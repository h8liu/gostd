<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7408835">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7408890">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7408944">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7408995">package</span>&nbsp;<span class="ident" id="7409003">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7409008">import</span>&nbsp;<span class="op" id="7409015">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409018">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409033">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409040">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409046">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409057">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="7409066">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7409069">type</span>&nbsp;<span class="ident" id="7409074">md5Test</span>&nbsp;<span class="keyword" id="7409082">struct</span>&nbsp;<span class="op" id="7409089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409092">out</span>&nbsp;<span class="builtintype" id="7409096">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409104">in</span>&nbsp;&nbsp;<span class="builtintype" id="7409108">string</span><br>
<span class="lineno"></span><span class="op" id="7409115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7409118">var</span>&nbsp;<span class="ident" id="7409122">golden</span>&nbsp;<span class="op" id="7409129">=</span>&nbsp;<span class="op" id="7409131">[</span><span class="op" id="7409132">]</span><span class="ident" id="7409133">md5Test</span><span class="op" id="7409140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409143">{</span><span class="string" id="7409144">&#34;d41d8cd98f00b204e9800998ecf8427e&#34;</span><span class="op" id="7409178">,</span>&nbsp;<span class="string" id="7409180">&#34;&#34;</span><span class="op" id="7409182">}</span><span class="op" id="7409183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409186">{</span><span class="string" id="7409187">&#34;0cc175b9c0f1b6a831c399e269772661&#34;</span><span class="op" id="7409221">,</span>&nbsp;<span class="string" id="7409223">&#34;a&#34;</span><span class="op" id="7409226">}</span><span class="op" id="7409227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409230">{</span><span class="string" id="7409231">&#34;187ef4436122d1cc2f40dc2b92f0eba0&#34;</span><span class="op" id="7409265">,</span>&nbsp;<span class="string" id="7409267">&#34;ab&#34;</span><span class="op" id="7409271">}</span><span class="op" id="7409272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409275">{</span><span class="string" id="7409276">&#34;900150983cd24fb0d6963f7d28e17f72&#34;</span><span class="op" id="7409310">,</span>&nbsp;<span class="string" id="7409312">&#34;abc&#34;</span><span class="op" id="7409317">}</span><span class="op" id="7409318">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409321">{</span><span class="string" id="7409322">&#34;e2fc714c4727ee9395f324cd2e7f331f&#34;</span><span class="op" id="7409356">,</span>&nbsp;<span class="string" id="7409358">&#34;abcd&#34;</span><span class="op" id="7409364">}</span><span class="op" id="7409365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409368">{</span><span class="string" id="7409369">&#34;ab56b4d92b40713acc5af89985d4b786&#34;</span><span class="op" id="7409403">,</span>&nbsp;<span class="string" id="7409405">&#34;abcde&#34;</span><span class="op" id="7409412">}</span><span class="op" id="7409413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409416">{</span><span class="string" id="7409417">&#34;e80b5017098950fc58aad83c8c14978e&#34;</span><span class="op" id="7409451">,</span>&nbsp;<span class="string" id="7409453">&#34;abcdef&#34;</span><span class="op" id="7409461">}</span><span class="op" id="7409462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409465">{</span><span class="string" id="7409466">&#34;7ac66c0f148de9519b8bd264312c4d64&#34;</span><span class="op" id="7409500">,</span>&nbsp;<span class="string" id="7409502">&#34;abcdefg&#34;</span><span class="op" id="7409511">}</span><span class="op" id="7409512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409515">{</span><span class="string" id="7409516">&#34;e8dc4081b13434b45189a720b77b6818&#34;</span><span class="op" id="7409550">,</span>&nbsp;<span class="string" id="7409552">&#34;abcdefgh&#34;</span><span class="op" id="7409562">}</span><span class="op" id="7409563">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409566">{</span><span class="string" id="7409567">&#34;8aa99b1f439ff71293e95357bac6fd94&#34;</span><span class="op" id="7409601">,</span>&nbsp;<span class="string" id="7409603">&#34;abcdefghi&#34;</span><span class="op" id="7409614">}</span><span class="op" id="7409615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409618">{</span><span class="string" id="7409619">&#34;a925576942e94b2ef57a066101b48876&#34;</span><span class="op" id="7409653">,</span>&nbsp;<span class="string" id="7409655">&#34;abcdefghij&#34;</span><span class="op" id="7409667">}</span><span class="op" id="7409668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409671">{</span><span class="string" id="7409672">&#34;d747fc1719c7eacb84058196cfe56d57&#34;</span><span class="op" id="7409706">,</span>&nbsp;<span class="string" id="7409708">&#34;Discard&nbsp;medicine&nbsp;more&nbsp;than&nbsp;two&nbsp;years&nbsp;old.&#34;</span><span class="op" id="7409751">}</span><span class="op" id="7409752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409755">{</span><span class="string" id="7409756">&#34;bff2dcb37ef3a44ba43ab144768ca837&#34;</span><span class="op" id="7409790">,</span>&nbsp;<span class="string" id="7409792">&#34;He&nbsp;who&nbsp;has&nbsp;a&nbsp;shady&nbsp;past&nbsp;knows&nbsp;that&nbsp;nice&nbsp;guys&nbsp;finish&nbsp;last.&#34;</span><span class="op" id="7409851">}</span><span class="op" id="7409852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409855">{</span><span class="string" id="7409856">&#34;0441015ecb54a7342d017ed1bcfdbea5&#34;</span><span class="op" id="7409890">,</span>&nbsp;<span class="string" id="7409892">&#34;I&nbsp;wouldn&#39;t&nbsp;marry&nbsp;him&nbsp;with&nbsp;a&nbsp;ten&nbsp;foot&nbsp;pole.&#34;</span><span class="op" id="7409936">}</span><span class="op" id="7409937">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409940">{</span><span class="string" id="7409941">&#34;9e3cac8e9e9757a60c3ea391130d3689&#34;</span><span class="op" id="7409975">,</span>&nbsp;<span class="string" id="7409977">&#34;Free!&nbsp;Free!/A&nbsp;trip/to&nbsp;Mars/for&nbsp;900/empty&nbsp;jars/Burma&nbsp;Shave&#34;</span><span class="op" id="7410036">}</span><span class="op" id="7410037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410040">{</span><span class="string" id="7410041">&#34;a0f04459b031f916a59a35cc482dc039&#34;</span><span class="op" id="7410075">,</span>&nbsp;<span class="string" id="7410077">&#34;The&nbsp;days&nbsp;of&nbsp;the&nbsp;digital&nbsp;watch&nbsp;are&nbsp;numbered.&nbsp;&nbsp;-Tom&nbsp;Stoppard&#34;</span><span class="op" id="7410137">}</span><span class="op" id="7410138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410141">{</span><span class="string" id="7410142">&#34;e7a48e0fe884faf31475d2a04b1362cc&#34;</span><span class="op" id="7410176">,</span>&nbsp;<span class="string" id="7410178">&#34;Nepal&nbsp;premier&nbsp;won&#39;t&nbsp;resign.&#34;</span><span class="op" id="7410207">}</span><span class="op" id="7410208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410211">{</span><span class="string" id="7410212">&#34;637d2fe925c07c113800509964fb0e06&#34;</span><span class="op" id="7410246">,</span>&nbsp;<span class="string" id="7410248">&#34;For&nbsp;every&nbsp;action&nbsp;there&nbsp;is&nbsp;an&nbsp;equal&nbsp;and&nbsp;opposite&nbsp;government&nbsp;program.&#34;</span><span class="op" id="7410317">}</span><span class="op" id="7410318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410321">{</span><span class="string" id="7410322">&#34;834a8d18d5c6562119cf4c7f5086cb71&#34;</span><span class="op" id="7410356">,</span>&nbsp;<span class="string" id="7410358">&#34;His&nbsp;money&nbsp;is&nbsp;twice&nbsp;tainted:&nbsp;&#39;taint&nbsp;yours&nbsp;and&nbsp;&#39;taint&nbsp;mine.&#34;</span><span class="op" id="7410417">}</span><span class="op" id="7410418">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410421">{</span><span class="string" id="7410422">&#34;de3a4d2fd6c73ec2db2abad23b444281&#34;</span><span class="op" id="7410456">,</span>&nbsp;<span class="string" id="7410458">&#34;There&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;any&nbsp;individual&nbsp;to&nbsp;have&nbsp;a&nbsp;computer&nbsp;in&nbsp;their&nbsp;home.&nbsp;-Ken&nbsp;Olsen,&nbsp;1977&#34;</span><span class="op" id="7410548">}</span><span class="op" id="7410549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410552">{</span><span class="string" id="7410553">&#34;acf203f997e2cf74ea3aff86985aefaf&#34;</span><span class="op" id="7410587">,</span>&nbsp;<span class="string" id="7410589">&#34;It&#39;s&nbsp;a&nbsp;tiny&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;and&nbsp;not&nbsp;completely&nbsp;disgusting.&nbsp;-&nbsp;Bob&nbsp;Manchek&#34;</span><span class="op" id="7410666">}</span><span class="op" id="7410667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410670">{</span><span class="string" id="7410671">&#34;e1c1384cb4d2221dfdd7c795a4222c9a&#34;</span><span class="op" id="7410705">,</span>&nbsp;<span class="string" id="7410707">&#34;size:&nbsp;&nbsp;a.out:&nbsp;&nbsp;bad&nbsp;magic&#34;</span><span class="op" id="7410733">}</span><span class="op" id="7410734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410737">{</span><span class="string" id="7410738">&#34;c90f3ddecc54f34228c063d7525bf644&#34;</span><span class="op" id="7410772">,</span>&nbsp;<span class="string" id="7410774">&#34;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;with&nbsp;sendmail.&nbsp;&nbsp;-Mark&nbsp;Horton&#34;</span><span class="op" id="7410825">}</span><span class="op" id="7410826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410829">{</span><span class="string" id="7410830">&#34;cdf7ab6c1fd49bd9933c43f3ea5af185&#34;</span><span class="op" id="7410864">,</span>&nbsp;<span class="string" id="7410866">&#34;Give&nbsp;me&nbsp;a&nbsp;rock,&nbsp;paper&nbsp;and&nbsp;scissors&nbsp;and&nbsp;I&nbsp;will&nbsp;move&nbsp;the&nbsp;world.&nbsp;&nbsp;CCFestoon&#34;</span><span class="op" id="7410940">}</span><span class="op" id="7410941">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410944">{</span><span class="string" id="7410945">&#34;83bc85234942fc883c063cbd7f0ad5d0&#34;</span><span class="op" id="7410979">,</span>&nbsp;<span class="string" id="7410981">&#34;If&nbsp;the&nbsp;enemy&nbsp;is&nbsp;within&nbsp;range,&nbsp;then&nbsp;so&nbsp;are&nbsp;you.&#34;</span><span class="op" id="7411029">}</span><span class="op" id="7411030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411033">{</span><span class="string" id="7411034">&#34;277cbe255686b48dd7e8f389394d9299&#34;</span><span class="op" id="7411068">,</span>&nbsp;<span class="string" id="7411070">&#34;It&#39;s&nbsp;well&nbsp;we&nbsp;cannot&nbsp;hear&nbsp;the&nbsp;screams/That&nbsp;we&nbsp;create&nbsp;in&nbsp;others&#39;&nbsp;dreams.&#34;</span><span class="op" id="7411142">}</span><span class="op" id="7411143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411146">{</span><span class="string" id="7411147">&#34;fd3fb0a7ffb8af16603f3d3af98f8e1f&#34;</span><span class="op" id="7411181">,</span>&nbsp;<span class="string" id="7411183">&#34;You&nbsp;remind&nbsp;me&nbsp;of&nbsp;a&nbsp;TV&nbsp;show,&nbsp;but&nbsp;that&#39;s&nbsp;all&nbsp;right:&nbsp;I&nbsp;watch&nbsp;it&nbsp;anyway.&#34;</span><span class="op" id="7411253">}</span><span class="op" id="7411254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411257">{</span><span class="string" id="7411258">&#34;469b13a78ebf297ecda64d4723655154&#34;</span><span class="op" id="7411292">,</span>&nbsp;<span class="string" id="7411294">&#34;C&nbsp;is&nbsp;as&nbsp;portable&nbsp;as&nbsp;Stonehedge!!&#34;</span><span class="op" id="7411328">}</span><span class="op" id="7411329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411332">{</span><span class="string" id="7411333">&#34;63eb3a2f466410104731c4b037600110&#34;</span><span class="op" id="7411367">,</span>&nbsp;<span class="string" id="7411369">&#34;Even&nbsp;if&nbsp;I&nbsp;could&nbsp;be&nbsp;Shakespeare,&nbsp;I&nbsp;think&nbsp;I&nbsp;should&nbsp;still&nbsp;choose&nbsp;to&nbsp;be&nbsp;Faraday.&nbsp;-&nbsp;A.&nbsp;Huxley&#34;</span><span class="op" id="7411459">}</span><span class="op" id="7411460">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411463">{</span><span class="string" id="7411464">&#34;72c2ed7592debca1c90fc0100f931a2f&#34;</span><span class="op" id="7411498">,</span>&nbsp;<span class="string" id="7411500">&#34;The&nbsp;fugacity&nbsp;of&nbsp;a&nbsp;constituent&nbsp;in&nbsp;a&nbsp;mixture&nbsp;of&nbsp;gases&nbsp;at&nbsp;a&nbsp;given&nbsp;temperature&nbsp;is&nbsp;proportional&nbsp;to&nbsp;its&nbsp;mole&nbsp;fraction.&nbsp;&nbsp;Lewis-Randall&nbsp;Rule&#34;</span><span class="op" id="7411634">}</span><span class="op" id="7411635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411638">{</span><span class="string" id="7411639">&#34;132f7619d33b523b1d9e5bd8e0928355&#34;</span><span class="op" id="7411673">,</span>&nbsp;<span class="string" id="7411675">&#34;How&nbsp;can&nbsp;you&nbsp;write&nbsp;a&nbsp;big&nbsp;system&nbsp;without&nbsp;C++?&nbsp;&nbsp;-Paul&nbsp;Glick&#34;</span><span class="op" id="7411733">}</span><span class="op" id="7411734">,</span><br>
<span class="lineno"></span><span class="op" id="7411736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7411739">func</span>&nbsp;<span class="ident" id="7411744">TestGolden</span><span class="op" id="7411754">(</span><span class="ident" id="7411755">t</span>&nbsp;<span class="op" id="7411757">*</span><span class="ident" id="7411758">testing</span><span class="op" id="7411765">.</span><span class="ident" id="7411766">T</span><span class="op" id="7411767">)</span>&nbsp;<span class="op" id="7411769">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411772">for</span>&nbsp;<span class="ident" id="7411776">i</span>&nbsp;<span class="op" id="7411778">:=</span>&nbsp;<span class="num" id="7411781">0</span><span class="op" id="7411782">;</span>&nbsp;<span class="ident" id="7411784">i</span>&nbsp;<span class="op" id="7411786">&lt;</span>&nbsp;<span class="builtinfunc" id="7411788">len</span><span class="op" id="7411791">(</span><span class="ident" id="7411792">golden</span><span class="op" id="7411798">)</span><span class="op" id="7411799">;</span>&nbsp;<span class="ident" id="7411801">i</span><span class="op" id="7411802">++</span>&nbsp;<span class="op" id="7411805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411809">g</span>&nbsp;<span class="op" id="7411811">:=</span>&nbsp;<span class="ident" id="7411814">golden</span><span class="op" id="7411820">[</span><span class="ident" id="7411821">i</span><span class="op" id="7411822">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411826">s</span>&nbsp;<span class="op" id="7411828">:=</span>&nbsp;<span class="ident" id="7411831">fmt</span><span class="op" id="7411834">.</span><span class="ident" id="7411835">Sprintf</span><span class="op" id="7411842">(</span><span class="string" id="7411843">&#34;%x&#34;</span><span class="op" id="7411847">,</span>&nbsp;<span class="ident" id="7411849">Sum</span><span class="op" id="7411852">(</span><span class="op" id="7411853">[</span><span class="op" id="7411854">]</span><span class="builtintype" id="7411855">byte</span><span class="op" id="7411859">(</span><span class="ident" id="7411860">g</span><span class="op" id="7411861">.</span><span class="ident" id="7411862">in</span><span class="op" id="7411864">)</span><span class="op" id="7411865">)</span><span class="op" id="7411866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411870">if</span>&nbsp;<span class="ident" id="7411873">s</span>&nbsp;<span class="op" id="7411875">!=</span>&nbsp;<span class="ident" id="7411878">g</span><span class="op" id="7411879">.</span><span class="ident" id="7411880">out</span>&nbsp;<span class="op" id="7411884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411889">t</span><span class="op" id="7411890">.</span><span class="ident" id="7411891">Fatalf</span><span class="op" id="7411897">(</span><span class="string" id="7411898">&#34;Sum&nbsp;function:&nbsp;md5(%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7411934">,</span>&nbsp;<span class="ident" id="7411936">g</span><span class="op" id="7411937">.</span><span class="ident" id="7411938">in</span><span class="op" id="7411940">,</span>&nbsp;<span class="ident" id="7411942">s</span><span class="op" id="7411943">,</span>&nbsp;<span class="ident" id="7411945">g</span><span class="op" id="7411946">.</span><span class="ident" id="7411947">out</span><span class="op" id="7411950">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411958">c</span>&nbsp;<span class="op" id="7411960">:=</span>&nbsp;<span class="ident" id="7411963">New</span><span class="op" id="7411966">(</span><span class="op" id="7411967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411971">buf</span>&nbsp;<span class="op" id="7411975">:=</span>&nbsp;<span class="builtinfunc" id="7411978">make</span><span class="op" id="7411982">(</span><span class="op" id="7411983">[</span><span class="op" id="7411984">]</span><span class="builtintype" id="7411985">byte</span><span class="op" id="7411989">,</span>&nbsp;<span class="builtinfunc" id="7411991">len</span><span class="op" id="7411994">(</span><span class="ident" id="7411995">g</span><span class="op" id="7411996">.</span><span class="ident" id="7411997">in</span><span class="op" id="7411999">)</span><span class="op" id="7412000">+</span><span class="num" id="7412001">4</span><span class="op" id="7412002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412006">for</span>&nbsp;<span class="ident" id="7412010">j</span>&nbsp;<span class="op" id="7412012">:=</span>&nbsp;<span class="num" id="7412015">0</span><span class="op" id="7412016">;</span>&nbsp;<span class="ident" id="7412018">j</span>&nbsp;<span class="op" id="7412020">&lt;</span>&nbsp;<span class="num" id="7412022">3</span><span class="op" id="7412023">+</span><span class="num" id="7412024">4</span><span class="op" id="7412025">;</span>&nbsp;<span class="ident" id="7412027">j</span><span class="op" id="7412028">++</span>&nbsp;<span class="op" id="7412031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412036">if</span>&nbsp;<span class="ident" id="7412039">j</span>&nbsp;<span class="op" id="7412041">&lt;</span>&nbsp;<span class="num" id="7412043">2</span>&nbsp;<span class="op" id="7412045">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412051">io</span><span class="op" id="7412053">.</span><span class="ident" id="7412054">WriteString</span><span class="op" id="7412065">(</span><span class="ident" id="7412066">c</span><span class="op" id="7412067">,</span>&nbsp;<span class="ident" id="7412069">g</span><span class="op" id="7412070">.</span><span class="ident" id="7412071">in</span><span class="op" id="7412073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412078">}</span>&nbsp;<span class="keyword" id="7412080">else</span>&nbsp;<span class="keyword" id="7412085">if</span>&nbsp;<span class="ident" id="7412088">j</span>&nbsp;<span class="op" id="7412090">==</span>&nbsp;<span class="num" id="7412093">2</span>&nbsp;<span class="op" id="7412095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412101">io</span><span class="op" id="7412103">.</span><span class="ident" id="7412104">WriteString</span><span class="op" id="7412115">(</span><span class="ident" id="7412116">c</span><span class="op" id="7412117">,</span>&nbsp;<span class="ident" id="7412119">g</span><span class="op" id="7412120">.</span><span class="ident" id="7412121">in</span><span class="op" id="7412123">[</span><span class="num" id="7412124">0</span><span class="op" id="7412125">:</span><span class="builtinfunc" id="7412126">len</span><span class="op" id="7412129">(</span><span class="ident" id="7412130">g</span><span class="op" id="7412131">.</span><span class="ident" id="7412132">in</span><span class="op" id="7412134">)</span><span class="op" id="7412135">/</span><span class="num" id="7412136">2</span><span class="op" id="7412137">]</span><span class="op" id="7412138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412144">c</span><span class="op" id="7412145">.</span><span class="ident" id="7412146">Sum</span><span class="op" id="7412149">(</span><span class="ident" id="7412150">nil</span><span class="op" id="7412153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412159">io</span><span class="op" id="7412161">.</span><span class="ident" id="7412162">WriteString</span><span class="op" id="7412173">(</span><span class="ident" id="7412174">c</span><span class="op" id="7412175">,</span>&nbsp;<span class="ident" id="7412177">g</span><span class="op" id="7412178">.</span><span class="ident" id="7412179">in</span><span class="op" id="7412181">[</span><span class="builtinfunc" id="7412182">len</span><span class="op" id="7412185">(</span><span class="ident" id="7412186">g</span><span class="op" id="7412187">.</span><span class="ident" id="7412188">in</span><span class="op" id="7412190">)</span><span class="op" id="7412191">/</span><span class="num" id="7412192">2</span><span class="op" id="7412193">:</span><span class="op" id="7412194">]</span><span class="op" id="7412195">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412200">}</span>&nbsp;<span class="keyword" id="7412202">else</span>&nbsp;<span class="keyword" id="7412207">if</span>&nbsp;<span class="ident" id="7412210">j</span>&nbsp;<span class="op" id="7412212">&gt;</span>&nbsp;<span class="num" id="7412214">2</span>&nbsp;<span class="op" id="7412216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7412222">//&nbsp;test&nbsp;unaligned&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412250">buf</span>&nbsp;<span class="op" id="7412254">=</span>&nbsp;<span class="ident" id="7412256">buf</span><span class="op" id="7412259">[</span><span class="num" id="7412260">1</span><span class="op" id="7412261">:</span><span class="op" id="7412262">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7412268">copy</span><span class="op" id="7412272">(</span><span class="ident" id="7412273">buf</span><span class="op" id="7412276">,</span>&nbsp;<span class="ident" id="7412278">g</span><span class="op" id="7412279">.</span><span class="ident" id="7412280">in</span><span class="op" id="7412282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412288">c</span><span class="op" id="7412289">.</span><span class="ident" id="7412290">Write</span><span class="op" id="7412295">(</span><span class="ident" id="7412296">buf</span><span class="op" id="7412299">[</span><span class="op" id="7412300">:</span><span class="builtinfunc" id="7412301">len</span><span class="op" id="7412304">(</span><span class="ident" id="7412305">g</span><span class="op" id="7412306">.</span><span class="ident" id="7412307">in</span><span class="op" id="7412309">)</span><span class="op" id="7412310">]</span><span class="op" id="7412311">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412321">s</span>&nbsp;<span class="op" id="7412323">:=</span>&nbsp;<span class="ident" id="7412326">fmt</span><span class="op" id="7412329">.</span><span class="ident" id="7412330">Sprintf</span><span class="op" id="7412337">(</span><span class="string" id="7412338">&#34;%x&#34;</span><span class="op" id="7412342">,</span>&nbsp;<span class="ident" id="7412344">c</span><span class="op" id="7412345">.</span><span class="ident" id="7412346">Sum</span><span class="op" id="7412349">(</span><span class="ident" id="7412350">nil</span><span class="op" id="7412353">)</span><span class="op" id="7412354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412359">if</span>&nbsp;<span class="ident" id="7412362">s</span>&nbsp;<span class="op" id="7412364">!=</span>&nbsp;<span class="ident" id="7412367">g</span><span class="op" id="7412368">.</span><span class="ident" id="7412369">out</span>&nbsp;<span class="op" id="7412373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412379">t</span><span class="op" id="7412380">.</span><span class="ident" id="7412381">Fatalf</span><span class="op" id="7412387">(</span><span class="string" id="7412388">&#34;md5[%d](%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7412414">,</span>&nbsp;<span class="ident" id="7412416">j</span><span class="op" id="7412417">,</span>&nbsp;<span class="ident" id="7412419">g</span><span class="op" id="7412420">.</span><span class="ident" id="7412421">in</span><span class="op" id="7412423">,</span>&nbsp;<span class="ident" id="7412425">s</span><span class="op" id="7412426">,</span>&nbsp;<span class="ident" id="7412428">g</span><span class="op" id="7412429">.</span><span class="ident" id="7412430">out</span><span class="op" id="7412433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412438">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412443">c</span><span class="op" id="7412444">.</span><span class="ident" id="7412445">Reset</span><span class="op" id="7412450">(</span><span class="op" id="7412451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412458">}</span><br>
<span class="lineno"></span><span class="op" id="7412460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7412463">func</span>&nbsp;<span class="ident" id="7412468">TestLarge</span><span class="op" id="7412477">(</span><span class="ident" id="7412478">t</span>&nbsp;<span class="op" id="7412480">*</span><span class="ident" id="7412481">testing</span><span class="op" id="7412488">.</span><span class="ident" id="7412489">T</span><span class="op" id="7412490">)</span>&nbsp;<span class="op" id="7412492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412495">const</span>&nbsp;<span class="ident" id="7412501">N</span>&nbsp;<span class="op" id="7412503">=</span>&nbsp;<span class="num" id="7412505">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412512">ok</span>&nbsp;<span class="op" id="7412515">:=</span>&nbsp;<span class="string" id="7412518">&#34;2bb571599a4180e1d542f76904adc3df&#34;</span>&nbsp;<span class="comment" id="7412553">//&nbsp;md5sum&nbsp;of&nbsp;&#34;0123456789&#34;&nbsp;*&nbsp;1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412587">block</span>&nbsp;<span class="op" id="7412593">:=</span>&nbsp;<span class="builtinfunc" id="7412596">make</span><span class="op" id="7412600">(</span><span class="op" id="7412601">[</span><span class="op" id="7412602">]</span><span class="builtintype" id="7412603">byte</span><span class="op" id="7412607">,</span>&nbsp;<span class="num" id="7412609">10004</span><span class="op" id="7412614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412617">c</span>&nbsp;<span class="op" id="7412619">:=</span>&nbsp;<span class="ident" id="7412622">New</span><span class="op" id="7412625">(</span><span class="op" id="7412626">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412629">for</span>&nbsp;<span class="ident" id="7412633">offset</span>&nbsp;<span class="op" id="7412640">:=</span>&nbsp;<span class="num" id="7412643">0</span><span class="op" id="7412644">;</span>&nbsp;<span class="ident" id="7412646">offset</span>&nbsp;<span class="op" id="7412653">&lt;</span>&nbsp;<span class="num" id="7412655">4</span><span class="op" id="7412656">;</span>&nbsp;<span class="ident" id="7412658">offset</span><span class="op" id="7412664">++</span>&nbsp;<span class="op" id="7412667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412671">for</span>&nbsp;<span class="ident" id="7412675">i</span>&nbsp;<span class="op" id="7412677">:=</span>&nbsp;<span class="num" id="7412680">0</span><span class="op" id="7412681">;</span>&nbsp;<span class="ident" id="7412683">i</span>&nbsp;<span class="op" id="7412685">&lt;</span>&nbsp;<span class="ident" id="7412687">N</span><span class="op" id="7412688">;</span>&nbsp;<span class="ident" id="7412690">i</span><span class="op" id="7412691">++</span>&nbsp;<span class="op" id="7412694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412699">block</span><span class="op" id="7412704">[</span><span class="ident" id="7412705">offset</span><span class="op" id="7412711">+</span><span class="ident" id="7412712">i</span><span class="op" id="7412713">]</span>&nbsp;<span class="op" id="7412715">=</span>&nbsp;<span class="string" id="7412717">&#39;0&#39;</span>&nbsp;<span class="op" id="7412721">+</span>&nbsp;<span class="builtintype" id="7412723">byte</span><span class="op" id="7412727">(</span><span class="ident" id="7412728">i</span><span class="op" id="7412729">%</span><span class="num" id="7412730">10</span><span class="op" id="7412732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412740">for</span>&nbsp;<span class="ident" id="7412744">blockSize</span>&nbsp;<span class="op" id="7412754">:=</span>&nbsp;<span class="num" id="7412757">10</span><span class="op" id="7412759">;</span>&nbsp;<span class="ident" id="7412761">blockSize</span>&nbsp;<span class="op" id="7412771">&lt;=</span>&nbsp;<span class="ident" id="7412774">N</span><span class="op" id="7412775">;</span>&nbsp;<span class="ident" id="7412777">blockSize</span>&nbsp;<span class="op" id="7412787">*=</span>&nbsp;<span class="num" id="7412790">10</span>&nbsp;<span class="op" id="7412793">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412798">blocks</span>&nbsp;<span class="op" id="7412805">:=</span>&nbsp;<span class="ident" id="7412808">N</span>&nbsp;<span class="op" id="7412810">/</span>&nbsp;<span class="ident" id="7412812">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412825">b</span>&nbsp;<span class="op" id="7412827">:=</span>&nbsp;<span class="ident" id="7412830">block</span><span class="op" id="7412835">[</span><span class="ident" id="7412836">offset</span>&nbsp;<span class="op" id="7412843">:</span>&nbsp;<span class="ident" id="7412845">offset</span><span class="op" id="7412851">+</span><span class="ident" id="7412852">blockSize</span><span class="op" id="7412861">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412866">c</span><span class="op" id="7412867">.</span><span class="ident" id="7412868">Reset</span><span class="op" id="7412873">(</span><span class="op" id="7412874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412879">for</span>&nbsp;<span class="ident" id="7412883">i</span>&nbsp;<span class="op" id="7412885">:=</span>&nbsp;<span class="num" id="7412888">0</span><span class="op" id="7412889">;</span>&nbsp;<span class="ident" id="7412891">i</span>&nbsp;<span class="op" id="7412893">&lt;</span>&nbsp;<span class="ident" id="7412895">blocks</span><span class="op" id="7412901">;</span>&nbsp;<span class="ident" id="7412903">i</span><span class="op" id="7412904">++</span>&nbsp;<span class="op" id="7412907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412913">c</span><span class="op" id="7412914">.</span><span class="ident" id="7412915">Write</span><span class="op" id="7412920">(</span><span class="ident" id="7412921">b</span><span class="op" id="7412922">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412932">s</span>&nbsp;<span class="op" id="7412934">:=</span>&nbsp;<span class="ident" id="7412937">fmt</span><span class="op" id="7412940">.</span><span class="ident" id="7412941">Sprintf</span><span class="op" id="7412948">(</span><span class="string" id="7412949">&#34;%x&#34;</span><span class="op" id="7412953">,</span>&nbsp;<span class="ident" id="7412955">c</span><span class="op" id="7412956">.</span><span class="ident" id="7412957">Sum</span><span class="op" id="7412960">(</span><span class="ident" id="7412961">nil</span><span class="op" id="7412964">)</span><span class="op" id="7412965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7412970">if</span>&nbsp;<span class="ident" id="7412973">s</span>&nbsp;<span class="op" id="7412975">!=</span>&nbsp;<span class="ident" id="7412978">ok</span>&nbsp;<span class="op" id="7412981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412987">t</span><span class="op" id="7412988">.</span><span class="ident" id="7412989">Fatalf</span><span class="op" id="7412995">(</span><span class="string" id="7412996">&#34;md5&nbsp;TestLarge&nbsp;offset=%d,&nbsp;blockSize=%d&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7413048">,</span>&nbsp;<span class="ident" id="7413050">offset</span><span class="op" id="7413056">,</span>&nbsp;<span class="ident" id="7413058">blockSize</span><span class="op" id="7413067">,</span>&nbsp;<span class="ident" id="7413069">s</span><span class="op" id="7413070">,</span>&nbsp;<span class="ident" id="7413072">ok</span><span class="op" id="7413074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7413079">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7413083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7413086">}</span><br>
<span class="lineno"></span><span class="op" id="7413088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7413091">//&nbsp;Tests&nbsp;that&nbsp;blockGeneric&nbsp;(pure&nbsp;Go)&nbsp;and&nbsp;block&nbsp;(in&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;arm)&nbsp;match.</span><br>
<span class="lineno">110</span><span class="keyword" id="7413179">func</span>&nbsp;<span class="ident" id="7413184">TestBlockGeneric</span><span class="op" id="7413200">(</span><span class="ident" id="7413201">t</span>&nbsp;<span class="op" id="7413203">*</span><span class="ident" id="7413204">testing</span><span class="op" id="7413211">.</span><span class="ident" id="7413212">T</span><span class="op" id="7413213">)</span>&nbsp;<span class="op" id="7413215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413218">gen</span><span class="op" id="7413221">,</span>&nbsp;<span class="ident" id="7413223">asm</span>&nbsp;<span class="op" id="7413227">:=</span>&nbsp;<span class="ident" id="7413230">New</span><span class="op" id="7413233">(</span><span class="op" id="7413234">)</span><span class="op" id="7413235">.</span><span class="op" id="7413236">(</span><span class="op" id="7413237">*</span><span class="ident" id="7413238">digest</span><span class="op" id="7413244">)</span><span class="op" id="7413245">,</span>&nbsp;<span class="ident" id="7413247">New</span><span class="op" id="7413250">(</span><span class="op" id="7413251">)</span><span class="op" id="7413252">.</span><span class="op" id="7413253">(</span><span class="op" id="7413254">*</span><span class="ident" id="7413255">digest</span><span class="op" id="7413261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413264">buf</span>&nbsp;<span class="op" id="7413268">:=</span>&nbsp;<span class="builtinfunc" id="7413271">make</span><span class="op" id="7413275">(</span><span class="op" id="7413276">[</span><span class="op" id="7413277">]</span><span class="builtintype" id="7413278">byte</span><span class="op" id="7413282">,</span>&nbsp;<span class="ident" id="7413284">BlockSize</span><span class="op" id="7413293">*</span><span class="num" id="7413294">20</span><span class="op" id="7413296">)</span>&nbsp;<span class="comment" id="7413298">//&nbsp;arbitrary&nbsp;factor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413319">rand</span><span class="op" id="7413323">.</span><span class="ident" id="7413324">Read</span><span class="op" id="7413328">(</span><span class="ident" id="7413329">buf</span><span class="op" id="7413332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413335">blockGeneric</span><span class="op" id="7413347">(</span><span class="ident" id="7413348">gen</span><span class="op" id="7413351">,</span>&nbsp;<span class="ident" id="7413353">buf</span><span class="op" id="7413356">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413359">block</span><span class="op" id="7413364">(</span><span class="ident" id="7413365">asm</span><span class="op" id="7413368">,</span>&nbsp;<span class="ident" id="7413370">buf</span><span class="op" id="7413373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7413376">if</span>&nbsp;<span class="op" id="7413379">*</span><span class="ident" id="7413380">gen</span>&nbsp;<span class="op" id="7413384">!=</span>&nbsp;<span class="op" id="7413387">*</span><span class="ident" id="7413388">asm</span>&nbsp;<span class="op" id="7413392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413396">t</span><span class="op" id="7413397">.</span><span class="ident" id="7413398">Error</span><span class="op" id="7413403">(</span><span class="string" id="7413404">&#34;block&nbsp;and&nbsp;blockGeneric&nbsp;resulted&nbsp;in&nbsp;different&nbsp;states&#34;</span><span class="op" id="7413457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7413460">}</span><br>
<span class="lineno"></span><span class="op" id="7413462">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7413465">var</span>&nbsp;<span class="ident" id="7413469">bench</span>&nbsp;<span class="op" id="7413475">=</span>&nbsp;<span class="ident" id="7413477">New</span><span class="op" id="7413480">(</span><span class="op" id="7413481">)</span><br>
<span class="lineno"></span><span class="keyword" id="7413483">var</span>&nbsp;<span class="ident" id="7413487">buf</span>&nbsp;<span class="op" id="7413491">=</span>&nbsp;<span class="builtinfunc" id="7413493">make</span><span class="op" id="7413497">(</span><span class="op" id="7413498">[</span><span class="op" id="7413499">]</span><span class="builtintype" id="7413500">byte</span><span class="op" id="7413504">,</span>&nbsp;<span class="num" id="7413506">8192</span><span class="op" id="7413510">+</span><span class="num" id="7413511">1</span><span class="op" id="7413512">)</span><br>
<span class="lineno"></span><span class="keyword" id="7413514">var</span>&nbsp;<span class="ident" id="7413518">sum</span>&nbsp;<span class="op" id="7413522">=</span>&nbsp;<span class="builtinfunc" id="7413524">make</span><span class="op" id="7413528">(</span><span class="op" id="7413529">[</span><span class="op" id="7413530">]</span><span class="builtintype" id="7413531">byte</span><span class="op" id="7413535">,</span>&nbsp;<span class="ident" id="7413537">bench</span><span class="op" id="7413542">.</span><span class="ident" id="7413543">Size</span><span class="op" id="7413547">(</span><span class="op" id="7413548">)</span><span class="op" id="7413549">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7413552">func</span>&nbsp;<span class="ident" id="7413557">benchmarkSize</span><span class="op" id="7413570">(</span><span class="ident" id="7413571">b</span>&nbsp;<span class="op" id="7413573">*</span><span class="ident" id="7413574">testing</span><span class="op" id="7413581">.</span><span class="ident" id="7413582">B</span><span class="op" id="7413583">,</span>&nbsp;<span class="ident" id="7413585">size</span>&nbsp;<span class="builtintype" id="7413590">int</span><span class="op" id="7413593">,</span>&nbsp;<span class="ident" id="7413595">unaligned</span>&nbsp;<span class="builtintype" id="7413605">bool</span><span class="op" id="7413609">)</span>&nbsp;<span class="op" id="7413611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413614">b</span><span class="op" id="7413615">.</span><span class="ident" id="7413616">SetBytes</span><span class="op" id="7413624">(</span><span class="ident" id="7413625">int64</span><span class="op" id="7413630">(</span><span class="ident" id="7413631">size</span><span class="op" id="7413635">)</span><span class="op" id="7413636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413639">buf</span>&nbsp;<span class="op" id="7413643">:=</span>&nbsp;<span class="ident" id="7413646">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7413651">if</span>&nbsp;<span class="ident" id="7413654">unaligned</span>&nbsp;<span class="op" id="7413664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7413668">if</span>&nbsp;<span class="builtintype" id="7413671">uintptr</span><span class="op" id="7413678">(</span><span class="ident" id="7413679">unsafe</span><span class="op" id="7413685">.</span><span class="ident" id="7413686">Pointer</span><span class="op" id="7413693">(</span><span class="op" id="7413694">&amp;</span><span class="ident" id="7413695">buf</span><span class="op" id="7413698">[</span><span class="num" id="7413699">0</span><span class="op" id="7413700">]</span><span class="op" id="7413701">)</span><span class="op" id="7413702">)</span><span class="op" id="7413703">&amp;</span><span class="op" id="7413704">(</span><span class="ident" id="7413705">unsafe</span><span class="op" id="7413711">.</span><span class="ident" id="7413712">Alignof</span><span class="op" id="7413719">(</span><span class="builtintype" id="7413720">uint32</span><span class="op" id="7413726">(</span><span class="num" id="7413727">0</span><span class="op" id="7413728">)</span><span class="op" id="7413729">)</span><span class="op" id="7413730">-</span><span class="num" id="7413731">1</span><span class="op" id="7413732">)</span>&nbsp;<span class="op" id="7413734">==</span>&nbsp;<span class="num" id="7413737">0</span>&nbsp;<span class="op" id="7413739">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413744">buf</span>&nbsp;<span class="op" id="7413748">=</span>&nbsp;<span class="ident" id="7413750">buf</span><span class="op" id="7413753">[</span><span class="num" id="7413754">1</span><span class="op" id="7413755">:</span><span class="op" id="7413756">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7413760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7413763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413766">b</span><span class="op" id="7413767">.</span><span class="ident" id="7413768">ResetTimer</span><span class="op" id="7413778">(</span><span class="op" id="7413779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7413782">for</span>&nbsp;<span class="ident" id="7413786">i</span>&nbsp;<span class="op" id="7413788">:=</span>&nbsp;<span class="num" id="7413791">0</span><span class="op" id="7413792">;</span>&nbsp;<span class="ident" id="7413794">i</span>&nbsp;<span class="op" id="7413796">&lt;</span>&nbsp;<span class="ident" id="7413798">b</span><span class="op" id="7413799">.</span><span class="ident" id="7413800">N</span><span class="op" id="7413801">;</span>&nbsp;<span class="ident" id="7413803">i</span><span class="op" id="7413804">++</span>&nbsp;<span class="op" id="7413807">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413811">bench</span><span class="op" id="7413816">.</span><span class="ident" id="7413817">Reset</span><span class="op" id="7413822">(</span><span class="op" id="7413823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413827">bench</span><span class="op" id="7413832">.</span><span class="ident" id="7413833">Write</span><span class="op" id="7413838">(</span><span class="ident" id="7413839">buf</span><span class="op" id="7413842">[</span><span class="op" id="7413843">:</span><span class="ident" id="7413844">size</span><span class="op" id="7413848">]</span><span class="op" id="7413849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413853">bench</span><span class="op" id="7413858">.</span><span class="ident" id="7413859">Sum</span><span class="op" id="7413862">(</span><span class="ident" id="7413863">sum</span><span class="op" id="7413866">[</span><span class="op" id="7413867">:</span><span class="num" id="7413868">0</span><span class="op" id="7413869">]</span><span class="op" id="7413870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7413873">}</span><br>
<span class="lineno"></span><span class="op" id="7413875">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7413878">func</span>&nbsp;<span class="ident" id="7413883">BenchmarkHash8Bytes</span><span class="op" id="7413902">(</span><span class="ident" id="7413903">b</span>&nbsp;<span class="op" id="7413905">*</span><span class="ident" id="7413906">testing</span><span class="op" id="7413913">.</span><span class="ident" id="7413914">B</span><span class="op" id="7413915">)</span>&nbsp;<span class="op" id="7413917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413920">benchmarkSize</span><span class="op" id="7413933">(</span><span class="ident" id="7413934">b</span><span class="op" id="7413935">,</span>&nbsp;<span class="num" id="7413937">8</span><span class="op" id="7413938">,</span>&nbsp;<span class="builtintype" id="7413940">false</span><span class="op" id="7413945">)</span><br>
<span class="lineno"></span><span class="op" id="7413947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="7413950">func</span>&nbsp;<span class="ident" id="7413955">BenchmarkHash1K</span><span class="op" id="7413970">(</span><span class="ident" id="7413971">b</span>&nbsp;<span class="op" id="7413973">*</span><span class="ident" id="7413974">testing</span><span class="op" id="7413981">.</span><span class="ident" id="7413982">B</span><span class="op" id="7413983">)</span>&nbsp;<span class="op" id="7413985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7413988">benchmarkSize</span><span class="op" id="7414001">(</span><span class="ident" id="7414002">b</span><span class="op" id="7414003">,</span>&nbsp;<span class="num" id="7414005">1024</span><span class="op" id="7414009">,</span>&nbsp;<span class="builtintype" id="7414011">false</span><span class="op" id="7414016">)</span><br>
<span class="lineno"></span><span class="op" id="7414018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7414021">func</span>&nbsp;<span class="ident" id="7414026">BenchmarkHash8K</span><span class="op" id="7414041">(</span><span class="ident" id="7414042">b</span>&nbsp;<span class="op" id="7414044">*</span><span class="ident" id="7414045">testing</span><span class="op" id="7414052">.</span><span class="ident" id="7414053">B</span><span class="op" id="7414054">)</span>&nbsp;<span class="op" id="7414056">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7414059">benchmarkSize</span><span class="op" id="7414072">(</span><span class="ident" id="7414073">b</span><span class="op" id="7414074">,</span>&nbsp;<span class="num" id="7414076">8192</span><span class="op" id="7414080">,</span>&nbsp;<span class="builtintype" id="7414082">false</span><span class="op" id="7414087">)</span><br>
<span class="lineno"></span><span class="op" id="7414089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7414092">func</span>&nbsp;<span class="ident" id="7414097">BenchmarkHash8BytesUnaligned</span><span class="op" id="7414125">(</span><span class="ident" id="7414126">b</span>&nbsp;<span class="op" id="7414128">*</span><span class="ident" id="7414129">testing</span><span class="op" id="7414136">.</span><span class="ident" id="7414137">B</span><span class="op" id="7414138">)</span>&nbsp;<span class="op" id="7414140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7414143">benchmarkSize</span><span class="op" id="7414156">(</span><span class="ident" id="7414157">b</span><span class="op" id="7414158">,</span>&nbsp;<span class="num" id="7414160">8</span><span class="op" id="7414161">,</span>&nbsp;<span class="builtintype" id="7414163">true</span><span class="op" id="7414167">)</span><br>
<span class="lineno">155</span><span class="op" id="7414169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7414172">func</span>&nbsp;<span class="ident" id="7414177">BenchmarkHash1KUnaligned</span><span class="op" id="7414201">(</span><span class="ident" id="7414202">b</span>&nbsp;<span class="op" id="7414204">*</span><span class="ident" id="7414205">testing</span><span class="op" id="7414212">.</span><span class="ident" id="7414213">B</span><span class="op" id="7414214">)</span>&nbsp;<span class="op" id="7414216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7414219">benchmarkSize</span><span class="op" id="7414232">(</span><span class="ident" id="7414233">b</span><span class="op" id="7414234">,</span>&nbsp;<span class="num" id="7414236">1024</span><span class="op" id="7414240">,</span>&nbsp;<span class="builtintype" id="7414242">true</span><span class="op" id="7414246">)</span><br>
<span class="lineno"></span><span class="op" id="7414248">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="7414251">func</span>&nbsp;<span class="ident" id="7414256">BenchmarkHash8KUnaligned</span><span class="op" id="7414280">(</span><span class="ident" id="7414281">b</span>&nbsp;<span class="op" id="7414283">*</span><span class="ident" id="7414284">testing</span><span class="op" id="7414291">.</span><span class="ident" id="7414292">B</span><span class="op" id="7414293">)</span>&nbsp;<span class="op" id="7414295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7414298">benchmarkSize</span><span class="op" id="7414311">(</span><span class="ident" id="7414312">b</span><span class="op" id="7414313">,</span>&nbsp;<span class="num" id="7414315">8192</span><span class="op" id="7414319">,</span>&nbsp;<span class="builtintype" id="7414321">true</span><span class="op" id="7414325">)</span><br>
<span class="lineno"></span><span class="op" id="7414327">}</span>
</div>
</body>
</html>
