<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4651013">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4651068">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4651122">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4651173">package</span>&nbsp;<span class="ident" id="4651181">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4651186">import</span>&nbsp;<span class="op" id="4651193">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4651196">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4651214">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4651217">func</span>&nbsp;<span class="ident" id="4651222">cryptBlock</span><span class="op" id="4651232">(</span><span class="ident" id="4651233">subkeys</span>&nbsp;<span class="op" id="4651241">[</span><span class="op" id="4651242">]</span><span class="ident" id="4651243">uint64</span><span class="op" id="4651249">,</span>&nbsp;<span class="ident" id="4651251">dst</span><span class="op" id="4651254">,</span>&nbsp;<span class="ident" id="4651256">src</span>&nbsp;<span class="op" id="4651260">[</span><span class="op" id="4651261">]</span><span class="builtintype" id="4651262">byte</span><span class="op" id="4651266">,</span>&nbsp;<span class="ident" id="4651268">decrypt</span>&nbsp;<span class="builtintype" id="4651276">bool</span><span class="op" id="4651280">)</span>&nbsp;<span class="op" id="4651282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651285">b</span>&nbsp;<span class="op" id="4651287">:=</span>&nbsp;<span class="ident" id="4651290">binary</span><span class="op" id="4651296">.</span><span class="ident" id="4651297">BigEndian</span><span class="op" id="4651306">.</span><span class="ident" id="4651307">Uint64</span><span class="op" id="4651313">(</span><span class="ident" id="4651314">src</span><span class="op" id="4651317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651320">b</span>&nbsp;<span class="op" id="4651322">=</span>&nbsp;<span class="ident" id="4651324">permuteInitialBlock</span><span class="op" id="4651343">(</span><span class="ident" id="4651344">b</span><span class="op" id="4651345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651348">left</span><span class="op" id="4651352">,</span>&nbsp;<span class="ident" id="4651354">right</span>&nbsp;<span class="op" id="4651360">:=</span>&nbsp;<span class="builtintype" id="4651363">uint32</span><span class="op" id="4651369">(</span><span class="ident" id="4651370">b</span><span class="op" id="4651371">&gt;&gt;</span><span class="num" id="4651373">32</span><span class="op" id="4651375">)</span><span class="op" id="4651376">,</span>&nbsp;<span class="builtintype" id="4651378">uint32</span><span class="op" id="4651384">(</span><span class="ident" id="4651385">b</span><span class="op" id="4651386">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4651390">var</span>&nbsp;<span class="ident" id="4651394">subkey</span>&nbsp;<span class="ident" id="4651401">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4651409">for</span>&nbsp;<span class="ident" id="4651413">i</span>&nbsp;<span class="op" id="4651415">:=</span>&nbsp;<span class="num" id="4651418">0</span><span class="op" id="4651419">;</span>&nbsp;<span class="ident" id="4651421">i</span>&nbsp;<span class="op" id="4651423">&lt;</span>&nbsp;<span class="num" id="4651425">16</span><span class="op" id="4651427">;</span>&nbsp;<span class="ident" id="4651429">i</span><span class="op" id="4651430">++</span>&nbsp;<span class="op" id="4651433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4651437">if</span>&nbsp;<span class="ident" id="4651440">decrypt</span>&nbsp;<span class="op" id="4651448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651453">subkey</span>&nbsp;<span class="op" id="4651460">=</span>&nbsp;<span class="ident" id="4651462">subkeys</span><span class="op" id="4651469">[</span><span class="num" id="4651470">15</span><span class="op" id="4651472">-</span><span class="ident" id="4651473">i</span><span class="op" id="4651474">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4651478">}</span>&nbsp;<span class="keyword" id="4651480">else</span>&nbsp;<span class="op" id="4651485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651490">subkey</span>&nbsp;<span class="op" id="4651497">=</span>&nbsp;<span class="ident" id="4651499">subkeys</span><span class="op" id="4651506">[</span><span class="ident" id="4651507">i</span><span class="op" id="4651508">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4651512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651517">left</span><span class="op" id="4651521">,</span>&nbsp;<span class="ident" id="4651523">right</span>&nbsp;<span class="op" id="4651529">=</span>&nbsp;<span class="ident" id="4651531">right</span><span class="op" id="4651536">,</span>&nbsp;<span class="ident" id="4651538">left</span><span class="op" id="4651542">^</span><span class="ident" id="4651543">feistel</span><span class="op" id="4651550">(</span><span class="ident" id="4651551">right</span><span class="op" id="4651556">,</span>&nbsp;<span class="ident" id="4651558">subkey</span><span class="op" id="4651564">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4651567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4651570">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651624">preOutput</span>&nbsp;<span class="op" id="4651634">:=</span>&nbsp;<span class="op" id="4651637">(</span><span class="ident" id="4651638">uint64</span><span class="op" id="4651644">(</span><span class="ident" id="4651645">right</span><span class="op" id="4651650">)</span>&nbsp;<span class="op" id="4651652">&lt;&lt;</span>&nbsp;<span class="num" id="4651655">32</span><span class="op" id="4651657">)</span>&nbsp;<span class="op" id="4651659">|</span>&nbsp;<span class="ident" id="4651661">uint64</span><span class="op" id="4651667">(</span><span class="ident" id="4651668">left</span><span class="op" id="4651672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651675">binary</span><span class="op" id="4651681">.</span><span class="ident" id="4651682">BigEndian</span><span class="op" id="4651691">.</span><span class="ident" id="4651692">PutUint64</span><span class="op" id="4651701">(</span><span class="ident" id="4651702">dst</span><span class="op" id="4651705">,</span>&nbsp;<span class="ident" id="4651707">permuteFinalBlock</span><span class="op" id="4651724">(</span><span class="ident" id="4651725">preOutput</span><span class="op" id="4651734">)</span><span class="op" id="4651735">)</span><br>
<span class="lineno"></span><span class="op" id="4651737">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4651740">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4651799">func</span>&nbsp;<span class="ident" id="4651804">encryptBlock</span><span class="op" id="4651816">(</span><span class="ident" id="4651817">subkeys</span>&nbsp;<span class="op" id="4651825">[</span><span class="op" id="4651826">]</span><span class="ident" id="4651827">uint64</span><span class="op" id="4651833">,</span>&nbsp;<span class="ident" id="4651835">dst</span><span class="op" id="4651838">,</span>&nbsp;<span class="ident" id="4651840">src</span>&nbsp;<span class="op" id="4651844">[</span><span class="op" id="4651845">]</span><span class="builtintype" id="4651846">byte</span><span class="op" id="4651850">)</span>&nbsp;<span class="op" id="4651852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4651855">cryptBlock</span><span class="op" id="4651865">(</span><span class="ident" id="4651866">subkeys</span><span class="op" id="4651873">,</span>&nbsp;<span class="ident" id="4651875">dst</span><span class="op" id="4651878">,</span>&nbsp;<span class="ident" id="4651880">src</span><span class="op" id="4651883">,</span>&nbsp;<span class="builtintype" id="4651885">false</span><span class="op" id="4651890">)</span><br>
<span class="lineno"></span><span class="op" id="4651892">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4651895">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4651954">func</span>&nbsp;<span class="ident" id="4651959">decryptBlock</span><span class="op" id="4651971">(</span><span class="ident" id="4651972">subkeys</span>&nbsp;<span class="op" id="4651980">[</span><span class="op" id="4651981">]</span><span class="ident" id="4651982">uint64</span><span class="op" id="4651988">,</span>&nbsp;<span class="ident" id="4651990">dst</span><span class="op" id="4651993">,</span>&nbsp;<span class="ident" id="4651995">src</span>&nbsp;<span class="op" id="4651999">[</span><span class="op" id="4652000">]</span><span class="builtintype" id="4652001">byte</span><span class="op" id="4652005">)</span>&nbsp;<span class="op" id="4652007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652010">cryptBlock</span><span class="op" id="4652020">(</span><span class="ident" id="4652021">subkeys</span><span class="op" id="4652028">,</span>&nbsp;<span class="ident" id="4652030">dst</span><span class="op" id="4652033">,</span>&nbsp;<span class="ident" id="4652035">src</span><span class="op" id="4652038">,</span>&nbsp;<span class="builtintype" id="4652040">true</span><span class="op" id="4652044">)</span><br>
<span class="lineno"></span><span class="op" id="4652046">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4652049">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="4652073">func</span>&nbsp;<span class="ident" id="4652078">feistel</span><span class="op" id="4652085">(</span><span class="ident" id="4652086">right</span>&nbsp;<span class="builtintype" id="4652092">uint32</span><span class="op" id="4652098">,</span>&nbsp;<span class="ident" id="4652100">key</span>&nbsp;<span class="ident" id="4652104">uint64</span><span class="op" id="4652110">)</span>&nbsp;<span class="op" id="4652112">(</span><span class="ident" id="4652113">result</span>&nbsp;<span class="builtintype" id="4652120">uint32</span><span class="op" id="4652126">)</span>&nbsp;<span class="op" id="4652128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652131">sBoxLocations</span>&nbsp;<span class="op" id="4652145">:=</span>&nbsp;<span class="ident" id="4652148">key</span>&nbsp;<span class="op" id="4652152">^</span>&nbsp;<span class="ident" id="4652154">expandBlock</span><span class="op" id="4652165">(</span><span class="ident" id="4652166">right</span><span class="op" id="4652171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4652174">var</span>&nbsp;<span class="ident" id="4652178">sBoxResult</span>&nbsp;<span class="builtintype" id="4652189">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4652197">for</span>&nbsp;<span class="ident" id="4652201">i</span>&nbsp;<span class="op" id="4652203">:=</span>&nbsp;<span class="builtintype" id="4652206">uint8</span><span class="op" id="4652211">(</span><span class="num" id="4652212">0</span><span class="op" id="4652213">)</span><span class="op" id="4652214">;</span>&nbsp;<span class="ident" id="4652216">i</span>&nbsp;<span class="op" id="4652218">&lt;</span>&nbsp;<span class="num" id="4652220">8</span><span class="op" id="4652221">;</span>&nbsp;<span class="ident" id="4652223">i</span><span class="op" id="4652224">++</span>&nbsp;<span class="op" id="4652227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652231">sBoxLocation</span>&nbsp;<span class="op" id="4652244">:=</span>&nbsp;<span class="builtintype" id="4652247">uint8</span><span class="op" id="4652252">(</span><span class="ident" id="4652253">sBoxLocations</span><span class="op" id="4652266">&gt;&gt;</span><span class="num" id="4652268">42</span><span class="op" id="4652270">)</span>&nbsp;<span class="op" id="4652272">&amp;</span>&nbsp;<span class="num" id="4652274">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652281">sBoxLocations</span>&nbsp;<span class="op" id="4652295">&lt;&lt;=</span>&nbsp;<span class="num" id="4652299">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4652303">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4652342">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652374">row</span>&nbsp;<span class="op" id="4652378">:=</span>&nbsp;<span class="op" id="4652381">(</span><span class="ident" id="4652382">sBoxLocation</span>&nbsp;<span class="op" id="4652395">&amp;</span>&nbsp;<span class="num" id="4652397">0x1</span><span class="op" id="4652400">)</span>&nbsp;<span class="op" id="4652402">|</span>&nbsp;<span class="op" id="4652404">(</span><span class="op" id="4652405">(</span><span class="ident" id="4652406">sBoxLocation</span>&nbsp;<span class="op" id="4652419">&amp;</span>&nbsp;<span class="num" id="4652421">0x20</span><span class="op" id="4652425">)</span>&nbsp;<span class="op" id="4652427">&gt;&gt;</span>&nbsp;<span class="num" id="4652430">4</span><span class="op" id="4652431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652435">column</span>&nbsp;<span class="op" id="4652442">:=</span>&nbsp;<span class="op" id="4652445">(</span><span class="ident" id="4652446">sBoxLocation</span>&nbsp;<span class="op" id="4652459">&gt;&gt;</span>&nbsp;<span class="num" id="4652462">1</span><span class="op" id="4652463">)</span>&nbsp;<span class="op" id="4652465">&amp;</span>&nbsp;<span class="num" id="4652467">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652473">sBoxResult</span>&nbsp;<span class="op" id="4652484">^=</span>&nbsp;<span class="ident" id="4652487">feistelBox</span><span class="op" id="4652497">[</span><span class="ident" id="4652498">i</span><span class="op" id="4652499">]</span><span class="op" id="4652500">[</span><span class="num" id="4652501">16</span><span class="op" id="4652503">*</span><span class="ident" id="4652504">row</span><span class="op" id="4652507">+</span><span class="ident" id="4652508">column</span><span class="op" id="4652514">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4652517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4652520">return</span>&nbsp;<span class="ident" id="4652527">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="4652538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4652541">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="4652609">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="4652643">var</span>&nbsp;<span class="ident" id="4652647">feistelBox</span>&nbsp;<span class="op" id="4652658">[</span><span class="num" id="4652659">8</span><span class="op" id="4652660">]</span><span class="op" id="4652661">[</span><span class="num" id="4652662">64</span><span class="op" id="4652664">]</span><span class="builtintype" id="4652665">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4652673">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="4652735">func</span>&nbsp;<span class="ident" id="4652740">permuteBlock</span><span class="op" id="4652752">(</span><span class="ident" id="4652753">src</span>&nbsp;<span class="ident" id="4652757">uint64</span><span class="op" id="4652763">,</span>&nbsp;<span class="ident" id="4652765">permutation</span>&nbsp;<span class="op" id="4652777">[</span><span class="op" id="4652778">]</span><span class="builtintype" id="4652779">uint8</span><span class="op" id="4652784">)</span>&nbsp;<span class="op" id="4652786">(</span><span class="ident" id="4652787">block</span>&nbsp;<span class="ident" id="4652793">uint64</span><span class="op" id="4652799">)</span>&nbsp;<span class="op" id="4652801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4652804">for</span>&nbsp;<span class="ident" id="4652808">position</span><span class="op" id="4652816">,</span>&nbsp;<span class="ident" id="4652818">n</span>&nbsp;<span class="op" id="4652820">:=</span>&nbsp;<span class="keyword" id="4652823">range</span>&nbsp;<span class="ident" id="4652829">permutation</span>&nbsp;<span class="op" id="4652841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652845">bit</span>&nbsp;<span class="op" id="4652849">:=</span>&nbsp;<span class="op" id="4652852">(</span><span class="ident" id="4652853">src</span>&nbsp;<span class="op" id="4652857">&gt;&gt;</span>&nbsp;<span class="ident" id="4652860">n</span><span class="op" id="4652861">)</span>&nbsp;<span class="op" id="4652863">&amp;</span>&nbsp;<span class="num" id="4652865">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4652869">block</span>&nbsp;<span class="op" id="4652875">|=</span>&nbsp;<span class="ident" id="4652878">bit</span>&nbsp;<span class="op" id="4652882">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4652885">uint</span><span class="op" id="4652889">(</span><span class="op" id="4652890">(</span><span class="builtinfunc" id="4652891">len</span><span class="op" id="4652894">(</span><span class="ident" id="4652895">permutation</span><span class="op" id="4652906">)</span><span class="op" id="4652907">-</span><span class="num" id="4652908">1</span><span class="op" id="4652909">)</span><span class="op" id="4652910">-</span><span class="ident" id="4652911">position</span><span class="op" id="4652919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4652922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4652925">return</span><br>
<span class="lineno"></span><span class="op" id="4652932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4652935">func</span>&nbsp;<span class="ident" id="4652940">init</span><span class="op" id="4652944">(</span><span class="op" id="4652945">)</span>&nbsp;<span class="op" id="4652947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4652950">for</span>&nbsp;<span class="ident" id="4652954">s</span>&nbsp;<span class="op" id="4652956">:=</span>&nbsp;<span class="keyword" id="4652959">range</span>&nbsp;<span class="ident" id="4652965">sBoxes</span>&nbsp;<span class="op" id="4652972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4652976">for</span>&nbsp;<span class="ident" id="4652980">i</span>&nbsp;<span class="op" id="4652982">:=</span>&nbsp;<span class="num" id="4652985">0</span><span class="op" id="4652986">;</span>&nbsp;<span class="ident" id="4652988">i</span>&nbsp;<span class="op" id="4652990">&lt;</span>&nbsp;<span class="num" id="4652992">4</span><span class="op" id="4652993">;</span>&nbsp;<span class="ident" id="4652995">i</span><span class="op" id="4652996">++</span>&nbsp;<span class="op" id="4652999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4653004">for</span>&nbsp;<span class="ident" id="4653008">j</span>&nbsp;<span class="op" id="4653010">:=</span>&nbsp;<span class="num" id="4653013">0</span><span class="op" id="4653014">;</span>&nbsp;<span class="ident" id="4653016">j</span>&nbsp;<span class="op" id="4653018">&lt;</span>&nbsp;<span class="num" id="4653020">16</span><span class="op" id="4653022">;</span>&nbsp;<span class="ident" id="4653024">j</span><span class="op" id="4653025">++</span>&nbsp;<span class="op" id="4653028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653034">f</span>&nbsp;<span class="op" id="4653036">:=</span>&nbsp;<span class="ident" id="4653039">uint64</span><span class="op" id="4653045">(</span><span class="ident" id="4653046">sBoxes</span><span class="op" id="4653052">[</span><span class="ident" id="4653053">s</span><span class="op" id="4653054">]</span><span class="op" id="4653055">[</span><span class="ident" id="4653056">i</span><span class="op" id="4653057">]</span><span class="op" id="4653058">[</span><span class="ident" id="4653059">j</span><span class="op" id="4653060">]</span><span class="op" id="4653061">)</span>&nbsp;<span class="op" id="4653063">&lt;&lt;</span>&nbsp;<span class="op" id="4653066">(</span><span class="num" id="4653067">4</span>&nbsp;<span class="op" id="4653069">*</span>&nbsp;<span class="op" id="4653071">(</span><span class="num" id="4653072">7</span>&nbsp;<span class="op" id="4653074">-</span>&nbsp;<span class="builtintype" id="4653076">uint</span><span class="op" id="4653080">(</span><span class="ident" id="4653081">s</span><span class="op" id="4653082">)</span><span class="op" id="4653083">)</span><span class="op" id="4653084">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653090">f</span>&nbsp;<span class="op" id="4653092">=</span>&nbsp;<span class="ident" id="4653094">permuteBlock</span><span class="op" id="4653106">(</span><span class="ident" id="4653107">uint64</span><span class="op" id="4653113">(</span><span class="ident" id="4653114">f</span><span class="op" id="4653115">)</span><span class="op" id="4653116">,</span>&nbsp;<span class="ident" id="4653118">permutationFunction</span><span class="op" id="4653137">[</span><span class="op" id="4653138">:</span><span class="op" id="4653139">]</span><span class="op" id="4653140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653146">feistelBox</span><span class="op" id="4653156">[</span><span class="ident" id="4653157">s</span><span class="op" id="4653158">]</span><span class="op" id="4653159">[</span><span class="num" id="4653160">16</span><span class="op" id="4653162">*</span><span class="ident" id="4653163">i</span><span class="op" id="4653164">+</span><span class="ident" id="4653165">j</span><span class="op" id="4653166">]</span>&nbsp;<span class="op" id="4653168">=</span>&nbsp;<span class="builtintype" id="4653170">uint32</span><span class="op" id="4653176">(</span><span class="ident" id="4653177">f</span><span class="op" id="4653178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653190">}</span><br>
<span class="lineno">80</span><span class="op" id="4653192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4653195">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4653245">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4653286">func</span>&nbsp;<span class="ident" id="4653291">expandBlock</span><span class="op" id="4653302">(</span><span class="ident" id="4653303">src</span>&nbsp;<span class="builtintype" id="4653307">uint32</span><span class="op" id="4653313">)</span>&nbsp;<span class="op" id="4653315">(</span><span class="ident" id="4653316">block</span>&nbsp;<span class="ident" id="4653322">uint64</span><span class="op" id="4653328">)</span>&nbsp;<span class="op" id="4653330">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4653333">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653377">src</span>&nbsp;<span class="op" id="4653381">=</span>&nbsp;<span class="op" id="4653383">(</span><span class="ident" id="4653384">src</span>&nbsp;<span class="op" id="4653388">&lt;&lt;</span>&nbsp;<span class="num" id="4653391">5</span><span class="op" id="4653392">)</span>&nbsp;<span class="op" id="4653394">|</span>&nbsp;<span class="op" id="4653396">(</span><span class="ident" id="4653397">src</span>&nbsp;<span class="op" id="4653401">&gt;&gt;</span>&nbsp;<span class="num" id="4653404">27</span><span class="op" id="4653406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4653409">for</span>&nbsp;<span class="ident" id="4653413">i</span>&nbsp;<span class="op" id="4653415">:=</span>&nbsp;<span class="num" id="4653418">0</span><span class="op" id="4653419">;</span>&nbsp;<span class="ident" id="4653421">i</span>&nbsp;<span class="op" id="4653423">&lt;</span>&nbsp;<span class="num" id="4653425">8</span><span class="op" id="4653426">;</span>&nbsp;<span class="ident" id="4653428">i</span><span class="op" id="4653429">++</span>&nbsp;<span class="op" id="4653432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653436">block</span>&nbsp;<span class="op" id="4653442">&lt;&lt;=</span>&nbsp;<span class="num" id="4653446">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4653450">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653484">block</span>&nbsp;<span class="op" id="4653490">|=</span>&nbsp;<span class="ident" id="4653493">uint64</span><span class="op" id="4653499">(</span><span class="ident" id="4653500">src</span><span class="op" id="4653503">)</span>&nbsp;<span class="op" id="4653505">&amp;</span>&nbsp;<span class="op" id="4653507">(</span><span class="num" id="4653508">1</span><span class="op" id="4653509">&lt;&lt;</span><span class="num" id="4653511">6</span>&nbsp;<span class="op" id="4653513">-</span>&nbsp;<span class="num" id="4653515">1</span><span class="op" id="4653516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4653520">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653544">src</span>&nbsp;<span class="op" id="4653548">=</span>&nbsp;<span class="op" id="4653550">(</span><span class="ident" id="4653551">src</span>&nbsp;<span class="op" id="4653555">&lt;&lt;</span>&nbsp;<span class="num" id="4653558">4</span><span class="op" id="4653559">)</span>&nbsp;<span class="op" id="4653561">|</span>&nbsp;<span class="op" id="4653563">(</span><span class="ident" id="4653564">src</span>&nbsp;<span class="op" id="4653568">&gt;&gt;</span>&nbsp;<span class="num" id="4653571">28</span><span class="op" id="4653573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4653576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4653579">return</span><br>
<span class="lineno">95</span><span class="op" id="4653586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4653589">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4653653">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4653679">func</span>&nbsp;<span class="ident" id="4653684">permuteInitialBlock</span><span class="op" id="4653703">(</span><span class="ident" id="4653704">block</span>&nbsp;<span class="ident" id="4653710">uint64</span><span class="op" id="4653716">)</span>&nbsp;<span class="ident" id="4653718">uint64</span>&nbsp;<span class="op" id="4653725">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4653728">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653774">b1</span>&nbsp;<span class="op" id="4653777">:=</span>&nbsp;<span class="ident" id="4653780">block</span>&nbsp;<span class="op" id="4653786">&gt;&gt;</span>&nbsp;<span class="num" id="4653789">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653793">b2</span>&nbsp;<span class="op" id="4653796">:=</span>&nbsp;<span class="ident" id="4653799">block</span>&nbsp;<span class="op" id="4653805">&lt;&lt;</span>&nbsp;<span class="num" id="4653808">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653812">block</span>&nbsp;<span class="op" id="4653818">^=</span>&nbsp;<span class="ident" id="4653821">b1</span>&nbsp;<span class="op" id="4653824">^</span>&nbsp;<span class="ident" id="4653826">b2</span>&nbsp;<span class="op" id="4653829">^</span>&nbsp;<span class="ident" id="4653831">b1</span><span class="op" id="4653833">&lt;&lt;</span><span class="num" id="4653835">48</span>&nbsp;<span class="op" id="4653838">^</span>&nbsp;<span class="ident" id="4653840">b2</span><span class="op" id="4653842">&gt;&gt;</span><span class="num" id="4653844">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4653849">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653885">b1</span>&nbsp;<span class="op" id="4653888">=</span>&nbsp;<span class="ident" id="4653890">block</span>&nbsp;<span class="op" id="4653896">&gt;&gt;</span>&nbsp;<span class="num" id="4653899">32</span>&nbsp;<span class="op" id="4653902">&amp;</span>&nbsp;<span class="num" id="4653904">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653914">b2</span>&nbsp;<span class="op" id="4653917">=</span>&nbsp;<span class="op" id="4653919">(</span><span class="ident" id="4653920">block</span>&nbsp;<span class="op" id="4653926">&amp;</span>&nbsp;<span class="num" id="4653928">0xff00ff00</span><span class="op" id="4653938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4653941">block</span>&nbsp;<span class="op" id="4653947">^=</span>&nbsp;<span class="ident" id="4653950">b1</span><span class="op" id="4653952">&lt;&lt;</span><span class="num" id="4653954">32</span>&nbsp;<span class="op" id="4653957">^</span>&nbsp;<span class="ident" id="4653959">b2</span>&nbsp;<span class="op" id="4653962">^</span>&nbsp;<span class="ident" id="4653964">b1</span><span class="op" id="4653966">&lt;&lt;</span><span class="num" id="4653968">8</span>&nbsp;<span class="op" id="4653970">^</span>&nbsp;<span class="ident" id="4653972">b2</span><span class="op" id="4653974">&lt;&lt;</span><span class="num" id="4653976">24</span>&nbsp;<span class="comment" id="4653979">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654010">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654069">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654097">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654181">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654209">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654237">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654294">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654337">b1</span>&nbsp;<span class="op" id="4654340">=</span>&nbsp;<span class="ident" id="4654342">block</span>&nbsp;<span class="op" id="4654348">&amp;</span>&nbsp;<span class="num" id="4654350">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654370">b2</span>&nbsp;<span class="op" id="4654373">=</span>&nbsp;<span class="ident" id="4654375">block</span>&nbsp;<span class="op" id="4654381">&amp;</span>&nbsp;<span class="num" id="4654383">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654403">block</span>&nbsp;<span class="op" id="4654409">^=</span>&nbsp;<span class="ident" id="4654412">b1</span>&nbsp;<span class="op" id="4654415">^</span>&nbsp;<span class="ident" id="4654417">b2</span>&nbsp;<span class="op" id="4654420">^</span>&nbsp;<span class="ident" id="4654422">b1</span><span class="op" id="4654424">&gt;&gt;</span><span class="num" id="4654426">12</span>&nbsp;<span class="op" id="4654429">^</span>&nbsp;<span class="ident" id="4654431">b2</span><span class="op" id="4654433">&lt;&lt;</span><span class="num" id="4654435">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654440">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654470">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654474">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654499">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654503">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654519">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654535">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654551">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654577">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654615">b1</span>&nbsp;<span class="op" id="4654618">=</span>&nbsp;<span class="ident" id="4654620">block</span>&nbsp;<span class="op" id="4654626">&amp;</span>&nbsp;<span class="num" id="4654628">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654648">b2</span>&nbsp;<span class="op" id="4654651">=</span>&nbsp;<span class="ident" id="4654653">block</span>&nbsp;<span class="op" id="4654659">&amp;</span>&nbsp;<span class="num" id="4654661">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654681">block</span>&nbsp;<span class="op" id="4654687">^=</span>&nbsp;<span class="ident" id="4654690">b1</span>&nbsp;<span class="op" id="4654693">^</span>&nbsp;<span class="ident" id="4654695">b2</span>&nbsp;<span class="op" id="4654698">^</span>&nbsp;<span class="ident" id="4654700">b1</span><span class="op" id="4654702">&gt;&gt;</span><span class="num" id="4654704">6</span>&nbsp;<span class="op" id="4654706">^</span>&nbsp;<span class="ident" id="4654708">b2</span><span class="op" id="4654710">&lt;&lt;</span><span class="num" id="4654712">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654716">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654746">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654756">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654766">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654776">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654786">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654796">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654806">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654816">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654845">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654883">b1</span>&nbsp;<span class="op" id="4654886">=</span>&nbsp;<span class="ident" id="4654888">block</span>&nbsp;<span class="op" id="4654894">&amp;</span>&nbsp;<span class="num" id="4654896">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4654916">block</span>&nbsp;<span class="op" id="4654922">^=</span>&nbsp;<span class="ident" id="4654925">b1</span>&nbsp;<span class="op" id="4654928">^</span>&nbsp;<span class="ident" id="4654930">b1</span><span class="op" id="4654932">&gt;&gt;</span><span class="num" id="4654934">33</span>&nbsp;<span class="op" id="4654937">^</span>&nbsp;<span class="ident" id="4654939">b1</span><span class="op" id="4654941">&lt;&lt;</span><span class="num" id="4654943">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654948">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4654978">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655005">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655032">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655059">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655086">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655113">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655140">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655167">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4655194">return</span>&nbsp;<span class="ident" id="4655201">block</span><br>
<span class="lineno"></span><span class="op" id="4655207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4655210">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4655274">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4655298">func</span>&nbsp;<span class="ident" id="4655303">permuteFinalBlock</span><span class="op" id="4655320">(</span><span class="ident" id="4655321">block</span>&nbsp;<span class="ident" id="4655327">uint64</span><span class="op" id="4655333">)</span>&nbsp;<span class="ident" id="4655335">uint64</span>&nbsp;<span class="op" id="4655342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655345">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4655403">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655429">b1</span>&nbsp;<span class="op" id="4655432">:=</span>&nbsp;<span class="ident" id="4655435">block</span>&nbsp;<span class="op" id="4655441">&amp;</span>&nbsp;<span class="num" id="4655443">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655463">block</span>&nbsp;<span class="op" id="4655469">^=</span>&nbsp;<span class="ident" id="4655472">b1</span>&nbsp;<span class="op" id="4655475">^</span>&nbsp;<span class="ident" id="4655477">b1</span><span class="op" id="4655479">&gt;&gt;</span><span class="num" id="4655481">33</span>&nbsp;<span class="op" id="4655484">^</span>&nbsp;<span class="ident" id="4655486">b1</span><span class="op" id="4655488">&lt;&lt;</span><span class="num" id="4655490">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655495">b1</span>&nbsp;<span class="op" id="4655498">=</span>&nbsp;<span class="ident" id="4655500">block</span>&nbsp;<span class="op" id="4655506">&amp;</span>&nbsp;<span class="num" id="4655508">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655528">b2</span>&nbsp;<span class="op" id="4655531">:=</span>&nbsp;<span class="ident" id="4655534">block</span>&nbsp;<span class="op" id="4655540">&amp;</span>&nbsp;<span class="num" id="4655542">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655562">block</span>&nbsp;<span class="op" id="4655568">^=</span>&nbsp;<span class="ident" id="4655571">b1</span>&nbsp;<span class="op" id="4655574">^</span>&nbsp;<span class="ident" id="4655576">b2</span>&nbsp;<span class="op" id="4655579">^</span>&nbsp;<span class="ident" id="4655581">b1</span><span class="op" id="4655583">&gt;&gt;</span><span class="num" id="4655585">6</span>&nbsp;<span class="op" id="4655587">^</span>&nbsp;<span class="ident" id="4655589">b2</span><span class="op" id="4655591">&lt;&lt;</span><span class="num" id="4655593">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655597">b1</span>&nbsp;<span class="op" id="4655600">=</span>&nbsp;<span class="ident" id="4655602">block</span>&nbsp;<span class="op" id="4655608">&amp;</span>&nbsp;<span class="num" id="4655610">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655630">b2</span>&nbsp;<span class="op" id="4655633">=</span>&nbsp;<span class="ident" id="4655635">block</span>&nbsp;<span class="op" id="4655641">&amp;</span>&nbsp;<span class="num" id="4655643">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655663">block</span>&nbsp;<span class="op" id="4655669">^=</span>&nbsp;<span class="ident" id="4655672">b1</span>&nbsp;<span class="op" id="4655675">^</span>&nbsp;<span class="ident" id="4655677">b2</span>&nbsp;<span class="op" id="4655680">^</span>&nbsp;<span class="ident" id="4655682">b1</span><span class="op" id="4655684">&gt;&gt;</span><span class="num" id="4655686">12</span>&nbsp;<span class="op" id="4655689">^</span>&nbsp;<span class="ident" id="4655691">b2</span><span class="op" id="4655693">&lt;&lt;</span><span class="num" id="4655695">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655700">b1</span>&nbsp;<span class="op" id="4655703">=</span>&nbsp;<span class="ident" id="4655705">block</span>&nbsp;<span class="op" id="4655711">&gt;&gt;</span>&nbsp;<span class="num" id="4655714">32</span>&nbsp;<span class="op" id="4655717">&amp;</span>&nbsp;<span class="num" id="4655719">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655729">b2</span>&nbsp;<span class="op" id="4655732">=</span>&nbsp;<span class="op" id="4655734">(</span><span class="ident" id="4655735">block</span>&nbsp;<span class="op" id="4655741">&amp;</span>&nbsp;<span class="num" id="4655743">0xff00ff00</span><span class="op" id="4655753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655756">block</span>&nbsp;<span class="op" id="4655762">^=</span>&nbsp;<span class="ident" id="4655765">b1</span><span class="op" id="4655767">&lt;&lt;</span><span class="num" id="4655769">32</span>&nbsp;<span class="op" id="4655772">^</span>&nbsp;<span class="ident" id="4655774">b2</span>&nbsp;<span class="op" id="4655777">^</span>&nbsp;<span class="ident" id="4655779">b1</span><span class="op" id="4655781">&lt;&lt;</span><span class="num" id="4655783">8</span>&nbsp;<span class="op" id="4655785">^</span>&nbsp;<span class="ident" id="4655787">b2</span><span class="op" id="4655789">&lt;&lt;</span><span class="num" id="4655791">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655796">b1</span>&nbsp;<span class="op" id="4655799">=</span>&nbsp;<span class="ident" id="4655801">block</span>&nbsp;<span class="op" id="4655807">&gt;&gt;</span>&nbsp;<span class="num" id="4655810">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655814">b2</span>&nbsp;<span class="op" id="4655817">=</span>&nbsp;<span class="ident" id="4655819">block</span>&nbsp;<span class="op" id="4655825">&lt;&lt;</span>&nbsp;<span class="num" id="4655828">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4655832">block</span>&nbsp;<span class="op" id="4655838">^=</span>&nbsp;<span class="ident" id="4655841">b1</span>&nbsp;<span class="op" id="4655844">^</span>&nbsp;<span class="ident" id="4655846">b2</span>&nbsp;<span class="op" id="4655849">^</span>&nbsp;<span class="ident" id="4655851">b1</span><span class="op" id="4655853">&lt;&lt;</span><span class="num" id="4655855">48</span>&nbsp;<span class="op" id="4655858">^</span>&nbsp;<span class="ident" id="4655860">b2</span><span class="op" id="4655862">&gt;&gt;</span><span class="num" id="4655864">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4655868">return</span>&nbsp;<span class="ident" id="4655875">block</span><br>
<span class="lineno"></span><span class="op" id="4655881">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4655884">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="4655930">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="4655958">func</span>&nbsp;<span class="ident" id="4655963">ksRotate</span><span class="op" id="4655971">(</span><span class="ident" id="4655972">in</span>&nbsp;<span class="builtintype" id="4655975">uint32</span><span class="op" id="4655981">)</span>&nbsp;<span class="op" id="4655983">(</span><span class="ident" id="4655984">out</span>&nbsp;<span class="op" id="4655988">[</span><span class="op" id="4655989">]</span><span class="builtintype" id="4655990">uint32</span><span class="op" id="4655996">)</span>&nbsp;<span class="op" id="4655998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656001">out</span>&nbsp;<span class="op" id="4656005">=</span>&nbsp;<span class="builtinfunc" id="4656007">make</span><span class="op" id="4656011">(</span><span class="op" id="4656012">[</span><span class="op" id="4656013">]</span><span class="builtintype" id="4656014">uint32</span><span class="op" id="4656020">,</span>&nbsp;<span class="num" id="4656022">16</span><span class="op" id="4656024">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656027">last</span>&nbsp;<span class="op" id="4656032">:=</span>&nbsp;<span class="ident" id="4656035">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4656039">for</span>&nbsp;<span class="ident" id="4656043">i</span>&nbsp;<span class="op" id="4656045">:=</span>&nbsp;<span class="num" id="4656048">0</span><span class="op" id="4656049">;</span>&nbsp;<span class="ident" id="4656051">i</span>&nbsp;<span class="op" id="4656053">&lt;</span>&nbsp;<span class="num" id="4656055">16</span><span class="op" id="4656057">;</span>&nbsp;<span class="ident" id="4656059">i</span><span class="op" id="4656060">++</span>&nbsp;<span class="op" id="4656063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656067">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656099">left</span>&nbsp;<span class="op" id="4656104">:=</span>&nbsp;<span class="op" id="4656107">(</span><span class="ident" id="4656108">last</span>&nbsp;<span class="op" id="4656113">&lt;&lt;</span>&nbsp;<span class="op" id="4656116">(</span><span class="num" id="4656117">4</span>&nbsp;<span class="op" id="4656119">+</span>&nbsp;<span class="ident" id="4656121">ksRotations</span><span class="op" id="4656132">[</span><span class="ident" id="4656133">i</span><span class="op" id="4656134">]</span><span class="op" id="4656135">)</span><span class="op" id="4656136">)</span>&nbsp;<span class="op" id="4656138">&gt;&gt;</span>&nbsp;<span class="num" id="4656141">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656145">right</span>&nbsp;<span class="op" id="4656151">:=</span>&nbsp;<span class="op" id="4656154">(</span><span class="ident" id="4656155">last</span>&nbsp;<span class="op" id="4656160">&lt;&lt;</span>&nbsp;<span class="num" id="4656163">4</span><span class="op" id="4656164">)</span>&nbsp;<span class="op" id="4656166">&gt;&gt;</span>&nbsp;<span class="op" id="4656169">(</span><span class="num" id="4656170">32</span>&nbsp;<span class="op" id="4656173">-</span>&nbsp;<span class="ident" id="4656175">ksRotations</span><span class="op" id="4656186">[</span><span class="ident" id="4656187">i</span><span class="op" id="4656188">]</span><span class="op" id="4656189">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656193">out</span><span class="op" id="4656196">[</span><span class="ident" id="4656197">i</span><span class="op" id="4656198">]</span>&nbsp;<span class="op" id="4656200">=</span>&nbsp;<span class="ident" id="4656202">left</span>&nbsp;<span class="op" id="4656207">|</span>&nbsp;<span class="ident" id="4656209">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656217">last</span>&nbsp;<span class="op" id="4656222">=</span>&nbsp;<span class="ident" id="4656224">out</span><span class="op" id="4656227">[</span><span class="ident" id="4656228">i</span><span class="op" id="4656229">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4656232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4656235">return</span><br>
<span class="lineno"></span><span class="op" id="4656242">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4656245">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4656296">func</span>&nbsp;<span class="op" id="4656301">(</span><span class="ident" id="4656302">c</span>&nbsp;<span class="op" id="4656304">*</span><span class="ident" id="4656305">desCipher</span><span class="op" id="4656314">)</span>&nbsp;<span class="ident" id="4656316">generateSubkeys</span><span class="op" id="4656331">(</span><span class="ident" id="4656332">keyBytes</span>&nbsp;<span class="op" id="4656341">[</span><span class="op" id="4656342">]</span><span class="builtintype" id="4656343">byte</span><span class="op" id="4656347">)</span>&nbsp;<span class="op" id="4656349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656352">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656385">key</span>&nbsp;<span class="op" id="4656389">:=</span>&nbsp;<span class="ident" id="4656392">binary</span><span class="op" id="4656398">.</span><span class="ident" id="4656399">BigEndian</span><span class="op" id="4656408">.</span><span class="ident" id="4656409">Uint64</span><span class="op" id="4656415">(</span><span class="ident" id="4656416">keyBytes</span><span class="op" id="4656424">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656427">permutedKey</span>&nbsp;<span class="op" id="4656439">:=</span>&nbsp;<span class="ident" id="4656442">permuteBlock</span><span class="op" id="4656454">(</span><span class="ident" id="4656455">key</span><span class="op" id="4656458">,</span>&nbsp;<span class="ident" id="4656460">permutedChoice1</span><span class="op" id="4656475">[</span><span class="op" id="4656476">:</span><span class="op" id="4656477">]</span><span class="op" id="4656478">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656482">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656551">leftRotations</span>&nbsp;<span class="op" id="4656565">:=</span>&nbsp;<span class="ident" id="4656568">ksRotate</span><span class="op" id="4656576">(</span><span class="builtintype" id="4656577">uint32</span><span class="op" id="4656583">(</span><span class="ident" id="4656584">permutedKey</span>&nbsp;<span class="op" id="4656596">&gt;&gt;</span>&nbsp;<span class="num" id="4656599">28</span><span class="op" id="4656601">)</span><span class="op" id="4656602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656605">rightRotations</span>&nbsp;<span class="op" id="4656620">:=</span>&nbsp;<span class="ident" id="4656623">ksRotate</span><span class="op" id="4656631">(</span><span class="builtintype" id="4656632">uint32</span><span class="op" id="4656638">(</span><span class="ident" id="4656639">permutedKey</span><span class="op" id="4656650">&lt;&lt;</span><span class="num" id="4656652">4</span><span class="op" id="4656653">)</span>&nbsp;<span class="op" id="4656655">&gt;&gt;</span>&nbsp;<span class="num" id="4656658">4</span><span class="op" id="4656659">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656663">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4656684">for</span>&nbsp;<span class="ident" id="4656688">i</span>&nbsp;<span class="op" id="4656690">:=</span>&nbsp;<span class="num" id="4656693">0</span><span class="op" id="4656694">;</span>&nbsp;<span class="ident" id="4656696">i</span>&nbsp;<span class="op" id="4656698">&lt;</span>&nbsp;<span class="num" id="4656700">16</span><span class="op" id="4656702">;</span>&nbsp;<span class="ident" id="4656704">i</span><span class="op" id="4656705">++</span>&nbsp;<span class="op" id="4656708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656712">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656760">pc2Input</span>&nbsp;<span class="op" id="4656769">:=</span>&nbsp;<span class="ident" id="4656772">uint64</span><span class="op" id="4656778">(</span><span class="ident" id="4656779">leftRotations</span><span class="op" id="4656792">[</span><span class="ident" id="4656793">i</span><span class="op" id="4656794">]</span><span class="op" id="4656795">)</span><span class="op" id="4656796">&lt;&lt;</span><span class="num" id="4656798">28</span>&nbsp;<span class="op" id="4656801">|</span>&nbsp;<span class="ident" id="4656803">uint64</span><span class="op" id="4656809">(</span><span class="ident" id="4656810">rightRotations</span><span class="op" id="4656824">[</span><span class="ident" id="4656825">i</span><span class="op" id="4656826">]</span><span class="op" id="4656827">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4656831">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4656874">c</span><span class="op" id="4656875">.</span><span class="ident" id="4656876">subkeys</span><span class="op" id="4656883">[</span><span class="ident" id="4656884">i</span><span class="op" id="4656885">]</span>&nbsp;<span class="op" id="4656887">=</span>&nbsp;<span class="ident" id="4656889">permuteBlock</span><span class="op" id="4656901">(</span><span class="ident" id="4656902">pc2Input</span><span class="op" id="4656910">,</span>&nbsp;<span class="ident" id="4656912">permutedChoice2</span><span class="op" id="4656927">[</span><span class="op" id="4656928">:</span><span class="op" id="4656929">]</span><span class="op" id="4656930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4656933">}</span><br>
<span class="lineno"></span><span class="op" id="4656935">}</span>
</div>
</body>
</html>
