<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html" class="current">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4629762">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4629817">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4629871">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4629922">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4630000">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4630018">package</span>&nbsp;<span class="ident" id="4630026">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4630034">import</span>&nbsp;<span class="op" id="4630041">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4630044">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4630054">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4630061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4630064">func</span>&nbsp;<span class="ident" id="4630069">init</span><span class="op" id="4630073">(</span><span class="op" id="4630074">)</span>&nbsp;<span class="op" id="4630076">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630079">crypto</span><span class="op" id="4630085">.</span><span class="ident" id="4630086">RegisterHash</span><span class="op" id="4630098">(</span><span class="ident" id="4630099">crypto</span><span class="op" id="4630105">.</span><span class="ident" id="4630106">SHA384</span><span class="op" id="4630112">,</span>&nbsp;<span class="ident" id="4630114">New384</span><span class="op" id="4630120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630123">crypto</span><span class="op" id="4630129">.</span><span class="ident" id="4630130">RegisterHash</span><span class="op" id="4630142">(</span><span class="ident" id="4630143">crypto</span><span class="op" id="4630149">.</span><span class="ident" id="4630150">SHA512</span><span class="op" id="4630156">,</span>&nbsp;<span class="ident" id="4630158">New</span><span class="op" id="4630161">)</span><br>
<span class="lineno"></span><span class="op" id="4630163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4630166">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4630209">const</span>&nbsp;<span class="ident" id="4630215">Size</span>&nbsp;<span class="op" id="4630220">=</span>&nbsp;<span class="num" id="4630222">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4630226">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4630269">const</span>&nbsp;<span class="ident" id="4630275">Size384</span>&nbsp;<span class="op" id="4630283">=</span>&nbsp;<span class="num" id="4630285">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4630289">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4630337">const</span>&nbsp;<span class="ident" id="4630343">BlockSize</span>&nbsp;<span class="op" id="4630353">=</span>&nbsp;<span class="num" id="4630355">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4630360">const</span>&nbsp;<span class="op" id="4630366">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630369">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630379">=</span>&nbsp;<span class="num" id="4630381">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630386">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630396">=</span>&nbsp;<span class="num" id="4630398">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630418">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630428">=</span>&nbsp;<span class="num" id="4630430">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630450">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630460">=</span>&nbsp;<span class="num" id="4630462">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630482">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630492">=</span>&nbsp;<span class="num" id="4630494">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630514">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630524">=</span>&nbsp;<span class="num" id="4630526">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630546">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630556">=</span>&nbsp;<span class="num" id="4630558">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630578">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630588">=</span>&nbsp;<span class="num" id="4630590">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630610">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630620">=</span>&nbsp;<span class="num" id="4630622">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630642">init0_384</span>&nbsp;<span class="op" id="4630652">=</span>&nbsp;<span class="num" id="4630654">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630674">init1_384</span>&nbsp;<span class="op" id="4630684">=</span>&nbsp;<span class="num" id="4630686">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630706">init2_384</span>&nbsp;<span class="op" id="4630716">=</span>&nbsp;<span class="num" id="4630718">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630738">init3_384</span>&nbsp;<span class="op" id="4630748">=</span>&nbsp;<span class="num" id="4630750">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630770">init4_384</span>&nbsp;<span class="op" id="4630780">=</span>&nbsp;<span class="num" id="4630782">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630802">init5_384</span>&nbsp;<span class="op" id="4630812">=</span>&nbsp;<span class="num" id="4630814">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630834">init6_384</span>&nbsp;<span class="op" id="4630844">=</span>&nbsp;<span class="num" id="4630846">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630866">init7_384</span>&nbsp;<span class="op" id="4630876">=</span>&nbsp;<span class="num" id="4630878">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4630897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4630900">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4630959">type</span>&nbsp;<span class="ident" id="4630964">digest</span>&nbsp;<span class="keyword" id="4630971">struct</span>&nbsp;<span class="op" id="4630978">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630981">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630987">[</span><span class="num" id="4630988">8</span><span class="op" id="4630989">]</span><span class="builtintype" id="4630990">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630998">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631004">[</span><span class="ident" id="4631005">chunk</span><span class="op" id="4631010">]</span><span class="builtintype" id="4631011">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631017">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4631023">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4631028">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4631034">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631042">is384</span>&nbsp;<span class="builtintype" id="4631048">bool</span>&nbsp;<span class="comment" id="4631053">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4631087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4631090">func</span>&nbsp;<span class="op" id="4631095">(</span><span class="ident" id="4631096">d</span>&nbsp;<span class="op" id="4631098">*</span><span class="ident" id="4631099">digest</span><span class="op" id="4631105">)</span>&nbsp;<span class="ident" id="4631107">Reset</span><span class="op" id="4631112">(</span><span class="op" id="4631113">)</span>&nbsp;<span class="op" id="4631115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631118">if</span>&nbsp;<span class="op" id="4631121">!</span><span class="ident" id="4631122">d</span><span class="op" id="4631123">.</span><span class="ident" id="4631124">is384</span>&nbsp;<span class="op" id="4631130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631134">d</span><span class="op" id="4631135">.</span><span class="ident" id="4631136">h</span><span class="op" id="4631137">[</span><span class="num" id="4631138">0</span><span class="op" id="4631139">]</span>&nbsp;<span class="op" id="4631141">=</span>&nbsp;<span class="ident" id="4631143">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631151">d</span><span class="op" id="4631152">.</span><span class="ident" id="4631153">h</span><span class="op" id="4631154">[</span><span class="num" id="4631155">1</span><span class="op" id="4631156">]</span>&nbsp;<span class="op" id="4631158">=</span>&nbsp;<span class="ident" id="4631160">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631168">d</span><span class="op" id="4631169">.</span><span class="ident" id="4631170">h</span><span class="op" id="4631171">[</span><span class="num" id="4631172">2</span><span class="op" id="4631173">]</span>&nbsp;<span class="op" id="4631175">=</span>&nbsp;<span class="ident" id="4631177">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631185">d</span><span class="op" id="4631186">.</span><span class="ident" id="4631187">h</span><span class="op" id="4631188">[</span><span class="num" id="4631189">3</span><span class="op" id="4631190">]</span>&nbsp;<span class="op" id="4631192">=</span>&nbsp;<span class="ident" id="4631194">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631202">d</span><span class="op" id="4631203">.</span><span class="ident" id="4631204">h</span><span class="op" id="4631205">[</span><span class="num" id="4631206">4</span><span class="op" id="4631207">]</span>&nbsp;<span class="op" id="4631209">=</span>&nbsp;<span class="ident" id="4631211">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631219">d</span><span class="op" id="4631220">.</span><span class="ident" id="4631221">h</span><span class="op" id="4631222">[</span><span class="num" id="4631223">5</span><span class="op" id="4631224">]</span>&nbsp;<span class="op" id="4631226">=</span>&nbsp;<span class="ident" id="4631228">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631236">d</span><span class="op" id="4631237">.</span><span class="ident" id="4631238">h</span><span class="op" id="4631239">[</span><span class="num" id="4631240">6</span><span class="op" id="4631241">]</span>&nbsp;<span class="op" id="4631243">=</span>&nbsp;<span class="ident" id="4631245">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631253">d</span><span class="op" id="4631254">.</span><span class="ident" id="4631255">h</span><span class="op" id="4631256">[</span><span class="num" id="4631257">7</span><span class="op" id="4631258">]</span>&nbsp;<span class="op" id="4631260">=</span>&nbsp;<span class="ident" id="4631262">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631269">}</span>&nbsp;<span class="keyword" id="4631271">else</span>&nbsp;<span class="op" id="4631276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631280">d</span><span class="op" id="4631281">.</span><span class="ident" id="4631282">h</span><span class="op" id="4631283">[</span><span class="num" id="4631284">0</span><span class="op" id="4631285">]</span>&nbsp;<span class="op" id="4631287">=</span>&nbsp;<span class="ident" id="4631289">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631301">d</span><span class="op" id="4631302">.</span><span class="ident" id="4631303">h</span><span class="op" id="4631304">[</span><span class="num" id="4631305">1</span><span class="op" id="4631306">]</span>&nbsp;<span class="op" id="4631308">=</span>&nbsp;<span class="ident" id="4631310">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631322">d</span><span class="op" id="4631323">.</span><span class="ident" id="4631324">h</span><span class="op" id="4631325">[</span><span class="num" id="4631326">2</span><span class="op" id="4631327">]</span>&nbsp;<span class="op" id="4631329">=</span>&nbsp;<span class="ident" id="4631331">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631343">d</span><span class="op" id="4631344">.</span><span class="ident" id="4631345">h</span><span class="op" id="4631346">[</span><span class="num" id="4631347">3</span><span class="op" id="4631348">]</span>&nbsp;<span class="op" id="4631350">=</span>&nbsp;<span class="ident" id="4631352">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631364">d</span><span class="op" id="4631365">.</span><span class="ident" id="4631366">h</span><span class="op" id="4631367">[</span><span class="num" id="4631368">4</span><span class="op" id="4631369">]</span>&nbsp;<span class="op" id="4631371">=</span>&nbsp;<span class="ident" id="4631373">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631385">d</span><span class="op" id="4631386">.</span><span class="ident" id="4631387">h</span><span class="op" id="4631388">[</span><span class="num" id="4631389">5</span><span class="op" id="4631390">]</span>&nbsp;<span class="op" id="4631392">=</span>&nbsp;<span class="ident" id="4631394">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631406">d</span><span class="op" id="4631407">.</span><span class="ident" id="4631408">h</span><span class="op" id="4631409">[</span><span class="num" id="4631410">6</span><span class="op" id="4631411">]</span>&nbsp;<span class="op" id="4631413">=</span>&nbsp;<span class="ident" id="4631415">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631427">d</span><span class="op" id="4631428">.</span><span class="ident" id="4631429">h</span><span class="op" id="4631430">[</span><span class="num" id="4631431">7</span><span class="op" id="4631432">]</span>&nbsp;<span class="op" id="4631434">=</span>&nbsp;<span class="ident" id="4631436">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631450">d</span><span class="op" id="4631451">.</span><span class="ident" id="4631452">nx</span>&nbsp;<span class="op" id="4631455">=</span>&nbsp;<span class="num" id="4631457">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631460">d</span><span class="op" id="4631461">.</span><span class="builtinfunc" id="4631462">len</span>&nbsp;<span class="op" id="4631466">=</span>&nbsp;<span class="num" id="4631468">0</span><br>
<span class="lineno"></span><span class="op" id="4631470">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4631473">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4631535">func</span>&nbsp;<span class="ident" id="4631540">New</span><span class="op" id="4631543">(</span><span class="op" id="4631544">)</span>&nbsp;<span class="ident" id="4631546">hash</span><span class="op" id="4631550">.</span><span class="ident" id="4631551">Hash</span>&nbsp;<span class="op" id="4631556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631559">d</span>&nbsp;<span class="op" id="4631561">:=</span>&nbsp;<span class="builtinfunc" id="4631564">new</span><span class="op" id="4631567">(</span><span class="ident" id="4631568">digest</span><span class="op" id="4631574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631577">d</span><span class="op" id="4631578">.</span><span class="ident" id="4631579">Reset</span><span class="op" id="4631584">(</span><span class="op" id="4631585">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631588">return</span>&nbsp;<span class="ident" id="4631595">d</span><br>
<span class="lineno"></span><span class="op" id="4631597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4631600">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4631665">func</span>&nbsp;<span class="ident" id="4631670">New384</span><span class="op" id="4631676">(</span><span class="op" id="4631677">)</span>&nbsp;<span class="ident" id="4631679">hash</span><span class="op" id="4631683">.</span><span class="ident" id="4631684">Hash</span>&nbsp;<span class="op" id="4631689">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631692">d</span>&nbsp;<span class="op" id="4631694">:=</span>&nbsp;<span class="builtinfunc" id="4631697">new</span><span class="op" id="4631700">(</span><span class="ident" id="4631701">digest</span><span class="op" id="4631707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631710">d</span><span class="op" id="4631711">.</span><span class="ident" id="4631712">is384</span>&nbsp;<span class="op" id="4631718">=</span>&nbsp;<span class="builtintype" id="4631720">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631726">d</span><span class="op" id="4631727">.</span><span class="ident" id="4631728">Reset</span><span class="op" id="4631733">(</span><span class="op" id="4631734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631737">return</span>&nbsp;<span class="ident" id="4631744">d</span><br>
<span class="lineno"></span><span class="op" id="4631746">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4631749">func</span>&nbsp;<span class="op" id="4631754">(</span><span class="ident" id="4631755">d</span>&nbsp;<span class="op" id="4631757">*</span><span class="ident" id="4631758">digest</span><span class="op" id="4631764">)</span>&nbsp;<span class="ident" id="4631766">Size</span><span class="op" id="4631770">(</span><span class="op" id="4631771">)</span>&nbsp;<span class="builtintype" id="4631773">int</span>&nbsp;<span class="op" id="4631777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631780">if</span>&nbsp;<span class="op" id="4631783">!</span><span class="ident" id="4631784">d</span><span class="op" id="4631785">.</span><span class="ident" id="4631786">is384</span>&nbsp;<span class="op" id="4631792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631796">return</span>&nbsp;<span class="ident" id="4631803">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4631809">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631812">return</span>&nbsp;<span class="ident" id="4631819">Size384</span><br>
<span class="lineno"></span><span class="op" id="4631827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4631830">func</span>&nbsp;<span class="op" id="4631835">(</span><span class="ident" id="4631836">d</span>&nbsp;<span class="op" id="4631838">*</span><span class="ident" id="4631839">digest</span><span class="op" id="4631845">)</span>&nbsp;<span class="ident" id="4631847">BlockSize</span><span class="op" id="4631856">(</span><span class="op" id="4631857">)</span>&nbsp;<span class="builtintype" id="4631859">int</span>&nbsp;<span class="op" id="4631863">{</span>&nbsp;<span class="keyword" id="4631865">return</span>&nbsp;<span class="ident" id="4631872">BlockSize</span>&nbsp;<span class="op" id="4631882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4631885">func</span>&nbsp;<span class="op" id="4631890">(</span><span class="ident" id="4631891">d</span>&nbsp;<span class="op" id="4631893">*</span><span class="ident" id="4631894">digest</span><span class="op" id="4631900">)</span>&nbsp;<span class="ident" id="4631902">Write</span><span class="op" id="4631907">(</span><span class="ident" id="4631908">p</span>&nbsp;<span class="op" id="4631910">[</span><span class="op" id="4631911">]</span><span class="builtintype" id="4631912">byte</span><span class="op" id="4631916">)</span>&nbsp;<span class="op" id="4631918">(</span><span class="ident" id="4631919">nn</span>&nbsp;<span class="builtintype" id="4631922">int</span><span class="op" id="4631925">,</span>&nbsp;<span class="ident" id="4631927">err</span>&nbsp;<span class="builtintype" id="4631931">error</span><span class="op" id="4631936">)</span>&nbsp;<span class="op" id="4631938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631941">nn</span>&nbsp;<span class="op" id="4631944">=</span>&nbsp;<span class="builtinfunc" id="4631946">len</span><span class="op" id="4631949">(</span><span class="ident" id="4631950">p</span><span class="op" id="4631951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631954">d</span><span class="op" id="4631955">.</span><span class="builtinfunc" id="4631956">len</span>&nbsp;<span class="op" id="4631960">+=</span>&nbsp;<span class="builtintype" id="4631963">uint64</span><span class="op" id="4631969">(</span><span class="ident" id="4631970">nn</span><span class="op" id="4631972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4631975">if</span>&nbsp;<span class="ident" id="4631978">d</span><span class="op" id="4631979">.</span><span class="ident" id="4631980">nx</span>&nbsp;<span class="op" id="4631983">&gt;</span>&nbsp;<span class="num" id="4631985">0</span>&nbsp;<span class="op" id="4631987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4631991">n</span>&nbsp;<span class="op" id="4631993">:=</span>&nbsp;<span class="builtinfunc" id="4631996">copy</span><span class="op" id="4632000">(</span><span class="ident" id="4632001">d</span><span class="op" id="4632002">.</span><span class="ident" id="4632003">x</span><span class="op" id="4632004">[</span><span class="ident" id="4632005">d</span><span class="op" id="4632006">.</span><span class="ident" id="4632007">nx</span><span class="op" id="4632009">:</span><span class="op" id="4632010">]</span><span class="op" id="4632011">,</span>&nbsp;<span class="ident" id="4632013">p</span><span class="op" id="4632014">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632018">d</span><span class="op" id="4632019">.</span><span class="ident" id="4632020">nx</span>&nbsp;<span class="op" id="4632023">+=</span>&nbsp;<span class="ident" id="4632026">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632030">if</span>&nbsp;<span class="ident" id="4632033">d</span><span class="op" id="4632034">.</span><span class="ident" id="4632035">nx</span>&nbsp;<span class="op" id="4632038">==</span>&nbsp;<span class="ident" id="4632041">chunk</span>&nbsp;<span class="op" id="4632047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632052">block</span><span class="op" id="4632057">(</span><span class="ident" id="4632058">d</span><span class="op" id="4632059">,</span>&nbsp;<span class="ident" id="4632061">d</span><span class="op" id="4632062">.</span><span class="ident" id="4632063">x</span><span class="op" id="4632064">[</span><span class="op" id="4632065">:</span><span class="op" id="4632066">]</span><span class="op" id="4632067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632072">d</span><span class="op" id="4632073">.</span><span class="ident" id="4632074">nx</span>&nbsp;<span class="op" id="4632077">=</span>&nbsp;<span class="num" id="4632079">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632083">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632087">p</span>&nbsp;<span class="op" id="4632089">=</span>&nbsp;<span class="ident" id="4632091">p</span><span class="op" id="4632092">[</span><span class="ident" id="4632093">n</span><span class="op" id="4632094">:</span><span class="op" id="4632095">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632101">if</span>&nbsp;<span class="builtinfunc" id="4632104">len</span><span class="op" id="4632107">(</span><span class="ident" id="4632108">p</span><span class="op" id="4632109">)</span>&nbsp;<span class="op" id="4632111">&gt;=</span>&nbsp;<span class="ident" id="4632114">chunk</span>&nbsp;<span class="op" id="4632120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632124">n</span>&nbsp;<span class="op" id="4632126">:=</span>&nbsp;<span class="builtinfunc" id="4632129">len</span><span class="op" id="4632132">(</span><span class="ident" id="4632133">p</span><span class="op" id="4632134">)</span>&nbsp;<span class="op" id="4632136">&amp;^</span>&nbsp;<span class="op" id="4632139">(</span><span class="ident" id="4632140">chunk</span>&nbsp;<span class="op" id="4632146">-</span>&nbsp;<span class="num" id="4632148">1</span><span class="op" id="4632149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632153">block</span><span class="op" id="4632158">(</span><span class="ident" id="4632159">d</span><span class="op" id="4632160">,</span>&nbsp;<span class="ident" id="4632162">p</span><span class="op" id="4632163">[</span><span class="op" id="4632164">:</span><span class="ident" id="4632165">n</span><span class="op" id="4632166">]</span><span class="op" id="4632167">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632171">p</span>&nbsp;<span class="op" id="4632173">=</span>&nbsp;<span class="ident" id="4632175">p</span><span class="op" id="4632176">[</span><span class="ident" id="4632177">n</span><span class="op" id="4632178">:</span><span class="op" id="4632179">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632185">if</span>&nbsp;<span class="builtinfunc" id="4632188">len</span><span class="op" id="4632191">(</span><span class="ident" id="4632192">p</span><span class="op" id="4632193">)</span>&nbsp;<span class="op" id="4632195">&gt;</span>&nbsp;<span class="num" id="4632197">0</span>&nbsp;<span class="op" id="4632199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632203">d</span><span class="op" id="4632204">.</span><span class="ident" id="4632205">nx</span>&nbsp;<span class="op" id="4632208">=</span>&nbsp;<span class="builtinfunc" id="4632210">copy</span><span class="op" id="4632214">(</span><span class="ident" id="4632215">d</span><span class="op" id="4632216">.</span><span class="ident" id="4632217">x</span><span class="op" id="4632218">[</span><span class="op" id="4632219">:</span><span class="op" id="4632220">]</span><span class="op" id="4632221">,</span>&nbsp;<span class="ident" id="4632223">p</span><span class="op" id="4632224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632227">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632230">return</span><br>
<span class="lineno"></span><span class="op" id="4632237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632240">func</span>&nbsp;<span class="op" id="4632245">(</span><span class="ident" id="4632246">d0</span>&nbsp;<span class="op" id="4632249">*</span><span class="ident" id="4632250">digest</span><span class="op" id="4632256">)</span>&nbsp;<span class="ident" id="4632258">Sum</span><span class="op" id="4632261">(</span><span class="ident" id="4632262">in</span>&nbsp;<span class="op" id="4632265">[</span><span class="op" id="4632266">]</span><span class="builtintype" id="4632267">byte</span><span class="op" id="4632271">)</span>&nbsp;<span class="op" id="4632273">[</span><span class="op" id="4632274">]</span><span class="builtintype" id="4632275">byte</span>&nbsp;<span class="op" id="4632280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632283">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632350">d</span>&nbsp;<span class="op" id="4632352">:=</span>&nbsp;<span class="builtinfunc" id="4632355">new</span><span class="op" id="4632358">(</span><span class="ident" id="4632359">digest</span><span class="op" id="4632365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632368">*</span><span class="ident" id="4632369">d</span>&nbsp;<span class="op" id="4632371">=</span>&nbsp;<span class="op" id="4632373">*</span><span class="ident" id="4632374">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632378">hash</span>&nbsp;<span class="op" id="4632383">:=</span>&nbsp;<span class="ident" id="4632386">d</span><span class="op" id="4632387">.</span><span class="ident" id="4632388">checkSum</span><span class="op" id="4632396">(</span><span class="op" id="4632397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632400">if</span>&nbsp;<span class="ident" id="4632403">d</span><span class="op" id="4632404">.</span><span class="ident" id="4632405">is384</span>&nbsp;<span class="op" id="4632411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632415">return</span>&nbsp;<span class="builtinfunc" id="4632422">append</span><span class="op" id="4632428">(</span><span class="ident" id="4632429">in</span><span class="op" id="4632431">,</span>&nbsp;<span class="ident" id="4632433">hash</span><span class="op" id="4632437">[</span><span class="op" id="4632438">:</span><span class="ident" id="4632439">Size384</span><span class="op" id="4632446">]</span><span class="op" id="4632447">...</span><span class="op" id="4632450">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632456">return</span>&nbsp;<span class="builtinfunc" id="4632463">append</span><span class="op" id="4632469">(</span><span class="ident" id="4632470">in</span><span class="op" id="4632472">,</span>&nbsp;<span class="ident" id="4632474">hash</span><span class="op" id="4632478">[</span><span class="op" id="4632479">:</span><span class="op" id="4632480">]</span><span class="op" id="4632481">...</span><span class="op" id="4632484">)</span><br>
<span class="lineno"></span><span class="op" id="4632486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4632489">func</span>&nbsp;<span class="op" id="4632494">(</span><span class="ident" id="4632495">d</span>&nbsp;<span class="op" id="4632497">*</span><span class="ident" id="4632498">digest</span><span class="op" id="4632504">)</span>&nbsp;<span class="ident" id="4632506">checkSum</span><span class="op" id="4632514">(</span><span class="op" id="4632515">)</span>&nbsp;<span class="op" id="4632517">[</span><span class="ident" id="4632518">Size</span><span class="op" id="4632522">]</span><span class="builtintype" id="4632523">byte</span>&nbsp;<span class="op" id="4632528">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632531">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4632593">len</span>&nbsp;<span class="op" id="4632597">:=</span>&nbsp;<span class="ident" id="4632600">d</span><span class="op" id="4632601">.</span><span class="builtinfunc" id="4632602">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632607">var</span>&nbsp;<span class="ident" id="4632611">tmp</span>&nbsp;<span class="op" id="4632615">[</span><span class="num" id="4632616">128</span><span class="op" id="4632619">]</span><span class="builtintype" id="4632620">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632626">tmp</span><span class="op" id="4632629">[</span><span class="num" id="4632630">0</span><span class="op" id="4632631">]</span>&nbsp;<span class="op" id="4632633">=</span>&nbsp;<span class="num" id="4632635">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632641">if</span>&nbsp;<span class="builtinfunc" id="4632644">len</span><span class="op" id="4632647">%</span><span class="num" id="4632648">128</span>&nbsp;<span class="op" id="4632652">&lt;</span>&nbsp;<span class="num" id="4632654">112</span>&nbsp;<span class="op" id="4632658">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632662">d</span><span class="op" id="4632663">.</span><span class="ident" id="4632664">Write</span><span class="op" id="4632669">(</span><span class="ident" id="4632670">tmp</span><span class="op" id="4632673">[</span><span class="num" id="4632674">0</span>&nbsp;<span class="op" id="4632676">:</span>&nbsp;<span class="num" id="4632678">112</span><span class="op" id="4632681">-</span><span class="builtinfunc" id="4632682">len</span><span class="op" id="4632685">%</span><span class="num" id="4632686">128</span><span class="op" id="4632689">]</span><span class="op" id="4632690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632693">}</span>&nbsp;<span class="keyword" id="4632695">else</span>&nbsp;<span class="op" id="4632700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632704">d</span><span class="op" id="4632705">.</span><span class="ident" id="4632706">Write</span><span class="op" id="4632711">(</span><span class="ident" id="4632712">tmp</span><span class="op" id="4632715">[</span><span class="num" id="4632716">0</span>&nbsp;<span class="op" id="4632718">:</span>&nbsp;<span class="num" id="4632720">128</span><span class="op" id="4632723">+</span><span class="num" id="4632724">112</span><span class="op" id="4632727">-</span><span class="builtinfunc" id="4632728">len</span><span class="op" id="4632731">%</span><span class="num" id="4632732">128</span><span class="op" id="4632735">]</span><span class="op" id="4632736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4632743">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4632763">len</span>&nbsp;<span class="op" id="4632767">&lt;&lt;=</span>&nbsp;<span class="num" id="4632771">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632774">for</span>&nbsp;<span class="ident" id="4632778">i</span>&nbsp;<span class="op" id="4632780">:=</span>&nbsp;<span class="builtintype" id="4632783">uint</span><span class="op" id="4632787">(</span><span class="num" id="4632788">0</span><span class="op" id="4632789">)</span><span class="op" id="4632790">;</span>&nbsp;<span class="ident" id="4632792">i</span>&nbsp;<span class="op" id="4632794">&lt;</span>&nbsp;<span class="num" id="4632796">16</span><span class="op" id="4632798">;</span>&nbsp;<span class="ident" id="4632800">i</span><span class="op" id="4632801">++</span>&nbsp;<span class="op" id="4632804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632808">tmp</span><span class="op" id="4632811">[</span><span class="ident" id="4632812">i</span><span class="op" id="4632813">]</span>&nbsp;<span class="op" id="4632815">=</span>&nbsp;<span class="builtintype" id="4632817">byte</span><span class="op" id="4632821">(</span><span class="builtinfunc" id="4632822">len</span>&nbsp;<span class="op" id="4632826">&gt;&gt;</span>&nbsp;<span class="op" id="4632829">(</span><span class="num" id="4632830">120</span>&nbsp;<span class="op" id="4632834">-</span>&nbsp;<span class="num" id="4632836">8</span><span class="op" id="4632837">*</span><span class="ident" id="4632838">i</span><span class="op" id="4632839">)</span><span class="op" id="4632840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632843">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632846">d</span><span class="op" id="4632847">.</span><span class="ident" id="4632848">Write</span><span class="op" id="4632853">(</span><span class="ident" id="4632854">tmp</span><span class="op" id="4632857">[</span><span class="num" id="4632858">0</span><span class="op" id="4632859">:</span><span class="num" id="4632860">16</span><span class="op" id="4632862">]</span><span class="op" id="4632863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632867">if</span>&nbsp;<span class="ident" id="4632870">d</span><span class="op" id="4632871">.</span><span class="ident" id="4632872">nx</span>&nbsp;<span class="op" id="4632875">!=</span>&nbsp;<span class="num" id="4632878">0</span>&nbsp;<span class="op" id="4632880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4632884">panic</span><span class="op" id="4632889">(</span><span class="string" id="4632890">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4632901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632904">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632908">h</span>&nbsp;<span class="op" id="4632910">:=</span>&nbsp;<span class="ident" id="4632913">d</span><span class="op" id="4632914">.</span><span class="ident" id="4632915">h</span><span class="op" id="4632916">[</span><span class="op" id="4632917">:</span><span class="op" id="4632918">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632921">if</span>&nbsp;<span class="ident" id="4632924">d</span><span class="op" id="4632925">.</span><span class="ident" id="4632926">is384</span>&nbsp;<span class="op" id="4632932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632936">h</span>&nbsp;<span class="op" id="4632938">=</span>&nbsp;<span class="ident" id="4632940">d</span><span class="op" id="4632941">.</span><span class="ident" id="4632942">h</span><span class="op" id="4632943">[</span><span class="op" id="4632944">:</span><span class="num" id="4632945">6</span><span class="op" id="4632946">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4632949">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632953">var</span>&nbsp;<span class="ident" id="4632957">digest</span>&nbsp;<span class="op" id="4632964">[</span><span class="ident" id="4632965">Size</span><span class="op" id="4632969">]</span><span class="builtintype" id="4632970">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632976">for</span>&nbsp;<span class="ident" id="4632980">i</span><span class="op" id="4632981">,</span>&nbsp;<span class="ident" id="4632983">s</span>&nbsp;<span class="op" id="4632985">:=</span>&nbsp;<span class="keyword" id="4632988">range</span>&nbsp;<span class="ident" id="4632994">h</span>&nbsp;<span class="op" id="4632996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633000">digest</span><span class="op" id="4633006">[</span><span class="ident" id="4633007">i</span><span class="op" id="4633008">*</span><span class="num" id="4633009">8</span><span class="op" id="4633010">]</span>&nbsp;<span class="op" id="4633012">=</span>&nbsp;<span class="builtintype" id="4633014">byte</span><span class="op" id="4633018">(</span><span class="ident" id="4633019">s</span>&nbsp;<span class="op" id="4633021">&gt;&gt;</span>&nbsp;<span class="num" id="4633024">56</span><span class="op" id="4633026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633030">digest</span><span class="op" id="4633036">[</span><span class="ident" id="4633037">i</span><span class="op" id="4633038">*</span><span class="num" id="4633039">8</span><span class="op" id="4633040">+</span><span class="num" id="4633041">1</span><span class="op" id="4633042">]</span>&nbsp;<span class="op" id="4633044">=</span>&nbsp;<span class="builtintype" id="4633046">byte</span><span class="op" id="4633050">(</span><span class="ident" id="4633051">s</span>&nbsp;<span class="op" id="4633053">&gt;&gt;</span>&nbsp;<span class="num" id="4633056">48</span><span class="op" id="4633058">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633062">digest</span><span class="op" id="4633068">[</span><span class="ident" id="4633069">i</span><span class="op" id="4633070">*</span><span class="num" id="4633071">8</span><span class="op" id="4633072">+</span><span class="num" id="4633073">2</span><span class="op" id="4633074">]</span>&nbsp;<span class="op" id="4633076">=</span>&nbsp;<span class="builtintype" id="4633078">byte</span><span class="op" id="4633082">(</span><span class="ident" id="4633083">s</span>&nbsp;<span class="op" id="4633085">&gt;&gt;</span>&nbsp;<span class="num" id="4633088">40</span><span class="op" id="4633090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633094">digest</span><span class="op" id="4633100">[</span><span class="ident" id="4633101">i</span><span class="op" id="4633102">*</span><span class="num" id="4633103">8</span><span class="op" id="4633104">+</span><span class="num" id="4633105">3</span><span class="op" id="4633106">]</span>&nbsp;<span class="op" id="4633108">=</span>&nbsp;<span class="builtintype" id="4633110">byte</span><span class="op" id="4633114">(</span><span class="ident" id="4633115">s</span>&nbsp;<span class="op" id="4633117">&gt;&gt;</span>&nbsp;<span class="num" id="4633120">32</span><span class="op" id="4633122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633126">digest</span><span class="op" id="4633132">[</span><span class="ident" id="4633133">i</span><span class="op" id="4633134">*</span><span class="num" id="4633135">8</span><span class="op" id="4633136">+</span><span class="num" id="4633137">4</span><span class="op" id="4633138">]</span>&nbsp;<span class="op" id="4633140">=</span>&nbsp;<span class="builtintype" id="4633142">byte</span><span class="op" id="4633146">(</span><span class="ident" id="4633147">s</span>&nbsp;<span class="op" id="4633149">&gt;&gt;</span>&nbsp;<span class="num" id="4633152">24</span><span class="op" id="4633154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633158">digest</span><span class="op" id="4633164">[</span><span class="ident" id="4633165">i</span><span class="op" id="4633166">*</span><span class="num" id="4633167">8</span><span class="op" id="4633168">+</span><span class="num" id="4633169">5</span><span class="op" id="4633170">]</span>&nbsp;<span class="op" id="4633172">=</span>&nbsp;<span class="builtintype" id="4633174">byte</span><span class="op" id="4633178">(</span><span class="ident" id="4633179">s</span>&nbsp;<span class="op" id="4633181">&gt;&gt;</span>&nbsp;<span class="num" id="4633184">16</span><span class="op" id="4633186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633190">digest</span><span class="op" id="4633196">[</span><span class="ident" id="4633197">i</span><span class="op" id="4633198">*</span><span class="num" id="4633199">8</span><span class="op" id="4633200">+</span><span class="num" id="4633201">6</span><span class="op" id="4633202">]</span>&nbsp;<span class="op" id="4633204">=</span>&nbsp;<span class="builtintype" id="4633206">byte</span><span class="op" id="4633210">(</span><span class="ident" id="4633211">s</span>&nbsp;<span class="op" id="4633213">&gt;&gt;</span>&nbsp;<span class="num" id="4633216">8</span><span class="op" id="4633217">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633221">digest</span><span class="op" id="4633227">[</span><span class="ident" id="4633228">i</span><span class="op" id="4633229">*</span><span class="num" id="4633230">8</span><span class="op" id="4633231">+</span><span class="num" id="4633232">7</span><span class="op" id="4633233">]</span>&nbsp;<span class="op" id="4633235">=</span>&nbsp;<span class="builtintype" id="4633237">byte</span><span class="op" id="4633241">(</span><span class="ident" id="4633242">s</span><span class="op" id="4633243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4633246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633250">return</span>&nbsp;<span class="ident" id="4633257">digest</span><br>
<span class="lineno"></span><span class="op" id="4633264">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4633267">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4633318">func</span>&nbsp;<span class="ident" id="4633323">Sum512</span><span class="op" id="4633329">(</span><span class="ident" id="4633330">data</span>&nbsp;<span class="op" id="4633335">[</span><span class="op" id="4633336">]</span><span class="builtintype" id="4633337">byte</span><span class="op" id="4633341">)</span>&nbsp;<span class="op" id="4633343">[</span><span class="ident" id="4633344">Size</span><span class="op" id="4633348">]</span><span class="builtintype" id="4633349">byte</span>&nbsp;<span class="op" id="4633354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633357">var</span>&nbsp;<span class="ident" id="4633361">d</span>&nbsp;<span class="ident" id="4633363">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633371">d</span><span class="op" id="4633372">.</span><span class="ident" id="4633373">Reset</span><span class="op" id="4633378">(</span><span class="op" id="4633379">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633382">d</span><span class="op" id="4633383">.</span><span class="ident" id="4633384">Write</span><span class="op" id="4633389">(</span><span class="ident" id="4633390">data</span><span class="op" id="4633394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633397">return</span>&nbsp;<span class="ident" id="4633404">d</span><span class="op" id="4633405">.</span><span class="ident" id="4633406">checkSum</span><span class="op" id="4633414">(</span><span class="op" id="4633415">)</span><br>
<span class="lineno"></span><span class="op" id="4633417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4633420">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4633471">func</span>&nbsp;<span class="ident" id="4633476">Sum384</span><span class="op" id="4633482">(</span><span class="ident" id="4633483">data</span>&nbsp;<span class="op" id="4633488">[</span><span class="op" id="4633489">]</span><span class="builtintype" id="4633490">byte</span><span class="op" id="4633494">)</span>&nbsp;<span class="op" id="4633496">(</span><span class="ident" id="4633497">sum384</span>&nbsp;<span class="op" id="4633504">[</span><span class="ident" id="4633505">Size384</span><span class="op" id="4633512">]</span><span class="builtintype" id="4633513">byte</span><span class="op" id="4633517">)</span>&nbsp;<span class="op" id="4633519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633522">var</span>&nbsp;<span class="ident" id="4633526">d</span>&nbsp;<span class="ident" id="4633528">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633536">d</span><span class="op" id="4633537">.</span><span class="ident" id="4633538">is384</span>&nbsp;<span class="op" id="4633544">=</span>&nbsp;<span class="builtintype" id="4633546">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633552">d</span><span class="op" id="4633553">.</span><span class="ident" id="4633554">Reset</span><span class="op" id="4633559">(</span><span class="op" id="4633560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633563">d</span><span class="op" id="4633564">.</span><span class="ident" id="4633565">Write</span><span class="op" id="4633570">(</span><span class="ident" id="4633571">data</span><span class="op" id="4633575">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4633578">sum</span>&nbsp;<span class="op" id="4633582">:=</span>&nbsp;<span class="ident" id="4633585">d</span><span class="op" id="4633586">.</span><span class="ident" id="4633587">checkSum</span><span class="op" id="4633595">(</span><span class="op" id="4633596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4633599">copy</span><span class="op" id="4633603">(</span><span class="ident" id="4633604">sum384</span><span class="op" id="4633610">[</span><span class="op" id="4633611">:</span><span class="op" id="4633612">]</span><span class="op" id="4633613">,</span>&nbsp;<span class="ident" id="4633615">sum</span><span class="op" id="4633618">[</span><span class="op" id="4633619">:</span><span class="ident" id="4633620">Size384</span><span class="op" id="4633627">]</span><span class="op" id="4633628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633631">return</span><br>
<span class="lineno"></span><span class="op" id="4633638">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
