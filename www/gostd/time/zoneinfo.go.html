<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2639152">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2639207">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2639261">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2639312">package</span>&nbsp;<span class="ident" id="2639320">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2639326">import</span>&nbsp;<span class="op" id="2639333">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2639336">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2639344">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2639354">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2639357">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2639423">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2639492">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2639567">type</span>&nbsp;<span class="ident" id="2639572">Location</span>&nbsp;<span class="keyword" id="2639581">struct</span>&nbsp;<span class="op" id="2639588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639591">name</span>&nbsp;<span class="builtintype" id="2639596">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639604">zone</span>&nbsp;<span class="op" id="2639609">[</span><span class="op" id="2639610">]</span><span class="ident" id="2639611">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639617">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2639622">[</span><span class="op" id="2639623">]</span><span class="ident" id="2639624">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639636">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639683">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639733">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639785">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639838">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639874">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639907">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639961">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2640014">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640029">cacheStart</span>&nbsp;<span class="ident" id="2640040">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640047">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2640058">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640065">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2640076">*</span><span class="ident" id="2640077">zone</span><br>
<span class="lineno"></span><span class="op" id="2640082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2640085">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2640146">type</span>&nbsp;<span class="ident" id="2640151">zone</span>&nbsp;<span class="keyword" id="2640156">struct</span>&nbsp;<span class="op" id="2640163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640166">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2640173">string</span>&nbsp;<span class="comment" id="2640180">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640208">offset</span>&nbsp;<span class="builtintype" id="2640215">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2640222">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640246">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2640253">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2640260">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2640299">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2640302">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2640359">type</span>&nbsp;<span class="ident" id="2640364">zoneTrans</span>&nbsp;<span class="keyword" id="2640374">struct</span>&nbsp;<span class="op" id="2640381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640384">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2640397">int64</span>&nbsp;<span class="comment" id="2640403">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640450">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2640463">uint8</span>&nbsp;<span class="comment" id="2640469">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640530">isstd</span><span class="op" id="2640535">,</span>&nbsp;<span class="ident" id="2640537">isutc</span>&nbsp;<span class="builtintype" id="2640543">bool</span>&nbsp;&nbsp;<span class="comment" id="2640549">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2640586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2640589">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2640651">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2640667">const</span>&nbsp;<span class="op" id="2640673">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640676">alpha</span>&nbsp;<span class="op" id="2640682">=</span>&nbsp;<span class="op" id="2640684">-</span><span class="num" id="2640685">1</span>&nbsp;<span class="op" id="2640687">&lt;&lt;</span>&nbsp;<span class="num" id="2640690">63</span>&nbsp;&nbsp;<span class="comment" id="2640694">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640712">omega</span>&nbsp;<span class="op" id="2640718">=</span>&nbsp;<span class="num" id="2640720">1</span><span class="op" id="2640721">&lt;&lt;</span><span class="num" id="2640723">63</span>&nbsp;<span class="op" id="2640726">-</span>&nbsp;<span class="num" id="2640728">1</span>&nbsp;<span class="comment" id="2640730">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2640747">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2640750">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2640802">var</span>&nbsp;<span class="ident" id="2640806">UTC</span>&nbsp;<span class="op" id="2640810">*</span><span class="ident" id="2640811">Location</span>&nbsp;<span class="op" id="2640820">=</span>&nbsp;<span class="op" id="2640822">&amp;</span><span class="ident" id="2640823">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2640831">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2640886">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2640939">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2640990">var</span>&nbsp;<span class="ident" id="2640994">utcLoc</span>&nbsp;<span class="op" id="2641001">=</span>&nbsp;<span class="ident" id="2641003">Location</span><span class="op" id="2641011">{</span><span class="ident" id="2641012">name</span><span class="op" id="2641016">:</span>&nbsp;<span class="string" id="2641018">&#34;UTC&#34;</span><span class="op" id="2641023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2641026">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2641076">var</span>&nbsp;<span class="ident" id="2641080">Local</span>&nbsp;<span class="op" id="2641086">*</span><span class="ident" id="2641087">Location</span>&nbsp;<span class="op" id="2641096">=</span>&nbsp;<span class="op" id="2641098">&amp;</span><span class="ident" id="2641099">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2641109">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2641166">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2641208">var</span>&nbsp;<span class="ident" id="2641212">localLoc</span>&nbsp;<span class="ident" id="2641221">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2641230">var</span>&nbsp;<span class="ident" id="2641234">localOnce</span>&nbsp;<span class="ident" id="2641244">sync</span><span class="op" id="2641248">.</span><span class="ident" id="2641249">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2641255">func</span>&nbsp;<span class="op" id="2641260">(</span><span class="ident" id="2641261">l</span>&nbsp;<span class="op" id="2641263">*</span><span class="ident" id="2641264">Location</span><span class="op" id="2641272">)</span>&nbsp;<span class="ident" id="2641274">get</span><span class="op" id="2641277">(</span><span class="op" id="2641278">)</span>&nbsp;<span class="op" id="2641280">*</span><span class="ident" id="2641281">Location</span>&nbsp;<span class="op" id="2641290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641293">if</span>&nbsp;<span class="ident" id="2641296">l</span>&nbsp;<span class="op" id="2641298">==</span>&nbsp;<span class="ident" id="2641301">nil</span>&nbsp;<span class="op" id="2641305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641309">return</span>&nbsp;<span class="op" id="2641316">&amp;</span><span class="ident" id="2641317">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641325">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641328">if</span>&nbsp;<span class="ident" id="2641331">l</span>&nbsp;<span class="op" id="2641333">==</span>&nbsp;<span class="op" id="2641336">&amp;</span><span class="ident" id="2641337">localLoc</span>&nbsp;<span class="op" id="2641346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641350">localOnce</span><span class="op" id="2641359">.</span><span class="ident" id="2641360">Do</span><span class="op" id="2641362">(</span><span class="ident" id="2641363">initLocal</span><span class="op" id="2641372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641378">return</span>&nbsp;<span class="ident" id="2641385">l</span><br>
<span class="lineno"></span><span class="op" id="2641387">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2641390">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2641458">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2641508">func</span>&nbsp;<span class="op" id="2641513">(</span><span class="ident" id="2641514">l</span>&nbsp;<span class="op" id="2641516">*</span><span class="ident" id="2641517">Location</span><span class="op" id="2641525">)</span>&nbsp;<span class="ident" id="2641527">String</span><span class="op" id="2641533">(</span><span class="op" id="2641534">)</span>&nbsp;<span class="builtintype" id="2641536">string</span>&nbsp;<span class="op" id="2641543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641546">return</span>&nbsp;<span class="ident" id="2641553">l</span><span class="op" id="2641554">.</span><span class="ident" id="2641555">get</span><span class="op" id="2641558">(</span><span class="op" id="2641559">)</span><span class="op" id="2641560">.</span><span class="ident" id="2641561">name</span><br>
<span class="lineno">85</span><span class="op" id="2641566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2641569">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2641618">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2641675">func</span>&nbsp;<span class="ident" id="2641680">FixedZone</span><span class="op" id="2641689">(</span><span class="ident" id="2641690">name</span>&nbsp;<span class="builtintype" id="2641695">string</span><span class="op" id="2641701">,</span>&nbsp;<span class="ident" id="2641703">offset</span>&nbsp;<span class="builtintype" id="2641710">int</span><span class="op" id="2641713">)</span>&nbsp;<span class="op" id="2641715">*</span><span class="ident" id="2641716">Location</span>&nbsp;<span class="op" id="2641725">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641728">l</span>&nbsp;<span class="op" id="2641730">:=</span>&nbsp;<span class="op" id="2641733">&amp;</span><span class="ident" id="2641734">Location</span><span class="op" id="2641742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641746">name</span><span class="op" id="2641750">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2641758">name</span><span class="op" id="2641762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641766">zone</span><span class="op" id="2641770">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2641778">[</span><span class="op" id="2641779">]</span><span class="ident" id="2641780">zone</span><span class="op" id="2641784">{</span><span class="op" id="2641785">{</span><span class="ident" id="2641786">name</span><span class="op" id="2641790">,</span>&nbsp;<span class="ident" id="2641792">offset</span><span class="op" id="2641798">,</span>&nbsp;<span class="builtintype" id="2641800">false</span><span class="op" id="2641805">}</span><span class="op" id="2641806">}</span><span class="op" id="2641807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641811">tx</span><span class="op" id="2641813">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2641823">[</span><span class="op" id="2641824">]</span><span class="ident" id="2641825">zoneTrans</span><span class="op" id="2641834">{</span><span class="op" id="2641835">{</span><span class="ident" id="2641836">alpha</span><span class="op" id="2641841">,</span>&nbsp;<span class="num" id="2641843">0</span><span class="op" id="2641844">,</span>&nbsp;<span class="builtintype" id="2641846">false</span><span class="op" id="2641851">,</span>&nbsp;<span class="builtintype" id="2641853">false</span><span class="op" id="2641858">}</span><span class="op" id="2641859">}</span><span class="op" id="2641860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641864">cacheStart</span><span class="op" id="2641874">:</span>&nbsp;<span class="ident" id="2641876">alpha</span><span class="op" id="2641881">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641885">cacheEnd</span><span class="op" id="2641893">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2641897">omega</span><span class="op" id="2641902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641908">l</span><span class="op" id="2641909">.</span><span class="ident" id="2641910">cacheZone</span>&nbsp;<span class="op" id="2641920">=</span>&nbsp;<span class="op" id="2641922">&amp;</span><span class="ident" id="2641923">l</span><span class="op" id="2641924">.</span><span class="ident" id="2641925">zone</span><span class="op" id="2641929">[</span><span class="num" id="2641930">0</span><span class="op" id="2641931">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641934">return</span>&nbsp;<span class="ident" id="2641941">l</span><br>
<span class="lineno"></span><span class="op" id="2641943">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2641946">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2642009">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2642085">//</span><br>
<span class="lineno"></span><span class="comment" id="2642088">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2642160">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2642231">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2642300">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2642356">func</span>&nbsp;<span class="op" id="2642361">(</span><span class="ident" id="2642362">l</span>&nbsp;<span class="op" id="2642364">*</span><span class="ident" id="2642365">Location</span><span class="op" id="2642373">)</span>&nbsp;<span class="ident" id="2642375">lookup</span><span class="op" id="2642381">(</span><span class="ident" id="2642382">sec</span>&nbsp;<span class="ident" id="2642386">int64</span><span class="op" id="2642391">)</span>&nbsp;<span class="op" id="2642393">(</span><span class="ident" id="2642394">name</span>&nbsp;<span class="builtintype" id="2642399">string</span><span class="op" id="2642405">,</span>&nbsp;<span class="ident" id="2642407">offset</span>&nbsp;<span class="builtintype" id="2642414">int</span><span class="op" id="2642417">,</span>&nbsp;<span class="ident" id="2642419">isDST</span>&nbsp;<span class="builtintype" id="2642425">bool</span><span class="op" id="2642429">,</span>&nbsp;<span class="ident" id="2642431">start</span><span class="op" id="2642436">,</span>&nbsp;<span class="ident" id="2642438">end</span>&nbsp;<span class="ident" id="2642442">int64</span><span class="op" id="2642447">)</span>&nbsp;<span class="op" id="2642449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642452">l</span>&nbsp;<span class="op" id="2642454">=</span>&nbsp;<span class="ident" id="2642456">l</span><span class="op" id="2642457">.</span><span class="ident" id="2642458">get</span><span class="op" id="2642461">(</span><span class="op" id="2642462">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642466">if</span>&nbsp;<span class="builtinfunc" id="2642469">len</span><span class="op" id="2642472">(</span><span class="ident" id="2642473">l</span><span class="op" id="2642474">.</span><span class="ident" id="2642475">zone</span><span class="op" id="2642479">)</span>&nbsp;<span class="op" id="2642481">==</span>&nbsp;<span class="num" id="2642484">0</span>&nbsp;<span class="op" id="2642486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642490">name</span>&nbsp;<span class="op" id="2642495">=</span>&nbsp;<span class="string" id="2642497">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642505">offset</span>&nbsp;<span class="op" id="2642512">=</span>&nbsp;<span class="num" id="2642514">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642518">isDST</span>&nbsp;<span class="op" id="2642524">=</span>&nbsp;<span class="builtintype" id="2642526">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642534">start</span>&nbsp;<span class="op" id="2642540">=</span>&nbsp;<span class="ident" id="2642542">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642550">end</span>&nbsp;<span class="op" id="2642554">=</span>&nbsp;<span class="ident" id="2642556">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642564">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642576">if</span>&nbsp;<span class="ident" id="2642579">zone</span>&nbsp;<span class="op" id="2642584">:=</span>&nbsp;<span class="ident" id="2642587">l</span><span class="op" id="2642588">.</span><span class="ident" id="2642589">cacheZone</span><span class="op" id="2642598">;</span>&nbsp;<span class="ident" id="2642600">zone</span>&nbsp;<span class="op" id="2642605">!=</span>&nbsp;<span class="ident" id="2642608">nil</span>&nbsp;<span class="op" id="2642612">&amp;&amp;</span>&nbsp;<span class="ident" id="2642615">l</span><span class="op" id="2642616">.</span><span class="ident" id="2642617">cacheStart</span>&nbsp;<span class="op" id="2642628">&lt;=</span>&nbsp;<span class="ident" id="2642631">sec</span>&nbsp;<span class="op" id="2642635">&amp;&amp;</span>&nbsp;<span class="ident" id="2642638">sec</span>&nbsp;<span class="op" id="2642642">&lt;</span>&nbsp;<span class="ident" id="2642644">l</span><span class="op" id="2642645">.</span><span class="ident" id="2642646">cacheEnd</span>&nbsp;<span class="op" id="2642655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642659">name</span>&nbsp;<span class="op" id="2642664">=</span>&nbsp;<span class="ident" id="2642666">zone</span><span class="op" id="2642670">.</span><span class="ident" id="2642671">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642678">offset</span>&nbsp;<span class="op" id="2642685">=</span>&nbsp;<span class="ident" id="2642687">zone</span><span class="op" id="2642691">.</span><span class="ident" id="2642692">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642701">isDST</span>&nbsp;<span class="op" id="2642707">=</span>&nbsp;<span class="ident" id="2642709">zone</span><span class="op" id="2642713">.</span><span class="ident" id="2642714">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642722">start</span>&nbsp;<span class="op" id="2642728">=</span>&nbsp;<span class="ident" id="2642730">l</span><span class="op" id="2642731">.</span><span class="ident" id="2642732">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642745">end</span>&nbsp;<span class="op" id="2642749">=</span>&nbsp;<span class="ident" id="2642751">l</span><span class="op" id="2642752">.</span><span class="ident" id="2642753">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642764">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642776">if</span>&nbsp;<span class="builtinfunc" id="2642779">len</span><span class="op" id="2642782">(</span><span class="ident" id="2642783">l</span><span class="op" id="2642784">.</span><span class="ident" id="2642785">tx</span><span class="op" id="2642787">)</span>&nbsp;<span class="op" id="2642789">==</span>&nbsp;<span class="num" id="2642792">0</span>&nbsp;<span class="op" id="2642794">||</span>&nbsp;<span class="ident" id="2642797">sec</span>&nbsp;<span class="op" id="2642801">&lt;</span>&nbsp;<span class="ident" id="2642803">l</span><span class="op" id="2642804">.</span><span class="ident" id="2642805">tx</span><span class="op" id="2642807">[</span><span class="num" id="2642808">0</span><span class="op" id="2642809">]</span><span class="op" id="2642810">.</span><span class="ident" id="2642811">when</span>&nbsp;<span class="op" id="2642816">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642820">zone</span>&nbsp;<span class="op" id="2642825">:=</span>&nbsp;<span class="op" id="2642828">&amp;</span><span class="ident" id="2642829">l</span><span class="op" id="2642830">.</span><span class="ident" id="2642831">zone</span><span class="op" id="2642835">[</span><span class="ident" id="2642836">l</span><span class="op" id="2642837">.</span><span class="ident" id="2642838">lookupFirstZone</span><span class="op" id="2642853">(</span><span class="op" id="2642854">)</span><span class="op" id="2642855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642859">name</span>&nbsp;<span class="op" id="2642864">=</span>&nbsp;<span class="ident" id="2642866">zone</span><span class="op" id="2642870">.</span><span class="ident" id="2642871">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642878">offset</span>&nbsp;<span class="op" id="2642885">=</span>&nbsp;<span class="ident" id="2642887">zone</span><span class="op" id="2642891">.</span><span class="ident" id="2642892">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642901">isDST</span>&nbsp;<span class="op" id="2642907">=</span>&nbsp;<span class="ident" id="2642909">zone</span><span class="op" id="2642913">.</span><span class="ident" id="2642914">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642922">start</span>&nbsp;<span class="op" id="2642928">=</span>&nbsp;<span class="ident" id="2642930">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642938">if</span>&nbsp;<span class="builtinfunc" id="2642941">len</span><span class="op" id="2642944">(</span><span class="ident" id="2642945">l</span><span class="op" id="2642946">.</span><span class="ident" id="2642947">tx</span><span class="op" id="2642949">)</span>&nbsp;<span class="op" id="2642951">&gt;</span>&nbsp;<span class="num" id="2642953">0</span>&nbsp;<span class="op" id="2642955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642960">end</span>&nbsp;<span class="op" id="2642964">=</span>&nbsp;<span class="ident" id="2642966">l</span><span class="op" id="2642967">.</span><span class="ident" id="2642968">tx</span><span class="op" id="2642970">[</span><span class="num" id="2642971">0</span><span class="op" id="2642972">]</span><span class="op" id="2642973">.</span><span class="ident" id="2642974">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642981">}</span>&nbsp;<span class="keyword" id="2642983">else</span>&nbsp;<span class="op" id="2642988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2642993">end</span>&nbsp;<span class="op" id="2642997">=</span>&nbsp;<span class="ident" id="2642999">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643007">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643011">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643023">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643077">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643126">tx</span>&nbsp;<span class="op" id="2643129">:=</span>&nbsp;<span class="ident" id="2643132">l</span><span class="op" id="2643133">.</span><span class="ident" id="2643134">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643138">end</span>&nbsp;<span class="op" id="2643142">=</span>&nbsp;<span class="ident" id="2643144">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643151">lo</span>&nbsp;<span class="op" id="2643154">:=</span>&nbsp;<span class="num" id="2643157">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643160">hi</span>&nbsp;<span class="op" id="2643163">:=</span>&nbsp;<span class="builtinfunc" id="2643166">len</span><span class="op" id="2643169">(</span><span class="ident" id="2643170">tx</span><span class="op" id="2643172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643175">for</span>&nbsp;<span class="ident" id="2643179">hi</span><span class="op" id="2643181">-</span><span class="ident" id="2643182">lo</span>&nbsp;<span class="op" id="2643185">&gt;</span>&nbsp;<span class="num" id="2643187">1</span>&nbsp;<span class="op" id="2643189">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643193">m</span>&nbsp;<span class="op" id="2643195">:=</span>&nbsp;<span class="ident" id="2643198">lo</span>&nbsp;<span class="op" id="2643201">+</span>&nbsp;<span class="op" id="2643203">(</span><span class="ident" id="2643204">hi</span><span class="op" id="2643206">-</span><span class="ident" id="2643207">lo</span><span class="op" id="2643209">)</span><span class="op" id="2643210">/</span><span class="num" id="2643211">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643215">lim</span>&nbsp;<span class="op" id="2643219">:=</span>&nbsp;<span class="ident" id="2643222">tx</span><span class="op" id="2643224">[</span><span class="ident" id="2643225">m</span><span class="op" id="2643226">]</span><span class="op" id="2643227">.</span><span class="ident" id="2643228">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643235">if</span>&nbsp;<span class="ident" id="2643238">sec</span>&nbsp;<span class="op" id="2643242">&lt;</span>&nbsp;<span class="ident" id="2643244">lim</span>&nbsp;<span class="op" id="2643248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643253">end</span>&nbsp;<span class="op" id="2643257">=</span>&nbsp;<span class="ident" id="2643259">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643266">hi</span>&nbsp;<span class="op" id="2643269">=</span>&nbsp;<span class="ident" id="2643271">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643275">}</span>&nbsp;<span class="keyword" id="2643277">else</span>&nbsp;<span class="op" id="2643282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643287">lo</span>&nbsp;<span class="op" id="2643290">=</span>&nbsp;<span class="ident" id="2643292">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643302">zone</span>&nbsp;<span class="op" id="2643307">:=</span>&nbsp;<span class="op" id="2643310">&amp;</span><span class="ident" id="2643311">l</span><span class="op" id="2643312">.</span><span class="ident" id="2643313">zone</span><span class="op" id="2643317">[</span><span class="ident" id="2643318">tx</span><span class="op" id="2643320">[</span><span class="ident" id="2643321">lo</span><span class="op" id="2643323">]</span><span class="op" id="2643324">.</span><span class="ident" id="2643325">index</span><span class="op" id="2643330">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643333">name</span>&nbsp;<span class="op" id="2643338">=</span>&nbsp;<span class="ident" id="2643340">zone</span><span class="op" id="2643344">.</span><span class="ident" id="2643345">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643351">offset</span>&nbsp;<span class="op" id="2643358">=</span>&nbsp;<span class="ident" id="2643360">zone</span><span class="op" id="2643364">.</span><span class="ident" id="2643365">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643373">isDST</span>&nbsp;<span class="op" id="2643379">=</span>&nbsp;<span class="ident" id="2643381">zone</span><span class="op" id="2643385">.</span><span class="ident" id="2643386">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643393">start</span>&nbsp;<span class="op" id="2643399">=</span>&nbsp;<span class="ident" id="2643401">tx</span><span class="op" id="2643403">[</span><span class="ident" id="2643404">lo</span><span class="op" id="2643406">]</span><span class="op" id="2643407">.</span><span class="ident" id="2643408">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643414">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643453">return</span><br>
<span class="lineno"></span><span class="op" id="2643460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2643463">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2643534">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2643603">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2643613">//</span><br>
<span class="lineno"></span><span class="comment" id="2643616">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2643668">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2643741">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2643796">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2643858">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2643920">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2643983">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2644055">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2644067">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2644133">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2644153">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2644190">func</span>&nbsp;<span class="op" id="2644195">(</span><span class="ident" id="2644196">l</span>&nbsp;<span class="op" id="2644198">*</span><span class="ident" id="2644199">Location</span><span class="op" id="2644207">)</span>&nbsp;<span class="ident" id="2644209">lookupFirstZone</span><span class="op" id="2644224">(</span><span class="op" id="2644225">)</span>&nbsp;<span class="builtintype" id="2644227">int</span>&nbsp;<span class="op" id="2644231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644234">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644246">if</span>&nbsp;<span class="op" id="2644249">!</span><span class="ident" id="2644250">l</span><span class="op" id="2644251">.</span><span class="ident" id="2644252">firstZoneUsed</span><span class="op" id="2644265">(</span><span class="op" id="2644266">)</span>&nbsp;<span class="op" id="2644268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644272">return</span>&nbsp;<span class="num" id="2644279">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644286">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644298">if</span>&nbsp;<span class="builtinfunc" id="2644301">len</span><span class="op" id="2644304">(</span><span class="ident" id="2644305">l</span><span class="op" id="2644306">.</span><span class="ident" id="2644307">tx</span><span class="op" id="2644309">)</span>&nbsp;<span class="op" id="2644311">&gt;</span>&nbsp;<span class="num" id="2644313">0</span>&nbsp;<span class="op" id="2644315">&amp;&amp;</span>&nbsp;<span class="ident" id="2644318">l</span><span class="op" id="2644319">.</span><span class="ident" id="2644320">zone</span><span class="op" id="2644324">[</span><span class="ident" id="2644325">l</span><span class="op" id="2644326">.</span><span class="ident" id="2644327">tx</span><span class="op" id="2644329">[</span><span class="num" id="2644330">0</span><span class="op" id="2644331">]</span><span class="op" id="2644332">.</span><span class="ident" id="2644333">index</span><span class="op" id="2644338">]</span><span class="op" id="2644339">.</span><span class="ident" id="2644340">isDST</span>&nbsp;<span class="op" id="2644346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644350">for</span>&nbsp;<span class="ident" id="2644354">zi</span>&nbsp;<span class="op" id="2644357">:=</span>&nbsp;<span class="builtintype" id="2644360">int</span><span class="op" id="2644363">(</span><span class="ident" id="2644364">l</span><span class="op" id="2644365">.</span><span class="ident" id="2644366">tx</span><span class="op" id="2644368">[</span><span class="num" id="2644369">0</span><span class="op" id="2644370">]</span><span class="op" id="2644371">.</span><span class="ident" id="2644372">index</span><span class="op" id="2644377">)</span>&nbsp;<span class="op" id="2644379">-</span>&nbsp;<span class="num" id="2644381">1</span><span class="op" id="2644382">;</span>&nbsp;<span class="ident" id="2644384">zi</span>&nbsp;<span class="op" id="2644387">&gt;=</span>&nbsp;<span class="num" id="2644390">0</span><span class="op" id="2644391">;</span>&nbsp;<span class="ident" id="2644393">zi</span><span class="op" id="2644395">--</span>&nbsp;<span class="op" id="2644398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644403">if</span>&nbsp;<span class="op" id="2644406">!</span><span class="ident" id="2644407">l</span><span class="op" id="2644408">.</span><span class="ident" id="2644409">zone</span><span class="op" id="2644413">[</span><span class="ident" id="2644414">zi</span><span class="op" id="2644416">]</span><span class="op" id="2644417">.</span><span class="ident" id="2644418">isDST</span>&nbsp;<span class="op" id="2644424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644430">return</span>&nbsp;<span class="ident" id="2644437">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644443">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644454">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644466">for</span>&nbsp;<span class="ident" id="2644470">zi</span>&nbsp;<span class="op" id="2644473">:=</span>&nbsp;<span class="keyword" id="2644476">range</span>&nbsp;<span class="ident" id="2644482">l</span><span class="op" id="2644483">.</span><span class="ident" id="2644484">zone</span>&nbsp;<span class="op" id="2644489">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644493">if</span>&nbsp;<span class="op" id="2644496">!</span><span class="ident" id="2644497">l</span><span class="op" id="2644498">.</span><span class="ident" id="2644499">zone</span><span class="op" id="2644503">[</span><span class="ident" id="2644504">zi</span><span class="op" id="2644506">]</span><span class="op" id="2644507">.</span><span class="ident" id="2644508">isDST</span>&nbsp;<span class="op" id="2644514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644519">return</span>&nbsp;<span class="ident" id="2644526">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644538">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644550">return</span>&nbsp;<span class="num" id="2644557">0</span><br>
<span class="lineno"></span><span class="op" id="2644559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2644562">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2644626">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2644641">func</span>&nbsp;<span class="op" id="2644646">(</span><span class="ident" id="2644647">l</span>&nbsp;<span class="op" id="2644649">*</span><span class="ident" id="2644650">Location</span><span class="op" id="2644658">)</span>&nbsp;<span class="ident" id="2644660">firstZoneUsed</span><span class="op" id="2644673">(</span><span class="op" id="2644674">)</span>&nbsp;<span class="builtintype" id="2644676">bool</span>&nbsp;<span class="op" id="2644681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644684">for</span>&nbsp;<span class="ident" id="2644688">_</span><span class="op" id="2644689">,</span>&nbsp;<span class="ident" id="2644691">tx</span>&nbsp;<span class="op" id="2644694">:=</span>&nbsp;<span class="keyword" id="2644697">range</span>&nbsp;<span class="ident" id="2644703">l</span><span class="op" id="2644704">.</span><span class="ident" id="2644705">tx</span>&nbsp;<span class="op" id="2644708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644712">if</span>&nbsp;<span class="ident" id="2644715">tx</span><span class="op" id="2644717">.</span><span class="ident" id="2644718">index</span>&nbsp;<span class="op" id="2644724">==</span>&nbsp;<span class="num" id="2644727">0</span>&nbsp;<span class="op" id="2644729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644734">return</span>&nbsp;<span class="builtintype" id="2644741">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644754">return</span>&nbsp;<span class="builtintype" id="2644761">false</span><br>
<span class="lineno"></span><span class="op" id="2644767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2644770">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2644829">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2644893">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2644942">func</span>&nbsp;<span class="op" id="2644947">(</span><span class="ident" id="2644948">l</span>&nbsp;<span class="op" id="2644950">*</span><span class="ident" id="2644951">Location</span><span class="op" id="2644959">)</span>&nbsp;<span class="ident" id="2644961">lookupName</span><span class="op" id="2644971">(</span><span class="ident" id="2644972">name</span>&nbsp;<span class="builtintype" id="2644977">string</span><span class="op" id="2644983">,</span>&nbsp;<span class="ident" id="2644985">unix</span>&nbsp;<span class="ident" id="2644990">int64</span><span class="op" id="2644995">)</span>&nbsp;<span class="op" id="2644997">(</span><span class="ident" id="2644998">offset</span>&nbsp;<span class="builtintype" id="2645005">int</span><span class="op" id="2645008">,</span>&nbsp;<span class="ident" id="2645010">isDST</span>&nbsp;<span class="builtintype" id="2645016">bool</span><span class="op" id="2645020">,</span>&nbsp;<span class="ident" id="2645022">ok</span>&nbsp;<span class="builtintype" id="2645025">bool</span><span class="op" id="2645029">)</span>&nbsp;<span class="op" id="2645031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645034">l</span>&nbsp;<span class="op" id="2645036">=</span>&nbsp;<span class="ident" id="2645038">l</span><span class="op" id="2645039">.</span><span class="ident" id="2645040">get</span><span class="op" id="2645043">(</span><span class="op" id="2645044">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645048">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645111">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645181">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645244">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645303">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645370">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645387">for</span>&nbsp;<span class="ident" id="2645391">i</span>&nbsp;<span class="op" id="2645393">:=</span>&nbsp;<span class="keyword" id="2645396">range</span>&nbsp;<span class="ident" id="2645402">l</span><span class="op" id="2645403">.</span><span class="ident" id="2645404">zone</span>&nbsp;<span class="op" id="2645409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645413">zone</span>&nbsp;<span class="op" id="2645418">:=</span>&nbsp;<span class="op" id="2645421">&amp;</span><span class="ident" id="2645422">l</span><span class="op" id="2645423">.</span><span class="ident" id="2645424">zone</span><span class="op" id="2645428">[</span><span class="ident" id="2645429">i</span><span class="op" id="2645430">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645434">if</span>&nbsp;<span class="ident" id="2645437">zone</span><span class="op" id="2645441">.</span><span class="ident" id="2645442">name</span>&nbsp;<span class="op" id="2645447">==</span>&nbsp;<span class="ident" id="2645450">name</span>&nbsp;<span class="op" id="2645455">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645460">nam</span><span class="op" id="2645463">,</span>&nbsp;<span class="ident" id="2645465">offset</span><span class="op" id="2645471">,</span>&nbsp;<span class="ident" id="2645473">isDST</span><span class="op" id="2645478">,</span>&nbsp;<span class="ident" id="2645480">_</span><span class="op" id="2645481">,</span>&nbsp;<span class="ident" id="2645483">_</span>&nbsp;<span class="op" id="2645485">:=</span>&nbsp;<span class="ident" id="2645488">l</span><span class="op" id="2645489">.</span><span class="ident" id="2645490">lookup</span><span class="op" id="2645496">(</span><span class="ident" id="2645497">unix</span>&nbsp;<span class="op" id="2645502">-</span>&nbsp;<span class="ident" id="2645504">int64</span><span class="op" id="2645509">(</span><span class="ident" id="2645510">zone</span><span class="op" id="2645514">.</span><span class="ident" id="2645515">offset</span><span class="op" id="2645521">)</span><span class="op" id="2645522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645527">if</span>&nbsp;<span class="ident" id="2645530">nam</span>&nbsp;<span class="op" id="2645534">==</span>&nbsp;<span class="ident" id="2645537">zone</span><span class="op" id="2645541">.</span><span class="ident" id="2645542">name</span>&nbsp;<span class="op" id="2645547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645553">return</span>&nbsp;<span class="ident" id="2645560">offset</span><span class="op" id="2645566">,</span>&nbsp;<span class="ident" id="2645568">isDST</span><span class="op" id="2645573">,</span>&nbsp;<span class="builtintype" id="2645575">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645587">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645594">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645645">for</span>&nbsp;<span class="ident" id="2645649">i</span>&nbsp;<span class="op" id="2645651">:=</span>&nbsp;<span class="keyword" id="2645654">range</span>&nbsp;<span class="ident" id="2645660">l</span><span class="op" id="2645661">.</span><span class="ident" id="2645662">zone</span>&nbsp;<span class="op" id="2645667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645671">zone</span>&nbsp;<span class="op" id="2645676">:=</span>&nbsp;<span class="op" id="2645679">&amp;</span><span class="ident" id="2645680">l</span><span class="op" id="2645681">.</span><span class="ident" id="2645682">zone</span><span class="op" id="2645686">[</span><span class="ident" id="2645687">i</span><span class="op" id="2645688">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645692">if</span>&nbsp;<span class="ident" id="2645695">zone</span><span class="op" id="2645699">.</span><span class="ident" id="2645700">name</span>&nbsp;<span class="op" id="2645705">==</span>&nbsp;<span class="ident" id="2645708">name</span>&nbsp;<span class="op" id="2645713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645718">return</span>&nbsp;<span class="ident" id="2645725">zone</span><span class="op" id="2645729">.</span><span class="ident" id="2645730">offset</span><span class="op" id="2645736">,</span>&nbsp;<span class="ident" id="2645738">zone</span><span class="op" id="2645742">.</span><span class="ident" id="2645743">isDST</span><span class="op" id="2645748">,</span>&nbsp;<span class="builtintype" id="2645750">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645764">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645788">return</span><br>
<span class="lineno"></span><span class="op" id="2645795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2645798">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2645871">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2645932">var</span>&nbsp;<span class="ident" id="2645936">zoneinfo</span><span class="op" id="2645944">,</span>&nbsp;<span class="ident" id="2645946">_</span>&nbsp;<span class="op" id="2645948">=</span>&nbsp;<span class="ident" id="2645950">syscall</span><span class="op" id="2645957">.</span><span class="ident" id="2645958">Getenv</span><span class="op" id="2645964">(</span><span class="string" id="2645965">&#34;ZONEINFO&#34;</span><span class="op" id="2645975">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2645978">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2646036">//</span><br>
<span class="lineno"></span><span class="comment" id="2646039">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2646096">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2646151">//</span><br>
<span class="lineno"></span><span class="comment" id="2646154">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2646232">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2646295">//</span><br>
<span class="lineno"></span><span class="comment" id="2646298">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2646358">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2646414">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2646478">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2646547">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2646596">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2646651">func</span>&nbsp;<span class="ident" id="2646656">LoadLocation</span><span class="op" id="2646668">(</span><span class="ident" id="2646669">name</span>&nbsp;<span class="builtintype" id="2646674">string</span><span class="op" id="2646680">)</span>&nbsp;<span class="op" id="2646682">(</span><span class="op" id="2646683">*</span><span class="ident" id="2646684">Location</span><span class="op" id="2646692">,</span>&nbsp;<span class="builtintype" id="2646694">error</span><span class="op" id="2646699">)</span>&nbsp;<span class="op" id="2646701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646704">if</span>&nbsp;<span class="ident" id="2646707">name</span>&nbsp;<span class="op" id="2646712">==</span>&nbsp;<span class="string" id="2646715">&#34;&#34;</span>&nbsp;<span class="op" id="2646718">||</span>&nbsp;<span class="ident" id="2646721">name</span>&nbsp;<span class="op" id="2646726">==</span>&nbsp;<span class="string" id="2646729">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2646735">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646739">return</span>&nbsp;<span class="ident" id="2646746">UTC</span><span class="op" id="2646749">,</span>&nbsp;<span class="ident" id="2646751">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646759">if</span>&nbsp;<span class="ident" id="2646762">name</span>&nbsp;<span class="op" id="2646767">==</span>&nbsp;<span class="string" id="2646770">&#34;Local&#34;</span>&nbsp;<span class="op" id="2646778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646782">return</span>&nbsp;<span class="ident" id="2646789">Local</span><span class="op" id="2646794">,</span>&nbsp;<span class="ident" id="2646796">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646801">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646804">if</span>&nbsp;<span class="ident" id="2646807">zoneinfo</span>&nbsp;<span class="op" id="2646816">!=</span>&nbsp;<span class="string" id="2646819">&#34;&#34;</span>&nbsp;<span class="op" id="2646822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646826">if</span>&nbsp;<span class="ident" id="2646829">z</span><span class="op" id="2646830">,</span>&nbsp;<span class="ident" id="2646832">err</span>&nbsp;<span class="op" id="2646836">:=</span>&nbsp;<span class="ident" id="2646839">loadZoneFile</span><span class="op" id="2646851">(</span><span class="ident" id="2646852">zoneinfo</span><span class="op" id="2646860">,</span>&nbsp;<span class="ident" id="2646862">name</span><span class="op" id="2646866">)</span><span class="op" id="2646867">;</span>&nbsp;<span class="ident" id="2646869">err</span>&nbsp;<span class="op" id="2646873">==</span>&nbsp;<span class="ident" id="2646876">nil</span>&nbsp;<span class="op" id="2646880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646885">z</span><span class="op" id="2646886">.</span><span class="ident" id="2646887">name</span>&nbsp;<span class="op" id="2646892">=</span>&nbsp;<span class="ident" id="2646894">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646902">return</span>&nbsp;<span class="ident" id="2646909">z</span><span class="op" id="2646910">,</span>&nbsp;<span class="ident" id="2646912">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646918">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646924">return</span>&nbsp;<span class="ident" id="2646931">loadLocation</span><span class="op" id="2646943">(</span><span class="ident" id="2646944">name</span><span class="op" id="2646948">)</span><br>
<span class="lineno"></span><span class="op" id="2646950">}</span>
</div>
</body>
</html>
