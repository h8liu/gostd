<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2131285">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2131340">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2131394">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2131445">package</span>&nbsp;<span class="ident" id="2131453">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2131459">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2131515">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2131569">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2131626">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2131681">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2131711">//</span><br>
<span class="lineno"></span><span class="comment" id="2131714">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2131770">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2131839">//</span><br>
<span class="lineno"></span><span class="comment" id="2131842">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2131901">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2131957">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2132014">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2132031">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2132087">//</span><br>
<span class="lineno">25</span><span class="comment" id="2132090">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2132125">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2132185">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2132241">//</span><br>
<span class="lineno"></span><span class="comment" id="2132244">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2132255">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2132297">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2132357">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2132402">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2132451">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2132472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2132525">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2132582">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2132651">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2132705">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2132775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2132840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2132872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2132940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2132991">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2133052">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2133096">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2133123">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2133171">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2133193">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2133246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2133308">//</span><br>
<span class="lineno"></span><span class="comment" id="2133311">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2133375">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2133445">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2133500">//</span><br>
<span class="lineno"></span><span class="comment" id="2133503">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2133570">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2133600">//</span><br>
<span class="lineno"></span><span class="comment" id="2133603">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2133629">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2133701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2133726">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2133789">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2133832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2133885">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2133896">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2133957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2134016">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2134030">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2134069">//</span><br>
<span class="lineno"></span><span class="comment" id="2134072">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2134124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2134170">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2134186">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2134235">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2134305">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2134359">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2134403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2134469">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2134534">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2134577">//</span><br>
<span class="lineno"></span><span class="comment" id="2134580">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2134602">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2134655">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2134693">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2134740">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2134786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2134827">//</span><br>
<span class="lineno"></span><span class="comment" id="2134830">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2134834">var</span>&nbsp;<span class="ident" id="2134838">_lgamA</span>&nbsp;<span class="op" id="2134845">=</span>&nbsp;<span class="op" id="2134847">[</span><span class="op" id="2134848">...</span><span class="op" id="2134851">]</span><span class="builtintype" id="2134852">float64</span><span class="op" id="2134859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2134862">7.72156649015328655494e-02</span><span class="op" id="2134888">,</span>&nbsp;<span class="comment" id="2134890">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2134913">3.22467033424113591611e-01</span><span class="op" id="2134939">,</span>&nbsp;<span class="comment" id="2134941">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2134964">6.73523010531292681824e-02</span><span class="op" id="2134990">,</span>&nbsp;<span class="comment" id="2134992">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135015">2.05808084325167332806e-02</span><span class="op" id="2135041">,</span>&nbsp;<span class="comment" id="2135043">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135066">7.38555086081402883957e-03</span><span class="op" id="2135092">,</span>&nbsp;<span class="comment" id="2135094">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135117">2.89051383673415629091e-03</span><span class="op" id="2135143">,</span>&nbsp;<span class="comment" id="2135145">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135168">1.19270763183362067845e-03</span><span class="op" id="2135194">,</span>&nbsp;<span class="comment" id="2135196">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135219">5.10069792153511336608e-04</span><span class="op" id="2135245">,</span>&nbsp;<span class="comment" id="2135247">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135270">2.20862790713908385557e-04</span><span class="op" id="2135296">,</span>&nbsp;<span class="comment" id="2135298">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135321">1.08011567247583939954e-04</span><span class="op" id="2135347">,</span>&nbsp;<span class="comment" id="2135349">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135372">2.52144565451257326939e-05</span><span class="op" id="2135398">,</span>&nbsp;<span class="comment" id="2135400">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135423">4.48640949618915160150e-05</span><span class="op" id="2135449">,</span>&nbsp;<span class="comment" id="2135451">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2135473">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2135475">var</span>&nbsp;<span class="ident" id="2135479">_lgamR</span>&nbsp;<span class="op" id="2135486">=</span>&nbsp;<span class="op" id="2135488">[</span><span class="op" id="2135489">...</span><span class="op" id="2135492">]</span><span class="builtintype" id="2135493">float64</span><span class="op" id="2135500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135503">1.0</span><span class="op" id="2135506">,</span>&nbsp;<span class="comment" id="2135508">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135524">1.39200533467621045958e+00</span><span class="op" id="2135550">,</span>&nbsp;<span class="comment" id="2135552">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135575">7.21935547567138069525e-01</span><span class="op" id="2135601">,</span>&nbsp;<span class="comment" id="2135603">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135626">1.71933865632803078993e-01</span><span class="op" id="2135652">,</span>&nbsp;<span class="comment" id="2135654">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135677">1.86459191715652901344e-02</span><span class="op" id="2135703">,</span>&nbsp;<span class="comment" id="2135705">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135728">7.77942496381893596434e-04</span><span class="op" id="2135754">,</span>&nbsp;<span class="comment" id="2135756">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135779">7.32668430744625636189e-06</span><span class="op" id="2135805">,</span>&nbsp;<span class="comment" id="2135807">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2135829">}</span><br>
<span class="lineno"></span><span class="keyword" id="2135831">var</span>&nbsp;<span class="ident" id="2135835">_lgamS</span>&nbsp;<span class="op" id="2135842">=</span>&nbsp;<span class="op" id="2135844">[</span><span class="op" id="2135845">...</span><span class="op" id="2135848">]</span><span class="builtintype" id="2135849">float64</span><span class="op" id="2135856">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2135859">-</span><span class="num" id="2135860">7.72156649015328655494e-02</span><span class="op" id="2135886">,</span>&nbsp;<span class="comment" id="2135888">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135911">2.14982415960608852501e-01</span><span class="op" id="2135937">,</span>&nbsp;&nbsp;<span class="comment" id="2135940">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2135963">3.25778796408930981787e-01</span><span class="op" id="2135989">,</span>&nbsp;&nbsp;<span class="comment" id="2135992">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136015">1.46350472652464452805e-01</span><span class="op" id="2136041">,</span>&nbsp;&nbsp;<span class="comment" id="2136044">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136067">2.66422703033638609560e-02</span><span class="op" id="2136093">,</span>&nbsp;&nbsp;<span class="comment" id="2136096">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136119">1.84028451407337715652e-03</span><span class="op" id="2136145">,</span>&nbsp;&nbsp;<span class="comment" id="2136148">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136171">3.19475326584100867617e-05</span><span class="op" id="2136197">,</span>&nbsp;&nbsp;<span class="comment" id="2136200">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2136222">}</span><br>
<span class="lineno"></span><span class="keyword" id="2136224">var</span>&nbsp;<span class="ident" id="2136228">_lgamT</span>&nbsp;<span class="op" id="2136235">=</span>&nbsp;<span class="op" id="2136237">[</span><span class="op" id="2136238">...</span><span class="op" id="2136241">]</span><span class="builtintype" id="2136242">float64</span><span class="op" id="2136249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136252">4.83836122723810047042e-01</span><span class="op" id="2136278">,</span>&nbsp;&nbsp;<span class="comment" id="2136281">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136304">-</span><span class="num" id="2136305">1.47587722994593911752e-01</span><span class="op" id="2136331">,</span>&nbsp;<span class="comment" id="2136333">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136356">6.46249402391333854778e-02</span><span class="op" id="2136382">,</span>&nbsp;&nbsp;<span class="comment" id="2136385">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136408">-</span><span class="num" id="2136409">3.27885410759859649565e-02</span><span class="op" id="2136435">,</span>&nbsp;<span class="comment" id="2136437">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136460">1.79706750811820387126e-02</span><span class="op" id="2136486">,</span>&nbsp;&nbsp;<span class="comment" id="2136489">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136512">-</span><span class="num" id="2136513">1.03142241298341437450e-02</span><span class="op" id="2136539">,</span>&nbsp;<span class="comment" id="2136541">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136564">6.10053870246291332635e-03</span><span class="op" id="2136590">,</span>&nbsp;&nbsp;<span class="comment" id="2136593">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136616">-</span><span class="num" id="2136617">3.68452016781138256760e-03</span><span class="op" id="2136643">,</span>&nbsp;<span class="comment" id="2136645">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136668">2.25964780900612472250e-03</span><span class="op" id="2136694">,</span>&nbsp;&nbsp;<span class="comment" id="2136697">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136720">-</span><span class="num" id="2136721">1.40346469989232843813e-03</span><span class="op" id="2136747">,</span>&nbsp;<span class="comment" id="2136749">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136772">8.81081882437654011382e-04</span><span class="op" id="2136798">,</span>&nbsp;&nbsp;<span class="comment" id="2136801">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136824">-</span><span class="num" id="2136825">5.38595305356740546715e-04</span><span class="op" id="2136851">,</span>&nbsp;<span class="comment" id="2136853">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136876">3.15632070903625950361e-04</span><span class="op" id="2136902">,</span>&nbsp;&nbsp;<span class="comment" id="2136905">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136928">-</span><span class="num" id="2136929">3.12754168375120860518e-04</span><span class="op" id="2136955">,</span>&nbsp;<span class="comment" id="2136957">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2136980">3.35529192635519073543e-04</span><span class="op" id="2137006">,</span>&nbsp;&nbsp;<span class="comment" id="2137009">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2137031">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2137033">var</span>&nbsp;<span class="ident" id="2137037">_lgamU</span>&nbsp;<span class="op" id="2137044">=</span>&nbsp;<span class="op" id="2137046">[</span><span class="op" id="2137047">...</span><span class="op" id="2137050">]</span><span class="builtintype" id="2137051">float64</span><span class="op" id="2137058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137061">-</span><span class="num" id="2137062">7.72156649015328655494e-02</span><span class="op" id="2137088">,</span>&nbsp;<span class="comment" id="2137090">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137113">6.32827064025093366517e-01</span><span class="op" id="2137139">,</span>&nbsp;&nbsp;<span class="comment" id="2137142">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137165">1.45492250137234768737e+00</span><span class="op" id="2137191">,</span>&nbsp;&nbsp;<span class="comment" id="2137194">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137217">9.77717527963372745603e-01</span><span class="op" id="2137243">,</span>&nbsp;&nbsp;<span class="comment" id="2137246">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137269">2.28963728064692451092e-01</span><span class="op" id="2137295">,</span>&nbsp;&nbsp;<span class="comment" id="2137298">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137321">1.33810918536787660377e-02</span><span class="op" id="2137347">,</span>&nbsp;&nbsp;<span class="comment" id="2137350">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2137372">}</span><br>
<span class="lineno"></span><span class="keyword" id="2137374">var</span>&nbsp;<span class="ident" id="2137378">_lgamV</span>&nbsp;<span class="op" id="2137385">=</span>&nbsp;<span class="op" id="2137387">[</span><span class="op" id="2137388">...</span><span class="op" id="2137391">]</span><span class="builtintype" id="2137392">float64</span><span class="op" id="2137399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137402">1.0</span><span class="op" id="2137405">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137408">2.45597793713041134822e+00</span><span class="op" id="2137434">,</span>&nbsp;<span class="comment" id="2137436">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137459">2.12848976379893395361e+00</span><span class="op" id="2137485">,</span>&nbsp;<span class="comment" id="2137487">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137510">7.69285150456672783825e-01</span><span class="op" id="2137536">,</span>&nbsp;<span class="comment" id="2137538">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137561">1.04222645593369134254e-01</span><span class="op" id="2137587">,</span>&nbsp;<span class="comment" id="2137589">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137612">3.21709242282423911810e-03</span><span class="op" id="2137638">,</span>&nbsp;<span class="comment" id="2137640">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2137662">}</span><br>
<span class="lineno"></span><span class="keyword" id="2137664">var</span>&nbsp;<span class="ident" id="2137668">_lgamW</span>&nbsp;<span class="op" id="2137675">=</span>&nbsp;<span class="op" id="2137677">[</span><span class="op" id="2137678">...</span><span class="op" id="2137681">]</span><span class="builtintype" id="2137682">float64</span><span class="op" id="2137689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137692">4.18938533204672725052e-01</span><span class="op" id="2137718">,</span>&nbsp;&nbsp;<span class="comment" id="2137721">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137744">8.33333333333329678849e-02</span><span class="op" id="2137770">,</span>&nbsp;&nbsp;<span class="comment" id="2137773">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137796">-</span><span class="num" id="2137797">2.77777777728775536470e-03</span><span class="op" id="2137823">,</span>&nbsp;<span class="comment" id="2137825">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137848">7.93650558643019558500e-04</span><span class="op" id="2137874">,</span>&nbsp;&nbsp;<span class="comment" id="2137877">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137900">-</span><span class="num" id="2137901">5.95187557450339963135e-04</span><span class="op" id="2137927">,</span>&nbsp;<span class="comment" id="2137929">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137952">8.36339918996282139126e-04</span><span class="op" id="2137978">,</span>&nbsp;&nbsp;<span class="comment" id="2137981">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138004">-</span><span class="num" id="2138005">1.63092934096575273989e-03</span><span class="op" id="2138031">,</span>&nbsp;<span class="comment" id="2138033">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2138055">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2138058">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2138131">//</span><br>
<span class="lineno"></span><span class="comment" id="2138134">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2138156">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2138179">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2138199">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2138226">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2138249">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2138270">func</span>&nbsp;<span class="ident" id="2138275">Lgamma</span><span class="op" id="2138281">(</span><span class="ident" id="2138282">x</span>&nbsp;<span class="builtintype" id="2138284">float64</span><span class="op" id="2138291">)</span>&nbsp;<span class="op" id="2138293">(</span><span class="ident" id="2138294">lgamma</span>&nbsp;<span class="builtintype" id="2138301">float64</span><span class="op" id="2138308">,</span>&nbsp;<span class="ident" id="2138310">sign</span>&nbsp;<span class="builtintype" id="2138315">int</span><span class="op" id="2138318">)</span>&nbsp;<span class="op" id="2138320">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138323">const</span>&nbsp;<span class="op" id="2138329">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138333">Ymin</span>&nbsp;&nbsp;<span class="op" id="2138339">=</span>&nbsp;<span class="num" id="2138341">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138364">Two52</span>&nbsp;<span class="op" id="2138370">=</span>&nbsp;<span class="num" id="2138372">1</span>&nbsp;<span class="op" id="2138374">&lt;&lt;</span>&nbsp;<span class="num" id="2138377">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2138400">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138436">Two53</span>&nbsp;<span class="op" id="2138442">=</span>&nbsp;<span class="num" id="2138444">1</span>&nbsp;<span class="op" id="2138446">&lt;&lt;</span>&nbsp;<span class="num" id="2138449">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2138472">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138508">Two58</span>&nbsp;<span class="op" id="2138514">=</span>&nbsp;<span class="num" id="2138516">1</span>&nbsp;<span class="op" id="2138518">&lt;&lt;</span>&nbsp;<span class="num" id="2138521">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2138544">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138580">Tiny</span>&nbsp;&nbsp;<span class="op" id="2138586">=</span>&nbsp;<span class="num" id="2138588">1.0</span>&nbsp;<span class="op" id="2138592">/</span>&nbsp;<span class="op" id="2138594">(</span><span class="num" id="2138595">1</span>&nbsp;<span class="op" id="2138597">&lt;&lt;</span>&nbsp;<span class="num" id="2138600">70</span><span class="op" id="2138602">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2138616">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138653">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138659">=</span>&nbsp;<span class="num" id="2138661">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2138689">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138713">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138719">=</span>&nbsp;<span class="op" id="2138721">-</span><span class="num" id="2138722">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2138749">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2138773">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138797">Tt</span>&nbsp;<span class="op" id="2138800">=</span>&nbsp;<span class="op" id="2138802">-</span><span class="num" id="2138803">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2138830">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2138856">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138874">sign</span>&nbsp;<span class="op" id="2138879">=</span>&nbsp;<span class="num" id="2138881">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138884">switch</span>&nbsp;<span class="op" id="2138891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138894">case</span>&nbsp;<span class="ident" id="2138899">IsNaN</span><span class="op" id="2138904">(</span><span class="ident" id="2138905">x</span><span class="op" id="2138906">)</span><span class="op" id="2138907">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138911">lgamma</span>&nbsp;<span class="op" id="2138918">=</span>&nbsp;<span class="ident" id="2138920">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138924">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138932">case</span>&nbsp;<span class="ident" id="2138937">IsInf</span><span class="op" id="2138942">(</span><span class="ident" id="2138943">x</span><span class="op" id="2138944">,</span>&nbsp;<span class="num" id="2138946">0</span><span class="op" id="2138947">)</span><span class="op" id="2138948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138952">lgamma</span>&nbsp;<span class="op" id="2138959">=</span>&nbsp;<span class="ident" id="2138961">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138965">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138973">case</span>&nbsp;<span class="ident" id="2138978">x</span>&nbsp;<span class="op" id="2138980">==</span>&nbsp;<span class="num" id="2138983">0</span><span class="op" id="2138984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138988">lgamma</span>&nbsp;<span class="op" id="2138995">=</span>&nbsp;<span class="ident" id="2138997">Inf</span><span class="op" id="2139000">(</span><span class="num" id="2139001">1</span><span class="op" id="2139002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139006">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139018">neg</span>&nbsp;<span class="op" id="2139022">:=</span>&nbsp;<span class="builtintype" id="2139025">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139032">if</span>&nbsp;<span class="ident" id="2139035">x</span>&nbsp;<span class="op" id="2139037">&lt;</span>&nbsp;<span class="num" id="2139039">0</span>&nbsp;<span class="op" id="2139041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139045">x</span>&nbsp;<span class="op" id="2139047">=</span>&nbsp;<span class="op" id="2139049">-</span><span class="ident" id="2139050">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139054">neg</span>&nbsp;<span class="op" id="2139058">=</span>&nbsp;<span class="builtintype" id="2139060">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139066">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139070">if</span>&nbsp;<span class="ident" id="2139073">x</span>&nbsp;<span class="op" id="2139075">&lt;</span>&nbsp;<span class="ident" id="2139077">Tiny</span>&nbsp;<span class="op" id="2139082">{</span>&nbsp;<span class="comment" id="2139084">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139123">if</span>&nbsp;<span class="ident" id="2139126">neg</span>&nbsp;<span class="op" id="2139130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139135">sign</span>&nbsp;<span class="op" id="2139140">=</span>&nbsp;<span class="op" id="2139142">-</span><span class="num" id="2139143">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139147">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139151">lgamma</span>&nbsp;<span class="op" id="2139158">=</span>&nbsp;<span class="op" id="2139160">-</span><span class="ident" id="2139161">Log</span><span class="op" id="2139164">(</span><span class="ident" id="2139165">x</span><span class="op" id="2139166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139170">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139181">var</span>&nbsp;<span class="ident" id="2139185">nadj</span>&nbsp;<span class="builtintype" id="2139190">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139199">if</span>&nbsp;<span class="ident" id="2139202">neg</span>&nbsp;<span class="op" id="2139206">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139210">if</span>&nbsp;<span class="ident" id="2139213">x</span>&nbsp;<span class="op" id="2139215">&gt;=</span>&nbsp;<span class="ident" id="2139218">Two52</span>&nbsp;<span class="op" id="2139224">{</span>&nbsp;<span class="comment" id="2139226">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139263">lgamma</span>&nbsp;<span class="op" id="2139270">=</span>&nbsp;<span class="ident" id="2139272">Inf</span><span class="op" id="2139275">(</span><span class="num" id="2139276">1</span><span class="op" id="2139277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139282">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139295">t</span>&nbsp;<span class="op" id="2139297">:=</span>&nbsp;<span class="ident" id="2139300">sinPi</span><span class="op" id="2139305">(</span><span class="ident" id="2139306">x</span><span class="op" id="2139307">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139311">if</span>&nbsp;<span class="ident" id="2139314">t</span>&nbsp;<span class="op" id="2139316">==</span>&nbsp;<span class="num" id="2139319">0</span>&nbsp;<span class="op" id="2139321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139326">lgamma</span>&nbsp;<span class="op" id="2139333">=</span>&nbsp;<span class="ident" id="2139335">Inf</span><span class="op" id="2139338">(</span><span class="num" id="2139339">1</span><span class="op" id="2139340">)</span>&nbsp;<span class="comment" id="2139342">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139357">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139370">nadj</span>&nbsp;<span class="op" id="2139375">=</span>&nbsp;<span class="ident" id="2139377">Log</span><span class="op" id="2139380">(</span><span class="ident" id="2139381">Pi</span>&nbsp;<span class="op" id="2139384">/</span>&nbsp;<span class="ident" id="2139386">Abs</span><span class="op" id="2139389">(</span><span class="ident" id="2139390">t</span><span class="op" id="2139391">*</span><span class="ident" id="2139392">x</span><span class="op" id="2139393">)</span><span class="op" id="2139394">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139398">if</span>&nbsp;<span class="ident" id="2139401">t</span>&nbsp;<span class="op" id="2139403">&lt;</span>&nbsp;<span class="num" id="2139405">0</span>&nbsp;<span class="op" id="2139407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139412">sign</span>&nbsp;<span class="op" id="2139417">=</span>&nbsp;<span class="op" id="2139419">-</span><span class="num" id="2139420">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139431">switch</span>&nbsp;<span class="op" id="2139438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139441">case</span>&nbsp;<span class="ident" id="2139446">x</span>&nbsp;<span class="op" id="2139448">==</span>&nbsp;<span class="num" id="2139451">1</span>&nbsp;<span class="op" id="2139453">||</span>&nbsp;<span class="ident" id="2139456">x</span>&nbsp;<span class="op" id="2139458">==</span>&nbsp;<span class="num" id="2139461">2</span><span class="op" id="2139462">:</span>&nbsp;<span class="comment" id="2139464">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139487">lgamma</span>&nbsp;<span class="op" id="2139494">=</span>&nbsp;<span class="num" id="2139496">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139500">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139508">case</span>&nbsp;<span class="ident" id="2139513">x</span>&nbsp;<span class="op" id="2139515">&lt;</span>&nbsp;<span class="num" id="2139517">2</span><span class="op" id="2139518">:</span>&nbsp;<span class="comment" id="2139520">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139562">var</span>&nbsp;<span class="ident" id="2139566">y</span>&nbsp;<span class="builtintype" id="2139568">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139578">var</span>&nbsp;<span class="ident" id="2139582">i</span>&nbsp;<span class="builtintype" id="2139584">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139590">if</span>&nbsp;<span class="ident" id="2139593">x</span>&nbsp;<span class="op" id="2139595">&lt;=</span>&nbsp;<span class="num" id="2139598">0.9</span>&nbsp;<span class="op" id="2139602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139607">lgamma</span>&nbsp;<span class="op" id="2139614">=</span>&nbsp;<span class="op" id="2139616">-</span><span class="ident" id="2139617">Log</span><span class="op" id="2139620">(</span><span class="ident" id="2139621">x</span><span class="op" id="2139622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139627">switch</span>&nbsp;<span class="op" id="2139634">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139639">case</span>&nbsp;<span class="ident" id="2139644">x</span>&nbsp;<span class="op" id="2139646">&gt;=</span>&nbsp;<span class="op" id="2139649">(</span><span class="ident" id="2139650">Ymin</span>&nbsp;<span class="op" id="2139655">-</span>&nbsp;<span class="num" id="2139657">1</span>&nbsp;<span class="op" id="2139659">+</span>&nbsp;<span class="num" id="2139661">0.27</span><span class="op" id="2139665">)</span><span class="op" id="2139666">:</span>&nbsp;<span class="comment" id="2139668">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139695">y</span>&nbsp;<span class="op" id="2139697">=</span>&nbsp;<span class="num" id="2139699">1</span>&nbsp;<span class="op" id="2139701">-</span>&nbsp;<span class="ident" id="2139703">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139709">i</span>&nbsp;<span class="op" id="2139711">=</span>&nbsp;<span class="num" id="2139713">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139718">case</span>&nbsp;<span class="ident" id="2139723">x</span>&nbsp;<span class="op" id="2139725">&gt;=</span>&nbsp;<span class="op" id="2139728">(</span><span class="ident" id="2139729">Ymin</span>&nbsp;<span class="op" id="2139734">-</span>&nbsp;<span class="num" id="2139736">1</span>&nbsp;<span class="op" id="2139738">-</span>&nbsp;<span class="num" id="2139740">0.27</span><span class="op" id="2139744">)</span><span class="op" id="2139745">:</span>&nbsp;<span class="comment" id="2139747">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139775">y</span>&nbsp;<span class="op" id="2139777">=</span>&nbsp;<span class="ident" id="2139779">x</span>&nbsp;<span class="op" id="2139781">-</span>&nbsp;<span class="op" id="2139783">(</span><span class="ident" id="2139784">Tc</span>&nbsp;<span class="op" id="2139787">-</span>&nbsp;<span class="num" id="2139789">1</span><span class="op" id="2139790">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139796">i</span>&nbsp;<span class="op" id="2139798">=</span>&nbsp;<span class="num" id="2139800">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139805">default</span><span class="op" id="2139812">:</span>&nbsp;<span class="comment" id="2139814">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139836">y</span>&nbsp;<span class="op" id="2139838">=</span>&nbsp;<span class="ident" id="2139840">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139846">i</span>&nbsp;<span class="op" id="2139848">=</span>&nbsp;<span class="num" id="2139850">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139855">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139859">}</span>&nbsp;<span class="keyword" id="2139861">else</span>&nbsp;<span class="op" id="2139866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139871">lgamma</span>&nbsp;<span class="op" id="2139878">=</span>&nbsp;<span class="num" id="2139880">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139885">switch</span>&nbsp;<span class="op" id="2139892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139897">case</span>&nbsp;<span class="ident" id="2139902">x</span>&nbsp;<span class="op" id="2139904">&gt;=</span>&nbsp;<span class="op" id="2139907">(</span><span class="ident" id="2139908">Ymin</span>&nbsp;<span class="op" id="2139913">+</span>&nbsp;<span class="num" id="2139915">0.27</span><span class="op" id="2139919">)</span><span class="op" id="2139920">:</span>&nbsp;<span class="comment" id="2139922">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139945">y</span>&nbsp;<span class="op" id="2139947">=</span>&nbsp;<span class="num" id="2139949">2</span>&nbsp;<span class="op" id="2139951">-</span>&nbsp;<span class="ident" id="2139953">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139959">i</span>&nbsp;<span class="op" id="2139961">=</span>&nbsp;<span class="num" id="2139963">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139968">case</span>&nbsp;<span class="ident" id="2139973">x</span>&nbsp;<span class="op" id="2139975">&gt;=</span>&nbsp;<span class="op" id="2139978">(</span><span class="ident" id="2139979">Ymin</span>&nbsp;<span class="op" id="2139984">-</span>&nbsp;<span class="num" id="2139986">0.27</span><span class="op" id="2139990">)</span><span class="op" id="2139991">:</span>&nbsp;<span class="comment" id="2139993">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140021">y</span>&nbsp;<span class="op" id="2140023">=</span>&nbsp;<span class="ident" id="2140025">x</span>&nbsp;<span class="op" id="2140027">-</span>&nbsp;<span class="ident" id="2140029">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140036">i</span>&nbsp;<span class="op" id="2140038">=</span>&nbsp;<span class="num" id="2140040">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140045">default</span><span class="op" id="2140052">:</span>&nbsp;<span class="comment" id="2140054">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140078">y</span>&nbsp;<span class="op" id="2140080">=</span>&nbsp;<span class="ident" id="2140082">x</span>&nbsp;<span class="op" id="2140084">-</span>&nbsp;<span class="num" id="2140086">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140092">i</span>&nbsp;<span class="op" id="2140094">=</span>&nbsp;<span class="num" id="2140096">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140109">switch</span>&nbsp;<span class="ident" id="2140116">i</span>&nbsp;<span class="op" id="2140118">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140122">case</span>&nbsp;<span class="num" id="2140127">0</span><span class="op" id="2140128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140133">z</span>&nbsp;<span class="op" id="2140135">:=</span>&nbsp;<span class="ident" id="2140138">y</span>&nbsp;<span class="op" id="2140140">*</span>&nbsp;<span class="ident" id="2140142">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140147">p1</span>&nbsp;<span class="op" id="2140150">:=</span>&nbsp;<span class="ident" id="2140153">_lgamA</span><span class="op" id="2140159">[</span><span class="num" id="2140160">0</span><span class="op" id="2140161">]</span>&nbsp;<span class="op" id="2140163">+</span>&nbsp;<span class="ident" id="2140165">z</span><span class="op" id="2140166">*</span><span class="op" id="2140167">(</span><span class="ident" id="2140168">_lgamA</span><span class="op" id="2140174">[</span><span class="num" id="2140175">2</span><span class="op" id="2140176">]</span><span class="op" id="2140177">+</span><span class="ident" id="2140178">z</span><span class="op" id="2140179">*</span><span class="op" id="2140180">(</span><span class="ident" id="2140181">_lgamA</span><span class="op" id="2140187">[</span><span class="num" id="2140188">4</span><span class="op" id="2140189">]</span><span class="op" id="2140190">+</span><span class="ident" id="2140191">z</span><span class="op" id="2140192">*</span><span class="op" id="2140193">(</span><span class="ident" id="2140194">_lgamA</span><span class="op" id="2140200">[</span><span class="num" id="2140201">6</span><span class="op" id="2140202">]</span><span class="op" id="2140203">+</span><span class="ident" id="2140204">z</span><span class="op" id="2140205">*</span><span class="op" id="2140206">(</span><span class="ident" id="2140207">_lgamA</span><span class="op" id="2140213">[</span><span class="num" id="2140214">8</span><span class="op" id="2140215">]</span><span class="op" id="2140216">+</span><span class="ident" id="2140217">z</span><span class="op" id="2140218">*</span><span class="ident" id="2140219">_lgamA</span><span class="op" id="2140225">[</span><span class="num" id="2140226">10</span><span class="op" id="2140228">]</span><span class="op" id="2140229">)</span><span class="op" id="2140230">)</span><span class="op" id="2140231">)</span><span class="op" id="2140232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140237">p2</span>&nbsp;<span class="op" id="2140240">:=</span>&nbsp;<span class="ident" id="2140243">z</span>&nbsp;<span class="op" id="2140245">*</span>&nbsp;<span class="op" id="2140247">(</span><span class="ident" id="2140248">_lgamA</span><span class="op" id="2140254">[</span><span class="num" id="2140255">1</span><span class="op" id="2140256">]</span>&nbsp;<span class="op" id="2140258">+</span>&nbsp;<span class="ident" id="2140260">z</span><span class="op" id="2140261">*</span><span class="op" id="2140262">(</span><span class="op" id="2140263">+</span><span class="ident" id="2140264">_lgamA</span><span class="op" id="2140270">[</span><span class="num" id="2140271">3</span><span class="op" id="2140272">]</span><span class="op" id="2140273">+</span><span class="ident" id="2140274">z</span><span class="op" id="2140275">*</span><span class="op" id="2140276">(</span><span class="ident" id="2140277">_lgamA</span><span class="op" id="2140283">[</span><span class="num" id="2140284">5</span><span class="op" id="2140285">]</span><span class="op" id="2140286">+</span><span class="ident" id="2140287">z</span><span class="op" id="2140288">*</span><span class="op" id="2140289">(</span><span class="ident" id="2140290">_lgamA</span><span class="op" id="2140296">[</span><span class="num" id="2140297">7</span><span class="op" id="2140298">]</span><span class="op" id="2140299">+</span><span class="ident" id="2140300">z</span><span class="op" id="2140301">*</span><span class="op" id="2140302">(</span><span class="ident" id="2140303">_lgamA</span><span class="op" id="2140309">[</span><span class="num" id="2140310">9</span><span class="op" id="2140311">]</span><span class="op" id="2140312">+</span><span class="ident" id="2140313">z</span><span class="op" id="2140314">*</span><span class="ident" id="2140315">_lgamA</span><span class="op" id="2140321">[</span><span class="num" id="2140322">11</span><span class="op" id="2140324">]</span><span class="op" id="2140325">)</span><span class="op" id="2140326">)</span><span class="op" id="2140327">)</span><span class="op" id="2140328">)</span><span class="op" id="2140329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140334">p</span>&nbsp;<span class="op" id="2140336">:=</span>&nbsp;<span class="ident" id="2140339">y</span><span class="op" id="2140340">*</span><span class="ident" id="2140341">p1</span>&nbsp;<span class="op" id="2140344">+</span>&nbsp;<span class="ident" id="2140346">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140352">lgamma</span>&nbsp;<span class="op" id="2140359">+=</span>&nbsp;<span class="op" id="2140362">(</span><span class="ident" id="2140363">p</span>&nbsp;<span class="op" id="2140365">-</span>&nbsp;<span class="num" id="2140367">0.5</span><span class="op" id="2140370">*</span><span class="ident" id="2140371">y</span><span class="op" id="2140372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140376">case</span>&nbsp;<span class="num" id="2140381">1</span><span class="op" id="2140382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140387">z</span>&nbsp;<span class="op" id="2140389">:=</span>&nbsp;<span class="ident" id="2140392">y</span>&nbsp;<span class="op" id="2140394">*</span>&nbsp;<span class="ident" id="2140396">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140401">w</span>&nbsp;<span class="op" id="2140403">:=</span>&nbsp;<span class="ident" id="2140406">z</span>&nbsp;<span class="op" id="2140408">*</span>&nbsp;<span class="ident" id="2140410">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140415">p1</span>&nbsp;<span class="op" id="2140418">:=</span>&nbsp;<span class="ident" id="2140421">_lgamT</span><span class="op" id="2140427">[</span><span class="num" id="2140428">0</span><span class="op" id="2140429">]</span>&nbsp;<span class="op" id="2140431">+</span>&nbsp;<span class="ident" id="2140433">w</span><span class="op" id="2140434">*</span><span class="op" id="2140435">(</span><span class="ident" id="2140436">_lgamT</span><span class="op" id="2140442">[</span><span class="num" id="2140443">3</span><span class="op" id="2140444">]</span><span class="op" id="2140445">+</span><span class="ident" id="2140446">w</span><span class="op" id="2140447">*</span><span class="op" id="2140448">(</span><span class="ident" id="2140449">_lgamT</span><span class="op" id="2140455">[</span><span class="num" id="2140456">6</span><span class="op" id="2140457">]</span><span class="op" id="2140458">+</span><span class="ident" id="2140459">w</span><span class="op" id="2140460">*</span><span class="op" id="2140461">(</span><span class="ident" id="2140462">_lgamT</span><span class="op" id="2140468">[</span><span class="num" id="2140469">9</span><span class="op" id="2140470">]</span><span class="op" id="2140471">+</span><span class="ident" id="2140472">w</span><span class="op" id="2140473">*</span><span class="ident" id="2140474">_lgamT</span><span class="op" id="2140480">[</span><span class="num" id="2140481">12</span><span class="op" id="2140483">]</span><span class="op" id="2140484">)</span><span class="op" id="2140485">)</span><span class="op" id="2140486">)</span>&nbsp;<span class="comment" id="2140488">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140508">p2</span>&nbsp;<span class="op" id="2140511">:=</span>&nbsp;<span class="ident" id="2140514">_lgamT</span><span class="op" id="2140520">[</span><span class="num" id="2140521">1</span><span class="op" id="2140522">]</span>&nbsp;<span class="op" id="2140524">+</span>&nbsp;<span class="ident" id="2140526">w</span><span class="op" id="2140527">*</span><span class="op" id="2140528">(</span><span class="ident" id="2140529">_lgamT</span><span class="op" id="2140535">[</span><span class="num" id="2140536">4</span><span class="op" id="2140537">]</span><span class="op" id="2140538">+</span><span class="ident" id="2140539">w</span><span class="op" id="2140540">*</span><span class="op" id="2140541">(</span><span class="ident" id="2140542">_lgamT</span><span class="op" id="2140548">[</span><span class="num" id="2140549">7</span><span class="op" id="2140550">]</span><span class="op" id="2140551">+</span><span class="ident" id="2140552">w</span><span class="op" id="2140553">*</span><span class="op" id="2140554">(</span><span class="ident" id="2140555">_lgamT</span><span class="op" id="2140561">[</span><span class="num" id="2140562">10</span><span class="op" id="2140564">]</span><span class="op" id="2140565">+</span><span class="ident" id="2140566">w</span><span class="op" id="2140567">*</span><span class="ident" id="2140568">_lgamT</span><span class="op" id="2140574">[</span><span class="num" id="2140575">13</span><span class="op" id="2140577">]</span><span class="op" id="2140578">)</span><span class="op" id="2140579">)</span><span class="op" id="2140580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140585">p3</span>&nbsp;<span class="op" id="2140588">:=</span>&nbsp;<span class="ident" id="2140591">_lgamT</span><span class="op" id="2140597">[</span><span class="num" id="2140598">2</span><span class="op" id="2140599">]</span>&nbsp;<span class="op" id="2140601">+</span>&nbsp;<span class="ident" id="2140603">w</span><span class="op" id="2140604">*</span><span class="op" id="2140605">(</span><span class="ident" id="2140606">_lgamT</span><span class="op" id="2140612">[</span><span class="num" id="2140613">5</span><span class="op" id="2140614">]</span><span class="op" id="2140615">+</span><span class="ident" id="2140616">w</span><span class="op" id="2140617">*</span><span class="op" id="2140618">(</span><span class="ident" id="2140619">_lgamT</span><span class="op" id="2140625">[</span><span class="num" id="2140626">8</span><span class="op" id="2140627">]</span><span class="op" id="2140628">+</span><span class="ident" id="2140629">w</span><span class="op" id="2140630">*</span><span class="op" id="2140631">(</span><span class="ident" id="2140632">_lgamT</span><span class="op" id="2140638">[</span><span class="num" id="2140639">11</span><span class="op" id="2140641">]</span><span class="op" id="2140642">+</span><span class="ident" id="2140643">w</span><span class="op" id="2140644">*</span><span class="ident" id="2140645">_lgamT</span><span class="op" id="2140651">[</span><span class="num" id="2140652">14</span><span class="op" id="2140654">]</span><span class="op" id="2140655">)</span><span class="op" id="2140656">)</span><span class="op" id="2140657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140662">p</span>&nbsp;<span class="op" id="2140664">:=</span>&nbsp;<span class="ident" id="2140667">z</span><span class="op" id="2140668">*</span><span class="ident" id="2140669">p1</span>&nbsp;<span class="op" id="2140672">-</span>&nbsp;<span class="op" id="2140674">(</span><span class="ident" id="2140675">Tt</span>&nbsp;<span class="op" id="2140678">-</span>&nbsp;<span class="ident" id="2140680">w</span><span class="op" id="2140681">*</span><span class="op" id="2140682">(</span><span class="ident" id="2140683">p2</span><span class="op" id="2140685">+</span><span class="ident" id="2140686">y</span><span class="op" id="2140687">*</span><span class="ident" id="2140688">p3</span><span class="op" id="2140690">)</span><span class="op" id="2140691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140696">lgamma</span>&nbsp;<span class="op" id="2140703">+=</span>&nbsp;<span class="op" id="2140706">(</span><span class="ident" id="2140707">Tf</span>&nbsp;<span class="op" id="2140710">+</span>&nbsp;<span class="ident" id="2140712">p</span><span class="op" id="2140713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140717">case</span>&nbsp;<span class="num" id="2140722">2</span><span class="op" id="2140723">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140728">p1</span>&nbsp;<span class="op" id="2140731">:=</span>&nbsp;<span class="ident" id="2140734">y</span>&nbsp;<span class="op" id="2140736">*</span>&nbsp;<span class="op" id="2140738">(</span><span class="ident" id="2140739">_lgamU</span><span class="op" id="2140745">[</span><span class="num" id="2140746">0</span><span class="op" id="2140747">]</span>&nbsp;<span class="op" id="2140749">+</span>&nbsp;<span class="ident" id="2140751">y</span><span class="op" id="2140752">*</span><span class="op" id="2140753">(</span><span class="ident" id="2140754">_lgamU</span><span class="op" id="2140760">[</span><span class="num" id="2140761">1</span><span class="op" id="2140762">]</span><span class="op" id="2140763">+</span><span class="ident" id="2140764">y</span><span class="op" id="2140765">*</span><span class="op" id="2140766">(</span><span class="ident" id="2140767">_lgamU</span><span class="op" id="2140773">[</span><span class="num" id="2140774">2</span><span class="op" id="2140775">]</span><span class="op" id="2140776">+</span><span class="ident" id="2140777">y</span><span class="op" id="2140778">*</span><span class="op" id="2140779">(</span><span class="ident" id="2140780">_lgamU</span><span class="op" id="2140786">[</span><span class="num" id="2140787">3</span><span class="op" id="2140788">]</span><span class="op" id="2140789">+</span><span class="ident" id="2140790">y</span><span class="op" id="2140791">*</span><span class="op" id="2140792">(</span><span class="ident" id="2140793">_lgamU</span><span class="op" id="2140799">[</span><span class="num" id="2140800">4</span><span class="op" id="2140801">]</span><span class="op" id="2140802">+</span><span class="ident" id="2140803">y</span><span class="op" id="2140804">*</span><span class="ident" id="2140805">_lgamU</span><span class="op" id="2140811">[</span><span class="num" id="2140812">5</span><span class="op" id="2140813">]</span><span class="op" id="2140814">)</span><span class="op" id="2140815">)</span><span class="op" id="2140816">)</span><span class="op" id="2140817">)</span><span class="op" id="2140818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140823">p2</span>&nbsp;<span class="op" id="2140826">:=</span>&nbsp;<span class="num" id="2140829">1</span>&nbsp;<span class="op" id="2140831">+</span>&nbsp;<span class="ident" id="2140833">y</span><span class="op" id="2140834">*</span><span class="op" id="2140835">(</span><span class="ident" id="2140836">_lgamV</span><span class="op" id="2140842">[</span><span class="num" id="2140843">1</span><span class="op" id="2140844">]</span><span class="op" id="2140845">+</span><span class="ident" id="2140846">y</span><span class="op" id="2140847">*</span><span class="op" id="2140848">(</span><span class="ident" id="2140849">_lgamV</span><span class="op" id="2140855">[</span><span class="num" id="2140856">2</span><span class="op" id="2140857">]</span><span class="op" id="2140858">+</span><span class="ident" id="2140859">y</span><span class="op" id="2140860">*</span><span class="op" id="2140861">(</span><span class="ident" id="2140862">_lgamV</span><span class="op" id="2140868">[</span><span class="num" id="2140869">3</span><span class="op" id="2140870">]</span><span class="op" id="2140871">+</span><span class="ident" id="2140872">y</span><span class="op" id="2140873">*</span><span class="op" id="2140874">(</span><span class="ident" id="2140875">_lgamV</span><span class="op" id="2140881">[</span><span class="num" id="2140882">4</span><span class="op" id="2140883">]</span><span class="op" id="2140884">+</span><span class="ident" id="2140885">y</span><span class="op" id="2140886">*</span><span class="ident" id="2140887">_lgamV</span><span class="op" id="2140893">[</span><span class="num" id="2140894">5</span><span class="op" id="2140895">]</span><span class="op" id="2140896">)</span><span class="op" id="2140897">)</span><span class="op" id="2140898">)</span><span class="op" id="2140899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140904">lgamma</span>&nbsp;<span class="op" id="2140911">+=</span>&nbsp;<span class="op" id="2140914">(</span><span class="op" id="2140915">-</span><span class="num" id="2140916">0.5</span><span class="op" id="2140919">*</span><span class="ident" id="2140920">y</span>&nbsp;<span class="op" id="2140922">+</span>&nbsp;<span class="ident" id="2140924">p1</span><span class="op" id="2140926">/</span><span class="ident" id="2140927">p2</span><span class="op" id="2140929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140936">case</span>&nbsp;<span class="ident" id="2140941">x</span>&nbsp;<span class="op" id="2140943">&lt;</span>&nbsp;<span class="num" id="2140945">8</span><span class="op" id="2140946">:</span>&nbsp;<span class="comment" id="2140948">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140964">i</span>&nbsp;<span class="op" id="2140966">:=</span>&nbsp;<span class="builtintype" id="2140969">int</span><span class="op" id="2140972">(</span><span class="ident" id="2140973">x</span><span class="op" id="2140974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140978">y</span>&nbsp;<span class="op" id="2140980">:=</span>&nbsp;<span class="ident" id="2140983">x</span>&nbsp;<span class="op" id="2140985">-</span>&nbsp;<span class="builtintype" id="2140987">float64</span><span class="op" id="2140994">(</span><span class="ident" id="2140995">i</span><span class="op" id="2140996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141000">p</span>&nbsp;<span class="op" id="2141002">:=</span>&nbsp;<span class="ident" id="2141005">y</span>&nbsp;<span class="op" id="2141007">*</span>&nbsp;<span class="op" id="2141009">(</span><span class="ident" id="2141010">_lgamS</span><span class="op" id="2141016">[</span><span class="num" id="2141017">0</span><span class="op" id="2141018">]</span>&nbsp;<span class="op" id="2141020">+</span>&nbsp;<span class="ident" id="2141022">y</span><span class="op" id="2141023">*</span><span class="op" id="2141024">(</span><span class="ident" id="2141025">_lgamS</span><span class="op" id="2141031">[</span><span class="num" id="2141032">1</span><span class="op" id="2141033">]</span><span class="op" id="2141034">+</span><span class="ident" id="2141035">y</span><span class="op" id="2141036">*</span><span class="op" id="2141037">(</span><span class="ident" id="2141038">_lgamS</span><span class="op" id="2141044">[</span><span class="num" id="2141045">2</span><span class="op" id="2141046">]</span><span class="op" id="2141047">+</span><span class="ident" id="2141048">y</span><span class="op" id="2141049">*</span><span class="op" id="2141050">(</span><span class="ident" id="2141051">_lgamS</span><span class="op" id="2141057">[</span><span class="num" id="2141058">3</span><span class="op" id="2141059">]</span><span class="op" id="2141060">+</span><span class="ident" id="2141061">y</span><span class="op" id="2141062">*</span><span class="op" id="2141063">(</span><span class="ident" id="2141064">_lgamS</span><span class="op" id="2141070">[</span><span class="num" id="2141071">4</span><span class="op" id="2141072">]</span><span class="op" id="2141073">+</span><span class="ident" id="2141074">y</span><span class="op" id="2141075">*</span><span class="op" id="2141076">(</span><span class="ident" id="2141077">_lgamS</span><span class="op" id="2141083">[</span><span class="num" id="2141084">5</span><span class="op" id="2141085">]</span><span class="op" id="2141086">+</span><span class="ident" id="2141087">y</span><span class="op" id="2141088">*</span><span class="ident" id="2141089">_lgamS</span><span class="op" id="2141095">[</span><span class="num" id="2141096">6</span><span class="op" id="2141097">]</span><span class="op" id="2141098">)</span><span class="op" id="2141099">)</span><span class="op" id="2141100">)</span><span class="op" id="2141101">)</span><span class="op" id="2141102">)</span><span class="op" id="2141103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141107">q</span>&nbsp;<span class="op" id="2141109">:=</span>&nbsp;<span class="num" id="2141112">1</span>&nbsp;<span class="op" id="2141114">+</span>&nbsp;<span class="ident" id="2141116">y</span><span class="op" id="2141117">*</span><span class="op" id="2141118">(</span><span class="ident" id="2141119">_lgamR</span><span class="op" id="2141125">[</span><span class="num" id="2141126">1</span><span class="op" id="2141127">]</span><span class="op" id="2141128">+</span><span class="ident" id="2141129">y</span><span class="op" id="2141130">*</span><span class="op" id="2141131">(</span><span class="ident" id="2141132">_lgamR</span><span class="op" id="2141138">[</span><span class="num" id="2141139">2</span><span class="op" id="2141140">]</span><span class="op" id="2141141">+</span><span class="ident" id="2141142">y</span><span class="op" id="2141143">*</span><span class="op" id="2141144">(</span><span class="ident" id="2141145">_lgamR</span><span class="op" id="2141151">[</span><span class="num" id="2141152">3</span><span class="op" id="2141153">]</span><span class="op" id="2141154">+</span><span class="ident" id="2141155">y</span><span class="op" id="2141156">*</span><span class="op" id="2141157">(</span><span class="ident" id="2141158">_lgamR</span><span class="op" id="2141164">[</span><span class="num" id="2141165">4</span><span class="op" id="2141166">]</span><span class="op" id="2141167">+</span><span class="ident" id="2141168">y</span><span class="op" id="2141169">*</span><span class="op" id="2141170">(</span><span class="ident" id="2141171">_lgamR</span><span class="op" id="2141177">[</span><span class="num" id="2141178">5</span><span class="op" id="2141179">]</span><span class="op" id="2141180">+</span><span class="ident" id="2141181">y</span><span class="op" id="2141182">*</span><span class="ident" id="2141183">_lgamR</span><span class="op" id="2141189">[</span><span class="num" id="2141190">6</span><span class="op" id="2141191">]</span><span class="op" id="2141192">)</span><span class="op" id="2141193">)</span><span class="op" id="2141194">)</span><span class="op" id="2141195">)</span><span class="op" id="2141196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141200">lgamma</span>&nbsp;<span class="op" id="2141207">=</span>&nbsp;<span class="num" id="2141209">0.5</span><span class="op" id="2141212">*</span><span class="ident" id="2141213">y</span>&nbsp;<span class="op" id="2141215">+</span>&nbsp;<span class="ident" id="2141217">p</span><span class="op" id="2141218">/</span><span class="ident" id="2141219">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141223">z</span>&nbsp;<span class="op" id="2141225">:=</span>&nbsp;<span class="num" id="2141228">1.0</span>&nbsp;<span class="comment" id="2141232">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141270">switch</span>&nbsp;<span class="ident" id="2141277">i</span>&nbsp;<span class="op" id="2141279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141283">case</span>&nbsp;<span class="num" id="2141288">7</span><span class="op" id="2141289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141294">z</span>&nbsp;<span class="op" id="2141296">*=</span>&nbsp;<span class="op" id="2141299">(</span><span class="ident" id="2141300">y</span>&nbsp;<span class="op" id="2141302">+</span>&nbsp;<span class="num" id="2141304">6</span><span class="op" id="2141305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141310">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141324">case</span>&nbsp;<span class="num" id="2141329">6</span><span class="op" id="2141330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141335">z</span>&nbsp;<span class="op" id="2141337">*=</span>&nbsp;<span class="op" id="2141340">(</span><span class="ident" id="2141341">y</span>&nbsp;<span class="op" id="2141343">+</span>&nbsp;<span class="num" id="2141345">5</span><span class="op" id="2141346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141351">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141365">case</span>&nbsp;<span class="num" id="2141370">5</span><span class="op" id="2141371">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141376">z</span>&nbsp;<span class="op" id="2141378">*=</span>&nbsp;<span class="op" id="2141381">(</span><span class="ident" id="2141382">y</span>&nbsp;<span class="op" id="2141384">+</span>&nbsp;<span class="num" id="2141386">4</span><span class="op" id="2141387">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141392">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141406">case</span>&nbsp;<span class="num" id="2141411">4</span><span class="op" id="2141412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141417">z</span>&nbsp;<span class="op" id="2141419">*=</span>&nbsp;<span class="op" id="2141422">(</span><span class="ident" id="2141423">y</span>&nbsp;<span class="op" id="2141425">+</span>&nbsp;<span class="num" id="2141427">3</span><span class="op" id="2141428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141433">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141447">case</span>&nbsp;<span class="num" id="2141452">3</span><span class="op" id="2141453">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141458">z</span>&nbsp;<span class="op" id="2141460">*=</span>&nbsp;<span class="op" id="2141463">(</span><span class="ident" id="2141464">y</span>&nbsp;<span class="op" id="2141466">+</span>&nbsp;<span class="num" id="2141468">2</span><span class="op" id="2141469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141474">lgamma</span>&nbsp;<span class="op" id="2141481">+=</span>&nbsp;<span class="ident" id="2141484">Log</span><span class="op" id="2141487">(</span><span class="ident" id="2141488">z</span><span class="op" id="2141489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2141493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141496">case</span>&nbsp;<span class="ident" id="2141501">x</span>&nbsp;<span class="op" id="2141503">&lt;</span>&nbsp;<span class="ident" id="2141505">Two58</span><span class="op" id="2141510">:</span>&nbsp;<span class="comment" id="2141512">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141532">t</span>&nbsp;<span class="op" id="2141534">:=</span>&nbsp;<span class="ident" id="2141537">Log</span><span class="op" id="2141540">(</span><span class="ident" id="2141541">x</span><span class="op" id="2141542">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141546">z</span>&nbsp;<span class="op" id="2141548">:=</span>&nbsp;<span class="num" id="2141551">1</span>&nbsp;<span class="op" id="2141553">/</span>&nbsp;<span class="ident" id="2141555">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141559">y</span>&nbsp;<span class="op" id="2141561">:=</span>&nbsp;<span class="ident" id="2141564">z</span>&nbsp;<span class="op" id="2141566">*</span>&nbsp;<span class="ident" id="2141568">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141572">w</span>&nbsp;<span class="op" id="2141574">:=</span>&nbsp;<span class="ident" id="2141577">_lgamW</span><span class="op" id="2141583">[</span><span class="num" id="2141584">0</span><span class="op" id="2141585">]</span>&nbsp;<span class="op" id="2141587">+</span>&nbsp;<span class="ident" id="2141589">z</span><span class="op" id="2141590">*</span><span class="op" id="2141591">(</span><span class="ident" id="2141592">_lgamW</span><span class="op" id="2141598">[</span><span class="num" id="2141599">1</span><span class="op" id="2141600">]</span><span class="op" id="2141601">+</span><span class="ident" id="2141602">y</span><span class="op" id="2141603">*</span><span class="op" id="2141604">(</span><span class="ident" id="2141605">_lgamW</span><span class="op" id="2141611">[</span><span class="num" id="2141612">2</span><span class="op" id="2141613">]</span><span class="op" id="2141614">+</span><span class="ident" id="2141615">y</span><span class="op" id="2141616">*</span><span class="op" id="2141617">(</span><span class="ident" id="2141618">_lgamW</span><span class="op" id="2141624">[</span><span class="num" id="2141625">3</span><span class="op" id="2141626">]</span><span class="op" id="2141627">+</span><span class="ident" id="2141628">y</span><span class="op" id="2141629">*</span><span class="op" id="2141630">(</span><span class="ident" id="2141631">_lgamW</span><span class="op" id="2141637">[</span><span class="num" id="2141638">4</span><span class="op" id="2141639">]</span><span class="op" id="2141640">+</span><span class="ident" id="2141641">y</span><span class="op" id="2141642">*</span><span class="op" id="2141643">(</span><span class="ident" id="2141644">_lgamW</span><span class="op" id="2141650">[</span><span class="num" id="2141651">5</span><span class="op" id="2141652">]</span><span class="op" id="2141653">+</span><span class="ident" id="2141654">y</span><span class="op" id="2141655">*</span><span class="ident" id="2141656">_lgamW</span><span class="op" id="2141662">[</span><span class="num" id="2141663">6</span><span class="op" id="2141664">]</span><span class="op" id="2141665">)</span><span class="op" id="2141666">)</span><span class="op" id="2141667">)</span><span class="op" id="2141668">)</span><span class="op" id="2141669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141673">lgamma</span>&nbsp;<span class="op" id="2141680">=</span>&nbsp;<span class="op" id="2141682">(</span><span class="ident" id="2141683">x</span><span class="op" id="2141684">-</span><span class="num" id="2141685">0.5</span><span class="op" id="2141688">)</span><span class="op" id="2141689">*</span><span class="op" id="2141690">(</span><span class="ident" id="2141691">t</span><span class="op" id="2141692">-</span><span class="num" id="2141693">1</span><span class="op" id="2141694">)</span>&nbsp;<span class="op" id="2141696">+</span>&nbsp;<span class="ident" id="2141698">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141701">default</span><span class="op" id="2141708">:</span>&nbsp;<span class="comment" id="2141710">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141733">lgamma</span>&nbsp;<span class="op" id="2141740">=</span>&nbsp;<span class="ident" id="2141742">x</span>&nbsp;<span class="op" id="2141744">*</span>&nbsp;<span class="op" id="2141746">(</span><span class="ident" id="2141747">Log</span><span class="op" id="2141750">(</span><span class="ident" id="2141751">x</span><span class="op" id="2141752">)</span>&nbsp;<span class="op" id="2141754">-</span>&nbsp;<span class="num" id="2141756">1</span><span class="op" id="2141757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2141760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141763">if</span>&nbsp;<span class="ident" id="2141766">neg</span>&nbsp;<span class="op" id="2141770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141774">lgamma</span>&nbsp;<span class="op" id="2141781">=</span>&nbsp;<span class="ident" id="2141783">nadj</span>&nbsp;<span class="op" id="2141788">-</span>&nbsp;<span class="ident" id="2141790">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2141798">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141801">return</span><br>
<span class="lineno"></span><span class="op" id="2141808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2141811">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2141859">func</span>&nbsp;<span class="ident" id="2141864">sinPi</span><span class="op" id="2141869">(</span><span class="ident" id="2141870">x</span>&nbsp;<span class="builtintype" id="2141872">float64</span><span class="op" id="2141879">)</span>&nbsp;<span class="builtintype" id="2141881">float64</span>&nbsp;<span class="op" id="2141889">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141892">const</span>&nbsp;<span class="op" id="2141898">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141902">Two52</span>&nbsp;<span class="op" id="2141908">=</span>&nbsp;<span class="num" id="2141910">1</span>&nbsp;<span class="op" id="2141912">&lt;&lt;</span>&nbsp;<span class="num" id="2141915">52</span>&nbsp;<span class="comment" id="2141918">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141954">Two53</span>&nbsp;<span class="op" id="2141960">=</span>&nbsp;<span class="num" id="2141962">1</span>&nbsp;<span class="op" id="2141964">&lt;&lt;</span>&nbsp;<span class="num" id="2141967">53</span>&nbsp;<span class="comment" id="2141970">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142008">if</span>&nbsp;<span class="ident" id="2142011">x</span>&nbsp;<span class="op" id="2142013">&lt;</span>&nbsp;<span class="num" id="2142015">0.25</span>&nbsp;<span class="op" id="2142020">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142024">return</span>&nbsp;<span class="op" id="2142031">-</span><span class="ident" id="2142032">Sin</span><span class="op" id="2142035">(</span><span class="ident" id="2142036">Pi</span>&nbsp;<span class="op" id="2142039">*</span>&nbsp;<span class="ident" id="2142041">x</span><span class="op" id="2142042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2142049">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142072">z</span>&nbsp;<span class="op" id="2142074">:=</span>&nbsp;<span class="ident" id="2142077">Floor</span><span class="op" id="2142082">(</span><span class="ident" id="2142083">x</span><span class="op" id="2142084">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142087">var</span>&nbsp;<span class="ident" id="2142091">n</span>&nbsp;<span class="builtintype" id="2142093">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142098">if</span>&nbsp;<span class="ident" id="2142101">z</span>&nbsp;<span class="op" id="2142103">!=</span>&nbsp;<span class="ident" id="2142106">x</span>&nbsp;<span class="op" id="2142108">{</span>&nbsp;<span class="comment" id="2142110">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142123">x</span>&nbsp;<span class="op" id="2142125">=</span>&nbsp;<span class="ident" id="2142127">Mod</span><span class="op" id="2142130">(</span><span class="ident" id="2142131">x</span><span class="op" id="2142132">,</span>&nbsp;<span class="num" id="2142134">2</span><span class="op" id="2142135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142139">n</span>&nbsp;<span class="op" id="2142141">=</span>&nbsp;<span class="builtintype" id="2142143">int</span><span class="op" id="2142146">(</span><span class="ident" id="2142147">x</span>&nbsp;<span class="op" id="2142149">*</span>&nbsp;<span class="num" id="2142151">4</span><span class="op" id="2142152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142155">}</span>&nbsp;<span class="keyword" id="2142157">else</span>&nbsp;<span class="op" id="2142162">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142166">if</span>&nbsp;<span class="ident" id="2142169">x</span>&nbsp;<span class="op" id="2142171">&gt;=</span>&nbsp;<span class="ident" id="2142174">Two53</span>&nbsp;<span class="op" id="2142180">{</span>&nbsp;<span class="comment" id="2142182">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142203">x</span>&nbsp;<span class="op" id="2142205">=</span>&nbsp;<span class="num" id="2142207">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142212">n</span>&nbsp;<span class="op" id="2142214">=</span>&nbsp;<span class="num" id="2142216">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142220">}</span>&nbsp;<span class="keyword" id="2142222">else</span>&nbsp;<span class="op" id="2142227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142232">if</span>&nbsp;<span class="ident" id="2142235">x</span>&nbsp;<span class="op" id="2142237">&lt;</span>&nbsp;<span class="ident" id="2142239">Two52</span>&nbsp;<span class="op" id="2142245">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142251">z</span>&nbsp;<span class="op" id="2142253">=</span>&nbsp;<span class="ident" id="2142255">x</span>&nbsp;<span class="op" id="2142257">+</span>&nbsp;<span class="ident" id="2142259">Two52</span>&nbsp;<span class="comment" id="2142265">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142282">n</span>&nbsp;<span class="op" id="2142284">=</span>&nbsp;<span class="builtintype" id="2142286">int</span><span class="op" id="2142289">(</span><span class="num" id="2142290">1</span>&nbsp;<span class="op" id="2142292">&amp;</span>&nbsp;<span class="ident" id="2142294">Float64bits</span><span class="op" id="2142305">(</span><span class="ident" id="2142306">z</span><span class="op" id="2142307">)</span><span class="op" id="2142308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142313">x</span>&nbsp;<span class="op" id="2142315">=</span>&nbsp;<span class="builtintype" id="2142317">float64</span><span class="op" id="2142324">(</span><span class="ident" id="2142325">n</span><span class="op" id="2142326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142331">n</span>&nbsp;<span class="op" id="2142333">&lt;&lt;=</span>&nbsp;<span class="num" id="2142337">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142347">switch</span>&nbsp;<span class="ident" id="2142354">n</span>&nbsp;<span class="op" id="2142356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142359">case</span>&nbsp;<span class="num" id="2142364">0</span><span class="op" id="2142365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142369">x</span>&nbsp;<span class="op" id="2142371">=</span>&nbsp;<span class="ident" id="2142373">Sin</span><span class="op" id="2142376">(</span><span class="ident" id="2142377">Pi</span>&nbsp;<span class="op" id="2142380">*</span>&nbsp;<span class="ident" id="2142382">x</span><span class="op" id="2142383">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142386">case</span>&nbsp;<span class="num" id="2142391">1</span><span class="op" id="2142392">,</span>&nbsp;<span class="num" id="2142394">2</span><span class="op" id="2142395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142399">x</span>&nbsp;<span class="op" id="2142401">=</span>&nbsp;<span class="ident" id="2142403">Cos</span><span class="op" id="2142406">(</span><span class="ident" id="2142407">Pi</span>&nbsp;<span class="op" id="2142410">*</span>&nbsp;<span class="op" id="2142412">(</span><span class="num" id="2142413">0.5</span>&nbsp;<span class="op" id="2142417">-</span>&nbsp;<span class="ident" id="2142419">x</span><span class="op" id="2142420">)</span><span class="op" id="2142421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142424">case</span>&nbsp;<span class="num" id="2142429">3</span><span class="op" id="2142430">,</span>&nbsp;<span class="num" id="2142432">4</span><span class="op" id="2142433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142437">x</span>&nbsp;<span class="op" id="2142439">=</span>&nbsp;<span class="ident" id="2142441">Sin</span><span class="op" id="2142444">(</span><span class="ident" id="2142445">Pi</span>&nbsp;<span class="op" id="2142448">*</span>&nbsp;<span class="op" id="2142450">(</span><span class="num" id="2142451">1</span>&nbsp;<span class="op" id="2142453">-</span>&nbsp;<span class="ident" id="2142455">x</span><span class="op" id="2142456">)</span><span class="op" id="2142457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142460">case</span>&nbsp;<span class="num" id="2142465">5</span><span class="op" id="2142466">,</span>&nbsp;<span class="num" id="2142468">6</span><span class="op" id="2142469">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142473">x</span>&nbsp;<span class="op" id="2142475">=</span>&nbsp;<span class="op" id="2142477">-</span><span class="ident" id="2142478">Cos</span><span class="op" id="2142481">(</span><span class="ident" id="2142482">Pi</span>&nbsp;<span class="op" id="2142485">*</span>&nbsp;<span class="op" id="2142487">(</span><span class="ident" id="2142488">x</span>&nbsp;<span class="op" id="2142490">-</span>&nbsp;<span class="num" id="2142492">1.5</span><span class="op" id="2142495">)</span><span class="op" id="2142496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142499">default</span><span class="op" id="2142506">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142510">x</span>&nbsp;<span class="op" id="2142512">=</span>&nbsp;<span class="ident" id="2142514">Sin</span><span class="op" id="2142517">(</span><span class="ident" id="2142518">Pi</span>&nbsp;<span class="op" id="2142521">*</span>&nbsp;<span class="op" id="2142523">(</span><span class="ident" id="2142524">x</span>&nbsp;<span class="op" id="2142526">-</span>&nbsp;<span class="num" id="2142528">2</span><span class="op" id="2142529">)</span><span class="op" id="2142530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142536">return</span>&nbsp;<span class="op" id="2142543">-</span><span class="ident" id="2142544">x</span><br>
<span class="lineno">365</span><span class="op" id="2142546">}</span>
</div>
</body>
</html>
