<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strings</h2>
<ul>
<li><a href="/gostd/strings/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/strings/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/strings/reader.go.html">reader.go</a></li>
<li><a href="/gostd/strings/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/strings/replace.go.html">replace.go</a></li>
<li><a href="/gostd/strings/replace_test.go.html">replace_test.go</a></li>
<li><a href="/gostd/strings/search.go.html" class="current">search.go</a></li>
<li><a href="/gostd/strings/search_test.go.html">search_test.go</a></li>
<li><a href="/gostd/strings/strings.go.html">strings.go</a></li>
<li><a href="/gostd/strings/strings_decl.go.html">strings_decl.go</a></li>
<li><a href="/gostd/strings/strings_test.go.html">strings_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2961318">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2961373">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2961427">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2961478">package</span>&nbsp;<span class="ident" id="2961486">strings</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2961495">//&nbsp;stringFinder&nbsp;efficiently&nbsp;finds&nbsp;strings&nbsp;in&nbsp;a&nbsp;source&nbsp;text.&nbsp;It&#39;s&nbsp;implemented</span><br>
<span class="lineno"></span><span class="comment" id="2961572">//&nbsp;using&nbsp;the&nbsp;Boyer-Moore&nbsp;string&nbsp;search&nbsp;algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2961622">//&nbsp;http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm</span><br>
<span class="lineno">10</span><span class="comment" id="2961690">//&nbsp;http://www.cs.utexas.edu/~moore/publications/fstrpos.pdf&nbsp;(note:&nbsp;this&nbsp;aged</span><br>
<span class="lineno"></span><span class="comment" id="2961767">//&nbsp;document&nbsp;uses&nbsp;1-based&nbsp;indexing)</span><br>
<span class="lineno"></span><span class="keyword" id="2961802">type</span>&nbsp;<span class="ident" id="2961807">stringFinder</span>&nbsp;<span class="keyword" id="2961820">struct</span>&nbsp;<span class="op" id="2961827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961830">//&nbsp;pattern&nbsp;is&nbsp;the&nbsp;string&nbsp;that&nbsp;we&nbsp;are&nbsp;searching&nbsp;for&nbsp;in&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961895">pattern</span>&nbsp;<span class="builtintype" id="2961903">string</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961912">//&nbsp;badCharSkip[b]&nbsp;contains&nbsp;the&nbsp;distance&nbsp;between&nbsp;the&nbsp;last&nbsp;byte&nbsp;of&nbsp;pattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961986">//&nbsp;and&nbsp;the&nbsp;rightmost&nbsp;occurrence&nbsp;of&nbsp;b&nbsp;in&nbsp;pattern.&nbsp;If&nbsp;b&nbsp;is&nbsp;not&nbsp;in&nbsp;pattern,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962060">//&nbsp;badCharSkip[b]&nbsp;is&nbsp;len(pattern).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962096">//</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962100">//&nbsp;Whenever&nbsp;a&nbsp;mismatch&nbsp;is&nbsp;found&nbsp;with&nbsp;byte&nbsp;b&nbsp;in&nbsp;the&nbsp;text,&nbsp;we&nbsp;can&nbsp;safely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962172">//&nbsp;shift&nbsp;the&nbsp;matching&nbsp;frame&nbsp;at&nbsp;least&nbsp;badCharSkip[b]&nbsp;until&nbsp;the&nbsp;next&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962245">//&nbsp;the&nbsp;matching&nbsp;char&nbsp;could&nbsp;be&nbsp;in&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2962290">badCharSkip</span>&nbsp;<span class="op" id="2962302">[</span><span class="num" id="2962303">256</span><span class="op" id="2962306">]</span><span class="builtintype" id="2962307">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962313">//&nbsp;goodSuffixSkip[i]&nbsp;defines&nbsp;how&nbsp;far&nbsp;we&nbsp;can&nbsp;shift&nbsp;the&nbsp;matching&nbsp;frame&nbsp;given</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962389">//&nbsp;that&nbsp;the&nbsp;suffix&nbsp;pattern[i+1:]&nbsp;matches,&nbsp;but&nbsp;the&nbsp;byte&nbsp;pattern[i]&nbsp;does</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962461">//&nbsp;not.&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962503">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962507">//&nbsp;1.&nbsp;The&nbsp;matched&nbsp;suffix&nbsp;occurs&nbsp;elsewhere&nbsp;in&nbsp;pattern&nbsp;(with&nbsp;a&nbsp;different</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962579">//&nbsp;byte&nbsp;preceding&nbsp;it&nbsp;that&nbsp;we&nbsp;might&nbsp;possibly&nbsp;match).&nbsp;In&nbsp;this&nbsp;case,&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962653">//&nbsp;shift&nbsp;the&nbsp;matching&nbsp;frame&nbsp;to&nbsp;align&nbsp;with&nbsp;the&nbsp;next&nbsp;suffix&nbsp;chunk.&nbsp;For</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962723">//&nbsp;example,&nbsp;the&nbsp;pattern&nbsp;&#34;mississi&#34;&nbsp;has&nbsp;the&nbsp;suffix&nbsp;&#34;issi&#34;&nbsp;next&nbsp;occurring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962796">//&nbsp;(in&nbsp;right-to-left&nbsp;order)&nbsp;at&nbsp;index&nbsp;1,&nbsp;so&nbsp;goodSuffixSkip[3]&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962861">//&nbsp;shift+len(suffix)&nbsp;==&nbsp;3+4&nbsp;==&nbsp;7.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962896">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962900">//&nbsp;2.&nbsp;If&nbsp;the&nbsp;matched&nbsp;suffix&nbsp;does&nbsp;not&nbsp;occur&nbsp;elsewhere&nbsp;in&nbsp;pattern,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962975">//&nbsp;matching&nbsp;frame&nbsp;may&nbsp;share&nbsp;part&nbsp;of&nbsp;its&nbsp;prefix&nbsp;with&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963043">//&nbsp;matching&nbsp;suffix.&nbsp;In&nbsp;this&nbsp;case,&nbsp;goodSuffixSkip[i]&nbsp;will&nbsp;contain&nbsp;how&nbsp;far</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963117">//&nbsp;to&nbsp;shift&nbsp;the&nbsp;frame&nbsp;to&nbsp;align&nbsp;this&nbsp;portion&nbsp;of&nbsp;the&nbsp;prefix&nbsp;to&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963183">//&nbsp;suffix.&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;pattern&nbsp;&#34;abcxxxabc&#34;,&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963251">//&nbsp;mismatch&nbsp;from&nbsp;the&nbsp;back&nbsp;is&nbsp;found&nbsp;to&nbsp;be&nbsp;in&nbsp;position&nbsp;3,&nbsp;the&nbsp;matching</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963321">//&nbsp;suffix&nbsp;&#34;xxabc&#34;&nbsp;is&nbsp;not&nbsp;found&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;pattern.&nbsp;However,&nbsp;its</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963392">//&nbsp;rightmost&nbsp;&#34;abc&#34;&nbsp;(at&nbsp;position&nbsp;6)&nbsp;is&nbsp;a&nbsp;prefix&nbsp;of&nbsp;the&nbsp;whole&nbsp;pattern,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963465">//&nbsp;goodSuffixSkip[3]&nbsp;==&nbsp;shift+len(suffix)&nbsp;==&nbsp;6+5&nbsp;==&nbsp;11.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963522">goodSuffixSkip</span>&nbsp;<span class="op" id="2963537">[</span><span class="op" id="2963538">]</span><span class="builtintype" id="2963539">int</span><br>
<span class="lineno"></span><span class="op" id="2963543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2963546">func</span>&nbsp;<span class="ident" id="2963551">makeStringFinder</span><span class="op" id="2963567">(</span><span class="ident" id="2963568">pattern</span>&nbsp;<span class="builtintype" id="2963576">string</span><span class="op" id="2963582">)</span>&nbsp;<span class="op" id="2963584">*</span><span class="ident" id="2963585"><a href="/gostd/strings/search.go.html#2961807">stringFinder</a></span>&nbsp;<span class="op" id="2963598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963601">f</span>&nbsp;<span class="op" id="2963603">:=</span>&nbsp;<span class="op" id="2963606">&amp;</span><span class="ident" id="2963607"><a href="/gostd/strings/search.go.html#2961807">stringFinder</a></span><span class="op" id="2963619">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963623"><a href="/gostd/strings/search.go.html#2961895">pattern</a></span><span class="op" id="2963630">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963639"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2963646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963650"><a href="/gostd/strings/search.go.html#2963522">goodSuffixSkip</a></span><span class="op" id="2963664">:</span>&nbsp;<span class="builtinfunc" id="2963666">make</span><span class="op" id="2963670">(</span><span class="op" id="2963671">[</span><span class="op" id="2963672">]</span><span class="builtintype" id="2963673">int</span><span class="op" id="2963676">,</span>&nbsp;<span class="builtinfunc" id="2963678">len</span><span class="op" id="2963681">(</span><span class="ident" id="2963682"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2963689">)</span><span class="op" id="2963690">)</span><span class="op" id="2963691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963697">//&nbsp;last&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;character&nbsp;in&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963757">last</span>&nbsp;<span class="op" id="2963762">:=</span>&nbsp;<span class="builtinfunc" id="2963765">len</span><span class="op" id="2963768">(</span><span class="ident" id="2963769"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2963776">)</span>&nbsp;<span class="op" id="2963778">-</span>&nbsp;<span class="num" id="2963780">1</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963784">//&nbsp;Build&nbsp;bad&nbsp;character&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963815">//&nbsp;Bytes&nbsp;not&nbsp;in&nbsp;the&nbsp;pattern&nbsp;can&nbsp;skip&nbsp;one&nbsp;pattern&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963875">for</span>&nbsp;<span class="ident" id="2963879">i</span>&nbsp;<span class="op" id="2963881">:=</span>&nbsp;<span class="keyword" id="2963884">range</span>&nbsp;<span class="ident" id="2963890"><a href="/gostd/strings/search.go.html#2963601">f</a></span><span class="op" id="2963891">.</span><span class="ident" id="2963892"><a href="/gostd/strings/search.go.html#2962290">badCharSkip</a></span>&nbsp;<span class="op" id="2963904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963908"><a href="/gostd/strings/search.go.html#2963601">f</a></span><span class="op" id="2963909">.</span><span class="ident" id="2963910"><a href="/gostd/strings/search.go.html#2962290">badCharSkip</a></span><span class="op" id="2963921">[</span><span class="ident" id="2963922"><a href="/gostd/strings/search.go.html#2963879">i</a></span><span class="op" id="2963923">]</span>&nbsp;<span class="op" id="2963925">=</span>&nbsp;<span class="builtinfunc" id="2963927">len</span><span class="op" id="2963930">(</span><span class="ident" id="2963931"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2963938">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2963944">//&nbsp;The&nbsp;loop&nbsp;condition&nbsp;is&nbsp;&lt;&nbsp;instead&nbsp;of&nbsp;&lt;=&nbsp;so&nbsp;that&nbsp;the&nbsp;last&nbsp;byte&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964017">//&nbsp;have&nbsp;a&nbsp;zero&nbsp;distance&nbsp;to&nbsp;itself.&nbsp;Finding&nbsp;this&nbsp;byte&nbsp;out&nbsp;of&nbsp;place&nbsp;implies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964092">//&nbsp;that&nbsp;it&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;last&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964133">for</span>&nbsp;<span class="ident" id="2964137">i</span>&nbsp;<span class="op" id="2964139">:=</span>&nbsp;<span class="num" id="2964142">0</span><span class="op" id="2964143">;</span>&nbsp;<span class="ident" id="2964145"><a href="/gostd/strings/search.go.html#2964137">i</a></span>&nbsp;<span class="op" id="2964147">&lt;</span>&nbsp;<span class="ident" id="2964149"><a href="/gostd/strings/search.go.html#2963757">last</a></span><span class="op" id="2964153">;</span>&nbsp;<span class="ident" id="2964155"><a href="/gostd/strings/search.go.html#2964137">i</a></span><span class="op" id="2964156">++</span>&nbsp;<span class="op" id="2964159">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964163"><a href="/gostd/strings/search.go.html#2963601">f</a></span><span class="op" id="2964164">.</span><span class="ident" id="2964165"><a href="/gostd/strings/search.go.html#2962290">badCharSkip</a></span><span class="op" id="2964176">[</span><span class="ident" id="2964177"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2964184">[</span><span class="ident" id="2964185"><a href="/gostd/strings/search.go.html#2964137">i</a></span><span class="op" id="2964186">]</span><span class="op" id="2964187">]</span>&nbsp;<span class="op" id="2964189">=</span>&nbsp;<span class="ident" id="2964191"><a href="/gostd/strings/search.go.html#2963757">last</a></span>&nbsp;<span class="op" id="2964196">-</span>&nbsp;<span class="ident" id="2964198"><a href="/gostd/strings/search.go.html#2964137">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964205">//&nbsp;Build&nbsp;good&nbsp;suffix&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964234">//&nbsp;First&nbsp;pass:&nbsp;set&nbsp;each&nbsp;value&nbsp;to&nbsp;the&nbsp;next&nbsp;index&nbsp;which&nbsp;starts&nbsp;a&nbsp;prefix&nbsp;of</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964308">//&nbsp;pattern.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964321">lastPrefix</span>&nbsp;<span class="op" id="2964332">:=</span>&nbsp;<span class="ident" id="2964335"><a href="/gostd/strings/search.go.html#2963757">last</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964341">for</span>&nbsp;<span class="ident" id="2964345">i</span>&nbsp;<span class="op" id="2964347">:=</span>&nbsp;<span class="ident" id="2964350"><a href="/gostd/strings/search.go.html#2963757">last</a></span><span class="op" id="2964354">;</span>&nbsp;<span class="ident" id="2964356"><a href="/gostd/strings/search.go.html#2964345">i</a></span>&nbsp;<span class="op" id="2964358">&gt;=</span>&nbsp;<span class="num" id="2964361">0</span><span class="op" id="2964362">;</span>&nbsp;<span class="ident" id="2964364"><a href="/gostd/strings/search.go.html#2964345">i</a></span><span class="op" id="2964365">--</span>&nbsp;<span class="op" id="2964368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964372">if</span>&nbsp;<span class="ident" id="2964375"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="2964384">(</span><span class="ident" id="2964385"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2964392">,</span>&nbsp;<span class="ident" id="2964394"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2964401">[</span><span class="ident" id="2964402"><a href="/gostd/strings/search.go.html#2964345">i</a></span><span class="op" id="2964403">+</span><span class="num" id="2964404">1</span><span class="op" id="2964405">:</span><span class="op" id="2964406">]</span><span class="op" id="2964407">)</span>&nbsp;<span class="op" id="2964409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964414"><a href="/gostd/strings/search.go.html#2964321">lastPrefix</a></span>&nbsp;<span class="op" id="2964425">=</span>&nbsp;<span class="ident" id="2964427"><a href="/gostd/strings/search.go.html#2964345">i</a></span>&nbsp;<span class="op" id="2964429">+</span>&nbsp;<span class="num" id="2964431">1</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964439">//&nbsp;lastPrefix&nbsp;is&nbsp;the&nbsp;shift,&nbsp;and&nbsp;(last-i)&nbsp;is&nbsp;len(suffix).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964498"><a href="/gostd/strings/search.go.html#2963601">f</a></span><span class="op" id="2964499">.</span><span class="ident" id="2964500"><a href="/gostd/strings/search.go.html#2963522">goodSuffixSkip</a></span><span class="op" id="2964514">[</span><span class="ident" id="2964515"><a href="/gostd/strings/search.go.html#2964345">i</a></span><span class="op" id="2964516">]</span>&nbsp;<span class="op" id="2964518">=</span>&nbsp;<span class="ident" id="2964520"><a href="/gostd/strings/search.go.html#2964321">lastPrefix</a></span>&nbsp;<span class="op" id="2964531">+</span>&nbsp;<span class="ident" id="2964533"><a href="/gostd/strings/search.go.html#2963757">last</a></span>&nbsp;<span class="op" id="2964538">-</span>&nbsp;<span class="ident" id="2964540"><a href="/gostd/strings/search.go.html#2964345">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964546">//&nbsp;Second&nbsp;pass:&nbsp;find&nbsp;repeats&nbsp;of&nbsp;pattern&#39;s&nbsp;suffix&nbsp;starting&nbsp;from&nbsp;the&nbsp;front.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964621">for</span>&nbsp;<span class="ident" id="2964625">i</span>&nbsp;<span class="op" id="2964627">:=</span>&nbsp;<span class="num" id="2964630">0</span><span class="op" id="2964631">;</span>&nbsp;<span class="ident" id="2964633"><a href="/gostd/strings/search.go.html#2964625">i</a></span>&nbsp;<span class="op" id="2964635">&lt;</span>&nbsp;<span class="ident" id="2964637"><a href="/gostd/strings/search.go.html#2963757">last</a></span><span class="op" id="2964641">;</span>&nbsp;<span class="ident" id="2964643"><a href="/gostd/strings/search.go.html#2964625">i</a></span><span class="op" id="2964644">++</span>&nbsp;<span class="op" id="2964647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964651">lenSuffix</span>&nbsp;<span class="op" id="2964661">:=</span>&nbsp;<span class="ident" id="2964664"><a href="/gostd/strings/search.go.html#2964908">longestCommonSuffix</a></span><span class="op" id="2964683">(</span><span class="ident" id="2964684"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2964691">,</span>&nbsp;<span class="ident" id="2964693"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2964700">[</span><span class="num" id="2964701">1</span><span class="op" id="2964702">:</span><span class="ident" id="2964703"><a href="/gostd/strings/search.go.html#2964625">i</a></span><span class="op" id="2964704">+</span><span class="num" id="2964705">1</span><span class="op" id="2964706">]</span><span class="op" id="2964707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964711">if</span>&nbsp;<span class="ident" id="2964714"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2964721">[</span><span class="ident" id="2964722"><a href="/gostd/strings/search.go.html#2964625">i</a></span><span class="op" id="2964723">-</span><span class="ident" id="2964724"><a href="/gostd/strings/search.go.html#2964651">lenSuffix</a></span><span class="op" id="2964733">]</span>&nbsp;<span class="op" id="2964735">!=</span>&nbsp;<span class="ident" id="2964738"><a href="/gostd/strings/search.go.html#2963568">pattern</a></span><span class="op" id="2964745">[</span><span class="ident" id="2964746"><a href="/gostd/strings/search.go.html#2963757">last</a></span><span class="op" id="2964750">-</span><span class="ident" id="2964751"><a href="/gostd/strings/search.go.html#2964651">lenSuffix</a></span><span class="op" id="2964760">]</span>&nbsp;<span class="op" id="2964762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964767">//&nbsp;(last-i)&nbsp;is&nbsp;the&nbsp;shift,&nbsp;and&nbsp;lenSuffix&nbsp;is&nbsp;len(suffix).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964826"><a href="/gostd/strings/search.go.html#2963601">f</a></span><span class="op" id="2964827">.</span><span class="ident" id="2964828"><a href="/gostd/strings/search.go.html#2963522">goodSuffixSkip</a></span><span class="op" id="2964842">[</span><span class="ident" id="2964843"><a href="/gostd/strings/search.go.html#2963757">last</a></span><span class="op" id="2964847">-</span><span class="ident" id="2964848"><a href="/gostd/strings/search.go.html#2964651">lenSuffix</a></span><span class="op" id="2964857">]</span>&nbsp;<span class="op" id="2964859">=</span>&nbsp;<span class="ident" id="2964861"><a href="/gostd/strings/search.go.html#2964651">lenSuffix</a></span>&nbsp;<span class="op" id="2964871">+</span>&nbsp;<span class="ident" id="2964873"><a href="/gostd/strings/search.go.html#2963757">last</a></span>&nbsp;<span class="op" id="2964878">-</span>&nbsp;<span class="ident" id="2964880"><a href="/gostd/strings/search.go.html#2964625">i</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964891">return</span>&nbsp;<span class="ident" id="2964898"><a href="/gostd/strings/search.go.html#2963601">f</a></span><br>
<span class="lineno"></span><span class="op" id="2964900">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2964903">func</span>&nbsp;<span class="ident" id="2964908">longestCommonSuffix</span><span class="op" id="2964927">(</span><span class="ident" id="2964928">a</span><span class="op" id="2964929">,</span>&nbsp;<span class="ident" id="2964931">b</span>&nbsp;<span class="builtintype" id="2964933">string</span><span class="op" id="2964939">)</span>&nbsp;<span class="op" id="2964941">(</span><span class="ident" id="2964942">i</span>&nbsp;<span class="builtintype" id="2964944">int</span><span class="op" id="2964947">)</span>&nbsp;<span class="op" id="2964949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964952">for</span>&nbsp;<span class="op" id="2964956">;</span>&nbsp;<span class="ident" id="2964958"><a href="/gostd/strings/search.go.html#2964942">i</a></span>&nbsp;<span class="op" id="2964960">&lt;</span>&nbsp;<span class="builtinfunc" id="2964962">len</span><span class="op" id="2964965">(</span><span class="ident" id="2964966"><a href="/gostd/strings/search.go.html#2964928">a</a></span><span class="op" id="2964967">)</span>&nbsp;<span class="op" id="2964969">&amp;&amp;</span>&nbsp;<span class="ident" id="2964972"><a href="/gostd/strings/search.go.html#2964942">i</a></span>&nbsp;<span class="op" id="2964974">&lt;</span>&nbsp;<span class="builtinfunc" id="2964976">len</span><span class="op" id="2964979">(</span><span class="ident" id="2964980"><a href="/gostd/strings/search.go.html#2964931">b</a></span><span class="op" id="2964981">)</span><span class="op" id="2964982">;</span>&nbsp;<span class="ident" id="2964984"><a href="/gostd/strings/search.go.html#2964942">i</a></span><span class="op" id="2964985">++</span>&nbsp;<span class="op" id="2964988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964992">if</span>&nbsp;<span class="ident" id="2964995"><a href="/gostd/strings/search.go.html#2964928">a</a></span><span class="op" id="2964996">[</span><span class="builtinfunc" id="2964997">len</span><span class="op" id="2965000">(</span><span class="ident" id="2965001"><a href="/gostd/strings/search.go.html#2964928">a</a></span><span class="op" id="2965002">)</span><span class="op" id="2965003">-</span><span class="num" id="2965004">1</span><span class="op" id="2965005">-</span><span class="ident" id="2965006"><a href="/gostd/strings/search.go.html#2964942">i</a></span><span class="op" id="2965007">]</span>&nbsp;<span class="op" id="2965009">!=</span>&nbsp;<span class="ident" id="2965012"><a href="/gostd/strings/search.go.html#2964931">b</a></span><span class="op" id="2965013">[</span><span class="builtinfunc" id="2965014">len</span><span class="op" id="2965017">(</span><span class="ident" id="2965018"><a href="/gostd/strings/search.go.html#2964931">b</a></span><span class="op" id="2965019">)</span><span class="op" id="2965020">-</span><span class="num" id="2965021">1</span><span class="op" id="2965022">-</span><span class="ident" id="2965023"><a href="/gostd/strings/search.go.html#2964942">i</a></span><span class="op" id="2965024">]</span>&nbsp;<span class="op" id="2965026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965031">break</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965045">return</span><br>
<span class="lineno"></span><span class="op" id="2965052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="2965055">//&nbsp;next&nbsp;returns&nbsp;the&nbsp;index&nbsp;in&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;the&nbsp;pattern.&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="2965132">//&nbsp;the&nbsp;pattern&nbsp;is&nbsp;not&nbsp;found,&nbsp;it&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="2965176">func</span>&nbsp;<span class="op" id="2965181">(</span><span class="ident" id="2965182">f</span>&nbsp;<span class="op" id="2965184">*</span><span class="ident" id="2965185"><a href="/gostd/strings/search.go.html#2961807">stringFinder</a></span><span class="op" id="2965197">)</span>&nbsp;<span class="ident" id="2965199">next</span><span class="op" id="2965203">(</span><span class="ident" id="2965204">text</span>&nbsp;<span class="builtintype" id="2965209">string</span><span class="op" id="2965215">)</span>&nbsp;<span class="builtintype" id="2965217">int</span>&nbsp;<span class="op" id="2965221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965224">i</span>&nbsp;<span class="op" id="2965226">:=</span>&nbsp;<span class="builtinfunc" id="2965229">len</span><span class="op" id="2965232">(</span><span class="ident" id="2965233"><a href="/gostd/strings/search.go.html#2965182">f</a></span><span class="op" id="2965234">.</span><span class="ident" id="2965235"><a href="/gostd/strings/search.go.html#2961895">pattern</a></span><span class="op" id="2965242">)</span>&nbsp;<span class="op" id="2965244">-</span>&nbsp;<span class="num" id="2965246">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965249">for</span>&nbsp;<span class="ident" id="2965253"><a href="/gostd/strings/search.go.html#2965224">i</a></span>&nbsp;<span class="op" id="2965255">&lt;</span>&nbsp;<span class="builtinfunc" id="2965257">len</span><span class="op" id="2965260">(</span><span class="ident" id="2965261"><a href="/gostd/strings/search.go.html#2965204">text</a></span><span class="op" id="2965265">)</span>&nbsp;<span class="op" id="2965267">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2965271">//&nbsp;Compare&nbsp;backwards&nbsp;from&nbsp;the&nbsp;end&nbsp;until&nbsp;the&nbsp;first&nbsp;unmatching&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965345">j</span>&nbsp;<span class="op" id="2965347">:=</span>&nbsp;<span class="builtinfunc" id="2965350">len</span><span class="op" id="2965353">(</span><span class="ident" id="2965354"><a href="/gostd/strings/search.go.html#2965182">f</a></span><span class="op" id="2965355">.</span><span class="ident" id="2965356"><a href="/gostd/strings/search.go.html#2961895">pattern</a></span><span class="op" id="2965363">)</span>&nbsp;<span class="op" id="2965365">-</span>&nbsp;<span class="num" id="2965367">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965371">for</span>&nbsp;<span class="ident" id="2965375"><a href="/gostd/strings/search.go.html#2965345">j</a></span>&nbsp;<span class="op" id="2965377">&gt;=</span>&nbsp;<span class="num" id="2965380">0</span>&nbsp;<span class="op" id="2965382">&amp;&amp;</span>&nbsp;<span class="ident" id="2965385"><a href="/gostd/strings/search.go.html#2965204">text</a></span><span class="op" id="2965389">[</span><span class="ident" id="2965390"><a href="/gostd/strings/search.go.html#2965224">i</a></span><span class="op" id="2965391">]</span>&nbsp;<span class="op" id="2965393">==</span>&nbsp;<span class="ident" id="2965396"><a href="/gostd/strings/search.go.html#2965182">f</a></span><span class="op" id="2965397">.</span><span class="ident" id="2965398"><a href="/gostd/strings/search.go.html#2961895">pattern</a></span><span class="op" id="2965405">[</span><span class="ident" id="2965406"><a href="/gostd/strings/search.go.html#2965345">j</a></span><span class="op" id="2965407">]</span>&nbsp;<span class="op" id="2965409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965414"><a href="/gostd/strings/search.go.html#2965224">i</a></span><span class="op" id="2965415">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965421"><a href="/gostd/strings/search.go.html#2965345">j</a></span><span class="op" id="2965422">--</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965431">if</span>&nbsp;<span class="ident" id="2965434"><a href="/gostd/strings/search.go.html#2965345">j</a></span>&nbsp;<span class="op" id="2965436">&lt;</span>&nbsp;<span class="num" id="2965438">0</span>&nbsp;<span class="op" id="2965440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965445">return</span>&nbsp;<span class="ident" id="2965452"><a href="/gostd/strings/search.go.html#2965224">i</a></span>&nbsp;<span class="op" id="2965454">+</span>&nbsp;<span class="num" id="2965456">1</span>&nbsp;<span class="comment" id="2965458">//&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965473"><a href="/gostd/strings/search.go.html#2965224">i</a></span>&nbsp;<span class="op" id="2965475">+=</span>&nbsp;<span class="ident" id="2965478"><a href="/gostd/strings/search.go.html#2965549">max</a></span><span class="op" id="2965481">(</span><span class="ident" id="2965482"><a href="/gostd/strings/search.go.html#2965182">f</a></span><span class="op" id="2965483">.</span><span class="ident" id="2965484"><a href="/gostd/strings/search.go.html#2962290">badCharSkip</a></span><span class="op" id="2965495">[</span><span class="ident" id="2965496"><a href="/gostd/strings/search.go.html#2965204">text</a></span><span class="op" id="2965500">[</span><span class="ident" id="2965501"><a href="/gostd/strings/search.go.html#2965224">i</a></span><span class="op" id="2965502">]</span><span class="op" id="2965503">]</span><span class="op" id="2965504">,</span>&nbsp;<span class="ident" id="2965506"><a href="/gostd/strings/search.go.html#2965182">f</a></span><span class="op" id="2965507">.</span><span class="ident" id="2965508"><a href="/gostd/strings/search.go.html#2963522">goodSuffixSkip</a></span><span class="op" id="2965522">[</span><span class="ident" id="2965523"><a href="/gostd/strings/search.go.html#2965345">j</a></span><span class="op" id="2965524">]</span><span class="op" id="2965525">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965531">return</span>&nbsp;<span class="op" id="2965538">-</span><span class="num" id="2965539">1</span><br>
<span class="lineno"></span><span class="op" id="2965541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2965544">func</span>&nbsp;<span class="ident" id="2965549">max</span><span class="op" id="2965552">(</span><span class="ident" id="2965553">a</span><span class="op" id="2965554">,</span>&nbsp;<span class="ident" id="2965556">b</span>&nbsp;<span class="builtintype" id="2965558">int</span><span class="op" id="2965561">)</span>&nbsp;<span class="builtintype" id="2965563">int</span>&nbsp;<span class="op" id="2965567">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965570">if</span>&nbsp;<span class="ident" id="2965573"><a href="/gostd/strings/search.go.html#2965553">a</a></span>&nbsp;<span class="op" id="2965575">&gt;</span>&nbsp;<span class="ident" id="2965577"><a href="/gostd/strings/search.go.html#2965556">b</a></span>&nbsp;<span class="op" id="2965579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965583">return</span>&nbsp;<span class="ident" id="2965590"><a href="/gostd/strings/search.go.html#2965553">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965596">return</span>&nbsp;<span class="ident" id="2965603"><a href="/gostd/strings/search.go.html#2965556">b</a></span><br>
<span class="lineno"></span><span class="op" id="2965605">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
