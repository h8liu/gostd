<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html" class="current">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5098783">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5098838">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5098892">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5098943">package</span>&nbsp;<span class="ident" id="5098951">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5098961">import</span>&nbsp;<span class="op" id="5098968">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5098971">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5098978">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5098984">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5098997">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5099014">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5099022">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5099039">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5099061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5099064">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="5099144">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="5099171">type</span>&nbsp;<span class="ident" id="5099176">Template</span>&nbsp;<span class="keyword" id="5099185">struct</span>&nbsp;<span class="op" id="5099192">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5099195">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5099231">escapeErr</span>&nbsp;<span class="builtintype" id="5099241">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5099248">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5099322">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5099391">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5099415">text</span>&nbsp;<span class="op" id="5099420">*</span><span class="ident" id="5099421">template</span><span class="op" id="5099429">.</span><span class="ident" id="5099430">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5099440">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5099507">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5099518">*</span><span class="ident" id="5099519">parse</span><span class="op" id="5099524">.</span><span class="ident" id="5099525">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5099531">*</span><span class="ident" id="5099532">nameSpace</span>&nbsp;<span class="comment" id="5099542">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="5099580">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5099583">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="5099648">var</span>&nbsp;<span class="ident" id="5099652">escapeOK</span>&nbsp;<span class="op" id="5099661">=</span>&nbsp;<span class="ident" id="5099663">fmt</span><span class="op" id="5099666">.</span><span class="ident" id="5099667">Errorf</span><span class="op" id="5099673">(</span><span class="string" id="5099674">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="5099702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5099705">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="5099783">type</span>&nbsp;<span class="ident" id="5099788">nameSpace</span>&nbsp;<span class="keyword" id="5099798">struct</span>&nbsp;<span class="op" id="5099805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5099808">mu</span>&nbsp;&nbsp;<span class="ident" id="5099812">sync</span><span class="op" id="5099816">.</span><span class="ident" id="5099817">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5099824">set</span>&nbsp;<span class="keyword" id="5099828">map</span><span class="op" id="5099831">[</span><span class="builtintype" id="5099832">string</span><span class="op" id="5099838">]</span><span class="op" id="5099839">*</span><span class="ident" id="5099840">Template</span><br>
<span class="lineno"></span><span class="op" id="5099849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5099852">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="5099929">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5099940">func</span>&nbsp;<span class="op" id="5099945">(</span><span class="ident" id="5099946">t</span>&nbsp;<span class="op" id="5099948">*</span><span class="ident" id="5099949">Template</span><span class="op" id="5099957">)</span>&nbsp;<span class="ident" id="5099959">Templates</span><span class="op" id="5099968">(</span><span class="op" id="5099969">)</span>&nbsp;<span class="op" id="5099971">[</span><span class="op" id="5099972">]</span><span class="op" id="5099973">*</span><span class="ident" id="5099974">Template</span>&nbsp;<span class="op" id="5099983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5099986">ns</span>&nbsp;<span class="op" id="5099989">:=</span>&nbsp;<span class="ident" id="5099992">t</span><span class="op" id="5099993">.</span><span class="ident" id="5099994">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5100005">ns</span><span class="op" id="5100007">.</span><span class="ident" id="5100008">mu</span><span class="op" id="5100010">.</span><span class="ident" id="5100011">Lock</span><span class="op" id="5100015">(</span><span class="op" id="5100016">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100019">defer</span>&nbsp;<span class="ident" id="5100025">ns</span><span class="op" id="5100027">.</span><span class="ident" id="5100028">mu</span><span class="op" id="5100030">.</span><span class="ident" id="5100031">Unlock</span><span class="op" id="5100037">(</span><span class="op" id="5100038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5100041">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5100088">m</span>&nbsp;<span class="op" id="5100090">:=</span>&nbsp;<span class="builtinfunc" id="5100093">make</span><span class="op" id="5100097">(</span><span class="op" id="5100098">[</span><span class="op" id="5100099">]</span><span class="op" id="5100100">*</span><span class="ident" id="5100101">Template</span><span class="op" id="5100109">,</span>&nbsp;<span class="num" id="5100111">0</span><span class="op" id="5100112">,</span>&nbsp;<span class="builtinfunc" id="5100114">len</span><span class="op" id="5100117">(</span><span class="ident" id="5100118">ns</span><span class="op" id="5100120">.</span><span class="ident" id="5100121">set</span><span class="op" id="5100124">)</span><span class="op" id="5100125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100128">for</span>&nbsp;<span class="ident" id="5100132">_</span><span class="op" id="5100133">,</span>&nbsp;<span class="ident" id="5100135">v</span>&nbsp;<span class="op" id="5100137">:=</span>&nbsp;<span class="keyword" id="5100140">range</span>&nbsp;<span class="ident" id="5100146">ns</span><span class="op" id="5100148">.</span><span class="ident" id="5100149">set</span>&nbsp;<span class="op" id="5100153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5100157">m</span>&nbsp;<span class="op" id="5100159">=</span>&nbsp;<span class="builtinfunc" id="5100161">append</span><span class="op" id="5100167">(</span><span class="ident" id="5100168">m</span><span class="op" id="5100169">,</span>&nbsp;<span class="ident" id="5100171">v</span><span class="op" id="5100172">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5100175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100178">return</span>&nbsp;<span class="ident" id="5100185">m</span><br>
<span class="lineno"></span><span class="op" id="5100187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5100190">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="5100234">func</span>&nbsp;<span class="op" id="5100239">(</span><span class="ident" id="5100240">t</span>&nbsp;<span class="op" id="5100242">*</span><span class="ident" id="5100243">Template</span><span class="op" id="5100251">)</span>&nbsp;<span class="ident" id="5100253">escape</span><span class="op" id="5100259">(</span><span class="op" id="5100260">)</span>&nbsp;<span class="builtintype" id="5100262">error</span>&nbsp;<span class="op" id="5100268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5100271">t</span><span class="op" id="5100272">.</span><span class="ident" id="5100273">nameSpace</span><span class="op" id="5100282">.</span><span class="ident" id="5100283">mu</span><span class="op" id="5100285">.</span><span class="ident" id="5100286">Lock</span><span class="op" id="5100290">(</span><span class="op" id="5100291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100294">defer</span>&nbsp;<span class="ident" id="5100300">t</span><span class="op" id="5100301">.</span><span class="ident" id="5100302">nameSpace</span><span class="op" id="5100311">.</span><span class="ident" id="5100312">mu</span><span class="op" id="5100314">.</span><span class="ident" id="5100315">Unlock</span><span class="op" id="5100321">(</span><span class="op" id="5100322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100325">if</span>&nbsp;<span class="ident" id="5100328">t</span><span class="op" id="5100329">.</span><span class="ident" id="5100330">escapeErr</span>&nbsp;<span class="op" id="5100340">==</span>&nbsp;<span class="ident" id="5100343">nil</span>&nbsp;<span class="op" id="5100347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100351">if</span>&nbsp;<span class="ident" id="5100354">err</span>&nbsp;<span class="op" id="5100358">:=</span>&nbsp;<span class="ident" id="5100361">escapeTemplate</span><span class="op" id="5100375">(</span><span class="ident" id="5100376">t</span><span class="op" id="5100377">,</span>&nbsp;<span class="ident" id="5100379">t</span><span class="op" id="5100380">.</span><span class="ident" id="5100381">text</span><span class="op" id="5100385">.</span><span class="ident" id="5100386">Root</span><span class="op" id="5100390">,</span>&nbsp;<span class="ident" id="5100392">t</span><span class="op" id="5100393">.</span><span class="ident" id="5100394">Name</span><span class="op" id="5100398">(</span><span class="op" id="5100399">)</span><span class="op" id="5100400">)</span><span class="op" id="5100401">;</span>&nbsp;<span class="ident" id="5100403">err</span>&nbsp;<span class="op" id="5100407">!=</span>&nbsp;<span class="ident" id="5100410">nil</span>&nbsp;<span class="op" id="5100414">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100419">return</span>&nbsp;<span class="ident" id="5100426">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5100432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5100435">}</span>&nbsp;<span class="keyword" id="5100437">else</span>&nbsp;<span class="keyword" id="5100442">if</span>&nbsp;<span class="ident" id="5100445">t</span><span class="op" id="5100446">.</span><span class="ident" id="5100447">escapeErr</span>&nbsp;<span class="op" id="5100457">!=</span>&nbsp;<span class="ident" id="5100460">escapeOK</span>&nbsp;<span class="op" id="5100469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100473">return</span>&nbsp;<span class="ident" id="5100480">t</span><span class="op" id="5100481">.</span><span class="ident" id="5100482">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5100493">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100496">return</span>&nbsp;<span class="ident" id="5100503">nil</span><br>
<span class="lineno"></span><span class="op" id="5100507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5100510">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5100577">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="5100606">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5100674">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5100747">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5100769">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5100819">func</span>&nbsp;<span class="op" id="5100824">(</span><span class="ident" id="5100825">t</span>&nbsp;<span class="op" id="5100827">*</span><span class="ident" id="5100828">Template</span><span class="op" id="5100836">)</span>&nbsp;<span class="ident" id="5100838">Execute</span><span class="op" id="5100845">(</span><span class="ident" id="5100846">wr</span>&nbsp;<span class="ident" id="5100849">io</span><span class="op" id="5100851">.</span><span class="ident" id="5100852">Writer</span><span class="op" id="5100858">,</span>&nbsp;<span class="ident" id="5100860">data</span>&nbsp;<span class="keyword" id="5100865">interface</span><span class="op" id="5100874">{</span><span class="op" id="5100875">}</span><span class="op" id="5100876">)</span>&nbsp;<span class="builtintype" id="5100878">error</span>&nbsp;<span class="op" id="5100884">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100887">if</span>&nbsp;<span class="ident" id="5100890">err</span>&nbsp;<span class="op" id="5100894">:=</span>&nbsp;<span class="ident" id="5100897">t</span><span class="op" id="5100898">.</span><span class="ident" id="5100899">escape</span><span class="op" id="5100905">(</span><span class="op" id="5100906">)</span><span class="op" id="5100907">;</span>&nbsp;<span class="ident" id="5100909">err</span>&nbsp;<span class="op" id="5100913">!=</span>&nbsp;<span class="ident" id="5100916">nil</span>&nbsp;<span class="op" id="5100920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100924">return</span>&nbsp;<span class="ident" id="5100931">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5100936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5100939">return</span>&nbsp;<span class="ident" id="5100946">t</span><span class="op" id="5100947">.</span><span class="ident" id="5100948">text</span><span class="op" id="5100952">.</span><span class="ident" id="5100953">Execute</span><span class="op" id="5100960">(</span><span class="ident" id="5100961">wr</span><span class="op" id="5100963">,</span>&nbsp;<span class="ident" id="5100965">data</span><span class="op" id="5100969">)</span><br>
<span class="lineno"></span><span class="op" id="5100971">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5100974">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5101051">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5101117">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5101185">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="5101258">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5101280">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5101330">func</span>&nbsp;<span class="op" id="5101335">(</span><span class="ident" id="5101336">t</span>&nbsp;<span class="op" id="5101338">*</span><span class="ident" id="5101339">Template</span><span class="op" id="5101347">)</span>&nbsp;<span class="ident" id="5101349">ExecuteTemplate</span><span class="op" id="5101364">(</span><span class="ident" id="5101365">wr</span>&nbsp;<span class="ident" id="5101368">io</span><span class="op" id="5101370">.</span><span class="ident" id="5101371">Writer</span><span class="op" id="5101377">,</span>&nbsp;<span class="ident" id="5101379">name</span>&nbsp;<span class="builtintype" id="5101384">string</span><span class="op" id="5101390">,</span>&nbsp;<span class="ident" id="5101392">data</span>&nbsp;<span class="keyword" id="5101397">interface</span><span class="op" id="5101406">{</span><span class="op" id="5101407">}</span><span class="op" id="5101408">)</span>&nbsp;<span class="builtintype" id="5101410">error</span>&nbsp;<span class="op" id="5101416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101419">tmpl</span><span class="op" id="5101423">,</span>&nbsp;<span class="ident" id="5101425">err</span>&nbsp;<span class="op" id="5101429">:=</span>&nbsp;<span class="ident" id="5101432">t</span><span class="op" id="5101433">.</span><span class="ident" id="5101434">lookupAndEscapeTemplate</span><span class="op" id="5101457">(</span><span class="ident" id="5101458">name</span><span class="op" id="5101462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5101465">if</span>&nbsp;<span class="ident" id="5101468">err</span>&nbsp;<span class="op" id="5101472">!=</span>&nbsp;<span class="ident" id="5101475">nil</span>&nbsp;<span class="op" id="5101479">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5101483">return</span>&nbsp;<span class="ident" id="5101490">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5101495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5101498">return</span>&nbsp;<span class="ident" id="5101505">tmpl</span><span class="op" id="5101509">.</span><span class="ident" id="5101510">text</span><span class="op" id="5101514">.</span><span class="ident" id="5101515">Execute</span><span class="op" id="5101522">(</span><span class="ident" id="5101523">wr</span><span class="op" id="5101525">,</span>&nbsp;<span class="ident" id="5101527">data</span><span class="op" id="5101531">)</span><br>
<span class="lineno"></span><span class="op" id="5101533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="5101536">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5101612">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="5101685">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5101698">func</span>&nbsp;<span class="op" id="5101703">(</span><span class="ident" id="5101704">t</span>&nbsp;<span class="op" id="5101706">*</span><span class="ident" id="5101707">Template</span><span class="op" id="5101715">)</span>&nbsp;<span class="ident" id="5101717">lookupAndEscapeTemplate</span><span class="op" id="5101740">(</span><span class="ident" id="5101741">name</span>&nbsp;<span class="builtintype" id="5101746">string</span><span class="op" id="5101752">)</span>&nbsp;<span class="op" id="5101754">(</span><span class="ident" id="5101755">tmpl</span>&nbsp;<span class="op" id="5101760">*</span><span class="ident" id="5101761">Template</span><span class="op" id="5101769">,</span>&nbsp;<span class="ident" id="5101771">err</span>&nbsp;<span class="builtintype" id="5101775">error</span><span class="op" id="5101780">)</span>&nbsp;<span class="op" id="5101782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101785">t</span><span class="op" id="5101786">.</span><span class="ident" id="5101787">nameSpace</span><span class="op" id="5101796">.</span><span class="ident" id="5101797">mu</span><span class="op" id="5101799">.</span><span class="ident" id="5101800">Lock</span><span class="op" id="5101804">(</span><span class="op" id="5101805">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5101808">defer</span>&nbsp;<span class="ident" id="5101814">t</span><span class="op" id="5101815">.</span><span class="ident" id="5101816">nameSpace</span><span class="op" id="5101825">.</span><span class="ident" id="5101826">mu</span><span class="op" id="5101828">.</span><span class="ident" id="5101829">Unlock</span><span class="op" id="5101835">(</span><span class="op" id="5101836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5101839">tmpl</span>&nbsp;<span class="op" id="5101844">=</span>&nbsp;<span class="ident" id="5101846">t</span><span class="op" id="5101847">.</span><span class="ident" id="5101848">set</span><span class="op" id="5101851">[</span><span class="ident" id="5101852">name</span><span class="op" id="5101856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5101859">if</span>&nbsp;<span class="ident" id="5101862">tmpl</span>&nbsp;<span class="op" id="5101867">==</span>&nbsp;<span class="ident" id="5101870">nil</span>&nbsp;<span class="op" id="5101874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5101878">return</span>&nbsp;<span class="ident" id="5101885">nil</span><span class="op" id="5101888">,</span>&nbsp;<span class="ident" id="5101890">fmt</span><span class="op" id="5101893">.</span><span class="ident" id="5101894">Errorf</span><span class="op" id="5101900">(</span><span class="string" id="5101901">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="5101933">,</span>&nbsp;<span class="ident" id="5101935">name</span><span class="op" id="5101939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5101942">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5101945">if</span>&nbsp;<span class="ident" id="5101948">tmpl</span><span class="op" id="5101952">.</span><span class="ident" id="5101953">escapeErr</span>&nbsp;<span class="op" id="5101963">!=</span>&nbsp;<span class="ident" id="5101966">nil</span>&nbsp;<span class="op" id="5101970">&amp;&amp;</span>&nbsp;<span class="ident" id="5101973">tmpl</span><span class="op" id="5101977">.</span><span class="ident" id="5101978">escapeErr</span>&nbsp;<span class="op" id="5101988">!=</span>&nbsp;<span class="ident" id="5101991">escapeOK</span>&nbsp;<span class="op" id="5102000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5102004">return</span>&nbsp;<span class="ident" id="5102011">nil</span><span class="op" id="5102014">,</span>&nbsp;<span class="ident" id="5102016">tmpl</span><span class="op" id="5102020">.</span><span class="ident" id="5102021">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5102032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5102035">if</span>&nbsp;<span class="ident" id="5102038">tmpl</span><span class="op" id="5102042">.</span><span class="ident" id="5102043">text</span><span class="op" id="5102047">.</span><span class="ident" id="5102048">Tree</span>&nbsp;<span class="op" id="5102053">==</span>&nbsp;<span class="ident" id="5102056">nil</span>&nbsp;<span class="op" id="5102060">||</span>&nbsp;<span class="ident" id="5102063">tmpl</span><span class="op" id="5102067">.</span><span class="ident" id="5102068">text</span><span class="op" id="5102072">.</span><span class="ident" id="5102073">Root</span>&nbsp;<span class="op" id="5102078">==</span>&nbsp;<span class="ident" id="5102081">nil</span>&nbsp;<span class="op" id="5102085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5102089">return</span>&nbsp;<span class="ident" id="5102096">nil</span><span class="op" id="5102099">,</span>&nbsp;<span class="ident" id="5102101">fmt</span><span class="op" id="5102104">.</span><span class="ident" id="5102105">Errorf</span><span class="op" id="5102111">(</span><span class="string" id="5102112">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="5102157">,</span>&nbsp;<span class="ident" id="5102159">name</span><span class="op" id="5102163">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5102166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5102169">if</span>&nbsp;<span class="ident" id="5102172">t</span><span class="op" id="5102173">.</span><span class="ident" id="5102174">text</span><span class="op" id="5102178">.</span><span class="ident" id="5102179">Lookup</span><span class="op" id="5102185">(</span><span class="ident" id="5102186">name</span><span class="op" id="5102190">)</span>&nbsp;<span class="op" id="5102192">==</span>&nbsp;<span class="ident" id="5102195">nil</span>&nbsp;<span class="op" id="5102199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5102203">panic</span><span class="op" id="5102208">(</span><span class="string" id="5102209">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="5102270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5102273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5102276">if</span>&nbsp;<span class="ident" id="5102279">tmpl</span><span class="op" id="5102283">.</span><span class="ident" id="5102284">escapeErr</span>&nbsp;<span class="op" id="5102294">==</span>&nbsp;<span class="ident" id="5102297">nil</span>&nbsp;<span class="op" id="5102301">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102305">err</span>&nbsp;<span class="op" id="5102309">=</span>&nbsp;<span class="ident" id="5102311">escapeTemplate</span><span class="op" id="5102325">(</span><span class="ident" id="5102326">tmpl</span><span class="op" id="5102330">,</span>&nbsp;<span class="ident" id="5102332">tmpl</span><span class="op" id="5102336">.</span><span class="ident" id="5102337">text</span><span class="op" id="5102341">.</span><span class="ident" id="5102342">Root</span><span class="op" id="5102346">,</span>&nbsp;<span class="ident" id="5102348">name</span><span class="op" id="5102352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5102355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5102358">return</span>&nbsp;<span class="ident" id="5102365">tmpl</span><span class="op" id="5102369">,</span>&nbsp;<span class="ident" id="5102371">err</span><br>
<span class="lineno"></span><span class="op" id="5102375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5102378">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="5102448">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5102514">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="5102586">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="5102659">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="5102723">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="5102794">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5102861">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="5102919">func</span>&nbsp;<span class="op" id="5102924">(</span><span class="ident" id="5102925">t</span>&nbsp;<span class="op" id="5102927">*</span><span class="ident" id="5102928">Template</span><span class="op" id="5102936">)</span>&nbsp;<span class="ident" id="5102938">Parse</span><span class="op" id="5102943">(</span><span class="ident" id="5102944">src</span>&nbsp;<span class="builtintype" id="5102948">string</span><span class="op" id="5102954">)</span>&nbsp;<span class="op" id="5102956">(</span><span class="op" id="5102957">*</span><span class="ident" id="5102958">Template</span><span class="op" id="5102966">,</span>&nbsp;<span class="builtintype" id="5102968">error</span><span class="op" id="5102973">)</span>&nbsp;<span class="op" id="5102975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5102978">t</span><span class="op" id="5102979">.</span><span class="ident" id="5102980">nameSpace</span><span class="op" id="5102989">.</span><span class="ident" id="5102990">mu</span><span class="op" id="5102992">.</span><span class="ident" id="5102993">Lock</span><span class="op" id="5102997">(</span><span class="op" id="5102998">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103001">t</span><span class="op" id="5103002">.</span><span class="ident" id="5103003">escapeErr</span>&nbsp;<span class="op" id="5103013">=</span>&nbsp;<span class="ident" id="5103015">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103020">t</span><span class="op" id="5103021">.</span><span class="ident" id="5103022">nameSpace</span><span class="op" id="5103031">.</span><span class="ident" id="5103032">mu</span><span class="op" id="5103034">.</span><span class="ident" id="5103035">Unlock</span><span class="op" id="5103041">(</span><span class="op" id="5103042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103045">ret</span><span class="op" id="5103048">,</span>&nbsp;<span class="ident" id="5103050">err</span>&nbsp;<span class="op" id="5103054">:=</span>&nbsp;<span class="ident" id="5103057">t</span><span class="op" id="5103058">.</span><span class="ident" id="5103059">text</span><span class="op" id="5103063">.</span><span class="ident" id="5103064">Parse</span><span class="op" id="5103069">(</span><span class="ident" id="5103070">src</span><span class="op" id="5103073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103076">if</span>&nbsp;<span class="ident" id="5103079">err</span>&nbsp;<span class="op" id="5103083">!=</span>&nbsp;<span class="ident" id="5103086">nil</span>&nbsp;<span class="op" id="5103090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103094">return</span>&nbsp;<span class="ident" id="5103101">nil</span><span class="op" id="5103104">,</span>&nbsp;<span class="ident" id="5103106">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5103111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103114">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103184">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103237">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103298">t</span><span class="op" id="5103299">.</span><span class="ident" id="5103300">nameSpace</span><span class="op" id="5103309">.</span><span class="ident" id="5103310">mu</span><span class="op" id="5103312">.</span><span class="ident" id="5103313">Lock</span><span class="op" id="5103317">(</span><span class="op" id="5103318">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103321">defer</span>&nbsp;<span class="ident" id="5103327">t</span><span class="op" id="5103328">.</span><span class="ident" id="5103329">nameSpace</span><span class="op" id="5103338">.</span><span class="ident" id="5103339">mu</span><span class="op" id="5103341">.</span><span class="ident" id="5103342">Unlock</span><span class="op" id="5103348">(</span><span class="op" id="5103349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103352">for</span>&nbsp;<span class="ident" id="5103356">_</span><span class="op" id="5103357">,</span>&nbsp;<span class="ident" id="5103359">v</span>&nbsp;<span class="op" id="5103361">:=</span>&nbsp;<span class="keyword" id="5103364">range</span>&nbsp;<span class="ident" id="5103370">ret</span><span class="op" id="5103373">.</span><span class="ident" id="5103374">Templates</span><span class="op" id="5103383">(</span><span class="op" id="5103384">)</span>&nbsp;<span class="op" id="5103386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103390">name</span>&nbsp;<span class="op" id="5103395">:=</span>&nbsp;<span class="ident" id="5103398">v</span><span class="op" id="5103399">.</span><span class="ident" id="5103400">Name</span><span class="op" id="5103404">(</span><span class="op" id="5103405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103409">tmpl</span>&nbsp;<span class="op" id="5103414">:=</span>&nbsp;<span class="ident" id="5103417">t</span><span class="op" id="5103418">.</span><span class="ident" id="5103419">set</span><span class="op" id="5103422">[</span><span class="ident" id="5103423">name</span><span class="op" id="5103427">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103431">if</span>&nbsp;<span class="ident" id="5103434">tmpl</span>&nbsp;<span class="op" id="5103439">==</span>&nbsp;<span class="ident" id="5103442">nil</span>&nbsp;<span class="op" id="5103446">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103451">tmpl</span>&nbsp;<span class="op" id="5103456">=</span>&nbsp;<span class="ident" id="5103458">t</span><span class="op" id="5103459">.</span><span class="builtinfunc" id="5103460">new</span><span class="op" id="5103463">(</span><span class="ident" id="5103464">name</span><span class="op" id="5103468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5103472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5103476">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103555">tmpl</span><span class="op" id="5103559">.</span><span class="ident" id="5103560">escapeErr</span>&nbsp;<span class="op" id="5103570">=</span>&nbsp;<span class="ident" id="5103572">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103578">tmpl</span><span class="op" id="5103582">.</span><span class="ident" id="5103583">text</span>&nbsp;<span class="op" id="5103588">=</span>&nbsp;<span class="ident" id="5103590">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103594">tmpl</span><span class="op" id="5103598">.</span><span class="ident" id="5103599">Tree</span>&nbsp;<span class="op" id="5103604">=</span>&nbsp;<span class="ident" id="5103606">v</span><span class="op" id="5103607">.</span><span class="ident" id="5103608">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5103614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103617">return</span>&nbsp;<span class="ident" id="5103624">t</span><span class="op" id="5103625">,</span>&nbsp;<span class="ident" id="5103627">nil</span><br>
<span class="lineno"></span><span class="op" id="5103631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="5103634">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="5103702">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="5103731">//</span><br>
<span class="lineno"></span><span class="comment" id="5103734">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5103789">func</span>&nbsp;<span class="op" id="5103794">(</span><span class="ident" id="5103795">t</span>&nbsp;<span class="op" id="5103797">*</span><span class="ident" id="5103798">Template</span><span class="op" id="5103806">)</span>&nbsp;<span class="ident" id="5103808">AddParseTree</span><span class="op" id="5103820">(</span><span class="ident" id="5103821">name</span>&nbsp;<span class="builtintype" id="5103826">string</span><span class="op" id="5103832">,</span>&nbsp;<span class="ident" id="5103834">tree</span>&nbsp;<span class="op" id="5103839">*</span><span class="ident" id="5103840">parse</span><span class="op" id="5103845">.</span><span class="ident" id="5103846">Tree</span><span class="op" id="5103850">)</span>&nbsp;<span class="op" id="5103852">(</span><span class="op" id="5103853">*</span><span class="ident" id="5103854">Template</span><span class="op" id="5103862">,</span>&nbsp;<span class="builtintype" id="5103864">error</span><span class="op" id="5103869">)</span>&nbsp;<span class="op" id="5103871">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5103874">t</span><span class="op" id="5103875">.</span><span class="ident" id="5103876">nameSpace</span><span class="op" id="5103885">.</span><span class="ident" id="5103886">mu</span><span class="op" id="5103888">.</span><span class="ident" id="5103889">Lock</span><span class="op" id="5103893">(</span><span class="op" id="5103894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103897">defer</span>&nbsp;<span class="ident" id="5103903">t</span><span class="op" id="5103904">.</span><span class="ident" id="5103905">nameSpace</span><span class="op" id="5103914">.</span><span class="ident" id="5103915">mu</span><span class="op" id="5103917">.</span><span class="ident" id="5103918">Unlock</span><span class="op" id="5103924">(</span><span class="op" id="5103925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103928">if</span>&nbsp;<span class="ident" id="5103931">t</span><span class="op" id="5103932">.</span><span class="ident" id="5103933">escapeErr</span>&nbsp;<span class="op" id="5103943">!=</span>&nbsp;<span class="ident" id="5103946">nil</span>&nbsp;<span class="op" id="5103950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5103954">return</span>&nbsp;<span class="ident" id="5103961">nil</span><span class="op" id="5103964">,</span>&nbsp;<span class="ident" id="5103966">fmt</span><span class="op" id="5103969">.</span><span class="ident" id="5103970">Errorf</span><span class="op" id="5103976">(</span><span class="string" id="5103977">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5104041">,</span>&nbsp;<span class="ident" id="5104043">t</span><span class="op" id="5104044">.</span><span class="ident" id="5104045">Name</span><span class="op" id="5104049">(</span><span class="op" id="5104050">)</span><span class="op" id="5104051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104054">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104057">text</span><span class="op" id="5104061">,</span>&nbsp;<span class="ident" id="5104063">err</span>&nbsp;<span class="op" id="5104067">:=</span>&nbsp;<span class="ident" id="5104070">t</span><span class="op" id="5104071">.</span><span class="ident" id="5104072">text</span><span class="op" id="5104076">.</span><span class="ident" id="5104077">AddParseTree</span><span class="op" id="5104089">(</span><span class="ident" id="5104090">name</span><span class="op" id="5104094">,</span>&nbsp;<span class="ident" id="5104096">tree</span><span class="op" id="5104100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104103">if</span>&nbsp;<span class="ident" id="5104106">err</span>&nbsp;<span class="op" id="5104110">!=</span>&nbsp;<span class="ident" id="5104113">nil</span>&nbsp;<span class="op" id="5104117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104121">return</span>&nbsp;<span class="ident" id="5104128">nil</span><span class="op" id="5104131">,</span>&nbsp;<span class="ident" id="5104133">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104141">ret</span>&nbsp;<span class="op" id="5104145">:=</span>&nbsp;<span class="op" id="5104148">&amp;</span><span class="ident" id="5104149">Template</span><span class="op" id="5104157">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104161">nil</span><span class="op" id="5104164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104168">text</span><span class="op" id="5104172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104176">text</span><span class="op" id="5104180">.</span><span class="ident" id="5104181">Tree</span><span class="op" id="5104185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104189">t</span><span class="op" id="5104190">.</span><span class="ident" id="5104191">nameSpace</span><span class="op" id="5104200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104203">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104206">t</span><span class="op" id="5104207">.</span><span class="ident" id="5104208">set</span><span class="op" id="5104211">[</span><span class="ident" id="5104212">name</span><span class="op" id="5104216">]</span>&nbsp;<span class="op" id="5104218">=</span>&nbsp;<span class="ident" id="5104220">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104225">return</span>&nbsp;<span class="ident" id="5104232">ret</span><span class="op" id="5104235">,</span>&nbsp;<span class="ident" id="5104237">nil</span><br>
<span class="lineno"></span><span class="op" id="5104241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5104244">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="5104315">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5104392">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="5104467">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="5104546">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="5104624">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="5104675">//</span><br>
<span class="lineno"></span><span class="comment" id="5104678">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5104733">func</span>&nbsp;<span class="op" id="5104738">(</span><span class="ident" id="5104739">t</span>&nbsp;<span class="op" id="5104741">*</span><span class="ident" id="5104742">Template</span><span class="op" id="5104750">)</span>&nbsp;<span class="ident" id="5104752">Clone</span><span class="op" id="5104757">(</span><span class="op" id="5104758">)</span>&nbsp;<span class="op" id="5104760">(</span><span class="op" id="5104761">*</span><span class="ident" id="5104762">Template</span><span class="op" id="5104770">,</span>&nbsp;<span class="builtintype" id="5104772">error</span><span class="op" id="5104777">)</span>&nbsp;<span class="op" id="5104779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104782">t</span><span class="op" id="5104783">.</span><span class="ident" id="5104784">nameSpace</span><span class="op" id="5104793">.</span><span class="ident" id="5104794">mu</span><span class="op" id="5104796">.</span><span class="ident" id="5104797">Lock</span><span class="op" id="5104801">(</span><span class="op" id="5104802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104805">defer</span>&nbsp;<span class="ident" id="5104811">t</span><span class="op" id="5104812">.</span><span class="ident" id="5104813">nameSpace</span><span class="op" id="5104822">.</span><span class="ident" id="5104823">mu</span><span class="op" id="5104825">.</span><span class="ident" id="5104826">Unlock</span><span class="op" id="5104832">(</span><span class="op" id="5104833">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104836">if</span>&nbsp;<span class="ident" id="5104839">t</span><span class="op" id="5104840">.</span><span class="ident" id="5104841">escapeErr</span>&nbsp;<span class="op" id="5104851">!=</span>&nbsp;<span class="ident" id="5104854">nil</span>&nbsp;<span class="op" id="5104858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104862">return</span>&nbsp;<span class="ident" id="5104869">nil</span><span class="op" id="5104872">,</span>&nbsp;<span class="ident" id="5104874">fmt</span><span class="op" id="5104877">.</span><span class="ident" id="5104878">Errorf</span><span class="op" id="5104884">(</span><span class="string" id="5104885">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5104939">,</span>&nbsp;<span class="ident" id="5104941">t</span><span class="op" id="5104942">.</span><span class="ident" id="5104943">Name</span><span class="op" id="5104947">(</span><span class="op" id="5104948">)</span><span class="op" id="5104949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5104952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5104955">textClone</span><span class="op" id="5104964">,</span>&nbsp;<span class="ident" id="5104966">err</span>&nbsp;<span class="op" id="5104970">:=</span>&nbsp;<span class="ident" id="5104973">t</span><span class="op" id="5104974">.</span><span class="ident" id="5104975">text</span><span class="op" id="5104979">.</span><span class="ident" id="5104980">Clone</span><span class="op" id="5104985">(</span><span class="op" id="5104986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5104989">if</span>&nbsp;<span class="ident" id="5104992">err</span>&nbsp;<span class="op" id="5104996">!=</span>&nbsp;<span class="ident" id="5104999">nil</span>&nbsp;<span class="op" id="5105003">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105007">return</span>&nbsp;<span class="ident" id="5105014">nil</span><span class="op" id="5105017">,</span>&nbsp;<span class="ident" id="5105019">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105027">ret</span>&nbsp;<span class="op" id="5105031">:=</span>&nbsp;<span class="op" id="5105034">&amp;</span><span class="ident" id="5105035">Template</span><span class="op" id="5105043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105047">nil</span><span class="op" id="5105050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105054">textClone</span><span class="op" id="5105063">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105067">textClone</span><span class="op" id="5105076">.</span><span class="ident" id="5105077">Tree</span><span class="op" id="5105081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105085">&amp;</span><span class="ident" id="5105086">nameSpace</span><span class="op" id="5105095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105100">set</span><span class="op" id="5105103">:</span>&nbsp;<span class="builtinfunc" id="5105105">make</span><span class="op" id="5105109">(</span><span class="keyword" id="5105110">map</span><span class="op" id="5105113">[</span><span class="builtintype" id="5105114">string</span><span class="op" id="5105120">]</span><span class="op" id="5105121">*</span><span class="ident" id="5105122">Template</span><span class="op" id="5105130">)</span><span class="op" id="5105131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105135">}</span><span class="op" id="5105136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105139">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105142">for</span>&nbsp;<span class="ident" id="5105146">_</span><span class="op" id="5105147">,</span>&nbsp;<span class="ident" id="5105149">x</span>&nbsp;<span class="op" id="5105151">:=</span>&nbsp;<span class="keyword" id="5105154">range</span>&nbsp;<span class="ident" id="5105160">textClone</span><span class="op" id="5105169">.</span><span class="ident" id="5105170">Templates</span><span class="op" id="5105179">(</span><span class="op" id="5105180">)</span>&nbsp;<span class="op" id="5105182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105186">name</span>&nbsp;<span class="op" id="5105191">:=</span>&nbsp;<span class="ident" id="5105194">x</span><span class="op" id="5105195">.</span><span class="ident" id="5105196">Name</span><span class="op" id="5105200">(</span><span class="op" id="5105201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105205">src</span>&nbsp;<span class="op" id="5105209">:=</span>&nbsp;<span class="ident" id="5105212">t</span><span class="op" id="5105213">.</span><span class="ident" id="5105214">set</span><span class="op" id="5105217">[</span><span class="ident" id="5105218">name</span><span class="op" id="5105222">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105226">if</span>&nbsp;<span class="ident" id="5105229">src</span>&nbsp;<span class="op" id="5105233">==</span>&nbsp;<span class="ident" id="5105236">nil</span>&nbsp;<span class="op" id="5105240">||</span>&nbsp;<span class="ident" id="5105243">src</span><span class="op" id="5105246">.</span><span class="ident" id="5105247">escapeErr</span>&nbsp;<span class="op" id="5105257">!=</span>&nbsp;<span class="ident" id="5105260">nil</span>&nbsp;<span class="op" id="5105264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105269">return</span>&nbsp;<span class="ident" id="5105276">nil</span><span class="op" id="5105279">,</span>&nbsp;<span class="ident" id="5105281">fmt</span><span class="op" id="5105284">.</span><span class="ident" id="5105285">Errorf</span><span class="op" id="5105291">(</span><span class="string" id="5105292">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5105346">,</span>&nbsp;<span class="ident" id="5105348">t</span><span class="op" id="5105349">.</span><span class="ident" id="5105350">Name</span><span class="op" id="5105354">(</span><span class="op" id="5105355">)</span><span class="op" id="5105356">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105364">x</span><span class="op" id="5105365">.</span><span class="ident" id="5105366">Tree</span>&nbsp;<span class="op" id="5105371">=</span>&nbsp;<span class="ident" id="5105373">x</span><span class="op" id="5105374">.</span><span class="ident" id="5105375">Tree</span><span class="op" id="5105379">.</span><span class="ident" id="5105380">Copy</span><span class="op" id="5105384">(</span><span class="op" id="5105385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105389">ret</span><span class="op" id="5105392">.</span><span class="ident" id="5105393">set</span><span class="op" id="5105396">[</span><span class="ident" id="5105397">name</span><span class="op" id="5105401">]</span>&nbsp;<span class="op" id="5105403">=</span>&nbsp;<span class="op" id="5105405">&amp;</span><span class="ident" id="5105406">Template</span><span class="op" id="5105414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105419">nil</span><span class="op" id="5105422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105427">x</span><span class="op" id="5105428">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105433">x</span><span class="op" id="5105434">.</span><span class="ident" id="5105435">Tree</span><span class="op" id="5105439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105444">ret</span><span class="op" id="5105447">.</span><span class="ident" id="5105448">nameSpace</span><span class="op" id="5105457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105467">return</span>&nbsp;<span class="ident" id="5105474">ret</span><span class="op" id="5105477">,</span>&nbsp;<span class="ident" id="5105479">nil</span><br>
<span class="lineno">220</span><span class="op" id="5105483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5105486">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5105544">func</span>&nbsp;<span class="ident" id="5105549">New</span><span class="op" id="5105552">(</span><span class="ident" id="5105553">name</span>&nbsp;<span class="builtintype" id="5105558">string</span><span class="op" id="5105564">)</span>&nbsp;<span class="op" id="5105566">*</span><span class="ident" id="5105567">Template</span>&nbsp;<span class="op" id="5105576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105579">tmpl</span>&nbsp;<span class="op" id="5105584">:=</span>&nbsp;<span class="op" id="5105587">&amp;</span><span class="ident" id="5105588">Template</span><span class="op" id="5105596">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105600">nil</span><span class="op" id="5105603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105607">template</span><span class="op" id="5105615">.</span><span class="ident" id="5105616">New</span><span class="op" id="5105619">(</span><span class="ident" id="5105620">name</span><span class="op" id="5105624">)</span><span class="op" id="5105625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105629">nil</span><span class="op" id="5105632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105636">&amp;</span><span class="ident" id="5105637">nameSpace</span><span class="op" id="5105646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105651">set</span><span class="op" id="5105654">:</span>&nbsp;<span class="builtinfunc" id="5105656">make</span><span class="op" id="5105660">(</span><span class="keyword" id="5105661">map</span><span class="op" id="5105664">[</span><span class="builtintype" id="5105665">string</span><span class="op" id="5105671">]</span><span class="op" id="5105672">*</span><span class="ident" id="5105673">Template</span><span class="op" id="5105681">)</span><span class="op" id="5105682">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105686">}</span><span class="op" id="5105687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5105690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105693">tmpl</span><span class="op" id="5105697">.</span><span class="ident" id="5105698">set</span><span class="op" id="5105701">[</span><span class="ident" id="5105702">name</span><span class="op" id="5105706">]</span>&nbsp;<span class="op" id="5105708">=</span>&nbsp;<span class="ident" id="5105710">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5105716">return</span>&nbsp;<span class="ident" id="5105723">tmpl</span><br>
<span class="lineno"></span><span class="op" id="5105728">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5105731">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5105798">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="5105869">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5105938">func</span>&nbsp;<span class="op" id="5105943">(</span><span class="ident" id="5105944">t</span>&nbsp;<span class="op" id="5105946">*</span><span class="ident" id="5105947">Template</span><span class="op" id="5105955">)</span>&nbsp;<span class="ident" id="5105957">New</span><span class="op" id="5105960">(</span><span class="ident" id="5105961">name</span>&nbsp;<span class="builtintype" id="5105966">string</span><span class="op" id="5105972">)</span>&nbsp;<span class="op" id="5105974">*</span><span class="ident" id="5105975">Template</span>&nbsp;<span class="op" id="5105984">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5105987">t</span><span class="op" id="5105988">.</span><span class="ident" id="5105989">nameSpace</span><span class="op" id="5105998">.</span><span class="ident" id="5105999">mu</span><span class="op" id="5106001">.</span><span class="ident" id="5106002">Lock</span><span class="op" id="5106006">(</span><span class="op" id="5106007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106010">defer</span>&nbsp;<span class="ident" id="5106016">t</span><span class="op" id="5106017">.</span><span class="ident" id="5106018">nameSpace</span><span class="op" id="5106027">.</span><span class="ident" id="5106028">mu</span><span class="op" id="5106030">.</span><span class="ident" id="5106031">Unlock</span><span class="op" id="5106037">(</span><span class="op" id="5106038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106041">return</span>&nbsp;<span class="ident" id="5106048">t</span><span class="op" id="5106049">.</span><span class="builtinfunc" id="5106050">new</span><span class="op" id="5106053">(</span><span class="ident" id="5106054">name</span><span class="op" id="5106058">)</span><br>
<span class="lineno"></span><span class="op" id="5106060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="5106063">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="5106118">func</span>&nbsp;<span class="op" id="5106123">(</span><span class="ident" id="5106124">t</span>&nbsp;<span class="op" id="5106126">*</span><span class="ident" id="5106127">Template</span><span class="op" id="5106135">)</span>&nbsp;<span class="builtinfunc" id="5106137">new</span><span class="op" id="5106140">(</span><span class="ident" id="5106141">name</span>&nbsp;<span class="builtintype" id="5106146">string</span><span class="op" id="5106152">)</span>&nbsp;<span class="op" id="5106154">*</span><span class="ident" id="5106155">Template</span>&nbsp;<span class="op" id="5106164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106167">tmpl</span>&nbsp;<span class="op" id="5106172">:=</span>&nbsp;<span class="op" id="5106175">&amp;</span><span class="ident" id="5106176">Template</span><span class="op" id="5106184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106188">nil</span><span class="op" id="5106191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106195">t</span><span class="op" id="5106196">.</span><span class="ident" id="5106197">text</span><span class="op" id="5106201">.</span><span class="ident" id="5106202">New</span><span class="op" id="5106205">(</span><span class="ident" id="5106206">name</span><span class="op" id="5106210">)</span><span class="op" id="5106211">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106215">nil</span><span class="op" id="5106218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106222">t</span><span class="op" id="5106223">.</span><span class="ident" id="5106224">nameSpace</span><span class="op" id="5106233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5106236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5106239">tmpl</span><span class="op" id="5106243">.</span><span class="ident" id="5106244">set</span><span class="op" id="5106247">[</span><span class="ident" id="5106248">name</span><span class="op" id="5106252">]</span>&nbsp;<span class="op" id="5106254">=</span>&nbsp;<span class="ident" id="5106256">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106262">return</span>&nbsp;<span class="ident" id="5106269">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="5106274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5106277">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5106319">func</span>&nbsp;<span class="op" id="5106324">(</span><span class="ident" id="5106325">t</span>&nbsp;<span class="op" id="5106327">*</span><span class="ident" id="5106328">Template</span><span class="op" id="5106336">)</span>&nbsp;<span class="ident" id="5106338">Name</span><span class="op" id="5106342">(</span><span class="op" id="5106343">)</span>&nbsp;<span class="builtintype" id="5106345">string</span>&nbsp;<span class="op" id="5106352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5106355">return</span>&nbsp;<span class="ident" id="5106362">t</span><span class="op" id="5106363">.</span><span class="ident" id="5106364">text</span><span class="op" id="5106368">.</span><span class="ident" id="5106369">Name</span><span class="op" id="5106373">(</span><span class="op" id="5106374">)</span><br>
<span class="lineno">260</span><span class="op" id="5106376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5106379">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5106448">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="5106523">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="5106597">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="5106673">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5106750">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="5106823">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5106843">type</span>&nbsp;<span class="ident" id="5106848">FuncMap</span>&nbsp;<span class="keyword" id="5106856">map</span><span class="op" id="5106859">[</span><span class="builtintype" id="5106860">string</span><span class="op" id="5106866">]</span><span class="keyword" id="5106867">interface</span><span class="op" id="5106876">{</span><span class="op" id="5106877">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="5106880">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5106959">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5107036">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5107111">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="5107162">func</span>&nbsp;<span class="op" id="5107167">(</span><span class="ident" id="5107168">t</span>&nbsp;<span class="op" id="5107170">*</span><span class="ident" id="5107171">Template</span><span class="op" id="5107179">)</span>&nbsp;<span class="ident" id="5107181">Funcs</span><span class="op" id="5107186">(</span><span class="ident" id="5107187">funcMap</span>&nbsp;<span class="ident" id="5107195">FuncMap</span><span class="op" id="5107202">)</span>&nbsp;<span class="op" id="5107204">*</span><span class="ident" id="5107205">Template</span>&nbsp;<span class="op" id="5107214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107217">t</span><span class="op" id="5107218">.</span><span class="ident" id="5107219">text</span><span class="op" id="5107223">.</span><span class="ident" id="5107224">Funcs</span><span class="op" id="5107229">(</span><span class="ident" id="5107230">template</span><span class="op" id="5107238">.</span><span class="ident" id="5107239">FuncMap</span><span class="op" id="5107246">(</span><span class="ident" id="5107247">funcMap</span><span class="op" id="5107254">)</span><span class="op" id="5107255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107258">return</span>&nbsp;<span class="ident" id="5107265">t</span><br>
<span class="lineno"></span><span class="op" id="5107267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="5107270">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5107347">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5107419">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5107495">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="5107531">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="5107593">func</span>&nbsp;<span class="op" id="5107598">(</span><span class="ident" id="5107599">t</span>&nbsp;<span class="op" id="5107601">*</span><span class="ident" id="5107602">Template</span><span class="op" id="5107610">)</span>&nbsp;<span class="ident" id="5107612">Delims</span><span class="op" id="5107618">(</span><span class="ident" id="5107619">left</span><span class="op" id="5107623">,</span>&nbsp;<span class="ident" id="5107625">right</span>&nbsp;<span class="builtintype" id="5107631">string</span><span class="op" id="5107637">)</span>&nbsp;<span class="op" id="5107639">*</span><span class="ident" id="5107640">Template</span>&nbsp;<span class="op" id="5107649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107652">t</span><span class="op" id="5107653">.</span><span class="ident" id="5107654">text</span><span class="op" id="5107658">.</span><span class="ident" id="5107659">Delims</span><span class="op" id="5107665">(</span><span class="ident" id="5107666">left</span><span class="op" id="5107670">,</span>&nbsp;<span class="ident" id="5107672">right</span><span class="op" id="5107677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107680">return</span>&nbsp;<span class="ident" id="5107687">t</span><br>
<span class="lineno"></span><span class="op" id="5107689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="5107692">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="5107770">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5107810">func</span>&nbsp;<span class="op" id="5107815">(</span><span class="ident" id="5107816">t</span>&nbsp;<span class="op" id="5107818">*</span><span class="ident" id="5107819">Template</span><span class="op" id="5107827">)</span>&nbsp;<span class="ident" id="5107829">Lookup</span><span class="op" id="5107835">(</span><span class="ident" id="5107836">name</span>&nbsp;<span class="builtintype" id="5107841">string</span><span class="op" id="5107847">)</span>&nbsp;<span class="op" id="5107849">*</span><span class="ident" id="5107850">Template</span>&nbsp;<span class="op" id="5107859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5107862">t</span><span class="op" id="5107863">.</span><span class="ident" id="5107864">nameSpace</span><span class="op" id="5107873">.</span><span class="ident" id="5107874">mu</span><span class="op" id="5107876">.</span><span class="ident" id="5107877">Lock</span><span class="op" id="5107881">(</span><span class="op" id="5107882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107885">defer</span>&nbsp;<span class="ident" id="5107891">t</span><span class="op" id="5107892">.</span><span class="ident" id="5107893">nameSpace</span><span class="op" id="5107902">.</span><span class="ident" id="5107903">mu</span><span class="op" id="5107905">.</span><span class="ident" id="5107906">Unlock</span><span class="op" id="5107912">(</span><span class="op" id="5107913">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5107916">return</span>&nbsp;<span class="ident" id="5107923">t</span><span class="op" id="5107924">.</span><span class="ident" id="5107925">set</span><span class="op" id="5107928">[</span><span class="ident" id="5107929">name</span><span class="op" id="5107933">]</span><br>
<span class="lineno"></span><span class="op" id="5107935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5107938">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="5108019">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="5108109">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5108120">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="5108181">func</span>&nbsp;<span class="ident" id="5108186">Must</span><span class="op" id="5108190">(</span><span class="ident" id="5108191">t</span>&nbsp;<span class="op" id="5108193">*</span><span class="ident" id="5108194">Template</span><span class="op" id="5108202">,</span>&nbsp;<span class="ident" id="5108204">err</span>&nbsp;<span class="builtintype" id="5108208">error</span><span class="op" id="5108213">)</span>&nbsp;<span class="op" id="5108215">*</span><span class="ident" id="5108216">Template</span>&nbsp;<span class="op" id="5108225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108228">if</span>&nbsp;<span class="ident" id="5108231">err</span>&nbsp;<span class="op" id="5108235">!=</span>&nbsp;<span class="ident" id="5108238">nil</span>&nbsp;<span class="op" id="5108242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5108246">panic</span><span class="op" id="5108251">(</span><span class="ident" id="5108252">err</span><span class="op" id="5108255">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5108258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108261">return</span>&nbsp;<span class="ident" id="5108268">t</span><br>
<span class="lineno"></span><span class="op" id="5108270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5108273">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="5108351">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5108430">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5108503">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5108575">func</span>&nbsp;<span class="ident" id="5108580">ParseFiles</span><span class="op" id="5108590">(</span><span class="ident" id="5108591">filenames</span>&nbsp;<span class="op" id="5108601">...</span><span class="builtintype" id="5108604">string</span><span class="op" id="5108610">)</span>&nbsp;<span class="op" id="5108612">(</span><span class="op" id="5108613">*</span><span class="ident" id="5108614">Template</span><span class="op" id="5108622">,</span>&nbsp;<span class="builtintype" id="5108624">error</span><span class="op" id="5108629">)</span>&nbsp;<span class="op" id="5108631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108634">return</span>&nbsp;<span class="ident" id="5108641">parseFiles</span><span class="op" id="5108651">(</span><span class="ident" id="5108652">nil</span><span class="op" id="5108655">,</span>&nbsp;<span class="ident" id="5108657">filenames</span><span class="op" id="5108666">...</span><span class="op" id="5108669">)</span><br>
<span class="lineno">315</span><span class="op" id="5108671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5108674">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5108755">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5108829">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="5108884">func</span>&nbsp;<span class="op" id="5108889">(</span><span class="ident" id="5108890">t</span>&nbsp;<span class="op" id="5108892">*</span><span class="ident" id="5108893">Template</span><span class="op" id="5108901">)</span>&nbsp;<span class="ident" id="5108903">ParseFiles</span><span class="op" id="5108913">(</span><span class="ident" id="5108914">filenames</span>&nbsp;<span class="op" id="5108924">...</span><span class="builtintype" id="5108927">string</span><span class="op" id="5108933">)</span>&nbsp;<span class="op" id="5108935">(</span><span class="op" id="5108936">*</span><span class="ident" id="5108937">Template</span><span class="op" id="5108945">,</span>&nbsp;<span class="builtintype" id="5108947">error</span><span class="op" id="5108952">)</span>&nbsp;<span class="op" id="5108954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5108957">return</span>&nbsp;<span class="ident" id="5108964">parseFiles</span><span class="op" id="5108974">(</span><span class="ident" id="5108975">t</span><span class="op" id="5108976">,</span>&nbsp;<span class="ident" id="5108978">filenames</span><span class="op" id="5108987">...</span><span class="op" id="5108990">)</span><br>
<span class="lineno"></span><span class="op" id="5108992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5108995">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="5109068">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5109123">func</span>&nbsp;<span class="ident" id="5109128">parseFiles</span><span class="op" id="5109138">(</span><span class="ident" id="5109139">t</span>&nbsp;<span class="op" id="5109141">*</span><span class="ident" id="5109142">Template</span><span class="op" id="5109150">,</span>&nbsp;<span class="ident" id="5109152">filenames</span>&nbsp;<span class="op" id="5109162">...</span><span class="builtintype" id="5109165">string</span><span class="op" id="5109171">)</span>&nbsp;<span class="op" id="5109173">(</span><span class="op" id="5109174">*</span><span class="ident" id="5109175">Template</span><span class="op" id="5109183">,</span>&nbsp;<span class="builtintype" id="5109185">error</span><span class="op" id="5109190">)</span>&nbsp;<span class="op" id="5109192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109195">if</span>&nbsp;<span class="builtinfunc" id="5109198">len</span><span class="op" id="5109201">(</span><span class="ident" id="5109202">filenames</span><span class="op" id="5109211">)</span>&nbsp;<span class="op" id="5109213">==</span>&nbsp;<span class="num" id="5109216">0</span>&nbsp;<span class="op" id="5109218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109222">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109268">return</span>&nbsp;<span class="ident" id="5109275">nil</span><span class="op" id="5109278">,</span>&nbsp;<span class="ident" id="5109280">fmt</span><span class="op" id="5109283">.</span><span class="ident" id="5109284">Errorf</span><span class="op" id="5109290">(</span><span class="string" id="5109291">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="5109344">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5109347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109350">for</span>&nbsp;<span class="ident" id="5109354">_</span><span class="op" id="5109355">,</span>&nbsp;<span class="ident" id="5109357">filename</span>&nbsp;<span class="op" id="5109366">:=</span>&nbsp;<span class="keyword" id="5109369">range</span>&nbsp;<span class="ident" id="5109375">filenames</span>&nbsp;<span class="op" id="5109385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109389">b</span><span class="op" id="5109390">,</span>&nbsp;<span class="ident" id="5109392">err</span>&nbsp;<span class="op" id="5109396">:=</span>&nbsp;<span class="ident" id="5109399">ioutil</span><span class="op" id="5109405">.</span><span class="ident" id="5109406">ReadFile</span><span class="op" id="5109414">(</span><span class="ident" id="5109415">filename</span><span class="op" id="5109423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109427">if</span>&nbsp;<span class="ident" id="5109430">err</span>&nbsp;<span class="op" id="5109434">!=</span>&nbsp;<span class="ident" id="5109437">nil</span>&nbsp;<span class="op" id="5109441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109446">return</span>&nbsp;<span class="ident" id="5109453">nil</span><span class="op" id="5109456">,</span>&nbsp;<span class="ident" id="5109458">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5109464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109468">s</span>&nbsp;<span class="op" id="5109470">:=</span>&nbsp;<span class="builtintype" id="5109473">string</span><span class="op" id="5109479">(</span><span class="ident" id="5109480">b</span><span class="op" id="5109481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109485">name</span>&nbsp;<span class="op" id="5109490">:=</span>&nbsp;<span class="ident" id="5109493">filepath</span><span class="op" id="5109501">.</span><span class="ident" id="5109502">Base</span><span class="op" id="5109506">(</span><span class="ident" id="5109507">filename</span><span class="op" id="5109515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109519">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109584">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109647">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109717">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109768">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5109822">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109888">var</span>&nbsp;<span class="ident" id="5109892">tmpl</span>&nbsp;<span class="op" id="5109897">*</span><span class="ident" id="5109898">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109909">if</span>&nbsp;<span class="ident" id="5109912">t</span>&nbsp;<span class="op" id="5109914">==</span>&nbsp;<span class="ident" id="5109917">nil</span>&nbsp;<span class="op" id="5109921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109926">t</span>&nbsp;<span class="op" id="5109928">=</span>&nbsp;<span class="ident" id="5109930">New</span><span class="op" id="5109933">(</span><span class="ident" id="5109934">name</span><span class="op" id="5109938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5109942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5109946">if</span>&nbsp;<span class="ident" id="5109949">name</span>&nbsp;<span class="op" id="5109954">==</span>&nbsp;<span class="ident" id="5109957">t</span><span class="op" id="5109958">.</span><span class="ident" id="5109959">Name</span><span class="op" id="5109963">(</span><span class="op" id="5109964">)</span>&nbsp;<span class="op" id="5109966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109971">tmpl</span>&nbsp;<span class="op" id="5109976">=</span>&nbsp;<span class="ident" id="5109978">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5109982">}</span>&nbsp;<span class="keyword" id="5109984">else</span>&nbsp;<span class="op" id="5109989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5109994">tmpl</span>&nbsp;<span class="op" id="5109999">=</span>&nbsp;<span class="ident" id="5110001">t</span><span class="op" id="5110002">.</span><span class="ident" id="5110003">New</span><span class="op" id="5110006">(</span><span class="ident" id="5110007">name</span><span class="op" id="5110011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5110019">_</span><span class="op" id="5110020">,</span>&nbsp;<span class="ident" id="5110022">err</span>&nbsp;<span class="op" id="5110026">=</span>&nbsp;<span class="ident" id="5110028">tmpl</span><span class="op" id="5110032">.</span><span class="ident" id="5110033">Parse</span><span class="op" id="5110038">(</span><span class="ident" id="5110039">s</span><span class="op" id="5110040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110044">if</span>&nbsp;<span class="ident" id="5110047">err</span>&nbsp;<span class="op" id="5110051">!=</span>&nbsp;<span class="ident" id="5110054">nil</span>&nbsp;<span class="op" id="5110058">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110063">return</span>&nbsp;<span class="ident" id="5110070">nil</span><span class="op" id="5110073">,</span>&nbsp;<span class="ident" id="5110075">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5110084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110087">return</span>&nbsp;<span class="ident" id="5110094">t</span><span class="op" id="5110095">,</span>&nbsp;<span class="ident" id="5110097">nil</span><br>
<span class="lineno"></span><span class="op" id="5110101">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="5110104">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5110185">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="5110261">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5110337">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="5110410">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="5110471">func</span>&nbsp;<span class="ident" id="5110476">ParseGlob</span><span class="op" id="5110485">(</span><span class="ident" id="5110486">pattern</span>&nbsp;<span class="builtintype" id="5110494">string</span><span class="op" id="5110500">)</span>&nbsp;<span class="op" id="5110502">(</span><span class="op" id="5110503">*</span><span class="ident" id="5110504">Template</span><span class="op" id="5110512">,</span>&nbsp;<span class="builtintype" id="5110514">error</span><span class="op" id="5110519">)</span>&nbsp;<span class="op" id="5110521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110524">return</span>&nbsp;<span class="ident" id="5110531">parseGlob</span><span class="op" id="5110540">(</span><span class="ident" id="5110541">nil</span><span class="op" id="5110544">,</span>&nbsp;<span class="ident" id="5110546">pattern</span><span class="op" id="5110553">)</span><br>
<span class="lineno"></span><span class="op" id="5110555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="5110558">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5110634">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5110707">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5110784">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5110860">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="5110872">func</span>&nbsp;<span class="op" id="5110877">(</span><span class="ident" id="5110878">t</span>&nbsp;<span class="op" id="5110880">*</span><span class="ident" id="5110881">Template</span><span class="op" id="5110889">)</span>&nbsp;<span class="ident" id="5110891">ParseGlob</span><span class="op" id="5110900">(</span><span class="ident" id="5110901">pattern</span>&nbsp;<span class="builtintype" id="5110909">string</span><span class="op" id="5110915">)</span>&nbsp;<span class="op" id="5110917">(</span><span class="op" id="5110918">*</span><span class="ident" id="5110919">Template</span><span class="op" id="5110927">,</span>&nbsp;<span class="builtintype" id="5110929">error</span><span class="op" id="5110934">)</span>&nbsp;<span class="op" id="5110936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5110939">return</span>&nbsp;<span class="ident" id="5110946">parseGlob</span><span class="op" id="5110955">(</span><span class="ident" id="5110956">t</span><span class="op" id="5110957">,</span>&nbsp;<span class="ident" id="5110959">pattern</span><span class="op" id="5110966">)</span><br>
<span class="lineno"></span><span class="op" id="5110968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5110971">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="5111044">func</span>&nbsp;<span class="ident" id="5111049">parseGlob</span><span class="op" id="5111058">(</span><span class="ident" id="5111059">t</span>&nbsp;<span class="op" id="5111061">*</span><span class="ident" id="5111062">Template</span><span class="op" id="5111070">,</span>&nbsp;<span class="ident" id="5111072">pattern</span>&nbsp;<span class="builtintype" id="5111080">string</span><span class="op" id="5111086">)</span>&nbsp;<span class="op" id="5111088">(</span><span class="op" id="5111089">*</span><span class="ident" id="5111090">Template</span><span class="op" id="5111098">,</span>&nbsp;<span class="builtintype" id="5111100">error</span><span class="op" id="5111105">)</span>&nbsp;<span class="op" id="5111107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5111110">filenames</span><span class="op" id="5111119">,</span>&nbsp;<span class="ident" id="5111121">err</span>&nbsp;<span class="op" id="5111125">:=</span>&nbsp;<span class="ident" id="5111128">filepath</span><span class="op" id="5111136">.</span><span class="ident" id="5111137">Glob</span><span class="op" id="5111141">(</span><span class="ident" id="5111142">pattern</span><span class="op" id="5111149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111152">if</span>&nbsp;<span class="ident" id="5111155">err</span>&nbsp;<span class="op" id="5111159">!=</span>&nbsp;<span class="ident" id="5111162">nil</span>&nbsp;<span class="op" id="5111166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111170">return</span>&nbsp;<span class="ident" id="5111177">nil</span><span class="op" id="5111180">,</span>&nbsp;<span class="ident" id="5111182">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5111187">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111190">if</span>&nbsp;<span class="builtinfunc" id="5111193">len</span><span class="op" id="5111196">(</span><span class="ident" id="5111197">filenames</span><span class="op" id="5111206">)</span>&nbsp;<span class="op" id="5111208">==</span>&nbsp;<span class="num" id="5111211">0</span>&nbsp;<span class="op" id="5111213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111217">return</span>&nbsp;<span class="ident" id="5111224">nil</span><span class="op" id="5111227">,</span>&nbsp;<span class="ident" id="5111229">fmt</span><span class="op" id="5111232">.</span><span class="ident" id="5111233">Errorf</span><span class="op" id="5111239">(</span><span class="string" id="5111240">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="5111286">,</span>&nbsp;<span class="ident" id="5111288">pattern</span><span class="op" id="5111295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5111298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5111301">return</span>&nbsp;<span class="ident" id="5111308">parseFiles</span><span class="op" id="5111318">(</span><span class="ident" id="5111319">t</span><span class="op" id="5111320">,</span>&nbsp;<span class="ident" id="5111322">filenames</span><span class="op" id="5111331">...</span><span class="op" id="5111334">)</span><br>
<span class="lineno"></span><span class="op" id="5111336">}</span>
</div>
</body>
</html>
