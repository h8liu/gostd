<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6974586">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6974641">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6974695">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6974746">package</span>&nbsp;<span class="ident" id="6974754">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6974759">import</span>&nbsp;<span class="op" id="6974766">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6974769">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6974777">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6974784">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6974795">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6974802">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6974805">var</span>&nbsp;<span class="ident" id="6974809">testDNSFlood</span>&nbsp;<span class="op" id="6974822">=</span>&nbsp;<span class="ident" id="6974824"><a href="/net/z_last_test.go.html#6974769">flag</a></span><span class="op" id="6974828">.</span><span class="ident" id="6974829">Bool</span><span class="op" id="6974833">(</span><span class="string" id="6974834">&#34;dnsflood&#34;</span><span class="op" id="6974844">,</span>&nbsp;<span class="ident" id="6974846">false</span><span class="op" id="6974851">,</span>&nbsp;<span class="string" id="6974853">&#34;whether&nbsp;to&nbsp;test&nbsp;dns&nbsp;query&nbsp;flooding&#34;</span><span class="op" id="6974889">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6974892">func</span>&nbsp;<span class="ident" id="6974897">TestDNSThreadLimit</span><span class="op" id="6974915">(</span><span class="ident" id="6974916">t</span>&nbsp;<span class="op" id="6974918">*</span><span class="ident" id="6974919"><a href="/net/z_last_test.go.html#6974784">testing</a></span><span class="op" id="6974926">.</span><span class="ident" id="6974927">T</span><span class="op" id="6974928">)</span>&nbsp;<span class="op" id="6974930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6974933">if</span>&nbsp;<span class="op" id="6974936">!</span><span class="op" id="6974937">*</span><span class="ident" id="6974938"><a href="/net/z_last_test.go.html#6974809">testDNSFlood</a></span>&nbsp;<span class="op" id="6974951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6974955"><a href="/net/z_last_test.go.html#6974916">t</a></span><span class="op" id="6974956">.</span><span class="ident" id="6974957">Skip</span><span class="op" id="6974961">(</span><span class="string" id="6974962">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6975002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975005">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975009">const</span>&nbsp;<span class="ident" id="6975015">N</span>&nbsp;<span class="op" id="6975017">=</span>&nbsp;<span class="num" id="6975019">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975026">c</span>&nbsp;<span class="op" id="6975028">:=</span>&nbsp;<span class="builtinfunc" id="6975031">make</span><span class="op" id="6975035">(</span><span class="keyword" id="6975036">chan</span>&nbsp;<span class="builtintype" id="6975041">int</span><span class="op" id="6975044">,</span>&nbsp;<span class="ident" id="6975046"><a href="/net/z_last_test.go.html#6975015">N</a></span><span class="op" id="6975047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975050">for</span>&nbsp;<span class="ident" id="6975054">i</span>&nbsp;<span class="op" id="6975056">:=</span>&nbsp;<span class="num" id="6975059">0</span><span class="op" id="6975060">;</span>&nbsp;<span class="ident" id="6975062"><a href="/net/z_last_test.go.html#6975054">i</a></span>&nbsp;<span class="op" id="6975064">&lt;</span>&nbsp;<span class="ident" id="6975066"><a href="/net/z_last_test.go.html#6975015">N</a></span><span class="op" id="6975067">;</span>&nbsp;<span class="ident" id="6975069"><a href="/net/z_last_test.go.html#6975054">i</a></span><span class="op" id="6975070">++</span>&nbsp;<span class="op" id="6975073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975077">go</span>&nbsp;<span class="keyword" id="6975080">func</span><span class="op" id="6975084">(</span><span class="ident" id="6975085">i</span>&nbsp;<span class="builtintype" id="6975087">int</span><span class="op" id="6975090">)</span>&nbsp;<span class="op" id="6975092">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975097"><a href="/net/lookup.go.html#2642100">LookupIP</a></span><span class="op" id="6975105">(</span><span class="ident" id="6975106"><a href="/net/z_last_test.go.html#6974777">fmt</a></span><span class="op" id="6975109">.</span><span class="ident" id="6975110">Sprintf</span><span class="op" id="6975117">(</span><span class="string" id="6975118">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="6975142">,</span>&nbsp;<span class="ident" id="6975144"><a href="/net/z_last_test.go.html#6975085">i</a></span><span class="op" id="6975145">)</span><span class="op" id="6975146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975151"><a href="/net/z_last_test.go.html#6975026">c</a></span>&nbsp;<span class="op" id="6975153">&lt;-</span>&nbsp;<span class="num" id="6975156">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975160">}</span><span class="op" id="6975161">(</span><span class="ident" id="6975162"><a href="/net/z_last_test.go.html#6975054">i</a></span><span class="op" id="6975163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6975169">//&nbsp;Don&#39;t&nbsp;bother&nbsp;waiting&nbsp;for&nbsp;the&nbsp;stragglers;&nbsp;stop&nbsp;at&nbsp;0.9&nbsp;N.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975229">for</span>&nbsp;<span class="ident" id="6975233">i</span>&nbsp;<span class="op" id="6975235">:=</span>&nbsp;<span class="num" id="6975238">0</span><span class="op" id="6975239">;</span>&nbsp;<span class="ident" id="6975241"><a href="/net/z_last_test.go.html#6975233">i</a></span>&nbsp;<span class="op" id="6975243">&lt;</span>&nbsp;<span class="ident" id="6975245"><a href="/net/z_last_test.go.html#6975015">N</a></span><span class="op" id="6975246">*</span><span class="num" id="6975247">9</span><span class="op" id="6975248">/</span><span class="num" id="6975249">10</span><span class="op" id="6975251">;</span>&nbsp;<span class="ident" id="6975253"><a href="/net/z_last_test.go.html#6975233">i</a></span><span class="op" id="6975254">++</span>&nbsp;<span class="op" id="6975257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975261">if</span>&nbsp;<span class="ident" id="6975264"><a href="/net/z_last_test.go.html#6975233">i</a></span><span class="op" id="6975265">%</span><span class="num" id="6975266">100</span>&nbsp;<span class="op" id="6975270">==</span>&nbsp;<span class="num" id="6975273">0</span>&nbsp;<span class="op" id="6975275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6975280">//println(&#34;TestDNSThreadLimit:&#34;,&nbsp;i)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975322">&lt;-</span><span class="ident" id="6975324"><a href="/net/z_last_test.go.html#6975026">c</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6975331">//&nbsp;If&nbsp;we&#39;re&nbsp;still&nbsp;here,&nbsp;it&nbsp;worked.</span><br>
<span class="lineno"></span><span class="op" id="6975366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="6975369">func</span>&nbsp;<span class="ident" id="6975374">TestLookupIPDeadline</span><span class="op" id="6975394">(</span><span class="ident" id="6975395">t</span>&nbsp;<span class="op" id="6975397">*</span><span class="ident" id="6975398"><a href="/net/z_last_test.go.html#6974784">testing</a></span><span class="op" id="6975405">.</span><span class="ident" id="6975406">T</span><span class="op" id="6975407">)</span>&nbsp;<span class="op" id="6975409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975412">if</span>&nbsp;<span class="op" id="6975415">!</span><span class="op" id="6975416">*</span><span class="ident" id="6975417"><a href="/net/z_last_test.go.html#6974809">testDNSFlood</a></span>&nbsp;<span class="op" id="6975430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975434"><a href="/net/z_last_test.go.html#6975395">t</a></span><span class="op" id="6975435">.</span><span class="ident" id="6975436">Skip</span><span class="op" id="6975440">(</span><span class="string" id="6975441">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6975481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975488">const</span>&nbsp;<span class="ident" id="6975494">N</span>&nbsp;<span class="op" id="6975496">=</span>&nbsp;<span class="num" id="6975498">5000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975504">const</span>&nbsp;<span class="ident" id="6975510">timeout</span>&nbsp;<span class="op" id="6975518">=</span>&nbsp;<span class="num" id="6975520">3</span>&nbsp;<span class="op" id="6975522">*</span>&nbsp;<span class="ident" id="6975524"><a href="/net/z_last_test.go.html#6974795">time</a></span><span class="op" id="6975528">.</span><span class="ident" id="6975529">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975537">c</span>&nbsp;<span class="op" id="6975539">:=</span>&nbsp;<span class="builtinfunc" id="6975542">make</span><span class="op" id="6975546">(</span><span class="keyword" id="6975547">chan</span>&nbsp;<span class="builtintype" id="6975552">error</span><span class="op" id="6975557">,</span>&nbsp;<span class="num" id="6975559">2</span><span class="op" id="6975560">*</span><span class="ident" id="6975561"><a href="/net/z_last_test.go.html#6975494">N</a></span><span class="op" id="6975562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975565">for</span>&nbsp;<span class="ident" id="6975569">i</span>&nbsp;<span class="op" id="6975571">:=</span>&nbsp;<span class="num" id="6975574">0</span><span class="op" id="6975575">;</span>&nbsp;<span class="ident" id="6975577"><a href="/net/z_last_test.go.html#6975569">i</a></span>&nbsp;<span class="op" id="6975579">&lt;</span>&nbsp;<span class="ident" id="6975581"><a href="/net/z_last_test.go.html#6975494">N</a></span><span class="op" id="6975582">;</span>&nbsp;<span class="ident" id="6975584"><a href="/net/z_last_test.go.html#6975569">i</a></span><span class="op" id="6975585">++</span>&nbsp;<span class="op" id="6975588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975592">name</span>&nbsp;<span class="op" id="6975597">:=</span>&nbsp;<span class="ident" id="6975600"><a href="/net/z_last_test.go.html#6974777">fmt</a></span><span class="op" id="6975603">.</span><span class="ident" id="6975604">Sprintf</span><span class="op" id="6975611">(</span><span class="string" id="6975612">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="6975636">,</span>&nbsp;<span class="ident" id="6975638"><a href="/net/z_last_test.go.html#6975569">i</a></span><span class="op" id="6975639">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975643">go</span>&nbsp;<span class="keyword" id="6975646">func</span><span class="op" id="6975650">(</span><span class="op" id="6975651">)</span>&nbsp;<span class="op" id="6975653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975658">_</span><span class="op" id="6975659">,</span>&nbsp;<span class="ident" id="6975661">err</span>&nbsp;<span class="op" id="6975665">:=</span>&nbsp;<span class="ident" id="6975668"><a href="/net/lookup.go.html#2643004">lookupIPDeadline</a></span><span class="op" id="6975684">(</span><span class="ident" id="6975685"><a href="/net/z_last_test.go.html#6975592">name</a></span><span class="op" id="6975689">,</span>&nbsp;<span class="ident" id="6975691"><a href="/net/z_last_test.go.html#6974795">time</a></span><span class="op" id="6975695">.</span><span class="ident" id="6975696">Now</span><span class="op" id="6975699">(</span><span class="op" id="6975700">)</span><span class="op" id="6975701">.</span><span class="ident" id="6975702">Add</span><span class="op" id="6975705">(</span><span class="ident" id="6975706"><a href="/net/z_last_test.go.html#6975510">timeout</a></span><span class="op" id="6975713">/</span><span class="num" id="6975714">2</span><span class="op" id="6975715">)</span><span class="op" id="6975716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975721"><a href="/net/z_last_test.go.html#6975537">c</a></span>&nbsp;<span class="op" id="6975723">&lt;-</span>&nbsp;<span class="ident" id="6975726"><a href="/net/z_last_test.go.html#6975661">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975732">}</span><span class="op" id="6975733">(</span><span class="op" id="6975734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6975738">go</span>&nbsp;<span class="keyword" id="6975741">func</span><span class="op" id="6975745">(</span><span class="op" id="6975746">)</span>&nbsp;<span class="op" id="6975748">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975753">_</span><span class="op" id="6975754">,</span>&nbsp;<span class="ident" id="6975756">err</span>&nbsp;<span class="op" id="6975760">:=</span>&nbsp;<span class="ident" id="6975763"><a href="/net/lookup.go.html#2643004">lookupIPDeadline</a></span><span class="op" id="6975779">(</span><span class="ident" id="6975780"><a href="/net/z_last_test.go.html#6975592">name</a></span><span class="op" id="6975784">,</span>&nbsp;<span class="ident" id="6975786"><a href="/net/z_last_test.go.html#6974795">time</a></span><span class="op" id="6975790">.</span><span class="ident" id="6975791">Now</span><span class="op" id="6975794">(</span><span class="op" id="6975795">)</span><span class="op" id="6975796">.</span><span class="ident" id="6975797">Add</span><span class="op" id="6975800">(</span><span class="ident" id="6975801"><a href="/net/z_last_test.go.html#6975510">timeout</a></span><span class="op" id="6975808">)</span><span class="op" id="6975809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975814"><a href="/net/z_last_test.go.html#6975537">c</a></span>&nbsp;<span class="op" id="6975816">&lt;-</span>&nbsp;<span class="ident" id="6975819"><a href="/net/z_last_test.go.html#6975756">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975825">}</span><span class="op" id="6975826">(</span><span class="op" id="6975827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975833">qstats</span>&nbsp;<span class="op" id="6975840">:=</span>&nbsp;<span class="keyword" id="6975843">struct</span>&nbsp;<span class="op" id="6975850">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975854">succeeded</span><span class="op" id="6975863">,</span>&nbsp;<span class="ident" id="6975865">failed</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6975880">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975886">timeout</span><span class="op" id="6975893">,</span>&nbsp;<span class="ident" id="6975895">temporary</span><span class="op" id="6975904">,</span>&nbsp;<span class="ident" id="6975906">other</span>&nbsp;<span class="builtintype" id="6975912">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975918">unknown</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6975944">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6975949">}</span><span class="op" id="6975950">{</span><span class="op" id="6975951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6975954">deadline</span>&nbsp;<span class="op" id="6975963">:=</span>&nbsp;<span class="ident" id="6975966"><a href="/net/z_last_test.go.html#6974795">time</a></span><span class="op" id="6975970">.</span><span class="ident" id="6975971">After</span><span class="op" id="6975976">(</span><span class="ident" id="6975977"><a href="/net/z_last_test.go.html#6975510">timeout</a></span>&nbsp;<span class="op" id="6975985">+</span>&nbsp;<span class="ident" id="6975987"><a href="/net/z_last_test.go.html#6974795">time</a></span><span class="op" id="6975991">.</span><span class="ident" id="6975992">Second</span><span class="op" id="6975998">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976001">for</span>&nbsp;<span class="ident" id="6976005">i</span>&nbsp;<span class="op" id="6976007">:=</span>&nbsp;<span class="num" id="6976010">0</span><span class="op" id="6976011">;</span>&nbsp;<span class="ident" id="6976013"><a href="/net/z_last_test.go.html#6976005">i</a></span>&nbsp;<span class="op" id="6976015">&lt;</span>&nbsp;<span class="num" id="6976017">2</span><span class="op" id="6976018">*</span><span class="ident" id="6976019"><a href="/net/z_last_test.go.html#6975494">N</a></span><span class="op" id="6976020">;</span>&nbsp;<span class="ident" id="6976022"><a href="/net/z_last_test.go.html#6976005">i</a></span><span class="op" id="6976023">++</span>&nbsp;<span class="op" id="6976026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976030">select</span>&nbsp;<span class="op" id="6976037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976041">case</span>&nbsp;<span class="op" id="6976046">&lt;-</span><span class="ident" id="6976048"><a href="/net/z_last_test.go.html#6975954">deadline</a></span><span class="op" id="6976056">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976061"><a href="/net/z_last_test.go.html#6975395">t</a></span><span class="op" id="6976062">.</span><span class="ident" id="6976063">Fatal</span><span class="op" id="6976068">(</span><span class="string" id="6976069">&#34;deadline&nbsp;exceeded&#34;</span><span class="op" id="6976088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976092">case</span>&nbsp;<span class="ident" id="6976097">err</span>&nbsp;<span class="op" id="6976101">:=</span>&nbsp;<span class="op" id="6976104">&lt;-</span><span class="ident" id="6976106"><a href="/net/z_last_test.go.html#6975537">c</a></span><span class="op" id="6976107">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976112">switch</span>&nbsp;<span class="ident" id="6976119">err</span>&nbsp;<span class="op" id="6976123">:=</span>&nbsp;<span class="ident" id="6976126"><a href="/net/z_last_test.go.html#6976097">err</a></span><span class="op" id="6976129">.</span><span class="op" id="6976130">(</span><span class="keyword" id="6976131">type</span><span class="op" id="6976135">)</span>&nbsp;<span class="op" id="6976137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976142">case</span>&nbsp;<span class="ident" id="6976147">nil</span><span class="op" id="6976150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976156"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976162">.</span><span class="ident" id="6976163">succeeded</span><span class="op" id="6976172">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976178">case</span>&nbsp;<span class="ident" id="6976183"><a href="/net/net.go.html#2656629">Error</a></span><span class="op" id="6976188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976194"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976200">.</span><span class="ident" id="6976201">failed</span><span class="op" id="6976207">++</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976214">if</span>&nbsp;<span class="ident" id="6976217"><a href="/net/z_last_test.go.html#6976119">err</a></span><span class="op" id="6976220">.</span><span class="ident" id="6976221">Timeout</span><span class="op" id="6976228">(</span><span class="op" id="6976229">)</span>&nbsp;<span class="op" id="6976231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976238"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976244">.</span><span class="ident" id="6976245">timeout</span><span class="op" id="6976252">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6976259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976265">if</span>&nbsp;<span class="ident" id="6976268"><a href="/net/z_last_test.go.html#6976119">err</a></span><span class="op" id="6976271">.</span><span class="ident" id="6976272">Temporary</span><span class="op" id="6976281">(</span><span class="op" id="6976282">)</span>&nbsp;<span class="op" id="6976284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976291"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976297">.</span><span class="ident" id="6976298">temporary</span><span class="op" id="6976307">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6976314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976320">if</span>&nbsp;<span class="op" id="6976323">!</span><span class="ident" id="6976324"><a href="/net/z_last_test.go.html#6976119">err</a></span><span class="op" id="6976327">.</span><span class="ident" id="6976328">Timeout</span><span class="op" id="6976335">(</span><span class="op" id="6976336">)</span>&nbsp;<span class="op" id="6976338">&amp;&amp;</span>&nbsp;<span class="op" id="6976341">!</span><span class="ident" id="6976342"><a href="/net/z_last_test.go.html#6976119">err</a></span><span class="op" id="6976345">.</span><span class="ident" id="6976346">Temporary</span><span class="op" id="6976355">(</span><span class="op" id="6976356">)</span>&nbsp;<span class="op" id="6976358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976365"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976371">.</span><span class="ident" id="6976372">other</span><span class="op" id="6976377">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6976384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6976389">default</span><span class="op" id="6976396">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976402"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976408">.</span><span class="ident" id="6976409">failed</span><span class="op" id="6976415">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976422"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976428">.</span><span class="ident" id="6976429">unknown</span><span class="op" id="6976436">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6976442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6976446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6976449">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6976453">//&nbsp;A&nbsp;high&nbsp;volume&nbsp;of&nbsp;DNS&nbsp;queries&nbsp;for&nbsp;sub-domain&nbsp;of&nbsp;golang.org</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6976515">//&nbsp;would&nbsp;be&nbsp;coordinated&nbsp;by&nbsp;authoritative&nbsp;or&nbsp;recursive&nbsp;server,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6976578">//&nbsp;or&nbsp;stub&nbsp;resolver&nbsp;which&nbsp;implements&nbsp;query-response&nbsp;rate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6976636">//&nbsp;limitation,&nbsp;so&nbsp;we&nbsp;can&nbsp;expect&nbsp;some&nbsp;query&nbsp;successes&nbsp;and&nbsp;more</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6976699">//&nbsp;failures&nbsp;including&nbsp;timeout,&nbsp;temporary&nbsp;and&nbsp;other&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6976757">//&nbsp;As&nbsp;a&nbsp;rule,&nbsp;unknown&nbsp;must&nbsp;not&nbsp;be&nbsp;shown&nbsp;but&nbsp;it&nbsp;might&nbsp;possibly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6976820">//&nbsp;happen&nbsp;due&nbsp;to&nbsp;issue&nbsp;4856&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6976858"><a href="/net/z_last_test.go.html#6975395">t</a></span><span class="op" id="6976859">.</span><span class="ident" id="6976860">Logf</span><span class="op" id="6976864">(</span><span class="string" id="6976865">&#34;%v&nbsp;succeeded,&nbsp;%v&nbsp;failed&nbsp;(%v&nbsp;timeout,&nbsp;%v&nbsp;temporary,&nbsp;%v&nbsp;other,&nbsp;%v&nbsp;unknown)&#34;</span><span class="op" id="6976939">,</span>&nbsp;<span class="ident" id="6976941"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976947">.</span><span class="ident" id="6976948">succeeded</span><span class="op" id="6976957">,</span>&nbsp;<span class="ident" id="6976959"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976965">.</span><span class="ident" id="6976966">failed</span><span class="op" id="6976972">,</span>&nbsp;<span class="ident" id="6976974"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976980">.</span><span class="ident" id="6976981">timeout</span><span class="op" id="6976988">,</span>&nbsp;<span class="ident" id="6976990"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6976996">.</span><span class="ident" id="6976997">temporary</span><span class="op" id="6977006">,</span>&nbsp;<span class="ident" id="6977008"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6977014">.</span><span class="ident" id="6977015">other</span><span class="op" id="6977020">,</span>&nbsp;<span class="ident" id="6977022"><a href="/net/z_last_test.go.html#6975833">qstats</a></span><span class="op" id="6977028">.</span><span class="ident" id="6977029">unknown</span><span class="op" id="6977036">)</span><br>
<span class="lineno"></span><span class="op" id="6977038">}</span>
</div>
</body>
</html>
