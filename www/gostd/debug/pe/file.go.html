<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3412205">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3412261">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3412315">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3412366">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="3412451">package</span>&nbsp;<span class="ident" id="3412459">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3412463">import</span>&nbsp;<span class="op" id="3412470">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3412473">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3412488">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3412507">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3412517">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3412524">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3412530">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3412536">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3412546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3412549">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="3412587">type</span>&nbsp;<span class="ident" id="3412592">File</span>&nbsp;<span class="keyword" id="3412597">struct</span>&nbsp;<span class="op" id="3412604">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412607"><a href="/gostd/debug/pe/pe.go.html#3422768">FileHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412619">OptionalHeader</span>&nbsp;<span class="keyword" id="3412634">interface</span><span class="op" id="3412643">{</span><span class="op" id="3412644">}</span>&nbsp;<span class="comment" id="3412646">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412697">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3412712">[</span><span class="op" id="3412713">]</span><span class="op" id="3412714">*</span><span class="ident" id="3412715"><a href="/gostd/debug/pe/file.go.html#3413097">Section</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412724">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3412739">[</span><span class="op" id="3412740">]</span><span class="op" id="3412741">*</span><span class="ident" id="3412742"><a href="/gostd/debug/pe/file.go.html#3413408">Symbol</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412751">closer</span>&nbsp;<span class="ident" id="3412758"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3412760">.</span><span class="ident" id="3412761"><a href="/gostd/io/io.go.html#1422563">Closer</a></span><br>
<span class="lineno"></span><span class="op" id="3412768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3412771">type</span>&nbsp;<span class="ident" id="3412776">SectionHeader</span>&nbsp;<span class="keyword" id="3412790">struct</span>&nbsp;<span class="op" id="3412797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412800">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3412821">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412829">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3412850">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412858">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3412879">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412887">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3412908">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412916">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3412937">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412945">PointerToRelocations</span>&nbsp;<span class="builtintype" id="3412966">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3412974">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="3412995">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413003">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="3413024">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413032">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="3413053">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413061">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413082">uint32</span><br>
<span class="lineno"></span><span class="op" id="3413089">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3413092">type</span>&nbsp;<span class="ident" id="3413097">Section</span>&nbsp;<span class="keyword" id="3413105">struct</span>&nbsp;<span class="op" id="3413112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413115"><a href="/gostd/debug/pe/file.go.html#3412776">SectionHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3413131">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3413169">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3413209">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3413244">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3413292">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3413342">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413366"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3413368">.</span><span class="ident" id="3413369"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413379">sr</span>&nbsp;<span class="op" id="3413382">*</span><span class="ident" id="3413383"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3413385">.</span><span class="ident" id="3413386"><a href="/gostd/io/io.go.html#1432668">SectionReader</a></span><br>
<span class="lineno"></span><span class="op" id="3413400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3413403">type</span>&nbsp;<span class="ident" id="3413408">Symbol</span>&nbsp;<span class="keyword" id="3413415">struct</span>&nbsp;<span class="op" id="3413422">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413425">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413439">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413447">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413461">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413469">SectionNumber</span>&nbsp;<span class="builtintype" id="3413483">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413490">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413504">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413512">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="3413526">uint8</span><br>
<span class="lineno">60</span><span class="op" id="3413532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3413535">type</span>&nbsp;<span class="ident" id="3413540">ImportDirectory</span>&nbsp;<span class="keyword" id="3413556">struct</span>&nbsp;<span class="op" id="3413563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413566">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="3413585">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413593">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413612">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413620">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413639">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413647">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413666">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413674">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3413693">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413702">dll</span>&nbsp;<span class="builtintype" id="3413706">string</span><br>
<span class="lineno">70</span><span class="op" id="3413713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3413716">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="3413774">func</span>&nbsp;<span class="op" id="3413779">(</span><span class="ident" id="3413780">s</span>&nbsp;<span class="op" id="3413782">*</span><span class="ident" id="3413783"><a href="/gostd/debug/pe/file.go.html#3413097">Section</a></span><span class="op" id="3413790">)</span>&nbsp;<span class="ident" id="3413792">Data</span><span class="op" id="3413796">(</span><span class="op" id="3413797">)</span>&nbsp;<span class="op" id="3413799">(</span><span class="op" id="3413800">[</span><span class="op" id="3413801">]</span><span class="builtintype" id="3413802">byte</span><span class="op" id="3413806">,</span>&nbsp;<span class="builtintype" id="3413808">error</span><span class="op" id="3413813">)</span>&nbsp;<span class="op" id="3413815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413818">dat</span>&nbsp;<span class="op" id="3413822">:=</span>&nbsp;<span class="builtinfunc" id="3413825">make</span><span class="op" id="3413829">(</span><span class="op" id="3413830">[</span><span class="op" id="3413831">]</span><span class="builtintype" id="3413832">byte</span><span class="op" id="3413836">,</span>&nbsp;<span class="ident" id="3413838"><a href="/gostd/debug/pe/file.go.html#3413780">s</a></span><span class="op" id="3413839">.</span><span class="ident" id="3413840"><a href="/gostd/debug/pe/file.go.html#3413379">sr</a></span><span class="op" id="3413842">.</span><span class="ident" id="3413843"><a href="/gostd/io/io.go.html#1433783">Size</a></span><span class="op" id="3413847">(</span><span class="op" id="3413848">)</span><span class="op" id="3413849">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413852">n</span><span class="op" id="3413853">,</span>&nbsp;<span class="ident" id="3413855">err</span>&nbsp;<span class="op" id="3413859">:=</span>&nbsp;<span class="ident" id="3413862"><a href="/gostd/debug/pe/file.go.html#3413780">s</a></span><span class="op" id="3413863">.</span><span class="ident" id="3413864"><a href="/gostd/debug/pe/file.go.html#3413379">sr</a></span><span class="op" id="3413866">.</span><span class="ident" id="3413867"><a href="/gostd/io/io.go.html#1433410">ReadAt</a></span><span class="op" id="3413873">(</span><span class="ident" id="3413874"><a href="/gostd/debug/pe/file.go.html#3413818">dat</a></span><span class="op" id="3413877">,</span>&nbsp;<span class="num" id="3413879">0</span><span class="op" id="3413880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3413883">if</span>&nbsp;<span class="ident" id="3413886"><a href="/gostd/debug/pe/file.go.html#3413852">n</a></span>&nbsp;<span class="op" id="3413888">==</span>&nbsp;<span class="builtinfunc" id="3413891">len</span><span class="op" id="3413894">(</span><span class="ident" id="3413895"><a href="/gostd/debug/pe/file.go.html#3413818">dat</a></span><span class="op" id="3413898">)</span>&nbsp;<span class="op" id="3413900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3413904"><a href="/gostd/debug/pe/file.go.html#3413855">err</a></span>&nbsp;<span class="op" id="3413908">=</span>&nbsp;<span class="builtintype" id="3413910">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3413915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3413918">return</span>&nbsp;<span class="ident" id="3413925"><a href="/gostd/debug/pe/file.go.html#3413818">dat</a></span><span class="op" id="3413928">[</span><span class="num" id="3413929">0</span><span class="op" id="3413930">:</span><span class="ident" id="3413931"><a href="/gostd/debug/pe/file.go.html#3413852">n</a></span><span class="op" id="3413932">]</span><span class="op" id="3413933">,</span>&nbsp;<span class="ident" id="3413935"><a href="/gostd/debug/pe/file.go.html#3413855">err</a></span><br>
<span class="lineno">80</span><span class="op" id="3413939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3413942">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="3413999">func</span>&nbsp;<span class="op" id="3414004">(</span><span class="ident" id="3414005">s</span>&nbsp;<span class="op" id="3414007">*</span><span class="ident" id="3414008"><a href="/gostd/debug/pe/file.go.html#3413097">Section</a></span><span class="op" id="3414015">)</span>&nbsp;<span class="ident" id="3414017">Open</span><span class="op" id="3414021">(</span><span class="op" id="3414022">)</span>&nbsp;<span class="ident" id="3414024"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3414026">.</span><span class="ident" id="3414027"><a href="/gostd/io/io.go.html#1423813">ReadSeeker</a></span>&nbsp;<span class="op" id="3414038">{</span>&nbsp;<span class="keyword" id="3414040">return</span>&nbsp;<span class="ident" id="3414047"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3414049">.</span><span class="ident" id="3414050"><a href="/gostd/io/io.go.html#1432455">NewSectionReader</a></span><span class="op" id="3414066">(</span><span class="ident" id="3414067"><a href="/gostd/debug/pe/file.go.html#3414005">s</a></span><span class="op" id="3414068">.</span><span class="ident" id="3414069"><a href="/gostd/debug/pe/file.go.html#3413379">sr</a></span><span class="op" id="3414071">,</span>&nbsp;<span class="num" id="3414073">0</span><span class="op" id="3414074">,</span>&nbsp;<span class="num" id="3414076">1</span><span class="op" id="3414077">&lt;&lt;</span><span class="num" id="3414079">63</span><span class="op" id="3414081">-</span><span class="num" id="3414082">1</span><span class="op" id="3414083">)</span>&nbsp;<span class="op" id="3414085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="3414088">type</span>&nbsp;<span class="ident" id="3414093">FormatError</span>&nbsp;<span class="keyword" id="3414105">struct</span>&nbsp;<span class="op" id="3414112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414115">off</span>&nbsp;<span class="builtintype" id="3414119">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414126">msg</span>&nbsp;<span class="builtintype" id="3414130">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414138">val</span>&nbsp;<span class="keyword" id="3414142">interface</span><span class="op" id="3414151">{</span><span class="op" id="3414152">}</span><br>
<span class="lineno"></span><span class="op" id="3414154">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="3414157">func</span>&nbsp;<span class="op" id="3414162">(</span><span class="ident" id="3414163">e</span>&nbsp;<span class="op" id="3414165">*</span><span class="ident" id="3414166"><a href="/gostd/debug/pe/file.go.html#3414093">FormatError</a></span><span class="op" id="3414177">)</span>&nbsp;<span class="ident" id="3414179">Error</span><span class="op" id="3414184">(</span><span class="op" id="3414185">)</span>&nbsp;<span class="builtintype" id="3414187">string</span>&nbsp;<span class="op" id="3414194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414197">msg</span>&nbsp;<span class="op" id="3414201">:=</span>&nbsp;<span class="ident" id="3414204"><a href="/gostd/debug/pe/file.go.html#3414163">e</a></span><span class="op" id="3414205">.</span><span class="ident" id="3414206"><a href="/gostd/debug/pe/file.go.html#3414126">msg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414211">if</span>&nbsp;<span class="ident" id="3414214"><a href="/gostd/debug/pe/file.go.html#3414163">e</a></span><span class="op" id="3414215">.</span><span class="ident" id="3414216"><a href="/gostd/debug/pe/file.go.html#3414138">val</a></span>&nbsp;<span class="op" id="3414220">!=</span>&nbsp;<span class="builtintype" id="3414223">nil</span>&nbsp;<span class="op" id="3414227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414231"><a href="/gostd/debug/pe/file.go.html#3414197">msg</a></span>&nbsp;<span class="op" id="3414235">+=</span>&nbsp;<span class="ident" id="3414238"><a href="/gostd/debug/pe/file.go.html#3412517">fmt</a></span><span class="op" id="3414241">.</span><span class="ident" id="3414242"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3414249">(</span><span class="string" id="3414250">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="3414257">,</span>&nbsp;<span class="ident" id="3414259"><a href="/gostd/debug/pe/file.go.html#3414163">e</a></span><span class="op" id="3414260">.</span><span class="ident" id="3414261"><a href="/gostd/debug/pe/file.go.html#3414138">val</a></span><span class="op" id="3414264">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3414267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414270"><a href="/gostd/debug/pe/file.go.html#3414197">msg</a></span>&nbsp;<span class="op" id="3414274">+=</span>&nbsp;<span class="ident" id="3414277"><a href="/gostd/debug/pe/file.go.html#3412517">fmt</a></span><span class="op" id="3414280">.</span><span class="ident" id="3414281"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3414288">(</span><span class="string" id="3414289">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="3414313">,</span>&nbsp;<span class="ident" id="3414315"><a href="/gostd/debug/pe/file.go.html#3414163">e</a></span><span class="op" id="3414316">.</span><span class="ident" id="3414317"><a href="/gostd/debug/pe/file.go.html#3414115">off</a></span><span class="op" id="3414320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414323">return</span>&nbsp;<span class="ident" id="3414330"><a href="/gostd/debug/pe/file.go.html#3414197">msg</a></span><br>
<span class="lineno"></span><span class="op" id="3414334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3414337">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3414420">func</span>&nbsp;<span class="ident" id="3414425">Open</span><span class="op" id="3414429">(</span><span class="ident" id="3414430">name</span>&nbsp;<span class="builtintype" id="3414435">string</span><span class="op" id="3414441">)</span>&nbsp;<span class="op" id="3414443">(</span><span class="op" id="3414444">*</span><span class="ident" id="3414445"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3414449">,</span>&nbsp;<span class="builtintype" id="3414451">error</span><span class="op" id="3414456">)</span>&nbsp;<span class="op" id="3414458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414461">f</span><span class="op" id="3414462">,</span>&nbsp;<span class="ident" id="3414464">err</span>&nbsp;<span class="op" id="3414468">:=</span>&nbsp;<span class="ident" id="3414471"><a href="/gostd/debug/pe/file.go.html#3412530">os</a></span><span class="op" id="3414473">.</span><span class="ident" id="3414474"><a href="/gostd/os/file.go.html#2446863">Open</a></span><span class="op" id="3414478">(</span><span class="ident" id="3414479"><a href="/gostd/debug/pe/file.go.html#3414430">name</a></span><span class="op" id="3414483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414486">if</span>&nbsp;<span class="ident" id="3414489"><a href="/gostd/debug/pe/file.go.html#3414464">err</a></span>&nbsp;<span class="op" id="3414493">!=</span>&nbsp;<span class="builtintype" id="3414496">nil</span>&nbsp;<span class="op" id="3414500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414504">return</span>&nbsp;<span class="builtintype" id="3414511">nil</span><span class="op" id="3414514">,</span>&nbsp;<span class="ident" id="3414516"><a href="/gostd/debug/pe/file.go.html#3414464">err</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3414521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414524">ff</span><span class="op" id="3414526">,</span>&nbsp;<span class="ident" id="3414528"><a href="/gostd/debug/pe/file.go.html#3414464">err</a></span>&nbsp;<span class="op" id="3414532">:=</span>&nbsp;<span class="ident" id="3414535"><a href="/gostd/debug/pe/file.go.html#3415102">NewFile</a></span><span class="op" id="3414542">(</span><span class="ident" id="3414543"><a href="/gostd/debug/pe/file.go.html#3414461">f</a></span><span class="op" id="3414544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414547">if</span>&nbsp;<span class="ident" id="3414550"><a href="/gostd/debug/pe/file.go.html#3414464">err</a></span>&nbsp;<span class="op" id="3414554">!=</span>&nbsp;<span class="builtintype" id="3414557">nil</span>&nbsp;<span class="op" id="3414561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414565"><a href="/gostd/debug/pe/file.go.html#3414461">f</a></span><span class="op" id="3414566">.</span><span class="ident" id="3414567"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="3414572">(</span><span class="op" id="3414573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414577">return</span>&nbsp;<span class="builtintype" id="3414584">nil</span><span class="op" id="3414587">,</span>&nbsp;<span class="ident" id="3414589"><a href="/gostd/debug/pe/file.go.html#3414464">err</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3414594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414597"><a href="/gostd/debug/pe/file.go.html#3414524">ff</a></span><span class="op" id="3414599">.</span><span class="ident" id="3414600"><a href="/gostd/debug/pe/file.go.html#3412751">closer</a></span>&nbsp;<span class="op" id="3414607">=</span>&nbsp;<span class="ident" id="3414609"><a href="/gostd/debug/pe/file.go.html#3414461">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414612">return</span>&nbsp;<span class="ident" id="3414619"><a href="/gostd/debug/pe/file.go.html#3414524">ff</a></span><span class="op" id="3414621">,</span>&nbsp;<span class="builtintype" id="3414623">nil</span><br>
<span class="lineno"></span><span class="op" id="3414627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="3414630">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="3414656">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="3414723">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="3414747">func</span>&nbsp;<span class="op" id="3414752">(</span><span class="ident" id="3414753">f</span>&nbsp;<span class="op" id="3414755">*</span><span class="ident" id="3414756"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3414760">)</span>&nbsp;<span class="ident" id="3414762">Close</span><span class="op" id="3414767">(</span><span class="op" id="3414768">)</span>&nbsp;<span class="builtintype" id="3414770">error</span>&nbsp;<span class="op" id="3414776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414779">var</span>&nbsp;<span class="ident" id="3414783">err</span>&nbsp;<span class="builtintype" id="3414787">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414794">if</span>&nbsp;<span class="ident" id="3414797"><a href="/gostd/debug/pe/file.go.html#3414753">f</a></span><span class="op" id="3414798">.</span><span class="ident" id="3414799"><a href="/gostd/debug/pe/file.go.html#3412751">closer</a></span>&nbsp;<span class="op" id="3414806">!=</span>&nbsp;<span class="builtintype" id="3414809">nil</span>&nbsp;<span class="op" id="3414813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414817"><a href="/gostd/debug/pe/file.go.html#3414783">err</a></span>&nbsp;<span class="op" id="3414821">=</span>&nbsp;<span class="ident" id="3414823"><a href="/gostd/debug/pe/file.go.html#3414753">f</a></span><span class="op" id="3414824">.</span><span class="ident" id="3414825"><a href="/gostd/debug/pe/file.go.html#3412751">closer</a></span><span class="op" id="3414831">.</span><span class="ident" id="3414832"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="3414837">(</span><span class="op" id="3414838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414842"><a href="/gostd/debug/pe/file.go.html#3414753">f</a></span><span class="op" id="3414843">.</span><span class="ident" id="3414844"><a href="/gostd/debug/pe/file.go.html#3412751">closer</a></span>&nbsp;<span class="op" id="3414851">=</span>&nbsp;<span class="builtintype" id="3414853">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3414858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3414861">return</span>&nbsp;<span class="ident" id="3414868"><a href="/gostd/debug/pe/file.go.html#3414783">err</a></span><br>
<span class="lineno">125</span><span class="op" id="3414872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3414875">var</span>&nbsp;<span class="op" id="3414879">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414882">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="3414905">=</span>&nbsp;<span class="builtintype" id="3414907">uint16</span><span class="op" id="3414913">(</span><span class="ident" id="3414914"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3414920">.</span><span class="ident" id="3414921"><a href="/gostd/encoding/binary/binary.go.html#2994221">Size</a></span><span class="op" id="3414925">(</span><span class="ident" id="3414926"><a href="/gostd/debug/pe/pe.go.html#3423076">OptionalHeader32</a></span><span class="op" id="3414942">{</span><span class="op" id="3414943">}</span><span class="op" id="3414944">)</span><span class="op" id="3414945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3414948">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="3414971">=</span>&nbsp;<span class="builtintype" id="3414973">uint16</span><span class="op" id="3414979">(</span><span class="ident" id="3414980"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3414986">.</span><span class="ident" id="3414987"><a href="/gostd/encoding/binary/binary.go.html#2994221">Size</a></span><span class="op" id="3414991">(</span><span class="ident" id="3414992"><a href="/gostd/debug/pe/pe.go.html#3424235">OptionalHeader64</a></span><span class="op" id="3415008">{</span><span class="op" id="3415009">}</span><span class="op" id="3415010">)</span><span class="op" id="3415011">)</span><br>
<span class="lineno">130</span><span class="op" id="3415013">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3415016">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="3415097">func</span>&nbsp;<span class="ident" id="3415102">NewFile</span><span class="op" id="3415109">(</span><span class="ident" id="3415110">r</span>&nbsp;<span class="ident" id="3415112"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3415114">.</span><span class="ident" id="3415115"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><span class="op" id="3415123">)</span>&nbsp;<span class="op" id="3415125">(</span><span class="op" id="3415126">*</span><span class="ident" id="3415127"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3415131">,</span>&nbsp;<span class="builtintype" id="3415133">error</span><span class="op" id="3415138">)</span>&nbsp;<span class="op" id="3415140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3415143">f</span>&nbsp;<span class="op" id="3415145">:=</span>&nbsp;<span class="builtinfunc" id="3415148">new</span><span class="op" id="3415151">(</span><span class="ident" id="3415152"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3415156">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3415159">sr</span>&nbsp;<span class="op" id="3415162">:=</span>&nbsp;<span class="ident" id="3415165"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3415167">.</span><span class="ident" id="3415168"><a href="/gostd/io/io.go.html#1432455">NewSectionReader</a></span><span class="op" id="3415184">(</span><span class="ident" id="3415185"><a href="/gostd/debug/pe/file.go.html#3415110">r</a></span><span class="op" id="3415186">,</span>&nbsp;<span class="num" id="3415188">0</span><span class="op" id="3415189">,</span>&nbsp;<span class="num" id="3415191">1</span><span class="op" id="3415192">&lt;&lt;</span><span class="num" id="3415194">63</span><span class="op" id="3415196">-</span><span class="num" id="3415197">1</span><span class="op" id="3415198">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415202">var</span>&nbsp;<span class="ident" id="3415206">dosheader</span>&nbsp;<span class="op" id="3415216">[</span><span class="num" id="3415217">96</span><span class="op" id="3415219">]</span><span class="builtintype" id="3415220">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415226">if</span>&nbsp;<span class="ident" id="3415229">_</span><span class="op" id="3415230">,</span>&nbsp;<span class="ident" id="3415232">err</span>&nbsp;<span class="op" id="3415236">:=</span>&nbsp;<span class="ident" id="3415239"><a href="/gostd/debug/pe/file.go.html#3415110">r</a></span><span class="op" id="3415240">.</span><span class="ident" id="3415241"><a href="/gostd/io/io.go.html#1426007">ReadAt</a></span><span class="op" id="3415247">(</span><span class="ident" id="3415248"><a href="/gostd/debug/pe/file.go.html#3415206">dosheader</a></span><span class="op" id="3415257">[</span><span class="num" id="3415258">0</span><span class="op" id="3415259">:</span><span class="op" id="3415260">]</span><span class="op" id="3415261">,</span>&nbsp;<span class="num" id="3415263">0</span><span class="op" id="3415264">)</span><span class="op" id="3415265">;</span>&nbsp;<span class="ident" id="3415267"><a href="/gostd/debug/pe/file.go.html#3415232">err</a></span>&nbsp;<span class="op" id="3415271">!=</span>&nbsp;<span class="builtintype" id="3415274">nil</span>&nbsp;<span class="op" id="3415278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415282">return</span>&nbsp;<span class="builtintype" id="3415289">nil</span><span class="op" id="3415292">,</span>&nbsp;<span class="ident" id="3415294"><a href="/gostd/debug/pe/file.go.html#3415232">err</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3415299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415302">var</span>&nbsp;<span class="ident" id="3415306">base</span>&nbsp;<span class="builtintype" id="3415311">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415318">if</span>&nbsp;<span class="ident" id="3415321"><a href="/gostd/debug/pe/file.go.html#3415206">dosheader</a></span><span class="op" id="3415330">[</span><span class="num" id="3415331">0</span><span class="op" id="3415332">]</span>&nbsp;<span class="op" id="3415334">==</span>&nbsp;<span class="string" id="3415337">&#39;M&#39;</span>&nbsp;<span class="op" id="3415341">&amp;&amp;</span>&nbsp;<span class="ident" id="3415344"><a href="/gostd/debug/pe/file.go.html#3415206">dosheader</a></span><span class="op" id="3415353">[</span><span class="num" id="3415354">1</span><span class="op" id="3415355">]</span>&nbsp;<span class="op" id="3415357">==</span>&nbsp;<span class="string" id="3415360">&#39;Z&#39;</span>&nbsp;<span class="op" id="3415364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3415368">signoff</span>&nbsp;<span class="op" id="3415376">:=</span>&nbsp;<span class="builtintype" id="3415379">int64</span><span class="op" id="3415384">(</span><span class="ident" id="3415385"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3415391">.</span><span class="ident" id="3415392"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3415404">.</span><span class="ident" id="3415405"><a href="/gostd/encoding/binary/binary.go.html#2987394">Uint32</a></span><span class="op" id="3415411">(</span><span class="ident" id="3415412"><a href="/gostd/debug/pe/file.go.html#3415206">dosheader</a></span><span class="op" id="3415421">[</span><span class="num" id="3415422">0x3c</span><span class="op" id="3415426">:</span><span class="op" id="3415427">]</span><span class="op" id="3415428">)</span><span class="op" id="3415429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415433">var</span>&nbsp;<span class="ident" id="3415437">sign</span>&nbsp;<span class="op" id="3415442">[</span><span class="num" id="3415443">4</span><span class="op" id="3415444">]</span><span class="builtintype" id="3415445">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3415452"><a href="/gostd/debug/pe/file.go.html#3415110">r</a></span><span class="op" id="3415453">.</span><span class="ident" id="3415454"><a href="/gostd/io/io.go.html#1426007">ReadAt</a></span><span class="op" id="3415460">(</span><span class="ident" id="3415461"><a href="/gostd/debug/pe/file.go.html#3415437">sign</a></span><span class="op" id="3415465">[</span><span class="op" id="3415466">:</span><span class="op" id="3415467">]</span><span class="op" id="3415468">,</span>&nbsp;<span class="ident" id="3415470"><a href="/gostd/debug/pe/file.go.html#3415368">signoff</a></span><span class="op" id="3415477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415481">if</span>&nbsp;<span class="op" id="3415484">!</span><span class="op" id="3415485">(</span><span class="ident" id="3415486"><a href="/gostd/debug/pe/file.go.html#3415437">sign</a></span><span class="op" id="3415490">[</span><span class="num" id="3415491">0</span><span class="op" id="3415492">]</span>&nbsp;<span class="op" id="3415494">==</span>&nbsp;<span class="string" id="3415497">&#39;P&#39;</span>&nbsp;<span class="op" id="3415501">&amp;&amp;</span>&nbsp;<span class="ident" id="3415504"><a href="/gostd/debug/pe/file.go.html#3415437">sign</a></span><span class="op" id="3415508">[</span><span class="num" id="3415509">1</span><span class="op" id="3415510">]</span>&nbsp;<span class="op" id="3415512">==</span>&nbsp;<span class="string" id="3415515">&#39;E&#39;</span>&nbsp;<span class="op" id="3415519">&amp;&amp;</span>&nbsp;<span class="ident" id="3415522"><a href="/gostd/debug/pe/file.go.html#3415437">sign</a></span><span class="op" id="3415526">[</span><span class="num" id="3415527">2</span><span class="op" id="3415528">]</span>&nbsp;<span class="op" id="3415530">==</span>&nbsp;<span class="num" id="3415533">0</span>&nbsp;<span class="op" id="3415535">&amp;&amp;</span>&nbsp;<span class="ident" id="3415538"><a href="/gostd/debug/pe/file.go.html#3415437">sign</a></span><span class="op" id="3415542">[</span><span class="num" id="3415543">3</span><span class="op" id="3415544">]</span>&nbsp;<span class="op" id="3415546">==</span>&nbsp;<span class="num" id="3415549">0</span><span class="op" id="3415550">)</span>&nbsp;<span class="op" id="3415552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415557">return</span>&nbsp;<span class="builtintype" id="3415564">nil</span><span class="op" id="3415567">,</span>&nbsp;<span class="ident" id="3415569"><a href="/gostd/debug/pe/file.go.html#3412507">errors</a></span><span class="op" id="3415575">.</span><span class="ident" id="3415576"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="3415579">(</span><span class="string" id="3415580">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="3415605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3415609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3415613"><a href="/gostd/debug/pe/file.go.html#3415306">base</a></span>&nbsp;<span class="op" id="3415618">=</span>&nbsp;<span class="ident" id="3415620"><a href="/gostd/debug/pe/file.go.html#3415368">signoff</a></span>&nbsp;<span class="op" id="3415628">+</span>&nbsp;<span class="num" id="3415630">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3415633">}</span>&nbsp;<span class="keyword" id="3415635">else</span>&nbsp;<span class="op" id="3415640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3415644"><a href="/gostd/debug/pe/file.go.html#3415306">base</a></span>&nbsp;<span class="op" id="3415649">=</span>&nbsp;<span class="builtintype" id="3415651">int64</span><span class="op" id="3415656">(</span><span class="num" id="3415657">0</span><span class="op" id="3415658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3415661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3415664"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3415666">.</span><span class="ident" id="3415667"><a href="/gostd/io/io.go.html#1433107">Seek</a></span><span class="op" id="3415671">(</span><span class="ident" id="3415672"><a href="/gostd/debug/pe/file.go.html#3415306">base</a></span><span class="op" id="3415676">,</span>&nbsp;<span class="ident" id="3415678"><a href="/gostd/debug/pe/file.go.html#3412530">os</a></span><span class="op" id="3415680">.</span><span class="ident" id="3415681"><a href="/gostd/os/file.go.html#2442631">SEEK_SET</a></span><span class="op" id="3415689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415692">if</span>&nbsp;<span class="ident" id="3415695">err</span>&nbsp;<span class="op" id="3415699">:=</span>&nbsp;<span class="ident" id="3415702"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3415708">.</span><span class="ident" id="3415709"><a href="/gostd/encoding/binary/binary.go.html#2989675">Read</a></span><span class="op" id="3415713">(</span><span class="ident" id="3415714"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3415716">,</span>&nbsp;<span class="ident" id="3415718"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3415724">.</span><span class="ident" id="3415725"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3415737">,</span>&nbsp;<span class="op" id="3415739">&amp;</span><span class="ident" id="3415740"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3415741">.</span><span class="ident" id="3415742"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3415752">)</span><span class="op" id="3415753">;</span>&nbsp;<span class="ident" id="3415755"><a href="/gostd/debug/pe/file.go.html#3415695">err</a></span>&nbsp;<span class="op" id="3415759">!=</span>&nbsp;<span class="builtintype" id="3415762">nil</span>&nbsp;<span class="op" id="3415766">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415770">return</span>&nbsp;<span class="builtintype" id="3415777">nil</span><span class="op" id="3415780">,</span>&nbsp;<span class="ident" id="3415782"><a href="/gostd/debug/pe/file.go.html#3415695">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3415787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415790">if</span>&nbsp;<span class="ident" id="3415793"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3415794">.</span><span class="ident" id="3415795"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3415805">.</span><span class="ident" id="3415806"><a href="/gostd/debug/pe/pe.go.html#3422789">Machine</a></span>&nbsp;<span class="op" id="3415814">!=</span>&nbsp;<span class="ident" id="3415817"><a href="/gostd/debug/pe/pe.go.html#3425903">IMAGE_FILE_MACHINE_UNKNOWN</a></span>&nbsp;<span class="op" id="3415844">&amp;&amp;</span>&nbsp;<span class="ident" id="3415847"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3415848">.</span><span class="ident" id="3415849"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3415859">.</span><span class="ident" id="3415860"><a href="/gostd/debug/pe/pe.go.html#3422789">Machine</a></span>&nbsp;<span class="op" id="3415868">!=</span>&nbsp;<span class="ident" id="3415871"><a href="/gostd/debug/pe/pe.go.html#3425977">IMAGE_FILE_MACHINE_AMD64</a></span>&nbsp;<span class="op" id="3415896">&amp;&amp;</span>&nbsp;<span class="ident" id="3415899"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3415900">.</span><span class="ident" id="3415901"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3415911">.</span><span class="ident" id="3415912"><a href="/gostd/debug/pe/pe.go.html#3422789">Machine</a></span>&nbsp;<span class="op" id="3415920">!=</span>&nbsp;<span class="ident" id="3415923"><a href="/gostd/debug/pe/pe.go.html#3426092">IMAGE_FILE_MACHINE_I386</a></span>&nbsp;<span class="op" id="3415947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3415951">return</span>&nbsp;<span class="builtintype" id="3415958">nil</span><span class="op" id="3415961">,</span>&nbsp;<span class="ident" id="3415963"><a href="/gostd/debug/pe/file.go.html#3412507">errors</a></span><span class="op" id="3415969">.</span><span class="ident" id="3415970"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="3415973">(</span><span class="string" id="3415974">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="3415999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3416002">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416006">var</span>&nbsp;<span class="ident" id="3416010">ss</span>&nbsp;<span class="op" id="3416013">[</span><span class="op" id="3416014">]</span><span class="builtintype" id="3416015">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416021">if</span>&nbsp;<span class="ident" id="3416024"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3416025">.</span><span class="ident" id="3416026"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3416036">.</span><span class="ident" id="3416037"><a href="/gostd/debug/pe/pe.go.html#3422905">NumberOfSymbols</a></span>&nbsp;<span class="op" id="3416053">&gt;</span>&nbsp;<span class="num" id="3416055">0</span>&nbsp;<span class="op" id="3416057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3416061">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3416143"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3416145">.</span><span class="ident" id="3416146"><a href="/gostd/io/io.go.html#1433107">Seek</a></span><span class="op" id="3416150">(</span><span class="builtintype" id="3416151">int64</span><span class="op" id="3416156">(</span><span class="ident" id="3416157"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3416158">.</span><span class="ident" id="3416159"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3416169">.</span><span class="ident" id="3416170"><a href="/gostd/debug/pe/pe.go.html#3422876">PointerToSymbolTable</a></span><span class="op" id="3416190">+</span><span class="ident" id="3416191"><a href="/gostd/debug/pe/pe.go.html#3425684">COFFSymbolSize</a></span><span class="op" id="3416205">*</span><span class="ident" id="3416206"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3416207">.</span><span class="ident" id="3416208"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3416218">.</span><span class="ident" id="3416219"><a href="/gostd/debug/pe/pe.go.html#3422905">NumberOfSymbols</a></span><span class="op" id="3416234">)</span><span class="op" id="3416235">,</span>&nbsp;<span class="ident" id="3416237"><a href="/gostd/debug/pe/file.go.html#3412530">os</a></span><span class="op" id="3416239">.</span><span class="ident" id="3416240"><a href="/gostd/os/file.go.html#2442631">SEEK_SET</a></span><span class="op" id="3416248">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416252">var</span>&nbsp;<span class="ident" id="3416256">l</span>&nbsp;<span class="builtintype" id="3416258">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416267">if</span>&nbsp;<span class="ident" id="3416270">err</span>&nbsp;<span class="op" id="3416274">:=</span>&nbsp;<span class="ident" id="3416277"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3416283">.</span><span class="ident" id="3416284"><a href="/gostd/encoding/binary/binary.go.html#2989675">Read</a></span><span class="op" id="3416288">(</span><span class="ident" id="3416289"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3416291">,</span>&nbsp;<span class="ident" id="3416293"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3416299">.</span><span class="ident" id="3416300"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3416312">,</span>&nbsp;<span class="op" id="3416314">&amp;</span><span class="ident" id="3416315"><a href="/gostd/debug/pe/file.go.html#3416256">l</a></span><span class="op" id="3416316">)</span><span class="op" id="3416317">;</span>&nbsp;<span class="ident" id="3416319"><a href="/gostd/debug/pe/file.go.html#3416270">err</a></span>&nbsp;<span class="op" id="3416323">!=</span>&nbsp;<span class="builtintype" id="3416326">nil</span>&nbsp;<span class="op" id="3416330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416335">return</span>&nbsp;<span class="builtintype" id="3416342">nil</span><span class="op" id="3416345">,</span>&nbsp;<span class="ident" id="3416347"><a href="/gostd/debug/pe/file.go.html#3416270">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3416353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3416357"><a href="/gostd/debug/pe/file.go.html#3416010">ss</a></span>&nbsp;<span class="op" id="3416360">=</span>&nbsp;<span class="builtinfunc" id="3416362">make</span><span class="op" id="3416366">(</span><span class="op" id="3416367">[</span><span class="op" id="3416368">]</span><span class="builtintype" id="3416369">byte</span><span class="op" id="3416373">,</span>&nbsp;<span class="ident" id="3416375"><a href="/gostd/debug/pe/file.go.html#3416256">l</a></span><span class="op" id="3416376">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416380">if</span>&nbsp;<span class="ident" id="3416383">_</span><span class="op" id="3416384">,</span>&nbsp;<span class="ident" id="3416386">err</span>&nbsp;<span class="op" id="3416390">:=</span>&nbsp;<span class="ident" id="3416393"><a href="/gostd/debug/pe/file.go.html#3415110">r</a></span><span class="op" id="3416394">.</span><span class="ident" id="3416395"><a href="/gostd/io/io.go.html#1426007">ReadAt</a></span><span class="op" id="3416401">(</span><span class="ident" id="3416402"><a href="/gostd/debug/pe/file.go.html#3416010">ss</a></span><span class="op" id="3416404">,</span>&nbsp;<span class="builtintype" id="3416406">int64</span><span class="op" id="3416411">(</span><span class="ident" id="3416412"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3416413">.</span><span class="ident" id="3416414"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3416424">.</span><span class="ident" id="3416425"><a href="/gostd/debug/pe/pe.go.html#3422876">PointerToSymbolTable</a></span><span class="op" id="3416445">+</span><span class="ident" id="3416446"><a href="/gostd/debug/pe/pe.go.html#3425684">COFFSymbolSize</a></span><span class="op" id="3416460">*</span><span class="ident" id="3416461"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3416462">.</span><span class="ident" id="3416463"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3416473">.</span><span class="ident" id="3416474"><a href="/gostd/debug/pe/pe.go.html#3422905">NumberOfSymbols</a></span><span class="op" id="3416489">)</span><span class="op" id="3416490">)</span><span class="op" id="3416491">;</span>&nbsp;<span class="ident" id="3416493"><a href="/gostd/debug/pe/file.go.html#3416386">err</a></span>&nbsp;<span class="op" id="3416497">!=</span>&nbsp;<span class="builtintype" id="3416500">nil</span>&nbsp;<span class="op" id="3416504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416509">return</span>&nbsp;<span class="builtintype" id="3416516">nil</span><span class="op" id="3416519">,</span>&nbsp;<span class="ident" id="3416521"><a href="/gostd/debug/pe/file.go.html#3416386">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3416527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3416532">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3416564"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3416566">.</span><span class="ident" id="3416567"><a href="/gostd/io/io.go.html#1433107">Seek</a></span><span class="op" id="3416571">(</span><span class="builtintype" id="3416572">int64</span><span class="op" id="3416577">(</span><span class="ident" id="3416578"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3416579">.</span><span class="ident" id="3416580"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3416590">.</span><span class="ident" id="3416591"><a href="/gostd/debug/pe/pe.go.html#3422876">PointerToSymbolTable</a></span><span class="op" id="3416611">)</span><span class="op" id="3416612">,</span>&nbsp;<span class="ident" id="3416614"><a href="/gostd/debug/pe/file.go.html#3412530">os</a></span><span class="op" id="3416616">.</span><span class="ident" id="3416617"><a href="/gostd/os/file.go.html#2442631">SEEK_SET</a></span><span class="op" id="3416625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3416629">aux</span>&nbsp;<span class="op" id="3416633">:=</span>&nbsp;<span class="builtintype" id="3416636">uint8</span><span class="op" id="3416641">(</span><span class="num" id="3416642">0</span><span class="op" id="3416643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416647">for</span>&nbsp;<span class="ident" id="3416651">i</span>&nbsp;<span class="op" id="3416653">:=</span>&nbsp;<span class="num" id="3416656">0</span><span class="op" id="3416657">;</span>&nbsp;<span class="ident" id="3416659"><a href="/gostd/debug/pe/file.go.html#3416651">i</a></span>&nbsp;<span class="op" id="3416661">&lt;</span>&nbsp;<span class="builtintype" id="3416663">int</span><span class="op" id="3416666">(</span><span class="ident" id="3416667"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3416668">.</span><span class="ident" id="3416669"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3416679">.</span><span class="ident" id="3416680"><a href="/gostd/debug/pe/pe.go.html#3422905">NumberOfSymbols</a></span><span class="op" id="3416695">)</span><span class="op" id="3416696">;</span>&nbsp;<span class="ident" id="3416698"><a href="/gostd/debug/pe/file.go.html#3416651">i</a></span><span class="op" id="3416699">++</span>&nbsp;<span class="op" id="3416702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3416707">cs</span>&nbsp;<span class="op" id="3416710">:=</span>&nbsp;<span class="builtinfunc" id="3416713">new</span><span class="op" id="3416716">(</span><span class="ident" id="3416717"><a href="/gostd/debug/pe/pe.go.html#3425710">COFFSymbol</a></span><span class="op" id="3416727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416732">if</span>&nbsp;<span class="ident" id="3416735">err</span>&nbsp;<span class="op" id="3416739">:=</span>&nbsp;<span class="ident" id="3416742"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3416748">.</span><span class="ident" id="3416749"><a href="/gostd/encoding/binary/binary.go.html#2989675">Read</a></span><span class="op" id="3416753">(</span><span class="ident" id="3416754"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3416756">,</span>&nbsp;<span class="ident" id="3416758"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3416764">.</span><span class="ident" id="3416765"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3416777">,</span>&nbsp;<span class="ident" id="3416779"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3416781">)</span><span class="op" id="3416782">;</span>&nbsp;<span class="ident" id="3416784"><a href="/gostd/debug/pe/file.go.html#3416735">err</a></span>&nbsp;<span class="op" id="3416788">!=</span>&nbsp;<span class="builtintype" id="3416791">nil</span>&nbsp;<span class="op" id="3416795">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416801">return</span>&nbsp;<span class="builtintype" id="3416808">nil</span><span class="op" id="3416811">,</span>&nbsp;<span class="ident" id="3416813"><a href="/gostd/debug/pe/file.go.html#3416735">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3416820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416825">if</span>&nbsp;<span class="ident" id="3416828"><a href="/gostd/debug/pe/file.go.html#3416629">aux</a></span>&nbsp;<span class="op" id="3416832">&gt;</span>&nbsp;<span class="num" id="3416834">0</span>&nbsp;<span class="op" id="3416836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3416842"><a href="/gostd/debug/pe/file.go.html#3416629">aux</a></span><span class="op" id="3416845">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416852">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3416864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416869">var</span>&nbsp;<span class="ident" id="3416873">name</span>&nbsp;<span class="builtintype" id="3416878">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3416888">if</span>&nbsp;<span class="ident" id="3416891"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3416893">.</span><span class="ident" id="3416894"><a href="/gostd/debug/pe/pe.go.html#3425731">Name</a></span><span class="op" id="3416898">[</span><span class="num" id="3416899">0</span><span class="op" id="3416900">]</span>&nbsp;<span class="op" id="3416902">==</span>&nbsp;<span class="num" id="3416905">0</span>&nbsp;<span class="op" id="3416907">&amp;&amp;</span>&nbsp;<span class="ident" id="3416910"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3416912">.</span><span class="ident" id="3416913"><a href="/gostd/debug/pe/pe.go.html#3425731">Name</a></span><span class="op" id="3416917">[</span><span class="num" id="3416918">1</span><span class="op" id="3416919">]</span>&nbsp;<span class="op" id="3416921">==</span>&nbsp;<span class="num" id="3416924">0</span>&nbsp;<span class="op" id="3416926">&amp;&amp;</span>&nbsp;<span class="ident" id="3416929"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3416931">.</span><span class="ident" id="3416932"><a href="/gostd/debug/pe/pe.go.html#3425731">Name</a></span><span class="op" id="3416936">[</span><span class="num" id="3416937">2</span><span class="op" id="3416938">]</span>&nbsp;<span class="op" id="3416940">==</span>&nbsp;<span class="num" id="3416943">0</span>&nbsp;<span class="op" id="3416945">&amp;&amp;</span>&nbsp;<span class="ident" id="3416948"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3416950">.</span><span class="ident" id="3416951"><a href="/gostd/debug/pe/pe.go.html#3425731">Name</a></span><span class="op" id="3416955">[</span><span class="num" id="3416956">3</span><span class="op" id="3416957">]</span>&nbsp;<span class="op" id="3416959">==</span>&nbsp;<span class="num" id="3416962">0</span>&nbsp;<span class="op" id="3416964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3416970">si</span>&nbsp;<span class="op" id="3416973">:=</span>&nbsp;<span class="builtintype" id="3416976">int</span><span class="op" id="3416979">(</span><span class="ident" id="3416980"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3416986">.</span><span class="ident" id="3416987"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3416999">.</span><span class="ident" id="3417000"><a href="/gostd/encoding/binary/binary.go.html#2987394">Uint32</a></span><span class="op" id="3417006">(</span><span class="ident" id="3417007"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3417009">.</span><span class="ident" id="3417010"><a href="/gostd/debug/pe/pe.go.html#3425731">Name</a></span><span class="op" id="3417014">[</span><span class="num" id="3417015">4</span><span class="op" id="3417016">:</span><span class="op" id="3417017">]</span><span class="op" id="3417018">)</span><span class="op" id="3417019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417025"><a href="/gostd/debug/pe/file.go.html#3416873">name</a></span><span class="op" id="3417029">,</span>&nbsp;<span class="ident" id="3417031">_</span>&nbsp;<span class="op" id="3417033">=</span>&nbsp;<span class="ident" id="3417035"><a href="/gostd/debug/pe/file.go.html#3419438">getString</a></span><span class="op" id="3417044">(</span><span class="ident" id="3417045"><a href="/gostd/debug/pe/file.go.html#3416010">ss</a></span><span class="op" id="3417047">,</span>&nbsp;<span class="ident" id="3417049"><a href="/gostd/debug/pe/file.go.html#3416970">si</a></span><span class="op" id="3417051">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417056">}</span>&nbsp;<span class="keyword" id="3417058">else</span>&nbsp;<span class="op" id="3417063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417069"><a href="/gostd/debug/pe/file.go.html#3416873">name</a></span>&nbsp;<span class="op" id="3417074">=</span>&nbsp;<span class="ident" id="3417076"><a href="/gostd/debug/pe/file.go.html#3419266">cstring</a></span><span class="op" id="3417083">(</span><span class="ident" id="3417084"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3417086">.</span><span class="ident" id="3417087"><a href="/gostd/debug/pe/pe.go.html#3425731">Name</a></span><span class="op" id="3417091">[</span><span class="op" id="3417092">:</span><span class="op" id="3417093">]</span><span class="op" id="3417094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417104"><a href="/gostd/debug/pe/file.go.html#3416629">aux</a></span>&nbsp;<span class="op" id="3417108">=</span>&nbsp;<span class="ident" id="3417110"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3417112">.</span><span class="ident" id="3417113"><a href="/gostd/debug/pe/pe.go.html#3425866">NumberOfAuxSymbols</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417135">s</span>&nbsp;<span class="op" id="3417137">:=</span>&nbsp;<span class="op" id="3417140">&amp;</span><span class="ident" id="3417141"><a href="/gostd/debug/pe/file.go.html#3413408">Symbol</a></span><span class="op" id="3417147">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417153"><a href="/gostd/debug/pe/file.go.html#3413425">Name</a></span><span class="op" id="3417157">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417168"><a href="/gostd/debug/pe/file.go.html#3416873">name</a></span><span class="op" id="3417172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417178"><a href="/gostd/debug/pe/file.go.html#3413447">Value</a></span><span class="op" id="3417183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417193"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3417195">.</span><span class="ident" id="3417196"><a href="/gostd/debug/pe/pe.go.html#3425760">Value</a></span><span class="op" id="3417201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417207"><a href="/gostd/debug/pe/file.go.html#3413469">SectionNumber</a></span><span class="op" id="3417220">:</span>&nbsp;<span class="ident" id="3417222"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3417224">.</span><span class="ident" id="3417225"><a href="/gostd/debug/pe/pe.go.html#3425787">SectionNumber</a></span><span class="op" id="3417238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417244"><a href="/gostd/debug/pe/file.go.html#3413490">Type</a></span><span class="op" id="3417248">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417259"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3417261">.</span><span class="ident" id="3417262"><a href="/gostd/debug/pe/pe.go.html#3425813">Type</a></span><span class="op" id="3417266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417272"><a href="/gostd/debug/pe/file.go.html#3413512">StorageClass</a></span><span class="op" id="3417284">:</span>&nbsp;&nbsp;<span class="ident" id="3417287"><a href="/gostd/debug/pe/file.go.html#3416707">cs</a></span><span class="op" id="3417289">.</span><span class="ident" id="3417290"><a href="/gostd/debug/pe/pe.go.html#3425840">StorageClass</a></span><span class="op" id="3417302">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417312"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3417313">.</span><span class="ident" id="3417314"><a href="/gostd/debug/pe/file.go.html#3412724">Symbols</a></span>&nbsp;<span class="op" id="3417322">=</span>&nbsp;<span class="builtinfunc" id="3417324">append</span><span class="op" id="3417330">(</span><span class="ident" id="3417331"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3417332">.</span><span class="ident" id="3417333"><a href="/gostd/debug/pe/file.go.html#3412724">Symbols</a></span><span class="op" id="3417340">,</span>&nbsp;<span class="ident" id="3417342"><a href="/gostd/debug/pe/file.go.html#3417135">s</a></span><span class="op" id="3417343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3417354">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417380"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3417382">.</span><span class="ident" id="3417383"><a href="/gostd/io/io.go.html#1433107">Seek</a></span><span class="op" id="3417387">(</span><span class="ident" id="3417388"><a href="/gostd/debug/pe/file.go.html#3415306">base</a></span><span class="op" id="3417392">,</span>&nbsp;<span class="ident" id="3417394"><a href="/gostd/debug/pe/file.go.html#3412530">os</a></span><span class="op" id="3417396">.</span><span class="ident" id="3417397"><a href="/gostd/os/file.go.html#2442631">SEEK_SET</a></span><span class="op" id="3417405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417408">if</span>&nbsp;<span class="ident" id="3417411">err</span>&nbsp;<span class="op" id="3417415">:=</span>&nbsp;<span class="ident" id="3417418"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3417424">.</span><span class="ident" id="3417425"><a href="/gostd/encoding/binary/binary.go.html#2989675">Read</a></span><span class="op" id="3417429">(</span><span class="ident" id="3417430"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3417432">,</span>&nbsp;<span class="ident" id="3417434"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3417440">.</span><span class="ident" id="3417441"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3417453">,</span>&nbsp;<span class="op" id="3417455">&amp;</span><span class="ident" id="3417456"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3417457">.</span><span class="ident" id="3417458"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3417468">)</span><span class="op" id="3417469">;</span>&nbsp;<span class="ident" id="3417471"><a href="/gostd/debug/pe/file.go.html#3417411">err</a></span>&nbsp;<span class="op" id="3417475">!=</span>&nbsp;<span class="builtintype" id="3417478">nil</span>&nbsp;<span class="op" id="3417482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417486">return</span>&nbsp;<span class="builtintype" id="3417493">nil</span><span class="op" id="3417496">,</span>&nbsp;<span class="ident" id="3417498"><a href="/gostd/debug/pe/file.go.html#3417411">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417503">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417506">var</span>&nbsp;<span class="ident" id="3417510">oh32</span>&nbsp;<span class="ident" id="3417515"><a href="/gostd/debug/pe/pe.go.html#3423076">OptionalHeader32</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417533">var</span>&nbsp;<span class="ident" id="3417537">oh64</span>&nbsp;<span class="ident" id="3417542"><a href="/gostd/debug/pe/pe.go.html#3424235">OptionalHeader64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417560">switch</span>&nbsp;<span class="ident" id="3417567"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3417568">.</span><span class="ident" id="3417569"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3417579">.</span><span class="ident" id="3417580"><a href="/gostd/debug/pe/pe.go.html#3422934">SizeOfOptionalHeader</a></span>&nbsp;<span class="op" id="3417601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417604">case</span>&nbsp;<span class="ident" id="3417609"><a href="/gostd/debug/pe/file.go.html#3414882">sizeofOptionalHeader32</a></span><span class="op" id="3417631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417635">if</span>&nbsp;<span class="ident" id="3417638">err</span>&nbsp;<span class="op" id="3417642">:=</span>&nbsp;<span class="ident" id="3417645"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3417651">.</span><span class="ident" id="3417652"><a href="/gostd/encoding/binary/binary.go.html#2989675">Read</a></span><span class="op" id="3417656">(</span><span class="ident" id="3417657"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3417659">,</span>&nbsp;<span class="ident" id="3417661"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3417667">.</span><span class="ident" id="3417668"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3417680">,</span>&nbsp;<span class="op" id="3417682">&amp;</span><span class="ident" id="3417683"><a href="/gostd/debug/pe/file.go.html#3417510">oh32</a></span><span class="op" id="3417687">)</span><span class="op" id="3417688">;</span>&nbsp;<span class="ident" id="3417690"><a href="/gostd/debug/pe/file.go.html#3417638">err</a></span>&nbsp;<span class="op" id="3417694">!=</span>&nbsp;<span class="builtintype" id="3417697">nil</span>&nbsp;<span class="op" id="3417701">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417706">return</span>&nbsp;<span class="builtintype" id="3417713">nil</span><span class="op" id="3417716">,</span>&nbsp;<span class="ident" id="3417718"><a href="/gostd/debug/pe/file.go.html#3417638">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417728">if</span>&nbsp;<span class="ident" id="3417731"><a href="/gostd/debug/pe/file.go.html#3417510">oh32</a></span><span class="op" id="3417735">.</span><span class="ident" id="3417736"><a href="/gostd/debug/pe/pe.go.html#3423103">Magic</a></span>&nbsp;<span class="op" id="3417742">!=</span>&nbsp;<span class="num" id="3417745">0x10b</span>&nbsp;<span class="op" id="3417751">{</span>&nbsp;<span class="comment" id="3417753">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417764">return</span>&nbsp;<span class="builtintype" id="3417771">nil</span><span class="op" id="3417774">,</span>&nbsp;<span class="ident" id="3417776"><a href="/gostd/debug/pe/file.go.html#3412517">fmt</a></span><span class="op" id="3417779">.</span><span class="ident" id="3417780"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="3417786">(</span><span class="string" id="3417787">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="3417838">,</span>&nbsp;<span class="ident" id="3417840"><a href="/gostd/debug/pe/file.go.html#3417510">oh32</a></span><span class="op" id="3417844">.</span><span class="ident" id="3417845"><a href="/gostd/debug/pe/pe.go.html#3423103">Magic</a></span><span class="op" id="3417850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3417854">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3417858"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3417859">.</span><span class="ident" id="3417860"><a href="/gostd/debug/pe/file.go.html#3412619">OptionalHeader</a></span>&nbsp;<span class="op" id="3417875">=</span>&nbsp;<span class="op" id="3417877">&amp;</span><span class="ident" id="3417878"><a href="/gostd/debug/pe/file.go.html#3417510">oh32</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417884">case</span>&nbsp;<span class="ident" id="3417889"><a href="/gostd/debug/pe/file.go.html#3414948">sizeofOptionalHeader64</a></span><span class="op" id="3417911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417915">if</span>&nbsp;<span class="ident" id="3417918">err</span>&nbsp;<span class="op" id="3417922">:=</span>&nbsp;<span class="ident" id="3417925"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3417931">.</span><span class="ident" id="3417932"><a href="/gostd/encoding/binary/binary.go.html#2989675">Read</a></span><span class="op" id="3417936">(</span><span class="ident" id="3417937"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3417939">,</span>&nbsp;<span class="ident" id="3417941"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3417947">.</span><span class="ident" id="3417948"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3417960">,</span>&nbsp;<span class="op" id="3417962">&amp;</span><span class="ident" id="3417963"><a href="/gostd/debug/pe/file.go.html#3417537">oh64</a></span><span class="op" id="3417967">)</span><span class="op" id="3417968">;</span>&nbsp;<span class="ident" id="3417970"><a href="/gostd/debug/pe/file.go.html#3417918">err</a></span>&nbsp;<span class="op" id="3417974">!=</span>&nbsp;<span class="builtintype" id="3417977">nil</span>&nbsp;<span class="op" id="3417981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3417986">return</span>&nbsp;<span class="builtintype" id="3417993">nil</span><span class="op" id="3417996">,</span>&nbsp;<span class="ident" id="3417998"><a href="/gostd/debug/pe/file.go.html#3417918">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3418004">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3418008">if</span>&nbsp;<span class="ident" id="3418011"><a href="/gostd/debug/pe/file.go.html#3417537">oh64</a></span><span class="op" id="3418015">.</span><span class="ident" id="3418016"><a href="/gostd/debug/pe/pe.go.html#3424262">Magic</a></span>&nbsp;<span class="op" id="3418022">!=</span>&nbsp;<span class="num" id="3418025">0x20b</span>&nbsp;<span class="op" id="3418031">{</span>&nbsp;<span class="comment" id="3418033">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3418045">return</span>&nbsp;<span class="builtintype" id="3418052">nil</span><span class="op" id="3418055">,</span>&nbsp;<span class="ident" id="3418057"><a href="/gostd/debug/pe/file.go.html#3412517">fmt</a></span><span class="op" id="3418060">.</span><span class="ident" id="3418061"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="3418067">(</span><span class="string" id="3418068">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="3418120">,</span>&nbsp;<span class="ident" id="3418122"><a href="/gostd/debug/pe/file.go.html#3417537">oh64</a></span><span class="op" id="3418126">.</span><span class="ident" id="3418127"><a href="/gostd/debug/pe/pe.go.html#3424262">Magic</a></span><span class="op" id="3418132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3418136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418140"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3418141">.</span><span class="ident" id="3418142"><a href="/gostd/debug/pe/file.go.html#3412619">OptionalHeader</a></span>&nbsp;<span class="op" id="3418157">=</span>&nbsp;<span class="op" id="3418159">&amp;</span><span class="ident" id="3418160"><a href="/gostd/debug/pe/file.go.html#3417537">oh64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3418166">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3418170">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418192"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3418193">.</span><span class="ident" id="3418194"><a href="/gostd/debug/pe/file.go.html#3412697">Sections</a></span>&nbsp;<span class="op" id="3418203">=</span>&nbsp;<span class="builtinfunc" id="3418205">make</span><span class="op" id="3418209">(</span><span class="op" id="3418210">[</span><span class="op" id="3418211">]</span><span class="op" id="3418212">*</span><span class="ident" id="3418213"><a href="/gostd/debug/pe/file.go.html#3413097">Section</a></span><span class="op" id="3418220">,</span>&nbsp;<span class="ident" id="3418222"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3418223">.</span><span class="ident" id="3418224"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3418234">.</span><span class="ident" id="3418235"><a href="/gostd/debug/pe/pe.go.html#3422818">NumberOfSections</a></span><span class="op" id="3418251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3418254">for</span>&nbsp;<span class="ident" id="3418258">i</span>&nbsp;<span class="op" id="3418260">:=</span>&nbsp;<span class="num" id="3418263">0</span><span class="op" id="3418264">;</span>&nbsp;<span class="ident" id="3418266"><a href="/gostd/debug/pe/file.go.html#3418258">i</a></span>&nbsp;<span class="op" id="3418268">&lt;</span>&nbsp;<span class="builtintype" id="3418270">int</span><span class="op" id="3418273">(</span><span class="ident" id="3418274"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3418275">.</span><span class="ident" id="3418276"><a href="/gostd/debug/pe/file.go.html#3412607">FileHeader</a></span><span class="op" id="3418286">.</span><span class="ident" id="3418287"><a href="/gostd/debug/pe/pe.go.html#3422818">NumberOfSections</a></span><span class="op" id="3418303">)</span><span class="op" id="3418304">;</span>&nbsp;<span class="ident" id="3418306"><a href="/gostd/debug/pe/file.go.html#3418258">i</a></span><span class="op" id="3418307">++</span>&nbsp;<span class="op" id="3418310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418314">sh</span>&nbsp;<span class="op" id="3418317">:=</span>&nbsp;<span class="builtinfunc" id="3418320">new</span><span class="op" id="3418323">(</span><span class="ident" id="3418324"><a href="/gostd/debug/pe/pe.go.html#3425358">SectionHeader32</a></span><span class="op" id="3418339">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3418343">if</span>&nbsp;<span class="ident" id="3418346">err</span>&nbsp;<span class="op" id="3418350">:=</span>&nbsp;<span class="ident" id="3418353"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3418359">.</span><span class="ident" id="3418360"><a href="/gostd/encoding/binary/binary.go.html#2989675">Read</a></span><span class="op" id="3418364">(</span><span class="ident" id="3418365"><a href="/gostd/debug/pe/file.go.html#3415159">sr</a></span><span class="op" id="3418367">,</span>&nbsp;<span class="ident" id="3418369"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3418375">.</span><span class="ident" id="3418376"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3418388">,</span>&nbsp;<span class="ident" id="3418390"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418392">)</span><span class="op" id="3418393">;</span>&nbsp;<span class="ident" id="3418395"><a href="/gostd/debug/pe/file.go.html#3418346">err</a></span>&nbsp;<span class="op" id="3418399">!=</span>&nbsp;<span class="builtintype" id="3418402">nil</span>&nbsp;<span class="op" id="3418406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3418411">return</span>&nbsp;<span class="builtintype" id="3418418">nil</span><span class="op" id="3418421">,</span>&nbsp;<span class="ident" id="3418423"><a href="/gostd/debug/pe/file.go.html#3418346">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3418429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3418433">var</span>&nbsp;<span class="ident" id="3418437">name</span>&nbsp;<span class="builtintype" id="3418442">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3418451">if</span>&nbsp;<span class="ident" id="3418454"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418456">.</span><span class="ident" id="3418457"><a href="/gostd/debug/pe/pe.go.html#3425384">Name</a></span><span class="op" id="3418461">[</span><span class="num" id="3418462">0</span><span class="op" id="3418463">]</span>&nbsp;<span class="op" id="3418465">==</span>&nbsp;<span class="string" id="3418468">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="3418475">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418480">si</span><span class="op" id="3418482">,</span>&nbsp;<span class="ident" id="3418484">_</span>&nbsp;<span class="op" id="3418486">:=</span>&nbsp;<span class="ident" id="3418489"><a href="/gostd/debug/pe/file.go.html#3412536">strconv</a></span><span class="op" id="3418496">.</span><span class="ident" id="3418497"><a href="/gostd/strconv/atoi.go.html#2357032">Atoi</a></span><span class="op" id="3418501">(</span><span class="ident" id="3418502"><a href="/gostd/debug/pe/file.go.html#3419266">cstring</a></span><span class="op" id="3418509">(</span><span class="ident" id="3418510"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418512">.</span><span class="ident" id="3418513"><a href="/gostd/debug/pe/pe.go.html#3425384">Name</a></span><span class="op" id="3418517">[</span><span class="num" id="3418518">1</span><span class="op" id="3418519">:</span><span class="op" id="3418520">]</span><span class="op" id="3418521">)</span><span class="op" id="3418522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418527"><a href="/gostd/debug/pe/file.go.html#3418437">name</a></span><span class="op" id="3418531">,</span>&nbsp;<span class="ident" id="3418533">_</span>&nbsp;<span class="op" id="3418535">=</span>&nbsp;<span class="ident" id="3418537"><a href="/gostd/debug/pe/file.go.html#3419438">getString</a></span><span class="op" id="3418546">(</span><span class="ident" id="3418547"><a href="/gostd/debug/pe/file.go.html#3416010">ss</a></span><span class="op" id="3418549">,</span>&nbsp;<span class="ident" id="3418551"><a href="/gostd/debug/pe/file.go.html#3418480">si</a></span><span class="op" id="3418553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3418557">}</span>&nbsp;<span class="keyword" id="3418559">else</span>&nbsp;<span class="op" id="3418564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418569"><a href="/gostd/debug/pe/file.go.html#3418437">name</a></span>&nbsp;<span class="op" id="3418574">=</span>&nbsp;<span class="ident" id="3418576"><a href="/gostd/debug/pe/file.go.html#3419266">cstring</a></span><span class="op" id="3418583">(</span><span class="ident" id="3418584"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418586">.</span><span class="ident" id="3418587"><a href="/gostd/debug/pe/pe.go.html#3425384">Name</a></span><span class="op" id="3418591">[</span><span class="num" id="3418592">0</span><span class="op" id="3418593">:</span><span class="op" id="3418594">]</span><span class="op" id="3418595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3418599">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418603">s</span>&nbsp;<span class="op" id="3418605">:=</span>&nbsp;<span class="builtinfunc" id="3418608">new</span><span class="op" id="3418611">(</span><span class="ident" id="3418612"><a href="/gostd/debug/pe/file.go.html#3413097">Section</a></span><span class="op" id="3418619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418623"><a href="/gostd/debug/pe/file.go.html#3418603">s</a></span><span class="op" id="3418624">.</span><span class="ident" id="3418625"><a href="/gostd/debug/pe/file.go.html#3413115">SectionHeader</a></span>&nbsp;<span class="op" id="3418639">=</span>&nbsp;<span class="ident" id="3418641"><a href="/gostd/debug/pe/file.go.html#3412776">SectionHeader</a></span><span class="op" id="3418654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418659"><a href="/gostd/debug/pe/file.go.html#3412800">Name</a></span><span class="op" id="3418663">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418681"><a href="/gostd/debug/pe/file.go.html#3418437">name</a></span><span class="op" id="3418685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418690"><a href="/gostd/debug/pe/file.go.html#3412829">VirtualSize</a></span><span class="op" id="3418701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418712"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418714">.</span><span class="ident" id="3418715"><a href="/gostd/debug/pe/pe.go.html#3425415">VirtualSize</a></span><span class="op" id="3418726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418731"><a href="/gostd/debug/pe/file.go.html#3412858">VirtualAddress</a></span><span class="op" id="3418745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418753"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418755">.</span><span class="ident" id="3418756"><a href="/gostd/debug/pe/pe.go.html#3425444">VirtualAddress</a></span><span class="op" id="3418770">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418775"><a href="/gostd/debug/pe/file.go.html#3412887">Size</a></span><span class="op" id="3418779">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418797"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418799">.</span><span class="ident" id="3418800"><a href="/gostd/debug/pe/pe.go.html#3425473">SizeOfRawData</a></span><span class="op" id="3418813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418818"><a href="/gostd/debug/pe/file.go.html#3412916">Offset</a></span><span class="op" id="3418824">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418840"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418842">.</span><span class="ident" id="3418843"><a href="/gostd/debug/pe/pe.go.html#3425502">PointerToRawData</a></span><span class="op" id="3418859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418864"><a href="/gostd/debug/pe/file.go.html#3412945">PointerToRelocations</a></span><span class="op" id="3418884">:</span>&nbsp;<span class="ident" id="3418886"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418888">.</span><span class="ident" id="3418889"><a href="/gostd/debug/pe/pe.go.html#3425531">PointerToRelocations</a></span><span class="op" id="3418909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418914"><a href="/gostd/debug/pe/file.go.html#3412974">PointerToLineNumbers</a></span><span class="op" id="3418934">:</span>&nbsp;<span class="ident" id="3418936"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418938">.</span><span class="ident" id="3418939"><a href="/gostd/debug/pe/pe.go.html#3425560">PointerToLineNumbers</a></span><span class="op" id="3418959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3418964"><a href="/gostd/debug/pe/file.go.html#3413003">NumberOfRelocations</a></span><span class="op" id="3418983">:</span>&nbsp;&nbsp;<span class="ident" id="3418986"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3418988">.</span><span class="ident" id="3418989"><a href="/gostd/debug/pe/pe.go.html#3425589">NumberOfRelocations</a></span><span class="op" id="3419008">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3419013"><a href="/gostd/debug/pe/file.go.html#3413032">NumberOfLineNumbers</a></span><span class="op" id="3419032">:</span>&nbsp;&nbsp;<span class="ident" id="3419035"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3419037">.</span><span class="ident" id="3419038"><a href="/gostd/debug/pe/pe.go.html#3425618">NumberOfLineNumbers</a></span><span class="op" id="3419057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3419062"><a href="/gostd/debug/pe/file.go.html#3413061">Characteristics</a></span><span class="op" id="3419077">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3419084"><a href="/gostd/debug/pe/file.go.html#3418314">sh</a></span><span class="op" id="3419086">.</span><span class="ident" id="3419087"><a href="/gostd/debug/pe/pe.go.html#3425647">Characteristics</a></span><span class="op" id="3419102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3419110"><a href="/gostd/debug/pe/file.go.html#3418603">s</a></span><span class="op" id="3419111">.</span><span class="ident" id="3419112"><a href="/gostd/debug/pe/file.go.html#3413379">sr</a></span>&nbsp;<span class="op" id="3419115">=</span>&nbsp;<span class="ident" id="3419117"><a href="/gostd/debug/pe/file.go.html#3412524">io</a></span><span class="op" id="3419119">.</span><span class="ident" id="3419120"><a href="/gostd/io/io.go.html#1432455">NewSectionReader</a></span><span class="op" id="3419136">(</span><span class="ident" id="3419137"><a href="/gostd/debug/pe/file.go.html#3415110">r</a></span><span class="op" id="3419138">,</span>&nbsp;<span class="builtintype" id="3419140">int64</span><span class="op" id="3419145">(</span><span class="ident" id="3419146"><a href="/gostd/debug/pe/file.go.html#3418603">s</a></span><span class="op" id="3419147">.</span><span class="ident" id="3419148"><a href="/gostd/debug/pe/file.go.html#3413115">SectionHeader</a></span><span class="op" id="3419161">.</span><span class="ident" id="3419162"><a href="/gostd/debug/pe/file.go.html#3412916">Offset</a></span><span class="op" id="3419168">)</span><span class="op" id="3419169">,</span>&nbsp;<span class="builtintype" id="3419171">int64</span><span class="op" id="3419176">(</span><span class="ident" id="3419177"><a href="/gostd/debug/pe/file.go.html#3418603">s</a></span><span class="op" id="3419178">.</span><span class="ident" id="3419179"><a href="/gostd/debug/pe/file.go.html#3413115">SectionHeader</a></span><span class="op" id="3419192">.</span><span class="ident" id="3419193"><a href="/gostd/debug/pe/file.go.html#3412887">Size</a></span><span class="op" id="3419197">)</span><span class="op" id="3419198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3419202"><a href="/gostd/debug/pe/file.go.html#3418603">s</a></span><span class="op" id="3419203">.</span><span class="ident" id="3419204"><a href="/gostd/debug/pe/file.go.html#3413366">ReaderAt</a></span>&nbsp;<span class="op" id="3419213">=</span>&nbsp;<span class="ident" id="3419215"><a href="/gostd/debug/pe/file.go.html#3418603">s</a></span><span class="op" id="3419216">.</span><span class="ident" id="3419217"><a href="/gostd/debug/pe/file.go.html#3413379">sr</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3419222"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3419223">.</span><span class="ident" id="3419224"><a href="/gostd/debug/pe/file.go.html#3412697">Sections</a></span><span class="op" id="3419232">[</span><span class="ident" id="3419233"><a href="/gostd/debug/pe/file.go.html#3418258">i</a></span><span class="op" id="3419234">]</span>&nbsp;<span class="op" id="3419236">=</span>&nbsp;<span class="ident" id="3419238"><a href="/gostd/debug/pe/file.go.html#3418603">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419244">return</span>&nbsp;<span class="ident" id="3419251"><a href="/gostd/debug/pe/file.go.html#3415143">f</a></span><span class="op" id="3419252">,</span>&nbsp;<span class="builtintype" id="3419254">nil</span><br>
<span class="lineno"></span><span class="op" id="3419258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3419261">func</span>&nbsp;<span class="ident" id="3419266">cstring</span><span class="op" id="3419273">(</span><span class="ident" id="3419274">b</span>&nbsp;<span class="op" id="3419276">[</span><span class="op" id="3419277">]</span><span class="builtintype" id="3419278">byte</span><span class="op" id="3419282">)</span>&nbsp;<span class="builtintype" id="3419284">string</span>&nbsp;<span class="op" id="3419291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419294">var</span>&nbsp;<span class="ident" id="3419298">i</span>&nbsp;<span class="builtintype" id="3419300">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419305">for</span>&nbsp;<span class="ident" id="3419309"><a href="/gostd/debug/pe/file.go.html#3419298">i</a></span>&nbsp;<span class="op" id="3419311">=</span>&nbsp;<span class="num" id="3419313">0</span><span class="op" id="3419314">;</span>&nbsp;<span class="ident" id="3419316"><a href="/gostd/debug/pe/file.go.html#3419298">i</a></span>&nbsp;<span class="op" id="3419318">&lt;</span>&nbsp;<span class="builtinfunc" id="3419320">len</span><span class="op" id="3419323">(</span><span class="ident" id="3419324"><a href="/gostd/debug/pe/file.go.html#3419274">b</a></span><span class="op" id="3419325">)</span>&nbsp;<span class="op" id="3419327">&amp;&amp;</span>&nbsp;<span class="ident" id="3419330"><a href="/gostd/debug/pe/file.go.html#3419274">b</a></span><span class="op" id="3419331">[</span><span class="ident" id="3419332"><a href="/gostd/debug/pe/file.go.html#3419298">i</a></span><span class="op" id="3419333">]</span>&nbsp;<span class="op" id="3419335">!=</span>&nbsp;<span class="num" id="3419338">0</span><span class="op" id="3419339">;</span>&nbsp;<span class="ident" id="3419341"><a href="/gostd/debug/pe/file.go.html#3419298">i</a></span><span class="op" id="3419342">++</span>&nbsp;<span class="op" id="3419345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419351">return</span>&nbsp;<span class="builtintype" id="3419358">string</span><span class="op" id="3419364">(</span><span class="ident" id="3419365"><a href="/gostd/debug/pe/file.go.html#3419274">b</a></span><span class="op" id="3419366">[</span><span class="num" id="3419367">0</span><span class="op" id="3419368">:</span><span class="ident" id="3419369"><a href="/gostd/debug/pe/file.go.html#3419298">i</a></span><span class="op" id="3419370">]</span><span class="op" id="3419371">)</span><br>
<span class="lineno">270</span><span class="op" id="3419373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3419376">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="3419433">func</span>&nbsp;<span class="ident" id="3419438">getString</span><span class="op" id="3419447">(</span><span class="ident" id="3419448">section</span>&nbsp;<span class="op" id="3419456">[</span><span class="op" id="3419457">]</span><span class="builtintype" id="3419458">byte</span><span class="op" id="3419462">,</span>&nbsp;<span class="ident" id="3419464">start</span>&nbsp;<span class="builtintype" id="3419470">int</span><span class="op" id="3419473">)</span>&nbsp;<span class="op" id="3419475">(</span><span class="builtintype" id="3419476">string</span><span class="op" id="3419482">,</span>&nbsp;<span class="builtintype" id="3419484">bool</span><span class="op" id="3419488">)</span>&nbsp;<span class="op" id="3419490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419493">if</span>&nbsp;<span class="ident" id="3419496"><a href="/gostd/debug/pe/file.go.html#3419464">start</a></span>&nbsp;<span class="op" id="3419502">&lt;</span>&nbsp;<span class="num" id="3419504">0</span>&nbsp;<span class="op" id="3419506">||</span>&nbsp;<span class="ident" id="3419509"><a href="/gostd/debug/pe/file.go.html#3419464">start</a></span>&nbsp;<span class="op" id="3419515">&gt;=</span>&nbsp;<span class="builtinfunc" id="3419518">len</span><span class="op" id="3419521">(</span><span class="ident" id="3419522"><a href="/gostd/debug/pe/file.go.html#3419448">section</a></span><span class="op" id="3419529">)</span>&nbsp;<span class="op" id="3419531">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419535">return</span>&nbsp;<span class="string" id="3419542">&#34;&#34;</span><span class="op" id="3419544">,</span>&nbsp;<span class="builtintype" id="3419546">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419557">for</span>&nbsp;<span class="ident" id="3419561">end</span>&nbsp;<span class="op" id="3419565">:=</span>&nbsp;<span class="ident" id="3419568"><a href="/gostd/debug/pe/file.go.html#3419464">start</a></span><span class="op" id="3419573">;</span>&nbsp;<span class="ident" id="3419575"><a href="/gostd/debug/pe/file.go.html#3419561">end</a></span>&nbsp;<span class="op" id="3419579">&lt;</span>&nbsp;<span class="builtinfunc" id="3419581">len</span><span class="op" id="3419584">(</span><span class="ident" id="3419585"><a href="/gostd/debug/pe/file.go.html#3419448">section</a></span><span class="op" id="3419592">)</span><span class="op" id="3419593">;</span>&nbsp;<span class="ident" id="3419595"><a href="/gostd/debug/pe/file.go.html#3419561">end</a></span><span class="op" id="3419598">++</span>&nbsp;<span class="op" id="3419601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419605">if</span>&nbsp;<span class="ident" id="3419608"><a href="/gostd/debug/pe/file.go.html#3419448">section</a></span><span class="op" id="3419615">[</span><span class="ident" id="3419616"><a href="/gostd/debug/pe/file.go.html#3419561">end</a></span><span class="op" id="3419619">]</span>&nbsp;<span class="op" id="3419621">==</span>&nbsp;<span class="num" id="3419624">0</span>&nbsp;<span class="op" id="3419626">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419631">return</span>&nbsp;<span class="builtintype" id="3419638">string</span><span class="op" id="3419644">(</span><span class="ident" id="3419645"><a href="/gostd/debug/pe/file.go.html#3419448">section</a></span><span class="op" id="3419652">[</span><span class="ident" id="3419653"><a href="/gostd/debug/pe/file.go.html#3419464">start</a></span><span class="op" id="3419658">:</span><span class="ident" id="3419659"><a href="/gostd/debug/pe/file.go.html#3419561">end</a></span><span class="op" id="3419662">]</span><span class="op" id="3419663">)</span><span class="op" id="3419664">,</span>&nbsp;<span class="builtintype" id="3419666">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419679">return</span>&nbsp;<span class="string" id="3419686">&#34;&#34;</span><span class="op" id="3419688">,</span>&nbsp;<span class="builtintype" id="3419690">false</span><br>
<span class="lineno"></span><span class="op" id="3419696">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="3419699">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="3419775">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="3419794">func</span>&nbsp;<span class="op" id="3419799">(</span><span class="ident" id="3419800">f</span>&nbsp;<span class="op" id="3419802">*</span><span class="ident" id="3419803"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3419807">)</span>&nbsp;<span class="ident" id="3419809">Section</span><span class="op" id="3419816">(</span><span class="ident" id="3419817">name</span>&nbsp;<span class="builtintype" id="3419822">string</span><span class="op" id="3419828">)</span>&nbsp;<span class="op" id="3419830">*</span><span class="ident" id="3419831"><a href="/gostd/debug/pe/file.go.html#3413097">Section</a></span>&nbsp;<span class="op" id="3419839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419842">for</span>&nbsp;<span class="ident" id="3419846">_</span><span class="op" id="3419847">,</span>&nbsp;<span class="ident" id="3419849">s</span>&nbsp;<span class="op" id="3419851">:=</span>&nbsp;<span class="keyword" id="3419854">range</span>&nbsp;<span class="ident" id="3419860"><a href="/gostd/debug/pe/file.go.html#3419800">f</a></span><span class="op" id="3419861">.</span><span class="ident" id="3419862"><a href="/gostd/debug/pe/file.go.html#3412697">Sections</a></span>&nbsp;<span class="op" id="3419871">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419875">if</span>&nbsp;<span class="ident" id="3419878"><a href="/gostd/debug/pe/file.go.html#3419849">s</a></span><span class="op" id="3419879">.</span><span class="ident" id="3419880"><a href="/gostd/debug/pe/file.go.html#3412800">Name</a></span>&nbsp;<span class="op" id="3419885">==</span>&nbsp;<span class="ident" id="3419888"><a href="/gostd/debug/pe/file.go.html#3419817">name</a></span>&nbsp;<span class="op" id="3419893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419898">return</span>&nbsp;<span class="ident" id="3419905"><a href="/gostd/debug/pe/file.go.html#3419849">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3419912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3419915">return</span>&nbsp;<span class="builtintype" id="3419922">nil</span><br>
<span class="lineno">295</span><span class="op" id="3419926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3419929">func</span>&nbsp;<span class="op" id="3419934">(</span><span class="ident" id="3419935">f</span>&nbsp;<span class="op" id="3419937">*</span><span class="ident" id="3419938"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3419942">)</span>&nbsp;<span class="ident" id="3419944">DWARF</span><span class="op" id="3419949">(</span><span class="op" id="3419950">)</span>&nbsp;<span class="op" id="3419952">(</span><span class="op" id="3419953">*</span><span class="ident" id="3419954"><a href="/gostd/debug/pe/file.go.html#3412473">dwarf</a></span><span class="op" id="3419959">.</span><span class="ident" id="3419960"><a href="/gostd/debug/dwarf/open.go.html#3454534">Data</a></span><span class="op" id="3419964">,</span>&nbsp;<span class="builtintype" id="3419966">error</span><span class="op" id="3419971">)</span>&nbsp;<span class="op" id="3419973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3419976">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3420027">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3420082">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420141">var</span>&nbsp;<span class="ident" id="3420145">names</span>&nbsp;<span class="op" id="3420151">=</span>&nbsp;<span class="op" id="3420153">[</span><span class="op" id="3420154">...</span><span class="op" id="3420157">]</span><span class="builtintype" id="3420158">string</span><span class="op" id="3420164">{</span><span class="string" id="3420165">&#34;abbrev&#34;</span><span class="op" id="3420173">,</span>&nbsp;<span class="string" id="3420175">&#34;info&#34;</span><span class="op" id="3420181">,</span>&nbsp;<span class="string" id="3420183">&#34;str&#34;</span><span class="op" id="3420188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420191">var</span>&nbsp;<span class="ident" id="3420195">dat</span>&nbsp;<span class="op" id="3420199">[</span><span class="builtinfunc" id="3420200">len</span><span class="op" id="3420203">(</span><span class="ident" id="3420204"><a href="/gostd/debug/pe/file.go.html#3420145">names</a></span><span class="op" id="3420209">)</span><span class="op" id="3420210">]</span><span class="op" id="3420211">[</span><span class="op" id="3420212">]</span><span class="builtintype" id="3420213">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420219">for</span>&nbsp;<span class="ident" id="3420223">i</span><span class="op" id="3420224">,</span>&nbsp;<span class="ident" id="3420226">name</span>&nbsp;<span class="op" id="3420231">:=</span>&nbsp;<span class="keyword" id="3420234">range</span>&nbsp;<span class="ident" id="3420240"><a href="/gostd/debug/pe/file.go.html#3420145">names</a></span>&nbsp;<span class="op" id="3420246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420250"><a href="/gostd/debug/pe/file.go.html#3420226">name</a></span>&nbsp;<span class="op" id="3420255">=</span>&nbsp;<span class="string" id="3420257">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="3420267">+</span>&nbsp;<span class="ident" id="3420269"><a href="/gostd/debug/pe/file.go.html#3420226">name</a></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420276">s</span>&nbsp;<span class="op" id="3420278">:=</span>&nbsp;<span class="ident" id="3420281"><a href="/gostd/debug/pe/file.go.html#3419935">f</a></span><span class="op" id="3420282">.</span><span class="ident" id="3420283"><a href="/gostd/debug/pe/file.go.html#3419809">Section</a></span><span class="op" id="3420290">(</span><span class="ident" id="3420291"><a href="/gostd/debug/pe/file.go.html#3420226">name</a></span><span class="op" id="3420295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420299">if</span>&nbsp;<span class="ident" id="3420302"><a href="/gostd/debug/pe/file.go.html#3420276">s</a></span>&nbsp;<span class="op" id="3420304">==</span>&nbsp;<span class="builtintype" id="3420307">nil</span>&nbsp;<span class="op" id="3420311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420316">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3420327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420331">b</span><span class="op" id="3420332">,</span>&nbsp;<span class="ident" id="3420334">err</span>&nbsp;<span class="op" id="3420338">:=</span>&nbsp;<span class="ident" id="3420341"><a href="/gostd/debug/pe/file.go.html#3420276">s</a></span><span class="op" id="3420342">.</span><span class="ident" id="3420343"><a href="/gostd/debug/pe/file.go.html#3413792">Data</a></span><span class="op" id="3420347">(</span><span class="op" id="3420348">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420352">if</span>&nbsp;<span class="ident" id="3420355"><a href="/gostd/debug/pe/file.go.html#3420334">err</a></span>&nbsp;<span class="op" id="3420359">!=</span>&nbsp;<span class="builtintype" id="3420362">nil</span>&nbsp;<span class="op" id="3420366">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3420369">uint32</span><span class="op" id="3420375">(</span><span class="builtinfunc" id="3420376">len</span><span class="op" id="3420379">(</span><span class="ident" id="3420380"><a href="/gostd/debug/pe/file.go.html#3420331">b</a></span><span class="op" id="3420381">)</span><span class="op" id="3420382">)</span>&nbsp;<span class="op" id="3420384">&lt;</span>&nbsp;<span class="ident" id="3420386"><a href="/gostd/debug/pe/file.go.html#3420276">s</a></span><span class="op" id="3420387">.</span><span class="ident" id="3420388"><a href="/gostd/debug/pe/file.go.html#3412887">Size</a></span>&nbsp;<span class="op" id="3420393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420398">return</span>&nbsp;<span class="builtintype" id="3420405">nil</span><span class="op" id="3420408">,</span>&nbsp;<span class="ident" id="3420410"><a href="/gostd/debug/pe/file.go.html#3420334">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3420416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420420"><a href="/gostd/debug/pe/file.go.html#3420195">dat</a></span><span class="op" id="3420423">[</span><span class="ident" id="3420424"><a href="/gostd/debug/pe/file.go.html#3420223">i</a></span><span class="op" id="3420425">]</span>&nbsp;<span class="op" id="3420427">=</span>&nbsp;<span class="ident" id="3420429"><a href="/gostd/debug/pe/file.go.html#3420331">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3420432">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420436">abbrev</span><span class="op" id="3420442">,</span>&nbsp;<span class="ident" id="3420444">info</span><span class="op" id="3420448">,</span>&nbsp;<span class="ident" id="3420450">str</span>&nbsp;<span class="op" id="3420454">:=</span>&nbsp;<span class="ident" id="3420457"><a href="/gostd/debug/pe/file.go.html#3420195">dat</a></span><span class="op" id="3420460">[</span><span class="num" id="3420461">0</span><span class="op" id="3420462">]</span><span class="op" id="3420463">,</span>&nbsp;<span class="ident" id="3420465"><a href="/gostd/debug/pe/file.go.html#3420195">dat</a></span><span class="op" id="3420468">[</span><span class="num" id="3420469">1</span><span class="op" id="3420470">]</span><span class="op" id="3420471">,</span>&nbsp;<span class="ident" id="3420473"><a href="/gostd/debug/pe/file.go.html#3420195">dat</a></span><span class="op" id="3420476">[</span><span class="num" id="3420477">2</span><span class="op" id="3420478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420481">return</span>&nbsp;<span class="ident" id="3420488"><a href="/gostd/debug/pe/file.go.html#3412473">dwarf</a></span><span class="op" id="3420493">.</span><span class="ident" id="3420494"><a href="/gostd/debug/dwarf/open.go.html#3455313">New</a></span><span class="op" id="3420497">(</span><span class="ident" id="3420498"><a href="/gostd/debug/pe/file.go.html#3420436">abbrev</a></span><span class="op" id="3420504">,</span>&nbsp;<span class="builtintype" id="3420506">nil</span><span class="op" id="3420509">,</span>&nbsp;<span class="builtintype" id="3420511">nil</span><span class="op" id="3420514">,</span>&nbsp;<span class="ident" id="3420516"><a href="/gostd/debug/pe/file.go.html#3420444">info</a></span><span class="op" id="3420520">,</span>&nbsp;<span class="builtintype" id="3420522">nil</span><span class="op" id="3420525">,</span>&nbsp;<span class="builtintype" id="3420527">nil</span><span class="op" id="3420530">,</span>&nbsp;<span class="builtintype" id="3420532">nil</span><span class="op" id="3420535">,</span>&nbsp;<span class="ident" id="3420537"><a href="/gostd/debug/pe/file.go.html#3420450">str</a></span><span class="op" id="3420540">)</span><br>
<span class="lineno"></span><span class="op" id="3420542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="3420545">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="3420597">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3420652">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="3420706">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="3420742">func</span>&nbsp;<span class="op" id="3420747">(</span><span class="ident" id="3420748">f</span>&nbsp;<span class="op" id="3420750">*</span><span class="ident" id="3420751"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3420755">)</span>&nbsp;<span class="ident" id="3420757">ImportedSymbols</span><span class="op" id="3420772">(</span><span class="op" id="3420773">)</span>&nbsp;<span class="op" id="3420775">(</span><span class="op" id="3420776">[</span><span class="op" id="3420777">]</span><span class="builtintype" id="3420778">string</span><span class="op" id="3420784">,</span>&nbsp;<span class="builtintype" id="3420786">error</span><span class="op" id="3420791">)</span>&nbsp;<span class="op" id="3420793">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420796">pe64</span>&nbsp;<span class="op" id="3420801">:=</span>&nbsp;<span class="ident" id="3420804"><a href="/gostd/debug/pe/file.go.html#3420748">f</a></span><span class="op" id="3420805">.</span><span class="ident" id="3420806"><a href="/gostd/debug/pe/pe.go.html#3422789">Machine</a></span>&nbsp;<span class="op" id="3420814">==</span>&nbsp;<span class="ident" id="3420817"><a href="/gostd/debug/pe/pe.go.html#3425977">IMAGE_FILE_MACHINE_AMD64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420843">ds</span>&nbsp;<span class="op" id="3420846">:=</span>&nbsp;<span class="ident" id="3420849"><a href="/gostd/debug/pe/file.go.html#3420748">f</a></span><span class="op" id="3420850">.</span><span class="ident" id="3420851"><a href="/gostd/debug/pe/file.go.html#3419809">Section</a></span><span class="op" id="3420858">(</span><span class="string" id="3420859">&#34;.idata&#34;</span><span class="op" id="3420867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420870">if</span>&nbsp;<span class="ident" id="3420873"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span>&nbsp;<span class="op" id="3420876">==</span>&nbsp;<span class="builtintype" id="3420879">nil</span>&nbsp;<span class="op" id="3420883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3420887">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420921">return</span>&nbsp;<span class="builtintype" id="3420928">nil</span><span class="op" id="3420931">,</span>&nbsp;<span class="builtintype" id="3420933">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3420938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3420941">d</span><span class="op" id="3420942">,</span>&nbsp;<span class="ident" id="3420944">err</span>&nbsp;<span class="op" id="3420948">:=</span>&nbsp;<span class="ident" id="3420951"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span><span class="op" id="3420953">.</span><span class="ident" id="3420954"><a href="/gostd/debug/pe/file.go.html#3413792">Data</a></span><span class="op" id="3420958">(</span><span class="op" id="3420959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420962">if</span>&nbsp;<span class="ident" id="3420965"><a href="/gostd/debug/pe/file.go.html#3420944">err</a></span>&nbsp;<span class="op" id="3420969">!=</span>&nbsp;<span class="builtintype" id="3420972">nil</span>&nbsp;<span class="op" id="3420976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3420980">return</span>&nbsp;<span class="builtintype" id="3420987">nil</span><span class="op" id="3420990">,</span>&nbsp;<span class="ident" id="3420992"><a href="/gostd/debug/pe/file.go.html#3420944">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3420997">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421000">var</span>&nbsp;<span class="ident" id="3421004">ida</span>&nbsp;<span class="op" id="3421008">[</span><span class="op" id="3421009">]</span><span class="ident" id="3421010"><a href="/gostd/debug/pe/file.go.html#3413540">ImportDirectory</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421027">for</span>&nbsp;<span class="builtinfunc" id="3421031">len</span><span class="op" id="3421034">(</span><span class="ident" id="3421035"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421036">)</span>&nbsp;<span class="op" id="3421038">&gt;</span>&nbsp;<span class="num" id="3421040">0</span>&nbsp;<span class="op" id="3421042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421046">var</span>&nbsp;<span class="ident" id="3421050">dt</span>&nbsp;<span class="ident" id="3421053"><a href="/gostd/debug/pe/file.go.html#3413540">ImportDirectory</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421071"><a href="/gostd/debug/pe/file.go.html#3421050">dt</a></span><span class="op" id="3421073">.</span><span class="ident" id="3421074"><a href="/gostd/debug/pe/file.go.html#3413566">OriginalFirstThunk</a></span>&nbsp;<span class="op" id="3421093">=</span>&nbsp;<span class="ident" id="3421095"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3421101">.</span><span class="ident" id="3421102"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3421114">.</span><span class="ident" id="3421115"><a href="/gostd/encoding/binary/binary.go.html#2987394">Uint32</a></span><span class="op" id="3421121">(</span><span class="ident" id="3421122"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421123">[</span><span class="num" id="3421124">0</span><span class="op" id="3421125">:</span><span class="num" id="3421126">4</span><span class="op" id="3421127">]</span><span class="op" id="3421128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421132"><a href="/gostd/debug/pe/file.go.html#3421050">dt</a></span><span class="op" id="3421134">.</span><span class="ident" id="3421135"><a href="/gostd/debug/pe/file.go.html#3413647">Name</a></span>&nbsp;<span class="op" id="3421140">=</span>&nbsp;<span class="ident" id="3421142"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3421148">.</span><span class="ident" id="3421149"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3421161">.</span><span class="ident" id="3421162"><a href="/gostd/encoding/binary/binary.go.html#2987394">Uint32</a></span><span class="op" id="3421168">(</span><span class="ident" id="3421169"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421170">[</span><span class="num" id="3421171">12</span><span class="op" id="3421173">:</span><span class="num" id="3421174">16</span><span class="op" id="3421176">]</span><span class="op" id="3421177">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421181"><a href="/gostd/debug/pe/file.go.html#3421050">dt</a></span><span class="op" id="3421183">.</span><span class="ident" id="3421184"><a href="/gostd/debug/pe/file.go.html#3413674">FirstThunk</a></span>&nbsp;<span class="op" id="3421195">=</span>&nbsp;<span class="ident" id="3421197"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3421203">.</span><span class="ident" id="3421204"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3421216">.</span><span class="ident" id="3421217"><a href="/gostd/encoding/binary/binary.go.html#2987394">Uint32</a></span><span class="op" id="3421223">(</span><span class="ident" id="3421224"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421225">[</span><span class="num" id="3421226">16</span><span class="op" id="3421228">:</span><span class="num" id="3421229">20</span><span class="op" id="3421231">]</span><span class="op" id="3421232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421236"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span>&nbsp;<span class="op" id="3421238">=</span>&nbsp;<span class="ident" id="3421240"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421241">[</span><span class="num" id="3421242">20</span><span class="op" id="3421244">:</span><span class="op" id="3421245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421249">if</span>&nbsp;<span class="ident" id="3421252"><a href="/gostd/debug/pe/file.go.html#3421050">dt</a></span><span class="op" id="3421254">.</span><span class="ident" id="3421255"><a href="/gostd/debug/pe/file.go.html#3413566">OriginalFirstThunk</a></span>&nbsp;<span class="op" id="3421274">==</span>&nbsp;<span class="num" id="3421277">0</span>&nbsp;<span class="op" id="3421279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421284">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421292">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421296"><a href="/gostd/debug/pe/file.go.html#3421004">ida</a></span>&nbsp;<span class="op" id="3421300">=</span>&nbsp;<span class="builtinfunc" id="3421302">append</span><span class="op" id="3421308">(</span><span class="ident" id="3421309"><a href="/gostd/debug/pe/file.go.html#3421004">ida</a></span><span class="op" id="3421312">,</span>&nbsp;<span class="ident" id="3421314"><a href="/gostd/debug/pe/file.go.html#3421050">dt</a></span><span class="op" id="3421316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421322">names</span><span class="op" id="3421327">,</span>&nbsp;<span class="ident" id="3421329">_</span>&nbsp;<span class="op" id="3421331">:=</span>&nbsp;<span class="ident" id="3421334"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span><span class="op" id="3421336">.</span><span class="ident" id="3421337"><a href="/gostd/debug/pe/file.go.html#3413792">Data</a></span><span class="op" id="3421341">(</span><span class="op" id="3421342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421345">var</span>&nbsp;<span class="ident" id="3421349">all</span>&nbsp;<span class="op" id="3421353">[</span><span class="op" id="3421354">]</span><span class="builtintype" id="3421355">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421363">for</span>&nbsp;<span class="ident" id="3421367">_</span><span class="op" id="3421368">,</span>&nbsp;<span class="ident" id="3421370">dt</span>&nbsp;<span class="op" id="3421373">:=</span>&nbsp;<span class="keyword" id="3421376">range</span>&nbsp;<span class="ident" id="3421382"><a href="/gostd/debug/pe/file.go.html#3421004">ida</a></span>&nbsp;<span class="op" id="3421386">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421390"><a href="/gostd/debug/pe/file.go.html#3421370">dt</a></span><span class="op" id="3421392">.</span><span class="ident" id="3421393"><a href="/gostd/debug/pe/file.go.html#3413702">dll</a></span><span class="op" id="3421396">,</span>&nbsp;<span class="ident" id="3421398">_</span>&nbsp;<span class="op" id="3421400">=</span>&nbsp;<span class="ident" id="3421402"><a href="/gostd/debug/pe/file.go.html#3419438">getString</a></span><span class="op" id="3421411">(</span><span class="ident" id="3421412"><a href="/gostd/debug/pe/file.go.html#3421322">names</a></span><span class="op" id="3421417">,</span>&nbsp;<span class="builtintype" id="3421419">int</span><span class="op" id="3421422">(</span><span class="ident" id="3421423"><a href="/gostd/debug/pe/file.go.html#3421370">dt</a></span><span class="op" id="3421425">.</span><span class="ident" id="3421426"><a href="/gostd/debug/pe/file.go.html#3413647">Name</a></span><span class="op" id="3421430">-</span><span class="ident" id="3421431"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span><span class="op" id="3421433">.</span><span class="ident" id="3421434"><a href="/gostd/debug/pe/file.go.html#3412858">VirtualAddress</a></span><span class="op" id="3421448">)</span><span class="op" id="3421449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421453"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421454">,</span>&nbsp;<span class="ident" id="3421456">_</span>&nbsp;<span class="op" id="3421458">=</span>&nbsp;<span class="ident" id="3421460"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span><span class="op" id="3421462">.</span><span class="ident" id="3421463"><a href="/gostd/debug/pe/file.go.html#3413792">Data</a></span><span class="op" id="3421467">(</span><span class="op" id="3421468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3421472">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421504"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span>&nbsp;<span class="op" id="3421506">=</span>&nbsp;<span class="ident" id="3421508"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421509">[</span><span class="ident" id="3421510"><a href="/gostd/debug/pe/file.go.html#3421370">dt</a></span><span class="op" id="3421512">.</span><span class="ident" id="3421513"><a href="/gostd/debug/pe/file.go.html#3413566">OriginalFirstThunk</a></span><span class="op" id="3421531">-</span><span class="ident" id="3421532"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span><span class="op" id="3421534">.</span><span class="ident" id="3421535"><a href="/gostd/debug/pe/file.go.html#3412858">VirtualAddress</a></span><span class="op" id="3421549">:</span><span class="op" id="3421550">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421554">for</span>&nbsp;<span class="builtinfunc" id="3421558">len</span><span class="op" id="3421561">(</span><span class="ident" id="3421562"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421563">)</span>&nbsp;<span class="op" id="3421565">&gt;</span>&nbsp;<span class="num" id="3421567">0</span>&nbsp;<span class="op" id="3421569">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421574">if</span>&nbsp;<span class="ident" id="3421577"><a href="/gostd/debug/pe/file.go.html#3420796">pe64</a></span>&nbsp;<span class="op" id="3421582">{</span>&nbsp;<span class="comment" id="3421584">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421597">va</span>&nbsp;<span class="op" id="3421600">:=</span>&nbsp;<span class="ident" id="3421603"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3421609">.</span><span class="ident" id="3421610"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3421622">.</span><span class="ident" id="3421623"><a href="/gostd/encoding/binary/binary.go.html#2987656">Uint64</a></span><span class="op" id="3421629">(</span><span class="ident" id="3421630"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421631">[</span><span class="num" id="3421632">0</span><span class="op" id="3421633">:</span><span class="num" id="3421634">8</span><span class="op" id="3421635">]</span><span class="op" id="3421636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421642"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span>&nbsp;<span class="op" id="3421644">=</span>&nbsp;<span class="ident" id="3421646"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421647">[</span><span class="num" id="3421648">8</span><span class="op" id="3421649">:</span><span class="op" id="3421650">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421656">if</span>&nbsp;<span class="ident" id="3421659"><a href="/gostd/debug/pe/file.go.html#3421597">va</a></span>&nbsp;<span class="op" id="3421662">==</span>&nbsp;<span class="num" id="3421665">0</span>&nbsp;<span class="op" id="3421667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421674">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421690">if</span>&nbsp;<span class="ident" id="3421693"><a href="/gostd/debug/pe/file.go.html#3421597">va</a></span><span class="op" id="3421695">&amp;</span><span class="num" id="3421696">0x8000000000000000</span>&nbsp;<span class="op" id="3421715">&gt;</span>&nbsp;<span class="num" id="3421717">0</span>&nbsp;<span class="op" id="3421719">{</span>&nbsp;<span class="comment" id="3421721">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3421740">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421783">}</span>&nbsp;<span class="keyword" id="3421785">else</span>&nbsp;<span class="op" id="3421790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421797">fn</span><span class="op" id="3421799">,</span>&nbsp;<span class="ident" id="3421801">_</span>&nbsp;<span class="op" id="3421803">:=</span>&nbsp;<span class="ident" id="3421806"><a href="/gostd/debug/pe/file.go.html#3419438">getString</a></span><span class="op" id="3421815">(</span><span class="ident" id="3421816"><a href="/gostd/debug/pe/file.go.html#3421322">names</a></span><span class="op" id="3421821">,</span>&nbsp;<span class="builtintype" id="3421823">int</span><span class="op" id="3421826">(</span><span class="builtintype" id="3421827">uint32</span><span class="op" id="3421833">(</span><span class="ident" id="3421834"><a href="/gostd/debug/pe/file.go.html#3421597">va</a></span><span class="op" id="3421836">)</span><span class="op" id="3421837">-</span><span class="ident" id="3421838"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span><span class="op" id="3421840">.</span><span class="ident" id="3421841"><a href="/gostd/debug/pe/file.go.html#3412858">VirtualAddress</a></span><span class="op" id="3421855">+</span><span class="num" id="3421856">2</span><span class="op" id="3421857">)</span><span class="op" id="3421858">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421865"><a href="/gostd/debug/pe/file.go.html#3421349">all</a></span>&nbsp;<span class="op" id="3421869">=</span>&nbsp;<span class="builtinfunc" id="3421871">append</span><span class="op" id="3421877">(</span><span class="ident" id="3421878"><a href="/gostd/debug/pe/file.go.html#3421349">all</a></span><span class="op" id="3421881">,</span>&nbsp;<span class="ident" id="3421883"><a href="/gostd/debug/pe/file.go.html#3421797">fn</a></span><span class="op" id="3421885">+</span><span class="string" id="3421886">&#34;:&#34;</span><span class="op" id="3421889">+</span><span class="ident" id="3421890"><a href="/gostd/debug/pe/file.go.html#3421370">dt</a></span><span class="op" id="3421892">.</span><span class="ident" id="3421893"><a href="/gostd/debug/pe/file.go.html#3413702">dll</a></span><span class="op" id="3421896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421907">}</span>&nbsp;<span class="keyword" id="3421909">else</span>&nbsp;<span class="op" id="3421914">{</span>&nbsp;<span class="comment" id="3421916">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421929">va</span>&nbsp;<span class="op" id="3421932">:=</span>&nbsp;<span class="ident" id="3421935"><a href="/gostd/debug/pe/file.go.html#3412488">binary</a></span><span class="op" id="3421941">.</span><span class="ident" id="3421942"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="3421954">.</span><span class="ident" id="3421955"><a href="/gostd/encoding/binary/binary.go.html#2987394">Uint32</a></span><span class="op" id="3421961">(</span><span class="ident" id="3421962"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421963">[</span><span class="num" id="3421964">0</span><span class="op" id="3421965">:</span><span class="num" id="3421966">4</span><span class="op" id="3421967">]</span><span class="op" id="3421968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421974"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span>&nbsp;<span class="op" id="3421976">=</span>&nbsp;<span class="ident" id="3421978"><a href="/gostd/debug/pe/file.go.html#3420941">d</a></span><span class="op" id="3421979">[</span><span class="num" id="3421980">4</span><span class="op" id="3421981">:</span><span class="op" id="3421982">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3421988">if</span>&nbsp;<span class="ident" id="3421991"><a href="/gostd/debug/pe/file.go.html#3421929">va</a></span>&nbsp;<span class="op" id="3421994">==</span>&nbsp;<span class="num" id="3421997">0</span>&nbsp;<span class="op" id="3421999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3422006">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3422022">if</span>&nbsp;<span class="ident" id="3422025"><a href="/gostd/debug/pe/file.go.html#3421929">va</a></span><span class="op" id="3422027">&amp;</span><span class="num" id="3422028">0x80000000</span>&nbsp;<span class="op" id="3422039">&gt;</span>&nbsp;<span class="num" id="3422041">0</span>&nbsp;<span class="op" id="3422043">{</span>&nbsp;<span class="comment" id="3422045">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422064">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422108">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422135">}</span>&nbsp;<span class="keyword" id="3422137">else</span>&nbsp;<span class="op" id="3422142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422149">fn</span><span class="op" id="3422151">,</span>&nbsp;<span class="ident" id="3422153">_</span>&nbsp;<span class="op" id="3422155">:=</span>&nbsp;<span class="ident" id="3422158"><a href="/gostd/debug/pe/file.go.html#3419438">getString</a></span><span class="op" id="3422167">(</span><span class="ident" id="3422168"><a href="/gostd/debug/pe/file.go.html#3421322">names</a></span><span class="op" id="3422173">,</span>&nbsp;<span class="builtintype" id="3422175">int</span><span class="op" id="3422178">(</span><span class="ident" id="3422179"><a href="/gostd/debug/pe/file.go.html#3421929">va</a></span><span class="op" id="3422181">-</span><span class="ident" id="3422182"><a href="/gostd/debug/pe/file.go.html#3420843">ds</a></span><span class="op" id="3422184">.</span><span class="ident" id="3422185"><a href="/gostd/debug/pe/file.go.html#3412858">VirtualAddress</a></span><span class="op" id="3422199">+</span><span class="num" id="3422200">2</span><span class="op" id="3422201">)</span><span class="op" id="3422202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422209"><a href="/gostd/debug/pe/file.go.html#3421349">all</a></span>&nbsp;<span class="op" id="3422213">=</span>&nbsp;<span class="builtinfunc" id="3422215">append</span><span class="op" id="3422221">(</span><span class="ident" id="3422222"><a href="/gostd/debug/pe/file.go.html#3421349">all</a></span><span class="op" id="3422225">,</span>&nbsp;<span class="ident" id="3422227"><a href="/gostd/debug/pe/file.go.html#3422149">fn</a></span><span class="op" id="3422229">+</span><span class="string" id="3422230">&#34;:&#34;</span><span class="op" id="3422233">+</span><span class="ident" id="3422234"><a href="/gostd/debug/pe/file.go.html#3421370">dt</a></span><span class="op" id="3422236">.</span><span class="ident" id="3422237"><a href="/gostd/debug/pe/file.go.html#3413702">dll</a></span><span class="op" id="3422240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422246">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3422262">return</span>&nbsp;<span class="ident" id="3422269"><a href="/gostd/debug/pe/file.go.html#3421349">all</a></span><span class="op" id="3422272">,</span>&nbsp;<span class="builtintype" id="3422274">nil</span><br>
<span class="lineno">385</span><span class="op" id="3422278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3422281">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="3422337">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3422392">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="3422440">func</span>&nbsp;<span class="op" id="3422445">(</span><span class="ident" id="3422446">f</span>&nbsp;<span class="op" id="3422448">*</span><span class="ident" id="3422449"><a href="/gostd/debug/pe/file.go.html#3412592">File</a></span><span class="op" id="3422453">)</span>&nbsp;<span class="ident" id="3422455">ImportedLibraries</span><span class="op" id="3422472">(</span><span class="op" id="3422473">)</span>&nbsp;<span class="op" id="3422475">(</span><span class="op" id="3422476">[</span><span class="op" id="3422477">]</span><span class="builtintype" id="3422478">string</span><span class="op" id="3422484">,</span>&nbsp;<span class="builtintype" id="3422486">error</span><span class="op" id="3422491">)</span>&nbsp;<span class="op" id="3422493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422496">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422505">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3422571">return</span>&nbsp;<span class="builtintype" id="3422578">nil</span><span class="op" id="3422581">,</span>&nbsp;<span class="builtintype" id="3422583">nil</span><br>
<span class="lineno"></span><span class="op" id="3422587">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
