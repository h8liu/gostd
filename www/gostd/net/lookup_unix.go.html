<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html" class="current">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3803880">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3803936">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3803990">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3804041">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3804106">package</span>&nbsp;<span class="ident" id="3804114">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3804119">import</span>&nbsp;<span class="op" id="3804126">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3804129">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3804139">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3804146">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3804149">var</span>&nbsp;<span class="ident" id="3804153">onceReadProtocols</span>&nbsp;<span class="ident" id="3804171">sync</span><span class="op" id="3804175">.</span><span class="ident" id="3804176">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3804182">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3804251">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3804272">func</span>&nbsp;<span class="ident" id="3804277">readProtocols</span><span class="op" id="3804290">(</span><span class="op" id="3804291">)</span>&nbsp;<span class="op" id="3804293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804296">if</span>&nbsp;<span class="ident" id="3804299">file</span><span class="op" id="3804303">,</span>&nbsp;<span class="ident" id="3804305">err</span>&nbsp;<span class="op" id="3804309">:=</span>&nbsp;<span class="ident" id="3804312">open</span><span class="op" id="3804316">(</span><span class="string" id="3804317">&#34;/etc/protocols&#34;</span><span class="op" id="3804333">)</span><span class="op" id="3804334">;</span>&nbsp;<span class="ident" id="3804336">err</span>&nbsp;<span class="op" id="3804340">==</span>&nbsp;<span class="builtintype" id="3804343">nil</span>&nbsp;<span class="op" id="3804347">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804351">for</span>&nbsp;<span class="ident" id="3804355">line</span><span class="op" id="3804359">,</span>&nbsp;<span class="ident" id="3804361">ok</span>&nbsp;<span class="op" id="3804364">:=</span>&nbsp;<span class="ident" id="3804367">file</span><span class="op" id="3804371">.</span><span class="ident" id="3804372">readLine</span><span class="op" id="3804380">(</span><span class="op" id="3804381">)</span><span class="op" id="3804382">;</span>&nbsp;<span class="ident" id="3804384">ok</span><span class="op" id="3804386">;</span>&nbsp;<span class="ident" id="3804388">line</span><span class="op" id="3804392">,</span>&nbsp;<span class="ident" id="3804394">ok</span>&nbsp;<span class="op" id="3804397">=</span>&nbsp;<span class="ident" id="3804399">file</span><span class="op" id="3804403">.</span><span class="ident" id="3804404">readLine</span><span class="op" id="3804412">(</span><span class="op" id="3804413">)</span>&nbsp;<span class="op" id="3804415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3804420">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804476">if</span>&nbsp;<span class="ident" id="3804479">i</span>&nbsp;<span class="op" id="3804481">:=</span>&nbsp;<span class="ident" id="3804484">byteIndex</span><span class="op" id="3804493">(</span><span class="ident" id="3804494">line</span><span class="op" id="3804498">,</span>&nbsp;<span class="string" id="3804500">&#39;#&#39;</span><span class="op" id="3804503">)</span><span class="op" id="3804504">;</span>&nbsp;<span class="ident" id="3804506">i</span>&nbsp;<span class="op" id="3804508">&gt;=</span>&nbsp;<span class="num" id="3804511">0</span>&nbsp;<span class="op" id="3804513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804519">line</span>&nbsp;<span class="op" id="3804524">=</span>&nbsp;<span class="ident" id="3804526">line</span><span class="op" id="3804530">[</span><span class="num" id="3804531">0</span><span class="op" id="3804532">:</span><span class="ident" id="3804533">i</span><span class="op" id="3804534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804539">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804544">f</span>&nbsp;<span class="op" id="3804546">:=</span>&nbsp;<span class="ident" id="3804549">getFields</span><span class="op" id="3804558">(</span><span class="ident" id="3804559">line</span><span class="op" id="3804563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804568">if</span>&nbsp;<span class="builtinfunc" id="3804571">len</span><span class="op" id="3804574">(</span><span class="ident" id="3804575">f</span><span class="op" id="3804576">)</span>&nbsp;<span class="op" id="3804578">&lt;</span>&nbsp;<span class="num" id="3804580">2</span>&nbsp;<span class="op" id="3804582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804588">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804605">if</span>&nbsp;<span class="ident" id="3804608">proto</span><span class="op" id="3804613">,</span>&nbsp;<span class="ident" id="3804615">_</span><span class="op" id="3804616">,</span>&nbsp;<span class="ident" id="3804618">ok</span>&nbsp;<span class="op" id="3804621">:=</span>&nbsp;<span class="ident" id="3804624">dtoi</span><span class="op" id="3804628">(</span><span class="ident" id="3804629">f</span><span class="op" id="3804630">[</span><span class="num" id="3804631">1</span><span class="op" id="3804632">]</span><span class="op" id="3804633">,</span>&nbsp;<span class="num" id="3804635">0</span><span class="op" id="3804636">)</span><span class="op" id="3804637">;</span>&nbsp;<span class="ident" id="3804639">ok</span>&nbsp;<span class="op" id="3804642">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804648">if</span>&nbsp;<span class="ident" id="3804651">_</span><span class="op" id="3804652">,</span>&nbsp;<span class="ident" id="3804654">ok</span>&nbsp;<span class="op" id="3804657">:=</span>&nbsp;<span class="ident" id="3804660">protocols</span><span class="op" id="3804669">[</span><span class="ident" id="3804670">f</span><span class="op" id="3804671">[</span><span class="num" id="3804672">0</span><span class="op" id="3804673">]</span><span class="op" id="3804674">]</span><span class="op" id="3804675">;</span>&nbsp;<span class="op" id="3804677">!</span><span class="ident" id="3804678">ok</span>&nbsp;<span class="op" id="3804681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804688">protocols</span><span class="op" id="3804697">[</span><span class="ident" id="3804698">f</span><span class="op" id="3804699">[</span><span class="num" id="3804700">0</span><span class="op" id="3804701">]</span><span class="op" id="3804702">]</span>&nbsp;<span class="op" id="3804704">=</span>&nbsp;<span class="ident" id="3804706">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804722">for</span>&nbsp;<span class="ident" id="3804726">_</span><span class="op" id="3804727">,</span>&nbsp;<span class="ident" id="3804729">alias</span>&nbsp;<span class="op" id="3804735">:=</span>&nbsp;<span class="keyword" id="3804738">range</span>&nbsp;<span class="ident" id="3804744">f</span><span class="op" id="3804745">[</span><span class="num" id="3804746">2</span><span class="op" id="3804747">:</span><span class="op" id="3804748">]</span>&nbsp;<span class="op" id="3804750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804757">if</span>&nbsp;<span class="ident" id="3804760">_</span><span class="op" id="3804761">,</span>&nbsp;<span class="ident" id="3804763">ok</span>&nbsp;<span class="op" id="3804766">:=</span>&nbsp;<span class="ident" id="3804769">protocols</span><span class="op" id="3804778">[</span><span class="ident" id="3804779">alias</span><span class="op" id="3804784">]</span><span class="op" id="3804785">;</span>&nbsp;<span class="op" id="3804787">!</span><span class="ident" id="3804788">ok</span>&nbsp;<span class="op" id="3804791">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804799">protocols</span><span class="op" id="3804808">[</span><span class="ident" id="3804809">alias</span><span class="op" id="3804814">]</span>&nbsp;<span class="op" id="3804816">=</span>&nbsp;<span class="ident" id="3804818">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804844">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804848">file</span><span class="op" id="3804852">.</span><span class="builtinfunc" id="3804853">close</span><span class="op" id="3804858">(</span><span class="op" id="3804859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804862">}</span><br>
<span class="lineno"></span><span class="op" id="3804864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3804867">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3804933">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3804975">func</span>&nbsp;<span class="ident" id="3804980">lookupProtocol</span><span class="op" id="3804994">(</span><span class="ident" id="3804995">name</span>&nbsp;<span class="builtintype" id="3805000">string</span><span class="op" id="3805006">)</span>&nbsp;<span class="op" id="3805008">(</span><span class="ident" id="3805009">proto</span>&nbsp;<span class="builtintype" id="3805015">int</span><span class="op" id="3805018">,</span>&nbsp;<span class="ident" id="3805020">err</span>&nbsp;<span class="builtintype" id="3805024">error</span><span class="op" id="3805029">)</span>&nbsp;<span class="op" id="3805031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805034">onceReadProtocols</span><span class="op" id="3805051">.</span><span class="ident" id="3805052">Do</span><span class="op" id="3805054">(</span><span class="ident" id="3805055">readProtocols</span><span class="op" id="3805068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805071">proto</span><span class="op" id="3805076">,</span>&nbsp;<span class="ident" id="3805078">found</span>&nbsp;<span class="op" id="3805084">:=</span>&nbsp;<span class="ident" id="3805087">protocols</span><span class="op" id="3805096">[</span><span class="ident" id="3805097">name</span><span class="op" id="3805101">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805104">if</span>&nbsp;<span class="op" id="3805107">!</span><span class="ident" id="3805108">found</span>&nbsp;<span class="op" id="3805114">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805118">return</span>&nbsp;<span class="num" id="3805125">0</span><span class="op" id="3805126">,</span>&nbsp;<span class="ident" id="3805128">errors</span><span class="op" id="3805134">.</span><span class="ident" id="3805135">New</span><span class="op" id="3805138">(</span><span class="string" id="3805139">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3805173">+</span>&nbsp;<span class="ident" id="3805175">name</span><span class="op" id="3805179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805185">return</span><br>
<span class="lineno"></span><span class="op" id="3805192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3805195">func</span>&nbsp;<span class="ident" id="3805200">lookupHost</span><span class="op" id="3805210">(</span><span class="ident" id="3805211">host</span>&nbsp;<span class="builtintype" id="3805216">string</span><span class="op" id="3805222">)</span>&nbsp;<span class="op" id="3805224">(</span><span class="ident" id="3805225">addrs</span>&nbsp;<span class="op" id="3805231">[</span><span class="op" id="3805232">]</span><span class="builtintype" id="3805233">string</span><span class="op" id="3805239">,</span>&nbsp;<span class="ident" id="3805241">err</span>&nbsp;<span class="builtintype" id="3805245">error</span><span class="op" id="3805250">)</span>&nbsp;<span class="op" id="3805252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805255">addrs</span><span class="op" id="3805260">,</span>&nbsp;<span class="ident" id="3805262">err</span><span class="op" id="3805265">,</span>&nbsp;<span class="ident" id="3805267">ok</span>&nbsp;<span class="op" id="3805270">:=</span>&nbsp;<span class="ident" id="3805273">cgoLookupHost</span><span class="op" id="3805286">(</span><span class="ident" id="3805287">host</span><span class="op" id="3805291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805294">if</span>&nbsp;<span class="op" id="3805297">!</span><span class="ident" id="3805298">ok</span>&nbsp;<span class="op" id="3805301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805305">addrs</span><span class="op" id="3805310">,</span>&nbsp;<span class="ident" id="3805312">err</span>&nbsp;<span class="op" id="3805316">=</span>&nbsp;<span class="ident" id="3805318">goLookupHost</span><span class="op" id="3805330">(</span><span class="ident" id="3805331">host</span><span class="op" id="3805335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805338">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805341">return</span><br>
<span class="lineno"></span><span class="op" id="3805348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3805351">func</span>&nbsp;<span class="ident" id="3805356">lookupIP</span><span class="op" id="3805364">(</span><span class="ident" id="3805365">host</span>&nbsp;<span class="builtintype" id="3805370">string</span><span class="op" id="3805376">)</span>&nbsp;<span class="op" id="3805378">(</span><span class="ident" id="3805379">addrs</span>&nbsp;<span class="op" id="3805385">[</span><span class="op" id="3805386">]</span><span class="ident" id="3805387">IP</span><span class="op" id="3805389">,</span>&nbsp;<span class="ident" id="3805391">err</span>&nbsp;<span class="builtintype" id="3805395">error</span><span class="op" id="3805400">)</span>&nbsp;<span class="op" id="3805402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805405">addrs</span><span class="op" id="3805410">,</span>&nbsp;<span class="ident" id="3805412">err</span><span class="op" id="3805415">,</span>&nbsp;<span class="ident" id="3805417">ok</span>&nbsp;<span class="op" id="3805420">:=</span>&nbsp;<span class="ident" id="3805423">cgoLookupIP</span><span class="op" id="3805434">(</span><span class="ident" id="3805435">host</span><span class="op" id="3805439">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805442">if</span>&nbsp;<span class="op" id="3805445">!</span><span class="ident" id="3805446">ok</span>&nbsp;<span class="op" id="3805449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805453">addrs</span><span class="op" id="3805458">,</span>&nbsp;<span class="ident" id="3805460">err</span>&nbsp;<span class="op" id="3805464">=</span>&nbsp;<span class="ident" id="3805466">goLookupIP</span><span class="op" id="3805476">(</span><span class="ident" id="3805477">host</span><span class="op" id="3805481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805487">return</span><br>
<span class="lineno"></span><span class="op" id="3805494">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3805497">func</span>&nbsp;<span class="ident" id="3805502">lookupPort</span><span class="op" id="3805512">(</span><span class="ident" id="3805513">network</span><span class="op" id="3805520">,</span>&nbsp;<span class="ident" id="3805522">service</span>&nbsp;<span class="builtintype" id="3805530">string</span><span class="op" id="3805536">)</span>&nbsp;<span class="op" id="3805538">(</span><span class="ident" id="3805539">port</span>&nbsp;<span class="builtintype" id="3805544">int</span><span class="op" id="3805547">,</span>&nbsp;<span class="ident" id="3805549">err</span>&nbsp;<span class="builtintype" id="3805553">error</span><span class="op" id="3805558">)</span>&nbsp;<span class="op" id="3805560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805563">port</span><span class="op" id="3805567">,</span>&nbsp;<span class="ident" id="3805569">err</span><span class="op" id="3805572">,</span>&nbsp;<span class="ident" id="3805574">ok</span>&nbsp;<span class="op" id="3805577">:=</span>&nbsp;<span class="ident" id="3805580">cgoLookupPort</span><span class="op" id="3805593">(</span><span class="ident" id="3805594">network</span><span class="op" id="3805601">,</span>&nbsp;<span class="ident" id="3805603">service</span><span class="op" id="3805610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805613">if</span>&nbsp;<span class="op" id="3805616">!</span><span class="ident" id="3805617">ok</span>&nbsp;<span class="op" id="3805620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805624">port</span><span class="op" id="3805628">,</span>&nbsp;<span class="ident" id="3805630">err</span>&nbsp;<span class="op" id="3805634">=</span>&nbsp;<span class="ident" id="3805636">goLookupPort</span><span class="op" id="3805648">(</span><span class="ident" id="3805649">network</span><span class="op" id="3805656">,</span>&nbsp;<span class="ident" id="3805658">service</span><span class="op" id="3805665">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805671">return</span><br>
<span class="lineno"></span><span class="op" id="3805678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3805681">func</span>&nbsp;<span class="ident" id="3805686">lookupCNAME</span><span class="op" id="3805697">(</span><span class="ident" id="3805698">name</span>&nbsp;<span class="builtintype" id="3805703">string</span><span class="op" id="3805709">)</span>&nbsp;<span class="op" id="3805711">(</span><span class="ident" id="3805712">cname</span>&nbsp;<span class="builtintype" id="3805718">string</span><span class="op" id="3805724">,</span>&nbsp;<span class="ident" id="3805726">err</span>&nbsp;<span class="builtintype" id="3805730">error</span><span class="op" id="3805735">)</span>&nbsp;<span class="op" id="3805737">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805740">cname</span><span class="op" id="3805745">,</span>&nbsp;<span class="ident" id="3805747">err</span><span class="op" id="3805750">,</span>&nbsp;<span class="ident" id="3805752">ok</span>&nbsp;<span class="op" id="3805755">:=</span>&nbsp;<span class="ident" id="3805758">cgoLookupCNAME</span><span class="op" id="3805772">(</span><span class="ident" id="3805773">name</span><span class="op" id="3805777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805780">if</span>&nbsp;<span class="op" id="3805783">!</span><span class="ident" id="3805784">ok</span>&nbsp;<span class="op" id="3805787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805791">cname</span><span class="op" id="3805796">,</span>&nbsp;<span class="ident" id="3805798">err</span>&nbsp;<span class="op" id="3805802">=</span>&nbsp;<span class="ident" id="3805804">goLookupCNAME</span><span class="op" id="3805817">(</span><span class="ident" id="3805818">name</span><span class="op" id="3805822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805828">return</span><br>
<span class="lineno">85</span><span class="op" id="3805835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3805838">func</span>&nbsp;<span class="ident" id="3805843">lookupSRV</span><span class="op" id="3805852">(</span><span class="ident" id="3805853">service</span><span class="op" id="3805860">,</span>&nbsp;<span class="ident" id="3805862">proto</span><span class="op" id="3805867">,</span>&nbsp;<span class="ident" id="3805869">name</span>&nbsp;<span class="builtintype" id="3805874">string</span><span class="op" id="3805880">)</span>&nbsp;<span class="op" id="3805882">(</span><span class="ident" id="3805883">cname</span>&nbsp;<span class="builtintype" id="3805889">string</span><span class="op" id="3805895">,</span>&nbsp;<span class="ident" id="3805897">addrs</span>&nbsp;<span class="op" id="3805903">[</span><span class="op" id="3805904">]</span><span class="op" id="3805905">*</span><span class="ident" id="3805906">SRV</span><span class="op" id="3805909">,</span>&nbsp;<span class="ident" id="3805911">err</span>&nbsp;<span class="builtintype" id="3805915">error</span><span class="op" id="3805920">)</span>&nbsp;<span class="op" id="3805922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805925">var</span>&nbsp;<span class="ident" id="3805929">target</span>&nbsp;<span class="builtintype" id="3805936">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805944">if</span>&nbsp;<span class="ident" id="3805947">service</span>&nbsp;<span class="op" id="3805955">==</span>&nbsp;<span class="string" id="3805958">&#34;&#34;</span>&nbsp;<span class="op" id="3805961">&amp;&amp;</span>&nbsp;<span class="ident" id="3805964">proto</span>&nbsp;<span class="op" id="3805970">==</span>&nbsp;<span class="string" id="3805973">&#34;&#34;</span>&nbsp;<span class="op" id="3805976">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805980">target</span>&nbsp;<span class="op" id="3805987">=</span>&nbsp;<span class="ident" id="3805989">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805995">}</span>&nbsp;<span class="keyword" id="3805997">else</span>&nbsp;<span class="op" id="3806002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806006">target</span>&nbsp;<span class="op" id="3806013">=</span>&nbsp;<span class="string" id="3806015">&#34;_&#34;</span>&nbsp;<span class="op" id="3806019">+</span>&nbsp;<span class="ident" id="3806021">service</span>&nbsp;<span class="op" id="3806029">+</span>&nbsp;<span class="string" id="3806031">&#34;._&#34;</span>&nbsp;<span class="op" id="3806036">+</span>&nbsp;<span class="ident" id="3806038">proto</span>&nbsp;<span class="op" id="3806044">+</span>&nbsp;<span class="string" id="3806046">&#34;.&#34;</span>&nbsp;<span class="op" id="3806050">+</span>&nbsp;<span class="ident" id="3806052">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806061">var</span>&nbsp;<span class="ident" id="3806065">records</span>&nbsp;<span class="op" id="3806073">[</span><span class="op" id="3806074">]</span><span class="ident" id="3806075">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806082">cname</span><span class="op" id="3806087">,</span>&nbsp;<span class="ident" id="3806089">records</span><span class="op" id="3806096">,</span>&nbsp;<span class="ident" id="3806098">err</span>&nbsp;<span class="op" id="3806102">=</span>&nbsp;<span class="ident" id="3806104">lookup</span><span class="op" id="3806110">(</span><span class="ident" id="3806111">target</span><span class="op" id="3806117">,</span>&nbsp;<span class="ident" id="3806119">dnsTypeSRV</span><span class="op" id="3806129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806132">if</span>&nbsp;<span class="ident" id="3806135">err</span>&nbsp;<span class="op" id="3806139">!=</span>&nbsp;<span class="builtintype" id="3806142">nil</span>&nbsp;<span class="op" id="3806146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806150">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806161">addrs</span>&nbsp;<span class="op" id="3806167">=</span>&nbsp;<span class="builtinfunc" id="3806169">make</span><span class="op" id="3806173">(</span><span class="op" id="3806174">[</span><span class="op" id="3806175">]</span><span class="op" id="3806176">*</span><span class="ident" id="3806177">SRV</span><span class="op" id="3806180">,</span>&nbsp;<span class="builtinfunc" id="3806182">len</span><span class="op" id="3806185">(</span><span class="ident" id="3806186">records</span><span class="op" id="3806193">)</span><span class="op" id="3806194">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806197">for</span>&nbsp;<span class="ident" id="3806201">i</span><span class="op" id="3806202">,</span>&nbsp;<span class="ident" id="3806204">rr</span>&nbsp;<span class="op" id="3806207">:=</span>&nbsp;<span class="keyword" id="3806210">range</span>&nbsp;<span class="ident" id="3806216">records</span>&nbsp;<span class="op" id="3806224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806228">r</span>&nbsp;<span class="op" id="3806230">:=</span>&nbsp;<span class="ident" id="3806233">rr</span><span class="op" id="3806235">.</span><span class="op" id="3806236">(</span><span class="op" id="3806237">*</span><span class="ident" id="3806238">dnsRR_SRV</span><span class="op" id="3806247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806251">addrs</span><span class="op" id="3806256">[</span><span class="ident" id="3806257">i</span><span class="op" id="3806258">]</span>&nbsp;<span class="op" id="3806260">=</span>&nbsp;<span class="op" id="3806262">&amp;</span><span class="ident" id="3806263">SRV</span><span class="op" id="3806266">{</span><span class="ident" id="3806267">r</span><span class="op" id="3806268">.</span><span class="ident" id="3806269">Target</span><span class="op" id="3806275">,</span>&nbsp;<span class="ident" id="3806277">r</span><span class="op" id="3806278">.</span><span class="ident" id="3806279">Port</span><span class="op" id="3806283">,</span>&nbsp;<span class="ident" id="3806285">r</span><span class="op" id="3806286">.</span><span class="ident" id="3806287">Priority</span><span class="op" id="3806295">,</span>&nbsp;<span class="ident" id="3806297">r</span><span class="op" id="3806298">.</span><span class="ident" id="3806299">Weight</span><span class="op" id="3806305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806311">byPriorityWeight</span><span class="op" id="3806327">(</span><span class="ident" id="3806328">addrs</span><span class="op" id="3806333">)</span><span class="op" id="3806334">.</span><span class="ident" id="3806335">sort</span><span class="op" id="3806339">(</span><span class="op" id="3806340">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806343">return</span><br>
<span class="lineno"></span><span class="op" id="3806350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3806353">func</span>&nbsp;<span class="ident" id="3806358">lookupMX</span><span class="op" id="3806366">(</span><span class="ident" id="3806367">name</span>&nbsp;<span class="builtintype" id="3806372">string</span><span class="op" id="3806378">)</span>&nbsp;<span class="op" id="3806380">(</span><span class="ident" id="3806381">mx</span>&nbsp;<span class="op" id="3806384">[</span><span class="op" id="3806385">]</span><span class="op" id="3806386">*</span><span class="ident" id="3806387">MX</span><span class="op" id="3806389">,</span>&nbsp;<span class="ident" id="3806391">err</span>&nbsp;<span class="builtintype" id="3806395">error</span><span class="op" id="3806400">)</span>&nbsp;<span class="op" id="3806402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806405">_</span><span class="op" id="3806406">,</span>&nbsp;<span class="ident" id="3806408">records</span><span class="op" id="3806415">,</span>&nbsp;<span class="ident" id="3806417">err</span>&nbsp;<span class="op" id="3806421">:=</span>&nbsp;<span class="ident" id="3806424">lookup</span><span class="op" id="3806430">(</span><span class="ident" id="3806431">name</span><span class="op" id="3806435">,</span>&nbsp;<span class="ident" id="3806437">dnsTypeMX</span><span class="op" id="3806446">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806449">if</span>&nbsp;<span class="ident" id="3806452">err</span>&nbsp;<span class="op" id="3806456">!=</span>&nbsp;<span class="builtintype" id="3806459">nil</span>&nbsp;<span class="op" id="3806463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806467">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806478">mx</span>&nbsp;<span class="op" id="3806481">=</span>&nbsp;<span class="builtinfunc" id="3806483">make</span><span class="op" id="3806487">(</span><span class="op" id="3806488">[</span><span class="op" id="3806489">]</span><span class="op" id="3806490">*</span><span class="ident" id="3806491">MX</span><span class="op" id="3806493">,</span>&nbsp;<span class="builtinfunc" id="3806495">len</span><span class="op" id="3806498">(</span><span class="ident" id="3806499">records</span><span class="op" id="3806506">)</span><span class="op" id="3806507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806510">for</span>&nbsp;<span class="ident" id="3806514">i</span><span class="op" id="3806515">,</span>&nbsp;<span class="ident" id="3806517">rr</span>&nbsp;<span class="op" id="3806520">:=</span>&nbsp;<span class="keyword" id="3806523">range</span>&nbsp;<span class="ident" id="3806529">records</span>&nbsp;<span class="op" id="3806537">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806541">r</span>&nbsp;<span class="op" id="3806543">:=</span>&nbsp;<span class="ident" id="3806546">rr</span><span class="op" id="3806548">.</span><span class="op" id="3806549">(</span><span class="op" id="3806550">*</span><span class="ident" id="3806551">dnsRR_MX</span><span class="op" id="3806559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806563">mx</span><span class="op" id="3806565">[</span><span class="ident" id="3806566">i</span><span class="op" id="3806567">]</span>&nbsp;<span class="op" id="3806569">=</span>&nbsp;<span class="op" id="3806571">&amp;</span><span class="ident" id="3806572">MX</span><span class="op" id="3806574">{</span><span class="ident" id="3806575">r</span><span class="op" id="3806576">.</span><span class="ident" id="3806577">Mx</span><span class="op" id="3806579">,</span>&nbsp;<span class="ident" id="3806581">r</span><span class="op" id="3806582">.</span><span class="ident" id="3806583">Pref</span><span class="op" id="3806587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806593">byPref</span><span class="op" id="3806599">(</span><span class="ident" id="3806600">mx</span><span class="op" id="3806602">)</span><span class="op" id="3806603">.</span><span class="ident" id="3806604">sort</span><span class="op" id="3806608">(</span><span class="op" id="3806609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806612">return</span><br>
<span class="lineno">120</span><span class="op" id="3806619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3806622">func</span>&nbsp;<span class="ident" id="3806627">lookupNS</span><span class="op" id="3806635">(</span><span class="ident" id="3806636">name</span>&nbsp;<span class="builtintype" id="3806641">string</span><span class="op" id="3806647">)</span>&nbsp;<span class="op" id="3806649">(</span><span class="ident" id="3806650">ns</span>&nbsp;<span class="op" id="3806653">[</span><span class="op" id="3806654">]</span><span class="op" id="3806655">*</span><span class="ident" id="3806656">NS</span><span class="op" id="3806658">,</span>&nbsp;<span class="ident" id="3806660">err</span>&nbsp;<span class="builtintype" id="3806664">error</span><span class="op" id="3806669">)</span>&nbsp;<span class="op" id="3806671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806674">_</span><span class="op" id="3806675">,</span>&nbsp;<span class="ident" id="3806677">records</span><span class="op" id="3806684">,</span>&nbsp;<span class="ident" id="3806686">err</span>&nbsp;<span class="op" id="3806690">:=</span>&nbsp;<span class="ident" id="3806693">lookup</span><span class="op" id="3806699">(</span><span class="ident" id="3806700">name</span><span class="op" id="3806704">,</span>&nbsp;<span class="ident" id="3806706">dnsTypeNS</span><span class="op" id="3806715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806718">if</span>&nbsp;<span class="ident" id="3806721">err</span>&nbsp;<span class="op" id="3806725">!=</span>&nbsp;<span class="builtintype" id="3806728">nil</span>&nbsp;<span class="op" id="3806732">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806747">ns</span>&nbsp;<span class="op" id="3806750">=</span>&nbsp;<span class="builtinfunc" id="3806752">make</span><span class="op" id="3806756">(</span><span class="op" id="3806757">[</span><span class="op" id="3806758">]</span><span class="op" id="3806759">*</span><span class="ident" id="3806760">NS</span><span class="op" id="3806762">,</span>&nbsp;<span class="builtinfunc" id="3806764">len</span><span class="op" id="3806767">(</span><span class="ident" id="3806768">records</span><span class="op" id="3806775">)</span><span class="op" id="3806776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806779">for</span>&nbsp;<span class="ident" id="3806783">i</span><span class="op" id="3806784">,</span>&nbsp;<span class="ident" id="3806786">r</span>&nbsp;<span class="op" id="3806788">:=</span>&nbsp;<span class="keyword" id="3806791">range</span>&nbsp;<span class="ident" id="3806797">records</span>&nbsp;<span class="op" id="3806805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806809">r</span>&nbsp;<span class="op" id="3806811">:=</span>&nbsp;<span class="ident" id="3806814">r</span><span class="op" id="3806815">.</span><span class="op" id="3806816">(</span><span class="op" id="3806817">*</span><span class="ident" id="3806818">dnsRR_NS</span><span class="op" id="3806826">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806830">ns</span><span class="op" id="3806832">[</span><span class="ident" id="3806833">i</span><span class="op" id="3806834">]</span>&nbsp;<span class="op" id="3806836">=</span>&nbsp;<span class="op" id="3806838">&amp;</span><span class="ident" id="3806839">NS</span><span class="op" id="3806841">{</span><span class="ident" id="3806842">r</span><span class="op" id="3806843">.</span><span class="ident" id="3806844">Ns</span><span class="op" id="3806846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806852">return</span><br>
<span class="lineno"></span><span class="op" id="3806859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3806862">func</span>&nbsp;<span class="ident" id="3806867">lookupTXT</span><span class="op" id="3806876">(</span><span class="ident" id="3806877">name</span>&nbsp;<span class="builtintype" id="3806882">string</span><span class="op" id="3806888">)</span>&nbsp;<span class="op" id="3806890">(</span><span class="ident" id="3806891">txt</span>&nbsp;<span class="op" id="3806895">[</span><span class="op" id="3806896">]</span><span class="builtintype" id="3806897">string</span><span class="op" id="3806903">,</span>&nbsp;<span class="ident" id="3806905">err</span>&nbsp;<span class="builtintype" id="3806909">error</span><span class="op" id="3806914">)</span>&nbsp;<span class="op" id="3806916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806919">_</span><span class="op" id="3806920">,</span>&nbsp;<span class="ident" id="3806922">records</span><span class="op" id="3806929">,</span>&nbsp;<span class="ident" id="3806931">err</span>&nbsp;<span class="op" id="3806935">:=</span>&nbsp;<span class="ident" id="3806938">lookup</span><span class="op" id="3806944">(</span><span class="ident" id="3806945">name</span><span class="op" id="3806949">,</span>&nbsp;<span class="ident" id="3806951">dnsTypeTXT</span><span class="op" id="3806961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806964">if</span>&nbsp;<span class="ident" id="3806967">err</span>&nbsp;<span class="op" id="3806971">!=</span>&nbsp;<span class="builtintype" id="3806974">nil</span>&nbsp;<span class="op" id="3806978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806982">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806990">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806993">txt</span>&nbsp;<span class="op" id="3806997">=</span>&nbsp;<span class="builtinfunc" id="3806999">make</span><span class="op" id="3807003">(</span><span class="op" id="3807004">[</span><span class="op" id="3807005">]</span><span class="builtintype" id="3807006">string</span><span class="op" id="3807012">,</span>&nbsp;<span class="builtinfunc" id="3807014">len</span><span class="op" id="3807017">(</span><span class="ident" id="3807018">records</span><span class="op" id="3807025">)</span><span class="op" id="3807026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807029">for</span>&nbsp;<span class="ident" id="3807033">i</span><span class="op" id="3807034">,</span>&nbsp;<span class="ident" id="3807036">r</span>&nbsp;<span class="op" id="3807038">:=</span>&nbsp;<span class="keyword" id="3807041">range</span>&nbsp;<span class="ident" id="3807047">records</span>&nbsp;<span class="op" id="3807055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807059">txt</span><span class="op" id="3807062">[</span><span class="ident" id="3807063">i</span><span class="op" id="3807064">]</span>&nbsp;<span class="op" id="3807066">=</span>&nbsp;<span class="ident" id="3807068">r</span><span class="op" id="3807069">.</span><span class="op" id="3807070">(</span><span class="op" id="3807071">*</span><span class="ident" id="3807072">dnsRR_TXT</span><span class="op" id="3807081">)</span><span class="op" id="3807082">.</span><span class="ident" id="3807083">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807091">return</span><br>
<span class="lineno">145</span><span class="op" id="3807098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3807101">func</span>&nbsp;<span class="ident" id="3807106">lookupAddr</span><span class="op" id="3807116">(</span><span class="ident" id="3807117">addr</span>&nbsp;<span class="builtintype" id="3807122">string</span><span class="op" id="3807128">)</span>&nbsp;<span class="op" id="3807130">(</span><span class="ident" id="3807131">name</span>&nbsp;<span class="op" id="3807136">[</span><span class="op" id="3807137">]</span><span class="builtintype" id="3807138">string</span><span class="op" id="3807144">,</span>&nbsp;<span class="ident" id="3807146">err</span>&nbsp;<span class="builtintype" id="3807150">error</span><span class="op" id="3807155">)</span>&nbsp;<span class="op" id="3807157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807160">name</span>&nbsp;<span class="op" id="3807165">=</span>&nbsp;<span class="ident" id="3807167">lookupStaticAddr</span><span class="op" id="3807183">(</span><span class="ident" id="3807184">addr</span><span class="op" id="3807188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807191">if</span>&nbsp;<span class="builtinfunc" id="3807194">len</span><span class="op" id="3807197">(</span><span class="ident" id="3807198">name</span><span class="op" id="3807202">)</span>&nbsp;<span class="op" id="3807204">&gt;</span>&nbsp;<span class="num" id="3807206">0</span>&nbsp;<span class="op" id="3807208">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807212">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807223">var</span>&nbsp;<span class="ident" id="3807227">arpa</span>&nbsp;<span class="builtintype" id="3807232">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807240">arpa</span><span class="op" id="3807244">,</span>&nbsp;<span class="ident" id="3807246">err</span>&nbsp;<span class="op" id="3807250">=</span>&nbsp;<span class="ident" id="3807252">reverseaddr</span><span class="op" id="3807263">(</span><span class="ident" id="3807264">addr</span><span class="op" id="3807268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807271">if</span>&nbsp;<span class="ident" id="3807274">err</span>&nbsp;<span class="op" id="3807278">!=</span>&nbsp;<span class="builtintype" id="3807281">nil</span>&nbsp;<span class="op" id="3807285">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807289">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807300">var</span>&nbsp;<span class="ident" id="3807304">records</span>&nbsp;<span class="op" id="3807312">[</span><span class="op" id="3807313">]</span><span class="ident" id="3807314">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807321">_</span><span class="op" id="3807322">,</span>&nbsp;<span class="ident" id="3807324">records</span><span class="op" id="3807331">,</span>&nbsp;<span class="ident" id="3807333">err</span>&nbsp;<span class="op" id="3807337">=</span>&nbsp;<span class="ident" id="3807339">lookup</span><span class="op" id="3807345">(</span><span class="ident" id="3807346">arpa</span><span class="op" id="3807350">,</span>&nbsp;<span class="ident" id="3807352">dnsTypePTR</span><span class="op" id="3807362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807365">if</span>&nbsp;<span class="ident" id="3807368">err</span>&nbsp;<span class="op" id="3807372">!=</span>&nbsp;<span class="builtintype" id="3807375">nil</span>&nbsp;<span class="op" id="3807379">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807383">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807394">name</span>&nbsp;<span class="op" id="3807399">=</span>&nbsp;<span class="builtinfunc" id="3807401">make</span><span class="op" id="3807405">(</span><span class="op" id="3807406">[</span><span class="op" id="3807407">]</span><span class="builtintype" id="3807408">string</span><span class="op" id="3807414">,</span>&nbsp;<span class="builtinfunc" id="3807416">len</span><span class="op" id="3807419">(</span><span class="ident" id="3807420">records</span><span class="op" id="3807427">)</span><span class="op" id="3807428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807431">for</span>&nbsp;<span class="ident" id="3807435">i</span>&nbsp;<span class="op" id="3807437">:=</span>&nbsp;<span class="keyword" id="3807440">range</span>&nbsp;<span class="ident" id="3807446">records</span>&nbsp;<span class="op" id="3807454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807458">r</span>&nbsp;<span class="op" id="3807460">:=</span>&nbsp;<span class="ident" id="3807463">records</span><span class="op" id="3807470">[</span><span class="ident" id="3807471">i</span><span class="op" id="3807472">]</span><span class="op" id="3807473">.</span><span class="op" id="3807474">(</span><span class="op" id="3807475">*</span><span class="ident" id="3807476">dnsRR_PTR</span><span class="op" id="3807485">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807489">name</span><span class="op" id="3807493">[</span><span class="ident" id="3807494">i</span><span class="op" id="3807495">]</span>&nbsp;<span class="op" id="3807497">=</span>&nbsp;<span class="ident" id="3807499">r</span><span class="op" id="3807500">.</span><span class="ident" id="3807501">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807509">return</span><br>
<span class="lineno"></span><span class="op" id="3807516">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
