<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7080600">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7080655">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7080709">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7080760">package</span>&nbsp;<span class="ident" id="7080768">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7080773">import</span>&nbsp;<span class="op" id="7080780">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7080783">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7080793">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7080796">func</span>&nbsp;<span class="ident" id="7080801">TestRoundUp</span><span class="op" id="7080812">(</span><span class="ident" id="7080813">t</span>&nbsp;<span class="op" id="7080815">*</span><span class="ident" id="7080816"><a href="/crypto/tls/conn_test.go.html#7080783">testing</a></span><span class="op" id="7080823">.</span><span class="ident" id="7080824">T</span><span class="op" id="7080825">)</span>&nbsp;<span class="op" id="7080827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080830">if</span>&nbsp;<span class="ident" id="7080833"><a href="/crypto/tls/conn.go.html#4133633">roundUp</a></span><span class="op" id="7080840">(</span><span class="num" id="7080841">0</span><span class="op" id="7080842">,</span>&nbsp;<span class="num" id="7080844">16</span><span class="op" id="7080846">)</span>&nbsp;<span class="op" id="7080848">!=</span>&nbsp;<span class="num" id="7080851">0</span>&nbsp;<span class="op" id="7080853">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080858"><a href="/crypto/tls/conn.go.html#4133633">roundUp</a></span><span class="op" id="7080865">(</span><span class="num" id="7080866">1</span><span class="op" id="7080867">,</span>&nbsp;<span class="num" id="7080869">16</span><span class="op" id="7080871">)</span>&nbsp;<span class="op" id="7080873">!=</span>&nbsp;<span class="num" id="7080876">16</span>&nbsp;<span class="op" id="7080879">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080884"><a href="/crypto/tls/conn.go.html#4133633">roundUp</a></span><span class="op" id="7080891">(</span><span class="num" id="7080892">15</span><span class="op" id="7080894">,</span>&nbsp;<span class="num" id="7080896">16</span><span class="op" id="7080898">)</span>&nbsp;<span class="op" id="7080900">!=</span>&nbsp;<span class="num" id="7080903">16</span>&nbsp;<span class="op" id="7080906">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080911"><a href="/crypto/tls/conn.go.html#4133633">roundUp</a></span><span class="op" id="7080918">(</span><span class="num" id="7080919">16</span><span class="op" id="7080921">,</span>&nbsp;<span class="num" id="7080923">16</span><span class="op" id="7080925">)</span>&nbsp;<span class="op" id="7080927">!=</span>&nbsp;<span class="num" id="7080930">16</span>&nbsp;<span class="op" id="7080933">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080938"><a href="/crypto/tls/conn.go.html#4133633">roundUp</a></span><span class="op" id="7080945">(</span><span class="num" id="7080946">17</span><span class="op" id="7080948">,</span>&nbsp;<span class="num" id="7080950">16</span><span class="op" id="7080952">)</span>&nbsp;<span class="op" id="7080954">!=</span>&nbsp;<span class="num" id="7080957">32</span>&nbsp;<span class="op" id="7080960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080964"><a href="/crypto/tls/conn_test.go.html#7080813">t</a></span><span class="op" id="7080965">.</span><span class="ident" id="7080966">Error</span><span class="op" id="7080971">(</span><span class="string" id="7080972">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7080988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080991">}</span><br>
<span class="lineno"></span><span class="op" id="7080993">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7080996">var</span>&nbsp;<span class="ident" id="7081000">paddingTests</span>&nbsp;<span class="op" id="7081013">=</span>&nbsp;<span class="op" id="7081015">[</span><span class="op" id="7081016">]</span><span class="keyword" id="7081017">struct</span>&nbsp;<span class="op" id="7081024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081027">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7081039">[</span><span class="op" id="7081040">]</span><span class="builtintype" id="7081041">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081047">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7081059">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081065">expectedLen</span>&nbsp;<span class="builtintype" id="7081077">int</span><br>
<span class="lineno">25</span><span class="op" id="7081081">}</span><span class="op" id="7081082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081085">{</span><span class="op" id="7081086">[</span><span class="op" id="7081087">]</span><span class="builtintype" id="7081088">byte</span><span class="op" id="7081092">{</span><span class="num" id="7081093">1</span><span class="op" id="7081094">,</span>&nbsp;<span class="num" id="7081096">2</span><span class="op" id="7081097">,</span>&nbsp;<span class="num" id="7081099">3</span><span class="op" id="7081100">,</span>&nbsp;<span class="num" id="7081102">4</span><span class="op" id="7081103">,</span>&nbsp;<span class="num" id="7081105">0</span><span class="op" id="7081106">}</span><span class="op" id="7081107">,</span>&nbsp;<span class="ident" id="7081109">true</span><span class="op" id="7081113">,</span>&nbsp;<span class="num" id="7081115">4</span><span class="op" id="7081116">}</span><span class="op" id="7081117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081120">{</span><span class="op" id="7081121">[</span><span class="op" id="7081122">]</span><span class="builtintype" id="7081123">byte</span><span class="op" id="7081127">{</span><span class="num" id="7081128">1</span><span class="op" id="7081129">,</span>&nbsp;<span class="num" id="7081131">2</span><span class="op" id="7081132">,</span>&nbsp;<span class="num" id="7081134">3</span><span class="op" id="7081135">,</span>&nbsp;<span class="num" id="7081137">4</span><span class="op" id="7081138">,</span>&nbsp;<span class="num" id="7081140">0</span><span class="op" id="7081141">,</span>&nbsp;<span class="num" id="7081143">1</span><span class="op" id="7081144">}</span><span class="op" id="7081145">,</span>&nbsp;<span class="ident" id="7081147">false</span><span class="op" id="7081152">,</span>&nbsp;<span class="num" id="7081154">0</span><span class="op" id="7081155">}</span><span class="op" id="7081156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081159">{</span><span class="op" id="7081160">[</span><span class="op" id="7081161">]</span><span class="builtintype" id="7081162">byte</span><span class="op" id="7081166">{</span><span class="num" id="7081167">1</span><span class="op" id="7081168">,</span>&nbsp;<span class="num" id="7081170">2</span><span class="op" id="7081171">,</span>&nbsp;<span class="num" id="7081173">3</span><span class="op" id="7081174">,</span>&nbsp;<span class="num" id="7081176">4</span><span class="op" id="7081177">,</span>&nbsp;<span class="num" id="7081179">99</span><span class="op" id="7081181">,</span>&nbsp;<span class="num" id="7081183">99</span><span class="op" id="7081185">}</span><span class="op" id="7081186">,</span>&nbsp;<span class="ident" id="7081188">false</span><span class="op" id="7081193">,</span>&nbsp;<span class="num" id="7081195">0</span><span class="op" id="7081196">}</span><span class="op" id="7081197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081200">{</span><span class="op" id="7081201">[</span><span class="op" id="7081202">]</span><span class="builtintype" id="7081203">byte</span><span class="op" id="7081207">{</span><span class="num" id="7081208">1</span><span class="op" id="7081209">,</span>&nbsp;<span class="num" id="7081211">2</span><span class="op" id="7081212">,</span>&nbsp;<span class="num" id="7081214">3</span><span class="op" id="7081215">,</span>&nbsp;<span class="num" id="7081217">4</span><span class="op" id="7081218">,</span>&nbsp;<span class="num" id="7081220">1</span><span class="op" id="7081221">,</span>&nbsp;<span class="num" id="7081223">1</span><span class="op" id="7081224">}</span><span class="op" id="7081225">,</span>&nbsp;<span class="ident" id="7081227">true</span><span class="op" id="7081231">,</span>&nbsp;<span class="num" id="7081233">4</span><span class="op" id="7081234">}</span><span class="op" id="7081235">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081238">{</span><span class="op" id="7081239">[</span><span class="op" id="7081240">]</span><span class="builtintype" id="7081241">byte</span><span class="op" id="7081245">{</span><span class="num" id="7081246">1</span><span class="op" id="7081247">,</span>&nbsp;<span class="num" id="7081249">2</span><span class="op" id="7081250">,</span>&nbsp;<span class="num" id="7081252">3</span><span class="op" id="7081253">,</span>&nbsp;<span class="num" id="7081255">2</span><span class="op" id="7081256">,</span>&nbsp;<span class="num" id="7081258">2</span><span class="op" id="7081259">,</span>&nbsp;<span class="num" id="7081261">2</span><span class="op" id="7081262">}</span><span class="op" id="7081263">,</span>&nbsp;<span class="ident" id="7081265">true</span><span class="op" id="7081269">,</span>&nbsp;<span class="num" id="7081271">3</span><span class="op" id="7081272">}</span><span class="op" id="7081273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081276">{</span><span class="op" id="7081277">[</span><span class="op" id="7081278">]</span><span class="builtintype" id="7081279">byte</span><span class="op" id="7081283">{</span><span class="num" id="7081284">1</span><span class="op" id="7081285">,</span>&nbsp;<span class="num" id="7081287">2</span><span class="op" id="7081288">,</span>&nbsp;<span class="num" id="7081290">3</span><span class="op" id="7081291">,</span>&nbsp;<span class="num" id="7081293">3</span><span class="op" id="7081294">,</span>&nbsp;<span class="num" id="7081296">3</span><span class="op" id="7081297">,</span>&nbsp;<span class="num" id="7081299">3</span><span class="op" id="7081300">}</span><span class="op" id="7081301">,</span>&nbsp;<span class="ident" id="7081303">true</span><span class="op" id="7081307">,</span>&nbsp;<span class="num" id="7081309">2</span><span class="op" id="7081310">}</span><span class="op" id="7081311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081314">{</span><span class="op" id="7081315">[</span><span class="op" id="7081316">]</span><span class="builtintype" id="7081317">byte</span><span class="op" id="7081321">{</span><span class="num" id="7081322">1</span><span class="op" id="7081323">,</span>&nbsp;<span class="num" id="7081325">2</span><span class="op" id="7081326">,</span>&nbsp;<span class="num" id="7081328">3</span><span class="op" id="7081329">,</span>&nbsp;<span class="num" id="7081331">4</span><span class="op" id="7081332">,</span>&nbsp;<span class="num" id="7081334">3</span><span class="op" id="7081335">,</span>&nbsp;<span class="num" id="7081337">3</span><span class="op" id="7081338">}</span><span class="op" id="7081339">,</span>&nbsp;<span class="ident" id="7081341">false</span><span class="op" id="7081346">,</span>&nbsp;<span class="num" id="7081348">0</span><span class="op" id="7081349">}</span><span class="op" id="7081350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081353">{</span><span class="op" id="7081354">[</span><span class="op" id="7081355">]</span><span class="builtintype" id="7081356">byte</span><span class="op" id="7081360">{</span><span class="num" id="7081361">1</span><span class="op" id="7081362">,</span>&nbsp;<span class="num" id="7081364">4</span><span class="op" id="7081365">,</span>&nbsp;<span class="num" id="7081367">4</span><span class="op" id="7081368">,</span>&nbsp;<span class="num" id="7081370">4</span><span class="op" id="7081371">,</span>&nbsp;<span class="num" id="7081373">4</span><span class="op" id="7081374">,</span>&nbsp;<span class="num" id="7081376">4</span><span class="op" id="7081377">}</span><span class="op" id="7081378">,</span>&nbsp;<span class="ident" id="7081380">true</span><span class="op" id="7081384">,</span>&nbsp;<span class="num" id="7081386">1</span><span class="op" id="7081387">}</span><span class="op" id="7081388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081391">{</span><span class="op" id="7081392">[</span><span class="op" id="7081393">]</span><span class="builtintype" id="7081394">byte</span><span class="op" id="7081398">{</span><span class="num" id="7081399">5</span><span class="op" id="7081400">,</span>&nbsp;<span class="num" id="7081402">5</span><span class="op" id="7081403">,</span>&nbsp;<span class="num" id="7081405">5</span><span class="op" id="7081406">,</span>&nbsp;<span class="num" id="7081408">5</span><span class="op" id="7081409">,</span>&nbsp;<span class="num" id="7081411">5</span><span class="op" id="7081412">,</span>&nbsp;<span class="num" id="7081414">5</span><span class="op" id="7081415">}</span><span class="op" id="7081416">,</span>&nbsp;<span class="ident" id="7081418">true</span><span class="op" id="7081422">,</span>&nbsp;<span class="num" id="7081424">0</span><span class="op" id="7081425">}</span><span class="op" id="7081426">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081429">{</span><span class="op" id="7081430">[</span><span class="op" id="7081431">]</span><span class="builtintype" id="7081432">byte</span><span class="op" id="7081436">{</span><span class="num" id="7081437">6</span><span class="op" id="7081438">,</span>&nbsp;<span class="num" id="7081440">6</span><span class="op" id="7081441">,</span>&nbsp;<span class="num" id="7081443">6</span><span class="op" id="7081444">,</span>&nbsp;<span class="num" id="7081446">6</span><span class="op" id="7081447">,</span>&nbsp;<span class="num" id="7081449">6</span><span class="op" id="7081450">,</span>&nbsp;<span class="num" id="7081452">6</span><span class="op" id="7081453">}</span><span class="op" id="7081454">,</span>&nbsp;<span class="ident" id="7081456">false</span><span class="op" id="7081461">,</span>&nbsp;<span class="num" id="7081463">0</span><span class="op" id="7081464">}</span><span class="op" id="7081465">,</span><br>
<span class="lineno"></span><span class="op" id="7081467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7081470">func</span>&nbsp;<span class="ident" id="7081475">TestRemovePadding</span><span class="op" id="7081492">(</span><span class="ident" id="7081493">t</span>&nbsp;<span class="op" id="7081495">*</span><span class="ident" id="7081496"><a href="/crypto/tls/conn_test.go.html#7080783">testing</a></span><span class="op" id="7081503">.</span><span class="ident" id="7081504">T</span><span class="op" id="7081505">)</span>&nbsp;<span class="op" id="7081507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081510">for</span>&nbsp;<span class="ident" id="7081514">i</span><span class="op" id="7081515">,</span>&nbsp;<span class="ident" id="7081517">test</span>&nbsp;<span class="op" id="7081522">:=</span>&nbsp;<span class="keyword" id="7081525">range</span>&nbsp;<span class="ident" id="7081531"><a href="/crypto/tls/conn_test.go.html#7081000">paddingTests</a></span>&nbsp;<span class="op" id="7081544">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081548">payload</span><span class="op" id="7081555">,</span>&nbsp;<span class="ident" id="7081557">good</span>&nbsp;<span class="op" id="7081562">:=</span>&nbsp;<span class="ident" id="7081565"><a href="/crypto/tls/conn.go.html#4132230">removePadding</a></span><span class="op" id="7081578">(</span><span class="ident" id="7081579"><a href="/crypto/tls/conn_test.go.html#7081517">test</a></span><span class="op" id="7081583">.</span><span class="ident" id="7081584">in</span><span class="op" id="7081586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081590">expectedGood</span>&nbsp;<span class="op" id="7081603">:=</span>&nbsp;<span class="builtintype" id="7081606">byte</span><span class="op" id="7081610">(</span><span class="num" id="7081611">255</span><span class="op" id="7081614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081618">if</span>&nbsp;<span class="op" id="7081621">!</span><span class="ident" id="7081622"><a href="/crypto/tls/conn_test.go.html#7081517">test</a></span><span class="op" id="7081626">.</span><span class="ident" id="7081627">good</span>&nbsp;<span class="op" id="7081632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081637"><a href="/crypto/tls/conn_test.go.html#7081590">expectedGood</a></span>&nbsp;<span class="op" id="7081650">=</span>&nbsp;<span class="num" id="7081652">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081656">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081660">if</span>&nbsp;<span class="ident" id="7081663"><a href="/crypto/tls/conn_test.go.html#7081557">good</a></span>&nbsp;<span class="op" id="7081668">!=</span>&nbsp;<span class="ident" id="7081671"><a href="/crypto/tls/conn_test.go.html#7081590">expectedGood</a></span>&nbsp;<span class="op" id="7081684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081689"><a href="/crypto/tls/conn_test.go.html#7081493">t</a></span><span class="op" id="7081690">.</span><span class="ident" id="7081691">Errorf</span><span class="op" id="7081697">(</span><span class="string" id="7081698">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7081735">,</span>&nbsp;<span class="ident" id="7081737"><a href="/crypto/tls/conn_test.go.html#7081514">i</a></span><span class="op" id="7081738">,</span>&nbsp;<span class="ident" id="7081740"><a href="/crypto/tls/conn_test.go.html#7081590">expectedGood</a></span><span class="op" id="7081752">,</span>&nbsp;<span class="ident" id="7081754"><a href="/crypto/tls/conn_test.go.html#7081557">good</a></span><span class="op" id="7081758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081766">if</span>&nbsp;<span class="ident" id="7081769"><a href="/crypto/tls/conn_test.go.html#7081557">good</a></span>&nbsp;<span class="op" id="7081774">==</span>&nbsp;<span class="num" id="7081777">255</span>&nbsp;<span class="op" id="7081781">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7081784">len</span><span class="op" id="7081787">(</span><span class="ident" id="7081788"><a href="/crypto/tls/conn_test.go.html#7081548">payload</a></span><span class="op" id="7081795">)</span>&nbsp;<span class="op" id="7081797">!=</span>&nbsp;<span class="ident" id="7081800"><a href="/crypto/tls/conn_test.go.html#7081517">test</a></span><span class="op" id="7081804">.</span><span class="ident" id="7081805">expectedLen</span>&nbsp;<span class="op" id="7081817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081822"><a href="/crypto/tls/conn_test.go.html#7081493">t</a></span><span class="op" id="7081823">.</span><span class="ident" id="7081824">Errorf</span><span class="op" id="7081830">(</span><span class="string" id="7081831">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7081853">,</span>&nbsp;<span class="ident" id="7081855"><a href="/crypto/tls/conn_test.go.html#7081514">i</a></span><span class="op" id="7081856">,</span>&nbsp;<span class="builtinfunc" id="7081858">len</span><span class="op" id="7081861">(</span><span class="ident" id="7081862"><a href="/crypto/tls/conn_test.go.html#7081548">payload</a></span><span class="op" id="7081869">)</span><span class="op" id="7081870">,</span>&nbsp;<span class="ident" id="7081872"><a href="/crypto/tls/conn_test.go.html#7081517">test</a></span><span class="op" id="7081876">.</span><span class="ident" id="7081877">expectedLen</span><span class="op" id="7081888">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081895">}</span><br>
<span class="lineno"></span><span class="op" id="7081897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7081900">var</span>&nbsp;<span class="ident" id="7081904">certExampleCom</span>&nbsp;<span class="op" id="7081919">=</span>&nbsp;<span class="string" id="7081921">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7082573">var</span>&nbsp;<span class="ident" id="7082577">certWildcardExampleCom</span>&nbsp;<span class="op" id="7082600">=</span>&nbsp;<span class="string" id="7082602">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7083258">var</span>&nbsp;<span class="ident" id="7083262">certFooExampleCom</span>&nbsp;<span class="op" id="7083280">=</span>&nbsp;<span class="string" id="7083282">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7083942">var</span>&nbsp;<span class="ident" id="7083946">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7083975">=</span>&nbsp;<span class="string" id="7083977">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7084637">func</span>&nbsp;<span class="ident" id="7084642">TestCertificateSelection</span><span class="op" id="7084666">(</span><span class="ident" id="7084667">t</span>&nbsp;<span class="op" id="7084669">*</span><span class="ident" id="7084670"><a href="/crypto/tls/conn_test.go.html#7080783">testing</a></span><span class="op" id="7084677">.</span><span class="ident" id="7084678">T</span><span class="op" id="7084679">)</span>&nbsp;<span class="op" id="7084681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084684">config</span>&nbsp;<span class="op" id="7084691">:=</span>&nbsp;<span class="ident" id="7084694"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="7084700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084704">Certificates</span><span class="op" id="7084716">:</span>&nbsp;<span class="op" id="7084718">[</span><span class="op" id="7084719">]</span><span class="ident" id="7084720"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><span class="op" id="7084731">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084742">Certificate</span><span class="op" id="7084753">:</span>&nbsp;<span class="op" id="7084755">[</span><span class="op" id="7084756">]</span><span class="op" id="7084757">[</span><span class="op" id="7084758">]</span><span class="builtintype" id="7084759">byte</span><span class="op" id="7084763">{</span><span class="ident" id="7084764"><a href="/crypto/tls/handshake_server_test.go.html#7131982">fromHex</a></span><span class="op" id="7084771">(</span><span class="ident" id="7084772"><a href="/crypto/tls/conn_test.go.html#7081904">certExampleCom</a></span><span class="op" id="7084786">)</span><span class="op" id="7084787">}</span><span class="op" id="7084788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084793">}</span><span class="op" id="7084794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084805">Certificate</span><span class="op" id="7084816">:</span>&nbsp;<span class="op" id="7084818">[</span><span class="op" id="7084819">]</span><span class="op" id="7084820">[</span><span class="op" id="7084821">]</span><span class="builtintype" id="7084822">byte</span><span class="op" id="7084826">{</span><span class="ident" id="7084827"><a href="/crypto/tls/handshake_server_test.go.html#7131982">fromHex</a></span><span class="op" id="7084834">(</span><span class="ident" id="7084835"><a href="/crypto/tls/conn_test.go.html#7082577">certWildcardExampleCom</a></span><span class="op" id="7084857">)</span><span class="op" id="7084858">}</span><span class="op" id="7084859">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084864">}</span><span class="op" id="7084865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084876">Certificate</span><span class="op" id="7084887">:</span>&nbsp;<span class="op" id="7084889">[</span><span class="op" id="7084890">]</span><span class="op" id="7084891">[</span><span class="op" id="7084892">]</span><span class="builtintype" id="7084893">byte</span><span class="op" id="7084897">{</span><span class="ident" id="7084898"><a href="/crypto/tls/handshake_server_test.go.html#7131982">fromHex</a></span><span class="op" id="7084905">(</span><span class="ident" id="7084906"><a href="/crypto/tls/conn_test.go.html#7083262">certFooExampleCom</a></span><span class="op" id="7084923">)</span><span class="op" id="7084924">}</span><span class="op" id="7084925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084930">}</span><span class="op" id="7084931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084936">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084942">Certificate</span><span class="op" id="7084953">:</span>&nbsp;<span class="op" id="7084955">[</span><span class="op" id="7084956">]</span><span class="op" id="7084957">[</span><span class="op" id="7084958">]</span><span class="builtintype" id="7084959">byte</span><span class="op" id="7084963">{</span><span class="ident" id="7084964"><a href="/crypto/tls/handshake_server_test.go.html#7131982">fromHex</a></span><span class="op" id="7084971">(</span><span class="ident" id="7084972"><a href="/crypto/tls/conn_test.go.html#7083946">certDoubleWildcardExampleCom</a></span><span class="op" id="7085000">)</span><span class="op" id="7085001">}</span><span class="op" id="7085002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085007">}</span><span class="op" id="7085008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085012">}</span><span class="op" id="7085013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085020"><a href="/crypto/tls/conn_test.go.html#7084684">config</a></span><span class="op" id="7085026">.</span><span class="ident" id="7085027">BuildNameToCertificate</span><span class="op" id="7085049">(</span><span class="op" id="7085050">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085054">pointerToIndex</span>&nbsp;<span class="op" id="7085069">:=</span>&nbsp;<span class="keyword" id="7085072">func</span><span class="op" id="7085076">(</span><span class="ident" id="7085077">c</span>&nbsp;<span class="op" id="7085079">*</span><span class="ident" id="7085080"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><span class="op" id="7085091">)</span>&nbsp;<span class="builtintype" id="7085093">int</span>&nbsp;<span class="op" id="7085097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085101">for</span>&nbsp;<span class="ident" id="7085105">i</span>&nbsp;<span class="op" id="7085107">:=</span>&nbsp;<span class="keyword" id="7085110">range</span>&nbsp;<span class="ident" id="7085116"><a href="/crypto/tls/conn_test.go.html#7084684">config</a></span><span class="op" id="7085122">.</span><span class="ident" id="7085123">Certificates</span>&nbsp;<span class="op" id="7085136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085141">if</span>&nbsp;<span class="ident" id="7085144"><a href="/crypto/tls/conn_test.go.html#7085077">c</a></span>&nbsp;<span class="op" id="7085146">==</span>&nbsp;<span class="op" id="7085149">&amp;</span><span class="ident" id="7085150"><a href="/crypto/tls/conn_test.go.html#7084684">config</a></span><span class="op" id="7085156">.</span><span class="ident" id="7085157">Certificates</span><span class="op" id="7085169">[</span><span class="ident" id="7085170"><a href="/crypto/tls/conn_test.go.html#7085105">i</a></span><span class="op" id="7085171">]</span>&nbsp;<span class="op" id="7085173">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085179">return</span>&nbsp;<span class="ident" id="7085186"><a href="/crypto/tls/conn_test.go.html#7085105">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085199">return</span>&nbsp;<span class="op" id="7085206">-</span><span class="num" id="7085207">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085210">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085214">certificateForName</span>&nbsp;<span class="op" id="7085233">:=</span>&nbsp;<span class="keyword" id="7085236">func</span><span class="op" id="7085240">(</span><span class="ident" id="7085241">name</span>&nbsp;<span class="builtintype" id="7085246">string</span><span class="op" id="7085252">)</span>&nbsp;<span class="op" id="7085254">*</span><span class="ident" id="7085255"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span>&nbsp;<span class="op" id="7085267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085271">clientHello</span>&nbsp;<span class="op" id="7085283">:=</span>&nbsp;<span class="op" id="7085286">&amp;</span><span class="ident" id="7085287"><a href="/crypto/tls/common.go.html#4115067">ClientHelloInfo</a></span><span class="op" id="7085302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085307">ServerName</span><span class="op" id="7085317">:</span>&nbsp;<span class="ident" id="7085319"><a href="/crypto/tls/conn_test.go.html#7085241">name</a></span><span class="op" id="7085323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085327">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085331">if</span>&nbsp;<span class="ident" id="7085334">cert</span><span class="op" id="7085338">,</span>&nbsp;<span class="ident" id="7085340">err</span>&nbsp;<span class="op" id="7085344">:=</span>&nbsp;<span class="ident" id="7085347"><a href="/crypto/tls/conn_test.go.html#7084684">config</a></span><span class="op" id="7085353">.</span><span class="ident" id="7085354">getCertificate</span><span class="op" id="7085368">(</span><span class="ident" id="7085369"><a href="/crypto/tls/conn_test.go.html#7085271">clientHello</a></span><span class="op" id="7085380">)</span><span class="op" id="7085381">;</span>&nbsp;<span class="ident" id="7085383"><a href="/crypto/tls/conn_test.go.html#7085340">err</a></span>&nbsp;<span class="op" id="7085387">!=</span>&nbsp;<span class="ident" id="7085390">nil</span>&nbsp;<span class="op" id="7085394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085399"><a href="/crypto/tls/conn_test.go.html#7084667">t</a></span><span class="op" id="7085400">.</span><span class="ident" id="7085401">Errorf</span><span class="op" id="7085407">(</span><span class="string" id="7085408">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7085453">,</span>&nbsp;<span class="ident" id="7085455"><a href="/crypto/tls/conn_test.go.html#7085241">name</a></span><span class="op" id="7085459">,</span>&nbsp;<span class="ident" id="7085461"><a href="/crypto/tls/conn_test.go.html#7085340">err</a></span><span class="op" id="7085464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085469">return</span>&nbsp;<span class="ident" id="7085476">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085482">}</span>&nbsp;<span class="keyword" id="7085484">else</span>&nbsp;<span class="op" id="7085489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085494">return</span>&nbsp;<span class="ident" id="7085501"><a href="/crypto/tls/conn_test.go.html#7085334">cert</a></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085515">if</span>&nbsp;<span class="ident" id="7085518">n</span>&nbsp;<span class="op" id="7085520">:=</span>&nbsp;<span class="ident" id="7085523"><a href="/crypto/tls/conn_test.go.html#7085054">pointerToIndex</a></span><span class="op" id="7085537">(</span><span class="ident" id="7085538"><a href="/crypto/tls/conn_test.go.html#7085214">certificateForName</a></span><span class="op" id="7085556">(</span><span class="string" id="7085557">&#34;example.com&#34;</span><span class="op" id="7085570">)</span><span class="op" id="7085571">)</span><span class="op" id="7085572">;</span>&nbsp;<span class="ident" id="7085574"><a href="/crypto/tls/conn_test.go.html#7085518">n</a></span>&nbsp;<span class="op" id="7085576">!=</span>&nbsp;<span class="num" id="7085579">0</span>&nbsp;<span class="op" id="7085581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085585"><a href="/crypto/tls/conn_test.go.html#7084667">t</a></span><span class="op" id="7085586">.</span><span class="ident" id="7085587">Errorf</span><span class="op" id="7085593">(</span><span class="string" id="7085594">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7085638">,</span>&nbsp;<span class="ident" id="7085640"><a href="/crypto/tls/conn_test.go.html#7085518">n</a></span><span class="op" id="7085641">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085647">if</span>&nbsp;<span class="ident" id="7085650">n</span>&nbsp;<span class="op" id="7085652">:=</span>&nbsp;<span class="ident" id="7085655"><a href="/crypto/tls/conn_test.go.html#7085054">pointerToIndex</a></span><span class="op" id="7085669">(</span><span class="ident" id="7085670"><a href="/crypto/tls/conn_test.go.html#7085214">certificateForName</a></span><span class="op" id="7085688">(</span><span class="string" id="7085689">&#34;bar.example.com&#34;</span><span class="op" id="7085706">)</span><span class="op" id="7085707">)</span><span class="op" id="7085708">;</span>&nbsp;<span class="ident" id="7085710"><a href="/crypto/tls/conn_test.go.html#7085650">n</a></span>&nbsp;<span class="op" id="7085712">!=</span>&nbsp;<span class="num" id="7085715">1</span>&nbsp;<span class="op" id="7085717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085721"><a href="/crypto/tls/conn_test.go.html#7084667">t</a></span><span class="op" id="7085722">.</span><span class="ident" id="7085723">Errorf</span><span class="op" id="7085729">(</span><span class="string" id="7085730">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7085778">,</span>&nbsp;<span class="ident" id="7085780"><a href="/crypto/tls/conn_test.go.html#7085650">n</a></span><span class="op" id="7085781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085787">if</span>&nbsp;<span class="ident" id="7085790">n</span>&nbsp;<span class="op" id="7085792">:=</span>&nbsp;<span class="ident" id="7085795"><a href="/crypto/tls/conn_test.go.html#7085054">pointerToIndex</a></span><span class="op" id="7085809">(</span><span class="ident" id="7085810"><a href="/crypto/tls/conn_test.go.html#7085214">certificateForName</a></span><span class="op" id="7085828">(</span><span class="string" id="7085829">&#34;foo.example.com&#34;</span><span class="op" id="7085846">)</span><span class="op" id="7085847">)</span><span class="op" id="7085848">;</span>&nbsp;<span class="ident" id="7085850"><a href="/crypto/tls/conn_test.go.html#7085790">n</a></span>&nbsp;<span class="op" id="7085852">!=</span>&nbsp;<span class="num" id="7085855">2</span>&nbsp;<span class="op" id="7085857">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085861"><a href="/crypto/tls/conn_test.go.html#7084667">t</a></span><span class="op" id="7085862">.</span><span class="ident" id="7085863">Errorf</span><span class="op" id="7085869">(</span><span class="string" id="7085870">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7085918">,</span>&nbsp;<span class="ident" id="7085920"><a href="/crypto/tls/conn_test.go.html#7085790">n</a></span><span class="op" id="7085921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085927">if</span>&nbsp;<span class="ident" id="7085930">n</span>&nbsp;<span class="op" id="7085932">:=</span>&nbsp;<span class="ident" id="7085935"><a href="/crypto/tls/conn_test.go.html#7085054">pointerToIndex</a></span><span class="op" id="7085949">(</span><span class="ident" id="7085950"><a href="/crypto/tls/conn_test.go.html#7085214">certificateForName</a></span><span class="op" id="7085968">(</span><span class="string" id="7085969">&#34;foo.bar.example.com&#34;</span><span class="op" id="7085990">)</span><span class="op" id="7085991">)</span><span class="op" id="7085992">;</span>&nbsp;<span class="ident" id="7085994"><a href="/crypto/tls/conn_test.go.html#7085930">n</a></span>&nbsp;<span class="op" id="7085996">!=</span>&nbsp;<span class="num" id="7085999">3</span>&nbsp;<span class="op" id="7086001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7086005"><a href="/crypto/tls/conn_test.go.html#7084667">t</a></span><span class="op" id="7086006">.</span><span class="ident" id="7086007">Errorf</span><span class="op" id="7086013">(</span><span class="string" id="7086014">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7086066">,</span>&nbsp;<span class="ident" id="7086068"><a href="/crypto/tls/conn_test.go.html#7085930">n</a></span><span class="op" id="7086069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7086072">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7086075">if</span>&nbsp;<span class="ident" id="7086078">n</span>&nbsp;<span class="op" id="7086080">:=</span>&nbsp;<span class="ident" id="7086083"><a href="/crypto/tls/conn_test.go.html#7085054">pointerToIndex</a></span><span class="op" id="7086097">(</span><span class="ident" id="7086098"><a href="/crypto/tls/conn_test.go.html#7085214">certificateForName</a></span><span class="op" id="7086116">(</span><span class="string" id="7086117">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7086142">)</span><span class="op" id="7086143">)</span><span class="op" id="7086144">;</span>&nbsp;<span class="ident" id="7086146"><a href="/crypto/tls/conn_test.go.html#7086078">n</a></span>&nbsp;<span class="op" id="7086148">!=</span>&nbsp;<span class="num" id="7086151">0</span>&nbsp;<span class="op" id="7086153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7086157"><a href="/crypto/tls/conn_test.go.html#7084667">t</a></span><span class="op" id="7086158">.</span><span class="ident" id="7086159">Errorf</span><span class="op" id="7086165">(</span><span class="string" id="7086166">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7086222">,</span>&nbsp;<span class="ident" id="7086224"><a href="/crypto/tls/conn_test.go.html#7086078">n</a></span><span class="op" id="7086225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7086228">}</span><br>
<span class="lineno"></span><span class="op" id="7086230">}</span>
</div>
</body>
</html>
