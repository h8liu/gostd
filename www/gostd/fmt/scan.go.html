<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2422085">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2422140">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2422194">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2422245">package</span>&nbsp;<span class="ident" id="2422253">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2422258">import</span>&nbsp;<span class="op" id="2422265">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422268">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422278">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422284">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422292">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422298">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422309">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422320">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2422328">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2422343">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2422346">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2422415">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2422482">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2422552">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2422587">type</span>&nbsp;<span class="ident" id="2422592">runeUnreader</span>&nbsp;<span class="keyword" id="2422605">interface</span>&nbsp;<span class="op" id="2422615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422618">UnreadRune</span><span class="op" id="2422628">(</span><span class="op" id="2422629">)</span>&nbsp;<span class="builtintype" id="2422631">error</span><br>
<span class="lineno"></span><span class="op" id="2422637">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2422640">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2422709">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2422773">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2422820">type</span>&nbsp;<span class="ident" id="2422825">ScanState</span>&nbsp;<span class="keyword" id="2422835">interface</span>&nbsp;<span class="op" id="2422845">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2422848">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2422918">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2422985">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423054">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423079">ReadRune</span><span class="op" id="2423087">(</span><span class="op" id="2423088">)</span>&nbsp;<span class="op" id="2423090">(</span><span class="ident" id="2423091">r</span>&nbsp;<span class="builtintype" id="2423093">rune</span><span class="op" id="2423097">,</span>&nbsp;<span class="ident" id="2423099">size</span>&nbsp;<span class="builtintype" id="2423104">int</span><span class="op" id="2423107">,</span>&nbsp;<span class="ident" id="2423109">err</span>&nbsp;<span class="builtintype" id="2423113">error</span><span class="op" id="2423118">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423121">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423194">UnreadRune</span><span class="op" id="2423204">(</span><span class="op" id="2423205">)</span>&nbsp;<span class="builtintype" id="2423207">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423214">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423284">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423359">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423392">SkipSpace</span><span class="op" id="2423401">(</span><span class="op" id="2423402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423405">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423479">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423543">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423615">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423688">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423761">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423836">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423913">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423968">Token</span><span class="op" id="2423973">(</span><span class="ident" id="2423974">skipSpace</span>&nbsp;<span class="builtintype" id="2423984">bool</span><span class="op" id="2423988">,</span>&nbsp;<span class="ident" id="2423990">f</span>&nbsp;<span class="keyword" id="2423992">func</span><span class="op" id="2423996">(</span><span class="builtintype" id="2423997">rune</span><span class="op" id="2424001">)</span>&nbsp;<span class="builtintype" id="2424003">bool</span><span class="op" id="2424007">)</span>&nbsp;<span class="op" id="2424009">(</span><span class="ident" id="2424010">token</span>&nbsp;<span class="op" id="2424016">[</span><span class="op" id="2424017">]</span><span class="builtintype" id="2424018">byte</span><span class="op" id="2424022">,</span>&nbsp;<span class="ident" id="2424024">err</span>&nbsp;<span class="builtintype" id="2424028">error</span><span class="op" id="2424033">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2424036">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2424113">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424150">Width</span><span class="op" id="2424155">(</span><span class="op" id="2424156">)</span>&nbsp;<span class="op" id="2424158">(</span><span class="ident" id="2424159">wid</span>&nbsp;<span class="builtintype" id="2424163">int</span><span class="op" id="2424166">,</span>&nbsp;<span class="ident" id="2424168">ok</span>&nbsp;<span class="builtintype" id="2424171">bool</span><span class="op" id="2424175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2424178">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2424253">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2424319">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424381">Read</span><span class="op" id="2424385">(</span><span class="ident" id="2424386">buf</span>&nbsp;<span class="op" id="2424390">[</span><span class="op" id="2424391">]</span><span class="builtintype" id="2424392">byte</span><span class="op" id="2424396">)</span>&nbsp;<span class="op" id="2424398">(</span><span class="ident" id="2424399">n</span>&nbsp;<span class="builtintype" id="2424401">int</span><span class="op" id="2424404">,</span>&nbsp;<span class="ident" id="2424406">err</span>&nbsp;<span class="builtintype" id="2424410">error</span><span class="op" id="2424415">)</span><br>
<span class="lineno"></span><span class="op" id="2424417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2424420">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2424495">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2424571">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2424649">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2424715">type</span>&nbsp;<span class="ident" id="2424720">Scanner</span>&nbsp;<span class="keyword" id="2424728">interface</span>&nbsp;<span class="op" id="2424738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424741">Scan</span><span class="op" id="2424745">(</span><span class="ident" id="2424746">state</span>&nbsp;<span class="ident" id="2424752">ScanState</span><span class="op" id="2424761">,</span>&nbsp;<span class="ident" id="2424763">verb</span>&nbsp;<span class="builtintype" id="2424768">rune</span><span class="op" id="2424772">)</span>&nbsp;<span class="builtintype" id="2424774">error</span><br>
<span class="lineno">65</span><span class="op" id="2424780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2424783">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2424847">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2424916">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2424983">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2425053">func</span>&nbsp;<span class="ident" id="2425058">Scan</span><span class="op" id="2425062">(</span><span class="ident" id="2425063">a</span>&nbsp;<span class="op" id="2425065">...</span><span class="keyword" id="2425068">interface</span><span class="op" id="2425077">{</span><span class="op" id="2425078">}</span><span class="op" id="2425079">)</span>&nbsp;<span class="op" id="2425081">(</span><span class="ident" id="2425082">n</span>&nbsp;<span class="builtintype" id="2425084">int</span><span class="op" id="2425087">,</span>&nbsp;<span class="ident" id="2425089">err</span>&nbsp;<span class="builtintype" id="2425093">error</span><span class="op" id="2425098">)</span>&nbsp;<span class="op" id="2425100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425103">return</span>&nbsp;<span class="ident" id="2425110">Fscan</span><span class="op" id="2425115">(</span><span class="ident" id="2425116">os</span><span class="op" id="2425118">.</span><span class="ident" id="2425119">Stdin</span><span class="op" id="2425124">,</span>&nbsp;<span class="ident" id="2425126">a</span><span class="op" id="2425127">...</span><span class="op" id="2425130">)</span><br>
<span class="lineno"></span><span class="op" id="2425132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2425135">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2425201">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2425257">func</span>&nbsp;<span class="ident" id="2425262">Scanln</span><span class="op" id="2425268">(</span><span class="ident" id="2425269">a</span>&nbsp;<span class="op" id="2425271">...</span><span class="keyword" id="2425274">interface</span><span class="op" id="2425283">{</span><span class="op" id="2425284">}</span><span class="op" id="2425285">)</span>&nbsp;<span class="op" id="2425287">(</span><span class="ident" id="2425288">n</span>&nbsp;<span class="builtintype" id="2425290">int</span><span class="op" id="2425293">,</span>&nbsp;<span class="ident" id="2425295">err</span>&nbsp;<span class="builtintype" id="2425299">error</span><span class="op" id="2425304">)</span>&nbsp;<span class="op" id="2425306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425309">return</span>&nbsp;<span class="ident" id="2425316">Fscanln</span><span class="op" id="2425323">(</span><span class="ident" id="2425324">os</span><span class="op" id="2425326">.</span><span class="ident" id="2425327">Stdin</span><span class="op" id="2425332">,</span>&nbsp;<span class="ident" id="2425334">a</span><span class="op" id="2425335">...</span><span class="op" id="2425338">)</span><br>
<span class="lineno"></span><span class="op" id="2425340">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2425343">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2425408">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2425477">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2425546">func</span>&nbsp;<span class="ident" id="2425551">Scanf</span><span class="op" id="2425556">(</span><span class="ident" id="2425557">format</span>&nbsp;<span class="builtintype" id="2425564">string</span><span class="op" id="2425570">,</span>&nbsp;<span class="ident" id="2425572">a</span>&nbsp;<span class="op" id="2425574">...</span><span class="keyword" id="2425577">interface</span><span class="op" id="2425586">{</span><span class="op" id="2425587">}</span><span class="op" id="2425588">)</span>&nbsp;<span class="op" id="2425590">(</span><span class="ident" id="2425591">n</span>&nbsp;<span class="builtintype" id="2425593">int</span><span class="op" id="2425596">,</span>&nbsp;<span class="ident" id="2425598">err</span>&nbsp;<span class="builtintype" id="2425602">error</span><span class="op" id="2425607">)</span>&nbsp;<span class="op" id="2425609">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425612">return</span>&nbsp;<span class="ident" id="2425619">Fscanf</span><span class="op" id="2425625">(</span><span class="ident" id="2425626">os</span><span class="op" id="2425628">.</span><span class="ident" id="2425629">Stdin</span><span class="op" id="2425634">,</span>&nbsp;<span class="ident" id="2425636">format</span><span class="op" id="2425642">,</span>&nbsp;<span class="ident" id="2425644">a</span><span class="op" id="2425645">...</span><span class="op" id="2425648">)</span><br>
<span class="lineno"></span><span class="op" id="2425650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2425653">type</span>&nbsp;<span class="ident" id="2425658">stringReader</span>&nbsp;<span class="builtintype" id="2425671">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2425679">func</span>&nbsp;<span class="op" id="2425684">(</span><span class="ident" id="2425685">r</span>&nbsp;<span class="op" id="2425687">*</span><span class="ident" id="2425688">stringReader</span><span class="op" id="2425700">)</span>&nbsp;<span class="ident" id="2425702">Read</span><span class="op" id="2425706">(</span><span class="ident" id="2425707">b</span>&nbsp;<span class="op" id="2425709">[</span><span class="op" id="2425710">]</span><span class="builtintype" id="2425711">byte</span><span class="op" id="2425715">)</span>&nbsp;<span class="op" id="2425717">(</span><span class="ident" id="2425718">n</span>&nbsp;<span class="builtintype" id="2425720">int</span><span class="op" id="2425723">,</span>&nbsp;<span class="ident" id="2425725">err</span>&nbsp;<span class="builtintype" id="2425729">error</span><span class="op" id="2425734">)</span>&nbsp;<span class="op" id="2425736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425739">n</span>&nbsp;<span class="op" id="2425741">=</span>&nbsp;<span class="builtinfunc" id="2425743">copy</span><span class="op" id="2425747">(</span><span class="ident" id="2425748">b</span><span class="op" id="2425749">,</span>&nbsp;<span class="op" id="2425751">*</span><span class="ident" id="2425752">r</span><span class="op" id="2425753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425756">*</span><span class="ident" id="2425757">r</span>&nbsp;<span class="op" id="2425759">=</span>&nbsp;<span class="op" id="2425761">(</span><span class="op" id="2425762">*</span><span class="ident" id="2425763">r</span><span class="op" id="2425764">)</span><span class="op" id="2425765">[</span><span class="ident" id="2425766">n</span><span class="op" id="2425767">:</span><span class="op" id="2425768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425771">if</span>&nbsp;<span class="ident" id="2425774">n</span>&nbsp;<span class="op" id="2425776">==</span>&nbsp;<span class="num" id="2425779">0</span>&nbsp;<span class="op" id="2425781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425785">err</span>&nbsp;<span class="op" id="2425789">=</span>&nbsp;<span class="ident" id="2425791">io</span><span class="op" id="2425793">.</span><span class="ident" id="2425794">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425802">return</span><br>
<span class="lineno"></span><span class="op" id="2425809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2425812">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2425883">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2425950">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2426020">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2426074">func</span>&nbsp;<span class="ident" id="2426079">Sscan</span><span class="op" id="2426084">(</span><span class="ident" id="2426085">str</span>&nbsp;<span class="builtintype" id="2426089">string</span><span class="op" id="2426095">,</span>&nbsp;<span class="ident" id="2426097">a</span>&nbsp;<span class="op" id="2426099">...</span><span class="keyword" id="2426102">interface</span><span class="op" id="2426111">{</span><span class="op" id="2426112">}</span><span class="op" id="2426113">)</span>&nbsp;<span class="op" id="2426115">(</span><span class="ident" id="2426116">n</span>&nbsp;<span class="builtintype" id="2426118">int</span><span class="op" id="2426121">,</span>&nbsp;<span class="ident" id="2426123">err</span>&nbsp;<span class="builtintype" id="2426127">error</span><span class="op" id="2426132">)</span>&nbsp;<span class="op" id="2426134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426137">return</span>&nbsp;<span class="ident" id="2426144">Fscan</span><span class="op" id="2426149">(</span><span class="op" id="2426150">(</span><span class="op" id="2426151">*</span><span class="ident" id="2426152">stringReader</span><span class="op" id="2426164">)</span><span class="op" id="2426165">(</span><span class="op" id="2426166">&amp;</span><span class="ident" id="2426167">str</span><span class="op" id="2426170">)</span><span class="op" id="2426171">,</span>&nbsp;<span class="ident" id="2426173">a</span><span class="op" id="2426174">...</span><span class="op" id="2426177">)</span><br>
<span class="lineno">105</span><span class="op" id="2426179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2426182">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2426250">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2426306">func</span>&nbsp;<span class="ident" id="2426311">Sscanln</span><span class="op" id="2426318">(</span><span class="ident" id="2426319">str</span>&nbsp;<span class="builtintype" id="2426323">string</span><span class="op" id="2426329">,</span>&nbsp;<span class="ident" id="2426331">a</span>&nbsp;<span class="op" id="2426333">...</span><span class="keyword" id="2426336">interface</span><span class="op" id="2426345">{</span><span class="op" id="2426346">}</span><span class="op" id="2426347">)</span>&nbsp;<span class="op" id="2426349">(</span><span class="ident" id="2426350">n</span>&nbsp;<span class="builtintype" id="2426352">int</span><span class="op" id="2426355">,</span>&nbsp;<span class="ident" id="2426357">err</span>&nbsp;<span class="builtintype" id="2426361">error</span><span class="op" id="2426366">)</span>&nbsp;<span class="op" id="2426368">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426371">return</span>&nbsp;<span class="ident" id="2426378">Fscanln</span><span class="op" id="2426385">(</span><span class="op" id="2426386">(</span><span class="op" id="2426387">*</span><span class="ident" id="2426388">stringReader</span><span class="op" id="2426400">)</span><span class="op" id="2426401">(</span><span class="op" id="2426402">&amp;</span><span class="ident" id="2426403">str</span><span class="op" id="2426406">)</span><span class="op" id="2426407">,</span>&nbsp;<span class="ident" id="2426409">a</span><span class="op" id="2426410">...</span><span class="op" id="2426413">)</span><br>
<span class="lineno"></span><span class="op" id="2426415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2426418">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2426490">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2426559">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2426611">func</span>&nbsp;<span class="ident" id="2426616">Sscanf</span><span class="op" id="2426622">(</span><span class="ident" id="2426623">str</span>&nbsp;<span class="builtintype" id="2426627">string</span><span class="op" id="2426633">,</span>&nbsp;<span class="ident" id="2426635">format</span>&nbsp;<span class="builtintype" id="2426642">string</span><span class="op" id="2426648">,</span>&nbsp;<span class="ident" id="2426650">a</span>&nbsp;<span class="op" id="2426652">...</span><span class="keyword" id="2426655">interface</span><span class="op" id="2426664">{</span><span class="op" id="2426665">}</span><span class="op" id="2426666">)</span>&nbsp;<span class="op" id="2426668">(</span><span class="ident" id="2426669">n</span>&nbsp;<span class="builtintype" id="2426671">int</span><span class="op" id="2426674">,</span>&nbsp;<span class="ident" id="2426676">err</span>&nbsp;<span class="builtintype" id="2426680">error</span><span class="op" id="2426685">)</span>&nbsp;<span class="op" id="2426687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426690">return</span>&nbsp;<span class="ident" id="2426697">Fscanf</span><span class="op" id="2426703">(</span><span class="op" id="2426704">(</span><span class="op" id="2426705">*</span><span class="ident" id="2426706">stringReader</span><span class="op" id="2426718">)</span><span class="op" id="2426719">(</span><span class="op" id="2426720">&amp;</span><span class="ident" id="2426721">str</span><span class="op" id="2426724">)</span><span class="op" id="2426725">,</span>&nbsp;<span class="ident" id="2426727">format</span><span class="op" id="2426733">,</span>&nbsp;<span class="ident" id="2426735">a</span><span class="op" id="2426736">...</span><span class="op" id="2426739">)</span><br>
<span class="lineno"></span><span class="op" id="2426741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2426744">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2426812">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2426879">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2426949">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2427003">func</span>&nbsp;<span class="ident" id="2427008">Fscan</span><span class="op" id="2427013">(</span><span class="ident" id="2427014">r</span>&nbsp;<span class="ident" id="2427016">io</span><span class="op" id="2427018">.</span><span class="ident" id="2427019">Reader</span><span class="op" id="2427025">,</span>&nbsp;<span class="ident" id="2427027">a</span>&nbsp;<span class="op" id="2427029">...</span><span class="keyword" id="2427032">interface</span><span class="op" id="2427041">{</span><span class="op" id="2427042">}</span><span class="op" id="2427043">)</span>&nbsp;<span class="op" id="2427045">(</span><span class="ident" id="2427046">n</span>&nbsp;<span class="builtintype" id="2427048">int</span><span class="op" id="2427051">,</span>&nbsp;<span class="ident" id="2427053">err</span>&nbsp;<span class="builtintype" id="2427057">error</span><span class="op" id="2427062">)</span>&nbsp;<span class="op" id="2427064">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427067">s</span><span class="op" id="2427068">,</span>&nbsp;<span class="ident" id="2427070">old</span>&nbsp;<span class="op" id="2427074">:=</span>&nbsp;<span class="ident" id="2427077">newScanState</span><span class="op" id="2427089">(</span><span class="ident" id="2427090">r</span><span class="op" id="2427091">,</span>&nbsp;<span class="builtintype" id="2427093">true</span><span class="op" id="2427097">,</span>&nbsp;<span class="builtintype" id="2427099">false</span><span class="op" id="2427104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427107">n</span><span class="op" id="2427108">,</span>&nbsp;<span class="ident" id="2427110">err</span>&nbsp;<span class="op" id="2427114">=</span>&nbsp;<span class="ident" id="2427116">s</span><span class="op" id="2427117">.</span><span class="ident" id="2427118">doScan</span><span class="op" id="2427124">(</span><span class="ident" id="2427125">a</span><span class="op" id="2427126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427129">s</span><span class="op" id="2427130">.</span><span class="ident" id="2427131">free</span><span class="op" id="2427135">(</span><span class="ident" id="2427136">old</span><span class="op" id="2427139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427142">return</span><br>
<span class="lineno"></span><span class="op" id="2427149">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2427152">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2427220">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2427276">func</span>&nbsp;<span class="ident" id="2427281">Fscanln</span><span class="op" id="2427288">(</span><span class="ident" id="2427289">r</span>&nbsp;<span class="ident" id="2427291">io</span><span class="op" id="2427293">.</span><span class="ident" id="2427294">Reader</span><span class="op" id="2427300">,</span>&nbsp;<span class="ident" id="2427302">a</span>&nbsp;<span class="op" id="2427304">...</span><span class="keyword" id="2427307">interface</span><span class="op" id="2427316">{</span><span class="op" id="2427317">}</span><span class="op" id="2427318">)</span>&nbsp;<span class="op" id="2427320">(</span><span class="ident" id="2427321">n</span>&nbsp;<span class="builtintype" id="2427323">int</span><span class="op" id="2427326">,</span>&nbsp;<span class="ident" id="2427328">err</span>&nbsp;<span class="builtintype" id="2427332">error</span><span class="op" id="2427337">)</span>&nbsp;<span class="op" id="2427339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427342">s</span><span class="op" id="2427343">,</span>&nbsp;<span class="ident" id="2427345">old</span>&nbsp;<span class="op" id="2427349">:=</span>&nbsp;<span class="ident" id="2427352">newScanState</span><span class="op" id="2427364">(</span><span class="ident" id="2427365">r</span><span class="op" id="2427366">,</span>&nbsp;<span class="builtintype" id="2427368">false</span><span class="op" id="2427373">,</span>&nbsp;<span class="builtintype" id="2427375">true</span><span class="op" id="2427379">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427382">n</span><span class="op" id="2427383">,</span>&nbsp;<span class="ident" id="2427385">err</span>&nbsp;<span class="op" id="2427389">=</span>&nbsp;<span class="ident" id="2427391">s</span><span class="op" id="2427392">.</span><span class="ident" id="2427393">doScan</span><span class="op" id="2427399">(</span><span class="ident" id="2427400">a</span><span class="op" id="2427401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427404">s</span><span class="op" id="2427405">.</span><span class="ident" id="2427406">free</span><span class="op" id="2427410">(</span><span class="ident" id="2427411">old</span><span class="op" id="2427414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427417">return</span><br>
<span class="lineno"></span><span class="op" id="2427424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2427427">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2427496">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2427565">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2427617">func</span>&nbsp;<span class="ident" id="2427622">Fscanf</span><span class="op" id="2427628">(</span><span class="ident" id="2427629">r</span>&nbsp;<span class="ident" id="2427631">io</span><span class="op" id="2427633">.</span><span class="ident" id="2427634">Reader</span><span class="op" id="2427640">,</span>&nbsp;<span class="ident" id="2427642">format</span>&nbsp;<span class="builtintype" id="2427649">string</span><span class="op" id="2427655">,</span>&nbsp;<span class="ident" id="2427657">a</span>&nbsp;<span class="op" id="2427659">...</span><span class="keyword" id="2427662">interface</span><span class="op" id="2427671">{</span><span class="op" id="2427672">}</span><span class="op" id="2427673">)</span>&nbsp;<span class="op" id="2427675">(</span><span class="ident" id="2427676">n</span>&nbsp;<span class="builtintype" id="2427678">int</span><span class="op" id="2427681">,</span>&nbsp;<span class="ident" id="2427683">err</span>&nbsp;<span class="builtintype" id="2427687">error</span><span class="op" id="2427692">)</span>&nbsp;<span class="op" id="2427694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427697">s</span><span class="op" id="2427698">,</span>&nbsp;<span class="ident" id="2427700">old</span>&nbsp;<span class="op" id="2427704">:=</span>&nbsp;<span class="ident" id="2427707">newScanState</span><span class="op" id="2427719">(</span><span class="ident" id="2427720">r</span><span class="op" id="2427721">,</span>&nbsp;<span class="builtintype" id="2427723">false</span><span class="op" id="2427728">,</span>&nbsp;<span class="builtintype" id="2427730">false</span><span class="op" id="2427735">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427738">n</span><span class="op" id="2427739">,</span>&nbsp;<span class="ident" id="2427741">err</span>&nbsp;<span class="op" id="2427745">=</span>&nbsp;<span class="ident" id="2427747">s</span><span class="op" id="2427748">.</span><span class="ident" id="2427749">doScanf</span><span class="op" id="2427756">(</span><span class="ident" id="2427757">format</span><span class="op" id="2427763">,</span>&nbsp;<span class="ident" id="2427765">a</span><span class="op" id="2427766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427769">s</span><span class="op" id="2427770">.</span><span class="ident" id="2427771">free</span><span class="op" id="2427775">(</span><span class="ident" id="2427776">old</span><span class="op" id="2427779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427782">return</span><br>
<span class="lineno"></span><span class="op" id="2427789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2427792">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2427861">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2427937">type</span>&nbsp;<span class="ident" id="2427942">scanError</span>&nbsp;<span class="keyword" id="2427952">struct</span>&nbsp;<span class="op" id="2427959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427962">err</span>&nbsp;<span class="builtintype" id="2427966">error</span><br>
<span class="lineno"></span><span class="op" id="2427972">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2427975">const</span>&nbsp;<span class="ident" id="2427981">eof</span>&nbsp;<span class="op" id="2427985">=</span>&nbsp;<span class="op" id="2427987">-</span><span class="num" id="2427988">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2427991">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2428042">type</span>&nbsp;<span class="ident" id="2428047">ss</span>&nbsp;<span class="keyword" id="2428050">struct</span>&nbsp;<span class="op" id="2428057">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428060">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2428069">io</span><span class="op" id="2428071">.</span><span class="ident" id="2428072">RuneReader</span>&nbsp;<span class="comment" id="2428083">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428107">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2428116">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2428130">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428152">peekRune</span>&nbsp;<span class="builtintype" id="2428161">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2428175">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428198">prevRune</span>&nbsp;<span class="builtintype" id="2428207">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2428221">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428256">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2428265">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2428279">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428306">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2428315">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2428329">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428350">ssave</span><br>
<span class="lineno"></span><span class="op" id="2428356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2428359">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2428406">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2428448">type</span>&nbsp;<span class="ident" id="2428453">ssave</span>&nbsp;<span class="keyword" id="2428459">struct</span>&nbsp;<span class="op" id="2428466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428469">validSave</span>&nbsp;<span class="builtintype" id="2428479">bool</span>&nbsp;<span class="comment" id="2428484">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428522">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2428532">bool</span>&nbsp;<span class="comment" id="2428537">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428573">nlIsSpace</span>&nbsp;<span class="builtintype" id="2428583">bool</span>&nbsp;<span class="comment" id="2428588">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428630">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2428640">int</span>&nbsp;&nbsp;<span class="comment" id="2428645">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428703">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2428713">int</span>&nbsp;&nbsp;<span class="comment" id="2428718">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428745">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2428755">int</span>&nbsp;&nbsp;<span class="comment" id="2428760">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2428782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2428785">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2428843">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2428904">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2428963">func</span>&nbsp;<span class="op" id="2428968">(</span><span class="ident" id="2428969">s</span>&nbsp;<span class="op" id="2428971">*</span><span class="ident" id="2428972">ss</span><span class="op" id="2428974">)</span>&nbsp;<span class="ident" id="2428976">Read</span><span class="op" id="2428980">(</span><span class="ident" id="2428981">buf</span>&nbsp;<span class="op" id="2428985">[</span><span class="op" id="2428986">]</span><span class="builtintype" id="2428987">byte</span><span class="op" id="2428991">)</span>&nbsp;<span class="op" id="2428993">(</span><span class="ident" id="2428994">n</span>&nbsp;<span class="builtintype" id="2428996">int</span><span class="op" id="2428999">,</span>&nbsp;<span class="ident" id="2429001">err</span>&nbsp;<span class="builtintype" id="2429005">error</span><span class="op" id="2429010">)</span>&nbsp;<span class="op" id="2429012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429015">return</span>&nbsp;<span class="num" id="2429022">0</span><span class="op" id="2429023">,</span>&nbsp;<span class="ident" id="2429025">errors</span><span class="op" id="2429031">.</span><span class="ident" id="2429032">New</span><span class="op" id="2429035">(</span><span class="string" id="2429036">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2429089">)</span><br>
<span class="lineno">185</span><span class="op" id="2429091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2429094">func</span>&nbsp;<span class="op" id="2429099">(</span><span class="ident" id="2429100">s</span>&nbsp;<span class="op" id="2429102">*</span><span class="ident" id="2429103">ss</span><span class="op" id="2429105">)</span>&nbsp;<span class="ident" id="2429107">ReadRune</span><span class="op" id="2429115">(</span><span class="op" id="2429116">)</span>&nbsp;<span class="op" id="2429118">(</span><span class="ident" id="2429119">r</span>&nbsp;<span class="builtintype" id="2429121">rune</span><span class="op" id="2429125">,</span>&nbsp;<span class="ident" id="2429127">size</span>&nbsp;<span class="builtintype" id="2429132">int</span><span class="op" id="2429135">,</span>&nbsp;<span class="ident" id="2429137">err</span>&nbsp;<span class="builtintype" id="2429141">error</span><span class="op" id="2429146">)</span>&nbsp;<span class="op" id="2429148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429151">if</span>&nbsp;<span class="ident" id="2429154">s</span><span class="op" id="2429155">.</span><span class="ident" id="2429156">peekRune</span>&nbsp;<span class="op" id="2429165">&gt;=</span>&nbsp;<span class="num" id="2429168">0</span>&nbsp;<span class="op" id="2429170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429174">s</span><span class="op" id="2429175">.</span><span class="ident" id="2429176">count</span><span class="op" id="2429181">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429186">r</span>&nbsp;<span class="op" id="2429188">=</span>&nbsp;<span class="ident" id="2429190">s</span><span class="op" id="2429191">.</span><span class="ident" id="2429192">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429203">size</span>&nbsp;<span class="op" id="2429208">=</span>&nbsp;<span class="ident" id="2429210">utf8</span><span class="op" id="2429214">.</span><span class="ident" id="2429215">RuneLen</span><span class="op" id="2429222">(</span><span class="ident" id="2429223">r</span><span class="op" id="2429224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429228">s</span><span class="op" id="2429229">.</span><span class="ident" id="2429230">prevRune</span>&nbsp;<span class="op" id="2429239">=</span>&nbsp;<span class="ident" id="2429241">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429245">s</span><span class="op" id="2429246">.</span><span class="ident" id="2429247">peekRune</span>&nbsp;<span class="op" id="2429256">=</span>&nbsp;<span class="op" id="2429258">-</span><span class="num" id="2429259">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429263">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429274">if</span>&nbsp;<span class="ident" id="2429277">s</span><span class="op" id="2429278">.</span><span class="ident" id="2429279">atEOF</span>&nbsp;<span class="op" id="2429285">||</span>&nbsp;<span class="ident" id="2429288">s</span><span class="op" id="2429289">.</span><span class="ident" id="2429290">nlIsEnd</span>&nbsp;<span class="op" id="2429298">&amp;&amp;</span>&nbsp;<span class="ident" id="2429301">s</span><span class="op" id="2429302">.</span><span class="ident" id="2429303">prevRune</span>&nbsp;<span class="op" id="2429312">==</span>&nbsp;<span class="string" id="2429315">&#39;\n&#39;</span>&nbsp;<span class="op" id="2429320">||</span>&nbsp;<span class="ident" id="2429323">s</span><span class="op" id="2429324">.</span><span class="ident" id="2429325">count</span>&nbsp;<span class="op" id="2429331">&gt;=</span>&nbsp;<span class="ident" id="2429334">s</span><span class="op" id="2429335">.</span><span class="ident" id="2429336">argLimit</span>&nbsp;<span class="op" id="2429345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429349">err</span>&nbsp;<span class="op" id="2429353">=</span>&nbsp;<span class="ident" id="2429355">io</span><span class="op" id="2429357">.</span><span class="ident" id="2429358">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429364">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429372">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429376">r</span><span class="op" id="2429377">,</span>&nbsp;<span class="ident" id="2429379">size</span><span class="op" id="2429383">,</span>&nbsp;<span class="ident" id="2429385">err</span>&nbsp;<span class="op" id="2429389">=</span>&nbsp;<span class="ident" id="2429391">s</span><span class="op" id="2429392">.</span><span class="ident" id="2429393">rr</span><span class="op" id="2429395">.</span><span class="ident" id="2429396">ReadRune</span><span class="op" id="2429404">(</span><span class="op" id="2429405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429408">if</span>&nbsp;<span class="ident" id="2429411">err</span>&nbsp;<span class="op" id="2429415">==</span>&nbsp;<span class="ident" id="2429418">nil</span>&nbsp;<span class="op" id="2429422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429426">s</span><span class="op" id="2429427">.</span><span class="ident" id="2429428">count</span><span class="op" id="2429433">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429438">s</span><span class="op" id="2429439">.</span><span class="ident" id="2429440">prevRune</span>&nbsp;<span class="op" id="2429449">=</span>&nbsp;<span class="ident" id="2429451">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429454">}</span>&nbsp;<span class="keyword" id="2429456">else</span>&nbsp;<span class="keyword" id="2429461">if</span>&nbsp;<span class="ident" id="2429464">err</span>&nbsp;<span class="op" id="2429468">==</span>&nbsp;<span class="ident" id="2429471">io</span><span class="op" id="2429473">.</span><span class="ident" id="2429474">EOF</span>&nbsp;<span class="op" id="2429478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429482">s</span><span class="op" id="2429483">.</span><span class="ident" id="2429484">atEOF</span>&nbsp;<span class="op" id="2429490">=</span>&nbsp;<span class="builtintype" id="2429492">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429501">return</span><br>
<span class="lineno"></span><span class="op" id="2429508">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2429511">func</span>&nbsp;<span class="op" id="2429516">(</span><span class="ident" id="2429517">s</span>&nbsp;<span class="op" id="2429519">*</span><span class="ident" id="2429520">ss</span><span class="op" id="2429522">)</span>&nbsp;<span class="ident" id="2429524">Width</span><span class="op" id="2429529">(</span><span class="op" id="2429530">)</span>&nbsp;<span class="op" id="2429532">(</span><span class="ident" id="2429533">wid</span>&nbsp;<span class="builtintype" id="2429537">int</span><span class="op" id="2429540">,</span>&nbsp;<span class="ident" id="2429542">ok</span>&nbsp;<span class="builtintype" id="2429545">bool</span><span class="op" id="2429549">)</span>&nbsp;<span class="op" id="2429551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429554">if</span>&nbsp;<span class="ident" id="2429557">s</span><span class="op" id="2429558">.</span><span class="ident" id="2429559">maxWid</span>&nbsp;<span class="op" id="2429566">==</span>&nbsp;<span class="ident" id="2429569">hugeWid</span>&nbsp;<span class="op" id="2429577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429581">return</span>&nbsp;<span class="num" id="2429588">0</span><span class="op" id="2429589">,</span>&nbsp;<span class="builtintype" id="2429591">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429598">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429601">return</span>&nbsp;<span class="ident" id="2429608">s</span><span class="op" id="2429609">.</span><span class="ident" id="2429610">maxWid</span><span class="op" id="2429616">,</span>&nbsp;<span class="builtintype" id="2429618">true</span><br>
<span class="lineno"></span><span class="op" id="2429623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2429626">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2429690">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2429747">func</span>&nbsp;<span class="op" id="2429752">(</span><span class="ident" id="2429753">s</span>&nbsp;<span class="op" id="2429755">*</span><span class="ident" id="2429756">ss</span><span class="op" id="2429758">)</span>&nbsp;<span class="ident" id="2429760">getRune</span><span class="op" id="2429767">(</span><span class="op" id="2429768">)</span>&nbsp;<span class="op" id="2429770">(</span><span class="ident" id="2429771">r</span>&nbsp;<span class="builtintype" id="2429773">rune</span><span class="op" id="2429777">)</span>&nbsp;<span class="op" id="2429779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429782">r</span><span class="op" id="2429783">,</span>&nbsp;<span class="ident" id="2429785">_</span><span class="op" id="2429786">,</span>&nbsp;<span class="ident" id="2429788">err</span>&nbsp;<span class="op" id="2429792">:=</span>&nbsp;<span class="ident" id="2429795">s</span><span class="op" id="2429796">.</span><span class="ident" id="2429797">ReadRune</span><span class="op" id="2429805">(</span><span class="op" id="2429806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429809">if</span>&nbsp;<span class="ident" id="2429812">err</span>&nbsp;<span class="op" id="2429816">!=</span>&nbsp;<span class="ident" id="2429819">nil</span>&nbsp;<span class="op" id="2429823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429827">if</span>&nbsp;<span class="ident" id="2429830">err</span>&nbsp;<span class="op" id="2429834">==</span>&nbsp;<span class="ident" id="2429837">io</span><span class="op" id="2429839">.</span><span class="ident" id="2429840">EOF</span>&nbsp;<span class="op" id="2429844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429849">return</span>&nbsp;<span class="ident" id="2429856">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429866">s</span><span class="op" id="2429867">.</span><span class="builtintype" id="2429868">error</span><span class="op" id="2429873">(</span><span class="ident" id="2429874">err</span><span class="op" id="2429877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429883">return</span><br>
<span class="lineno"></span><span class="op" id="2429890">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2429893">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2429957">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2430024">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2430041">func</span>&nbsp;<span class="op" id="2430046">(</span><span class="ident" id="2430047">s</span>&nbsp;<span class="op" id="2430049">*</span><span class="ident" id="2430050">ss</span><span class="op" id="2430052">)</span>&nbsp;<span class="ident" id="2430054">mustReadRune</span><span class="op" id="2430066">(</span><span class="op" id="2430067">)</span>&nbsp;<span class="op" id="2430069">(</span><span class="ident" id="2430070">r</span>&nbsp;<span class="builtintype" id="2430072">rune</span><span class="op" id="2430076">)</span>&nbsp;<span class="op" id="2430078">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430081">r</span>&nbsp;<span class="op" id="2430083">=</span>&nbsp;<span class="ident" id="2430085">s</span><span class="op" id="2430086">.</span><span class="ident" id="2430087">getRune</span><span class="op" id="2430094">(</span><span class="op" id="2430095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430098">if</span>&nbsp;<span class="ident" id="2430101">r</span>&nbsp;<span class="op" id="2430103">==</span>&nbsp;<span class="ident" id="2430106">eof</span>&nbsp;<span class="op" id="2430110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430114">s</span><span class="op" id="2430115">.</span><span class="builtintype" id="2430116">error</span><span class="op" id="2430121">(</span><span class="ident" id="2430122">io</span><span class="op" id="2430124">.</span><span class="ident" id="2430125">ErrUnexpectedEOF</span><span class="op" id="2430141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430147">return</span><br>
<span class="lineno">240</span><span class="op" id="2430154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2430157">func</span>&nbsp;<span class="op" id="2430162">(</span><span class="ident" id="2430163">s</span>&nbsp;<span class="op" id="2430165">*</span><span class="ident" id="2430166">ss</span><span class="op" id="2430168">)</span>&nbsp;<span class="ident" id="2430170">UnreadRune</span><span class="op" id="2430180">(</span><span class="op" id="2430181">)</span>&nbsp;<span class="builtintype" id="2430183">error</span>&nbsp;<span class="op" id="2430189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430192">if</span>&nbsp;<span class="ident" id="2430195">u</span><span class="op" id="2430196">,</span>&nbsp;<span class="ident" id="2430198">ok</span>&nbsp;<span class="op" id="2430201">:=</span>&nbsp;<span class="ident" id="2430204">s</span><span class="op" id="2430205">.</span><span class="ident" id="2430206">rr</span><span class="op" id="2430208">.</span><span class="op" id="2430209">(</span><span class="ident" id="2430210">runeUnreader</span><span class="op" id="2430222">)</span><span class="op" id="2430223">;</span>&nbsp;<span class="ident" id="2430225">ok</span>&nbsp;<span class="op" id="2430228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430232">u</span><span class="op" id="2430233">.</span><span class="ident" id="2430234">UnreadRune</span><span class="op" id="2430244">(</span><span class="op" id="2430245">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430248">}</span>&nbsp;<span class="keyword" id="2430250">else</span>&nbsp;<span class="op" id="2430255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430259">s</span><span class="op" id="2430260">.</span><span class="ident" id="2430261">peekRune</span>&nbsp;<span class="op" id="2430270">=</span>&nbsp;<span class="ident" id="2430272">s</span><span class="op" id="2430273">.</span><span class="ident" id="2430274">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430287">s</span><span class="op" id="2430288">.</span><span class="ident" id="2430289">prevRune</span>&nbsp;<span class="op" id="2430298">=</span>&nbsp;<span class="op" id="2430300">-</span><span class="num" id="2430301">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430304">s</span><span class="op" id="2430305">.</span><span class="ident" id="2430306">count</span><span class="op" id="2430311">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430315">return</span>&nbsp;<span class="ident" id="2430322">nil</span><br>
<span class="lineno"></span><span class="op" id="2430326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2430329">func</span>&nbsp;<span class="op" id="2430334">(</span><span class="ident" id="2430335">s</span>&nbsp;<span class="op" id="2430337">*</span><span class="ident" id="2430338">ss</span><span class="op" id="2430340">)</span>&nbsp;<span class="builtintype" id="2430342">error</span><span class="op" id="2430347">(</span><span class="ident" id="2430348">err</span>&nbsp;<span class="builtintype" id="2430352">error</span><span class="op" id="2430357">)</span>&nbsp;<span class="op" id="2430359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2430362">panic</span><span class="op" id="2430367">(</span><span class="ident" id="2430368">scanError</span><span class="op" id="2430377">{</span><span class="ident" id="2430378">err</span><span class="op" id="2430381">}</span><span class="op" id="2430382">)</span><br>
<span class="lineno">255</span><span class="op" id="2430384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2430387">func</span>&nbsp;<span class="op" id="2430392">(</span><span class="ident" id="2430393">s</span>&nbsp;<span class="op" id="2430395">*</span><span class="ident" id="2430396">ss</span><span class="op" id="2430398">)</span>&nbsp;<span class="ident" id="2430400">errorString</span><span class="op" id="2430411">(</span><span class="ident" id="2430412">err</span>&nbsp;<span class="builtintype" id="2430416">string</span><span class="op" id="2430422">)</span>&nbsp;<span class="op" id="2430424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2430427">panic</span><span class="op" id="2430432">(</span><span class="ident" id="2430433">scanError</span><span class="op" id="2430442">{</span><span class="ident" id="2430443">errors</span><span class="op" id="2430449">.</span><span class="ident" id="2430450">New</span><span class="op" id="2430453">(</span><span class="ident" id="2430454">err</span><span class="op" id="2430457">)</span><span class="op" id="2430458">}</span><span class="op" id="2430459">)</span><br>
<span class="lineno"></span><span class="op" id="2430461">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2430464">func</span>&nbsp;<span class="op" id="2430469">(</span><span class="ident" id="2430470">s</span>&nbsp;<span class="op" id="2430472">*</span><span class="ident" id="2430473">ss</span><span class="op" id="2430475">)</span>&nbsp;<span class="ident" id="2430477">Token</span><span class="op" id="2430482">(</span><span class="ident" id="2430483">skipSpace</span>&nbsp;<span class="builtintype" id="2430493">bool</span><span class="op" id="2430497">,</span>&nbsp;<span class="ident" id="2430499">f</span>&nbsp;<span class="keyword" id="2430501">func</span><span class="op" id="2430505">(</span><span class="builtintype" id="2430506">rune</span><span class="op" id="2430510">)</span>&nbsp;<span class="builtintype" id="2430512">bool</span><span class="op" id="2430516">)</span>&nbsp;<span class="op" id="2430518">(</span><span class="ident" id="2430519">tok</span>&nbsp;<span class="op" id="2430523">[</span><span class="op" id="2430524">]</span><span class="builtintype" id="2430525">byte</span><span class="op" id="2430529">,</span>&nbsp;<span class="ident" id="2430531">err</span>&nbsp;<span class="builtintype" id="2430535">error</span><span class="op" id="2430540">)</span>&nbsp;<span class="op" id="2430542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430545">defer</span>&nbsp;<span class="keyword" id="2430551">func</span><span class="op" id="2430555">(</span><span class="op" id="2430556">)</span>&nbsp;<span class="op" id="2430558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430562">if</span>&nbsp;<span class="ident" id="2430565">e</span>&nbsp;<span class="op" id="2430567">:=</span>&nbsp;<span class="builtinfunc" id="2430570">recover</span><span class="op" id="2430577">(</span><span class="op" id="2430578">)</span><span class="op" id="2430579">;</span>&nbsp;<span class="ident" id="2430581">e</span>&nbsp;<span class="op" id="2430583">!=</span>&nbsp;<span class="ident" id="2430586">nil</span>&nbsp;<span class="op" id="2430590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430595">if</span>&nbsp;<span class="ident" id="2430598">se</span><span class="op" id="2430600">,</span>&nbsp;<span class="ident" id="2430602">ok</span>&nbsp;<span class="op" id="2430605">:=</span>&nbsp;<span class="ident" id="2430608">e</span><span class="op" id="2430609">.</span><span class="op" id="2430610">(</span><span class="ident" id="2430611">scanError</span><span class="op" id="2430620">)</span><span class="op" id="2430621">;</span>&nbsp;<span class="ident" id="2430623">ok</span>&nbsp;<span class="op" id="2430626">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430632">err</span>&nbsp;<span class="op" id="2430636">=</span>&nbsp;<span class="ident" id="2430638">se</span><span class="op" id="2430640">.</span><span class="ident" id="2430641">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430648">}</span>&nbsp;<span class="keyword" id="2430650">else</span>&nbsp;<span class="op" id="2430655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2430661">panic</span><span class="op" id="2430666">(</span><span class="ident" id="2430667">e</span><span class="op" id="2430668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430677">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430680">}</span><span class="op" id="2430681">(</span><span class="op" id="2430682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430685">if</span>&nbsp;<span class="ident" id="2430688">f</span>&nbsp;<span class="op" id="2430690">==</span>&nbsp;<span class="ident" id="2430693">nil</span>&nbsp;<span class="op" id="2430697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430701">f</span>&nbsp;<span class="op" id="2430703">=</span>&nbsp;<span class="ident" id="2430705">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430718">s</span><span class="op" id="2430719">.</span><span class="ident" id="2430720">buf</span>&nbsp;<span class="op" id="2430724">=</span>&nbsp;<span class="ident" id="2430726">s</span><span class="op" id="2430727">.</span><span class="ident" id="2430728">buf</span><span class="op" id="2430731">[</span><span class="op" id="2430732">:</span><span class="num" id="2430733">0</span><span class="op" id="2430734">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430737">tok</span>&nbsp;<span class="op" id="2430741">=</span>&nbsp;<span class="ident" id="2430743">s</span><span class="op" id="2430744">.</span><span class="ident" id="2430745">token</span><span class="op" id="2430750">(</span><span class="ident" id="2430751">skipSpace</span><span class="op" id="2430760">,</span>&nbsp;<span class="ident" id="2430762">f</span><span class="op" id="2430763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430766">return</span><br>
<span class="lineno"></span><span class="op" id="2430773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2430776">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2430830">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2430872">var</span>&nbsp;<span class="ident" id="2430876">space</span>&nbsp;<span class="op" id="2430882">=</span>&nbsp;<span class="op" id="2430884">[</span><span class="op" id="2430885">]</span><span class="op" id="2430886">[</span><span class="num" id="2430887">2</span><span class="op" id="2430888">]</span><span class="builtintype" id="2430889">uint16</span><span class="op" id="2430895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430898">{</span><span class="num" id="2430899">0x0009</span><span class="op" id="2430905">,</span>&nbsp;<span class="num" id="2430907">0x000d</span><span class="op" id="2430913">}</span><span class="op" id="2430914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430917">{</span><span class="num" id="2430918">0x0020</span><span class="op" id="2430924">,</span>&nbsp;<span class="num" id="2430926">0x0020</span><span class="op" id="2430932">}</span><span class="op" id="2430933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430936">{</span><span class="num" id="2430937">0x0085</span><span class="op" id="2430943">,</span>&nbsp;<span class="num" id="2430945">0x0085</span><span class="op" id="2430951">}</span><span class="op" id="2430952">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430955">{</span><span class="num" id="2430956">0x00a0</span><span class="op" id="2430962">,</span>&nbsp;<span class="num" id="2430964">0x00a0</span><span class="op" id="2430970">}</span><span class="op" id="2430971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430974">{</span><span class="num" id="2430975">0x1680</span><span class="op" id="2430981">,</span>&nbsp;<span class="num" id="2430983">0x1680</span><span class="op" id="2430989">}</span><span class="op" id="2430990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430993">{</span><span class="num" id="2430994">0x2000</span><span class="op" id="2431000">,</span>&nbsp;<span class="num" id="2431002">0x200a</span><span class="op" id="2431008">}</span><span class="op" id="2431009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431012">{</span><span class="num" id="2431013">0x2028</span><span class="op" id="2431019">,</span>&nbsp;<span class="num" id="2431021">0x2029</span><span class="op" id="2431027">}</span><span class="op" id="2431028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431031">{</span><span class="num" id="2431032">0x202f</span><span class="op" id="2431038">,</span>&nbsp;<span class="num" id="2431040">0x202f</span><span class="op" id="2431046">}</span><span class="op" id="2431047">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431050">{</span><span class="num" id="2431051">0x205f</span><span class="op" id="2431057">,</span>&nbsp;<span class="num" id="2431059">0x205f</span><span class="op" id="2431065">}</span><span class="op" id="2431066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431069">{</span><span class="num" id="2431070">0x3000</span><span class="op" id="2431076">,</span>&nbsp;<span class="num" id="2431078">0x3000</span><span class="op" id="2431084">}</span><span class="op" id="2431085">,</span><br>
<span class="lineno"></span><span class="op" id="2431087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2431090">func</span>&nbsp;<span class="ident" id="2431095">isSpace</span><span class="op" id="2431102">(</span><span class="ident" id="2431103">r</span>&nbsp;<span class="builtintype" id="2431105">rune</span><span class="op" id="2431109">)</span>&nbsp;<span class="builtintype" id="2431111">bool</span>&nbsp;<span class="op" id="2431116">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431119">if</span>&nbsp;<span class="ident" id="2431122">r</span>&nbsp;<span class="op" id="2431124">&gt;=</span>&nbsp;<span class="num" id="2431127">1</span><span class="op" id="2431128">&lt;&lt;</span><span class="num" id="2431130">16</span>&nbsp;<span class="op" id="2431133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431137">return</span>&nbsp;<span class="builtintype" id="2431144">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431154">rx</span>&nbsp;<span class="op" id="2431157">:=</span>&nbsp;<span class="builtintype" id="2431160">uint16</span><span class="op" id="2431166">(</span><span class="ident" id="2431167">r</span><span class="op" id="2431168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431171">for</span>&nbsp;<span class="ident" id="2431175">_</span><span class="op" id="2431176">,</span>&nbsp;<span class="ident" id="2431178">rng</span>&nbsp;<span class="op" id="2431182">:=</span>&nbsp;<span class="keyword" id="2431185">range</span>&nbsp;<span class="ident" id="2431191">space</span>&nbsp;<span class="op" id="2431197">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431201">if</span>&nbsp;<span class="ident" id="2431204">rx</span>&nbsp;<span class="op" id="2431207">&lt;</span>&nbsp;<span class="ident" id="2431209">rng</span><span class="op" id="2431212">[</span><span class="num" id="2431213">0</span><span class="op" id="2431214">]</span>&nbsp;<span class="op" id="2431216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431221">return</span>&nbsp;<span class="builtintype" id="2431228">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431240">if</span>&nbsp;<span class="ident" id="2431243">rx</span>&nbsp;<span class="op" id="2431246">&lt;=</span>&nbsp;<span class="ident" id="2431249">rng</span><span class="op" id="2431252">[</span><span class="num" id="2431253">1</span><span class="op" id="2431254">]</span>&nbsp;<span class="op" id="2431256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431261">return</span>&nbsp;<span class="builtintype" id="2431268">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431281">return</span>&nbsp;<span class="builtintype" id="2431288">false</span><br>
<span class="lineno"></span><span class="op" id="2431294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2431297">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2431357">func</span>&nbsp;<span class="ident" id="2431362">notSpace</span><span class="op" id="2431370">(</span><span class="ident" id="2431371">r</span>&nbsp;<span class="builtintype" id="2431373">rune</span><span class="op" id="2431377">)</span>&nbsp;<span class="builtintype" id="2431379">bool</span>&nbsp;<span class="op" id="2431384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431387">return</span>&nbsp;<span class="op" id="2431394">!</span><span class="ident" id="2431395">isSpace</span><span class="op" id="2431402">(</span><span class="ident" id="2431403">r</span><span class="op" id="2431404">)</span><br>
<span class="lineno"></span><span class="op" id="2431406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2431409">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2431482">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2431560">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2431580">func</span>&nbsp;<span class="op" id="2431585">(</span><span class="ident" id="2431586">s</span>&nbsp;<span class="op" id="2431588">*</span><span class="ident" id="2431589">ss</span><span class="op" id="2431591">)</span>&nbsp;<span class="ident" id="2431593">SkipSpace</span><span class="op" id="2431602">(</span><span class="op" id="2431603">)</span>&nbsp;<span class="op" id="2431605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431608">s</span><span class="op" id="2431609">.</span><span class="ident" id="2431610">skipSpace</span><span class="op" id="2431619">(</span><span class="builtintype" id="2431620">false</span><span class="op" id="2431625">)</span><br>
<span class="lineno">320</span><span class="op" id="2431627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2431630">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2431701">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2431775">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2431815">type</span>&nbsp;<span class="ident" id="2431820">readRune</span>&nbsp;<span class="keyword" id="2431829">struct</span>&nbsp;<span class="op" id="2431836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431839">reader</span>&nbsp;&nbsp;<span class="ident" id="2431847">io</span><span class="op" id="2431849">.</span><span class="ident" id="2431850">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431858">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2431866">[</span><span class="ident" id="2431867">utf8</span><span class="op" id="2431871">.</span><span class="ident" id="2431872">UTFMax</span><span class="op" id="2431878">]</span><span class="builtintype" id="2431879">byte</span>&nbsp;<span class="comment" id="2431884">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431914">pending</span>&nbsp;<span class="builtintype" id="2431922">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2431940">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431994">pendBuf</span>&nbsp;<span class="op" id="2432002">[</span><span class="ident" id="2432003">utf8</span><span class="op" id="2432007">.</span><span class="ident" id="2432008">UTFMax</span><span class="op" id="2432014">]</span><span class="builtintype" id="2432015">byte</span>&nbsp;<span class="comment" id="2432020">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2432039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2432042">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2432105">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2432168">func</span>&nbsp;<span class="op" id="2432173">(</span><span class="ident" id="2432174">r</span>&nbsp;<span class="op" id="2432176">*</span><span class="ident" id="2432177">readRune</span><span class="op" id="2432185">)</span>&nbsp;<span class="ident" id="2432187">readByte</span><span class="op" id="2432195">(</span><span class="op" id="2432196">)</span>&nbsp;<span class="op" id="2432198">(</span><span class="ident" id="2432199">b</span>&nbsp;<span class="builtintype" id="2432201">byte</span><span class="op" id="2432205">,</span>&nbsp;<span class="ident" id="2432207">err</span>&nbsp;<span class="builtintype" id="2432211">error</span><span class="op" id="2432216">)</span>&nbsp;<span class="op" id="2432218">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432221">if</span>&nbsp;<span class="ident" id="2432224">r</span><span class="op" id="2432225">.</span><span class="ident" id="2432226">pending</span>&nbsp;<span class="op" id="2432234">&gt;</span>&nbsp;<span class="num" id="2432236">0</span>&nbsp;<span class="op" id="2432238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432242">b</span>&nbsp;<span class="op" id="2432244">=</span>&nbsp;<span class="ident" id="2432246">r</span><span class="op" id="2432247">.</span><span class="ident" id="2432248">pendBuf</span><span class="op" id="2432255">[</span><span class="num" id="2432256">0</span><span class="op" id="2432257">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2432261">copy</span><span class="op" id="2432265">(</span><span class="ident" id="2432266">r</span><span class="op" id="2432267">.</span><span class="ident" id="2432268">pendBuf</span><span class="op" id="2432275">[</span><span class="num" id="2432276">0</span><span class="op" id="2432277">:</span><span class="op" id="2432278">]</span><span class="op" id="2432279">,</span>&nbsp;<span class="ident" id="2432281">r</span><span class="op" id="2432282">.</span><span class="ident" id="2432283">pendBuf</span><span class="op" id="2432290">[</span><span class="num" id="2432291">1</span><span class="op" id="2432292">:</span><span class="op" id="2432293">]</span><span class="op" id="2432294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432298">r</span><span class="op" id="2432299">.</span><span class="ident" id="2432300">pending</span><span class="op" id="2432307">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432312">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432323">n</span><span class="op" id="2432324">,</span>&nbsp;<span class="ident" id="2432326">err</span>&nbsp;<span class="op" id="2432330">:=</span>&nbsp;<span class="ident" id="2432333">io</span><span class="op" id="2432335">.</span><span class="ident" id="2432336">ReadFull</span><span class="op" id="2432344">(</span><span class="ident" id="2432345">r</span><span class="op" id="2432346">.</span><span class="ident" id="2432347">reader</span><span class="op" id="2432353">,</span>&nbsp;<span class="ident" id="2432355">r</span><span class="op" id="2432356">.</span><span class="ident" id="2432357">pendBuf</span><span class="op" id="2432364">[</span><span class="num" id="2432365">0</span><span class="op" id="2432366">:</span><span class="num" id="2432367">1</span><span class="op" id="2432368">]</span><span class="op" id="2432369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432372">if</span>&nbsp;<span class="ident" id="2432375">n</span>&nbsp;<span class="op" id="2432377">!=</span>&nbsp;<span class="num" id="2432380">1</span>&nbsp;<span class="op" id="2432382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432386">return</span>&nbsp;<span class="num" id="2432393">0</span><span class="op" id="2432394">,</span>&nbsp;<span class="ident" id="2432396">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432401">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432404">return</span>&nbsp;<span class="ident" id="2432411">r</span><span class="op" id="2432412">.</span><span class="ident" id="2432413">pendBuf</span><span class="op" id="2432420">[</span><span class="num" id="2432421">0</span><span class="op" id="2432422">]</span><span class="op" id="2432423">,</span>&nbsp;<span class="ident" id="2432425">err</span><br>
<span class="lineno"></span><span class="op" id="2432429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2432432">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2432477">func</span>&nbsp;<span class="op" id="2432482">(</span><span class="ident" id="2432483">r</span>&nbsp;<span class="op" id="2432485">*</span><span class="ident" id="2432486">readRune</span><span class="op" id="2432494">)</span>&nbsp;<span class="ident" id="2432496">unread</span><span class="op" id="2432502">(</span><span class="ident" id="2432503">buf</span>&nbsp;<span class="op" id="2432507">[</span><span class="op" id="2432508">]</span><span class="builtintype" id="2432509">byte</span><span class="op" id="2432513">)</span>&nbsp;<span class="op" id="2432515">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2432518">copy</span><span class="op" id="2432522">(</span><span class="ident" id="2432523">r</span><span class="op" id="2432524">.</span><span class="ident" id="2432525">pendBuf</span><span class="op" id="2432532">[</span><span class="ident" id="2432533">r</span><span class="op" id="2432534">.</span><span class="ident" id="2432535">pending</span><span class="op" id="2432542">:</span><span class="op" id="2432543">]</span><span class="op" id="2432544">,</span>&nbsp;<span class="ident" id="2432546">buf</span><span class="op" id="2432549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432552">r</span><span class="op" id="2432553">.</span><span class="ident" id="2432554">pending</span>&nbsp;<span class="op" id="2432562">+=</span>&nbsp;<span class="builtinfunc" id="2432565">len</span><span class="op" id="2432568">(</span><span class="ident" id="2432569">buf</span><span class="op" id="2432572">)</span><br>
<span class="lineno"></span><span class="op" id="2432574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2432577">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2432640">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2432663">func</span>&nbsp;<span class="op" id="2432668">(</span><span class="ident" id="2432669">r</span>&nbsp;<span class="op" id="2432671">*</span><span class="ident" id="2432672">readRune</span><span class="op" id="2432680">)</span>&nbsp;<span class="ident" id="2432682">ReadRune</span><span class="op" id="2432690">(</span><span class="op" id="2432691">)</span>&nbsp;<span class="op" id="2432693">(</span><span class="ident" id="2432694">rr</span>&nbsp;<span class="builtintype" id="2432697">rune</span><span class="op" id="2432701">,</span>&nbsp;<span class="ident" id="2432703">size</span>&nbsp;<span class="builtintype" id="2432708">int</span><span class="op" id="2432711">,</span>&nbsp;<span class="ident" id="2432713">err</span>&nbsp;<span class="builtintype" id="2432717">error</span><span class="op" id="2432722">)</span>&nbsp;<span class="op" id="2432724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432727">r</span><span class="op" id="2432728">.</span><span class="ident" id="2432729">buf</span><span class="op" id="2432732">[</span><span class="num" id="2432733">0</span><span class="op" id="2432734">]</span><span class="op" id="2432735">,</span>&nbsp;<span class="ident" id="2432737">err</span>&nbsp;<span class="op" id="2432741">=</span>&nbsp;<span class="ident" id="2432743">r</span><span class="op" id="2432744">.</span><span class="ident" id="2432745">readByte</span><span class="op" id="2432753">(</span><span class="op" id="2432754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432757">if</span>&nbsp;<span class="ident" id="2432760">err</span>&nbsp;<span class="op" id="2432764">!=</span>&nbsp;<span class="ident" id="2432767">nil</span>&nbsp;<span class="op" id="2432771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432775">return</span>&nbsp;<span class="num" id="2432782">0</span><span class="op" id="2432783">,</span>&nbsp;<span class="num" id="2432785">0</span><span class="op" id="2432786">,</span>&nbsp;<span class="ident" id="2432788">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432796">if</span>&nbsp;<span class="ident" id="2432799">r</span><span class="op" id="2432800">.</span><span class="ident" id="2432801">buf</span><span class="op" id="2432804">[</span><span class="num" id="2432805">0</span><span class="op" id="2432806">]</span>&nbsp;<span class="op" id="2432808">&lt;</span>&nbsp;<span class="ident" id="2432810">utf8</span><span class="op" id="2432814">.</span><span class="ident" id="2432815">RuneSelf</span>&nbsp;<span class="op" id="2432824">{</span>&nbsp;<span class="comment" id="2432826">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432864">rr</span>&nbsp;<span class="op" id="2432867">=</span>&nbsp;<span class="builtintype" id="2432869">rune</span><span class="op" id="2432873">(</span><span class="ident" id="2432874">r</span><span class="op" id="2432875">.</span><span class="ident" id="2432876">buf</span><span class="op" id="2432879">[</span><span class="num" id="2432880">0</span><span class="op" id="2432881">]</span><span class="op" id="2432882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432886">size</span>&nbsp;<span class="op" id="2432891">=</span>&nbsp;<span class="num" id="2432893">1</span>&nbsp;<span class="comment" id="2432895">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432915">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432926">var</span>&nbsp;<span class="ident" id="2432930">n</span>&nbsp;<span class="builtintype" id="2432932">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432937">for</span>&nbsp;<span class="ident" id="2432941">n</span>&nbsp;<span class="op" id="2432943">=</span>&nbsp;<span class="num" id="2432945">1</span><span class="op" id="2432946">;</span>&nbsp;<span class="op" id="2432948">!</span><span class="ident" id="2432949">utf8</span><span class="op" id="2432953">.</span><span class="ident" id="2432954">FullRune</span><span class="op" id="2432962">(</span><span class="ident" id="2432963">r</span><span class="op" id="2432964">.</span><span class="ident" id="2432965">buf</span><span class="op" id="2432968">[</span><span class="num" id="2432969">0</span><span class="op" id="2432970">:</span><span class="ident" id="2432971">n</span><span class="op" id="2432972">]</span><span class="op" id="2432973">)</span><span class="op" id="2432974">;</span>&nbsp;<span class="ident" id="2432976">n</span><span class="op" id="2432977">++</span>&nbsp;<span class="op" id="2432980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432984">r</span><span class="op" id="2432985">.</span><span class="ident" id="2432986">buf</span><span class="op" id="2432989">[</span><span class="ident" id="2432990">n</span><span class="op" id="2432991">]</span><span class="op" id="2432992">,</span>&nbsp;<span class="ident" id="2432994">err</span>&nbsp;<span class="op" id="2432998">=</span>&nbsp;<span class="ident" id="2433000">r</span><span class="op" id="2433001">.</span><span class="ident" id="2433002">readByte</span><span class="op" id="2433010">(</span><span class="op" id="2433011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433015">if</span>&nbsp;<span class="ident" id="2433018">err</span>&nbsp;<span class="op" id="2433022">!=</span>&nbsp;<span class="ident" id="2433025">nil</span>&nbsp;<span class="op" id="2433029">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433034">if</span>&nbsp;<span class="ident" id="2433037">err</span>&nbsp;<span class="op" id="2433041">==</span>&nbsp;<span class="ident" id="2433044">io</span><span class="op" id="2433046">.</span><span class="ident" id="2433047">EOF</span>&nbsp;<span class="op" id="2433051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433057">err</span>&nbsp;<span class="op" id="2433061">=</span>&nbsp;<span class="ident" id="2433063">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433071">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433085">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433100">rr</span><span class="op" id="2433102">,</span>&nbsp;<span class="ident" id="2433104">size</span>&nbsp;<span class="op" id="2433109">=</span>&nbsp;<span class="ident" id="2433111">utf8</span><span class="op" id="2433115">.</span><span class="ident" id="2433116">DecodeRune</span><span class="op" id="2433126">(</span><span class="ident" id="2433127">r</span><span class="op" id="2433128">.</span><span class="ident" id="2433129">buf</span><span class="op" id="2433132">[</span><span class="num" id="2433133">0</span><span class="op" id="2433134">:</span><span class="ident" id="2433135">n</span><span class="op" id="2433136">]</span><span class="op" id="2433137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433140">if</span>&nbsp;<span class="ident" id="2433143">size</span>&nbsp;<span class="op" id="2433148">&lt;</span>&nbsp;<span class="ident" id="2433150">n</span>&nbsp;<span class="op" id="2433152">{</span>&nbsp;<span class="comment" id="2433154">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433168">r</span><span class="op" id="2433169">.</span><span class="ident" id="2433170">unread</span><span class="op" id="2433176">(</span><span class="ident" id="2433177">r</span><span class="op" id="2433178">.</span><span class="ident" id="2433179">buf</span><span class="op" id="2433182">[</span><span class="ident" id="2433183">size</span><span class="op" id="2433187">:</span><span class="ident" id="2433188">n</span><span class="op" id="2433189">]</span><span class="op" id="2433190">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433196">return</span><br>
<span class="lineno"></span><span class="op" id="2433203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2433206">var</span>&nbsp;<span class="ident" id="2433210">ssFree</span>&nbsp;<span class="op" id="2433217">=</span>&nbsp;<span class="ident" id="2433219">sync</span><span class="op" id="2433223">.</span><span class="ident" id="2433224">Pool</span><span class="op" id="2433228">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433231">New</span><span class="op" id="2433234">:</span>&nbsp;<span class="keyword" id="2433236">func</span><span class="op" id="2433240">(</span><span class="op" id="2433241">)</span>&nbsp;<span class="keyword" id="2433243">interface</span><span class="op" id="2433252">{</span><span class="op" id="2433253">}</span>&nbsp;<span class="op" id="2433255">{</span>&nbsp;<span class="keyword" id="2433257">return</span>&nbsp;<span class="builtinfunc" id="2433264">new</span><span class="op" id="2433267">(</span><span class="ident" id="2433268">ss</span><span class="op" id="2433270">)</span>&nbsp;<span class="op" id="2433272">}</span><span class="op" id="2433273">,</span><br>
<span class="lineno"></span><span class="op" id="2433275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2433278">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2433342">func</span>&nbsp;<span class="ident" id="2433347">newScanState</span><span class="op" id="2433359">(</span><span class="ident" id="2433360">r</span>&nbsp;<span class="ident" id="2433362">io</span><span class="op" id="2433364">.</span><span class="ident" id="2433365">Reader</span><span class="op" id="2433371">,</span>&nbsp;<span class="ident" id="2433373">nlIsSpace</span><span class="op" id="2433382">,</span>&nbsp;<span class="ident" id="2433384">nlIsEnd</span>&nbsp;<span class="builtintype" id="2433392">bool</span><span class="op" id="2433396">)</span>&nbsp;<span class="op" id="2433398">(</span><span class="ident" id="2433399">s</span>&nbsp;<span class="op" id="2433401">*</span><span class="ident" id="2433402">ss</span><span class="op" id="2433404">,</span>&nbsp;<span class="ident" id="2433406">old</span>&nbsp;<span class="ident" id="2433410">ssave</span><span class="op" id="2433415">)</span>&nbsp;<span class="op" id="2433417">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2433420">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2433475">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433519">s</span><span class="op" id="2433520">,</span>&nbsp;<span class="ident" id="2433522">ok</span>&nbsp;<span class="op" id="2433525">:=</span>&nbsp;<span class="ident" id="2433528">r</span><span class="op" id="2433529">.</span><span class="op" id="2433530">(</span><span class="op" id="2433531">*</span><span class="ident" id="2433532">ss</span><span class="op" id="2433534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433537">if</span>&nbsp;<span class="ident" id="2433540">ok</span>&nbsp;<span class="op" id="2433543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433547">old</span>&nbsp;<span class="op" id="2433551">=</span>&nbsp;<span class="ident" id="2433553">s</span><span class="op" id="2433554">.</span><span class="ident" id="2433555">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433563">s</span><span class="op" id="2433564">.</span><span class="ident" id="2433565">limit</span>&nbsp;<span class="op" id="2433571">=</span>&nbsp;<span class="ident" id="2433573">s</span><span class="op" id="2433574">.</span><span class="ident" id="2433575">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433586">s</span><span class="op" id="2433587">.</span><span class="ident" id="2433588">nlIsEnd</span>&nbsp;<span class="op" id="2433596">=</span>&nbsp;<span class="ident" id="2433598">nlIsEnd</span>&nbsp;<span class="op" id="2433606">||</span>&nbsp;<span class="ident" id="2433609">s</span><span class="op" id="2433610">.</span><span class="ident" id="2433611">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433621">s</span><span class="op" id="2433622">.</span><span class="ident" id="2433623">nlIsSpace</span>&nbsp;<span class="op" id="2433633">=</span>&nbsp;<span class="ident" id="2433635">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433647">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433655">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433659">s</span>&nbsp;<span class="op" id="2433661">=</span>&nbsp;<span class="ident" id="2433663">ssFree</span><span class="op" id="2433669">.</span><span class="ident" id="2433670">Get</span><span class="op" id="2433673">(</span><span class="op" id="2433674">)</span><span class="op" id="2433675">.</span><span class="op" id="2433676">(</span><span class="op" id="2433677">*</span><span class="ident" id="2433678">ss</span><span class="op" id="2433680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433683">if</span>&nbsp;<span class="ident" id="2433686">rr</span><span class="op" id="2433688">,</span>&nbsp;<span class="ident" id="2433690">ok</span>&nbsp;<span class="op" id="2433693">:=</span>&nbsp;<span class="ident" id="2433696">r</span><span class="op" id="2433697">.</span><span class="op" id="2433698">(</span><span class="ident" id="2433699">io</span><span class="op" id="2433701">.</span><span class="ident" id="2433702">RuneReader</span><span class="op" id="2433712">)</span><span class="op" id="2433713">;</span>&nbsp;<span class="ident" id="2433715">ok</span>&nbsp;<span class="op" id="2433718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433722">s</span><span class="op" id="2433723">.</span><span class="ident" id="2433724">rr</span>&nbsp;<span class="op" id="2433727">=</span>&nbsp;<span class="ident" id="2433729">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433733">}</span>&nbsp;<span class="keyword" id="2433735">else</span>&nbsp;<span class="op" id="2433740">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433744">s</span><span class="op" id="2433745">.</span><span class="ident" id="2433746">rr</span>&nbsp;<span class="op" id="2433749">=</span>&nbsp;<span class="op" id="2433751">&amp;</span><span class="ident" id="2433752">readRune</span><span class="op" id="2433760">{</span><span class="ident" id="2433761">reader</span><span class="op" id="2433767">:</span>&nbsp;<span class="ident" id="2433769">r</span><span class="op" id="2433770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433776">s</span><span class="op" id="2433777">.</span><span class="ident" id="2433778">nlIsSpace</span>&nbsp;<span class="op" id="2433788">=</span>&nbsp;<span class="ident" id="2433790">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433801">s</span><span class="op" id="2433802">.</span><span class="ident" id="2433803">nlIsEnd</span>&nbsp;<span class="op" id="2433811">=</span>&nbsp;<span class="ident" id="2433813">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433822">s</span><span class="op" id="2433823">.</span><span class="ident" id="2433824">prevRune</span>&nbsp;<span class="op" id="2433833">=</span>&nbsp;<span class="op" id="2433835">-</span><span class="num" id="2433836">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433839">s</span><span class="op" id="2433840">.</span><span class="ident" id="2433841">peekRune</span>&nbsp;<span class="op" id="2433850">=</span>&nbsp;<span class="op" id="2433852">-</span><span class="num" id="2433853">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433856">s</span><span class="op" id="2433857">.</span><span class="ident" id="2433858">atEOF</span>&nbsp;<span class="op" id="2433864">=</span>&nbsp;<span class="builtintype" id="2433866">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433873">s</span><span class="op" id="2433874">.</span><span class="ident" id="2433875">limit</span>&nbsp;<span class="op" id="2433881">=</span>&nbsp;<span class="ident" id="2433883">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433892">s</span><span class="op" id="2433893">.</span><span class="ident" id="2433894">argLimit</span>&nbsp;<span class="op" id="2433903">=</span>&nbsp;<span class="ident" id="2433905">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433914">s</span><span class="op" id="2433915">.</span><span class="ident" id="2433916">maxWid</span>&nbsp;<span class="op" id="2433923">=</span>&nbsp;<span class="ident" id="2433925">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433934">s</span><span class="op" id="2433935">.</span><span class="ident" id="2433936">validSave</span>&nbsp;<span class="op" id="2433946">=</span>&nbsp;<span class="builtintype" id="2433948">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433954">s</span><span class="op" id="2433955">.</span><span class="ident" id="2433956">count</span>&nbsp;<span class="op" id="2433962">=</span>&nbsp;<span class="num" id="2433964">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433967">return</span><br>
<span class="lineno"></span><span class="op" id="2433974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2433977">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2434054">func</span>&nbsp;<span class="op" id="2434059">(</span><span class="ident" id="2434060">s</span>&nbsp;<span class="op" id="2434062">*</span><span class="ident" id="2434063">ss</span><span class="op" id="2434065">)</span>&nbsp;<span class="ident" id="2434067">free</span><span class="op" id="2434071">(</span><span class="ident" id="2434072">old</span>&nbsp;<span class="ident" id="2434076">ssave</span><span class="op" id="2434081">)</span>&nbsp;<span class="op" id="2434083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2434086">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434146">if</span>&nbsp;<span class="ident" id="2434149">old</span><span class="op" id="2434152">.</span><span class="ident" id="2434153">validSave</span>&nbsp;<span class="op" id="2434163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434167">s</span><span class="op" id="2434168">.</span><span class="ident" id="2434169">ssave</span>&nbsp;<span class="op" id="2434175">=</span>&nbsp;<span class="ident" id="2434177">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434183">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2434194">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434246">if</span>&nbsp;<span class="builtinfunc" id="2434249">cap</span><span class="op" id="2434252">(</span><span class="ident" id="2434253">s</span><span class="op" id="2434254">.</span><span class="ident" id="2434255">buf</span><span class="op" id="2434258">)</span>&nbsp;<span class="op" id="2434260">&gt;</span>&nbsp;<span class="num" id="2434262">1024</span>&nbsp;<span class="op" id="2434267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434271">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434282">s</span><span class="op" id="2434283">.</span><span class="ident" id="2434284">buf</span>&nbsp;<span class="op" id="2434288">=</span>&nbsp;<span class="ident" id="2434290">s</span><span class="op" id="2434291">.</span><span class="ident" id="2434292">buf</span><span class="op" id="2434295">[</span><span class="op" id="2434296">:</span><span class="num" id="2434297">0</span><span class="op" id="2434298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434301">s</span><span class="op" id="2434302">.</span><span class="ident" id="2434303">rr</span>&nbsp;<span class="op" id="2434306">=</span>&nbsp;<span class="ident" id="2434308">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434313">ssFree</span><span class="op" id="2434319">.</span><span class="ident" id="2434320">Put</span><span class="op" id="2434323">(</span><span class="ident" id="2434324">s</span><span class="op" id="2434325">)</span><br>
<span class="lineno"></span><span class="op" id="2434327">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2434330">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2434376">func</span>&nbsp;<span class="op" id="2434381">(</span><span class="ident" id="2434382">s</span>&nbsp;<span class="op" id="2434384">*</span><span class="ident" id="2434385">ss</span><span class="op" id="2434387">)</span>&nbsp;<span class="ident" id="2434389">skipSpace</span><span class="op" id="2434398">(</span><span class="ident" id="2434399">stopAtNewline</span>&nbsp;<span class="builtintype" id="2434413">bool</span><span class="op" id="2434417">)</span>&nbsp;<span class="op" id="2434419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434422">for</span>&nbsp;<span class="op" id="2434426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434430">r</span>&nbsp;<span class="op" id="2434432">:=</span>&nbsp;<span class="ident" id="2434435">s</span><span class="op" id="2434436">.</span><span class="ident" id="2434437">getRune</span><span class="op" id="2434444">(</span><span class="op" id="2434445">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434449">if</span>&nbsp;<span class="ident" id="2434452">r</span>&nbsp;<span class="op" id="2434454">==</span>&nbsp;<span class="ident" id="2434457">eof</span>&nbsp;<span class="op" id="2434461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434466">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434479">if</span>&nbsp;<span class="ident" id="2434482">r</span>&nbsp;<span class="op" id="2434484">==</span>&nbsp;<span class="string" id="2434487">&#39;\r&#39;</span>&nbsp;<span class="op" id="2434492">&amp;&amp;</span>&nbsp;<span class="ident" id="2434495">s</span><span class="op" id="2434496">.</span><span class="ident" id="2434497">peek</span><span class="op" id="2434501">(</span><span class="string" id="2434502">&#34;\n&#34;</span><span class="op" id="2434506">)</span>&nbsp;<span class="op" id="2434508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434513">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434528">if</span>&nbsp;<span class="ident" id="2434531">r</span>&nbsp;<span class="op" id="2434533">==</span>&nbsp;<span class="string" id="2434536">&#39;\n&#39;</span>&nbsp;<span class="op" id="2434541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434546">if</span>&nbsp;<span class="ident" id="2434549">stopAtNewline</span>&nbsp;<span class="op" id="2434563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434569">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434578">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434583">if</span>&nbsp;<span class="ident" id="2434586">s</span><span class="op" id="2434587">.</span><span class="ident" id="2434588">nlIsSpace</span>&nbsp;<span class="op" id="2434598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434604">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434621">s</span><span class="op" id="2434622">.</span><span class="ident" id="2434623">errorString</span><span class="op" id="2434634">(</span><span class="string" id="2434635">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2434655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434660">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434673">if</span>&nbsp;<span class="op" id="2434676">!</span><span class="ident" id="2434677">isSpace</span><span class="op" id="2434684">(</span><span class="ident" id="2434685">r</span><span class="op" id="2434686">)</span>&nbsp;<span class="op" id="2434688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434693">s</span><span class="op" id="2434694">.</span><span class="ident" id="2434695">UnreadRune</span><span class="op" id="2434705">(</span><span class="op" id="2434706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434711">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434719">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434722">}</span><br>
<span class="lineno"></span><span class="op" id="2434724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2434727">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2434796">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2434864">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2434899">func</span>&nbsp;<span class="op" id="2434904">(</span><span class="ident" id="2434905">s</span>&nbsp;<span class="op" id="2434907">*</span><span class="ident" id="2434908">ss</span><span class="op" id="2434910">)</span>&nbsp;<span class="ident" id="2434912">token</span><span class="op" id="2434917">(</span><span class="ident" id="2434918">skipSpace</span>&nbsp;<span class="builtintype" id="2434928">bool</span><span class="op" id="2434932">,</span>&nbsp;<span class="ident" id="2434934">f</span>&nbsp;<span class="keyword" id="2434936">func</span><span class="op" id="2434940">(</span><span class="builtintype" id="2434941">rune</span><span class="op" id="2434945">)</span>&nbsp;<span class="builtintype" id="2434947">bool</span><span class="op" id="2434951">)</span>&nbsp;<span class="op" id="2434953">[</span><span class="op" id="2434954">]</span><span class="builtintype" id="2434955">byte</span>&nbsp;<span class="op" id="2434960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434963">if</span>&nbsp;<span class="ident" id="2434966">skipSpace</span>&nbsp;<span class="op" id="2434976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434980">s</span><span class="op" id="2434981">.</span><span class="ident" id="2434982">skipSpace</span><span class="op" id="2434991">(</span><span class="builtintype" id="2434992">false</span><span class="op" id="2434997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435000">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2435003">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435041">for</span>&nbsp;<span class="op" id="2435045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435049">r</span>&nbsp;<span class="op" id="2435051">:=</span>&nbsp;<span class="ident" id="2435054">s</span><span class="op" id="2435055">.</span><span class="ident" id="2435056">getRune</span><span class="op" id="2435063">(</span><span class="op" id="2435064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435068">if</span>&nbsp;<span class="ident" id="2435071">r</span>&nbsp;<span class="op" id="2435073">==</span>&nbsp;<span class="ident" id="2435076">eof</span>&nbsp;<span class="op" id="2435080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435085">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435097">if</span>&nbsp;<span class="op" id="2435100">!</span><span class="ident" id="2435101">f</span><span class="op" id="2435102">(</span><span class="ident" id="2435103">r</span><span class="op" id="2435104">)</span>&nbsp;<span class="op" id="2435106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435111">s</span><span class="op" id="2435112">.</span><span class="ident" id="2435113">UnreadRune</span><span class="op" id="2435123">(</span><span class="op" id="2435124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435129">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435137">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435141">s</span><span class="op" id="2435142">.</span><span class="ident" id="2435143">buf</span><span class="op" id="2435146">.</span><span class="ident" id="2435147">WriteRune</span><span class="op" id="2435156">(</span><span class="ident" id="2435157">r</span><span class="op" id="2435158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435164">return</span>&nbsp;<span class="ident" id="2435171">s</span><span class="op" id="2435172">.</span><span class="ident" id="2435173">buf</span><br>
<span class="lineno"></span><span class="op" id="2435177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2435180">var</span>&nbsp;<span class="ident" id="2435184">complexError</span>&nbsp;<span class="op" id="2435197">=</span>&nbsp;<span class="ident" id="2435199">errors</span><span class="op" id="2435205">.</span><span class="ident" id="2435206">New</span><span class="op" id="2435209">(</span><span class="string" id="2435210">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2435248">)</span><br>
<span class="lineno"></span><span class="keyword" id="2435250">var</span>&nbsp;<span class="ident" id="2435254">boolError</span>&nbsp;<span class="op" id="2435264">=</span>&nbsp;<span class="ident" id="2435266">errors</span><span class="op" id="2435272">.</span><span class="ident" id="2435273">New</span><span class="op" id="2435276">(</span><span class="string" id="2435277">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2435308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2435311">func</span>&nbsp;<span class="ident" id="2435316">indexRune</span><span class="op" id="2435325">(</span><span class="ident" id="2435326">s</span>&nbsp;<span class="builtintype" id="2435328">string</span><span class="op" id="2435334">,</span>&nbsp;<span class="ident" id="2435336">r</span>&nbsp;<span class="builtintype" id="2435338">rune</span><span class="op" id="2435342">)</span>&nbsp;<span class="builtintype" id="2435344">int</span>&nbsp;<span class="op" id="2435348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435351">for</span>&nbsp;<span class="ident" id="2435355">i</span><span class="op" id="2435356">,</span>&nbsp;<span class="ident" id="2435358">c</span>&nbsp;<span class="op" id="2435360">:=</span>&nbsp;<span class="keyword" id="2435363">range</span>&nbsp;<span class="ident" id="2435369">s</span>&nbsp;<span class="op" id="2435371">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435375">if</span>&nbsp;<span class="ident" id="2435378">c</span>&nbsp;<span class="op" id="2435380">==</span>&nbsp;<span class="ident" id="2435383">r</span>&nbsp;<span class="op" id="2435385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435390">return</span>&nbsp;<span class="ident" id="2435397">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435407">return</span>&nbsp;<span class="op" id="2435414">-</span><span class="num" id="2435415">1</span><br>
<span class="lineno">495</span><span class="op" id="2435417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2435420">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2435508">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2435574">func</span>&nbsp;<span class="op" id="2435579">(</span><span class="ident" id="2435580">s</span>&nbsp;<span class="op" id="2435582">*</span><span class="ident" id="2435583">ss</span><span class="op" id="2435585">)</span>&nbsp;<span class="ident" id="2435587">consume</span><span class="op" id="2435594">(</span><span class="ident" id="2435595">ok</span>&nbsp;<span class="builtintype" id="2435598">string</span><span class="op" id="2435604">,</span>&nbsp;<span class="ident" id="2435606">accept</span>&nbsp;<span class="builtintype" id="2435613">bool</span><span class="op" id="2435617">)</span>&nbsp;<span class="builtintype" id="2435619">bool</span>&nbsp;<span class="op" id="2435624">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435627">r</span>&nbsp;<span class="op" id="2435629">:=</span>&nbsp;<span class="ident" id="2435632">s</span><span class="op" id="2435633">.</span><span class="ident" id="2435634">getRune</span><span class="op" id="2435641">(</span><span class="op" id="2435642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435645">if</span>&nbsp;<span class="ident" id="2435648">r</span>&nbsp;<span class="op" id="2435650">==</span>&nbsp;<span class="ident" id="2435653">eof</span>&nbsp;<span class="op" id="2435657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435661">return</span>&nbsp;<span class="builtintype" id="2435668">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435678">if</span>&nbsp;<span class="ident" id="2435681">indexRune</span><span class="op" id="2435690">(</span><span class="ident" id="2435691">ok</span><span class="op" id="2435693">,</span>&nbsp;<span class="ident" id="2435695">r</span><span class="op" id="2435696">)</span>&nbsp;<span class="op" id="2435698">&gt;=</span>&nbsp;<span class="num" id="2435701">0</span>&nbsp;<span class="op" id="2435703">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435707">if</span>&nbsp;<span class="ident" id="2435710">accept</span>&nbsp;<span class="op" id="2435717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435722">s</span><span class="op" id="2435723">.</span><span class="ident" id="2435724">buf</span><span class="op" id="2435727">.</span><span class="ident" id="2435728">WriteRune</span><span class="op" id="2435737">(</span><span class="ident" id="2435738">r</span><span class="op" id="2435739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435747">return</span>&nbsp;<span class="builtintype" id="2435754">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435760">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435763">if</span>&nbsp;<span class="ident" id="2435766">r</span>&nbsp;<span class="op" id="2435768">!=</span>&nbsp;<span class="ident" id="2435771">eof</span>&nbsp;<span class="op" id="2435775">&amp;&amp;</span>&nbsp;<span class="ident" id="2435778">accept</span>&nbsp;<span class="op" id="2435785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435789">s</span><span class="op" id="2435790">.</span><span class="ident" id="2435791">UnreadRune</span><span class="op" id="2435801">(</span><span class="op" id="2435802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435808">return</span>&nbsp;<span class="builtintype" id="2435815">false</span><br>
<span class="lineno"></span><span class="op" id="2435821">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2435824">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2435910">func</span>&nbsp;<span class="op" id="2435915">(</span><span class="ident" id="2435916">s</span>&nbsp;<span class="op" id="2435918">*</span><span class="ident" id="2435919">ss</span><span class="op" id="2435921">)</span>&nbsp;<span class="ident" id="2435923">peek</span><span class="op" id="2435927">(</span><span class="ident" id="2435928">ok</span>&nbsp;<span class="builtintype" id="2435931">string</span><span class="op" id="2435937">)</span>&nbsp;<span class="builtintype" id="2435939">bool</span>&nbsp;<span class="op" id="2435944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435947">r</span>&nbsp;<span class="op" id="2435949">:=</span>&nbsp;<span class="ident" id="2435952">s</span><span class="op" id="2435953">.</span><span class="ident" id="2435954">getRune</span><span class="op" id="2435961">(</span><span class="op" id="2435962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435965">if</span>&nbsp;<span class="ident" id="2435968">r</span>&nbsp;<span class="op" id="2435970">!=</span>&nbsp;<span class="ident" id="2435973">eof</span>&nbsp;<span class="op" id="2435977">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435981">s</span><span class="op" id="2435982">.</span><span class="ident" id="2435983">UnreadRune</span><span class="op" id="2435993">(</span><span class="op" id="2435994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436000">return</span>&nbsp;<span class="ident" id="2436007">indexRune</span><span class="op" id="2436016">(</span><span class="ident" id="2436017">ok</span><span class="op" id="2436019">,</span>&nbsp;<span class="ident" id="2436021">r</span><span class="op" id="2436022">)</span>&nbsp;<span class="op" id="2436024">&gt;=</span>&nbsp;<span class="num" id="2436027">0</span><br>
<span class="lineno"></span><span class="op" id="2436029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2436032">func</span>&nbsp;<span class="op" id="2436037">(</span><span class="ident" id="2436038">s</span>&nbsp;<span class="op" id="2436040">*</span><span class="ident" id="2436041">ss</span><span class="op" id="2436043">)</span>&nbsp;<span class="ident" id="2436045">notEOF</span><span class="op" id="2436051">(</span><span class="op" id="2436052">)</span>&nbsp;<span class="op" id="2436054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2436057">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436097">if</span>&nbsp;<span class="ident" id="2436100">r</span>&nbsp;<span class="op" id="2436102">:=</span>&nbsp;<span class="ident" id="2436105">s</span><span class="op" id="2436106">.</span><span class="ident" id="2436107">getRune</span><span class="op" id="2436114">(</span><span class="op" id="2436115">)</span><span class="op" id="2436116">;</span>&nbsp;<span class="ident" id="2436118">r</span>&nbsp;<span class="op" id="2436120">==</span>&nbsp;<span class="ident" id="2436123">eof</span>&nbsp;<span class="op" id="2436127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2436131">panic</span><span class="op" id="2436136">(</span><span class="ident" id="2436137">io</span><span class="op" id="2436139">.</span><span class="ident" id="2436140">EOF</span><span class="op" id="2436143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436146">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436149">s</span><span class="op" id="2436150">.</span><span class="ident" id="2436151">UnreadRune</span><span class="op" id="2436161">(</span><span class="op" id="2436162">)</span><br>
<span class="lineno"></span><span class="op" id="2436164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2436167">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2436267">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2436322">func</span>&nbsp;<span class="op" id="2436327">(</span><span class="ident" id="2436328">s</span>&nbsp;<span class="op" id="2436330">*</span><span class="ident" id="2436331">ss</span><span class="op" id="2436333">)</span>&nbsp;<span class="ident" id="2436335">accept</span><span class="op" id="2436341">(</span><span class="ident" id="2436342">ok</span>&nbsp;<span class="builtintype" id="2436345">string</span><span class="op" id="2436351">)</span>&nbsp;<span class="builtintype" id="2436353">bool</span>&nbsp;<span class="op" id="2436358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436361">return</span>&nbsp;<span class="ident" id="2436368">s</span><span class="op" id="2436369">.</span><span class="ident" id="2436370">consume</span><span class="op" id="2436377">(</span><span class="ident" id="2436378">ok</span><span class="op" id="2436380">,</span>&nbsp;<span class="builtintype" id="2436382">true</span><span class="op" id="2436386">)</span><br>
<span class="lineno"></span><span class="op" id="2436388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2436391">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2436484">func</span>&nbsp;<span class="op" id="2436489">(</span><span class="ident" id="2436490">s</span>&nbsp;<span class="op" id="2436492">*</span><span class="ident" id="2436493">ss</span><span class="op" id="2436495">)</span>&nbsp;<span class="ident" id="2436497">okVerb</span><span class="op" id="2436503">(</span><span class="ident" id="2436504">verb</span>&nbsp;<span class="builtintype" id="2436509">rune</span><span class="op" id="2436513">,</span>&nbsp;<span class="ident" id="2436515">okVerbs</span><span class="op" id="2436522">,</span>&nbsp;<span class="ident" id="2436524">typ</span>&nbsp;<span class="builtintype" id="2436528">string</span><span class="op" id="2436534">)</span>&nbsp;<span class="builtintype" id="2436536">bool</span>&nbsp;<span class="op" id="2436541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436544">for</span>&nbsp;<span class="ident" id="2436548">_</span><span class="op" id="2436549">,</span>&nbsp;<span class="ident" id="2436551">v</span>&nbsp;<span class="op" id="2436553">:=</span>&nbsp;<span class="keyword" id="2436556">range</span>&nbsp;<span class="ident" id="2436562">okVerbs</span>&nbsp;<span class="op" id="2436570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436574">if</span>&nbsp;<span class="ident" id="2436577">v</span>&nbsp;<span class="op" id="2436579">==</span>&nbsp;<span class="ident" id="2436582">verb</span>&nbsp;<span class="op" id="2436587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436592">return</span>&nbsp;<span class="builtintype" id="2436599">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436606">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436612">s</span><span class="op" id="2436613">.</span><span class="ident" id="2436614">errorString</span><span class="op" id="2436625">(</span><span class="string" id="2436626">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2436639">+</span>&nbsp;<span class="builtintype" id="2436641">string</span><span class="op" id="2436647">(</span><span class="ident" id="2436648">verb</span><span class="op" id="2436652">)</span>&nbsp;<span class="op" id="2436654">+</span>&nbsp;<span class="string" id="2436656">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2436664">+</span>&nbsp;<span class="ident" id="2436666">typ</span><span class="op" id="2436669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436672">return</span>&nbsp;<span class="builtintype" id="2436679">false</span><br>
<span class="lineno"></span><span class="op" id="2436685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2436688">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2436764">func</span>&nbsp;<span class="op" id="2436769">(</span><span class="ident" id="2436770">s</span>&nbsp;<span class="op" id="2436772">*</span><span class="ident" id="2436773">ss</span><span class="op" id="2436775">)</span>&nbsp;<span class="ident" id="2436777">scanBool</span><span class="op" id="2436785">(</span><span class="ident" id="2436786">verb</span>&nbsp;<span class="builtintype" id="2436791">rune</span><span class="op" id="2436795">)</span>&nbsp;<span class="builtintype" id="2436797">bool</span>&nbsp;<span class="op" id="2436802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436805">s</span><span class="op" id="2436806">.</span><span class="ident" id="2436807">skipSpace</span><span class="op" id="2436816">(</span><span class="builtintype" id="2436817">false</span><span class="op" id="2436822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436825">s</span><span class="op" id="2436826">.</span><span class="ident" id="2436827">notEOF</span><span class="op" id="2436833">(</span><span class="op" id="2436834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436837">if</span>&nbsp;<span class="op" id="2436840">!</span><span class="ident" id="2436841">s</span><span class="op" id="2436842">.</span><span class="ident" id="2436843">okVerb</span><span class="op" id="2436849">(</span><span class="ident" id="2436850">verb</span><span class="op" id="2436854">,</span>&nbsp;<span class="string" id="2436856">&#34;tv&#34;</span><span class="op" id="2436860">,</span>&nbsp;<span class="string" id="2436862">&#34;boolean&#34;</span><span class="op" id="2436871">)</span>&nbsp;<span class="op" id="2436873">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436877">return</span>&nbsp;<span class="builtintype" id="2436884">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2436894">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436971">switch</span>&nbsp;<span class="ident" id="2436978">s</span><span class="op" id="2436979">.</span><span class="ident" id="2436980">getRune</span><span class="op" id="2436987">(</span><span class="op" id="2436988">)</span>&nbsp;<span class="op" id="2436990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436993">case</span>&nbsp;<span class="string" id="2436998">&#39;0&#39;</span><span class="op" id="2437001">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437005">return</span>&nbsp;<span class="builtintype" id="2437012">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437019">case</span>&nbsp;<span class="string" id="2437024">&#39;1&#39;</span><span class="op" id="2437027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437031">return</span>&nbsp;<span class="builtintype" id="2437038">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437044">case</span>&nbsp;<span class="string" id="2437049">&#39;t&#39;</span><span class="op" id="2437052">,</span>&nbsp;<span class="string" id="2437054">&#39;T&#39;</span><span class="op" id="2437057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437061">if</span>&nbsp;<span class="ident" id="2437064">s</span><span class="op" id="2437065">.</span><span class="ident" id="2437066">accept</span><span class="op" id="2437072">(</span><span class="string" id="2437073">&#34;rR&#34;</span><span class="op" id="2437077">)</span>&nbsp;<span class="op" id="2437079">&amp;&amp;</span>&nbsp;<span class="op" id="2437082">(</span><span class="op" id="2437083">!</span><span class="ident" id="2437084">s</span><span class="op" id="2437085">.</span><span class="ident" id="2437086">accept</span><span class="op" id="2437092">(</span><span class="string" id="2437093">&#34;uU&#34;</span><span class="op" id="2437097">)</span>&nbsp;<span class="op" id="2437099">||</span>&nbsp;<span class="op" id="2437102">!</span><span class="ident" id="2437103">s</span><span class="op" id="2437104">.</span><span class="ident" id="2437105">accept</span><span class="op" id="2437111">(</span><span class="string" id="2437112">&#34;eE&#34;</span><span class="op" id="2437116">)</span><span class="op" id="2437117">)</span>&nbsp;<span class="op" id="2437119">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437124">s</span><span class="op" id="2437125">.</span><span class="builtintype" id="2437126">error</span><span class="op" id="2437131">(</span><span class="ident" id="2437132">boolError</span><span class="op" id="2437141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437149">return</span>&nbsp;<span class="builtintype" id="2437156">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437162">case</span>&nbsp;<span class="string" id="2437167">&#39;f&#39;</span><span class="op" id="2437170">,</span>&nbsp;<span class="string" id="2437172">&#39;F&#39;</span><span class="op" id="2437175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437179">if</span>&nbsp;<span class="ident" id="2437182">s</span><span class="op" id="2437183">.</span><span class="ident" id="2437184">accept</span><span class="op" id="2437190">(</span><span class="string" id="2437191">&#34;aA&#34;</span><span class="op" id="2437195">)</span>&nbsp;<span class="op" id="2437197">&amp;&amp;</span>&nbsp;<span class="op" id="2437200">(</span><span class="op" id="2437201">!</span><span class="ident" id="2437202">s</span><span class="op" id="2437203">.</span><span class="ident" id="2437204">accept</span><span class="op" id="2437210">(</span><span class="string" id="2437211">&#34;lL&#34;</span><span class="op" id="2437215">)</span>&nbsp;<span class="op" id="2437217">||</span>&nbsp;<span class="op" id="2437220">!</span><span class="ident" id="2437221">s</span><span class="op" id="2437222">.</span><span class="ident" id="2437223">accept</span><span class="op" id="2437229">(</span><span class="string" id="2437230">&#34;sS&#34;</span><span class="op" id="2437234">)</span>&nbsp;<span class="op" id="2437236">||</span>&nbsp;<span class="op" id="2437239">!</span><span class="ident" id="2437240">s</span><span class="op" id="2437241">.</span><span class="ident" id="2437242">accept</span><span class="op" id="2437248">(</span><span class="string" id="2437249">&#34;eE&#34;</span><span class="op" id="2437253">)</span><span class="op" id="2437254">)</span>&nbsp;<span class="op" id="2437256">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437261">s</span><span class="op" id="2437262">.</span><span class="builtintype" id="2437263">error</span><span class="op" id="2437268">(</span><span class="ident" id="2437269">boolError</span><span class="op" id="2437278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437286">return</span>&nbsp;<span class="builtintype" id="2437293">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437303">return</span>&nbsp;<span class="builtintype" id="2437310">false</span><br>
<span class="lineno">575</span><span class="op" id="2437316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2437319">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2437341">const</span>&nbsp;<span class="op" id="2437347">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437350">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2437368">=</span>&nbsp;<span class="string" id="2437370">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437376">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2437394">=</span>&nbsp;<span class="string" id="2437396">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437408">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2437426">=</span>&nbsp;<span class="string" id="2437428">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437442">hexadecimalDigits</span>&nbsp;<span class="op" id="2437460">=</span>&nbsp;<span class="string" id="2437462">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437488">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2437506">=</span>&nbsp;<span class="string" id="2437508">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437514">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2437532">=</span>&nbsp;<span class="string" id="2437534">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437539">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2437557">=</span>&nbsp;<span class="string" id="2437559">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2437565">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2437568">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2437650">func</span>&nbsp;<span class="op" id="2437655">(</span><span class="ident" id="2437656">s</span>&nbsp;<span class="op" id="2437658">*</span><span class="ident" id="2437659">ss</span><span class="op" id="2437661">)</span>&nbsp;<span class="ident" id="2437663">getBase</span><span class="op" id="2437670">(</span><span class="ident" id="2437671">verb</span>&nbsp;<span class="builtintype" id="2437676">rune</span><span class="op" id="2437680">)</span>&nbsp;<span class="op" id="2437682">(</span><span class="ident" id="2437683">base</span>&nbsp;<span class="builtintype" id="2437688">int</span><span class="op" id="2437691">,</span>&nbsp;<span class="ident" id="2437693">digits</span>&nbsp;<span class="builtintype" id="2437700">string</span><span class="op" id="2437706">)</span>&nbsp;<span class="op" id="2437708">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437711">s</span><span class="op" id="2437712">.</span><span class="ident" id="2437713">okVerb</span><span class="op" id="2437719">(</span><span class="ident" id="2437720">verb</span><span class="op" id="2437724">,</span>&nbsp;<span class="string" id="2437726">&#34;bdoUxXv&#34;</span><span class="op" id="2437735">,</span>&nbsp;<span class="string" id="2437737">&#34;integer&#34;</span><span class="op" id="2437746">)</span>&nbsp;<span class="comment" id="2437748">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437763">base</span>&nbsp;<span class="op" id="2437768">=</span>&nbsp;<span class="num" id="2437770">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437774">digits</span>&nbsp;<span class="op" id="2437781">=</span>&nbsp;<span class="ident" id="2437783">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437798">switch</span>&nbsp;<span class="ident" id="2437805">verb</span>&nbsp;<span class="op" id="2437810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437813">case</span>&nbsp;<span class="string" id="2437818">&#39;b&#39;</span><span class="op" id="2437821">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437825">base</span>&nbsp;<span class="op" id="2437830">=</span>&nbsp;<span class="num" id="2437832">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437836">digits</span>&nbsp;<span class="op" id="2437843">=</span>&nbsp;<span class="ident" id="2437845">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437859">case</span>&nbsp;<span class="string" id="2437864">&#39;o&#39;</span><span class="op" id="2437867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437871">base</span>&nbsp;<span class="op" id="2437876">=</span>&nbsp;<span class="num" id="2437878">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437882">digits</span>&nbsp;<span class="op" id="2437889">=</span>&nbsp;<span class="ident" id="2437891">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437904">case</span>&nbsp;<span class="string" id="2437909">&#39;x&#39;</span><span class="op" id="2437912">,</span>&nbsp;<span class="string" id="2437914">&#39;X&#39;</span><span class="op" id="2437917">,</span>&nbsp;<span class="string" id="2437919">&#39;U&#39;</span><span class="op" id="2437922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437926">base</span>&nbsp;<span class="op" id="2437931">=</span>&nbsp;<span class="num" id="2437933">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437938">digits</span>&nbsp;<span class="op" id="2437945">=</span>&nbsp;<span class="ident" id="2437947">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437969">return</span><br>
<span class="lineno">605</span><span class="op" id="2437976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2437979">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2438059">func</span>&nbsp;<span class="op" id="2438064">(</span><span class="ident" id="2438065">s</span>&nbsp;<span class="op" id="2438067">*</span><span class="ident" id="2438068">ss</span><span class="op" id="2438070">)</span>&nbsp;<span class="ident" id="2438072">scanNumber</span><span class="op" id="2438082">(</span><span class="ident" id="2438083">digits</span>&nbsp;<span class="builtintype" id="2438090">string</span><span class="op" id="2438096">,</span>&nbsp;<span class="ident" id="2438098">haveDigits</span>&nbsp;<span class="builtintype" id="2438109">bool</span><span class="op" id="2438113">)</span>&nbsp;<span class="builtintype" id="2438115">string</span>&nbsp;<span class="op" id="2438122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438125">if</span>&nbsp;<span class="op" id="2438128">!</span><span class="ident" id="2438129">haveDigits</span>&nbsp;<span class="op" id="2438140">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438144">s</span><span class="op" id="2438145">.</span><span class="ident" id="2438146">notEOF</span><span class="op" id="2438152">(</span><span class="op" id="2438153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438157">if</span>&nbsp;<span class="op" id="2438160">!</span><span class="ident" id="2438161">s</span><span class="op" id="2438162">.</span><span class="ident" id="2438163">accept</span><span class="op" id="2438169">(</span><span class="ident" id="2438170">digits</span><span class="op" id="2438176">)</span>&nbsp;<span class="op" id="2438178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438183">s</span><span class="op" id="2438184">.</span><span class="ident" id="2438185">errorString</span><span class="op" id="2438196">(</span><span class="string" id="2438197">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2438215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438222">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438225">for</span>&nbsp;<span class="ident" id="2438229">s</span><span class="op" id="2438230">.</span><span class="ident" id="2438231">accept</span><span class="op" id="2438237">(</span><span class="ident" id="2438238">digits</span><span class="op" id="2438244">)</span>&nbsp;<span class="op" id="2438246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438252">return</span>&nbsp;<span class="builtintype" id="2438259">string</span><span class="op" id="2438265">(</span><span class="ident" id="2438266">s</span><span class="op" id="2438267">.</span><span class="ident" id="2438268">buf</span><span class="op" id="2438271">)</span><br>
<span class="lineno"></span><span class="op" id="2438273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2438276">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2438330">func</span>&nbsp;<span class="op" id="2438335">(</span><span class="ident" id="2438336">s</span>&nbsp;<span class="op" id="2438338">*</span><span class="ident" id="2438339">ss</span><span class="op" id="2438341">)</span>&nbsp;<span class="ident" id="2438343">scanRune</span><span class="op" id="2438351">(</span><span class="ident" id="2438352">bitSize</span>&nbsp;<span class="builtintype" id="2438360">int</span><span class="op" id="2438363">)</span>&nbsp;<span class="ident" id="2438365">int64</span>&nbsp;<span class="op" id="2438371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438374">s</span><span class="op" id="2438375">.</span><span class="ident" id="2438376">notEOF</span><span class="op" id="2438382">(</span><span class="op" id="2438383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438386">r</span>&nbsp;<span class="op" id="2438388">:=</span>&nbsp;<span class="ident" id="2438391">int64</span><span class="op" id="2438396">(</span><span class="ident" id="2438397">s</span><span class="op" id="2438398">.</span><span class="ident" id="2438399">getRune</span><span class="op" id="2438406">(</span><span class="op" id="2438407">)</span><span class="op" id="2438408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438411">n</span>&nbsp;<span class="op" id="2438413">:=</span>&nbsp;<span class="builtintype" id="2438416">uint</span><span class="op" id="2438420">(</span><span class="ident" id="2438421">bitSize</span><span class="op" id="2438428">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438431">x</span>&nbsp;<span class="op" id="2438433">:=</span>&nbsp;<span class="op" id="2438436">(</span><span class="ident" id="2438437">r</span>&nbsp;<span class="op" id="2438439">&lt;&lt;</span>&nbsp;<span class="op" id="2438442">(</span><span class="num" id="2438443">64</span>&nbsp;<span class="op" id="2438446">-</span>&nbsp;<span class="ident" id="2438448">n</span><span class="op" id="2438449">)</span><span class="op" id="2438450">)</span>&nbsp;<span class="op" id="2438452">&gt;&gt;</span>&nbsp;<span class="op" id="2438455">(</span><span class="num" id="2438456">64</span>&nbsp;<span class="op" id="2438459">-</span>&nbsp;<span class="ident" id="2438461">n</span><span class="op" id="2438462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438465">if</span>&nbsp;<span class="ident" id="2438468">x</span>&nbsp;<span class="op" id="2438470">!=</span>&nbsp;<span class="ident" id="2438473">r</span>&nbsp;<span class="op" id="2438475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438479">s</span><span class="op" id="2438480">.</span><span class="ident" id="2438481">errorString</span><span class="op" id="2438492">(</span><span class="string" id="2438493">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2438524">+</span>&nbsp;<span class="builtintype" id="2438526">string</span><span class="op" id="2438532">(</span><span class="ident" id="2438533">r</span><span class="op" id="2438534">)</span><span class="op" id="2438535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438541">return</span>&nbsp;<span class="ident" id="2438548">r</span><br>
<span class="lineno">630</span><span class="op" id="2438550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2438553">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2438622">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2438691">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2438731">func</span>&nbsp;<span class="op" id="2438736">(</span><span class="ident" id="2438737">s</span>&nbsp;<span class="op" id="2438739">*</span><span class="ident" id="2438740">ss</span><span class="op" id="2438742">)</span>&nbsp;<span class="ident" id="2438744">scanBasePrefix</span><span class="op" id="2438758">(</span><span class="op" id="2438759">)</span>&nbsp;<span class="op" id="2438761">(</span><span class="ident" id="2438762">base</span>&nbsp;<span class="builtintype" id="2438767">int</span><span class="op" id="2438770">,</span>&nbsp;<span class="ident" id="2438772">digits</span>&nbsp;<span class="builtintype" id="2438779">string</span><span class="op" id="2438785">,</span>&nbsp;<span class="ident" id="2438787">found</span>&nbsp;<span class="builtintype" id="2438793">bool</span><span class="op" id="2438797">)</span>&nbsp;<span class="op" id="2438799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438802">if</span>&nbsp;<span class="op" id="2438805">!</span><span class="ident" id="2438806">s</span><span class="op" id="2438807">.</span><span class="ident" id="2438808">peek</span><span class="op" id="2438812">(</span><span class="string" id="2438813">&#34;0&#34;</span><span class="op" id="2438816">)</span>&nbsp;<span class="op" id="2438818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438822">return</span>&nbsp;<span class="num" id="2438829">10</span><span class="op" id="2438831">,</span>&nbsp;<span class="ident" id="2438833">decimalDigits</span><span class="op" id="2438846">,</span>&nbsp;<span class="builtintype" id="2438848">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438858">s</span><span class="op" id="2438859">.</span><span class="ident" id="2438860">accept</span><span class="op" id="2438866">(</span><span class="string" id="2438867">&#34;0&#34;</span><span class="op" id="2438870">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438873">found</span>&nbsp;<span class="op" id="2438879">=</span>&nbsp;<span class="builtintype" id="2438881">true</span>&nbsp;<span class="comment" id="2438886">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438931">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438965">base</span><span class="op" id="2438969">,</span>&nbsp;<span class="ident" id="2438971">digits</span>&nbsp;<span class="op" id="2438978">=</span>&nbsp;<span class="num" id="2438980">8</span><span class="op" id="2438981">,</span>&nbsp;<span class="ident" id="2438983">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438996">if</span>&nbsp;<span class="ident" id="2438999">s</span><span class="op" id="2439000">.</span><span class="ident" id="2439001">peek</span><span class="op" id="2439005">(</span><span class="string" id="2439006">&#34;xX&#34;</span><span class="op" id="2439010">)</span>&nbsp;<span class="op" id="2439012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439016">s</span><span class="op" id="2439017">.</span><span class="ident" id="2439018">consume</span><span class="op" id="2439025">(</span><span class="string" id="2439026">&#34;xX&#34;</span><span class="op" id="2439030">,</span>&nbsp;<span class="builtintype" id="2439032">false</span><span class="op" id="2439037">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439041">base</span><span class="op" id="2439045">,</span>&nbsp;<span class="ident" id="2439047">digits</span>&nbsp;<span class="op" id="2439054">=</span>&nbsp;<span class="num" id="2439056">16</span><span class="op" id="2439058">,</span>&nbsp;<span class="ident" id="2439060">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439082">return</span><br>
<span class="lineno"></span><span class="op" id="2439089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2439092">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2439160">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2439224">func</span>&nbsp;<span class="op" id="2439229">(</span><span class="ident" id="2439230">s</span>&nbsp;<span class="op" id="2439232">*</span><span class="ident" id="2439233">ss</span><span class="op" id="2439235">)</span>&nbsp;<span class="ident" id="2439237">scanInt</span><span class="op" id="2439244">(</span><span class="ident" id="2439245">verb</span>&nbsp;<span class="builtintype" id="2439250">rune</span><span class="op" id="2439254">,</span>&nbsp;<span class="ident" id="2439256">bitSize</span>&nbsp;<span class="builtintype" id="2439264">int</span><span class="op" id="2439267">)</span>&nbsp;<span class="ident" id="2439269">int64</span>&nbsp;<span class="op" id="2439275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439278">if</span>&nbsp;<span class="ident" id="2439281">verb</span>&nbsp;<span class="op" id="2439286">==</span>&nbsp;<span class="string" id="2439289">&#39;c&#39;</span>&nbsp;<span class="op" id="2439293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439297">return</span>&nbsp;<span class="ident" id="2439304">s</span><span class="op" id="2439305">.</span><span class="ident" id="2439306">scanRune</span><span class="op" id="2439314">(</span><span class="ident" id="2439315">bitSize</span><span class="op" id="2439322">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439328">s</span><span class="op" id="2439329">.</span><span class="ident" id="2439330">skipSpace</span><span class="op" id="2439339">(</span><span class="builtintype" id="2439340">false</span><span class="op" id="2439345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439348">s</span><span class="op" id="2439349">.</span><span class="ident" id="2439350">notEOF</span><span class="op" id="2439356">(</span><span class="op" id="2439357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439360">base</span><span class="op" id="2439364">,</span>&nbsp;<span class="ident" id="2439366">digits</span>&nbsp;<span class="op" id="2439373">:=</span>&nbsp;<span class="ident" id="2439376">s</span><span class="op" id="2439377">.</span><span class="ident" id="2439378">getBase</span><span class="op" id="2439385">(</span><span class="ident" id="2439386">verb</span><span class="op" id="2439390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439393">haveDigits</span>&nbsp;<span class="op" id="2439404">:=</span>&nbsp;<span class="builtintype" id="2439407">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439414">if</span>&nbsp;<span class="ident" id="2439417">verb</span>&nbsp;<span class="op" id="2439422">==</span>&nbsp;<span class="string" id="2439425">&#39;U&#39;</span>&nbsp;<span class="op" id="2439429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439433">if</span>&nbsp;<span class="op" id="2439436">!</span><span class="ident" id="2439437">s</span><span class="op" id="2439438">.</span><span class="ident" id="2439439">consume</span><span class="op" id="2439446">(</span><span class="string" id="2439447">&#34;U&#34;</span><span class="op" id="2439450">,</span>&nbsp;<span class="builtintype" id="2439452">false</span><span class="op" id="2439457">)</span>&nbsp;<span class="op" id="2439459">||</span>&nbsp;<span class="op" id="2439462">!</span><span class="ident" id="2439463">s</span><span class="op" id="2439464">.</span><span class="ident" id="2439465">consume</span><span class="op" id="2439472">(</span><span class="string" id="2439473">&#34;+&#34;</span><span class="op" id="2439476">,</span>&nbsp;<span class="builtintype" id="2439478">false</span><span class="op" id="2439483">)</span>&nbsp;<span class="op" id="2439485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439490">s</span><span class="op" id="2439491">.</span><span class="ident" id="2439492">errorString</span><span class="op" id="2439503">(</span><span class="string" id="2439504">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2439525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439532">}</span>&nbsp;<span class="keyword" id="2439534">else</span>&nbsp;<span class="op" id="2439539">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439543">s</span><span class="op" id="2439544">.</span><span class="ident" id="2439545">accept</span><span class="op" id="2439551">(</span><span class="ident" id="2439552">sign</span><span class="op" id="2439556">)</span>&nbsp;<span class="comment" id="2439558">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439619">if</span>&nbsp;<span class="ident" id="2439622">verb</span>&nbsp;<span class="op" id="2439627">==</span>&nbsp;<span class="string" id="2439630">&#39;v&#39;</span>&nbsp;<span class="op" id="2439634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439639">base</span><span class="op" id="2439643">,</span>&nbsp;<span class="ident" id="2439645">digits</span><span class="op" id="2439651">,</span>&nbsp;<span class="ident" id="2439653">haveDigits</span>&nbsp;<span class="op" id="2439664">=</span>&nbsp;<span class="ident" id="2439666">s</span><span class="op" id="2439667">.</span><span class="ident" id="2439668">scanBasePrefix</span><span class="op" id="2439682">(</span><span class="op" id="2439683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439690">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439693">tok</span>&nbsp;<span class="op" id="2439697">:=</span>&nbsp;<span class="ident" id="2439700">s</span><span class="op" id="2439701">.</span><span class="ident" id="2439702">scanNumber</span><span class="op" id="2439712">(</span><span class="ident" id="2439713">digits</span><span class="op" id="2439719">,</span>&nbsp;<span class="ident" id="2439721">haveDigits</span><span class="op" id="2439731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439734">i</span><span class="op" id="2439735">,</span>&nbsp;<span class="ident" id="2439737">err</span>&nbsp;<span class="op" id="2439741">:=</span>&nbsp;<span class="ident" id="2439744">strconv</span><span class="op" id="2439751">.</span><span class="ident" id="2439752">ParseInt</span><span class="op" id="2439760">(</span><span class="ident" id="2439761">tok</span><span class="op" id="2439764">,</span>&nbsp;<span class="ident" id="2439766">base</span><span class="op" id="2439770">,</span>&nbsp;<span class="num" id="2439772">64</span><span class="op" id="2439774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439777">if</span>&nbsp;<span class="ident" id="2439780">err</span>&nbsp;<span class="op" id="2439784">!=</span>&nbsp;<span class="ident" id="2439787">nil</span>&nbsp;<span class="op" id="2439791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439795">s</span><span class="op" id="2439796">.</span><span class="builtintype" id="2439797">error</span><span class="op" id="2439802">(</span><span class="ident" id="2439803">err</span><span class="op" id="2439806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439809">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439812">n</span>&nbsp;<span class="op" id="2439814">:=</span>&nbsp;<span class="builtintype" id="2439817">uint</span><span class="op" id="2439821">(</span><span class="ident" id="2439822">bitSize</span><span class="op" id="2439829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439832">x</span>&nbsp;<span class="op" id="2439834">:=</span>&nbsp;<span class="op" id="2439837">(</span><span class="ident" id="2439838">i</span>&nbsp;<span class="op" id="2439840">&lt;&lt;</span>&nbsp;<span class="op" id="2439843">(</span><span class="num" id="2439844">64</span>&nbsp;<span class="op" id="2439847">-</span>&nbsp;<span class="ident" id="2439849">n</span><span class="op" id="2439850">)</span><span class="op" id="2439851">)</span>&nbsp;<span class="op" id="2439853">&gt;&gt;</span>&nbsp;<span class="op" id="2439856">(</span><span class="num" id="2439857">64</span>&nbsp;<span class="op" id="2439860">-</span>&nbsp;<span class="ident" id="2439862">n</span><span class="op" id="2439863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439866">if</span>&nbsp;<span class="ident" id="2439869">x</span>&nbsp;<span class="op" id="2439871">!=</span>&nbsp;<span class="ident" id="2439874">i</span>&nbsp;<span class="op" id="2439876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439880">s</span><span class="op" id="2439881">.</span><span class="ident" id="2439882">errorString</span><span class="op" id="2439893">(</span><span class="string" id="2439894">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2439923">+</span>&nbsp;<span class="ident" id="2439925">tok</span><span class="op" id="2439928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439931">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439934">return</span>&nbsp;<span class="ident" id="2439941">i</span><br>
<span class="lineno"></span><span class="op" id="2439943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2439946">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2440012">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2440088">func</span>&nbsp;<span class="op" id="2440093">(</span><span class="ident" id="2440094">s</span>&nbsp;<span class="op" id="2440096">*</span><span class="ident" id="2440097">ss</span><span class="op" id="2440099">)</span>&nbsp;<span class="ident" id="2440101">scanUint</span><span class="op" id="2440109">(</span><span class="ident" id="2440110">verb</span>&nbsp;<span class="builtintype" id="2440115">rune</span><span class="op" id="2440119">,</span>&nbsp;<span class="ident" id="2440121">bitSize</span>&nbsp;<span class="builtintype" id="2440129">int</span><span class="op" id="2440132">)</span>&nbsp;<span class="ident" id="2440134">uint64</span>&nbsp;<span class="op" id="2440141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440144">if</span>&nbsp;<span class="ident" id="2440147">verb</span>&nbsp;<span class="op" id="2440152">==</span>&nbsp;<span class="string" id="2440155">&#39;c&#39;</span>&nbsp;<span class="op" id="2440159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440163">return</span>&nbsp;<span class="ident" id="2440170">uint64</span><span class="op" id="2440176">(</span><span class="ident" id="2440177">s</span><span class="op" id="2440178">.</span><span class="ident" id="2440179">scanRune</span><span class="op" id="2440187">(</span><span class="ident" id="2440188">bitSize</span><span class="op" id="2440195">)</span><span class="op" id="2440196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440202">s</span><span class="op" id="2440203">.</span><span class="ident" id="2440204">skipSpace</span><span class="op" id="2440213">(</span><span class="builtintype" id="2440214">false</span><span class="op" id="2440219">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440222">s</span><span class="op" id="2440223">.</span><span class="ident" id="2440224">notEOF</span><span class="op" id="2440230">(</span><span class="op" id="2440231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440234">base</span><span class="op" id="2440238">,</span>&nbsp;<span class="ident" id="2440240">digits</span>&nbsp;<span class="op" id="2440247">:=</span>&nbsp;<span class="ident" id="2440250">s</span><span class="op" id="2440251">.</span><span class="ident" id="2440252">getBase</span><span class="op" id="2440259">(</span><span class="ident" id="2440260">verb</span><span class="op" id="2440264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440267">haveDigits</span>&nbsp;<span class="op" id="2440278">:=</span>&nbsp;<span class="builtintype" id="2440281">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440288">if</span>&nbsp;<span class="ident" id="2440291">verb</span>&nbsp;<span class="op" id="2440296">==</span>&nbsp;<span class="string" id="2440299">&#39;U&#39;</span>&nbsp;<span class="op" id="2440303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440307">if</span>&nbsp;<span class="op" id="2440310">!</span><span class="ident" id="2440311">s</span><span class="op" id="2440312">.</span><span class="ident" id="2440313">consume</span><span class="op" id="2440320">(</span><span class="string" id="2440321">&#34;U&#34;</span><span class="op" id="2440324">,</span>&nbsp;<span class="builtintype" id="2440326">false</span><span class="op" id="2440331">)</span>&nbsp;<span class="op" id="2440333">||</span>&nbsp;<span class="op" id="2440336">!</span><span class="ident" id="2440337">s</span><span class="op" id="2440338">.</span><span class="ident" id="2440339">consume</span><span class="op" id="2440346">(</span><span class="string" id="2440347">&#34;+&#34;</span><span class="op" id="2440350">,</span>&nbsp;<span class="builtintype" id="2440352">false</span><span class="op" id="2440357">)</span>&nbsp;<span class="op" id="2440359">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440364">s</span><span class="op" id="2440365">.</span><span class="ident" id="2440366">errorString</span><span class="op" id="2440377">(</span><span class="string" id="2440378">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2440399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440406">}</span>&nbsp;<span class="keyword" id="2440408">else</span>&nbsp;<span class="keyword" id="2440413">if</span>&nbsp;<span class="ident" id="2440416">verb</span>&nbsp;<span class="op" id="2440421">==</span>&nbsp;<span class="string" id="2440424">&#39;v&#39;</span>&nbsp;<span class="op" id="2440428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440432">base</span><span class="op" id="2440436">,</span>&nbsp;<span class="ident" id="2440438">digits</span><span class="op" id="2440444">,</span>&nbsp;<span class="ident" id="2440446">haveDigits</span>&nbsp;<span class="op" id="2440457">=</span>&nbsp;<span class="ident" id="2440459">s</span><span class="op" id="2440460">.</span><span class="ident" id="2440461">scanBasePrefix</span><span class="op" id="2440475">(</span><span class="op" id="2440476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440479">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440482">tok</span>&nbsp;<span class="op" id="2440486">:=</span>&nbsp;<span class="ident" id="2440489">s</span><span class="op" id="2440490">.</span><span class="ident" id="2440491">scanNumber</span><span class="op" id="2440501">(</span><span class="ident" id="2440502">digits</span><span class="op" id="2440508">,</span>&nbsp;<span class="ident" id="2440510">haveDigits</span><span class="op" id="2440520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440523">i</span><span class="op" id="2440524">,</span>&nbsp;<span class="ident" id="2440526">err</span>&nbsp;<span class="op" id="2440530">:=</span>&nbsp;<span class="ident" id="2440533">strconv</span><span class="op" id="2440540">.</span><span class="ident" id="2440541">ParseUint</span><span class="op" id="2440550">(</span><span class="ident" id="2440551">tok</span><span class="op" id="2440554">,</span>&nbsp;<span class="ident" id="2440556">base</span><span class="op" id="2440560">,</span>&nbsp;<span class="num" id="2440562">64</span><span class="op" id="2440564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440567">if</span>&nbsp;<span class="ident" id="2440570">err</span>&nbsp;<span class="op" id="2440574">!=</span>&nbsp;<span class="ident" id="2440577">nil</span>&nbsp;<span class="op" id="2440581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440585">s</span><span class="op" id="2440586">.</span><span class="builtintype" id="2440587">error</span><span class="op" id="2440592">(</span><span class="ident" id="2440593">err</span><span class="op" id="2440596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440599">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440602">n</span>&nbsp;<span class="op" id="2440604">:=</span>&nbsp;<span class="builtintype" id="2440607">uint</span><span class="op" id="2440611">(</span><span class="ident" id="2440612">bitSize</span><span class="op" id="2440619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440622">x</span>&nbsp;<span class="op" id="2440624">:=</span>&nbsp;<span class="op" id="2440627">(</span><span class="ident" id="2440628">i</span>&nbsp;<span class="op" id="2440630">&lt;&lt;</span>&nbsp;<span class="op" id="2440633">(</span><span class="num" id="2440634">64</span>&nbsp;<span class="op" id="2440637">-</span>&nbsp;<span class="ident" id="2440639">n</span><span class="op" id="2440640">)</span><span class="op" id="2440641">)</span>&nbsp;<span class="op" id="2440643">&gt;&gt;</span>&nbsp;<span class="op" id="2440646">(</span><span class="num" id="2440647">64</span>&nbsp;<span class="op" id="2440650">-</span>&nbsp;<span class="ident" id="2440652">n</span><span class="op" id="2440653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440656">if</span>&nbsp;<span class="ident" id="2440659">x</span>&nbsp;<span class="op" id="2440661">!=</span>&nbsp;<span class="ident" id="2440664">i</span>&nbsp;<span class="op" id="2440666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440670">s</span><span class="op" id="2440671">.</span><span class="ident" id="2440672">errorString</span><span class="op" id="2440683">(</span><span class="string" id="2440684">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2440722">+</span>&nbsp;<span class="ident" id="2440724">tok</span><span class="op" id="2440727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440730">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440733">return</span>&nbsp;<span class="ident" id="2440740">i</span><br>
<span class="lineno"></span><span class="op" id="2440742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2440745">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2440828">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2440919">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2440975">func</span>&nbsp;<span class="op" id="2440980">(</span><span class="ident" id="2440981">s</span>&nbsp;<span class="op" id="2440983">*</span><span class="ident" id="2440984">ss</span><span class="op" id="2440986">)</span>&nbsp;<span class="ident" id="2440988">floatToken</span><span class="op" id="2440998">(</span><span class="op" id="2440999">)</span>&nbsp;<span class="builtintype" id="2441001">string</span>&nbsp;<span class="op" id="2441008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441011">s</span><span class="op" id="2441012">.</span><span class="ident" id="2441013">buf</span>&nbsp;<span class="op" id="2441017">=</span>&nbsp;<span class="ident" id="2441019">s</span><span class="op" id="2441020">.</span><span class="ident" id="2441021">buf</span><span class="op" id="2441024">[</span><span class="op" id="2441025">:</span><span class="num" id="2441026">0</span><span class="op" id="2441027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441030">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441039">if</span>&nbsp;<span class="ident" id="2441042">s</span><span class="op" id="2441043">.</span><span class="ident" id="2441044">accept</span><span class="op" id="2441050">(</span><span class="string" id="2441051">&#34;nN&#34;</span><span class="op" id="2441055">)</span>&nbsp;<span class="op" id="2441057">&amp;&amp;</span>&nbsp;<span class="ident" id="2441060">s</span><span class="op" id="2441061">.</span><span class="ident" id="2441062">accept</span><span class="op" id="2441068">(</span><span class="string" id="2441069">&#34;aA&#34;</span><span class="op" id="2441073">)</span>&nbsp;<span class="op" id="2441075">&amp;&amp;</span>&nbsp;<span class="ident" id="2441078">s</span><span class="op" id="2441079">.</span><span class="ident" id="2441080">accept</span><span class="op" id="2441086">(</span><span class="string" id="2441087">&#34;nN&#34;</span><span class="op" id="2441091">)</span>&nbsp;<span class="op" id="2441093">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441097">return</span>&nbsp;<span class="builtintype" id="2441104">string</span><span class="op" id="2441110">(</span><span class="ident" id="2441111">s</span><span class="op" id="2441112">.</span><span class="ident" id="2441113">buf</span><span class="op" id="2441116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441122">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441140">s</span><span class="op" id="2441141">.</span><span class="ident" id="2441142">accept</span><span class="op" id="2441148">(</span><span class="ident" id="2441149">sign</span><span class="op" id="2441153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441156">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441165">if</span>&nbsp;<span class="ident" id="2441168">s</span><span class="op" id="2441169">.</span><span class="ident" id="2441170">accept</span><span class="op" id="2441176">(</span><span class="string" id="2441177">&#34;iI&#34;</span><span class="op" id="2441181">)</span>&nbsp;<span class="op" id="2441183">&amp;&amp;</span>&nbsp;<span class="ident" id="2441186">s</span><span class="op" id="2441187">.</span><span class="ident" id="2441188">accept</span><span class="op" id="2441194">(</span><span class="string" id="2441195">&#34;nN&#34;</span><span class="op" id="2441199">)</span>&nbsp;<span class="op" id="2441201">&amp;&amp;</span>&nbsp;<span class="ident" id="2441204">s</span><span class="op" id="2441205">.</span><span class="ident" id="2441206">accept</span><span class="op" id="2441212">(</span><span class="string" id="2441213">&#34;fF&#34;</span><span class="op" id="2441217">)</span>&nbsp;<span class="op" id="2441219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441223">return</span>&nbsp;<span class="builtintype" id="2441230">string</span><span class="op" id="2441236">(</span><span class="ident" id="2441237">s</span><span class="op" id="2441238">.</span><span class="ident" id="2441239">buf</span><span class="op" id="2441242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441248">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441260">for</span>&nbsp;<span class="ident" id="2441264">s</span><span class="op" id="2441265">.</span><span class="ident" id="2441266">accept</span><span class="op" id="2441272">(</span><span class="ident" id="2441273">decimalDigits</span><span class="op" id="2441286">)</span>&nbsp;<span class="op" id="2441288">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441294">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441313">if</span>&nbsp;<span class="ident" id="2441316">s</span><span class="op" id="2441317">.</span><span class="ident" id="2441318">accept</span><span class="op" id="2441324">(</span><span class="ident" id="2441325">period</span><span class="op" id="2441331">)</span>&nbsp;<span class="op" id="2441333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441337">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441352">for</span>&nbsp;<span class="ident" id="2441356">s</span><span class="op" id="2441357">.</span><span class="ident" id="2441358">accept</span><span class="op" id="2441364">(</span><span class="ident" id="2441365">decimalDigits</span><span class="op" id="2441378">)</span>&nbsp;<span class="op" id="2441380">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441390">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441404">if</span>&nbsp;<span class="ident" id="2441407">s</span><span class="op" id="2441408">.</span><span class="ident" id="2441409">accept</span><span class="op" id="2441415">(</span><span class="ident" id="2441416">exponent</span><span class="op" id="2441424">)</span>&nbsp;<span class="op" id="2441426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441430">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441449">s</span><span class="op" id="2441450">.</span><span class="ident" id="2441451">accept</span><span class="op" id="2441457">(</span><span class="ident" id="2441458">sign</span><span class="op" id="2441462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441466">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441479">for</span>&nbsp;<span class="ident" id="2441483">s</span><span class="op" id="2441484">.</span><span class="ident" id="2441485">accept</span><span class="op" id="2441491">(</span><span class="ident" id="2441492">decimalDigits</span><span class="op" id="2441505">)</span>&nbsp;<span class="op" id="2441507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441514">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441517">return</span>&nbsp;<span class="builtintype" id="2441524">string</span><span class="op" id="2441530">(</span><span class="ident" id="2441531">s</span><span class="op" id="2441532">.</span><span class="ident" id="2441533">buf</span><span class="op" id="2441536">)</span><br>
<span class="lineno"></span><span class="op" id="2441538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2441541">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2441632">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2441723">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2441765">func</span>&nbsp;<span class="op" id="2441770">(</span><span class="ident" id="2441771">s</span>&nbsp;<span class="op" id="2441773">*</span><span class="ident" id="2441774">ss</span><span class="op" id="2441776">)</span>&nbsp;<span class="ident" id="2441778">complexTokens</span><span class="op" id="2441791">(</span><span class="op" id="2441792">)</span>&nbsp;<span class="op" id="2441794">(</span><span class="builtinfunc" id="2441795">real</span><span class="op" id="2441799">,</span>&nbsp;<span class="builtinfunc" id="2441801">imag</span>&nbsp;<span class="builtintype" id="2441806">string</span><span class="op" id="2441812">)</span>&nbsp;<span class="op" id="2441814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441817">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441858">parens</span>&nbsp;<span class="op" id="2441865">:=</span>&nbsp;<span class="ident" id="2441868">s</span><span class="op" id="2441869">.</span><span class="ident" id="2441870">accept</span><span class="op" id="2441876">(</span><span class="string" id="2441877">&#34;(&#34;</span><span class="op" id="2441880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2441883">real</span>&nbsp;<span class="op" id="2441888">=</span>&nbsp;<span class="ident" id="2441890">s</span><span class="op" id="2441891">.</span><span class="ident" id="2441892">floatToken</span><span class="op" id="2441902">(</span><span class="op" id="2441903">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441906">s</span><span class="op" id="2441907">.</span><span class="ident" id="2441908">buf</span>&nbsp;<span class="op" id="2441912">=</span>&nbsp;<span class="ident" id="2441914">s</span><span class="op" id="2441915">.</span><span class="ident" id="2441916">buf</span><span class="op" id="2441919">[</span><span class="op" id="2441920">:</span><span class="num" id="2441921">0</span><span class="op" id="2441922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441925">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441951">if</span>&nbsp;<span class="op" id="2441954">!</span><span class="ident" id="2441955">s</span><span class="op" id="2441956">.</span><span class="ident" id="2441957">accept</span><span class="op" id="2441963">(</span><span class="string" id="2441964">&#34;+-&#34;</span><span class="op" id="2441968">)</span>&nbsp;<span class="op" id="2441970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441974">s</span><span class="op" id="2441975">.</span><span class="builtintype" id="2441976">error</span><span class="op" id="2441981">(</span><span class="ident" id="2441982">complexError</span><span class="op" id="2441994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441997">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442000">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442026">imagSign</span>&nbsp;<span class="op" id="2442035">:=</span>&nbsp;<span class="builtintype" id="2442038">string</span><span class="op" id="2442044">(</span><span class="ident" id="2442045">s</span><span class="op" id="2442046">.</span><span class="ident" id="2442047">buf</span><span class="op" id="2442050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2442053">imag</span>&nbsp;<span class="op" id="2442058">=</span>&nbsp;<span class="ident" id="2442060">s</span><span class="op" id="2442061">.</span><span class="ident" id="2442062">floatToken</span><span class="op" id="2442072">(</span><span class="op" id="2442073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442076">if</span>&nbsp;<span class="op" id="2442079">!</span><span class="ident" id="2442080">s</span><span class="op" id="2442081">.</span><span class="ident" id="2442082">accept</span><span class="op" id="2442088">(</span><span class="string" id="2442089">&#34;i&#34;</span><span class="op" id="2442092">)</span>&nbsp;<span class="op" id="2442094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442098">s</span><span class="op" id="2442099">.</span><span class="builtintype" id="2442100">error</span><span class="op" id="2442105">(</span><span class="ident" id="2442106">complexError</span><span class="op" id="2442118">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442124">if</span>&nbsp;<span class="ident" id="2442127">parens</span>&nbsp;<span class="op" id="2442134">&amp;&amp;</span>&nbsp;<span class="op" id="2442137">!</span><span class="ident" id="2442138">s</span><span class="op" id="2442139">.</span><span class="ident" id="2442140">accept</span><span class="op" id="2442146">(</span><span class="string" id="2442147">&#34;)&#34;</span><span class="op" id="2442150">)</span>&nbsp;<span class="op" id="2442152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442156">s</span><span class="op" id="2442157">.</span><span class="builtintype" id="2442158">error</span><span class="op" id="2442163">(</span><span class="ident" id="2442164">complexError</span><span class="op" id="2442176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442182">return</span>&nbsp;<span class="builtinfunc" id="2442189">real</span><span class="op" id="2442193">,</span>&nbsp;<span class="ident" id="2442195">imagSign</span>&nbsp;<span class="op" id="2442204">+</span>&nbsp;<span class="builtinfunc" id="2442206">imag</span><br>
<span class="lineno">770</span><span class="op" id="2442211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2442214">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2442269">func</span>&nbsp;<span class="op" id="2442274">(</span><span class="ident" id="2442275">s</span>&nbsp;<span class="op" id="2442277">*</span><span class="ident" id="2442278">ss</span><span class="op" id="2442280">)</span>&nbsp;<span class="ident" id="2442282">convertFloat</span><span class="op" id="2442294">(</span><span class="ident" id="2442295">str</span>&nbsp;<span class="builtintype" id="2442299">string</span><span class="op" id="2442305">,</span>&nbsp;<span class="ident" id="2442307">n</span>&nbsp;<span class="builtintype" id="2442309">int</span><span class="op" id="2442312">)</span>&nbsp;<span class="builtintype" id="2442314">float64</span>&nbsp;<span class="op" id="2442322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442325">if</span>&nbsp;<span class="ident" id="2442328">p</span>&nbsp;<span class="op" id="2442330">:=</span>&nbsp;<span class="ident" id="2442333">indexRune</span><span class="op" id="2442342">(</span><span class="ident" id="2442343">str</span><span class="op" id="2442346">,</span>&nbsp;<span class="string" id="2442348">&#39;p&#39;</span><span class="op" id="2442351">)</span><span class="op" id="2442352">;</span>&nbsp;<span class="ident" id="2442354">p</span>&nbsp;<span class="op" id="2442356">&gt;=</span>&nbsp;<span class="num" id="2442359">0</span>&nbsp;<span class="op" id="2442361">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442365">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442412">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442447">f</span><span class="op" id="2442448">,</span>&nbsp;<span class="ident" id="2442450">err</span>&nbsp;<span class="op" id="2442454">:=</span>&nbsp;<span class="ident" id="2442457">strconv</span><span class="op" id="2442464">.</span><span class="ident" id="2442465">ParseFloat</span><span class="op" id="2442475">(</span><span class="ident" id="2442476">str</span><span class="op" id="2442479">[</span><span class="op" id="2442480">:</span><span class="ident" id="2442481">p</span><span class="op" id="2442482">]</span><span class="op" id="2442483">,</span>&nbsp;<span class="ident" id="2442485">n</span><span class="op" id="2442486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442490">if</span>&nbsp;<span class="ident" id="2442493">err</span>&nbsp;<span class="op" id="2442497">!=</span>&nbsp;<span class="ident" id="2442500">nil</span>&nbsp;<span class="op" id="2442504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442509">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442543">if</span>&nbsp;<span class="ident" id="2442546">e</span><span class="op" id="2442547">,</span>&nbsp;<span class="ident" id="2442549">ok</span>&nbsp;<span class="op" id="2442552">:=</span>&nbsp;<span class="ident" id="2442555">err</span><span class="op" id="2442558">.</span><span class="op" id="2442559">(</span><span class="op" id="2442560">*</span><span class="ident" id="2442561">strconv</span><span class="op" id="2442568">.</span><span class="ident" id="2442569">NumError</span><span class="op" id="2442577">)</span><span class="op" id="2442578">;</span>&nbsp;<span class="ident" id="2442580">ok</span>&nbsp;<span class="op" id="2442583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442589">e</span><span class="op" id="2442590">.</span><span class="ident" id="2442591">Num</span>&nbsp;<span class="op" id="2442595">=</span>&nbsp;<span class="ident" id="2442597">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442609">s</span><span class="op" id="2442610">.</span><span class="builtintype" id="2442611">error</span><span class="op" id="2442616">(</span><span class="ident" id="2442617">err</span><span class="op" id="2442620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442624">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442628">m</span><span class="op" id="2442629">,</span>&nbsp;<span class="ident" id="2442631">err</span>&nbsp;<span class="op" id="2442635">:=</span>&nbsp;<span class="ident" id="2442638">strconv</span><span class="op" id="2442645">.</span><span class="ident" id="2442646">Atoi</span><span class="op" id="2442650">(</span><span class="ident" id="2442651">str</span><span class="op" id="2442654">[</span><span class="ident" id="2442655">p</span><span class="op" id="2442656">+</span><span class="num" id="2442657">1</span><span class="op" id="2442658">:</span><span class="op" id="2442659">]</span><span class="op" id="2442660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442664">if</span>&nbsp;<span class="ident" id="2442667">err</span>&nbsp;<span class="op" id="2442671">!=</span>&nbsp;<span class="ident" id="2442674">nil</span>&nbsp;<span class="op" id="2442678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442683">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442717">if</span>&nbsp;<span class="ident" id="2442720">e</span><span class="op" id="2442721">,</span>&nbsp;<span class="ident" id="2442723">ok</span>&nbsp;<span class="op" id="2442726">:=</span>&nbsp;<span class="ident" id="2442729">err</span><span class="op" id="2442732">.</span><span class="op" id="2442733">(</span><span class="op" id="2442734">*</span><span class="ident" id="2442735">strconv</span><span class="op" id="2442742">.</span><span class="ident" id="2442743">NumError</span><span class="op" id="2442751">)</span><span class="op" id="2442752">;</span>&nbsp;<span class="ident" id="2442754">ok</span>&nbsp;<span class="op" id="2442757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442763">e</span><span class="op" id="2442764">.</span><span class="ident" id="2442765">Num</span>&nbsp;<span class="op" id="2442769">=</span>&nbsp;<span class="ident" id="2442771">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442783">s</span><span class="op" id="2442784">.</span><span class="builtintype" id="2442785">error</span><span class="op" id="2442790">(</span><span class="ident" id="2442791">err</span><span class="op" id="2442794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442802">return</span>&nbsp;<span class="ident" id="2442809">math</span><span class="op" id="2442813">.</span><span class="ident" id="2442814">Ldexp</span><span class="op" id="2442819">(</span><span class="ident" id="2442820">f</span><span class="op" id="2442821">,</span>&nbsp;<span class="ident" id="2442823">m</span><span class="op" id="2442824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442827">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442830">f</span><span class="op" id="2442831">,</span>&nbsp;<span class="ident" id="2442833">err</span>&nbsp;<span class="op" id="2442837">:=</span>&nbsp;<span class="ident" id="2442840">strconv</span><span class="op" id="2442847">.</span><span class="ident" id="2442848">ParseFloat</span><span class="op" id="2442858">(</span><span class="ident" id="2442859">str</span><span class="op" id="2442862">,</span>&nbsp;<span class="ident" id="2442864">n</span><span class="op" id="2442865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442868">if</span>&nbsp;<span class="ident" id="2442871">err</span>&nbsp;<span class="op" id="2442875">!=</span>&nbsp;<span class="ident" id="2442878">nil</span>&nbsp;<span class="op" id="2442882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442886">s</span><span class="op" id="2442887">.</span><span class="builtintype" id="2442888">error</span><span class="op" id="2442893">(</span><span class="ident" id="2442894">err</span><span class="op" id="2442897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442903">return</span>&nbsp;<span class="ident" id="2442910">f</span><br>
<span class="lineno">800</span><span class="op" id="2442912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2442915">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2442980">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2443052">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2443125">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2443195">func</span>&nbsp;<span class="op" id="2443200">(</span><span class="ident" id="2443201">s</span>&nbsp;<span class="op" id="2443203">*</span><span class="ident" id="2443204">ss</span><span class="op" id="2443206">)</span>&nbsp;<span class="ident" id="2443208">scanComplex</span><span class="op" id="2443219">(</span><span class="ident" id="2443220">verb</span>&nbsp;<span class="builtintype" id="2443225">rune</span><span class="op" id="2443229">,</span>&nbsp;<span class="ident" id="2443231">n</span>&nbsp;<span class="builtintype" id="2443233">int</span><span class="op" id="2443236">)</span>&nbsp;<span class="builtintype" id="2443238">complex128</span>&nbsp;<span class="op" id="2443249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443252">if</span>&nbsp;<span class="op" id="2443255">!</span><span class="ident" id="2443256">s</span><span class="op" id="2443257">.</span><span class="ident" id="2443258">okVerb</span><span class="op" id="2443264">(</span><span class="ident" id="2443265">verb</span><span class="op" id="2443269">,</span>&nbsp;<span class="ident" id="2443271">floatVerbs</span><span class="op" id="2443281">,</span>&nbsp;<span class="string" id="2443283">&#34;complex&#34;</span><span class="op" id="2443292">)</span>&nbsp;<span class="op" id="2443294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443298">return</span>&nbsp;<span class="num" id="2443305">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2443308">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443311">s</span><span class="op" id="2443312">.</span><span class="ident" id="2443313">skipSpace</span><span class="op" id="2443322">(</span><span class="builtintype" id="2443323">false</span><span class="op" id="2443328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443331">s</span><span class="op" id="2443332">.</span><span class="ident" id="2443333">notEOF</span><span class="op" id="2443339">(</span><span class="op" id="2443340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443343">sreal</span><span class="op" id="2443348">,</span>&nbsp;<span class="ident" id="2443350">simag</span>&nbsp;<span class="op" id="2443356">:=</span>&nbsp;<span class="ident" id="2443359">s</span><span class="op" id="2443360">.</span><span class="ident" id="2443361">complexTokens</span><span class="op" id="2443374">(</span><span class="op" id="2443375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2443378">real</span>&nbsp;<span class="op" id="2443383">:=</span>&nbsp;<span class="ident" id="2443386">s</span><span class="op" id="2443387">.</span><span class="ident" id="2443388">convertFloat</span><span class="op" id="2443400">(</span><span class="ident" id="2443401">sreal</span><span class="op" id="2443406">,</span>&nbsp;<span class="ident" id="2443408">n</span><span class="op" id="2443409">/</span><span class="num" id="2443410">2</span><span class="op" id="2443411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2443414">imag</span>&nbsp;<span class="op" id="2443419">:=</span>&nbsp;<span class="ident" id="2443422">s</span><span class="op" id="2443423">.</span><span class="ident" id="2443424">convertFloat</span><span class="op" id="2443436">(</span><span class="ident" id="2443437">simag</span><span class="op" id="2443442">,</span>&nbsp;<span class="ident" id="2443444">n</span><span class="op" id="2443445">/</span><span class="num" id="2443446">2</span><span class="op" id="2443447">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443450">return</span>&nbsp;<span class="builtinfunc" id="2443457">complex</span><span class="op" id="2443464">(</span><span class="builtinfunc" id="2443465">real</span><span class="op" id="2443469">,</span>&nbsp;<span class="builtinfunc" id="2443471">imag</span><span class="op" id="2443475">)</span><br>
<span class="lineno"></span><span class="op" id="2443477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2443480">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2443558">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2443612">func</span>&nbsp;<span class="op" id="2443617">(</span><span class="ident" id="2443618">s</span>&nbsp;<span class="op" id="2443620">*</span><span class="ident" id="2443621">ss</span><span class="op" id="2443623">)</span>&nbsp;<span class="ident" id="2443625">convertString</span><span class="op" id="2443638">(</span><span class="ident" id="2443639">verb</span>&nbsp;<span class="builtintype" id="2443644">rune</span><span class="op" id="2443648">)</span>&nbsp;<span class="op" id="2443650">(</span><span class="ident" id="2443651">str</span>&nbsp;<span class="builtintype" id="2443655">string</span><span class="op" id="2443661">)</span>&nbsp;<span class="op" id="2443663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443666">if</span>&nbsp;<span class="op" id="2443669">!</span><span class="ident" id="2443670">s</span><span class="op" id="2443671">.</span><span class="ident" id="2443672">okVerb</span><span class="op" id="2443678">(</span><span class="ident" id="2443679">verb</span><span class="op" id="2443683">,</span>&nbsp;<span class="string" id="2443685">&#34;svqx&#34;</span><span class="op" id="2443691">,</span>&nbsp;<span class="string" id="2443693">&#34;string&#34;</span><span class="op" id="2443701">)</span>&nbsp;<span class="op" id="2443703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443707">return</span>&nbsp;<span class="string" id="2443714">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2443718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443721">s</span><span class="op" id="2443722">.</span><span class="ident" id="2443723">skipSpace</span><span class="op" id="2443732">(</span><span class="builtintype" id="2443733">false</span><span class="op" id="2443738">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443741">s</span><span class="op" id="2443742">.</span><span class="ident" id="2443743">notEOF</span><span class="op" id="2443749">(</span><span class="op" id="2443750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443753">switch</span>&nbsp;<span class="ident" id="2443760">verb</span>&nbsp;<span class="op" id="2443765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443768">case</span>&nbsp;<span class="string" id="2443773">&#39;q&#39;</span><span class="op" id="2443776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443780">str</span>&nbsp;<span class="op" id="2443784">=</span>&nbsp;<span class="ident" id="2443786">s</span><span class="op" id="2443787">.</span><span class="ident" id="2443788">quotedString</span><span class="op" id="2443800">(</span><span class="op" id="2443801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443804">case</span>&nbsp;<span class="string" id="2443809">&#39;x&#39;</span><span class="op" id="2443812">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443816">str</span>&nbsp;<span class="op" id="2443820">=</span>&nbsp;<span class="ident" id="2443822">s</span><span class="op" id="2443823">.</span><span class="ident" id="2443824">hexString</span><span class="op" id="2443833">(</span><span class="op" id="2443834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443837">default</span><span class="op" id="2443844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443848">str</span>&nbsp;<span class="op" id="2443852">=</span>&nbsp;<span class="builtintype" id="2443854">string</span><span class="op" id="2443860">(</span><span class="ident" id="2443861">s</span><span class="op" id="2443862">.</span><span class="ident" id="2443863">token</span><span class="op" id="2443868">(</span><span class="builtintype" id="2443869">true</span><span class="op" id="2443873">,</span>&nbsp;<span class="ident" id="2443875">notSpace</span><span class="op" id="2443883">)</span><span class="op" id="2443884">)</span>&nbsp;<span class="comment" id="2443886">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2443926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443929">return</span><br>
<span class="lineno">835</span><span class="op" id="2443936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2443939">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2444039">func</span>&nbsp;<span class="op" id="2444044">(</span><span class="ident" id="2444045">s</span>&nbsp;<span class="op" id="2444047">*</span><span class="ident" id="2444048">ss</span><span class="op" id="2444050">)</span>&nbsp;<span class="ident" id="2444052">quotedString</span><span class="op" id="2444064">(</span><span class="op" id="2444065">)</span>&nbsp;<span class="builtintype" id="2444067">string</span>&nbsp;<span class="op" id="2444074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444077">s</span><span class="op" id="2444078">.</span><span class="ident" id="2444079">notEOF</span><span class="op" id="2444085">(</span><span class="op" id="2444086">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444089">quote</span>&nbsp;<span class="op" id="2444095">:=</span>&nbsp;<span class="ident" id="2444098">s</span><span class="op" id="2444099">.</span><span class="ident" id="2444100">getRune</span><span class="op" id="2444107">(</span><span class="op" id="2444108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444111">switch</span>&nbsp;<span class="ident" id="2444118">quote</span>&nbsp;<span class="op" id="2444124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444127">case</span>&nbsp;<span class="string" id="2444132">&#39;`&#39;</span><span class="op" id="2444135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444139">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444196">for</span>&nbsp;<span class="op" id="2444200">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444205">r</span>&nbsp;<span class="op" id="2444207">:=</span>&nbsp;<span class="ident" id="2444210">s</span><span class="op" id="2444211">.</span><span class="ident" id="2444212">mustReadRune</span><span class="op" id="2444224">(</span><span class="op" id="2444225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444230">if</span>&nbsp;<span class="ident" id="2444233">r</span>&nbsp;<span class="op" id="2444235">==</span>&nbsp;<span class="ident" id="2444238">quote</span>&nbsp;<span class="op" id="2444244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444250">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2444259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444264">s</span><span class="op" id="2444265">.</span><span class="ident" id="2444266">buf</span><span class="op" id="2444269">.</span><span class="ident" id="2444270">WriteRune</span><span class="op" id="2444279">(</span><span class="ident" id="2444280">r</span><span class="op" id="2444281">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2444285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444289">return</span>&nbsp;<span class="builtintype" id="2444296">string</span><span class="op" id="2444302">(</span><span class="ident" id="2444303">s</span><span class="op" id="2444304">.</span><span class="ident" id="2444305">buf</span><span class="op" id="2444308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444311">case</span>&nbsp;<span class="string" id="2444316">&#39;&#34;&#39;</span><span class="op" id="2444319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444323">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444412">s</span><span class="op" id="2444413">.</span><span class="ident" id="2444414">buf</span><span class="op" id="2444417">.</span><span class="ident" id="2444418">WriteRune</span><span class="op" id="2444427">(</span><span class="ident" id="2444428">quote</span><span class="op" id="2444433">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444437">for</span>&nbsp;<span class="op" id="2444441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444446">r</span>&nbsp;<span class="op" id="2444448">:=</span>&nbsp;<span class="ident" id="2444451">s</span><span class="op" id="2444452">.</span><span class="ident" id="2444453">mustReadRune</span><span class="op" id="2444465">(</span><span class="op" id="2444466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444471">s</span><span class="op" id="2444472">.</span><span class="ident" id="2444473">buf</span><span class="op" id="2444476">.</span><span class="ident" id="2444477">WriteRune</span><span class="op" id="2444486">(</span><span class="ident" id="2444487">r</span><span class="op" id="2444488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444493">if</span>&nbsp;<span class="ident" id="2444496">r</span>&nbsp;<span class="op" id="2444498">==</span>&nbsp;<span class="string" id="2444501">&#39;\\&#39;</span>&nbsp;<span class="op" id="2444506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444512">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444587">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444659">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444736">s</span><span class="op" id="2444737">.</span><span class="ident" id="2444738">buf</span><span class="op" id="2444741">.</span><span class="ident" id="2444742">WriteRune</span><span class="op" id="2444751">(</span><span class="ident" id="2444752">s</span><span class="op" id="2444753">.</span><span class="ident" id="2444754">mustReadRune</span><span class="op" id="2444766">(</span><span class="op" id="2444767">)</span><span class="op" id="2444768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2444773">}</span>&nbsp;<span class="keyword" id="2444775">else</span>&nbsp;<span class="keyword" id="2444780">if</span>&nbsp;<span class="ident" id="2444783">r</span>&nbsp;<span class="op" id="2444785">==</span>&nbsp;<span class="string" id="2444788">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2444792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444798">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2444807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2444811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444815">result</span><span class="op" id="2444821">,</span>&nbsp;<span class="ident" id="2444823">err</span>&nbsp;<span class="op" id="2444827">:=</span>&nbsp;<span class="ident" id="2444830">strconv</span><span class="op" id="2444837">.</span><span class="ident" id="2444838">Unquote</span><span class="op" id="2444845">(</span><span class="builtintype" id="2444846">string</span><span class="op" id="2444852">(</span><span class="ident" id="2444853">s</span><span class="op" id="2444854">.</span><span class="ident" id="2444855">buf</span><span class="op" id="2444858">)</span><span class="op" id="2444859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444863">if</span>&nbsp;<span class="ident" id="2444866">err</span>&nbsp;<span class="op" id="2444870">!=</span>&nbsp;<span class="ident" id="2444873">nil</span>&nbsp;<span class="op" id="2444877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444882">s</span><span class="op" id="2444883">.</span><span class="builtintype" id="2444884">error</span><span class="op" id="2444889">(</span><span class="ident" id="2444890">err</span><span class="op" id="2444893">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2444897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444901">return</span>&nbsp;<span class="ident" id="2444908">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444916">default</span><span class="op" id="2444923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444927">s</span><span class="op" id="2444928">.</span><span class="ident" id="2444929">errorString</span><span class="op" id="2444940">(</span><span class="string" id="2444941">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2444965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2444968">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444971">return</span>&nbsp;<span class="string" id="2444978">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2444981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2444984">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2445039">func</span>&nbsp;<span class="op" id="2445044">(</span><span class="ident" id="2445045">s</span>&nbsp;<span class="op" id="2445047">*</span><span class="ident" id="2445048">ss</span><span class="op" id="2445050">)</span>&nbsp;<span class="ident" id="2445052">hexDigit</span><span class="op" id="2445060">(</span><span class="ident" id="2445061">d</span>&nbsp;<span class="builtintype" id="2445063">rune</span><span class="op" id="2445067">)</span>&nbsp;<span class="builtintype" id="2445069">int</span>&nbsp;<span class="op" id="2445073">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445076">digit</span>&nbsp;<span class="op" id="2445082">:=</span>&nbsp;<span class="builtintype" id="2445085">int</span><span class="op" id="2445088">(</span><span class="ident" id="2445089">d</span><span class="op" id="2445090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445093">switch</span>&nbsp;<span class="ident" id="2445100">digit</span>&nbsp;<span class="op" id="2445106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445109">case</span>&nbsp;<span class="string" id="2445114">&#39;0&#39;</span><span class="op" id="2445117">,</span>&nbsp;<span class="string" id="2445119">&#39;1&#39;</span><span class="op" id="2445122">,</span>&nbsp;<span class="string" id="2445124">&#39;2&#39;</span><span class="op" id="2445127">,</span>&nbsp;<span class="string" id="2445129">&#39;3&#39;</span><span class="op" id="2445132">,</span>&nbsp;<span class="string" id="2445134">&#39;4&#39;</span><span class="op" id="2445137">,</span>&nbsp;<span class="string" id="2445139">&#39;5&#39;</span><span class="op" id="2445142">,</span>&nbsp;<span class="string" id="2445144">&#39;6&#39;</span><span class="op" id="2445147">,</span>&nbsp;<span class="string" id="2445149">&#39;7&#39;</span><span class="op" id="2445152">,</span>&nbsp;<span class="string" id="2445154">&#39;8&#39;</span><span class="op" id="2445157">,</span>&nbsp;<span class="string" id="2445159">&#39;9&#39;</span><span class="op" id="2445162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445166">return</span>&nbsp;<span class="ident" id="2445173">digit</span>&nbsp;<span class="op" id="2445179">-</span>&nbsp;<span class="string" id="2445181">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445186">case</span>&nbsp;<span class="string" id="2445191">&#39;a&#39;</span><span class="op" id="2445194">,</span>&nbsp;<span class="string" id="2445196">&#39;b&#39;</span><span class="op" id="2445199">,</span>&nbsp;<span class="string" id="2445201">&#39;c&#39;</span><span class="op" id="2445204">,</span>&nbsp;<span class="string" id="2445206">&#39;d&#39;</span><span class="op" id="2445209">,</span>&nbsp;<span class="string" id="2445211">&#39;e&#39;</span><span class="op" id="2445214">,</span>&nbsp;<span class="string" id="2445216">&#39;f&#39;</span><span class="op" id="2445219">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445223">return</span>&nbsp;<span class="num" id="2445230">10</span>&nbsp;<span class="op" id="2445233">+</span>&nbsp;<span class="ident" id="2445235">digit</span>&nbsp;<span class="op" id="2445241">-</span>&nbsp;<span class="string" id="2445243">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445248">case</span>&nbsp;<span class="string" id="2445253">&#39;A&#39;</span><span class="op" id="2445256">,</span>&nbsp;<span class="string" id="2445258">&#39;B&#39;</span><span class="op" id="2445261">,</span>&nbsp;<span class="string" id="2445263">&#39;C&#39;</span><span class="op" id="2445266">,</span>&nbsp;<span class="string" id="2445268">&#39;D&#39;</span><span class="op" id="2445271">,</span>&nbsp;<span class="string" id="2445273">&#39;E&#39;</span><span class="op" id="2445276">,</span>&nbsp;<span class="string" id="2445278">&#39;F&#39;</span><span class="op" id="2445281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445285">return</span>&nbsp;<span class="num" id="2445292">10</span>&nbsp;<span class="op" id="2445295">+</span>&nbsp;<span class="ident" id="2445297">digit</span>&nbsp;<span class="op" id="2445303">-</span>&nbsp;<span class="string" id="2445305">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445313">s</span><span class="op" id="2445314">.</span><span class="ident" id="2445315">errorString</span><span class="op" id="2445326">(</span><span class="string" id="2445327">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2445346">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445349">return</span>&nbsp;<span class="num" id="2445356">0</span><br>
<span class="lineno"></span><span class="op" id="2445358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2445361">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2445438">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2445520">func</span>&nbsp;<span class="op" id="2445525">(</span><span class="ident" id="2445526">s</span>&nbsp;<span class="op" id="2445528">*</span><span class="ident" id="2445529">ss</span><span class="op" id="2445531">)</span>&nbsp;<span class="ident" id="2445533">hexByte</span><span class="op" id="2445540">(</span><span class="op" id="2445541">)</span>&nbsp;<span class="op" id="2445543">(</span><span class="ident" id="2445544">b</span>&nbsp;<span class="builtintype" id="2445546">byte</span><span class="op" id="2445550">,</span>&nbsp;<span class="ident" id="2445552">ok</span>&nbsp;<span class="builtintype" id="2445555">bool</span><span class="op" id="2445559">)</span>&nbsp;<span class="op" id="2445561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445564">rune1</span>&nbsp;<span class="op" id="2445570">:=</span>&nbsp;<span class="ident" id="2445573">s</span><span class="op" id="2445574">.</span><span class="ident" id="2445575">getRune</span><span class="op" id="2445582">(</span><span class="op" id="2445583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445586">if</span>&nbsp;<span class="ident" id="2445589">rune1</span>&nbsp;<span class="op" id="2445595">==</span>&nbsp;<span class="ident" id="2445598">eof</span>&nbsp;<span class="op" id="2445602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445606">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445614">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445617">if</span>&nbsp;<span class="ident" id="2445620">isSpace</span><span class="op" id="2445627">(</span><span class="ident" id="2445628">rune1</span><span class="op" id="2445633">)</span>&nbsp;<span class="op" id="2445635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445639">s</span><span class="op" id="2445640">.</span><span class="ident" id="2445641">UnreadRune</span><span class="op" id="2445651">(</span><span class="op" id="2445652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445656">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445667">rune2</span>&nbsp;<span class="op" id="2445673">:=</span>&nbsp;<span class="ident" id="2445676">s</span><span class="op" id="2445677">.</span><span class="ident" id="2445678">mustReadRune</span><span class="op" id="2445690">(</span><span class="op" id="2445691">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445694">return</span>&nbsp;<span class="builtintype" id="2445701">byte</span><span class="op" id="2445705">(</span><span class="ident" id="2445706">s</span><span class="op" id="2445707">.</span><span class="ident" id="2445708">hexDigit</span><span class="op" id="2445716">(</span><span class="ident" id="2445717">rune1</span><span class="op" id="2445722">)</span><span class="op" id="2445723">&lt;&lt;</span><span class="num" id="2445725">4</span>&nbsp;<span class="op" id="2445727">|</span>&nbsp;<span class="ident" id="2445729">s</span><span class="op" id="2445730">.</span><span class="ident" id="2445731">hexDigit</span><span class="op" id="2445739">(</span><span class="ident" id="2445740">rune2</span><span class="op" id="2445745">)</span><span class="op" id="2445746">)</span><span class="op" id="2445747">,</span>&nbsp;<span class="builtintype" id="2445749">true</span><br>
<span class="lineno"></span><span class="op" id="2445754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2445757">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2445822">func</span>&nbsp;<span class="op" id="2445827">(</span><span class="ident" id="2445828">s</span>&nbsp;<span class="op" id="2445830">*</span><span class="ident" id="2445831">ss</span><span class="op" id="2445833">)</span>&nbsp;<span class="ident" id="2445835">hexString</span><span class="op" id="2445844">(</span><span class="op" id="2445845">)</span>&nbsp;<span class="builtintype" id="2445847">string</span>&nbsp;<span class="op" id="2445854">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445857">s</span><span class="op" id="2445858">.</span><span class="ident" id="2445859">notEOF</span><span class="op" id="2445865">(</span><span class="op" id="2445866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445869">for</span>&nbsp;<span class="op" id="2445873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445877">b</span><span class="op" id="2445878">,</span>&nbsp;<span class="ident" id="2445880">ok</span>&nbsp;<span class="op" id="2445883">:=</span>&nbsp;<span class="ident" id="2445886">s</span><span class="op" id="2445887">.</span><span class="ident" id="2445888">hexByte</span><span class="op" id="2445895">(</span><span class="op" id="2445896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445900">if</span>&nbsp;<span class="op" id="2445903">!</span><span class="ident" id="2445904">ok</span>&nbsp;<span class="op" id="2445907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445912">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445924">s</span><span class="op" id="2445925">.</span><span class="ident" id="2445926">buf</span><span class="op" id="2445929">.</span><span class="ident" id="2445930">WriteByte</span><span class="op" id="2445939">(</span><span class="ident" id="2445940">b</span><span class="op" id="2445941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445947">if</span>&nbsp;<span class="builtinfunc" id="2445950">len</span><span class="op" id="2445953">(</span><span class="ident" id="2445954">s</span><span class="op" id="2445955">.</span><span class="ident" id="2445956">buf</span><span class="op" id="2445959">)</span>&nbsp;<span class="op" id="2445961">==</span>&nbsp;<span class="num" id="2445964">0</span>&nbsp;<span class="op" id="2445966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445970">s</span><span class="op" id="2445971">.</span><span class="ident" id="2445972">errorString</span><span class="op" id="2445983">(</span><span class="string" id="2445984">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2446011">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446015">return</span>&nbsp;<span class="string" id="2446022">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446029">return</span>&nbsp;<span class="builtintype" id="2446036">string</span><span class="op" id="2446042">(</span><span class="ident" id="2446043">s</span><span class="op" id="2446044">.</span><span class="ident" id="2446045">buf</span><span class="op" id="2446048">)</span><br>
<span class="lineno"></span><span class="op" id="2446050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2446053">const</span>&nbsp;<span class="ident" id="2446059">floatVerbs</span>&nbsp;<span class="op" id="2446070">=</span>&nbsp;<span class="string" id="2446072">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2446084">const</span>&nbsp;<span class="ident" id="2446090">hugeWid</span>&nbsp;<span class="op" id="2446098">=</span>&nbsp;<span class="num" id="2446100">1</span>&nbsp;<span class="op" id="2446102">&lt;&lt;</span>&nbsp;<span class="num" id="2446105">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2446109">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2446194">func</span>&nbsp;<span class="op" id="2446199">(</span><span class="ident" id="2446200">s</span>&nbsp;<span class="op" id="2446202">*</span><span class="ident" id="2446203">ss</span><span class="op" id="2446205">)</span>&nbsp;<span class="ident" id="2446207">scanOne</span><span class="op" id="2446214">(</span><span class="ident" id="2446215">verb</span>&nbsp;<span class="builtintype" id="2446220">rune</span><span class="op" id="2446224">,</span>&nbsp;<span class="ident" id="2446226">arg</span>&nbsp;<span class="keyword" id="2446230">interface</span><span class="op" id="2446239">{</span><span class="op" id="2446240">}</span><span class="op" id="2446241">)</span>&nbsp;<span class="op" id="2446243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446246">s</span><span class="op" id="2446247">.</span><span class="ident" id="2446248">buf</span>&nbsp;<span class="op" id="2446252">=</span>&nbsp;<span class="ident" id="2446254">s</span><span class="op" id="2446255">.</span><span class="ident" id="2446256">buf</span><span class="op" id="2446259">[</span><span class="op" id="2446260">:</span><span class="num" id="2446261">0</span><span class="op" id="2446262">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446265">var</span>&nbsp;<span class="ident" id="2446269">err</span>&nbsp;<span class="builtintype" id="2446273">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2446280">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446336">if</span>&nbsp;<span class="ident" id="2446339">v</span><span class="op" id="2446340">,</span>&nbsp;<span class="ident" id="2446342">ok</span>&nbsp;<span class="op" id="2446345">:=</span>&nbsp;<span class="ident" id="2446348">arg</span><span class="op" id="2446351">.</span><span class="op" id="2446352">(</span><span class="ident" id="2446353">Scanner</span><span class="op" id="2446360">)</span><span class="op" id="2446361">;</span>&nbsp;<span class="ident" id="2446363">ok</span>&nbsp;<span class="op" id="2446366">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446370">err</span>&nbsp;<span class="op" id="2446374">=</span>&nbsp;<span class="ident" id="2446376">v</span><span class="op" id="2446377">.</span><span class="ident" id="2446378">Scan</span><span class="op" id="2446382">(</span><span class="ident" id="2446383">s</span><span class="op" id="2446384">,</span>&nbsp;<span class="ident" id="2446386">verb</span><span class="op" id="2446390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446394">if</span>&nbsp;<span class="ident" id="2446397">err</span>&nbsp;<span class="op" id="2446401">!=</span>&nbsp;<span class="ident" id="2446404">nil</span>&nbsp;<span class="op" id="2446408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446413">if</span>&nbsp;<span class="ident" id="2446416">err</span>&nbsp;<span class="op" id="2446420">==</span>&nbsp;<span class="ident" id="2446423">io</span><span class="op" id="2446425">.</span><span class="ident" id="2446426">EOF</span>&nbsp;<span class="op" id="2446430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446436">err</span>&nbsp;<span class="op" id="2446440">=</span>&nbsp;<span class="ident" id="2446442">io</span><span class="op" id="2446444">.</span><span class="ident" id="2446445">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446465">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446470">s</span><span class="op" id="2446471">.</span><span class="builtintype" id="2446472">error</span><span class="op" id="2446477">(</span><span class="ident" id="2446478">err</span><span class="op" id="2446481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446489">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446501">switch</span>&nbsp;<span class="ident" id="2446508">v</span>&nbsp;<span class="op" id="2446510">:=</span>&nbsp;<span class="ident" id="2446513">arg</span><span class="op" id="2446516">.</span><span class="op" id="2446517">(</span><span class="keyword" id="2446518">type</span><span class="op" id="2446522">)</span>&nbsp;<span class="op" id="2446524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446527">case</span>&nbsp;<span class="op" id="2446532">*</span><span class="builtintype" id="2446533">bool</span><span class="op" id="2446537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446541">*</span><span class="ident" id="2446542">v</span>&nbsp;<span class="op" id="2446544">=</span>&nbsp;<span class="ident" id="2446546">s</span><span class="op" id="2446547">.</span><span class="ident" id="2446548">scanBool</span><span class="op" id="2446556">(</span><span class="ident" id="2446557">verb</span><span class="op" id="2446561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446564">case</span>&nbsp;<span class="op" id="2446569">*</span><span class="builtintype" id="2446570">complex64</span><span class="op" id="2446579">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446583">*</span><span class="ident" id="2446584">v</span>&nbsp;<span class="op" id="2446586">=</span>&nbsp;<span class="builtintype" id="2446588">complex64</span><span class="op" id="2446597">(</span><span class="ident" id="2446598">s</span><span class="op" id="2446599">.</span><span class="ident" id="2446600">scanComplex</span><span class="op" id="2446611">(</span><span class="ident" id="2446612">verb</span><span class="op" id="2446616">,</span>&nbsp;<span class="num" id="2446618">64</span><span class="op" id="2446620">)</span><span class="op" id="2446621">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446624">case</span>&nbsp;<span class="op" id="2446629">*</span><span class="builtintype" id="2446630">complex128</span><span class="op" id="2446640">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446644">*</span><span class="ident" id="2446645">v</span>&nbsp;<span class="op" id="2446647">=</span>&nbsp;<span class="ident" id="2446649">s</span><span class="op" id="2446650">.</span><span class="ident" id="2446651">scanComplex</span><span class="op" id="2446662">(</span><span class="ident" id="2446663">verb</span><span class="op" id="2446667">,</span>&nbsp;<span class="num" id="2446669">128</span><span class="op" id="2446672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446675">case</span>&nbsp;<span class="op" id="2446680">*</span><span class="builtintype" id="2446681">int</span><span class="op" id="2446684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446688">*</span><span class="ident" id="2446689">v</span>&nbsp;<span class="op" id="2446691">=</span>&nbsp;<span class="builtintype" id="2446693">int</span><span class="op" id="2446696">(</span><span class="ident" id="2446697">s</span><span class="op" id="2446698">.</span><span class="ident" id="2446699">scanInt</span><span class="op" id="2446706">(</span><span class="ident" id="2446707">verb</span><span class="op" id="2446711">,</span>&nbsp;<span class="ident" id="2446713">intBits</span><span class="op" id="2446720">)</span><span class="op" id="2446721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446724">case</span>&nbsp;<span class="op" id="2446729">*</span><span class="builtintype" id="2446730">int8</span><span class="op" id="2446734">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446738">*</span><span class="ident" id="2446739">v</span>&nbsp;<span class="op" id="2446741">=</span>&nbsp;<span class="builtintype" id="2446743">int8</span><span class="op" id="2446747">(</span><span class="ident" id="2446748">s</span><span class="op" id="2446749">.</span><span class="ident" id="2446750">scanInt</span><span class="op" id="2446757">(</span><span class="ident" id="2446758">verb</span><span class="op" id="2446762">,</span>&nbsp;<span class="num" id="2446764">8</span><span class="op" id="2446765">)</span><span class="op" id="2446766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446769">case</span>&nbsp;<span class="op" id="2446774">*</span><span class="builtintype" id="2446775">int16</span><span class="op" id="2446780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446784">*</span><span class="ident" id="2446785">v</span>&nbsp;<span class="op" id="2446787">=</span>&nbsp;<span class="builtintype" id="2446789">int16</span><span class="op" id="2446794">(</span><span class="ident" id="2446795">s</span><span class="op" id="2446796">.</span><span class="ident" id="2446797">scanInt</span><span class="op" id="2446804">(</span><span class="ident" id="2446805">verb</span><span class="op" id="2446809">,</span>&nbsp;<span class="num" id="2446811">16</span><span class="op" id="2446813">)</span><span class="op" id="2446814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446817">case</span>&nbsp;<span class="op" id="2446822">*</span><span class="builtintype" id="2446823">int32</span><span class="op" id="2446828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446832">*</span><span class="ident" id="2446833">v</span>&nbsp;<span class="op" id="2446835">=</span>&nbsp;<span class="builtintype" id="2446837">int32</span><span class="op" id="2446842">(</span><span class="ident" id="2446843">s</span><span class="op" id="2446844">.</span><span class="ident" id="2446845">scanInt</span><span class="op" id="2446852">(</span><span class="ident" id="2446853">verb</span><span class="op" id="2446857">,</span>&nbsp;<span class="num" id="2446859">32</span><span class="op" id="2446861">)</span><span class="op" id="2446862">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446865">case</span>&nbsp;<span class="op" id="2446870">*</span><span class="ident" id="2446871">int64</span><span class="op" id="2446876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446880">*</span><span class="ident" id="2446881">v</span>&nbsp;<span class="op" id="2446883">=</span>&nbsp;<span class="ident" id="2446885">s</span><span class="op" id="2446886">.</span><span class="ident" id="2446887">scanInt</span><span class="op" id="2446894">(</span><span class="ident" id="2446895">verb</span><span class="op" id="2446899">,</span>&nbsp;<span class="num" id="2446901">64</span><span class="op" id="2446903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446906">case</span>&nbsp;<span class="op" id="2446911">*</span><span class="builtintype" id="2446912">uint</span><span class="op" id="2446916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446920">*</span><span class="ident" id="2446921">v</span>&nbsp;<span class="op" id="2446923">=</span>&nbsp;<span class="builtintype" id="2446925">uint</span><span class="op" id="2446929">(</span><span class="ident" id="2446930">s</span><span class="op" id="2446931">.</span><span class="ident" id="2446932">scanUint</span><span class="op" id="2446940">(</span><span class="ident" id="2446941">verb</span><span class="op" id="2446945">,</span>&nbsp;<span class="ident" id="2446947">intBits</span><span class="op" id="2446954">)</span><span class="op" id="2446955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446958">case</span>&nbsp;<span class="op" id="2446963">*</span><span class="builtintype" id="2446964">uint8</span><span class="op" id="2446969">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446973">*</span><span class="ident" id="2446974">v</span>&nbsp;<span class="op" id="2446976">=</span>&nbsp;<span class="builtintype" id="2446978">uint8</span><span class="op" id="2446983">(</span><span class="ident" id="2446984">s</span><span class="op" id="2446985">.</span><span class="ident" id="2446986">scanUint</span><span class="op" id="2446994">(</span><span class="ident" id="2446995">verb</span><span class="op" id="2446999">,</span>&nbsp;<span class="num" id="2447001">8</span><span class="op" id="2447002">)</span><span class="op" id="2447003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447006">case</span>&nbsp;<span class="op" id="2447011">*</span><span class="builtintype" id="2447012">uint16</span><span class="op" id="2447018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447022">*</span><span class="ident" id="2447023">v</span>&nbsp;<span class="op" id="2447025">=</span>&nbsp;<span class="builtintype" id="2447027">uint16</span><span class="op" id="2447033">(</span><span class="ident" id="2447034">s</span><span class="op" id="2447035">.</span><span class="ident" id="2447036">scanUint</span><span class="op" id="2447044">(</span><span class="ident" id="2447045">verb</span><span class="op" id="2447049">,</span>&nbsp;<span class="num" id="2447051">16</span><span class="op" id="2447053">)</span><span class="op" id="2447054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447057">case</span>&nbsp;<span class="op" id="2447062">*</span><span class="builtintype" id="2447063">uint32</span><span class="op" id="2447069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447073">*</span><span class="ident" id="2447074">v</span>&nbsp;<span class="op" id="2447076">=</span>&nbsp;<span class="builtintype" id="2447078">uint32</span><span class="op" id="2447084">(</span><span class="ident" id="2447085">s</span><span class="op" id="2447086">.</span><span class="ident" id="2447087">scanUint</span><span class="op" id="2447095">(</span><span class="ident" id="2447096">verb</span><span class="op" id="2447100">,</span>&nbsp;<span class="num" id="2447102">32</span><span class="op" id="2447104">)</span><span class="op" id="2447105">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447108">case</span>&nbsp;<span class="op" id="2447113">*</span><span class="ident" id="2447114">uint64</span><span class="op" id="2447120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447124">*</span><span class="ident" id="2447125">v</span>&nbsp;<span class="op" id="2447127">=</span>&nbsp;<span class="ident" id="2447129">s</span><span class="op" id="2447130">.</span><span class="ident" id="2447131">scanUint</span><span class="op" id="2447139">(</span><span class="ident" id="2447140">verb</span><span class="op" id="2447144">,</span>&nbsp;<span class="num" id="2447146">64</span><span class="op" id="2447148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447151">case</span>&nbsp;<span class="op" id="2447156">*</span><span class="builtintype" id="2447157">uintptr</span><span class="op" id="2447164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447168">*</span><span class="ident" id="2447169">v</span>&nbsp;<span class="op" id="2447171">=</span>&nbsp;<span class="builtintype" id="2447173">uintptr</span><span class="op" id="2447180">(</span><span class="ident" id="2447181">s</span><span class="op" id="2447182">.</span><span class="ident" id="2447183">scanUint</span><span class="op" id="2447191">(</span><span class="ident" id="2447192">verb</span><span class="op" id="2447196">,</span>&nbsp;<span class="ident" id="2447198">uintptrBits</span><span class="op" id="2447209">)</span><span class="op" id="2447210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447213">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447296">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447386">case</span>&nbsp;<span class="op" id="2447391">*</span><span class="builtintype" id="2447392">float32</span><span class="op" id="2447399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447403">if</span>&nbsp;<span class="ident" id="2447406">s</span><span class="op" id="2447407">.</span><span class="ident" id="2447408">okVerb</span><span class="op" id="2447414">(</span><span class="ident" id="2447415">verb</span><span class="op" id="2447419">,</span>&nbsp;<span class="ident" id="2447421">floatVerbs</span><span class="op" id="2447431">,</span>&nbsp;<span class="string" id="2447433">&#34;float32&#34;</span><span class="op" id="2447442">)</span>&nbsp;<span class="op" id="2447444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447449">s</span><span class="op" id="2447450">.</span><span class="ident" id="2447451">skipSpace</span><span class="op" id="2447460">(</span><span class="builtintype" id="2447461">false</span><span class="op" id="2447466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447471">s</span><span class="op" id="2447472">.</span><span class="ident" id="2447473">notEOF</span><span class="op" id="2447479">(</span><span class="op" id="2447480">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447485">*</span><span class="ident" id="2447486">v</span>&nbsp;<span class="op" id="2447488">=</span>&nbsp;<span class="builtintype" id="2447490">float32</span><span class="op" id="2447497">(</span><span class="ident" id="2447498">s</span><span class="op" id="2447499">.</span><span class="ident" id="2447500">convertFloat</span><span class="op" id="2447512">(</span><span class="ident" id="2447513">s</span><span class="op" id="2447514">.</span><span class="ident" id="2447515">floatToken</span><span class="op" id="2447525">(</span><span class="op" id="2447526">)</span><span class="op" id="2447527">,</span>&nbsp;<span class="num" id="2447529">32</span><span class="op" id="2447531">)</span><span class="op" id="2447532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447539">case</span>&nbsp;<span class="op" id="2447544">*</span><span class="builtintype" id="2447545">float64</span><span class="op" id="2447552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447556">if</span>&nbsp;<span class="ident" id="2447559">s</span><span class="op" id="2447560">.</span><span class="ident" id="2447561">okVerb</span><span class="op" id="2447567">(</span><span class="ident" id="2447568">verb</span><span class="op" id="2447572">,</span>&nbsp;<span class="ident" id="2447574">floatVerbs</span><span class="op" id="2447584">,</span>&nbsp;<span class="string" id="2447586">&#34;float64&#34;</span><span class="op" id="2447595">)</span>&nbsp;<span class="op" id="2447597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447602">s</span><span class="op" id="2447603">.</span><span class="ident" id="2447604">skipSpace</span><span class="op" id="2447613">(</span><span class="builtintype" id="2447614">false</span><span class="op" id="2447619">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447624">s</span><span class="op" id="2447625">.</span><span class="ident" id="2447626">notEOF</span><span class="op" id="2447632">(</span><span class="op" id="2447633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447638">*</span><span class="ident" id="2447639">v</span>&nbsp;<span class="op" id="2447641">=</span>&nbsp;<span class="ident" id="2447643">s</span><span class="op" id="2447644">.</span><span class="ident" id="2447645">convertFloat</span><span class="op" id="2447657">(</span><span class="ident" id="2447658">s</span><span class="op" id="2447659">.</span><span class="ident" id="2447660">floatToken</span><span class="op" id="2447670">(</span><span class="op" id="2447671">)</span><span class="op" id="2447672">,</span>&nbsp;<span class="num" id="2447674">64</span><span class="op" id="2447676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447683">case</span>&nbsp;<span class="op" id="2447688">*</span><span class="builtintype" id="2447689">string</span><span class="op" id="2447695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447699">*</span><span class="ident" id="2447700">v</span>&nbsp;<span class="op" id="2447702">=</span>&nbsp;<span class="ident" id="2447704">s</span><span class="op" id="2447705">.</span><span class="ident" id="2447706">convertString</span><span class="op" id="2447719">(</span><span class="ident" id="2447720">verb</span><span class="op" id="2447724">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447727">case</span>&nbsp;<span class="op" id="2447732">*</span><span class="op" id="2447733">[</span><span class="op" id="2447734">]</span><span class="builtintype" id="2447735">byte</span><span class="op" id="2447739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447743">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447808">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447874">*</span><span class="ident" id="2447875">v</span>&nbsp;<span class="op" id="2447877">=</span>&nbsp;<span class="op" id="2447879">[</span><span class="op" id="2447880">]</span><span class="builtintype" id="2447881">byte</span><span class="op" id="2447885">(</span><span class="ident" id="2447886">s</span><span class="op" id="2447887">.</span><span class="ident" id="2447888">convertString</span><span class="op" id="2447901">(</span><span class="ident" id="2447902">verb</span><span class="op" id="2447906">)</span><span class="op" id="2447907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447910">default</span><span class="op" id="2447917">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447921">val</span>&nbsp;<span class="op" id="2447925">:=</span>&nbsp;<span class="ident" id="2447928">reflect</span><span class="op" id="2447935">.</span><span class="ident" id="2447936">ValueOf</span><span class="op" id="2447943">(</span><span class="ident" id="2447944">v</span><span class="op" id="2447945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447949">ptr</span>&nbsp;<span class="op" id="2447953">:=</span>&nbsp;<span class="ident" id="2447956">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447962">if</span>&nbsp;<span class="ident" id="2447965">ptr</span><span class="op" id="2447968">.</span><span class="ident" id="2447969">Kind</span><span class="op" id="2447973">(</span><span class="op" id="2447974">)</span>&nbsp;<span class="op" id="2447976">!=</span>&nbsp;<span class="ident" id="2447979">reflect</span><span class="op" id="2447986">.</span><span class="ident" id="2447987">Ptr</span>&nbsp;<span class="op" id="2447991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447996">s</span><span class="op" id="2447997">.</span><span class="ident" id="2447998">errorString</span><span class="op" id="2448009">(</span><span class="string" id="2448010">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2448033">+</span>&nbsp;<span class="ident" id="2448035">val</span><span class="op" id="2448038">.</span><span class="ident" id="2448039">Type</span><span class="op" id="2448043">(</span><span class="op" id="2448044">)</span><span class="op" id="2448045">.</span><span class="ident" id="2448046">String</span><span class="op" id="2448052">(</span><span class="op" id="2448053">)</span><span class="op" id="2448054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448059">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448072">switch</span>&nbsp;<span class="ident" id="2448079">v</span>&nbsp;<span class="op" id="2448081">:=</span>&nbsp;<span class="ident" id="2448084">ptr</span><span class="op" id="2448087">.</span><span class="ident" id="2448088">Elem</span><span class="op" id="2448092">(</span><span class="op" id="2448093">)</span><span class="op" id="2448094">;</span>&nbsp;<span class="ident" id="2448096">v</span><span class="op" id="2448097">.</span><span class="ident" id="2448098">Kind</span><span class="op" id="2448102">(</span><span class="op" id="2448103">)</span>&nbsp;<span class="op" id="2448105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448109">case</span>&nbsp;<span class="ident" id="2448114">reflect</span><span class="op" id="2448121">.</span><span class="ident" id="2448122">Bool</span><span class="op" id="2448126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448131">v</span><span class="op" id="2448132">.</span><span class="ident" id="2448133">SetBool</span><span class="op" id="2448140">(</span><span class="ident" id="2448141">s</span><span class="op" id="2448142">.</span><span class="ident" id="2448143">scanBool</span><span class="op" id="2448151">(</span><span class="ident" id="2448152">verb</span><span class="op" id="2448156">)</span><span class="op" id="2448157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448161">case</span>&nbsp;<span class="ident" id="2448166">reflect</span><span class="op" id="2448173">.</span><span class="ident" id="2448174">Int</span><span class="op" id="2448177">,</span>&nbsp;<span class="ident" id="2448179">reflect</span><span class="op" id="2448186">.</span><span class="ident" id="2448187">Int8</span><span class="op" id="2448191">,</span>&nbsp;<span class="ident" id="2448193">reflect</span><span class="op" id="2448200">.</span><span class="ident" id="2448201">Int16</span><span class="op" id="2448206">,</span>&nbsp;<span class="ident" id="2448208">reflect</span><span class="op" id="2448215">.</span><span class="ident" id="2448216">Int32</span><span class="op" id="2448221">,</span>&nbsp;<span class="ident" id="2448223">reflect</span><span class="op" id="2448230">.</span><span class="ident" id="2448231">Int64</span><span class="op" id="2448236">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448241">v</span><span class="op" id="2448242">.</span><span class="ident" id="2448243">SetInt</span><span class="op" id="2448249">(</span><span class="ident" id="2448250">s</span><span class="op" id="2448251">.</span><span class="ident" id="2448252">scanInt</span><span class="op" id="2448259">(</span><span class="ident" id="2448260">verb</span><span class="op" id="2448264">,</span>&nbsp;<span class="ident" id="2448266">v</span><span class="op" id="2448267">.</span><span class="ident" id="2448268">Type</span><span class="op" id="2448272">(</span><span class="op" id="2448273">)</span><span class="op" id="2448274">.</span><span class="ident" id="2448275">Bits</span><span class="op" id="2448279">(</span><span class="op" id="2448280">)</span><span class="op" id="2448281">)</span><span class="op" id="2448282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448286">case</span>&nbsp;<span class="ident" id="2448291">reflect</span><span class="op" id="2448298">.</span><span class="ident" id="2448299">Uint</span><span class="op" id="2448303">,</span>&nbsp;<span class="ident" id="2448305">reflect</span><span class="op" id="2448312">.</span><span class="ident" id="2448313">Uint8</span><span class="op" id="2448318">,</span>&nbsp;<span class="ident" id="2448320">reflect</span><span class="op" id="2448327">.</span><span class="ident" id="2448328">Uint16</span><span class="op" id="2448334">,</span>&nbsp;<span class="ident" id="2448336">reflect</span><span class="op" id="2448343">.</span><span class="ident" id="2448344">Uint32</span><span class="op" id="2448350">,</span>&nbsp;<span class="ident" id="2448352">reflect</span><span class="op" id="2448359">.</span><span class="ident" id="2448360">Uint64</span><span class="op" id="2448366">,</span>&nbsp;<span class="ident" id="2448368">reflect</span><span class="op" id="2448375">.</span><span class="ident" id="2448376">Uintptr</span><span class="op" id="2448383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448388">v</span><span class="op" id="2448389">.</span><span class="ident" id="2448390">SetUint</span><span class="op" id="2448397">(</span><span class="ident" id="2448398">s</span><span class="op" id="2448399">.</span><span class="ident" id="2448400">scanUint</span><span class="op" id="2448408">(</span><span class="ident" id="2448409">verb</span><span class="op" id="2448413">,</span>&nbsp;<span class="ident" id="2448415">v</span><span class="op" id="2448416">.</span><span class="ident" id="2448417">Type</span><span class="op" id="2448421">(</span><span class="op" id="2448422">)</span><span class="op" id="2448423">.</span><span class="ident" id="2448424">Bits</span><span class="op" id="2448428">(</span><span class="op" id="2448429">)</span><span class="op" id="2448430">)</span><span class="op" id="2448431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448435">case</span>&nbsp;<span class="ident" id="2448440">reflect</span><span class="op" id="2448447">.</span><span class="ident" id="2448448">String</span><span class="op" id="2448454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448459">v</span><span class="op" id="2448460">.</span><span class="ident" id="2448461">SetString</span><span class="op" id="2448470">(</span><span class="ident" id="2448471">s</span><span class="op" id="2448472">.</span><span class="ident" id="2448473">convertString</span><span class="op" id="2448486">(</span><span class="ident" id="2448487">verb</span><span class="op" id="2448491">)</span><span class="op" id="2448492">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448496">case</span>&nbsp;<span class="ident" id="2448501">reflect</span><span class="op" id="2448508">.</span><span class="ident" id="2448509">Slice</span><span class="op" id="2448514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448519">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448568">typ</span>&nbsp;<span class="op" id="2448572">:=</span>&nbsp;<span class="ident" id="2448575">v</span><span class="op" id="2448576">.</span><span class="ident" id="2448577">Type</span><span class="op" id="2448581">(</span><span class="op" id="2448582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448587">if</span>&nbsp;<span class="ident" id="2448590">typ</span><span class="op" id="2448593">.</span><span class="ident" id="2448594">Elem</span><span class="op" id="2448598">(</span><span class="op" id="2448599">)</span><span class="op" id="2448600">.</span><span class="ident" id="2448601">Kind</span><span class="op" id="2448605">(</span><span class="op" id="2448606">)</span>&nbsp;<span class="op" id="2448608">!=</span>&nbsp;<span class="ident" id="2448611">reflect</span><span class="op" id="2448618">.</span><span class="ident" id="2448619">Uint8</span>&nbsp;<span class="op" id="2448625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448631">s</span><span class="op" id="2448632">.</span><span class="ident" id="2448633">errorString</span><span class="op" id="2448644">(</span><span class="string" id="2448645">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2448665">+</span>&nbsp;<span class="ident" id="2448667">val</span><span class="op" id="2448670">.</span><span class="ident" id="2448671">Type</span><span class="op" id="2448675">(</span><span class="op" id="2448676">)</span><span class="op" id="2448677">.</span><span class="ident" id="2448678">String</span><span class="op" id="2448684">(</span><span class="op" id="2448685">)</span><span class="op" id="2448686">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448696">str</span>&nbsp;<span class="op" id="2448700">:=</span>&nbsp;<span class="ident" id="2448703">s</span><span class="op" id="2448704">.</span><span class="ident" id="2448705">convertString</span><span class="op" id="2448718">(</span><span class="ident" id="2448719">verb</span><span class="op" id="2448723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448728">v</span><span class="op" id="2448729">.</span><span class="ident" id="2448730">Set</span><span class="op" id="2448733">(</span><span class="ident" id="2448734">reflect</span><span class="op" id="2448741">.</span><span class="ident" id="2448742">MakeSlice</span><span class="op" id="2448751">(</span><span class="ident" id="2448752">typ</span><span class="op" id="2448755">,</span>&nbsp;<span class="builtinfunc" id="2448757">len</span><span class="op" id="2448760">(</span><span class="ident" id="2448761">str</span><span class="op" id="2448764">)</span><span class="op" id="2448765">,</span>&nbsp;<span class="builtinfunc" id="2448767">len</span><span class="op" id="2448770">(</span><span class="ident" id="2448771">str</span><span class="op" id="2448774">)</span><span class="op" id="2448775">)</span><span class="op" id="2448776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448781">for</span>&nbsp;<span class="ident" id="2448785">i</span>&nbsp;<span class="op" id="2448787">:=</span>&nbsp;<span class="num" id="2448790">0</span><span class="op" id="2448791">;</span>&nbsp;<span class="ident" id="2448793">i</span>&nbsp;<span class="op" id="2448795">&lt;</span>&nbsp;<span class="builtinfunc" id="2448797">len</span><span class="op" id="2448800">(</span><span class="ident" id="2448801">str</span><span class="op" id="2448804">)</span><span class="op" id="2448805">;</span>&nbsp;<span class="ident" id="2448807">i</span><span class="op" id="2448808">++</span>&nbsp;<span class="op" id="2448811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448817">v</span><span class="op" id="2448818">.</span><span class="ident" id="2448819">Index</span><span class="op" id="2448824">(</span><span class="ident" id="2448825">i</span><span class="op" id="2448826">)</span><span class="op" id="2448827">.</span><span class="ident" id="2448828">SetUint</span><span class="op" id="2448835">(</span><span class="ident" id="2448836">uint64</span><span class="op" id="2448842">(</span><span class="ident" id="2448843">str</span><span class="op" id="2448846">[</span><span class="ident" id="2448847">i</span><span class="op" id="2448848">]</span><span class="op" id="2448849">)</span><span class="op" id="2448850">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448859">case</span>&nbsp;<span class="ident" id="2448864">reflect</span><span class="op" id="2448871">.</span><span class="ident" id="2448872">Float32</span><span class="op" id="2448879">,</span>&nbsp;<span class="ident" id="2448881">reflect</span><span class="op" id="2448888">.</span><span class="ident" id="2448889">Float64</span><span class="op" id="2448896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448901">s</span><span class="op" id="2448902">.</span><span class="ident" id="2448903">skipSpace</span><span class="op" id="2448912">(</span><span class="builtintype" id="2448913">false</span><span class="op" id="2448918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448923">s</span><span class="op" id="2448924">.</span><span class="ident" id="2448925">notEOF</span><span class="op" id="2448931">(</span><span class="op" id="2448932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448937">v</span><span class="op" id="2448938">.</span><span class="ident" id="2448939">SetFloat</span><span class="op" id="2448947">(</span><span class="ident" id="2448948">s</span><span class="op" id="2448949">.</span><span class="ident" id="2448950">convertFloat</span><span class="op" id="2448962">(</span><span class="ident" id="2448963">s</span><span class="op" id="2448964">.</span><span class="ident" id="2448965">floatToken</span><span class="op" id="2448975">(</span><span class="op" id="2448976">)</span><span class="op" id="2448977">,</span>&nbsp;<span class="ident" id="2448979">v</span><span class="op" id="2448980">.</span><span class="ident" id="2448981">Type</span><span class="op" id="2448985">(</span><span class="op" id="2448986">)</span><span class="op" id="2448987">.</span><span class="ident" id="2448988">Bits</span><span class="op" id="2448992">(</span><span class="op" id="2448993">)</span><span class="op" id="2448994">)</span><span class="op" id="2448995">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448999">case</span>&nbsp;<span class="ident" id="2449004">reflect</span><span class="op" id="2449011">.</span><span class="ident" id="2449012">Complex64</span><span class="op" id="2449021">,</span>&nbsp;<span class="ident" id="2449023">reflect</span><span class="op" id="2449030">.</span><span class="ident" id="2449031">Complex128</span><span class="op" id="2449041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449046">v</span><span class="op" id="2449047">.</span><span class="ident" id="2449048">SetComplex</span><span class="op" id="2449058">(</span><span class="ident" id="2449059">s</span><span class="op" id="2449060">.</span><span class="ident" id="2449061">scanComplex</span><span class="op" id="2449072">(</span><span class="ident" id="2449073">verb</span><span class="op" id="2449077">,</span>&nbsp;<span class="ident" id="2449079">v</span><span class="op" id="2449080">.</span><span class="ident" id="2449081">Type</span><span class="op" id="2449085">(</span><span class="op" id="2449086">)</span><span class="op" id="2449087">.</span><span class="ident" id="2449088">Bits</span><span class="op" id="2449092">(</span><span class="op" id="2449093">)</span><span class="op" id="2449094">)</span><span class="op" id="2449095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449099">default</span><span class="op" id="2449106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449111">s</span><span class="op" id="2449112">.</span><span class="ident" id="2449113">errorString</span><span class="op" id="2449124">(</span><span class="string" id="2449125">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2449145">+</span>&nbsp;<span class="ident" id="2449147">val</span><span class="op" id="2449150">.</span><span class="ident" id="2449151">Type</span><span class="op" id="2449155">(</span><span class="op" id="2449156">)</span><span class="op" id="2449157">.</span><span class="ident" id="2449158">String</span><span class="op" id="2449164">(</span><span class="op" id="2449165">)</span><span class="op" id="2449166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449170">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449173">}</span><br>
<span class="lineno"></span><span class="op" id="2449175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2449178">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2449233">func</span>&nbsp;<span class="ident" id="2449238">errorHandler</span><span class="op" id="2449250">(</span><span class="ident" id="2449251">errp</span>&nbsp;<span class="op" id="2449256">*</span><span class="builtintype" id="2449257">error</span><span class="op" id="2449262">)</span>&nbsp;<span class="op" id="2449264">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449267">if</span>&nbsp;<span class="ident" id="2449270">e</span>&nbsp;<span class="op" id="2449272">:=</span>&nbsp;<span class="builtinfunc" id="2449275">recover</span><span class="op" id="2449282">(</span><span class="op" id="2449283">)</span><span class="op" id="2449284">;</span>&nbsp;<span class="ident" id="2449286">e</span>&nbsp;<span class="op" id="2449288">!=</span>&nbsp;<span class="ident" id="2449291">nil</span>&nbsp;<span class="op" id="2449295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449299">if</span>&nbsp;<span class="ident" id="2449302">se</span><span class="op" id="2449304">,</span>&nbsp;<span class="ident" id="2449306">ok</span>&nbsp;<span class="op" id="2449309">:=</span>&nbsp;<span class="ident" id="2449312">e</span><span class="op" id="2449313">.</span><span class="op" id="2449314">(</span><span class="ident" id="2449315">scanError</span><span class="op" id="2449324">)</span><span class="op" id="2449325">;</span>&nbsp;<span class="ident" id="2449327">ok</span>&nbsp;<span class="op" id="2449330">{</span>&nbsp;<span class="comment" id="2449332">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449356">*</span><span class="ident" id="2449357">errp</span>&nbsp;<span class="op" id="2449362">=</span>&nbsp;<span class="ident" id="2449364">se</span><span class="op" id="2449366">.</span><span class="ident" id="2449367">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449373">}</span>&nbsp;<span class="keyword" id="2449375">else</span>&nbsp;<span class="keyword" id="2449380">if</span>&nbsp;<span class="ident" id="2449383">eof</span><span class="op" id="2449386">,</span>&nbsp;<span class="ident" id="2449388">ok</span>&nbsp;<span class="op" id="2449391">:=</span>&nbsp;<span class="ident" id="2449394">e</span><span class="op" id="2449395">.</span><span class="op" id="2449396">(</span><span class="builtintype" id="2449397">error</span><span class="op" id="2449402">)</span><span class="op" id="2449403">;</span>&nbsp;<span class="ident" id="2449405">ok</span>&nbsp;<span class="op" id="2449408">&amp;&amp;</span>&nbsp;<span class="ident" id="2449411">eof</span>&nbsp;<span class="op" id="2449415">==</span>&nbsp;<span class="ident" id="2449418">io</span><span class="op" id="2449420">.</span><span class="ident" id="2449421">EOF</span>&nbsp;<span class="op" id="2449425">{</span>&nbsp;<span class="comment" id="2449427">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449446">*</span><span class="ident" id="2449447">errp</span>&nbsp;<span class="op" id="2449452">=</span>&nbsp;<span class="ident" id="2449454">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449460">}</span>&nbsp;<span class="keyword" id="2449462">else</span>&nbsp;<span class="op" id="2449467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2449472">panic</span><span class="op" id="2449477">(</span><span class="ident" id="2449478">e</span><span class="op" id="2449479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449486">}</span><br>
<span class="lineno"></span><span class="op" id="2449488">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2449491">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2449558">func</span>&nbsp;<span class="op" id="2449563">(</span><span class="ident" id="2449564">s</span>&nbsp;<span class="op" id="2449566">*</span><span class="ident" id="2449567">ss</span><span class="op" id="2449569">)</span>&nbsp;<span class="ident" id="2449571">doScan</span><span class="op" id="2449577">(</span><span class="ident" id="2449578">a</span>&nbsp;<span class="op" id="2449580">[</span><span class="op" id="2449581">]</span><span class="keyword" id="2449582">interface</span><span class="op" id="2449591">{</span><span class="op" id="2449592">}</span><span class="op" id="2449593">)</span>&nbsp;<span class="op" id="2449595">(</span><span class="ident" id="2449596">numProcessed</span>&nbsp;<span class="builtintype" id="2449609">int</span><span class="op" id="2449612">,</span>&nbsp;<span class="ident" id="2449614">err</span>&nbsp;<span class="builtintype" id="2449618">error</span><span class="op" id="2449623">)</span>&nbsp;<span class="op" id="2449625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449628">defer</span>&nbsp;<span class="ident" id="2449634">errorHandler</span><span class="op" id="2449646">(</span><span class="op" id="2449647">&amp;</span><span class="ident" id="2449648">err</span><span class="op" id="2449651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449654">for</span>&nbsp;<span class="ident" id="2449658">_</span><span class="op" id="2449659">,</span>&nbsp;<span class="ident" id="2449661">arg</span>&nbsp;<span class="op" id="2449665">:=</span>&nbsp;<span class="keyword" id="2449668">range</span>&nbsp;<span class="ident" id="2449674">a</span>&nbsp;<span class="op" id="2449676">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449680">s</span><span class="op" id="2449681">.</span><span class="ident" id="2449682">scanOne</span><span class="op" id="2449689">(</span><span class="string" id="2449690">&#39;v&#39;</span><span class="op" id="2449693">,</span>&nbsp;<span class="ident" id="2449695">arg</span><span class="op" id="2449698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449702">numProcessed</span><span class="op" id="2449714">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2449721">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449756">if</span>&nbsp;<span class="op" id="2449759">!</span><span class="ident" id="2449760">s</span><span class="op" id="2449761">.</span><span class="ident" id="2449762">nlIsSpace</span>&nbsp;<span class="op" id="2449772">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449776">for</span>&nbsp;<span class="op" id="2449780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449785">r</span>&nbsp;<span class="op" id="2449787">:=</span>&nbsp;<span class="ident" id="2449790">s</span><span class="op" id="2449791">.</span><span class="ident" id="2449792">getRune</span><span class="op" id="2449799">(</span><span class="op" id="2449800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449805">if</span>&nbsp;<span class="ident" id="2449808">r</span>&nbsp;<span class="op" id="2449810">==</span>&nbsp;<span class="string" id="2449813">&#39;\n&#39;</span>&nbsp;<span class="op" id="2449818">||</span>&nbsp;<span class="ident" id="2449821">r</span>&nbsp;<span class="op" id="2449823">==</span>&nbsp;<span class="ident" id="2449826">eof</span>&nbsp;<span class="op" id="2449830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449836">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449845">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449850">if</span>&nbsp;<span class="op" id="2449853">!</span><span class="ident" id="2449854">isSpace</span><span class="op" id="2449861">(</span><span class="ident" id="2449862">r</span><span class="op" id="2449863">)</span>&nbsp;<span class="op" id="2449865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449871">s</span><span class="op" id="2449872">.</span><span class="ident" id="2449873">errorString</span><span class="op" id="2449884">(</span><span class="string" id="2449885">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2449903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449909">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449922">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2449925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449928">return</span><br>
<span class="lineno"></span><span class="op" id="2449935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2449938">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2450007">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2450078">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2450147">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2450217">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2450285">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2450349">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2450407">func</span>&nbsp;<span class="op" id="2450412">(</span><span class="ident" id="2450413">s</span>&nbsp;<span class="op" id="2450415">*</span><span class="ident" id="2450416">ss</span><span class="op" id="2450418">)</span>&nbsp;<span class="ident" id="2450420">advance</span><span class="op" id="2450427">(</span><span class="ident" id="2450428">format</span>&nbsp;<span class="builtintype" id="2450435">string</span><span class="op" id="2450441">)</span>&nbsp;<span class="op" id="2450443">(</span><span class="ident" id="2450444">i</span>&nbsp;<span class="builtintype" id="2450446">int</span><span class="op" id="2450449">)</span>&nbsp;<span class="op" id="2450451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2450454">for</span>&nbsp;<span class="ident" id="2450458">i</span>&nbsp;<span class="op" id="2450460">&lt;</span>&nbsp;<span class="builtinfunc" id="2450462">len</span><span class="op" id="2450465">(</span><span class="ident" id="2450466">format</span><span class="op" id="2450472">)</span>&nbsp;<span class="op" id="2450474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450478">fmtc</span><span class="op" id="2450482">,</span>&nbsp;<span class="ident" id="2450484">w</span>&nbsp;<span class="op" id="2450486">:=</span>&nbsp;<span class="ident" id="2450489">utf8</span><span class="op" id="2450493">.</span><span class="ident" id="2450494">DecodeRuneInString</span><span class="op" id="2450512">(</span><span class="ident" id="2450513">format</span><span class="op" id="2450519">[</span><span class="ident" id="2450520">i</span><span class="op" id="2450521">:</span><span class="op" id="2450522">]</span><span class="op" id="2450523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2450527">if</span>&nbsp;<span class="ident" id="2450530">fmtc</span>&nbsp;<span class="op" id="2450535">==</span>&nbsp;<span class="string" id="2450538">&#39;%&#39;</span>&nbsp;<span class="op" id="2450542">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2450547">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450581">nextc</span><span class="op" id="2450586">,</span>&nbsp;<span class="ident" id="2450588">_</span>&nbsp;<span class="op" id="2450590">:=</span>&nbsp;<span class="ident" id="2450593">utf8</span><span class="op" id="2450597">.</span><span class="ident" id="2450598">DecodeRuneInString</span><span class="op" id="2450616">(</span><span class="ident" id="2450617">format</span><span class="op" id="2450623">[</span><span class="ident" id="2450624">i</span><span class="op" id="2450625">+</span><span class="ident" id="2450626">w</span><span class="op" id="2450627">:</span><span class="op" id="2450628">]</span><span class="op" id="2450629">)</span>&nbsp;<span class="comment" id="2450631">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2450673">if</span>&nbsp;<span class="ident" id="2450676">nextc</span>&nbsp;<span class="op" id="2450682">!=</span>&nbsp;<span class="string" id="2450685">&#39;%&#39;</span>&nbsp;<span class="op" id="2450689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2450695">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2450705">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450710">i</span>&nbsp;<span class="op" id="2450712">+=</span>&nbsp;<span class="ident" id="2450715">w</span>&nbsp;<span class="comment" id="2450717">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2450739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450743">sawSpace</span>&nbsp;<span class="op" id="2450752">:=</span>&nbsp;<span class="builtintype" id="2450755">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2450763">for</span>&nbsp;<span class="ident" id="2450767">isSpace</span><span class="op" id="2450774">(</span><span class="ident" id="2450775">fmtc</span><span class="op" id="2450779">)</span>&nbsp;<span class="op" id="2450781">&amp;&amp;</span>&nbsp;<span class="ident" id="2450784">i</span>&nbsp;<span class="op" id="2450786">&lt;</span>&nbsp;<span class="builtinfunc" id="2450788">len</span><span class="op" id="2450791">(</span><span class="ident" id="2450792">format</span><span class="op" id="2450798">)</span>&nbsp;<span class="op" id="2450800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450805">sawSpace</span>&nbsp;<span class="op" id="2450814">=</span>&nbsp;<span class="builtintype" id="2450816">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450824">i</span>&nbsp;<span class="op" id="2450826">+=</span>&nbsp;<span class="ident" id="2450829">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450834">fmtc</span><span class="op" id="2450838">,</span>&nbsp;<span class="ident" id="2450840">w</span>&nbsp;<span class="op" id="2450842">=</span>&nbsp;<span class="ident" id="2450844">utf8</span><span class="op" id="2450848">.</span><span class="ident" id="2450849">DecodeRuneInString</span><span class="op" id="2450867">(</span><span class="ident" id="2450868">format</span><span class="op" id="2450874">[</span><span class="ident" id="2450875">i</span><span class="op" id="2450876">:</span><span class="op" id="2450877">]</span><span class="op" id="2450878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2450882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2450886">if</span>&nbsp;<span class="ident" id="2450889">sawSpace</span>&nbsp;<span class="op" id="2450898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2450903">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2450971">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450991">inputc</span>&nbsp;<span class="op" id="2450998">:=</span>&nbsp;<span class="ident" id="2451001">s</span><span class="op" id="2451002">.</span><span class="ident" id="2451003">getRune</span><span class="op" id="2451010">(</span><span class="op" id="2451011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451016">if</span>&nbsp;<span class="ident" id="2451019">inputc</span>&nbsp;<span class="op" id="2451026">==</span>&nbsp;<span class="ident" id="2451029">eof</span>&nbsp;<span class="op" id="2451033">||</span>&nbsp;<span class="ident" id="2451036">inputc</span>&nbsp;<span class="op" id="2451043">==</span>&nbsp;<span class="string" id="2451046">&#39;\n&#39;</span>&nbsp;<span class="op" id="2451051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451057">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451120">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2451130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451135">if</span>&nbsp;<span class="op" id="2451138">!</span><span class="ident" id="2451139">isSpace</span><span class="op" id="2451146">(</span><span class="ident" id="2451147">inputc</span><span class="op" id="2451153">)</span>&nbsp;<span class="op" id="2451155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451161">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451208">s</span><span class="op" id="2451209">.</span><span class="ident" id="2451210">errorString</span><span class="op" id="2451221">(</span><span class="string" id="2451222">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2451263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2451268">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451273">s</span><span class="op" id="2451274">.</span><span class="ident" id="2451275">skipSpace</span><span class="op" id="2451284">(</span><span class="builtintype" id="2451285">true</span><span class="op" id="2451289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451294">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2451305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451309">inputc</span>&nbsp;<span class="op" id="2451316">:=</span>&nbsp;<span class="ident" id="2451319">s</span><span class="op" id="2451320">.</span><span class="ident" id="2451321">mustReadRune</span><span class="op" id="2451333">(</span><span class="op" id="2451334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451338">if</span>&nbsp;<span class="ident" id="2451341">fmtc</span>&nbsp;<span class="op" id="2451346">!=</span>&nbsp;<span class="ident" id="2451349">inputc</span>&nbsp;<span class="op" id="2451356">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451361">s</span><span class="op" id="2451362">.</span><span class="ident" id="2451363">UnreadRune</span><span class="op" id="2451373">(</span><span class="op" id="2451374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451379">return</span>&nbsp;<span class="op" id="2451386">-</span><span class="num" id="2451387">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2451391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451395">i</span>&nbsp;<span class="op" id="2451397">+=</span>&nbsp;<span class="ident" id="2451400">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2451403">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451406">return</span><br>
<span class="lineno"></span><span class="op" id="2451413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2451416">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2451482">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2451542">func</span>&nbsp;<span class="op" id="2451547">(</span><span class="ident" id="2451548">s</span>&nbsp;<span class="op" id="2451550">*</span><span class="ident" id="2451551">ss</span><span class="op" id="2451553">)</span>&nbsp;<span class="ident" id="2451555">doScanf</span><span class="op" id="2451562">(</span><span class="ident" id="2451563">format</span>&nbsp;<span class="builtintype" id="2451570">string</span><span class="op" id="2451576">,</span>&nbsp;<span class="ident" id="2451578">a</span>&nbsp;<span class="op" id="2451580">[</span><span class="op" id="2451581">]</span><span class="keyword" id="2451582">interface</span><span class="op" id="2451591">{</span><span class="op" id="2451592">}</span><span class="op" id="2451593">)</span>&nbsp;<span class="op" id="2451595">(</span><span class="ident" id="2451596">numProcessed</span>&nbsp;<span class="builtintype" id="2451609">int</span><span class="op" id="2451612">,</span>&nbsp;<span class="ident" id="2451614">err</span>&nbsp;<span class="builtintype" id="2451618">error</span><span class="op" id="2451623">)</span>&nbsp;<span class="op" id="2451625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451628">defer</span>&nbsp;<span class="ident" id="2451634">errorHandler</span><span class="op" id="2451646">(</span><span class="op" id="2451647">&amp;</span><span class="ident" id="2451648">err</span><span class="op" id="2451651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451654">end</span>&nbsp;<span class="op" id="2451658">:=</span>&nbsp;<span class="builtinfunc" id="2451661">len</span><span class="op" id="2451664">(</span><span class="ident" id="2451665">format</span><span class="op" id="2451671">)</span>&nbsp;<span class="op" id="2451673">-</span>&nbsp;<span class="num" id="2451675">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451678">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451725">for</span>&nbsp;<span class="ident" id="2451729">i</span>&nbsp;<span class="op" id="2451731">:=</span>&nbsp;<span class="num" id="2451734">0</span><span class="op" id="2451735">;</span>&nbsp;<span class="ident" id="2451737">i</span>&nbsp;<span class="op" id="2451739">&lt;=</span>&nbsp;<span class="ident" id="2451742">end</span><span class="op" id="2451745">;</span>&nbsp;<span class="op" id="2451747">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451751">w</span>&nbsp;<span class="op" id="2451753">:=</span>&nbsp;<span class="ident" id="2451756">s</span><span class="op" id="2451757">.</span><span class="ident" id="2451758">advance</span><span class="op" id="2451765">(</span><span class="ident" id="2451766">format</span><span class="op" id="2451772">[</span><span class="ident" id="2451773">i</span><span class="op" id="2451774">:</span><span class="op" id="2451775">]</span><span class="op" id="2451776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451780">if</span>&nbsp;<span class="ident" id="2451783">w</span>&nbsp;<span class="op" id="2451785">&gt;</span>&nbsp;<span class="num" id="2451787">0</span>&nbsp;<span class="op" id="2451789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451794">i</span>&nbsp;<span class="op" id="2451796">+=</span>&nbsp;<span class="ident" id="2451799">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451804">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2451815">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451819">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451906">if</span>&nbsp;<span class="ident" id="2451909">format</span><span class="op" id="2451915">[</span><span class="ident" id="2451916">i</span><span class="op" id="2451917">]</span>&nbsp;<span class="op" id="2451919">!=</span>&nbsp;<span class="string" id="2451922">&#39;%&#39;</span>&nbsp;<span class="op" id="2451926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451931">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451969">if</span>&nbsp;<span class="ident" id="2451972">w</span>&nbsp;<span class="op" id="2451974">&lt;</span>&nbsp;<span class="num" id="2451976">0</span>&nbsp;<span class="op" id="2451978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451984">s</span><span class="op" id="2451985">.</span><span class="ident" id="2451986">errorString</span><span class="op" id="2451997">(</span><span class="string" id="2451998">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2452027">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452037">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452101">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452113">i</span><span class="op" id="2452114">++</span>&nbsp;<span class="comment" id="2452117">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452137">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452165">var</span>&nbsp;<span class="ident" id="2452169">widPresent</span>&nbsp;<span class="builtintype" id="2452180">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452187">s</span><span class="op" id="2452188">.</span><span class="ident" id="2452189">maxWid</span><span class="op" id="2452195">,</span>&nbsp;<span class="ident" id="2452197">widPresent</span><span class="op" id="2452207">,</span>&nbsp;<span class="ident" id="2452209">i</span>&nbsp;<span class="op" id="2452211">=</span>&nbsp;<span class="ident" id="2452213">parsenum</span><span class="op" id="2452221">(</span><span class="ident" id="2452222">format</span><span class="op" id="2452228">,</span>&nbsp;<span class="ident" id="2452230">i</span><span class="op" id="2452231">,</span>&nbsp;<span class="ident" id="2452233">end</span><span class="op" id="2452236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452240">if</span>&nbsp;<span class="op" id="2452243">!</span><span class="ident" id="2452244">widPresent</span>&nbsp;<span class="op" id="2452255">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452260">s</span><span class="op" id="2452261">.</span><span class="ident" id="2452262">maxWid</span>&nbsp;<span class="op" id="2452269">=</span>&nbsp;<span class="ident" id="2452271">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452285">s</span><span class="op" id="2452286">.</span><span class="ident" id="2452287">argLimit</span>&nbsp;<span class="op" id="2452296">=</span>&nbsp;<span class="ident" id="2452298">s</span><span class="op" id="2452299">.</span><span class="ident" id="2452300">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452308">if</span>&nbsp;<span class="ident" id="2452311">f</span>&nbsp;<span class="op" id="2452313">:=</span>&nbsp;<span class="ident" id="2452316">s</span><span class="op" id="2452317">.</span><span class="ident" id="2452318">count</span>&nbsp;<span class="op" id="2452324">+</span>&nbsp;<span class="ident" id="2452326">s</span><span class="op" id="2452327">.</span><span class="ident" id="2452328">maxWid</span><span class="op" id="2452334">;</span>&nbsp;<span class="ident" id="2452336">f</span>&nbsp;<span class="op" id="2452338">&lt;</span>&nbsp;<span class="ident" id="2452340">s</span><span class="op" id="2452341">.</span><span class="ident" id="2452342">argLimit</span>&nbsp;<span class="op" id="2452351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452356">s</span><span class="op" id="2452357">.</span><span class="ident" id="2452358">argLimit</span>&nbsp;<span class="op" id="2452367">=</span>&nbsp;<span class="ident" id="2452369">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452378">c</span><span class="op" id="2452379">,</span>&nbsp;<span class="ident" id="2452381">w</span>&nbsp;<span class="op" id="2452383">:=</span>&nbsp;<span class="ident" id="2452386">utf8</span><span class="op" id="2452390">.</span><span class="ident" id="2452391">DecodeRuneInString</span><span class="op" id="2452409">(</span><span class="ident" id="2452410">format</span><span class="op" id="2452416">[</span><span class="ident" id="2452417">i</span><span class="op" id="2452418">:</span><span class="op" id="2452419">]</span><span class="op" id="2452420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452424">i</span>&nbsp;<span class="op" id="2452426">+=</span>&nbsp;<span class="ident" id="2452429">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452434">if</span>&nbsp;<span class="ident" id="2452437">numProcessed</span>&nbsp;<span class="op" id="2452450">&gt;=</span>&nbsp;<span class="builtinfunc" id="2452453">len</span><span class="op" id="2452456">(</span><span class="ident" id="2452457">a</span><span class="op" id="2452458">)</span>&nbsp;<span class="op" id="2452460">{</span>&nbsp;<span class="comment" id="2452462">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452484">s</span><span class="op" id="2452485">.</span><span class="ident" id="2452486">errorString</span><span class="op" id="2452497">(</span><span class="string" id="2452498">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2452530">+</span>&nbsp;<span class="ident" id="2452532">format</span><span class="op" id="2452538">[</span><span class="ident" id="2452539">i</span><span class="op" id="2452540">-</span><span class="ident" id="2452541">w</span><span class="op" id="2452542">:</span><span class="op" id="2452543">]</span><span class="op" id="2452544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452549">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452561">arg</span>&nbsp;<span class="op" id="2452565">:=</span>&nbsp;<span class="ident" id="2452568">a</span><span class="op" id="2452569">[</span><span class="ident" id="2452570">numProcessed</span><span class="op" id="2452582">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452587">s</span><span class="op" id="2452588">.</span><span class="ident" id="2452589">scanOne</span><span class="op" id="2452596">(</span><span class="ident" id="2452597">c</span><span class="op" id="2452598">,</span>&nbsp;<span class="ident" id="2452600">arg</span><span class="op" id="2452603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452607">numProcessed</span><span class="op" id="2452619">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452624">s</span><span class="op" id="2452625">.</span><span class="ident" id="2452626">argLimit</span>&nbsp;<span class="op" id="2452635">=</span>&nbsp;<span class="ident" id="2452637">s</span><span class="op" id="2452638">.</span><span class="ident" id="2452639">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452646">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452649">if</span>&nbsp;<span class="ident" id="2452652">numProcessed</span>&nbsp;<span class="op" id="2452665">&lt;</span>&nbsp;<span class="builtinfunc" id="2452667">len</span><span class="op" id="2452670">(</span><span class="ident" id="2452671">a</span><span class="op" id="2452672">)</span>&nbsp;<span class="op" id="2452674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452678">s</span><span class="op" id="2452679">.</span><span class="ident" id="2452680">errorString</span><span class="op" id="2452691">(</span><span class="string" id="2452692">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2452711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452717">return</span><br>
<span class="lineno"></span><span class="op" id="2452724">}</span>
</div>
</body>
</html>
