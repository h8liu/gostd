<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html" class="current">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4744542">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4744597">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4744651">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4744702">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4744780">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4744798">package</span>&nbsp;<span class="ident" id="4744806">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4744814">import</span>&nbsp;<span class="op" id="4744821">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4744824">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4744834">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4744841">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4744844">func</span>&nbsp;<span class="ident" id="4744849">init</span><span class="op" id="4744853">(</span><span class="op" id="4744854">)</span>&nbsp;<span class="op" id="4744856">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744859">crypto</span><span class="op" id="4744865">.</span><span class="ident" id="4744866">RegisterHash</span><span class="op" id="4744878">(</span><span class="ident" id="4744879">crypto</span><span class="op" id="4744885">.</span><span class="ident" id="4744886">SHA384</span><span class="op" id="4744892">,</span>&nbsp;<span class="ident" id="4744894">New384</span><span class="op" id="4744900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744903">crypto</span><span class="op" id="4744909">.</span><span class="ident" id="4744910">RegisterHash</span><span class="op" id="4744922">(</span><span class="ident" id="4744923">crypto</span><span class="op" id="4744929">.</span><span class="ident" id="4744930">SHA512</span><span class="op" id="4744936">,</span>&nbsp;<span class="ident" id="4744938">New</span><span class="op" id="4744941">)</span><br>
<span class="lineno"></span><span class="op" id="4744943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4744946">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4744989">const</span>&nbsp;<span class="ident" id="4744995">Size</span>&nbsp;<span class="op" id="4745000">=</span>&nbsp;<span class="num" id="4745002">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4745006">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4745049">const</span>&nbsp;<span class="ident" id="4745055">Size384</span>&nbsp;<span class="op" id="4745063">=</span>&nbsp;<span class="num" id="4745065">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4745069">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4745117">const</span>&nbsp;<span class="ident" id="4745123">BlockSize</span>&nbsp;<span class="op" id="4745133">=</span>&nbsp;<span class="num" id="4745135">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4745140">const</span>&nbsp;<span class="op" id="4745146">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745149">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745159">=</span>&nbsp;<span class="num" id="4745161">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745166">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745176">=</span>&nbsp;<span class="num" id="4745178">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745198">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745208">=</span>&nbsp;<span class="num" id="4745210">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745230">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745240">=</span>&nbsp;<span class="num" id="4745242">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745262">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745272">=</span>&nbsp;<span class="num" id="4745274">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745294">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745304">=</span>&nbsp;<span class="num" id="4745306">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745326">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745336">=</span>&nbsp;<span class="num" id="4745338">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745358">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745368">=</span>&nbsp;<span class="num" id="4745370">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745390">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745400">=</span>&nbsp;<span class="num" id="4745402">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745422">init0_384</span>&nbsp;<span class="op" id="4745432">=</span>&nbsp;<span class="num" id="4745434">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745454">init1_384</span>&nbsp;<span class="op" id="4745464">=</span>&nbsp;<span class="num" id="4745466">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745486">init2_384</span>&nbsp;<span class="op" id="4745496">=</span>&nbsp;<span class="num" id="4745498">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745518">init3_384</span>&nbsp;<span class="op" id="4745528">=</span>&nbsp;<span class="num" id="4745530">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745550">init4_384</span>&nbsp;<span class="op" id="4745560">=</span>&nbsp;<span class="num" id="4745562">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745582">init5_384</span>&nbsp;<span class="op" id="4745592">=</span>&nbsp;<span class="num" id="4745594">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745614">init6_384</span>&nbsp;<span class="op" id="4745624">=</span>&nbsp;<span class="num" id="4745626">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745646">init7_384</span>&nbsp;<span class="op" id="4745656">=</span>&nbsp;<span class="num" id="4745658">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4745677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4745680">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4745739">type</span>&nbsp;<span class="ident" id="4745744">digest</span>&nbsp;<span class="keyword" id="4745751">struct</span>&nbsp;<span class="op" id="4745758">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745761">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745767">[</span><span class="num" id="4745768">8</span><span class="op" id="4745769">]</span><span class="ident" id="4745770">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745778">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745784">[</span><span class="ident" id="4745785">chunk</span><span class="op" id="4745790">]</span><span class="builtintype" id="4745791">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745797">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4745803">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4745808">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4745814">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745822">is384</span>&nbsp;<span class="builtintype" id="4745828">bool</span>&nbsp;<span class="comment" id="4745833">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4745867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4745870">func</span>&nbsp;<span class="op" id="4745875">(</span><span class="ident" id="4745876">d</span>&nbsp;<span class="op" id="4745878">*</span><span class="ident" id="4745879">digest</span><span class="op" id="4745885">)</span>&nbsp;<span class="ident" id="4745887">Reset</span><span class="op" id="4745892">(</span><span class="op" id="4745893">)</span>&nbsp;<span class="op" id="4745895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4745898">if</span>&nbsp;<span class="op" id="4745901">!</span><span class="ident" id="4745902">d</span><span class="op" id="4745903">.</span><span class="ident" id="4745904">is384</span>&nbsp;<span class="op" id="4745910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745914">d</span><span class="op" id="4745915">.</span><span class="ident" id="4745916">h</span><span class="op" id="4745917">[</span><span class="num" id="4745918">0</span><span class="op" id="4745919">]</span>&nbsp;<span class="op" id="4745921">=</span>&nbsp;<span class="ident" id="4745923">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745931">d</span><span class="op" id="4745932">.</span><span class="ident" id="4745933">h</span><span class="op" id="4745934">[</span><span class="num" id="4745935">1</span><span class="op" id="4745936">]</span>&nbsp;<span class="op" id="4745938">=</span>&nbsp;<span class="ident" id="4745940">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745948">d</span><span class="op" id="4745949">.</span><span class="ident" id="4745950">h</span><span class="op" id="4745951">[</span><span class="num" id="4745952">2</span><span class="op" id="4745953">]</span>&nbsp;<span class="op" id="4745955">=</span>&nbsp;<span class="ident" id="4745957">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745965">d</span><span class="op" id="4745966">.</span><span class="ident" id="4745967">h</span><span class="op" id="4745968">[</span><span class="num" id="4745969">3</span><span class="op" id="4745970">]</span>&nbsp;<span class="op" id="4745972">=</span>&nbsp;<span class="ident" id="4745974">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745982">d</span><span class="op" id="4745983">.</span><span class="ident" id="4745984">h</span><span class="op" id="4745985">[</span><span class="num" id="4745986">4</span><span class="op" id="4745987">]</span>&nbsp;<span class="op" id="4745989">=</span>&nbsp;<span class="ident" id="4745991">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745999">d</span><span class="op" id="4746000">.</span><span class="ident" id="4746001">h</span><span class="op" id="4746002">[</span><span class="num" id="4746003">5</span><span class="op" id="4746004">]</span>&nbsp;<span class="op" id="4746006">=</span>&nbsp;<span class="ident" id="4746008">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746016">d</span><span class="op" id="4746017">.</span><span class="ident" id="4746018">h</span><span class="op" id="4746019">[</span><span class="num" id="4746020">6</span><span class="op" id="4746021">]</span>&nbsp;<span class="op" id="4746023">=</span>&nbsp;<span class="ident" id="4746025">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746033">d</span><span class="op" id="4746034">.</span><span class="ident" id="4746035">h</span><span class="op" id="4746036">[</span><span class="num" id="4746037">7</span><span class="op" id="4746038">]</span>&nbsp;<span class="op" id="4746040">=</span>&nbsp;<span class="ident" id="4746042">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746049">}</span>&nbsp;<span class="keyword" id="4746051">else</span>&nbsp;<span class="op" id="4746056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746060">d</span><span class="op" id="4746061">.</span><span class="ident" id="4746062">h</span><span class="op" id="4746063">[</span><span class="num" id="4746064">0</span><span class="op" id="4746065">]</span>&nbsp;<span class="op" id="4746067">=</span>&nbsp;<span class="ident" id="4746069">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746081">d</span><span class="op" id="4746082">.</span><span class="ident" id="4746083">h</span><span class="op" id="4746084">[</span><span class="num" id="4746085">1</span><span class="op" id="4746086">]</span>&nbsp;<span class="op" id="4746088">=</span>&nbsp;<span class="ident" id="4746090">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746102">d</span><span class="op" id="4746103">.</span><span class="ident" id="4746104">h</span><span class="op" id="4746105">[</span><span class="num" id="4746106">2</span><span class="op" id="4746107">]</span>&nbsp;<span class="op" id="4746109">=</span>&nbsp;<span class="ident" id="4746111">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746123">d</span><span class="op" id="4746124">.</span><span class="ident" id="4746125">h</span><span class="op" id="4746126">[</span><span class="num" id="4746127">3</span><span class="op" id="4746128">]</span>&nbsp;<span class="op" id="4746130">=</span>&nbsp;<span class="ident" id="4746132">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746144">d</span><span class="op" id="4746145">.</span><span class="ident" id="4746146">h</span><span class="op" id="4746147">[</span><span class="num" id="4746148">4</span><span class="op" id="4746149">]</span>&nbsp;<span class="op" id="4746151">=</span>&nbsp;<span class="ident" id="4746153">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746165">d</span><span class="op" id="4746166">.</span><span class="ident" id="4746167">h</span><span class="op" id="4746168">[</span><span class="num" id="4746169">5</span><span class="op" id="4746170">]</span>&nbsp;<span class="op" id="4746172">=</span>&nbsp;<span class="ident" id="4746174">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746186">d</span><span class="op" id="4746187">.</span><span class="ident" id="4746188">h</span><span class="op" id="4746189">[</span><span class="num" id="4746190">6</span><span class="op" id="4746191">]</span>&nbsp;<span class="op" id="4746193">=</span>&nbsp;<span class="ident" id="4746195">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746207">d</span><span class="op" id="4746208">.</span><span class="ident" id="4746209">h</span><span class="op" id="4746210">[</span><span class="num" id="4746211">7</span><span class="op" id="4746212">]</span>&nbsp;<span class="op" id="4746214">=</span>&nbsp;<span class="ident" id="4746216">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746230">d</span><span class="op" id="4746231">.</span><span class="ident" id="4746232">nx</span>&nbsp;<span class="op" id="4746235">=</span>&nbsp;<span class="num" id="4746237">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746240">d</span><span class="op" id="4746241">.</span><span class="builtinfunc" id="4746242">len</span>&nbsp;<span class="op" id="4746246">=</span>&nbsp;<span class="num" id="4746248">0</span><br>
<span class="lineno"></span><span class="op" id="4746250">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4746253">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4746315">func</span>&nbsp;<span class="ident" id="4746320">New</span><span class="op" id="4746323">(</span><span class="op" id="4746324">)</span>&nbsp;<span class="ident" id="4746326">hash</span><span class="op" id="4746330">.</span><span class="ident" id="4746331">Hash</span>&nbsp;<span class="op" id="4746336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746339">d</span>&nbsp;<span class="op" id="4746341">:=</span>&nbsp;<span class="builtinfunc" id="4746344">new</span><span class="op" id="4746347">(</span><span class="ident" id="4746348">digest</span><span class="op" id="4746354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746357">d</span><span class="op" id="4746358">.</span><span class="ident" id="4746359">Reset</span><span class="op" id="4746364">(</span><span class="op" id="4746365">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746368">return</span>&nbsp;<span class="ident" id="4746375">d</span><br>
<span class="lineno"></span><span class="op" id="4746377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4746380">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4746445">func</span>&nbsp;<span class="ident" id="4746450">New384</span><span class="op" id="4746456">(</span><span class="op" id="4746457">)</span>&nbsp;<span class="ident" id="4746459">hash</span><span class="op" id="4746463">.</span><span class="ident" id="4746464">Hash</span>&nbsp;<span class="op" id="4746469">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746472">d</span>&nbsp;<span class="op" id="4746474">:=</span>&nbsp;<span class="builtinfunc" id="4746477">new</span><span class="op" id="4746480">(</span><span class="ident" id="4746481">digest</span><span class="op" id="4746487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746490">d</span><span class="op" id="4746491">.</span><span class="ident" id="4746492">is384</span>&nbsp;<span class="op" id="4746498">=</span>&nbsp;<span class="builtintype" id="4746500">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746506">d</span><span class="op" id="4746507">.</span><span class="ident" id="4746508">Reset</span><span class="op" id="4746513">(</span><span class="op" id="4746514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746517">return</span>&nbsp;<span class="ident" id="4746524">d</span><br>
<span class="lineno"></span><span class="op" id="4746526">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4746529">func</span>&nbsp;<span class="op" id="4746534">(</span><span class="ident" id="4746535">d</span>&nbsp;<span class="op" id="4746537">*</span><span class="ident" id="4746538">digest</span><span class="op" id="4746544">)</span>&nbsp;<span class="ident" id="4746546">Size</span><span class="op" id="4746550">(</span><span class="op" id="4746551">)</span>&nbsp;<span class="builtintype" id="4746553">int</span>&nbsp;<span class="op" id="4746557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746560">if</span>&nbsp;<span class="op" id="4746563">!</span><span class="ident" id="4746564">d</span><span class="op" id="4746565">.</span><span class="ident" id="4746566">is384</span>&nbsp;<span class="op" id="4746572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746576">return</span>&nbsp;<span class="ident" id="4746583">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746589">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746592">return</span>&nbsp;<span class="ident" id="4746599">Size384</span><br>
<span class="lineno"></span><span class="op" id="4746607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4746610">func</span>&nbsp;<span class="op" id="4746615">(</span><span class="ident" id="4746616">d</span>&nbsp;<span class="op" id="4746618">*</span><span class="ident" id="4746619">digest</span><span class="op" id="4746625">)</span>&nbsp;<span class="ident" id="4746627">BlockSize</span><span class="op" id="4746636">(</span><span class="op" id="4746637">)</span>&nbsp;<span class="builtintype" id="4746639">int</span>&nbsp;<span class="op" id="4746643">{</span>&nbsp;<span class="keyword" id="4746645">return</span>&nbsp;<span class="ident" id="4746652">BlockSize</span>&nbsp;<span class="op" id="4746662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4746665">func</span>&nbsp;<span class="op" id="4746670">(</span><span class="ident" id="4746671">d</span>&nbsp;<span class="op" id="4746673">*</span><span class="ident" id="4746674">digest</span><span class="op" id="4746680">)</span>&nbsp;<span class="ident" id="4746682">Write</span><span class="op" id="4746687">(</span><span class="ident" id="4746688">p</span>&nbsp;<span class="op" id="4746690">[</span><span class="op" id="4746691">]</span><span class="builtintype" id="4746692">byte</span><span class="op" id="4746696">)</span>&nbsp;<span class="op" id="4746698">(</span><span class="ident" id="4746699">nn</span>&nbsp;<span class="builtintype" id="4746702">int</span><span class="op" id="4746705">,</span>&nbsp;<span class="ident" id="4746707">err</span>&nbsp;<span class="builtintype" id="4746711">error</span><span class="op" id="4746716">)</span>&nbsp;<span class="op" id="4746718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746721">nn</span>&nbsp;<span class="op" id="4746724">=</span>&nbsp;<span class="builtinfunc" id="4746726">len</span><span class="op" id="4746729">(</span><span class="ident" id="4746730">p</span><span class="op" id="4746731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746734">d</span><span class="op" id="4746735">.</span><span class="builtinfunc" id="4746736">len</span>&nbsp;<span class="op" id="4746740">+=</span>&nbsp;<span class="ident" id="4746743">uint64</span><span class="op" id="4746749">(</span><span class="ident" id="4746750">nn</span><span class="op" id="4746752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746755">if</span>&nbsp;<span class="ident" id="4746758">d</span><span class="op" id="4746759">.</span><span class="ident" id="4746760">nx</span>&nbsp;<span class="op" id="4746763">&gt;</span>&nbsp;<span class="num" id="4746765">0</span>&nbsp;<span class="op" id="4746767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746771">n</span>&nbsp;<span class="op" id="4746773">:=</span>&nbsp;<span class="builtinfunc" id="4746776">copy</span><span class="op" id="4746780">(</span><span class="ident" id="4746781">d</span><span class="op" id="4746782">.</span><span class="ident" id="4746783">x</span><span class="op" id="4746784">[</span><span class="ident" id="4746785">d</span><span class="op" id="4746786">.</span><span class="ident" id="4746787">nx</span><span class="op" id="4746789">:</span><span class="op" id="4746790">]</span><span class="op" id="4746791">,</span>&nbsp;<span class="ident" id="4746793">p</span><span class="op" id="4746794">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746798">d</span><span class="op" id="4746799">.</span><span class="ident" id="4746800">nx</span>&nbsp;<span class="op" id="4746803">+=</span>&nbsp;<span class="ident" id="4746806">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746810">if</span>&nbsp;<span class="ident" id="4746813">d</span><span class="op" id="4746814">.</span><span class="ident" id="4746815">nx</span>&nbsp;<span class="op" id="4746818">==</span>&nbsp;<span class="ident" id="4746821">chunk</span>&nbsp;<span class="op" id="4746827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746832">block</span><span class="op" id="4746837">(</span><span class="ident" id="4746838">d</span><span class="op" id="4746839">,</span>&nbsp;<span class="ident" id="4746841">d</span><span class="op" id="4746842">.</span><span class="ident" id="4746843">x</span><span class="op" id="4746844">[</span><span class="op" id="4746845">:</span><span class="op" id="4746846">]</span><span class="op" id="4746847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746852">d</span><span class="op" id="4746853">.</span><span class="ident" id="4746854">nx</span>&nbsp;<span class="op" id="4746857">=</span>&nbsp;<span class="num" id="4746859">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746863">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746867">p</span>&nbsp;<span class="op" id="4746869">=</span>&nbsp;<span class="ident" id="4746871">p</span><span class="op" id="4746872">[</span><span class="ident" id="4746873">n</span><span class="op" id="4746874">:</span><span class="op" id="4746875">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746881">if</span>&nbsp;<span class="builtinfunc" id="4746884">len</span><span class="op" id="4746887">(</span><span class="ident" id="4746888">p</span><span class="op" id="4746889">)</span>&nbsp;<span class="op" id="4746891">&gt;=</span>&nbsp;<span class="ident" id="4746894">chunk</span>&nbsp;<span class="op" id="4746900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746904">n</span>&nbsp;<span class="op" id="4746906">:=</span>&nbsp;<span class="builtinfunc" id="4746909">len</span><span class="op" id="4746912">(</span><span class="ident" id="4746913">p</span><span class="op" id="4746914">)</span>&nbsp;<span class="op" id="4746916">&amp;^</span>&nbsp;<span class="op" id="4746919">(</span><span class="ident" id="4746920">chunk</span>&nbsp;<span class="op" id="4746926">-</span>&nbsp;<span class="num" id="4746928">1</span><span class="op" id="4746929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746933">block</span><span class="op" id="4746938">(</span><span class="ident" id="4746939">d</span><span class="op" id="4746940">,</span>&nbsp;<span class="ident" id="4746942">p</span><span class="op" id="4746943">[</span><span class="op" id="4746944">:</span><span class="ident" id="4746945">n</span><span class="op" id="4746946">]</span><span class="op" id="4746947">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746951">p</span>&nbsp;<span class="op" id="4746953">=</span>&nbsp;<span class="ident" id="4746955">p</span><span class="op" id="4746956">[</span><span class="ident" id="4746957">n</span><span class="op" id="4746958">:</span><span class="op" id="4746959">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746965">if</span>&nbsp;<span class="builtinfunc" id="4746968">len</span><span class="op" id="4746971">(</span><span class="ident" id="4746972">p</span><span class="op" id="4746973">)</span>&nbsp;<span class="op" id="4746975">&gt;</span>&nbsp;<span class="num" id="4746977">0</span>&nbsp;<span class="op" id="4746979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746983">d</span><span class="op" id="4746984">.</span><span class="ident" id="4746985">nx</span>&nbsp;<span class="op" id="4746988">=</span>&nbsp;<span class="builtinfunc" id="4746990">copy</span><span class="op" id="4746994">(</span><span class="ident" id="4746995">d</span><span class="op" id="4746996">.</span><span class="ident" id="4746997">x</span><span class="op" id="4746998">[</span><span class="op" id="4746999">:</span><span class="op" id="4747000">]</span><span class="op" id="4747001">,</span>&nbsp;<span class="ident" id="4747003">p</span><span class="op" id="4747004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747007">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747010">return</span><br>
<span class="lineno"></span><span class="op" id="4747017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4747020">func</span>&nbsp;<span class="op" id="4747025">(</span><span class="ident" id="4747026">d0</span>&nbsp;<span class="op" id="4747029">*</span><span class="ident" id="4747030">digest</span><span class="op" id="4747036">)</span>&nbsp;<span class="ident" id="4747038">Sum</span><span class="op" id="4747041">(</span><span class="ident" id="4747042">in</span>&nbsp;<span class="op" id="4747045">[</span><span class="op" id="4747046">]</span><span class="builtintype" id="4747047">byte</span><span class="op" id="4747051">)</span>&nbsp;<span class="op" id="4747053">[</span><span class="op" id="4747054">]</span><span class="builtintype" id="4747055">byte</span>&nbsp;<span class="op" id="4747060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4747063">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747130">d</span>&nbsp;<span class="op" id="4747132">:=</span>&nbsp;<span class="builtinfunc" id="4747135">new</span><span class="op" id="4747138">(</span><span class="ident" id="4747139">digest</span><span class="op" id="4747145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747148">*</span><span class="ident" id="4747149">d</span>&nbsp;<span class="op" id="4747151">=</span>&nbsp;<span class="op" id="4747153">*</span><span class="ident" id="4747154">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747158">hash</span>&nbsp;<span class="op" id="4747163">:=</span>&nbsp;<span class="ident" id="4747166">d</span><span class="op" id="4747167">.</span><span class="ident" id="4747168">checkSum</span><span class="op" id="4747176">(</span><span class="op" id="4747177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747180">if</span>&nbsp;<span class="ident" id="4747183">d</span><span class="op" id="4747184">.</span><span class="ident" id="4747185">is384</span>&nbsp;<span class="op" id="4747191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747195">return</span>&nbsp;<span class="builtinfunc" id="4747202">append</span><span class="op" id="4747208">(</span><span class="ident" id="4747209">in</span><span class="op" id="4747211">,</span>&nbsp;<span class="ident" id="4747213">hash</span><span class="op" id="4747217">[</span><span class="op" id="4747218">:</span><span class="ident" id="4747219">Size384</span><span class="op" id="4747226">]</span><span class="op" id="4747227">...</span><span class="op" id="4747230">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747236">return</span>&nbsp;<span class="builtinfunc" id="4747243">append</span><span class="op" id="4747249">(</span><span class="ident" id="4747250">in</span><span class="op" id="4747252">,</span>&nbsp;<span class="ident" id="4747254">hash</span><span class="op" id="4747258">[</span><span class="op" id="4747259">:</span><span class="op" id="4747260">]</span><span class="op" id="4747261">...</span><span class="op" id="4747264">)</span><br>
<span class="lineno"></span><span class="op" id="4747266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4747269">func</span>&nbsp;<span class="op" id="4747274">(</span><span class="ident" id="4747275">d</span>&nbsp;<span class="op" id="4747277">*</span><span class="ident" id="4747278">digest</span><span class="op" id="4747284">)</span>&nbsp;<span class="ident" id="4747286">checkSum</span><span class="op" id="4747294">(</span><span class="op" id="4747295">)</span>&nbsp;<span class="op" id="4747297">[</span><span class="ident" id="4747298">Size</span><span class="op" id="4747302">]</span><span class="builtintype" id="4747303">byte</span>&nbsp;<span class="op" id="4747308">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4747311">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4747373">len</span>&nbsp;<span class="op" id="4747377">:=</span>&nbsp;<span class="ident" id="4747380">d</span><span class="op" id="4747381">.</span><span class="builtinfunc" id="4747382">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747387">var</span>&nbsp;<span class="ident" id="4747391">tmp</span>&nbsp;<span class="op" id="4747395">[</span><span class="num" id="4747396">128</span><span class="op" id="4747399">]</span><span class="builtintype" id="4747400">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747406">tmp</span><span class="op" id="4747409">[</span><span class="num" id="4747410">0</span><span class="op" id="4747411">]</span>&nbsp;<span class="op" id="4747413">=</span>&nbsp;<span class="num" id="4747415">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747421">if</span>&nbsp;<span class="builtinfunc" id="4747424">len</span><span class="op" id="4747427">%</span><span class="num" id="4747428">128</span>&nbsp;<span class="op" id="4747432">&lt;</span>&nbsp;<span class="num" id="4747434">112</span>&nbsp;<span class="op" id="4747438">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747442">d</span><span class="op" id="4747443">.</span><span class="ident" id="4747444">Write</span><span class="op" id="4747449">(</span><span class="ident" id="4747450">tmp</span><span class="op" id="4747453">[</span><span class="num" id="4747454">0</span>&nbsp;<span class="op" id="4747456">:</span>&nbsp;<span class="num" id="4747458">112</span><span class="op" id="4747461">-</span><span class="builtinfunc" id="4747462">len</span><span class="op" id="4747465">%</span><span class="num" id="4747466">128</span><span class="op" id="4747469">]</span><span class="op" id="4747470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747473">}</span>&nbsp;<span class="keyword" id="4747475">else</span>&nbsp;<span class="op" id="4747480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747484">d</span><span class="op" id="4747485">.</span><span class="ident" id="4747486">Write</span><span class="op" id="4747491">(</span><span class="ident" id="4747492">tmp</span><span class="op" id="4747495">[</span><span class="num" id="4747496">0</span>&nbsp;<span class="op" id="4747498">:</span>&nbsp;<span class="num" id="4747500">128</span><span class="op" id="4747503">+</span><span class="num" id="4747504">112</span><span class="op" id="4747507">-</span><span class="builtinfunc" id="4747508">len</span><span class="op" id="4747511">%</span><span class="num" id="4747512">128</span><span class="op" id="4747515">]</span><span class="op" id="4747516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4747523">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4747543">len</span>&nbsp;<span class="op" id="4747547">&lt;&lt;=</span>&nbsp;<span class="num" id="4747551">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747554">for</span>&nbsp;<span class="ident" id="4747558">i</span>&nbsp;<span class="op" id="4747560">:=</span>&nbsp;<span class="builtintype" id="4747563">uint</span><span class="op" id="4747567">(</span><span class="num" id="4747568">0</span><span class="op" id="4747569">)</span><span class="op" id="4747570">;</span>&nbsp;<span class="ident" id="4747572">i</span>&nbsp;<span class="op" id="4747574">&lt;</span>&nbsp;<span class="num" id="4747576">16</span><span class="op" id="4747578">;</span>&nbsp;<span class="ident" id="4747580">i</span><span class="op" id="4747581">++</span>&nbsp;<span class="op" id="4747584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747588">tmp</span><span class="op" id="4747591">[</span><span class="ident" id="4747592">i</span><span class="op" id="4747593">]</span>&nbsp;<span class="op" id="4747595">=</span>&nbsp;<span class="builtintype" id="4747597">byte</span><span class="op" id="4747601">(</span><span class="builtinfunc" id="4747602">len</span>&nbsp;<span class="op" id="4747606">&gt;&gt;</span>&nbsp;<span class="op" id="4747609">(</span><span class="num" id="4747610">120</span>&nbsp;<span class="op" id="4747614">-</span>&nbsp;<span class="num" id="4747616">8</span><span class="op" id="4747617">*</span><span class="ident" id="4747618">i</span><span class="op" id="4747619">)</span><span class="op" id="4747620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747623">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747626">d</span><span class="op" id="4747627">.</span><span class="ident" id="4747628">Write</span><span class="op" id="4747633">(</span><span class="ident" id="4747634">tmp</span><span class="op" id="4747637">[</span><span class="num" id="4747638">0</span><span class="op" id="4747639">:</span><span class="num" id="4747640">16</span><span class="op" id="4747642">]</span><span class="op" id="4747643">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747647">if</span>&nbsp;<span class="ident" id="4747650">d</span><span class="op" id="4747651">.</span><span class="ident" id="4747652">nx</span>&nbsp;<span class="op" id="4747655">!=</span>&nbsp;<span class="num" id="4747658">0</span>&nbsp;<span class="op" id="4747660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4747664">panic</span><span class="op" id="4747669">(</span><span class="string" id="4747670">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4747681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747684">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747688">h</span>&nbsp;<span class="op" id="4747690">:=</span>&nbsp;<span class="ident" id="4747693">d</span><span class="op" id="4747694">.</span><span class="ident" id="4747695">h</span><span class="op" id="4747696">[</span><span class="op" id="4747697">:</span><span class="op" id="4747698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747701">if</span>&nbsp;<span class="ident" id="4747704">d</span><span class="op" id="4747705">.</span><span class="ident" id="4747706">is384</span>&nbsp;<span class="op" id="4747712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747716">h</span>&nbsp;<span class="op" id="4747718">=</span>&nbsp;<span class="ident" id="4747720">d</span><span class="op" id="4747721">.</span><span class="ident" id="4747722">h</span><span class="op" id="4747723">[</span><span class="op" id="4747724">:</span><span class="num" id="4747725">6</span><span class="op" id="4747726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4747729">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747733">var</span>&nbsp;<span class="ident" id="4747737">digest</span>&nbsp;<span class="op" id="4747744">[</span><span class="ident" id="4747745">Size</span><span class="op" id="4747749">]</span><span class="builtintype" id="4747750">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747756">for</span>&nbsp;<span class="ident" id="4747760">i</span><span class="op" id="4747761">,</span>&nbsp;<span class="ident" id="4747763">s</span>&nbsp;<span class="op" id="4747765">:=</span>&nbsp;<span class="keyword" id="4747768">range</span>&nbsp;<span class="ident" id="4747774">h</span>&nbsp;<span class="op" id="4747776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747780">digest</span><span class="op" id="4747786">[</span><span class="ident" id="4747787">i</span><span class="op" id="4747788">*</span><span class="num" id="4747789">8</span><span class="op" id="4747790">]</span>&nbsp;<span class="op" id="4747792">=</span>&nbsp;<span class="builtintype" id="4747794">byte</span><span class="op" id="4747798">(</span><span class="ident" id="4747799">s</span>&nbsp;<span class="op" id="4747801">&gt;&gt;</span>&nbsp;<span class="num" id="4747804">56</span><span class="op" id="4747806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747810">digest</span><span class="op" id="4747816">[</span><span class="ident" id="4747817">i</span><span class="op" id="4747818">*</span><span class="num" id="4747819">8</span><span class="op" id="4747820">+</span><span class="num" id="4747821">1</span><span class="op" id="4747822">]</span>&nbsp;<span class="op" id="4747824">=</span>&nbsp;<span class="builtintype" id="4747826">byte</span><span class="op" id="4747830">(</span><span class="ident" id="4747831">s</span>&nbsp;<span class="op" id="4747833">&gt;&gt;</span>&nbsp;<span class="num" id="4747836">48</span><span class="op" id="4747838">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747842">digest</span><span class="op" id="4747848">[</span><span class="ident" id="4747849">i</span><span class="op" id="4747850">*</span><span class="num" id="4747851">8</span><span class="op" id="4747852">+</span><span class="num" id="4747853">2</span><span class="op" id="4747854">]</span>&nbsp;<span class="op" id="4747856">=</span>&nbsp;<span class="builtintype" id="4747858">byte</span><span class="op" id="4747862">(</span><span class="ident" id="4747863">s</span>&nbsp;<span class="op" id="4747865">&gt;&gt;</span>&nbsp;<span class="num" id="4747868">40</span><span class="op" id="4747870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747874">digest</span><span class="op" id="4747880">[</span><span class="ident" id="4747881">i</span><span class="op" id="4747882">*</span><span class="num" id="4747883">8</span><span class="op" id="4747884">+</span><span class="num" id="4747885">3</span><span class="op" id="4747886">]</span>&nbsp;<span class="op" id="4747888">=</span>&nbsp;<span class="builtintype" id="4747890">byte</span><span class="op" id="4747894">(</span><span class="ident" id="4747895">s</span>&nbsp;<span class="op" id="4747897">&gt;&gt;</span>&nbsp;<span class="num" id="4747900">32</span><span class="op" id="4747902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747906">digest</span><span class="op" id="4747912">[</span><span class="ident" id="4747913">i</span><span class="op" id="4747914">*</span><span class="num" id="4747915">8</span><span class="op" id="4747916">+</span><span class="num" id="4747917">4</span><span class="op" id="4747918">]</span>&nbsp;<span class="op" id="4747920">=</span>&nbsp;<span class="builtintype" id="4747922">byte</span><span class="op" id="4747926">(</span><span class="ident" id="4747927">s</span>&nbsp;<span class="op" id="4747929">&gt;&gt;</span>&nbsp;<span class="num" id="4747932">24</span><span class="op" id="4747934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747938">digest</span><span class="op" id="4747944">[</span><span class="ident" id="4747945">i</span><span class="op" id="4747946">*</span><span class="num" id="4747947">8</span><span class="op" id="4747948">+</span><span class="num" id="4747949">5</span><span class="op" id="4747950">]</span>&nbsp;<span class="op" id="4747952">=</span>&nbsp;<span class="builtintype" id="4747954">byte</span><span class="op" id="4747958">(</span><span class="ident" id="4747959">s</span>&nbsp;<span class="op" id="4747961">&gt;&gt;</span>&nbsp;<span class="num" id="4747964">16</span><span class="op" id="4747966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747970">digest</span><span class="op" id="4747976">[</span><span class="ident" id="4747977">i</span><span class="op" id="4747978">*</span><span class="num" id="4747979">8</span><span class="op" id="4747980">+</span><span class="num" id="4747981">6</span><span class="op" id="4747982">]</span>&nbsp;<span class="op" id="4747984">=</span>&nbsp;<span class="builtintype" id="4747986">byte</span><span class="op" id="4747990">(</span><span class="ident" id="4747991">s</span>&nbsp;<span class="op" id="4747993">&gt;&gt;</span>&nbsp;<span class="num" id="4747996">8</span><span class="op" id="4747997">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748001">digest</span><span class="op" id="4748007">[</span><span class="ident" id="4748008">i</span><span class="op" id="4748009">*</span><span class="num" id="4748010">8</span><span class="op" id="4748011">+</span><span class="num" id="4748012">7</span><span class="op" id="4748013">]</span>&nbsp;<span class="op" id="4748015">=</span>&nbsp;<span class="builtintype" id="4748017">byte</span><span class="op" id="4748021">(</span><span class="ident" id="4748022">s</span><span class="op" id="4748023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4748026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748030">return</span>&nbsp;<span class="ident" id="4748037">digest</span><br>
<span class="lineno"></span><span class="op" id="4748044">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4748047">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4748098">func</span>&nbsp;<span class="ident" id="4748103">Sum512</span><span class="op" id="4748109">(</span><span class="ident" id="4748110">data</span>&nbsp;<span class="op" id="4748115">[</span><span class="op" id="4748116">]</span><span class="builtintype" id="4748117">byte</span><span class="op" id="4748121">)</span>&nbsp;<span class="op" id="4748123">[</span><span class="ident" id="4748124">Size</span><span class="op" id="4748128">]</span><span class="builtintype" id="4748129">byte</span>&nbsp;<span class="op" id="4748134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748137">var</span>&nbsp;<span class="ident" id="4748141">d</span>&nbsp;<span class="ident" id="4748143">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748151">d</span><span class="op" id="4748152">.</span><span class="ident" id="4748153">Reset</span><span class="op" id="4748158">(</span><span class="op" id="4748159">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748162">d</span><span class="op" id="4748163">.</span><span class="ident" id="4748164">Write</span><span class="op" id="4748169">(</span><span class="ident" id="4748170">data</span><span class="op" id="4748174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748177">return</span>&nbsp;<span class="ident" id="4748184">d</span><span class="op" id="4748185">.</span><span class="ident" id="4748186">checkSum</span><span class="op" id="4748194">(</span><span class="op" id="4748195">)</span><br>
<span class="lineno"></span><span class="op" id="4748197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748200">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4748251">func</span>&nbsp;<span class="ident" id="4748256">Sum384</span><span class="op" id="4748262">(</span><span class="ident" id="4748263">data</span>&nbsp;<span class="op" id="4748268">[</span><span class="op" id="4748269">]</span><span class="builtintype" id="4748270">byte</span><span class="op" id="4748274">)</span>&nbsp;<span class="op" id="4748276">(</span><span class="ident" id="4748277">sum384</span>&nbsp;<span class="op" id="4748284">[</span><span class="ident" id="4748285">Size384</span><span class="op" id="4748292">]</span><span class="builtintype" id="4748293">byte</span><span class="op" id="4748297">)</span>&nbsp;<span class="op" id="4748299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748302">var</span>&nbsp;<span class="ident" id="4748306">d</span>&nbsp;<span class="ident" id="4748308">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748316">d</span><span class="op" id="4748317">.</span><span class="ident" id="4748318">is384</span>&nbsp;<span class="op" id="4748324">=</span>&nbsp;<span class="builtintype" id="4748326">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748332">d</span><span class="op" id="4748333">.</span><span class="ident" id="4748334">Reset</span><span class="op" id="4748339">(</span><span class="op" id="4748340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748343">d</span><span class="op" id="4748344">.</span><span class="ident" id="4748345">Write</span><span class="op" id="4748350">(</span><span class="ident" id="4748351">data</span><span class="op" id="4748355">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748358">sum</span>&nbsp;<span class="op" id="4748362">:=</span>&nbsp;<span class="ident" id="4748365">d</span><span class="op" id="4748366">.</span><span class="ident" id="4748367">checkSum</span><span class="op" id="4748375">(</span><span class="op" id="4748376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4748379">copy</span><span class="op" id="4748383">(</span><span class="ident" id="4748384">sum384</span><span class="op" id="4748390">[</span><span class="op" id="4748391">:</span><span class="op" id="4748392">]</span><span class="op" id="4748393">,</span>&nbsp;<span class="ident" id="4748395">sum</span><span class="op" id="4748398">[</span><span class="op" id="4748399">:</span><span class="ident" id="4748400">Size384</span><span class="op" id="4748407">]</span><span class="op" id="4748408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748411">return</span><br>
<span class="lineno"></span><span class="op" id="4748418">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
