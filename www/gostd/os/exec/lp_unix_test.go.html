<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html" class="current">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7975509">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7975565">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7975619">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7975670">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7975735">package</span>&nbsp;<span class="ident" id="7975743">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7975749">import</span>&nbsp;<span class="op" id="7975756">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7975759">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7975772">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7975778">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7975788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7975791">func</span>&nbsp;<span class="ident" id="7975796">TestLookPathUnixEmptyPath</span><span class="op" id="7975821">(</span><span class="ident" id="7975822">t</span>&nbsp;<span class="op" id="7975824">*</span><span class="ident" id="7975825">testing</span><span class="op" id="7975832">.</span><span class="ident" id="7975833">T</span><span class="op" id="7975834">)</span>&nbsp;<span class="op" id="7975836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7975839">tmp</span><span class="op" id="7975842">,</span>&nbsp;<span class="ident" id="7975844">err</span>&nbsp;<span class="op" id="7975848">:=</span>&nbsp;<span class="ident" id="7975851">ioutil</span><span class="op" id="7975857">.</span><span class="ident" id="7975858">TempDir</span><span class="op" id="7975865">(</span><span class="string" id="7975866">&#34;&#34;</span><span class="op" id="7975868">,</span>&nbsp;<span class="string" id="7975870">&#34;TestLookPathUnixEmptyPath&#34;</span><span class="op" id="7975897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7975900">if</span>&nbsp;<span class="ident" id="7975903">err</span>&nbsp;<span class="op" id="7975907">!=</span>&nbsp;<span class="builtintype" id="7975910">nil</span>&nbsp;<span class="op" id="7975914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7975918">t</span><span class="op" id="7975919">.</span><span class="ident" id="7975920">Fatal</span><span class="op" id="7975925">(</span><span class="string" id="7975926">&#34;TempDir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7975944">,</span>&nbsp;<span class="ident" id="7975946">err</span><span class="op" id="7975949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7975952">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7975955">defer</span>&nbsp;<span class="ident" id="7975961">os</span><span class="op" id="7975963">.</span><span class="ident" id="7975964">RemoveAll</span><span class="op" id="7975973">(</span><span class="ident" id="7975974">tmp</span><span class="op" id="7975977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7975980">wd</span><span class="op" id="7975982">,</span>&nbsp;<span class="ident" id="7975984">err</span>&nbsp;<span class="op" id="7975988">:=</span>&nbsp;<span class="ident" id="7975991">os</span><span class="op" id="7975993">.</span><span class="ident" id="7975994">Getwd</span><span class="op" id="7975999">(</span><span class="op" id="7976000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976003">if</span>&nbsp;<span class="ident" id="7976006">err</span>&nbsp;<span class="op" id="7976010">!=</span>&nbsp;<span class="builtintype" id="7976013">nil</span>&nbsp;<span class="op" id="7976017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976021">t</span><span class="op" id="7976022">.</span><span class="ident" id="7976023">Fatal</span><span class="op" id="7976028">(</span><span class="string" id="7976029">&#34;Getwd&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7976045">,</span>&nbsp;<span class="ident" id="7976047">err</span><span class="op" id="7976050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7976053">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976056">err</span>&nbsp;<span class="op" id="7976060">=</span>&nbsp;<span class="ident" id="7976062">os</span><span class="op" id="7976064">.</span><span class="ident" id="7976065">Chdir</span><span class="op" id="7976070">(</span><span class="ident" id="7976071">tmp</span><span class="op" id="7976074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976077">if</span>&nbsp;<span class="ident" id="7976080">err</span>&nbsp;<span class="op" id="7976084">!=</span>&nbsp;<span class="builtintype" id="7976087">nil</span>&nbsp;<span class="op" id="7976091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976095">t</span><span class="op" id="7976096">.</span><span class="ident" id="7976097">Fatal</span><span class="op" id="7976102">(</span><span class="string" id="7976103">&#34;Chdir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7976119">,</span>&nbsp;<span class="ident" id="7976121">err</span><span class="op" id="7976124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7976127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976130">defer</span>&nbsp;<span class="ident" id="7976136">os</span><span class="op" id="7976138">.</span><span class="ident" id="7976139">Chdir</span><span class="op" id="7976144">(</span><span class="ident" id="7976145">wd</span><span class="op" id="7976147">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976151">f</span><span class="op" id="7976152">,</span>&nbsp;<span class="ident" id="7976154">err</span>&nbsp;<span class="op" id="7976158">:=</span>&nbsp;<span class="ident" id="7976161">os</span><span class="op" id="7976163">.</span><span class="ident" id="7976164">OpenFile</span><span class="op" id="7976172">(</span><span class="string" id="7976173">&#34;exec_me&#34;</span><span class="op" id="7976182">,</span>&nbsp;<span class="ident" id="7976184">os</span><span class="op" id="7976186">.</span><span class="ident" id="7976187">O_CREATE</span><span class="op" id="7976195">|</span><span class="ident" id="7976196">os</span><span class="op" id="7976198">.</span><span class="ident" id="7976199">O_EXCL</span><span class="op" id="7976205">,</span>&nbsp;<span class="num" id="7976207">0700</span><span class="op" id="7976211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976214">if</span>&nbsp;<span class="ident" id="7976217">err</span>&nbsp;<span class="op" id="7976221">!=</span>&nbsp;<span class="builtintype" id="7976224">nil</span>&nbsp;<span class="op" id="7976228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976232">t</span><span class="op" id="7976233">.</span><span class="ident" id="7976234">Fatal</span><span class="op" id="7976239">(</span><span class="string" id="7976240">&#34;OpenFile&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7976259">,</span>&nbsp;<span class="ident" id="7976261">err</span><span class="op" id="7976264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7976267">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976270">err</span>&nbsp;<span class="op" id="7976274">=</span>&nbsp;<span class="ident" id="7976276">f</span><span class="op" id="7976277">.</span><span class="ident" id="7976278">Close</span><span class="op" id="7976283">(</span><span class="op" id="7976284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976287">if</span>&nbsp;<span class="ident" id="7976290">err</span>&nbsp;<span class="op" id="7976294">!=</span>&nbsp;<span class="builtintype" id="7976297">nil</span>&nbsp;<span class="op" id="7976301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976305">t</span><span class="op" id="7976306">.</span><span class="ident" id="7976307">Fatal</span><span class="op" id="7976312">(</span><span class="string" id="7976313">&#34;Close&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7976329">,</span>&nbsp;<span class="ident" id="7976331">err</span><span class="op" id="7976334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7976337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976341">pathenv</span>&nbsp;<span class="op" id="7976349">:=</span>&nbsp;<span class="ident" id="7976352">os</span><span class="op" id="7976354">.</span><span class="ident" id="7976355">Getenv</span><span class="op" id="7976361">(</span><span class="string" id="7976362">&#34;PATH&#34;</span><span class="op" id="7976368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976371">defer</span>&nbsp;<span class="ident" id="7976377">os</span><span class="op" id="7976379">.</span><span class="ident" id="7976380">Setenv</span><span class="op" id="7976386">(</span><span class="string" id="7976387">&#34;PATH&#34;</span><span class="op" id="7976393">,</span>&nbsp;<span class="ident" id="7976395">pathenv</span><span class="op" id="7976402">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976406">err</span>&nbsp;<span class="op" id="7976410">=</span>&nbsp;<span class="ident" id="7976412">os</span><span class="op" id="7976414">.</span><span class="ident" id="7976415">Setenv</span><span class="op" id="7976421">(</span><span class="string" id="7976422">&#34;PATH&#34;</span><span class="op" id="7976428">,</span>&nbsp;<span class="string" id="7976430">&#34;&#34;</span><span class="op" id="7976432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976435">if</span>&nbsp;<span class="ident" id="7976438">err</span>&nbsp;<span class="op" id="7976442">!=</span>&nbsp;<span class="builtintype" id="7976445">nil</span>&nbsp;<span class="op" id="7976449">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976453">t</span><span class="op" id="7976454">.</span><span class="ident" id="7976455">Fatal</span><span class="op" id="7976460">(</span><span class="string" id="7976461">&#34;Setenv&nbsp;failed:&nbsp;&#34;</span><span class="op" id="7976478">,</span>&nbsp;<span class="ident" id="7976480">err</span><span class="op" id="7976483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7976486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976490">path</span><span class="op" id="7976494">,</span>&nbsp;<span class="ident" id="7976496">err</span>&nbsp;<span class="op" id="7976500">:=</span>&nbsp;<span class="ident" id="7976503">LookPath</span><span class="op" id="7976511">(</span><span class="string" id="7976512">&#34;exec_me&#34;</span><span class="op" id="7976521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976524">if</span>&nbsp;<span class="ident" id="7976527">err</span>&nbsp;<span class="op" id="7976531">==</span>&nbsp;<span class="builtintype" id="7976534">nil</span>&nbsp;<span class="op" id="7976538">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976542">t</span><span class="op" id="7976543">.</span><span class="ident" id="7976544">Fatal</span><span class="op" id="7976549">(</span><span class="string" id="7976550">&#34;LookPath&nbsp;found&nbsp;exec_me&nbsp;in&nbsp;empty&nbsp;$PATH&#34;</span><span class="op" id="7976589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7976592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7976595">if</span>&nbsp;<span class="ident" id="7976598">path</span>&nbsp;<span class="op" id="7976603">!=</span>&nbsp;<span class="string" id="7976606">&#34;&#34;</span>&nbsp;<span class="op" id="7976609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7976613">t</span><span class="op" id="7976614">.</span><span class="ident" id="7976615">Fatalf</span><span class="op" id="7976621">(</span><span class="string" id="7976622">&#34;LookPath&nbsp;path&nbsp;==&nbsp;%q&nbsp;when&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7976659">,</span>&nbsp;<span class="ident" id="7976661">path</span><span class="op" id="7976665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7976668">}</span><br>
<span class="lineno">55</span><span class="op" id="7976670">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
