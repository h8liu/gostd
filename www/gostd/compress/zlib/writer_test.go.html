<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7479804">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7479859">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7479913">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7479964">package</span>&nbsp;<span class="ident" id="7479972">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7479978">import</span>&nbsp;<span class="op" id="7479985">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7479988">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7479997">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7480004">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7480010">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7480023">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7480029">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7480039">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7480042">var</span>&nbsp;<span class="ident" id="7480046">filenames</span>&nbsp;<span class="op" id="7480056">=</span>&nbsp;<span class="op" id="7480058">[</span><span class="op" id="7480059">]</span><span class="builtintype" id="7480060">string</span><span class="op" id="7480066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7480069">&#34;../testdata/e.txt&#34;</span><span class="op" id="7480088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7480091">&#34;../testdata/pi.txt&#34;</span><span class="op" id="7480111">,</span><br>
<span class="lineno"></span><span class="op" id="7480113">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7480116">var</span>&nbsp;<span class="ident" id="7480120">data</span>&nbsp;<span class="op" id="7480125">=</span>&nbsp;<span class="op" id="7480127">[</span><span class="op" id="7480128">]</span><span class="builtintype" id="7480129">string</span><span class="op" id="7480135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7480138">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="7480193">,</span><br>
<span class="lineno"></span><span class="op" id="7480195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="7480198">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="7480308">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="7480357">func</span>&nbsp;<span class="ident" id="7480362">testFileLevelDict</span><span class="op" id="7480379">(</span><span class="ident" id="7480380">t</span>&nbsp;<span class="op" id="7480382">*</span><span class="ident" id="7480383">testing</span><span class="op" id="7480390">.</span><span class="ident" id="7480391">T</span><span class="op" id="7480392">,</span>&nbsp;<span class="ident" id="7480394">fn</span>&nbsp;<span class="builtintype" id="7480397">string</span><span class="op" id="7480403">,</span>&nbsp;<span class="ident" id="7480405">level</span>&nbsp;<span class="builtintype" id="7480411">int</span><span class="op" id="7480414">,</span>&nbsp;<span class="ident" id="7480416">d</span>&nbsp;<span class="builtintype" id="7480418">string</span><span class="op" id="7480424">)</span>&nbsp;<span class="op" id="7480426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7480429">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7480466">golden</span><span class="op" id="7480472">,</span>&nbsp;<span class="ident" id="7480474">err</span>&nbsp;<span class="op" id="7480478">:=</span>&nbsp;<span class="ident" id="7480481">os</span><span class="op" id="7480483">.</span><span class="ident" id="7480484">Open</span><span class="op" id="7480488">(</span><span class="ident" id="7480489">fn</span><span class="op" id="7480491">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7480494">if</span>&nbsp;<span class="ident" id="7480497">err</span>&nbsp;<span class="op" id="7480501">!=</span>&nbsp;<span class="ident" id="7480504">nil</span>&nbsp;<span class="op" id="7480508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7480512">t</span><span class="op" id="7480513">.</span><span class="ident" id="7480514">Errorf</span><span class="op" id="7480520">(</span><span class="string" id="7480521">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7480549">,</span>&nbsp;<span class="ident" id="7480551">fn</span><span class="op" id="7480553">,</span>&nbsp;<span class="ident" id="7480555">level</span><span class="op" id="7480560">,</span>&nbsp;<span class="ident" id="7480562">d</span><span class="op" id="7480563">,</span>&nbsp;<span class="ident" id="7480565">err</span><span class="op" id="7480568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7480572">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7480580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7480583">defer</span>&nbsp;<span class="ident" id="7480589">golden</span><span class="op" id="7480595">.</span><span class="ident" id="7480596">Close</span><span class="op" id="7480601">(</span><span class="op" id="7480602">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7480605">b0</span><span class="op" id="7480607">,</span>&nbsp;<span class="ident" id="7480609">err0</span>&nbsp;<span class="op" id="7480614">:=</span>&nbsp;<span class="ident" id="7480617">ioutil</span><span class="op" id="7480623">.</span><span class="ident" id="7480624">ReadAll</span><span class="op" id="7480631">(</span><span class="ident" id="7480632">golden</span><span class="op" id="7480638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7480641">if</span>&nbsp;<span class="ident" id="7480644">err0</span>&nbsp;<span class="op" id="7480649">!=</span>&nbsp;<span class="ident" id="7480652">nil</span>&nbsp;<span class="op" id="7480656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7480660">t</span><span class="op" id="7480661">.</span><span class="ident" id="7480662">Errorf</span><span class="op" id="7480668">(</span><span class="string" id="7480669">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7480697">,</span>&nbsp;<span class="ident" id="7480699">fn</span><span class="op" id="7480701">,</span>&nbsp;<span class="ident" id="7480703">level</span><span class="op" id="7480708">,</span>&nbsp;<span class="ident" id="7480710">d</span><span class="op" id="7480711">,</span>&nbsp;<span class="ident" id="7480713">err0</span><span class="op" id="7480717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7480721">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7480729">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7480732">testLevelDict</span><span class="op" id="7480745">(</span><span class="ident" id="7480746">t</span><span class="op" id="7480747">,</span>&nbsp;<span class="ident" id="7480749">fn</span><span class="op" id="7480751">,</span>&nbsp;<span class="ident" id="7480753">b0</span><span class="op" id="7480755">,</span>&nbsp;<span class="ident" id="7480757">level</span><span class="op" id="7480762">,</span>&nbsp;<span class="ident" id="7480764">d</span><span class="op" id="7480765">)</span><br>
<span class="lineno"></span><span class="op" id="7480767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7480770">func</span>&nbsp;<span class="ident" id="7480775">testLevelDict</span><span class="op" id="7480788">(</span><span class="ident" id="7480789">t</span>&nbsp;<span class="op" id="7480791">*</span><span class="ident" id="7480792">testing</span><span class="op" id="7480799">.</span><span class="ident" id="7480800">T</span><span class="op" id="7480801">,</span>&nbsp;<span class="ident" id="7480803">fn</span>&nbsp;<span class="builtintype" id="7480806">string</span><span class="op" id="7480812">,</span>&nbsp;<span class="ident" id="7480814">b0</span>&nbsp;<span class="op" id="7480817">[</span><span class="op" id="7480818">]</span><span class="builtintype" id="7480819">byte</span><span class="op" id="7480823">,</span>&nbsp;<span class="ident" id="7480825">level</span>&nbsp;<span class="builtintype" id="7480831">int</span><span class="op" id="7480834">,</span>&nbsp;<span class="ident" id="7480836">d</span>&nbsp;<span class="builtintype" id="7480838">string</span><span class="op" id="7480844">)</span>&nbsp;<span class="op" id="7480846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7480849">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7480880">var</span>&nbsp;<span class="ident" id="7480884">dict</span>&nbsp;<span class="op" id="7480889">[</span><span class="op" id="7480890">]</span><span class="builtintype" id="7480891">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7480897">if</span>&nbsp;<span class="ident" id="7480900">d</span>&nbsp;<span class="op" id="7480902">!=</span>&nbsp;<span class="string" id="7480905">&#34;&#34;</span>&nbsp;<span class="op" id="7480908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7480912">dict</span>&nbsp;<span class="op" id="7480917">=</span>&nbsp;<span class="op" id="7480919">[</span><span class="op" id="7480920">]</span><span class="builtintype" id="7480921">byte</span><span class="op" id="7480925">(</span><span class="ident" id="7480926">d</span><span class="op" id="7480927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7480930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7480934">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481031">piper</span><span class="op" id="7481036">,</span>&nbsp;<span class="ident" id="7481038">pipew</span>&nbsp;<span class="op" id="7481044">:=</span>&nbsp;<span class="ident" id="7481047">io</span><span class="op" id="7481049">.</span><span class="ident" id="7481050">Pipe</span><span class="op" id="7481054">(</span><span class="op" id="7481055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481058">defer</span>&nbsp;<span class="ident" id="7481064">piper</span><span class="op" id="7481069">.</span><span class="ident" id="7481070">Close</span><span class="op" id="7481075">(</span><span class="op" id="7481076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481079">go</span>&nbsp;<span class="keyword" id="7481082">func</span><span class="op" id="7481086">(</span><span class="op" id="7481087">)</span>&nbsp;<span class="op" id="7481089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481093">defer</span>&nbsp;<span class="ident" id="7481099">pipew</span><span class="op" id="7481104">.</span><span class="ident" id="7481105">Close</span><span class="op" id="7481110">(</span><span class="op" id="7481111">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481115">zlibw</span><span class="op" id="7481120">,</span>&nbsp;<span class="ident" id="7481122">err</span>&nbsp;<span class="op" id="7481126">:=</span>&nbsp;<span class="ident" id="7481129">NewWriterLevelDict</span><span class="op" id="7481147">(</span><span class="ident" id="7481148">pipew</span><span class="op" id="7481153">,</span>&nbsp;<span class="ident" id="7481155">level</span><span class="op" id="7481160">,</span>&nbsp;<span class="ident" id="7481162">dict</span><span class="op" id="7481166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481170">if</span>&nbsp;<span class="ident" id="7481173">err</span>&nbsp;<span class="op" id="7481177">!=</span>&nbsp;<span class="ident" id="7481180">nil</span>&nbsp;<span class="op" id="7481184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481189">t</span><span class="op" id="7481190">.</span><span class="ident" id="7481191">Errorf</span><span class="op" id="7481197">(</span><span class="string" id="7481198">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7481226">,</span>&nbsp;<span class="ident" id="7481228">fn</span><span class="op" id="7481230">,</span>&nbsp;<span class="ident" id="7481232">level</span><span class="op" id="7481237">,</span>&nbsp;<span class="ident" id="7481239">d</span><span class="op" id="7481240">,</span>&nbsp;<span class="ident" id="7481242">err</span><span class="op" id="7481245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481250">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481259">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481263">defer</span>&nbsp;<span class="ident" id="7481269">zlibw</span><span class="op" id="7481274">.</span><span class="ident" id="7481275">Close</span><span class="op" id="7481280">(</span><span class="op" id="7481281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481285">_</span><span class="op" id="7481286">,</span>&nbsp;<span class="ident" id="7481288">err</span>&nbsp;<span class="op" id="7481292">=</span>&nbsp;<span class="ident" id="7481294">zlibw</span><span class="op" id="7481299">.</span><span class="ident" id="7481300">Write</span><span class="op" id="7481305">(</span><span class="ident" id="7481306">b0</span><span class="op" id="7481308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481312">if</span>&nbsp;<span class="ident" id="7481315">err</span>&nbsp;<span class="op" id="7481319">!=</span>&nbsp;<span class="ident" id="7481322">nil</span>&nbsp;<span class="op" id="7481326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481331">t</span><span class="op" id="7481332">.</span><span class="ident" id="7481333">Errorf</span><span class="op" id="7481339">(</span><span class="string" id="7481340">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7481368">,</span>&nbsp;<span class="ident" id="7481370">fn</span><span class="op" id="7481372">,</span>&nbsp;<span class="ident" id="7481374">level</span><span class="op" id="7481379">,</span>&nbsp;<span class="ident" id="7481381">d</span><span class="op" id="7481382">,</span>&nbsp;<span class="ident" id="7481384">err</span><span class="op" id="7481387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481392">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481404">}</span><span class="op" id="7481405">(</span><span class="op" id="7481406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481409">zlibr</span><span class="op" id="7481414">,</span>&nbsp;<span class="ident" id="7481416">err</span>&nbsp;<span class="op" id="7481420">:=</span>&nbsp;<span class="ident" id="7481423">NewReaderDict</span><span class="op" id="7481436">(</span><span class="ident" id="7481437">piper</span><span class="op" id="7481442">,</span>&nbsp;<span class="ident" id="7481444">dict</span><span class="op" id="7481448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481451">if</span>&nbsp;<span class="ident" id="7481454">err</span>&nbsp;<span class="op" id="7481458">!=</span>&nbsp;<span class="ident" id="7481461">nil</span>&nbsp;<span class="op" id="7481465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481469">t</span><span class="op" id="7481470">.</span><span class="ident" id="7481471">Errorf</span><span class="op" id="7481477">(</span><span class="string" id="7481478">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7481506">,</span>&nbsp;<span class="ident" id="7481508">fn</span><span class="op" id="7481510">,</span>&nbsp;<span class="ident" id="7481512">level</span><span class="op" id="7481517">,</span>&nbsp;<span class="ident" id="7481519">d</span><span class="op" id="7481520">,</span>&nbsp;<span class="ident" id="7481522">err</span><span class="op" id="7481525">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481529">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481540">defer</span>&nbsp;<span class="ident" id="7481546">zlibr</span><span class="op" id="7481551">.</span><span class="ident" id="7481552">Close</span><span class="op" id="7481557">(</span><span class="op" id="7481558">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7481562">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481597">b1</span><span class="op" id="7481599">,</span>&nbsp;<span class="ident" id="7481601">err1</span>&nbsp;<span class="op" id="7481606">:=</span>&nbsp;<span class="ident" id="7481609">ioutil</span><span class="op" id="7481615">.</span><span class="ident" id="7481616">ReadAll</span><span class="op" id="7481623">(</span><span class="ident" id="7481624">zlibr</span><span class="op" id="7481629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481632">if</span>&nbsp;<span class="ident" id="7481635">err1</span>&nbsp;<span class="op" id="7481640">!=</span>&nbsp;<span class="ident" id="7481643">nil</span>&nbsp;<span class="op" id="7481647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481651">t</span><span class="op" id="7481652">.</span><span class="ident" id="7481653">Errorf</span><span class="op" id="7481659">(</span><span class="string" id="7481660">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7481688">,</span>&nbsp;<span class="ident" id="7481690">fn</span><span class="op" id="7481692">,</span>&nbsp;<span class="ident" id="7481694">level</span><span class="op" id="7481699">,</span>&nbsp;<span class="ident" id="7481701">d</span><span class="op" id="7481702">,</span>&nbsp;<span class="ident" id="7481704">err1</span><span class="op" id="7481708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481712">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481720">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481723">if</span>&nbsp;<span class="builtinfunc" id="7481726">len</span><span class="op" id="7481729">(</span><span class="ident" id="7481730">b0</span><span class="op" id="7481732">)</span>&nbsp;<span class="op" id="7481734">!=</span>&nbsp;<span class="builtinfunc" id="7481737">len</span><span class="op" id="7481740">(</span><span class="ident" id="7481741">b1</span><span class="op" id="7481743">)</span>&nbsp;<span class="op" id="7481745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481749">t</span><span class="op" id="7481750">.</span><span class="ident" id="7481751">Errorf</span><span class="op" id="7481757">(</span><span class="string" id="7481758">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="7481812">,</span>&nbsp;<span class="ident" id="7481814">fn</span><span class="op" id="7481816">,</span>&nbsp;<span class="ident" id="7481818">level</span><span class="op" id="7481823">,</span>&nbsp;<span class="ident" id="7481825">d</span><span class="op" id="7481826">,</span>&nbsp;<span class="builtinfunc" id="7481828">len</span><span class="op" id="7481831">(</span><span class="ident" id="7481832">b0</span><span class="op" id="7481834">)</span><span class="op" id="7481835">,</span>&nbsp;<span class="builtinfunc" id="7481837">len</span><span class="op" id="7481840">(</span><span class="ident" id="7481841">b1</span><span class="op" id="7481843">)</span><span class="op" id="7481844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481848">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481859">for</span>&nbsp;<span class="ident" id="7481863">i</span>&nbsp;<span class="op" id="7481865">:=</span>&nbsp;<span class="num" id="7481868">0</span><span class="op" id="7481869">;</span>&nbsp;<span class="ident" id="7481871">i</span>&nbsp;<span class="op" id="7481873">&lt;</span>&nbsp;<span class="builtinfunc" id="7481875">len</span><span class="op" id="7481878">(</span><span class="ident" id="7481879">b0</span><span class="op" id="7481881">)</span><span class="op" id="7481882">;</span>&nbsp;<span class="ident" id="7481884">i</span><span class="op" id="7481885">++</span>&nbsp;<span class="op" id="7481888">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7481892">if</span>&nbsp;<span class="ident" id="7481895">b0</span><span class="op" id="7481897">[</span><span class="ident" id="7481898">i</span><span class="op" id="7481899">]</span>&nbsp;<span class="op" id="7481901">!=</span>&nbsp;<span class="ident" id="7481904">b1</span><span class="op" id="7481906">[</span><span class="ident" id="7481907">i</span><span class="op" id="7481908">]</span>&nbsp;<span class="op" id="7481910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481915">t</span><span class="op" id="7481916">.</span><span class="ident" id="7481917">Errorf</span><span class="op" id="7481923">(</span><span class="string" id="7481924">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="7481988">,</span>&nbsp;<span class="ident" id="7481990">fn</span><span class="op" id="7481992">,</span>&nbsp;<span class="ident" id="7481994">level</span><span class="op" id="7481999">,</span>&nbsp;<span class="ident" id="7482001">d</span><span class="op" id="7482002">,</span>&nbsp;<span class="ident" id="7482004">i</span><span class="op" id="7482005">,</span>&nbsp;<span class="ident" id="7482007">b0</span><span class="op" id="7482009">[</span><span class="ident" id="7482010">i</span><span class="op" id="7482011">]</span><span class="op" id="7482012">,</span>&nbsp;<span class="ident" id="7482014">b1</span><span class="op" id="7482016">[</span><span class="ident" id="7482017">i</span><span class="op" id="7482018">]</span><span class="op" id="7482019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482024">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482036">}</span><br>
<span class="lineno">90</span><span class="op" id="7482038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7482041">func</span>&nbsp;<span class="ident" id="7482046">testFileLevelDictReset</span><span class="op" id="7482068">(</span><span class="ident" id="7482069">t</span>&nbsp;<span class="op" id="7482071">*</span><span class="ident" id="7482072">testing</span><span class="op" id="7482079">.</span><span class="ident" id="7482080">T</span><span class="op" id="7482081">,</span>&nbsp;<span class="ident" id="7482083">fn</span>&nbsp;<span class="builtintype" id="7482086">string</span><span class="op" id="7482092">,</span>&nbsp;<span class="ident" id="7482094">level</span>&nbsp;<span class="builtintype" id="7482100">int</span><span class="op" id="7482103">,</span>&nbsp;<span class="ident" id="7482105">dict</span>&nbsp;<span class="op" id="7482110">[</span><span class="op" id="7482111">]</span><span class="builtintype" id="7482112">byte</span><span class="op" id="7482116">)</span>&nbsp;<span class="op" id="7482118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482121">var</span>&nbsp;<span class="ident" id="7482125">b0</span>&nbsp;<span class="op" id="7482128">[</span><span class="op" id="7482129">]</span><span class="builtintype" id="7482130">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482136">var</span>&nbsp;<span class="ident" id="7482140">err</span>&nbsp;<span class="builtintype" id="7482144">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482151">if</span>&nbsp;<span class="ident" id="7482154">fn</span>&nbsp;<span class="op" id="7482157">!=</span>&nbsp;<span class="string" id="7482160">&#34;&#34;</span>&nbsp;<span class="op" id="7482163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482167">b0</span><span class="op" id="7482169">,</span>&nbsp;<span class="ident" id="7482171">err</span>&nbsp;<span class="op" id="7482175">=</span>&nbsp;<span class="ident" id="7482177">ioutil</span><span class="op" id="7482183">.</span><span class="ident" id="7482184">ReadFile</span><span class="op" id="7482192">(</span><span class="ident" id="7482193">fn</span><span class="op" id="7482195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482199">if</span>&nbsp;<span class="ident" id="7482202">err</span>&nbsp;<span class="op" id="7482206">!=</span>&nbsp;<span class="ident" id="7482209">nil</span>&nbsp;<span class="op" id="7482213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482218">t</span><span class="op" id="7482219">.</span><span class="ident" id="7482220">Errorf</span><span class="op" id="7482226">(</span><span class="string" id="7482227">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7482246">,</span>&nbsp;<span class="ident" id="7482248">fn</span><span class="op" id="7482250">,</span>&nbsp;<span class="ident" id="7482252">level</span><span class="op" id="7482257">,</span>&nbsp;<span class="ident" id="7482259">err</span><span class="op" id="7482262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482267">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7482283">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482302">buf</span>&nbsp;<span class="op" id="7482306">:=</span>&nbsp;<span class="builtinfunc" id="7482309">new</span><span class="op" id="7482312">(</span><span class="ident" id="7482313">bytes</span><span class="op" id="7482318">.</span><span class="ident" id="7482319">Buffer</span><span class="op" id="7482325">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482328">var</span>&nbsp;<span class="ident" id="7482332">zlibw</span>&nbsp;<span class="op" id="7482338">*</span><span class="ident" id="7482339">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482347">if</span>&nbsp;<span class="ident" id="7482350">dict</span>&nbsp;<span class="op" id="7482355">==</span>&nbsp;<span class="ident" id="7482358">nil</span>&nbsp;<span class="op" id="7482362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482366">zlibw</span><span class="op" id="7482371">,</span>&nbsp;<span class="ident" id="7482373">err</span>&nbsp;<span class="op" id="7482377">=</span>&nbsp;<span class="ident" id="7482379">NewWriterLevel</span><span class="op" id="7482393">(</span><span class="ident" id="7482394">buf</span><span class="op" id="7482397">,</span>&nbsp;<span class="ident" id="7482399">level</span><span class="op" id="7482404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482407">}</span>&nbsp;<span class="keyword" id="7482409">else</span>&nbsp;<span class="op" id="7482414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482418">zlibw</span><span class="op" id="7482423">,</span>&nbsp;<span class="ident" id="7482425">err</span>&nbsp;<span class="op" id="7482429">=</span>&nbsp;<span class="ident" id="7482431">NewWriterLevelDict</span><span class="op" id="7482449">(</span><span class="ident" id="7482450">buf</span><span class="op" id="7482453">,</span>&nbsp;<span class="ident" id="7482455">level</span><span class="op" id="7482460">,</span>&nbsp;<span class="ident" id="7482462">dict</span><span class="op" id="7482466">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482472">if</span>&nbsp;<span class="ident" id="7482475">err</span>&nbsp;<span class="op" id="7482479">==</span>&nbsp;<span class="ident" id="7482482">nil</span>&nbsp;<span class="op" id="7482486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482490">_</span><span class="op" id="7482491">,</span>&nbsp;<span class="ident" id="7482493">err</span>&nbsp;<span class="op" id="7482497">=</span>&nbsp;<span class="ident" id="7482499">zlibw</span><span class="op" id="7482504">.</span><span class="ident" id="7482505">Write</span><span class="op" id="7482510">(</span><span class="ident" id="7482511">b0</span><span class="op" id="7482513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482519">if</span>&nbsp;<span class="ident" id="7482522">err</span>&nbsp;<span class="op" id="7482526">==</span>&nbsp;<span class="ident" id="7482529">nil</span>&nbsp;<span class="op" id="7482533">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482537">err</span>&nbsp;<span class="op" id="7482541">=</span>&nbsp;<span class="ident" id="7482543">zlibw</span><span class="op" id="7482548">.</span><span class="ident" id="7482549">Close</span><span class="op" id="7482554">(</span><span class="op" id="7482555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482561">if</span>&nbsp;<span class="ident" id="7482564">err</span>&nbsp;<span class="op" id="7482568">!=</span>&nbsp;<span class="ident" id="7482571">nil</span>&nbsp;<span class="op" id="7482575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482579">t</span><span class="op" id="7482580">.</span><span class="ident" id="7482581">Errorf</span><span class="op" id="7482587">(</span><span class="string" id="7482588">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7482607">,</span>&nbsp;<span class="ident" id="7482609">fn</span><span class="op" id="7482611">,</span>&nbsp;<span class="ident" id="7482613">level</span><span class="op" id="7482618">,</span>&nbsp;<span class="ident" id="7482620">err</span><span class="op" id="7482623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482627">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482638">out</span>&nbsp;<span class="op" id="7482642">:=</span>&nbsp;<span class="ident" id="7482645">buf</span><span class="op" id="7482648">.</span><span class="ident" id="7482649">String</span><span class="op" id="7482655">(</span><span class="op" id="7482656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7482660">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482690">buf2</span>&nbsp;<span class="op" id="7482695">:=</span>&nbsp;<span class="builtinfunc" id="7482698">new</span><span class="op" id="7482701">(</span><span class="ident" id="7482702">bytes</span><span class="op" id="7482707">.</span><span class="ident" id="7482708">Buffer</span><span class="op" id="7482714">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482717">zlibw</span><span class="op" id="7482722">.</span><span class="ident" id="7482723">Reset</span><span class="op" id="7482728">(</span><span class="ident" id="7482729">buf2</span><span class="op" id="7482733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482736">_</span><span class="op" id="7482737">,</span>&nbsp;<span class="ident" id="7482739">err</span>&nbsp;<span class="op" id="7482743">=</span>&nbsp;<span class="ident" id="7482745">zlibw</span><span class="op" id="7482750">.</span><span class="ident" id="7482751">Write</span><span class="op" id="7482756">(</span><span class="ident" id="7482757">b0</span><span class="op" id="7482759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482762">if</span>&nbsp;<span class="ident" id="7482765">err</span>&nbsp;<span class="op" id="7482769">==</span>&nbsp;<span class="ident" id="7482772">nil</span>&nbsp;<span class="op" id="7482776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482780">err</span>&nbsp;<span class="op" id="7482784">=</span>&nbsp;<span class="ident" id="7482786">zlibw</span><span class="op" id="7482791">.</span><span class="ident" id="7482792">Close</span><span class="op" id="7482797">(</span><span class="op" id="7482798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482801">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482804">if</span>&nbsp;<span class="ident" id="7482807">err</span>&nbsp;<span class="op" id="7482811">!=</span>&nbsp;<span class="ident" id="7482814">nil</span>&nbsp;<span class="op" id="7482818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482822">t</span><span class="op" id="7482823">.</span><span class="ident" id="7482824">Errorf</span><span class="op" id="7482830">(</span><span class="string" id="7482831">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7482850">,</span>&nbsp;<span class="ident" id="7482852">fn</span><span class="op" id="7482854">,</span>&nbsp;<span class="ident" id="7482856">level</span><span class="op" id="7482861">,</span>&nbsp;<span class="ident" id="7482863">err</span><span class="op" id="7482866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482870">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7482878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482881">out2</span>&nbsp;<span class="op" id="7482886">:=</span>&nbsp;<span class="ident" id="7482889">buf2</span><span class="op" id="7482893">.</span><span class="ident" id="7482894">String</span><span class="op" id="7482900">(</span><span class="op" id="7482901">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7482905">if</span>&nbsp;<span class="ident" id="7482908">out2</span>&nbsp;<span class="op" id="7482913">!=</span>&nbsp;<span class="ident" id="7482916">out</span>&nbsp;<span class="op" id="7482920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7482924">t</span><span class="op" id="7482925">.</span><span class="ident" id="7482926">Errorf</span><span class="op" id="7482932">(</span><span class="string" id="7482933">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7483005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483010">fn</span><span class="op" id="7483012">,</span>&nbsp;<span class="ident" id="7483014">level</span><span class="op" id="7483019">,</span>&nbsp;<span class="builtinfunc" id="7483021">len</span><span class="op" id="7483024">(</span><span class="ident" id="7483025">out2</span><span class="op" id="7483029">)</span><span class="op" id="7483030">,</span>&nbsp;<span class="builtinfunc" id="7483032">len</span><span class="op" id="7483035">(</span><span class="ident" id="7483036">out</span><span class="op" id="7483039">)</span><span class="op" id="7483040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483043">}</span><br>
<span class="lineno">140</span><span class="op" id="7483045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7483048">func</span>&nbsp;<span class="ident" id="7483053">TestWriter</span><span class="op" id="7483063">(</span><span class="ident" id="7483064">t</span>&nbsp;<span class="op" id="7483066">*</span><span class="ident" id="7483067">testing</span><span class="op" id="7483074">.</span><span class="ident" id="7483075">T</span><span class="op" id="7483076">)</span>&nbsp;<span class="op" id="7483078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483081">for</span>&nbsp;<span class="ident" id="7483085">i</span><span class="op" id="7483086">,</span>&nbsp;<span class="ident" id="7483088">s</span>&nbsp;<span class="op" id="7483090">:=</span>&nbsp;<span class="keyword" id="7483093">range</span>&nbsp;<span class="ident" id="7483099">data</span>&nbsp;<span class="op" id="7483104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483108">b</span>&nbsp;<span class="op" id="7483110">:=</span>&nbsp;<span class="op" id="7483113">[</span><span class="op" id="7483114">]</span><span class="builtintype" id="7483115">byte</span><span class="op" id="7483119">(</span><span class="ident" id="7483120">s</span><span class="op" id="7483121">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483125">tag</span>&nbsp;<span class="op" id="7483129">:=</span>&nbsp;<span class="ident" id="7483132">fmt</span><span class="op" id="7483135">.</span><span class="ident" id="7483136">Sprintf</span><span class="op" id="7483143">(</span><span class="string" id="7483144">&#34;#%d&#34;</span><span class="op" id="7483149">,</span>&nbsp;<span class="ident" id="7483151">i</span><span class="op" id="7483152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483156">testLevelDict</span><span class="op" id="7483169">(</span><span class="ident" id="7483170">t</span><span class="op" id="7483171">,</span>&nbsp;<span class="ident" id="7483173">tag</span><span class="op" id="7483176">,</span>&nbsp;<span class="ident" id="7483178">b</span><span class="op" id="7483179">,</span>&nbsp;<span class="ident" id="7483181">DefaultCompression</span><span class="op" id="7483199">,</span>&nbsp;<span class="string" id="7483201">&#34;&#34;</span><span class="op" id="7483203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483207">testLevelDict</span><span class="op" id="7483220">(</span><span class="ident" id="7483221">t</span><span class="op" id="7483222">,</span>&nbsp;<span class="ident" id="7483224">tag</span><span class="op" id="7483227">,</span>&nbsp;<span class="ident" id="7483229">b</span><span class="op" id="7483230">,</span>&nbsp;<span class="ident" id="7483232">NoCompression</span><span class="op" id="7483245">,</span>&nbsp;<span class="string" id="7483247">&#34;&#34;</span><span class="op" id="7483249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483253">for</span>&nbsp;<span class="ident" id="7483257">level</span>&nbsp;<span class="op" id="7483263">:=</span>&nbsp;<span class="ident" id="7483266">BestSpeed</span><span class="op" id="7483275">;</span>&nbsp;<span class="ident" id="7483277">level</span>&nbsp;<span class="op" id="7483283">&lt;=</span>&nbsp;<span class="ident" id="7483286">BestCompression</span><span class="op" id="7483301">;</span>&nbsp;<span class="ident" id="7483303">level</span><span class="op" id="7483308">++</span>&nbsp;<span class="op" id="7483311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483316">testLevelDict</span><span class="op" id="7483329">(</span><span class="ident" id="7483330">t</span><span class="op" id="7483331">,</span>&nbsp;<span class="ident" id="7483333">tag</span><span class="op" id="7483336">,</span>&nbsp;<span class="ident" id="7483338">b</span><span class="op" id="7483339">,</span>&nbsp;<span class="ident" id="7483341">level</span><span class="op" id="7483346">,</span>&nbsp;<span class="string" id="7483348">&#34;&#34;</span><span class="op" id="7483350">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483357">}</span><br>
<span class="lineno"></span><span class="op" id="7483359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7483362">func</span>&nbsp;<span class="ident" id="7483367">TestWriterBig</span><span class="op" id="7483380">(</span><span class="ident" id="7483381">t</span>&nbsp;<span class="op" id="7483383">*</span><span class="ident" id="7483384">testing</span><span class="op" id="7483391">.</span><span class="ident" id="7483392">T</span><span class="op" id="7483393">)</span>&nbsp;<span class="op" id="7483395">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483398">for</span>&nbsp;<span class="ident" id="7483402">_</span><span class="op" id="7483403">,</span>&nbsp;<span class="ident" id="7483405">fn</span>&nbsp;<span class="op" id="7483408">:=</span>&nbsp;<span class="keyword" id="7483411">range</span>&nbsp;<span class="ident" id="7483417">filenames</span>&nbsp;<span class="op" id="7483427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483431">testFileLevelDict</span><span class="op" id="7483448">(</span><span class="ident" id="7483449">t</span><span class="op" id="7483450">,</span>&nbsp;<span class="ident" id="7483452">fn</span><span class="op" id="7483454">,</span>&nbsp;<span class="ident" id="7483456">DefaultCompression</span><span class="op" id="7483474">,</span>&nbsp;<span class="string" id="7483476">&#34;&#34;</span><span class="op" id="7483478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483482">testFileLevelDict</span><span class="op" id="7483499">(</span><span class="ident" id="7483500">t</span><span class="op" id="7483501">,</span>&nbsp;<span class="ident" id="7483503">fn</span><span class="op" id="7483505">,</span>&nbsp;<span class="ident" id="7483507">NoCompression</span><span class="op" id="7483520">,</span>&nbsp;<span class="string" id="7483522">&#34;&#34;</span><span class="op" id="7483524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483528">for</span>&nbsp;<span class="ident" id="7483532">level</span>&nbsp;<span class="op" id="7483538">:=</span>&nbsp;<span class="ident" id="7483541">BestSpeed</span><span class="op" id="7483550">;</span>&nbsp;<span class="ident" id="7483552">level</span>&nbsp;<span class="op" id="7483558">&lt;=</span>&nbsp;<span class="ident" id="7483561">BestCompression</span><span class="op" id="7483576">;</span>&nbsp;<span class="ident" id="7483578">level</span><span class="op" id="7483583">++</span>&nbsp;<span class="op" id="7483586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483591">testFileLevelDict</span><span class="op" id="7483608">(</span><span class="ident" id="7483609">t</span><span class="op" id="7483610">,</span>&nbsp;<span class="ident" id="7483612">fn</span><span class="op" id="7483614">,</span>&nbsp;<span class="ident" id="7483616">level</span><span class="op" id="7483621">,</span>&nbsp;<span class="string" id="7483623">&#34;&#34;</span><span class="op" id="7483625">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483632">}</span><br>
<span class="lineno"></span><span class="op" id="7483634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7483637">func</span>&nbsp;<span class="ident" id="7483642">TestWriterDict</span><span class="op" id="7483656">(</span><span class="ident" id="7483657">t</span>&nbsp;<span class="op" id="7483659">*</span><span class="ident" id="7483660">testing</span><span class="op" id="7483667">.</span><span class="ident" id="7483668">T</span><span class="op" id="7483669">)</span>&nbsp;<span class="op" id="7483671">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483674">const</span>&nbsp;<span class="ident" id="7483680">dictionary</span>&nbsp;<span class="op" id="7483691">=</span>&nbsp;<span class="string" id="7483693">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483708">for</span>&nbsp;<span class="ident" id="7483712">_</span><span class="op" id="7483713">,</span>&nbsp;<span class="ident" id="7483715">fn</span>&nbsp;<span class="op" id="7483718">:=</span>&nbsp;<span class="keyword" id="7483721">range</span>&nbsp;<span class="ident" id="7483727">filenames</span>&nbsp;<span class="op" id="7483737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483741">testFileLevelDict</span><span class="op" id="7483758">(</span><span class="ident" id="7483759">t</span><span class="op" id="7483760">,</span>&nbsp;<span class="ident" id="7483762">fn</span><span class="op" id="7483764">,</span>&nbsp;<span class="ident" id="7483766">DefaultCompression</span><span class="op" id="7483784">,</span>&nbsp;<span class="ident" id="7483786">dictionary</span><span class="op" id="7483796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483800">testFileLevelDict</span><span class="op" id="7483817">(</span><span class="ident" id="7483818">t</span><span class="op" id="7483819">,</span>&nbsp;<span class="ident" id="7483821">fn</span><span class="op" id="7483823">,</span>&nbsp;<span class="ident" id="7483825">NoCompression</span><span class="op" id="7483838">,</span>&nbsp;<span class="ident" id="7483840">dictionary</span><span class="op" id="7483850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7483854">for</span>&nbsp;<span class="ident" id="7483858">level</span>&nbsp;<span class="op" id="7483864">:=</span>&nbsp;<span class="ident" id="7483867">BestSpeed</span><span class="op" id="7483876">;</span>&nbsp;<span class="ident" id="7483878">level</span>&nbsp;<span class="op" id="7483884">&lt;=</span>&nbsp;<span class="ident" id="7483887">BestCompression</span><span class="op" id="7483902">;</span>&nbsp;<span class="ident" id="7483904">level</span><span class="op" id="7483909">++</span>&nbsp;<span class="op" id="7483912">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7483917">testFileLevelDict</span><span class="op" id="7483934">(</span><span class="ident" id="7483935">t</span><span class="op" id="7483936">,</span>&nbsp;<span class="ident" id="7483938">fn</span><span class="op" id="7483940">,</span>&nbsp;<span class="ident" id="7483942">level</span><span class="op" id="7483947">,</span>&nbsp;<span class="ident" id="7483949">dictionary</span><span class="op" id="7483959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7483966">}</span><br>
<span class="lineno"></span><span class="op" id="7483968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7483971">func</span>&nbsp;<span class="ident" id="7483976">TestWriterReset</span><span class="op" id="7483991">(</span><span class="ident" id="7483992">t</span>&nbsp;<span class="op" id="7483994">*</span><span class="ident" id="7483995">testing</span><span class="op" id="7484002">.</span><span class="ident" id="7484003">T</span><span class="op" id="7484004">)</span>&nbsp;<span class="op" id="7484006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484009">const</span>&nbsp;<span class="ident" id="7484015">dictionary</span>&nbsp;<span class="op" id="7484026">=</span>&nbsp;<span class="string" id="7484028">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484043">for</span>&nbsp;<span class="ident" id="7484047">_</span><span class="op" id="7484048">,</span>&nbsp;<span class="ident" id="7484050">fn</span>&nbsp;<span class="op" id="7484053">:=</span>&nbsp;<span class="keyword" id="7484056">range</span>&nbsp;<span class="ident" id="7484062">filenames</span>&nbsp;<span class="op" id="7484072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484076">testFileLevelDictReset</span><span class="op" id="7484098">(</span><span class="ident" id="7484099">t</span><span class="op" id="7484100">,</span>&nbsp;<span class="ident" id="7484102">fn</span><span class="op" id="7484104">,</span>&nbsp;<span class="ident" id="7484106">NoCompression</span><span class="op" id="7484119">,</span>&nbsp;<span class="ident" id="7484121">nil</span><span class="op" id="7484124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484128">testFileLevelDictReset</span><span class="op" id="7484150">(</span><span class="ident" id="7484151">t</span><span class="op" id="7484152">,</span>&nbsp;<span class="ident" id="7484154">fn</span><span class="op" id="7484156">,</span>&nbsp;<span class="ident" id="7484158">DefaultCompression</span><span class="op" id="7484176">,</span>&nbsp;<span class="ident" id="7484178">nil</span><span class="op" id="7484181">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484185">testFileLevelDictReset</span><span class="op" id="7484207">(</span><span class="ident" id="7484208">t</span><span class="op" id="7484209">,</span>&nbsp;<span class="ident" id="7484211">fn</span><span class="op" id="7484213">,</span>&nbsp;<span class="ident" id="7484215">NoCompression</span><span class="op" id="7484228">,</span>&nbsp;<span class="op" id="7484230">[</span><span class="op" id="7484231">]</span><span class="builtintype" id="7484232">byte</span><span class="op" id="7484236">(</span><span class="ident" id="7484237">dictionary</span><span class="op" id="7484247">)</span><span class="op" id="7484248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484252">testFileLevelDictReset</span><span class="op" id="7484274">(</span><span class="ident" id="7484275">t</span><span class="op" id="7484276">,</span>&nbsp;<span class="ident" id="7484278">fn</span><span class="op" id="7484280">,</span>&nbsp;<span class="ident" id="7484282">DefaultCompression</span><span class="op" id="7484300">,</span>&nbsp;<span class="op" id="7484302">[</span><span class="op" id="7484303">]</span><span class="builtintype" id="7484304">byte</span><span class="op" id="7484308">(</span><span class="ident" id="7484309">dictionary</span><span class="op" id="7484319">)</span><span class="op" id="7484320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484324">if</span>&nbsp;<span class="op" id="7484327">!</span><span class="ident" id="7484328">testing</span><span class="op" id="7484335">.</span><span class="ident" id="7484336">Short</span><span class="op" id="7484341">(</span><span class="op" id="7484342">)</span>&nbsp;<span class="op" id="7484344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484349">for</span>&nbsp;<span class="ident" id="7484353">level</span>&nbsp;<span class="op" id="7484359">:=</span>&nbsp;<span class="ident" id="7484362">BestSpeed</span><span class="op" id="7484371">;</span>&nbsp;<span class="ident" id="7484373">level</span>&nbsp;<span class="op" id="7484379">&lt;=</span>&nbsp;<span class="ident" id="7484382">BestCompression</span><span class="op" id="7484397">;</span>&nbsp;<span class="ident" id="7484399">level</span><span class="op" id="7484404">++</span>&nbsp;<span class="op" id="7484407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484413">testFileLevelDictReset</span><span class="op" id="7484435">(</span><span class="ident" id="7484436">t</span><span class="op" id="7484437">,</span>&nbsp;<span class="ident" id="7484439">fn</span><span class="op" id="7484441">,</span>&nbsp;<span class="ident" id="7484443">level</span><span class="op" id="7484448">,</span>&nbsp;<span class="ident" id="7484450">nil</span><span class="op" id="7484453">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484465">}</span><br>
<span class="lineno"></span><span class="op" id="7484467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7484470">func</span>&nbsp;<span class="ident" id="7484475">TestWriterDictIsUsed</span><span class="op" id="7484495">(</span><span class="ident" id="7484496">t</span>&nbsp;<span class="op" id="7484498">*</span><span class="ident" id="7484499">testing</span><span class="op" id="7484506">.</span><span class="ident" id="7484507">T</span><span class="op" id="7484508">)</span>&nbsp;<span class="op" id="7484510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484513">var</span>&nbsp;<span class="ident" id="7484517">input</span>&nbsp;<span class="op" id="7484523">=</span>&nbsp;<span class="op" id="7484525">[</span><span class="op" id="7484526">]</span><span class="builtintype" id="7484527">byte</span><span class="op" id="7484531">(</span><span class="string" id="7484532">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="7484658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484661">var</span>&nbsp;<span class="ident" id="7484665">buf</span>&nbsp;<span class="ident" id="7484669">bytes</span><span class="op" id="7484674">.</span><span class="ident" id="7484675">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484683">compressor</span><span class="op" id="7484693">,</span>&nbsp;<span class="ident" id="7484695">err</span>&nbsp;<span class="op" id="7484699">:=</span>&nbsp;<span class="ident" id="7484702">NewWriterLevelDict</span><span class="op" id="7484720">(</span><span class="op" id="7484721">&amp;</span><span class="ident" id="7484722">buf</span><span class="op" id="7484725">,</span>&nbsp;<span class="ident" id="7484727">BestCompression</span><span class="op" id="7484742">,</span>&nbsp;<span class="ident" id="7484744">input</span><span class="op" id="7484749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484752">if</span>&nbsp;<span class="ident" id="7484755">err</span>&nbsp;<span class="op" id="7484759">!=</span>&nbsp;<span class="ident" id="7484762">nil</span>&nbsp;<span class="op" id="7484766">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484770">t</span><span class="op" id="7484771">.</span><span class="ident" id="7484772">Errorf</span><span class="op" id="7484778">(</span><span class="string" id="7484779">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="7484812">,</span>&nbsp;<span class="ident" id="7484814">err</span><span class="op" id="7484817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484821">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7484829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484832">compressor</span><span class="op" id="7484842">.</span><span class="ident" id="7484843">Write</span><span class="op" id="7484848">(</span><span class="ident" id="7484849">input</span><span class="op" id="7484854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484857">compressor</span><span class="op" id="7484867">.</span><span class="ident" id="7484868">Close</span><span class="op" id="7484873">(</span><span class="op" id="7484874">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484877">const</span>&nbsp;<span class="ident" id="7484883">expectedMaxSize</span>&nbsp;<span class="op" id="7484899">=</span>&nbsp;<span class="num" id="7484901">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484905">output</span>&nbsp;<span class="op" id="7484912">:=</span>&nbsp;<span class="ident" id="7484915">buf</span><span class="op" id="7484918">.</span><span class="ident" id="7484919">Bytes</span><span class="op" id="7484924">(</span><span class="op" id="7484925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7484928">if</span>&nbsp;<span class="builtinfunc" id="7484931">len</span><span class="op" id="7484934">(</span><span class="ident" id="7484935">output</span><span class="op" id="7484941">)</span>&nbsp;<span class="op" id="7484943">&gt;</span>&nbsp;<span class="ident" id="7484945">expectedMaxSize</span>&nbsp;<span class="op" id="7484961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7484965">t</span><span class="op" id="7484966">.</span><span class="ident" id="7484967">Errorf</span><span class="op" id="7484973">(</span><span class="string" id="7484974">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="7485050">,</span>&nbsp;<span class="builtinfunc" id="7485052">len</span><span class="op" id="7485055">(</span><span class="ident" id="7485056">output</span><span class="op" id="7485062">)</span><span class="op" id="7485063">,</span>&nbsp;<span class="ident" id="7485065">expectedMaxSize</span><span class="op" id="7485080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485083">}</span><br>
<span class="lineno">205</span><span class="op" id="7485085">}</span>
</div>
</body>
</html>
