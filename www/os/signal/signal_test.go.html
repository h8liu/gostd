<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8206935">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8206990">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8207044">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8207095">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8207160">package</span>&nbsp;<span class="ident" id="8207168">signal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8207176">import</span>&nbsp;<span class="op" id="8207183">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207186">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207194">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207207">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207213">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207224">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207235">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207246">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207257">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8207268">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8207275">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8207278">func</span>&nbsp;<span class="ident" id="8207283">waitSig</span><span class="op" id="8207290">(</span><span class="ident" id="8207291">t</span>&nbsp;<span class="op" id="8207293">*</span><span class="ident" id="8207294"><a href="/os/signal/signal_test.go.html#8207257">testing</a></span><span class="op" id="8207301">.</span><span class="ident" id="8207302">T</span><span class="op" id="8207303">,</span>&nbsp;<span class="ident" id="8207305">c</span>&nbsp;<span class="op" id="8207307">&lt;-</span><span class="keyword" id="8207309">chan</span>&nbsp;<span class="ident" id="8207314"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8207316">.</span><span class="ident" id="8207317">Signal</span><span class="op" id="8207323">,</span>&nbsp;<span class="ident" id="8207325">sig</span>&nbsp;<span class="ident" id="8207329"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8207331">.</span><span class="ident" id="8207332">Signal</span><span class="op" id="8207338">)</span>&nbsp;<span class="op" id="8207340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207343">select</span>&nbsp;<span class="op" id="8207350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207353">case</span>&nbsp;<span class="ident" id="8207358">s</span>&nbsp;<span class="op" id="8207360">:=</span>&nbsp;<span class="op" id="8207363">&lt;-</span><span class="ident" id="8207365"><a href="/os/signal/signal_test.go.html#8207305">c</a></span><span class="op" id="8207366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207370">if</span>&nbsp;<span class="ident" id="8207373"><a href="/os/signal/signal_test.go.html#8207358">s</a></span>&nbsp;<span class="op" id="8207375">!=</span>&nbsp;<span class="ident" id="8207378"><a href="/os/signal/signal_test.go.html#8207325">sig</a></span>&nbsp;<span class="op" id="8207382">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207387"><a href="/os/signal/signal_test.go.html#8207291">t</a></span><span class="op" id="8207388">.</span><span class="ident" id="8207389">Fatalf</span><span class="op" id="8207395">(</span><span class="string" id="8207396">&#34;signal&nbsp;was&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8207420">,</span>&nbsp;<span class="ident" id="8207422"><a href="/os/signal/signal_test.go.html#8207358">s</a></span><span class="op" id="8207423">,</span>&nbsp;<span class="ident" id="8207425"><a href="/os/signal/signal_test.go.html#8207325">sig</a></span><span class="op" id="8207428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207435">case</span>&nbsp;<span class="op" id="8207440">&lt;-</span><span class="ident" id="8207442"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8207446">.</span><span class="ident" id="8207447">After</span><span class="op" id="8207452">(</span><span class="num" id="8207453">1</span>&nbsp;<span class="op" id="8207455">*</span>&nbsp;<span class="ident" id="8207457"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8207461">.</span><span class="ident" id="8207462">Second</span><span class="op" id="8207468">)</span><span class="op" id="8207469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207473"><a href="/os/signal/signal_test.go.html#8207291">t</a></span><span class="op" id="8207474">.</span><span class="ident" id="8207475">Fatalf</span><span class="op" id="8207481">(</span><span class="string" id="8207482">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;%v&#34;</span><span class="op" id="8207506">,</span>&nbsp;<span class="ident" id="8207508"><a href="/os/signal/signal_test.go.html#8207325">sig</a></span><span class="op" id="8207511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207514">}</span><br>
<span class="lineno">30</span><span class="op" id="8207516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8207519">//&nbsp;Test&nbsp;that&nbsp;basic&nbsp;signal&nbsp;handling&nbsp;works.</span><br>
<span class="lineno"></span><span class="keyword" id="8207561">func</span>&nbsp;<span class="ident" id="8207566">TestSignal</span><span class="op" id="8207576">(</span><span class="ident" id="8207577">t</span>&nbsp;<span class="op" id="8207579">*</span><span class="ident" id="8207580"><a href="/os/signal/signal_test.go.html#8207257">testing</a></span><span class="op" id="8207587">.</span><span class="ident" id="8207588">T</span><span class="op" id="8207589">)</span>&nbsp;<span class="op" id="8207591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8207594">//&nbsp;Ask&nbsp;for&nbsp;SIGHUP</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207613">c</span>&nbsp;<span class="op" id="8207615">:=</span>&nbsp;<span class="builtinfunc" id="8207618">make</span><span class="op" id="8207622">(</span><span class="keyword" id="8207623">chan</span>&nbsp;<span class="ident" id="8207628"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8207630">.</span><span class="ident" id="8207631">Signal</span><span class="op" id="8207637">,</span>&nbsp;<span class="num" id="8207639">1</span><span class="op" id="8207640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207643"><a href="/os/signal/signal.go.html#4909129">Notify</a></span><span class="op" id="8207649">(</span><span class="ident" id="8207650"><a href="/os/signal/signal_test.go.html#8207613">c</a></span><span class="op" id="8207651">,</span>&nbsp;<span class="ident" id="8207653"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207660">.</span><span class="ident" id="8207661">SIGHUP</span><span class="op" id="8207667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207670">defer</span>&nbsp;<span class="ident" id="8207676"><a href="/os/signal/signal.go.html#4909949">Stop</a></span><span class="op" id="8207680">(</span><span class="ident" id="8207681"><a href="/os/signal/signal_test.go.html#8207613">c</a></span><span class="op" id="8207682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8207686">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;a&nbsp;SIGHUP</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207717"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8207718">.</span><span class="ident" id="8207719">Logf</span><span class="op" id="8207723">(</span><span class="string" id="8207724">&#34;sighup...&#34;</span><span class="op" id="8207735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207738"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207745">.</span><span class="ident" id="8207746">Kill</span><span class="op" id="8207750">(</span><span class="ident" id="8207751"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207758">.</span><span class="ident" id="8207759">Getpid</span><span class="op" id="8207765">(</span><span class="op" id="8207766">)</span><span class="op" id="8207767">,</span>&nbsp;<span class="ident" id="8207769"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207776">.</span><span class="ident" id="8207777">SIGHUP</span><span class="op" id="8207783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207786"><a href="/os/signal/signal_test.go.html#8207283">waitSig</a></span><span class="op" id="8207793">(</span><span class="ident" id="8207794"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8207795">,</span>&nbsp;<span class="ident" id="8207797"><a href="/os/signal/signal_test.go.html#8207613">c</a></span><span class="op" id="8207798">,</span>&nbsp;<span class="ident" id="8207800"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207807">.</span><span class="ident" id="8207808">SIGHUP</span><span class="op" id="8207814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8207818">//&nbsp;Ask&nbsp;for&nbsp;everything&nbsp;we&nbsp;can&nbsp;get.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207853">c1</span>&nbsp;<span class="op" id="8207856">:=</span>&nbsp;<span class="builtinfunc" id="8207859">make</span><span class="op" id="8207863">(</span><span class="keyword" id="8207864">chan</span>&nbsp;<span class="ident" id="8207869"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8207871">.</span><span class="ident" id="8207872">Signal</span><span class="op" id="8207878">,</span>&nbsp;<span class="num" id="8207880">1</span><span class="op" id="8207881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207884"><a href="/os/signal/signal.go.html#4909129">Notify</a></span><span class="op" id="8207890">(</span><span class="ident" id="8207891"><a href="/os/signal/signal_test.go.html#8207853">c1</a></span><span class="op" id="8207893">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8207897">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;a&nbsp;SIGWINCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207930"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8207931">.</span><span class="ident" id="8207932">Logf</span><span class="op" id="8207936">(</span><span class="string" id="8207937">&#34;sigwinch...&#34;</span><span class="op" id="8207950">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207953"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207960">.</span><span class="ident" id="8207961">Kill</span><span class="op" id="8207965">(</span><span class="ident" id="8207966"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207973">.</span><span class="ident" id="8207974">Getpid</span><span class="op" id="8207980">(</span><span class="op" id="8207981">)</span><span class="op" id="8207982">,</span>&nbsp;<span class="ident" id="8207984"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8207991">.</span><span class="ident" id="8207992">SIGWINCH</span><span class="op" id="8208000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208003"><a href="/os/signal/signal_test.go.html#8207283">waitSig</a></span><span class="op" id="8208010">(</span><span class="ident" id="8208011"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8208012">,</span>&nbsp;<span class="ident" id="8208014"><a href="/os/signal/signal_test.go.html#8207853">c1</a></span><span class="op" id="8208016">,</span>&nbsp;<span class="ident" id="8208018"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208025">.</span><span class="ident" id="8208026">SIGWINCH</span><span class="op" id="8208034">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8208038">//&nbsp;Send&nbsp;two&nbsp;more&nbsp;SIGHUPs,&nbsp;to&nbsp;make&nbsp;sure&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8208083">//&nbsp;they&nbsp;get&nbsp;delivered&nbsp;on&nbsp;c1&nbsp;and&nbsp;that&nbsp;not&nbsp;reading</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8208133">//&nbsp;from&nbsp;c&nbsp;does&nbsp;not&nbsp;block&nbsp;everything.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208171"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8208172">.</span><span class="ident" id="8208173">Logf</span><span class="op" id="8208177">(</span><span class="string" id="8208178">&#34;sighup...&#34;</span><span class="op" id="8208189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208192"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208199">.</span><span class="ident" id="8208200">Kill</span><span class="op" id="8208204">(</span><span class="ident" id="8208205"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208212">.</span><span class="ident" id="8208213">Getpid</span><span class="op" id="8208219">(</span><span class="op" id="8208220">)</span><span class="op" id="8208221">,</span>&nbsp;<span class="ident" id="8208223"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208230">.</span><span class="ident" id="8208231">SIGHUP</span><span class="op" id="8208237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208240"><a href="/os/signal/signal_test.go.html#8207283">waitSig</a></span><span class="op" id="8208247">(</span><span class="ident" id="8208248"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8208249">,</span>&nbsp;<span class="ident" id="8208251"><a href="/os/signal/signal_test.go.html#8207853">c1</a></span><span class="op" id="8208253">,</span>&nbsp;<span class="ident" id="8208255"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208262">.</span><span class="ident" id="8208263">SIGHUP</span><span class="op" id="8208269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208272"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8208273">.</span><span class="ident" id="8208274">Logf</span><span class="op" id="8208278">(</span><span class="string" id="8208279">&#34;sighup...&#34;</span><span class="op" id="8208290">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208293"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208300">.</span><span class="ident" id="8208301">Kill</span><span class="op" id="8208305">(</span><span class="ident" id="8208306"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208313">.</span><span class="ident" id="8208314">Getpid</span><span class="op" id="8208320">(</span><span class="op" id="8208321">)</span><span class="op" id="8208322">,</span>&nbsp;<span class="ident" id="8208324"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208331">.</span><span class="ident" id="8208332">SIGHUP</span><span class="op" id="8208338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208341"><a href="/os/signal/signal_test.go.html#8207283">waitSig</a></span><span class="op" id="8208348">(</span><span class="ident" id="8208349"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8208350">,</span>&nbsp;<span class="ident" id="8208352"><a href="/os/signal/signal_test.go.html#8207853">c1</a></span><span class="op" id="8208354">,</span>&nbsp;<span class="ident" id="8208356"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208363">.</span><span class="ident" id="8208364">SIGHUP</span><span class="op" id="8208370">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8208374">//&nbsp;The&nbsp;first&nbsp;SIGHUP&nbsp;should&nbsp;be&nbsp;waiting&nbsp;for&nbsp;us&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208426"><a href="/os/signal/signal_test.go.html#8207283">waitSig</a></span><span class="op" id="8208433">(</span><span class="ident" id="8208434"><a href="/os/signal/signal_test.go.html#8207577">t</a></span><span class="op" id="8208435">,</span>&nbsp;<span class="ident" id="8208437"><a href="/os/signal/signal_test.go.html#8207613">c</a></span><span class="op" id="8208438">,</span>&nbsp;<span class="ident" id="8208440"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208447">.</span><span class="ident" id="8208448">SIGHUP</span><span class="op" id="8208454">)</span><br>
<span class="lineno">65</span><span class="op" id="8208456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8208459">func</span>&nbsp;<span class="ident" id="8208464">TestStress</span><span class="op" id="8208474">(</span><span class="ident" id="8208475">t</span>&nbsp;<span class="op" id="8208477">*</span><span class="ident" id="8208478"><a href="/os/signal/signal_test.go.html#8207257">testing</a></span><span class="op" id="8208485">.</span><span class="ident" id="8208486">T</span><span class="op" id="8208487">)</span>&nbsp;<span class="op" id="8208489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208492">dur</span>&nbsp;<span class="op" id="8208496">:=</span>&nbsp;<span class="num" id="8208499">3</span>&nbsp;<span class="op" id="8208501">*</span>&nbsp;<span class="ident" id="8208503"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8208507">.</span><span class="ident" id="8208508">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208516">if</span>&nbsp;<span class="ident" id="8208519"><a href="/os/signal/signal_test.go.html#8207257">testing</a></span><span class="op" id="8208526">.</span><span class="ident" id="8208527">Short</span><span class="op" id="8208532">(</span><span class="op" id="8208533">)</span>&nbsp;<span class="op" id="8208535">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208539"><a href="/os/signal/signal_test.go.html#8208492">dur</a></span>&nbsp;<span class="op" id="8208543">=</span>&nbsp;<span class="num" id="8208545">100</span>&nbsp;<span class="op" id="8208549">*</span>&nbsp;<span class="ident" id="8208551"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8208555">.</span><span class="ident" id="8208556">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208572">defer</span>&nbsp;<span class="ident" id="8208578"><a href="/os/signal/signal_test.go.html#8207224">runtime</a></span><span class="op" id="8208585">.</span><span class="ident" id="8208586">GOMAXPROCS</span><span class="op" id="8208596">(</span><span class="ident" id="8208597"><a href="/os/signal/signal_test.go.html#8207224">runtime</a></span><span class="op" id="8208604">.</span><span class="ident" id="8208605">GOMAXPROCS</span><span class="op" id="8208615">(</span><span class="num" id="8208616">4</span><span class="op" id="8208617">)</span><span class="op" id="8208618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208621">done</span>&nbsp;<span class="op" id="8208626">:=</span>&nbsp;<span class="builtinfunc" id="8208629">make</span><span class="op" id="8208633">(</span><span class="keyword" id="8208634">chan</span>&nbsp;<span class="builtintype" id="8208639">bool</span><span class="op" id="8208643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208646">finished</span>&nbsp;<span class="op" id="8208655">:=</span>&nbsp;<span class="builtinfunc" id="8208658">make</span><span class="op" id="8208662">(</span><span class="keyword" id="8208663">chan</span>&nbsp;<span class="builtintype" id="8208668">bool</span><span class="op" id="8208672">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208675">go</span>&nbsp;<span class="keyword" id="8208678">func</span><span class="op" id="8208682">(</span><span class="op" id="8208683">)</span>&nbsp;<span class="op" id="8208685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208689">sig</span>&nbsp;<span class="op" id="8208693">:=</span>&nbsp;<span class="builtinfunc" id="8208696">make</span><span class="op" id="8208700">(</span><span class="keyword" id="8208701">chan</span>&nbsp;<span class="ident" id="8208706"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8208708">.</span><span class="ident" id="8208709">Signal</span><span class="op" id="8208715">,</span>&nbsp;<span class="num" id="8208717">1</span><span class="op" id="8208718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208722"><a href="/os/signal/signal.go.html#4909129">Notify</a></span><span class="op" id="8208728">(</span><span class="ident" id="8208729"><a href="/os/signal/signal_test.go.html#8208689">sig</a></span><span class="op" id="8208732">,</span>&nbsp;<span class="ident" id="8208734"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208741">.</span><span class="ident" id="8208742">SIGUSR1</span><span class="op" id="8208749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208753">defer</span>&nbsp;<span class="ident" id="8208759"><a href="/os/signal/signal.go.html#4909949">Stop</a></span><span class="op" id="8208763">(</span><span class="ident" id="8208764"><a href="/os/signal/signal_test.go.html#8208689">sig</a></span><span class="op" id="8208767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208770">Loop</span><span class="op" id="8208774">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208778">for</span>&nbsp;<span class="op" id="8208782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208787">select</span>&nbsp;<span class="op" id="8208794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208799">case</span>&nbsp;<span class="op" id="8208804">&lt;-</span><span class="ident" id="8208806"><a href="/os/signal/signal_test.go.html#8208689">sig</a></span><span class="op" id="8208809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208814">case</span>&nbsp;<span class="op" id="8208819">&lt;-</span><span class="ident" id="8208821"><a href="/os/signal/signal_test.go.html#8208621">done</a></span><span class="op" id="8208825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208831">break</span>&nbsp;<span class="ident" id="8208837">Loop</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208853"><a href="/os/signal/signal_test.go.html#8208646">finished</a></span>&nbsp;<span class="op" id="8208862">&lt;-</span>&nbsp;<span class="builtintype" id="8208865">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208871">}</span><span class="op" id="8208872">(</span><span class="op" id="8208873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208876">go</span>&nbsp;<span class="keyword" id="8208879">func</span><span class="op" id="8208883">(</span><span class="op" id="8208884">)</span>&nbsp;<span class="op" id="8208886">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208889">Loop</span><span class="op" id="8208893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208897">for</span>&nbsp;<span class="op" id="8208901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208906">select</span>&nbsp;<span class="op" id="8208913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208918">case</span>&nbsp;<span class="op" id="8208923">&lt;-</span><span class="ident" id="8208925"><a href="/os/signal/signal_test.go.html#8208621">done</a></span><span class="op" id="8208929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208935">break</span>&nbsp;<span class="ident" id="8208941">Loop</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208949">default</span><span class="op" id="8208956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208962"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208969">.</span><span class="ident" id="8208970">Kill</span><span class="op" id="8208974">(</span><span class="ident" id="8208975"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8208982">.</span><span class="ident" id="8208983">Getpid</span><span class="op" id="8208989">(</span><span class="op" id="8208990">)</span><span class="op" id="8208991">,</span>&nbsp;<span class="ident" id="8208993"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8209000">.</span><span class="ident" id="8209001">SIGUSR1</span><span class="op" id="8209008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209014"><a href="/os/signal/signal_test.go.html#8207224">runtime</a></span><span class="op" id="8209021">.</span><span class="ident" id="8209022">Gosched</span><span class="op" id="8209029">(</span><span class="op" id="8209030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209039">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209043"><a href="/os/signal/signal_test.go.html#8208646">finished</a></span>&nbsp;<span class="op" id="8209052">&lt;-</span>&nbsp;<span class="builtintype" id="8209055">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209061">}</span><span class="op" id="8209062">(</span><span class="op" id="8209063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209066"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8209070">.</span><span class="ident" id="8209071">Sleep</span><span class="op" id="8209076">(</span><span class="ident" id="8209077"><a href="/os/signal/signal_test.go.html#8208492">dur</a></span><span class="op" id="8209080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8209083">close</span><span class="op" id="8209088">(</span><span class="ident" id="8209089"><a href="/os/signal/signal_test.go.html#8208621">done</a></span><span class="op" id="8209093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209096">&lt;-</span><span class="ident" id="8209098"><a href="/os/signal/signal_test.go.html#8208646">finished</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209108">&lt;-</span><span class="ident" id="8209110"><a href="/os/signal/signal_test.go.html#8208646">finished</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209120">//&nbsp;When&nbsp;run&nbsp;with&nbsp;&#39;go&nbsp;test&nbsp;-cpu=1,2,4&#39;&nbsp;SIGUSR1&nbsp;from&nbsp;this&nbsp;test&nbsp;can&nbsp;slip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209191">//&nbsp;into&nbsp;subsequent&nbsp;TestSignal()&nbsp;causing&nbsp;failure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209241">//&nbsp;Sleep&nbsp;for&nbsp;a&nbsp;while&nbsp;to&nbsp;reduce&nbsp;the&nbsp;possibility&nbsp;of&nbsp;the&nbsp;failure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209305"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8209309">.</span><span class="ident" id="8209310">Sleep</span><span class="op" id="8209315">(</span><span class="num" id="8209316">10</span>&nbsp;<span class="op" id="8209319">*</span>&nbsp;<span class="ident" id="8209321"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8209325">.</span><span class="ident" id="8209326">Millisecond</span><span class="op" id="8209337">)</span><br>
<span class="lineno">110</span><span class="op" id="8209339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8209342">var</span>&nbsp;<span class="ident" id="8209346">sendUncaughtSighup</span>&nbsp;<span class="op" id="8209365">=</span>&nbsp;<span class="ident" id="8209367"><a href="/os/signal/signal_test.go.html#8207186">flag</a></span><span class="op" id="8209371">.</span><span class="ident" id="8209372">Int</span><span class="op" id="8209375">(</span><span class="string" id="8209376">&#34;send_uncaught_sighup&#34;</span><span class="op" id="8209398">,</span>&nbsp;<span class="num" id="8209400">0</span><span class="op" id="8209401">,</span>&nbsp;<span class="string" id="8209403">&#34;send&nbsp;uncaught&nbsp;SIGHUP&nbsp;during&nbsp;TestStop&#34;</span><span class="op" id="8209441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8209444">//&nbsp;Test&nbsp;that&nbsp;Stop&nbsp;cancels&nbsp;the&nbsp;channel&#39;s&nbsp;registrations.</span><br>
<span class="lineno">115</span><span class="keyword" id="8209499">func</span>&nbsp;<span class="ident" id="8209504">TestStop</span><span class="op" id="8209512">(</span><span class="ident" id="8209513">t</span>&nbsp;<span class="op" id="8209515">*</span><span class="ident" id="8209516"><a href="/os/signal/signal_test.go.html#8207257">testing</a></span><span class="op" id="8209523">.</span><span class="ident" id="8209524">T</span><span class="op" id="8209525">)</span>&nbsp;<span class="op" id="8209527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209530">sigs</span>&nbsp;<span class="op" id="8209535">:=</span>&nbsp;<span class="op" id="8209538">[</span><span class="op" id="8209539">]</span><span class="ident" id="8209540"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8209547">.</span><span class="ident" id="8209548">Signal</span><span class="op" id="8209554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209558"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8209565">.</span><span class="ident" id="8209566">SIGWINCH</span><span class="op" id="8209574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209578"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8209585">.</span><span class="ident" id="8209586">SIGHUP</span><span class="op" id="8209592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209595">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209599">for</span>&nbsp;<span class="ident" id="8209603">_</span><span class="op" id="8209604">,</span>&nbsp;<span class="ident" id="8209606">sig</span>&nbsp;<span class="op" id="8209610">:=</span>&nbsp;<span class="keyword" id="8209613">range</span>&nbsp;<span class="ident" id="8209619"><a href="/os/signal/signal_test.go.html#8209530">sigs</a></span>&nbsp;<span class="op" id="8209624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209628">//&nbsp;Send&nbsp;the&nbsp;signal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209650">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGWINCH,&nbsp;we&nbsp;should&nbsp;not&nbsp;see&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209695">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGHUP,&nbsp;maybe&nbsp;we&#39;ll&nbsp;die.&nbsp;Let&nbsp;the&nbsp;flag&nbsp;tell&nbsp;us&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209766">if</span>&nbsp;<span class="ident" id="8209769"><a href="/os/signal/signal_test.go.html#8209606">sig</a></span>&nbsp;<span class="op" id="8209773">!=</span>&nbsp;<span class="ident" id="8209776"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8209783">.</span><span class="ident" id="8209784">SIGHUP</span>&nbsp;<span class="op" id="8209791">||</span>&nbsp;<span class="op" id="8209794">*</span><span class="ident" id="8209795"><a href="/os/signal/signal_test.go.html#8209346">sendUncaughtSighup</a></span>&nbsp;<span class="op" id="8209814">==</span>&nbsp;<span class="num" id="8209817">1</span>&nbsp;<span class="op" id="8209819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209824"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8209831">.</span><span class="ident" id="8209832">Kill</span><span class="op" id="8209836">(</span><span class="ident" id="8209837"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8209844">.</span><span class="ident" id="8209845">Getpid</span><span class="op" id="8209851">(</span><span class="op" id="8209852">)</span><span class="op" id="8209853">,</span>&nbsp;<span class="ident" id="8209855"><a href="/os/signal/signal_test.go.html#8209606">sig</a></span><span class="op" id="8209858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209866"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8209870">.</span><span class="ident" id="8209871">Sleep</span><span class="op" id="8209876">(</span><span class="num" id="8209877">100</span>&nbsp;<span class="op" id="8209881">*</span>&nbsp;<span class="ident" id="8209883"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8209887">.</span><span class="ident" id="8209888">Millisecond</span><span class="op" id="8209899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209904">//&nbsp;Ask&nbsp;for&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209924">c</span>&nbsp;<span class="op" id="8209926">:=</span>&nbsp;<span class="builtinfunc" id="8209929">make</span><span class="op" id="8209933">(</span><span class="keyword" id="8209934">chan</span>&nbsp;<span class="ident" id="8209939"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8209941">.</span><span class="ident" id="8209942">Signal</span><span class="op" id="8209948">,</span>&nbsp;<span class="num" id="8209950">1</span><span class="op" id="8209951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209955"><a href="/os/signal/signal.go.html#4909129">Notify</a></span><span class="op" id="8209961">(</span><span class="ident" id="8209962"><a href="/os/signal/signal_test.go.html#8209924">c</a></span><span class="op" id="8209963">,</span>&nbsp;<span class="ident" id="8209965"><a href="/os/signal/signal_test.go.html#8209606">sig</a></span><span class="op" id="8209968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209972">defer</span>&nbsp;<span class="ident" id="8209978"><a href="/os/signal/signal.go.html#4909949">Stop</a></span><span class="op" id="8209982">(</span><span class="ident" id="8209983"><a href="/os/signal/signal_test.go.html#8209924">c</a></span><span class="op" id="8209984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209989">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;that&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210024"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8210031">.</span><span class="ident" id="8210032">Kill</span><span class="op" id="8210036">(</span><span class="ident" id="8210037"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8210044">.</span><span class="ident" id="8210045">Getpid</span><span class="op" id="8210051">(</span><span class="op" id="8210052">)</span><span class="op" id="8210053">,</span>&nbsp;<span class="ident" id="8210055"><a href="/os/signal/signal_test.go.html#8209606">sig</a></span><span class="op" id="8210058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210062"><a href="/os/signal/signal_test.go.html#8207283">waitSig</a></span><span class="op" id="8210069">(</span><span class="ident" id="8210070"><a href="/os/signal/signal_test.go.html#8209513">t</a></span><span class="op" id="8210071">,</span>&nbsp;<span class="ident" id="8210073"><a href="/os/signal/signal_test.go.html#8209924">c</a></span><span class="op" id="8210074">,</span>&nbsp;<span class="ident" id="8210076"><a href="/os/signal/signal_test.go.html#8209606">sig</a></span><span class="op" id="8210079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210084"><a href="/os/signal/signal.go.html#4909949">Stop</a></span><span class="op" id="8210088">(</span><span class="ident" id="8210089"><a href="/os/signal/signal_test.go.html#8209924">c</a></span><span class="op" id="8210090">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210094">select</span>&nbsp;<span class="op" id="8210101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210105">case</span>&nbsp;<span class="ident" id="8210110">s</span>&nbsp;<span class="op" id="8210112">:=</span>&nbsp;<span class="op" id="8210115">&lt;-</span><span class="ident" id="8210117"><a href="/os/signal/signal_test.go.html#8209924">c</a></span><span class="op" id="8210118">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210123"><a href="/os/signal/signal_test.go.html#8209513">t</a></span><span class="op" id="8210124">.</span><span class="ident" id="8210125">Fatalf</span><span class="op" id="8210131">(</span><span class="string" id="8210132">&#34;unexpected&nbsp;signal&nbsp;%v&#34;</span><span class="op" id="8210154">,</span>&nbsp;<span class="ident" id="8210156"><a href="/os/signal/signal_test.go.html#8210110">s</a></span><span class="op" id="8210157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210161">case</span>&nbsp;<span class="op" id="8210166">&lt;-</span><span class="ident" id="8210168"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8210172">.</span><span class="ident" id="8210173">After</span><span class="op" id="8210178">(</span><span class="num" id="8210179">100</span>&nbsp;<span class="op" id="8210183">*</span>&nbsp;<span class="ident" id="8210185"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8210189">.</span><span class="ident" id="8210190">Millisecond</span><span class="op" id="8210201">)</span><span class="op" id="8210202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210207">//&nbsp;nothing&nbsp;to&nbsp;read&nbsp;-&nbsp;good</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210240">//&nbsp;Send&nbsp;the&nbsp;signal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210262">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGWINCH,&nbsp;we&nbsp;should&nbsp;not&nbsp;see&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210307">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGHUP,&nbsp;maybe&nbsp;we&#39;ll&nbsp;die.&nbsp;Let&nbsp;the&nbsp;flag&nbsp;tell&nbsp;us&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210378">if</span>&nbsp;<span class="ident" id="8210381"><a href="/os/signal/signal_test.go.html#8209606">sig</a></span>&nbsp;<span class="op" id="8210385">!=</span>&nbsp;<span class="ident" id="8210388"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8210395">.</span><span class="ident" id="8210396">SIGHUP</span>&nbsp;<span class="op" id="8210403">||</span>&nbsp;<span class="op" id="8210406">*</span><span class="ident" id="8210407"><a href="/os/signal/signal_test.go.html#8209346">sendUncaughtSighup</a></span>&nbsp;<span class="op" id="8210426">==</span>&nbsp;<span class="num" id="8210429">2</span>&nbsp;<span class="op" id="8210431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210436"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8210443">.</span><span class="ident" id="8210444">Kill</span><span class="op" id="8210448">(</span><span class="ident" id="8210449"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8210456">.</span><span class="ident" id="8210457">Getpid</span><span class="op" id="8210463">(</span><span class="op" id="8210464">)</span><span class="op" id="8210465">,</span>&nbsp;<span class="ident" id="8210467"><a href="/os/signal/signal_test.go.html#8209606">sig</a></span><span class="op" id="8210470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210479">select</span>&nbsp;<span class="op" id="8210486">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210490">case</span>&nbsp;<span class="ident" id="8210495">s</span>&nbsp;<span class="op" id="8210497">:=</span>&nbsp;<span class="op" id="8210500">&lt;-</span><span class="ident" id="8210502"><a href="/os/signal/signal_test.go.html#8209924">c</a></span><span class="op" id="8210503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210508"><a href="/os/signal/signal_test.go.html#8209513">t</a></span><span class="op" id="8210509">.</span><span class="ident" id="8210510">Fatalf</span><span class="op" id="8210516">(</span><span class="string" id="8210517">&#34;unexpected&nbsp;signal&nbsp;%v&#34;</span><span class="op" id="8210539">,</span>&nbsp;<span class="ident" id="8210541"><a href="/os/signal/signal_test.go.html#8210495">s</a></span><span class="op" id="8210542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210546">case</span>&nbsp;<span class="op" id="8210551">&lt;-</span><span class="ident" id="8210553"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8210557">.</span><span class="ident" id="8210558">After</span><span class="op" id="8210563">(</span><span class="num" id="8210564">100</span>&nbsp;<span class="op" id="8210568">*</span>&nbsp;<span class="ident" id="8210570"><a href="/os/signal/signal_test.go.html#8207268">time</a></span><span class="op" id="8210574">.</span><span class="ident" id="8210575">Millisecond</span><span class="op" id="8210586">)</span><span class="op" id="8210587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210592">//&nbsp;nothing&nbsp;to&nbsp;read&nbsp;-&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210620">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210623">}</span><br>
<span class="lineno"></span><span class="op" id="8210625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8210628">//&nbsp;Test&nbsp;that&nbsp;when&nbsp;run&nbsp;under&nbsp;nohup,&nbsp;an&nbsp;uncaught&nbsp;SIGHUP&nbsp;does&nbsp;not&nbsp;kill&nbsp;the&nbsp;program,</span><br>
<span class="lineno"></span><span class="comment" id="8210709">//&nbsp;but&nbsp;a</span><br>
<span class="lineno">165</span><span class="keyword" id="8210718">func</span>&nbsp;<span class="ident" id="8210723">TestNohup</span><span class="op" id="8210732">(</span><span class="ident" id="8210733">t</span>&nbsp;<span class="op" id="8210735">*</span><span class="ident" id="8210736"><a href="/os/signal/signal_test.go.html#8207257">testing</a></span><span class="op" id="8210743">.</span><span class="ident" id="8210744">T</span><span class="op" id="8210745">)</span>&nbsp;<span class="op" id="8210747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210750">//&nbsp;Ugly:&nbsp;ask&nbsp;for&nbsp;SIGHUP&nbsp;so&nbsp;that&nbsp;child&nbsp;will&nbsp;not&nbsp;have&nbsp;no-hup&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210814">//&nbsp;even&nbsp;if&nbsp;test&nbsp;is&nbsp;running&nbsp;under&nbsp;nohup&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210867">//&nbsp;We&nbsp;have&nbsp;no&nbsp;intention&nbsp;of&nbsp;reading&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210911">c</span>&nbsp;<span class="op" id="8210913">:=</span>&nbsp;<span class="builtinfunc" id="8210916">make</span><span class="op" id="8210920">(</span><span class="keyword" id="8210921">chan</span>&nbsp;<span class="ident" id="8210926"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8210928">.</span><span class="ident" id="8210929">Signal</span><span class="op" id="8210935">,</span>&nbsp;<span class="num" id="8210937">1</span><span class="op" id="8210938">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210941"><a href="/os/signal/signal.go.html#4909129">Notify</a></span><span class="op" id="8210947">(</span><span class="ident" id="8210948"><a href="/os/signal/signal_test.go.html#8210911">c</a></span><span class="op" id="8210949">,</span>&nbsp;<span class="ident" id="8210951"><a href="/os/signal/signal_test.go.html#8207246">syscall</a></span><span class="op" id="8210958">.</span><span class="ident" id="8210959">SIGHUP</span><span class="op" id="8210965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210969">//&nbsp;When&nbsp;run&nbsp;without&nbsp;nohup,&nbsp;the&nbsp;test&nbsp;should&nbsp;crash&nbsp;on&nbsp;an&nbsp;uncaught&nbsp;SIGHUP.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211042">//&nbsp;When&nbsp;run&nbsp;under&nbsp;nohup,&nbsp;the&nbsp;test&nbsp;should&nbsp;ignore&nbsp;uncaught&nbsp;SIGHUPs,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211109">//&nbsp;because&nbsp;the&nbsp;runtime&nbsp;is&nbsp;not&nbsp;supposed&nbsp;to&nbsp;be&nbsp;listening&nbsp;for&nbsp;them.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211175">//&nbsp;Either&nbsp;way,&nbsp;TestStop&nbsp;should&nbsp;still&nbsp;be&nbsp;able&nbsp;to&nbsp;catch&nbsp;them&nbsp;when&nbsp;it&nbsp;wants&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211254">//&nbsp;and&nbsp;then&nbsp;when&nbsp;it&nbsp;stops&nbsp;wanting&nbsp;them,&nbsp;the&nbsp;original&nbsp;behavior&nbsp;should&nbsp;resume.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211332">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211336">//&nbsp;send_uncaught_sighup=1&nbsp;sends&nbsp;the&nbsp;SIGHUP&nbsp;before&nbsp;starting&nbsp;to&nbsp;listen&nbsp;for&nbsp;SIGHUPs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211419">//&nbsp;send_uncaught_sighup=2&nbsp;sends&nbsp;the&nbsp;SIGHUP&nbsp;after&nbsp;no&nbsp;longer&nbsp;listening&nbsp;for&nbsp;SIGHUPs.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211502">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211506">//&nbsp;Both&nbsp;should&nbsp;fail&nbsp;without&nbsp;nohup&nbsp;and&nbsp;succeed&nbsp;with&nbsp;nohup.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211566">for</span>&nbsp;<span class="ident" id="8211570">i</span>&nbsp;<span class="op" id="8211572">:=</span>&nbsp;<span class="num" id="8211575">1</span><span class="op" id="8211576">;</span>&nbsp;<span class="ident" id="8211578"><a href="/os/signal/signal_test.go.html#8211570">i</a></span>&nbsp;<span class="op" id="8211580">&lt;=</span>&nbsp;<span class="num" id="8211583">2</span><span class="op" id="8211584">;</span>&nbsp;<span class="ident" id="8211586"><a href="/os/signal/signal_test.go.html#8211570">i</a></span><span class="op" id="8211587">++</span>&nbsp;<span class="op" id="8211590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211594">out</span><span class="op" id="8211597">,</span>&nbsp;<span class="ident" id="8211599">err</span>&nbsp;<span class="op" id="8211603">:=</span>&nbsp;<span class="ident" id="8211606"><a href="/os/signal/signal_test.go.html#8207213">exec</a></span><span class="op" id="8211610">.</span><span class="ident" id="8211611">Command</span><span class="op" id="8211618">(</span><span class="ident" id="8211619"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8211621">.</span><span class="ident" id="8211622">Args</span><span class="op" id="8211626">[</span><span class="num" id="8211627">0</span><span class="op" id="8211628">]</span><span class="op" id="8211629">,</span>&nbsp;<span class="string" id="8211631">&#34;-test.run=TestStop&#34;</span><span class="op" id="8211651">,</span>&nbsp;<span class="string" id="8211653">&#34;-send_uncaught_sighup=&#34;</span><span class="op" id="8211677">+</span><span class="ident" id="8211678"><a href="/os/signal/signal_test.go.html#8207235">strconv</a></span><span class="op" id="8211685">.</span><span class="ident" id="8211686">Itoa</span><span class="op" id="8211690">(</span><span class="ident" id="8211691"><a href="/os/signal/signal_test.go.html#8211570">i</a></span><span class="op" id="8211692">)</span><span class="op" id="8211693">)</span><span class="op" id="8211694">.</span><span class="ident" id="8211695">CombinedOutput</span><span class="op" id="8211709">(</span><span class="op" id="8211710">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211714">if</span>&nbsp;<span class="ident" id="8211717"><a href="/os/signal/signal_test.go.html#8211599">err</a></span>&nbsp;<span class="op" id="8211721">==</span>&nbsp;<span class="ident" id="8211724">nil</span>&nbsp;<span class="op" id="8211728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211733"><a href="/os/signal/signal_test.go.html#8210733">t</a></span><span class="op" id="8211734">.</span><span class="ident" id="8211735">Fatalf</span><span class="op" id="8211741">(</span><span class="string" id="8211742">&#34;ran&nbsp;test&nbsp;with&nbsp;-send_uncaught_sighup=%d&nbsp;and&nbsp;it&nbsp;succeeded:&nbsp;expected&nbsp;failure.\nOutput:\n%s&#34;</span><span class="op" id="8211831">,</span>&nbsp;<span class="ident" id="8211833"><a href="/os/signal/signal_test.go.html#8211570">i</a></span><span class="op" id="8211834">,</span>&nbsp;<span class="ident" id="8211836"><a href="/os/signal/signal_test.go.html#8211594">out</a></span><span class="op" id="8211839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211850"><a href="/os/signal/signal.go.html#4909949">Stop</a></span><span class="op" id="8211854">(</span><span class="ident" id="8211855"><a href="/os/signal/signal_test.go.html#8210911">c</a></span><span class="op" id="8211856">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211860">//&nbsp;Again,&nbsp;this&nbsp;time&nbsp;with&nbsp;nohup,&nbsp;assuming&nbsp;we&nbsp;can&nbsp;find&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211918">_</span><span class="op" id="8211919">,</span>&nbsp;<span class="ident" id="8211921">err</span>&nbsp;<span class="op" id="8211925">:=</span>&nbsp;<span class="ident" id="8211928"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8211930">.</span><span class="ident" id="8211931">Stat</span><span class="op" id="8211935">(</span><span class="string" id="8211936">&#34;/usr/bin/nohup&#34;</span><span class="op" id="8211952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211955">if</span>&nbsp;<span class="ident" id="8211958"><a href="/os/signal/signal_test.go.html#8211921">err</a></span>&nbsp;<span class="op" id="8211962">!=</span>&nbsp;<span class="ident" id="8211965">nil</span>&nbsp;<span class="op" id="8211969">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211973"><a href="/os/signal/signal_test.go.html#8210733">t</a></span><span class="op" id="8211974">.</span><span class="ident" id="8211975">Skip</span><span class="op" id="8211979">(</span><span class="string" id="8211980">&#34;cannot&nbsp;find&nbsp;nohup;&nbsp;skipping&nbsp;second&nbsp;half&nbsp;of&nbsp;test&#34;</span><span class="op" id="8212029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212036">for</span>&nbsp;<span class="ident" id="8212040">i</span>&nbsp;<span class="op" id="8212042">:=</span>&nbsp;<span class="num" id="8212045">1</span><span class="op" id="8212046">;</span>&nbsp;<span class="ident" id="8212048"><a href="/os/signal/signal_test.go.html#8212040">i</a></span>&nbsp;<span class="op" id="8212050">&lt;=</span>&nbsp;<span class="num" id="8212053">2</span><span class="op" id="8212054">;</span>&nbsp;<span class="ident" id="8212056"><a href="/os/signal/signal_test.go.html#8212040">i</a></span><span class="op" id="8212057">++</span>&nbsp;<span class="op" id="8212060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212064"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8212066">.</span><span class="ident" id="8212067">Remove</span><span class="op" id="8212073">(</span><span class="string" id="8212074">&#34;nohup.out&#34;</span><span class="op" id="8212085">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212089">out</span><span class="op" id="8212092">,</span>&nbsp;<span class="ident" id="8212094">err</span>&nbsp;<span class="op" id="8212098">:=</span>&nbsp;<span class="ident" id="8212101"><a href="/os/signal/signal_test.go.html#8207213">exec</a></span><span class="op" id="8212105">.</span><span class="ident" id="8212106">Command</span><span class="op" id="8212113">(</span><span class="string" id="8212114">&#34;/usr/bin/nohup&#34;</span><span class="op" id="8212130">,</span>&nbsp;<span class="ident" id="8212132"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8212134">.</span><span class="ident" id="8212135">Args</span><span class="op" id="8212139">[</span><span class="num" id="8212140">0</span><span class="op" id="8212141">]</span><span class="op" id="8212142">,</span>&nbsp;<span class="string" id="8212144">&#34;-test.run=TestStop&#34;</span><span class="op" id="8212164">,</span>&nbsp;<span class="string" id="8212166">&#34;-send_uncaught_sighup=&#34;</span><span class="op" id="8212190">+</span><span class="ident" id="8212191"><a href="/os/signal/signal_test.go.html#8207235">strconv</a></span><span class="op" id="8212198">.</span><span class="ident" id="8212199">Itoa</span><span class="op" id="8212203">(</span><span class="ident" id="8212204"><a href="/os/signal/signal_test.go.html#8212040">i</a></span><span class="op" id="8212205">)</span><span class="op" id="8212206">)</span><span class="op" id="8212207">.</span><span class="ident" id="8212208">CombinedOutput</span><span class="op" id="8212222">(</span><span class="op" id="8212223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212228">data</span><span class="op" id="8212232">,</span>&nbsp;<span class="ident" id="8212234">_</span>&nbsp;<span class="op" id="8212236">:=</span>&nbsp;<span class="ident" id="8212239"><a href="/os/signal/signal_test.go.html#8207194">ioutil</a></span><span class="op" id="8212245">.</span><span class="ident" id="8212246">ReadFile</span><span class="op" id="8212254">(</span><span class="string" id="8212255">&#34;nohup.out&#34;</span><span class="op" id="8212266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212270"><a href="/os/signal/signal_test.go.html#8207207">os</a></span><span class="op" id="8212272">.</span><span class="ident" id="8212273">Remove</span><span class="op" id="8212279">(</span><span class="string" id="8212280">&#34;nohup.out&#34;</span><span class="op" id="8212291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212295">if</span>&nbsp;<span class="ident" id="8212298"><a href="/os/signal/signal_test.go.html#8212094">err</a></span>&nbsp;<span class="op" id="8212302">!=</span>&nbsp;<span class="ident" id="8212305">nil</span>&nbsp;<span class="op" id="8212309">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212314"><a href="/os/signal/signal_test.go.html#8210733">t</a></span><span class="op" id="8212315">.</span><span class="ident" id="8212316">Fatalf</span><span class="op" id="8212322">(</span><span class="string" id="8212323">&#34;ran&nbsp;test&nbsp;with&nbsp;-send_uncaught_sighup=%d&nbsp;under&nbsp;nohup&nbsp;and&nbsp;it&nbsp;failed:&nbsp;expected&nbsp;success.\nError:&nbsp;%v\nOutput:\n%s%s&#34;</span><span class="op" id="8212434">,</span>&nbsp;<span class="ident" id="8212436"><a href="/os/signal/signal_test.go.html#8212040">i</a></span><span class="op" id="8212437">,</span>&nbsp;<span class="ident" id="8212439"><a href="/os/signal/signal_test.go.html#8212094">err</a></span><span class="op" id="8212442">,</span>&nbsp;<span class="ident" id="8212444"><a href="/os/signal/signal_test.go.html#8212089">out</a></span><span class="op" id="8212447">,</span>&nbsp;<span class="ident" id="8212449"><a href="/os/signal/signal_test.go.html#8212228">data</a></span><span class="op" id="8212453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212460">}</span><br>
<span class="lineno"></span><span class="op" id="8212462">}</span>
</div>
</body>
</html>
