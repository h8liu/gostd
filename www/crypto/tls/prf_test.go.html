<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7862455">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7862510">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7862564">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7862615">package</span>&nbsp;<span class="ident" id="7862623">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7862628">import</span>&nbsp;<span class="op" id="7862635">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7862638">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7862654">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7862664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7862667">type</span>&nbsp;<span class="ident" id="7862672">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="7862701">struct</span>&nbsp;<span class="op" id="7862708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7862711">in</span><span class="op" id="7862713">,</span>&nbsp;<span class="ident" id="7862715">out1</span><span class="op" id="7862719">,</span>&nbsp;<span class="ident" id="7862721">out2</span>&nbsp;<span class="builtintype" id="7862726">string</span><br>
<span class="lineno"></span><span class="op" id="7862733">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7862736">var</span>&nbsp;<span class="ident" id="7862740">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7862770">=</span>&nbsp;<span class="op" id="7862772">[</span><span class="op" id="7862773">]</span><span class="ident" id="7862774">testSplitPreMasterSecretTest</span><span class="op" id="7862802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7862805">{</span><span class="string" id="7862806">&#34;&#34;</span><span class="op" id="7862808">,</span>&nbsp;<span class="string" id="7862810">&#34;&#34;</span><span class="op" id="7862812">,</span>&nbsp;<span class="string" id="7862814">&#34;&#34;</span><span class="op" id="7862816">}</span><span class="op" id="7862817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7862820">{</span><span class="string" id="7862821">&#34;00&#34;</span><span class="op" id="7862825">,</span>&nbsp;<span class="string" id="7862827">&#34;00&#34;</span><span class="op" id="7862831">,</span>&nbsp;<span class="string" id="7862833">&#34;00&#34;</span><span class="op" id="7862837">}</span><span class="op" id="7862838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7862841">{</span><span class="string" id="7862842">&#34;0011&#34;</span><span class="op" id="7862848">,</span>&nbsp;<span class="string" id="7862850">&#34;00&#34;</span><span class="op" id="7862854">,</span>&nbsp;<span class="string" id="7862856">&#34;11&#34;</span><span class="op" id="7862860">}</span><span class="op" id="7862861">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7862864">{</span><span class="string" id="7862865">&#34;001122&#34;</span><span class="op" id="7862873">,</span>&nbsp;<span class="string" id="7862875">&#34;0011&#34;</span><span class="op" id="7862881">,</span>&nbsp;<span class="string" id="7862883">&#34;1122&#34;</span><span class="op" id="7862889">}</span><span class="op" id="7862890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7862893">{</span><span class="string" id="7862894">&#34;00112233&#34;</span><span class="op" id="7862904">,</span>&nbsp;<span class="string" id="7862906">&#34;0011&#34;</span><span class="op" id="7862912">,</span>&nbsp;<span class="string" id="7862914">&#34;2233&#34;</span><span class="op" id="7862920">}</span><span class="op" id="7862921">,</span><br>
<span class="lineno"></span><span class="op" id="7862923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7862926">func</span>&nbsp;<span class="ident" id="7862931">TestSplitPreMasterSecret</span><span class="op" id="7862955">(</span><span class="ident" id="7862956">t</span>&nbsp;<span class="op" id="7862958">*</span><span class="ident" id="7862959">testing</span><span class="op" id="7862966">.</span><span class="ident" id="7862967">T</span><span class="op" id="7862968">)</span>&nbsp;<span class="op" id="7862970">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7862973">for</span>&nbsp;<span class="ident" id="7862977">i</span><span class="op" id="7862978">,</span>&nbsp;<span class="ident" id="7862980">test</span>&nbsp;<span class="op" id="7862985">:=</span>&nbsp;<span class="keyword" id="7862988">range</span>&nbsp;<span class="ident" id="7862994">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7863024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863028">in</span><span class="op" id="7863030">,</span>&nbsp;<span class="ident" id="7863032">_</span>&nbsp;<span class="op" id="7863034">:=</span>&nbsp;<span class="ident" id="7863037">hex</span><span class="op" id="7863040">.</span><span class="ident" id="7863041">DecodeString</span><span class="op" id="7863053">(</span><span class="ident" id="7863054">test</span><span class="op" id="7863058">.</span><span class="ident" id="7863059">in</span><span class="op" id="7863061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863065">out1</span><span class="op" id="7863069">,</span>&nbsp;<span class="ident" id="7863071">out2</span>&nbsp;<span class="op" id="7863076">:=</span>&nbsp;<span class="ident" id="7863079">splitPreMasterSecret</span><span class="op" id="7863099">(</span><span class="ident" id="7863100">in</span><span class="op" id="7863102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863106">s1</span>&nbsp;<span class="op" id="7863109">:=</span>&nbsp;<span class="ident" id="7863112">hex</span><span class="op" id="7863115">.</span><span class="ident" id="7863116">EncodeToString</span><span class="op" id="7863130">(</span><span class="ident" id="7863131">out1</span><span class="op" id="7863135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863139">s2</span>&nbsp;<span class="op" id="7863142">:=</span>&nbsp;<span class="ident" id="7863145">hex</span><span class="op" id="7863148">.</span><span class="ident" id="7863149">EncodeToString</span><span class="op" id="7863163">(</span><span class="ident" id="7863164">out2</span><span class="op" id="7863168">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7863172">if</span>&nbsp;<span class="ident" id="7863175">s1</span>&nbsp;<span class="op" id="7863178">!=</span>&nbsp;<span class="ident" id="7863181">test</span><span class="op" id="7863185">.</span><span class="ident" id="7863186">out1</span>&nbsp;<span class="op" id="7863191">||</span>&nbsp;<span class="ident" id="7863194">s2</span>&nbsp;<span class="op" id="7863197">!=</span>&nbsp;<span class="ident" id="7863200">test</span><span class="op" id="7863204">.</span><span class="ident" id="7863205">out2</span>&nbsp;<span class="op" id="7863210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863215">t</span><span class="op" id="7863216">.</span><span class="ident" id="7863217">Errorf</span><span class="op" id="7863223">(</span><span class="string" id="7863224">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="7863259">,</span>&nbsp;<span class="ident" id="7863261">i</span><span class="op" id="7863262">,</span>&nbsp;<span class="ident" id="7863264">s1</span><span class="op" id="7863266">,</span>&nbsp;<span class="ident" id="7863268">s2</span><span class="op" id="7863270">,</span>&nbsp;<span class="ident" id="7863272">test</span><span class="op" id="7863276">.</span><span class="ident" id="7863277">out1</span><span class="op" id="7863281">,</span>&nbsp;<span class="ident" id="7863283">test</span><span class="op" id="7863287">.</span><span class="ident" id="7863288">out2</span><span class="op" id="7863292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7863296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7863299">}</span><br>
<span class="lineno"></span><span class="op" id="7863301">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7863304">type</span>&nbsp;<span class="ident" id="7863309">testKeysFromTest</span>&nbsp;<span class="keyword" id="7863326">struct</span>&nbsp;<span class="op" id="7863333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863336">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7863363">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863371">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7863398">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863406">clientRandom</span><span class="op" id="7863418">,</span>&nbsp;<span class="ident" id="7863420">serverRandom</span>&nbsp;<span class="builtintype" id="7863433">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863441">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7863468">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863476">clientMAC</span><span class="op" id="7863485">,</span>&nbsp;<span class="ident" id="7863487">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7863503">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863511">clientKey</span><span class="op" id="7863520">,</span>&nbsp;<span class="ident" id="7863522">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7863538">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863546">macLen</span><span class="op" id="7863552">,</span>&nbsp;<span class="ident" id="7863554">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7863573">int</span><br>
<span class="lineno"></span><span class="op" id="7863577">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7863580">func</span>&nbsp;<span class="ident" id="7863585">TestKeysFromPreMasterSecret</span><span class="op" id="7863612">(</span><span class="ident" id="7863613">t</span>&nbsp;<span class="op" id="7863615">*</span><span class="ident" id="7863616">testing</span><span class="op" id="7863623">.</span><span class="ident" id="7863624">T</span><span class="op" id="7863625">)</span>&nbsp;<span class="op" id="7863627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7863630">for</span>&nbsp;<span class="ident" id="7863634">i</span><span class="op" id="7863635">,</span>&nbsp;<span class="ident" id="7863637">test</span>&nbsp;<span class="op" id="7863642">:=</span>&nbsp;<span class="keyword" id="7863645">range</span>&nbsp;<span class="ident" id="7863651">testKeysFromTests</span>&nbsp;<span class="op" id="7863669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863673">in</span><span class="op" id="7863675">,</span>&nbsp;<span class="ident" id="7863677">_</span>&nbsp;<span class="op" id="7863679">:=</span>&nbsp;<span class="ident" id="7863682">hex</span><span class="op" id="7863685">.</span><span class="ident" id="7863686">DecodeString</span><span class="op" id="7863698">(</span><span class="ident" id="7863699">test</span><span class="op" id="7863703">.</span><span class="ident" id="7863704">preMasterSecret</span><span class="op" id="7863719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863723">clientRandom</span><span class="op" id="7863735">,</span>&nbsp;<span class="ident" id="7863737">_</span>&nbsp;<span class="op" id="7863739">:=</span>&nbsp;<span class="ident" id="7863742">hex</span><span class="op" id="7863745">.</span><span class="ident" id="7863746">DecodeString</span><span class="op" id="7863758">(</span><span class="ident" id="7863759">test</span><span class="op" id="7863763">.</span><span class="ident" id="7863764">clientRandom</span><span class="op" id="7863776">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863780">serverRandom</span><span class="op" id="7863792">,</span>&nbsp;<span class="ident" id="7863794">_</span>&nbsp;<span class="op" id="7863796">:=</span>&nbsp;<span class="ident" id="7863799">hex</span><span class="op" id="7863802">.</span><span class="ident" id="7863803">DecodeString</span><span class="op" id="7863815">(</span><span class="ident" id="7863816">test</span><span class="op" id="7863820">.</span><span class="ident" id="7863821">serverRandom</span><span class="op" id="7863833">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863838">masterSecret</span>&nbsp;<span class="op" id="7863851">:=</span>&nbsp;<span class="ident" id="7863854">masterFromPreMasterSecret</span><span class="op" id="7863879">(</span><span class="ident" id="7863880">test</span><span class="op" id="7863884">.</span><span class="ident" id="7863885">version</span><span class="op" id="7863892">,</span>&nbsp;<span class="ident" id="7863894">in</span><span class="op" id="7863896">,</span>&nbsp;<span class="ident" id="7863898">clientRandom</span><span class="op" id="7863910">,</span>&nbsp;<span class="ident" id="7863912">serverRandom</span><span class="op" id="7863924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7863928">if</span>&nbsp;<span class="ident" id="7863931">s</span>&nbsp;<span class="op" id="7863933">:=</span>&nbsp;<span class="ident" id="7863936">hex</span><span class="op" id="7863939">.</span><span class="ident" id="7863940">EncodeToString</span><span class="op" id="7863954">(</span><span class="ident" id="7863955">masterSecret</span><span class="op" id="7863967">)</span><span class="op" id="7863968">;</span>&nbsp;<span class="ident" id="7863970">s</span>&nbsp;<span class="op" id="7863972">!=</span>&nbsp;<span class="ident" id="7863975">test</span><span class="op" id="7863979">.</span><span class="ident" id="7863980">masterSecret</span>&nbsp;<span class="op" id="7863993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7863998">t</span><span class="op" id="7863999">.</span><span class="ident" id="7864000">Errorf</span><span class="op" id="7864006">(</span><span class="string" id="7864007">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7864043">,</span>&nbsp;<span class="ident" id="7864045">i</span><span class="op" id="7864046">,</span>&nbsp;<span class="ident" id="7864048">s</span><span class="op" id="7864049">,</span>&nbsp;<span class="ident" id="7864051">test</span><span class="op" id="7864055">.</span><span class="ident" id="7864056">masterSecret</span><span class="op" id="7864068">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7864073">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7864084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864089">clientMAC</span><span class="op" id="7864098">,</span>&nbsp;<span class="ident" id="7864100">serverMAC</span><span class="op" id="7864109">,</span>&nbsp;<span class="ident" id="7864111">clientKey</span><span class="op" id="7864120">,</span>&nbsp;<span class="ident" id="7864122">serverKey</span><span class="op" id="7864131">,</span>&nbsp;<span class="ident" id="7864133">_</span><span class="op" id="7864134">,</span>&nbsp;<span class="ident" id="7864136">_</span>&nbsp;<span class="op" id="7864138">:=</span>&nbsp;<span class="ident" id="7864141">keysFromMasterSecret</span><span class="op" id="7864161">(</span><span class="ident" id="7864162">test</span><span class="op" id="7864166">.</span><span class="ident" id="7864167">version</span><span class="op" id="7864174">,</span>&nbsp;<span class="ident" id="7864176">masterSecret</span><span class="op" id="7864188">,</span>&nbsp;<span class="ident" id="7864190">clientRandom</span><span class="op" id="7864202">,</span>&nbsp;<span class="ident" id="7864204">serverRandom</span><span class="op" id="7864216">,</span>&nbsp;<span class="ident" id="7864218">test</span><span class="op" id="7864222">.</span><span class="ident" id="7864223">macLen</span><span class="op" id="7864229">,</span>&nbsp;<span class="ident" id="7864231">test</span><span class="op" id="7864235">.</span><span class="ident" id="7864236">keyLen</span><span class="op" id="7864242">,</span>&nbsp;<span class="num" id="7864244">0</span><span class="op" id="7864245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864249">clientMACString</span>&nbsp;<span class="op" id="7864265">:=</span>&nbsp;<span class="ident" id="7864268">hex</span><span class="op" id="7864271">.</span><span class="ident" id="7864272">EncodeToString</span><span class="op" id="7864286">(</span><span class="ident" id="7864287">clientMAC</span><span class="op" id="7864296">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864300">serverMACString</span>&nbsp;<span class="op" id="7864316">:=</span>&nbsp;<span class="ident" id="7864319">hex</span><span class="op" id="7864322">.</span><span class="ident" id="7864323">EncodeToString</span><span class="op" id="7864337">(</span><span class="ident" id="7864338">serverMAC</span><span class="op" id="7864347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864351">clientKeyString</span>&nbsp;<span class="op" id="7864367">:=</span>&nbsp;<span class="ident" id="7864370">hex</span><span class="op" id="7864373">.</span><span class="ident" id="7864374">EncodeToString</span><span class="op" id="7864388">(</span><span class="ident" id="7864389">clientKey</span><span class="op" id="7864398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864402">serverKeyString</span>&nbsp;<span class="op" id="7864418">:=</span>&nbsp;<span class="ident" id="7864421">hex</span><span class="op" id="7864424">.</span><span class="ident" id="7864425">EncodeToString</span><span class="op" id="7864439">(</span><span class="ident" id="7864440">serverKey</span><span class="op" id="7864449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7864453">if</span>&nbsp;<span class="ident" id="7864456">clientMACString</span>&nbsp;<span class="op" id="7864472">!=</span>&nbsp;<span class="ident" id="7864475">test</span><span class="op" id="7864479">.</span><span class="ident" id="7864480">clientMAC</span>&nbsp;<span class="op" id="7864490">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864496">serverMACString</span>&nbsp;<span class="op" id="7864512">!=</span>&nbsp;<span class="ident" id="7864515">test</span><span class="op" id="7864519">.</span><span class="ident" id="7864520">serverMAC</span>&nbsp;<span class="op" id="7864530">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864536">clientKeyString</span>&nbsp;<span class="op" id="7864552">!=</span>&nbsp;<span class="ident" id="7864555">test</span><span class="op" id="7864559">.</span><span class="ident" id="7864560">clientKey</span>&nbsp;<span class="op" id="7864570">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864576">serverKeyString</span>&nbsp;<span class="op" id="7864592">!=</span>&nbsp;<span class="ident" id="7864595">test</span><span class="op" id="7864599">.</span><span class="ident" id="7864600">serverKey</span>&nbsp;<span class="op" id="7864610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864615">t</span><span class="op" id="7864616">.</span><span class="ident" id="7864617">Errorf</span><span class="op" id="7864623">(</span><span class="string" id="7864624">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="7864675">,</span>&nbsp;<span class="ident" id="7864677">i</span><span class="op" id="7864678">,</span>&nbsp;<span class="ident" id="7864680">clientMACString</span><span class="op" id="7864695">,</span>&nbsp;<span class="ident" id="7864697">serverMACString</span><span class="op" id="7864712">,</span>&nbsp;<span class="ident" id="7864714">clientKeyString</span><span class="op" id="7864729">,</span>&nbsp;<span class="ident" id="7864731">serverKeyString</span><span class="op" id="7864746">,</span>&nbsp;<span class="ident" id="7864748">test</span><span class="op" id="7864752">.</span><span class="ident" id="7864753">clientMAC</span><span class="op" id="7864762">,</span>&nbsp;<span class="ident" id="7864764">test</span><span class="op" id="7864768">.</span><span class="ident" id="7864769">serverMAC</span><span class="op" id="7864778">,</span>&nbsp;<span class="ident" id="7864780">test</span><span class="op" id="7864784">.</span><span class="ident" id="7864785">clientKey</span><span class="op" id="7864794">,</span>&nbsp;<span class="ident" id="7864796">test</span><span class="op" id="7864800">.</span><span class="ident" id="7864801">serverKey</span><span class="op" id="7864810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7864814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7864817">}</span><br>
<span class="lineno">70</span><span class="op" id="7864819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7864822">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="7864907">var</span>&nbsp;<span class="ident" id="7864911">testKeysFromTests</span>&nbsp;<span class="op" id="7864929">=</span>&nbsp;<span class="op" id="7864931">[</span><span class="op" id="7864932">]</span><span class="ident" id="7864933">testKeysFromTest</span><span class="op" id="7864949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7864952">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7864956">VersionTLS10</span><span class="op" id="7864968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7864972">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="7865070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865074">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="7865140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865144">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="7865210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865214">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="7865312">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865316">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="7865358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865362">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="7865404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865408">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="7865442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865446">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="7865480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7865484">20</span><span class="op" id="7865486">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7865490">16</span><span class="op" id="7865492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7865495">}</span><span class="op" id="7865496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7865499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7865503">VersionTLS10</span><span class="op" id="7865515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865519">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="7865617">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865621">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="7865687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865691">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="7865757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865761">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="7865859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865863">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="7865905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865909">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="7865951">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865955">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="7865989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7865993">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="7866027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7866031">20</span><span class="op" id="7866033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7866037">16</span><span class="op" id="7866039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7866042">}</span><span class="op" id="7866043">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7866046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7866050">VersionTLS10</span><span class="op" id="7866062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866066">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7866324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866328">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7866394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866398">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7866464">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866468">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="7866566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866570">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="7866612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866616">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="7866658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866662">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="7866696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866700">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="7866734">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7866738">20</span><span class="op" id="7866740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7866744">16</span><span class="op" id="7866746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7866749">}</span><span class="op" id="7866750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7866753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7866757">VersionSSL30</span><span class="op" id="7866769">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7866773">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7867031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867035">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7867101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867105">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7867171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867175">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="7867273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867277">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="7867319">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867323">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="7867365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867369">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="7867403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867407">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="7867441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7867445">20</span><span class="op" id="7867447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7867451">16</span><span class="op" id="7867453">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7867456">}</span><span class="op" id="7867457">,</span><br>
<span class="lineno"></span><span class="op" id="7867459">}</span>
</div>
</body>
</html>
