<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4572461">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4572516">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4572570">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4572621">package</span>&nbsp;<span class="ident" id="4572629">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4572639">import</span>&nbsp;<span class="op" id="4572646">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572649">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572658">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572665">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572671">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572682">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572693">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572701">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4572712">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="4572734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4572737">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4572805">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="4572866">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4572894">type</span>&nbsp;<span class="ident" id="4572899">state</span>&nbsp;<span class="keyword" id="4572905">struct</span>&nbsp;<span class="op" id="4572912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572915">tmpl</span>&nbsp;<span class="op" id="4572920">*</span><span class="ident" id="4572921">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572931">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4572936">io</span><span class="op" id="4572938">.</span><span class="ident" id="4572939">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572947">node</span>&nbsp;<span class="ident" id="4572952">parse</span><span class="op" id="4572957">.</span><span class="ident" id="4572958">Node</span>&nbsp;<span class="comment" id="4572963">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572992">vars</span>&nbsp;<span class="op" id="4572997">[</span><span class="op" id="4572998">]</span><span class="ident" id="4572999">variable</span>&nbsp;<span class="comment" id="4573008">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="4573047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4573050">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="4573119">type</span>&nbsp;<span class="ident" id="4573124">variable</span>&nbsp;<span class="keyword" id="4573133">struct</span>&nbsp;<span class="op" id="4573140">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573143">name</span>&nbsp;&nbsp;<span class="builtintype" id="4573149">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573157">value</span>&nbsp;<span class="ident" id="4573163">reflect</span><span class="op" id="4573170">.</span><span class="ident" id="4573171">Value</span><br>
<span class="lineno"></span><span class="op" id="4573177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4573180">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="4573224">func</span>&nbsp;<span class="op" id="4573229">(</span><span class="ident" id="4573230">s</span>&nbsp;<span class="op" id="4573232">*</span><span class="ident" id="4573233">state</span><span class="op" id="4573238">)</span>&nbsp;<span class="ident" id="4573240">push</span><span class="op" id="4573244">(</span><span class="ident" id="4573245">name</span>&nbsp;<span class="builtintype" id="4573250">string</span><span class="op" id="4573256">,</span>&nbsp;<span class="ident" id="4573258">value</span>&nbsp;<span class="ident" id="4573264">reflect</span><span class="op" id="4573271">.</span><span class="ident" id="4573272">Value</span><span class="op" id="4573277">)</span>&nbsp;<span class="op" id="4573279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573282">s</span><span class="op" id="4573283">.</span><span class="ident" id="4573284">vars</span>&nbsp;<span class="op" id="4573289">=</span>&nbsp;<span class="builtinfunc" id="4573291">append</span><span class="op" id="4573297">(</span><span class="ident" id="4573298">s</span><span class="op" id="4573299">.</span><span class="ident" id="4573300">vars</span><span class="op" id="4573304">,</span>&nbsp;<span class="ident" id="4573306">variable</span><span class="op" id="4573314">{</span><span class="ident" id="4573315">name</span><span class="op" id="4573319">,</span>&nbsp;<span class="ident" id="4573321">value</span><span class="op" id="4573326">}</span><span class="op" id="4573327">)</span><br>
<span class="lineno"></span><span class="op" id="4573329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4573332">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="4573382">func</span>&nbsp;<span class="op" id="4573387">(</span><span class="ident" id="4573388">s</span>&nbsp;<span class="op" id="4573390">*</span><span class="ident" id="4573391">state</span><span class="op" id="4573396">)</span>&nbsp;<span class="ident" id="4573398">mark</span><span class="op" id="4573402">(</span><span class="op" id="4573403">)</span>&nbsp;<span class="builtintype" id="4573405">int</span>&nbsp;<span class="op" id="4573409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573412">return</span>&nbsp;<span class="builtinfunc" id="4573419">len</span><span class="op" id="4573422">(</span><span class="ident" id="4573423">s</span><span class="op" id="4573424">.</span><span class="ident" id="4573425">vars</span><span class="op" id="4573429">)</span><br>
<span class="lineno"></span><span class="op" id="4573431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4573434">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="4573481">func</span>&nbsp;<span class="op" id="4573486">(</span><span class="ident" id="4573487">s</span>&nbsp;<span class="op" id="4573489">*</span><span class="ident" id="4573490">state</span><span class="op" id="4573495">)</span>&nbsp;<span class="ident" id="4573497">pop</span><span class="op" id="4573500">(</span><span class="ident" id="4573501">mark</span>&nbsp;<span class="builtintype" id="4573506">int</span><span class="op" id="4573509">)</span>&nbsp;<span class="op" id="4573511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573514">s</span><span class="op" id="4573515">.</span><span class="ident" id="4573516">vars</span>&nbsp;<span class="op" id="4573521">=</span>&nbsp;<span class="ident" id="4573523">s</span><span class="op" id="4573524">.</span><span class="ident" id="4573525">vars</span><span class="op" id="4573529">[</span><span class="num" id="4573530">0</span><span class="op" id="4573531">:</span><span class="ident" id="4573532">mark</span><span class="op" id="4573536">]</span><br>
<span class="lineno"></span><span class="op" id="4573538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4573541">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="4573623">func</span>&nbsp;<span class="op" id="4573628">(</span><span class="ident" id="4573629">s</span>&nbsp;<span class="op" id="4573631">*</span><span class="ident" id="4573632">state</span><span class="op" id="4573637">)</span>&nbsp;<span class="ident" id="4573639">setVar</span><span class="op" id="4573645">(</span><span class="ident" id="4573646">n</span>&nbsp;<span class="builtintype" id="4573648">int</span><span class="op" id="4573651">,</span>&nbsp;<span class="ident" id="4573653">value</span>&nbsp;<span class="ident" id="4573659">reflect</span><span class="op" id="4573666">.</span><span class="ident" id="4573667">Value</span><span class="op" id="4573672">)</span>&nbsp;<span class="op" id="4573674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573677">s</span><span class="op" id="4573678">.</span><span class="ident" id="4573679">vars</span><span class="op" id="4573683">[</span><span class="builtinfunc" id="4573684">len</span><span class="op" id="4573687">(</span><span class="ident" id="4573688">s</span><span class="op" id="4573689">.</span><span class="ident" id="4573690">vars</span><span class="op" id="4573694">)</span><span class="op" id="4573695">-</span><span class="ident" id="4573696">n</span><span class="op" id="4573697">]</span><span class="op" id="4573698">.</span><span class="ident" id="4573699">value</span>&nbsp;<span class="op" id="4573705">=</span>&nbsp;<span class="ident" id="4573707">value</span><br>
<span class="lineno"></span><span class="op" id="4573713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4573716">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="4573769">func</span>&nbsp;<span class="op" id="4573774">(</span><span class="ident" id="4573775">s</span>&nbsp;<span class="op" id="4573777">*</span><span class="ident" id="4573778">state</span><span class="op" id="4573783">)</span>&nbsp;<span class="ident" id="4573785">varValue</span><span class="op" id="4573793">(</span><span class="ident" id="4573794">name</span>&nbsp;<span class="builtintype" id="4573799">string</span><span class="op" id="4573805">)</span>&nbsp;<span class="ident" id="4573807">reflect</span><span class="op" id="4573814">.</span><span class="ident" id="4573815">Value</span>&nbsp;<span class="op" id="4573821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573824">for</span>&nbsp;<span class="ident" id="4573828">i</span>&nbsp;<span class="op" id="4573830">:=</span>&nbsp;<span class="ident" id="4573833">s</span><span class="op" id="4573834">.</span><span class="ident" id="4573835">mark</span><span class="op" id="4573839">(</span><span class="op" id="4573840">)</span>&nbsp;<span class="op" id="4573842">-</span>&nbsp;<span class="num" id="4573844">1</span><span class="op" id="4573845">;</span>&nbsp;<span class="ident" id="4573847">i</span>&nbsp;<span class="op" id="4573849">&gt;=</span>&nbsp;<span class="num" id="4573852">0</span><span class="op" id="4573853">;</span>&nbsp;<span class="ident" id="4573855">i</span><span class="op" id="4573856">--</span>&nbsp;<span class="op" id="4573859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573863">if</span>&nbsp;<span class="ident" id="4573866">s</span><span class="op" id="4573867">.</span><span class="ident" id="4573868">vars</span><span class="op" id="4573872">[</span><span class="ident" id="4573873">i</span><span class="op" id="4573874">]</span><span class="op" id="4573875">.</span><span class="ident" id="4573876">name</span>&nbsp;<span class="op" id="4573881">==</span>&nbsp;<span class="ident" id="4573884">name</span>&nbsp;<span class="op" id="4573889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573894">return</span>&nbsp;<span class="ident" id="4573901">s</span><span class="op" id="4573902">.</span><span class="ident" id="4573903">vars</span><span class="op" id="4573907">[</span><span class="ident" id="4573908">i</span><span class="op" id="4573909">]</span><span class="op" id="4573910">.</span><span class="ident" id="4573911">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573919">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573925">s</span><span class="op" id="4573926">.</span><span class="ident" id="4573927">errorf</span><span class="op" id="4573933">(</span><span class="string" id="4573934">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="4573958">,</span>&nbsp;<span class="ident" id="4573960">name</span><span class="op" id="4573964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573967">return</span>&nbsp;<span class="ident" id="4573974">zero</span><br>
<span class="lineno"></span><span class="op" id="4573979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="4573982">var</span>&nbsp;<span class="ident" id="4573986">zero</span>&nbsp;<span class="ident" id="4573991">reflect</span><span class="op" id="4573998">.</span><span class="ident" id="4573999">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4574006">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="4574066">func</span>&nbsp;<span class="op" id="4574071">(</span><span class="ident" id="4574072">s</span>&nbsp;<span class="op" id="4574074">*</span><span class="ident" id="4574075">state</span><span class="op" id="4574080">)</span>&nbsp;<span class="ident" id="4574082">at</span><span class="op" id="4574084">(</span><span class="ident" id="4574085">node</span>&nbsp;<span class="ident" id="4574090">parse</span><span class="op" id="4574095">.</span><span class="ident" id="4574096">Node</span><span class="op" id="4574100">)</span>&nbsp;<span class="op" id="4574102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574105">s</span><span class="op" id="4574106">.</span><span class="ident" id="4574107">node</span>&nbsp;<span class="op" id="4574112">=</span>&nbsp;<span class="ident" id="4574114">node</span><br>
<span class="lineno">70</span><span class="op" id="4574119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4574122">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4574197">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4574256">func</span>&nbsp;<span class="ident" id="4574261">doublePercent</span><span class="op" id="4574274">(</span><span class="ident" id="4574275">str</span>&nbsp;<span class="builtintype" id="4574279">string</span><span class="op" id="4574285">)</span>&nbsp;<span class="builtintype" id="4574287">string</span>&nbsp;<span class="op" id="4574294">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574297">if</span>&nbsp;<span class="ident" id="4574300">strings</span><span class="op" id="4574307">.</span><span class="ident" id="4574308">Contains</span><span class="op" id="4574316">(</span><span class="ident" id="4574317">str</span><span class="op" id="4574320">,</span>&nbsp;<span class="string" id="4574322">&#34;%&#34;</span><span class="op" id="4574325">)</span>&nbsp;<span class="op" id="4574327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574331">str</span>&nbsp;<span class="op" id="4574335">=</span>&nbsp;<span class="ident" id="4574337">strings</span><span class="op" id="4574344">.</span><span class="ident" id="4574345">Replace</span><span class="op" id="4574352">(</span><span class="ident" id="4574353">str</span><span class="op" id="4574356">,</span>&nbsp;<span class="string" id="4574358">&#34;%&#34;</span><span class="op" id="4574361">,</span>&nbsp;<span class="string" id="4574363">&#34;%%&#34;</span><span class="op" id="4574367">,</span>&nbsp;<span class="op" id="4574369">-</span><span class="num" id="4574370">1</span><span class="op" id="4574371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574377">return</span>&nbsp;<span class="ident" id="4574384">str</span><br>
<span class="lineno"></span><span class="op" id="4574388">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4574391">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4574446">func</span>&nbsp;<span class="op" id="4574451">(</span><span class="ident" id="4574452">s</span>&nbsp;<span class="op" id="4574454">*</span><span class="ident" id="4574455">state</span><span class="op" id="4574460">)</span>&nbsp;<span class="ident" id="4574462">errorf</span><span class="op" id="4574468">(</span><span class="ident" id="4574469">format</span>&nbsp;<span class="builtintype" id="4574476">string</span><span class="op" id="4574482">,</span>&nbsp;<span class="ident" id="4574484">args</span>&nbsp;<span class="op" id="4574489">...</span><span class="keyword" id="4574492">interface</span><span class="op" id="4574501">{</span><span class="op" id="4574502">}</span><span class="op" id="4574503">)</span>&nbsp;<span class="op" id="4574505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574508">name</span>&nbsp;<span class="op" id="4574513">:=</span>&nbsp;<span class="ident" id="4574516">doublePercent</span><span class="op" id="4574529">(</span><span class="ident" id="4574530">s</span><span class="op" id="4574531">.</span><span class="ident" id="4574532">tmpl</span><span class="op" id="4574536">.</span><span class="ident" id="4574537">Name</span><span class="op" id="4574541">(</span><span class="op" id="4574542">)</span><span class="op" id="4574543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574546">if</span>&nbsp;<span class="ident" id="4574549">s</span><span class="op" id="4574550">.</span><span class="ident" id="4574551">node</span>&nbsp;<span class="op" id="4574556">==</span>&nbsp;<span class="builtintype" id="4574559">nil</span>&nbsp;<span class="op" id="4574563">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574567">format</span>&nbsp;<span class="op" id="4574574">=</span>&nbsp;<span class="ident" id="4574576">fmt</span><span class="op" id="4574579">.</span><span class="ident" id="4574580">Sprintf</span><span class="op" id="4574587">(</span><span class="string" id="4574588">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="4574606">,</span>&nbsp;<span class="ident" id="4574608">name</span><span class="op" id="4574612">,</span>&nbsp;<span class="ident" id="4574614">format</span><span class="op" id="4574620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574623">}</span>&nbsp;<span class="keyword" id="4574625">else</span>&nbsp;<span class="op" id="4574630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574634">location</span><span class="op" id="4574642">,</span>&nbsp;<span class="ident" id="4574644">context</span>&nbsp;<span class="op" id="4574652">:=</span>&nbsp;<span class="ident" id="4574655">s</span><span class="op" id="4574656">.</span><span class="ident" id="4574657">tmpl</span><span class="op" id="4574661">.</span><span class="ident" id="4574662">ErrorContext</span><span class="op" id="4574674">(</span><span class="ident" id="4574675">s</span><span class="op" id="4574676">.</span><span class="ident" id="4574677">node</span><span class="op" id="4574681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574685">format</span>&nbsp;<span class="op" id="4574692">=</span>&nbsp;<span class="ident" id="4574694">fmt</span><span class="op" id="4574697">.</span><span class="ident" id="4574698">Sprintf</span><span class="op" id="4574705">(</span><span class="string" id="4574706">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="4574746">,</span>&nbsp;<span class="ident" id="4574748">location</span><span class="op" id="4574756">,</span>&nbsp;<span class="ident" id="4574758">name</span><span class="op" id="4574762">,</span>&nbsp;<span class="ident" id="4574764">doublePercent</span><span class="op" id="4574777">(</span><span class="ident" id="4574778">context</span><span class="op" id="4574785">)</span><span class="op" id="4574786">,</span>&nbsp;<span class="ident" id="4574788">format</span><span class="op" id="4574794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4574797">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4574800">panic</span><span class="op" id="4574805">(</span><span class="ident" id="4574806">fmt</span><span class="op" id="4574809">.</span><span class="ident" id="4574810">Errorf</span><span class="op" id="4574816">(</span><span class="ident" id="4574817">format</span><span class="op" id="4574823">,</span>&nbsp;<span class="ident" id="4574825">args</span><span class="op" id="4574829">...</span><span class="op" id="4574832">)</span><span class="op" id="4574833">)</span><br>
<span class="lineno"></span><span class="op" id="4574835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4574838">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="4574911">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="4574930">func</span>&nbsp;<span class="ident" id="4574935">errRecover</span><span class="op" id="4574945">(</span><span class="ident" id="4574946">errp</span>&nbsp;<span class="op" id="4574951">*</span><span class="builtintype" id="4574952">error</span><span class="op" id="4574957">)</span>&nbsp;<span class="op" id="4574959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574962">e</span>&nbsp;<span class="op" id="4574964">:=</span>&nbsp;<span class="builtinfunc" id="4574967">recover</span><span class="op" id="4574974">(</span><span class="op" id="4574975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574978">if</span>&nbsp;<span class="ident" id="4574981">e</span>&nbsp;<span class="op" id="4574983">!=</span>&nbsp;<span class="builtintype" id="4574986">nil</span>&nbsp;<span class="op" id="4574990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574994">switch</span>&nbsp;<span class="ident" id="4575001">err</span>&nbsp;<span class="op" id="4575005">:=</span>&nbsp;<span class="ident" id="4575008">e</span><span class="op" id="4575009">.</span><span class="op" id="4575010">(</span><span class="keyword" id="4575011">type</span><span class="op" id="4575015">)</span>&nbsp;<span class="op" id="4575017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575021">case</span>&nbsp;<span class="ident" id="4575026">runtime</span><span class="op" id="4575033">.</span><span class="ident" id="4575034">Error</span><span class="op" id="4575039">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4575044">panic</span><span class="op" id="4575049">(</span><span class="ident" id="4575050">e</span><span class="op" id="4575051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575055">case</span>&nbsp;<span class="builtintype" id="4575060">error</span><span class="op" id="4575065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575070">*</span><span class="ident" id="4575071">errp</span>&nbsp;<span class="op" id="4575076">=</span>&nbsp;<span class="ident" id="4575078">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575084">default</span><span class="op" id="4575091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4575096">panic</span><span class="op" id="4575101">(</span><span class="ident" id="4575102">e</span><span class="op" id="4575103">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575110">}</span><br>
<span class="lineno"></span><span class="op" id="4575112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4575115">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="4575197">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="4575258">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4575326">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4575399">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4575421">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="4575471">func</span>&nbsp;<span class="op" id="4575476">(</span><span class="ident" id="4575477">t</span>&nbsp;<span class="op" id="4575479">*</span><span class="ident" id="4575480">Template</span><span class="op" id="4575488">)</span>&nbsp;<span class="ident" id="4575490">ExecuteTemplate</span><span class="op" id="4575505">(</span><span class="ident" id="4575506">wr</span>&nbsp;<span class="ident" id="4575509">io</span><span class="op" id="4575511">.</span><span class="ident" id="4575512">Writer</span><span class="op" id="4575518">,</span>&nbsp;<span class="ident" id="4575520">name</span>&nbsp;<span class="builtintype" id="4575525">string</span><span class="op" id="4575531">,</span>&nbsp;<span class="ident" id="4575533">data</span>&nbsp;<span class="keyword" id="4575538">interface</span><span class="op" id="4575547">{</span><span class="op" id="4575548">}</span><span class="op" id="4575549">)</span>&nbsp;<span class="builtintype" id="4575551">error</span>&nbsp;<span class="op" id="4575557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575560">tmpl</span>&nbsp;<span class="op" id="4575565">:=</span>&nbsp;<span class="ident" id="4575568">t</span><span class="op" id="4575569">.</span><span class="ident" id="4575570">tmpl</span><span class="op" id="4575574">[</span><span class="ident" id="4575575">name</span><span class="op" id="4575579">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575582">if</span>&nbsp;<span class="ident" id="4575585">tmpl</span>&nbsp;<span class="op" id="4575590">==</span>&nbsp;<span class="builtintype" id="4575593">nil</span>&nbsp;<span class="op" id="4575597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575601">return</span>&nbsp;<span class="ident" id="4575608">fmt</span><span class="op" id="4575611">.</span><span class="ident" id="4575612">Errorf</span><span class="op" id="4575618">(</span><span class="string" id="4575619">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="4575673">,</span>&nbsp;<span class="ident" id="4575675">name</span><span class="op" id="4575679">,</span>&nbsp;<span class="ident" id="4575681">t</span><span class="op" id="4575682">.</span><span class="ident" id="4575683">name</span><span class="op" id="4575687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575690">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575693">return</span>&nbsp;<span class="ident" id="4575700">tmpl</span><span class="op" id="4575704">.</span><span class="ident" id="4575705">Execute</span><span class="op" id="4575712">(</span><span class="ident" id="4575713">wr</span><span class="op" id="4575715">,</span>&nbsp;<span class="ident" id="4575717">data</span><span class="op" id="4575721">)</span><br>
<span class="lineno"></span><span class="op" id="4575723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4575726">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="4575793">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="4575825">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4575893">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4575966">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4575988">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4576038">func</span>&nbsp;<span class="op" id="4576043">(</span><span class="ident" id="4576044">t</span>&nbsp;<span class="op" id="4576046">*</span><span class="ident" id="4576047">Template</span><span class="op" id="4576055">)</span>&nbsp;<span class="ident" id="4576057">Execute</span><span class="op" id="4576064">(</span><span class="ident" id="4576065">wr</span>&nbsp;<span class="ident" id="4576068">io</span><span class="op" id="4576070">.</span><span class="ident" id="4576071">Writer</span><span class="op" id="4576077">,</span>&nbsp;<span class="ident" id="4576079">data</span>&nbsp;<span class="keyword" id="4576084">interface</span><span class="op" id="4576093">{</span><span class="op" id="4576094">}</span><span class="op" id="4576095">)</span>&nbsp;<span class="op" id="4576097">(</span><span class="ident" id="4576098">err</span>&nbsp;<span class="builtintype" id="4576102">error</span><span class="op" id="4576107">)</span>&nbsp;<span class="op" id="4576109">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576112">defer</span>&nbsp;<span class="ident" id="4576118">errRecover</span><span class="op" id="4576128">(</span><span class="op" id="4576129">&amp;</span><span class="ident" id="4576130">err</span><span class="op" id="4576133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576136">value</span>&nbsp;<span class="op" id="4576142">:=</span>&nbsp;<span class="ident" id="4576145">reflect</span><span class="op" id="4576152">.</span><span class="ident" id="4576153">ValueOf</span><span class="op" id="4576160">(</span><span class="ident" id="4576161">data</span><span class="op" id="4576165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576168">state</span>&nbsp;<span class="op" id="4576174">:=</span>&nbsp;<span class="op" id="4576177">&amp;</span><span class="ident" id="4576178">state</span><span class="op" id="4576183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576187">tmpl</span><span class="op" id="4576191">:</span>&nbsp;<span class="ident" id="4576193">t</span><span class="op" id="4576194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576198">wr</span><span class="op" id="4576200">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4576204">wr</span><span class="op" id="4576206">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576210">vars</span><span class="op" id="4576214">:</span>&nbsp;<span class="op" id="4576216">[</span><span class="op" id="4576217">]</span><span class="ident" id="4576218">variable</span><span class="op" id="4576226">{</span><span class="op" id="4576227">{</span><span class="string" id="4576228">&#34;$&#34;</span><span class="op" id="4576231">,</span>&nbsp;<span class="ident" id="4576233">value</span><span class="op" id="4576238">}</span><span class="op" id="4576239">}</span><span class="op" id="4576240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576246">t</span><span class="op" id="4576247">.</span><span class="ident" id="4576248">init</span><span class="op" id="4576252">(</span><span class="op" id="4576253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576256">if</span>&nbsp;<span class="ident" id="4576259">t</span><span class="op" id="4576260">.</span><span class="ident" id="4576261">Tree</span>&nbsp;<span class="op" id="4576266">==</span>&nbsp;<span class="builtintype" id="4576269">nil</span>&nbsp;<span class="op" id="4576273">||</span>&nbsp;<span class="ident" id="4576276">t</span><span class="op" id="4576277">.</span><span class="ident" id="4576278">Root</span>&nbsp;<span class="op" id="4576283">==</span>&nbsp;<span class="builtintype" id="4576286">nil</span>&nbsp;<span class="op" id="4576290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576294">var</span>&nbsp;<span class="ident" id="4576298">b</span>&nbsp;<span class="ident" id="4576300">bytes</span><span class="op" id="4576305">.</span><span class="ident" id="4576306">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576315">for</span>&nbsp;<span class="ident" id="4576319">name</span><span class="op" id="4576323">,</span>&nbsp;<span class="ident" id="4576325">tmpl</span>&nbsp;<span class="op" id="4576330">:=</span>&nbsp;<span class="keyword" id="4576333">range</span>&nbsp;<span class="ident" id="4576339">t</span><span class="op" id="4576340">.</span><span class="ident" id="4576341">tmpl</span>&nbsp;<span class="op" id="4576346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576351">if</span>&nbsp;<span class="ident" id="4576354">tmpl</span><span class="op" id="4576358">.</span><span class="ident" id="4576359">Tree</span>&nbsp;<span class="op" id="4576364">==</span>&nbsp;<span class="builtintype" id="4576367">nil</span>&nbsp;<span class="op" id="4576371">||</span>&nbsp;<span class="ident" id="4576374">tmpl</span><span class="op" id="4576378">.</span><span class="ident" id="4576379">Root</span>&nbsp;<span class="op" id="4576384">==</span>&nbsp;<span class="builtintype" id="4576387">nil</span>&nbsp;<span class="op" id="4576391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576397">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576414">if</span>&nbsp;<span class="ident" id="4576417">b</span><span class="op" id="4576418">.</span><span class="ident" id="4576419">Len</span><span class="op" id="4576422">(</span><span class="op" id="4576423">)</span>&nbsp;<span class="op" id="4576425">&gt;</span>&nbsp;<span class="num" id="4576427">0</span>&nbsp;<span class="op" id="4576429">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576435">b</span><span class="op" id="4576436">.</span><span class="ident" id="4576437">WriteString</span><span class="op" id="4576448">(</span><span class="string" id="4576449">&#34;,&nbsp;&#34;</span><span class="op" id="4576453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576463">fmt</span><span class="op" id="4576466">.</span><span class="ident" id="4576467">Fprintf</span><span class="op" id="4576474">(</span><span class="op" id="4576475">&amp;</span><span class="ident" id="4576476">b</span><span class="op" id="4576477">,</span>&nbsp;<span class="string" id="4576479">&#34;%q&#34;</span><span class="op" id="4576483">,</span>&nbsp;<span class="ident" id="4576485">name</span><span class="op" id="4576489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576497">var</span>&nbsp;<span class="ident" id="4576501">s</span>&nbsp;<span class="builtintype" id="4576503">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576512">if</span>&nbsp;<span class="ident" id="4576515">b</span><span class="op" id="4576516">.</span><span class="ident" id="4576517">Len</span><span class="op" id="4576520">(</span><span class="op" id="4576521">)</span>&nbsp;<span class="op" id="4576523">&gt;</span>&nbsp;<span class="num" id="4576525">0</span>&nbsp;<span class="op" id="4576527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576532">s</span>&nbsp;<span class="op" id="4576534">=</span>&nbsp;<span class="string" id="4576536">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="4576564">+</span>&nbsp;<span class="ident" id="4576566">b</span><span class="op" id="4576567">.</span><span class="ident" id="4576568">String</span><span class="op" id="4576574">(</span><span class="op" id="4576575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576583">state</span><span class="op" id="4576588">.</span><span class="ident" id="4576589">errorf</span><span class="op" id="4576595">(</span><span class="string" id="4576596">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="4576637">,</span>&nbsp;<span class="ident" id="4576639">t</span><span class="op" id="4576640">.</span><span class="ident" id="4576641">Name</span><span class="op" id="4576645">(</span><span class="op" id="4576646">)</span><span class="op" id="4576647">,</span>&nbsp;<span class="ident" id="4576649">s</span><span class="op" id="4576650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576653">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576656">state</span><span class="op" id="4576661">.</span><span class="ident" id="4576662">walk</span><span class="op" id="4576666">(</span><span class="ident" id="4576667">value</span><span class="op" id="4576672">,</span>&nbsp;<span class="ident" id="4576674">t</span><span class="op" id="4576675">.</span><span class="ident" id="4576676">Root</span><span class="op" id="4576680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576683">return</span><br>
<span class="lineno"></span><span class="op" id="4576690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4576693">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="4576768">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="4576801">func</span>&nbsp;<span class="op" id="4576806">(</span><span class="ident" id="4576807">s</span>&nbsp;<span class="op" id="4576809">*</span><span class="ident" id="4576810">state</span><span class="op" id="4576815">)</span>&nbsp;<span class="ident" id="4576817">walk</span><span class="op" id="4576821">(</span><span class="ident" id="4576822">dot</span>&nbsp;<span class="ident" id="4576826">reflect</span><span class="op" id="4576833">.</span><span class="ident" id="4576834">Value</span><span class="op" id="4576839">,</span>&nbsp;<span class="ident" id="4576841">node</span>&nbsp;<span class="ident" id="4576846">parse</span><span class="op" id="4576851">.</span><span class="ident" id="4576852">Node</span><span class="op" id="4576856">)</span>&nbsp;<span class="op" id="4576858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576861">s</span><span class="op" id="4576862">.</span><span class="ident" id="4576863">at</span><span class="op" id="4576865">(</span><span class="ident" id="4576866">node</span><span class="op" id="4576870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576873">switch</span>&nbsp;<span class="ident" id="4576880">node</span>&nbsp;<span class="op" id="4576885">:=</span>&nbsp;<span class="ident" id="4576888">node</span><span class="op" id="4576892">.</span><span class="op" id="4576893">(</span><span class="keyword" id="4576894">type</span><span class="op" id="4576898">)</span>&nbsp;<span class="op" id="4576900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576903">case</span>&nbsp;<span class="op" id="4576908">*</span><span class="ident" id="4576909">parse</span><span class="op" id="4576914">.</span><span class="ident" id="4576915">ActionNode</span><span class="op" id="4576925">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4576929">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4576987">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577056">val</span>&nbsp;<span class="op" id="4577060">:=</span>&nbsp;<span class="ident" id="4577063">s</span><span class="op" id="4577064">.</span><span class="ident" id="4577065">evalPipeline</span><span class="op" id="4577077">(</span><span class="ident" id="4577078">dot</span><span class="op" id="4577081">,</span>&nbsp;<span class="ident" id="4577083">node</span><span class="op" id="4577087">.</span><span class="ident" id="4577088">Pipe</span><span class="op" id="4577092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577096">if</span>&nbsp;<span class="builtinfunc" id="4577099">len</span><span class="op" id="4577102">(</span><span class="ident" id="4577103">node</span><span class="op" id="4577107">.</span><span class="ident" id="4577108">Pipe</span><span class="op" id="4577112">.</span><span class="ident" id="4577113">Decl</span><span class="op" id="4577117">)</span>&nbsp;<span class="op" id="4577119">==</span>&nbsp;<span class="num" id="4577122">0</span>&nbsp;<span class="op" id="4577124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577129">s</span><span class="op" id="4577130">.</span><span class="ident" id="4577131">printValue</span><span class="op" id="4577141">(</span><span class="ident" id="4577142">node</span><span class="op" id="4577146">,</span>&nbsp;<span class="ident" id="4577148">val</span><span class="op" id="4577151">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577158">case</span>&nbsp;<span class="op" id="4577163">*</span><span class="ident" id="4577164">parse</span><span class="op" id="4577169">.</span><span class="ident" id="4577170">IfNode</span><span class="op" id="4577176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577180">s</span><span class="op" id="4577181">.</span><span class="ident" id="4577182">walkIfOrWith</span><span class="op" id="4577194">(</span><span class="ident" id="4577195">parse</span><span class="op" id="4577200">.</span><span class="ident" id="4577201">NodeIf</span><span class="op" id="4577207">,</span>&nbsp;<span class="ident" id="4577209">dot</span><span class="op" id="4577212">,</span>&nbsp;<span class="ident" id="4577214">node</span><span class="op" id="4577218">.</span><span class="ident" id="4577219">Pipe</span><span class="op" id="4577223">,</span>&nbsp;<span class="ident" id="4577225">node</span><span class="op" id="4577229">.</span><span class="ident" id="4577230">List</span><span class="op" id="4577234">,</span>&nbsp;<span class="ident" id="4577236">node</span><span class="op" id="4577240">.</span><span class="ident" id="4577241">ElseList</span><span class="op" id="4577249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577252">case</span>&nbsp;<span class="op" id="4577257">*</span><span class="ident" id="4577258">parse</span><span class="op" id="4577263">.</span><span class="ident" id="4577264">ListNode</span><span class="op" id="4577272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577276">for</span>&nbsp;<span class="ident" id="4577280">_</span><span class="op" id="4577281">,</span>&nbsp;<span class="ident" id="4577283">node</span>&nbsp;<span class="op" id="4577288">:=</span>&nbsp;<span class="keyword" id="4577291">range</span>&nbsp;<span class="ident" id="4577297">node</span><span class="op" id="4577301">.</span><span class="ident" id="4577302">Nodes</span>&nbsp;<span class="op" id="4577308">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577313">s</span><span class="op" id="4577314">.</span><span class="ident" id="4577315">walk</span><span class="op" id="4577319">(</span><span class="ident" id="4577320">dot</span><span class="op" id="4577323">,</span>&nbsp;<span class="ident" id="4577325">node</span><span class="op" id="4577329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577336">case</span>&nbsp;<span class="op" id="4577341">*</span><span class="ident" id="4577342">parse</span><span class="op" id="4577347">.</span><span class="ident" id="4577348">RangeNode</span><span class="op" id="4577357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577361">s</span><span class="op" id="4577362">.</span><span class="ident" id="4577363">walkRange</span><span class="op" id="4577372">(</span><span class="ident" id="4577373">dot</span><span class="op" id="4577376">,</span>&nbsp;<span class="ident" id="4577378">node</span><span class="op" id="4577382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577385">case</span>&nbsp;<span class="op" id="4577390">*</span><span class="ident" id="4577391">parse</span><span class="op" id="4577396">.</span><span class="ident" id="4577397">TemplateNode</span><span class="op" id="4577409">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577413">s</span><span class="op" id="4577414">.</span><span class="ident" id="4577415">walkTemplate</span><span class="op" id="4577427">(</span><span class="ident" id="4577428">dot</span><span class="op" id="4577431">,</span>&nbsp;<span class="ident" id="4577433">node</span><span class="op" id="4577437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577440">case</span>&nbsp;<span class="op" id="4577445">*</span><span class="ident" id="4577446">parse</span><span class="op" id="4577451">.</span><span class="ident" id="4577452">TextNode</span><span class="op" id="4577460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577464">if</span>&nbsp;<span class="ident" id="4577467">_</span><span class="op" id="4577468">,</span>&nbsp;<span class="ident" id="4577470">err</span>&nbsp;<span class="op" id="4577474">:=</span>&nbsp;<span class="ident" id="4577477">s</span><span class="op" id="4577478">.</span><span class="ident" id="4577479">wr</span><span class="op" id="4577481">.</span><span class="ident" id="4577482">Write</span><span class="op" id="4577487">(</span><span class="ident" id="4577488">node</span><span class="op" id="4577492">.</span><span class="ident" id="4577493">Text</span><span class="op" id="4577497">)</span><span class="op" id="4577498">;</span>&nbsp;<span class="ident" id="4577500">err</span>&nbsp;<span class="op" id="4577504">!=</span>&nbsp;<span class="builtintype" id="4577507">nil</span>&nbsp;<span class="op" id="4577511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577516">s</span><span class="op" id="4577517">.</span><span class="ident" id="4577518">errorf</span><span class="op" id="4577524">(</span><span class="string" id="4577525">&#34;%s&#34;</span><span class="op" id="4577529">,</span>&nbsp;<span class="ident" id="4577531">err</span><span class="op" id="4577534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577538">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577541">case</span>&nbsp;<span class="op" id="4577546">*</span><span class="ident" id="4577547">parse</span><span class="op" id="4577552">.</span><span class="ident" id="4577553">WithNode</span><span class="op" id="4577561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577565">s</span><span class="op" id="4577566">.</span><span class="ident" id="4577567">walkIfOrWith</span><span class="op" id="4577579">(</span><span class="ident" id="4577580">parse</span><span class="op" id="4577585">.</span><span class="ident" id="4577586">NodeWith</span><span class="op" id="4577594">,</span>&nbsp;<span class="ident" id="4577596">dot</span><span class="op" id="4577599">,</span>&nbsp;<span class="ident" id="4577601">node</span><span class="op" id="4577605">.</span><span class="ident" id="4577606">Pipe</span><span class="op" id="4577610">,</span>&nbsp;<span class="ident" id="4577612">node</span><span class="op" id="4577616">.</span><span class="ident" id="4577617">List</span><span class="op" id="4577621">,</span>&nbsp;<span class="ident" id="4577623">node</span><span class="op" id="4577627">.</span><span class="ident" id="4577628">ElseList</span><span class="op" id="4577636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577639">default</span><span class="op" id="4577646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577650">s</span><span class="op" id="4577651">.</span><span class="ident" id="4577652">errorf</span><span class="op" id="4577658">(</span><span class="string" id="4577659">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="4577677">,</span>&nbsp;<span class="ident" id="4577679">node</span><span class="op" id="4577683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577686">}</span><br>
<span class="lineno">190</span><span class="op" id="4577688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4577691">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="4577764">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="4577822">func</span>&nbsp;<span class="op" id="4577827">(</span><span class="ident" id="4577828">s</span>&nbsp;<span class="op" id="4577830">*</span><span class="ident" id="4577831">state</span><span class="op" id="4577836">)</span>&nbsp;<span class="ident" id="4577838">walkIfOrWith</span><span class="op" id="4577850">(</span><span class="ident" id="4577851">typ</span>&nbsp;<span class="ident" id="4577855">parse</span><span class="op" id="4577860">.</span><span class="ident" id="4577861">NodeType</span><span class="op" id="4577869">,</span>&nbsp;<span class="ident" id="4577871">dot</span>&nbsp;<span class="ident" id="4577875">reflect</span><span class="op" id="4577882">.</span><span class="ident" id="4577883">Value</span><span class="op" id="4577888">,</span>&nbsp;<span class="ident" id="4577890">pipe</span>&nbsp;<span class="op" id="4577895">*</span><span class="ident" id="4577896">parse</span><span class="op" id="4577901">.</span><span class="ident" id="4577902">PipeNode</span><span class="op" id="4577910">,</span>&nbsp;<span class="ident" id="4577912">list</span><span class="op" id="4577916">,</span>&nbsp;<span class="ident" id="4577918">elseList</span>&nbsp;<span class="op" id="4577927">*</span><span class="ident" id="4577928">parse</span><span class="op" id="4577933">.</span><span class="ident" id="4577934">ListNode</span><span class="op" id="4577942">)</span>&nbsp;<span class="op" id="4577944">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577947">defer</span>&nbsp;<span class="ident" id="4577953">s</span><span class="op" id="4577954">.</span><span class="ident" id="4577955">pop</span><span class="op" id="4577958">(</span><span class="ident" id="4577959">s</span><span class="op" id="4577960">.</span><span class="ident" id="4577961">mark</span><span class="op" id="4577965">(</span><span class="op" id="4577966">)</span><span class="op" id="4577967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577970">val</span>&nbsp;<span class="op" id="4577974">:=</span>&nbsp;<span class="ident" id="4577977">s</span><span class="op" id="4577978">.</span><span class="ident" id="4577979">evalPipeline</span><span class="op" id="4577991">(</span><span class="ident" id="4577992">dot</span><span class="op" id="4577995">,</span>&nbsp;<span class="ident" id="4577997">pipe</span><span class="op" id="4578001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578004">truth</span><span class="op" id="4578009">,</span>&nbsp;<span class="ident" id="4578011">ok</span>&nbsp;<span class="op" id="4578014">:=</span>&nbsp;<span class="ident" id="4578017">isTrue</span><span class="op" id="4578023">(</span><span class="ident" id="4578024">val</span><span class="op" id="4578027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578030">if</span>&nbsp;<span class="op" id="4578033">!</span><span class="ident" id="4578034">ok</span>&nbsp;<span class="op" id="4578037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578041">s</span><span class="op" id="4578042">.</span><span class="ident" id="4578043">errorf</span><span class="op" id="4578049">(</span><span class="string" id="4578050">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="4578072">,</span>&nbsp;<span class="ident" id="4578074">val</span><span class="op" id="4578077">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578083">if</span>&nbsp;<span class="ident" id="4578086">truth</span>&nbsp;<span class="op" id="4578092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578096">if</span>&nbsp;<span class="ident" id="4578099">typ</span>&nbsp;<span class="op" id="4578103">==</span>&nbsp;<span class="ident" id="4578106">parse</span><span class="op" id="4578111">.</span><span class="ident" id="4578112">NodeWith</span>&nbsp;<span class="op" id="4578121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578126">s</span><span class="op" id="4578127">.</span><span class="ident" id="4578128">walk</span><span class="op" id="4578132">(</span><span class="ident" id="4578133">val</span><span class="op" id="4578136">,</span>&nbsp;<span class="ident" id="4578138">list</span><span class="op" id="4578142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578146">}</span>&nbsp;<span class="keyword" id="4578148">else</span>&nbsp;<span class="op" id="4578153">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578158">s</span><span class="op" id="4578159">.</span><span class="ident" id="4578160">walk</span><span class="op" id="4578164">(</span><span class="ident" id="4578165">dot</span><span class="op" id="4578168">,</span>&nbsp;<span class="ident" id="4578170">list</span><span class="op" id="4578174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578181">}</span>&nbsp;<span class="keyword" id="4578183">else</span>&nbsp;<span class="keyword" id="4578188">if</span>&nbsp;<span class="ident" id="4578191">elseList</span>&nbsp;<span class="op" id="4578200">!=</span>&nbsp;<span class="builtintype" id="4578203">nil</span>&nbsp;<span class="op" id="4578207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578211">s</span><span class="op" id="4578212">.</span><span class="ident" id="4578213">walk</span><span class="op" id="4578217">(</span><span class="ident" id="4578218">dot</span><span class="op" id="4578221">,</span>&nbsp;<span class="ident" id="4578223">elseList</span><span class="op" id="4578231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578234">}</span><br>
<span class="lineno">210</span><span class="op" id="4578236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4578239">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="4578328">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4578383">func</span>&nbsp;<span class="ident" id="4578388">isTrue</span><span class="op" id="4578394">(</span><span class="ident" id="4578395">val</span>&nbsp;<span class="ident" id="4578399">reflect</span><span class="op" id="4578406">.</span><span class="ident" id="4578407">Value</span><span class="op" id="4578412">)</span>&nbsp;<span class="op" id="4578414">(</span><span class="ident" id="4578415">truth</span><span class="op" id="4578420">,</span>&nbsp;<span class="ident" id="4578422">ok</span>&nbsp;<span class="builtintype" id="4578425">bool</span><span class="op" id="4578429">)</span>&nbsp;<span class="op" id="4578431">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578434">if</span>&nbsp;<span class="op" id="4578437">!</span><span class="ident" id="4578438">val</span><span class="op" id="4578441">.</span><span class="ident" id="4578442">IsValid</span><span class="op" id="4578449">(</span><span class="op" id="4578450">)</span>&nbsp;<span class="op" id="4578452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4578456">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578526">return</span>&nbsp;<span class="builtintype" id="4578533">false</span><span class="op" id="4578538">,</span>&nbsp;<span class="builtintype" id="4578540">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578549">switch</span>&nbsp;<span class="ident" id="4578556">val</span><span class="op" id="4578559">.</span><span class="ident" id="4578560">Kind</span><span class="op" id="4578564">(</span><span class="op" id="4578565">)</span>&nbsp;<span class="op" id="4578567">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578570">case</span>&nbsp;<span class="ident" id="4578575">reflect</span><span class="op" id="4578582">.</span><span class="ident" id="4578583">Array</span><span class="op" id="4578588">,</span>&nbsp;<span class="ident" id="4578590">reflect</span><span class="op" id="4578597">.</span><span class="ident" id="4578598">Map</span><span class="op" id="4578601">,</span>&nbsp;<span class="ident" id="4578603">reflect</span><span class="op" id="4578610">.</span><span class="ident" id="4578611">Slice</span><span class="op" id="4578616">,</span>&nbsp;<span class="ident" id="4578618">reflect</span><span class="op" id="4578625">.</span><span class="ident" id="4578626">String</span><span class="op" id="4578632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578636">truth</span>&nbsp;<span class="op" id="4578642">=</span>&nbsp;<span class="ident" id="4578644">val</span><span class="op" id="4578647">.</span><span class="ident" id="4578648">Len</span><span class="op" id="4578651">(</span><span class="op" id="4578652">)</span>&nbsp;<span class="op" id="4578654">&gt;</span>&nbsp;<span class="num" id="4578656">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578659">case</span>&nbsp;<span class="ident" id="4578664">reflect</span><span class="op" id="4578671">.</span><span class="ident" id="4578672">Bool</span><span class="op" id="4578676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578680">truth</span>&nbsp;<span class="op" id="4578686">=</span>&nbsp;<span class="ident" id="4578688">val</span><span class="op" id="4578691">.</span><span class="ident" id="4578692">Bool</span><span class="op" id="4578696">(</span><span class="op" id="4578697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578700">case</span>&nbsp;<span class="ident" id="4578705">reflect</span><span class="op" id="4578712">.</span><span class="ident" id="4578713">Complex64</span><span class="op" id="4578722">,</span>&nbsp;<span class="ident" id="4578724">reflect</span><span class="op" id="4578731">.</span><span class="ident" id="4578732">Complex128</span><span class="op" id="4578742">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578746">truth</span>&nbsp;<span class="op" id="4578752">=</span>&nbsp;<span class="ident" id="4578754">val</span><span class="op" id="4578757">.</span><span class="ident" id="4578758">Complex</span><span class="op" id="4578765">(</span><span class="op" id="4578766">)</span>&nbsp;<span class="op" id="4578768">!=</span>&nbsp;<span class="num" id="4578771">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578774">case</span>&nbsp;<span class="ident" id="4578779">reflect</span><span class="op" id="4578786">.</span><span class="ident" id="4578787">Chan</span><span class="op" id="4578791">,</span>&nbsp;<span class="ident" id="4578793">reflect</span><span class="op" id="4578800">.</span><span class="ident" id="4578801">Func</span><span class="op" id="4578805">,</span>&nbsp;<span class="ident" id="4578807">reflect</span><span class="op" id="4578814">.</span><span class="ident" id="4578815">Ptr</span><span class="op" id="4578818">,</span>&nbsp;<span class="ident" id="4578820">reflect</span><span class="op" id="4578827">.</span><span class="ident" id="4578828">Interface</span><span class="op" id="4578837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578841">truth</span>&nbsp;<span class="op" id="4578847">=</span>&nbsp;<span class="op" id="4578849">!</span><span class="ident" id="4578850">val</span><span class="op" id="4578853">.</span><span class="ident" id="4578854">IsNil</span><span class="op" id="4578859">(</span><span class="op" id="4578860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578863">case</span>&nbsp;<span class="ident" id="4578868">reflect</span><span class="op" id="4578875">.</span><span class="ident" id="4578876">Int</span><span class="op" id="4578879">,</span>&nbsp;<span class="ident" id="4578881">reflect</span><span class="op" id="4578888">.</span><span class="ident" id="4578889">Int8</span><span class="op" id="4578893">,</span>&nbsp;<span class="ident" id="4578895">reflect</span><span class="op" id="4578902">.</span><span class="ident" id="4578903">Int16</span><span class="op" id="4578908">,</span>&nbsp;<span class="ident" id="4578910">reflect</span><span class="op" id="4578917">.</span><span class="ident" id="4578918">Int32</span><span class="op" id="4578923">,</span>&nbsp;<span class="ident" id="4578925">reflect</span><span class="op" id="4578932">.</span><span class="ident" id="4578933">Int64</span><span class="op" id="4578938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578942">truth</span>&nbsp;<span class="op" id="4578948">=</span>&nbsp;<span class="ident" id="4578950">val</span><span class="op" id="4578953">.</span><span class="ident" id="4578954">Int</span><span class="op" id="4578957">(</span><span class="op" id="4578958">)</span>&nbsp;<span class="op" id="4578960">!=</span>&nbsp;<span class="num" id="4578963">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578966">case</span>&nbsp;<span class="ident" id="4578971">reflect</span><span class="op" id="4578978">.</span><span class="ident" id="4578979">Float32</span><span class="op" id="4578986">,</span>&nbsp;<span class="ident" id="4578988">reflect</span><span class="op" id="4578995">.</span><span class="ident" id="4578996">Float64</span><span class="op" id="4579003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579007">truth</span>&nbsp;<span class="op" id="4579013">=</span>&nbsp;<span class="ident" id="4579015">val</span><span class="op" id="4579018">.</span><span class="ident" id="4579019">Float</span><span class="op" id="4579024">(</span><span class="op" id="4579025">)</span>&nbsp;<span class="op" id="4579027">!=</span>&nbsp;<span class="num" id="4579030">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579033">case</span>&nbsp;<span class="ident" id="4579038">reflect</span><span class="op" id="4579045">.</span><span class="ident" id="4579046">Uint</span><span class="op" id="4579050">,</span>&nbsp;<span class="ident" id="4579052">reflect</span><span class="op" id="4579059">.</span><span class="ident" id="4579060">Uint8</span><span class="op" id="4579065">,</span>&nbsp;<span class="ident" id="4579067">reflect</span><span class="op" id="4579074">.</span><span class="ident" id="4579075">Uint16</span><span class="op" id="4579081">,</span>&nbsp;<span class="ident" id="4579083">reflect</span><span class="op" id="4579090">.</span><span class="ident" id="4579091">Uint32</span><span class="op" id="4579097">,</span>&nbsp;<span class="ident" id="4579099">reflect</span><span class="op" id="4579106">.</span><span class="ident" id="4579107">Uint64</span><span class="op" id="4579113">,</span>&nbsp;<span class="ident" id="4579115">reflect</span><span class="op" id="4579122">.</span><span class="ident" id="4579123">Uintptr</span><span class="op" id="4579130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579134">truth</span>&nbsp;<span class="op" id="4579140">=</span>&nbsp;<span class="ident" id="4579142">val</span><span class="op" id="4579145">.</span><span class="ident" id="4579146">Uint</span><span class="op" id="4579150">(</span><span class="op" id="4579151">)</span>&nbsp;<span class="op" id="4579153">!=</span>&nbsp;<span class="num" id="4579156">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579159">case</span>&nbsp;<span class="ident" id="4579164">reflect</span><span class="op" id="4579171">.</span><span class="ident" id="4579172">Struct</span><span class="op" id="4579178">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579182">truth</span>&nbsp;<span class="op" id="4579188">=</span>&nbsp;<span class="builtintype" id="4579190">true</span>&nbsp;<span class="comment" id="4579195">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579230">default</span><span class="op" id="4579237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579241">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579252">return</span>&nbsp;<span class="ident" id="4579259">truth</span><span class="op" id="4579264">,</span>&nbsp;<span class="builtintype" id="4579266">true</span><br>
<span class="lineno">240</span><span class="op" id="4579271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4579274">func</span>&nbsp;<span class="op" id="4579279">(</span><span class="ident" id="4579280">s</span>&nbsp;<span class="op" id="4579282">*</span><span class="ident" id="4579283">state</span><span class="op" id="4579288">)</span>&nbsp;<span class="ident" id="4579290">walkRange</span><span class="op" id="4579299">(</span><span class="ident" id="4579300">dot</span>&nbsp;<span class="ident" id="4579304">reflect</span><span class="op" id="4579311">.</span><span class="ident" id="4579312">Value</span><span class="op" id="4579317">,</span>&nbsp;<span class="ident" id="4579319">r</span>&nbsp;<span class="op" id="4579321">*</span><span class="ident" id="4579322">parse</span><span class="op" id="4579327">.</span><span class="ident" id="4579328">RangeNode</span><span class="op" id="4579337">)</span>&nbsp;<span class="op" id="4579339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579342">s</span><span class="op" id="4579343">.</span><span class="ident" id="4579344">at</span><span class="op" id="4579346">(</span><span class="ident" id="4579347">r</span><span class="op" id="4579348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579351">defer</span>&nbsp;<span class="ident" id="4579357">s</span><span class="op" id="4579358">.</span><span class="ident" id="4579359">pop</span><span class="op" id="4579362">(</span><span class="ident" id="4579363">s</span><span class="op" id="4579364">.</span><span class="ident" id="4579365">mark</span><span class="op" id="4579369">(</span><span class="op" id="4579370">)</span><span class="op" id="4579371">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579374">val</span><span class="op" id="4579377">,</span>&nbsp;<span class="ident" id="4579379">_</span>&nbsp;<span class="op" id="4579381">:=</span>&nbsp;<span class="ident" id="4579384">indirect</span><span class="op" id="4579392">(</span><span class="ident" id="4579393">s</span><span class="op" id="4579394">.</span><span class="ident" id="4579395">evalPipeline</span><span class="op" id="4579407">(</span><span class="ident" id="4579408">dot</span><span class="op" id="4579411">,</span>&nbsp;<span class="ident" id="4579413">r</span><span class="op" id="4579414">.</span><span class="ident" id="4579415">Pipe</span><span class="op" id="4579419">)</span><span class="op" id="4579420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4579423">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579490">mark</span>&nbsp;<span class="op" id="4579495">:=</span>&nbsp;<span class="ident" id="4579498">s</span><span class="op" id="4579499">.</span><span class="ident" id="4579500">mark</span><span class="op" id="4579504">(</span><span class="op" id="4579505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579508">oneIteration</span>&nbsp;<span class="op" id="4579521">:=</span>&nbsp;<span class="keyword" id="4579524">func</span><span class="op" id="4579528">(</span><span class="ident" id="4579529">index</span><span class="op" id="4579534">,</span>&nbsp;<span class="ident" id="4579536">elem</span>&nbsp;<span class="ident" id="4579541">reflect</span><span class="op" id="4579548">.</span><span class="ident" id="4579549">Value</span><span class="op" id="4579554">)</span>&nbsp;<span class="op" id="4579556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4579560">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579633">if</span>&nbsp;<span class="builtinfunc" id="4579636">len</span><span class="op" id="4579639">(</span><span class="ident" id="4579640">r</span><span class="op" id="4579641">.</span><span class="ident" id="4579642">Pipe</span><span class="op" id="4579646">.</span><span class="ident" id="4579647">Decl</span><span class="op" id="4579651">)</span>&nbsp;<span class="op" id="4579653">&gt;</span>&nbsp;<span class="num" id="4579655">0</span>&nbsp;<span class="op" id="4579657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579662">s</span><span class="op" id="4579663">.</span><span class="ident" id="4579664">setVar</span><span class="op" id="4579670">(</span><span class="num" id="4579671">1</span><span class="op" id="4579672">,</span>&nbsp;<span class="ident" id="4579674">elem</span><span class="op" id="4579678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4579686">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579757">if</span>&nbsp;<span class="builtinfunc" id="4579760">len</span><span class="op" id="4579763">(</span><span class="ident" id="4579764">r</span><span class="op" id="4579765">.</span><span class="ident" id="4579766">Pipe</span><span class="op" id="4579770">.</span><span class="ident" id="4579771">Decl</span><span class="op" id="4579775">)</span>&nbsp;<span class="op" id="4579777">&gt;</span>&nbsp;<span class="num" id="4579779">1</span>&nbsp;<span class="op" id="4579781">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579786">s</span><span class="op" id="4579787">.</span><span class="ident" id="4579788">setVar</span><span class="op" id="4579794">(</span><span class="num" id="4579795">2</span><span class="op" id="4579796">,</span>&nbsp;<span class="ident" id="4579798">index</span><span class="op" id="4579803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579811">s</span><span class="op" id="4579812">.</span><span class="ident" id="4579813">walk</span><span class="op" id="4579817">(</span><span class="ident" id="4579818">elem</span><span class="op" id="4579822">,</span>&nbsp;<span class="ident" id="4579824">r</span><span class="op" id="4579825">.</span><span class="ident" id="4579826">List</span><span class="op" id="4579830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579834">s</span><span class="op" id="4579835">.</span><span class="ident" id="4579836">pop</span><span class="op" id="4579839">(</span><span class="ident" id="4579840">mark</span><span class="op" id="4579844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579847">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579850">switch</span>&nbsp;<span class="ident" id="4579857">val</span><span class="op" id="4579860">.</span><span class="ident" id="4579861">Kind</span><span class="op" id="4579865">(</span><span class="op" id="4579866">)</span>&nbsp;<span class="op" id="4579868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579871">case</span>&nbsp;<span class="ident" id="4579876">reflect</span><span class="op" id="4579883">.</span><span class="ident" id="4579884">Array</span><span class="op" id="4579889">,</span>&nbsp;<span class="ident" id="4579891">reflect</span><span class="op" id="4579898">.</span><span class="ident" id="4579899">Slice</span><span class="op" id="4579904">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579908">if</span>&nbsp;<span class="ident" id="4579911">val</span><span class="op" id="4579914">.</span><span class="ident" id="4579915">Len</span><span class="op" id="4579918">(</span><span class="op" id="4579919">)</span>&nbsp;<span class="op" id="4579921">==</span>&nbsp;<span class="num" id="4579924">0</span>&nbsp;<span class="op" id="4579926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579931">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579939">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579943">for</span>&nbsp;<span class="ident" id="4579947">i</span>&nbsp;<span class="op" id="4579949">:=</span>&nbsp;<span class="num" id="4579952">0</span><span class="op" id="4579953">;</span>&nbsp;<span class="ident" id="4579955">i</span>&nbsp;<span class="op" id="4579957">&lt;</span>&nbsp;<span class="ident" id="4579959">val</span><span class="op" id="4579962">.</span><span class="ident" id="4579963">Len</span><span class="op" id="4579966">(</span><span class="op" id="4579967">)</span><span class="op" id="4579968">;</span>&nbsp;<span class="ident" id="4579970">i</span><span class="op" id="4579971">++</span>&nbsp;<span class="op" id="4579974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579979">oneIteration</span><span class="op" id="4579991">(</span><span class="ident" id="4579992">reflect</span><span class="op" id="4579999">.</span><span class="ident" id="4580000">ValueOf</span><span class="op" id="4580007">(</span><span class="ident" id="4580008">i</span><span class="op" id="4580009">)</span><span class="op" id="4580010">,</span>&nbsp;<span class="ident" id="4580012">val</span><span class="op" id="4580015">.</span><span class="ident" id="4580016">Index</span><span class="op" id="4580021">(</span><span class="ident" id="4580022">i</span><span class="op" id="4580023">)</span><span class="op" id="4580024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580032">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580040">case</span>&nbsp;<span class="ident" id="4580045">reflect</span><span class="op" id="4580052">.</span><span class="ident" id="4580053">Map</span><span class="op" id="4580056">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580060">if</span>&nbsp;<span class="ident" id="4580063">val</span><span class="op" id="4580066">.</span><span class="ident" id="4580067">Len</span><span class="op" id="4580070">(</span><span class="op" id="4580071">)</span>&nbsp;<span class="op" id="4580073">==</span>&nbsp;<span class="num" id="4580076">0</span>&nbsp;<span class="op" id="4580078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580083">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580095">for</span>&nbsp;<span class="ident" id="4580099">_</span><span class="op" id="4580100">,</span>&nbsp;<span class="ident" id="4580102">key</span>&nbsp;<span class="op" id="4580106">:=</span>&nbsp;<span class="keyword" id="4580109">range</span>&nbsp;<span class="ident" id="4580115">sortKeys</span><span class="op" id="4580123">(</span><span class="ident" id="4580124">val</span><span class="op" id="4580127">.</span><span class="ident" id="4580128">MapKeys</span><span class="op" id="4580135">(</span><span class="op" id="4580136">)</span><span class="op" id="4580137">)</span>&nbsp;<span class="op" id="4580139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580144">oneIteration</span><span class="op" id="4580156">(</span><span class="ident" id="4580157">key</span><span class="op" id="4580160">,</span>&nbsp;<span class="ident" id="4580162">val</span><span class="op" id="4580165">.</span><span class="ident" id="4580166">MapIndex</span><span class="op" id="4580174">(</span><span class="ident" id="4580175">key</span><span class="op" id="4580178">)</span><span class="op" id="4580179">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580187">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580195">case</span>&nbsp;<span class="ident" id="4580200">reflect</span><span class="op" id="4580207">.</span><span class="ident" id="4580208">Chan</span><span class="op" id="4580212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580216">if</span>&nbsp;<span class="ident" id="4580219">val</span><span class="op" id="4580222">.</span><span class="ident" id="4580223">IsNil</span><span class="op" id="4580228">(</span><span class="op" id="4580229">)</span>&nbsp;<span class="op" id="4580231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580236">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580248">i</span>&nbsp;<span class="op" id="4580250">:=</span>&nbsp;<span class="num" id="4580253">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580257">for</span>&nbsp;<span class="op" id="4580261">;</span>&nbsp;<span class="op" id="4580263">;</span>&nbsp;<span class="ident" id="4580265">i</span><span class="op" id="4580266">++</span>&nbsp;<span class="op" id="4580269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580274">elem</span><span class="op" id="4580278">,</span>&nbsp;<span class="ident" id="4580280">ok</span>&nbsp;<span class="op" id="4580283">:=</span>&nbsp;<span class="ident" id="4580286">val</span><span class="op" id="4580289">.</span><span class="ident" id="4580290">Recv</span><span class="op" id="4580294">(</span><span class="op" id="4580295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580300">if</span>&nbsp;<span class="op" id="4580303">!</span><span class="ident" id="4580304">ok</span>&nbsp;<span class="op" id="4580307">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580313">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580327">oneIteration</span><span class="op" id="4580339">(</span><span class="ident" id="4580340">reflect</span><span class="op" id="4580347">.</span><span class="ident" id="4580348">ValueOf</span><span class="op" id="4580355">(</span><span class="ident" id="4580356">i</span><span class="op" id="4580357">)</span><span class="op" id="4580358">,</span>&nbsp;<span class="ident" id="4580360">elem</span><span class="op" id="4580364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580372">if</span>&nbsp;<span class="ident" id="4580375">i</span>&nbsp;<span class="op" id="4580377">==</span>&nbsp;<span class="num" id="4580380">0</span>&nbsp;<span class="op" id="4580382">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580387">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580399">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580407">case</span>&nbsp;<span class="ident" id="4580412">reflect</span><span class="op" id="4580419">.</span><span class="ident" id="4580420">Invalid</span><span class="op" id="4580427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580431">break</span>&nbsp;<span class="comment" id="4580437">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580512">default</span><span class="op" id="4580519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580523">s</span><span class="op" id="4580524">.</span><span class="ident" id="4580525">errorf</span><span class="op" id="4580531">(</span><span class="string" id="4580532">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="4580561">,</span>&nbsp;<span class="ident" id="4580563">val</span><span class="op" id="4580566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580572">if</span>&nbsp;<span class="ident" id="4580575">r</span><span class="op" id="4580576">.</span><span class="ident" id="4580577">ElseList</span>&nbsp;<span class="op" id="4580586">!=</span>&nbsp;<span class="builtintype" id="4580589">nil</span>&nbsp;<span class="op" id="4580593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580597">s</span><span class="op" id="4580598">.</span><span class="ident" id="4580599">walk</span><span class="op" id="4580603">(</span><span class="ident" id="4580604">dot</span><span class="op" id="4580607">,</span>&nbsp;<span class="ident" id="4580609">r</span><span class="op" id="4580610">.</span><span class="ident" id="4580611">ElseList</span><span class="op" id="4580619">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580622">}</span><br>
<span class="lineno"></span><span class="op" id="4580624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4580627">func</span>&nbsp;<span class="op" id="4580632">(</span><span class="ident" id="4580633">s</span>&nbsp;<span class="op" id="4580635">*</span><span class="ident" id="4580636">state</span><span class="op" id="4580641">)</span>&nbsp;<span class="ident" id="4580643">walkTemplate</span><span class="op" id="4580655">(</span><span class="ident" id="4580656">dot</span>&nbsp;<span class="ident" id="4580660">reflect</span><span class="op" id="4580667">.</span><span class="ident" id="4580668">Value</span><span class="op" id="4580673">,</span>&nbsp;<span class="ident" id="4580675">t</span>&nbsp;<span class="op" id="4580677">*</span><span class="ident" id="4580678">parse</span><span class="op" id="4580683">.</span><span class="ident" id="4580684">TemplateNode</span><span class="op" id="4580696">)</span>&nbsp;<span class="op" id="4580698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580701">s</span><span class="op" id="4580702">.</span><span class="ident" id="4580703">at</span><span class="op" id="4580705">(</span><span class="ident" id="4580706">t</span><span class="op" id="4580707">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580710">tmpl</span>&nbsp;<span class="op" id="4580715">:=</span>&nbsp;<span class="ident" id="4580718">s</span><span class="op" id="4580719">.</span><span class="ident" id="4580720">tmpl</span><span class="op" id="4580724">.</span><span class="ident" id="4580725">tmpl</span><span class="op" id="4580729">[</span><span class="ident" id="4580730">t</span><span class="op" id="4580731">.</span><span class="ident" id="4580732">Name</span><span class="op" id="4580736">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580739">if</span>&nbsp;<span class="ident" id="4580742">tmpl</span>&nbsp;<span class="op" id="4580747">==</span>&nbsp;<span class="builtintype" id="4580750">nil</span>&nbsp;<span class="op" id="4580754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580758">s</span><span class="op" id="4580759">.</span><span class="ident" id="4580760">errorf</span><span class="op" id="4580766">(</span><span class="string" id="4580767">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="4580792">,</span>&nbsp;<span class="ident" id="4580794">t</span><span class="op" id="4580795">.</span><span class="ident" id="4580796">Name</span><span class="op" id="4580800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4580806">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580854">dot</span>&nbsp;<span class="op" id="4580858">=</span>&nbsp;<span class="ident" id="4580860">s</span><span class="op" id="4580861">.</span><span class="ident" id="4580862">evalPipeline</span><span class="op" id="4580874">(</span><span class="ident" id="4580875">dot</span><span class="op" id="4580878">,</span>&nbsp;<span class="ident" id="4580880">t</span><span class="op" id="4580881">.</span><span class="ident" id="4580882">Pipe</span><span class="op" id="4580886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580889">newState</span>&nbsp;<span class="op" id="4580898">:=</span>&nbsp;<span class="op" id="4580901">*</span><span class="ident" id="4580902">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580905">newState</span><span class="op" id="4580913">.</span><span class="ident" id="4580914">tmpl</span>&nbsp;<span class="op" id="4580919">=</span>&nbsp;<span class="ident" id="4580921">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4580927">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580994">newState</span><span class="op" id="4581002">.</span><span class="ident" id="4581003">vars</span>&nbsp;<span class="op" id="4581008">=</span>&nbsp;<span class="op" id="4581010">[</span><span class="op" id="4581011">]</span><span class="ident" id="4581012">variable</span><span class="op" id="4581020">{</span><span class="op" id="4581021">{</span><span class="string" id="4581022">&#34;$&#34;</span><span class="op" id="4581025">,</span>&nbsp;<span class="ident" id="4581027">dot</span><span class="op" id="4581030">}</span><span class="op" id="4581031">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581034">newState</span><span class="op" id="4581042">.</span><span class="ident" id="4581043">walk</span><span class="op" id="4581047">(</span><span class="ident" id="4581048">dot</span><span class="op" id="4581051">,</span>&nbsp;<span class="ident" id="4581053">tmpl</span><span class="op" id="4581057">.</span><span class="ident" id="4581058">Root</span><span class="op" id="4581062">)</span><br>
<span class="lineno"></span><span class="op" id="4581064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4581067">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="4581146">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="4581229">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4581299">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4581375">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4581450">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="4581523">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4581578">func</span>&nbsp;<span class="op" id="4581583">(</span><span class="ident" id="4581584">s</span>&nbsp;<span class="op" id="4581586">*</span><span class="ident" id="4581587">state</span><span class="op" id="4581592">)</span>&nbsp;<span class="ident" id="4581594">evalPipeline</span><span class="op" id="4581606">(</span><span class="ident" id="4581607">dot</span>&nbsp;<span class="ident" id="4581611">reflect</span><span class="op" id="4581618">.</span><span class="ident" id="4581619">Value</span><span class="op" id="4581624">,</span>&nbsp;<span class="ident" id="4581626">pipe</span>&nbsp;<span class="op" id="4581631">*</span><span class="ident" id="4581632">parse</span><span class="op" id="4581637">.</span><span class="ident" id="4581638">PipeNode</span><span class="op" id="4581646">)</span>&nbsp;<span class="op" id="4581648">(</span><span class="ident" id="4581649">value</span>&nbsp;<span class="ident" id="4581655">reflect</span><span class="op" id="4581662">.</span><span class="ident" id="4581663">Value</span><span class="op" id="4581668">)</span>&nbsp;<span class="op" id="4581670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581673">if</span>&nbsp;<span class="ident" id="4581676">pipe</span>&nbsp;<span class="op" id="4581681">==</span>&nbsp;<span class="builtintype" id="4581684">nil</span>&nbsp;<span class="op" id="4581688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581692">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581700">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581703">s</span><span class="op" id="4581704">.</span><span class="ident" id="4581705">at</span><span class="op" id="4581707">(</span><span class="ident" id="4581708">pipe</span><span class="op" id="4581712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581715">for</span>&nbsp;<span class="ident" id="4581719">_</span><span class="op" id="4581720">,</span>&nbsp;<span class="ident" id="4581722">cmd</span>&nbsp;<span class="op" id="4581726">:=</span>&nbsp;<span class="keyword" id="4581729">range</span>&nbsp;<span class="ident" id="4581735">pipe</span><span class="op" id="4581739">.</span><span class="ident" id="4581740">Cmds</span>&nbsp;<span class="op" id="4581745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581749">value</span>&nbsp;<span class="op" id="4581755">=</span>&nbsp;<span class="ident" id="4581757">s</span><span class="op" id="4581758">.</span><span class="ident" id="4581759">evalCommand</span><span class="op" id="4581770">(</span><span class="ident" id="4581771">dot</span><span class="op" id="4581774">,</span>&nbsp;<span class="ident" id="4581776">cmd</span><span class="op" id="4581779">,</span>&nbsp;<span class="ident" id="4581781">value</span><span class="op" id="4581786">)</span>&nbsp;<span class="comment" id="4581788">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4581833">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581914">if</span>&nbsp;<span class="ident" id="4581917">value</span><span class="op" id="4581922">.</span><span class="ident" id="4581923">Kind</span><span class="op" id="4581927">(</span><span class="op" id="4581928">)</span>&nbsp;<span class="op" id="4581930">==</span>&nbsp;<span class="ident" id="4581933">reflect</span><span class="op" id="4581940">.</span><span class="ident" id="4581941">Interface</span>&nbsp;<span class="op" id="4581951">&amp;&amp;</span>&nbsp;<span class="ident" id="4581954">value</span><span class="op" id="4581959">.</span><span class="ident" id="4581960">Type</span><span class="op" id="4581964">(</span><span class="op" id="4581965">)</span><span class="op" id="4581966">.</span><span class="ident" id="4581967">NumMethod</span><span class="op" id="4581976">(</span><span class="op" id="4581977">)</span>&nbsp;<span class="op" id="4581979">==</span>&nbsp;<span class="num" id="4581982">0</span>&nbsp;<span class="op" id="4581984">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581989">value</span>&nbsp;<span class="op" id="4581995">=</span>&nbsp;<span class="ident" id="4581997">reflect</span><span class="op" id="4582004">.</span><span class="ident" id="4582005">ValueOf</span><span class="op" id="4582012">(</span><span class="ident" id="4582013">value</span><span class="op" id="4582018">.</span><span class="ident" id="4582019">Interface</span><span class="op" id="4582028">(</span><span class="op" id="4582029">)</span><span class="op" id="4582030">)</span>&nbsp;<span class="comment" id="4582032">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582051">for</span>&nbsp;<span class="ident" id="4582055">_</span><span class="op" id="4582056">,</span>&nbsp;<span class="ident" id="4582058">variable</span>&nbsp;<span class="op" id="4582067">:=</span>&nbsp;<span class="keyword" id="4582070">range</span>&nbsp;<span class="ident" id="4582076">pipe</span><span class="op" id="4582080">.</span><span class="ident" id="4582081">Decl</span>&nbsp;<span class="op" id="4582086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582090">s</span><span class="op" id="4582091">.</span><span class="ident" id="4582092">push</span><span class="op" id="4582096">(</span><span class="ident" id="4582097">variable</span><span class="op" id="4582105">.</span><span class="ident" id="4582106">Ident</span><span class="op" id="4582111">[</span><span class="num" id="4582112">0</span><span class="op" id="4582113">]</span><span class="op" id="4582114">,</span>&nbsp;<span class="ident" id="4582116">value</span><span class="op" id="4582121">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582127">return</span>&nbsp;<span class="ident" id="4582134">value</span><br>
<span class="lineno"></span><span class="op" id="4582140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4582143">func</span>&nbsp;<span class="op" id="4582148">(</span><span class="ident" id="4582149">s</span>&nbsp;<span class="op" id="4582151">*</span><span class="ident" id="4582152">state</span><span class="op" id="4582157">)</span>&nbsp;<span class="ident" id="4582159">notAFunction</span><span class="op" id="4582171">(</span><span class="ident" id="4582172">args</span>&nbsp;<span class="op" id="4582177">[</span><span class="op" id="4582178">]</span><span class="ident" id="4582179">parse</span><span class="op" id="4582184">.</span><span class="ident" id="4582185">Node</span><span class="op" id="4582189">,</span>&nbsp;<span class="ident" id="4582191">final</span>&nbsp;<span class="ident" id="4582197">reflect</span><span class="op" id="4582204">.</span><span class="ident" id="4582205">Value</span><span class="op" id="4582210">)</span>&nbsp;<span class="op" id="4582212">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582215">if</span>&nbsp;<span class="builtinfunc" id="4582218">len</span><span class="op" id="4582221">(</span><span class="ident" id="4582222">args</span><span class="op" id="4582226">)</span>&nbsp;<span class="op" id="4582228">&gt;</span>&nbsp;<span class="num" id="4582230">1</span>&nbsp;<span class="op" id="4582232">||</span>&nbsp;<span class="ident" id="4582235">final</span><span class="op" id="4582240">.</span><span class="ident" id="4582241">IsValid</span><span class="op" id="4582248">(</span><span class="op" id="4582249">)</span>&nbsp;<span class="op" id="4582251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582255">s</span><span class="op" id="4582256">.</span><span class="ident" id="4582257">errorf</span><span class="op" id="4582263">(</span><span class="string" id="4582264">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="4582304">,</span>&nbsp;<span class="ident" id="4582306">args</span><span class="op" id="4582310">[</span><span class="num" id="4582311">0</span><span class="op" id="4582312">]</span><span class="op" id="4582313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582316">}</span><br>
<span class="lineno"></span><span class="op" id="4582318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4582321">func</span>&nbsp;<span class="op" id="4582326">(</span><span class="ident" id="4582327">s</span>&nbsp;<span class="op" id="4582329">*</span><span class="ident" id="4582330">state</span><span class="op" id="4582335">)</span>&nbsp;<span class="ident" id="4582337">evalCommand</span><span class="op" id="4582348">(</span><span class="ident" id="4582349">dot</span>&nbsp;<span class="ident" id="4582353">reflect</span><span class="op" id="4582360">.</span><span class="ident" id="4582361">Value</span><span class="op" id="4582366">,</span>&nbsp;<span class="ident" id="4582368">cmd</span>&nbsp;<span class="op" id="4582372">*</span><span class="ident" id="4582373">parse</span><span class="op" id="4582378">.</span><span class="ident" id="4582379">CommandNode</span><span class="op" id="4582390">,</span>&nbsp;<span class="ident" id="4582392">final</span>&nbsp;<span class="ident" id="4582398">reflect</span><span class="op" id="4582405">.</span><span class="ident" id="4582406">Value</span><span class="op" id="4582411">)</span>&nbsp;<span class="ident" id="4582413">reflect</span><span class="op" id="4582420">.</span><span class="ident" id="4582421">Value</span>&nbsp;<span class="op" id="4582427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582430">firstWord</span>&nbsp;<span class="op" id="4582440">:=</span>&nbsp;<span class="ident" id="4582443">cmd</span><span class="op" id="4582446">.</span><span class="ident" id="4582447">Args</span><span class="op" id="4582451">[</span><span class="num" id="4582452">0</span><span class="op" id="4582453">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582456">switch</span>&nbsp;<span class="ident" id="4582463">n</span>&nbsp;<span class="op" id="4582465">:=</span>&nbsp;<span class="ident" id="4582468">firstWord</span><span class="op" id="4582477">.</span><span class="op" id="4582478">(</span><span class="keyword" id="4582479">type</span><span class="op" id="4582483">)</span>&nbsp;<span class="op" id="4582485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582488">case</span>&nbsp;<span class="op" id="4582493">*</span><span class="ident" id="4582494">parse</span><span class="op" id="4582499">.</span><span class="ident" id="4582500">FieldNode</span><span class="op" id="4582509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582513">return</span>&nbsp;<span class="ident" id="4582520">s</span><span class="op" id="4582521">.</span><span class="ident" id="4582522">evalFieldNode</span><span class="op" id="4582535">(</span><span class="ident" id="4582536">dot</span><span class="op" id="4582539">,</span>&nbsp;<span class="ident" id="4582541">n</span><span class="op" id="4582542">,</span>&nbsp;<span class="ident" id="4582544">cmd</span><span class="op" id="4582547">.</span><span class="ident" id="4582548">Args</span><span class="op" id="4582552">,</span>&nbsp;<span class="ident" id="4582554">final</span><span class="op" id="4582559">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582562">case</span>&nbsp;<span class="op" id="4582567">*</span><span class="ident" id="4582568">parse</span><span class="op" id="4582573">.</span><span class="ident" id="4582574">ChainNode</span><span class="op" id="4582583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582587">return</span>&nbsp;<span class="ident" id="4582594">s</span><span class="op" id="4582595">.</span><span class="ident" id="4582596">evalChainNode</span><span class="op" id="4582609">(</span><span class="ident" id="4582610">dot</span><span class="op" id="4582613">,</span>&nbsp;<span class="ident" id="4582615">n</span><span class="op" id="4582616">,</span>&nbsp;<span class="ident" id="4582618">cmd</span><span class="op" id="4582621">.</span><span class="ident" id="4582622">Args</span><span class="op" id="4582626">,</span>&nbsp;<span class="ident" id="4582628">final</span><span class="op" id="4582633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582636">case</span>&nbsp;<span class="op" id="4582641">*</span><span class="ident" id="4582642">parse</span><span class="op" id="4582647">.</span><span class="ident" id="4582648">IdentifierNode</span><span class="op" id="4582662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4582666">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582691">return</span>&nbsp;<span class="ident" id="4582698">s</span><span class="op" id="4582699">.</span><span class="ident" id="4582700">evalFunction</span><span class="op" id="4582712">(</span><span class="ident" id="4582713">dot</span><span class="op" id="4582716">,</span>&nbsp;<span class="ident" id="4582718">n</span><span class="op" id="4582719">,</span>&nbsp;<span class="ident" id="4582721">cmd</span><span class="op" id="4582724">,</span>&nbsp;<span class="ident" id="4582726">cmd</span><span class="op" id="4582729">.</span><span class="ident" id="4582730">Args</span><span class="op" id="4582734">,</span>&nbsp;<span class="ident" id="4582736">final</span><span class="op" id="4582741">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582744">case</span>&nbsp;<span class="op" id="4582749">*</span><span class="ident" id="4582750">parse</span><span class="op" id="4582755">.</span><span class="ident" id="4582756">PipeNode</span><span class="op" id="4582764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4582768">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582858">return</span>&nbsp;<span class="ident" id="4582865">s</span><span class="op" id="4582866">.</span><span class="ident" id="4582867">evalPipeline</span><span class="op" id="4582879">(</span><span class="ident" id="4582880">dot</span><span class="op" id="4582883">,</span>&nbsp;<span class="ident" id="4582885">n</span><span class="op" id="4582886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582889">case</span>&nbsp;<span class="op" id="4582894">*</span><span class="ident" id="4582895">parse</span><span class="op" id="4582900">.</span><span class="ident" id="4582901">VariableNode</span><span class="op" id="4582913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582917">return</span>&nbsp;<span class="ident" id="4582924">s</span><span class="op" id="4582925">.</span><span class="ident" id="4582926">evalVariableNode</span><span class="op" id="4582942">(</span><span class="ident" id="4582943">dot</span><span class="op" id="4582946">,</span>&nbsp;<span class="ident" id="4582948">n</span><span class="op" id="4582949">,</span>&nbsp;<span class="ident" id="4582951">cmd</span><span class="op" id="4582954">.</span><span class="ident" id="4582955">Args</span><span class="op" id="4582959">,</span>&nbsp;<span class="ident" id="4582961">final</span><span class="op" id="4582966">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582972">s</span><span class="op" id="4582973">.</span><span class="ident" id="4582974">at</span><span class="op" id="4582976">(</span><span class="ident" id="4582977">firstWord</span><span class="op" id="4582986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582989">s</span><span class="op" id="4582990">.</span><span class="ident" id="4582991">notAFunction</span><span class="op" id="4583003">(</span><span class="ident" id="4583004">cmd</span><span class="op" id="4583007">.</span><span class="ident" id="4583008">Args</span><span class="op" id="4583012">,</span>&nbsp;<span class="ident" id="4583014">final</span><span class="op" id="4583019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583022">switch</span>&nbsp;<span class="ident" id="4583029">word</span>&nbsp;<span class="op" id="4583034">:=</span>&nbsp;<span class="ident" id="4583037">firstWord</span><span class="op" id="4583046">.</span><span class="op" id="4583047">(</span><span class="keyword" id="4583048">type</span><span class="op" id="4583052">)</span>&nbsp;<span class="op" id="4583054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583057">case</span>&nbsp;<span class="op" id="4583062">*</span><span class="ident" id="4583063">parse</span><span class="op" id="4583068">.</span><span class="ident" id="4583069">BoolNode</span><span class="op" id="4583077">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583081">return</span>&nbsp;<span class="ident" id="4583088">reflect</span><span class="op" id="4583095">.</span><span class="ident" id="4583096">ValueOf</span><span class="op" id="4583103">(</span><span class="ident" id="4583104">word</span><span class="op" id="4583108">.</span><span class="ident" id="4583109">True</span><span class="op" id="4583113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583116">case</span>&nbsp;<span class="op" id="4583121">*</span><span class="ident" id="4583122">parse</span><span class="op" id="4583127">.</span><span class="ident" id="4583128">DotNode</span><span class="op" id="4583135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583139">return</span>&nbsp;<span class="ident" id="4583146">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583151">case</span>&nbsp;<span class="op" id="4583156">*</span><span class="ident" id="4583157">parse</span><span class="op" id="4583162">.</span><span class="ident" id="4583163">NilNode</span><span class="op" id="4583170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583174">s</span><span class="op" id="4583175">.</span><span class="ident" id="4583176">errorf</span><span class="op" id="4583182">(</span><span class="string" id="4583183">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="4583205">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583208">case</span>&nbsp;<span class="op" id="4583213">*</span><span class="ident" id="4583214">parse</span><span class="op" id="4583219">.</span><span class="ident" id="4583220">NumberNode</span><span class="op" id="4583230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583234">return</span>&nbsp;<span class="ident" id="4583241">s</span><span class="op" id="4583242">.</span><span class="ident" id="4583243">idealConstant</span><span class="op" id="4583256">(</span><span class="ident" id="4583257">word</span><span class="op" id="4583261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583264">case</span>&nbsp;<span class="op" id="4583269">*</span><span class="ident" id="4583270">parse</span><span class="op" id="4583275">.</span><span class="ident" id="4583276">StringNode</span><span class="op" id="4583286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583290">return</span>&nbsp;<span class="ident" id="4583297">reflect</span><span class="op" id="4583304">.</span><span class="ident" id="4583305">ValueOf</span><span class="op" id="4583312">(</span><span class="ident" id="4583313">word</span><span class="op" id="4583317">.</span><span class="ident" id="4583318">Text</span><span class="op" id="4583322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4583325">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583328">s</span><span class="op" id="4583329">.</span><span class="ident" id="4583330">errorf</span><span class="op" id="4583336">(</span><span class="string" id="4583337">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="4583364">,</span>&nbsp;<span class="ident" id="4583366">firstWord</span><span class="op" id="4583375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4583378">panic</span><span class="op" id="4583383">(</span><span class="string" id="4583384">&#34;not&nbsp;reached&#34;</span><span class="op" id="4583397">)</span><br>
<span class="lineno"></span><span class="op" id="4583399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4583402">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="4583480">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="4583555">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4583632">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4583708">func</span>&nbsp;<span class="op" id="4583713">(</span><span class="ident" id="4583714">s</span>&nbsp;<span class="op" id="4583716">*</span><span class="ident" id="4583717">state</span><span class="op" id="4583722">)</span>&nbsp;<span class="ident" id="4583724">idealConstant</span><span class="op" id="4583737">(</span><span class="ident" id="4583738">constant</span>&nbsp;<span class="op" id="4583747">*</span><span class="ident" id="4583748">parse</span><span class="op" id="4583753">.</span><span class="ident" id="4583754">NumberNode</span><span class="op" id="4583764">)</span>&nbsp;<span class="ident" id="4583766">reflect</span><span class="op" id="4583773">.</span><span class="ident" id="4583774">Value</span>&nbsp;<span class="op" id="4583780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4583783">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4583840">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4583899">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583965">s</span><span class="op" id="4583966">.</span><span class="ident" id="4583967">at</span><span class="op" id="4583969">(</span><span class="ident" id="4583970">constant</span><span class="op" id="4583978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583981">switch</span>&nbsp;<span class="op" id="4583988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583991">case</span>&nbsp;<span class="ident" id="4583996">constant</span><span class="op" id="4584004">.</span><span class="ident" id="4584005">IsComplex</span><span class="op" id="4584014">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584018">return</span>&nbsp;<span class="ident" id="4584025">reflect</span><span class="op" id="4584032">.</span><span class="ident" id="4584033">ValueOf</span><span class="op" id="4584040">(</span><span class="ident" id="4584041">constant</span><span class="op" id="4584049">.</span><span class="ident" id="4584050">Complex128</span><span class="op" id="4584060">)</span>&nbsp;<span class="comment" id="4584062">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584084">case</span>&nbsp;<span class="ident" id="4584089">constant</span><span class="op" id="4584097">.</span><span class="ident" id="4584098">IsFloat</span>&nbsp;<span class="op" id="4584106">&amp;&amp;</span>&nbsp;<span class="op" id="4584109">!</span><span class="ident" id="4584110">isHexConstant</span><span class="op" id="4584123">(</span><span class="ident" id="4584124">constant</span><span class="op" id="4584132">.</span><span class="ident" id="4584133">Text</span><span class="op" id="4584137">)</span>&nbsp;<span class="op" id="4584139">&amp;&amp;</span>&nbsp;<span class="ident" id="4584142">strings</span><span class="op" id="4584149">.</span><span class="ident" id="4584150">IndexAny</span><span class="op" id="4584158">(</span><span class="ident" id="4584159">constant</span><span class="op" id="4584167">.</span><span class="ident" id="4584168">Text</span><span class="op" id="4584172">,</span>&nbsp;<span class="string" id="4584174">&#34;.eE&#34;</span><span class="op" id="4584179">)</span>&nbsp;<span class="op" id="4584181">&gt;=</span>&nbsp;<span class="num" id="4584184">0</span><span class="op" id="4584185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584189">return</span>&nbsp;<span class="ident" id="4584196">reflect</span><span class="op" id="4584203">.</span><span class="ident" id="4584204">ValueOf</span><span class="op" id="4584211">(</span><span class="ident" id="4584212">constant</span><span class="op" id="4584220">.</span><span class="ident" id="4584221">Float64</span><span class="op" id="4584228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584231">case</span>&nbsp;<span class="ident" id="4584236">constant</span><span class="op" id="4584244">.</span><span class="ident" id="4584245">IsInt</span><span class="op" id="4584250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584254">n</span>&nbsp;<span class="op" id="4584256">:=</span>&nbsp;<span class="builtintype" id="4584259">int</span><span class="op" id="4584262">(</span><span class="ident" id="4584263">constant</span><span class="op" id="4584271">.</span><span class="ident" id="4584272">Int64</span><span class="op" id="4584277">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584281">if</span>&nbsp;<span class="ident" id="4584284">int64</span><span class="op" id="4584289">(</span><span class="ident" id="4584290">n</span><span class="op" id="4584291">)</span>&nbsp;<span class="op" id="4584293">!=</span>&nbsp;<span class="ident" id="4584296">constant</span><span class="op" id="4584304">.</span><span class="ident" id="4584305">Int64</span>&nbsp;<span class="op" id="4584311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584316">s</span><span class="op" id="4584317">.</span><span class="ident" id="4584318">errorf</span><span class="op" id="4584324">(</span><span class="string" id="4584325">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="4584343">,</span>&nbsp;<span class="ident" id="4584345">constant</span><span class="op" id="4584353">.</span><span class="ident" id="4584354">Text</span><span class="op" id="4584358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4584362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584366">return</span>&nbsp;<span class="ident" id="4584373">reflect</span><span class="op" id="4584380">.</span><span class="ident" id="4584381">ValueOf</span><span class="op" id="4584388">(</span><span class="ident" id="4584389">n</span><span class="op" id="4584390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584393">case</span>&nbsp;<span class="ident" id="4584398">constant</span><span class="op" id="4584406">.</span><span class="ident" id="4584407">IsUint</span><span class="op" id="4584413">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584417">s</span><span class="op" id="4584418">.</span><span class="ident" id="4584419">errorf</span><span class="op" id="4584425">(</span><span class="string" id="4584426">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="4584444">,</span>&nbsp;<span class="ident" id="4584446">constant</span><span class="op" id="4584454">.</span><span class="ident" id="4584455">Text</span><span class="op" id="4584459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4584462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584465">return</span>&nbsp;<span class="ident" id="4584472">zero</span><br>
<span class="lineno"></span><span class="op" id="4584477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="4584480">func</span>&nbsp;<span class="ident" id="4584485">isHexConstant</span><span class="op" id="4584498">(</span><span class="ident" id="4584499">s</span>&nbsp;<span class="builtintype" id="4584501">string</span><span class="op" id="4584507">)</span>&nbsp;<span class="builtintype" id="4584509">bool</span>&nbsp;<span class="op" id="4584514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584517">return</span>&nbsp;<span class="builtinfunc" id="4584524">len</span><span class="op" id="4584527">(</span><span class="ident" id="4584528">s</span><span class="op" id="4584529">)</span>&nbsp;<span class="op" id="4584531">&gt;</span>&nbsp;<span class="num" id="4584533">2</span>&nbsp;<span class="op" id="4584535">&amp;&amp;</span>&nbsp;<span class="ident" id="4584538">s</span><span class="op" id="4584539">[</span><span class="num" id="4584540">0</span><span class="op" id="4584541">]</span>&nbsp;<span class="op" id="4584543">==</span>&nbsp;<span class="string" id="4584546">&#39;0&#39;</span>&nbsp;<span class="op" id="4584550">&amp;&amp;</span>&nbsp;<span class="op" id="4584553">(</span><span class="ident" id="4584554">s</span><span class="op" id="4584555">[</span><span class="num" id="4584556">1</span><span class="op" id="4584557">]</span>&nbsp;<span class="op" id="4584559">==</span>&nbsp;<span class="string" id="4584562">&#39;x&#39;</span>&nbsp;<span class="op" id="4584566">||</span>&nbsp;<span class="ident" id="4584569">s</span><span class="op" id="4584570">[</span><span class="num" id="4584571">1</span><span class="op" id="4584572">]</span>&nbsp;<span class="op" id="4584574">==</span>&nbsp;<span class="string" id="4584577">&#39;X&#39;</span><span class="op" id="4584580">)</span><br>
<span class="lineno"></span><span class="op" id="4584582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4584585">func</span>&nbsp;<span class="op" id="4584590">(</span><span class="ident" id="4584591">s</span>&nbsp;<span class="op" id="4584593">*</span><span class="ident" id="4584594">state</span><span class="op" id="4584599">)</span>&nbsp;<span class="ident" id="4584601">evalFieldNode</span><span class="op" id="4584614">(</span><span class="ident" id="4584615">dot</span>&nbsp;<span class="ident" id="4584619">reflect</span><span class="op" id="4584626">.</span><span class="ident" id="4584627">Value</span><span class="op" id="4584632">,</span>&nbsp;<span class="ident" id="4584634">field</span>&nbsp;<span class="op" id="4584640">*</span><span class="ident" id="4584641">parse</span><span class="op" id="4584646">.</span><span class="ident" id="4584647">FieldNode</span><span class="op" id="4584656">,</span>&nbsp;<span class="ident" id="4584658">args</span>&nbsp;<span class="op" id="4584663">[</span><span class="op" id="4584664">]</span><span class="ident" id="4584665">parse</span><span class="op" id="4584670">.</span><span class="ident" id="4584671">Node</span><span class="op" id="4584675">,</span>&nbsp;<span class="ident" id="4584677">final</span>&nbsp;<span class="ident" id="4584683">reflect</span><span class="op" id="4584690">.</span><span class="ident" id="4584691">Value</span><span class="op" id="4584696">)</span>&nbsp;<span class="ident" id="4584698">reflect</span><span class="op" id="4584705">.</span><span class="ident" id="4584706">Value</span>&nbsp;<span class="op" id="4584712">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584715">s</span><span class="op" id="4584716">.</span><span class="ident" id="4584717">at</span><span class="op" id="4584719">(</span><span class="ident" id="4584720">field</span><span class="op" id="4584725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4584728">return</span>&nbsp;<span class="ident" id="4584735">s</span><span class="op" id="4584736">.</span><span class="ident" id="4584737">evalFieldChain</span><span class="op" id="4584751">(</span><span class="ident" id="4584752">dot</span><span class="op" id="4584755">,</span>&nbsp;<span class="ident" id="4584757">dot</span><span class="op" id="4584760">,</span>&nbsp;<span class="ident" id="4584762">field</span><span class="op" id="4584767">,</span>&nbsp;<span class="ident" id="4584769">field</span><span class="op" id="4584774">.</span><span class="ident" id="4584775">Ident</span><span class="op" id="4584780">,</span>&nbsp;<span class="ident" id="4584782">args</span><span class="op" id="4584786">,</span>&nbsp;<span class="ident" id="4584788">final</span><span class="op" id="4584793">)</span><br>
<span class="lineno"></span><span class="op" id="4584795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4584798">func</span>&nbsp;<span class="op" id="4584803">(</span><span class="ident" id="4584804">s</span>&nbsp;<span class="op" id="4584806">*</span><span class="ident" id="4584807">state</span><span class="op" id="4584812">)</span>&nbsp;<span class="ident" id="4584814">evalChainNode</span><span class="op" id="4584827">(</span><span class="ident" id="4584828">dot</span>&nbsp;<span class="ident" id="4584832">reflect</span><span class="op" id="4584839">.</span><span class="ident" id="4584840">Value</span><span class="op" id="4584845">,</span>&nbsp;<span class="ident" id="4584847">chain</span>&nbsp;<span class="op" id="4584853">*</span><span class="ident" id="4584854">parse</span><span class="op" id="4584859">.</span><span class="ident" id="4584860">ChainNode</span><span class="op" id="4584869">,</span>&nbsp;<span class="ident" id="4584871">args</span>&nbsp;<span class="op" id="4584876">[</span><span class="op" id="4584877">]</span><span class="ident" id="4584878">parse</span><span class="op" id="4584883">.</span><span class="ident" id="4584884">Node</span><span class="op" id="4584888">,</span>&nbsp;<span class="ident" id="4584890">final</span>&nbsp;<span class="ident" id="4584896">reflect</span><span class="op" id="4584903">.</span><span class="ident" id="4584904">Value</span><span class="op" id="4584909">)</span>&nbsp;<span class="ident" id="4584911">reflect</span><span class="op" id="4584918">.</span><span class="ident" id="4584919">Value</span>&nbsp;<span class="op" id="4584925">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4584928">s</span><span class="op" id="4584929">.</span><span class="ident" id="4584930">at</span><span class="op" id="4584932">(</span><span class="ident" id="4584933">chain</span><span class="op" id="4584938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4584941">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585039">pipe</span>&nbsp;<span class="op" id="4585044">:=</span>&nbsp;<span class="ident" id="4585047">s</span><span class="op" id="4585048">.</span><span class="ident" id="4585049">evalArg</span><span class="op" id="4585056">(</span><span class="ident" id="4585057">dot</span><span class="op" id="4585060">,</span>&nbsp;<span class="builtintype" id="4585062">nil</span><span class="op" id="4585065">,</span>&nbsp;<span class="ident" id="4585067">chain</span><span class="op" id="4585072">.</span><span class="ident" id="4585073">Node</span><span class="op" id="4585077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585080">if</span>&nbsp;<span class="builtinfunc" id="4585083">len</span><span class="op" id="4585086">(</span><span class="ident" id="4585087">chain</span><span class="op" id="4585092">.</span><span class="ident" id="4585093">Field</span><span class="op" id="4585098">)</span>&nbsp;<span class="op" id="4585100">==</span>&nbsp;<span class="num" id="4585103">0</span>&nbsp;<span class="op" id="4585105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585109">s</span><span class="op" id="4585110">.</span><span class="ident" id="4585111">errorf</span><span class="op" id="4585117">(</span><span class="string" id="4585118">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="4585162">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585168">return</span>&nbsp;<span class="ident" id="4585175">s</span><span class="op" id="4585176">.</span><span class="ident" id="4585177">evalFieldChain</span><span class="op" id="4585191">(</span><span class="ident" id="4585192">dot</span><span class="op" id="4585195">,</span>&nbsp;<span class="ident" id="4585197">pipe</span><span class="op" id="4585201">,</span>&nbsp;<span class="ident" id="4585203">chain</span><span class="op" id="4585208">,</span>&nbsp;<span class="ident" id="4585210">chain</span><span class="op" id="4585215">.</span><span class="ident" id="4585216">Field</span><span class="op" id="4585221">,</span>&nbsp;<span class="ident" id="4585223">args</span><span class="op" id="4585227">,</span>&nbsp;<span class="ident" id="4585229">final</span><span class="op" id="4585234">)</span><br>
<span class="lineno"></span><span class="op" id="4585236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4585239">func</span>&nbsp;<span class="op" id="4585244">(</span><span class="ident" id="4585245">s</span>&nbsp;<span class="op" id="4585247">*</span><span class="ident" id="4585248">state</span><span class="op" id="4585253">)</span>&nbsp;<span class="ident" id="4585255">evalVariableNode</span><span class="op" id="4585271">(</span><span class="ident" id="4585272">dot</span>&nbsp;<span class="ident" id="4585276">reflect</span><span class="op" id="4585283">.</span><span class="ident" id="4585284">Value</span><span class="op" id="4585289">,</span>&nbsp;<span class="ident" id="4585291">variable</span>&nbsp;<span class="op" id="4585300">*</span><span class="ident" id="4585301">parse</span><span class="op" id="4585306">.</span><span class="ident" id="4585307">VariableNode</span><span class="op" id="4585319">,</span>&nbsp;<span class="ident" id="4585321">args</span>&nbsp;<span class="op" id="4585326">[</span><span class="op" id="4585327">]</span><span class="ident" id="4585328">parse</span><span class="op" id="4585333">.</span><span class="ident" id="4585334">Node</span><span class="op" id="4585338">,</span>&nbsp;<span class="ident" id="4585340">final</span>&nbsp;<span class="ident" id="4585346">reflect</span><span class="op" id="4585353">.</span><span class="ident" id="4585354">Value</span><span class="op" id="4585359">)</span>&nbsp;<span class="ident" id="4585361">reflect</span><span class="op" id="4585368">.</span><span class="ident" id="4585369">Value</span>&nbsp;<span class="op" id="4585375">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4585378">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585470">s</span><span class="op" id="4585471">.</span><span class="ident" id="4585472">at</span><span class="op" id="4585474">(</span><span class="ident" id="4585475">variable</span><span class="op" id="4585483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585486">value</span>&nbsp;<span class="op" id="4585492">:=</span>&nbsp;<span class="ident" id="4585495">s</span><span class="op" id="4585496">.</span><span class="ident" id="4585497">varValue</span><span class="op" id="4585505">(</span><span class="ident" id="4585506">variable</span><span class="op" id="4585514">.</span><span class="ident" id="4585515">Ident</span><span class="op" id="4585520">[</span><span class="num" id="4585521">0</span><span class="op" id="4585522">]</span><span class="op" id="4585523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585526">if</span>&nbsp;<span class="builtinfunc" id="4585529">len</span><span class="op" id="4585532">(</span><span class="ident" id="4585533">variable</span><span class="op" id="4585541">.</span><span class="ident" id="4585542">Ident</span><span class="op" id="4585547">)</span>&nbsp;<span class="op" id="4585549">==</span>&nbsp;<span class="num" id="4585552">1</span>&nbsp;<span class="op" id="4585554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4585558">s</span><span class="op" id="4585559">.</span><span class="ident" id="4585560">notAFunction</span><span class="op" id="4585572">(</span><span class="ident" id="4585573">args</span><span class="op" id="4585577">,</span>&nbsp;<span class="ident" id="4585579">final</span><span class="op" id="4585584">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585588">return</span>&nbsp;<span class="ident" id="4585595">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4585605">return</span>&nbsp;<span class="ident" id="4585612">s</span><span class="op" id="4585613">.</span><span class="ident" id="4585614">evalFieldChain</span><span class="op" id="4585628">(</span><span class="ident" id="4585629">dot</span><span class="op" id="4585632">,</span>&nbsp;<span class="ident" id="4585634">value</span><span class="op" id="4585639">,</span>&nbsp;<span class="ident" id="4585641">variable</span><span class="op" id="4585649">,</span>&nbsp;<span class="ident" id="4585651">variable</span><span class="op" id="4585659">.</span><span class="ident" id="4585660">Ident</span><span class="op" id="4585665">[</span><span class="num" id="4585666">1</span><span class="op" id="4585667">:</span><span class="op" id="4585668">]</span><span class="op" id="4585669">,</span>&nbsp;<span class="ident" id="4585671">args</span><span class="op" id="4585675">,</span>&nbsp;<span class="ident" id="4585677">final</span><span class="op" id="4585682">)</span><br>
<span class="lineno"></span><span class="op" id="4585684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="4585687">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="4585754">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="4585818">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="4585873">func</span>&nbsp;<span class="op" id="4585878">(</span><span class="ident" id="4585879">s</span>&nbsp;<span class="op" id="4585881">*</span><span class="ident" id="4585882">state</span><span class="op" id="4585887">)</span>&nbsp;<span class="ident" id="4585889">evalFieldChain</span><span class="op" id="4585903">(</span><span class="ident" id="4585904">dot</span><span class="op" id="4585907">,</span>&nbsp;<span class="ident" id="4585909">receiver</span>&nbsp;<span class="ident" id="4585918">reflect</span><span class="op" id="4585925">.</span><span class="ident" id="4585926">Value</span><span class="op" id="4585931">,</span>&nbsp;<span class="ident" id="4585933">node</span>&nbsp;<span class="ident" id="4585938">parse</span><span class="op" id="4585943">.</span><span class="ident" id="4585944">Node</span><span class="op" id="4585948">,</span>&nbsp;<span class="ident" id="4585950">ident</span>&nbsp;<span class="op" id="4585956">[</span><span class="op" id="4585957">]</span><span class="builtintype" id="4585958">string</span><span class="op" id="4585964">,</span>&nbsp;<span class="ident" id="4585966">args</span>&nbsp;<span class="op" id="4585971">[</span><span class="op" id="4585972">]</span><span class="ident" id="4585973">parse</span><span class="op" id="4585978">.</span><span class="ident" id="4585979">Node</span><span class="op" id="4585983">,</span>&nbsp;<span class="ident" id="4585985">final</span>&nbsp;<span class="ident" id="4585991">reflect</span><span class="op" id="4585998">.</span><span class="ident" id="4585999">Value</span><span class="op" id="4586004">)</span>&nbsp;<span class="ident" id="4586006">reflect</span><span class="op" id="4586013">.</span><span class="ident" id="4586014">Value</span>&nbsp;<span class="op" id="4586020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586023">n</span>&nbsp;<span class="op" id="4586025">:=</span>&nbsp;<span class="builtinfunc" id="4586028">len</span><span class="op" id="4586031">(</span><span class="ident" id="4586032">ident</span><span class="op" id="4586037">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4586040">for</span>&nbsp;<span class="ident" id="4586044">i</span>&nbsp;<span class="op" id="4586046">:=</span>&nbsp;<span class="num" id="4586049">0</span><span class="op" id="4586050">;</span>&nbsp;<span class="ident" id="4586052">i</span>&nbsp;<span class="op" id="4586054">&lt;</span>&nbsp;<span class="ident" id="4586056">n</span><span class="op" id="4586057">-</span><span class="num" id="4586058">1</span><span class="op" id="4586059">;</span>&nbsp;<span class="ident" id="4586061">i</span><span class="op" id="4586062">++</span>&nbsp;<span class="op" id="4586065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586069">receiver</span>&nbsp;<span class="op" id="4586078">=</span>&nbsp;<span class="ident" id="4586080">s</span><span class="op" id="4586081">.</span><span class="ident" id="4586082">evalField</span><span class="op" id="4586091">(</span><span class="ident" id="4586092">dot</span><span class="op" id="4586095">,</span>&nbsp;<span class="ident" id="4586097">ident</span><span class="op" id="4586102">[</span><span class="ident" id="4586103">i</span><span class="op" id="4586104">]</span><span class="op" id="4586105">,</span>&nbsp;<span class="ident" id="4586107">node</span><span class="op" id="4586111">,</span>&nbsp;<span class="builtintype" id="4586113">nil</span><span class="op" id="4586116">,</span>&nbsp;<span class="ident" id="4586118">zero</span><span class="op" id="4586122">,</span>&nbsp;<span class="ident" id="4586124">receiver</span><span class="op" id="4586132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4586135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4586138">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4586187">return</span>&nbsp;<span class="ident" id="4586194">s</span><span class="op" id="4586195">.</span><span class="ident" id="4586196">evalField</span><span class="op" id="4586205">(</span><span class="ident" id="4586206">dot</span><span class="op" id="4586209">,</span>&nbsp;<span class="ident" id="4586211">ident</span><span class="op" id="4586216">[</span><span class="ident" id="4586217">n</span><span class="op" id="4586218">-</span><span class="num" id="4586219">1</span><span class="op" id="4586220">]</span><span class="op" id="4586221">,</span>&nbsp;<span class="ident" id="4586223">node</span><span class="op" id="4586227">,</span>&nbsp;<span class="ident" id="4586229">args</span><span class="op" id="4586233">,</span>&nbsp;<span class="ident" id="4586235">final</span><span class="op" id="4586240">,</span>&nbsp;<span class="ident" id="4586242">receiver</span><span class="op" id="4586250">)</span><br>
<span class="lineno">450</span><span class="op" id="4586252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4586255">func</span>&nbsp;<span class="op" id="4586260">(</span><span class="ident" id="4586261">s</span>&nbsp;<span class="op" id="4586263">*</span><span class="ident" id="4586264">state</span><span class="op" id="4586269">)</span>&nbsp;<span class="ident" id="4586271">evalFunction</span><span class="op" id="4586283">(</span><span class="ident" id="4586284">dot</span>&nbsp;<span class="ident" id="4586288">reflect</span><span class="op" id="4586295">.</span><span class="ident" id="4586296">Value</span><span class="op" id="4586301">,</span>&nbsp;<span class="ident" id="4586303">node</span>&nbsp;<span class="op" id="4586308">*</span><span class="ident" id="4586309">parse</span><span class="op" id="4586314">.</span><span class="ident" id="4586315">IdentifierNode</span><span class="op" id="4586329">,</span>&nbsp;<span class="ident" id="4586331">cmd</span>&nbsp;<span class="ident" id="4586335">parse</span><span class="op" id="4586340">.</span><span class="ident" id="4586341">Node</span><span class="op" id="4586345">,</span>&nbsp;<span class="ident" id="4586347">args</span>&nbsp;<span class="op" id="4586352">[</span><span class="op" id="4586353">]</span><span class="ident" id="4586354">parse</span><span class="op" id="4586359">.</span><span class="ident" id="4586360">Node</span><span class="op" id="4586364">,</span>&nbsp;<span class="ident" id="4586366">final</span>&nbsp;<span class="ident" id="4586372">reflect</span><span class="op" id="4586379">.</span><span class="ident" id="4586380">Value</span><span class="op" id="4586385">)</span>&nbsp;<span class="ident" id="4586387">reflect</span><span class="op" id="4586394">.</span><span class="ident" id="4586395">Value</span>&nbsp;<span class="op" id="4586401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586404">s</span><span class="op" id="4586405">.</span><span class="ident" id="4586406">at</span><span class="op" id="4586408">(</span><span class="ident" id="4586409">node</span><span class="op" id="4586413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586416">name</span>&nbsp;<span class="op" id="4586421">:=</span>&nbsp;<span class="ident" id="4586424">node</span><span class="op" id="4586428">.</span><span class="ident" id="4586429">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586436">function</span><span class="op" id="4586444">,</span>&nbsp;<span class="ident" id="4586446">ok</span>&nbsp;<span class="op" id="4586449">:=</span>&nbsp;<span class="ident" id="4586452">findFunction</span><span class="op" id="4586464">(</span><span class="ident" id="4586465">name</span><span class="op" id="4586469">,</span>&nbsp;<span class="ident" id="4586471">s</span><span class="op" id="4586472">.</span><span class="ident" id="4586473">tmpl</span><span class="op" id="4586477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4586480">if</span>&nbsp;<span class="op" id="4586483">!</span><span class="ident" id="4586484">ok</span>&nbsp;<span class="op" id="4586487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586491">s</span><span class="op" id="4586492">.</span><span class="ident" id="4586493">errorf</span><span class="op" id="4586499">(</span><span class="string" id="4586500">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="4586530">,</span>&nbsp;<span class="ident" id="4586532">name</span><span class="op" id="4586536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4586539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4586542">return</span>&nbsp;<span class="ident" id="4586549">s</span><span class="op" id="4586550">.</span><span class="ident" id="4586551">evalCall</span><span class="op" id="4586559">(</span><span class="ident" id="4586560">dot</span><span class="op" id="4586563">,</span>&nbsp;<span class="ident" id="4586565">function</span><span class="op" id="4586573">,</span>&nbsp;<span class="ident" id="4586575">cmd</span><span class="op" id="4586578">,</span>&nbsp;<span class="ident" id="4586580">name</span><span class="op" id="4586584">,</span>&nbsp;<span class="ident" id="4586586">args</span><span class="op" id="4586590">,</span>&nbsp;<span class="ident" id="4586592">final</span><span class="op" id="4586597">)</span><br>
<span class="lineno">460</span><span class="op" id="4586599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4586602">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="4586676">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="4586747">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="4586781">func</span>&nbsp;<span class="op" id="4586786">(</span><span class="ident" id="4586787">s</span>&nbsp;<span class="op" id="4586789">*</span><span class="ident" id="4586790">state</span><span class="op" id="4586795">)</span>&nbsp;<span class="ident" id="4586797">evalField</span><span class="op" id="4586806">(</span><span class="ident" id="4586807">dot</span>&nbsp;<span class="ident" id="4586811">reflect</span><span class="op" id="4586818">.</span><span class="ident" id="4586819">Value</span><span class="op" id="4586824">,</span>&nbsp;<span class="ident" id="4586826">fieldName</span>&nbsp;<span class="builtintype" id="4586836">string</span><span class="op" id="4586842">,</span>&nbsp;<span class="ident" id="4586844">node</span>&nbsp;<span class="ident" id="4586849">parse</span><span class="op" id="4586854">.</span><span class="ident" id="4586855">Node</span><span class="op" id="4586859">,</span>&nbsp;<span class="ident" id="4586861">args</span>&nbsp;<span class="op" id="4586866">[</span><span class="op" id="4586867">]</span><span class="ident" id="4586868">parse</span><span class="op" id="4586873">.</span><span class="ident" id="4586874">Node</span><span class="op" id="4586878">,</span>&nbsp;<span class="ident" id="4586880">final</span><span class="op" id="4586885">,</span>&nbsp;<span class="ident" id="4586887">receiver</span>&nbsp;<span class="ident" id="4586896">reflect</span><span class="op" id="4586903">.</span><span class="ident" id="4586904">Value</span><span class="op" id="4586909">)</span>&nbsp;<span class="ident" id="4586911">reflect</span><span class="op" id="4586918">.</span><span class="ident" id="4586919">Value</span>&nbsp;<span class="op" id="4586925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4586928">if</span>&nbsp;<span class="op" id="4586931">!</span><span class="ident" id="4586932">receiver</span><span class="op" id="4586940">.</span><span class="ident" id="4586941">IsValid</span><span class="op" id="4586948">(</span><span class="op" id="4586949">)</span>&nbsp;<span class="op" id="4586951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4586955">return</span>&nbsp;<span class="ident" id="4586962">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4586968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586971">typ</span>&nbsp;<span class="op" id="4586975">:=</span>&nbsp;<span class="ident" id="4586978">receiver</span><span class="op" id="4586986">.</span><span class="ident" id="4586987">Type</span><span class="op" id="4586991">(</span><span class="op" id="4586992">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4586995">receiver</span><span class="op" id="4587003">,</span>&nbsp;<span class="ident" id="4587005">_</span>&nbsp;<span class="op" id="4587007">=</span>&nbsp;<span class="ident" id="4587009">indirect</span><span class="op" id="4587017">(</span><span class="ident" id="4587018">receiver</span><span class="op" id="4587026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4587029">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4587106">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587142">ptr</span>&nbsp;<span class="op" id="4587146">:=</span>&nbsp;<span class="ident" id="4587149">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587159">if</span>&nbsp;<span class="ident" id="4587162">ptr</span><span class="op" id="4587165">.</span><span class="ident" id="4587166">Kind</span><span class="op" id="4587170">(</span><span class="op" id="4587171">)</span>&nbsp;<span class="op" id="4587173">!=</span>&nbsp;<span class="ident" id="4587176">reflect</span><span class="op" id="4587183">.</span><span class="ident" id="4587184">Interface</span>&nbsp;<span class="op" id="4587194">&amp;&amp;</span>&nbsp;<span class="ident" id="4587197">ptr</span><span class="op" id="4587200">.</span><span class="ident" id="4587201">CanAddr</span><span class="op" id="4587208">(</span><span class="op" id="4587209">)</span>&nbsp;<span class="op" id="4587211">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587215">ptr</span>&nbsp;<span class="op" id="4587219">=</span>&nbsp;<span class="ident" id="4587221">ptr</span><span class="op" id="4587224">.</span><span class="ident" id="4587225">Addr</span><span class="op" id="4587229">(</span><span class="op" id="4587230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4587233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587236">if</span>&nbsp;<span class="ident" id="4587239">method</span>&nbsp;<span class="op" id="4587246">:=</span>&nbsp;<span class="ident" id="4587249">ptr</span><span class="op" id="4587252">.</span><span class="ident" id="4587253">MethodByName</span><span class="op" id="4587265">(</span><span class="ident" id="4587266">fieldName</span><span class="op" id="4587275">)</span><span class="op" id="4587276">;</span>&nbsp;<span class="ident" id="4587278">method</span><span class="op" id="4587284">.</span><span class="ident" id="4587285">IsValid</span><span class="op" id="4587292">(</span><span class="op" id="4587293">)</span>&nbsp;<span class="op" id="4587295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587299">return</span>&nbsp;<span class="ident" id="4587306">s</span><span class="op" id="4587307">.</span><span class="ident" id="4587308">evalCall</span><span class="op" id="4587316">(</span><span class="ident" id="4587317">dot</span><span class="op" id="4587320">,</span>&nbsp;<span class="ident" id="4587322">method</span><span class="op" id="4587328">,</span>&nbsp;<span class="ident" id="4587330">node</span><span class="op" id="4587334">,</span>&nbsp;<span class="ident" id="4587336">fieldName</span><span class="op" id="4587345">,</span>&nbsp;<span class="ident" id="4587347">args</span><span class="op" id="4587351">,</span>&nbsp;<span class="ident" id="4587353">final</span><span class="op" id="4587358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4587361">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587364">hasArgs</span>&nbsp;<span class="op" id="4587372">:=</span>&nbsp;<span class="builtinfunc" id="4587375">len</span><span class="op" id="4587378">(</span><span class="ident" id="4587379">args</span><span class="op" id="4587383">)</span>&nbsp;<span class="op" id="4587385">&gt;</span>&nbsp;<span class="num" id="4587387">1</span>&nbsp;<span class="op" id="4587389">||</span>&nbsp;<span class="ident" id="4587392">final</span><span class="op" id="4587397">.</span><span class="ident" id="4587398">IsValid</span><span class="op" id="4587405">(</span><span class="op" id="4587406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4587409">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587514">receiver</span><span class="op" id="4587522">,</span>&nbsp;<span class="ident" id="4587524">isNil</span>&nbsp;<span class="op" id="4587530">:=</span>&nbsp;<span class="ident" id="4587533">indirect</span><span class="op" id="4587541">(</span><span class="ident" id="4587542">receiver</span><span class="op" id="4587550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587553">if</span>&nbsp;<span class="ident" id="4587556">isNil</span>&nbsp;<span class="op" id="4587562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587566">s</span><span class="op" id="4587567">.</span><span class="ident" id="4587568">errorf</span><span class="op" id="4587574">(</span><span class="string" id="4587575">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="4587605">,</span>&nbsp;<span class="ident" id="4587607">typ</span><span class="op" id="4587610">,</span>&nbsp;<span class="ident" id="4587612">fieldName</span><span class="op" id="4587621">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4587624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587627">switch</span>&nbsp;<span class="ident" id="4587634">receiver</span><span class="op" id="4587642">.</span><span class="ident" id="4587643">Kind</span><span class="op" id="4587647">(</span><span class="op" id="4587648">)</span>&nbsp;<span class="op" id="4587650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587653">case</span>&nbsp;<span class="ident" id="4587658">reflect</span><span class="op" id="4587665">.</span><span class="ident" id="4587666">Struct</span><span class="op" id="4587672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587676">tField</span><span class="op" id="4587682">,</span>&nbsp;<span class="ident" id="4587684">ok</span>&nbsp;<span class="op" id="4587687">:=</span>&nbsp;<span class="ident" id="4587690">receiver</span><span class="op" id="4587698">.</span><span class="ident" id="4587699">Type</span><span class="op" id="4587703">(</span><span class="op" id="4587704">)</span><span class="op" id="4587705">.</span><span class="ident" id="4587706">FieldByName</span><span class="op" id="4587717">(</span><span class="ident" id="4587718">fieldName</span><span class="op" id="4587727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587731">if</span>&nbsp;<span class="ident" id="4587734">ok</span>&nbsp;<span class="op" id="4587737">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587742">field</span>&nbsp;<span class="op" id="4587748">:=</span>&nbsp;<span class="ident" id="4587751">receiver</span><span class="op" id="4587759">.</span><span class="ident" id="4587760">FieldByIndex</span><span class="op" id="4587772">(</span><span class="ident" id="4587773">tField</span><span class="op" id="4587779">.</span><span class="ident" id="4587780">Index</span><span class="op" id="4587785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587790">if</span>&nbsp;<span class="ident" id="4587793">tField</span><span class="op" id="4587799">.</span><span class="ident" id="4587800">PkgPath</span>&nbsp;<span class="op" id="4587808">!=</span>&nbsp;<span class="string" id="4587811">&#34;&#34;</span>&nbsp;<span class="op" id="4587814">{</span>&nbsp;<span class="comment" id="4587816">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587843">s</span><span class="op" id="4587844">.</span><span class="ident" id="4587845">errorf</span><span class="op" id="4587851">(</span><span class="string" id="4587852">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4587897">,</span>&nbsp;<span class="ident" id="4587899">fieldName</span><span class="op" id="4587908">,</span>&nbsp;<span class="ident" id="4587910">typ</span><span class="op" id="4587913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4587918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4587923">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4587966">if</span>&nbsp;<span class="ident" id="4587969">hasArgs</span>&nbsp;<span class="op" id="4587977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4587983">s</span><span class="op" id="4587984">.</span><span class="ident" id="4587985">errorf</span><span class="op" id="4587991">(</span><span class="string" id="4587992">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="4588044">,</span>&nbsp;<span class="ident" id="4588046">fieldName</span><span class="op" id="4588055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4588065">return</span>&nbsp;<span class="ident" id="4588072">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588080">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588084">s</span><span class="op" id="4588085">.</span><span class="ident" id="4588086">errorf</span><span class="op" id="4588092">(</span><span class="string" id="4588093">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4588130">,</span>&nbsp;<span class="ident" id="4588132">fieldName</span><span class="op" id="4588141">,</span>&nbsp;<span class="ident" id="4588143">typ</span><span class="op" id="4588146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4588149">case</span>&nbsp;<span class="ident" id="4588154">reflect</span><span class="op" id="4588161">.</span><span class="ident" id="4588162">Map</span><span class="op" id="4588165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4588169">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588229">nameVal</span>&nbsp;<span class="op" id="4588237">:=</span>&nbsp;<span class="ident" id="4588240">reflect</span><span class="op" id="4588247">.</span><span class="ident" id="4588248">ValueOf</span><span class="op" id="4588255">(</span><span class="ident" id="4588256">fieldName</span><span class="op" id="4588265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4588269">if</span>&nbsp;<span class="ident" id="4588272">nameVal</span><span class="op" id="4588279">.</span><span class="ident" id="4588280">Type</span><span class="op" id="4588284">(</span><span class="op" id="4588285">)</span><span class="op" id="4588286">.</span><span class="ident" id="4588287">AssignableTo</span><span class="op" id="4588299">(</span><span class="ident" id="4588300">receiver</span><span class="op" id="4588308">.</span><span class="ident" id="4588309">Type</span><span class="op" id="4588313">(</span><span class="op" id="4588314">)</span><span class="op" id="4588315">.</span><span class="ident" id="4588316">Key</span><span class="op" id="4588319">(</span><span class="op" id="4588320">)</span><span class="op" id="4588321">)</span>&nbsp;<span class="op" id="4588323">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4588328">if</span>&nbsp;<span class="ident" id="4588331">hasArgs</span>&nbsp;<span class="op" id="4588339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588345">s</span><span class="op" id="4588346">.</span><span class="ident" id="4588347">errorf</span><span class="op" id="4588353">(</span><span class="string" id="4588354">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="4588392">,</span>&nbsp;<span class="ident" id="4588394">fieldName</span><span class="op" id="4588403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4588413">return</span>&nbsp;<span class="ident" id="4588420">receiver</span><span class="op" id="4588428">.</span><span class="ident" id="4588429">MapIndex</span><span class="op" id="4588437">(</span><span class="ident" id="4588438">nameVal</span><span class="op" id="4588445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588449">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588455">s</span><span class="op" id="4588456">.</span><span class="ident" id="4588457">errorf</span><span class="op" id="4588463">(</span><span class="string" id="4588464">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4588500">,</span>&nbsp;<span class="ident" id="4588502">fieldName</span><span class="op" id="4588511">,</span>&nbsp;<span class="ident" id="4588513">typ</span><span class="op" id="4588516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4588519">panic</span><span class="op" id="4588524">(</span><span class="string" id="4588525">&#34;not&nbsp;reached&#34;</span><span class="op" id="4588538">)</span><br>
<span class="lineno"></span><span class="op" id="4588540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="4588543">var</span>&nbsp;<span class="op" id="4588547">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588550">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588566">=</span>&nbsp;<span class="ident" id="4588568">reflect</span><span class="op" id="4588575">.</span><span class="ident" id="4588576">TypeOf</span><span class="op" id="4588582">(</span><span class="op" id="4588583">(</span><span class="op" id="4588584">*</span><span class="builtintype" id="4588585">error</span><span class="op" id="4588590">)</span><span class="op" id="4588591">(</span><span class="builtintype" id="4588592">nil</span><span class="op" id="4588595">)</span><span class="op" id="4588596">)</span><span class="op" id="4588597">.</span><span class="ident" id="4588598">Elem</span><span class="op" id="4588602">(</span><span class="op" id="4588603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588606">fmtStringerType</span>&nbsp;<span class="op" id="4588622">=</span>&nbsp;<span class="ident" id="4588624">reflect</span><span class="op" id="4588631">.</span><span class="ident" id="4588632">TypeOf</span><span class="op" id="4588638">(</span><span class="op" id="4588639">(</span><span class="op" id="4588640">*</span><span class="ident" id="4588641">fmt</span><span class="op" id="4588644">.</span><span class="ident" id="4588645">Stringer</span><span class="op" id="4588653">)</span><span class="op" id="4588654">(</span><span class="builtintype" id="4588655">nil</span><span class="op" id="4588658">)</span><span class="op" id="4588659">)</span><span class="op" id="4588660">.</span><span class="ident" id="4588661">Elem</span><span class="op" id="4588665">(</span><span class="op" id="4588666">)</span><br>
<span class="lineno"></span><span class="op" id="4588668">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="4588671">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="4588776">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="4588888">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4588915">func</span>&nbsp;<span class="op" id="4588920">(</span><span class="ident" id="4588921">s</span>&nbsp;<span class="op" id="4588923">*</span><span class="ident" id="4588924">state</span><span class="op" id="4588929">)</span>&nbsp;<span class="ident" id="4588931">evalCall</span><span class="op" id="4588939">(</span><span class="ident" id="4588940">dot</span><span class="op" id="4588943">,</span>&nbsp;<span class="ident" id="4588945">fun</span>&nbsp;<span class="ident" id="4588949">reflect</span><span class="op" id="4588956">.</span><span class="ident" id="4588957">Value</span><span class="op" id="4588962">,</span>&nbsp;<span class="ident" id="4588964">node</span>&nbsp;<span class="ident" id="4588969">parse</span><span class="op" id="4588974">.</span><span class="ident" id="4588975">Node</span><span class="op" id="4588979">,</span>&nbsp;<span class="ident" id="4588981">name</span>&nbsp;<span class="builtintype" id="4588986">string</span><span class="op" id="4588992">,</span>&nbsp;<span class="ident" id="4588994">args</span>&nbsp;<span class="op" id="4588999">[</span><span class="op" id="4589000">]</span><span class="ident" id="4589001">parse</span><span class="op" id="4589006">.</span><span class="ident" id="4589007">Node</span><span class="op" id="4589011">,</span>&nbsp;<span class="ident" id="4589013">final</span>&nbsp;<span class="ident" id="4589019">reflect</span><span class="op" id="4589026">.</span><span class="ident" id="4589027">Value</span><span class="op" id="4589032">)</span>&nbsp;<span class="ident" id="4589034">reflect</span><span class="op" id="4589041">.</span><span class="ident" id="4589042">Value</span>&nbsp;<span class="op" id="4589048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4589051">if</span>&nbsp;<span class="ident" id="4589054">args</span>&nbsp;<span class="op" id="4589059">!=</span>&nbsp;<span class="builtintype" id="4589062">nil</span>&nbsp;<span class="op" id="4589066">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589070">args</span>&nbsp;<span class="op" id="4589075">=</span>&nbsp;<span class="ident" id="4589077">args</span><span class="op" id="4589081">[</span><span class="num" id="4589082">1</span><span class="op" id="4589083">:</span><span class="op" id="4589084">]</span>&nbsp;<span class="comment" id="4589086">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4589148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589151">typ</span>&nbsp;<span class="op" id="4589155">:=</span>&nbsp;<span class="ident" id="4589158">fun</span><span class="op" id="4589161">.</span><span class="ident" id="4589162">Type</span><span class="op" id="4589166">(</span><span class="op" id="4589167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589170">numIn</span>&nbsp;<span class="op" id="4589176">:=</span>&nbsp;<span class="builtinfunc" id="4589179">len</span><span class="op" id="4589182">(</span><span class="ident" id="4589183">args</span><span class="op" id="4589187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4589190">if</span>&nbsp;<span class="ident" id="4589193">final</span><span class="op" id="4589198">.</span><span class="ident" id="4589199">IsValid</span><span class="op" id="4589206">(</span><span class="op" id="4589207">)</span>&nbsp;<span class="op" id="4589209">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589213">numIn</span><span class="op" id="4589218">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4589222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589225">numFixed</span>&nbsp;<span class="op" id="4589234">:=</span>&nbsp;<span class="builtinfunc" id="4589237">len</span><span class="op" id="4589240">(</span><span class="ident" id="4589241">args</span><span class="op" id="4589245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4589248">if</span>&nbsp;<span class="ident" id="4589251">typ</span><span class="op" id="4589254">.</span><span class="ident" id="4589255">IsVariadic</span><span class="op" id="4589265">(</span><span class="op" id="4589266">)</span>&nbsp;<span class="op" id="4589268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589272">numFixed</span>&nbsp;<span class="op" id="4589281">=</span>&nbsp;<span class="ident" id="4589283">typ</span><span class="op" id="4589286">.</span><span class="ident" id="4589287">NumIn</span><span class="op" id="4589292">(</span><span class="op" id="4589293">)</span>&nbsp;<span class="op" id="4589295">-</span>&nbsp;<span class="num" id="4589297">1</span>&nbsp;<span class="comment" id="4589299">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4589334">if</span>&nbsp;<span class="ident" id="4589337">numIn</span>&nbsp;<span class="op" id="4589343">&lt;</span>&nbsp;<span class="ident" id="4589345">numFixed</span>&nbsp;<span class="op" id="4589354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589359">s</span><span class="op" id="4589360">.</span><span class="ident" id="4589361">errorf</span><span class="op" id="4589367">(</span><span class="string" id="4589368">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="4589422">,</span>&nbsp;<span class="ident" id="4589424">name</span><span class="op" id="4589428">,</span>&nbsp;<span class="ident" id="4589430">typ</span><span class="op" id="4589433">.</span><span class="ident" id="4589434">NumIn</span><span class="op" id="4589439">(</span><span class="op" id="4589440">)</span><span class="op" id="4589441">-</span><span class="num" id="4589442">1</span><span class="op" id="4589443">,</span>&nbsp;<span class="builtinfunc" id="4589445">len</span><span class="op" id="4589448">(</span><span class="ident" id="4589449">args</span><span class="op" id="4589453">)</span><span class="op" id="4589454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4589458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4589461">}</span>&nbsp;<span class="keyword" id="4589463">else</span>&nbsp;<span class="keyword" id="4589468">if</span>&nbsp;<span class="ident" id="4589471">numIn</span>&nbsp;<span class="op" id="4589477">&lt;</span>&nbsp;<span class="ident" id="4589479">typ</span><span class="op" id="4589482">.</span><span class="ident" id="4589483">NumIn</span><span class="op" id="4589488">(</span><span class="op" id="4589489">)</span><span class="op" id="4589490">-</span><span class="num" id="4589491">1</span>&nbsp;<span class="op" id="4589493">||</span>&nbsp;<span class="op" id="4589496">!</span><span class="ident" id="4589497">typ</span><span class="op" id="4589500">.</span><span class="ident" id="4589501">IsVariadic</span><span class="op" id="4589511">(</span><span class="op" id="4589512">)</span>&nbsp;<span class="op" id="4589514">&amp;&amp;</span>&nbsp;<span class="ident" id="4589517">numIn</span>&nbsp;<span class="op" id="4589523">!=</span>&nbsp;<span class="ident" id="4589526">typ</span><span class="op" id="4589529">.</span><span class="ident" id="4589530">NumIn</span><span class="op" id="4589535">(</span><span class="op" id="4589536">)</span>&nbsp;<span class="op" id="4589538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589542">s</span><span class="op" id="4589543">.</span><span class="ident" id="4589544">errorf</span><span class="op" id="4589550">(</span><span class="string" id="4589551">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="4589596">,</span>&nbsp;<span class="ident" id="4589598">name</span><span class="op" id="4589602">,</span>&nbsp;<span class="ident" id="4589604">typ</span><span class="op" id="4589607">.</span><span class="ident" id="4589608">NumIn</span><span class="op" id="4589613">(</span><span class="op" id="4589614">)</span><span class="op" id="4589615">,</span>&nbsp;<span class="builtinfunc" id="4589617">len</span><span class="op" id="4589620">(</span><span class="ident" id="4589621">args</span><span class="op" id="4589625">)</span><span class="op" id="4589626">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4589629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4589632">if</span>&nbsp;<span class="op" id="4589635">!</span><span class="ident" id="4589636">goodFunc</span><span class="op" id="4589644">(</span><span class="ident" id="4589645">typ</span><span class="op" id="4589648">)</span>&nbsp;<span class="op" id="4589650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4589654">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589740">s</span><span class="op" id="4589741">.</span><span class="ident" id="4589742">errorf</span><span class="op" id="4589748">(</span><span class="string" id="4589749">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="4589796">,</span>&nbsp;<span class="ident" id="4589798">name</span><span class="op" id="4589802">,</span>&nbsp;<span class="ident" id="4589804">typ</span><span class="op" id="4589807">.</span><span class="ident" id="4589808">NumOut</span><span class="op" id="4589814">(</span><span class="op" id="4589815">)</span><span class="op" id="4589816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4589819">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4589822">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589846">argv</span>&nbsp;<span class="op" id="4589851">:=</span>&nbsp;<span class="builtinfunc" id="4589854">make</span><span class="op" id="4589858">(</span><span class="op" id="4589859">[</span><span class="op" id="4589860">]</span><span class="ident" id="4589861">reflect</span><span class="op" id="4589868">.</span><span class="ident" id="4589869">Value</span><span class="op" id="4589874">,</span>&nbsp;<span class="ident" id="4589876">numIn</span><span class="op" id="4589881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4589884">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589930">i</span>&nbsp;<span class="op" id="4589932">:=</span>&nbsp;<span class="num" id="4589935">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4589938">for</span>&nbsp;<span class="op" id="4589942">;</span>&nbsp;<span class="ident" id="4589944">i</span>&nbsp;<span class="op" id="4589946">&lt;</span>&nbsp;<span class="ident" id="4589948">numFixed</span>&nbsp;<span class="op" id="4589957">&amp;&amp;</span>&nbsp;<span class="ident" id="4589960">i</span>&nbsp;<span class="op" id="4589962">&lt;</span>&nbsp;<span class="builtinfunc" id="4589964">len</span><span class="op" id="4589967">(</span><span class="ident" id="4589968">args</span><span class="op" id="4589972">)</span><span class="op" id="4589973">;</span>&nbsp;<span class="ident" id="4589975">i</span><span class="op" id="4589976">++</span>&nbsp;<span class="op" id="4589979">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589983">argv</span><span class="op" id="4589987">[</span><span class="ident" id="4589988">i</span><span class="op" id="4589989">]</span>&nbsp;<span class="op" id="4589991">=</span>&nbsp;<span class="ident" id="4589993">s</span><span class="op" id="4589994">.</span><span class="ident" id="4589995">evalArg</span><span class="op" id="4590002">(</span><span class="ident" id="4590003">dot</span><span class="op" id="4590006">,</span>&nbsp;<span class="ident" id="4590008">typ</span><span class="op" id="4590011">.</span><span class="ident" id="4590012">In</span><span class="op" id="4590014">(</span><span class="ident" id="4590015">i</span><span class="op" id="4590016">)</span><span class="op" id="4590017">,</span>&nbsp;<span class="ident" id="4590019">args</span><span class="op" id="4590023">[</span><span class="ident" id="4590024">i</span><span class="op" id="4590025">]</span><span class="op" id="4590026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4590029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4590032">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590054">if</span>&nbsp;<span class="ident" id="4590057">typ</span><span class="op" id="4590060">.</span><span class="ident" id="4590061">IsVariadic</span><span class="op" id="4590071">(</span><span class="op" id="4590072">)</span>&nbsp;<span class="op" id="4590074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590078">argType</span>&nbsp;<span class="op" id="4590086">:=</span>&nbsp;<span class="ident" id="4590089">typ</span><span class="op" id="4590092">.</span><span class="ident" id="4590093">In</span><span class="op" id="4590095">(</span><span class="ident" id="4590096">typ</span><span class="op" id="4590099">.</span><span class="ident" id="4590100">NumIn</span><span class="op" id="4590105">(</span><span class="op" id="4590106">)</span>&nbsp;<span class="op" id="4590108">-</span>&nbsp;<span class="num" id="4590110">1</span><span class="op" id="4590111">)</span><span class="op" id="4590112">.</span><span class="ident" id="4590113">Elem</span><span class="op" id="4590117">(</span><span class="op" id="4590118">)</span>&nbsp;<span class="comment" id="4590120">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590146">for</span>&nbsp;<span class="op" id="4590150">;</span>&nbsp;<span class="ident" id="4590152">i</span>&nbsp;<span class="op" id="4590154">&lt;</span>&nbsp;<span class="builtinfunc" id="4590156">len</span><span class="op" id="4590159">(</span><span class="ident" id="4590160">args</span><span class="op" id="4590164">)</span><span class="op" id="4590165">;</span>&nbsp;<span class="ident" id="4590167">i</span><span class="op" id="4590168">++</span>&nbsp;<span class="op" id="4590171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590176">argv</span><span class="op" id="4590180">[</span><span class="ident" id="4590181">i</span><span class="op" id="4590182">]</span>&nbsp;<span class="op" id="4590184">=</span>&nbsp;<span class="ident" id="4590186">s</span><span class="op" id="4590187">.</span><span class="ident" id="4590188">evalArg</span><span class="op" id="4590195">(</span><span class="ident" id="4590196">dot</span><span class="op" id="4590199">,</span>&nbsp;<span class="ident" id="4590201">argType</span><span class="op" id="4590208">,</span>&nbsp;<span class="ident" id="4590210">args</span><span class="op" id="4590214">[</span><span class="ident" id="4590215">i</span><span class="op" id="4590216">]</span><span class="op" id="4590217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4590221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4590224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4590227">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590261">if</span>&nbsp;<span class="ident" id="4590264">final</span><span class="op" id="4590269">.</span><span class="ident" id="4590270">IsValid</span><span class="op" id="4590277">(</span><span class="op" id="4590278">)</span>&nbsp;<span class="op" id="4590280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590284">t</span>&nbsp;<span class="op" id="4590286">:=</span>&nbsp;<span class="ident" id="4590289">typ</span><span class="op" id="4590292">.</span><span class="ident" id="4590293">In</span><span class="op" id="4590295">(</span><span class="ident" id="4590296">typ</span><span class="op" id="4590299">.</span><span class="ident" id="4590300">NumIn</span><span class="op" id="4590305">(</span><span class="op" id="4590306">)</span>&nbsp;<span class="op" id="4590308">-</span>&nbsp;<span class="num" id="4590310">1</span><span class="op" id="4590311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590315">if</span>&nbsp;<span class="ident" id="4590318">typ</span><span class="op" id="4590321">.</span><span class="ident" id="4590322">IsVariadic</span><span class="op" id="4590332">(</span><span class="op" id="4590333">)</span>&nbsp;<span class="op" id="4590335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590340">t</span>&nbsp;<span class="op" id="4590342">=</span>&nbsp;<span class="ident" id="4590344">t</span><span class="op" id="4590345">.</span><span class="ident" id="4590346">Elem</span><span class="op" id="4590350">(</span><span class="op" id="4590351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4590355">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590359">argv</span><span class="op" id="4590363">[</span><span class="ident" id="4590364">i</span><span class="op" id="4590365">]</span>&nbsp;<span class="op" id="4590367">=</span>&nbsp;<span class="ident" id="4590369">s</span><span class="op" id="4590370">.</span><span class="ident" id="4590371">validateType</span><span class="op" id="4590383">(</span><span class="ident" id="4590384">final</span><span class="op" id="4590389">,</span>&nbsp;<span class="ident" id="4590391">t</span><span class="op" id="4590392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4590395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590398">result</span>&nbsp;<span class="op" id="4590405">:=</span>&nbsp;<span class="ident" id="4590408">fun</span><span class="op" id="4590411">.</span><span class="ident" id="4590412">Call</span><span class="op" id="4590416">(</span><span class="ident" id="4590417">argv</span><span class="op" id="4590421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4590424">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590517">if</span>&nbsp;<span class="builtinfunc" id="4590520">len</span><span class="op" id="4590523">(</span><span class="ident" id="4590524">result</span><span class="op" id="4590530">)</span>&nbsp;<span class="op" id="4590532">==</span>&nbsp;<span class="num" id="4590535">2</span>&nbsp;<span class="op" id="4590537">&amp;&amp;</span>&nbsp;<span class="op" id="4590540">!</span><span class="ident" id="4590541">result</span><span class="op" id="4590547">[</span><span class="num" id="4590548">1</span><span class="op" id="4590549">]</span><span class="op" id="4590550">.</span><span class="ident" id="4590551">IsNil</span><span class="op" id="4590556">(</span><span class="op" id="4590557">)</span>&nbsp;<span class="op" id="4590559">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590563">s</span><span class="op" id="4590564">.</span><span class="ident" id="4590565">at</span><span class="op" id="4590567">(</span><span class="ident" id="4590568">node</span><span class="op" id="4590572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4590576">s</span><span class="op" id="4590577">.</span><span class="ident" id="4590578">errorf</span><span class="op" id="4590584">(</span><span class="string" id="4590585">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="4590607">,</span>&nbsp;<span class="ident" id="4590609">name</span><span class="op" id="4590613">,</span>&nbsp;<span class="ident" id="4590615">result</span><span class="op" id="4590621">[</span><span class="num" id="4590622">1</span><span class="op" id="4590623">]</span><span class="op" id="4590624">.</span><span class="ident" id="4590625">Interface</span><span class="op" id="4590634">(</span><span class="op" id="4590635">)</span><span class="op" id="4590636">.</span><span class="op" id="4590637">(</span><span class="builtintype" id="4590638">error</span><span class="op" id="4590643">)</span><span class="op" id="4590644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4590647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590650">return</span>&nbsp;<span class="ident" id="4590657">result</span><span class="op" id="4590663">[</span><span class="num" id="4590664">0</span><span class="op" id="4590665">]</span><br>
<span class="lineno"></span><span class="op" id="4590667">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="4590670">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="4590760">func</span>&nbsp;<span class="ident" id="4590765">canBeNil</span><span class="op" id="4590773">(</span><span class="ident" id="4590774">typ</span>&nbsp;<span class="ident" id="4590778">reflect</span><span class="op" id="4590785">.</span><span class="ident" id="4590786">Type</span><span class="op" id="4590790">)</span>&nbsp;<span class="builtintype" id="4590792">bool</span>&nbsp;<span class="op" id="4590797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590800">switch</span>&nbsp;<span class="ident" id="4590807">typ</span><span class="op" id="4590810">.</span><span class="ident" id="4590811">Kind</span><span class="op" id="4590815">(</span><span class="op" id="4590816">)</span>&nbsp;<span class="op" id="4590818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590821">case</span>&nbsp;<span class="ident" id="4590826">reflect</span><span class="op" id="4590833">.</span><span class="ident" id="4590834">Chan</span><span class="op" id="4590838">,</span>&nbsp;<span class="ident" id="4590840">reflect</span><span class="op" id="4590847">.</span><span class="ident" id="4590848">Func</span><span class="op" id="4590852">,</span>&nbsp;<span class="ident" id="4590854">reflect</span><span class="op" id="4590861">.</span><span class="ident" id="4590862">Interface</span><span class="op" id="4590871">,</span>&nbsp;<span class="ident" id="4590873">reflect</span><span class="op" id="4590880">.</span><span class="ident" id="4590881">Map</span><span class="op" id="4590884">,</span>&nbsp;<span class="ident" id="4590886">reflect</span><span class="op" id="4590893">.</span><span class="ident" id="4590894">Ptr</span><span class="op" id="4590897">,</span>&nbsp;<span class="ident" id="4590899">reflect</span><span class="op" id="4590906">.</span><span class="ident" id="4590907">Slice</span><span class="op" id="4590912">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590916">return</span>&nbsp;<span class="builtintype" id="4590923">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4590929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4590932">return</span>&nbsp;<span class="builtintype" id="4590939">false</span><br>
<span class="lineno"></span><span class="op" id="4590945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="4590948">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4591027">func</span>&nbsp;<span class="op" id="4591032">(</span><span class="ident" id="4591033">s</span>&nbsp;<span class="op" id="4591035">*</span><span class="ident" id="4591036">state</span><span class="op" id="4591041">)</span>&nbsp;<span class="ident" id="4591043">validateType</span><span class="op" id="4591055">(</span><span class="ident" id="4591056">value</span>&nbsp;<span class="ident" id="4591062">reflect</span><span class="op" id="4591069">.</span><span class="ident" id="4591070">Value</span><span class="op" id="4591075">,</span>&nbsp;<span class="ident" id="4591077">typ</span>&nbsp;<span class="ident" id="4591081">reflect</span><span class="op" id="4591088">.</span><span class="ident" id="4591089">Type</span><span class="op" id="4591093">)</span>&nbsp;<span class="ident" id="4591095">reflect</span><span class="op" id="4591102">.</span><span class="ident" id="4591103">Value</span>&nbsp;<span class="op" id="4591109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591112">if</span>&nbsp;<span class="op" id="4591115">!</span><span class="ident" id="4591116">value</span><span class="op" id="4591121">.</span><span class="ident" id="4591122">IsValid</span><span class="op" id="4591129">(</span><span class="op" id="4591130">)</span>&nbsp;<span class="op" id="4591132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591136">if</span>&nbsp;<span class="ident" id="4591139">typ</span>&nbsp;<span class="op" id="4591143">==</span>&nbsp;<span class="builtintype" id="4591146">nil</span>&nbsp;<span class="op" id="4591150">||</span>&nbsp;<span class="ident" id="4591153">canBeNil</span><span class="op" id="4591161">(</span><span class="ident" id="4591162">typ</span><span class="op" id="4591165">)</span>&nbsp;<span class="op" id="4591167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4591172">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591236">return</span>&nbsp;<span class="ident" id="4591243">reflect</span><span class="op" id="4591250">.</span><span class="ident" id="4591251">Zero</span><span class="op" id="4591255">(</span><span class="ident" id="4591256">typ</span><span class="op" id="4591259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591267">s</span><span class="op" id="4591268">.</span><span class="ident" id="4591269">errorf</span><span class="op" id="4591275">(</span><span class="string" id="4591276">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="4591304">,</span>&nbsp;<span class="ident" id="4591306">typ</span><span class="op" id="4591309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591315">if</span>&nbsp;<span class="ident" id="4591318">typ</span>&nbsp;<span class="op" id="4591322">!=</span>&nbsp;<span class="builtintype" id="4591325">nil</span>&nbsp;<span class="op" id="4591329">&amp;&amp;</span>&nbsp;<span class="op" id="4591332">!</span><span class="ident" id="4591333">value</span><span class="op" id="4591338">.</span><span class="ident" id="4591339">Type</span><span class="op" id="4591343">(</span><span class="op" id="4591344">)</span><span class="op" id="4591345">.</span><span class="ident" id="4591346">AssignableTo</span><span class="op" id="4591358">(</span><span class="ident" id="4591359">typ</span><span class="op" id="4591362">)</span>&nbsp;<span class="op" id="4591364">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591368">if</span>&nbsp;<span class="ident" id="4591371">value</span><span class="op" id="4591376">.</span><span class="ident" id="4591377">Kind</span><span class="op" id="4591381">(</span><span class="op" id="4591382">)</span>&nbsp;<span class="op" id="4591384">==</span>&nbsp;<span class="ident" id="4591387">reflect</span><span class="op" id="4591394">.</span><span class="ident" id="4591395">Interface</span>&nbsp;<span class="op" id="4591405">&amp;&amp;</span>&nbsp;<span class="op" id="4591408">!</span><span class="ident" id="4591409">value</span><span class="op" id="4591414">.</span><span class="ident" id="4591415">IsNil</span><span class="op" id="4591420">(</span><span class="op" id="4591421">)</span>&nbsp;<span class="op" id="4591423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591428">value</span>&nbsp;<span class="op" id="4591434">=</span>&nbsp;<span class="ident" id="4591436">value</span><span class="op" id="4591441">.</span><span class="ident" id="4591442">Elem</span><span class="op" id="4591446">(</span><span class="op" id="4591447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591452">if</span>&nbsp;<span class="ident" id="4591455">value</span><span class="op" id="4591460">.</span><span class="ident" id="4591461">Type</span><span class="op" id="4591465">(</span><span class="op" id="4591466">)</span><span class="op" id="4591467">.</span><span class="ident" id="4591468">AssignableTo</span><span class="op" id="4591480">(</span><span class="ident" id="4591481">typ</span><span class="op" id="4591484">)</span>&nbsp;<span class="op" id="4591486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591492">return</span>&nbsp;<span class="ident" id="4591499">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591508">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4591513">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4591534">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4591605">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4591677">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4591749">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591798">switch</span>&nbsp;<span class="op" id="4591805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591809">case</span>&nbsp;<span class="ident" id="4591814">value</span><span class="op" id="4591819">.</span><span class="ident" id="4591820">Kind</span><span class="op" id="4591824">(</span><span class="op" id="4591825">)</span>&nbsp;<span class="op" id="4591827">==</span>&nbsp;<span class="ident" id="4591830">reflect</span><span class="op" id="4591837">.</span><span class="ident" id="4591838">Ptr</span>&nbsp;<span class="op" id="4591842">&amp;&amp;</span>&nbsp;<span class="ident" id="4591845">value</span><span class="op" id="4591850">.</span><span class="ident" id="4591851">Type</span><span class="op" id="4591855">(</span><span class="op" id="4591856">)</span><span class="op" id="4591857">.</span><span class="ident" id="4591858">Elem</span><span class="op" id="4591862">(</span><span class="op" id="4591863">)</span><span class="op" id="4591864">.</span><span class="ident" id="4591865">AssignableTo</span><span class="op" id="4591877">(</span><span class="ident" id="4591878">typ</span><span class="op" id="4591881">)</span><span class="op" id="4591882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591887">value</span>&nbsp;<span class="op" id="4591893">=</span>&nbsp;<span class="ident" id="4591895">value</span><span class="op" id="4591900">.</span><span class="ident" id="4591901">Elem</span><span class="op" id="4591905">(</span><span class="op" id="4591906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591911">if</span>&nbsp;<span class="op" id="4591914">!</span><span class="ident" id="4591915">value</span><span class="op" id="4591920">.</span><span class="ident" id="4591921">IsValid</span><span class="op" id="4591928">(</span><span class="op" id="4591929">)</span>&nbsp;<span class="op" id="4591931">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591937">s</span><span class="op" id="4591938">.</span><span class="ident" id="4591939">errorf</span><span class="op" id="4591945">(</span><span class="string" id="4591946">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4591985">,</span>&nbsp;<span class="ident" id="4591987">typ</span><span class="op" id="4591990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591999">case</span>&nbsp;<span class="ident" id="4592004">reflect</span><span class="op" id="4592011">.</span><span class="ident" id="4592012">PtrTo</span><span class="op" id="4592017">(</span><span class="ident" id="4592018">value</span><span class="op" id="4592023">.</span><span class="ident" id="4592024">Type</span><span class="op" id="4592028">(</span><span class="op" id="4592029">)</span><span class="op" id="4592030">)</span><span class="op" id="4592031">.</span><span class="ident" id="4592032">AssignableTo</span><span class="op" id="4592044">(</span><span class="ident" id="4592045">typ</span><span class="op" id="4592048">)</span>&nbsp;<span class="op" id="4592050">&amp;&amp;</span>&nbsp;<span class="ident" id="4592053">value</span><span class="op" id="4592058">.</span><span class="ident" id="4592059">CanAddr</span><span class="op" id="4592066">(</span><span class="op" id="4592067">)</span><span class="op" id="4592068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592073">value</span>&nbsp;<span class="op" id="4592079">=</span>&nbsp;<span class="ident" id="4592081">value</span><span class="op" id="4592086">.</span><span class="ident" id="4592087">Addr</span><span class="op" id="4592091">(</span><span class="op" id="4592092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592096">default</span><span class="op" id="4592103">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592108">s</span><span class="op" id="4592109">.</span><span class="ident" id="4592110">errorf</span><span class="op" id="4592116">(</span><span class="string" id="4592117">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="4592160">,</span>&nbsp;<span class="ident" id="4592162">typ</span><span class="op" id="4592165">,</span>&nbsp;<span class="ident" id="4592167">value</span><span class="op" id="4592172">.</span><span class="ident" id="4592173">Type</span><span class="op" id="4592177">(</span><span class="op" id="4592178">)</span><span class="op" id="4592179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4592183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4592186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592189">return</span>&nbsp;<span class="ident" id="4592196">value</span><br>
<span class="lineno"></span><span class="op" id="4592202">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="4592205">func</span>&nbsp;<span class="op" id="4592210">(</span><span class="ident" id="4592211">s</span>&nbsp;<span class="op" id="4592213">*</span><span class="ident" id="4592214">state</span><span class="op" id="4592219">)</span>&nbsp;<span class="ident" id="4592221">evalArg</span><span class="op" id="4592228">(</span><span class="ident" id="4592229">dot</span>&nbsp;<span class="ident" id="4592233">reflect</span><span class="op" id="4592240">.</span><span class="ident" id="4592241">Value</span><span class="op" id="4592246">,</span>&nbsp;<span class="ident" id="4592248">typ</span>&nbsp;<span class="ident" id="4592252">reflect</span><span class="op" id="4592259">.</span><span class="ident" id="4592260">Type</span><span class="op" id="4592264">,</span>&nbsp;<span class="ident" id="4592266">n</span>&nbsp;<span class="ident" id="4592268">parse</span><span class="op" id="4592273">.</span><span class="ident" id="4592274">Node</span><span class="op" id="4592278">)</span>&nbsp;<span class="ident" id="4592280">reflect</span><span class="op" id="4592287">.</span><span class="ident" id="4592288">Value</span>&nbsp;<span class="op" id="4592294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592297">s</span><span class="op" id="4592298">.</span><span class="ident" id="4592299">at</span><span class="op" id="4592301">(</span><span class="ident" id="4592302">n</span><span class="op" id="4592303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592306">switch</span>&nbsp;<span class="ident" id="4592313">arg</span>&nbsp;<span class="op" id="4592317">:=</span>&nbsp;<span class="ident" id="4592320">n</span><span class="op" id="4592321">.</span><span class="op" id="4592322">(</span><span class="keyword" id="4592323">type</span><span class="op" id="4592327">)</span>&nbsp;<span class="op" id="4592329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592332">case</span>&nbsp;<span class="op" id="4592337">*</span><span class="ident" id="4592338">parse</span><span class="op" id="4592343">.</span><span class="ident" id="4592344">DotNode</span><span class="op" id="4592351">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592355">return</span>&nbsp;<span class="ident" id="4592362">s</span><span class="op" id="4592363">.</span><span class="ident" id="4592364">validateType</span><span class="op" id="4592376">(</span><span class="ident" id="4592377">dot</span><span class="op" id="4592380">,</span>&nbsp;<span class="ident" id="4592382">typ</span><span class="op" id="4592385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592388">case</span>&nbsp;<span class="op" id="4592393">*</span><span class="ident" id="4592394">parse</span><span class="op" id="4592399">.</span><span class="ident" id="4592400">NilNode</span><span class="op" id="4592407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592411">if</span>&nbsp;<span class="ident" id="4592414">canBeNil</span><span class="op" id="4592422">(</span><span class="ident" id="4592423">typ</span><span class="op" id="4592426">)</span>&nbsp;<span class="op" id="4592428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592433">return</span>&nbsp;<span class="ident" id="4592440">reflect</span><span class="op" id="4592447">.</span><span class="ident" id="4592448">Zero</span><span class="op" id="4592452">(</span><span class="ident" id="4592453">typ</span><span class="op" id="4592456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4592460">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592464">s</span><span class="op" id="4592465">.</span><span class="ident" id="4592466">errorf</span><span class="op" id="4592472">(</span><span class="string" id="4592473">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="4592498">,</span>&nbsp;<span class="ident" id="4592500">typ</span><span class="op" id="4592503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592506">case</span>&nbsp;<span class="op" id="4592511">*</span><span class="ident" id="4592512">parse</span><span class="op" id="4592517">.</span><span class="ident" id="4592518">FieldNode</span><span class="op" id="4592527">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592531">return</span>&nbsp;<span class="ident" id="4592538">s</span><span class="op" id="4592539">.</span><span class="ident" id="4592540">validateType</span><span class="op" id="4592552">(</span><span class="ident" id="4592553">s</span><span class="op" id="4592554">.</span><span class="ident" id="4592555">evalFieldNode</span><span class="op" id="4592568">(</span><span class="ident" id="4592569">dot</span><span class="op" id="4592572">,</span>&nbsp;<span class="ident" id="4592574">arg</span><span class="op" id="4592577">,</span>&nbsp;<span class="op" id="4592579">[</span><span class="op" id="4592580">]</span><span class="ident" id="4592581">parse</span><span class="op" id="4592586">.</span><span class="ident" id="4592587">Node</span><span class="op" id="4592591">{</span><span class="ident" id="4592592">n</span><span class="op" id="4592593">}</span><span class="op" id="4592594">,</span>&nbsp;<span class="ident" id="4592596">zero</span><span class="op" id="4592600">)</span><span class="op" id="4592601">,</span>&nbsp;<span class="ident" id="4592603">typ</span><span class="op" id="4592606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592609">case</span>&nbsp;<span class="op" id="4592614">*</span><span class="ident" id="4592615">parse</span><span class="op" id="4592620">.</span><span class="ident" id="4592621">VariableNode</span><span class="op" id="4592633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592637">return</span>&nbsp;<span class="ident" id="4592644">s</span><span class="op" id="4592645">.</span><span class="ident" id="4592646">validateType</span><span class="op" id="4592658">(</span><span class="ident" id="4592659">s</span><span class="op" id="4592660">.</span><span class="ident" id="4592661">evalVariableNode</span><span class="op" id="4592677">(</span><span class="ident" id="4592678">dot</span><span class="op" id="4592681">,</span>&nbsp;<span class="ident" id="4592683">arg</span><span class="op" id="4592686">,</span>&nbsp;<span class="builtintype" id="4592688">nil</span><span class="op" id="4592691">,</span>&nbsp;<span class="ident" id="4592693">zero</span><span class="op" id="4592697">)</span><span class="op" id="4592698">,</span>&nbsp;<span class="ident" id="4592700">typ</span><span class="op" id="4592703">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592706">case</span>&nbsp;<span class="op" id="4592711">*</span><span class="ident" id="4592712">parse</span><span class="op" id="4592717">.</span><span class="ident" id="4592718">PipeNode</span><span class="op" id="4592726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592730">return</span>&nbsp;<span class="ident" id="4592737">s</span><span class="op" id="4592738">.</span><span class="ident" id="4592739">validateType</span><span class="op" id="4592751">(</span><span class="ident" id="4592752">s</span><span class="op" id="4592753">.</span><span class="ident" id="4592754">evalPipeline</span><span class="op" id="4592766">(</span><span class="ident" id="4592767">dot</span><span class="op" id="4592770">,</span>&nbsp;<span class="ident" id="4592772">arg</span><span class="op" id="4592775">)</span><span class="op" id="4592776">,</span>&nbsp;<span class="ident" id="4592778">typ</span><span class="op" id="4592781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592784">case</span>&nbsp;<span class="op" id="4592789">*</span><span class="ident" id="4592790">parse</span><span class="op" id="4592795">.</span><span class="ident" id="4592796">IdentifierNode</span><span class="op" id="4592810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592814">return</span>&nbsp;<span class="ident" id="4592821">s</span><span class="op" id="4592822">.</span><span class="ident" id="4592823">evalFunction</span><span class="op" id="4592835">(</span><span class="ident" id="4592836">dot</span><span class="op" id="4592839">,</span>&nbsp;<span class="ident" id="4592841">arg</span><span class="op" id="4592844">,</span>&nbsp;<span class="ident" id="4592846">arg</span><span class="op" id="4592849">,</span>&nbsp;<span class="builtintype" id="4592851">nil</span><span class="op" id="4592854">,</span>&nbsp;<span class="ident" id="4592856">zero</span><span class="op" id="4592860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592863">case</span>&nbsp;<span class="op" id="4592868">*</span><span class="ident" id="4592869">parse</span><span class="op" id="4592874">.</span><span class="ident" id="4592875">ChainNode</span><span class="op" id="4592884">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592888">return</span>&nbsp;<span class="ident" id="4592895">s</span><span class="op" id="4592896">.</span><span class="ident" id="4592897">validateType</span><span class="op" id="4592909">(</span><span class="ident" id="4592910">s</span><span class="op" id="4592911">.</span><span class="ident" id="4592912">evalChainNode</span><span class="op" id="4592925">(</span><span class="ident" id="4592926">dot</span><span class="op" id="4592929">,</span>&nbsp;<span class="ident" id="4592931">arg</span><span class="op" id="4592934">,</span>&nbsp;<span class="builtintype" id="4592936">nil</span><span class="op" id="4592939">,</span>&nbsp;<span class="ident" id="4592941">zero</span><span class="op" id="4592945">)</span><span class="op" id="4592946">,</span>&nbsp;<span class="ident" id="4592948">typ</span><span class="op" id="4592951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4592954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592957">switch</span>&nbsp;<span class="ident" id="4592964">typ</span><span class="op" id="4592967">.</span><span class="ident" id="4592968">Kind</span><span class="op" id="4592972">(</span><span class="op" id="4592973">)</span>&nbsp;<span class="op" id="4592975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592978">case</span>&nbsp;<span class="ident" id="4592983">reflect</span><span class="op" id="4592990">.</span><span class="ident" id="4592991">Bool</span><span class="op" id="4592995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592999">return</span>&nbsp;<span class="ident" id="4593006">s</span><span class="op" id="4593007">.</span><span class="ident" id="4593008">evalBool</span><span class="op" id="4593016">(</span><span class="ident" id="4593017">typ</span><span class="op" id="4593020">,</span>&nbsp;<span class="ident" id="4593022">n</span><span class="op" id="4593023">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593026">case</span>&nbsp;<span class="ident" id="4593031">reflect</span><span class="op" id="4593038">.</span><span class="ident" id="4593039">Complex64</span><span class="op" id="4593048">,</span>&nbsp;<span class="ident" id="4593050">reflect</span><span class="op" id="4593057">.</span><span class="ident" id="4593058">Complex128</span><span class="op" id="4593068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593072">return</span>&nbsp;<span class="ident" id="4593079">s</span><span class="op" id="4593080">.</span><span class="ident" id="4593081">evalComplex</span><span class="op" id="4593092">(</span><span class="ident" id="4593093">typ</span><span class="op" id="4593096">,</span>&nbsp;<span class="ident" id="4593098">n</span><span class="op" id="4593099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593102">case</span>&nbsp;<span class="ident" id="4593107">reflect</span><span class="op" id="4593114">.</span><span class="ident" id="4593115">Float32</span><span class="op" id="4593122">,</span>&nbsp;<span class="ident" id="4593124">reflect</span><span class="op" id="4593131">.</span><span class="ident" id="4593132">Float64</span><span class="op" id="4593139">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593143">return</span>&nbsp;<span class="ident" id="4593150">s</span><span class="op" id="4593151">.</span><span class="ident" id="4593152">evalFloat</span><span class="op" id="4593161">(</span><span class="ident" id="4593162">typ</span><span class="op" id="4593165">,</span>&nbsp;<span class="ident" id="4593167">n</span><span class="op" id="4593168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593171">case</span>&nbsp;<span class="ident" id="4593176">reflect</span><span class="op" id="4593183">.</span><span class="ident" id="4593184">Int</span><span class="op" id="4593187">,</span>&nbsp;<span class="ident" id="4593189">reflect</span><span class="op" id="4593196">.</span><span class="ident" id="4593197">Int8</span><span class="op" id="4593201">,</span>&nbsp;<span class="ident" id="4593203">reflect</span><span class="op" id="4593210">.</span><span class="ident" id="4593211">Int16</span><span class="op" id="4593216">,</span>&nbsp;<span class="ident" id="4593218">reflect</span><span class="op" id="4593225">.</span><span class="ident" id="4593226">Int32</span><span class="op" id="4593231">,</span>&nbsp;<span class="ident" id="4593233">reflect</span><span class="op" id="4593240">.</span><span class="ident" id="4593241">Int64</span><span class="op" id="4593246">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593250">return</span>&nbsp;<span class="ident" id="4593257">s</span><span class="op" id="4593258">.</span><span class="ident" id="4593259">evalInteger</span><span class="op" id="4593270">(</span><span class="ident" id="4593271">typ</span><span class="op" id="4593274">,</span>&nbsp;<span class="ident" id="4593276">n</span><span class="op" id="4593277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593280">case</span>&nbsp;<span class="ident" id="4593285">reflect</span><span class="op" id="4593292">.</span><span class="ident" id="4593293">Interface</span><span class="op" id="4593302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593306">if</span>&nbsp;<span class="ident" id="4593309">typ</span><span class="op" id="4593312">.</span><span class="ident" id="4593313">NumMethod</span><span class="op" id="4593322">(</span><span class="op" id="4593323">)</span>&nbsp;<span class="op" id="4593325">==</span>&nbsp;<span class="num" id="4593328">0</span>&nbsp;<span class="op" id="4593330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593335">return</span>&nbsp;<span class="ident" id="4593342">s</span><span class="op" id="4593343">.</span><span class="ident" id="4593344">evalEmptyInterface</span><span class="op" id="4593362">(</span><span class="ident" id="4593363">dot</span><span class="op" id="4593366">,</span>&nbsp;<span class="ident" id="4593368">n</span><span class="op" id="4593369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4593373">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593376">case</span>&nbsp;<span class="ident" id="4593381">reflect</span><span class="op" id="4593388">.</span><span class="ident" id="4593389">String</span><span class="op" id="4593395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593399">return</span>&nbsp;<span class="ident" id="4593406">s</span><span class="op" id="4593407">.</span><span class="ident" id="4593408">evalString</span><span class="op" id="4593418">(</span><span class="ident" id="4593419">typ</span><span class="op" id="4593422">,</span>&nbsp;<span class="ident" id="4593424">n</span><span class="op" id="4593425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593428">case</span>&nbsp;<span class="ident" id="4593433">reflect</span><span class="op" id="4593440">.</span><span class="ident" id="4593441">Uint</span><span class="op" id="4593445">,</span>&nbsp;<span class="ident" id="4593447">reflect</span><span class="op" id="4593454">.</span><span class="ident" id="4593455">Uint8</span><span class="op" id="4593460">,</span>&nbsp;<span class="ident" id="4593462">reflect</span><span class="op" id="4593469">.</span><span class="ident" id="4593470">Uint16</span><span class="op" id="4593476">,</span>&nbsp;<span class="ident" id="4593478">reflect</span><span class="op" id="4593485">.</span><span class="ident" id="4593486">Uint32</span><span class="op" id="4593492">,</span>&nbsp;<span class="ident" id="4593494">reflect</span><span class="op" id="4593501">.</span><span class="ident" id="4593502">Uint64</span><span class="op" id="4593508">,</span>&nbsp;<span class="ident" id="4593510">reflect</span><span class="op" id="4593517">.</span><span class="ident" id="4593518">Uintptr</span><span class="op" id="4593525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593529">return</span>&nbsp;<span class="ident" id="4593536">s</span><span class="op" id="4593537">.</span><span class="ident" id="4593538">evalUnsignedInteger</span><span class="op" id="4593557">(</span><span class="ident" id="4593558">typ</span><span class="op" id="4593561">,</span>&nbsp;<span class="ident" id="4593563">n</span><span class="op" id="4593564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4593567">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593570">s</span><span class="op" id="4593571">.</span><span class="ident" id="4593572">errorf</span><span class="op" id="4593578">(</span><span class="string" id="4593579">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4593615">,</span>&nbsp;<span class="ident" id="4593617">n</span><span class="op" id="4593618">,</span>&nbsp;<span class="ident" id="4593620">typ</span><span class="op" id="4593623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4593626">panic</span><span class="op" id="4593631">(</span><span class="string" id="4593632">&#34;not&nbsp;reached&#34;</span><span class="op" id="4593645">)</span><br>
<span class="lineno"></span><span class="op" id="4593647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4593650">func</span>&nbsp;<span class="op" id="4593655">(</span><span class="ident" id="4593656">s</span>&nbsp;<span class="op" id="4593658">*</span><span class="ident" id="4593659">state</span><span class="op" id="4593664">)</span>&nbsp;<span class="ident" id="4593666">evalBool</span><span class="op" id="4593674">(</span><span class="ident" id="4593675">typ</span>&nbsp;<span class="ident" id="4593679">reflect</span><span class="op" id="4593686">.</span><span class="ident" id="4593687">Type</span><span class="op" id="4593691">,</span>&nbsp;<span class="ident" id="4593693">n</span>&nbsp;<span class="ident" id="4593695">parse</span><span class="op" id="4593700">.</span><span class="ident" id="4593701">Node</span><span class="op" id="4593705">)</span>&nbsp;<span class="ident" id="4593707">reflect</span><span class="op" id="4593714">.</span><span class="ident" id="4593715">Value</span>&nbsp;<span class="op" id="4593721">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593724">s</span><span class="op" id="4593725">.</span><span class="ident" id="4593726">at</span><span class="op" id="4593728">(</span><span class="ident" id="4593729">n</span><span class="op" id="4593730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593733">if</span>&nbsp;<span class="ident" id="4593736">n</span><span class="op" id="4593737">,</span>&nbsp;<span class="ident" id="4593739">ok</span>&nbsp;<span class="op" id="4593742">:=</span>&nbsp;<span class="ident" id="4593745">n</span><span class="op" id="4593746">.</span><span class="op" id="4593747">(</span><span class="op" id="4593748">*</span><span class="ident" id="4593749">parse</span><span class="op" id="4593754">.</span><span class="ident" id="4593755">BoolNode</span><span class="op" id="4593763">)</span><span class="op" id="4593764">;</span>&nbsp;<span class="ident" id="4593766">ok</span>&nbsp;<span class="op" id="4593769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593773">value</span>&nbsp;<span class="op" id="4593779">:=</span>&nbsp;<span class="ident" id="4593782">reflect</span><span class="op" id="4593789">.</span><span class="ident" id="4593790">New</span><span class="op" id="4593793">(</span><span class="ident" id="4593794">typ</span><span class="op" id="4593797">)</span><span class="op" id="4593798">.</span><span class="ident" id="4593799">Elem</span><span class="op" id="4593803">(</span><span class="op" id="4593804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593808">value</span><span class="op" id="4593813">.</span><span class="ident" id="4593814">SetBool</span><span class="op" id="4593821">(</span><span class="ident" id="4593822">n</span><span class="op" id="4593823">.</span><span class="ident" id="4593824">True</span><span class="op" id="4593828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593832">return</span>&nbsp;<span class="ident" id="4593839">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4593846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593849">s</span><span class="op" id="4593850">.</span><span class="ident" id="4593851">errorf</span><span class="op" id="4593857">(</span><span class="string" id="4593858">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4593883">,</span>&nbsp;<span class="ident" id="4593885">n</span><span class="op" id="4593886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4593889">panic</span><span class="op" id="4593894">(</span><span class="string" id="4593895">&#34;not&nbsp;reached&#34;</span><span class="op" id="4593908">)</span><br>
<span class="lineno"></span><span class="op" id="4593910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="4593913">func</span>&nbsp;<span class="op" id="4593918">(</span><span class="ident" id="4593919">s</span>&nbsp;<span class="op" id="4593921">*</span><span class="ident" id="4593922">state</span><span class="op" id="4593927">)</span>&nbsp;<span class="ident" id="4593929">evalString</span><span class="op" id="4593939">(</span><span class="ident" id="4593940">typ</span>&nbsp;<span class="ident" id="4593944">reflect</span><span class="op" id="4593951">.</span><span class="ident" id="4593952">Type</span><span class="op" id="4593956">,</span>&nbsp;<span class="ident" id="4593958">n</span>&nbsp;<span class="ident" id="4593960">parse</span><span class="op" id="4593965">.</span><span class="ident" id="4593966">Node</span><span class="op" id="4593970">)</span>&nbsp;<span class="ident" id="4593972">reflect</span><span class="op" id="4593979">.</span><span class="ident" id="4593980">Value</span>&nbsp;<span class="op" id="4593986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593989">s</span><span class="op" id="4593990">.</span><span class="ident" id="4593991">at</span><span class="op" id="4593993">(</span><span class="ident" id="4593994">n</span><span class="op" id="4593995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593998">if</span>&nbsp;<span class="ident" id="4594001">n</span><span class="op" id="4594002">,</span>&nbsp;<span class="ident" id="4594004">ok</span>&nbsp;<span class="op" id="4594007">:=</span>&nbsp;<span class="ident" id="4594010">n</span><span class="op" id="4594011">.</span><span class="op" id="4594012">(</span><span class="op" id="4594013">*</span><span class="ident" id="4594014">parse</span><span class="op" id="4594019">.</span><span class="ident" id="4594020">StringNode</span><span class="op" id="4594030">)</span><span class="op" id="4594031">;</span>&nbsp;<span class="ident" id="4594033">ok</span>&nbsp;<span class="op" id="4594036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594040">value</span>&nbsp;<span class="op" id="4594046">:=</span>&nbsp;<span class="ident" id="4594049">reflect</span><span class="op" id="4594056">.</span><span class="ident" id="4594057">New</span><span class="op" id="4594060">(</span><span class="ident" id="4594061">typ</span><span class="op" id="4594064">)</span><span class="op" id="4594065">.</span><span class="ident" id="4594066">Elem</span><span class="op" id="4594070">(</span><span class="op" id="4594071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594075">value</span><span class="op" id="4594080">.</span><span class="ident" id="4594081">SetString</span><span class="op" id="4594090">(</span><span class="ident" id="4594091">n</span><span class="op" id="4594092">.</span><span class="ident" id="4594093">Text</span><span class="op" id="4594097">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594101">return</span>&nbsp;<span class="ident" id="4594108">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594118">s</span><span class="op" id="4594119">.</span><span class="ident" id="4594120">errorf</span><span class="op" id="4594126">(</span><span class="string" id="4594127">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4594154">,</span>&nbsp;<span class="ident" id="4594156">n</span><span class="op" id="4594157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4594160">panic</span><span class="op" id="4594165">(</span><span class="string" id="4594166">&#34;not&nbsp;reached&#34;</span><span class="op" id="4594179">)</span><br>
<span class="lineno"></span><span class="op" id="4594181">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="4594184">func</span>&nbsp;<span class="op" id="4594189">(</span><span class="ident" id="4594190">s</span>&nbsp;<span class="op" id="4594192">*</span><span class="ident" id="4594193">state</span><span class="op" id="4594198">)</span>&nbsp;<span class="ident" id="4594200">evalInteger</span><span class="op" id="4594211">(</span><span class="ident" id="4594212">typ</span>&nbsp;<span class="ident" id="4594216">reflect</span><span class="op" id="4594223">.</span><span class="ident" id="4594224">Type</span><span class="op" id="4594228">,</span>&nbsp;<span class="ident" id="4594230">n</span>&nbsp;<span class="ident" id="4594232">parse</span><span class="op" id="4594237">.</span><span class="ident" id="4594238">Node</span><span class="op" id="4594242">)</span>&nbsp;<span class="ident" id="4594244">reflect</span><span class="op" id="4594251">.</span><span class="ident" id="4594252">Value</span>&nbsp;<span class="op" id="4594258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594261">s</span><span class="op" id="4594262">.</span><span class="ident" id="4594263">at</span><span class="op" id="4594265">(</span><span class="ident" id="4594266">n</span><span class="op" id="4594267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594270">if</span>&nbsp;<span class="ident" id="4594273">n</span><span class="op" id="4594274">,</span>&nbsp;<span class="ident" id="4594276">ok</span>&nbsp;<span class="op" id="4594279">:=</span>&nbsp;<span class="ident" id="4594282">n</span><span class="op" id="4594283">.</span><span class="op" id="4594284">(</span><span class="op" id="4594285">*</span><span class="ident" id="4594286">parse</span><span class="op" id="4594291">.</span><span class="ident" id="4594292">NumberNode</span><span class="op" id="4594302">)</span><span class="op" id="4594303">;</span>&nbsp;<span class="ident" id="4594305">ok</span>&nbsp;<span class="op" id="4594308">&amp;&amp;</span>&nbsp;<span class="ident" id="4594311">n</span><span class="op" id="4594312">.</span><span class="ident" id="4594313">IsInt</span>&nbsp;<span class="op" id="4594319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594323">value</span>&nbsp;<span class="op" id="4594329">:=</span>&nbsp;<span class="ident" id="4594332">reflect</span><span class="op" id="4594339">.</span><span class="ident" id="4594340">New</span><span class="op" id="4594343">(</span><span class="ident" id="4594344">typ</span><span class="op" id="4594347">)</span><span class="op" id="4594348">.</span><span class="ident" id="4594349">Elem</span><span class="op" id="4594353">(</span><span class="op" id="4594354">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594358">value</span><span class="op" id="4594363">.</span><span class="ident" id="4594364">SetInt</span><span class="op" id="4594370">(</span><span class="ident" id="4594371">n</span><span class="op" id="4594372">.</span><span class="ident" id="4594373">Int64</span><span class="op" id="4594378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594382">return</span>&nbsp;<span class="ident" id="4594389">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594399">s</span><span class="op" id="4594400">.</span><span class="ident" id="4594401">errorf</span><span class="op" id="4594407">(</span><span class="string" id="4594408">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4594436">,</span>&nbsp;<span class="ident" id="4594438">n</span><span class="op" id="4594439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4594442">panic</span><span class="op" id="4594447">(</span><span class="string" id="4594448">&#34;not&nbsp;reached&#34;</span><span class="op" id="4594461">)</span><br>
<span class="lineno">695</span><span class="op" id="4594463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594466">func</span>&nbsp;<span class="op" id="4594471">(</span><span class="ident" id="4594472">s</span>&nbsp;<span class="op" id="4594474">*</span><span class="ident" id="4594475">state</span><span class="op" id="4594480">)</span>&nbsp;<span class="ident" id="4594482">evalUnsignedInteger</span><span class="op" id="4594501">(</span><span class="ident" id="4594502">typ</span>&nbsp;<span class="ident" id="4594506">reflect</span><span class="op" id="4594513">.</span><span class="ident" id="4594514">Type</span><span class="op" id="4594518">,</span>&nbsp;<span class="ident" id="4594520">n</span>&nbsp;<span class="ident" id="4594522">parse</span><span class="op" id="4594527">.</span><span class="ident" id="4594528">Node</span><span class="op" id="4594532">)</span>&nbsp;<span class="ident" id="4594534">reflect</span><span class="op" id="4594541">.</span><span class="ident" id="4594542">Value</span>&nbsp;<span class="op" id="4594548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594551">s</span><span class="op" id="4594552">.</span><span class="ident" id="4594553">at</span><span class="op" id="4594555">(</span><span class="ident" id="4594556">n</span><span class="op" id="4594557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594560">if</span>&nbsp;<span class="ident" id="4594563">n</span><span class="op" id="4594564">,</span>&nbsp;<span class="ident" id="4594566">ok</span>&nbsp;<span class="op" id="4594569">:=</span>&nbsp;<span class="ident" id="4594572">n</span><span class="op" id="4594573">.</span><span class="op" id="4594574">(</span><span class="op" id="4594575">*</span><span class="ident" id="4594576">parse</span><span class="op" id="4594581">.</span><span class="ident" id="4594582">NumberNode</span><span class="op" id="4594592">)</span><span class="op" id="4594593">;</span>&nbsp;<span class="ident" id="4594595">ok</span>&nbsp;<span class="op" id="4594598">&amp;&amp;</span>&nbsp;<span class="ident" id="4594601">n</span><span class="op" id="4594602">.</span><span class="ident" id="4594603">IsUint</span>&nbsp;<span class="op" id="4594610">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594614">value</span>&nbsp;<span class="op" id="4594620">:=</span>&nbsp;<span class="ident" id="4594623">reflect</span><span class="op" id="4594630">.</span><span class="ident" id="4594631">New</span><span class="op" id="4594634">(</span><span class="ident" id="4594635">typ</span><span class="op" id="4594638">)</span><span class="op" id="4594639">.</span><span class="ident" id="4594640">Elem</span><span class="op" id="4594644">(</span><span class="op" id="4594645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594649">value</span><span class="op" id="4594654">.</span><span class="ident" id="4594655">SetUint</span><span class="op" id="4594662">(</span><span class="ident" id="4594663">n</span><span class="op" id="4594664">.</span><span class="ident" id="4594665">Uint64</span><span class="op" id="4594671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594675">return</span>&nbsp;<span class="ident" id="4594682">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594692">s</span><span class="op" id="4594693">.</span><span class="ident" id="4594694">errorf</span><span class="op" id="4594700">(</span><span class="string" id="4594701">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4594738">,</span>&nbsp;<span class="ident" id="4594740">n</span><span class="op" id="4594741">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4594744">panic</span><span class="op" id="4594749">(</span><span class="string" id="4594750">&#34;not&nbsp;reached&#34;</span><span class="op" id="4594763">)</span><br>
<span class="lineno"></span><span class="op" id="4594765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594768">func</span>&nbsp;<span class="op" id="4594773">(</span><span class="ident" id="4594774">s</span>&nbsp;<span class="op" id="4594776">*</span><span class="ident" id="4594777">state</span><span class="op" id="4594782">)</span>&nbsp;<span class="ident" id="4594784">evalFloat</span><span class="op" id="4594793">(</span><span class="ident" id="4594794">typ</span>&nbsp;<span class="ident" id="4594798">reflect</span><span class="op" id="4594805">.</span><span class="ident" id="4594806">Type</span><span class="op" id="4594810">,</span>&nbsp;<span class="ident" id="4594812">n</span>&nbsp;<span class="ident" id="4594814">parse</span><span class="op" id="4594819">.</span><span class="ident" id="4594820">Node</span><span class="op" id="4594824">)</span>&nbsp;<span class="ident" id="4594826">reflect</span><span class="op" id="4594833">.</span><span class="ident" id="4594834">Value</span>&nbsp;<span class="op" id="4594840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594843">s</span><span class="op" id="4594844">.</span><span class="ident" id="4594845">at</span><span class="op" id="4594847">(</span><span class="ident" id="4594848">n</span><span class="op" id="4594849">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594852">if</span>&nbsp;<span class="ident" id="4594855">n</span><span class="op" id="4594856">,</span>&nbsp;<span class="ident" id="4594858">ok</span>&nbsp;<span class="op" id="4594861">:=</span>&nbsp;<span class="ident" id="4594864">n</span><span class="op" id="4594865">.</span><span class="op" id="4594866">(</span><span class="op" id="4594867">*</span><span class="ident" id="4594868">parse</span><span class="op" id="4594873">.</span><span class="ident" id="4594874">NumberNode</span><span class="op" id="4594884">)</span><span class="op" id="4594885">;</span>&nbsp;<span class="ident" id="4594887">ok</span>&nbsp;<span class="op" id="4594890">&amp;&amp;</span>&nbsp;<span class="ident" id="4594893">n</span><span class="op" id="4594894">.</span><span class="ident" id="4594895">IsFloat</span>&nbsp;<span class="op" id="4594903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594907">value</span>&nbsp;<span class="op" id="4594913">:=</span>&nbsp;<span class="ident" id="4594916">reflect</span><span class="op" id="4594923">.</span><span class="ident" id="4594924">New</span><span class="op" id="4594927">(</span><span class="ident" id="4594928">typ</span><span class="op" id="4594931">)</span><span class="op" id="4594932">.</span><span class="ident" id="4594933">Elem</span><span class="op" id="4594937">(</span><span class="op" id="4594938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594942">value</span><span class="op" id="4594947">.</span><span class="ident" id="4594948">SetFloat</span><span class="op" id="4594956">(</span><span class="ident" id="4594957">n</span><span class="op" id="4594958">.</span><span class="ident" id="4594959">Float64</span><span class="op" id="4594966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4594970">return</span>&nbsp;<span class="ident" id="4594977">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594984">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594987">s</span><span class="op" id="4594988">.</span><span class="ident" id="4594989">errorf</span><span class="op" id="4594995">(</span><span class="string" id="4594996">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4595022">,</span>&nbsp;<span class="ident" id="4595024">n</span><span class="op" id="4595025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4595028">panic</span><span class="op" id="4595033">(</span><span class="string" id="4595034">&#34;not&nbsp;reached&#34;</span><span class="op" id="4595047">)</span><br>
<span class="lineno"></span><span class="op" id="4595049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4595052">func</span>&nbsp;<span class="op" id="4595057">(</span><span class="ident" id="4595058">s</span>&nbsp;<span class="op" id="4595060">*</span><span class="ident" id="4595061">state</span><span class="op" id="4595066">)</span>&nbsp;<span class="ident" id="4595068">evalComplex</span><span class="op" id="4595079">(</span><span class="ident" id="4595080">typ</span>&nbsp;<span class="ident" id="4595084">reflect</span><span class="op" id="4595091">.</span><span class="ident" id="4595092">Type</span><span class="op" id="4595096">,</span>&nbsp;<span class="ident" id="4595098">n</span>&nbsp;<span class="ident" id="4595100">parse</span><span class="op" id="4595105">.</span><span class="ident" id="4595106">Node</span><span class="op" id="4595110">)</span>&nbsp;<span class="ident" id="4595112">reflect</span><span class="op" id="4595119">.</span><span class="ident" id="4595120">Value</span>&nbsp;<span class="op" id="4595126">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595129">if</span>&nbsp;<span class="ident" id="4595132">n</span><span class="op" id="4595133">,</span>&nbsp;<span class="ident" id="4595135">ok</span>&nbsp;<span class="op" id="4595138">:=</span>&nbsp;<span class="ident" id="4595141">n</span><span class="op" id="4595142">.</span><span class="op" id="4595143">(</span><span class="op" id="4595144">*</span><span class="ident" id="4595145">parse</span><span class="op" id="4595150">.</span><span class="ident" id="4595151">NumberNode</span><span class="op" id="4595161">)</span><span class="op" id="4595162">;</span>&nbsp;<span class="ident" id="4595164">ok</span>&nbsp;<span class="op" id="4595167">&amp;&amp;</span>&nbsp;<span class="ident" id="4595170">n</span><span class="op" id="4595171">.</span><span class="ident" id="4595172">IsComplex</span>&nbsp;<span class="op" id="4595182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595186">value</span>&nbsp;<span class="op" id="4595192">:=</span>&nbsp;<span class="ident" id="4595195">reflect</span><span class="op" id="4595202">.</span><span class="ident" id="4595203">New</span><span class="op" id="4595206">(</span><span class="ident" id="4595207">typ</span><span class="op" id="4595210">)</span><span class="op" id="4595211">.</span><span class="ident" id="4595212">Elem</span><span class="op" id="4595216">(</span><span class="op" id="4595217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595221">value</span><span class="op" id="4595226">.</span><span class="ident" id="4595227">SetComplex</span><span class="op" id="4595237">(</span><span class="ident" id="4595238">n</span><span class="op" id="4595239">.</span><span class="ident" id="4595240">Complex128</span><span class="op" id="4595250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595254">return</span>&nbsp;<span class="ident" id="4595261">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4595268">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595271">s</span><span class="op" id="4595272">.</span><span class="ident" id="4595273">errorf</span><span class="op" id="4595279">(</span><span class="string" id="4595280">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4595308">,</span>&nbsp;<span class="ident" id="4595310">n</span><span class="op" id="4595311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4595314">panic</span><span class="op" id="4595319">(</span><span class="string" id="4595320">&#34;not&nbsp;reached&#34;</span><span class="op" id="4595333">)</span><br>
<span class="lineno"></span><span class="op" id="4595335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4595338">func</span>&nbsp;<span class="op" id="4595343">(</span><span class="ident" id="4595344">s</span>&nbsp;<span class="op" id="4595346">*</span><span class="ident" id="4595347">state</span><span class="op" id="4595352">)</span>&nbsp;<span class="ident" id="4595354">evalEmptyInterface</span><span class="op" id="4595372">(</span><span class="ident" id="4595373">dot</span>&nbsp;<span class="ident" id="4595377">reflect</span><span class="op" id="4595384">.</span><span class="ident" id="4595385">Value</span><span class="op" id="4595390">,</span>&nbsp;<span class="ident" id="4595392">n</span>&nbsp;<span class="ident" id="4595394">parse</span><span class="op" id="4595399">.</span><span class="ident" id="4595400">Node</span><span class="op" id="4595404">)</span>&nbsp;<span class="ident" id="4595406">reflect</span><span class="op" id="4595413">.</span><span class="ident" id="4595414">Value</span>&nbsp;<span class="op" id="4595420">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595423">s</span><span class="op" id="4595424">.</span><span class="ident" id="4595425">at</span><span class="op" id="4595427">(</span><span class="ident" id="4595428">n</span><span class="op" id="4595429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595432">switch</span>&nbsp;<span class="ident" id="4595439">n</span>&nbsp;<span class="op" id="4595441">:=</span>&nbsp;<span class="ident" id="4595444">n</span><span class="op" id="4595445">.</span><span class="op" id="4595446">(</span><span class="keyword" id="4595447">type</span><span class="op" id="4595451">)</span>&nbsp;<span class="op" id="4595453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595456">case</span>&nbsp;<span class="op" id="4595461">*</span><span class="ident" id="4595462">parse</span><span class="op" id="4595467">.</span><span class="ident" id="4595468">BoolNode</span><span class="op" id="4595476">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595480">return</span>&nbsp;<span class="ident" id="4595487">reflect</span><span class="op" id="4595494">.</span><span class="ident" id="4595495">ValueOf</span><span class="op" id="4595502">(</span><span class="ident" id="4595503">n</span><span class="op" id="4595504">.</span><span class="ident" id="4595505">True</span><span class="op" id="4595509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595512">case</span>&nbsp;<span class="op" id="4595517">*</span><span class="ident" id="4595518">parse</span><span class="op" id="4595523">.</span><span class="ident" id="4595524">DotNode</span><span class="op" id="4595531">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595535">return</span>&nbsp;<span class="ident" id="4595542">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595547">case</span>&nbsp;<span class="op" id="4595552">*</span><span class="ident" id="4595553">parse</span><span class="op" id="4595558">.</span><span class="ident" id="4595559">FieldNode</span><span class="op" id="4595568">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595572">return</span>&nbsp;<span class="ident" id="4595579">s</span><span class="op" id="4595580">.</span><span class="ident" id="4595581">evalFieldNode</span><span class="op" id="4595594">(</span><span class="ident" id="4595595">dot</span><span class="op" id="4595598">,</span>&nbsp;<span class="ident" id="4595600">n</span><span class="op" id="4595601">,</span>&nbsp;<span class="builtintype" id="4595603">nil</span><span class="op" id="4595606">,</span>&nbsp;<span class="ident" id="4595608">zero</span><span class="op" id="4595612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595615">case</span>&nbsp;<span class="op" id="4595620">*</span><span class="ident" id="4595621">parse</span><span class="op" id="4595626">.</span><span class="ident" id="4595627">IdentifierNode</span><span class="op" id="4595641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595645">return</span>&nbsp;<span class="ident" id="4595652">s</span><span class="op" id="4595653">.</span><span class="ident" id="4595654">evalFunction</span><span class="op" id="4595666">(</span><span class="ident" id="4595667">dot</span><span class="op" id="4595670">,</span>&nbsp;<span class="ident" id="4595672">n</span><span class="op" id="4595673">,</span>&nbsp;<span class="ident" id="4595675">n</span><span class="op" id="4595676">,</span>&nbsp;<span class="builtintype" id="4595678">nil</span><span class="op" id="4595681">,</span>&nbsp;<span class="ident" id="4595683">zero</span><span class="op" id="4595687">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595690">case</span>&nbsp;<span class="op" id="4595695">*</span><span class="ident" id="4595696">parse</span><span class="op" id="4595701">.</span><span class="ident" id="4595702">NilNode</span><span class="op" id="4595709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4595713">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595781">s</span><span class="op" id="4595782">.</span><span class="ident" id="4595783">errorf</span><span class="op" id="4595789">(</span><span class="string" id="4595790">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="4595830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595833">case</span>&nbsp;<span class="op" id="4595838">*</span><span class="ident" id="4595839">parse</span><span class="op" id="4595844">.</span><span class="ident" id="4595845">NumberNode</span><span class="op" id="4595855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595859">return</span>&nbsp;<span class="ident" id="4595866">s</span><span class="op" id="4595867">.</span><span class="ident" id="4595868">idealConstant</span><span class="op" id="4595881">(</span><span class="ident" id="4595882">n</span><span class="op" id="4595883">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595886">case</span>&nbsp;<span class="op" id="4595891">*</span><span class="ident" id="4595892">parse</span><span class="op" id="4595897">.</span><span class="ident" id="4595898">StringNode</span><span class="op" id="4595908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595912">return</span>&nbsp;<span class="ident" id="4595919">reflect</span><span class="op" id="4595926">.</span><span class="ident" id="4595927">ValueOf</span><span class="op" id="4595934">(</span><span class="ident" id="4595935">n</span><span class="op" id="4595936">.</span><span class="ident" id="4595937">Text</span><span class="op" id="4595941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595944">case</span>&nbsp;<span class="op" id="4595949">*</span><span class="ident" id="4595950">parse</span><span class="op" id="4595955">.</span><span class="ident" id="4595956">VariableNode</span><span class="op" id="4595968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595972">return</span>&nbsp;<span class="ident" id="4595979">s</span><span class="op" id="4595980">.</span><span class="ident" id="4595981">evalVariableNode</span><span class="op" id="4595997">(</span><span class="ident" id="4595998">dot</span><span class="op" id="4596001">,</span>&nbsp;<span class="ident" id="4596003">n</span><span class="op" id="4596004">,</span>&nbsp;<span class="builtintype" id="4596006">nil</span><span class="op" id="4596009">,</span>&nbsp;<span class="ident" id="4596011">zero</span><span class="op" id="4596015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596018">case</span>&nbsp;<span class="op" id="4596023">*</span><span class="ident" id="4596024">parse</span><span class="op" id="4596029">.</span><span class="ident" id="4596030">PipeNode</span><span class="op" id="4596038">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596042">return</span>&nbsp;<span class="ident" id="4596049">s</span><span class="op" id="4596050">.</span><span class="ident" id="4596051">evalPipeline</span><span class="op" id="4596063">(</span><span class="ident" id="4596064">dot</span><span class="op" id="4596067">,</span>&nbsp;<span class="ident" id="4596069">n</span><span class="op" id="4596070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596076">s</span><span class="op" id="4596077">.</span><span class="ident" id="4596078">errorf</span><span class="op" id="4596084">(</span><span class="string" id="4596085">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="4596144">,</span>&nbsp;<span class="ident" id="4596146">n</span><span class="op" id="4596147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4596150">panic</span><span class="op" id="4596155">(</span><span class="string" id="4596156">&#34;not&nbsp;reached&#34;</span><span class="op" id="4596169">)</span><br>
<span class="lineno"></span><span class="op" id="4596171">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="4596174">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="4596266">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="4596334">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="4596386">func</span>&nbsp;<span class="ident" id="4596391">indirect</span><span class="op" id="4596399">(</span><span class="ident" id="4596400">v</span>&nbsp;<span class="ident" id="4596402">reflect</span><span class="op" id="4596409">.</span><span class="ident" id="4596410">Value</span><span class="op" id="4596415">)</span>&nbsp;<span class="op" id="4596417">(</span><span class="ident" id="4596418">rv</span>&nbsp;<span class="ident" id="4596421">reflect</span><span class="op" id="4596428">.</span><span class="ident" id="4596429">Value</span><span class="op" id="4596434">,</span>&nbsp;<span class="ident" id="4596436">isNil</span>&nbsp;<span class="builtintype" id="4596442">bool</span><span class="op" id="4596446">)</span>&nbsp;<span class="op" id="4596448">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596451">for</span>&nbsp;<span class="op" id="4596455">;</span>&nbsp;<span class="ident" id="4596457">v</span><span class="op" id="4596458">.</span><span class="ident" id="4596459">Kind</span><span class="op" id="4596463">(</span><span class="op" id="4596464">)</span>&nbsp;<span class="op" id="4596466">==</span>&nbsp;<span class="ident" id="4596469">reflect</span><span class="op" id="4596476">.</span><span class="ident" id="4596477">Ptr</span>&nbsp;<span class="op" id="4596481">||</span>&nbsp;<span class="ident" id="4596484">v</span><span class="op" id="4596485">.</span><span class="ident" id="4596486">Kind</span><span class="op" id="4596490">(</span><span class="op" id="4596491">)</span>&nbsp;<span class="op" id="4596493">==</span>&nbsp;<span class="ident" id="4596496">reflect</span><span class="op" id="4596503">.</span><span class="ident" id="4596504">Interface</span><span class="op" id="4596513">;</span>&nbsp;<span class="ident" id="4596515">v</span>&nbsp;<span class="op" id="4596517">=</span>&nbsp;<span class="ident" id="4596519">v</span><span class="op" id="4596520">.</span><span class="ident" id="4596521">Elem</span><span class="op" id="4596525">(</span><span class="op" id="4596526">)</span>&nbsp;<span class="op" id="4596528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596532">if</span>&nbsp;<span class="ident" id="4596535">v</span><span class="op" id="4596536">.</span><span class="ident" id="4596537">IsNil</span><span class="op" id="4596542">(</span><span class="op" id="4596543">)</span>&nbsp;<span class="op" id="4596545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596550">return</span>&nbsp;<span class="ident" id="4596557">v</span><span class="op" id="4596558">,</span>&nbsp;<span class="builtintype" id="4596560">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596571">if</span>&nbsp;<span class="ident" id="4596574">v</span><span class="op" id="4596575">.</span><span class="ident" id="4596576">Kind</span><span class="op" id="4596580">(</span><span class="op" id="4596581">)</span>&nbsp;<span class="op" id="4596583">==</span>&nbsp;<span class="ident" id="4596586">reflect</span><span class="op" id="4596593">.</span><span class="ident" id="4596594">Interface</span>&nbsp;<span class="op" id="4596604">&amp;&amp;</span>&nbsp;<span class="ident" id="4596607">v</span><span class="op" id="4596608">.</span><span class="ident" id="4596609">NumMethod</span><span class="op" id="4596618">(</span><span class="op" id="4596619">)</span>&nbsp;<span class="op" id="4596621">&gt;</span>&nbsp;<span class="num" id="4596623">0</span>&nbsp;<span class="op" id="4596625">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596630">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596644">return</span>&nbsp;<span class="ident" id="4596651">v</span><span class="op" id="4596652">,</span>&nbsp;<span class="builtintype" id="4596654">false</span><br>
<span class="lineno"></span><span class="op" id="4596660">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="4596663">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4596741">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4596758">func</span>&nbsp;<span class="op" id="4596763">(</span><span class="ident" id="4596764">s</span>&nbsp;<span class="op" id="4596766">*</span><span class="ident" id="4596767">state</span><span class="op" id="4596772">)</span>&nbsp;<span class="ident" id="4596774">printValue</span><span class="op" id="4596784">(</span><span class="ident" id="4596785">n</span>&nbsp;<span class="ident" id="4596787">parse</span><span class="op" id="4596792">.</span><span class="ident" id="4596793">Node</span><span class="op" id="4596797">,</span>&nbsp;<span class="ident" id="4596799">v</span>&nbsp;<span class="ident" id="4596801">reflect</span><span class="op" id="4596808">.</span><span class="ident" id="4596809">Value</span><span class="op" id="4596814">)</span>&nbsp;<span class="op" id="4596816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596819">s</span><span class="op" id="4596820">.</span><span class="ident" id="4596821">at</span><span class="op" id="4596823">(</span><span class="ident" id="4596824">n</span><span class="op" id="4596825">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596828">iface</span><span class="op" id="4596833">,</span>&nbsp;<span class="ident" id="4596835">ok</span>&nbsp;<span class="op" id="4596838">:=</span>&nbsp;<span class="ident" id="4596841">printableValue</span><span class="op" id="4596855">(</span><span class="ident" id="4596856">v</span><span class="op" id="4596857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596860">if</span>&nbsp;<span class="op" id="4596863">!</span><span class="ident" id="4596864">ok</span>&nbsp;<span class="op" id="4596867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596871">s</span><span class="op" id="4596872">.</span><span class="ident" id="4596873">errorf</span><span class="op" id="4596879">(</span><span class="string" id="4596880">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4596907">,</span>&nbsp;<span class="ident" id="4596909">n</span><span class="op" id="4596910">,</span>&nbsp;<span class="ident" id="4596912">v</span><span class="op" id="4596913">.</span><span class="ident" id="4596914">Type</span><span class="op" id="4596918">(</span><span class="op" id="4596919">)</span><span class="op" id="4596920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596926">fmt</span><span class="op" id="4596929">.</span><span class="ident" id="4596930">Fprint</span><span class="op" id="4596936">(</span><span class="ident" id="4596937">s</span><span class="op" id="4596938">.</span><span class="ident" id="4596939">wr</span><span class="op" id="4596941">,</span>&nbsp;<span class="ident" id="4596943">iface</span><span class="op" id="4596948">)</span><br>
<span class="lineno">780</span><span class="op" id="4596950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4596953">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4597035">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="4597079">func</span>&nbsp;<span class="ident" id="4597084">printableValue</span><span class="op" id="4597098">(</span><span class="ident" id="4597099">v</span>&nbsp;<span class="ident" id="4597101">reflect</span><span class="op" id="4597108">.</span><span class="ident" id="4597109">Value</span><span class="op" id="4597114">)</span>&nbsp;<span class="op" id="4597116">(</span><span class="keyword" id="4597117">interface</span><span class="op" id="4597126">{</span><span class="op" id="4597127">}</span><span class="op" id="4597128">,</span>&nbsp;<span class="builtintype" id="4597130">bool</span><span class="op" id="4597134">)</span>&nbsp;<span class="op" id="4597136">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597139">if</span>&nbsp;<span class="ident" id="4597142">v</span><span class="op" id="4597143">.</span><span class="ident" id="4597144">Kind</span><span class="op" id="4597148">(</span><span class="op" id="4597149">)</span>&nbsp;<span class="op" id="4597151">==</span>&nbsp;<span class="ident" id="4597154">reflect</span><span class="op" id="4597161">.</span><span class="ident" id="4597162">Ptr</span>&nbsp;<span class="op" id="4597166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4597170">v</span><span class="op" id="4597171">,</span>&nbsp;<span class="ident" id="4597173">_</span>&nbsp;<span class="op" id="4597175">=</span>&nbsp;<span class="ident" id="4597177">indirect</span><span class="op" id="4597185">(</span><span class="ident" id="4597186">v</span><span class="op" id="4597187">)</span>&nbsp;<span class="comment" id="4597189">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4597217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597220">if</span>&nbsp;<span class="op" id="4597223">!</span><span class="ident" id="4597224">v</span><span class="op" id="4597225">.</span><span class="ident" id="4597226">IsValid</span><span class="op" id="4597233">(</span><span class="op" id="4597234">)</span>&nbsp;<span class="op" id="4597236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597240">return</span>&nbsp;<span class="string" id="4597247">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="4597259">,</span>&nbsp;<span class="builtintype" id="4597261">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4597267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597271">if</span>&nbsp;<span class="op" id="4597274">!</span><span class="ident" id="4597275">v</span><span class="op" id="4597276">.</span><span class="ident" id="4597277">Type</span><span class="op" id="4597281">(</span><span class="op" id="4597282">)</span><span class="op" id="4597283">.</span><span class="ident" id="4597284">Implements</span><span class="op" id="4597294">(</span><span class="ident" id="4597295">errorType</span><span class="op" id="4597304">)</span>&nbsp;<span class="op" id="4597306">&amp;&amp;</span>&nbsp;<span class="op" id="4597309">!</span><span class="ident" id="4597310">v</span><span class="op" id="4597311">.</span><span class="ident" id="4597312">Type</span><span class="op" id="4597316">(</span><span class="op" id="4597317">)</span><span class="op" id="4597318">.</span><span class="ident" id="4597319">Implements</span><span class="op" id="4597329">(</span><span class="ident" id="4597330">fmtStringerType</span><span class="op" id="4597345">)</span>&nbsp;<span class="op" id="4597347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597351">if</span>&nbsp;<span class="ident" id="4597354">v</span><span class="op" id="4597355">.</span><span class="ident" id="4597356">CanAddr</span><span class="op" id="4597363">(</span><span class="op" id="4597364">)</span>&nbsp;<span class="op" id="4597366">&amp;&amp;</span>&nbsp;<span class="op" id="4597369">(</span><span class="ident" id="4597370">reflect</span><span class="op" id="4597377">.</span><span class="ident" id="4597378">PtrTo</span><span class="op" id="4597383">(</span><span class="ident" id="4597384">v</span><span class="op" id="4597385">.</span><span class="ident" id="4597386">Type</span><span class="op" id="4597390">(</span><span class="op" id="4597391">)</span><span class="op" id="4597392">)</span><span class="op" id="4597393">.</span><span class="ident" id="4597394">Implements</span><span class="op" id="4597404">(</span><span class="ident" id="4597405">errorType</span><span class="op" id="4597414">)</span>&nbsp;<span class="op" id="4597416">||</span>&nbsp;<span class="ident" id="4597419">reflect</span><span class="op" id="4597426">.</span><span class="ident" id="4597427">PtrTo</span><span class="op" id="4597432">(</span><span class="ident" id="4597433">v</span><span class="op" id="4597434">.</span><span class="ident" id="4597435">Type</span><span class="op" id="4597439">(</span><span class="op" id="4597440">)</span><span class="op" id="4597441">)</span><span class="op" id="4597442">.</span><span class="ident" id="4597443">Implements</span><span class="op" id="4597453">(</span><span class="ident" id="4597454">fmtStringerType</span><span class="op" id="4597469">)</span><span class="op" id="4597470">)</span>&nbsp;<span class="op" id="4597472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4597477">v</span>&nbsp;<span class="op" id="4597479">=</span>&nbsp;<span class="ident" id="4597481">v</span><span class="op" id="4597482">.</span><span class="ident" id="4597483">Addr</span><span class="op" id="4597487">(</span><span class="op" id="4597488">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4597492">}</span>&nbsp;<span class="keyword" id="4597494">else</span>&nbsp;<span class="op" id="4597499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597504">switch</span>&nbsp;<span class="ident" id="4597511">v</span><span class="op" id="4597512">.</span><span class="ident" id="4597513">Kind</span><span class="op" id="4597517">(</span><span class="op" id="4597518">)</span>&nbsp;<span class="op" id="4597520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597525">case</span>&nbsp;<span class="ident" id="4597530">reflect</span><span class="op" id="4597537">.</span><span class="ident" id="4597538">Chan</span><span class="op" id="4597542">,</span>&nbsp;<span class="ident" id="4597544">reflect</span><span class="op" id="4597551">.</span><span class="ident" id="4597552">Func</span><span class="op" id="4597556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597562">return</span>&nbsp;<span class="builtintype" id="4597569">nil</span><span class="op" id="4597572">,</span>&nbsp;<span class="builtintype" id="4597574">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4597583">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4597587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4597590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4597593">return</span>&nbsp;<span class="ident" id="4597600">v</span><span class="op" id="4597601">.</span><span class="ident" id="4597602">Interface</span><span class="op" id="4597611">(</span><span class="op" id="4597612">)</span><span class="op" id="4597613">,</span>&nbsp;<span class="builtintype" id="4597615">true</span><br>
<span class="lineno"></span><span class="op" id="4597620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="4597623">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597689">type</span>&nbsp;<span class="ident" id="4597694">rvs</span>&nbsp;<span class="op" id="4597698">[</span><span class="op" id="4597699">]</span><span class="ident" id="4597700">reflect</span><span class="op" id="4597707">.</span><span class="ident" id="4597708">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597715">func</span>&nbsp;<span class="op" id="4597720">(</span><span class="ident" id="4597721">x</span>&nbsp;<span class="ident" id="4597723">rvs</span><span class="op" id="4597726">)</span>&nbsp;<span class="ident" id="4597728">Len</span><span class="op" id="4597731">(</span><span class="op" id="4597732">)</span>&nbsp;<span class="builtintype" id="4597734">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4597743">{</span>&nbsp;<span class="keyword" id="4597745">return</span>&nbsp;<span class="builtinfunc" id="4597752">len</span><span class="op" id="4597755">(</span><span class="ident" id="4597756">x</span><span class="op" id="4597757">)</span>&nbsp;<span class="op" id="4597759">}</span><br>
<span class="lineno">810</span><span class="keyword" id="4597761">func</span>&nbsp;<span class="op" id="4597766">(</span><span class="ident" id="4597767">x</span>&nbsp;<span class="ident" id="4597769">rvs</span><span class="op" id="4597772">)</span>&nbsp;<span class="ident" id="4597774">Swap</span><span class="op" id="4597778">(</span><span class="ident" id="4597779">i</span><span class="op" id="4597780">,</span>&nbsp;<span class="ident" id="4597782">j</span>&nbsp;<span class="builtintype" id="4597784">int</span><span class="op" id="4597787">)</span>&nbsp;<span class="op" id="4597789">{</span>&nbsp;<span class="ident" id="4597791">x</span><span class="op" id="4597792">[</span><span class="ident" id="4597793">i</span><span class="op" id="4597794">]</span><span class="op" id="4597795">,</span>&nbsp;<span class="ident" id="4597797">x</span><span class="op" id="4597798">[</span><span class="ident" id="4597799">j</span><span class="op" id="4597800">]</span>&nbsp;<span class="op" id="4597802">=</span>&nbsp;<span class="ident" id="4597804">x</span><span class="op" id="4597805">[</span><span class="ident" id="4597806">j</span><span class="op" id="4597807">]</span><span class="op" id="4597808">,</span>&nbsp;<span class="ident" id="4597810">x</span><span class="op" id="4597811">[</span><span class="ident" id="4597812">i</span><span class="op" id="4597813">]</span>&nbsp;<span class="op" id="4597815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597818">type</span>&nbsp;<span class="ident" id="4597823">rvInts</span>&nbsp;<span class="keyword" id="4597830">struct</span><span class="op" id="4597836">{</span>&nbsp;<span class="ident" id="4597838">rvs</span>&nbsp;<span class="op" id="4597842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597845">func</span>&nbsp;<span class="op" id="4597850">(</span><span class="ident" id="4597851">x</span>&nbsp;<span class="ident" id="4597853">rvInts</span><span class="op" id="4597859">)</span>&nbsp;<span class="ident" id="4597861">Less</span><span class="op" id="4597865">(</span><span class="ident" id="4597866">i</span><span class="op" id="4597867">,</span>&nbsp;<span class="ident" id="4597869">j</span>&nbsp;<span class="builtintype" id="4597871">int</span><span class="op" id="4597874">)</span>&nbsp;<span class="builtintype" id="4597876">bool</span>&nbsp;<span class="op" id="4597881">{</span>&nbsp;<span class="keyword" id="4597883">return</span>&nbsp;<span class="ident" id="4597890">x</span><span class="op" id="4597891">.</span><span class="ident" id="4597892">rvs</span><span class="op" id="4597895">[</span><span class="ident" id="4597896">i</span><span class="op" id="4597897">]</span><span class="op" id="4597898">.</span><span class="ident" id="4597899">Int</span><span class="op" id="4597902">(</span><span class="op" id="4597903">)</span>&nbsp;<span class="op" id="4597905">&lt;</span>&nbsp;<span class="ident" id="4597907">x</span><span class="op" id="4597908">.</span><span class="ident" id="4597909">rvs</span><span class="op" id="4597912">[</span><span class="ident" id="4597913">j</span><span class="op" id="4597914">]</span><span class="op" id="4597915">.</span><span class="ident" id="4597916">Int</span><span class="op" id="4597919">(</span><span class="op" id="4597920">)</span>&nbsp;<span class="op" id="4597922">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="4597925">type</span>&nbsp;<span class="ident" id="4597930">rvUints</span>&nbsp;<span class="keyword" id="4597938">struct</span><span class="op" id="4597944">{</span>&nbsp;<span class="ident" id="4597946">rvs</span>&nbsp;<span class="op" id="4597950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597953">func</span>&nbsp;<span class="op" id="4597958">(</span><span class="ident" id="4597959">x</span>&nbsp;<span class="ident" id="4597961">rvUints</span><span class="op" id="4597968">)</span>&nbsp;<span class="ident" id="4597970">Less</span><span class="op" id="4597974">(</span><span class="ident" id="4597975">i</span><span class="op" id="4597976">,</span>&nbsp;<span class="ident" id="4597978">j</span>&nbsp;<span class="builtintype" id="4597980">int</span><span class="op" id="4597983">)</span>&nbsp;<span class="builtintype" id="4597985">bool</span>&nbsp;<span class="op" id="4597990">{</span>&nbsp;<span class="keyword" id="4597992">return</span>&nbsp;<span class="ident" id="4597999">x</span><span class="op" id="4598000">.</span><span class="ident" id="4598001">rvs</span><span class="op" id="4598004">[</span><span class="ident" id="4598005">i</span><span class="op" id="4598006">]</span><span class="op" id="4598007">.</span><span class="ident" id="4598008">Uint</span><span class="op" id="4598012">(</span><span class="op" id="4598013">)</span>&nbsp;<span class="op" id="4598015">&lt;</span>&nbsp;<span class="ident" id="4598017">x</span><span class="op" id="4598018">.</span><span class="ident" id="4598019">rvs</span><span class="op" id="4598022">[</span><span class="ident" id="4598023">j</span><span class="op" id="4598024">]</span><span class="op" id="4598025">.</span><span class="ident" id="4598026">Uint</span><span class="op" id="4598030">(</span><span class="op" id="4598031">)</span>&nbsp;<span class="op" id="4598033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="4598036">type</span>&nbsp;<span class="ident" id="4598041">rvFloats</span>&nbsp;<span class="keyword" id="4598050">struct</span><span class="op" id="4598056">{</span>&nbsp;<span class="ident" id="4598058">rvs</span>&nbsp;<span class="op" id="4598062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4598065">func</span>&nbsp;<span class="op" id="4598070">(</span><span class="ident" id="4598071">x</span>&nbsp;<span class="ident" id="4598073">rvFloats</span><span class="op" id="4598081">)</span>&nbsp;<span class="ident" id="4598083">Less</span><span class="op" id="4598087">(</span><span class="ident" id="4598088">i</span><span class="op" id="4598089">,</span>&nbsp;<span class="ident" id="4598091">j</span>&nbsp;<span class="builtintype" id="4598093">int</span><span class="op" id="4598096">)</span>&nbsp;<span class="builtintype" id="4598098">bool</span>&nbsp;<span class="op" id="4598103">{</span>&nbsp;<span class="keyword" id="4598105">return</span>&nbsp;<span class="ident" id="4598112">x</span><span class="op" id="4598113">.</span><span class="ident" id="4598114">rvs</span><span class="op" id="4598117">[</span><span class="ident" id="4598118">i</span><span class="op" id="4598119">]</span><span class="op" id="4598120">.</span><span class="ident" id="4598121">Float</span><span class="op" id="4598126">(</span><span class="op" id="4598127">)</span>&nbsp;<span class="op" id="4598129">&lt;</span>&nbsp;<span class="ident" id="4598131">x</span><span class="op" id="4598132">.</span><span class="ident" id="4598133">rvs</span><span class="op" id="4598136">[</span><span class="ident" id="4598137">j</span><span class="op" id="4598138">]</span><span class="op" id="4598139">.</span><span class="ident" id="4598140">Float</span><span class="op" id="4598145">(</span><span class="op" id="4598146">)</span>&nbsp;<span class="op" id="4598148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4598151">type</span>&nbsp;<span class="ident" id="4598156">rvStrings</span>&nbsp;<span class="keyword" id="4598166">struct</span><span class="op" id="4598172">{</span>&nbsp;<span class="ident" id="4598174">rvs</span>&nbsp;<span class="op" id="4598178">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="4598181">func</span>&nbsp;<span class="op" id="4598186">(</span><span class="ident" id="4598187">x</span>&nbsp;<span class="ident" id="4598189">rvStrings</span><span class="op" id="4598198">)</span>&nbsp;<span class="ident" id="4598200">Less</span><span class="op" id="4598204">(</span><span class="ident" id="4598205">i</span><span class="op" id="4598206">,</span>&nbsp;<span class="ident" id="4598208">j</span>&nbsp;<span class="builtintype" id="4598210">int</span><span class="op" id="4598213">)</span>&nbsp;<span class="builtintype" id="4598215">bool</span>&nbsp;<span class="op" id="4598220">{</span>&nbsp;<span class="keyword" id="4598222">return</span>&nbsp;<span class="ident" id="4598229">x</span><span class="op" id="4598230">.</span><span class="ident" id="4598231">rvs</span><span class="op" id="4598234">[</span><span class="ident" id="4598235">i</span><span class="op" id="4598236">]</span><span class="op" id="4598237">.</span><span class="ident" id="4598238">String</span><span class="op" id="4598244">(</span><span class="op" id="4598245">)</span>&nbsp;<span class="op" id="4598247">&lt;</span>&nbsp;<span class="ident" id="4598249">x</span><span class="op" id="4598250">.</span><span class="ident" id="4598251">rvs</span><span class="op" id="4598254">[</span><span class="ident" id="4598255">j</span><span class="op" id="4598256">]</span><span class="op" id="4598257">.</span><span class="ident" id="4598258">String</span><span class="op" id="4598264">(</span><span class="op" id="4598265">)</span>&nbsp;<span class="op" id="4598267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4598270">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="4598359">func</span>&nbsp;<span class="ident" id="4598364">sortKeys</span><span class="op" id="4598372">(</span><span class="ident" id="4598373">v</span>&nbsp;<span class="op" id="4598375">[</span><span class="op" id="4598376">]</span><span class="ident" id="4598377">reflect</span><span class="op" id="4598384">.</span><span class="ident" id="4598385">Value</span><span class="op" id="4598390">)</span>&nbsp;<span class="op" id="4598392">[</span><span class="op" id="4598393">]</span><span class="ident" id="4598394">reflect</span><span class="op" id="4598401">.</span><span class="ident" id="4598402">Value</span>&nbsp;<span class="op" id="4598408">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598411">if</span>&nbsp;<span class="builtinfunc" id="4598414">len</span><span class="op" id="4598417">(</span><span class="ident" id="4598418">v</span><span class="op" id="4598419">)</span>&nbsp;<span class="op" id="4598421">&lt;=</span>&nbsp;<span class="num" id="4598424">1</span>&nbsp;<span class="op" id="4598426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598430">return</span>&nbsp;<span class="ident" id="4598437">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4598440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598443">switch</span>&nbsp;<span class="ident" id="4598450">v</span><span class="op" id="4598451">[</span><span class="num" id="4598452">0</span><span class="op" id="4598453">]</span><span class="op" id="4598454">.</span><span class="ident" id="4598455">Kind</span><span class="op" id="4598459">(</span><span class="op" id="4598460">)</span>&nbsp;<span class="op" id="4598462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598465">case</span>&nbsp;<span class="ident" id="4598470">reflect</span><span class="op" id="4598477">.</span><span class="ident" id="4598478">Float32</span><span class="op" id="4598485">,</span>&nbsp;<span class="ident" id="4598487">reflect</span><span class="op" id="4598494">.</span><span class="ident" id="4598495">Float64</span><span class="op" id="4598502">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4598506">sort</span><span class="op" id="4598510">.</span><span class="ident" id="4598511">Sort</span><span class="op" id="4598515">(</span><span class="ident" id="4598516">rvFloats</span><span class="op" id="4598524">{</span><span class="ident" id="4598525">v</span><span class="op" id="4598526">}</span><span class="op" id="4598527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598530">case</span>&nbsp;<span class="ident" id="4598535">reflect</span><span class="op" id="4598542">.</span><span class="ident" id="4598543">Int</span><span class="op" id="4598546">,</span>&nbsp;<span class="ident" id="4598548">reflect</span><span class="op" id="4598555">.</span><span class="ident" id="4598556">Int8</span><span class="op" id="4598560">,</span>&nbsp;<span class="ident" id="4598562">reflect</span><span class="op" id="4598569">.</span><span class="ident" id="4598570">Int16</span><span class="op" id="4598575">,</span>&nbsp;<span class="ident" id="4598577">reflect</span><span class="op" id="4598584">.</span><span class="ident" id="4598585">Int32</span><span class="op" id="4598590">,</span>&nbsp;<span class="ident" id="4598592">reflect</span><span class="op" id="4598599">.</span><span class="ident" id="4598600">Int64</span><span class="op" id="4598605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4598609">sort</span><span class="op" id="4598613">.</span><span class="ident" id="4598614">Sort</span><span class="op" id="4598618">(</span><span class="ident" id="4598619">rvInts</span><span class="op" id="4598625">{</span><span class="ident" id="4598626">v</span><span class="op" id="4598627">}</span><span class="op" id="4598628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598631">case</span>&nbsp;<span class="ident" id="4598636">reflect</span><span class="op" id="4598643">.</span><span class="ident" id="4598644">String</span><span class="op" id="4598650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4598654">sort</span><span class="op" id="4598658">.</span><span class="ident" id="4598659">Sort</span><span class="op" id="4598663">(</span><span class="ident" id="4598664">rvStrings</span><span class="op" id="4598673">{</span><span class="ident" id="4598674">v</span><span class="op" id="4598675">}</span><span class="op" id="4598676">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598679">case</span>&nbsp;<span class="ident" id="4598684">reflect</span><span class="op" id="4598691">.</span><span class="ident" id="4598692">Uint</span><span class="op" id="4598696">,</span>&nbsp;<span class="ident" id="4598698">reflect</span><span class="op" id="4598705">.</span><span class="ident" id="4598706">Uint8</span><span class="op" id="4598711">,</span>&nbsp;<span class="ident" id="4598713">reflect</span><span class="op" id="4598720">.</span><span class="ident" id="4598721">Uint16</span><span class="op" id="4598727">,</span>&nbsp;<span class="ident" id="4598729">reflect</span><span class="op" id="4598736">.</span><span class="ident" id="4598737">Uint32</span><span class="op" id="4598743">,</span>&nbsp;<span class="ident" id="4598745">reflect</span><span class="op" id="4598752">.</span><span class="ident" id="4598753">Uint64</span><span class="op" id="4598759">,</span>&nbsp;<span class="ident" id="4598761">reflect</span><span class="op" id="4598768">.</span><span class="ident" id="4598769">Uintptr</span><span class="op" id="4598776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4598780">sort</span><span class="op" id="4598784">.</span><span class="ident" id="4598785">Sort</span><span class="op" id="4598789">(</span><span class="ident" id="4598790">rvUints</span><span class="op" id="4598797">{</span><span class="ident" id="4598798">v</span><span class="op" id="4598799">}</span><span class="op" id="4598800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4598803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4598806">return</span>&nbsp;<span class="ident" id="4598813">v</span><br>
<span class="lineno"></span><span class="op" id="4598815">}</span>
</div>
</body>
</html>
