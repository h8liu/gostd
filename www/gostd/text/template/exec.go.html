<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3198963">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3199018">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3199072">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3199123">package</span>&nbsp;<span class="ident" id="3199131">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3199141">import</span>&nbsp;<span class="op" id="3199148">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199151">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199160">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199167">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199173">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199184">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199195">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199203">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3199214">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="3199236">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3199239">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3199307">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="3199368">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3199396">type</span>&nbsp;<span class="ident" id="3199401">state</span>&nbsp;<span class="keyword" id="3199407">struct</span>&nbsp;<span class="op" id="3199414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199417">tmpl</span>&nbsp;<span class="op" id="3199422">*</span><span class="ident" id="3199423">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199433">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3199438">io</span><span class="op" id="3199440">.</span><span class="ident" id="3199441">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199449">node</span>&nbsp;<span class="ident" id="3199454">parse</span><span class="op" id="3199459">.</span><span class="ident" id="3199460">Node</span>&nbsp;<span class="comment" id="3199465">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199494">vars</span>&nbsp;<span class="op" id="3199499">[</span><span class="op" id="3199500">]</span><span class="ident" id="3199501">variable</span>&nbsp;<span class="comment" id="3199510">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="3199549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3199552">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="3199621">type</span>&nbsp;<span class="ident" id="3199626">variable</span>&nbsp;<span class="keyword" id="3199635">struct</span>&nbsp;<span class="op" id="3199642">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199645">name</span>&nbsp;&nbsp;<span class="builtintype" id="3199651">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199659">value</span>&nbsp;<span class="ident" id="3199665">reflect</span><span class="op" id="3199672">.</span><span class="ident" id="3199673">Value</span><br>
<span class="lineno"></span><span class="op" id="3199679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3199682">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="3199726">func</span>&nbsp;<span class="op" id="3199731">(</span><span class="ident" id="3199732">s</span>&nbsp;<span class="op" id="3199734">*</span><span class="ident" id="3199735">state</span><span class="op" id="3199740">)</span>&nbsp;<span class="ident" id="3199742">push</span><span class="op" id="3199746">(</span><span class="ident" id="3199747">name</span>&nbsp;<span class="builtintype" id="3199752">string</span><span class="op" id="3199758">,</span>&nbsp;<span class="ident" id="3199760">value</span>&nbsp;<span class="ident" id="3199766">reflect</span><span class="op" id="3199773">.</span><span class="ident" id="3199774">Value</span><span class="op" id="3199779">)</span>&nbsp;<span class="op" id="3199781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3199784">s</span><span class="op" id="3199785">.</span><span class="ident" id="3199786">vars</span>&nbsp;<span class="op" id="3199791">=</span>&nbsp;<span class="builtinfunc" id="3199793">append</span><span class="op" id="3199799">(</span><span class="ident" id="3199800">s</span><span class="op" id="3199801">.</span><span class="ident" id="3199802">vars</span><span class="op" id="3199806">,</span>&nbsp;<span class="ident" id="3199808">variable</span><span class="op" id="3199816">{</span><span class="ident" id="3199817">name</span><span class="op" id="3199821">,</span>&nbsp;<span class="ident" id="3199823">value</span><span class="op" id="3199828">}</span><span class="op" id="3199829">)</span><br>
<span class="lineno"></span><span class="op" id="3199831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3199834">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="3199884">func</span>&nbsp;<span class="op" id="3199889">(</span><span class="ident" id="3199890">s</span>&nbsp;<span class="op" id="3199892">*</span><span class="ident" id="3199893">state</span><span class="op" id="3199898">)</span>&nbsp;<span class="ident" id="3199900">mark</span><span class="op" id="3199904">(</span><span class="op" id="3199905">)</span>&nbsp;<span class="builtintype" id="3199907">int</span>&nbsp;<span class="op" id="3199911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3199914">return</span>&nbsp;<span class="builtinfunc" id="3199921">len</span><span class="op" id="3199924">(</span><span class="ident" id="3199925">s</span><span class="op" id="3199926">.</span><span class="ident" id="3199927">vars</span><span class="op" id="3199931">)</span><br>
<span class="lineno"></span><span class="op" id="3199933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3199936">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="3199983">func</span>&nbsp;<span class="op" id="3199988">(</span><span class="ident" id="3199989">s</span>&nbsp;<span class="op" id="3199991">*</span><span class="ident" id="3199992">state</span><span class="op" id="3199997">)</span>&nbsp;<span class="ident" id="3199999">pop</span><span class="op" id="3200002">(</span><span class="ident" id="3200003">mark</span>&nbsp;<span class="builtintype" id="3200008">int</span><span class="op" id="3200011">)</span>&nbsp;<span class="op" id="3200013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200016">s</span><span class="op" id="3200017">.</span><span class="ident" id="3200018">vars</span>&nbsp;<span class="op" id="3200023">=</span>&nbsp;<span class="ident" id="3200025">s</span><span class="op" id="3200026">.</span><span class="ident" id="3200027">vars</span><span class="op" id="3200031">[</span><span class="num" id="3200032">0</span><span class="op" id="3200033">:</span><span class="ident" id="3200034">mark</span><span class="op" id="3200038">]</span><br>
<span class="lineno"></span><span class="op" id="3200040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3200043">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="3200125">func</span>&nbsp;<span class="op" id="3200130">(</span><span class="ident" id="3200131">s</span>&nbsp;<span class="op" id="3200133">*</span><span class="ident" id="3200134">state</span><span class="op" id="3200139">)</span>&nbsp;<span class="ident" id="3200141">setVar</span><span class="op" id="3200147">(</span><span class="ident" id="3200148">n</span>&nbsp;<span class="builtintype" id="3200150">int</span><span class="op" id="3200153">,</span>&nbsp;<span class="ident" id="3200155">value</span>&nbsp;<span class="ident" id="3200161">reflect</span><span class="op" id="3200168">.</span><span class="ident" id="3200169">Value</span><span class="op" id="3200174">)</span>&nbsp;<span class="op" id="3200176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200179">s</span><span class="op" id="3200180">.</span><span class="ident" id="3200181">vars</span><span class="op" id="3200185">[</span><span class="builtinfunc" id="3200186">len</span><span class="op" id="3200189">(</span><span class="ident" id="3200190">s</span><span class="op" id="3200191">.</span><span class="ident" id="3200192">vars</span><span class="op" id="3200196">)</span><span class="op" id="3200197">-</span><span class="ident" id="3200198">n</span><span class="op" id="3200199">]</span><span class="op" id="3200200">.</span><span class="ident" id="3200201">value</span>&nbsp;<span class="op" id="3200207">=</span>&nbsp;<span class="ident" id="3200209">value</span><br>
<span class="lineno"></span><span class="op" id="3200215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3200218">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="3200271">func</span>&nbsp;<span class="op" id="3200276">(</span><span class="ident" id="3200277">s</span>&nbsp;<span class="op" id="3200279">*</span><span class="ident" id="3200280">state</span><span class="op" id="3200285">)</span>&nbsp;<span class="ident" id="3200287">varValue</span><span class="op" id="3200295">(</span><span class="ident" id="3200296">name</span>&nbsp;<span class="builtintype" id="3200301">string</span><span class="op" id="3200307">)</span>&nbsp;<span class="ident" id="3200309">reflect</span><span class="op" id="3200316">.</span><span class="ident" id="3200317">Value</span>&nbsp;<span class="op" id="3200323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200326">for</span>&nbsp;<span class="ident" id="3200330">i</span>&nbsp;<span class="op" id="3200332">:=</span>&nbsp;<span class="ident" id="3200335">s</span><span class="op" id="3200336">.</span><span class="ident" id="3200337">mark</span><span class="op" id="3200341">(</span><span class="op" id="3200342">)</span>&nbsp;<span class="op" id="3200344">-</span>&nbsp;<span class="num" id="3200346">1</span><span class="op" id="3200347">;</span>&nbsp;<span class="ident" id="3200349">i</span>&nbsp;<span class="op" id="3200351">&gt;=</span>&nbsp;<span class="num" id="3200354">0</span><span class="op" id="3200355">;</span>&nbsp;<span class="ident" id="3200357">i</span><span class="op" id="3200358">--</span>&nbsp;<span class="op" id="3200361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200365">if</span>&nbsp;<span class="ident" id="3200368">s</span><span class="op" id="3200369">.</span><span class="ident" id="3200370">vars</span><span class="op" id="3200374">[</span><span class="ident" id="3200375">i</span><span class="op" id="3200376">]</span><span class="op" id="3200377">.</span><span class="ident" id="3200378">name</span>&nbsp;<span class="op" id="3200383">==</span>&nbsp;<span class="ident" id="3200386">name</span>&nbsp;<span class="op" id="3200391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200396">return</span>&nbsp;<span class="ident" id="3200403">s</span><span class="op" id="3200404">.</span><span class="ident" id="3200405">vars</span><span class="op" id="3200409">[</span><span class="ident" id="3200410">i</span><span class="op" id="3200411">]</span><span class="op" id="3200412">.</span><span class="ident" id="3200413">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200421">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200427">s</span><span class="op" id="3200428">.</span><span class="ident" id="3200429">errorf</span><span class="op" id="3200435">(</span><span class="string" id="3200436">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="3200460">,</span>&nbsp;<span class="ident" id="3200462">name</span><span class="op" id="3200466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200469">return</span>&nbsp;<span class="ident" id="3200476">zero</span><br>
<span class="lineno"></span><span class="op" id="3200481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="3200484">var</span>&nbsp;<span class="ident" id="3200488">zero</span>&nbsp;<span class="ident" id="3200493">reflect</span><span class="op" id="3200500">.</span><span class="ident" id="3200501">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3200508">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="3200568">func</span>&nbsp;<span class="op" id="3200573">(</span><span class="ident" id="3200574">s</span>&nbsp;<span class="op" id="3200576">*</span><span class="ident" id="3200577">state</span><span class="op" id="3200582">)</span>&nbsp;<span class="ident" id="3200584">at</span><span class="op" id="3200586">(</span><span class="ident" id="3200587">node</span>&nbsp;<span class="ident" id="3200592">parse</span><span class="op" id="3200597">.</span><span class="ident" id="3200598">Node</span><span class="op" id="3200602">)</span>&nbsp;<span class="op" id="3200604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200607">s</span><span class="op" id="3200608">.</span><span class="ident" id="3200609">node</span>&nbsp;<span class="op" id="3200614">=</span>&nbsp;<span class="ident" id="3200616">node</span><br>
<span class="lineno">70</span><span class="op" id="3200621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3200624">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3200699">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3200758">func</span>&nbsp;<span class="ident" id="3200763">doublePercent</span><span class="op" id="3200776">(</span><span class="ident" id="3200777">str</span>&nbsp;<span class="builtintype" id="3200781">string</span><span class="op" id="3200787">)</span>&nbsp;<span class="builtintype" id="3200789">string</span>&nbsp;<span class="op" id="3200796">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200799">if</span>&nbsp;<span class="ident" id="3200802">strings</span><span class="op" id="3200809">.</span><span class="ident" id="3200810">Contains</span><span class="op" id="3200818">(</span><span class="ident" id="3200819">str</span><span class="op" id="3200822">,</span>&nbsp;<span class="string" id="3200824">&#34;%&#34;</span><span class="op" id="3200827">)</span>&nbsp;<span class="op" id="3200829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3200833">str</span>&nbsp;<span class="op" id="3200837">=</span>&nbsp;<span class="ident" id="3200839">strings</span><span class="op" id="3200846">.</span><span class="ident" id="3200847">Replace</span><span class="op" id="3200854">(</span><span class="ident" id="3200855">str</span><span class="op" id="3200858">,</span>&nbsp;<span class="string" id="3200860">&#34;%&#34;</span><span class="op" id="3200863">,</span>&nbsp;<span class="string" id="3200865">&#34;%%&#34;</span><span class="op" id="3200869">,</span>&nbsp;<span class="op" id="3200871">-</span><span class="num" id="3200872">1</span><span class="op" id="3200873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3200876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3200879">return</span>&nbsp;<span class="ident" id="3200886">str</span><br>
<span class="lineno"></span><span class="op" id="3200890">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3200893">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3200948">func</span>&nbsp;<span class="op" id="3200953">(</span><span class="ident" id="3200954">s</span>&nbsp;<span class="op" id="3200956">*</span><span class="ident" id="3200957">state</span><span class="op" id="3200962">)</span>&nbsp;<span class="ident" id="3200964">errorf</span><span class="op" id="3200970">(</span><span class="ident" id="3200971">format</span>&nbsp;<span class="builtintype" id="3200978">string</span><span class="op" id="3200984">,</span>&nbsp;<span class="ident" id="3200986">args</span>&nbsp;<span class="op" id="3200991">...</span><span class="keyword" id="3200994">interface</span><span class="op" id="3201003">{</span><span class="op" id="3201004">}</span><span class="op" id="3201005">)</span>&nbsp;<span class="op" id="3201007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201010">name</span>&nbsp;<span class="op" id="3201015">:=</span>&nbsp;<span class="ident" id="3201018">doublePercent</span><span class="op" id="3201031">(</span><span class="ident" id="3201032">s</span><span class="op" id="3201033">.</span><span class="ident" id="3201034">tmpl</span><span class="op" id="3201038">.</span><span class="ident" id="3201039">Name</span><span class="op" id="3201043">(</span><span class="op" id="3201044">)</span><span class="op" id="3201045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201048">if</span>&nbsp;<span class="ident" id="3201051">s</span><span class="op" id="3201052">.</span><span class="ident" id="3201053">node</span>&nbsp;<span class="op" id="3201058">==</span>&nbsp;<span class="ident" id="3201061">nil</span>&nbsp;<span class="op" id="3201065">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201069">format</span>&nbsp;<span class="op" id="3201076">=</span>&nbsp;<span class="ident" id="3201078">fmt</span><span class="op" id="3201081">.</span><span class="ident" id="3201082">Sprintf</span><span class="op" id="3201089">(</span><span class="string" id="3201090">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3201108">,</span>&nbsp;<span class="ident" id="3201110">name</span><span class="op" id="3201114">,</span>&nbsp;<span class="ident" id="3201116">format</span><span class="op" id="3201122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201125">}</span>&nbsp;<span class="keyword" id="3201127">else</span>&nbsp;<span class="op" id="3201132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201136">location</span><span class="op" id="3201144">,</span>&nbsp;<span class="ident" id="3201146">context</span>&nbsp;<span class="op" id="3201154">:=</span>&nbsp;<span class="ident" id="3201157">s</span><span class="op" id="3201158">.</span><span class="ident" id="3201159">tmpl</span><span class="op" id="3201163">.</span><span class="ident" id="3201164">ErrorContext</span><span class="op" id="3201176">(</span><span class="ident" id="3201177">s</span><span class="op" id="3201178">.</span><span class="ident" id="3201179">node</span><span class="op" id="3201183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201187">format</span>&nbsp;<span class="op" id="3201194">=</span>&nbsp;<span class="ident" id="3201196">fmt</span><span class="op" id="3201199">.</span><span class="ident" id="3201200">Sprintf</span><span class="op" id="3201207">(</span><span class="string" id="3201208">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="3201248">,</span>&nbsp;<span class="ident" id="3201250">location</span><span class="op" id="3201258">,</span>&nbsp;<span class="ident" id="3201260">name</span><span class="op" id="3201264">,</span>&nbsp;<span class="ident" id="3201266">doublePercent</span><span class="op" id="3201279">(</span><span class="ident" id="3201280">context</span><span class="op" id="3201287">)</span><span class="op" id="3201288">,</span>&nbsp;<span class="ident" id="3201290">format</span><span class="op" id="3201296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201299">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3201302">panic</span><span class="op" id="3201307">(</span><span class="ident" id="3201308">fmt</span><span class="op" id="3201311">.</span><span class="ident" id="3201312">Errorf</span><span class="op" id="3201318">(</span><span class="ident" id="3201319">format</span><span class="op" id="3201325">,</span>&nbsp;<span class="ident" id="3201327">args</span><span class="op" id="3201331">...</span><span class="op" id="3201334">)</span><span class="op" id="3201335">)</span><br>
<span class="lineno"></span><span class="op" id="3201337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3201340">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="3201413">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="3201432">func</span>&nbsp;<span class="ident" id="3201437">errRecover</span><span class="op" id="3201447">(</span><span class="ident" id="3201448">errp</span>&nbsp;<span class="op" id="3201453">*</span><span class="builtintype" id="3201454">error</span><span class="op" id="3201459">)</span>&nbsp;<span class="op" id="3201461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3201464">e</span>&nbsp;<span class="op" id="3201466">:=</span>&nbsp;<span class="builtinfunc" id="3201469">recover</span><span class="op" id="3201476">(</span><span class="op" id="3201477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201480">if</span>&nbsp;<span class="ident" id="3201483">e</span>&nbsp;<span class="op" id="3201485">!=</span>&nbsp;<span class="ident" id="3201488">nil</span>&nbsp;<span class="op" id="3201492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201496">switch</span>&nbsp;<span class="ident" id="3201503">err</span>&nbsp;<span class="op" id="3201507">:=</span>&nbsp;<span class="ident" id="3201510">e</span><span class="op" id="3201511">.</span><span class="op" id="3201512">(</span><span class="keyword" id="3201513">type</span><span class="op" id="3201517">)</span>&nbsp;<span class="op" id="3201519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201523">case</span>&nbsp;<span class="ident" id="3201528">runtime</span><span class="op" id="3201535">.</span><span class="ident" id="3201536">Error</span><span class="op" id="3201541">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3201546">panic</span><span class="op" id="3201551">(</span><span class="ident" id="3201552">e</span><span class="op" id="3201553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201557">case</span>&nbsp;<span class="builtintype" id="3201562">error</span><span class="op" id="3201567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201572">*</span><span class="ident" id="3201573">errp</span>&nbsp;<span class="op" id="3201578">=</span>&nbsp;<span class="ident" id="3201580">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3201586">default</span><span class="op" id="3201593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3201598">panic</span><span class="op" id="3201603">(</span><span class="ident" id="3201604">e</span><span class="op" id="3201605">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3201612">}</span><br>
<span class="lineno"></span><span class="op" id="3201614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3201617">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="3201699">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="3201760">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3201828">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3201901">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3201923">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="3201973">func</span>&nbsp;<span class="op" id="3201978">(</span><span class="ident" id="3201979">t</span>&nbsp;<span class="op" id="3201981">*</span><span class="ident" id="3201982">Template</span><span class="op" id="3201990">)</span>&nbsp;<span class="ident" id="3201992">ExecuteTemplate</span><span class="op" id="3202007">(</span><span class="ident" id="3202008">wr</span>&nbsp;<span class="ident" id="3202011">io</span><span class="op" id="3202013">.</span><span class="ident" id="3202014">Writer</span><span class="op" id="3202020">,</span>&nbsp;<span class="ident" id="3202022">name</span>&nbsp;<span class="builtintype" id="3202027">string</span><span class="op" id="3202033">,</span>&nbsp;<span class="ident" id="3202035">data</span>&nbsp;<span class="keyword" id="3202040">interface</span><span class="op" id="3202049">{</span><span class="op" id="3202050">}</span><span class="op" id="3202051">)</span>&nbsp;<span class="builtintype" id="3202053">error</span>&nbsp;<span class="op" id="3202059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202062">tmpl</span>&nbsp;<span class="op" id="3202067">:=</span>&nbsp;<span class="ident" id="3202070">t</span><span class="op" id="3202071">.</span><span class="ident" id="3202072">tmpl</span><span class="op" id="3202076">[</span><span class="ident" id="3202077">name</span><span class="op" id="3202081">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202084">if</span>&nbsp;<span class="ident" id="3202087">tmpl</span>&nbsp;<span class="op" id="3202092">==</span>&nbsp;<span class="ident" id="3202095">nil</span>&nbsp;<span class="op" id="3202099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202103">return</span>&nbsp;<span class="ident" id="3202110">fmt</span><span class="op" id="3202113">.</span><span class="ident" id="3202114">Errorf</span><span class="op" id="3202120">(</span><span class="string" id="3202121">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="3202175">,</span>&nbsp;<span class="ident" id="3202177">name</span><span class="op" id="3202181">,</span>&nbsp;<span class="ident" id="3202183">t</span><span class="op" id="3202184">.</span><span class="ident" id="3202185">name</span><span class="op" id="3202189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3202192">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202195">return</span>&nbsp;<span class="ident" id="3202202">tmpl</span><span class="op" id="3202206">.</span><span class="ident" id="3202207">Execute</span><span class="op" id="3202214">(</span><span class="ident" id="3202215">wr</span><span class="op" id="3202217">,</span>&nbsp;<span class="ident" id="3202219">data</span><span class="op" id="3202223">)</span><br>
<span class="lineno"></span><span class="op" id="3202225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202228">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="3202295">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="3202327">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3202395">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3202468">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3202490">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3202540">func</span>&nbsp;<span class="op" id="3202545">(</span><span class="ident" id="3202546">t</span>&nbsp;<span class="op" id="3202548">*</span><span class="ident" id="3202549">Template</span><span class="op" id="3202557">)</span>&nbsp;<span class="ident" id="3202559">Execute</span><span class="op" id="3202566">(</span><span class="ident" id="3202567">wr</span>&nbsp;<span class="ident" id="3202570">io</span><span class="op" id="3202572">.</span><span class="ident" id="3202573">Writer</span><span class="op" id="3202579">,</span>&nbsp;<span class="ident" id="3202581">data</span>&nbsp;<span class="keyword" id="3202586">interface</span><span class="op" id="3202595">{</span><span class="op" id="3202596">}</span><span class="op" id="3202597">)</span>&nbsp;<span class="op" id="3202599">(</span><span class="ident" id="3202600">err</span>&nbsp;<span class="builtintype" id="3202604">error</span><span class="op" id="3202609">)</span>&nbsp;<span class="op" id="3202611">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202614">defer</span>&nbsp;<span class="ident" id="3202620">errRecover</span><span class="op" id="3202630">(</span><span class="op" id="3202631">&amp;</span><span class="ident" id="3202632">err</span><span class="op" id="3202635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202638">value</span>&nbsp;<span class="op" id="3202644">:=</span>&nbsp;<span class="ident" id="3202647">reflect</span><span class="op" id="3202654">.</span><span class="ident" id="3202655">ValueOf</span><span class="op" id="3202662">(</span><span class="ident" id="3202663">data</span><span class="op" id="3202667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202670">state</span>&nbsp;<span class="op" id="3202676">:=</span>&nbsp;<span class="op" id="3202679">&amp;</span><span class="ident" id="3202680">state</span><span class="op" id="3202685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202689">tmpl</span><span class="op" id="3202693">:</span>&nbsp;<span class="ident" id="3202695">t</span><span class="op" id="3202696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202700">wr</span><span class="op" id="3202702">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3202706">wr</span><span class="op" id="3202708">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202712">vars</span><span class="op" id="3202716">:</span>&nbsp;<span class="op" id="3202718">[</span><span class="op" id="3202719">]</span><span class="ident" id="3202720">variable</span><span class="op" id="3202728">{</span><span class="op" id="3202729">{</span><span class="string" id="3202730">&#34;$&#34;</span><span class="op" id="3202733">,</span>&nbsp;<span class="ident" id="3202735">value</span><span class="op" id="3202740">}</span><span class="op" id="3202741">}</span><span class="op" id="3202742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3202745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202748">t</span><span class="op" id="3202749">.</span><span class="ident" id="3202750">init</span><span class="op" id="3202754">(</span><span class="op" id="3202755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202758">if</span>&nbsp;<span class="ident" id="3202761">t</span><span class="op" id="3202762">.</span><span class="ident" id="3202763">Tree</span>&nbsp;<span class="op" id="3202768">==</span>&nbsp;<span class="ident" id="3202771">nil</span>&nbsp;<span class="op" id="3202775">||</span>&nbsp;<span class="ident" id="3202778">t</span><span class="op" id="3202779">.</span><span class="ident" id="3202780">Root</span>&nbsp;<span class="op" id="3202785">==</span>&nbsp;<span class="ident" id="3202788">nil</span>&nbsp;<span class="op" id="3202792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202796">var</span>&nbsp;<span class="ident" id="3202800">b</span>&nbsp;<span class="ident" id="3202802">bytes</span><span class="op" id="3202807">.</span><span class="ident" id="3202808">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202817">for</span>&nbsp;<span class="ident" id="3202821">name</span><span class="op" id="3202825">,</span>&nbsp;<span class="ident" id="3202827">tmpl</span>&nbsp;<span class="op" id="3202832">:=</span>&nbsp;<span class="keyword" id="3202835">range</span>&nbsp;<span class="ident" id="3202841">t</span><span class="op" id="3202842">.</span><span class="ident" id="3202843">tmpl</span>&nbsp;<span class="op" id="3202848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202853">if</span>&nbsp;<span class="ident" id="3202856">tmpl</span><span class="op" id="3202860">.</span><span class="ident" id="3202861">Tree</span>&nbsp;<span class="op" id="3202866">==</span>&nbsp;<span class="ident" id="3202869">nil</span>&nbsp;<span class="op" id="3202873">||</span>&nbsp;<span class="ident" id="3202876">tmpl</span><span class="op" id="3202880">.</span><span class="ident" id="3202881">Root</span>&nbsp;<span class="op" id="3202886">==</span>&nbsp;<span class="ident" id="3202889">nil</span>&nbsp;<span class="op" id="3202893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202899">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3202911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202916">if</span>&nbsp;<span class="ident" id="3202919">b</span><span class="op" id="3202920">.</span><span class="ident" id="3202921">Len</span><span class="op" id="3202924">(</span><span class="op" id="3202925">)</span>&nbsp;<span class="op" id="3202927">&gt;</span>&nbsp;<span class="num" id="3202929">0</span>&nbsp;<span class="op" id="3202931">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202937">b</span><span class="op" id="3202938">.</span><span class="ident" id="3202939">WriteString</span><span class="op" id="3202950">(</span><span class="string" id="3202951">&#34;,&nbsp;&#34;</span><span class="op" id="3202955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3202960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202965">fmt</span><span class="op" id="3202968">.</span><span class="ident" id="3202969">Fprintf</span><span class="op" id="3202976">(</span><span class="op" id="3202977">&amp;</span><span class="ident" id="3202978">b</span><span class="op" id="3202979">,</span>&nbsp;<span class="string" id="3202981">&#34;%q&#34;</span><span class="op" id="3202985">,</span>&nbsp;<span class="ident" id="3202987">name</span><span class="op" id="3202991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3202995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202999">var</span>&nbsp;<span class="ident" id="3203003">s</span>&nbsp;<span class="builtintype" id="3203005">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203014">if</span>&nbsp;<span class="ident" id="3203017">b</span><span class="op" id="3203018">.</span><span class="ident" id="3203019">Len</span><span class="op" id="3203022">(</span><span class="op" id="3203023">)</span>&nbsp;<span class="op" id="3203025">&gt;</span>&nbsp;<span class="num" id="3203027">0</span>&nbsp;<span class="op" id="3203029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203034">s</span>&nbsp;<span class="op" id="3203036">=</span>&nbsp;<span class="string" id="3203038">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="3203066">+</span>&nbsp;<span class="ident" id="3203068">b</span><span class="op" id="3203069">.</span><span class="ident" id="3203070">String</span><span class="op" id="3203076">(</span><span class="op" id="3203077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203085">state</span><span class="op" id="3203090">.</span><span class="ident" id="3203091">errorf</span><span class="op" id="3203097">(</span><span class="string" id="3203098">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="3203139">,</span>&nbsp;<span class="ident" id="3203141">t</span><span class="op" id="3203142">.</span><span class="ident" id="3203143">Name</span><span class="op" id="3203147">(</span><span class="op" id="3203148">)</span><span class="op" id="3203149">,</span>&nbsp;<span class="ident" id="3203151">s</span><span class="op" id="3203152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203155">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203158">state</span><span class="op" id="3203163">.</span><span class="ident" id="3203164">walk</span><span class="op" id="3203168">(</span><span class="ident" id="3203169">value</span><span class="op" id="3203174">,</span>&nbsp;<span class="ident" id="3203176">t</span><span class="op" id="3203177">.</span><span class="ident" id="3203178">Root</span><span class="op" id="3203182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203185">return</span><br>
<span class="lineno"></span><span class="op" id="3203192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3203195">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="3203270">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="3203303">func</span>&nbsp;<span class="op" id="3203308">(</span><span class="ident" id="3203309">s</span>&nbsp;<span class="op" id="3203311">*</span><span class="ident" id="3203312">state</span><span class="op" id="3203317">)</span>&nbsp;<span class="ident" id="3203319">walk</span><span class="op" id="3203323">(</span><span class="ident" id="3203324">dot</span>&nbsp;<span class="ident" id="3203328">reflect</span><span class="op" id="3203335">.</span><span class="ident" id="3203336">Value</span><span class="op" id="3203341">,</span>&nbsp;<span class="ident" id="3203343">node</span>&nbsp;<span class="ident" id="3203348">parse</span><span class="op" id="3203353">.</span><span class="ident" id="3203354">Node</span><span class="op" id="3203358">)</span>&nbsp;<span class="op" id="3203360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203363">s</span><span class="op" id="3203364">.</span><span class="ident" id="3203365">at</span><span class="op" id="3203367">(</span><span class="ident" id="3203368">node</span><span class="op" id="3203372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203375">switch</span>&nbsp;<span class="ident" id="3203382">node</span>&nbsp;<span class="op" id="3203387">:=</span>&nbsp;<span class="ident" id="3203390">node</span><span class="op" id="3203394">.</span><span class="op" id="3203395">(</span><span class="keyword" id="3203396">type</span><span class="op" id="3203400">)</span>&nbsp;<span class="op" id="3203402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203405">case</span>&nbsp;<span class="op" id="3203410">*</span><span class="ident" id="3203411">parse</span><span class="op" id="3203416">.</span><span class="ident" id="3203417">ActionNode</span><span class="op" id="3203427">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3203431">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3203489">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203558">val</span>&nbsp;<span class="op" id="3203562">:=</span>&nbsp;<span class="ident" id="3203565">s</span><span class="op" id="3203566">.</span><span class="ident" id="3203567">evalPipeline</span><span class="op" id="3203579">(</span><span class="ident" id="3203580">dot</span><span class="op" id="3203583">,</span>&nbsp;<span class="ident" id="3203585">node</span><span class="op" id="3203589">.</span><span class="ident" id="3203590">Pipe</span><span class="op" id="3203594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203598">if</span>&nbsp;<span class="builtinfunc" id="3203601">len</span><span class="op" id="3203604">(</span><span class="ident" id="3203605">node</span><span class="op" id="3203609">.</span><span class="ident" id="3203610">Pipe</span><span class="op" id="3203614">.</span><span class="ident" id="3203615">Decl</span><span class="op" id="3203619">)</span>&nbsp;<span class="op" id="3203621">==</span>&nbsp;<span class="num" id="3203624">0</span>&nbsp;<span class="op" id="3203626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203631">s</span><span class="op" id="3203632">.</span><span class="ident" id="3203633">printValue</span><span class="op" id="3203643">(</span><span class="ident" id="3203644">node</span><span class="op" id="3203648">,</span>&nbsp;<span class="ident" id="3203650">val</span><span class="op" id="3203653">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203660">case</span>&nbsp;<span class="op" id="3203665">*</span><span class="ident" id="3203666">parse</span><span class="op" id="3203671">.</span><span class="ident" id="3203672">IfNode</span><span class="op" id="3203678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203682">s</span><span class="op" id="3203683">.</span><span class="ident" id="3203684">walkIfOrWith</span><span class="op" id="3203696">(</span><span class="ident" id="3203697">parse</span><span class="op" id="3203702">.</span><span class="ident" id="3203703">NodeIf</span><span class="op" id="3203709">,</span>&nbsp;<span class="ident" id="3203711">dot</span><span class="op" id="3203714">,</span>&nbsp;<span class="ident" id="3203716">node</span><span class="op" id="3203720">.</span><span class="ident" id="3203721">Pipe</span><span class="op" id="3203725">,</span>&nbsp;<span class="ident" id="3203727">node</span><span class="op" id="3203731">.</span><span class="ident" id="3203732">List</span><span class="op" id="3203736">,</span>&nbsp;<span class="ident" id="3203738">node</span><span class="op" id="3203742">.</span><span class="ident" id="3203743">ElseList</span><span class="op" id="3203751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203754">case</span>&nbsp;<span class="op" id="3203759">*</span><span class="ident" id="3203760">parse</span><span class="op" id="3203765">.</span><span class="ident" id="3203766">ListNode</span><span class="op" id="3203774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203778">for</span>&nbsp;<span class="ident" id="3203782">_</span><span class="op" id="3203783">,</span>&nbsp;<span class="ident" id="3203785">node</span>&nbsp;<span class="op" id="3203790">:=</span>&nbsp;<span class="keyword" id="3203793">range</span>&nbsp;<span class="ident" id="3203799">node</span><span class="op" id="3203803">.</span><span class="ident" id="3203804">Nodes</span>&nbsp;<span class="op" id="3203810">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203815">s</span><span class="op" id="3203816">.</span><span class="ident" id="3203817">walk</span><span class="op" id="3203821">(</span><span class="ident" id="3203822">dot</span><span class="op" id="3203825">,</span>&nbsp;<span class="ident" id="3203827">node</span><span class="op" id="3203831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203838">case</span>&nbsp;<span class="op" id="3203843">*</span><span class="ident" id="3203844">parse</span><span class="op" id="3203849">.</span><span class="ident" id="3203850">RangeNode</span><span class="op" id="3203859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203863">s</span><span class="op" id="3203864">.</span><span class="ident" id="3203865">walkRange</span><span class="op" id="3203874">(</span><span class="ident" id="3203875">dot</span><span class="op" id="3203878">,</span>&nbsp;<span class="ident" id="3203880">node</span><span class="op" id="3203884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203887">case</span>&nbsp;<span class="op" id="3203892">*</span><span class="ident" id="3203893">parse</span><span class="op" id="3203898">.</span><span class="ident" id="3203899">TemplateNode</span><span class="op" id="3203911">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203915">s</span><span class="op" id="3203916">.</span><span class="ident" id="3203917">walkTemplate</span><span class="op" id="3203929">(</span><span class="ident" id="3203930">dot</span><span class="op" id="3203933">,</span>&nbsp;<span class="ident" id="3203935">node</span><span class="op" id="3203939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203942">case</span>&nbsp;<span class="op" id="3203947">*</span><span class="ident" id="3203948">parse</span><span class="op" id="3203953">.</span><span class="ident" id="3203954">TextNode</span><span class="op" id="3203962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203966">if</span>&nbsp;<span class="ident" id="3203969">_</span><span class="op" id="3203970">,</span>&nbsp;<span class="ident" id="3203972">err</span>&nbsp;<span class="op" id="3203976">:=</span>&nbsp;<span class="ident" id="3203979">s</span><span class="op" id="3203980">.</span><span class="ident" id="3203981">wr</span><span class="op" id="3203983">.</span><span class="ident" id="3203984">Write</span><span class="op" id="3203989">(</span><span class="ident" id="3203990">node</span><span class="op" id="3203994">.</span><span class="ident" id="3203995">Text</span><span class="op" id="3203999">)</span><span class="op" id="3204000">;</span>&nbsp;<span class="ident" id="3204002">err</span>&nbsp;<span class="op" id="3204006">!=</span>&nbsp;<span class="ident" id="3204009">nil</span>&nbsp;<span class="op" id="3204013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204018">s</span><span class="op" id="3204019">.</span><span class="ident" id="3204020">errorf</span><span class="op" id="3204026">(</span><span class="string" id="3204027">&#34;%s&#34;</span><span class="op" id="3204031">,</span>&nbsp;<span class="ident" id="3204033">err</span><span class="op" id="3204036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204040">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204043">case</span>&nbsp;<span class="op" id="3204048">*</span><span class="ident" id="3204049">parse</span><span class="op" id="3204054">.</span><span class="ident" id="3204055">WithNode</span><span class="op" id="3204063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204067">s</span><span class="op" id="3204068">.</span><span class="ident" id="3204069">walkIfOrWith</span><span class="op" id="3204081">(</span><span class="ident" id="3204082">parse</span><span class="op" id="3204087">.</span><span class="ident" id="3204088">NodeWith</span><span class="op" id="3204096">,</span>&nbsp;<span class="ident" id="3204098">dot</span><span class="op" id="3204101">,</span>&nbsp;<span class="ident" id="3204103">node</span><span class="op" id="3204107">.</span><span class="ident" id="3204108">Pipe</span><span class="op" id="3204112">,</span>&nbsp;<span class="ident" id="3204114">node</span><span class="op" id="3204118">.</span><span class="ident" id="3204119">List</span><span class="op" id="3204123">,</span>&nbsp;<span class="ident" id="3204125">node</span><span class="op" id="3204129">.</span><span class="ident" id="3204130">ElseList</span><span class="op" id="3204138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204141">default</span><span class="op" id="3204148">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204152">s</span><span class="op" id="3204153">.</span><span class="ident" id="3204154">errorf</span><span class="op" id="3204160">(</span><span class="string" id="3204161">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="3204179">,</span>&nbsp;<span class="ident" id="3204181">node</span><span class="op" id="3204185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204188">}</span><br>
<span class="lineno">190</span><span class="op" id="3204190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3204193">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="3204266">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3204324">func</span>&nbsp;<span class="op" id="3204329">(</span><span class="ident" id="3204330">s</span>&nbsp;<span class="op" id="3204332">*</span><span class="ident" id="3204333">state</span><span class="op" id="3204338">)</span>&nbsp;<span class="ident" id="3204340">walkIfOrWith</span><span class="op" id="3204352">(</span><span class="ident" id="3204353">typ</span>&nbsp;<span class="ident" id="3204357">parse</span><span class="op" id="3204362">.</span><span class="ident" id="3204363">NodeType</span><span class="op" id="3204371">,</span>&nbsp;<span class="ident" id="3204373">dot</span>&nbsp;<span class="ident" id="3204377">reflect</span><span class="op" id="3204384">.</span><span class="ident" id="3204385">Value</span><span class="op" id="3204390">,</span>&nbsp;<span class="ident" id="3204392">pipe</span>&nbsp;<span class="op" id="3204397">*</span><span class="ident" id="3204398">parse</span><span class="op" id="3204403">.</span><span class="ident" id="3204404">PipeNode</span><span class="op" id="3204412">,</span>&nbsp;<span class="ident" id="3204414">list</span><span class="op" id="3204418">,</span>&nbsp;<span class="ident" id="3204420">elseList</span>&nbsp;<span class="op" id="3204429">*</span><span class="ident" id="3204430">parse</span><span class="op" id="3204435">.</span><span class="ident" id="3204436">ListNode</span><span class="op" id="3204444">)</span>&nbsp;<span class="op" id="3204446">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204449">defer</span>&nbsp;<span class="ident" id="3204455">s</span><span class="op" id="3204456">.</span><span class="ident" id="3204457">pop</span><span class="op" id="3204460">(</span><span class="ident" id="3204461">s</span><span class="op" id="3204462">.</span><span class="ident" id="3204463">mark</span><span class="op" id="3204467">(</span><span class="op" id="3204468">)</span><span class="op" id="3204469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204472">val</span>&nbsp;<span class="op" id="3204476">:=</span>&nbsp;<span class="ident" id="3204479">s</span><span class="op" id="3204480">.</span><span class="ident" id="3204481">evalPipeline</span><span class="op" id="3204493">(</span><span class="ident" id="3204494">dot</span><span class="op" id="3204497">,</span>&nbsp;<span class="ident" id="3204499">pipe</span><span class="op" id="3204503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204506">truth</span><span class="op" id="3204511">,</span>&nbsp;<span class="ident" id="3204513">ok</span>&nbsp;<span class="op" id="3204516">:=</span>&nbsp;<span class="ident" id="3204519">isTrue</span><span class="op" id="3204525">(</span><span class="ident" id="3204526">val</span><span class="op" id="3204529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204532">if</span>&nbsp;<span class="op" id="3204535">!</span><span class="ident" id="3204536">ok</span>&nbsp;<span class="op" id="3204539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204543">s</span><span class="op" id="3204544">.</span><span class="ident" id="3204545">errorf</span><span class="op" id="3204551">(</span><span class="string" id="3204552">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="3204574">,</span>&nbsp;<span class="ident" id="3204576">val</span><span class="op" id="3204579">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204585">if</span>&nbsp;<span class="ident" id="3204588">truth</span>&nbsp;<span class="op" id="3204594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204598">if</span>&nbsp;<span class="ident" id="3204601">typ</span>&nbsp;<span class="op" id="3204605">==</span>&nbsp;<span class="ident" id="3204608">parse</span><span class="op" id="3204613">.</span><span class="ident" id="3204614">NodeWith</span>&nbsp;<span class="op" id="3204623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204628">s</span><span class="op" id="3204629">.</span><span class="ident" id="3204630">walk</span><span class="op" id="3204634">(</span><span class="ident" id="3204635">val</span><span class="op" id="3204638">,</span>&nbsp;<span class="ident" id="3204640">list</span><span class="op" id="3204644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204648">}</span>&nbsp;<span class="keyword" id="3204650">else</span>&nbsp;<span class="op" id="3204655">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204660">s</span><span class="op" id="3204661">.</span><span class="ident" id="3204662">walk</span><span class="op" id="3204666">(</span><span class="ident" id="3204667">dot</span><span class="op" id="3204670">,</span>&nbsp;<span class="ident" id="3204672">list</span><span class="op" id="3204676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204683">}</span>&nbsp;<span class="keyword" id="3204685">else</span>&nbsp;<span class="keyword" id="3204690">if</span>&nbsp;<span class="ident" id="3204693">elseList</span>&nbsp;<span class="op" id="3204702">!=</span>&nbsp;<span class="ident" id="3204705">nil</span>&nbsp;<span class="op" id="3204709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204713">s</span><span class="op" id="3204714">.</span><span class="ident" id="3204715">walk</span><span class="op" id="3204719">(</span><span class="ident" id="3204720">dot</span><span class="op" id="3204723">,</span>&nbsp;<span class="ident" id="3204725">elseList</span><span class="op" id="3204733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204736">}</span><br>
<span class="lineno">210</span><span class="op" id="3204738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3204741">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="3204830">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3204885">func</span>&nbsp;<span class="ident" id="3204890">isTrue</span><span class="op" id="3204896">(</span><span class="ident" id="3204897">val</span>&nbsp;<span class="ident" id="3204901">reflect</span><span class="op" id="3204908">.</span><span class="ident" id="3204909">Value</span><span class="op" id="3204914">)</span>&nbsp;<span class="op" id="3204916">(</span><span class="ident" id="3204917">truth</span><span class="op" id="3204922">,</span>&nbsp;<span class="ident" id="3204924">ok</span>&nbsp;<span class="builtintype" id="3204927">bool</span><span class="op" id="3204931">)</span>&nbsp;<span class="op" id="3204933">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204936">if</span>&nbsp;<span class="op" id="3204939">!</span><span class="ident" id="3204940">val</span><span class="op" id="3204943">.</span><span class="ident" id="3204944">IsValid</span><span class="op" id="3204951">(</span><span class="op" id="3204952">)</span>&nbsp;<span class="op" id="3204954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3204958">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205028">return</span>&nbsp;<span class="builtintype" id="3205035">false</span><span class="op" id="3205040">,</span>&nbsp;<span class="builtintype" id="3205042">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3205048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205051">switch</span>&nbsp;<span class="ident" id="3205058">val</span><span class="op" id="3205061">.</span><span class="ident" id="3205062">Kind</span><span class="op" id="3205066">(</span><span class="op" id="3205067">)</span>&nbsp;<span class="op" id="3205069">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205072">case</span>&nbsp;<span class="ident" id="3205077">reflect</span><span class="op" id="3205084">.</span><span class="ident" id="3205085">Array</span><span class="op" id="3205090">,</span>&nbsp;<span class="ident" id="3205092">reflect</span><span class="op" id="3205099">.</span><span class="ident" id="3205100">Map</span><span class="op" id="3205103">,</span>&nbsp;<span class="ident" id="3205105">reflect</span><span class="op" id="3205112">.</span><span class="ident" id="3205113">Slice</span><span class="op" id="3205118">,</span>&nbsp;<span class="ident" id="3205120">reflect</span><span class="op" id="3205127">.</span><span class="ident" id="3205128">String</span><span class="op" id="3205134">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205138">truth</span>&nbsp;<span class="op" id="3205144">=</span>&nbsp;<span class="ident" id="3205146">val</span><span class="op" id="3205149">.</span><span class="ident" id="3205150">Len</span><span class="op" id="3205153">(</span><span class="op" id="3205154">)</span>&nbsp;<span class="op" id="3205156">&gt;</span>&nbsp;<span class="num" id="3205158">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205161">case</span>&nbsp;<span class="ident" id="3205166">reflect</span><span class="op" id="3205173">.</span><span class="ident" id="3205174">Bool</span><span class="op" id="3205178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205182">truth</span>&nbsp;<span class="op" id="3205188">=</span>&nbsp;<span class="ident" id="3205190">val</span><span class="op" id="3205193">.</span><span class="ident" id="3205194">Bool</span><span class="op" id="3205198">(</span><span class="op" id="3205199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205202">case</span>&nbsp;<span class="ident" id="3205207">reflect</span><span class="op" id="3205214">.</span><span class="ident" id="3205215">Complex64</span><span class="op" id="3205224">,</span>&nbsp;<span class="ident" id="3205226">reflect</span><span class="op" id="3205233">.</span><span class="ident" id="3205234">Complex128</span><span class="op" id="3205244">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205248">truth</span>&nbsp;<span class="op" id="3205254">=</span>&nbsp;<span class="ident" id="3205256">val</span><span class="op" id="3205259">.</span><span class="ident" id="3205260">Complex</span><span class="op" id="3205267">(</span><span class="op" id="3205268">)</span>&nbsp;<span class="op" id="3205270">!=</span>&nbsp;<span class="num" id="3205273">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205276">case</span>&nbsp;<span class="ident" id="3205281">reflect</span><span class="op" id="3205288">.</span><span class="ident" id="3205289">Chan</span><span class="op" id="3205293">,</span>&nbsp;<span class="ident" id="3205295">reflect</span><span class="op" id="3205302">.</span><span class="ident" id="3205303">Func</span><span class="op" id="3205307">,</span>&nbsp;<span class="ident" id="3205309">reflect</span><span class="op" id="3205316">.</span><span class="ident" id="3205317">Ptr</span><span class="op" id="3205320">,</span>&nbsp;<span class="ident" id="3205322">reflect</span><span class="op" id="3205329">.</span><span class="ident" id="3205330">Interface</span><span class="op" id="3205339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205343">truth</span>&nbsp;<span class="op" id="3205349">=</span>&nbsp;<span class="op" id="3205351">!</span><span class="ident" id="3205352">val</span><span class="op" id="3205355">.</span><span class="ident" id="3205356">IsNil</span><span class="op" id="3205361">(</span><span class="op" id="3205362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205365">case</span>&nbsp;<span class="ident" id="3205370">reflect</span><span class="op" id="3205377">.</span><span class="ident" id="3205378">Int</span><span class="op" id="3205381">,</span>&nbsp;<span class="ident" id="3205383">reflect</span><span class="op" id="3205390">.</span><span class="ident" id="3205391">Int8</span><span class="op" id="3205395">,</span>&nbsp;<span class="ident" id="3205397">reflect</span><span class="op" id="3205404">.</span><span class="ident" id="3205405">Int16</span><span class="op" id="3205410">,</span>&nbsp;<span class="ident" id="3205412">reflect</span><span class="op" id="3205419">.</span><span class="ident" id="3205420">Int32</span><span class="op" id="3205425">,</span>&nbsp;<span class="ident" id="3205427">reflect</span><span class="op" id="3205434">.</span><span class="ident" id="3205435">Int64</span><span class="op" id="3205440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205444">truth</span>&nbsp;<span class="op" id="3205450">=</span>&nbsp;<span class="ident" id="3205452">val</span><span class="op" id="3205455">.</span><span class="ident" id="3205456">Int</span><span class="op" id="3205459">(</span><span class="op" id="3205460">)</span>&nbsp;<span class="op" id="3205462">!=</span>&nbsp;<span class="num" id="3205465">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205468">case</span>&nbsp;<span class="ident" id="3205473">reflect</span><span class="op" id="3205480">.</span><span class="ident" id="3205481">Float32</span><span class="op" id="3205488">,</span>&nbsp;<span class="ident" id="3205490">reflect</span><span class="op" id="3205497">.</span><span class="ident" id="3205498">Float64</span><span class="op" id="3205505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205509">truth</span>&nbsp;<span class="op" id="3205515">=</span>&nbsp;<span class="ident" id="3205517">val</span><span class="op" id="3205520">.</span><span class="ident" id="3205521">Float</span><span class="op" id="3205526">(</span><span class="op" id="3205527">)</span>&nbsp;<span class="op" id="3205529">!=</span>&nbsp;<span class="num" id="3205532">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205535">case</span>&nbsp;<span class="ident" id="3205540">reflect</span><span class="op" id="3205547">.</span><span class="ident" id="3205548">Uint</span><span class="op" id="3205552">,</span>&nbsp;<span class="ident" id="3205554">reflect</span><span class="op" id="3205561">.</span><span class="ident" id="3205562">Uint8</span><span class="op" id="3205567">,</span>&nbsp;<span class="ident" id="3205569">reflect</span><span class="op" id="3205576">.</span><span class="ident" id="3205577">Uint16</span><span class="op" id="3205583">,</span>&nbsp;<span class="ident" id="3205585">reflect</span><span class="op" id="3205592">.</span><span class="ident" id="3205593">Uint32</span><span class="op" id="3205599">,</span>&nbsp;<span class="ident" id="3205601">reflect</span><span class="op" id="3205608">.</span><span class="ident" id="3205609">Uint64</span><span class="op" id="3205615">,</span>&nbsp;<span class="ident" id="3205617">reflect</span><span class="op" id="3205624">.</span><span class="ident" id="3205625">Uintptr</span><span class="op" id="3205632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205636">truth</span>&nbsp;<span class="op" id="3205642">=</span>&nbsp;<span class="ident" id="3205644">val</span><span class="op" id="3205647">.</span><span class="ident" id="3205648">Uint</span><span class="op" id="3205652">(</span><span class="op" id="3205653">)</span>&nbsp;<span class="op" id="3205655">!=</span>&nbsp;<span class="num" id="3205658">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205661">case</span>&nbsp;<span class="ident" id="3205666">reflect</span><span class="op" id="3205673">.</span><span class="ident" id="3205674">Struct</span><span class="op" id="3205680">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205684">truth</span>&nbsp;<span class="op" id="3205690">=</span>&nbsp;<span class="builtintype" id="3205692">true</span>&nbsp;<span class="comment" id="3205697">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205732">default</span><span class="op" id="3205739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205743">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3205751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205754">return</span>&nbsp;<span class="ident" id="3205761">truth</span><span class="op" id="3205766">,</span>&nbsp;<span class="builtintype" id="3205768">true</span><br>
<span class="lineno">240</span><span class="op" id="3205773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3205776">func</span>&nbsp;<span class="op" id="3205781">(</span><span class="ident" id="3205782">s</span>&nbsp;<span class="op" id="3205784">*</span><span class="ident" id="3205785">state</span><span class="op" id="3205790">)</span>&nbsp;<span class="ident" id="3205792">walkRange</span><span class="op" id="3205801">(</span><span class="ident" id="3205802">dot</span>&nbsp;<span class="ident" id="3205806">reflect</span><span class="op" id="3205813">.</span><span class="ident" id="3205814">Value</span><span class="op" id="3205819">,</span>&nbsp;<span class="ident" id="3205821">r</span>&nbsp;<span class="op" id="3205823">*</span><span class="ident" id="3205824">parse</span><span class="op" id="3205829">.</span><span class="ident" id="3205830">RangeNode</span><span class="op" id="3205839">)</span>&nbsp;<span class="op" id="3205841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205844">s</span><span class="op" id="3205845">.</span><span class="ident" id="3205846">at</span><span class="op" id="3205848">(</span><span class="ident" id="3205849">r</span><span class="op" id="3205850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205853">defer</span>&nbsp;<span class="ident" id="3205859">s</span><span class="op" id="3205860">.</span><span class="ident" id="3205861">pop</span><span class="op" id="3205864">(</span><span class="ident" id="3205865">s</span><span class="op" id="3205866">.</span><span class="ident" id="3205867">mark</span><span class="op" id="3205871">(</span><span class="op" id="3205872">)</span><span class="op" id="3205873">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205876">val</span><span class="op" id="3205879">,</span>&nbsp;<span class="ident" id="3205881">_</span>&nbsp;<span class="op" id="3205883">:=</span>&nbsp;<span class="ident" id="3205886">indirect</span><span class="op" id="3205894">(</span><span class="ident" id="3205895">s</span><span class="op" id="3205896">.</span><span class="ident" id="3205897">evalPipeline</span><span class="op" id="3205909">(</span><span class="ident" id="3205910">dot</span><span class="op" id="3205913">,</span>&nbsp;<span class="ident" id="3205915">r</span><span class="op" id="3205916">.</span><span class="ident" id="3205917">Pipe</span><span class="op" id="3205921">)</span><span class="op" id="3205922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205925">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205992">mark</span>&nbsp;<span class="op" id="3205997">:=</span>&nbsp;<span class="ident" id="3206000">s</span><span class="op" id="3206001">.</span><span class="ident" id="3206002">mark</span><span class="op" id="3206006">(</span><span class="op" id="3206007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206010">oneIteration</span>&nbsp;<span class="op" id="3206023">:=</span>&nbsp;<span class="keyword" id="3206026">func</span><span class="op" id="3206030">(</span><span class="ident" id="3206031">index</span><span class="op" id="3206036">,</span>&nbsp;<span class="ident" id="3206038">elem</span>&nbsp;<span class="ident" id="3206043">reflect</span><span class="op" id="3206050">.</span><span class="ident" id="3206051">Value</span><span class="op" id="3206056">)</span>&nbsp;<span class="op" id="3206058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3206062">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206135">if</span>&nbsp;<span class="builtinfunc" id="3206138">len</span><span class="op" id="3206141">(</span><span class="ident" id="3206142">r</span><span class="op" id="3206143">.</span><span class="ident" id="3206144">Pipe</span><span class="op" id="3206148">.</span><span class="ident" id="3206149">Decl</span><span class="op" id="3206153">)</span>&nbsp;<span class="op" id="3206155">&gt;</span>&nbsp;<span class="num" id="3206157">0</span>&nbsp;<span class="op" id="3206159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206164">s</span><span class="op" id="3206165">.</span><span class="ident" id="3206166">setVar</span><span class="op" id="3206172">(</span><span class="num" id="3206173">1</span><span class="op" id="3206174">,</span>&nbsp;<span class="ident" id="3206176">elem</span><span class="op" id="3206180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3206188">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206259">if</span>&nbsp;<span class="builtinfunc" id="3206262">len</span><span class="op" id="3206265">(</span><span class="ident" id="3206266">r</span><span class="op" id="3206267">.</span><span class="ident" id="3206268">Pipe</span><span class="op" id="3206272">.</span><span class="ident" id="3206273">Decl</span><span class="op" id="3206277">)</span>&nbsp;<span class="op" id="3206279">&gt;</span>&nbsp;<span class="num" id="3206281">1</span>&nbsp;<span class="op" id="3206283">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206288">s</span><span class="op" id="3206289">.</span><span class="ident" id="3206290">setVar</span><span class="op" id="3206296">(</span><span class="num" id="3206297">2</span><span class="op" id="3206298">,</span>&nbsp;<span class="ident" id="3206300">index</span><span class="op" id="3206305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206313">s</span><span class="op" id="3206314">.</span><span class="ident" id="3206315">walk</span><span class="op" id="3206319">(</span><span class="ident" id="3206320">elem</span><span class="op" id="3206324">,</span>&nbsp;<span class="ident" id="3206326">r</span><span class="op" id="3206327">.</span><span class="ident" id="3206328">List</span><span class="op" id="3206332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206336">s</span><span class="op" id="3206337">.</span><span class="ident" id="3206338">pop</span><span class="op" id="3206341">(</span><span class="ident" id="3206342">mark</span><span class="op" id="3206346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206349">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206352">switch</span>&nbsp;<span class="ident" id="3206359">val</span><span class="op" id="3206362">.</span><span class="ident" id="3206363">Kind</span><span class="op" id="3206367">(</span><span class="op" id="3206368">)</span>&nbsp;<span class="op" id="3206370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206373">case</span>&nbsp;<span class="ident" id="3206378">reflect</span><span class="op" id="3206385">.</span><span class="ident" id="3206386">Array</span><span class="op" id="3206391">,</span>&nbsp;<span class="ident" id="3206393">reflect</span><span class="op" id="3206400">.</span><span class="ident" id="3206401">Slice</span><span class="op" id="3206406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206410">if</span>&nbsp;<span class="ident" id="3206413">val</span><span class="op" id="3206416">.</span><span class="ident" id="3206417">Len</span><span class="op" id="3206420">(</span><span class="op" id="3206421">)</span>&nbsp;<span class="op" id="3206423">==</span>&nbsp;<span class="num" id="3206426">0</span>&nbsp;<span class="op" id="3206428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206433">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206441">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206445">for</span>&nbsp;<span class="ident" id="3206449">i</span>&nbsp;<span class="op" id="3206451">:=</span>&nbsp;<span class="num" id="3206454">0</span><span class="op" id="3206455">;</span>&nbsp;<span class="ident" id="3206457">i</span>&nbsp;<span class="op" id="3206459">&lt;</span>&nbsp;<span class="ident" id="3206461">val</span><span class="op" id="3206464">.</span><span class="ident" id="3206465">Len</span><span class="op" id="3206468">(</span><span class="op" id="3206469">)</span><span class="op" id="3206470">;</span>&nbsp;<span class="ident" id="3206472">i</span><span class="op" id="3206473">++</span>&nbsp;<span class="op" id="3206476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206481">oneIteration</span><span class="op" id="3206493">(</span><span class="ident" id="3206494">reflect</span><span class="op" id="3206501">.</span><span class="ident" id="3206502">ValueOf</span><span class="op" id="3206509">(</span><span class="ident" id="3206510">i</span><span class="op" id="3206511">)</span><span class="op" id="3206512">,</span>&nbsp;<span class="ident" id="3206514">val</span><span class="op" id="3206517">.</span><span class="ident" id="3206518">Index</span><span class="op" id="3206523">(</span><span class="ident" id="3206524">i</span><span class="op" id="3206525">)</span><span class="op" id="3206526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206534">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206542">case</span>&nbsp;<span class="ident" id="3206547">reflect</span><span class="op" id="3206554">.</span><span class="ident" id="3206555">Map</span><span class="op" id="3206558">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206562">if</span>&nbsp;<span class="ident" id="3206565">val</span><span class="op" id="3206568">.</span><span class="ident" id="3206569">Len</span><span class="op" id="3206572">(</span><span class="op" id="3206573">)</span>&nbsp;<span class="op" id="3206575">==</span>&nbsp;<span class="num" id="3206578">0</span>&nbsp;<span class="op" id="3206580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206585">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206597">for</span>&nbsp;<span class="ident" id="3206601">_</span><span class="op" id="3206602">,</span>&nbsp;<span class="ident" id="3206604">key</span>&nbsp;<span class="op" id="3206608">:=</span>&nbsp;<span class="keyword" id="3206611">range</span>&nbsp;<span class="ident" id="3206617">sortKeys</span><span class="op" id="3206625">(</span><span class="ident" id="3206626">val</span><span class="op" id="3206629">.</span><span class="ident" id="3206630">MapKeys</span><span class="op" id="3206637">(</span><span class="op" id="3206638">)</span><span class="op" id="3206639">)</span>&nbsp;<span class="op" id="3206641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206646">oneIteration</span><span class="op" id="3206658">(</span><span class="ident" id="3206659">key</span><span class="op" id="3206662">,</span>&nbsp;<span class="ident" id="3206664">val</span><span class="op" id="3206667">.</span><span class="ident" id="3206668">MapIndex</span><span class="op" id="3206676">(</span><span class="ident" id="3206677">key</span><span class="op" id="3206680">)</span><span class="op" id="3206681">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206689">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206697">case</span>&nbsp;<span class="ident" id="3206702">reflect</span><span class="op" id="3206709">.</span><span class="ident" id="3206710">Chan</span><span class="op" id="3206714">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206718">if</span>&nbsp;<span class="ident" id="3206721">val</span><span class="op" id="3206724">.</span><span class="ident" id="3206725">IsNil</span><span class="op" id="3206730">(</span><span class="op" id="3206731">)</span>&nbsp;<span class="op" id="3206733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206738">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206750">i</span>&nbsp;<span class="op" id="3206752">:=</span>&nbsp;<span class="num" id="3206755">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206759">for</span>&nbsp;<span class="op" id="3206763">;</span>&nbsp;<span class="op" id="3206765">;</span>&nbsp;<span class="ident" id="3206767">i</span><span class="op" id="3206768">++</span>&nbsp;<span class="op" id="3206771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206776">elem</span><span class="op" id="3206780">,</span>&nbsp;<span class="ident" id="3206782">ok</span>&nbsp;<span class="op" id="3206785">:=</span>&nbsp;<span class="ident" id="3206788">val</span><span class="op" id="3206791">.</span><span class="ident" id="3206792">Recv</span><span class="op" id="3206796">(</span><span class="op" id="3206797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206802">if</span>&nbsp;<span class="op" id="3206805">!</span><span class="ident" id="3206806">ok</span>&nbsp;<span class="op" id="3206809">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206815">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206829">oneIteration</span><span class="op" id="3206841">(</span><span class="ident" id="3206842">reflect</span><span class="op" id="3206849">.</span><span class="ident" id="3206850">ValueOf</span><span class="op" id="3206857">(</span><span class="ident" id="3206858">i</span><span class="op" id="3206859">)</span><span class="op" id="3206860">,</span>&nbsp;<span class="ident" id="3206862">elem</span><span class="op" id="3206866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206874">if</span>&nbsp;<span class="ident" id="3206877">i</span>&nbsp;<span class="op" id="3206879">==</span>&nbsp;<span class="num" id="3206882">0</span>&nbsp;<span class="op" id="3206884">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206889">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206909">case</span>&nbsp;<span class="ident" id="3206914">reflect</span><span class="op" id="3206921">.</span><span class="ident" id="3206922">Invalid</span><span class="op" id="3206929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206933">break</span>&nbsp;<span class="comment" id="3206939">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207014">default</span><span class="op" id="3207021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207025">s</span><span class="op" id="3207026">.</span><span class="ident" id="3207027">errorf</span><span class="op" id="3207033">(</span><span class="string" id="3207034">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="3207063">,</span>&nbsp;<span class="ident" id="3207065">val</span><span class="op" id="3207068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207074">if</span>&nbsp;<span class="ident" id="3207077">r</span><span class="op" id="3207078">.</span><span class="ident" id="3207079">ElseList</span>&nbsp;<span class="op" id="3207088">!=</span>&nbsp;<span class="ident" id="3207091">nil</span>&nbsp;<span class="op" id="3207095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207099">s</span><span class="op" id="3207100">.</span><span class="ident" id="3207101">walk</span><span class="op" id="3207105">(</span><span class="ident" id="3207106">dot</span><span class="op" id="3207109">,</span>&nbsp;<span class="ident" id="3207111">r</span><span class="op" id="3207112">.</span><span class="ident" id="3207113">ElseList</span><span class="op" id="3207121">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207124">}</span><br>
<span class="lineno"></span><span class="op" id="3207126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3207129">func</span>&nbsp;<span class="op" id="3207134">(</span><span class="ident" id="3207135">s</span>&nbsp;<span class="op" id="3207137">*</span><span class="ident" id="3207138">state</span><span class="op" id="3207143">)</span>&nbsp;<span class="ident" id="3207145">walkTemplate</span><span class="op" id="3207157">(</span><span class="ident" id="3207158">dot</span>&nbsp;<span class="ident" id="3207162">reflect</span><span class="op" id="3207169">.</span><span class="ident" id="3207170">Value</span><span class="op" id="3207175">,</span>&nbsp;<span class="ident" id="3207177">t</span>&nbsp;<span class="op" id="3207179">*</span><span class="ident" id="3207180">parse</span><span class="op" id="3207185">.</span><span class="ident" id="3207186">TemplateNode</span><span class="op" id="3207198">)</span>&nbsp;<span class="op" id="3207200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207203">s</span><span class="op" id="3207204">.</span><span class="ident" id="3207205">at</span><span class="op" id="3207207">(</span><span class="ident" id="3207208">t</span><span class="op" id="3207209">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207212">tmpl</span>&nbsp;<span class="op" id="3207217">:=</span>&nbsp;<span class="ident" id="3207220">s</span><span class="op" id="3207221">.</span><span class="ident" id="3207222">tmpl</span><span class="op" id="3207226">.</span><span class="ident" id="3207227">tmpl</span><span class="op" id="3207231">[</span><span class="ident" id="3207232">t</span><span class="op" id="3207233">.</span><span class="ident" id="3207234">Name</span><span class="op" id="3207238">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207241">if</span>&nbsp;<span class="ident" id="3207244">tmpl</span>&nbsp;<span class="op" id="3207249">==</span>&nbsp;<span class="ident" id="3207252">nil</span>&nbsp;<span class="op" id="3207256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207260">s</span><span class="op" id="3207261">.</span><span class="ident" id="3207262">errorf</span><span class="op" id="3207268">(</span><span class="string" id="3207269">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="3207294">,</span>&nbsp;<span class="ident" id="3207296">t</span><span class="op" id="3207297">.</span><span class="ident" id="3207298">Name</span><span class="op" id="3207302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3207308">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207356">dot</span>&nbsp;<span class="op" id="3207360">=</span>&nbsp;<span class="ident" id="3207362">s</span><span class="op" id="3207363">.</span><span class="ident" id="3207364">evalPipeline</span><span class="op" id="3207376">(</span><span class="ident" id="3207377">dot</span><span class="op" id="3207380">,</span>&nbsp;<span class="ident" id="3207382">t</span><span class="op" id="3207383">.</span><span class="ident" id="3207384">Pipe</span><span class="op" id="3207388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207391">newState</span>&nbsp;<span class="op" id="3207400">:=</span>&nbsp;<span class="op" id="3207403">*</span><span class="ident" id="3207404">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207407">newState</span><span class="op" id="3207415">.</span><span class="ident" id="3207416">tmpl</span>&nbsp;<span class="op" id="3207421">=</span>&nbsp;<span class="ident" id="3207423">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3207429">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207496">newState</span><span class="op" id="3207504">.</span><span class="ident" id="3207505">vars</span>&nbsp;<span class="op" id="3207510">=</span>&nbsp;<span class="op" id="3207512">[</span><span class="op" id="3207513">]</span><span class="ident" id="3207514">variable</span><span class="op" id="3207522">{</span><span class="op" id="3207523">{</span><span class="string" id="3207524">&#34;$&#34;</span><span class="op" id="3207527">,</span>&nbsp;<span class="ident" id="3207529">dot</span><span class="op" id="3207532">}</span><span class="op" id="3207533">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207536">newState</span><span class="op" id="3207544">.</span><span class="ident" id="3207545">walk</span><span class="op" id="3207549">(</span><span class="ident" id="3207550">dot</span><span class="op" id="3207553">,</span>&nbsp;<span class="ident" id="3207555">tmpl</span><span class="op" id="3207559">.</span><span class="ident" id="3207560">Root</span><span class="op" id="3207564">)</span><br>
<span class="lineno"></span><span class="op" id="3207566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3207569">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="3207648">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="3207731">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3207801">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3207877">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3207952">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="3208025">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3208080">func</span>&nbsp;<span class="op" id="3208085">(</span><span class="ident" id="3208086">s</span>&nbsp;<span class="op" id="3208088">*</span><span class="ident" id="3208089">state</span><span class="op" id="3208094">)</span>&nbsp;<span class="ident" id="3208096">evalPipeline</span><span class="op" id="3208108">(</span><span class="ident" id="3208109">dot</span>&nbsp;<span class="ident" id="3208113">reflect</span><span class="op" id="3208120">.</span><span class="ident" id="3208121">Value</span><span class="op" id="3208126">,</span>&nbsp;<span class="ident" id="3208128">pipe</span>&nbsp;<span class="op" id="3208133">*</span><span class="ident" id="3208134">parse</span><span class="op" id="3208139">.</span><span class="ident" id="3208140">PipeNode</span><span class="op" id="3208148">)</span>&nbsp;<span class="op" id="3208150">(</span><span class="ident" id="3208151">value</span>&nbsp;<span class="ident" id="3208157">reflect</span><span class="op" id="3208164">.</span><span class="ident" id="3208165">Value</span><span class="op" id="3208170">)</span>&nbsp;<span class="op" id="3208172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208175">if</span>&nbsp;<span class="ident" id="3208178">pipe</span>&nbsp;<span class="op" id="3208183">==</span>&nbsp;<span class="ident" id="3208186">nil</span>&nbsp;<span class="op" id="3208190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208194">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208202">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208205">s</span><span class="op" id="3208206">.</span><span class="ident" id="3208207">at</span><span class="op" id="3208209">(</span><span class="ident" id="3208210">pipe</span><span class="op" id="3208214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208217">for</span>&nbsp;<span class="ident" id="3208221">_</span><span class="op" id="3208222">,</span>&nbsp;<span class="ident" id="3208224">cmd</span>&nbsp;<span class="op" id="3208228">:=</span>&nbsp;<span class="keyword" id="3208231">range</span>&nbsp;<span class="ident" id="3208237">pipe</span><span class="op" id="3208241">.</span><span class="ident" id="3208242">Cmds</span>&nbsp;<span class="op" id="3208247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208251">value</span>&nbsp;<span class="op" id="3208257">=</span>&nbsp;<span class="ident" id="3208259">s</span><span class="op" id="3208260">.</span><span class="ident" id="3208261">evalCommand</span><span class="op" id="3208272">(</span><span class="ident" id="3208273">dot</span><span class="op" id="3208276">,</span>&nbsp;<span class="ident" id="3208278">cmd</span><span class="op" id="3208281">,</span>&nbsp;<span class="ident" id="3208283">value</span><span class="op" id="3208288">)</span>&nbsp;<span class="comment" id="3208290">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3208335">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208416">if</span>&nbsp;<span class="ident" id="3208419">value</span><span class="op" id="3208424">.</span><span class="ident" id="3208425">Kind</span><span class="op" id="3208429">(</span><span class="op" id="3208430">)</span>&nbsp;<span class="op" id="3208432">==</span>&nbsp;<span class="ident" id="3208435">reflect</span><span class="op" id="3208442">.</span><span class="ident" id="3208443">Interface</span>&nbsp;<span class="op" id="3208453">&amp;&amp;</span>&nbsp;<span class="ident" id="3208456">value</span><span class="op" id="3208461">.</span><span class="ident" id="3208462">Type</span><span class="op" id="3208466">(</span><span class="op" id="3208467">)</span><span class="op" id="3208468">.</span><span class="ident" id="3208469">NumMethod</span><span class="op" id="3208478">(</span><span class="op" id="3208479">)</span>&nbsp;<span class="op" id="3208481">==</span>&nbsp;<span class="num" id="3208484">0</span>&nbsp;<span class="op" id="3208486">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208491">value</span>&nbsp;<span class="op" id="3208497">=</span>&nbsp;<span class="ident" id="3208499">reflect</span><span class="op" id="3208506">.</span><span class="ident" id="3208507">ValueOf</span><span class="op" id="3208514">(</span><span class="ident" id="3208515">value</span><span class="op" id="3208520">.</span><span class="ident" id="3208521">Interface</span><span class="op" id="3208530">(</span><span class="op" id="3208531">)</span><span class="op" id="3208532">)</span>&nbsp;<span class="comment" id="3208534">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208553">for</span>&nbsp;<span class="ident" id="3208557">_</span><span class="op" id="3208558">,</span>&nbsp;<span class="ident" id="3208560">variable</span>&nbsp;<span class="op" id="3208569">:=</span>&nbsp;<span class="keyword" id="3208572">range</span>&nbsp;<span class="ident" id="3208578">pipe</span><span class="op" id="3208582">.</span><span class="ident" id="3208583">Decl</span>&nbsp;<span class="op" id="3208588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208592">s</span><span class="op" id="3208593">.</span><span class="ident" id="3208594">push</span><span class="op" id="3208598">(</span><span class="ident" id="3208599">variable</span><span class="op" id="3208607">.</span><span class="ident" id="3208608">Ident</span><span class="op" id="3208613">[</span><span class="num" id="3208614">0</span><span class="op" id="3208615">]</span><span class="op" id="3208616">,</span>&nbsp;<span class="ident" id="3208618">value</span><span class="op" id="3208623">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208629">return</span>&nbsp;<span class="ident" id="3208636">value</span><br>
<span class="lineno"></span><span class="op" id="3208642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3208645">func</span>&nbsp;<span class="op" id="3208650">(</span><span class="ident" id="3208651">s</span>&nbsp;<span class="op" id="3208653">*</span><span class="ident" id="3208654">state</span><span class="op" id="3208659">)</span>&nbsp;<span class="ident" id="3208661">notAFunction</span><span class="op" id="3208673">(</span><span class="ident" id="3208674">args</span>&nbsp;<span class="op" id="3208679">[</span><span class="op" id="3208680">]</span><span class="ident" id="3208681">parse</span><span class="op" id="3208686">.</span><span class="ident" id="3208687">Node</span><span class="op" id="3208691">,</span>&nbsp;<span class="ident" id="3208693">final</span>&nbsp;<span class="ident" id="3208699">reflect</span><span class="op" id="3208706">.</span><span class="ident" id="3208707">Value</span><span class="op" id="3208712">)</span>&nbsp;<span class="op" id="3208714">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208717">if</span>&nbsp;<span class="builtinfunc" id="3208720">len</span><span class="op" id="3208723">(</span><span class="ident" id="3208724">args</span><span class="op" id="3208728">)</span>&nbsp;<span class="op" id="3208730">&gt;</span>&nbsp;<span class="num" id="3208732">1</span>&nbsp;<span class="op" id="3208734">||</span>&nbsp;<span class="ident" id="3208737">final</span><span class="op" id="3208742">.</span><span class="ident" id="3208743">IsValid</span><span class="op" id="3208750">(</span><span class="op" id="3208751">)</span>&nbsp;<span class="op" id="3208753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208757">s</span><span class="op" id="3208758">.</span><span class="ident" id="3208759">errorf</span><span class="op" id="3208765">(</span><span class="string" id="3208766">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="3208806">,</span>&nbsp;<span class="ident" id="3208808">args</span><span class="op" id="3208812">[</span><span class="num" id="3208813">0</span><span class="op" id="3208814">]</span><span class="op" id="3208815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208818">}</span><br>
<span class="lineno"></span><span class="op" id="3208820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3208823">func</span>&nbsp;<span class="op" id="3208828">(</span><span class="ident" id="3208829">s</span>&nbsp;<span class="op" id="3208831">*</span><span class="ident" id="3208832">state</span><span class="op" id="3208837">)</span>&nbsp;<span class="ident" id="3208839">evalCommand</span><span class="op" id="3208850">(</span><span class="ident" id="3208851">dot</span>&nbsp;<span class="ident" id="3208855">reflect</span><span class="op" id="3208862">.</span><span class="ident" id="3208863">Value</span><span class="op" id="3208868">,</span>&nbsp;<span class="ident" id="3208870">cmd</span>&nbsp;<span class="op" id="3208874">*</span><span class="ident" id="3208875">parse</span><span class="op" id="3208880">.</span><span class="ident" id="3208881">CommandNode</span><span class="op" id="3208892">,</span>&nbsp;<span class="ident" id="3208894">final</span>&nbsp;<span class="ident" id="3208900">reflect</span><span class="op" id="3208907">.</span><span class="ident" id="3208908">Value</span><span class="op" id="3208913">)</span>&nbsp;<span class="ident" id="3208915">reflect</span><span class="op" id="3208922">.</span><span class="ident" id="3208923">Value</span>&nbsp;<span class="op" id="3208929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208932">firstWord</span>&nbsp;<span class="op" id="3208942">:=</span>&nbsp;<span class="ident" id="3208945">cmd</span><span class="op" id="3208948">.</span><span class="ident" id="3208949">Args</span><span class="op" id="3208953">[</span><span class="num" id="3208954">0</span><span class="op" id="3208955">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208958">switch</span>&nbsp;<span class="ident" id="3208965">n</span>&nbsp;<span class="op" id="3208967">:=</span>&nbsp;<span class="ident" id="3208970">firstWord</span><span class="op" id="3208979">.</span><span class="op" id="3208980">(</span><span class="keyword" id="3208981">type</span><span class="op" id="3208985">)</span>&nbsp;<span class="op" id="3208987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208990">case</span>&nbsp;<span class="op" id="3208995">*</span><span class="ident" id="3208996">parse</span><span class="op" id="3209001">.</span><span class="ident" id="3209002">FieldNode</span><span class="op" id="3209011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209015">return</span>&nbsp;<span class="ident" id="3209022">s</span><span class="op" id="3209023">.</span><span class="ident" id="3209024">evalFieldNode</span><span class="op" id="3209037">(</span><span class="ident" id="3209038">dot</span><span class="op" id="3209041">,</span>&nbsp;<span class="ident" id="3209043">n</span><span class="op" id="3209044">,</span>&nbsp;<span class="ident" id="3209046">cmd</span><span class="op" id="3209049">.</span><span class="ident" id="3209050">Args</span><span class="op" id="3209054">,</span>&nbsp;<span class="ident" id="3209056">final</span><span class="op" id="3209061">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209064">case</span>&nbsp;<span class="op" id="3209069">*</span><span class="ident" id="3209070">parse</span><span class="op" id="3209075">.</span><span class="ident" id="3209076">ChainNode</span><span class="op" id="3209085">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209089">return</span>&nbsp;<span class="ident" id="3209096">s</span><span class="op" id="3209097">.</span><span class="ident" id="3209098">evalChainNode</span><span class="op" id="3209111">(</span><span class="ident" id="3209112">dot</span><span class="op" id="3209115">,</span>&nbsp;<span class="ident" id="3209117">n</span><span class="op" id="3209118">,</span>&nbsp;<span class="ident" id="3209120">cmd</span><span class="op" id="3209123">.</span><span class="ident" id="3209124">Args</span><span class="op" id="3209128">,</span>&nbsp;<span class="ident" id="3209130">final</span><span class="op" id="3209135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209138">case</span>&nbsp;<span class="op" id="3209143">*</span><span class="ident" id="3209144">parse</span><span class="op" id="3209149">.</span><span class="ident" id="3209150">IdentifierNode</span><span class="op" id="3209164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3209168">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209193">return</span>&nbsp;<span class="ident" id="3209200">s</span><span class="op" id="3209201">.</span><span class="ident" id="3209202">evalFunction</span><span class="op" id="3209214">(</span><span class="ident" id="3209215">dot</span><span class="op" id="3209218">,</span>&nbsp;<span class="ident" id="3209220">n</span><span class="op" id="3209221">,</span>&nbsp;<span class="ident" id="3209223">cmd</span><span class="op" id="3209226">,</span>&nbsp;<span class="ident" id="3209228">cmd</span><span class="op" id="3209231">.</span><span class="ident" id="3209232">Args</span><span class="op" id="3209236">,</span>&nbsp;<span class="ident" id="3209238">final</span><span class="op" id="3209243">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209246">case</span>&nbsp;<span class="op" id="3209251">*</span><span class="ident" id="3209252">parse</span><span class="op" id="3209257">.</span><span class="ident" id="3209258">PipeNode</span><span class="op" id="3209266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3209270">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209360">return</span>&nbsp;<span class="ident" id="3209367">s</span><span class="op" id="3209368">.</span><span class="ident" id="3209369">evalPipeline</span><span class="op" id="3209381">(</span><span class="ident" id="3209382">dot</span><span class="op" id="3209385">,</span>&nbsp;<span class="ident" id="3209387">n</span><span class="op" id="3209388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209391">case</span>&nbsp;<span class="op" id="3209396">*</span><span class="ident" id="3209397">parse</span><span class="op" id="3209402">.</span><span class="ident" id="3209403">VariableNode</span><span class="op" id="3209415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209419">return</span>&nbsp;<span class="ident" id="3209426">s</span><span class="op" id="3209427">.</span><span class="ident" id="3209428">evalVariableNode</span><span class="op" id="3209444">(</span><span class="ident" id="3209445">dot</span><span class="op" id="3209448">,</span>&nbsp;<span class="ident" id="3209450">n</span><span class="op" id="3209451">,</span>&nbsp;<span class="ident" id="3209453">cmd</span><span class="op" id="3209456">.</span><span class="ident" id="3209457">Args</span><span class="op" id="3209461">,</span>&nbsp;<span class="ident" id="3209463">final</span><span class="op" id="3209468">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209474">s</span><span class="op" id="3209475">.</span><span class="ident" id="3209476">at</span><span class="op" id="3209478">(</span><span class="ident" id="3209479">firstWord</span><span class="op" id="3209488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209491">s</span><span class="op" id="3209492">.</span><span class="ident" id="3209493">notAFunction</span><span class="op" id="3209505">(</span><span class="ident" id="3209506">cmd</span><span class="op" id="3209509">.</span><span class="ident" id="3209510">Args</span><span class="op" id="3209514">,</span>&nbsp;<span class="ident" id="3209516">final</span><span class="op" id="3209521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209524">switch</span>&nbsp;<span class="ident" id="3209531">word</span>&nbsp;<span class="op" id="3209536">:=</span>&nbsp;<span class="ident" id="3209539">firstWord</span><span class="op" id="3209548">.</span><span class="op" id="3209549">(</span><span class="keyword" id="3209550">type</span><span class="op" id="3209554">)</span>&nbsp;<span class="op" id="3209556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209559">case</span>&nbsp;<span class="op" id="3209564">*</span><span class="ident" id="3209565">parse</span><span class="op" id="3209570">.</span><span class="ident" id="3209571">BoolNode</span><span class="op" id="3209579">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209583">return</span>&nbsp;<span class="ident" id="3209590">reflect</span><span class="op" id="3209597">.</span><span class="ident" id="3209598">ValueOf</span><span class="op" id="3209605">(</span><span class="ident" id="3209606">word</span><span class="op" id="3209610">.</span><span class="ident" id="3209611">True</span><span class="op" id="3209615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209618">case</span>&nbsp;<span class="op" id="3209623">*</span><span class="ident" id="3209624">parse</span><span class="op" id="3209629">.</span><span class="ident" id="3209630">DotNode</span><span class="op" id="3209637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209641">return</span>&nbsp;<span class="ident" id="3209648">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209653">case</span>&nbsp;<span class="op" id="3209658">*</span><span class="ident" id="3209659">parse</span><span class="op" id="3209664">.</span><span class="ident" id="3209665">NilNode</span><span class="op" id="3209672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209676">s</span><span class="op" id="3209677">.</span><span class="ident" id="3209678">errorf</span><span class="op" id="3209684">(</span><span class="string" id="3209685">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="3209707">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209710">case</span>&nbsp;<span class="op" id="3209715">*</span><span class="ident" id="3209716">parse</span><span class="op" id="3209721">.</span><span class="ident" id="3209722">NumberNode</span><span class="op" id="3209732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209736">return</span>&nbsp;<span class="ident" id="3209743">s</span><span class="op" id="3209744">.</span><span class="ident" id="3209745">idealConstant</span><span class="op" id="3209758">(</span><span class="ident" id="3209759">word</span><span class="op" id="3209763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209766">case</span>&nbsp;<span class="op" id="3209771">*</span><span class="ident" id="3209772">parse</span><span class="op" id="3209777">.</span><span class="ident" id="3209778">StringNode</span><span class="op" id="3209788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209792">return</span>&nbsp;<span class="ident" id="3209799">reflect</span><span class="op" id="3209806">.</span><span class="ident" id="3209807">ValueOf</span><span class="op" id="3209814">(</span><span class="ident" id="3209815">word</span><span class="op" id="3209819">.</span><span class="ident" id="3209820">Text</span><span class="op" id="3209824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209827">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209830">s</span><span class="op" id="3209831">.</span><span class="ident" id="3209832">errorf</span><span class="op" id="3209838">(</span><span class="string" id="3209839">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="3209866">,</span>&nbsp;<span class="ident" id="3209868">firstWord</span><span class="op" id="3209877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3209880">panic</span><span class="op" id="3209885">(</span><span class="string" id="3209886">&#34;not&nbsp;reached&#34;</span><span class="op" id="3209899">)</span><br>
<span class="lineno"></span><span class="op" id="3209901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3209904">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="3209982">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="3210057">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3210134">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3210210">func</span>&nbsp;<span class="op" id="3210215">(</span><span class="ident" id="3210216">s</span>&nbsp;<span class="op" id="3210218">*</span><span class="ident" id="3210219">state</span><span class="op" id="3210224">)</span>&nbsp;<span class="ident" id="3210226">idealConstant</span><span class="op" id="3210239">(</span><span class="ident" id="3210240">constant</span>&nbsp;<span class="op" id="3210249">*</span><span class="ident" id="3210250">parse</span><span class="op" id="3210255">.</span><span class="ident" id="3210256">NumberNode</span><span class="op" id="3210266">)</span>&nbsp;<span class="ident" id="3210268">reflect</span><span class="op" id="3210275">.</span><span class="ident" id="3210276">Value</span>&nbsp;<span class="op" id="3210282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3210285">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3210342">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3210401">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210467">s</span><span class="op" id="3210468">.</span><span class="ident" id="3210469">at</span><span class="op" id="3210471">(</span><span class="ident" id="3210472">constant</span><span class="op" id="3210480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210483">switch</span>&nbsp;<span class="op" id="3210490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210493">case</span>&nbsp;<span class="ident" id="3210498">constant</span><span class="op" id="3210506">.</span><span class="ident" id="3210507">IsComplex</span><span class="op" id="3210516">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210520">return</span>&nbsp;<span class="ident" id="3210527">reflect</span><span class="op" id="3210534">.</span><span class="ident" id="3210535">ValueOf</span><span class="op" id="3210542">(</span><span class="ident" id="3210543">constant</span><span class="op" id="3210551">.</span><span class="ident" id="3210552">Complex128</span><span class="op" id="3210562">)</span>&nbsp;<span class="comment" id="3210564">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210586">case</span>&nbsp;<span class="ident" id="3210591">constant</span><span class="op" id="3210599">.</span><span class="ident" id="3210600">IsFloat</span>&nbsp;<span class="op" id="3210608">&amp;&amp;</span>&nbsp;<span class="op" id="3210611">!</span><span class="ident" id="3210612">isHexConstant</span><span class="op" id="3210625">(</span><span class="ident" id="3210626">constant</span><span class="op" id="3210634">.</span><span class="ident" id="3210635">Text</span><span class="op" id="3210639">)</span>&nbsp;<span class="op" id="3210641">&amp;&amp;</span>&nbsp;<span class="ident" id="3210644">strings</span><span class="op" id="3210651">.</span><span class="ident" id="3210652">IndexAny</span><span class="op" id="3210660">(</span><span class="ident" id="3210661">constant</span><span class="op" id="3210669">.</span><span class="ident" id="3210670">Text</span><span class="op" id="3210674">,</span>&nbsp;<span class="string" id="3210676">&#34;.eE&#34;</span><span class="op" id="3210681">)</span>&nbsp;<span class="op" id="3210683">&gt;=</span>&nbsp;<span class="num" id="3210686">0</span><span class="op" id="3210687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210691">return</span>&nbsp;<span class="ident" id="3210698">reflect</span><span class="op" id="3210705">.</span><span class="ident" id="3210706">ValueOf</span><span class="op" id="3210713">(</span><span class="ident" id="3210714">constant</span><span class="op" id="3210722">.</span><span class="ident" id="3210723">Float64</span><span class="op" id="3210730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210733">case</span>&nbsp;<span class="ident" id="3210738">constant</span><span class="op" id="3210746">.</span><span class="ident" id="3210747">IsInt</span><span class="op" id="3210752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210756">n</span>&nbsp;<span class="op" id="3210758">:=</span>&nbsp;<span class="builtintype" id="3210761">int</span><span class="op" id="3210764">(</span><span class="ident" id="3210765">constant</span><span class="op" id="3210773">.</span><span class="ident" id="3210774">Int64</span><span class="op" id="3210779">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210783">if</span>&nbsp;<span class="ident" id="3210786">int64</span><span class="op" id="3210791">(</span><span class="ident" id="3210792">n</span><span class="op" id="3210793">)</span>&nbsp;<span class="op" id="3210795">!=</span>&nbsp;<span class="ident" id="3210798">constant</span><span class="op" id="3210806">.</span><span class="ident" id="3210807">Int64</span>&nbsp;<span class="op" id="3210813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210818">s</span><span class="op" id="3210819">.</span><span class="ident" id="3210820">errorf</span><span class="op" id="3210826">(</span><span class="string" id="3210827">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3210845">,</span>&nbsp;<span class="ident" id="3210847">constant</span><span class="op" id="3210855">.</span><span class="ident" id="3210856">Text</span><span class="op" id="3210860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210868">return</span>&nbsp;<span class="ident" id="3210875">reflect</span><span class="op" id="3210882">.</span><span class="ident" id="3210883">ValueOf</span><span class="op" id="3210890">(</span><span class="ident" id="3210891">n</span><span class="op" id="3210892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210895">case</span>&nbsp;<span class="ident" id="3210900">constant</span><span class="op" id="3210908">.</span><span class="ident" id="3210909">IsUint</span><span class="op" id="3210915">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210919">s</span><span class="op" id="3210920">.</span><span class="ident" id="3210921">errorf</span><span class="op" id="3210927">(</span><span class="string" id="3210928">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3210946">,</span>&nbsp;<span class="ident" id="3210948">constant</span><span class="op" id="3210956">.</span><span class="ident" id="3210957">Text</span><span class="op" id="3210961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210967">return</span>&nbsp;<span class="ident" id="3210974">zero</span><br>
<span class="lineno"></span><span class="op" id="3210979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="3210982">func</span>&nbsp;<span class="ident" id="3210987">isHexConstant</span><span class="op" id="3211000">(</span><span class="ident" id="3211001">s</span>&nbsp;<span class="builtintype" id="3211003">string</span><span class="op" id="3211009">)</span>&nbsp;<span class="builtintype" id="3211011">bool</span>&nbsp;<span class="op" id="3211016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211019">return</span>&nbsp;<span class="builtinfunc" id="3211026">len</span><span class="op" id="3211029">(</span><span class="ident" id="3211030">s</span><span class="op" id="3211031">)</span>&nbsp;<span class="op" id="3211033">&gt;</span>&nbsp;<span class="num" id="3211035">2</span>&nbsp;<span class="op" id="3211037">&amp;&amp;</span>&nbsp;<span class="ident" id="3211040">s</span><span class="op" id="3211041">[</span><span class="num" id="3211042">0</span><span class="op" id="3211043">]</span>&nbsp;<span class="op" id="3211045">==</span>&nbsp;<span class="string" id="3211048">&#39;0&#39;</span>&nbsp;<span class="op" id="3211052">&amp;&amp;</span>&nbsp;<span class="op" id="3211055">(</span><span class="ident" id="3211056">s</span><span class="op" id="3211057">[</span><span class="num" id="3211058">1</span><span class="op" id="3211059">]</span>&nbsp;<span class="op" id="3211061">==</span>&nbsp;<span class="string" id="3211064">&#39;x&#39;</span>&nbsp;<span class="op" id="3211068">||</span>&nbsp;<span class="ident" id="3211071">s</span><span class="op" id="3211072">[</span><span class="num" id="3211073">1</span><span class="op" id="3211074">]</span>&nbsp;<span class="op" id="3211076">==</span>&nbsp;<span class="string" id="3211079">&#39;X&#39;</span><span class="op" id="3211082">)</span><br>
<span class="lineno"></span><span class="op" id="3211084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3211087">func</span>&nbsp;<span class="op" id="3211092">(</span><span class="ident" id="3211093">s</span>&nbsp;<span class="op" id="3211095">*</span><span class="ident" id="3211096">state</span><span class="op" id="3211101">)</span>&nbsp;<span class="ident" id="3211103">evalFieldNode</span><span class="op" id="3211116">(</span><span class="ident" id="3211117">dot</span>&nbsp;<span class="ident" id="3211121">reflect</span><span class="op" id="3211128">.</span><span class="ident" id="3211129">Value</span><span class="op" id="3211134">,</span>&nbsp;<span class="ident" id="3211136">field</span>&nbsp;<span class="op" id="3211142">*</span><span class="ident" id="3211143">parse</span><span class="op" id="3211148">.</span><span class="ident" id="3211149">FieldNode</span><span class="op" id="3211158">,</span>&nbsp;<span class="ident" id="3211160">args</span>&nbsp;<span class="op" id="3211165">[</span><span class="op" id="3211166">]</span><span class="ident" id="3211167">parse</span><span class="op" id="3211172">.</span><span class="ident" id="3211173">Node</span><span class="op" id="3211177">,</span>&nbsp;<span class="ident" id="3211179">final</span>&nbsp;<span class="ident" id="3211185">reflect</span><span class="op" id="3211192">.</span><span class="ident" id="3211193">Value</span><span class="op" id="3211198">)</span>&nbsp;<span class="ident" id="3211200">reflect</span><span class="op" id="3211207">.</span><span class="ident" id="3211208">Value</span>&nbsp;<span class="op" id="3211214">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211217">s</span><span class="op" id="3211218">.</span><span class="ident" id="3211219">at</span><span class="op" id="3211221">(</span><span class="ident" id="3211222">field</span><span class="op" id="3211227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211230">return</span>&nbsp;<span class="ident" id="3211237">s</span><span class="op" id="3211238">.</span><span class="ident" id="3211239">evalFieldChain</span><span class="op" id="3211253">(</span><span class="ident" id="3211254">dot</span><span class="op" id="3211257">,</span>&nbsp;<span class="ident" id="3211259">dot</span><span class="op" id="3211262">,</span>&nbsp;<span class="ident" id="3211264">field</span><span class="op" id="3211269">,</span>&nbsp;<span class="ident" id="3211271">field</span><span class="op" id="3211276">.</span><span class="ident" id="3211277">Ident</span><span class="op" id="3211282">,</span>&nbsp;<span class="ident" id="3211284">args</span><span class="op" id="3211288">,</span>&nbsp;<span class="ident" id="3211290">final</span><span class="op" id="3211295">)</span><br>
<span class="lineno"></span><span class="op" id="3211297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3211300">func</span>&nbsp;<span class="op" id="3211305">(</span><span class="ident" id="3211306">s</span>&nbsp;<span class="op" id="3211308">*</span><span class="ident" id="3211309">state</span><span class="op" id="3211314">)</span>&nbsp;<span class="ident" id="3211316">evalChainNode</span><span class="op" id="3211329">(</span><span class="ident" id="3211330">dot</span>&nbsp;<span class="ident" id="3211334">reflect</span><span class="op" id="3211341">.</span><span class="ident" id="3211342">Value</span><span class="op" id="3211347">,</span>&nbsp;<span class="ident" id="3211349">chain</span>&nbsp;<span class="op" id="3211355">*</span><span class="ident" id="3211356">parse</span><span class="op" id="3211361">.</span><span class="ident" id="3211362">ChainNode</span><span class="op" id="3211371">,</span>&nbsp;<span class="ident" id="3211373">args</span>&nbsp;<span class="op" id="3211378">[</span><span class="op" id="3211379">]</span><span class="ident" id="3211380">parse</span><span class="op" id="3211385">.</span><span class="ident" id="3211386">Node</span><span class="op" id="3211390">,</span>&nbsp;<span class="ident" id="3211392">final</span>&nbsp;<span class="ident" id="3211398">reflect</span><span class="op" id="3211405">.</span><span class="ident" id="3211406">Value</span><span class="op" id="3211411">)</span>&nbsp;<span class="ident" id="3211413">reflect</span><span class="op" id="3211420">.</span><span class="ident" id="3211421">Value</span>&nbsp;<span class="op" id="3211427">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211430">s</span><span class="op" id="3211431">.</span><span class="ident" id="3211432">at</span><span class="op" id="3211434">(</span><span class="ident" id="3211435">chain</span><span class="op" id="3211440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3211443">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211541">pipe</span>&nbsp;<span class="op" id="3211546">:=</span>&nbsp;<span class="ident" id="3211549">s</span><span class="op" id="3211550">.</span><span class="ident" id="3211551">evalArg</span><span class="op" id="3211558">(</span><span class="ident" id="3211559">dot</span><span class="op" id="3211562">,</span>&nbsp;<span class="ident" id="3211564">nil</span><span class="op" id="3211567">,</span>&nbsp;<span class="ident" id="3211569">chain</span><span class="op" id="3211574">.</span><span class="ident" id="3211575">Node</span><span class="op" id="3211579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211582">if</span>&nbsp;<span class="builtinfunc" id="3211585">len</span><span class="op" id="3211588">(</span><span class="ident" id="3211589">chain</span><span class="op" id="3211594">.</span><span class="ident" id="3211595">Field</span><span class="op" id="3211600">)</span>&nbsp;<span class="op" id="3211602">==</span>&nbsp;<span class="num" id="3211605">0</span>&nbsp;<span class="op" id="3211607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211611">s</span><span class="op" id="3211612">.</span><span class="ident" id="3211613">errorf</span><span class="op" id="3211619">(</span><span class="string" id="3211620">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="3211664">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211670">return</span>&nbsp;<span class="ident" id="3211677">s</span><span class="op" id="3211678">.</span><span class="ident" id="3211679">evalFieldChain</span><span class="op" id="3211693">(</span><span class="ident" id="3211694">dot</span><span class="op" id="3211697">,</span>&nbsp;<span class="ident" id="3211699">pipe</span><span class="op" id="3211703">,</span>&nbsp;<span class="ident" id="3211705">chain</span><span class="op" id="3211710">,</span>&nbsp;<span class="ident" id="3211712">chain</span><span class="op" id="3211717">.</span><span class="ident" id="3211718">Field</span><span class="op" id="3211723">,</span>&nbsp;<span class="ident" id="3211725">args</span><span class="op" id="3211729">,</span>&nbsp;<span class="ident" id="3211731">final</span><span class="op" id="3211736">)</span><br>
<span class="lineno"></span><span class="op" id="3211738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3211741">func</span>&nbsp;<span class="op" id="3211746">(</span><span class="ident" id="3211747">s</span>&nbsp;<span class="op" id="3211749">*</span><span class="ident" id="3211750">state</span><span class="op" id="3211755">)</span>&nbsp;<span class="ident" id="3211757">evalVariableNode</span><span class="op" id="3211773">(</span><span class="ident" id="3211774">dot</span>&nbsp;<span class="ident" id="3211778">reflect</span><span class="op" id="3211785">.</span><span class="ident" id="3211786">Value</span><span class="op" id="3211791">,</span>&nbsp;<span class="ident" id="3211793">variable</span>&nbsp;<span class="op" id="3211802">*</span><span class="ident" id="3211803">parse</span><span class="op" id="3211808">.</span><span class="ident" id="3211809">VariableNode</span><span class="op" id="3211821">,</span>&nbsp;<span class="ident" id="3211823">args</span>&nbsp;<span class="op" id="3211828">[</span><span class="op" id="3211829">]</span><span class="ident" id="3211830">parse</span><span class="op" id="3211835">.</span><span class="ident" id="3211836">Node</span><span class="op" id="3211840">,</span>&nbsp;<span class="ident" id="3211842">final</span>&nbsp;<span class="ident" id="3211848">reflect</span><span class="op" id="3211855">.</span><span class="ident" id="3211856">Value</span><span class="op" id="3211861">)</span>&nbsp;<span class="ident" id="3211863">reflect</span><span class="op" id="3211870">.</span><span class="ident" id="3211871">Value</span>&nbsp;<span class="op" id="3211877">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3211880">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211972">s</span><span class="op" id="3211973">.</span><span class="ident" id="3211974">at</span><span class="op" id="3211976">(</span><span class="ident" id="3211977">variable</span><span class="op" id="3211985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211988">value</span>&nbsp;<span class="op" id="3211994">:=</span>&nbsp;<span class="ident" id="3211997">s</span><span class="op" id="3211998">.</span><span class="ident" id="3211999">varValue</span><span class="op" id="3212007">(</span><span class="ident" id="3212008">variable</span><span class="op" id="3212016">.</span><span class="ident" id="3212017">Ident</span><span class="op" id="3212022">[</span><span class="num" id="3212023">0</span><span class="op" id="3212024">]</span><span class="op" id="3212025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212028">if</span>&nbsp;<span class="builtinfunc" id="3212031">len</span><span class="op" id="3212034">(</span><span class="ident" id="3212035">variable</span><span class="op" id="3212043">.</span><span class="ident" id="3212044">Ident</span><span class="op" id="3212049">)</span>&nbsp;<span class="op" id="3212051">==</span>&nbsp;<span class="num" id="3212054">1</span>&nbsp;<span class="op" id="3212056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212060">s</span><span class="op" id="3212061">.</span><span class="ident" id="3212062">notAFunction</span><span class="op" id="3212074">(</span><span class="ident" id="3212075">args</span><span class="op" id="3212079">,</span>&nbsp;<span class="ident" id="3212081">final</span><span class="op" id="3212086">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212090">return</span>&nbsp;<span class="ident" id="3212097">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212107">return</span>&nbsp;<span class="ident" id="3212114">s</span><span class="op" id="3212115">.</span><span class="ident" id="3212116">evalFieldChain</span><span class="op" id="3212130">(</span><span class="ident" id="3212131">dot</span><span class="op" id="3212134">,</span>&nbsp;<span class="ident" id="3212136">value</span><span class="op" id="3212141">,</span>&nbsp;<span class="ident" id="3212143">variable</span><span class="op" id="3212151">,</span>&nbsp;<span class="ident" id="3212153">variable</span><span class="op" id="3212161">.</span><span class="ident" id="3212162">Ident</span><span class="op" id="3212167">[</span><span class="num" id="3212168">1</span><span class="op" id="3212169">:</span><span class="op" id="3212170">]</span><span class="op" id="3212171">,</span>&nbsp;<span class="ident" id="3212173">args</span><span class="op" id="3212177">,</span>&nbsp;<span class="ident" id="3212179">final</span><span class="op" id="3212184">)</span><br>
<span class="lineno"></span><span class="op" id="3212186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="3212189">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="3212256">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="3212320">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3212375">func</span>&nbsp;<span class="op" id="3212380">(</span><span class="ident" id="3212381">s</span>&nbsp;<span class="op" id="3212383">*</span><span class="ident" id="3212384">state</span><span class="op" id="3212389">)</span>&nbsp;<span class="ident" id="3212391">evalFieldChain</span><span class="op" id="3212405">(</span><span class="ident" id="3212406">dot</span><span class="op" id="3212409">,</span>&nbsp;<span class="ident" id="3212411">receiver</span>&nbsp;<span class="ident" id="3212420">reflect</span><span class="op" id="3212427">.</span><span class="ident" id="3212428">Value</span><span class="op" id="3212433">,</span>&nbsp;<span class="ident" id="3212435">node</span>&nbsp;<span class="ident" id="3212440">parse</span><span class="op" id="3212445">.</span><span class="ident" id="3212446">Node</span><span class="op" id="3212450">,</span>&nbsp;<span class="ident" id="3212452">ident</span>&nbsp;<span class="op" id="3212458">[</span><span class="op" id="3212459">]</span><span class="builtintype" id="3212460">string</span><span class="op" id="3212466">,</span>&nbsp;<span class="ident" id="3212468">args</span>&nbsp;<span class="op" id="3212473">[</span><span class="op" id="3212474">]</span><span class="ident" id="3212475">parse</span><span class="op" id="3212480">.</span><span class="ident" id="3212481">Node</span><span class="op" id="3212485">,</span>&nbsp;<span class="ident" id="3212487">final</span>&nbsp;<span class="ident" id="3212493">reflect</span><span class="op" id="3212500">.</span><span class="ident" id="3212501">Value</span><span class="op" id="3212506">)</span>&nbsp;<span class="ident" id="3212508">reflect</span><span class="op" id="3212515">.</span><span class="ident" id="3212516">Value</span>&nbsp;<span class="op" id="3212522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212525">n</span>&nbsp;<span class="op" id="3212527">:=</span>&nbsp;<span class="builtinfunc" id="3212530">len</span><span class="op" id="3212533">(</span><span class="ident" id="3212534">ident</span><span class="op" id="3212539">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212542">for</span>&nbsp;<span class="ident" id="3212546">i</span>&nbsp;<span class="op" id="3212548">:=</span>&nbsp;<span class="num" id="3212551">0</span><span class="op" id="3212552">;</span>&nbsp;<span class="ident" id="3212554">i</span>&nbsp;<span class="op" id="3212556">&lt;</span>&nbsp;<span class="ident" id="3212558">n</span><span class="op" id="3212559">-</span><span class="num" id="3212560">1</span><span class="op" id="3212561">;</span>&nbsp;<span class="ident" id="3212563">i</span><span class="op" id="3212564">++</span>&nbsp;<span class="op" id="3212567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212571">receiver</span>&nbsp;<span class="op" id="3212580">=</span>&nbsp;<span class="ident" id="3212582">s</span><span class="op" id="3212583">.</span><span class="ident" id="3212584">evalField</span><span class="op" id="3212593">(</span><span class="ident" id="3212594">dot</span><span class="op" id="3212597">,</span>&nbsp;<span class="ident" id="3212599">ident</span><span class="op" id="3212604">[</span><span class="ident" id="3212605">i</span><span class="op" id="3212606">]</span><span class="op" id="3212607">,</span>&nbsp;<span class="ident" id="3212609">node</span><span class="op" id="3212613">,</span>&nbsp;<span class="ident" id="3212615">nil</span><span class="op" id="3212618">,</span>&nbsp;<span class="ident" id="3212620">zero</span><span class="op" id="3212624">,</span>&nbsp;<span class="ident" id="3212626">receiver</span><span class="op" id="3212634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3212640">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212689">return</span>&nbsp;<span class="ident" id="3212696">s</span><span class="op" id="3212697">.</span><span class="ident" id="3212698">evalField</span><span class="op" id="3212707">(</span><span class="ident" id="3212708">dot</span><span class="op" id="3212711">,</span>&nbsp;<span class="ident" id="3212713">ident</span><span class="op" id="3212718">[</span><span class="ident" id="3212719">n</span><span class="op" id="3212720">-</span><span class="num" id="3212721">1</span><span class="op" id="3212722">]</span><span class="op" id="3212723">,</span>&nbsp;<span class="ident" id="3212725">node</span><span class="op" id="3212729">,</span>&nbsp;<span class="ident" id="3212731">args</span><span class="op" id="3212735">,</span>&nbsp;<span class="ident" id="3212737">final</span><span class="op" id="3212742">,</span>&nbsp;<span class="ident" id="3212744">receiver</span><span class="op" id="3212752">)</span><br>
<span class="lineno">450</span><span class="op" id="3212754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3212757">func</span>&nbsp;<span class="op" id="3212762">(</span><span class="ident" id="3212763">s</span>&nbsp;<span class="op" id="3212765">*</span><span class="ident" id="3212766">state</span><span class="op" id="3212771">)</span>&nbsp;<span class="ident" id="3212773">evalFunction</span><span class="op" id="3212785">(</span><span class="ident" id="3212786">dot</span>&nbsp;<span class="ident" id="3212790">reflect</span><span class="op" id="3212797">.</span><span class="ident" id="3212798">Value</span><span class="op" id="3212803">,</span>&nbsp;<span class="ident" id="3212805">node</span>&nbsp;<span class="op" id="3212810">*</span><span class="ident" id="3212811">parse</span><span class="op" id="3212816">.</span><span class="ident" id="3212817">IdentifierNode</span><span class="op" id="3212831">,</span>&nbsp;<span class="ident" id="3212833">cmd</span>&nbsp;<span class="ident" id="3212837">parse</span><span class="op" id="3212842">.</span><span class="ident" id="3212843">Node</span><span class="op" id="3212847">,</span>&nbsp;<span class="ident" id="3212849">args</span>&nbsp;<span class="op" id="3212854">[</span><span class="op" id="3212855">]</span><span class="ident" id="3212856">parse</span><span class="op" id="3212861">.</span><span class="ident" id="3212862">Node</span><span class="op" id="3212866">,</span>&nbsp;<span class="ident" id="3212868">final</span>&nbsp;<span class="ident" id="3212874">reflect</span><span class="op" id="3212881">.</span><span class="ident" id="3212882">Value</span><span class="op" id="3212887">)</span>&nbsp;<span class="ident" id="3212889">reflect</span><span class="op" id="3212896">.</span><span class="ident" id="3212897">Value</span>&nbsp;<span class="op" id="3212903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212906">s</span><span class="op" id="3212907">.</span><span class="ident" id="3212908">at</span><span class="op" id="3212910">(</span><span class="ident" id="3212911">node</span><span class="op" id="3212915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212918">name</span>&nbsp;<span class="op" id="3212923">:=</span>&nbsp;<span class="ident" id="3212926">node</span><span class="op" id="3212930">.</span><span class="ident" id="3212931">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212938">function</span><span class="op" id="3212946">,</span>&nbsp;<span class="ident" id="3212948">ok</span>&nbsp;<span class="op" id="3212951">:=</span>&nbsp;<span class="ident" id="3212954">findFunction</span><span class="op" id="3212966">(</span><span class="ident" id="3212967">name</span><span class="op" id="3212971">,</span>&nbsp;<span class="ident" id="3212973">s</span><span class="op" id="3212974">.</span><span class="ident" id="3212975">tmpl</span><span class="op" id="3212979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212982">if</span>&nbsp;<span class="op" id="3212985">!</span><span class="ident" id="3212986">ok</span>&nbsp;<span class="op" id="3212989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212993">s</span><span class="op" id="3212994">.</span><span class="ident" id="3212995">errorf</span><span class="op" id="3213001">(</span><span class="string" id="3213002">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="3213032">,</span>&nbsp;<span class="ident" id="3213034">name</span><span class="op" id="3213038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213044">return</span>&nbsp;<span class="ident" id="3213051">s</span><span class="op" id="3213052">.</span><span class="ident" id="3213053">evalCall</span><span class="op" id="3213061">(</span><span class="ident" id="3213062">dot</span><span class="op" id="3213065">,</span>&nbsp;<span class="ident" id="3213067">function</span><span class="op" id="3213075">,</span>&nbsp;<span class="ident" id="3213077">cmd</span><span class="op" id="3213080">,</span>&nbsp;<span class="ident" id="3213082">name</span><span class="op" id="3213086">,</span>&nbsp;<span class="ident" id="3213088">args</span><span class="op" id="3213092">,</span>&nbsp;<span class="ident" id="3213094">final</span><span class="op" id="3213099">)</span><br>
<span class="lineno">460</span><span class="op" id="3213101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3213104">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="3213178">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="3213249">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="3213283">func</span>&nbsp;<span class="op" id="3213288">(</span><span class="ident" id="3213289">s</span>&nbsp;<span class="op" id="3213291">*</span><span class="ident" id="3213292">state</span><span class="op" id="3213297">)</span>&nbsp;<span class="ident" id="3213299">evalField</span><span class="op" id="3213308">(</span><span class="ident" id="3213309">dot</span>&nbsp;<span class="ident" id="3213313">reflect</span><span class="op" id="3213320">.</span><span class="ident" id="3213321">Value</span><span class="op" id="3213326">,</span>&nbsp;<span class="ident" id="3213328">fieldName</span>&nbsp;<span class="builtintype" id="3213338">string</span><span class="op" id="3213344">,</span>&nbsp;<span class="ident" id="3213346">node</span>&nbsp;<span class="ident" id="3213351">parse</span><span class="op" id="3213356">.</span><span class="ident" id="3213357">Node</span><span class="op" id="3213361">,</span>&nbsp;<span class="ident" id="3213363">args</span>&nbsp;<span class="op" id="3213368">[</span><span class="op" id="3213369">]</span><span class="ident" id="3213370">parse</span><span class="op" id="3213375">.</span><span class="ident" id="3213376">Node</span><span class="op" id="3213380">,</span>&nbsp;<span class="ident" id="3213382">final</span><span class="op" id="3213387">,</span>&nbsp;<span class="ident" id="3213389">receiver</span>&nbsp;<span class="ident" id="3213398">reflect</span><span class="op" id="3213405">.</span><span class="ident" id="3213406">Value</span><span class="op" id="3213411">)</span>&nbsp;<span class="ident" id="3213413">reflect</span><span class="op" id="3213420">.</span><span class="ident" id="3213421">Value</span>&nbsp;<span class="op" id="3213427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213430">if</span>&nbsp;<span class="op" id="3213433">!</span><span class="ident" id="3213434">receiver</span><span class="op" id="3213442">.</span><span class="ident" id="3213443">IsValid</span><span class="op" id="3213450">(</span><span class="op" id="3213451">)</span>&nbsp;<span class="op" id="3213453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213457">return</span>&nbsp;<span class="ident" id="3213464">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213473">typ</span>&nbsp;<span class="op" id="3213477">:=</span>&nbsp;<span class="ident" id="3213480">receiver</span><span class="op" id="3213488">.</span><span class="ident" id="3213489">Type</span><span class="op" id="3213493">(</span><span class="op" id="3213494">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213497">receiver</span><span class="op" id="3213505">,</span>&nbsp;<span class="ident" id="3213507">_</span>&nbsp;<span class="op" id="3213509">=</span>&nbsp;<span class="ident" id="3213511">indirect</span><span class="op" id="3213519">(</span><span class="ident" id="3213520">receiver</span><span class="op" id="3213528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3213531">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3213608">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213644">ptr</span>&nbsp;<span class="op" id="3213648">:=</span>&nbsp;<span class="ident" id="3213651">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213661">if</span>&nbsp;<span class="ident" id="3213664">ptr</span><span class="op" id="3213667">.</span><span class="ident" id="3213668">Kind</span><span class="op" id="3213672">(</span><span class="op" id="3213673">)</span>&nbsp;<span class="op" id="3213675">!=</span>&nbsp;<span class="ident" id="3213678">reflect</span><span class="op" id="3213685">.</span><span class="ident" id="3213686">Interface</span>&nbsp;<span class="op" id="3213696">&amp;&amp;</span>&nbsp;<span class="ident" id="3213699">ptr</span><span class="op" id="3213702">.</span><span class="ident" id="3213703">CanAddr</span><span class="op" id="3213710">(</span><span class="op" id="3213711">)</span>&nbsp;<span class="op" id="3213713">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213717">ptr</span>&nbsp;<span class="op" id="3213721">=</span>&nbsp;<span class="ident" id="3213723">ptr</span><span class="op" id="3213726">.</span><span class="ident" id="3213727">Addr</span><span class="op" id="3213731">(</span><span class="op" id="3213732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213738">if</span>&nbsp;<span class="ident" id="3213741">method</span>&nbsp;<span class="op" id="3213748">:=</span>&nbsp;<span class="ident" id="3213751">ptr</span><span class="op" id="3213754">.</span><span class="ident" id="3213755">MethodByName</span><span class="op" id="3213767">(</span><span class="ident" id="3213768">fieldName</span><span class="op" id="3213777">)</span><span class="op" id="3213778">;</span>&nbsp;<span class="ident" id="3213780">method</span><span class="op" id="3213786">.</span><span class="ident" id="3213787">IsValid</span><span class="op" id="3213794">(</span><span class="op" id="3213795">)</span>&nbsp;<span class="op" id="3213797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213801">return</span>&nbsp;<span class="ident" id="3213808">s</span><span class="op" id="3213809">.</span><span class="ident" id="3213810">evalCall</span><span class="op" id="3213818">(</span><span class="ident" id="3213819">dot</span><span class="op" id="3213822">,</span>&nbsp;<span class="ident" id="3213824">method</span><span class="op" id="3213830">,</span>&nbsp;<span class="ident" id="3213832">node</span><span class="op" id="3213836">,</span>&nbsp;<span class="ident" id="3213838">fieldName</span><span class="op" id="3213847">,</span>&nbsp;<span class="ident" id="3213849">args</span><span class="op" id="3213853">,</span>&nbsp;<span class="ident" id="3213855">final</span><span class="op" id="3213860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213863">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213866">hasArgs</span>&nbsp;<span class="op" id="3213874">:=</span>&nbsp;<span class="builtinfunc" id="3213877">len</span><span class="op" id="3213880">(</span><span class="ident" id="3213881">args</span><span class="op" id="3213885">)</span>&nbsp;<span class="op" id="3213887">&gt;</span>&nbsp;<span class="num" id="3213889">1</span>&nbsp;<span class="op" id="3213891">||</span>&nbsp;<span class="ident" id="3213894">final</span><span class="op" id="3213899">.</span><span class="ident" id="3213900">IsValid</span><span class="op" id="3213907">(</span><span class="op" id="3213908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3213911">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214016">receiver</span><span class="op" id="3214024">,</span>&nbsp;<span class="ident" id="3214026">isNil</span>&nbsp;<span class="op" id="3214032">:=</span>&nbsp;<span class="ident" id="3214035">indirect</span><span class="op" id="3214043">(</span><span class="ident" id="3214044">receiver</span><span class="op" id="3214052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214055">if</span>&nbsp;<span class="ident" id="3214058">isNil</span>&nbsp;<span class="op" id="3214064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214068">s</span><span class="op" id="3214069">.</span><span class="ident" id="3214070">errorf</span><span class="op" id="3214076">(</span><span class="string" id="3214077">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="3214107">,</span>&nbsp;<span class="ident" id="3214109">typ</span><span class="op" id="3214112">,</span>&nbsp;<span class="ident" id="3214114">fieldName</span><span class="op" id="3214123">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214129">switch</span>&nbsp;<span class="ident" id="3214136">receiver</span><span class="op" id="3214144">.</span><span class="ident" id="3214145">Kind</span><span class="op" id="3214149">(</span><span class="op" id="3214150">)</span>&nbsp;<span class="op" id="3214152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214155">case</span>&nbsp;<span class="ident" id="3214160">reflect</span><span class="op" id="3214167">.</span><span class="ident" id="3214168">Struct</span><span class="op" id="3214174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214178">tField</span><span class="op" id="3214184">,</span>&nbsp;<span class="ident" id="3214186">ok</span>&nbsp;<span class="op" id="3214189">:=</span>&nbsp;<span class="ident" id="3214192">receiver</span><span class="op" id="3214200">.</span><span class="ident" id="3214201">Type</span><span class="op" id="3214205">(</span><span class="op" id="3214206">)</span><span class="op" id="3214207">.</span><span class="ident" id="3214208">FieldByName</span><span class="op" id="3214219">(</span><span class="ident" id="3214220">fieldName</span><span class="op" id="3214229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214233">if</span>&nbsp;<span class="ident" id="3214236">ok</span>&nbsp;<span class="op" id="3214239">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214244">field</span>&nbsp;<span class="op" id="3214250">:=</span>&nbsp;<span class="ident" id="3214253">receiver</span><span class="op" id="3214261">.</span><span class="ident" id="3214262">FieldByIndex</span><span class="op" id="3214274">(</span><span class="ident" id="3214275">tField</span><span class="op" id="3214281">.</span><span class="ident" id="3214282">Index</span><span class="op" id="3214287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214292">if</span>&nbsp;<span class="ident" id="3214295">tField</span><span class="op" id="3214301">.</span><span class="ident" id="3214302">PkgPath</span>&nbsp;<span class="op" id="3214310">!=</span>&nbsp;<span class="string" id="3214313">&#34;&#34;</span>&nbsp;<span class="op" id="3214316">{</span>&nbsp;<span class="comment" id="3214318">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214345">s</span><span class="op" id="3214346">.</span><span class="ident" id="3214347">errorf</span><span class="op" id="3214353">(</span><span class="string" id="3214354">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3214399">,</span>&nbsp;<span class="ident" id="3214401">fieldName</span><span class="op" id="3214410">,</span>&nbsp;<span class="ident" id="3214412">typ</span><span class="op" id="3214415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214425">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214468">if</span>&nbsp;<span class="ident" id="3214471">hasArgs</span>&nbsp;<span class="op" id="3214479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214485">s</span><span class="op" id="3214486">.</span><span class="ident" id="3214487">errorf</span><span class="op" id="3214493">(</span><span class="string" id="3214494">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="3214546">,</span>&nbsp;<span class="ident" id="3214548">fieldName</span><span class="op" id="3214557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214567">return</span>&nbsp;<span class="ident" id="3214574">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214582">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214586">s</span><span class="op" id="3214587">.</span><span class="ident" id="3214588">errorf</span><span class="op" id="3214594">(</span><span class="string" id="3214595">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3214632">,</span>&nbsp;<span class="ident" id="3214634">fieldName</span><span class="op" id="3214643">,</span>&nbsp;<span class="ident" id="3214645">typ</span><span class="op" id="3214648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214651">case</span>&nbsp;<span class="ident" id="3214656">reflect</span><span class="op" id="3214663">.</span><span class="ident" id="3214664">Map</span><span class="op" id="3214667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214671">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214731">nameVal</span>&nbsp;<span class="op" id="3214739">:=</span>&nbsp;<span class="ident" id="3214742">reflect</span><span class="op" id="3214749">.</span><span class="ident" id="3214750">ValueOf</span><span class="op" id="3214757">(</span><span class="ident" id="3214758">fieldName</span><span class="op" id="3214767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214771">if</span>&nbsp;<span class="ident" id="3214774">nameVal</span><span class="op" id="3214781">.</span><span class="ident" id="3214782">Type</span><span class="op" id="3214786">(</span><span class="op" id="3214787">)</span><span class="op" id="3214788">.</span><span class="ident" id="3214789">AssignableTo</span><span class="op" id="3214801">(</span><span class="ident" id="3214802">receiver</span><span class="op" id="3214810">.</span><span class="ident" id="3214811">Type</span><span class="op" id="3214815">(</span><span class="op" id="3214816">)</span><span class="op" id="3214817">.</span><span class="ident" id="3214818">Key</span><span class="op" id="3214821">(</span><span class="op" id="3214822">)</span><span class="op" id="3214823">)</span>&nbsp;<span class="op" id="3214825">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214830">if</span>&nbsp;<span class="ident" id="3214833">hasArgs</span>&nbsp;<span class="op" id="3214841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214847">s</span><span class="op" id="3214848">.</span><span class="ident" id="3214849">errorf</span><span class="op" id="3214855">(</span><span class="string" id="3214856">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="3214894">,</span>&nbsp;<span class="ident" id="3214896">fieldName</span><span class="op" id="3214905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214915">return</span>&nbsp;<span class="ident" id="3214922">receiver</span><span class="op" id="3214930">.</span><span class="ident" id="3214931">MapIndex</span><span class="op" id="3214939">(</span><span class="ident" id="3214940">nameVal</span><span class="op" id="3214947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214951">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214957">s</span><span class="op" id="3214958">.</span><span class="ident" id="3214959">errorf</span><span class="op" id="3214965">(</span><span class="string" id="3214966">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3215002">,</span>&nbsp;<span class="ident" id="3215004">fieldName</span><span class="op" id="3215013">,</span>&nbsp;<span class="ident" id="3215015">typ</span><span class="op" id="3215018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3215021">panic</span><span class="op" id="3215026">(</span><span class="string" id="3215027">&#34;not&nbsp;reached&#34;</span><span class="op" id="3215040">)</span><br>
<span class="lineno"></span><span class="op" id="3215042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="3215045">var</span>&nbsp;<span class="op" id="3215049">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215052">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3215068">=</span>&nbsp;<span class="ident" id="3215070">reflect</span><span class="op" id="3215077">.</span><span class="ident" id="3215078">TypeOf</span><span class="op" id="3215084">(</span><span class="op" id="3215085">(</span><span class="op" id="3215086">*</span><span class="builtintype" id="3215087">error</span><span class="op" id="3215092">)</span><span class="op" id="3215093">(</span><span class="ident" id="3215094">nil</span><span class="op" id="3215097">)</span><span class="op" id="3215098">)</span><span class="op" id="3215099">.</span><span class="ident" id="3215100">Elem</span><span class="op" id="3215104">(</span><span class="op" id="3215105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215108">fmtStringerType</span>&nbsp;<span class="op" id="3215124">=</span>&nbsp;<span class="ident" id="3215126">reflect</span><span class="op" id="3215133">.</span><span class="ident" id="3215134">TypeOf</span><span class="op" id="3215140">(</span><span class="op" id="3215141">(</span><span class="op" id="3215142">*</span><span class="ident" id="3215143">fmt</span><span class="op" id="3215146">.</span><span class="ident" id="3215147">Stringer</span><span class="op" id="3215155">)</span><span class="op" id="3215156">(</span><span class="ident" id="3215157">nil</span><span class="op" id="3215160">)</span><span class="op" id="3215161">)</span><span class="op" id="3215162">.</span><span class="ident" id="3215163">Elem</span><span class="op" id="3215167">(</span><span class="op" id="3215168">)</span><br>
<span class="lineno"></span><span class="op" id="3215170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="3215173">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="3215278">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="3215390">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="3215417">func</span>&nbsp;<span class="op" id="3215422">(</span><span class="ident" id="3215423">s</span>&nbsp;<span class="op" id="3215425">*</span><span class="ident" id="3215426">state</span><span class="op" id="3215431">)</span>&nbsp;<span class="ident" id="3215433">evalCall</span><span class="op" id="3215441">(</span><span class="ident" id="3215442">dot</span><span class="op" id="3215445">,</span>&nbsp;<span class="ident" id="3215447">fun</span>&nbsp;<span class="ident" id="3215451">reflect</span><span class="op" id="3215458">.</span><span class="ident" id="3215459">Value</span><span class="op" id="3215464">,</span>&nbsp;<span class="ident" id="3215466">node</span>&nbsp;<span class="ident" id="3215471">parse</span><span class="op" id="3215476">.</span><span class="ident" id="3215477">Node</span><span class="op" id="3215481">,</span>&nbsp;<span class="ident" id="3215483">name</span>&nbsp;<span class="builtintype" id="3215488">string</span><span class="op" id="3215494">,</span>&nbsp;<span class="ident" id="3215496">args</span>&nbsp;<span class="op" id="3215501">[</span><span class="op" id="3215502">]</span><span class="ident" id="3215503">parse</span><span class="op" id="3215508">.</span><span class="ident" id="3215509">Node</span><span class="op" id="3215513">,</span>&nbsp;<span class="ident" id="3215515">final</span>&nbsp;<span class="ident" id="3215521">reflect</span><span class="op" id="3215528">.</span><span class="ident" id="3215529">Value</span><span class="op" id="3215534">)</span>&nbsp;<span class="ident" id="3215536">reflect</span><span class="op" id="3215543">.</span><span class="ident" id="3215544">Value</span>&nbsp;<span class="op" id="3215550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215553">if</span>&nbsp;<span class="ident" id="3215556">args</span>&nbsp;<span class="op" id="3215561">!=</span>&nbsp;<span class="ident" id="3215564">nil</span>&nbsp;<span class="op" id="3215568">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215572">args</span>&nbsp;<span class="op" id="3215577">=</span>&nbsp;<span class="ident" id="3215579">args</span><span class="op" id="3215583">[</span><span class="num" id="3215584">1</span><span class="op" id="3215585">:</span><span class="op" id="3215586">]</span>&nbsp;<span class="comment" id="3215588">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215653">typ</span>&nbsp;<span class="op" id="3215657">:=</span>&nbsp;<span class="ident" id="3215660">fun</span><span class="op" id="3215663">.</span><span class="ident" id="3215664">Type</span><span class="op" id="3215668">(</span><span class="op" id="3215669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215672">numIn</span>&nbsp;<span class="op" id="3215678">:=</span>&nbsp;<span class="builtinfunc" id="3215681">len</span><span class="op" id="3215684">(</span><span class="ident" id="3215685">args</span><span class="op" id="3215689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215692">if</span>&nbsp;<span class="ident" id="3215695">final</span><span class="op" id="3215700">.</span><span class="ident" id="3215701">IsValid</span><span class="op" id="3215708">(</span><span class="op" id="3215709">)</span>&nbsp;<span class="op" id="3215711">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215715">numIn</span><span class="op" id="3215720">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215727">numFixed</span>&nbsp;<span class="op" id="3215736">:=</span>&nbsp;<span class="builtinfunc" id="3215739">len</span><span class="op" id="3215742">(</span><span class="ident" id="3215743">args</span><span class="op" id="3215747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215750">if</span>&nbsp;<span class="ident" id="3215753">typ</span><span class="op" id="3215756">.</span><span class="ident" id="3215757">IsVariadic</span><span class="op" id="3215767">(</span><span class="op" id="3215768">)</span>&nbsp;<span class="op" id="3215770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215774">numFixed</span>&nbsp;<span class="op" id="3215783">=</span>&nbsp;<span class="ident" id="3215785">typ</span><span class="op" id="3215788">.</span><span class="ident" id="3215789">NumIn</span><span class="op" id="3215794">(</span><span class="op" id="3215795">)</span>&nbsp;<span class="op" id="3215797">-</span>&nbsp;<span class="num" id="3215799">1</span>&nbsp;<span class="comment" id="3215801">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215836">if</span>&nbsp;<span class="ident" id="3215839">numIn</span>&nbsp;<span class="op" id="3215845">&lt;</span>&nbsp;<span class="ident" id="3215847">numFixed</span>&nbsp;<span class="op" id="3215856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215861">s</span><span class="op" id="3215862">.</span><span class="ident" id="3215863">errorf</span><span class="op" id="3215869">(</span><span class="string" id="3215870">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3215924">,</span>&nbsp;<span class="ident" id="3215926">name</span><span class="op" id="3215930">,</span>&nbsp;<span class="ident" id="3215932">typ</span><span class="op" id="3215935">.</span><span class="ident" id="3215936">NumIn</span><span class="op" id="3215941">(</span><span class="op" id="3215942">)</span><span class="op" id="3215943">-</span><span class="num" id="3215944">1</span><span class="op" id="3215945">,</span>&nbsp;<span class="builtinfunc" id="3215947">len</span><span class="op" id="3215950">(</span><span class="ident" id="3215951">args</span><span class="op" id="3215955">)</span><span class="op" id="3215956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215963">}</span>&nbsp;<span class="keyword" id="3215965">else</span>&nbsp;<span class="keyword" id="3215970">if</span>&nbsp;<span class="ident" id="3215973">numIn</span>&nbsp;<span class="op" id="3215979">&lt;</span>&nbsp;<span class="ident" id="3215981">typ</span><span class="op" id="3215984">.</span><span class="ident" id="3215985">NumIn</span><span class="op" id="3215990">(</span><span class="op" id="3215991">)</span><span class="op" id="3215992">-</span><span class="num" id="3215993">1</span>&nbsp;<span class="op" id="3215995">||</span>&nbsp;<span class="op" id="3215998">!</span><span class="ident" id="3215999">typ</span><span class="op" id="3216002">.</span><span class="ident" id="3216003">IsVariadic</span><span class="op" id="3216013">(</span><span class="op" id="3216014">)</span>&nbsp;<span class="op" id="3216016">&amp;&amp;</span>&nbsp;<span class="ident" id="3216019">numIn</span>&nbsp;<span class="op" id="3216025">!=</span>&nbsp;<span class="ident" id="3216028">typ</span><span class="op" id="3216031">.</span><span class="ident" id="3216032">NumIn</span><span class="op" id="3216037">(</span><span class="op" id="3216038">)</span>&nbsp;<span class="op" id="3216040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216044">s</span><span class="op" id="3216045">.</span><span class="ident" id="3216046">errorf</span><span class="op" id="3216052">(</span><span class="string" id="3216053">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3216098">,</span>&nbsp;<span class="ident" id="3216100">name</span><span class="op" id="3216104">,</span>&nbsp;<span class="ident" id="3216106">typ</span><span class="op" id="3216109">.</span><span class="ident" id="3216110">NumIn</span><span class="op" id="3216115">(</span><span class="op" id="3216116">)</span><span class="op" id="3216117">,</span>&nbsp;<span class="builtinfunc" id="3216119">len</span><span class="op" id="3216122">(</span><span class="ident" id="3216123">args</span><span class="op" id="3216127">)</span><span class="op" id="3216128">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216134">if</span>&nbsp;<span class="op" id="3216137">!</span><span class="ident" id="3216138">goodFunc</span><span class="op" id="3216146">(</span><span class="ident" id="3216147">typ</span><span class="op" id="3216150">)</span>&nbsp;<span class="op" id="3216152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3216156">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216242">s</span><span class="op" id="3216243">.</span><span class="ident" id="3216244">errorf</span><span class="op" id="3216250">(</span><span class="string" id="3216251">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3216298">,</span>&nbsp;<span class="ident" id="3216300">name</span><span class="op" id="3216304">,</span>&nbsp;<span class="ident" id="3216306">typ</span><span class="op" id="3216309">.</span><span class="ident" id="3216310">NumOut</span><span class="op" id="3216316">(</span><span class="op" id="3216317">)</span><span class="op" id="3216318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216321">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3216324">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216348">argv</span>&nbsp;<span class="op" id="3216353">:=</span>&nbsp;<span class="builtinfunc" id="3216356">make</span><span class="op" id="3216360">(</span><span class="op" id="3216361">[</span><span class="op" id="3216362">]</span><span class="ident" id="3216363">reflect</span><span class="op" id="3216370">.</span><span class="ident" id="3216371">Value</span><span class="op" id="3216376">,</span>&nbsp;<span class="ident" id="3216378">numIn</span><span class="op" id="3216383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3216386">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216432">i</span>&nbsp;<span class="op" id="3216434">:=</span>&nbsp;<span class="num" id="3216437">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216440">for</span>&nbsp;<span class="op" id="3216444">;</span>&nbsp;<span class="ident" id="3216446">i</span>&nbsp;<span class="op" id="3216448">&lt;</span>&nbsp;<span class="ident" id="3216450">numFixed</span>&nbsp;<span class="op" id="3216459">&amp;&amp;</span>&nbsp;<span class="ident" id="3216462">i</span>&nbsp;<span class="op" id="3216464">&lt;</span>&nbsp;<span class="builtinfunc" id="3216466">len</span><span class="op" id="3216469">(</span><span class="ident" id="3216470">args</span><span class="op" id="3216474">)</span><span class="op" id="3216475">;</span>&nbsp;<span class="ident" id="3216477">i</span><span class="op" id="3216478">++</span>&nbsp;<span class="op" id="3216481">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216485">argv</span><span class="op" id="3216489">[</span><span class="ident" id="3216490">i</span><span class="op" id="3216491">]</span>&nbsp;<span class="op" id="3216493">=</span>&nbsp;<span class="ident" id="3216495">s</span><span class="op" id="3216496">.</span><span class="ident" id="3216497">evalArg</span><span class="op" id="3216504">(</span><span class="ident" id="3216505">dot</span><span class="op" id="3216508">,</span>&nbsp;<span class="ident" id="3216510">typ</span><span class="op" id="3216513">.</span><span class="ident" id="3216514">In</span><span class="op" id="3216516">(</span><span class="ident" id="3216517">i</span><span class="op" id="3216518">)</span><span class="op" id="3216519">,</span>&nbsp;<span class="ident" id="3216521">args</span><span class="op" id="3216525">[</span><span class="ident" id="3216526">i</span><span class="op" id="3216527">]</span><span class="op" id="3216528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3216534">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216556">if</span>&nbsp;<span class="ident" id="3216559">typ</span><span class="op" id="3216562">.</span><span class="ident" id="3216563">IsVariadic</span><span class="op" id="3216573">(</span><span class="op" id="3216574">)</span>&nbsp;<span class="op" id="3216576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216580">argType</span>&nbsp;<span class="op" id="3216588">:=</span>&nbsp;<span class="ident" id="3216591">typ</span><span class="op" id="3216594">.</span><span class="ident" id="3216595">In</span><span class="op" id="3216597">(</span><span class="ident" id="3216598">typ</span><span class="op" id="3216601">.</span><span class="ident" id="3216602">NumIn</span><span class="op" id="3216607">(</span><span class="op" id="3216608">)</span>&nbsp;<span class="op" id="3216610">-</span>&nbsp;<span class="num" id="3216612">1</span><span class="op" id="3216613">)</span><span class="op" id="3216614">.</span><span class="ident" id="3216615">Elem</span><span class="op" id="3216619">(</span><span class="op" id="3216620">)</span>&nbsp;<span class="comment" id="3216622">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216648">for</span>&nbsp;<span class="op" id="3216652">;</span>&nbsp;<span class="ident" id="3216654">i</span>&nbsp;<span class="op" id="3216656">&lt;</span>&nbsp;<span class="builtinfunc" id="3216658">len</span><span class="op" id="3216661">(</span><span class="ident" id="3216662">args</span><span class="op" id="3216666">)</span><span class="op" id="3216667">;</span>&nbsp;<span class="ident" id="3216669">i</span><span class="op" id="3216670">++</span>&nbsp;<span class="op" id="3216673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216678">argv</span><span class="op" id="3216682">[</span><span class="ident" id="3216683">i</span><span class="op" id="3216684">]</span>&nbsp;<span class="op" id="3216686">=</span>&nbsp;<span class="ident" id="3216688">s</span><span class="op" id="3216689">.</span><span class="ident" id="3216690">evalArg</span><span class="op" id="3216697">(</span><span class="ident" id="3216698">dot</span><span class="op" id="3216701">,</span>&nbsp;<span class="ident" id="3216703">argType</span><span class="op" id="3216710">,</span>&nbsp;<span class="ident" id="3216712">args</span><span class="op" id="3216716">[</span><span class="ident" id="3216717">i</span><span class="op" id="3216718">]</span><span class="op" id="3216719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3216729">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216763">if</span>&nbsp;<span class="ident" id="3216766">final</span><span class="op" id="3216771">.</span><span class="ident" id="3216772">IsValid</span><span class="op" id="3216779">(</span><span class="op" id="3216780">)</span>&nbsp;<span class="op" id="3216782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216786">t</span>&nbsp;<span class="op" id="3216788">:=</span>&nbsp;<span class="ident" id="3216791">typ</span><span class="op" id="3216794">.</span><span class="ident" id="3216795">In</span><span class="op" id="3216797">(</span><span class="ident" id="3216798">typ</span><span class="op" id="3216801">.</span><span class="ident" id="3216802">NumIn</span><span class="op" id="3216807">(</span><span class="op" id="3216808">)</span>&nbsp;<span class="op" id="3216810">-</span>&nbsp;<span class="num" id="3216812">1</span><span class="op" id="3216813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216817">if</span>&nbsp;<span class="ident" id="3216820">typ</span><span class="op" id="3216823">.</span><span class="ident" id="3216824">IsVariadic</span><span class="op" id="3216834">(</span><span class="op" id="3216835">)</span>&nbsp;<span class="op" id="3216837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216842">t</span>&nbsp;<span class="op" id="3216844">=</span>&nbsp;<span class="ident" id="3216846">t</span><span class="op" id="3216847">.</span><span class="ident" id="3216848">Elem</span><span class="op" id="3216852">(</span><span class="op" id="3216853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216857">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216861">argv</span><span class="op" id="3216865">[</span><span class="ident" id="3216866">i</span><span class="op" id="3216867">]</span>&nbsp;<span class="op" id="3216869">=</span>&nbsp;<span class="ident" id="3216871">s</span><span class="op" id="3216872">.</span><span class="ident" id="3216873">validateType</span><span class="op" id="3216885">(</span><span class="ident" id="3216886">final</span><span class="op" id="3216891">,</span>&nbsp;<span class="ident" id="3216893">t</span><span class="op" id="3216894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216900">result</span>&nbsp;<span class="op" id="3216907">:=</span>&nbsp;<span class="ident" id="3216910">fun</span><span class="op" id="3216913">.</span><span class="ident" id="3216914">Call</span><span class="op" id="3216918">(</span><span class="ident" id="3216919">argv</span><span class="op" id="3216923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3216926">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217019">if</span>&nbsp;<span class="builtinfunc" id="3217022">len</span><span class="op" id="3217025">(</span><span class="ident" id="3217026">result</span><span class="op" id="3217032">)</span>&nbsp;<span class="op" id="3217034">==</span>&nbsp;<span class="num" id="3217037">2</span>&nbsp;<span class="op" id="3217039">&amp;&amp;</span>&nbsp;<span class="op" id="3217042">!</span><span class="ident" id="3217043">result</span><span class="op" id="3217049">[</span><span class="num" id="3217050">1</span><span class="op" id="3217051">]</span><span class="op" id="3217052">.</span><span class="ident" id="3217053">IsNil</span><span class="op" id="3217058">(</span><span class="op" id="3217059">)</span>&nbsp;<span class="op" id="3217061">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217065">s</span><span class="op" id="3217066">.</span><span class="ident" id="3217067">at</span><span class="op" id="3217069">(</span><span class="ident" id="3217070">node</span><span class="op" id="3217074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217078">s</span><span class="op" id="3217079">.</span><span class="ident" id="3217080">errorf</span><span class="op" id="3217086">(</span><span class="string" id="3217087">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3217109">,</span>&nbsp;<span class="ident" id="3217111">name</span><span class="op" id="3217115">,</span>&nbsp;<span class="ident" id="3217117">result</span><span class="op" id="3217123">[</span><span class="num" id="3217124">1</span><span class="op" id="3217125">]</span><span class="op" id="3217126">.</span><span class="ident" id="3217127">Interface</span><span class="op" id="3217136">(</span><span class="op" id="3217137">)</span><span class="op" id="3217138">.</span><span class="op" id="3217139">(</span><span class="builtintype" id="3217140">error</span><span class="op" id="3217145">)</span><span class="op" id="3217146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217152">return</span>&nbsp;<span class="ident" id="3217159">result</span><span class="op" id="3217165">[</span><span class="num" id="3217166">0</span><span class="op" id="3217167">]</span><br>
<span class="lineno"></span><span class="op" id="3217169">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3217172">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3217262">func</span>&nbsp;<span class="ident" id="3217267">canBeNil</span><span class="op" id="3217275">(</span><span class="ident" id="3217276">typ</span>&nbsp;<span class="ident" id="3217280">reflect</span><span class="op" id="3217287">.</span><span class="ident" id="3217288">Type</span><span class="op" id="3217292">)</span>&nbsp;<span class="builtintype" id="3217294">bool</span>&nbsp;<span class="op" id="3217299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217302">switch</span>&nbsp;<span class="ident" id="3217309">typ</span><span class="op" id="3217312">.</span><span class="ident" id="3217313">Kind</span><span class="op" id="3217317">(</span><span class="op" id="3217318">)</span>&nbsp;<span class="op" id="3217320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217323">case</span>&nbsp;<span class="ident" id="3217328">reflect</span><span class="op" id="3217335">.</span><span class="ident" id="3217336">Chan</span><span class="op" id="3217340">,</span>&nbsp;<span class="ident" id="3217342">reflect</span><span class="op" id="3217349">.</span><span class="ident" id="3217350">Func</span><span class="op" id="3217354">,</span>&nbsp;<span class="ident" id="3217356">reflect</span><span class="op" id="3217363">.</span><span class="ident" id="3217364">Interface</span><span class="op" id="3217373">,</span>&nbsp;<span class="ident" id="3217375">reflect</span><span class="op" id="3217382">.</span><span class="ident" id="3217383">Map</span><span class="op" id="3217386">,</span>&nbsp;<span class="ident" id="3217388">reflect</span><span class="op" id="3217395">.</span><span class="ident" id="3217396">Ptr</span><span class="op" id="3217399">,</span>&nbsp;<span class="ident" id="3217401">reflect</span><span class="op" id="3217408">.</span><span class="ident" id="3217409">Slice</span><span class="op" id="3217414">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217418">return</span>&nbsp;<span class="builtintype" id="3217425">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217434">return</span>&nbsp;<span class="builtintype" id="3217441">false</span><br>
<span class="lineno"></span><span class="op" id="3217447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="3217450">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3217529">func</span>&nbsp;<span class="op" id="3217534">(</span><span class="ident" id="3217535">s</span>&nbsp;<span class="op" id="3217537">*</span><span class="ident" id="3217538">state</span><span class="op" id="3217543">)</span>&nbsp;<span class="ident" id="3217545">validateType</span><span class="op" id="3217557">(</span><span class="ident" id="3217558">value</span>&nbsp;<span class="ident" id="3217564">reflect</span><span class="op" id="3217571">.</span><span class="ident" id="3217572">Value</span><span class="op" id="3217577">,</span>&nbsp;<span class="ident" id="3217579">typ</span>&nbsp;<span class="ident" id="3217583">reflect</span><span class="op" id="3217590">.</span><span class="ident" id="3217591">Type</span><span class="op" id="3217595">)</span>&nbsp;<span class="ident" id="3217597">reflect</span><span class="op" id="3217604">.</span><span class="ident" id="3217605">Value</span>&nbsp;<span class="op" id="3217611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217614">if</span>&nbsp;<span class="op" id="3217617">!</span><span class="ident" id="3217618">value</span><span class="op" id="3217623">.</span><span class="ident" id="3217624">IsValid</span><span class="op" id="3217631">(</span><span class="op" id="3217632">)</span>&nbsp;<span class="op" id="3217634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217638">if</span>&nbsp;<span class="ident" id="3217641">typ</span>&nbsp;<span class="op" id="3217645">==</span>&nbsp;<span class="ident" id="3217648">nil</span>&nbsp;<span class="op" id="3217652">||</span>&nbsp;<span class="ident" id="3217655">canBeNil</span><span class="op" id="3217663">(</span><span class="ident" id="3217664">typ</span><span class="op" id="3217667">)</span>&nbsp;<span class="op" id="3217669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217674">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217738">return</span>&nbsp;<span class="ident" id="3217745">reflect</span><span class="op" id="3217752">.</span><span class="ident" id="3217753">Zero</span><span class="op" id="3217757">(</span><span class="ident" id="3217758">typ</span><span class="op" id="3217761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217769">s</span><span class="op" id="3217770">.</span><span class="ident" id="3217771">errorf</span><span class="op" id="3217777">(</span><span class="string" id="3217778">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="3217806">,</span>&nbsp;<span class="ident" id="3217808">typ</span><span class="op" id="3217811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217817">if</span>&nbsp;<span class="ident" id="3217820">typ</span>&nbsp;<span class="op" id="3217824">!=</span>&nbsp;<span class="ident" id="3217827">nil</span>&nbsp;<span class="op" id="3217831">&amp;&amp;</span>&nbsp;<span class="op" id="3217834">!</span><span class="ident" id="3217835">value</span><span class="op" id="3217840">.</span><span class="ident" id="3217841">Type</span><span class="op" id="3217845">(</span><span class="op" id="3217846">)</span><span class="op" id="3217847">.</span><span class="ident" id="3217848">AssignableTo</span><span class="op" id="3217860">(</span><span class="ident" id="3217861">typ</span><span class="op" id="3217864">)</span>&nbsp;<span class="op" id="3217866">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217870">if</span>&nbsp;<span class="ident" id="3217873">value</span><span class="op" id="3217878">.</span><span class="ident" id="3217879">Kind</span><span class="op" id="3217883">(</span><span class="op" id="3217884">)</span>&nbsp;<span class="op" id="3217886">==</span>&nbsp;<span class="ident" id="3217889">reflect</span><span class="op" id="3217896">.</span><span class="ident" id="3217897">Interface</span>&nbsp;<span class="op" id="3217907">&amp;&amp;</span>&nbsp;<span class="op" id="3217910">!</span><span class="ident" id="3217911">value</span><span class="op" id="3217916">.</span><span class="ident" id="3217917">IsNil</span><span class="op" id="3217922">(</span><span class="op" id="3217923">)</span>&nbsp;<span class="op" id="3217925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217930">value</span>&nbsp;<span class="op" id="3217936">=</span>&nbsp;<span class="ident" id="3217938">value</span><span class="op" id="3217943">.</span><span class="ident" id="3217944">Elem</span><span class="op" id="3217948">(</span><span class="op" id="3217949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217954">if</span>&nbsp;<span class="ident" id="3217957">value</span><span class="op" id="3217962">.</span><span class="ident" id="3217963">Type</span><span class="op" id="3217967">(</span><span class="op" id="3217968">)</span><span class="op" id="3217969">.</span><span class="ident" id="3217970">AssignableTo</span><span class="op" id="3217982">(</span><span class="ident" id="3217983">typ</span><span class="op" id="3217986">)</span>&nbsp;<span class="op" id="3217988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217994">return</span>&nbsp;<span class="ident" id="3218001">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218010">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218015">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218036">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218107">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218179">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218251">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218300">switch</span>&nbsp;<span class="op" id="3218307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218311">case</span>&nbsp;<span class="ident" id="3218316">value</span><span class="op" id="3218321">.</span><span class="ident" id="3218322">Kind</span><span class="op" id="3218326">(</span><span class="op" id="3218327">)</span>&nbsp;<span class="op" id="3218329">==</span>&nbsp;<span class="ident" id="3218332">reflect</span><span class="op" id="3218339">.</span><span class="ident" id="3218340">Ptr</span>&nbsp;<span class="op" id="3218344">&amp;&amp;</span>&nbsp;<span class="ident" id="3218347">value</span><span class="op" id="3218352">.</span><span class="ident" id="3218353">Type</span><span class="op" id="3218357">(</span><span class="op" id="3218358">)</span><span class="op" id="3218359">.</span><span class="ident" id="3218360">Elem</span><span class="op" id="3218364">(</span><span class="op" id="3218365">)</span><span class="op" id="3218366">.</span><span class="ident" id="3218367">AssignableTo</span><span class="op" id="3218379">(</span><span class="ident" id="3218380">typ</span><span class="op" id="3218383">)</span><span class="op" id="3218384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218389">value</span>&nbsp;<span class="op" id="3218395">=</span>&nbsp;<span class="ident" id="3218397">value</span><span class="op" id="3218402">.</span><span class="ident" id="3218403">Elem</span><span class="op" id="3218407">(</span><span class="op" id="3218408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218413">if</span>&nbsp;<span class="op" id="3218416">!</span><span class="ident" id="3218417">value</span><span class="op" id="3218422">.</span><span class="ident" id="3218423">IsValid</span><span class="op" id="3218430">(</span><span class="op" id="3218431">)</span>&nbsp;<span class="op" id="3218433">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218439">s</span><span class="op" id="3218440">.</span><span class="ident" id="3218441">errorf</span><span class="op" id="3218447">(</span><span class="string" id="3218448">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3218487">,</span>&nbsp;<span class="ident" id="3218489">typ</span><span class="op" id="3218492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218501">case</span>&nbsp;<span class="ident" id="3218506">reflect</span><span class="op" id="3218513">.</span><span class="ident" id="3218514">PtrTo</span><span class="op" id="3218519">(</span><span class="ident" id="3218520">value</span><span class="op" id="3218525">.</span><span class="ident" id="3218526">Type</span><span class="op" id="3218530">(</span><span class="op" id="3218531">)</span><span class="op" id="3218532">)</span><span class="op" id="3218533">.</span><span class="ident" id="3218534">AssignableTo</span><span class="op" id="3218546">(</span><span class="ident" id="3218547">typ</span><span class="op" id="3218550">)</span>&nbsp;<span class="op" id="3218552">&amp;&amp;</span>&nbsp;<span class="ident" id="3218555">value</span><span class="op" id="3218560">.</span><span class="ident" id="3218561">CanAddr</span><span class="op" id="3218568">(</span><span class="op" id="3218569">)</span><span class="op" id="3218570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218575">value</span>&nbsp;<span class="op" id="3218581">=</span>&nbsp;<span class="ident" id="3218583">value</span><span class="op" id="3218588">.</span><span class="ident" id="3218589">Addr</span><span class="op" id="3218593">(</span><span class="op" id="3218594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218598">default</span><span class="op" id="3218605">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218610">s</span><span class="op" id="3218611">.</span><span class="ident" id="3218612">errorf</span><span class="op" id="3218618">(</span><span class="string" id="3218619">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="3218662">,</span>&nbsp;<span class="ident" id="3218664">typ</span><span class="op" id="3218667">,</span>&nbsp;<span class="ident" id="3218669">value</span><span class="op" id="3218674">.</span><span class="ident" id="3218675">Type</span><span class="op" id="3218679">(</span><span class="op" id="3218680">)</span><span class="op" id="3218681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218691">return</span>&nbsp;<span class="ident" id="3218698">value</span><br>
<span class="lineno"></span><span class="op" id="3218704">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="3218707">func</span>&nbsp;<span class="op" id="3218712">(</span><span class="ident" id="3218713">s</span>&nbsp;<span class="op" id="3218715">*</span><span class="ident" id="3218716">state</span><span class="op" id="3218721">)</span>&nbsp;<span class="ident" id="3218723">evalArg</span><span class="op" id="3218730">(</span><span class="ident" id="3218731">dot</span>&nbsp;<span class="ident" id="3218735">reflect</span><span class="op" id="3218742">.</span><span class="ident" id="3218743">Value</span><span class="op" id="3218748">,</span>&nbsp;<span class="ident" id="3218750">typ</span>&nbsp;<span class="ident" id="3218754">reflect</span><span class="op" id="3218761">.</span><span class="ident" id="3218762">Type</span><span class="op" id="3218766">,</span>&nbsp;<span class="ident" id="3218768">n</span>&nbsp;<span class="ident" id="3218770">parse</span><span class="op" id="3218775">.</span><span class="ident" id="3218776">Node</span><span class="op" id="3218780">)</span>&nbsp;<span class="ident" id="3218782">reflect</span><span class="op" id="3218789">.</span><span class="ident" id="3218790">Value</span>&nbsp;<span class="op" id="3218796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218799">s</span><span class="op" id="3218800">.</span><span class="ident" id="3218801">at</span><span class="op" id="3218803">(</span><span class="ident" id="3218804">n</span><span class="op" id="3218805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218808">switch</span>&nbsp;<span class="ident" id="3218815">arg</span>&nbsp;<span class="op" id="3218819">:=</span>&nbsp;<span class="ident" id="3218822">n</span><span class="op" id="3218823">.</span><span class="op" id="3218824">(</span><span class="keyword" id="3218825">type</span><span class="op" id="3218829">)</span>&nbsp;<span class="op" id="3218831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218834">case</span>&nbsp;<span class="op" id="3218839">*</span><span class="ident" id="3218840">parse</span><span class="op" id="3218845">.</span><span class="ident" id="3218846">DotNode</span><span class="op" id="3218853">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218857">return</span>&nbsp;<span class="ident" id="3218864">s</span><span class="op" id="3218865">.</span><span class="ident" id="3218866">validateType</span><span class="op" id="3218878">(</span><span class="ident" id="3218879">dot</span><span class="op" id="3218882">,</span>&nbsp;<span class="ident" id="3218884">typ</span><span class="op" id="3218887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218890">case</span>&nbsp;<span class="op" id="3218895">*</span><span class="ident" id="3218896">parse</span><span class="op" id="3218901">.</span><span class="ident" id="3218902">NilNode</span><span class="op" id="3218909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218913">if</span>&nbsp;<span class="ident" id="3218916">canBeNil</span><span class="op" id="3218924">(</span><span class="ident" id="3218925">typ</span><span class="op" id="3218928">)</span>&nbsp;<span class="op" id="3218930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218935">return</span>&nbsp;<span class="ident" id="3218942">reflect</span><span class="op" id="3218949">.</span><span class="ident" id="3218950">Zero</span><span class="op" id="3218954">(</span><span class="ident" id="3218955">typ</span><span class="op" id="3218958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218962">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218966">s</span><span class="op" id="3218967">.</span><span class="ident" id="3218968">errorf</span><span class="op" id="3218974">(</span><span class="string" id="3218975">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="3219000">,</span>&nbsp;<span class="ident" id="3219002">typ</span><span class="op" id="3219005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219008">case</span>&nbsp;<span class="op" id="3219013">*</span><span class="ident" id="3219014">parse</span><span class="op" id="3219019">.</span><span class="ident" id="3219020">FieldNode</span><span class="op" id="3219029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219033">return</span>&nbsp;<span class="ident" id="3219040">s</span><span class="op" id="3219041">.</span><span class="ident" id="3219042">validateType</span><span class="op" id="3219054">(</span><span class="ident" id="3219055">s</span><span class="op" id="3219056">.</span><span class="ident" id="3219057">evalFieldNode</span><span class="op" id="3219070">(</span><span class="ident" id="3219071">dot</span><span class="op" id="3219074">,</span>&nbsp;<span class="ident" id="3219076">arg</span><span class="op" id="3219079">,</span>&nbsp;<span class="op" id="3219081">[</span><span class="op" id="3219082">]</span><span class="ident" id="3219083">parse</span><span class="op" id="3219088">.</span><span class="ident" id="3219089">Node</span><span class="op" id="3219093">{</span><span class="ident" id="3219094">n</span><span class="op" id="3219095">}</span><span class="op" id="3219096">,</span>&nbsp;<span class="ident" id="3219098">zero</span><span class="op" id="3219102">)</span><span class="op" id="3219103">,</span>&nbsp;<span class="ident" id="3219105">typ</span><span class="op" id="3219108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219111">case</span>&nbsp;<span class="op" id="3219116">*</span><span class="ident" id="3219117">parse</span><span class="op" id="3219122">.</span><span class="ident" id="3219123">VariableNode</span><span class="op" id="3219135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219139">return</span>&nbsp;<span class="ident" id="3219146">s</span><span class="op" id="3219147">.</span><span class="ident" id="3219148">validateType</span><span class="op" id="3219160">(</span><span class="ident" id="3219161">s</span><span class="op" id="3219162">.</span><span class="ident" id="3219163">evalVariableNode</span><span class="op" id="3219179">(</span><span class="ident" id="3219180">dot</span><span class="op" id="3219183">,</span>&nbsp;<span class="ident" id="3219185">arg</span><span class="op" id="3219188">,</span>&nbsp;<span class="ident" id="3219190">nil</span><span class="op" id="3219193">,</span>&nbsp;<span class="ident" id="3219195">zero</span><span class="op" id="3219199">)</span><span class="op" id="3219200">,</span>&nbsp;<span class="ident" id="3219202">typ</span><span class="op" id="3219205">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219208">case</span>&nbsp;<span class="op" id="3219213">*</span><span class="ident" id="3219214">parse</span><span class="op" id="3219219">.</span><span class="ident" id="3219220">PipeNode</span><span class="op" id="3219228">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219232">return</span>&nbsp;<span class="ident" id="3219239">s</span><span class="op" id="3219240">.</span><span class="ident" id="3219241">validateType</span><span class="op" id="3219253">(</span><span class="ident" id="3219254">s</span><span class="op" id="3219255">.</span><span class="ident" id="3219256">evalPipeline</span><span class="op" id="3219268">(</span><span class="ident" id="3219269">dot</span><span class="op" id="3219272">,</span>&nbsp;<span class="ident" id="3219274">arg</span><span class="op" id="3219277">)</span><span class="op" id="3219278">,</span>&nbsp;<span class="ident" id="3219280">typ</span><span class="op" id="3219283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219286">case</span>&nbsp;<span class="op" id="3219291">*</span><span class="ident" id="3219292">parse</span><span class="op" id="3219297">.</span><span class="ident" id="3219298">IdentifierNode</span><span class="op" id="3219312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219316">return</span>&nbsp;<span class="ident" id="3219323">s</span><span class="op" id="3219324">.</span><span class="ident" id="3219325">evalFunction</span><span class="op" id="3219337">(</span><span class="ident" id="3219338">dot</span><span class="op" id="3219341">,</span>&nbsp;<span class="ident" id="3219343">arg</span><span class="op" id="3219346">,</span>&nbsp;<span class="ident" id="3219348">arg</span><span class="op" id="3219351">,</span>&nbsp;<span class="ident" id="3219353">nil</span><span class="op" id="3219356">,</span>&nbsp;<span class="ident" id="3219358">zero</span><span class="op" id="3219362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219365">case</span>&nbsp;<span class="op" id="3219370">*</span><span class="ident" id="3219371">parse</span><span class="op" id="3219376">.</span><span class="ident" id="3219377">ChainNode</span><span class="op" id="3219386">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219390">return</span>&nbsp;<span class="ident" id="3219397">s</span><span class="op" id="3219398">.</span><span class="ident" id="3219399">validateType</span><span class="op" id="3219411">(</span><span class="ident" id="3219412">s</span><span class="op" id="3219413">.</span><span class="ident" id="3219414">evalChainNode</span><span class="op" id="3219427">(</span><span class="ident" id="3219428">dot</span><span class="op" id="3219431">,</span>&nbsp;<span class="ident" id="3219433">arg</span><span class="op" id="3219436">,</span>&nbsp;<span class="ident" id="3219438">nil</span><span class="op" id="3219441">,</span>&nbsp;<span class="ident" id="3219443">zero</span><span class="op" id="3219447">)</span><span class="op" id="3219448">,</span>&nbsp;<span class="ident" id="3219450">typ</span><span class="op" id="3219453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3219456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219459">switch</span>&nbsp;<span class="ident" id="3219466">typ</span><span class="op" id="3219469">.</span><span class="ident" id="3219470">Kind</span><span class="op" id="3219474">(</span><span class="op" id="3219475">)</span>&nbsp;<span class="op" id="3219477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219480">case</span>&nbsp;<span class="ident" id="3219485">reflect</span><span class="op" id="3219492">.</span><span class="ident" id="3219493">Bool</span><span class="op" id="3219497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219501">return</span>&nbsp;<span class="ident" id="3219508">s</span><span class="op" id="3219509">.</span><span class="ident" id="3219510">evalBool</span><span class="op" id="3219518">(</span><span class="ident" id="3219519">typ</span><span class="op" id="3219522">,</span>&nbsp;<span class="ident" id="3219524">n</span><span class="op" id="3219525">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219528">case</span>&nbsp;<span class="ident" id="3219533">reflect</span><span class="op" id="3219540">.</span><span class="ident" id="3219541">Complex64</span><span class="op" id="3219550">,</span>&nbsp;<span class="ident" id="3219552">reflect</span><span class="op" id="3219559">.</span><span class="ident" id="3219560">Complex128</span><span class="op" id="3219570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219574">return</span>&nbsp;<span class="ident" id="3219581">s</span><span class="op" id="3219582">.</span><span class="ident" id="3219583">evalComplex</span><span class="op" id="3219594">(</span><span class="ident" id="3219595">typ</span><span class="op" id="3219598">,</span>&nbsp;<span class="ident" id="3219600">n</span><span class="op" id="3219601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219604">case</span>&nbsp;<span class="ident" id="3219609">reflect</span><span class="op" id="3219616">.</span><span class="ident" id="3219617">Float32</span><span class="op" id="3219624">,</span>&nbsp;<span class="ident" id="3219626">reflect</span><span class="op" id="3219633">.</span><span class="ident" id="3219634">Float64</span><span class="op" id="3219641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219645">return</span>&nbsp;<span class="ident" id="3219652">s</span><span class="op" id="3219653">.</span><span class="ident" id="3219654">evalFloat</span><span class="op" id="3219663">(</span><span class="ident" id="3219664">typ</span><span class="op" id="3219667">,</span>&nbsp;<span class="ident" id="3219669">n</span><span class="op" id="3219670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219673">case</span>&nbsp;<span class="ident" id="3219678">reflect</span><span class="op" id="3219685">.</span><span class="ident" id="3219686">Int</span><span class="op" id="3219689">,</span>&nbsp;<span class="ident" id="3219691">reflect</span><span class="op" id="3219698">.</span><span class="ident" id="3219699">Int8</span><span class="op" id="3219703">,</span>&nbsp;<span class="ident" id="3219705">reflect</span><span class="op" id="3219712">.</span><span class="ident" id="3219713">Int16</span><span class="op" id="3219718">,</span>&nbsp;<span class="ident" id="3219720">reflect</span><span class="op" id="3219727">.</span><span class="ident" id="3219728">Int32</span><span class="op" id="3219733">,</span>&nbsp;<span class="ident" id="3219735">reflect</span><span class="op" id="3219742">.</span><span class="ident" id="3219743">Int64</span><span class="op" id="3219748">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219752">return</span>&nbsp;<span class="ident" id="3219759">s</span><span class="op" id="3219760">.</span><span class="ident" id="3219761">evalInteger</span><span class="op" id="3219772">(</span><span class="ident" id="3219773">typ</span><span class="op" id="3219776">,</span>&nbsp;<span class="ident" id="3219778">n</span><span class="op" id="3219779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219782">case</span>&nbsp;<span class="ident" id="3219787">reflect</span><span class="op" id="3219794">.</span><span class="ident" id="3219795">Interface</span><span class="op" id="3219804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219808">if</span>&nbsp;<span class="ident" id="3219811">typ</span><span class="op" id="3219814">.</span><span class="ident" id="3219815">NumMethod</span><span class="op" id="3219824">(</span><span class="op" id="3219825">)</span>&nbsp;<span class="op" id="3219827">==</span>&nbsp;<span class="num" id="3219830">0</span>&nbsp;<span class="op" id="3219832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219837">return</span>&nbsp;<span class="ident" id="3219844">s</span><span class="op" id="3219845">.</span><span class="ident" id="3219846">evalEmptyInterface</span><span class="op" id="3219864">(</span><span class="ident" id="3219865">dot</span><span class="op" id="3219868">,</span>&nbsp;<span class="ident" id="3219870">n</span><span class="op" id="3219871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3219875">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219878">case</span>&nbsp;<span class="ident" id="3219883">reflect</span><span class="op" id="3219890">.</span><span class="ident" id="3219891">String</span><span class="op" id="3219897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219901">return</span>&nbsp;<span class="ident" id="3219908">s</span><span class="op" id="3219909">.</span><span class="ident" id="3219910">evalString</span><span class="op" id="3219920">(</span><span class="ident" id="3219921">typ</span><span class="op" id="3219924">,</span>&nbsp;<span class="ident" id="3219926">n</span><span class="op" id="3219927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219930">case</span>&nbsp;<span class="ident" id="3219935">reflect</span><span class="op" id="3219942">.</span><span class="ident" id="3219943">Uint</span><span class="op" id="3219947">,</span>&nbsp;<span class="ident" id="3219949">reflect</span><span class="op" id="3219956">.</span><span class="ident" id="3219957">Uint8</span><span class="op" id="3219962">,</span>&nbsp;<span class="ident" id="3219964">reflect</span><span class="op" id="3219971">.</span><span class="ident" id="3219972">Uint16</span><span class="op" id="3219978">,</span>&nbsp;<span class="ident" id="3219980">reflect</span><span class="op" id="3219987">.</span><span class="ident" id="3219988">Uint32</span><span class="op" id="3219994">,</span>&nbsp;<span class="ident" id="3219996">reflect</span><span class="op" id="3220003">.</span><span class="ident" id="3220004">Uint64</span><span class="op" id="3220010">,</span>&nbsp;<span class="ident" id="3220012">reflect</span><span class="op" id="3220019">.</span><span class="ident" id="3220020">Uintptr</span><span class="op" id="3220027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220031">return</span>&nbsp;<span class="ident" id="3220038">s</span><span class="op" id="3220039">.</span><span class="ident" id="3220040">evalUnsignedInteger</span><span class="op" id="3220059">(</span><span class="ident" id="3220060">typ</span><span class="op" id="3220063">,</span>&nbsp;<span class="ident" id="3220065">n</span><span class="op" id="3220066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220069">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220072">s</span><span class="op" id="3220073">.</span><span class="ident" id="3220074">errorf</span><span class="op" id="3220080">(</span><span class="string" id="3220081">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3220117">,</span>&nbsp;<span class="ident" id="3220119">n</span><span class="op" id="3220120">,</span>&nbsp;<span class="ident" id="3220122">typ</span><span class="op" id="3220125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3220128">panic</span><span class="op" id="3220133">(</span><span class="string" id="3220134">&#34;not&nbsp;reached&#34;</span><span class="op" id="3220147">)</span><br>
<span class="lineno"></span><span class="op" id="3220149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220152">func</span>&nbsp;<span class="op" id="3220157">(</span><span class="ident" id="3220158">s</span>&nbsp;<span class="op" id="3220160">*</span><span class="ident" id="3220161">state</span><span class="op" id="3220166">)</span>&nbsp;<span class="ident" id="3220168">evalBool</span><span class="op" id="3220176">(</span><span class="ident" id="3220177">typ</span>&nbsp;<span class="ident" id="3220181">reflect</span><span class="op" id="3220188">.</span><span class="ident" id="3220189">Type</span><span class="op" id="3220193">,</span>&nbsp;<span class="ident" id="3220195">n</span>&nbsp;<span class="ident" id="3220197">parse</span><span class="op" id="3220202">.</span><span class="ident" id="3220203">Node</span><span class="op" id="3220207">)</span>&nbsp;<span class="ident" id="3220209">reflect</span><span class="op" id="3220216">.</span><span class="ident" id="3220217">Value</span>&nbsp;<span class="op" id="3220223">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220226">s</span><span class="op" id="3220227">.</span><span class="ident" id="3220228">at</span><span class="op" id="3220230">(</span><span class="ident" id="3220231">n</span><span class="op" id="3220232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220235">if</span>&nbsp;<span class="ident" id="3220238">n</span><span class="op" id="3220239">,</span>&nbsp;<span class="ident" id="3220241">ok</span>&nbsp;<span class="op" id="3220244">:=</span>&nbsp;<span class="ident" id="3220247">n</span><span class="op" id="3220248">.</span><span class="op" id="3220249">(</span><span class="op" id="3220250">*</span><span class="ident" id="3220251">parse</span><span class="op" id="3220256">.</span><span class="ident" id="3220257">BoolNode</span><span class="op" id="3220265">)</span><span class="op" id="3220266">;</span>&nbsp;<span class="ident" id="3220268">ok</span>&nbsp;<span class="op" id="3220271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220275">value</span>&nbsp;<span class="op" id="3220281">:=</span>&nbsp;<span class="ident" id="3220284">reflect</span><span class="op" id="3220291">.</span><span class="ident" id="3220292">New</span><span class="op" id="3220295">(</span><span class="ident" id="3220296">typ</span><span class="op" id="3220299">)</span><span class="op" id="3220300">.</span><span class="ident" id="3220301">Elem</span><span class="op" id="3220305">(</span><span class="op" id="3220306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220310">value</span><span class="op" id="3220315">.</span><span class="ident" id="3220316">SetBool</span><span class="op" id="3220323">(</span><span class="ident" id="3220324">n</span><span class="op" id="3220325">.</span><span class="ident" id="3220326">True</span><span class="op" id="3220330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220334">return</span>&nbsp;<span class="ident" id="3220341">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220351">s</span><span class="op" id="3220352">.</span><span class="ident" id="3220353">errorf</span><span class="op" id="3220359">(</span><span class="string" id="3220360">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3220385">,</span>&nbsp;<span class="ident" id="3220387">n</span><span class="op" id="3220388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3220391">panic</span><span class="op" id="3220396">(</span><span class="string" id="3220397">&#34;not&nbsp;reached&#34;</span><span class="op" id="3220410">)</span><br>
<span class="lineno"></span><span class="op" id="3220412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="3220415">func</span>&nbsp;<span class="op" id="3220420">(</span><span class="ident" id="3220421">s</span>&nbsp;<span class="op" id="3220423">*</span><span class="ident" id="3220424">state</span><span class="op" id="3220429">)</span>&nbsp;<span class="ident" id="3220431">evalString</span><span class="op" id="3220441">(</span><span class="ident" id="3220442">typ</span>&nbsp;<span class="ident" id="3220446">reflect</span><span class="op" id="3220453">.</span><span class="ident" id="3220454">Type</span><span class="op" id="3220458">,</span>&nbsp;<span class="ident" id="3220460">n</span>&nbsp;<span class="ident" id="3220462">parse</span><span class="op" id="3220467">.</span><span class="ident" id="3220468">Node</span><span class="op" id="3220472">)</span>&nbsp;<span class="ident" id="3220474">reflect</span><span class="op" id="3220481">.</span><span class="ident" id="3220482">Value</span>&nbsp;<span class="op" id="3220488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220491">s</span><span class="op" id="3220492">.</span><span class="ident" id="3220493">at</span><span class="op" id="3220495">(</span><span class="ident" id="3220496">n</span><span class="op" id="3220497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220500">if</span>&nbsp;<span class="ident" id="3220503">n</span><span class="op" id="3220504">,</span>&nbsp;<span class="ident" id="3220506">ok</span>&nbsp;<span class="op" id="3220509">:=</span>&nbsp;<span class="ident" id="3220512">n</span><span class="op" id="3220513">.</span><span class="op" id="3220514">(</span><span class="op" id="3220515">*</span><span class="ident" id="3220516">parse</span><span class="op" id="3220521">.</span><span class="ident" id="3220522">StringNode</span><span class="op" id="3220532">)</span><span class="op" id="3220533">;</span>&nbsp;<span class="ident" id="3220535">ok</span>&nbsp;<span class="op" id="3220538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220542">value</span>&nbsp;<span class="op" id="3220548">:=</span>&nbsp;<span class="ident" id="3220551">reflect</span><span class="op" id="3220558">.</span><span class="ident" id="3220559">New</span><span class="op" id="3220562">(</span><span class="ident" id="3220563">typ</span><span class="op" id="3220566">)</span><span class="op" id="3220567">.</span><span class="ident" id="3220568">Elem</span><span class="op" id="3220572">(</span><span class="op" id="3220573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220577">value</span><span class="op" id="3220582">.</span><span class="ident" id="3220583">SetString</span><span class="op" id="3220592">(</span><span class="ident" id="3220593">n</span><span class="op" id="3220594">.</span><span class="ident" id="3220595">Text</span><span class="op" id="3220599">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220603">return</span>&nbsp;<span class="ident" id="3220610">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220620">s</span><span class="op" id="3220621">.</span><span class="ident" id="3220622">errorf</span><span class="op" id="3220628">(</span><span class="string" id="3220629">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3220656">,</span>&nbsp;<span class="ident" id="3220658">n</span><span class="op" id="3220659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3220662">panic</span><span class="op" id="3220667">(</span><span class="string" id="3220668">&#34;not&nbsp;reached&#34;</span><span class="op" id="3220681">)</span><br>
<span class="lineno"></span><span class="op" id="3220683">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3220686">func</span>&nbsp;<span class="op" id="3220691">(</span><span class="ident" id="3220692">s</span>&nbsp;<span class="op" id="3220694">*</span><span class="ident" id="3220695">state</span><span class="op" id="3220700">)</span>&nbsp;<span class="ident" id="3220702">evalInteger</span><span class="op" id="3220713">(</span><span class="ident" id="3220714">typ</span>&nbsp;<span class="ident" id="3220718">reflect</span><span class="op" id="3220725">.</span><span class="ident" id="3220726">Type</span><span class="op" id="3220730">,</span>&nbsp;<span class="ident" id="3220732">n</span>&nbsp;<span class="ident" id="3220734">parse</span><span class="op" id="3220739">.</span><span class="ident" id="3220740">Node</span><span class="op" id="3220744">)</span>&nbsp;<span class="ident" id="3220746">reflect</span><span class="op" id="3220753">.</span><span class="ident" id="3220754">Value</span>&nbsp;<span class="op" id="3220760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220763">s</span><span class="op" id="3220764">.</span><span class="ident" id="3220765">at</span><span class="op" id="3220767">(</span><span class="ident" id="3220768">n</span><span class="op" id="3220769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220772">if</span>&nbsp;<span class="ident" id="3220775">n</span><span class="op" id="3220776">,</span>&nbsp;<span class="ident" id="3220778">ok</span>&nbsp;<span class="op" id="3220781">:=</span>&nbsp;<span class="ident" id="3220784">n</span><span class="op" id="3220785">.</span><span class="op" id="3220786">(</span><span class="op" id="3220787">*</span><span class="ident" id="3220788">parse</span><span class="op" id="3220793">.</span><span class="ident" id="3220794">NumberNode</span><span class="op" id="3220804">)</span><span class="op" id="3220805">;</span>&nbsp;<span class="ident" id="3220807">ok</span>&nbsp;<span class="op" id="3220810">&amp;&amp;</span>&nbsp;<span class="ident" id="3220813">n</span><span class="op" id="3220814">.</span><span class="ident" id="3220815">IsInt</span>&nbsp;<span class="op" id="3220821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220825">value</span>&nbsp;<span class="op" id="3220831">:=</span>&nbsp;<span class="ident" id="3220834">reflect</span><span class="op" id="3220841">.</span><span class="ident" id="3220842">New</span><span class="op" id="3220845">(</span><span class="ident" id="3220846">typ</span><span class="op" id="3220849">)</span><span class="op" id="3220850">.</span><span class="ident" id="3220851">Elem</span><span class="op" id="3220855">(</span><span class="op" id="3220856">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220860">value</span><span class="op" id="3220865">.</span><span class="ident" id="3220866">SetInt</span><span class="op" id="3220872">(</span><span class="ident" id="3220873">n</span><span class="op" id="3220874">.</span><span class="ident" id="3220875">Int64</span><span class="op" id="3220880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220884">return</span>&nbsp;<span class="ident" id="3220891">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220901">s</span><span class="op" id="3220902">.</span><span class="ident" id="3220903">errorf</span><span class="op" id="3220909">(</span><span class="string" id="3220910">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3220938">,</span>&nbsp;<span class="ident" id="3220940">n</span><span class="op" id="3220941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3220944">panic</span><span class="op" id="3220949">(</span><span class="string" id="3220950">&#34;not&nbsp;reached&#34;</span><span class="op" id="3220963">)</span><br>
<span class="lineno">695</span><span class="op" id="3220965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220968">func</span>&nbsp;<span class="op" id="3220973">(</span><span class="ident" id="3220974">s</span>&nbsp;<span class="op" id="3220976">*</span><span class="ident" id="3220977">state</span><span class="op" id="3220982">)</span>&nbsp;<span class="ident" id="3220984">evalUnsignedInteger</span><span class="op" id="3221003">(</span><span class="ident" id="3221004">typ</span>&nbsp;<span class="ident" id="3221008">reflect</span><span class="op" id="3221015">.</span><span class="ident" id="3221016">Type</span><span class="op" id="3221020">,</span>&nbsp;<span class="ident" id="3221022">n</span>&nbsp;<span class="ident" id="3221024">parse</span><span class="op" id="3221029">.</span><span class="ident" id="3221030">Node</span><span class="op" id="3221034">)</span>&nbsp;<span class="ident" id="3221036">reflect</span><span class="op" id="3221043">.</span><span class="ident" id="3221044">Value</span>&nbsp;<span class="op" id="3221050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221053">s</span><span class="op" id="3221054">.</span><span class="ident" id="3221055">at</span><span class="op" id="3221057">(</span><span class="ident" id="3221058">n</span><span class="op" id="3221059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221062">if</span>&nbsp;<span class="ident" id="3221065">n</span><span class="op" id="3221066">,</span>&nbsp;<span class="ident" id="3221068">ok</span>&nbsp;<span class="op" id="3221071">:=</span>&nbsp;<span class="ident" id="3221074">n</span><span class="op" id="3221075">.</span><span class="op" id="3221076">(</span><span class="op" id="3221077">*</span><span class="ident" id="3221078">parse</span><span class="op" id="3221083">.</span><span class="ident" id="3221084">NumberNode</span><span class="op" id="3221094">)</span><span class="op" id="3221095">;</span>&nbsp;<span class="ident" id="3221097">ok</span>&nbsp;<span class="op" id="3221100">&amp;&amp;</span>&nbsp;<span class="ident" id="3221103">n</span><span class="op" id="3221104">.</span><span class="ident" id="3221105">IsUint</span>&nbsp;<span class="op" id="3221112">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221116">value</span>&nbsp;<span class="op" id="3221122">:=</span>&nbsp;<span class="ident" id="3221125">reflect</span><span class="op" id="3221132">.</span><span class="ident" id="3221133">New</span><span class="op" id="3221136">(</span><span class="ident" id="3221137">typ</span><span class="op" id="3221140">)</span><span class="op" id="3221141">.</span><span class="ident" id="3221142">Elem</span><span class="op" id="3221146">(</span><span class="op" id="3221147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221151">value</span><span class="op" id="3221156">.</span><span class="ident" id="3221157">SetUint</span><span class="op" id="3221164">(</span><span class="ident" id="3221165">n</span><span class="op" id="3221166">.</span><span class="ident" id="3221167">Uint64</span><span class="op" id="3221173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221177">return</span>&nbsp;<span class="ident" id="3221184">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3221191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221194">s</span><span class="op" id="3221195">.</span><span class="ident" id="3221196">errorf</span><span class="op" id="3221202">(</span><span class="string" id="3221203">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3221240">,</span>&nbsp;<span class="ident" id="3221242">n</span><span class="op" id="3221243">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3221246">panic</span><span class="op" id="3221251">(</span><span class="string" id="3221252">&#34;not&nbsp;reached&#34;</span><span class="op" id="3221265">)</span><br>
<span class="lineno"></span><span class="op" id="3221267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221270">func</span>&nbsp;<span class="op" id="3221275">(</span><span class="ident" id="3221276">s</span>&nbsp;<span class="op" id="3221278">*</span><span class="ident" id="3221279">state</span><span class="op" id="3221284">)</span>&nbsp;<span class="ident" id="3221286">evalFloat</span><span class="op" id="3221295">(</span><span class="ident" id="3221296">typ</span>&nbsp;<span class="ident" id="3221300">reflect</span><span class="op" id="3221307">.</span><span class="ident" id="3221308">Type</span><span class="op" id="3221312">,</span>&nbsp;<span class="ident" id="3221314">n</span>&nbsp;<span class="ident" id="3221316">parse</span><span class="op" id="3221321">.</span><span class="ident" id="3221322">Node</span><span class="op" id="3221326">)</span>&nbsp;<span class="ident" id="3221328">reflect</span><span class="op" id="3221335">.</span><span class="ident" id="3221336">Value</span>&nbsp;<span class="op" id="3221342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221345">s</span><span class="op" id="3221346">.</span><span class="ident" id="3221347">at</span><span class="op" id="3221349">(</span><span class="ident" id="3221350">n</span><span class="op" id="3221351">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221354">if</span>&nbsp;<span class="ident" id="3221357">n</span><span class="op" id="3221358">,</span>&nbsp;<span class="ident" id="3221360">ok</span>&nbsp;<span class="op" id="3221363">:=</span>&nbsp;<span class="ident" id="3221366">n</span><span class="op" id="3221367">.</span><span class="op" id="3221368">(</span><span class="op" id="3221369">*</span><span class="ident" id="3221370">parse</span><span class="op" id="3221375">.</span><span class="ident" id="3221376">NumberNode</span><span class="op" id="3221386">)</span><span class="op" id="3221387">;</span>&nbsp;<span class="ident" id="3221389">ok</span>&nbsp;<span class="op" id="3221392">&amp;&amp;</span>&nbsp;<span class="ident" id="3221395">n</span><span class="op" id="3221396">.</span><span class="ident" id="3221397">IsFloat</span>&nbsp;<span class="op" id="3221405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221409">value</span>&nbsp;<span class="op" id="3221415">:=</span>&nbsp;<span class="ident" id="3221418">reflect</span><span class="op" id="3221425">.</span><span class="ident" id="3221426">New</span><span class="op" id="3221429">(</span><span class="ident" id="3221430">typ</span><span class="op" id="3221433">)</span><span class="op" id="3221434">.</span><span class="ident" id="3221435">Elem</span><span class="op" id="3221439">(</span><span class="op" id="3221440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221444">value</span><span class="op" id="3221449">.</span><span class="ident" id="3221450">SetFloat</span><span class="op" id="3221458">(</span><span class="ident" id="3221459">n</span><span class="op" id="3221460">.</span><span class="ident" id="3221461">Float64</span><span class="op" id="3221468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221472">return</span>&nbsp;<span class="ident" id="3221479">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3221486">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221489">s</span><span class="op" id="3221490">.</span><span class="ident" id="3221491">errorf</span><span class="op" id="3221497">(</span><span class="string" id="3221498">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3221524">,</span>&nbsp;<span class="ident" id="3221526">n</span><span class="op" id="3221527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3221530">panic</span><span class="op" id="3221535">(</span><span class="string" id="3221536">&#34;not&nbsp;reached&#34;</span><span class="op" id="3221549">)</span><br>
<span class="lineno"></span><span class="op" id="3221551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221554">func</span>&nbsp;<span class="op" id="3221559">(</span><span class="ident" id="3221560">s</span>&nbsp;<span class="op" id="3221562">*</span><span class="ident" id="3221563">state</span><span class="op" id="3221568">)</span>&nbsp;<span class="ident" id="3221570">evalComplex</span><span class="op" id="3221581">(</span><span class="ident" id="3221582">typ</span>&nbsp;<span class="ident" id="3221586">reflect</span><span class="op" id="3221593">.</span><span class="ident" id="3221594">Type</span><span class="op" id="3221598">,</span>&nbsp;<span class="ident" id="3221600">n</span>&nbsp;<span class="ident" id="3221602">parse</span><span class="op" id="3221607">.</span><span class="ident" id="3221608">Node</span><span class="op" id="3221612">)</span>&nbsp;<span class="ident" id="3221614">reflect</span><span class="op" id="3221621">.</span><span class="ident" id="3221622">Value</span>&nbsp;<span class="op" id="3221628">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221631">if</span>&nbsp;<span class="ident" id="3221634">n</span><span class="op" id="3221635">,</span>&nbsp;<span class="ident" id="3221637">ok</span>&nbsp;<span class="op" id="3221640">:=</span>&nbsp;<span class="ident" id="3221643">n</span><span class="op" id="3221644">.</span><span class="op" id="3221645">(</span><span class="op" id="3221646">*</span><span class="ident" id="3221647">parse</span><span class="op" id="3221652">.</span><span class="ident" id="3221653">NumberNode</span><span class="op" id="3221663">)</span><span class="op" id="3221664">;</span>&nbsp;<span class="ident" id="3221666">ok</span>&nbsp;<span class="op" id="3221669">&amp;&amp;</span>&nbsp;<span class="ident" id="3221672">n</span><span class="op" id="3221673">.</span><span class="ident" id="3221674">IsComplex</span>&nbsp;<span class="op" id="3221684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221688">value</span>&nbsp;<span class="op" id="3221694">:=</span>&nbsp;<span class="ident" id="3221697">reflect</span><span class="op" id="3221704">.</span><span class="ident" id="3221705">New</span><span class="op" id="3221708">(</span><span class="ident" id="3221709">typ</span><span class="op" id="3221712">)</span><span class="op" id="3221713">.</span><span class="ident" id="3221714">Elem</span><span class="op" id="3221718">(</span><span class="op" id="3221719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221723">value</span><span class="op" id="3221728">.</span><span class="ident" id="3221729">SetComplex</span><span class="op" id="3221739">(</span><span class="ident" id="3221740">n</span><span class="op" id="3221741">.</span><span class="ident" id="3221742">Complex128</span><span class="op" id="3221752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221756">return</span>&nbsp;<span class="ident" id="3221763">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3221770">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221773">s</span><span class="op" id="3221774">.</span><span class="ident" id="3221775">errorf</span><span class="op" id="3221781">(</span><span class="string" id="3221782">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3221810">,</span>&nbsp;<span class="ident" id="3221812">n</span><span class="op" id="3221813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3221816">panic</span><span class="op" id="3221821">(</span><span class="string" id="3221822">&#34;not&nbsp;reached&#34;</span><span class="op" id="3221835">)</span><br>
<span class="lineno"></span><span class="op" id="3221837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221840">func</span>&nbsp;<span class="op" id="3221845">(</span><span class="ident" id="3221846">s</span>&nbsp;<span class="op" id="3221848">*</span><span class="ident" id="3221849">state</span><span class="op" id="3221854">)</span>&nbsp;<span class="ident" id="3221856">evalEmptyInterface</span><span class="op" id="3221874">(</span><span class="ident" id="3221875">dot</span>&nbsp;<span class="ident" id="3221879">reflect</span><span class="op" id="3221886">.</span><span class="ident" id="3221887">Value</span><span class="op" id="3221892">,</span>&nbsp;<span class="ident" id="3221894">n</span>&nbsp;<span class="ident" id="3221896">parse</span><span class="op" id="3221901">.</span><span class="ident" id="3221902">Node</span><span class="op" id="3221906">)</span>&nbsp;<span class="ident" id="3221908">reflect</span><span class="op" id="3221915">.</span><span class="ident" id="3221916">Value</span>&nbsp;<span class="op" id="3221922">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221925">s</span><span class="op" id="3221926">.</span><span class="ident" id="3221927">at</span><span class="op" id="3221929">(</span><span class="ident" id="3221930">n</span><span class="op" id="3221931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221934">switch</span>&nbsp;<span class="ident" id="3221941">n</span>&nbsp;<span class="op" id="3221943">:=</span>&nbsp;<span class="ident" id="3221946">n</span><span class="op" id="3221947">.</span><span class="op" id="3221948">(</span><span class="keyword" id="3221949">type</span><span class="op" id="3221953">)</span>&nbsp;<span class="op" id="3221955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221958">case</span>&nbsp;<span class="op" id="3221963">*</span><span class="ident" id="3221964">parse</span><span class="op" id="3221969">.</span><span class="ident" id="3221970">BoolNode</span><span class="op" id="3221978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221982">return</span>&nbsp;<span class="ident" id="3221989">reflect</span><span class="op" id="3221996">.</span><span class="ident" id="3221997">ValueOf</span><span class="op" id="3222004">(</span><span class="ident" id="3222005">n</span><span class="op" id="3222006">.</span><span class="ident" id="3222007">True</span><span class="op" id="3222011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222014">case</span>&nbsp;<span class="op" id="3222019">*</span><span class="ident" id="3222020">parse</span><span class="op" id="3222025">.</span><span class="ident" id="3222026">DotNode</span><span class="op" id="3222033">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222037">return</span>&nbsp;<span class="ident" id="3222044">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222049">case</span>&nbsp;<span class="op" id="3222054">*</span><span class="ident" id="3222055">parse</span><span class="op" id="3222060">.</span><span class="ident" id="3222061">FieldNode</span><span class="op" id="3222070">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222074">return</span>&nbsp;<span class="ident" id="3222081">s</span><span class="op" id="3222082">.</span><span class="ident" id="3222083">evalFieldNode</span><span class="op" id="3222096">(</span><span class="ident" id="3222097">dot</span><span class="op" id="3222100">,</span>&nbsp;<span class="ident" id="3222102">n</span><span class="op" id="3222103">,</span>&nbsp;<span class="ident" id="3222105">nil</span><span class="op" id="3222108">,</span>&nbsp;<span class="ident" id="3222110">zero</span><span class="op" id="3222114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222117">case</span>&nbsp;<span class="op" id="3222122">*</span><span class="ident" id="3222123">parse</span><span class="op" id="3222128">.</span><span class="ident" id="3222129">IdentifierNode</span><span class="op" id="3222143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222147">return</span>&nbsp;<span class="ident" id="3222154">s</span><span class="op" id="3222155">.</span><span class="ident" id="3222156">evalFunction</span><span class="op" id="3222168">(</span><span class="ident" id="3222169">dot</span><span class="op" id="3222172">,</span>&nbsp;<span class="ident" id="3222174">n</span><span class="op" id="3222175">,</span>&nbsp;<span class="ident" id="3222177">n</span><span class="op" id="3222178">,</span>&nbsp;<span class="ident" id="3222180">nil</span><span class="op" id="3222183">,</span>&nbsp;<span class="ident" id="3222185">zero</span><span class="op" id="3222189">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222192">case</span>&nbsp;<span class="op" id="3222197">*</span><span class="ident" id="3222198">parse</span><span class="op" id="3222203">.</span><span class="ident" id="3222204">NilNode</span><span class="op" id="3222211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222215">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222283">s</span><span class="op" id="3222284">.</span><span class="ident" id="3222285">errorf</span><span class="op" id="3222291">(</span><span class="string" id="3222292">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="3222332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222335">case</span>&nbsp;<span class="op" id="3222340">*</span><span class="ident" id="3222341">parse</span><span class="op" id="3222346">.</span><span class="ident" id="3222347">NumberNode</span><span class="op" id="3222357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222361">return</span>&nbsp;<span class="ident" id="3222368">s</span><span class="op" id="3222369">.</span><span class="ident" id="3222370">idealConstant</span><span class="op" id="3222383">(</span><span class="ident" id="3222384">n</span><span class="op" id="3222385">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222388">case</span>&nbsp;<span class="op" id="3222393">*</span><span class="ident" id="3222394">parse</span><span class="op" id="3222399">.</span><span class="ident" id="3222400">StringNode</span><span class="op" id="3222410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222414">return</span>&nbsp;<span class="ident" id="3222421">reflect</span><span class="op" id="3222428">.</span><span class="ident" id="3222429">ValueOf</span><span class="op" id="3222436">(</span><span class="ident" id="3222437">n</span><span class="op" id="3222438">.</span><span class="ident" id="3222439">Text</span><span class="op" id="3222443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222446">case</span>&nbsp;<span class="op" id="3222451">*</span><span class="ident" id="3222452">parse</span><span class="op" id="3222457">.</span><span class="ident" id="3222458">VariableNode</span><span class="op" id="3222470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222474">return</span>&nbsp;<span class="ident" id="3222481">s</span><span class="op" id="3222482">.</span><span class="ident" id="3222483">evalVariableNode</span><span class="op" id="3222499">(</span><span class="ident" id="3222500">dot</span><span class="op" id="3222503">,</span>&nbsp;<span class="ident" id="3222505">n</span><span class="op" id="3222506">,</span>&nbsp;<span class="ident" id="3222508">nil</span><span class="op" id="3222511">,</span>&nbsp;<span class="ident" id="3222513">zero</span><span class="op" id="3222517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222520">case</span>&nbsp;<span class="op" id="3222525">*</span><span class="ident" id="3222526">parse</span><span class="op" id="3222531">.</span><span class="ident" id="3222532">PipeNode</span><span class="op" id="3222540">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222544">return</span>&nbsp;<span class="ident" id="3222551">s</span><span class="op" id="3222552">.</span><span class="ident" id="3222553">evalPipeline</span><span class="op" id="3222565">(</span><span class="ident" id="3222566">dot</span><span class="op" id="3222569">,</span>&nbsp;<span class="ident" id="3222571">n</span><span class="op" id="3222572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3222575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222578">s</span><span class="op" id="3222579">.</span><span class="ident" id="3222580">errorf</span><span class="op" id="3222586">(</span><span class="string" id="3222587">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="3222646">,</span>&nbsp;<span class="ident" id="3222648">n</span><span class="op" id="3222649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3222652">panic</span><span class="op" id="3222657">(</span><span class="string" id="3222658">&#34;not&nbsp;reached&#34;</span><span class="op" id="3222671">)</span><br>
<span class="lineno"></span><span class="op" id="3222673">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="3222676">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3222768">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3222836">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="3222888">func</span>&nbsp;<span class="ident" id="3222893">indirect</span><span class="op" id="3222901">(</span><span class="ident" id="3222902">v</span>&nbsp;<span class="ident" id="3222904">reflect</span><span class="op" id="3222911">.</span><span class="ident" id="3222912">Value</span><span class="op" id="3222917">)</span>&nbsp;<span class="op" id="3222919">(</span><span class="ident" id="3222920">rv</span>&nbsp;<span class="ident" id="3222923">reflect</span><span class="op" id="3222930">.</span><span class="ident" id="3222931">Value</span><span class="op" id="3222936">,</span>&nbsp;<span class="ident" id="3222938">isNil</span>&nbsp;<span class="builtintype" id="3222944">bool</span><span class="op" id="3222948">)</span>&nbsp;<span class="op" id="3222950">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222953">for</span>&nbsp;<span class="op" id="3222957">;</span>&nbsp;<span class="ident" id="3222959">v</span><span class="op" id="3222960">.</span><span class="ident" id="3222961">Kind</span><span class="op" id="3222965">(</span><span class="op" id="3222966">)</span>&nbsp;<span class="op" id="3222968">==</span>&nbsp;<span class="ident" id="3222971">reflect</span><span class="op" id="3222978">.</span><span class="ident" id="3222979">Ptr</span>&nbsp;<span class="op" id="3222983">||</span>&nbsp;<span class="ident" id="3222986">v</span><span class="op" id="3222987">.</span><span class="ident" id="3222988">Kind</span><span class="op" id="3222992">(</span><span class="op" id="3222993">)</span>&nbsp;<span class="op" id="3222995">==</span>&nbsp;<span class="ident" id="3222998">reflect</span><span class="op" id="3223005">.</span><span class="ident" id="3223006">Interface</span><span class="op" id="3223015">;</span>&nbsp;<span class="ident" id="3223017">v</span>&nbsp;<span class="op" id="3223019">=</span>&nbsp;<span class="ident" id="3223021">v</span><span class="op" id="3223022">.</span><span class="ident" id="3223023">Elem</span><span class="op" id="3223027">(</span><span class="op" id="3223028">)</span>&nbsp;<span class="op" id="3223030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223034">if</span>&nbsp;<span class="ident" id="3223037">v</span><span class="op" id="3223038">.</span><span class="ident" id="3223039">IsNil</span><span class="op" id="3223044">(</span><span class="op" id="3223045">)</span>&nbsp;<span class="op" id="3223047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223052">return</span>&nbsp;<span class="ident" id="3223059">v</span><span class="op" id="3223060">,</span>&nbsp;<span class="builtintype" id="3223062">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223073">if</span>&nbsp;<span class="ident" id="3223076">v</span><span class="op" id="3223077">.</span><span class="ident" id="3223078">Kind</span><span class="op" id="3223082">(</span><span class="op" id="3223083">)</span>&nbsp;<span class="op" id="3223085">==</span>&nbsp;<span class="ident" id="3223088">reflect</span><span class="op" id="3223095">.</span><span class="ident" id="3223096">Interface</span>&nbsp;<span class="op" id="3223106">&amp;&amp;</span>&nbsp;<span class="ident" id="3223109">v</span><span class="op" id="3223110">.</span><span class="ident" id="3223111">NumMethod</span><span class="op" id="3223120">(</span><span class="op" id="3223121">)</span>&nbsp;<span class="op" id="3223123">&gt;</span>&nbsp;<span class="num" id="3223125">0</span>&nbsp;<span class="op" id="3223127">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223132">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223146">return</span>&nbsp;<span class="ident" id="3223153">v</span><span class="op" id="3223154">,</span>&nbsp;<span class="builtintype" id="3223156">false</span><br>
<span class="lineno"></span><span class="op" id="3223162">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="3223165">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3223243">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3223260">func</span>&nbsp;<span class="op" id="3223265">(</span><span class="ident" id="3223266">s</span>&nbsp;<span class="op" id="3223268">*</span><span class="ident" id="3223269">state</span><span class="op" id="3223274">)</span>&nbsp;<span class="ident" id="3223276">printValue</span><span class="op" id="3223286">(</span><span class="ident" id="3223287">n</span>&nbsp;<span class="ident" id="3223289">parse</span><span class="op" id="3223294">.</span><span class="ident" id="3223295">Node</span><span class="op" id="3223299">,</span>&nbsp;<span class="ident" id="3223301">v</span>&nbsp;<span class="ident" id="3223303">reflect</span><span class="op" id="3223310">.</span><span class="ident" id="3223311">Value</span><span class="op" id="3223316">)</span>&nbsp;<span class="op" id="3223318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223321">s</span><span class="op" id="3223322">.</span><span class="ident" id="3223323">at</span><span class="op" id="3223325">(</span><span class="ident" id="3223326">n</span><span class="op" id="3223327">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223330">iface</span><span class="op" id="3223335">,</span>&nbsp;<span class="ident" id="3223337">ok</span>&nbsp;<span class="op" id="3223340">:=</span>&nbsp;<span class="ident" id="3223343">printableValue</span><span class="op" id="3223357">(</span><span class="ident" id="3223358">v</span><span class="op" id="3223359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223362">if</span>&nbsp;<span class="op" id="3223365">!</span><span class="ident" id="3223366">ok</span>&nbsp;<span class="op" id="3223369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223373">s</span><span class="op" id="3223374">.</span><span class="ident" id="3223375">errorf</span><span class="op" id="3223381">(</span><span class="string" id="3223382">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3223409">,</span>&nbsp;<span class="ident" id="3223411">n</span><span class="op" id="3223412">,</span>&nbsp;<span class="ident" id="3223414">v</span><span class="op" id="3223415">.</span><span class="ident" id="3223416">Type</span><span class="op" id="3223420">(</span><span class="op" id="3223421">)</span><span class="op" id="3223422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223428">fmt</span><span class="op" id="3223431">.</span><span class="ident" id="3223432">Fprint</span><span class="op" id="3223438">(</span><span class="ident" id="3223439">s</span><span class="op" id="3223440">.</span><span class="ident" id="3223441">wr</span><span class="op" id="3223443">,</span>&nbsp;<span class="ident" id="3223445">iface</span><span class="op" id="3223450">)</span><br>
<span class="lineno">780</span><span class="op" id="3223452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3223455">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3223537">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="3223581">func</span>&nbsp;<span class="ident" id="3223586">printableValue</span><span class="op" id="3223600">(</span><span class="ident" id="3223601">v</span>&nbsp;<span class="ident" id="3223603">reflect</span><span class="op" id="3223610">.</span><span class="ident" id="3223611">Value</span><span class="op" id="3223616">)</span>&nbsp;<span class="op" id="3223618">(</span><span class="keyword" id="3223619">interface</span><span class="op" id="3223628">{</span><span class="op" id="3223629">}</span><span class="op" id="3223630">,</span>&nbsp;<span class="builtintype" id="3223632">bool</span><span class="op" id="3223636">)</span>&nbsp;<span class="op" id="3223638">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223641">if</span>&nbsp;<span class="ident" id="3223644">v</span><span class="op" id="3223645">.</span><span class="ident" id="3223646">Kind</span><span class="op" id="3223650">(</span><span class="op" id="3223651">)</span>&nbsp;<span class="op" id="3223653">==</span>&nbsp;<span class="ident" id="3223656">reflect</span><span class="op" id="3223663">.</span><span class="ident" id="3223664">Ptr</span>&nbsp;<span class="op" id="3223668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223672">v</span><span class="op" id="3223673">,</span>&nbsp;<span class="ident" id="3223675">_</span>&nbsp;<span class="op" id="3223677">=</span>&nbsp;<span class="ident" id="3223679">indirect</span><span class="op" id="3223687">(</span><span class="ident" id="3223688">v</span><span class="op" id="3223689">)</span>&nbsp;<span class="comment" id="3223691">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223722">if</span>&nbsp;<span class="op" id="3223725">!</span><span class="ident" id="3223726">v</span><span class="op" id="3223727">.</span><span class="ident" id="3223728">IsValid</span><span class="op" id="3223735">(</span><span class="op" id="3223736">)</span>&nbsp;<span class="op" id="3223738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223742">return</span>&nbsp;<span class="string" id="3223749">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="3223761">,</span>&nbsp;<span class="builtintype" id="3223763">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223773">if</span>&nbsp;<span class="op" id="3223776">!</span><span class="ident" id="3223777">v</span><span class="op" id="3223778">.</span><span class="ident" id="3223779">Type</span><span class="op" id="3223783">(</span><span class="op" id="3223784">)</span><span class="op" id="3223785">.</span><span class="ident" id="3223786">Implements</span><span class="op" id="3223796">(</span><span class="ident" id="3223797">errorType</span><span class="op" id="3223806">)</span>&nbsp;<span class="op" id="3223808">&amp;&amp;</span>&nbsp;<span class="op" id="3223811">!</span><span class="ident" id="3223812">v</span><span class="op" id="3223813">.</span><span class="ident" id="3223814">Type</span><span class="op" id="3223818">(</span><span class="op" id="3223819">)</span><span class="op" id="3223820">.</span><span class="ident" id="3223821">Implements</span><span class="op" id="3223831">(</span><span class="ident" id="3223832">fmtStringerType</span><span class="op" id="3223847">)</span>&nbsp;<span class="op" id="3223849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223853">if</span>&nbsp;<span class="ident" id="3223856">v</span><span class="op" id="3223857">.</span><span class="ident" id="3223858">CanAddr</span><span class="op" id="3223865">(</span><span class="op" id="3223866">)</span>&nbsp;<span class="op" id="3223868">&amp;&amp;</span>&nbsp;<span class="op" id="3223871">(</span><span class="ident" id="3223872">reflect</span><span class="op" id="3223879">.</span><span class="ident" id="3223880">PtrTo</span><span class="op" id="3223885">(</span><span class="ident" id="3223886">v</span><span class="op" id="3223887">.</span><span class="ident" id="3223888">Type</span><span class="op" id="3223892">(</span><span class="op" id="3223893">)</span><span class="op" id="3223894">)</span><span class="op" id="3223895">.</span><span class="ident" id="3223896">Implements</span><span class="op" id="3223906">(</span><span class="ident" id="3223907">errorType</span><span class="op" id="3223916">)</span>&nbsp;<span class="op" id="3223918">||</span>&nbsp;<span class="ident" id="3223921">reflect</span><span class="op" id="3223928">.</span><span class="ident" id="3223929">PtrTo</span><span class="op" id="3223934">(</span><span class="ident" id="3223935">v</span><span class="op" id="3223936">.</span><span class="ident" id="3223937">Type</span><span class="op" id="3223941">(</span><span class="op" id="3223942">)</span><span class="op" id="3223943">)</span><span class="op" id="3223944">.</span><span class="ident" id="3223945">Implements</span><span class="op" id="3223955">(</span><span class="ident" id="3223956">fmtStringerType</span><span class="op" id="3223971">)</span><span class="op" id="3223972">)</span>&nbsp;<span class="op" id="3223974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223979">v</span>&nbsp;<span class="op" id="3223981">=</span>&nbsp;<span class="ident" id="3223983">v</span><span class="op" id="3223984">.</span><span class="ident" id="3223985">Addr</span><span class="op" id="3223989">(</span><span class="op" id="3223990">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223994">}</span>&nbsp;<span class="keyword" id="3223996">else</span>&nbsp;<span class="op" id="3224001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224006">switch</span>&nbsp;<span class="ident" id="3224013">v</span><span class="op" id="3224014">.</span><span class="ident" id="3224015">Kind</span><span class="op" id="3224019">(</span><span class="op" id="3224020">)</span>&nbsp;<span class="op" id="3224022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224027">case</span>&nbsp;<span class="ident" id="3224032">reflect</span><span class="op" id="3224039">.</span><span class="ident" id="3224040">Chan</span><span class="op" id="3224044">,</span>&nbsp;<span class="ident" id="3224046">reflect</span><span class="op" id="3224053">.</span><span class="ident" id="3224054">Func</span><span class="op" id="3224058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224064">return</span>&nbsp;<span class="ident" id="3224071">nil</span><span class="op" id="3224074">,</span>&nbsp;<span class="builtintype" id="3224076">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3224085">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3224089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3224092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224095">return</span>&nbsp;<span class="ident" id="3224102">v</span><span class="op" id="3224103">.</span><span class="ident" id="3224104">Interface</span><span class="op" id="3224113">(</span><span class="op" id="3224114">)</span><span class="op" id="3224115">,</span>&nbsp;<span class="builtintype" id="3224117">true</span><br>
<span class="lineno"></span><span class="op" id="3224122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="3224125">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224191">type</span>&nbsp;<span class="ident" id="3224196">rvs</span>&nbsp;<span class="op" id="3224200">[</span><span class="op" id="3224201">]</span><span class="ident" id="3224202">reflect</span><span class="op" id="3224209">.</span><span class="ident" id="3224210">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224217">func</span>&nbsp;<span class="op" id="3224222">(</span><span class="ident" id="3224223">x</span>&nbsp;<span class="ident" id="3224225">rvs</span><span class="op" id="3224228">)</span>&nbsp;<span class="ident" id="3224230">Len</span><span class="op" id="3224233">(</span><span class="op" id="3224234">)</span>&nbsp;<span class="builtintype" id="3224236">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3224245">{</span>&nbsp;<span class="keyword" id="3224247">return</span>&nbsp;<span class="builtinfunc" id="3224254">len</span><span class="op" id="3224257">(</span><span class="ident" id="3224258">x</span><span class="op" id="3224259">)</span>&nbsp;<span class="op" id="3224261">}</span><br>
<span class="lineno">810</span><span class="keyword" id="3224263">func</span>&nbsp;<span class="op" id="3224268">(</span><span class="ident" id="3224269">x</span>&nbsp;<span class="ident" id="3224271">rvs</span><span class="op" id="3224274">)</span>&nbsp;<span class="ident" id="3224276">Swap</span><span class="op" id="3224280">(</span><span class="ident" id="3224281">i</span><span class="op" id="3224282">,</span>&nbsp;<span class="ident" id="3224284">j</span>&nbsp;<span class="builtintype" id="3224286">int</span><span class="op" id="3224289">)</span>&nbsp;<span class="op" id="3224291">{</span>&nbsp;<span class="ident" id="3224293">x</span><span class="op" id="3224294">[</span><span class="ident" id="3224295">i</span><span class="op" id="3224296">]</span><span class="op" id="3224297">,</span>&nbsp;<span class="ident" id="3224299">x</span><span class="op" id="3224300">[</span><span class="ident" id="3224301">j</span><span class="op" id="3224302">]</span>&nbsp;<span class="op" id="3224304">=</span>&nbsp;<span class="ident" id="3224306">x</span><span class="op" id="3224307">[</span><span class="ident" id="3224308">j</span><span class="op" id="3224309">]</span><span class="op" id="3224310">,</span>&nbsp;<span class="ident" id="3224312">x</span><span class="op" id="3224313">[</span><span class="ident" id="3224314">i</span><span class="op" id="3224315">]</span>&nbsp;<span class="op" id="3224317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224320">type</span>&nbsp;<span class="ident" id="3224325">rvInts</span>&nbsp;<span class="keyword" id="3224332">struct</span><span class="op" id="3224338">{</span>&nbsp;<span class="ident" id="3224340">rvs</span>&nbsp;<span class="op" id="3224344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224347">func</span>&nbsp;<span class="op" id="3224352">(</span><span class="ident" id="3224353">x</span>&nbsp;<span class="ident" id="3224355">rvInts</span><span class="op" id="3224361">)</span>&nbsp;<span class="ident" id="3224363">Less</span><span class="op" id="3224367">(</span><span class="ident" id="3224368">i</span><span class="op" id="3224369">,</span>&nbsp;<span class="ident" id="3224371">j</span>&nbsp;<span class="builtintype" id="3224373">int</span><span class="op" id="3224376">)</span>&nbsp;<span class="builtintype" id="3224378">bool</span>&nbsp;<span class="op" id="3224383">{</span>&nbsp;<span class="keyword" id="3224385">return</span>&nbsp;<span class="ident" id="3224392">x</span><span class="op" id="3224393">.</span><span class="ident" id="3224394">rvs</span><span class="op" id="3224397">[</span><span class="ident" id="3224398">i</span><span class="op" id="3224399">]</span><span class="op" id="3224400">.</span><span class="ident" id="3224401">Int</span><span class="op" id="3224404">(</span><span class="op" id="3224405">)</span>&nbsp;<span class="op" id="3224407">&lt;</span>&nbsp;<span class="ident" id="3224409">x</span><span class="op" id="3224410">.</span><span class="ident" id="3224411">rvs</span><span class="op" id="3224414">[</span><span class="ident" id="3224415">j</span><span class="op" id="3224416">]</span><span class="op" id="3224417">.</span><span class="ident" id="3224418">Int</span><span class="op" id="3224421">(</span><span class="op" id="3224422">)</span>&nbsp;<span class="op" id="3224424">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="3224427">type</span>&nbsp;<span class="ident" id="3224432">rvUints</span>&nbsp;<span class="keyword" id="3224440">struct</span><span class="op" id="3224446">{</span>&nbsp;<span class="ident" id="3224448">rvs</span>&nbsp;<span class="op" id="3224452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224455">func</span>&nbsp;<span class="op" id="3224460">(</span><span class="ident" id="3224461">x</span>&nbsp;<span class="ident" id="3224463">rvUints</span><span class="op" id="3224470">)</span>&nbsp;<span class="ident" id="3224472">Less</span><span class="op" id="3224476">(</span><span class="ident" id="3224477">i</span><span class="op" id="3224478">,</span>&nbsp;<span class="ident" id="3224480">j</span>&nbsp;<span class="builtintype" id="3224482">int</span><span class="op" id="3224485">)</span>&nbsp;<span class="builtintype" id="3224487">bool</span>&nbsp;<span class="op" id="3224492">{</span>&nbsp;<span class="keyword" id="3224494">return</span>&nbsp;<span class="ident" id="3224501">x</span><span class="op" id="3224502">.</span><span class="ident" id="3224503">rvs</span><span class="op" id="3224506">[</span><span class="ident" id="3224507">i</span><span class="op" id="3224508">]</span><span class="op" id="3224509">.</span><span class="ident" id="3224510">Uint</span><span class="op" id="3224514">(</span><span class="op" id="3224515">)</span>&nbsp;<span class="op" id="3224517">&lt;</span>&nbsp;<span class="ident" id="3224519">x</span><span class="op" id="3224520">.</span><span class="ident" id="3224521">rvs</span><span class="op" id="3224524">[</span><span class="ident" id="3224525">j</span><span class="op" id="3224526">]</span><span class="op" id="3224527">.</span><span class="ident" id="3224528">Uint</span><span class="op" id="3224532">(</span><span class="op" id="3224533">)</span>&nbsp;<span class="op" id="3224535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="3224538">type</span>&nbsp;<span class="ident" id="3224543">rvFloats</span>&nbsp;<span class="keyword" id="3224552">struct</span><span class="op" id="3224558">{</span>&nbsp;<span class="ident" id="3224560">rvs</span>&nbsp;<span class="op" id="3224564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224567">func</span>&nbsp;<span class="op" id="3224572">(</span><span class="ident" id="3224573">x</span>&nbsp;<span class="ident" id="3224575">rvFloats</span><span class="op" id="3224583">)</span>&nbsp;<span class="ident" id="3224585">Less</span><span class="op" id="3224589">(</span><span class="ident" id="3224590">i</span><span class="op" id="3224591">,</span>&nbsp;<span class="ident" id="3224593">j</span>&nbsp;<span class="builtintype" id="3224595">int</span><span class="op" id="3224598">)</span>&nbsp;<span class="builtintype" id="3224600">bool</span>&nbsp;<span class="op" id="3224605">{</span>&nbsp;<span class="keyword" id="3224607">return</span>&nbsp;<span class="ident" id="3224614">x</span><span class="op" id="3224615">.</span><span class="ident" id="3224616">rvs</span><span class="op" id="3224619">[</span><span class="ident" id="3224620">i</span><span class="op" id="3224621">]</span><span class="op" id="3224622">.</span><span class="ident" id="3224623">Float</span><span class="op" id="3224628">(</span><span class="op" id="3224629">)</span>&nbsp;<span class="op" id="3224631">&lt;</span>&nbsp;<span class="ident" id="3224633">x</span><span class="op" id="3224634">.</span><span class="ident" id="3224635">rvs</span><span class="op" id="3224638">[</span><span class="ident" id="3224639">j</span><span class="op" id="3224640">]</span><span class="op" id="3224641">.</span><span class="ident" id="3224642">Float</span><span class="op" id="3224647">(</span><span class="op" id="3224648">)</span>&nbsp;<span class="op" id="3224650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224653">type</span>&nbsp;<span class="ident" id="3224658">rvStrings</span>&nbsp;<span class="keyword" id="3224668">struct</span><span class="op" id="3224674">{</span>&nbsp;<span class="ident" id="3224676">rvs</span>&nbsp;<span class="op" id="3224680">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="3224683">func</span>&nbsp;<span class="op" id="3224688">(</span><span class="ident" id="3224689">x</span>&nbsp;<span class="ident" id="3224691">rvStrings</span><span class="op" id="3224700">)</span>&nbsp;<span class="ident" id="3224702">Less</span><span class="op" id="3224706">(</span><span class="ident" id="3224707">i</span><span class="op" id="3224708">,</span>&nbsp;<span class="ident" id="3224710">j</span>&nbsp;<span class="builtintype" id="3224712">int</span><span class="op" id="3224715">)</span>&nbsp;<span class="builtintype" id="3224717">bool</span>&nbsp;<span class="op" id="3224722">{</span>&nbsp;<span class="keyword" id="3224724">return</span>&nbsp;<span class="ident" id="3224731">x</span><span class="op" id="3224732">.</span><span class="ident" id="3224733">rvs</span><span class="op" id="3224736">[</span><span class="ident" id="3224737">i</span><span class="op" id="3224738">]</span><span class="op" id="3224739">.</span><span class="ident" id="3224740">String</span><span class="op" id="3224746">(</span><span class="op" id="3224747">)</span>&nbsp;<span class="op" id="3224749">&lt;</span>&nbsp;<span class="ident" id="3224751">x</span><span class="op" id="3224752">.</span><span class="ident" id="3224753">rvs</span><span class="op" id="3224756">[</span><span class="ident" id="3224757">j</span><span class="op" id="3224758">]</span><span class="op" id="3224759">.</span><span class="ident" id="3224760">String</span><span class="op" id="3224766">(</span><span class="op" id="3224767">)</span>&nbsp;<span class="op" id="3224769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3224772">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="3224861">func</span>&nbsp;<span class="ident" id="3224866">sortKeys</span><span class="op" id="3224874">(</span><span class="ident" id="3224875">v</span>&nbsp;<span class="op" id="3224877">[</span><span class="op" id="3224878">]</span><span class="ident" id="3224879">reflect</span><span class="op" id="3224886">.</span><span class="ident" id="3224887">Value</span><span class="op" id="3224892">)</span>&nbsp;<span class="op" id="3224894">[</span><span class="op" id="3224895">]</span><span class="ident" id="3224896">reflect</span><span class="op" id="3224903">.</span><span class="ident" id="3224904">Value</span>&nbsp;<span class="op" id="3224910">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224913">if</span>&nbsp;<span class="builtinfunc" id="3224916">len</span><span class="op" id="3224919">(</span><span class="ident" id="3224920">v</span><span class="op" id="3224921">)</span>&nbsp;<span class="op" id="3224923">&lt;=</span>&nbsp;<span class="num" id="3224926">1</span>&nbsp;<span class="op" id="3224928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224932">return</span>&nbsp;<span class="ident" id="3224939">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3224942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224945">switch</span>&nbsp;<span class="ident" id="3224952">v</span><span class="op" id="3224953">[</span><span class="num" id="3224954">0</span><span class="op" id="3224955">]</span><span class="op" id="3224956">.</span><span class="ident" id="3224957">Kind</span><span class="op" id="3224961">(</span><span class="op" id="3224962">)</span>&nbsp;<span class="op" id="3224964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224967">case</span>&nbsp;<span class="ident" id="3224972">reflect</span><span class="op" id="3224979">.</span><span class="ident" id="3224980">Float32</span><span class="op" id="3224987">,</span>&nbsp;<span class="ident" id="3224989">reflect</span><span class="op" id="3224996">.</span><span class="ident" id="3224997">Float64</span><span class="op" id="3225004">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225008">sort</span><span class="op" id="3225012">.</span><span class="ident" id="3225013">Sort</span><span class="op" id="3225017">(</span><span class="ident" id="3225018">rvFloats</span><span class="op" id="3225026">{</span><span class="ident" id="3225027">v</span><span class="op" id="3225028">}</span><span class="op" id="3225029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225032">case</span>&nbsp;<span class="ident" id="3225037">reflect</span><span class="op" id="3225044">.</span><span class="ident" id="3225045">Int</span><span class="op" id="3225048">,</span>&nbsp;<span class="ident" id="3225050">reflect</span><span class="op" id="3225057">.</span><span class="ident" id="3225058">Int8</span><span class="op" id="3225062">,</span>&nbsp;<span class="ident" id="3225064">reflect</span><span class="op" id="3225071">.</span><span class="ident" id="3225072">Int16</span><span class="op" id="3225077">,</span>&nbsp;<span class="ident" id="3225079">reflect</span><span class="op" id="3225086">.</span><span class="ident" id="3225087">Int32</span><span class="op" id="3225092">,</span>&nbsp;<span class="ident" id="3225094">reflect</span><span class="op" id="3225101">.</span><span class="ident" id="3225102">Int64</span><span class="op" id="3225107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225111">sort</span><span class="op" id="3225115">.</span><span class="ident" id="3225116">Sort</span><span class="op" id="3225120">(</span><span class="ident" id="3225121">rvInts</span><span class="op" id="3225127">{</span><span class="ident" id="3225128">v</span><span class="op" id="3225129">}</span><span class="op" id="3225130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225133">case</span>&nbsp;<span class="ident" id="3225138">reflect</span><span class="op" id="3225145">.</span><span class="ident" id="3225146">String</span><span class="op" id="3225152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225156">sort</span><span class="op" id="3225160">.</span><span class="ident" id="3225161">Sort</span><span class="op" id="3225165">(</span><span class="ident" id="3225166">rvStrings</span><span class="op" id="3225175">{</span><span class="ident" id="3225176">v</span><span class="op" id="3225177">}</span><span class="op" id="3225178">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225181">case</span>&nbsp;<span class="ident" id="3225186">reflect</span><span class="op" id="3225193">.</span><span class="ident" id="3225194">Uint</span><span class="op" id="3225198">,</span>&nbsp;<span class="ident" id="3225200">reflect</span><span class="op" id="3225207">.</span><span class="ident" id="3225208">Uint8</span><span class="op" id="3225213">,</span>&nbsp;<span class="ident" id="3225215">reflect</span><span class="op" id="3225222">.</span><span class="ident" id="3225223">Uint16</span><span class="op" id="3225229">,</span>&nbsp;<span class="ident" id="3225231">reflect</span><span class="op" id="3225238">.</span><span class="ident" id="3225239">Uint32</span><span class="op" id="3225245">,</span>&nbsp;<span class="ident" id="3225247">reflect</span><span class="op" id="3225254">.</span><span class="ident" id="3225255">Uint64</span><span class="op" id="3225261">,</span>&nbsp;<span class="ident" id="3225263">reflect</span><span class="op" id="3225270">.</span><span class="ident" id="3225271">Uintptr</span><span class="op" id="3225278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225282">sort</span><span class="op" id="3225286">.</span><span class="ident" id="3225287">Sort</span><span class="op" id="3225291">(</span><span class="ident" id="3225292">rvUints</span><span class="op" id="3225299">{</span><span class="ident" id="3225300">v</span><span class="op" id="3225301">}</span><span class="op" id="3225302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225308">return</span>&nbsp;<span class="ident" id="3225315">v</span><br>
<span class="lineno"></span><span class="op" id="3225317">}</span>
</div>
</body>
</html>
