<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html" class="current">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2208414">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2208469">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2208523">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2208574">package</span>&nbsp;<span class="ident" id="2208582">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2208588">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2208628">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2208688">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2208752">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2208810">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2208868">//</span><br>
<span class="lineno"></span><span class="comment" id="2208871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2208885">//</span><br>
<span class="lineno"></span><span class="comment" id="2208888">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2208910">//</span><br>
<span class="lineno">20</span><span class="comment" id="2208913">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2208926">//</span><br>
<span class="lineno"></span><span class="comment" id="2208929">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2208952">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2208969">//</span><br>
<span class="lineno">25</span><span class="comment" id="2208972">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2208988">//</span><br>
<span class="lineno"></span><span class="comment" id="2208991">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2209068">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2209138">//</span><br>
<span class="lineno">30</span><span class="comment" id="2209141">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2209197">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2209247">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2209275">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2209329">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2209357">//</span><br>
<span class="lineno"></span><span class="comment" id="2209360">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2209373">//</span><br>
<span class="lineno"></span><span class="comment" id="2209376">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2209416">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2209475">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2209536">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2209597">//</span><br>
<span class="lineno"></span><span class="comment" id="2209600">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2209678">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2209754">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2209796">//</span><br>
<span class="lineno"></span><span class="comment" id="2209799">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2209813">//</span><br>
<span class="lineno"></span><span class="comment" id="2209816">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2209840">//</span><br>
<span class="lineno"></span><span class="comment" id="2209843">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2209856">//</span><br>
<span class="lineno"></span><span class="comment" id="2209859">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2209882">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2209899">//</span><br>
<span class="lineno"></span><span class="comment" id="2209902">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2209918">//</span><br>
<span class="lineno"></span><span class="comment" id="2209921">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2209998">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2210068">//</span><br>
<span class="lineno"></span><span class="comment" id="2210071">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2210127">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2210179">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2210207">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2210259">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2210287">//</span><br>
<span class="lineno"></span><span class="comment" id="2210290">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2210303">//</span><br>
<span class="lineno"></span><span class="comment" id="2210306">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2210346">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2210405">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2210466">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2210527">//</span><br>
<span class="lineno"></span><span class="comment" id="2210530">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2210578">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2210642">//</span><br>
<span class="lineno"></span><span class="comment" id="2210645">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2210706">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2210776">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2210851">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2210918">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2210991">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2211063">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2211077">//</span><br>
<span class="lineno">85</span><span class="comment" id="2211080">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2211146">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2211212">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2211225">//</span><br>
<span class="lineno"></span><span class="comment" id="2211228">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2211252">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2211282">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2211302">var</span>&nbsp;<span class="ident" id="2211306">_sin</span>&nbsp;<span class="op" id="2211311">=</span>&nbsp;<span class="op" id="2211313">[</span><span class="op" id="2211314">...</span><span class="op" id="2211317">]</span><span class="builtintype" id="2211318">float64</span><span class="op" id="2211325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2211328">1.58962301576546568060E-10</span><span class="op" id="2211354">,</span>&nbsp;<span class="comment" id="2211356">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211379">-</span><span class="num" id="2211380">2.50507477628578072866E-8</span><span class="op" id="2211405">,</span>&nbsp;<span class="comment" id="2211407">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2211430">2.75573136213857245213E-6</span><span class="op" id="2211455">,</span>&nbsp;&nbsp;<span class="comment" id="2211458">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211481">-</span><span class="num" id="2211482">1.98412698295895385996E-4</span><span class="op" id="2211507">,</span>&nbsp;<span class="comment" id="2211509">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2211532">8.33333333332211858878E-3</span><span class="op" id="2211557">,</span>&nbsp;&nbsp;<span class="comment" id="2211560">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211583">-</span><span class="num" id="2211584">1.66666666666666307295E-1</span><span class="op" id="2211609">,</span>&nbsp;<span class="comment" id="2211611">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2211633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2211636">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2211656">var</span>&nbsp;<span class="ident" id="2211660">_cos</span>&nbsp;<span class="op" id="2211665">=</span>&nbsp;<span class="op" id="2211667">[</span><span class="op" id="2211668">...</span><span class="op" id="2211671">]</span><span class="builtintype" id="2211672">float64</span><span class="op" id="2211679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211682">-</span><span class="num" id="2211683">1.13585365213876817300E-11</span><span class="op" id="2211709">,</span>&nbsp;<span class="comment" id="2211711">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2211734">2.08757008419747316778E-9</span><span class="op" id="2211759">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2211763">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211786">-</span><span class="num" id="2211787">2.75573141792967388112E-7</span><span class="op" id="2211812">,</span>&nbsp;&nbsp;<span class="comment" id="2211815">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2211838">2.48015872888517045348E-5</span><span class="op" id="2211863">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2211867">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211890">-</span><span class="num" id="2211891">1.38888888888730564116E-3</span><span class="op" id="2211916">,</span>&nbsp;&nbsp;<span class="comment" id="2211919">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2211942">4.16666666666665929218E-2</span><span class="op" id="2211967">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2211971">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2211993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2211996">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2212048">//</span><br>
<span class="lineno"></span><span class="comment" id="2212051">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2212073">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2212093">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2212111">func</span>&nbsp;<span class="ident" id="2212116">Cos</span><span class="op" id="2212119">(</span><span class="ident" id="2212120">x</span>&nbsp;<span class="builtintype" id="2212122">float64</span><span class="op" id="2212129">)</span>&nbsp;<span class="builtintype" id="2212131">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2212140">func</span>&nbsp;<span class="ident" id="2212145">cos</span><span class="op" id="2212148">(</span><span class="ident" id="2212149">x</span>&nbsp;<span class="builtintype" id="2212151">float64</span><span class="op" id="2212158">)</span>&nbsp;<span class="builtintype" id="2212160">float64</span>&nbsp;<span class="op" id="2212168">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212171">const</span>&nbsp;<span class="op" id="2212177">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212181">PI4A</span>&nbsp;<span class="op" id="2212186">=</span>&nbsp;<span class="num" id="2212188">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2212242">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212295">PI4B</span>&nbsp;<span class="op" id="2212300">=</span>&nbsp;<span class="num" id="2212302">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2212356">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212381">PI4C</span>&nbsp;<span class="op" id="2212386">=</span>&nbsp;<span class="num" id="2212388">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2212442">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212467">M4PI</span>&nbsp;<span class="op" id="2212472">=</span>&nbsp;<span class="num" id="2212474">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2212528">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2212537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212540">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212558">switch</span>&nbsp;<span class="op" id="2212565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212568">case</span>&nbsp;<span class="ident" id="2212573">IsNaN</span><span class="op" id="2212578">(</span><span class="ident" id="2212579">x</span><span class="op" id="2212580">)</span>&nbsp;<span class="op" id="2212582">||</span>&nbsp;<span class="ident" id="2212585">IsInf</span><span class="op" id="2212590">(</span><span class="ident" id="2212591">x</span><span class="op" id="2212592">,</span>&nbsp;<span class="num" id="2212594">0</span><span class="op" id="2212595">)</span><span class="op" id="2212596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212600">return</span>&nbsp;<span class="ident" id="2212607">NaN</span><span class="op" id="2212610">(</span><span class="op" id="2212611">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2212614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212618">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212645">sign</span>&nbsp;<span class="op" id="2212650">:=</span>&nbsp;<span class="builtintype" id="2212653">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212660">if</span>&nbsp;<span class="ident" id="2212663">x</span>&nbsp;<span class="op" id="2212665">&lt;</span>&nbsp;<span class="num" id="2212667">0</span>&nbsp;<span class="op" id="2212669">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212673">x</span>&nbsp;<span class="op" id="2212675">=</span>&nbsp;<span class="op" id="2212677">-</span><span class="ident" id="2212678">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2212681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212685">j</span>&nbsp;<span class="op" id="2212687">:=</span>&nbsp;<span class="ident" id="2212690">int64</span><span class="op" id="2212695">(</span><span class="ident" id="2212696">x</span>&nbsp;<span class="op" id="2212698">*</span>&nbsp;<span class="ident" id="2212700">M4PI</span><span class="op" id="2212704">)</span>&nbsp;<span class="comment" id="2212706">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212776">y</span>&nbsp;<span class="op" id="2212778">:=</span>&nbsp;<span class="builtintype" id="2212781">float64</span><span class="op" id="2212788">(</span><span class="ident" id="2212789">j</span><span class="op" id="2212790">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2212797">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212837">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212861">if</span>&nbsp;<span class="ident" id="2212864">j</span><span class="op" id="2212865">&amp;</span><span class="num" id="2212866">1</span>&nbsp;<span class="op" id="2212868">==</span>&nbsp;<span class="num" id="2212871">1</span>&nbsp;<span class="op" id="2212873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212877">j</span>&nbsp;<span class="op" id="2212879">+=</span>&nbsp;<span class="num" id="2212882">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212886">y</span>&nbsp;<span class="op" id="2212888">+=</span>&nbsp;<span class="num" id="2212891">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2212894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212897">j</span>&nbsp;<span class="op" id="2212899">&amp;=</span>&nbsp;<span class="num" id="2212902">7</span>&nbsp;<span class="comment" id="2212904">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212948">if</span>&nbsp;<span class="ident" id="2212951">j</span>&nbsp;<span class="op" id="2212953">&gt;</span>&nbsp;<span class="num" id="2212955">3</span>&nbsp;<span class="op" id="2212957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212961">j</span>&nbsp;<span class="op" id="2212963">-=</span>&nbsp;<span class="num" id="2212966">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212970">sign</span>&nbsp;<span class="op" id="2212975">=</span>&nbsp;<span class="op" id="2212977">!</span><span class="ident" id="2212978">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2212984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212987">if</span>&nbsp;<span class="ident" id="2212990">j</span>&nbsp;<span class="op" id="2212992">&gt;</span>&nbsp;<span class="num" id="2212994">1</span>&nbsp;<span class="op" id="2212996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213000">sign</span>&nbsp;<span class="op" id="2213005">=</span>&nbsp;<span class="op" id="2213007">!</span><span class="ident" id="2213008">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213018">z</span>&nbsp;<span class="op" id="2213020">:=</span>&nbsp;<span class="op" id="2213023">(</span><span class="op" id="2213024">(</span><span class="ident" id="2213025">x</span>&nbsp;<span class="op" id="2213027">-</span>&nbsp;<span class="ident" id="2213029">y</span><span class="op" id="2213030">*</span><span class="ident" id="2213031">PI4A</span><span class="op" id="2213035">)</span>&nbsp;<span class="op" id="2213037">-</span>&nbsp;<span class="ident" id="2213039">y</span><span class="op" id="2213040">*</span><span class="ident" id="2213041">PI4B</span><span class="op" id="2213045">)</span>&nbsp;<span class="op" id="2213047">-</span>&nbsp;<span class="ident" id="2213049">y</span><span class="op" id="2213050">*</span><span class="ident" id="2213051">PI4C</span>&nbsp;<span class="comment" id="2213056">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213098">zz</span>&nbsp;<span class="op" id="2213101">:=</span>&nbsp;<span class="ident" id="2213104">z</span>&nbsp;<span class="op" id="2213106">*</span>&nbsp;<span class="ident" id="2213108">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213111">if</span>&nbsp;<span class="ident" id="2213114">j</span>&nbsp;<span class="op" id="2213116">==</span>&nbsp;<span class="num" id="2213119">1</span>&nbsp;<span class="op" id="2213121">||</span>&nbsp;<span class="ident" id="2213124">j</span>&nbsp;<span class="op" id="2213126">==</span>&nbsp;<span class="num" id="2213129">2</span>&nbsp;<span class="op" id="2213131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213135">y</span>&nbsp;<span class="op" id="2213137">=</span>&nbsp;<span class="ident" id="2213139">z</span>&nbsp;<span class="op" id="2213141">+</span>&nbsp;<span class="ident" id="2213143">z</span><span class="op" id="2213144">*</span><span class="ident" id="2213145">zz</span><span class="op" id="2213147">*</span><span class="op" id="2213148">(</span><span class="op" id="2213149">(</span><span class="op" id="2213150">(</span><span class="op" id="2213151">(</span><span class="op" id="2213152">(</span><span class="op" id="2213153">(</span><span class="ident" id="2213154">_sin</span><span class="op" id="2213158">[</span><span class="num" id="2213159">0</span><span class="op" id="2213160">]</span><span class="op" id="2213161">*</span><span class="ident" id="2213162">zz</span><span class="op" id="2213164">)</span><span class="op" id="2213165">+</span><span class="ident" id="2213166">_sin</span><span class="op" id="2213170">[</span><span class="num" id="2213171">1</span><span class="op" id="2213172">]</span><span class="op" id="2213173">)</span><span class="op" id="2213174">*</span><span class="ident" id="2213175">zz</span><span class="op" id="2213177">+</span><span class="ident" id="2213178">_sin</span><span class="op" id="2213182">[</span><span class="num" id="2213183">2</span><span class="op" id="2213184">]</span><span class="op" id="2213185">)</span><span class="op" id="2213186">*</span><span class="ident" id="2213187">zz</span><span class="op" id="2213189">+</span><span class="ident" id="2213190">_sin</span><span class="op" id="2213194">[</span><span class="num" id="2213195">3</span><span class="op" id="2213196">]</span><span class="op" id="2213197">)</span><span class="op" id="2213198">*</span><span class="ident" id="2213199">zz</span><span class="op" id="2213201">+</span><span class="ident" id="2213202">_sin</span><span class="op" id="2213206">[</span><span class="num" id="2213207">4</span><span class="op" id="2213208">]</span><span class="op" id="2213209">)</span><span class="op" id="2213210">*</span><span class="ident" id="2213211">zz</span><span class="op" id="2213213">+</span><span class="ident" id="2213214">_sin</span><span class="op" id="2213218">[</span><span class="num" id="2213219">5</span><span class="op" id="2213220">]</span><span class="op" id="2213221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213224">}</span>&nbsp;<span class="keyword" id="2213226">else</span>&nbsp;<span class="op" id="2213231">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213235">y</span>&nbsp;<span class="op" id="2213237">=</span>&nbsp;<span class="num" id="2213239">1.0</span>&nbsp;<span class="op" id="2213243">-</span>&nbsp;<span class="num" id="2213245">0.5</span><span class="op" id="2213248">*</span><span class="ident" id="2213249">zz</span>&nbsp;<span class="op" id="2213252">+</span>&nbsp;<span class="ident" id="2213254">zz</span><span class="op" id="2213256">*</span><span class="ident" id="2213257">zz</span><span class="op" id="2213259">*</span><span class="op" id="2213260">(</span><span class="op" id="2213261">(</span><span class="op" id="2213262">(</span><span class="op" id="2213263">(</span><span class="op" id="2213264">(</span><span class="op" id="2213265">(</span><span class="ident" id="2213266">_cos</span><span class="op" id="2213270">[</span><span class="num" id="2213271">0</span><span class="op" id="2213272">]</span><span class="op" id="2213273">*</span><span class="ident" id="2213274">zz</span><span class="op" id="2213276">)</span><span class="op" id="2213277">+</span><span class="ident" id="2213278">_cos</span><span class="op" id="2213282">[</span><span class="num" id="2213283">1</span><span class="op" id="2213284">]</span><span class="op" id="2213285">)</span><span class="op" id="2213286">*</span><span class="ident" id="2213287">zz</span><span class="op" id="2213289">+</span><span class="ident" id="2213290">_cos</span><span class="op" id="2213294">[</span><span class="num" id="2213295">2</span><span class="op" id="2213296">]</span><span class="op" id="2213297">)</span><span class="op" id="2213298">*</span><span class="ident" id="2213299">zz</span><span class="op" id="2213301">+</span><span class="ident" id="2213302">_cos</span><span class="op" id="2213306">[</span><span class="num" id="2213307">3</span><span class="op" id="2213308">]</span><span class="op" id="2213309">)</span><span class="op" id="2213310">*</span><span class="ident" id="2213311">zz</span><span class="op" id="2213313">+</span><span class="ident" id="2213314">_cos</span><span class="op" id="2213318">[</span><span class="num" id="2213319">4</span><span class="op" id="2213320">]</span><span class="op" id="2213321">)</span><span class="op" id="2213322">*</span><span class="ident" id="2213323">zz</span><span class="op" id="2213325">+</span><span class="ident" id="2213326">_cos</span><span class="op" id="2213330">[</span><span class="num" id="2213331">5</span><span class="op" id="2213332">]</span><span class="op" id="2213333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213339">if</span>&nbsp;<span class="ident" id="2213342">sign</span>&nbsp;<span class="op" id="2213347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213351">y</span>&nbsp;<span class="op" id="2213353">=</span>&nbsp;<span class="op" id="2213355">-</span><span class="ident" id="2213356">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213359">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213362">return</span>&nbsp;<span class="ident" id="2213369">y</span><br>
<span class="lineno"></span><span class="op" id="2213371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2213374">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2213424">//</span><br>
<span class="lineno">170</span><span class="comment" id="2213427">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2213449">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2213467">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2213487">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2213505">func</span>&nbsp;<span class="ident" id="2213510">Sin</span><span class="op" id="2213513">(</span><span class="ident" id="2213514">x</span>&nbsp;<span class="builtintype" id="2213516">float64</span><span class="op" id="2213523">)</span>&nbsp;<span class="builtintype" id="2213525">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2213534">func</span>&nbsp;<span class="ident" id="2213539">sin</span><span class="op" id="2213542">(</span><span class="ident" id="2213543">x</span>&nbsp;<span class="builtintype" id="2213545">float64</span><span class="op" id="2213552">)</span>&nbsp;<span class="builtintype" id="2213554">float64</span>&nbsp;<span class="op" id="2213562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213565">const</span>&nbsp;<span class="op" id="2213571">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213575">PI4A</span>&nbsp;<span class="op" id="2213580">=</span>&nbsp;<span class="num" id="2213582">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213636">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213689">PI4B</span>&nbsp;<span class="op" id="2213694">=</span>&nbsp;<span class="num" id="2213696">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213750">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213775">PI4C</span>&nbsp;<span class="op" id="2213780">=</span>&nbsp;<span class="num" id="2213782">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213836">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213861">M4PI</span>&nbsp;<span class="op" id="2213866">=</span>&nbsp;<span class="num" id="2213868">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2213922">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2213934">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213952">switch</span>&nbsp;<span class="op" id="2213959">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213962">case</span>&nbsp;<span class="ident" id="2213967">x</span>&nbsp;<span class="op" id="2213969">==</span>&nbsp;<span class="num" id="2213972">0</span>&nbsp;<span class="op" id="2213974">||</span>&nbsp;<span class="ident" id="2213977">IsNaN</span><span class="op" id="2213982">(</span><span class="ident" id="2213983">x</span><span class="op" id="2213984">)</span><span class="op" id="2213985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213989">return</span>&nbsp;<span class="ident" id="2213996">x</span>&nbsp;<span class="comment" id="2213998">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214022">case</span>&nbsp;<span class="ident" id="2214027">IsInf</span><span class="op" id="2214032">(</span><span class="ident" id="2214033">x</span><span class="op" id="2214034">,</span>&nbsp;<span class="num" id="2214036">0</span><span class="op" id="2214037">)</span><span class="op" id="2214038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214042">return</span>&nbsp;<span class="ident" id="2214049">NaN</span><span class="op" id="2214052">(</span><span class="op" id="2214053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214056">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2214060">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214105">sign</span>&nbsp;<span class="op" id="2214110">:=</span>&nbsp;<span class="builtintype" id="2214113">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214120">if</span>&nbsp;<span class="ident" id="2214123">x</span>&nbsp;<span class="op" id="2214125">&lt;</span>&nbsp;<span class="num" id="2214127">0</span>&nbsp;<span class="op" id="2214129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214133">x</span>&nbsp;<span class="op" id="2214135">=</span>&nbsp;<span class="op" id="2214137">-</span><span class="ident" id="2214138">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214142">sign</span>&nbsp;<span class="op" id="2214147">=</span>&nbsp;<span class="builtintype" id="2214149">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214159">j</span>&nbsp;<span class="op" id="2214161">:=</span>&nbsp;<span class="ident" id="2214164">int64</span><span class="op" id="2214169">(</span><span class="ident" id="2214170">x</span>&nbsp;<span class="op" id="2214172">*</span>&nbsp;<span class="ident" id="2214174">M4PI</span><span class="op" id="2214178">)</span>&nbsp;<span class="comment" id="2214180">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214250">y</span>&nbsp;<span class="op" id="2214252">:=</span>&nbsp;<span class="builtintype" id="2214255">float64</span><span class="op" id="2214262">(</span><span class="ident" id="2214263">j</span><span class="op" id="2214264">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214271">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2214311">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214335">if</span>&nbsp;<span class="ident" id="2214338">j</span><span class="op" id="2214339">&amp;</span><span class="num" id="2214340">1</span>&nbsp;<span class="op" id="2214342">==</span>&nbsp;<span class="num" id="2214345">1</span>&nbsp;<span class="op" id="2214347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214351">j</span>&nbsp;<span class="op" id="2214353">+=</span>&nbsp;<span class="num" id="2214356">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214360">y</span>&nbsp;<span class="op" id="2214362">+=</span>&nbsp;<span class="num" id="2214365">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214371">j</span>&nbsp;<span class="op" id="2214373">&amp;=</span>&nbsp;<span class="num" id="2214376">7</span>&nbsp;<span class="comment" id="2214378">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2214422">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214444">if</span>&nbsp;<span class="ident" id="2214447">j</span>&nbsp;<span class="op" id="2214449">&gt;</span>&nbsp;<span class="num" id="2214451">3</span>&nbsp;<span class="op" id="2214453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214457">sign</span>&nbsp;<span class="op" id="2214462">=</span>&nbsp;<span class="op" id="2214464">!</span><span class="ident" id="2214465">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214472">j</span>&nbsp;<span class="op" id="2214474">-=</span>&nbsp;<span class="num" id="2214477">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214484">z</span>&nbsp;<span class="op" id="2214486">:=</span>&nbsp;<span class="op" id="2214489">(</span><span class="op" id="2214490">(</span><span class="ident" id="2214491">x</span>&nbsp;<span class="op" id="2214493">-</span>&nbsp;<span class="ident" id="2214495">y</span><span class="op" id="2214496">*</span><span class="ident" id="2214497">PI4A</span><span class="op" id="2214501">)</span>&nbsp;<span class="op" id="2214503">-</span>&nbsp;<span class="ident" id="2214505">y</span><span class="op" id="2214506">*</span><span class="ident" id="2214507">PI4B</span><span class="op" id="2214511">)</span>&nbsp;<span class="op" id="2214513">-</span>&nbsp;<span class="ident" id="2214515">y</span><span class="op" id="2214516">*</span><span class="ident" id="2214517">PI4C</span>&nbsp;<span class="comment" id="2214522">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214564">zz</span>&nbsp;<span class="op" id="2214567">:=</span>&nbsp;<span class="ident" id="2214570">z</span>&nbsp;<span class="op" id="2214572">*</span>&nbsp;<span class="ident" id="2214574">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214577">if</span>&nbsp;<span class="ident" id="2214580">j</span>&nbsp;<span class="op" id="2214582">==</span>&nbsp;<span class="num" id="2214585">1</span>&nbsp;<span class="op" id="2214587">||</span>&nbsp;<span class="ident" id="2214590">j</span>&nbsp;<span class="op" id="2214592">==</span>&nbsp;<span class="num" id="2214595">2</span>&nbsp;<span class="op" id="2214597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214601">y</span>&nbsp;<span class="op" id="2214603">=</span>&nbsp;<span class="num" id="2214605">1.0</span>&nbsp;<span class="op" id="2214609">-</span>&nbsp;<span class="num" id="2214611">0.5</span><span class="op" id="2214614">*</span><span class="ident" id="2214615">zz</span>&nbsp;<span class="op" id="2214618">+</span>&nbsp;<span class="ident" id="2214620">zz</span><span class="op" id="2214622">*</span><span class="ident" id="2214623">zz</span><span class="op" id="2214625">*</span><span class="op" id="2214626">(</span><span class="op" id="2214627">(</span><span class="op" id="2214628">(</span><span class="op" id="2214629">(</span><span class="op" id="2214630">(</span><span class="op" id="2214631">(</span><span class="ident" id="2214632">_cos</span><span class="op" id="2214636">[</span><span class="num" id="2214637">0</span><span class="op" id="2214638">]</span><span class="op" id="2214639">*</span><span class="ident" id="2214640">zz</span><span class="op" id="2214642">)</span><span class="op" id="2214643">+</span><span class="ident" id="2214644">_cos</span><span class="op" id="2214648">[</span><span class="num" id="2214649">1</span><span class="op" id="2214650">]</span><span class="op" id="2214651">)</span><span class="op" id="2214652">*</span><span class="ident" id="2214653">zz</span><span class="op" id="2214655">+</span><span class="ident" id="2214656">_cos</span><span class="op" id="2214660">[</span><span class="num" id="2214661">2</span><span class="op" id="2214662">]</span><span class="op" id="2214663">)</span><span class="op" id="2214664">*</span><span class="ident" id="2214665">zz</span><span class="op" id="2214667">+</span><span class="ident" id="2214668">_cos</span><span class="op" id="2214672">[</span><span class="num" id="2214673">3</span><span class="op" id="2214674">]</span><span class="op" id="2214675">)</span><span class="op" id="2214676">*</span><span class="ident" id="2214677">zz</span><span class="op" id="2214679">+</span><span class="ident" id="2214680">_cos</span><span class="op" id="2214684">[</span><span class="num" id="2214685">4</span><span class="op" id="2214686">]</span><span class="op" id="2214687">)</span><span class="op" id="2214688">*</span><span class="ident" id="2214689">zz</span><span class="op" id="2214691">+</span><span class="ident" id="2214692">_cos</span><span class="op" id="2214696">[</span><span class="num" id="2214697">5</span><span class="op" id="2214698">]</span><span class="op" id="2214699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214702">}</span>&nbsp;<span class="keyword" id="2214704">else</span>&nbsp;<span class="op" id="2214709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214713">y</span>&nbsp;<span class="op" id="2214715">=</span>&nbsp;<span class="ident" id="2214717">z</span>&nbsp;<span class="op" id="2214719">+</span>&nbsp;<span class="ident" id="2214721">z</span><span class="op" id="2214722">*</span><span class="ident" id="2214723">zz</span><span class="op" id="2214725">*</span><span class="op" id="2214726">(</span><span class="op" id="2214727">(</span><span class="op" id="2214728">(</span><span class="op" id="2214729">(</span><span class="op" id="2214730">(</span><span class="op" id="2214731">(</span><span class="ident" id="2214732">_sin</span><span class="op" id="2214736">[</span><span class="num" id="2214737">0</span><span class="op" id="2214738">]</span><span class="op" id="2214739">*</span><span class="ident" id="2214740">zz</span><span class="op" id="2214742">)</span><span class="op" id="2214743">+</span><span class="ident" id="2214744">_sin</span><span class="op" id="2214748">[</span><span class="num" id="2214749">1</span><span class="op" id="2214750">]</span><span class="op" id="2214751">)</span><span class="op" id="2214752">*</span><span class="ident" id="2214753">zz</span><span class="op" id="2214755">+</span><span class="ident" id="2214756">_sin</span><span class="op" id="2214760">[</span><span class="num" id="2214761">2</span><span class="op" id="2214762">]</span><span class="op" id="2214763">)</span><span class="op" id="2214764">*</span><span class="ident" id="2214765">zz</span><span class="op" id="2214767">+</span><span class="ident" id="2214768">_sin</span><span class="op" id="2214772">[</span><span class="num" id="2214773">3</span><span class="op" id="2214774">]</span><span class="op" id="2214775">)</span><span class="op" id="2214776">*</span><span class="ident" id="2214777">zz</span><span class="op" id="2214779">+</span><span class="ident" id="2214780">_sin</span><span class="op" id="2214784">[</span><span class="num" id="2214785">4</span><span class="op" id="2214786">]</span><span class="op" id="2214787">)</span><span class="op" id="2214788">*</span><span class="ident" id="2214789">zz</span><span class="op" id="2214791">+</span><span class="ident" id="2214792">_sin</span><span class="op" id="2214796">[</span><span class="num" id="2214797">5</span><span class="op" id="2214798">]</span><span class="op" id="2214799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214802">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214805">if</span>&nbsp;<span class="ident" id="2214808">sign</span>&nbsp;<span class="op" id="2214813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214817">y</span>&nbsp;<span class="op" id="2214819">=</span>&nbsp;<span class="op" id="2214821">-</span><span class="ident" id="2214822">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214828">return</span>&nbsp;<span class="ident" id="2214835">y</span><br>
<span class="lineno"></span><span class="op" id="2214837">}</span>
</div>
</body>
</html>
