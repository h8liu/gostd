<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html" class="current">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4101573">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4101628">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4101682">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4101733">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4101808">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4101819">package</span>&nbsp;<span class="ident" id="4101827">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4101837">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4101912">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4101987">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4102067">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4102142">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4102216">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4102281">import</span>&nbsp;<span class="op" id="4102288">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4102291">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4102297">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4102309">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4102316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4102319">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4102383">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4102444">type</span>&nbsp;<span class="ident" id="4102449">Curve</span>&nbsp;<span class="keyword" id="4102455">interface</span>&nbsp;<span class="op" id="4102465">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102468">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102517">Params</span><span class="op" id="4102523">(</span><span class="op" id="4102524">)</span>&nbsp;<span class="op" id="4102526">*</span><span class="ident" id="4102527">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102540">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102605">IsOnCurve</span><span class="op" id="4102614">(</span><span class="ident" id="4102615">x</span><span class="op" id="4102616">,</span>&nbsp;<span class="ident" id="4102618">y</span>&nbsp;<span class="op" id="4102620">*</span><span class="ident" id="4102621">big</span><span class="op" id="4102624">.</span><span class="ident" id="4102625">Int</span><span class="op" id="4102628">)</span>&nbsp;<span class="builtintype" id="4102630">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102636">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102683">Add</span><span class="op" id="4102686">(</span><span class="ident" id="4102687">x1</span><span class="op" id="4102689">,</span>&nbsp;<span class="ident" id="4102691">y1</span><span class="op" id="4102693">,</span>&nbsp;<span class="ident" id="4102695">x2</span><span class="op" id="4102697">,</span>&nbsp;<span class="ident" id="4102699">y2</span>&nbsp;<span class="op" id="4102702">*</span><span class="ident" id="4102703">big</span><span class="op" id="4102706">.</span><span class="ident" id="4102707">Int</span><span class="op" id="4102710">)</span>&nbsp;<span class="op" id="4102712">(</span><span class="ident" id="4102713">x</span><span class="op" id="4102714">,</span>&nbsp;<span class="ident" id="4102716">y</span>&nbsp;<span class="op" id="4102718">*</span><span class="ident" id="4102719">big</span><span class="op" id="4102722">.</span><span class="ident" id="4102723">Int</span><span class="op" id="4102726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102729">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102756">Double</span><span class="op" id="4102762">(</span><span class="ident" id="4102763">x1</span><span class="op" id="4102765">,</span>&nbsp;<span class="ident" id="4102767">y1</span>&nbsp;<span class="op" id="4102770">*</span><span class="ident" id="4102771">big</span><span class="op" id="4102774">.</span><span class="ident" id="4102775">Int</span><span class="op" id="4102778">)</span>&nbsp;<span class="op" id="4102780">(</span><span class="ident" id="4102781">x</span><span class="op" id="4102782">,</span>&nbsp;<span class="ident" id="4102784">y</span>&nbsp;<span class="op" id="4102786">*</span><span class="ident" id="4102787">big</span><span class="op" id="4102790">.</span><span class="ident" id="4102791">Int</span><span class="op" id="4102794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102797">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102870">ScalarMult</span><span class="op" id="4102880">(</span><span class="ident" id="4102881">x1</span><span class="op" id="4102883">,</span>&nbsp;<span class="ident" id="4102885">y1</span>&nbsp;<span class="op" id="4102888">*</span><span class="ident" id="4102889">big</span><span class="op" id="4102892">.</span><span class="ident" id="4102893">Int</span><span class="op" id="4102896">,</span>&nbsp;<span class="ident" id="4102898">k</span>&nbsp;<span class="op" id="4102900">[</span><span class="op" id="4102901">]</span><span class="builtintype" id="4102902">byte</span><span class="op" id="4102906">)</span>&nbsp;<span class="op" id="4102908">(</span><span class="ident" id="4102909">x</span><span class="op" id="4102910">,</span>&nbsp;<span class="ident" id="4102912">y</span>&nbsp;<span class="op" id="4102914">*</span><span class="ident" id="4102915">big</span><span class="op" id="4102918">.</span><span class="ident" id="4102919">Int</span><span class="op" id="4102922">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102925">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102996">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103040">ScalarBaseMult</span><span class="op" id="4103054">(</span><span class="ident" id="4103055">k</span>&nbsp;<span class="op" id="4103057">[</span><span class="op" id="4103058">]</span><span class="builtintype" id="4103059">byte</span><span class="op" id="4103063">)</span>&nbsp;<span class="op" id="4103065">(</span><span class="ident" id="4103066">x</span><span class="op" id="4103067">,</span>&nbsp;<span class="ident" id="4103069">y</span>&nbsp;<span class="op" id="4103071">*</span><span class="ident" id="4103072">big</span><span class="op" id="4103075">.</span><span class="ident" id="4103076">Int</span><span class="op" id="4103079">)</span><br>
<span class="lineno"></span><span class="op" id="4103081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4103084">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4103162">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4103219">type</span>&nbsp;<span class="ident" id="4103224">CurveParams</span>&nbsp;<span class="keyword" id="4103236">struct</span>&nbsp;<span class="op" id="4103243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103246">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103254">*</span><span class="ident" id="4103255">big</span><span class="op" id="4103258">.</span><span class="ident" id="4103259">Int</span>&nbsp;<span class="comment" id="4103263">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103301">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103309">*</span><span class="ident" id="4103310">big</span><span class="op" id="4103313">.</span><span class="ident" id="4103314">Int</span>&nbsp;<span class="comment" id="4103318">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103350">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103358">*</span><span class="ident" id="4103359">big</span><span class="op" id="4103362">.</span><span class="ident" id="4103363">Int</span>&nbsp;<span class="comment" id="4103367">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103406">Gx</span><span class="op" id="4103408">,</span>&nbsp;<span class="ident" id="4103410">Gy</span>&nbsp;&nbsp;<span class="op" id="4103414">*</span><span class="ident" id="4103415">big</span><span class="op" id="4103418">.</span><span class="ident" id="4103419">Int</span>&nbsp;<span class="comment" id="4103423">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103451">BitSize</span>&nbsp;<span class="builtintype" id="4103459">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103468">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4103504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4103507">func</span>&nbsp;<span class="op" id="4103512">(</span><span class="ident" id="4103513">curve</span>&nbsp;<span class="op" id="4103519">*</span><span class="ident" id="4103520">CurveParams</span><span class="op" id="4103531">)</span>&nbsp;<span class="ident" id="4103533">Params</span><span class="op" id="4103539">(</span><span class="op" id="4103540">)</span>&nbsp;<span class="op" id="4103542">*</span><span class="ident" id="4103543">CurveParams</span>&nbsp;<span class="op" id="4103555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103558">return</span>&nbsp;<span class="ident" id="4103565">curve</span><br>
<span class="lineno"></span><span class="op" id="4103571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4103574">func</span>&nbsp;<span class="op" id="4103579">(</span><span class="ident" id="4103580">curve</span>&nbsp;<span class="op" id="4103586">*</span><span class="ident" id="4103587">CurveParams</span><span class="op" id="4103598">)</span>&nbsp;<span class="ident" id="4103600">IsOnCurve</span><span class="op" id="4103609">(</span><span class="ident" id="4103610">x</span><span class="op" id="4103611">,</span>&nbsp;<span class="ident" id="4103613">y</span>&nbsp;<span class="op" id="4103615">*</span><span class="ident" id="4103616">big</span><span class="op" id="4103619">.</span><span class="ident" id="4103620">Int</span><span class="op" id="4103623">)</span>&nbsp;<span class="builtintype" id="4103625">bool</span>&nbsp;<span class="op" id="4103630">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103633">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103656">y2</span>&nbsp;<span class="op" id="4103659">:=</span>&nbsp;<span class="builtinfunc" id="4103662">new</span><span class="op" id="4103665">(</span><span class="ident" id="4103666">big</span><span class="op" id="4103669">.</span><span class="ident" id="4103670">Int</span><span class="op" id="4103673">)</span><span class="op" id="4103674">.</span><span class="ident" id="4103675">Mul</span><span class="op" id="4103678">(</span><span class="ident" id="4103679">y</span><span class="op" id="4103680">,</span>&nbsp;<span class="ident" id="4103682">y</span><span class="op" id="4103683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103686">y2</span><span class="op" id="4103688">.</span><span class="ident" id="4103689">Mod</span><span class="op" id="4103692">(</span><span class="ident" id="4103693">y2</span><span class="op" id="4103695">,</span>&nbsp;<span class="ident" id="4103697">curve</span><span class="op" id="4103702">.</span><span class="ident" id="4103703">P</span><span class="op" id="4103704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103708">x3</span>&nbsp;<span class="op" id="4103711">:=</span>&nbsp;<span class="builtinfunc" id="4103714">new</span><span class="op" id="4103717">(</span><span class="ident" id="4103718">big</span><span class="op" id="4103721">.</span><span class="ident" id="4103722">Int</span><span class="op" id="4103725">)</span><span class="op" id="4103726">.</span><span class="ident" id="4103727">Mul</span><span class="op" id="4103730">(</span><span class="ident" id="4103731">x</span><span class="op" id="4103732">,</span>&nbsp;<span class="ident" id="4103734">x</span><span class="op" id="4103735">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103738">x3</span><span class="op" id="4103740">.</span><span class="ident" id="4103741">Mul</span><span class="op" id="4103744">(</span><span class="ident" id="4103745">x3</span><span class="op" id="4103747">,</span>&nbsp;<span class="ident" id="4103749">x</span><span class="op" id="4103750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103754">threeX</span>&nbsp;<span class="op" id="4103761">:=</span>&nbsp;<span class="builtinfunc" id="4103764">new</span><span class="op" id="4103767">(</span><span class="ident" id="4103768">big</span><span class="op" id="4103771">.</span><span class="ident" id="4103772">Int</span><span class="op" id="4103775">)</span><span class="op" id="4103776">.</span><span class="ident" id="4103777">Lsh</span><span class="op" id="4103780">(</span><span class="ident" id="4103781">x</span><span class="op" id="4103782">,</span>&nbsp;<span class="num" id="4103784">1</span><span class="op" id="4103785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103788">threeX</span><span class="op" id="4103794">.</span><span class="ident" id="4103795">Add</span><span class="op" id="4103798">(</span><span class="ident" id="4103799">threeX</span><span class="op" id="4103805">,</span>&nbsp;<span class="ident" id="4103807">x</span><span class="op" id="4103808">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103812">x3</span><span class="op" id="4103814">.</span><span class="ident" id="4103815">Sub</span><span class="op" id="4103818">(</span><span class="ident" id="4103819">x3</span><span class="op" id="4103821">,</span>&nbsp;<span class="ident" id="4103823">threeX</span><span class="op" id="4103829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103832">x3</span><span class="op" id="4103834">.</span><span class="ident" id="4103835">Add</span><span class="op" id="4103838">(</span><span class="ident" id="4103839">x3</span><span class="op" id="4103841">,</span>&nbsp;<span class="ident" id="4103843">curve</span><span class="op" id="4103848">.</span><span class="ident" id="4103849">B</span><span class="op" id="4103850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103853">x3</span><span class="op" id="4103855">.</span><span class="ident" id="4103856">Mod</span><span class="op" id="4103859">(</span><span class="ident" id="4103860">x3</span><span class="op" id="4103862">,</span>&nbsp;<span class="ident" id="4103864">curve</span><span class="op" id="4103869">.</span><span class="ident" id="4103870">P</span><span class="op" id="4103871">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103875">return</span>&nbsp;<span class="ident" id="4103882">x3</span><span class="op" id="4103884">.</span><span class="ident" id="4103885">Cmp</span><span class="op" id="4103888">(</span><span class="ident" id="4103889">y2</span><span class="op" id="4103891">)</span>&nbsp;<span class="op" id="4103893">==</span>&nbsp;<span class="num" id="4103896">0</span><br>
<span class="lineno">70</span><span class="op" id="4103898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4103901">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4103980">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4104060">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4104112">func</span>&nbsp;<span class="ident" id="4104117">zForAffine</span><span class="op" id="4104127">(</span><span class="ident" id="4104128">x</span><span class="op" id="4104129">,</span>&nbsp;<span class="ident" id="4104131">y</span>&nbsp;<span class="op" id="4104133">*</span><span class="ident" id="4104134">big</span><span class="op" id="4104137">.</span><span class="ident" id="4104138">Int</span><span class="op" id="4104141">)</span>&nbsp;<span class="op" id="4104143">*</span><span class="ident" id="4104144">big</span><span class="op" id="4104147">.</span><span class="ident" id="4104148">Int</span>&nbsp;<span class="op" id="4104152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104155">z</span>&nbsp;<span class="op" id="4104157">:=</span>&nbsp;<span class="builtinfunc" id="4104160">new</span><span class="op" id="4104163">(</span><span class="ident" id="4104164">big</span><span class="op" id="4104167">.</span><span class="ident" id="4104168">Int</span><span class="op" id="4104171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104174">if</span>&nbsp;<span class="ident" id="4104177">x</span><span class="op" id="4104178">.</span><span class="ident" id="4104179">Sign</span><span class="op" id="4104183">(</span><span class="op" id="4104184">)</span>&nbsp;<span class="op" id="4104186">!=</span>&nbsp;<span class="num" id="4104189">0</span>&nbsp;<span class="op" id="4104191">||</span>&nbsp;<span class="ident" id="4104194">y</span><span class="op" id="4104195">.</span><span class="ident" id="4104196">Sign</span><span class="op" id="4104200">(</span><span class="op" id="4104201">)</span>&nbsp;<span class="op" id="4104203">!=</span>&nbsp;<span class="num" id="4104206">0</span>&nbsp;<span class="op" id="4104208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104212">z</span><span class="op" id="4104213">.</span><span class="ident" id="4104214">SetInt64</span><span class="op" id="4104222">(</span><span class="num" id="4104223">1</span><span class="op" id="4104224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104227">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104230">return</span>&nbsp;<span class="ident" id="4104237">z</span><br>
<span class="lineno"></span><span class="op" id="4104239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4104242">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4104320">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4104377">func</span>&nbsp;<span class="op" id="4104382">(</span><span class="ident" id="4104383">curve</span>&nbsp;<span class="op" id="4104389">*</span><span class="ident" id="4104390">CurveParams</span><span class="op" id="4104401">)</span>&nbsp;<span class="ident" id="4104403">affineFromJacobian</span><span class="op" id="4104421">(</span><span class="ident" id="4104422">x</span><span class="op" id="4104423">,</span>&nbsp;<span class="ident" id="4104425">y</span><span class="op" id="4104426">,</span>&nbsp;<span class="ident" id="4104428">z</span>&nbsp;<span class="op" id="4104430">*</span><span class="ident" id="4104431">big</span><span class="op" id="4104434">.</span><span class="ident" id="4104435">Int</span><span class="op" id="4104438">)</span>&nbsp;<span class="op" id="4104440">(</span><span class="ident" id="4104441">xOut</span><span class="op" id="4104445">,</span>&nbsp;<span class="ident" id="4104447">yOut</span>&nbsp;<span class="op" id="4104452">*</span><span class="ident" id="4104453">big</span><span class="op" id="4104456">.</span><span class="ident" id="4104457">Int</span><span class="op" id="4104460">)</span>&nbsp;<span class="op" id="4104462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104465">if</span>&nbsp;<span class="ident" id="4104468">z</span><span class="op" id="4104469">.</span><span class="ident" id="4104470">Sign</span><span class="op" id="4104474">(</span><span class="op" id="4104475">)</span>&nbsp;<span class="op" id="4104477">==</span>&nbsp;<span class="num" id="4104480">0</span>&nbsp;<span class="op" id="4104482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104486">return</span>&nbsp;<span class="builtinfunc" id="4104493">new</span><span class="op" id="4104496">(</span><span class="ident" id="4104497">big</span><span class="op" id="4104500">.</span><span class="ident" id="4104501">Int</span><span class="op" id="4104504">)</span><span class="op" id="4104505">,</span>&nbsp;<span class="builtinfunc" id="4104507">new</span><span class="op" id="4104510">(</span><span class="ident" id="4104511">big</span><span class="op" id="4104514">.</span><span class="ident" id="4104515">Int</span><span class="op" id="4104518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104525">zinv</span>&nbsp;<span class="op" id="4104530">:=</span>&nbsp;<span class="builtinfunc" id="4104533">new</span><span class="op" id="4104536">(</span><span class="ident" id="4104537">big</span><span class="op" id="4104540">.</span><span class="ident" id="4104541">Int</span><span class="op" id="4104544">)</span><span class="op" id="4104545">.</span><span class="ident" id="4104546">ModInverse</span><span class="op" id="4104556">(</span><span class="ident" id="4104557">z</span><span class="op" id="4104558">,</span>&nbsp;<span class="ident" id="4104560">curve</span><span class="op" id="4104565">.</span><span class="ident" id="4104566">P</span><span class="op" id="4104567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104570">zinvsq</span>&nbsp;<span class="op" id="4104577">:=</span>&nbsp;<span class="builtinfunc" id="4104580">new</span><span class="op" id="4104583">(</span><span class="ident" id="4104584">big</span><span class="op" id="4104587">.</span><span class="ident" id="4104588">Int</span><span class="op" id="4104591">)</span><span class="op" id="4104592">.</span><span class="ident" id="4104593">Mul</span><span class="op" id="4104596">(</span><span class="ident" id="4104597">zinv</span><span class="op" id="4104601">,</span>&nbsp;<span class="ident" id="4104603">zinv</span><span class="op" id="4104607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104611">xOut</span>&nbsp;<span class="op" id="4104616">=</span>&nbsp;<span class="builtinfunc" id="4104618">new</span><span class="op" id="4104621">(</span><span class="ident" id="4104622">big</span><span class="op" id="4104625">.</span><span class="ident" id="4104626">Int</span><span class="op" id="4104629">)</span><span class="op" id="4104630">.</span><span class="ident" id="4104631">Mul</span><span class="op" id="4104634">(</span><span class="ident" id="4104635">x</span><span class="op" id="4104636">,</span>&nbsp;<span class="ident" id="4104638">zinvsq</span><span class="op" id="4104644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104647">xOut</span><span class="op" id="4104651">.</span><span class="ident" id="4104652">Mod</span><span class="op" id="4104655">(</span><span class="ident" id="4104656">xOut</span><span class="op" id="4104660">,</span>&nbsp;<span class="ident" id="4104662">curve</span><span class="op" id="4104667">.</span><span class="ident" id="4104668">P</span><span class="op" id="4104669">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104672">zinvsq</span><span class="op" id="4104678">.</span><span class="ident" id="4104679">Mul</span><span class="op" id="4104682">(</span><span class="ident" id="4104683">zinvsq</span><span class="op" id="4104689">,</span>&nbsp;<span class="ident" id="4104691">zinv</span><span class="op" id="4104695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104698">yOut</span>&nbsp;<span class="op" id="4104703">=</span>&nbsp;<span class="builtinfunc" id="4104705">new</span><span class="op" id="4104708">(</span><span class="ident" id="4104709">big</span><span class="op" id="4104712">.</span><span class="ident" id="4104713">Int</span><span class="op" id="4104716">)</span><span class="op" id="4104717">.</span><span class="ident" id="4104718">Mul</span><span class="op" id="4104721">(</span><span class="ident" id="4104722">y</span><span class="op" id="4104723">,</span>&nbsp;<span class="ident" id="4104725">zinvsq</span><span class="op" id="4104731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104734">yOut</span><span class="op" id="4104738">.</span><span class="ident" id="4104739">Mod</span><span class="op" id="4104742">(</span><span class="ident" id="4104743">yOut</span><span class="op" id="4104747">,</span>&nbsp;<span class="ident" id="4104749">curve</span><span class="op" id="4104754">.</span><span class="ident" id="4104755">P</span><span class="op" id="4104756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104759">return</span><br>
<span class="lineno"></span><span class="op" id="4104766">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4104769">func</span>&nbsp;<span class="op" id="4104774">(</span><span class="ident" id="4104775">curve</span>&nbsp;<span class="op" id="4104781">*</span><span class="ident" id="4104782">CurveParams</span><span class="op" id="4104793">)</span>&nbsp;<span class="ident" id="4104795">Add</span><span class="op" id="4104798">(</span><span class="ident" id="4104799">x1</span><span class="op" id="4104801">,</span>&nbsp;<span class="ident" id="4104803">y1</span><span class="op" id="4104805">,</span>&nbsp;<span class="ident" id="4104807">x2</span><span class="op" id="4104809">,</span>&nbsp;<span class="ident" id="4104811">y2</span>&nbsp;<span class="op" id="4104814">*</span><span class="ident" id="4104815">big</span><span class="op" id="4104818">.</span><span class="ident" id="4104819">Int</span><span class="op" id="4104822">)</span>&nbsp;<span class="op" id="4104824">(</span><span class="op" id="4104825">*</span><span class="ident" id="4104826">big</span><span class="op" id="4104829">.</span><span class="ident" id="4104830">Int</span><span class="op" id="4104833">,</span>&nbsp;<span class="op" id="4104835">*</span><span class="ident" id="4104836">big</span><span class="op" id="4104839">.</span><span class="ident" id="4104840">Int</span><span class="op" id="4104843">)</span>&nbsp;<span class="op" id="4104845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104848">z1</span>&nbsp;<span class="op" id="4104851">:=</span>&nbsp;<span class="ident" id="4104854">zForAffine</span><span class="op" id="4104864">(</span><span class="ident" id="4104865">x1</span><span class="op" id="4104867">,</span>&nbsp;<span class="ident" id="4104869">y1</span><span class="op" id="4104871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104874">z2</span>&nbsp;<span class="op" id="4104877">:=</span>&nbsp;<span class="ident" id="4104880">zForAffine</span><span class="op" id="4104890">(</span><span class="ident" id="4104891">x2</span><span class="op" id="4104893">,</span>&nbsp;<span class="ident" id="4104895">y2</span><span class="op" id="4104897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104900">return</span>&nbsp;<span class="ident" id="4104907">curve</span><span class="op" id="4104912">.</span><span class="ident" id="4104913">affineFromJacobian</span><span class="op" id="4104931">(</span><span class="ident" id="4104932">curve</span><span class="op" id="4104937">.</span><span class="ident" id="4104938">addJacobian</span><span class="op" id="4104949">(</span><span class="ident" id="4104950">x1</span><span class="op" id="4104952">,</span>&nbsp;<span class="ident" id="4104954">y1</span><span class="op" id="4104956">,</span>&nbsp;<span class="ident" id="4104958">z1</span><span class="op" id="4104960">,</span>&nbsp;<span class="ident" id="4104962">x2</span><span class="op" id="4104964">,</span>&nbsp;<span class="ident" id="4104966">y2</span><span class="op" id="4104968">,</span>&nbsp;<span class="ident" id="4104970">z2</span><span class="op" id="4104972">)</span><span class="op" id="4104973">)</span><br>
<span class="lineno">105</span><span class="op" id="4104975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4104978">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4105052">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4105114">func</span>&nbsp;<span class="op" id="4105119">(</span><span class="ident" id="4105120">curve</span>&nbsp;<span class="op" id="4105126">*</span><span class="ident" id="4105127">CurveParams</span><span class="op" id="4105138">)</span>&nbsp;<span class="ident" id="4105140">addJacobian</span><span class="op" id="4105151">(</span><span class="ident" id="4105152">x1</span><span class="op" id="4105154">,</span>&nbsp;<span class="ident" id="4105156">y1</span><span class="op" id="4105158">,</span>&nbsp;<span class="ident" id="4105160">z1</span><span class="op" id="4105162">,</span>&nbsp;<span class="ident" id="4105164">x2</span><span class="op" id="4105166">,</span>&nbsp;<span class="ident" id="4105168">y2</span><span class="op" id="4105170">,</span>&nbsp;<span class="ident" id="4105172">z2</span>&nbsp;<span class="op" id="4105175">*</span><span class="ident" id="4105176">big</span><span class="op" id="4105179">.</span><span class="ident" id="4105180">Int</span><span class="op" id="4105183">)</span>&nbsp;<span class="op" id="4105185">(</span><span class="op" id="4105186">*</span><span class="ident" id="4105187">big</span><span class="op" id="4105190">.</span><span class="ident" id="4105191">Int</span><span class="op" id="4105194">,</span>&nbsp;<span class="op" id="4105196">*</span><span class="ident" id="4105197">big</span><span class="op" id="4105200">.</span><span class="ident" id="4105201">Int</span><span class="op" id="4105204">,</span>&nbsp;<span class="op" id="4105206">*</span><span class="ident" id="4105207">big</span><span class="op" id="4105210">.</span><span class="ident" id="4105211">Int</span><span class="op" id="4105214">)</span>&nbsp;<span class="op" id="4105216">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4105219">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105309">x3</span><span class="op" id="4105311">,</span>&nbsp;<span class="ident" id="4105313">y3</span><span class="op" id="4105315">,</span>&nbsp;<span class="ident" id="4105317">z3</span>&nbsp;<span class="op" id="4105320">:=</span>&nbsp;<span class="builtinfunc" id="4105323">new</span><span class="op" id="4105326">(</span><span class="ident" id="4105327">big</span><span class="op" id="4105330">.</span><span class="ident" id="4105331">Int</span><span class="op" id="4105334">)</span><span class="op" id="4105335">,</span>&nbsp;<span class="builtinfunc" id="4105337">new</span><span class="op" id="4105340">(</span><span class="ident" id="4105341">big</span><span class="op" id="4105344">.</span><span class="ident" id="4105345">Int</span><span class="op" id="4105348">)</span><span class="op" id="4105349">,</span>&nbsp;<span class="builtinfunc" id="4105351">new</span><span class="op" id="4105354">(</span><span class="ident" id="4105355">big</span><span class="op" id="4105358">.</span><span class="ident" id="4105359">Int</span><span class="op" id="4105362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105365">if</span>&nbsp;<span class="ident" id="4105368">z1</span><span class="op" id="4105370">.</span><span class="ident" id="4105371">Sign</span><span class="op" id="4105375">(</span><span class="op" id="4105376">)</span>&nbsp;<span class="op" id="4105378">==</span>&nbsp;<span class="num" id="4105381">0</span>&nbsp;<span class="op" id="4105383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105387">x3</span><span class="op" id="4105389">.</span><span class="ident" id="4105390">Set</span><span class="op" id="4105393">(</span><span class="ident" id="4105394">x2</span><span class="op" id="4105396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105400">y3</span><span class="op" id="4105402">.</span><span class="ident" id="4105403">Set</span><span class="op" id="4105406">(</span><span class="ident" id="4105407">y2</span><span class="op" id="4105409">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105413">z3</span><span class="op" id="4105415">.</span><span class="ident" id="4105416">Set</span><span class="op" id="4105419">(</span><span class="ident" id="4105420">z2</span><span class="op" id="4105422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105426">return</span>&nbsp;<span class="ident" id="4105433">x3</span><span class="op" id="4105435">,</span>&nbsp;<span class="ident" id="4105437">y3</span><span class="op" id="4105439">,</span>&nbsp;<span class="ident" id="4105441">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105448">if</span>&nbsp;<span class="ident" id="4105451">z2</span><span class="op" id="4105453">.</span><span class="ident" id="4105454">Sign</span><span class="op" id="4105458">(</span><span class="op" id="4105459">)</span>&nbsp;<span class="op" id="4105461">==</span>&nbsp;<span class="num" id="4105464">0</span>&nbsp;<span class="op" id="4105466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105470">x3</span><span class="op" id="4105472">.</span><span class="ident" id="4105473">Set</span><span class="op" id="4105476">(</span><span class="ident" id="4105477">x1</span><span class="op" id="4105479">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105483">y3</span><span class="op" id="4105485">.</span><span class="ident" id="4105486">Set</span><span class="op" id="4105489">(</span><span class="ident" id="4105490">y1</span><span class="op" id="4105492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105496">z3</span><span class="op" id="4105498">.</span><span class="ident" id="4105499">Set</span><span class="op" id="4105502">(</span><span class="ident" id="4105503">z1</span><span class="op" id="4105505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105509">return</span>&nbsp;<span class="ident" id="4105516">x3</span><span class="op" id="4105518">,</span>&nbsp;<span class="ident" id="4105520">y3</span><span class="op" id="4105522">,</span>&nbsp;<span class="ident" id="4105524">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105532">z1z1</span>&nbsp;<span class="op" id="4105537">:=</span>&nbsp;<span class="builtinfunc" id="4105540">new</span><span class="op" id="4105543">(</span><span class="ident" id="4105544">big</span><span class="op" id="4105547">.</span><span class="ident" id="4105548">Int</span><span class="op" id="4105551">)</span><span class="op" id="4105552">.</span><span class="ident" id="4105553">Mul</span><span class="op" id="4105556">(</span><span class="ident" id="4105557">z1</span><span class="op" id="4105559">,</span>&nbsp;<span class="ident" id="4105561">z1</span><span class="op" id="4105563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105566">z1z1</span><span class="op" id="4105570">.</span><span class="ident" id="4105571">Mod</span><span class="op" id="4105574">(</span><span class="ident" id="4105575">z1z1</span><span class="op" id="4105579">,</span>&nbsp;<span class="ident" id="4105581">curve</span><span class="op" id="4105586">.</span><span class="ident" id="4105587">P</span><span class="op" id="4105588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105591">z2z2</span>&nbsp;<span class="op" id="4105596">:=</span>&nbsp;<span class="builtinfunc" id="4105599">new</span><span class="op" id="4105602">(</span><span class="ident" id="4105603">big</span><span class="op" id="4105606">.</span><span class="ident" id="4105607">Int</span><span class="op" id="4105610">)</span><span class="op" id="4105611">.</span><span class="ident" id="4105612">Mul</span><span class="op" id="4105615">(</span><span class="ident" id="4105616">z2</span><span class="op" id="4105618">,</span>&nbsp;<span class="ident" id="4105620">z2</span><span class="op" id="4105622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105625">z2z2</span><span class="op" id="4105629">.</span><span class="ident" id="4105630">Mod</span><span class="op" id="4105633">(</span><span class="ident" id="4105634">z2z2</span><span class="op" id="4105638">,</span>&nbsp;<span class="ident" id="4105640">curve</span><span class="op" id="4105645">.</span><span class="ident" id="4105646">P</span><span class="op" id="4105647">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105651">u1</span>&nbsp;<span class="op" id="4105654">:=</span>&nbsp;<span class="builtinfunc" id="4105657">new</span><span class="op" id="4105660">(</span><span class="ident" id="4105661">big</span><span class="op" id="4105664">.</span><span class="ident" id="4105665">Int</span><span class="op" id="4105668">)</span><span class="op" id="4105669">.</span><span class="ident" id="4105670">Mul</span><span class="op" id="4105673">(</span><span class="ident" id="4105674">x1</span><span class="op" id="4105676">,</span>&nbsp;<span class="ident" id="4105678">z2z2</span><span class="op" id="4105682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105685">u1</span><span class="op" id="4105687">.</span><span class="ident" id="4105688">Mod</span><span class="op" id="4105691">(</span><span class="ident" id="4105692">u1</span><span class="op" id="4105694">,</span>&nbsp;<span class="ident" id="4105696">curve</span><span class="op" id="4105701">.</span><span class="ident" id="4105702">P</span><span class="op" id="4105703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105706">u2</span>&nbsp;<span class="op" id="4105709">:=</span>&nbsp;<span class="builtinfunc" id="4105712">new</span><span class="op" id="4105715">(</span><span class="ident" id="4105716">big</span><span class="op" id="4105719">.</span><span class="ident" id="4105720">Int</span><span class="op" id="4105723">)</span><span class="op" id="4105724">.</span><span class="ident" id="4105725">Mul</span><span class="op" id="4105728">(</span><span class="ident" id="4105729">x2</span><span class="op" id="4105731">,</span>&nbsp;<span class="ident" id="4105733">z1z1</span><span class="op" id="4105737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105740">u2</span><span class="op" id="4105742">.</span><span class="ident" id="4105743">Mod</span><span class="op" id="4105746">(</span><span class="ident" id="4105747">u2</span><span class="op" id="4105749">,</span>&nbsp;<span class="ident" id="4105751">curve</span><span class="op" id="4105756">.</span><span class="ident" id="4105757">P</span><span class="op" id="4105758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105761">h</span>&nbsp;<span class="op" id="4105763">:=</span>&nbsp;<span class="builtinfunc" id="4105766">new</span><span class="op" id="4105769">(</span><span class="ident" id="4105770">big</span><span class="op" id="4105773">.</span><span class="ident" id="4105774">Int</span><span class="op" id="4105777">)</span><span class="op" id="4105778">.</span><span class="ident" id="4105779">Sub</span><span class="op" id="4105782">(</span><span class="ident" id="4105783">u2</span><span class="op" id="4105785">,</span>&nbsp;<span class="ident" id="4105787">u1</span><span class="op" id="4105789">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105792">xEqual</span>&nbsp;<span class="op" id="4105799">:=</span>&nbsp;<span class="ident" id="4105802">h</span><span class="op" id="4105803">.</span><span class="ident" id="4105804">Sign</span><span class="op" id="4105808">(</span><span class="op" id="4105809">)</span>&nbsp;<span class="op" id="4105811">==</span>&nbsp;<span class="num" id="4105814">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105817">if</span>&nbsp;<span class="ident" id="4105820">h</span><span class="op" id="4105821">.</span><span class="ident" id="4105822">Sign</span><span class="op" id="4105826">(</span><span class="op" id="4105827">)</span>&nbsp;<span class="op" id="4105829">==</span>&nbsp;<span class="op" id="4105832">-</span><span class="num" id="4105833">1</span>&nbsp;<span class="op" id="4105835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105839">h</span><span class="op" id="4105840">.</span><span class="ident" id="4105841">Add</span><span class="op" id="4105844">(</span><span class="ident" id="4105845">h</span><span class="op" id="4105846">,</span>&nbsp;<span class="ident" id="4105848">curve</span><span class="op" id="4105853">.</span><span class="ident" id="4105854">P</span><span class="op" id="4105855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105861">i</span>&nbsp;<span class="op" id="4105863">:=</span>&nbsp;<span class="builtinfunc" id="4105866">new</span><span class="op" id="4105869">(</span><span class="ident" id="4105870">big</span><span class="op" id="4105873">.</span><span class="ident" id="4105874">Int</span><span class="op" id="4105877">)</span><span class="op" id="4105878">.</span><span class="ident" id="4105879">Lsh</span><span class="op" id="4105882">(</span><span class="ident" id="4105883">h</span><span class="op" id="4105884">,</span>&nbsp;<span class="num" id="4105886">1</span><span class="op" id="4105887">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105890">i</span><span class="op" id="4105891">.</span><span class="ident" id="4105892">Mul</span><span class="op" id="4105895">(</span><span class="ident" id="4105896">i</span><span class="op" id="4105897">,</span>&nbsp;<span class="ident" id="4105899">i</span><span class="op" id="4105900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105903">j</span>&nbsp;<span class="op" id="4105905">:=</span>&nbsp;<span class="builtinfunc" id="4105908">new</span><span class="op" id="4105911">(</span><span class="ident" id="4105912">big</span><span class="op" id="4105915">.</span><span class="ident" id="4105916">Int</span><span class="op" id="4105919">)</span><span class="op" id="4105920">.</span><span class="ident" id="4105921">Mul</span><span class="op" id="4105924">(</span><span class="ident" id="4105925">h</span><span class="op" id="4105926">,</span>&nbsp;<span class="ident" id="4105928">i</span><span class="op" id="4105929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105933">s1</span>&nbsp;<span class="op" id="4105936">:=</span>&nbsp;<span class="builtinfunc" id="4105939">new</span><span class="op" id="4105942">(</span><span class="ident" id="4105943">big</span><span class="op" id="4105946">.</span><span class="ident" id="4105947">Int</span><span class="op" id="4105950">)</span><span class="op" id="4105951">.</span><span class="ident" id="4105952">Mul</span><span class="op" id="4105955">(</span><span class="ident" id="4105956">y1</span><span class="op" id="4105958">,</span>&nbsp;<span class="ident" id="4105960">z2</span><span class="op" id="4105962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105965">s1</span><span class="op" id="4105967">.</span><span class="ident" id="4105968">Mul</span><span class="op" id="4105971">(</span><span class="ident" id="4105972">s1</span><span class="op" id="4105974">,</span>&nbsp;<span class="ident" id="4105976">z2z2</span><span class="op" id="4105980">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105983">s1</span><span class="op" id="4105985">.</span><span class="ident" id="4105986">Mod</span><span class="op" id="4105989">(</span><span class="ident" id="4105990">s1</span><span class="op" id="4105992">,</span>&nbsp;<span class="ident" id="4105994">curve</span><span class="op" id="4105999">.</span><span class="ident" id="4106000">P</span><span class="op" id="4106001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106004">s2</span>&nbsp;<span class="op" id="4106007">:=</span>&nbsp;<span class="builtinfunc" id="4106010">new</span><span class="op" id="4106013">(</span><span class="ident" id="4106014">big</span><span class="op" id="4106017">.</span><span class="ident" id="4106018">Int</span><span class="op" id="4106021">)</span><span class="op" id="4106022">.</span><span class="ident" id="4106023">Mul</span><span class="op" id="4106026">(</span><span class="ident" id="4106027">y2</span><span class="op" id="4106029">,</span>&nbsp;<span class="ident" id="4106031">z1</span><span class="op" id="4106033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106036">s2</span><span class="op" id="4106038">.</span><span class="ident" id="4106039">Mul</span><span class="op" id="4106042">(</span><span class="ident" id="4106043">s2</span><span class="op" id="4106045">,</span>&nbsp;<span class="ident" id="4106047">z1z1</span><span class="op" id="4106051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106054">s2</span><span class="op" id="4106056">.</span><span class="ident" id="4106057">Mod</span><span class="op" id="4106060">(</span><span class="ident" id="4106061">s2</span><span class="op" id="4106063">,</span>&nbsp;<span class="ident" id="4106065">curve</span><span class="op" id="4106070">.</span><span class="ident" id="4106071">P</span><span class="op" id="4106072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106075">r</span>&nbsp;<span class="op" id="4106077">:=</span>&nbsp;<span class="builtinfunc" id="4106080">new</span><span class="op" id="4106083">(</span><span class="ident" id="4106084">big</span><span class="op" id="4106087">.</span><span class="ident" id="4106088">Int</span><span class="op" id="4106091">)</span><span class="op" id="4106092">.</span><span class="ident" id="4106093">Sub</span><span class="op" id="4106096">(</span><span class="ident" id="4106097">s2</span><span class="op" id="4106099">,</span>&nbsp;<span class="ident" id="4106101">s1</span><span class="op" id="4106103">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106106">if</span>&nbsp;<span class="ident" id="4106109">r</span><span class="op" id="4106110">.</span><span class="ident" id="4106111">Sign</span><span class="op" id="4106115">(</span><span class="op" id="4106116">)</span>&nbsp;<span class="op" id="4106118">==</span>&nbsp;<span class="op" id="4106121">-</span><span class="num" id="4106122">1</span>&nbsp;<span class="op" id="4106124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106128">r</span><span class="op" id="4106129">.</span><span class="ident" id="4106130">Add</span><span class="op" id="4106133">(</span><span class="ident" id="4106134">r</span><span class="op" id="4106135">,</span>&nbsp;<span class="ident" id="4106137">curve</span><span class="op" id="4106142">.</span><span class="ident" id="4106143">P</span><span class="op" id="4106144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106150">yEqual</span>&nbsp;<span class="op" id="4106157">:=</span>&nbsp;<span class="ident" id="4106160">r</span><span class="op" id="4106161">.</span><span class="ident" id="4106162">Sign</span><span class="op" id="4106166">(</span><span class="op" id="4106167">)</span>&nbsp;<span class="op" id="4106169">==</span>&nbsp;<span class="num" id="4106172">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106175">if</span>&nbsp;<span class="ident" id="4106178">xEqual</span>&nbsp;<span class="op" id="4106185">&amp;&amp;</span>&nbsp;<span class="ident" id="4106188">yEqual</span>&nbsp;<span class="op" id="4106195">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106199">return</span>&nbsp;<span class="ident" id="4106206">curve</span><span class="op" id="4106211">.</span><span class="ident" id="4106212">doubleJacobian</span><span class="op" id="4106226">(</span><span class="ident" id="4106227">x1</span><span class="op" id="4106229">,</span>&nbsp;<span class="ident" id="4106231">y1</span><span class="op" id="4106233">,</span>&nbsp;<span class="ident" id="4106235">z1</span><span class="op" id="4106237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106243">r</span><span class="op" id="4106244">.</span><span class="ident" id="4106245">Lsh</span><span class="op" id="4106248">(</span><span class="ident" id="4106249">r</span><span class="op" id="4106250">,</span>&nbsp;<span class="num" id="4106252">1</span><span class="op" id="4106253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106256">v</span>&nbsp;<span class="op" id="4106258">:=</span>&nbsp;<span class="builtinfunc" id="4106261">new</span><span class="op" id="4106264">(</span><span class="ident" id="4106265">big</span><span class="op" id="4106268">.</span><span class="ident" id="4106269">Int</span><span class="op" id="4106272">)</span><span class="op" id="4106273">.</span><span class="ident" id="4106274">Mul</span><span class="op" id="4106277">(</span><span class="ident" id="4106278">u1</span><span class="op" id="4106280">,</span>&nbsp;<span class="ident" id="4106282">i</span><span class="op" id="4106283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106287">x3</span><span class="op" id="4106289">.</span><span class="ident" id="4106290">Set</span><span class="op" id="4106293">(</span><span class="ident" id="4106294">r</span><span class="op" id="4106295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106298">x3</span><span class="op" id="4106300">.</span><span class="ident" id="4106301">Mul</span><span class="op" id="4106304">(</span><span class="ident" id="4106305">x3</span><span class="op" id="4106307">,</span>&nbsp;<span class="ident" id="4106309">x3</span><span class="op" id="4106311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106314">x3</span><span class="op" id="4106316">.</span><span class="ident" id="4106317">Sub</span><span class="op" id="4106320">(</span><span class="ident" id="4106321">x3</span><span class="op" id="4106323">,</span>&nbsp;<span class="ident" id="4106325">j</span><span class="op" id="4106326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106329">x3</span><span class="op" id="4106331">.</span><span class="ident" id="4106332">Sub</span><span class="op" id="4106335">(</span><span class="ident" id="4106336">x3</span><span class="op" id="4106338">,</span>&nbsp;<span class="ident" id="4106340">v</span><span class="op" id="4106341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106344">x3</span><span class="op" id="4106346">.</span><span class="ident" id="4106347">Sub</span><span class="op" id="4106350">(</span><span class="ident" id="4106351">x3</span><span class="op" id="4106353">,</span>&nbsp;<span class="ident" id="4106355">v</span><span class="op" id="4106356">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106359">x3</span><span class="op" id="4106361">.</span><span class="ident" id="4106362">Mod</span><span class="op" id="4106365">(</span><span class="ident" id="4106366">x3</span><span class="op" id="4106368">,</span>&nbsp;<span class="ident" id="4106370">curve</span><span class="op" id="4106375">.</span><span class="ident" id="4106376">P</span><span class="op" id="4106377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106381">y3</span><span class="op" id="4106383">.</span><span class="ident" id="4106384">Set</span><span class="op" id="4106387">(</span><span class="ident" id="4106388">r</span><span class="op" id="4106389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106392">v</span><span class="op" id="4106393">.</span><span class="ident" id="4106394">Sub</span><span class="op" id="4106397">(</span><span class="ident" id="4106398">v</span><span class="op" id="4106399">,</span>&nbsp;<span class="ident" id="4106401">x3</span><span class="op" id="4106403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106406">y3</span><span class="op" id="4106408">.</span><span class="ident" id="4106409">Mul</span><span class="op" id="4106412">(</span><span class="ident" id="4106413">y3</span><span class="op" id="4106415">,</span>&nbsp;<span class="ident" id="4106417">v</span><span class="op" id="4106418">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106421">s1</span><span class="op" id="4106423">.</span><span class="ident" id="4106424">Mul</span><span class="op" id="4106427">(</span><span class="ident" id="4106428">s1</span><span class="op" id="4106430">,</span>&nbsp;<span class="ident" id="4106432">j</span><span class="op" id="4106433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106436">s1</span><span class="op" id="4106438">.</span><span class="ident" id="4106439">Lsh</span><span class="op" id="4106442">(</span><span class="ident" id="4106443">s1</span><span class="op" id="4106445">,</span>&nbsp;<span class="num" id="4106447">1</span><span class="op" id="4106448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106451">y3</span><span class="op" id="4106453">.</span><span class="ident" id="4106454">Sub</span><span class="op" id="4106457">(</span><span class="ident" id="4106458">y3</span><span class="op" id="4106460">,</span>&nbsp;<span class="ident" id="4106462">s1</span><span class="op" id="4106464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106467">y3</span><span class="op" id="4106469">.</span><span class="ident" id="4106470">Mod</span><span class="op" id="4106473">(</span><span class="ident" id="4106474">y3</span><span class="op" id="4106476">,</span>&nbsp;<span class="ident" id="4106478">curve</span><span class="op" id="4106483">.</span><span class="ident" id="4106484">P</span><span class="op" id="4106485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106489">z3</span><span class="op" id="4106491">.</span><span class="ident" id="4106492">Add</span><span class="op" id="4106495">(</span><span class="ident" id="4106496">z1</span><span class="op" id="4106498">,</span>&nbsp;<span class="ident" id="4106500">z2</span><span class="op" id="4106502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106505">z3</span><span class="op" id="4106507">.</span><span class="ident" id="4106508">Mul</span><span class="op" id="4106511">(</span><span class="ident" id="4106512">z3</span><span class="op" id="4106514">,</span>&nbsp;<span class="ident" id="4106516">z3</span><span class="op" id="4106518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106521">z3</span><span class="op" id="4106523">.</span><span class="ident" id="4106524">Sub</span><span class="op" id="4106527">(</span><span class="ident" id="4106528">z3</span><span class="op" id="4106530">,</span>&nbsp;<span class="ident" id="4106532">z1z1</span><span class="op" id="4106536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106539">z3</span><span class="op" id="4106541">.</span><span class="ident" id="4106542">Sub</span><span class="op" id="4106545">(</span><span class="ident" id="4106546">z3</span><span class="op" id="4106548">,</span>&nbsp;<span class="ident" id="4106550">z2z2</span><span class="op" id="4106554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106557">z3</span><span class="op" id="4106559">.</span><span class="ident" id="4106560">Mul</span><span class="op" id="4106563">(</span><span class="ident" id="4106564">z3</span><span class="op" id="4106566">,</span>&nbsp;<span class="ident" id="4106568">h</span><span class="op" id="4106569">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106572">z3</span><span class="op" id="4106574">.</span><span class="ident" id="4106575">Mod</span><span class="op" id="4106578">(</span><span class="ident" id="4106579">z3</span><span class="op" id="4106581">,</span>&nbsp;<span class="ident" id="4106583">curve</span><span class="op" id="4106588">.</span><span class="ident" id="4106589">P</span><span class="op" id="4106590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106594">return</span>&nbsp;<span class="ident" id="4106601">x3</span><span class="op" id="4106603">,</span>&nbsp;<span class="ident" id="4106605">y3</span><span class="op" id="4106607">,</span>&nbsp;<span class="ident" id="4106609">z3</span><br>
<span class="lineno"></span><span class="op" id="4106612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4106615">func</span>&nbsp;<span class="op" id="4106620">(</span><span class="ident" id="4106621">curve</span>&nbsp;<span class="op" id="4106627">*</span><span class="ident" id="4106628">CurveParams</span><span class="op" id="4106639">)</span>&nbsp;<span class="ident" id="4106641">Double</span><span class="op" id="4106647">(</span><span class="ident" id="4106648">x1</span><span class="op" id="4106650">,</span>&nbsp;<span class="ident" id="4106652">y1</span>&nbsp;<span class="op" id="4106655">*</span><span class="ident" id="4106656">big</span><span class="op" id="4106659">.</span><span class="ident" id="4106660">Int</span><span class="op" id="4106663">)</span>&nbsp;<span class="op" id="4106665">(</span><span class="op" id="4106666">*</span><span class="ident" id="4106667">big</span><span class="op" id="4106670">.</span><span class="ident" id="4106671">Int</span><span class="op" id="4106674">,</span>&nbsp;<span class="op" id="4106676">*</span><span class="ident" id="4106677">big</span><span class="op" id="4106680">.</span><span class="ident" id="4106681">Int</span><span class="op" id="4106684">)</span>&nbsp;<span class="op" id="4106686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106689">z1</span>&nbsp;<span class="op" id="4106692">:=</span>&nbsp;<span class="ident" id="4106695">zForAffine</span><span class="op" id="4106705">(</span><span class="ident" id="4106706">x1</span><span class="op" id="4106708">,</span>&nbsp;<span class="ident" id="4106710">y1</span><span class="op" id="4106712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106715">return</span>&nbsp;<span class="ident" id="4106722">curve</span><span class="op" id="4106727">.</span><span class="ident" id="4106728">affineFromJacobian</span><span class="op" id="4106746">(</span><span class="ident" id="4106747">curve</span><span class="op" id="4106752">.</span><span class="ident" id="4106753">doubleJacobian</span><span class="op" id="4106767">(</span><span class="ident" id="4106768">x1</span><span class="op" id="4106770">,</span>&nbsp;<span class="ident" id="4106772">y1</span><span class="op" id="4106774">,</span>&nbsp;<span class="ident" id="4106776">z1</span><span class="op" id="4106778">)</span><span class="op" id="4106779">)</span><br>
<span class="lineno"></span><span class="op" id="4106781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4106784">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4106856">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4106902">func</span>&nbsp;<span class="op" id="4106907">(</span><span class="ident" id="4106908">curve</span>&nbsp;<span class="op" id="4106914">*</span><span class="ident" id="4106915">CurveParams</span><span class="op" id="4106926">)</span>&nbsp;<span class="ident" id="4106928">doubleJacobian</span><span class="op" id="4106942">(</span><span class="ident" id="4106943">x</span><span class="op" id="4106944">,</span>&nbsp;<span class="ident" id="4106946">y</span><span class="op" id="4106947">,</span>&nbsp;<span class="ident" id="4106949">z</span>&nbsp;<span class="op" id="4106951">*</span><span class="ident" id="4106952">big</span><span class="op" id="4106955">.</span><span class="ident" id="4106956">Int</span><span class="op" id="4106959">)</span>&nbsp;<span class="op" id="4106961">(</span><span class="op" id="4106962">*</span><span class="ident" id="4106963">big</span><span class="op" id="4106966">.</span><span class="ident" id="4106967">Int</span><span class="op" id="4106970">,</span>&nbsp;<span class="op" id="4106972">*</span><span class="ident" id="4106973">big</span><span class="op" id="4106976">.</span><span class="ident" id="4106977">Int</span><span class="op" id="4106980">,</span>&nbsp;<span class="op" id="4106982">*</span><span class="ident" id="4106983">big</span><span class="op" id="4106986">.</span><span class="ident" id="4106987">Int</span><span class="op" id="4106990">)</span>&nbsp;<span class="op" id="4106992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4106995">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107084">delta</span>&nbsp;<span class="op" id="4107090">:=</span>&nbsp;<span class="builtinfunc" id="4107093">new</span><span class="op" id="4107096">(</span><span class="ident" id="4107097">big</span><span class="op" id="4107100">.</span><span class="ident" id="4107101">Int</span><span class="op" id="4107104">)</span><span class="op" id="4107105">.</span><span class="ident" id="4107106">Mul</span><span class="op" id="4107109">(</span><span class="ident" id="4107110">z</span><span class="op" id="4107111">,</span>&nbsp;<span class="ident" id="4107113">z</span><span class="op" id="4107114">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107117">delta</span><span class="op" id="4107122">.</span><span class="ident" id="4107123">Mod</span><span class="op" id="4107126">(</span><span class="ident" id="4107127">delta</span><span class="op" id="4107132">,</span>&nbsp;<span class="ident" id="4107134">curve</span><span class="op" id="4107139">.</span><span class="ident" id="4107140">P</span><span class="op" id="4107141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107144">gamma</span>&nbsp;<span class="op" id="4107150">:=</span>&nbsp;<span class="builtinfunc" id="4107153">new</span><span class="op" id="4107156">(</span><span class="ident" id="4107157">big</span><span class="op" id="4107160">.</span><span class="ident" id="4107161">Int</span><span class="op" id="4107164">)</span><span class="op" id="4107165">.</span><span class="ident" id="4107166">Mul</span><span class="op" id="4107169">(</span><span class="ident" id="4107170">y</span><span class="op" id="4107171">,</span>&nbsp;<span class="ident" id="4107173">y</span><span class="op" id="4107174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107177">gamma</span><span class="op" id="4107182">.</span><span class="ident" id="4107183">Mod</span><span class="op" id="4107186">(</span><span class="ident" id="4107187">gamma</span><span class="op" id="4107192">,</span>&nbsp;<span class="ident" id="4107194">curve</span><span class="op" id="4107199">.</span><span class="ident" id="4107200">P</span><span class="op" id="4107201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107204">alpha</span>&nbsp;<span class="op" id="4107210">:=</span>&nbsp;<span class="builtinfunc" id="4107213">new</span><span class="op" id="4107216">(</span><span class="ident" id="4107217">big</span><span class="op" id="4107220">.</span><span class="ident" id="4107221">Int</span><span class="op" id="4107224">)</span><span class="op" id="4107225">.</span><span class="ident" id="4107226">Sub</span><span class="op" id="4107229">(</span><span class="ident" id="4107230">x</span><span class="op" id="4107231">,</span>&nbsp;<span class="ident" id="4107233">delta</span><span class="op" id="4107238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107241">if</span>&nbsp;<span class="ident" id="4107244">alpha</span><span class="op" id="4107249">.</span><span class="ident" id="4107250">Sign</span><span class="op" id="4107254">(</span><span class="op" id="4107255">)</span>&nbsp;<span class="op" id="4107257">==</span>&nbsp;<span class="op" id="4107260">-</span><span class="num" id="4107261">1</span>&nbsp;<span class="op" id="4107263">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107267">alpha</span><span class="op" id="4107272">.</span><span class="ident" id="4107273">Add</span><span class="op" id="4107276">(</span><span class="ident" id="4107277">alpha</span><span class="op" id="4107282">,</span>&nbsp;<span class="ident" id="4107284">curve</span><span class="op" id="4107289">.</span><span class="ident" id="4107290">P</span><span class="op" id="4107291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107297">alpha2</span>&nbsp;<span class="op" id="4107304">:=</span>&nbsp;<span class="builtinfunc" id="4107307">new</span><span class="op" id="4107310">(</span><span class="ident" id="4107311">big</span><span class="op" id="4107314">.</span><span class="ident" id="4107315">Int</span><span class="op" id="4107318">)</span><span class="op" id="4107319">.</span><span class="ident" id="4107320">Add</span><span class="op" id="4107323">(</span><span class="ident" id="4107324">x</span><span class="op" id="4107325">,</span>&nbsp;<span class="ident" id="4107327">delta</span><span class="op" id="4107332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107335">alpha</span><span class="op" id="4107340">.</span><span class="ident" id="4107341">Mul</span><span class="op" id="4107344">(</span><span class="ident" id="4107345">alpha</span><span class="op" id="4107350">,</span>&nbsp;<span class="ident" id="4107352">alpha2</span><span class="op" id="4107358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107361">alpha2</span><span class="op" id="4107367">.</span><span class="ident" id="4107368">Set</span><span class="op" id="4107371">(</span><span class="ident" id="4107372">alpha</span><span class="op" id="4107377">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107380">alpha</span><span class="op" id="4107385">.</span><span class="ident" id="4107386">Lsh</span><span class="op" id="4107389">(</span><span class="ident" id="4107390">alpha</span><span class="op" id="4107395">,</span>&nbsp;<span class="num" id="4107397">1</span><span class="op" id="4107398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107401">alpha</span><span class="op" id="4107406">.</span><span class="ident" id="4107407">Add</span><span class="op" id="4107410">(</span><span class="ident" id="4107411">alpha</span><span class="op" id="4107416">,</span>&nbsp;<span class="ident" id="4107418">alpha2</span><span class="op" id="4107424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107428">beta</span>&nbsp;<span class="op" id="4107433">:=</span>&nbsp;<span class="ident" id="4107436">alpha2</span><span class="op" id="4107442">.</span><span class="ident" id="4107443">Mul</span><span class="op" id="4107446">(</span><span class="ident" id="4107447">x</span><span class="op" id="4107448">,</span>&nbsp;<span class="ident" id="4107450">gamma</span><span class="op" id="4107455">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107459">x3</span>&nbsp;<span class="op" id="4107462">:=</span>&nbsp;<span class="builtinfunc" id="4107465">new</span><span class="op" id="4107468">(</span><span class="ident" id="4107469">big</span><span class="op" id="4107472">.</span><span class="ident" id="4107473">Int</span><span class="op" id="4107476">)</span><span class="op" id="4107477">.</span><span class="ident" id="4107478">Mul</span><span class="op" id="4107481">(</span><span class="ident" id="4107482">alpha</span><span class="op" id="4107487">,</span>&nbsp;<span class="ident" id="4107489">alpha</span><span class="op" id="4107494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107497">beta8</span>&nbsp;<span class="op" id="4107503">:=</span>&nbsp;<span class="builtinfunc" id="4107506">new</span><span class="op" id="4107509">(</span><span class="ident" id="4107510">big</span><span class="op" id="4107513">.</span><span class="ident" id="4107514">Int</span><span class="op" id="4107517">)</span><span class="op" id="4107518">.</span><span class="ident" id="4107519">Lsh</span><span class="op" id="4107522">(</span><span class="ident" id="4107523">beta</span><span class="op" id="4107527">,</span>&nbsp;<span class="num" id="4107529">3</span><span class="op" id="4107530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107533">x3</span><span class="op" id="4107535">.</span><span class="ident" id="4107536">Sub</span><span class="op" id="4107539">(</span><span class="ident" id="4107540">x3</span><span class="op" id="4107542">,</span>&nbsp;<span class="ident" id="4107544">beta8</span><span class="op" id="4107549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107552">for</span>&nbsp;<span class="ident" id="4107556">x3</span><span class="op" id="4107558">.</span><span class="ident" id="4107559">Sign</span><span class="op" id="4107563">(</span><span class="op" id="4107564">)</span>&nbsp;<span class="op" id="4107566">==</span>&nbsp;<span class="op" id="4107569">-</span><span class="num" id="4107570">1</span>&nbsp;<span class="op" id="4107572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107576">x3</span><span class="op" id="4107578">.</span><span class="ident" id="4107579">Add</span><span class="op" id="4107582">(</span><span class="ident" id="4107583">x3</span><span class="op" id="4107585">,</span>&nbsp;<span class="ident" id="4107587">curve</span><span class="op" id="4107592">.</span><span class="ident" id="4107593">P</span><span class="op" id="4107594">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107600">x3</span><span class="op" id="4107602">.</span><span class="ident" id="4107603">Mod</span><span class="op" id="4107606">(</span><span class="ident" id="4107607">x3</span><span class="op" id="4107609">,</span>&nbsp;<span class="ident" id="4107611">curve</span><span class="op" id="4107616">.</span><span class="ident" id="4107617">P</span><span class="op" id="4107618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107622">z3</span>&nbsp;<span class="op" id="4107625">:=</span>&nbsp;<span class="builtinfunc" id="4107628">new</span><span class="op" id="4107631">(</span><span class="ident" id="4107632">big</span><span class="op" id="4107635">.</span><span class="ident" id="4107636">Int</span><span class="op" id="4107639">)</span><span class="op" id="4107640">.</span><span class="ident" id="4107641">Add</span><span class="op" id="4107644">(</span><span class="ident" id="4107645">y</span><span class="op" id="4107646">,</span>&nbsp;<span class="ident" id="4107648">z</span><span class="op" id="4107649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107652">z3</span><span class="op" id="4107654">.</span><span class="ident" id="4107655">Mul</span><span class="op" id="4107658">(</span><span class="ident" id="4107659">z3</span><span class="op" id="4107661">,</span>&nbsp;<span class="ident" id="4107663">z3</span><span class="op" id="4107665">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107668">z3</span><span class="op" id="4107670">.</span><span class="ident" id="4107671">Sub</span><span class="op" id="4107674">(</span><span class="ident" id="4107675">z3</span><span class="op" id="4107677">,</span>&nbsp;<span class="ident" id="4107679">gamma</span><span class="op" id="4107684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107687">if</span>&nbsp;<span class="ident" id="4107690">z3</span><span class="op" id="4107692">.</span><span class="ident" id="4107693">Sign</span><span class="op" id="4107697">(</span><span class="op" id="4107698">)</span>&nbsp;<span class="op" id="4107700">==</span>&nbsp;<span class="op" id="4107703">-</span><span class="num" id="4107704">1</span>&nbsp;<span class="op" id="4107706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107710">z3</span><span class="op" id="4107712">.</span><span class="ident" id="4107713">Add</span><span class="op" id="4107716">(</span><span class="ident" id="4107717">z3</span><span class="op" id="4107719">,</span>&nbsp;<span class="ident" id="4107721">curve</span><span class="op" id="4107726">.</span><span class="ident" id="4107727">P</span><span class="op" id="4107728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107734">z3</span><span class="op" id="4107736">.</span><span class="ident" id="4107737">Sub</span><span class="op" id="4107740">(</span><span class="ident" id="4107741">z3</span><span class="op" id="4107743">,</span>&nbsp;<span class="ident" id="4107745">delta</span><span class="op" id="4107750">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107753">if</span>&nbsp;<span class="ident" id="4107756">z3</span><span class="op" id="4107758">.</span><span class="ident" id="4107759">Sign</span><span class="op" id="4107763">(</span><span class="op" id="4107764">)</span>&nbsp;<span class="op" id="4107766">==</span>&nbsp;<span class="op" id="4107769">-</span><span class="num" id="4107770">1</span>&nbsp;<span class="op" id="4107772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107776">z3</span><span class="op" id="4107778">.</span><span class="ident" id="4107779">Add</span><span class="op" id="4107782">(</span><span class="ident" id="4107783">z3</span><span class="op" id="4107785">,</span>&nbsp;<span class="ident" id="4107787">curve</span><span class="op" id="4107792">.</span><span class="ident" id="4107793">P</span><span class="op" id="4107794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107800">z3</span><span class="op" id="4107802">.</span><span class="ident" id="4107803">Mod</span><span class="op" id="4107806">(</span><span class="ident" id="4107807">z3</span><span class="op" id="4107809">,</span>&nbsp;<span class="ident" id="4107811">curve</span><span class="op" id="4107816">.</span><span class="ident" id="4107817">P</span><span class="op" id="4107818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107822">beta</span><span class="op" id="4107826">.</span><span class="ident" id="4107827">Lsh</span><span class="op" id="4107830">(</span><span class="ident" id="4107831">beta</span><span class="op" id="4107835">,</span>&nbsp;<span class="num" id="4107837">2</span><span class="op" id="4107838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107841">beta</span><span class="op" id="4107845">.</span><span class="ident" id="4107846">Sub</span><span class="op" id="4107849">(</span><span class="ident" id="4107850">beta</span><span class="op" id="4107854">,</span>&nbsp;<span class="ident" id="4107856">x3</span><span class="op" id="4107858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107861">if</span>&nbsp;<span class="ident" id="4107864">beta</span><span class="op" id="4107868">.</span><span class="ident" id="4107869">Sign</span><span class="op" id="4107873">(</span><span class="op" id="4107874">)</span>&nbsp;<span class="op" id="4107876">==</span>&nbsp;<span class="op" id="4107879">-</span><span class="num" id="4107880">1</span>&nbsp;<span class="op" id="4107882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107886">beta</span><span class="op" id="4107890">.</span><span class="ident" id="4107891">Add</span><span class="op" id="4107894">(</span><span class="ident" id="4107895">beta</span><span class="op" id="4107899">,</span>&nbsp;<span class="ident" id="4107901">curve</span><span class="op" id="4107906">.</span><span class="ident" id="4107907">P</span><span class="op" id="4107908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107911">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107914">y3</span>&nbsp;<span class="op" id="4107917">:=</span>&nbsp;<span class="ident" id="4107920">alpha</span><span class="op" id="4107925">.</span><span class="ident" id="4107926">Mul</span><span class="op" id="4107929">(</span><span class="ident" id="4107930">alpha</span><span class="op" id="4107935">,</span>&nbsp;<span class="ident" id="4107937">beta</span><span class="op" id="4107941">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107945">gamma</span><span class="op" id="4107950">.</span><span class="ident" id="4107951">Mul</span><span class="op" id="4107954">(</span><span class="ident" id="4107955">gamma</span><span class="op" id="4107960">,</span>&nbsp;<span class="ident" id="4107962">gamma</span><span class="op" id="4107967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107970">gamma</span><span class="op" id="4107975">.</span><span class="ident" id="4107976">Lsh</span><span class="op" id="4107979">(</span><span class="ident" id="4107980">gamma</span><span class="op" id="4107985">,</span>&nbsp;<span class="num" id="4107987">3</span><span class="op" id="4107988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107991">gamma</span><span class="op" id="4107996">.</span><span class="ident" id="4107997">Mod</span><span class="op" id="4108000">(</span><span class="ident" id="4108001">gamma</span><span class="op" id="4108006">,</span>&nbsp;<span class="ident" id="4108008">curve</span><span class="op" id="4108013">.</span><span class="ident" id="4108014">P</span><span class="op" id="4108015">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108019">y3</span><span class="op" id="4108021">.</span><span class="ident" id="4108022">Sub</span><span class="op" id="4108025">(</span><span class="ident" id="4108026">y3</span><span class="op" id="4108028">,</span>&nbsp;<span class="ident" id="4108030">gamma</span><span class="op" id="4108035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108038">if</span>&nbsp;<span class="ident" id="4108041">y3</span><span class="op" id="4108043">.</span><span class="ident" id="4108044">Sign</span><span class="op" id="4108048">(</span><span class="op" id="4108049">)</span>&nbsp;<span class="op" id="4108051">==</span>&nbsp;<span class="op" id="4108054">-</span><span class="num" id="4108055">1</span>&nbsp;<span class="op" id="4108057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108061">y3</span><span class="op" id="4108063">.</span><span class="ident" id="4108064">Add</span><span class="op" id="4108067">(</span><span class="ident" id="4108068">y3</span><span class="op" id="4108070">,</span>&nbsp;<span class="ident" id="4108072">curve</span><span class="op" id="4108077">.</span><span class="ident" id="4108078">P</span><span class="op" id="4108079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108082">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108085">y3</span><span class="op" id="4108087">.</span><span class="ident" id="4108088">Mod</span><span class="op" id="4108091">(</span><span class="ident" id="4108092">y3</span><span class="op" id="4108094">,</span>&nbsp;<span class="ident" id="4108096">curve</span><span class="op" id="4108101">.</span><span class="ident" id="4108102">P</span><span class="op" id="4108103">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108107">return</span>&nbsp;<span class="ident" id="4108114">x3</span><span class="op" id="4108116">,</span>&nbsp;<span class="ident" id="4108118">y3</span><span class="op" id="4108120">,</span>&nbsp;<span class="ident" id="4108122">z3</span><br>
<span class="lineno"></span><span class="op" id="4108125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4108128">func</span>&nbsp;<span class="op" id="4108133">(</span><span class="ident" id="4108134">curve</span>&nbsp;<span class="op" id="4108140">*</span><span class="ident" id="4108141">CurveParams</span><span class="op" id="4108152">)</span>&nbsp;<span class="ident" id="4108154">ScalarMult</span><span class="op" id="4108164">(</span><span class="ident" id="4108165">Bx</span><span class="op" id="4108167">,</span>&nbsp;<span class="ident" id="4108169">By</span>&nbsp;<span class="op" id="4108172">*</span><span class="ident" id="4108173">big</span><span class="op" id="4108176">.</span><span class="ident" id="4108177">Int</span><span class="op" id="4108180">,</span>&nbsp;<span class="ident" id="4108182">k</span>&nbsp;<span class="op" id="4108184">[</span><span class="op" id="4108185">]</span><span class="builtintype" id="4108186">byte</span><span class="op" id="4108190">)</span>&nbsp;<span class="op" id="4108192">(</span><span class="op" id="4108193">*</span><span class="ident" id="4108194">big</span><span class="op" id="4108197">.</span><span class="ident" id="4108198">Int</span><span class="op" id="4108201">,</span>&nbsp;<span class="op" id="4108203">*</span><span class="ident" id="4108204">big</span><span class="op" id="4108207">.</span><span class="ident" id="4108208">Int</span><span class="op" id="4108211">)</span>&nbsp;<span class="op" id="4108213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108216">Bz</span>&nbsp;<span class="op" id="4108219">:=</span>&nbsp;<span class="builtinfunc" id="4108222">new</span><span class="op" id="4108225">(</span><span class="ident" id="4108226">big</span><span class="op" id="4108229">.</span><span class="ident" id="4108230">Int</span><span class="op" id="4108233">)</span><span class="op" id="4108234">.</span><span class="ident" id="4108235">SetInt64</span><span class="op" id="4108243">(</span><span class="num" id="4108244">1</span><span class="op" id="4108245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108248">x</span><span class="op" id="4108249">,</span>&nbsp;<span class="ident" id="4108251">y</span><span class="op" id="4108252">,</span>&nbsp;<span class="ident" id="4108254">z</span>&nbsp;<span class="op" id="4108256">:=</span>&nbsp;<span class="builtinfunc" id="4108259">new</span><span class="op" id="4108262">(</span><span class="ident" id="4108263">big</span><span class="op" id="4108266">.</span><span class="ident" id="4108267">Int</span><span class="op" id="4108270">)</span><span class="op" id="4108271">,</span>&nbsp;<span class="builtinfunc" id="4108273">new</span><span class="op" id="4108276">(</span><span class="ident" id="4108277">big</span><span class="op" id="4108280">.</span><span class="ident" id="4108281">Int</span><span class="op" id="4108284">)</span><span class="op" id="4108285">,</span>&nbsp;<span class="builtinfunc" id="4108287">new</span><span class="op" id="4108290">(</span><span class="ident" id="4108291">big</span><span class="op" id="4108294">.</span><span class="ident" id="4108295">Int</span><span class="op" id="4108298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108302">for</span>&nbsp;<span class="ident" id="4108306">_</span><span class="op" id="4108307">,</span>&nbsp;<span class="builtintype" id="4108309">byte</span>&nbsp;<span class="op" id="4108314">:=</span>&nbsp;<span class="keyword" id="4108317">range</span>&nbsp;<span class="ident" id="4108323">k</span>&nbsp;<span class="op" id="4108325">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108329">for</span>&nbsp;<span class="ident" id="4108333">bitNum</span>&nbsp;<span class="op" id="4108340">:=</span>&nbsp;<span class="num" id="4108343">0</span><span class="op" id="4108344">;</span>&nbsp;<span class="ident" id="4108346">bitNum</span>&nbsp;<span class="op" id="4108353">&lt;</span>&nbsp;<span class="num" id="4108355">8</span><span class="op" id="4108356">;</span>&nbsp;<span class="ident" id="4108358">bitNum</span><span class="op" id="4108364">++</span>&nbsp;<span class="op" id="4108367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108372">x</span><span class="op" id="4108373">,</span>&nbsp;<span class="ident" id="4108375">y</span><span class="op" id="4108376">,</span>&nbsp;<span class="ident" id="4108378">z</span>&nbsp;<span class="op" id="4108380">=</span>&nbsp;<span class="ident" id="4108382">curve</span><span class="op" id="4108387">.</span><span class="ident" id="4108388">doubleJacobian</span><span class="op" id="4108402">(</span><span class="ident" id="4108403">x</span><span class="op" id="4108404">,</span>&nbsp;<span class="ident" id="4108406">y</span><span class="op" id="4108407">,</span>&nbsp;<span class="ident" id="4108409">z</span><span class="op" id="4108410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108415">if</span>&nbsp;<span class="builtintype" id="4108418">byte</span><span class="op" id="4108422">&amp;</span><span class="num" id="4108423">0x80</span>&nbsp;<span class="op" id="4108428">==</span>&nbsp;<span class="num" id="4108431">0x80</span>&nbsp;<span class="op" id="4108436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108442">x</span><span class="op" id="4108443">,</span>&nbsp;<span class="ident" id="4108445">y</span><span class="op" id="4108446">,</span>&nbsp;<span class="ident" id="4108448">z</span>&nbsp;<span class="op" id="4108450">=</span>&nbsp;<span class="ident" id="4108452">curve</span><span class="op" id="4108457">.</span><span class="ident" id="4108458">addJacobian</span><span class="op" id="4108469">(</span><span class="ident" id="4108470">Bx</span><span class="op" id="4108472">,</span>&nbsp;<span class="ident" id="4108474">By</span><span class="op" id="4108476">,</span>&nbsp;<span class="ident" id="4108478">Bz</span><span class="op" id="4108480">,</span>&nbsp;<span class="ident" id="4108482">x</span><span class="op" id="4108483">,</span>&nbsp;<span class="ident" id="4108485">y</span><span class="op" id="4108486">,</span>&nbsp;<span class="ident" id="4108488">z</span><span class="op" id="4108489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108494">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4108499">byte</span>&nbsp;<span class="op" id="4108504">&lt;&lt;=</span>&nbsp;<span class="num" id="4108508">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108519">return</span>&nbsp;<span class="ident" id="4108526">curve</span><span class="op" id="4108531">.</span><span class="ident" id="4108532">affineFromJacobian</span><span class="op" id="4108550">(</span><span class="ident" id="4108551">x</span><span class="op" id="4108552">,</span>&nbsp;<span class="ident" id="4108554">y</span><span class="op" id="4108555">,</span>&nbsp;<span class="ident" id="4108557">z</span><span class="op" id="4108558">)</span><br>
<span class="lineno">265</span><span class="op" id="4108560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4108563">func</span>&nbsp;<span class="op" id="4108568">(</span><span class="ident" id="4108569">curve</span>&nbsp;<span class="op" id="4108575">*</span><span class="ident" id="4108576">CurveParams</span><span class="op" id="4108587">)</span>&nbsp;<span class="ident" id="4108589">ScalarBaseMult</span><span class="op" id="4108603">(</span><span class="ident" id="4108604">k</span>&nbsp;<span class="op" id="4108606">[</span><span class="op" id="4108607">]</span><span class="builtintype" id="4108608">byte</span><span class="op" id="4108612">)</span>&nbsp;<span class="op" id="4108614">(</span><span class="op" id="4108615">*</span><span class="ident" id="4108616">big</span><span class="op" id="4108619">.</span><span class="ident" id="4108620">Int</span><span class="op" id="4108623">,</span>&nbsp;<span class="op" id="4108625">*</span><span class="ident" id="4108626">big</span><span class="op" id="4108629">.</span><span class="ident" id="4108630">Int</span><span class="op" id="4108633">)</span>&nbsp;<span class="op" id="4108635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108638">return</span>&nbsp;<span class="ident" id="4108645">curve</span><span class="op" id="4108650">.</span><span class="ident" id="4108651">ScalarMult</span><span class="op" id="4108661">(</span><span class="ident" id="4108662">curve</span><span class="op" id="4108667">.</span><span class="ident" id="4108668">Gx</span><span class="op" id="4108670">,</span>&nbsp;<span class="ident" id="4108672">curve</span><span class="op" id="4108677">.</span><span class="ident" id="4108678">Gy</span><span class="op" id="4108680">,</span>&nbsp;<span class="ident" id="4108682">k</span><span class="op" id="4108683">)</span><br>
<span class="lineno"></span><span class="op" id="4108685">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4108688">var</span>&nbsp;<span class="ident" id="4108692">mask</span>&nbsp;<span class="op" id="4108697">=</span>&nbsp;<span class="op" id="4108699">[</span><span class="op" id="4108700">]</span><span class="builtintype" id="4108701">byte</span><span class="op" id="4108705">{</span><span class="num" id="4108706">0xff</span><span class="op" id="4108710">,</span>&nbsp;<span class="num" id="4108712">0x1</span><span class="op" id="4108715">,</span>&nbsp;<span class="num" id="4108717">0x3</span><span class="op" id="4108720">,</span>&nbsp;<span class="num" id="4108722">0x7</span><span class="op" id="4108725">,</span>&nbsp;<span class="num" id="4108727">0xf</span><span class="op" id="4108730">,</span>&nbsp;<span class="num" id="4108732">0x1f</span><span class="op" id="4108736">,</span>&nbsp;<span class="num" id="4108738">0x3f</span><span class="op" id="4108742">,</span>&nbsp;<span class="num" id="4108744">0x7f</span><span class="op" id="4108748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4108751">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4108820">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4108888">func</span>&nbsp;<span class="ident" id="4108893">GenerateKey</span><span class="op" id="4108904">(</span><span class="ident" id="4108905">curve</span>&nbsp;<span class="ident" id="4108911">Curve</span><span class="op" id="4108916">,</span>&nbsp;<span class="ident" id="4108918">rand</span>&nbsp;<span class="ident" id="4108923">io</span><span class="op" id="4108925">.</span><span class="ident" id="4108926">Reader</span><span class="op" id="4108932">)</span>&nbsp;<span class="op" id="4108934">(</span><span class="ident" id="4108935">priv</span>&nbsp;<span class="op" id="4108940">[</span><span class="op" id="4108941">]</span><span class="builtintype" id="4108942">byte</span><span class="op" id="4108946">,</span>&nbsp;<span class="ident" id="4108948">x</span><span class="op" id="4108949">,</span>&nbsp;<span class="ident" id="4108951">y</span>&nbsp;<span class="op" id="4108953">*</span><span class="ident" id="4108954">big</span><span class="op" id="4108957">.</span><span class="ident" id="4108958">Int</span><span class="op" id="4108961">,</span>&nbsp;<span class="ident" id="4108963">err</span>&nbsp;<span class="builtintype" id="4108967">error</span><span class="op" id="4108972">)</span>&nbsp;<span class="op" id="4108974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108977">bitSize</span>&nbsp;<span class="op" id="4108985">:=</span>&nbsp;<span class="ident" id="4108988">curve</span><span class="op" id="4108993">.</span><span class="ident" id="4108994">Params</span><span class="op" id="4109000">(</span><span class="op" id="4109001">)</span><span class="op" id="4109002">.</span><span class="ident" id="4109003">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109012">byteLen</span>&nbsp;<span class="op" id="4109020">:=</span>&nbsp;<span class="op" id="4109023">(</span><span class="ident" id="4109024">bitSize</span>&nbsp;<span class="op" id="4109032">+</span>&nbsp;<span class="num" id="4109034">7</span><span class="op" id="4109035">)</span>&nbsp;<span class="op" id="4109037">&gt;&gt;</span>&nbsp;<span class="num" id="4109040">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109043">priv</span>&nbsp;<span class="op" id="4109048">=</span>&nbsp;<span class="builtinfunc" id="4109050">make</span><span class="op" id="4109054">(</span><span class="op" id="4109055">[</span><span class="op" id="4109056">]</span><span class="builtintype" id="4109057">byte</span><span class="op" id="4109061">,</span>&nbsp;<span class="ident" id="4109063">byteLen</span><span class="op" id="4109070">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109074">for</span>&nbsp;<span class="ident" id="4109078">x</span>&nbsp;<span class="op" id="4109080">==</span>&nbsp;<span class="builtintype" id="4109083">nil</span>&nbsp;<span class="op" id="4109087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109091">_</span><span class="op" id="4109092">,</span>&nbsp;<span class="ident" id="4109094">err</span>&nbsp;<span class="op" id="4109098">=</span>&nbsp;<span class="ident" id="4109100">io</span><span class="op" id="4109102">.</span><span class="ident" id="4109103">ReadFull</span><span class="op" id="4109111">(</span><span class="ident" id="4109112">rand</span><span class="op" id="4109116">,</span>&nbsp;<span class="ident" id="4109118">priv</span><span class="op" id="4109122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109126">if</span>&nbsp;<span class="ident" id="4109129">err</span>&nbsp;<span class="op" id="4109133">!=</span>&nbsp;<span class="builtintype" id="4109136">nil</span>&nbsp;<span class="op" id="4109140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109145">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4109154">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4109158">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4109232">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109286">priv</span><span class="op" id="4109290">[</span><span class="num" id="4109291">0</span><span class="op" id="4109292">]</span>&nbsp;<span class="op" id="4109294">&amp;=</span>&nbsp;<span class="ident" id="4109297">mask</span><span class="op" id="4109301">[</span><span class="ident" id="4109302">bitSize</span><span class="op" id="4109309">%</span><span class="num" id="4109310">8</span><span class="op" id="4109311">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4109315">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4109387">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109444">priv</span><span class="op" id="4109448">[</span><span class="num" id="4109449">1</span><span class="op" id="4109450">]</span>&nbsp;<span class="op" id="4109452">^=</span>&nbsp;<span class="num" id="4109455">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109462">x</span><span class="op" id="4109463">,</span>&nbsp;<span class="ident" id="4109465">y</span>&nbsp;<span class="op" id="4109467">=</span>&nbsp;<span class="ident" id="4109469">curve</span><span class="op" id="4109474">.</span><span class="ident" id="4109475">ScalarBaseMult</span><span class="op" id="4109489">(</span><span class="ident" id="4109490">priv</span><span class="op" id="4109494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4109497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109500">return</span><br>
<span class="lineno"></span><span class="op" id="4109507">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4109510">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4109594">func</span>&nbsp;<span class="ident" id="4109599">Marshal</span><span class="op" id="4109606">(</span><span class="ident" id="4109607">curve</span>&nbsp;<span class="ident" id="4109613">Curve</span><span class="op" id="4109618">,</span>&nbsp;<span class="ident" id="4109620">x</span><span class="op" id="4109621">,</span>&nbsp;<span class="ident" id="4109623">y</span>&nbsp;<span class="op" id="4109625">*</span><span class="ident" id="4109626">big</span><span class="op" id="4109629">.</span><span class="ident" id="4109630">Int</span><span class="op" id="4109633">)</span>&nbsp;<span class="op" id="4109635">[</span><span class="op" id="4109636">]</span><span class="builtintype" id="4109637">byte</span>&nbsp;<span class="op" id="4109642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109645">byteLen</span>&nbsp;<span class="op" id="4109653">:=</span>&nbsp;<span class="op" id="4109656">(</span><span class="ident" id="4109657">curve</span><span class="op" id="4109662">.</span><span class="ident" id="4109663">Params</span><span class="op" id="4109669">(</span><span class="op" id="4109670">)</span><span class="op" id="4109671">.</span><span class="ident" id="4109672">BitSize</span>&nbsp;<span class="op" id="4109680">+</span>&nbsp;<span class="num" id="4109682">7</span><span class="op" id="4109683">)</span>&nbsp;<span class="op" id="4109685">&gt;&gt;</span>&nbsp;<span class="num" id="4109688">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109692">ret</span>&nbsp;<span class="op" id="4109696">:=</span>&nbsp;<span class="builtinfunc" id="4109699">make</span><span class="op" id="4109703">(</span><span class="op" id="4109704">[</span><span class="op" id="4109705">]</span><span class="builtintype" id="4109706">byte</span><span class="op" id="4109710">,</span>&nbsp;<span class="num" id="4109712">1</span><span class="op" id="4109713">+</span><span class="num" id="4109714">2</span><span class="op" id="4109715">*</span><span class="ident" id="4109716">byteLen</span><span class="op" id="4109723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109726">ret</span><span class="op" id="4109729">[</span><span class="num" id="4109730">0</span><span class="op" id="4109731">]</span>&nbsp;<span class="op" id="4109733">=</span>&nbsp;<span class="num" id="4109735">4</span>&nbsp;<span class="comment" id="4109737">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109761">xBytes</span>&nbsp;<span class="op" id="4109768">:=</span>&nbsp;<span class="ident" id="4109771">x</span><span class="op" id="4109772">.</span><span class="ident" id="4109773">Bytes</span><span class="op" id="4109778">(</span><span class="op" id="4109779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4109782">copy</span><span class="op" id="4109786">(</span><span class="ident" id="4109787">ret</span><span class="op" id="4109790">[</span><span class="num" id="4109791">1</span><span class="op" id="4109792">+</span><span class="ident" id="4109793">byteLen</span><span class="op" id="4109800">-</span><span class="builtinfunc" id="4109801">len</span><span class="op" id="4109804">(</span><span class="ident" id="4109805">xBytes</span><span class="op" id="4109811">)</span><span class="op" id="4109812">:</span><span class="op" id="4109813">]</span><span class="op" id="4109814">,</span>&nbsp;<span class="ident" id="4109816">xBytes</span><span class="op" id="4109822">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109825">yBytes</span>&nbsp;<span class="op" id="4109832">:=</span>&nbsp;<span class="ident" id="4109835">y</span><span class="op" id="4109836">.</span><span class="ident" id="4109837">Bytes</span><span class="op" id="4109842">(</span><span class="op" id="4109843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4109846">copy</span><span class="op" id="4109850">(</span><span class="ident" id="4109851">ret</span><span class="op" id="4109854">[</span><span class="num" id="4109855">1</span><span class="op" id="4109856">+</span><span class="num" id="4109857">2</span><span class="op" id="4109858">*</span><span class="ident" id="4109859">byteLen</span><span class="op" id="4109866">-</span><span class="builtinfunc" id="4109867">len</span><span class="op" id="4109870">(</span><span class="ident" id="4109871">yBytes</span><span class="op" id="4109877">)</span><span class="op" id="4109878">:</span><span class="op" id="4109879">]</span><span class="op" id="4109880">,</span>&nbsp;<span class="ident" id="4109882">yBytes</span><span class="op" id="4109888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109891">return</span>&nbsp;<span class="ident" id="4109898">ret</span><br>
<span class="lineno"></span><span class="op" id="4109902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4109905">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4109997">func</span>&nbsp;<span class="ident" id="4110002">Unmarshal</span><span class="op" id="4110011">(</span><span class="ident" id="4110012">curve</span>&nbsp;<span class="ident" id="4110018">Curve</span><span class="op" id="4110023">,</span>&nbsp;<span class="ident" id="4110025">data</span>&nbsp;<span class="op" id="4110030">[</span><span class="op" id="4110031">]</span><span class="builtintype" id="4110032">byte</span><span class="op" id="4110036">)</span>&nbsp;<span class="op" id="4110038">(</span><span class="ident" id="4110039">x</span><span class="op" id="4110040">,</span>&nbsp;<span class="ident" id="4110042">y</span>&nbsp;<span class="op" id="4110044">*</span><span class="ident" id="4110045">big</span><span class="op" id="4110048">.</span><span class="ident" id="4110049">Int</span><span class="op" id="4110052">)</span>&nbsp;<span class="op" id="4110054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110057">byteLen</span>&nbsp;<span class="op" id="4110065">:=</span>&nbsp;<span class="op" id="4110068">(</span><span class="ident" id="4110069">curve</span><span class="op" id="4110074">.</span><span class="ident" id="4110075">Params</span><span class="op" id="4110081">(</span><span class="op" id="4110082">)</span><span class="op" id="4110083">.</span><span class="ident" id="4110084">BitSize</span>&nbsp;<span class="op" id="4110092">+</span>&nbsp;<span class="num" id="4110094">7</span><span class="op" id="4110095">)</span>&nbsp;<span class="op" id="4110097">&gt;&gt;</span>&nbsp;<span class="num" id="4110100">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110103">if</span>&nbsp;<span class="builtinfunc" id="4110106">len</span><span class="op" id="4110109">(</span><span class="ident" id="4110110">data</span><span class="op" id="4110114">)</span>&nbsp;<span class="op" id="4110116">!=</span>&nbsp;<span class="num" id="4110119">1</span><span class="op" id="4110120">+</span><span class="num" id="4110121">2</span><span class="op" id="4110122">*</span><span class="ident" id="4110123">byteLen</span>&nbsp;<span class="op" id="4110131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110135">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110146">if</span>&nbsp;<span class="ident" id="4110149">data</span><span class="op" id="4110153">[</span><span class="num" id="4110154">0</span><span class="op" id="4110155">]</span>&nbsp;<span class="op" id="4110157">!=</span>&nbsp;<span class="num" id="4110160">4</span>&nbsp;<span class="op" id="4110162">{</span>&nbsp;<span class="comment" id="4110164">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110187">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110198">x</span>&nbsp;<span class="op" id="4110200">=</span>&nbsp;<span class="builtinfunc" id="4110202">new</span><span class="op" id="4110205">(</span><span class="ident" id="4110206">big</span><span class="op" id="4110209">.</span><span class="ident" id="4110210">Int</span><span class="op" id="4110213">)</span><span class="op" id="4110214">.</span><span class="ident" id="4110215">SetBytes</span><span class="op" id="4110223">(</span><span class="ident" id="4110224">data</span><span class="op" id="4110228">[</span><span class="num" id="4110229">1</span>&nbsp;<span class="op" id="4110231">:</span>&nbsp;<span class="num" id="4110233">1</span><span class="op" id="4110234">+</span><span class="ident" id="4110235">byteLen</span><span class="op" id="4110242">]</span><span class="op" id="4110243">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110246">y</span>&nbsp;<span class="op" id="4110248">=</span>&nbsp;<span class="builtinfunc" id="4110250">new</span><span class="op" id="4110253">(</span><span class="ident" id="4110254">big</span><span class="op" id="4110257">.</span><span class="ident" id="4110258">Int</span><span class="op" id="4110261">)</span><span class="op" id="4110262">.</span><span class="ident" id="4110263">SetBytes</span><span class="op" id="4110271">(</span><span class="ident" id="4110272">data</span><span class="op" id="4110276">[</span><span class="num" id="4110277">1</span><span class="op" id="4110278">+</span><span class="ident" id="4110279">byteLen</span><span class="op" id="4110286">:</span><span class="op" id="4110287">]</span><span class="op" id="4110288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110291">return</span><br>
<span class="lineno"></span><span class="op" id="4110298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4110301">var</span>&nbsp;<span class="ident" id="4110305">initonce</span>&nbsp;<span class="ident" id="4110314">sync</span><span class="op" id="4110318">.</span><span class="ident" id="4110319">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4110324">var</span>&nbsp;<span class="ident" id="4110328">p384</span>&nbsp;<span class="op" id="4110333">*</span><span class="ident" id="4110334">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4110346">var</span>&nbsp;<span class="ident" id="4110350">p521</span>&nbsp;<span class="op" id="4110355">*</span><span class="ident" id="4110356">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4110369">func</span>&nbsp;<span class="ident" id="4110374">initAll</span><span class="op" id="4110381">(</span><span class="op" id="4110382">)</span>&nbsp;<span class="op" id="4110384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110387">initP224</span><span class="op" id="4110395">(</span><span class="op" id="4110396">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110399">initP256</span><span class="op" id="4110407">(</span><span class="op" id="4110408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110411">initP384</span><span class="op" id="4110419">(</span><span class="op" id="4110420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110423">initP521</span><span class="op" id="4110431">(</span><span class="op" id="4110432">)</span><br>
<span class="lineno"></span><span class="op" id="4110434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4110437">func</span>&nbsp;<span class="ident" id="4110442">initP384</span><span class="op" id="4110450">(</span><span class="op" id="4110451">)</span>&nbsp;<span class="op" id="4110453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4110456">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110490">p384</span>&nbsp;<span class="op" id="4110495">=</span>&nbsp;<span class="builtinfunc" id="4110497">new</span><span class="op" id="4110500">(</span><span class="ident" id="4110501">CurveParams</span><span class="op" id="4110512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110515">p384</span><span class="op" id="4110519">.</span><span class="ident" id="4110520">P</span><span class="op" id="4110521">,</span>&nbsp;<span class="ident" id="4110523">_</span>&nbsp;<span class="op" id="4110525">=</span>&nbsp;<span class="builtinfunc" id="4110527">new</span><span class="op" id="4110530">(</span><span class="ident" id="4110531">big</span><span class="op" id="4110534">.</span><span class="ident" id="4110535">Int</span><span class="op" id="4110538">)</span><span class="op" id="4110539">.</span><span class="ident" id="4110540">SetString</span><span class="op" id="4110549">(</span><span class="string" id="4110550">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4110668">,</span>&nbsp;<span class="num" id="4110670">10</span><span class="op" id="4110672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110675">p384</span><span class="op" id="4110679">.</span><span class="ident" id="4110680">N</span><span class="op" id="4110681">,</span>&nbsp;<span class="ident" id="4110683">_</span>&nbsp;<span class="op" id="4110685">=</span>&nbsp;<span class="builtinfunc" id="4110687">new</span><span class="op" id="4110690">(</span><span class="ident" id="4110691">big</span><span class="op" id="4110694">.</span><span class="ident" id="4110695">Int</span><span class="op" id="4110698">)</span><span class="op" id="4110699">.</span><span class="ident" id="4110700">SetString</span><span class="op" id="4110709">(</span><span class="string" id="4110710">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4110828">,</span>&nbsp;<span class="num" id="4110830">10</span><span class="op" id="4110832">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110835">p384</span><span class="op" id="4110839">.</span><span class="ident" id="4110840">B</span><span class="op" id="4110841">,</span>&nbsp;<span class="ident" id="4110843">_</span>&nbsp;<span class="op" id="4110845">=</span>&nbsp;<span class="builtinfunc" id="4110847">new</span><span class="op" id="4110850">(</span><span class="ident" id="4110851">big</span><span class="op" id="4110854">.</span><span class="ident" id="4110855">Int</span><span class="op" id="4110858">)</span><span class="op" id="4110859">.</span><span class="ident" id="4110860">SetString</span><span class="op" id="4110869">(</span><span class="string" id="4110870">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4110968">,</span>&nbsp;<span class="num" id="4110970">16</span><span class="op" id="4110972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110975">p384</span><span class="op" id="4110979">.</span><span class="ident" id="4110980">Gx</span><span class="op" id="4110982">,</span>&nbsp;<span class="ident" id="4110984">_</span>&nbsp;<span class="op" id="4110986">=</span>&nbsp;<span class="builtinfunc" id="4110988">new</span><span class="op" id="4110991">(</span><span class="ident" id="4110992">big</span><span class="op" id="4110995">.</span><span class="ident" id="4110996">Int</span><span class="op" id="4110999">)</span><span class="op" id="4111000">.</span><span class="ident" id="4111001">SetString</span><span class="op" id="4111010">(</span><span class="string" id="4111011">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4111109">,</span>&nbsp;<span class="num" id="4111111">16</span><span class="op" id="4111113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111116">p384</span><span class="op" id="4111120">.</span><span class="ident" id="4111121">Gy</span><span class="op" id="4111123">,</span>&nbsp;<span class="ident" id="4111125">_</span>&nbsp;<span class="op" id="4111127">=</span>&nbsp;<span class="builtinfunc" id="4111129">new</span><span class="op" id="4111132">(</span><span class="ident" id="4111133">big</span><span class="op" id="4111136">.</span><span class="ident" id="4111137">Int</span><span class="op" id="4111140">)</span><span class="op" id="4111141">.</span><span class="ident" id="4111142">SetString</span><span class="op" id="4111151">(</span><span class="string" id="4111152">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4111250">,</span>&nbsp;<span class="num" id="4111252">16</span><span class="op" id="4111254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111257">p384</span><span class="op" id="4111261">.</span><span class="ident" id="4111262">BitSize</span>&nbsp;<span class="op" id="4111270">=</span>&nbsp;<span class="num" id="4111272">384</span><br>
<span class="lineno"></span><span class="op" id="4111276">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4111279">func</span>&nbsp;<span class="ident" id="4111284">initP521</span><span class="op" id="4111292">(</span><span class="op" id="4111293">)</span>&nbsp;<span class="op" id="4111295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4111298">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111332">p521</span>&nbsp;<span class="op" id="4111337">=</span>&nbsp;<span class="builtinfunc" id="4111339">new</span><span class="op" id="4111342">(</span><span class="ident" id="4111343">CurveParams</span><span class="op" id="4111354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111357">p521</span><span class="op" id="4111361">.</span><span class="ident" id="4111362">P</span><span class="op" id="4111363">,</span>&nbsp;<span class="ident" id="4111365">_</span>&nbsp;<span class="op" id="4111367">=</span>&nbsp;<span class="builtinfunc" id="4111369">new</span><span class="op" id="4111372">(</span><span class="ident" id="4111373">big</span><span class="op" id="4111376">.</span><span class="ident" id="4111377">Int</span><span class="op" id="4111380">)</span><span class="op" id="4111381">.</span><span class="ident" id="4111382">SetString</span><span class="op" id="4111391">(</span><span class="string" id="4111392">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4111551">,</span>&nbsp;<span class="num" id="4111553">10</span><span class="op" id="4111555">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111558">p521</span><span class="op" id="4111562">.</span><span class="ident" id="4111563">N</span><span class="op" id="4111564">,</span>&nbsp;<span class="ident" id="4111566">_</span>&nbsp;<span class="op" id="4111568">=</span>&nbsp;<span class="builtinfunc" id="4111570">new</span><span class="op" id="4111573">(</span><span class="ident" id="4111574">big</span><span class="op" id="4111577">.</span><span class="ident" id="4111578">Int</span><span class="op" id="4111581">)</span><span class="op" id="4111582">.</span><span class="ident" id="4111583">SetString</span><span class="op" id="4111592">(</span><span class="string" id="4111593">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4111752">,</span>&nbsp;<span class="num" id="4111754">10</span><span class="op" id="4111756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111759">p521</span><span class="op" id="4111763">.</span><span class="ident" id="4111764">B</span><span class="op" id="4111765">,</span>&nbsp;<span class="ident" id="4111767">_</span>&nbsp;<span class="op" id="4111769">=</span>&nbsp;<span class="builtinfunc" id="4111771">new</span><span class="op" id="4111774">(</span><span class="ident" id="4111775">big</span><span class="op" id="4111778">.</span><span class="ident" id="4111779">Int</span><span class="op" id="4111782">)</span><span class="op" id="4111783">.</span><span class="ident" id="4111784">SetString</span><span class="op" id="4111793">(</span><span class="string" id="4111794">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4111927">,</span>&nbsp;<span class="num" id="4111929">16</span><span class="op" id="4111931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111934">p521</span><span class="op" id="4111938">.</span><span class="ident" id="4111939">Gx</span><span class="op" id="4111941">,</span>&nbsp;<span class="ident" id="4111943">_</span>&nbsp;<span class="op" id="4111945">=</span>&nbsp;<span class="builtinfunc" id="4111947">new</span><span class="op" id="4111950">(</span><span class="ident" id="4111951">big</span><span class="op" id="4111954">.</span><span class="ident" id="4111955">Int</span><span class="op" id="4111958">)</span><span class="op" id="4111959">.</span><span class="ident" id="4111960">SetString</span><span class="op" id="4111969">(</span><span class="string" id="4111970">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4112102">,</span>&nbsp;<span class="num" id="4112104">16</span><span class="op" id="4112106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112109">p521</span><span class="op" id="4112113">.</span><span class="ident" id="4112114">Gy</span><span class="op" id="4112116">,</span>&nbsp;<span class="ident" id="4112118">_</span>&nbsp;<span class="op" id="4112120">=</span>&nbsp;<span class="builtinfunc" id="4112122">new</span><span class="op" id="4112125">(</span><span class="ident" id="4112126">big</span><span class="op" id="4112129">.</span><span class="ident" id="4112130">Int</span><span class="op" id="4112133">)</span><span class="op" id="4112134">.</span><span class="ident" id="4112135">SetString</span><span class="op" id="4112144">(</span><span class="string" id="4112145">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4112278">,</span>&nbsp;<span class="num" id="4112280">16</span><span class="op" id="4112282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112285">p521</span><span class="op" id="4112289">.</span><span class="ident" id="4112290">BitSize</span>&nbsp;<span class="op" id="4112298">=</span>&nbsp;<span class="num" id="4112300">521</span><br>
<span class="lineno">355</span><span class="op" id="4112304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4112307">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4112386">func</span>&nbsp;<span class="ident" id="4112391">P256</span><span class="op" id="4112395">(</span><span class="op" id="4112396">)</span>&nbsp;<span class="ident" id="4112398">Curve</span>&nbsp;<span class="op" id="4112404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112407">initonce</span><span class="op" id="4112415">.</span><span class="ident" id="4112416">Do</span><span class="op" id="4112418">(</span><span class="ident" id="4112419">initAll</span><span class="op" id="4112426">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112429">return</span>&nbsp;<span class="ident" id="4112436">p256</span><br>
<span class="lineno"></span><span class="op" id="4112441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4112444">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4112523">func</span>&nbsp;<span class="ident" id="4112528">P384</span><span class="op" id="4112532">(</span><span class="op" id="4112533">)</span>&nbsp;<span class="ident" id="4112535">Curve</span>&nbsp;<span class="op" id="4112541">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112544">initonce</span><span class="op" id="4112552">.</span><span class="ident" id="4112553">Do</span><span class="op" id="4112555">(</span><span class="ident" id="4112556">initAll</span><span class="op" id="4112563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112566">return</span>&nbsp;<span class="ident" id="4112573">p384</span><br>
<span class="lineno"></span><span class="op" id="4112578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4112581">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4112660">func</span>&nbsp;<span class="ident" id="4112665">P521</span><span class="op" id="4112669">(</span><span class="op" id="4112670">)</span>&nbsp;<span class="ident" id="4112672">Curve</span>&nbsp;<span class="op" id="4112678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112681">initonce</span><span class="op" id="4112689">.</span><span class="ident" id="4112690">Do</span><span class="op" id="4112692">(</span><span class="ident" id="4112693">initAll</span><span class="op" id="4112700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112703">return</span>&nbsp;<span class="ident" id="4112710">p521</span><br>
<span class="lineno"></span><span class="op" id="4112715">}</span>
</div>
</body>
</html>
