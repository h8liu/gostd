<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html</h2>
<ul>
<li><a href="/gostd/html/entity.go.html">entity.go</a></li>
<li><a href="/gostd/html/entity_test.go.html" class="current">entity_test.go</a></li>
<li><a href="/gostd/html/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/escape_test.go.html">escape_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7443139">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7443194">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7443248">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7443299">package</span>&nbsp;<span class="ident" id="7443307">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7443313">import</span>&nbsp;<span class="op" id="7443320">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443323">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443334">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7443349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7443352">func</span>&nbsp;<span class="ident" id="7443357">TestEntityLength</span><span class="op" id="7443373">(</span><span class="ident" id="7443374">t</span>&nbsp;<span class="op" id="7443376">*</span><span class="ident" id="7443377">testing</span><span class="op" id="7443384">.</span><span class="ident" id="7443385">T</span><span class="op" id="7443386">)</span>&nbsp;<span class="op" id="7443388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7443391">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7443473">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7443553">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443606">for</span>&nbsp;<span class="ident" id="7443610">k</span><span class="op" id="7443611">,</span>&nbsp;<span class="ident" id="7443613">v</span>&nbsp;<span class="op" id="7443615">:=</span>&nbsp;<span class="keyword" id="7443618">range</span>&nbsp;<span class="ident" id="7443624">entity</span>&nbsp;<span class="op" id="7443631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443635">if</span>&nbsp;<span class="num" id="7443638">1</span><span class="op" id="7443639">+</span><span class="builtinfunc" id="7443640">len</span><span class="op" id="7443643">(</span><span class="ident" id="7443644">k</span><span class="op" id="7443645">)</span>&nbsp;<span class="op" id="7443647">&lt;</span>&nbsp;<span class="ident" id="7443649">utf8</span><span class="op" id="7443653">.</span><span class="ident" id="7443654">RuneLen</span><span class="op" id="7443661">(</span><span class="ident" id="7443662">v</span><span class="op" id="7443663">)</span>&nbsp;<span class="op" id="7443665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443670">t</span><span class="op" id="7443671">.</span><span class="ident" id="7443672">Error</span><span class="op" id="7443677">(</span><span class="string" id="7443678">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7443697">+</span>&nbsp;<span class="ident" id="7443699">k</span>&nbsp;<span class="op" id="7443701">+</span>&nbsp;<span class="string" id="7443703">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7443742">+</span>&nbsp;<span class="builtintype" id="7443744">string</span><span class="op" id="7443750">(</span><span class="ident" id="7443751">v</span><span class="op" id="7443752">)</span><span class="op" id="7443753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443757">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443761">if</span>&nbsp;<span class="builtinfunc" id="7443764">len</span><span class="op" id="7443767">(</span><span class="ident" id="7443768">k</span><span class="op" id="7443769">)</span>&nbsp;<span class="op" id="7443771">&gt;</span>&nbsp;<span class="ident" id="7443773">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="7443803">&amp;&amp;</span>&nbsp;<span class="ident" id="7443806">k</span><span class="op" id="7443807">[</span><span class="builtinfunc" id="7443808">len</span><span class="op" id="7443811">(</span><span class="ident" id="7443812">k</span><span class="op" id="7443813">)</span><span class="op" id="7443814">-</span><span class="num" id="7443815">1</span><span class="op" id="7443816">]</span>&nbsp;<span class="op" id="7443818">!=</span>&nbsp;<span class="string" id="7443821">&#39;;&#39;</span>&nbsp;<span class="op" id="7443825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443830">t</span><span class="op" id="7443831">.</span><span class="ident" id="7443832">Errorf</span><span class="op" id="7443838">(</span><span class="string" id="7443839">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="7443910">,</span>&nbsp;<span class="ident" id="7443912">k</span><span class="op" id="7443913">,</span>&nbsp;<span class="builtinfunc" id="7443915">len</span><span class="op" id="7443918">(</span><span class="ident" id="7443919">k</span><span class="op" id="7443920">)</span><span class="op" id="7443921">,</span>&nbsp;<span class="ident" id="7443923">longestEntityWithoutSemicolon</span><span class="op" id="7443952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443962">for</span>&nbsp;<span class="ident" id="7443966">k</span><span class="op" id="7443967">,</span>&nbsp;<span class="ident" id="7443969">v</span>&nbsp;<span class="op" id="7443971">:=</span>&nbsp;<span class="keyword" id="7443974">range</span>&nbsp;<span class="ident" id="7443980">entity2</span>&nbsp;<span class="op" id="7443988">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443992">if</span>&nbsp;<span class="num" id="7443995">1</span><span class="op" id="7443996">+</span><span class="builtinfunc" id="7443997">len</span><span class="op" id="7444000">(</span><span class="ident" id="7444001">k</span><span class="op" id="7444002">)</span>&nbsp;<span class="op" id="7444004">&lt;</span>&nbsp;<span class="ident" id="7444006">utf8</span><span class="op" id="7444010">.</span><span class="ident" id="7444011">RuneLen</span><span class="op" id="7444018">(</span><span class="ident" id="7444019">v</span><span class="op" id="7444020">[</span><span class="num" id="7444021">0</span><span class="op" id="7444022">]</span><span class="op" id="7444023">)</span><span class="op" id="7444024">+</span><span class="ident" id="7444025">utf8</span><span class="op" id="7444029">.</span><span class="ident" id="7444030">RuneLen</span><span class="op" id="7444037">(</span><span class="ident" id="7444038">v</span><span class="op" id="7444039">[</span><span class="num" id="7444040">1</span><span class="op" id="7444041">]</span><span class="op" id="7444042">)</span>&nbsp;<span class="op" id="7444044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444049">t</span><span class="op" id="7444050">.</span><span class="ident" id="7444051">Error</span><span class="op" id="7444056">(</span><span class="string" id="7444057">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7444076">+</span>&nbsp;<span class="ident" id="7444078">k</span>&nbsp;<span class="op" id="7444080">+</span>&nbsp;<span class="string" id="7444082">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7444121">+</span>&nbsp;<span class="builtintype" id="7444123">string</span><span class="op" id="7444129">(</span><span class="ident" id="7444130">v</span><span class="op" id="7444131">[</span><span class="num" id="7444132">0</span><span class="op" id="7444133">]</span><span class="op" id="7444134">)</span>&nbsp;<span class="op" id="7444136">+</span>&nbsp;<span class="builtintype" id="7444138">string</span><span class="op" id="7444144">(</span><span class="ident" id="7444145">v</span><span class="op" id="7444146">[</span><span class="num" id="7444147">1</span><span class="op" id="7444148">]</span><span class="op" id="7444149">)</span><span class="op" id="7444150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444157">}</span><br>
<span class="lineno"></span><span class="op" id="7444159">}</span>
</div>
</body>
</html>
