<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3715372">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3715428">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3715482">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3715533">package</span>&nbsp;<span class="ident" id="3715541">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3715547">import</span>&nbsp;<span class="op" id="3715554">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3715557">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3715566">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3715576">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3715581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3715584">//&nbsp;A&nbsp;Decoder&nbsp;reads&nbsp;and&nbsp;decodes&nbsp;JSON&nbsp;objects&nbsp;from&nbsp;an&nbsp;input&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="3715650">type</span>&nbsp;<span class="ident" id="3715655">Decoder</span>&nbsp;<span class="keyword" id="3715663">struct</span>&nbsp;<span class="op" id="3715670">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715673">r</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715678"><a href="/encoding/json/stream.go.html#3715576">io</a></span><span class="op" id="3715680">.</span><span class="ident" id="3715681">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715689">buf</span>&nbsp;&nbsp;<span class="op" id="3715694">[</span><span class="op" id="3715695">]</span><span class="builtintype" id="3715696">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715702">d</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715707"><a href="/encoding/json/decode.go.html#3639927">decodeState</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715720">scan</span>&nbsp;<span class="ident" id="3715725"><a href="/encoding/json/scanner.go.html#3701130">scanner</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715734">err</span>&nbsp;&nbsp;<span class="builtintype" id="3715739">error</span><br>
<span class="lineno">20</span><span class="op" id="3715745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3715748">//&nbsp;NewDecoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;decoder&nbsp;that&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="3715803">//</span><br>
<span class="lineno"></span><span class="comment" id="3715806">//&nbsp;The&nbsp;decoder&nbsp;introduces&nbsp;its&nbsp;own&nbsp;buffering&nbsp;and&nbsp;may</span><br>
<span class="lineno">25</span><span class="comment" id="3715858">//&nbsp;read&nbsp;data&nbsp;from&nbsp;r&nbsp;beyond&nbsp;the&nbsp;JSON&nbsp;values&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="3715912">func</span>&nbsp;<span class="ident" id="3715917">NewDecoder</span><span class="op" id="3715927">(</span><span class="ident" id="3715928">r</span>&nbsp;<span class="ident" id="3715930"><a href="/encoding/json/stream.go.html#3715576">io</a></span><span class="op" id="3715932">.</span><span class="ident" id="3715933">Reader</span><span class="op" id="3715939">)</span>&nbsp;<span class="op" id="3715941">*</span><span class="ident" id="3715942"><a href="/encoding/json/stream.go.html#3715655">Decoder</a></span>&nbsp;<span class="op" id="3715950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715953">return</span>&nbsp;<span class="op" id="3715960">&amp;</span><span class="ident" id="3715961"><a href="/encoding/json/stream.go.html#3715655">Decoder</a></span><span class="op" id="3715968">{</span><span class="ident" id="3715969">r</span><span class="op" id="3715970">:</span>&nbsp;<span class="ident" id="3715972"><a href="/encoding/json/stream.go.html#3715928">r</a></span><span class="op" id="3715973">}</span><br>
<span class="lineno"></span><span class="op" id="3715975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3715978">//&nbsp;UseNumber&nbsp;causes&nbsp;the&nbsp;Decoder&nbsp;to&nbsp;unmarshal&nbsp;a&nbsp;number&nbsp;into&nbsp;an&nbsp;interface{}&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3716057">//&nbsp;Number&nbsp;instead&nbsp;of&nbsp;as&nbsp;a&nbsp;float64.</span><br>
<span class="lineno"></span><span class="keyword" id="3716092">func</span>&nbsp;<span class="op" id="3716097">(</span><span class="ident" id="3716098">dec</span>&nbsp;<span class="op" id="3716102">*</span><span class="ident" id="3716103"><a href="/encoding/json/stream.go.html#3715655">Decoder</a></span><span class="op" id="3716110">)</span>&nbsp;<span class="ident" id="3716112">UseNumber</span><span class="op" id="3716121">(</span><span class="op" id="3716122">)</span>&nbsp;<span class="op" id="3716124">{</span>&nbsp;<span class="ident" id="3716126"><a href="/encoding/json/stream.go.html#3716098">dec</a></span><span class="op" id="3716129">.</span><span class="ident" id="3716130">d</span><span class="op" id="3716131">.</span><span class="ident" id="3716132">useNumber</span>&nbsp;<span class="op" id="3716142">=</span>&nbsp;<span class="ident" id="3716144">true</span>&nbsp;<span class="op" id="3716149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3716152">//&nbsp;Decode&nbsp;reads&nbsp;the&nbsp;next&nbsp;JSON-encoded&nbsp;value&nbsp;from&nbsp;its</span><br>
<span class="lineno">35</span><span class="comment" id="3716205">//&nbsp;input&nbsp;and&nbsp;stores&nbsp;it&nbsp;in&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to&nbsp;by&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="3716258">//</span><br>
<span class="lineno"></span><span class="comment" id="3716261">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Unmarshal&nbsp;for&nbsp;details&nbsp;about</span><br>
<span class="lineno"></span><span class="comment" id="3716318">//&nbsp;the&nbsp;conversion&nbsp;of&nbsp;JSON&nbsp;into&nbsp;a&nbsp;Go&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3716361">func</span>&nbsp;<span class="op" id="3716366">(</span><span class="ident" id="3716367">dec</span>&nbsp;<span class="op" id="3716371">*</span><span class="ident" id="3716372"><a href="/encoding/json/stream.go.html#3715655">Decoder</a></span><span class="op" id="3716379">)</span>&nbsp;<span class="ident" id="3716381">Decode</span><span class="op" id="3716387">(</span><span class="ident" id="3716388">v</span>&nbsp;<span class="keyword" id="3716390">interface</span><span class="op" id="3716399">{</span><span class="op" id="3716400">}</span><span class="op" id="3716401">)</span>&nbsp;<span class="builtintype" id="3716403">error</span>&nbsp;<span class="op" id="3716409">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716412">if</span>&nbsp;<span class="ident" id="3716415"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716418">.</span><span class="ident" id="3716419">err</span>&nbsp;<span class="op" id="3716423">!=</span>&nbsp;<span class="ident" id="3716426">nil</span>&nbsp;<span class="op" id="3716430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716434">return</span>&nbsp;<span class="ident" id="3716441"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716444">.</span><span class="ident" id="3716445">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716454">n</span><span class="op" id="3716455">,</span>&nbsp;<span class="ident" id="3716457">err</span>&nbsp;<span class="op" id="3716461">:=</span>&nbsp;<span class="ident" id="3716464"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716467">.</span><span class="ident" id="3716468">readValue</span><span class="op" id="3716477">(</span><span class="op" id="3716478">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716481">if</span>&nbsp;<span class="ident" id="3716484"><a href="/encoding/json/stream.go.html#3716457">err</a></span>&nbsp;<span class="op" id="3716488">!=</span>&nbsp;<span class="ident" id="3716491">nil</span>&nbsp;<span class="op" id="3716495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716499">return</span>&nbsp;<span class="ident" id="3716506"><a href="/encoding/json/stream.go.html#3716457">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716515">//&nbsp;Don&#39;t&nbsp;save&nbsp;err&nbsp;from&nbsp;unmarshal&nbsp;into&nbsp;dec.err:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716563">//&nbsp;the&nbsp;connection&nbsp;is&nbsp;still&nbsp;usable&nbsp;since&nbsp;we&nbsp;read&nbsp;a&nbsp;complete&nbsp;JSON</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716628">//&nbsp;object&nbsp;from&nbsp;it&nbsp;before&nbsp;the&nbsp;error&nbsp;happened.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716674"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716677">.</span><span class="ident" id="3716678">d</span><span class="op" id="3716679">.</span><span class="ident" id="3716680">init</span><span class="op" id="3716684">(</span><span class="ident" id="3716685"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716688">.</span><span class="ident" id="3716689">buf</span><span class="op" id="3716692">[</span><span class="num" id="3716693">0</span><span class="op" id="3716694">:</span><span class="ident" id="3716695"><a href="/encoding/json/stream.go.html#3716454">n</a></span><span class="op" id="3716696">]</span><span class="op" id="3716697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716700"><a href="/encoding/json/stream.go.html#3716457">err</a></span>&nbsp;<span class="op" id="3716704">=</span>&nbsp;<span class="ident" id="3716706"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716709">.</span><span class="ident" id="3716710">d</span><span class="op" id="3716711">.</span><span class="ident" id="3716712">unmarshal</span><span class="op" id="3716721">(</span><span class="ident" id="3716722"><a href="/encoding/json/stream.go.html#3716388">v</a></span><span class="op" id="3716723">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716727">//&nbsp;Slide&nbsp;rest&nbsp;of&nbsp;data&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716756">rest</span>&nbsp;<span class="op" id="3716761">:=</span>&nbsp;<span class="builtinfunc" id="3716764">copy</span><span class="op" id="3716768">(</span><span class="ident" id="3716769"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716772">.</span><span class="ident" id="3716773">buf</span><span class="op" id="3716776">,</span>&nbsp;<span class="ident" id="3716778"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716781">.</span><span class="ident" id="3716782">buf</span><span class="op" id="3716785">[</span><span class="ident" id="3716786"><a href="/encoding/json/stream.go.html#3716454">n</a></span><span class="op" id="3716787">:</span><span class="op" id="3716788">]</span><span class="op" id="3716789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716792"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716795">.</span><span class="ident" id="3716796">buf</span>&nbsp;<span class="op" id="3716800">=</span>&nbsp;<span class="ident" id="3716802"><a href="/encoding/json/stream.go.html#3716367">dec</a></span><span class="op" id="3716805">.</span><span class="ident" id="3716806">buf</span><span class="op" id="3716809">[</span><span class="num" id="3716810">0</span><span class="op" id="3716811">:</span><span class="ident" id="3716812"><a href="/encoding/json/stream.go.html#3716756">rest</a></span><span class="op" id="3716816">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716820">return</span>&nbsp;<span class="ident" id="3716827"><a href="/encoding/json/stream.go.html#3716457">err</a></span><br>
<span class="lineno">60</span><span class="op" id="3716831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3716834">//&nbsp;Buffered&nbsp;returns&nbsp;a&nbsp;reader&nbsp;of&nbsp;the&nbsp;data&nbsp;remaining&nbsp;in&nbsp;the&nbsp;Decoder&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3716902">//&nbsp;buffer.&nbsp;The&nbsp;reader&nbsp;is&nbsp;valid&nbsp;until&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Decode.</span><br>
<span class="lineno"></span><span class="keyword" id="3716964">func</span>&nbsp;<span class="op" id="3716969">(</span><span class="ident" id="3716970">dec</span>&nbsp;<span class="op" id="3716974">*</span><span class="ident" id="3716975"><a href="/encoding/json/stream.go.html#3715655">Decoder</a></span><span class="op" id="3716982">)</span>&nbsp;<span class="ident" id="3716984">Buffered</span><span class="op" id="3716992">(</span><span class="op" id="3716993">)</span>&nbsp;<span class="ident" id="3716995"><a href="/encoding/json/stream.go.html#3715576">io</a></span><span class="op" id="3716997">.</span><span class="ident" id="3716998">Reader</span>&nbsp;<span class="op" id="3717005">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717008">return</span>&nbsp;<span class="ident" id="3717015"><a href="/encoding/json/stream.go.html#3715557">bytes</a></span><span class="op" id="3717020">.</span><span class="ident" id="3717021">NewReader</span><span class="op" id="3717030">(</span><span class="ident" id="3717031"><a href="/encoding/json/stream.go.html#3716970">dec</a></span><span class="op" id="3717034">.</span><span class="ident" id="3717035">buf</span><span class="op" id="3717038">)</span><br>
<span class="lineno"></span><span class="op" id="3717040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3717043">//&nbsp;readValue&nbsp;reads&nbsp;a&nbsp;JSON&nbsp;value&nbsp;into&nbsp;dec.buf.</span><br>
<span class="lineno"></span><span class="comment" id="3717089">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno">70</span><span class="keyword" id="3717131">func</span>&nbsp;<span class="op" id="3717136">(</span><span class="ident" id="3717137">dec</span>&nbsp;<span class="op" id="3717141">*</span><span class="ident" id="3717142"><a href="/encoding/json/stream.go.html#3715655">Decoder</a></span><span class="op" id="3717149">)</span>&nbsp;<span class="ident" id="3717151">readValue</span><span class="op" id="3717160">(</span><span class="op" id="3717161">)</span>&nbsp;<span class="op" id="3717163">(</span><span class="builtintype" id="3717164">int</span><span class="op" id="3717167">,</span>&nbsp;<span class="builtintype" id="3717169">error</span><span class="op" id="3717174">)</span>&nbsp;<span class="op" id="3717176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717179"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717182">.</span><span class="ident" id="3717183">scan</span><span class="op" id="3717187">.</span><span class="ident" id="3717188">reset</span><span class="op" id="3717193">(</span><span class="op" id="3717194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717198">scanp</span>&nbsp;<span class="op" id="3717204">:=</span>&nbsp;<span class="num" id="3717207">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717210">var</span>&nbsp;<span class="ident" id="3717214">err</span>&nbsp;<span class="builtintype" id="3717218">error</span><br>
<span class="lineno">75</span><span class="ident" id="3717224">Input</span><span class="op" id="3717229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717232">for</span>&nbsp;<span class="op" id="3717236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717240">//&nbsp;Look&nbsp;in&nbsp;the&nbsp;buffer&nbsp;for&nbsp;a&nbsp;new&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717281">for</span>&nbsp;<span class="ident" id="3717285">i</span><span class="op" id="3717286">,</span>&nbsp;<span class="ident" id="3717288">c</span>&nbsp;<span class="op" id="3717290">:=</span>&nbsp;<span class="keyword" id="3717293">range</span>&nbsp;<span class="ident" id="3717299"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717302">.</span><span class="ident" id="3717303">buf</span><span class="op" id="3717306">[</span><span class="ident" id="3717307"><a href="/encoding/json/stream.go.html#3717198">scanp</a></span><span class="op" id="3717312">:</span><span class="op" id="3717313">]</span>&nbsp;<span class="op" id="3717315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717320"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717323">.</span><span class="ident" id="3717324">scan</span><span class="op" id="3717328">.</span><span class="ident" id="3717329">bytes</span><span class="op" id="3717334">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717340">v</span>&nbsp;<span class="op" id="3717342">:=</span>&nbsp;<span class="ident" id="3717345"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717348">.</span><span class="ident" id="3717349">scan</span><span class="op" id="3717353">.</span><span class="ident" id="3717354">step</span><span class="op" id="3717358">(</span><span class="op" id="3717359">&amp;</span><span class="ident" id="3717360"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717363">.</span><span class="ident" id="3717364">scan</span><span class="op" id="3717368">,</span>&nbsp;<span class="builtintype" id="3717370">int</span><span class="op" id="3717373">(</span><span class="ident" id="3717374"><a href="/encoding/json/stream.go.html#3717288">c</a></span><span class="op" id="3717375">)</span><span class="op" id="3717376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717381">if</span>&nbsp;<span class="ident" id="3717384"><a href="/encoding/json/stream.go.html#3717340">v</a></span>&nbsp;<span class="op" id="3717386">==</span>&nbsp;<span class="ident" id="3717389"><a href="/encoding/json/scanner.go.html#3702831">scanEnd</a></span>&nbsp;<span class="op" id="3717397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717403"><a href="/encoding/json/stream.go.html#3717198">scanp</a></span>&nbsp;<span class="op" id="3717409">+=</span>&nbsp;<span class="ident" id="3717412"><a href="/encoding/json/stream.go.html#3717285">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717418">break</span>&nbsp;<span class="ident" id="3717424">Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717433">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717438">//&nbsp;scanEnd&nbsp;is&nbsp;delayed&nbsp;one&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717473">//&nbsp;We&nbsp;might&nbsp;block&nbsp;trying&nbsp;to&nbsp;get&nbsp;that&nbsp;byte&nbsp;from&nbsp;src,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717528">//&nbsp;so&nbsp;instead&nbsp;invent&nbsp;a&nbsp;space&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717566">if</span>&nbsp;<span class="op" id="3717569">(</span><span class="ident" id="3717570"><a href="/encoding/json/stream.go.html#3717340">v</a></span>&nbsp;<span class="op" id="3717572">==</span>&nbsp;<span class="ident" id="3717575"><a href="/encoding/json/scanner.go.html#3702489">scanEndObject</a></span>&nbsp;<span class="op" id="3717589">||</span>&nbsp;<span class="ident" id="3717592"><a href="/encoding/json/stream.go.html#3717340">v</a></span>&nbsp;<span class="op" id="3717594">==</span>&nbsp;<span class="ident" id="3717597"><a href="/encoding/json/scanner.go.html#3702660">scanEndArray</a></span><span class="op" id="3717609">)</span>&nbsp;<span class="op" id="3717611">&amp;&amp;</span>&nbsp;<span class="ident" id="3717614"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717617">.</span><span class="ident" id="3717618">scan</span><span class="op" id="3717622">.</span><span class="ident" id="3717623">step</span><span class="op" id="3717627">(</span><span class="op" id="3717628">&amp;</span><span class="ident" id="3717629"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717632">.</span><span class="ident" id="3717633">scan</span><span class="op" id="3717637">,</span>&nbsp;<span class="string" id="3717639">&#39;&nbsp;&#39;</span><span class="op" id="3717642">)</span>&nbsp;<span class="op" id="3717644">==</span>&nbsp;<span class="ident" id="3717647"><a href="/encoding/json/scanner.go.html#3702831">scanEnd</a></span>&nbsp;<span class="op" id="3717655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717661"><a href="/encoding/json/stream.go.html#3717198">scanp</a></span>&nbsp;<span class="op" id="3717667">+=</span>&nbsp;<span class="ident" id="3717670"><a href="/encoding/json/stream.go.html#3717285">i</a></span>&nbsp;<span class="op" id="3717672">+</span>&nbsp;<span class="num" id="3717674">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717680">break</span>&nbsp;<span class="ident" id="3717686">Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717700">if</span>&nbsp;<span class="ident" id="3717703"><a href="/encoding/json/stream.go.html#3717340">v</a></span>&nbsp;<span class="op" id="3717705">==</span>&nbsp;<span class="ident" id="3717708"><a href="/encoding/json/scanner.go.html#3702919">scanError</a></span>&nbsp;<span class="op" id="3717718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717724"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717727">.</span><span class="ident" id="3717728">err</span>&nbsp;<span class="op" id="3717732">=</span>&nbsp;<span class="ident" id="3717734"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717737">.</span><span class="ident" id="3717738">scan</span><span class="op" id="3717742">.</span><span class="ident" id="3717743">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717751">return</span>&nbsp;<span class="num" id="3717758">0</span><span class="op" id="3717759">,</span>&nbsp;<span class="ident" id="3717761"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717764">.</span><span class="ident" id="3717765">scan</span><span class="op" id="3717769">.</span><span class="ident" id="3717770">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717785"><a href="/encoding/json/stream.go.html#3717198">scanp</a></span>&nbsp;<span class="op" id="3717791">=</span>&nbsp;<span class="builtinfunc" id="3717793">len</span><span class="op" id="3717796">(</span><span class="ident" id="3717797"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717800">.</span><span class="ident" id="3717801">buf</span><span class="op" id="3717804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717809">//&nbsp;Did&nbsp;the&nbsp;last&nbsp;read&nbsp;have&nbsp;an&nbsp;error?</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717847">//&nbsp;Delayed&nbsp;until&nbsp;now&nbsp;to&nbsp;allow&nbsp;buffer&nbsp;scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717892">if</span>&nbsp;<span class="ident" id="3717895"><a href="/encoding/json/stream.go.html#3717214">err</a></span>&nbsp;<span class="op" id="3717899">!=</span>&nbsp;<span class="ident" id="3717902">nil</span>&nbsp;<span class="op" id="3717906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717911">if</span>&nbsp;<span class="ident" id="3717914"><a href="/encoding/json/stream.go.html#3717214">err</a></span>&nbsp;<span class="op" id="3717918">==</span>&nbsp;<span class="ident" id="3717921"><a href="/encoding/json/stream.go.html#3715576">io</a></span><span class="op" id="3717923">.</span><span class="ident" id="3717924">EOF</span>&nbsp;<span class="op" id="3717928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717934">if</span>&nbsp;<span class="ident" id="3717937"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717940">.</span><span class="ident" id="3717941">scan</span><span class="op" id="3717945">.</span><span class="ident" id="3717946">step</span><span class="op" id="3717950">(</span><span class="op" id="3717951">&amp;</span><span class="ident" id="3717952"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3717955">.</span><span class="ident" id="3717956">scan</span><span class="op" id="3717960">,</span>&nbsp;<span class="string" id="3717962">&#39;&nbsp;&#39;</span><span class="op" id="3717965">)</span>&nbsp;<span class="op" id="3717967">==</span>&nbsp;<span class="ident" id="3717970"><a href="/encoding/json/scanner.go.html#3702831">scanEnd</a></span>&nbsp;<span class="op" id="3717978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717985">break</span>&nbsp;<span class="ident" id="3717991">Input</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718007">if</span>&nbsp;<span class="ident" id="3718010"><a href="/encoding/json/stream.go.html#3718532">nonSpace</a></span><span class="op" id="3718018">(</span><span class="ident" id="3718019"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718022">.</span><span class="ident" id="3718023">buf</span><span class="op" id="3718026">)</span>&nbsp;<span class="op" id="3718028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718035"><a href="/encoding/json/stream.go.html#3717214">err</a></span>&nbsp;<span class="op" id="3718039">=</span>&nbsp;<span class="ident" id="3718041"><a href="/encoding/json/stream.go.html#3715576">io</a></span><span class="op" id="3718043">.</span><span class="ident" id="3718044">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718070">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718075"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718078">.</span><span class="ident" id="3718079">err</span>&nbsp;<span class="op" id="3718083">=</span>&nbsp;<span class="ident" id="3718085"><a href="/encoding/json/stream.go.html#3717214">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718092">return</span>&nbsp;<span class="num" id="3718099">0</span><span class="op" id="3718100">,</span>&nbsp;<span class="ident" id="3718102"><a href="/encoding/json/stream.go.html#3717214">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3718113">//&nbsp;Make&nbsp;room&nbsp;to&nbsp;read&nbsp;more&nbsp;into&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718158">const</span>&nbsp;<span class="ident" id="3718164">minRead</span>&nbsp;<span class="op" id="3718172">=</span>&nbsp;<span class="num" id="3718174">512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718180">if</span>&nbsp;<span class="builtinfunc" id="3718183">cap</span><span class="op" id="3718186">(</span><span class="ident" id="3718187"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718190">.</span><span class="ident" id="3718191">buf</span><span class="op" id="3718194">)</span><span class="op" id="3718195">-</span><span class="builtinfunc" id="3718196">len</span><span class="op" id="3718199">(</span><span class="ident" id="3718200"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718203">.</span><span class="ident" id="3718204">buf</span><span class="op" id="3718207">)</span>&nbsp;<span class="op" id="3718209">&lt;</span>&nbsp;<span class="ident" id="3718211"><a href="/encoding/json/stream.go.html#3718164">minRead</a></span>&nbsp;<span class="op" id="3718219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718224">newBuf</span>&nbsp;<span class="op" id="3718231">:=</span>&nbsp;<span class="builtinfunc" id="3718234">make</span><span class="op" id="3718238">(</span><span class="op" id="3718239">[</span><span class="op" id="3718240">]</span><span class="builtintype" id="3718241">byte</span><span class="op" id="3718245">,</span>&nbsp;<span class="builtinfunc" id="3718247">len</span><span class="op" id="3718250">(</span><span class="ident" id="3718251"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718254">.</span><span class="ident" id="3718255">buf</span><span class="op" id="3718258">)</span><span class="op" id="3718259">,</span>&nbsp;<span class="num" id="3718261">2</span><span class="op" id="3718262">*</span><span class="builtinfunc" id="3718263">cap</span><span class="op" id="3718266">(</span><span class="ident" id="3718267"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718270">.</span><span class="ident" id="3718271">buf</span><span class="op" id="3718274">)</span><span class="op" id="3718275">+</span><span class="ident" id="3718276"><a href="/encoding/json/stream.go.html#3718164">minRead</a></span><span class="op" id="3718283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3718288">copy</span><span class="op" id="3718292">(</span><span class="ident" id="3718293"><a href="/encoding/json/stream.go.html#3718224">newBuf</a></span><span class="op" id="3718299">,</span>&nbsp;<span class="ident" id="3718301"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718304">.</span><span class="ident" id="3718305">buf</span><span class="op" id="3718308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718313"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718316">.</span><span class="ident" id="3718317">buf</span>&nbsp;<span class="op" id="3718321">=</span>&nbsp;<span class="ident" id="3718323"><a href="/encoding/json/stream.go.html#3718224">newBuf</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3718337">//&nbsp;Read.&nbsp;&nbsp;Delay&nbsp;error&nbsp;for&nbsp;next&nbsp;iteration&nbsp;(after&nbsp;scan).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718394">var</span>&nbsp;<span class="ident" id="3718398">n</span>&nbsp;<span class="builtintype" id="3718400">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718406"><a href="/encoding/json/stream.go.html#3718398">n</a></span><span class="op" id="3718407">,</span>&nbsp;<span class="ident" id="3718409"><a href="/encoding/json/stream.go.html#3717214">err</a></span>&nbsp;<span class="op" id="3718413">=</span>&nbsp;<span class="ident" id="3718415"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718418">.</span><span class="ident" id="3718419">r</span><span class="op" id="3718420">.</span><span class="ident" id="3718421">Read</span><span class="op" id="3718425">(</span><span class="ident" id="3718426"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718429">.</span><span class="ident" id="3718430">buf</span><span class="op" id="3718433">[</span><span class="builtinfunc" id="3718434">len</span><span class="op" id="3718437">(</span><span class="ident" id="3718438"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718441">.</span><span class="ident" id="3718442">buf</span><span class="op" id="3718445">)</span><span class="op" id="3718446">:</span><span class="builtinfunc" id="3718447">cap</span><span class="op" id="3718450">(</span><span class="ident" id="3718451"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718454">.</span><span class="ident" id="3718455">buf</span><span class="op" id="3718458">)</span><span class="op" id="3718459">]</span><span class="op" id="3718460">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718464"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718467">.</span><span class="ident" id="3718468">buf</span>&nbsp;<span class="op" id="3718472">=</span>&nbsp;<span class="ident" id="3718474"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718477">.</span><span class="ident" id="3718478">buf</span><span class="op" id="3718481">[</span><span class="num" id="3718482">0</span>&nbsp;<span class="op" id="3718484">:</span>&nbsp;<span class="builtinfunc" id="3718486">len</span><span class="op" id="3718489">(</span><span class="ident" id="3718490"><a href="/encoding/json/stream.go.html#3717137">dec</a></span><span class="op" id="3718493">.</span><span class="ident" id="3718494">buf</span><span class="op" id="3718497">)</span><span class="op" id="3718498">+</span><span class="ident" id="3718499"><a href="/encoding/json/stream.go.html#3718398">n</a></span><span class="op" id="3718500">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718506">return</span>&nbsp;<span class="ident" id="3718513"><a href="/encoding/json/stream.go.html#3717198">scanp</a></span><span class="op" id="3718518">,</span>&nbsp;<span class="ident" id="3718520">nil</span><br>
<span class="lineno"></span><span class="op" id="3718524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="3718527">func</span>&nbsp;<span class="ident" id="3718532">nonSpace</span><span class="op" id="3718540">(</span><span class="ident" id="3718541">b</span>&nbsp;<span class="op" id="3718543">[</span><span class="op" id="3718544">]</span><span class="builtintype" id="3718545">byte</span><span class="op" id="3718549">)</span>&nbsp;<span class="builtintype" id="3718551">bool</span>&nbsp;<span class="op" id="3718556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718559">for</span>&nbsp;<span class="ident" id="3718563">_</span><span class="op" id="3718564">,</span>&nbsp;<span class="ident" id="3718566">c</span>&nbsp;<span class="op" id="3718568">:=</span>&nbsp;<span class="keyword" id="3718571">range</span>&nbsp;<span class="ident" id="3718577"><a href="/encoding/json/stream.go.html#3718541">b</a></span>&nbsp;<span class="op" id="3718579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718583">if</span>&nbsp;<span class="op" id="3718586">!</span><span class="ident" id="3718587"><a href="/encoding/json/scanner.go.html#3704445">isSpace</a></span><span class="op" id="3718594">(</span><span class="builtintype" id="3718595">rune</span><span class="op" id="3718599">(</span><span class="ident" id="3718600"><a href="/encoding/json/stream.go.html#3718566">c</a></span><span class="op" id="3718601">)</span><span class="op" id="3718602">)</span>&nbsp;<span class="op" id="3718604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718609">return</span>&nbsp;<span class="ident" id="3718616">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718623">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718629">return</span>&nbsp;<span class="ident" id="3718636">false</span><br>
<span class="lineno"></span><span class="op" id="3718642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3718645">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;JSON&nbsp;objects&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno">140</span><span class="keyword" id="3718700">type</span>&nbsp;<span class="ident" id="3718705">Encoder</span>&nbsp;<span class="keyword" id="3718713">struct</span>&nbsp;<span class="op" id="3718720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718723">w</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3718727"><a href="/encoding/json/stream.go.html#3715576">io</a></span><span class="op" id="3718729">.</span><span class="ident" id="3718730">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718738">err</span>&nbsp;<span class="builtintype" id="3718742">error</span><br>
<span class="lineno"></span><span class="op" id="3718748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="3718751">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="3718805">func</span>&nbsp;<span class="ident" id="3718810">NewEncoder</span><span class="op" id="3718820">(</span><span class="ident" id="3718821">w</span>&nbsp;<span class="ident" id="3718823"><a href="/encoding/json/stream.go.html#3715576">io</a></span><span class="op" id="3718825">.</span><span class="ident" id="3718826">Writer</span><span class="op" id="3718832">)</span>&nbsp;<span class="op" id="3718834">*</span><span class="ident" id="3718835"><a href="/encoding/json/stream.go.html#3718705">Encoder</a></span>&nbsp;<span class="op" id="3718843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718846">return</span>&nbsp;<span class="op" id="3718853">&amp;</span><span class="ident" id="3718854"><a href="/encoding/json/stream.go.html#3718705">Encoder</a></span><span class="op" id="3718861">{</span><span class="ident" id="3718862">w</span><span class="op" id="3718863">:</span>&nbsp;<span class="ident" id="3718865"><a href="/encoding/json/stream.go.html#3718821">w</a></span><span class="op" id="3718866">}</span><br>
<span class="lineno"></span><span class="op" id="3718868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3718871">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;JSON&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="3718926">//&nbsp;followed&nbsp;by&nbsp;a&nbsp;newline&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3718962">//</span><br>
<span class="lineno"></span><span class="comment" id="3718965">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3719024">//&nbsp;conversion&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;JSON.</span><br>
<span class="lineno">155</span><span class="keyword" id="3719060">func</span>&nbsp;<span class="op" id="3719065">(</span><span class="ident" id="3719066">enc</span>&nbsp;<span class="op" id="3719070">*</span><span class="ident" id="3719071"><a href="/encoding/json/stream.go.html#3718705">Encoder</a></span><span class="op" id="3719078">)</span>&nbsp;<span class="ident" id="3719080">Encode</span><span class="op" id="3719086">(</span><span class="ident" id="3719087">v</span>&nbsp;<span class="keyword" id="3719089">interface</span><span class="op" id="3719098">{</span><span class="op" id="3719099">}</span><span class="op" id="3719100">)</span>&nbsp;<span class="builtintype" id="3719102">error</span>&nbsp;<span class="op" id="3719108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719111">if</span>&nbsp;<span class="ident" id="3719114"><a href="/encoding/json/stream.go.html#3719066">enc</a></span><span class="op" id="3719117">.</span><span class="ident" id="3719118">err</span>&nbsp;<span class="op" id="3719122">!=</span>&nbsp;<span class="ident" id="3719125">nil</span>&nbsp;<span class="op" id="3719129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719133">return</span>&nbsp;<span class="ident" id="3719140"><a href="/encoding/json/stream.go.html#3719066">enc</a></span><span class="op" id="3719143">.</span><span class="ident" id="3719144">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3719149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719152">e</span>&nbsp;<span class="op" id="3719154">:=</span>&nbsp;<span class="ident" id="3719157"><a href="/encoding/json/encode.go.html#3669684">newEncodeState</a></span><span class="op" id="3719171">(</span><span class="op" id="3719172">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719175">err</span>&nbsp;<span class="op" id="3719179">:=</span>&nbsp;<span class="ident" id="3719182"><a href="/encoding/json/stream.go.html#3719152">e</a></span><span class="op" id="3719183">.</span><span class="ident" id="3719184">marshal</span><span class="op" id="3719191">(</span><span class="ident" id="3719192"><a href="/encoding/json/stream.go.html#3719087">v</a></span><span class="op" id="3719193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719196">if</span>&nbsp;<span class="ident" id="3719199"><a href="/encoding/json/stream.go.html#3719175">err</a></span>&nbsp;<span class="op" id="3719203">!=</span>&nbsp;<span class="ident" id="3719206">nil</span>&nbsp;<span class="op" id="3719210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719214">return</span>&nbsp;<span class="ident" id="3719221"><a href="/encoding/json/stream.go.html#3719175">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3719226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3719230">//&nbsp;Terminate&nbsp;each&nbsp;value&nbsp;with&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3719271">//&nbsp;This&nbsp;makes&nbsp;the&nbsp;output&nbsp;look&nbsp;a&nbsp;little&nbsp;nicer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3719317">//&nbsp;when&nbsp;debugging,&nbsp;and&nbsp;some&nbsp;kind&nbsp;of&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3719360">//&nbsp;is&nbsp;required&nbsp;if&nbsp;the&nbsp;encoded&nbsp;value&nbsp;was&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3719411">//&nbsp;so&nbsp;that&nbsp;the&nbsp;reader&nbsp;knows&nbsp;there&nbsp;aren&#39;t&nbsp;more</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3719458">//&nbsp;digits&nbsp;coming.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719477"><a href="/encoding/json/stream.go.html#3719152">e</a></span><span class="op" id="3719478">.</span><span class="ident" id="3719479">WriteByte</span><span class="op" id="3719488">(</span><span class="string" id="3719489">&#39;\n&#39;</span><span class="op" id="3719493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719497">if</span>&nbsp;<span class="ident" id="3719500">_</span><span class="op" id="3719501">,</span>&nbsp;<span class="ident" id="3719503"><a href="/encoding/json/stream.go.html#3719175">err</a></span>&nbsp;<span class="op" id="3719507">=</span>&nbsp;<span class="ident" id="3719509"><a href="/encoding/json/stream.go.html#3719066">enc</a></span><span class="op" id="3719512">.</span><span class="ident" id="3719513">w</span><span class="op" id="3719514">.</span><span class="ident" id="3719515">Write</span><span class="op" id="3719520">(</span><span class="ident" id="3719521"><a href="/encoding/json/stream.go.html#3719152">e</a></span><span class="op" id="3719522">.</span><span class="ident" id="3719523">Bytes</span><span class="op" id="3719528">(</span><span class="op" id="3719529">)</span><span class="op" id="3719530">)</span><span class="op" id="3719531">;</span>&nbsp;<span class="ident" id="3719533"><a href="/encoding/json/stream.go.html#3719175">err</a></span>&nbsp;<span class="op" id="3719537">!=</span>&nbsp;<span class="ident" id="3719540">nil</span>&nbsp;<span class="op" id="3719544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719548"><a href="/encoding/json/stream.go.html#3719066">enc</a></span><span class="op" id="3719551">.</span><span class="ident" id="3719552">err</span>&nbsp;<span class="op" id="3719556">=</span>&nbsp;<span class="ident" id="3719558"><a href="/encoding/json/stream.go.html#3719175">err</a></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3719563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719566"><a href="/encoding/json/encode.go.html#3669652">encodeStatePool</a></span><span class="op" id="3719581">.</span><span class="ident" id="3719582">Put</span><span class="op" id="3719585">(</span><span class="ident" id="3719586"><a href="/encoding/json/stream.go.html#3719152">e</a></span><span class="op" id="3719587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719590">return</span>&nbsp;<span class="ident" id="3719597"><a href="/encoding/json/stream.go.html#3719175">err</a></span><br>
<span class="lineno"></span><span class="op" id="3719601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="3719604">//&nbsp;RawMessage&nbsp;is&nbsp;a&nbsp;raw&nbsp;encoded&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3719648">//&nbsp;It&nbsp;implements&nbsp;Marshaler&nbsp;and&nbsp;Unmarshaler&nbsp;and&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="3719699">//&nbsp;be&nbsp;used&nbsp;to&nbsp;delay&nbsp;JSON&nbsp;decoding&nbsp;or&nbsp;precompute&nbsp;a&nbsp;JSON&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="3719764">type</span>&nbsp;<span class="ident" id="3719769">RawMessage</span>&nbsp;<span class="op" id="3719780">[</span><span class="op" id="3719781">]</span><span class="builtintype" id="3719782">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="3719788">//&nbsp;MarshalJSON&nbsp;returns&nbsp;*m&nbsp;as&nbsp;the&nbsp;JSON&nbsp;encoding&nbsp;of&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="3719841">func</span>&nbsp;<span class="op" id="3719846">(</span><span class="ident" id="3719847">m</span>&nbsp;<span class="op" id="3719849">*</span><span class="ident" id="3719850"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><span class="op" id="3719860">)</span>&nbsp;<span class="ident" id="3719862">MarshalJSON</span><span class="op" id="3719873">(</span><span class="op" id="3719874">)</span>&nbsp;<span class="op" id="3719876">(</span><span class="op" id="3719877">[</span><span class="op" id="3719878">]</span><span class="builtintype" id="3719879">byte</span><span class="op" id="3719883">,</span>&nbsp;<span class="builtintype" id="3719885">error</span><span class="op" id="3719890">)</span>&nbsp;<span class="op" id="3719892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719895">return</span>&nbsp;<span class="op" id="3719902">*</span><span class="ident" id="3719903"><a href="/encoding/json/stream.go.html#3719847">m</a></span><span class="op" id="3719904">,</span>&nbsp;<span class="ident" id="3719906">nil</span><br>
<span class="lineno"></span><span class="op" id="3719910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="3719913">//&nbsp;UnmarshalJSON&nbsp;sets&nbsp;*m&nbsp;to&nbsp;a&nbsp;copy&nbsp;of&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3719957">func</span>&nbsp;<span class="op" id="3719962">(</span><span class="ident" id="3719963">m</span>&nbsp;<span class="op" id="3719965">*</span><span class="ident" id="3719966"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><span class="op" id="3719976">)</span>&nbsp;<span class="ident" id="3719978">UnmarshalJSON</span><span class="op" id="3719991">(</span><span class="ident" id="3719992">data</span>&nbsp;<span class="op" id="3719997">[</span><span class="op" id="3719998">]</span><span class="builtintype" id="3719999">byte</span><span class="op" id="3720003">)</span>&nbsp;<span class="builtintype" id="3720005">error</span>&nbsp;<span class="op" id="3720011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3720014">if</span>&nbsp;<span class="ident" id="3720017"><a href="/encoding/json/stream.go.html#3719963">m</a></span>&nbsp;<span class="op" id="3720019">==</span>&nbsp;<span class="ident" id="3720022">nil</span>&nbsp;<span class="op" id="3720026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3720030">return</span>&nbsp;<span class="ident" id="3720037"><a href="/encoding/json/stream.go.html#3715566">errors</a></span><span class="op" id="3720043">.</span><span class="ident" id="3720044">New</span><span class="op" id="3720047">(</span><span class="string" id="3720048">&#34;json.RawMessage:&nbsp;UnmarshalJSON&nbsp;on&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3720095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3720098">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3720101">*</span><span class="ident" id="3720102"><a href="/encoding/json/stream.go.html#3719963">m</a></span>&nbsp;<span class="op" id="3720104">=</span>&nbsp;<span class="builtinfunc" id="3720106">append</span><span class="op" id="3720112">(</span><span class="op" id="3720113">(</span><span class="op" id="3720114">*</span><span class="ident" id="3720115"><a href="/encoding/json/stream.go.html#3719963">m</a></span><span class="op" id="3720116">)</span><span class="op" id="3720117">[</span><span class="num" id="3720118">0</span><span class="op" id="3720119">:</span><span class="num" id="3720120">0</span><span class="op" id="3720121">]</span><span class="op" id="3720122">,</span>&nbsp;<span class="ident" id="3720124"><a href="/encoding/json/stream.go.html#3719992">data</a></span><span class="op" id="3720128">...</span><span class="op" id="3720131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3720134">return</span>&nbsp;<span class="ident" id="3720141">nil</span><br>
<span class="lineno"></span><span class="op" id="3720145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3720148">var</span>&nbsp;<span class="ident" id="3720152">_</span>&nbsp;<span class="ident" id="3720154"><a href="/encoding/json/encode.go.html#3668190">Marshaler</a></span>&nbsp;<span class="op" id="3720164">=</span>&nbsp;<span class="op" id="3720166">(</span><span class="op" id="3720167">*</span><span class="ident" id="3720168"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><span class="op" id="3720178">)</span><span class="op" id="3720179">(</span><span class="ident" id="3720180">nil</span><span class="op" id="3720183">)</span><br>
<span class="lineno">200</span><span class="keyword" id="3720185">var</span>&nbsp;<span class="ident" id="3720189">_</span>&nbsp;<span class="ident" id="3720191"><a href="/encoding/json/decode.go.html#3637521">Unmarshaler</a></span>&nbsp;<span class="op" id="3720203">=</span>&nbsp;<span class="op" id="3720205">(</span><span class="op" id="3720206">*</span><span class="ident" id="3720207"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><span class="op" id="3720217">)</span><span class="op" id="3720218">(</span><span class="ident" id="3720219">nil</span><span class="op" id="3720222">)</span>
</div>
</body>
</html>
