<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5409456">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5409511">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5409565">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5409616">package</span>&nbsp;<span class="ident" id="5409624">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5409634">import</span>&nbsp;<span class="op" id="5409641">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5409644">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="5409650">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5409653">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5409730">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="5409800">//</span><br>
<span class="lineno"></span><span class="comment" id="5409803">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5409878">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5409921">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="5409971">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="5410009">type</span>&nbsp;<span class="ident" id="5410014">context</span>&nbsp;<span class="keyword" id="5410022">struct</span>&nbsp;<span class="op" id="5410029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410032">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5410040">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410047">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5410055">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410062">urlPart</span>&nbsp;<span class="ident" id="5410070">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410079">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5410087">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410094">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5410102">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410108">element</span>&nbsp;<span class="ident" id="5410116">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410125">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5410133">*</span><span class="ident" id="5410134">Error</span><br>
<span class="lineno"></span><span class="op" id="5410140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5410143">func</span>&nbsp;<span class="op" id="5410148">(</span><span class="ident" id="5410149">c</span>&nbsp;<span class="ident" id="5410151">context</span><span class="op" id="5410158">)</span>&nbsp;<span class="ident" id="5410160">String</span><span class="op" id="5410166">(</span><span class="op" id="5410167">)</span>&nbsp;<span class="builtintype" id="5410169">string</span>&nbsp;<span class="op" id="5410176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410179">return</span>&nbsp;<span class="ident" id="5410186">fmt</span><span class="op" id="5410189">.</span><span class="ident" id="5410190">Sprintf</span><span class="op" id="5410197">(</span><span class="string" id="5410198">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="5410222">,</span>&nbsp;<span class="ident" id="5410224">c</span><span class="op" id="5410225">.</span><span class="ident" id="5410226">state</span><span class="op" id="5410231">,</span>&nbsp;<span class="ident" id="5410233">c</span><span class="op" id="5410234">.</span><span class="ident" id="5410235">delim</span><span class="op" id="5410240">,</span>&nbsp;<span class="ident" id="5410242">c</span><span class="op" id="5410243">.</span><span class="ident" id="5410244">urlPart</span><span class="op" id="5410251">,</span>&nbsp;<span class="ident" id="5410253">c</span><span class="op" id="5410254">.</span><span class="ident" id="5410255">jsCtx</span><span class="op" id="5410260">,</span>&nbsp;<span class="ident" id="5410262">c</span><span class="op" id="5410263">.</span><span class="ident" id="5410264">attr</span><span class="op" id="5410268">,</span>&nbsp;<span class="ident" id="5410270">c</span><span class="op" id="5410271">.</span><span class="ident" id="5410272">element</span><span class="op" id="5410279">,</span>&nbsp;<span class="ident" id="5410281">c</span><span class="op" id="5410282">.</span><span class="ident" id="5410283">err</span><span class="op" id="5410286">)</span><br>
<span class="lineno">30</span><span class="op" id="5410288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5410291">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="5410337">func</span>&nbsp;<span class="op" id="5410342">(</span><span class="ident" id="5410343">c</span>&nbsp;<span class="ident" id="5410345">context</span><span class="op" id="5410352">)</span>&nbsp;<span class="ident" id="5410354">eq</span><span class="op" id="5410356">(</span><span class="ident" id="5410357">d</span>&nbsp;<span class="ident" id="5410359">context</span><span class="op" id="5410366">)</span>&nbsp;<span class="builtintype" id="5410368">bool</span>&nbsp;<span class="op" id="5410373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410376">return</span>&nbsp;<span class="ident" id="5410383">c</span><span class="op" id="5410384">.</span><span class="ident" id="5410385">state</span>&nbsp;<span class="op" id="5410391">==</span>&nbsp;<span class="ident" id="5410394">d</span><span class="op" id="5410395">.</span><span class="ident" id="5410396">state</span>&nbsp;<span class="op" id="5410402">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410407">c</span><span class="op" id="5410408">.</span><span class="ident" id="5410409">delim</span>&nbsp;<span class="op" id="5410415">==</span>&nbsp;<span class="ident" id="5410418">d</span><span class="op" id="5410419">.</span><span class="ident" id="5410420">delim</span>&nbsp;<span class="op" id="5410426">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410431">c</span><span class="op" id="5410432">.</span><span class="ident" id="5410433">urlPart</span>&nbsp;<span class="op" id="5410441">==</span>&nbsp;<span class="ident" id="5410444">d</span><span class="op" id="5410445">.</span><span class="ident" id="5410446">urlPart</span>&nbsp;<span class="op" id="5410454">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410459">c</span><span class="op" id="5410460">.</span><span class="ident" id="5410461">jsCtx</span>&nbsp;<span class="op" id="5410467">==</span>&nbsp;<span class="ident" id="5410470">d</span><span class="op" id="5410471">.</span><span class="ident" id="5410472">jsCtx</span>&nbsp;<span class="op" id="5410478">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410483">c</span><span class="op" id="5410484">.</span><span class="ident" id="5410485">attr</span>&nbsp;<span class="op" id="5410490">==</span>&nbsp;<span class="ident" id="5410493">d</span><span class="op" id="5410494">.</span><span class="ident" id="5410495">attr</span>&nbsp;<span class="op" id="5410500">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410505">c</span><span class="op" id="5410506">.</span><span class="ident" id="5410507">element</span>&nbsp;<span class="op" id="5410515">==</span>&nbsp;<span class="ident" id="5410518">d</span><span class="op" id="5410519">.</span><span class="ident" id="5410520">element</span>&nbsp;<span class="op" id="5410528">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410533">c</span><span class="op" id="5410534">.</span><span class="ident" id="5410535">err</span>&nbsp;<span class="op" id="5410539">==</span>&nbsp;<span class="ident" id="5410542">d</span><span class="op" id="5410543">.</span><span class="ident" id="5410544">err</span><br>
<span class="lineno"></span><span class="op" id="5410548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5410551">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5410629">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="5410685">func</span>&nbsp;<span class="op" id="5410690">(</span><span class="ident" id="5410691">c</span>&nbsp;<span class="ident" id="5410693">context</span><span class="op" id="5410700">)</span>&nbsp;<span class="ident" id="5410702">mangle</span><span class="op" id="5410708">(</span><span class="ident" id="5410709">templateName</span>&nbsp;<span class="builtintype" id="5410722">string</span><span class="op" id="5410728">)</span>&nbsp;<span class="builtintype" id="5410730">string</span>&nbsp;<span class="op" id="5410737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5410740">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410812">if</span>&nbsp;<span class="ident" id="5410815">c</span><span class="op" id="5410816">.</span><span class="ident" id="5410817">state</span>&nbsp;<span class="op" id="5410823">==</span>&nbsp;<span class="ident" id="5410826">stateText</span>&nbsp;<span class="op" id="5410836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410840">return</span>&nbsp;<span class="ident" id="5410847">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5410861">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410864">s</span>&nbsp;<span class="op" id="5410866">:=</span>&nbsp;<span class="ident" id="5410869">templateName</span>&nbsp;<span class="op" id="5410882">+</span>&nbsp;<span class="string" id="5410884">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="5410901">+</span>&nbsp;<span class="ident" id="5410903">c</span><span class="op" id="5410904">.</span><span class="ident" id="5410905">state</span><span class="op" id="5410910">.</span><span class="ident" id="5410911">String</span><span class="op" id="5410917">(</span><span class="op" id="5410918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410921">if</span>&nbsp;<span class="ident" id="5410924">c</span><span class="op" id="5410925">.</span><span class="ident" id="5410926">delim</span>&nbsp;<span class="op" id="5410932">!=</span>&nbsp;<span class="num" id="5410935">0</span>&nbsp;<span class="op" id="5410937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410941">s</span>&nbsp;<span class="op" id="5410943">+=</span>&nbsp;<span class="string" id="5410946">&#34;_&#34;</span>&nbsp;<span class="op" id="5410950">+</span>&nbsp;<span class="ident" id="5410952">c</span><span class="op" id="5410953">.</span><span class="ident" id="5410954">delim</span><span class="op" id="5410959">.</span><span class="ident" id="5410960">String</span><span class="op" id="5410966">(</span><span class="op" id="5410967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5410970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410973">if</span>&nbsp;<span class="ident" id="5410976">c</span><span class="op" id="5410977">.</span><span class="ident" id="5410978">urlPart</span>&nbsp;<span class="op" id="5410986">!=</span>&nbsp;<span class="num" id="5410989">0</span>&nbsp;<span class="op" id="5410991">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410995">s</span>&nbsp;<span class="op" id="5410997">+=</span>&nbsp;<span class="string" id="5411000">&#34;_&#34;</span>&nbsp;<span class="op" id="5411004">+</span>&nbsp;<span class="ident" id="5411006">c</span><span class="op" id="5411007">.</span><span class="ident" id="5411008">urlPart</span><span class="op" id="5411015">.</span><span class="ident" id="5411016">String</span><span class="op" id="5411022">(</span><span class="op" id="5411023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411029">if</span>&nbsp;<span class="ident" id="5411032">c</span><span class="op" id="5411033">.</span><span class="ident" id="5411034">jsCtx</span>&nbsp;<span class="op" id="5411040">!=</span>&nbsp;<span class="num" id="5411043">0</span>&nbsp;<span class="op" id="5411045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411049">s</span>&nbsp;<span class="op" id="5411051">+=</span>&nbsp;<span class="string" id="5411054">&#34;_&#34;</span>&nbsp;<span class="op" id="5411058">+</span>&nbsp;<span class="ident" id="5411060">c</span><span class="op" id="5411061">.</span><span class="ident" id="5411062">jsCtx</span><span class="op" id="5411067">.</span><span class="ident" id="5411068">String</span><span class="op" id="5411074">(</span><span class="op" id="5411075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411078">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411081">if</span>&nbsp;<span class="ident" id="5411084">c</span><span class="op" id="5411085">.</span><span class="ident" id="5411086">attr</span>&nbsp;<span class="op" id="5411091">!=</span>&nbsp;<span class="num" id="5411094">0</span>&nbsp;<span class="op" id="5411096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411100">s</span>&nbsp;<span class="op" id="5411102">+=</span>&nbsp;<span class="string" id="5411105">&#34;_&#34;</span>&nbsp;<span class="op" id="5411109">+</span>&nbsp;<span class="ident" id="5411111">c</span><span class="op" id="5411112">.</span><span class="ident" id="5411113">attr</span><span class="op" id="5411117">.</span><span class="ident" id="5411118">String</span><span class="op" id="5411124">(</span><span class="op" id="5411125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411131">if</span>&nbsp;<span class="ident" id="5411134">c</span><span class="op" id="5411135">.</span><span class="ident" id="5411136">element</span>&nbsp;<span class="op" id="5411144">!=</span>&nbsp;<span class="num" id="5411147">0</span>&nbsp;<span class="op" id="5411149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411153">s</span>&nbsp;<span class="op" id="5411155">+=</span>&nbsp;<span class="string" id="5411158">&#34;_&#34;</span>&nbsp;<span class="op" id="5411162">+</span>&nbsp;<span class="ident" id="5411164">c</span><span class="op" id="5411165">.</span><span class="ident" id="5411166">element</span><span class="op" id="5411173">.</span><span class="ident" id="5411174">String</span><span class="op" id="5411180">(</span><span class="op" id="5411181">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411187">return</span>&nbsp;<span class="ident" id="5411194">s</span><br>
<span class="lineno"></span><span class="op" id="5411196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5411199">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="5411250">//</span><br>
<span class="lineno"></span><span class="comment" id="5411253">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="5411332">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5411409">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="5411482">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="5411562">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5411592">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="5411630">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5411708">type</span>&nbsp;<span class="ident" id="5411713">state</span>&nbsp;<span class="builtintype" id="5411719">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5411726">const</span>&nbsp;<span class="op" id="5411732">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5411735">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5411796">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5411859">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411909">stateText</span>&nbsp;<span class="ident" id="5411919">state</span>&nbsp;<span class="op" id="5411925">=</span>&nbsp;<span class="ident" id="5411927">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5411933">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411999">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412009">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412060">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412112">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412127">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412197">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412262">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412278">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412350">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412402">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412420">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412477">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412491">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412563">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412633">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412646">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412715">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412726">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412795">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412805">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412867">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412876">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5412942">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5412956">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413022">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413036">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413097">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413112">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413180">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413197">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413260">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413276">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413341">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413351">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413411">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413426">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413486">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413501">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413565">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413580">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413644">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413659">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413714">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413727">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413789">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413807">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413864">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413881">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5413943">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5413970">stateError</span><br>
<span class="lineno"></span><span class="op" id="5413981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5413984">var</span>&nbsp;<span class="ident" id="5413988">stateNames</span>&nbsp;<span class="op" id="5413999">=</span>&nbsp;<span class="op" id="5414001">[</span><span class="op" id="5414002">...</span><span class="op" id="5414005">]</span><span class="builtintype" id="5414006">string</span><span class="op" id="5414012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414015">stateText</span><span class="op" id="5414024">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414033">&#34;stateText&#34;</span><span class="op" id="5414044">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414047">stateTag</span><span class="op" id="5414055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414065">&#34;stateTag&#34;</span><span class="op" id="5414075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414078">stateAttrName</span><span class="op" id="5414091">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414096">&#34;stateAttrName&#34;</span><span class="op" id="5414111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414114">stateAfterName</span><span class="op" id="5414128">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5414132">&#34;stateAfterName&#34;</span><span class="op" id="5414148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414151">stateBeforeValue</span><span class="op" id="5414167">:</span>&nbsp;<span class="string" id="5414169">&#34;stateBeforeValue&#34;</span><span class="op" id="5414187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414190">stateHTMLCmt</span><span class="op" id="5414202">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414208">&#34;stateHTMLCmt&#34;</span><span class="op" id="5414222">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414225">stateRCDATA</span><span class="op" id="5414236">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414243">&#34;stateRCDATA&#34;</span><span class="op" id="5414256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414259">stateAttr</span><span class="op" id="5414268">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414277">&#34;stateAttr&#34;</span><span class="op" id="5414288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414291">stateURL</span><span class="op" id="5414299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414309">&#34;stateURL&#34;</span><span class="op" id="5414319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414322">stateJS</span><span class="op" id="5414329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414340">&#34;stateJS&#34;</span><span class="op" id="5414349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414352">stateJSDqStr</span><span class="op" id="5414364">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414370">&#34;stateJSDqStr&#34;</span><span class="op" id="5414384">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414387">stateJSSqStr</span><span class="op" id="5414399">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414405">&#34;stateJSSqStr&#34;</span><span class="op" id="5414419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414422">stateJSRegexp</span><span class="op" id="5414435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414440">&#34;stateJSRegexp&#34;</span><span class="op" id="5414455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414458">stateJSBlockCmt</span><span class="op" id="5414473">:</span>&nbsp;&nbsp;<span class="string" id="5414476">&#34;stateJSBlockCmt&#34;</span><span class="op" id="5414493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414496">stateJSLineCmt</span><span class="op" id="5414510">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5414514">&#34;stateJSLineCmt&#34;</span><span class="op" id="5414530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414533">stateCSS</span><span class="op" id="5414541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414551">&#34;stateCSS&#34;</span><span class="op" id="5414561">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414564">stateCSSDqStr</span><span class="op" id="5414577">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414582">&#34;stateCSSDqStr&#34;</span><span class="op" id="5414597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414600">stateCSSSqStr</span><span class="op" id="5414613">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414618">&#34;stateCSSSqStr&#34;</span><span class="op" id="5414633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414636">stateCSSDqURL</span><span class="op" id="5414649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414654">&#34;stateCSSDqURL&#34;</span><span class="op" id="5414669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414672">stateCSSSqURL</span><span class="op" id="5414685">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414690">&#34;stateCSSSqURL&#34;</span><span class="op" id="5414705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414708">stateCSSURL</span><span class="op" id="5414719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414726">&#34;stateCSSURL&#34;</span><span class="op" id="5414739">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414742">stateCSSBlockCmt</span><span class="op" id="5414758">:</span>&nbsp;<span class="string" id="5414760">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="5414778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414781">stateCSSLineCmt</span><span class="op" id="5414796">:</span>&nbsp;&nbsp;<span class="string" id="5414799">&#34;stateCSSLineCmt&#34;</span><span class="op" id="5414816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5414819">stateError</span><span class="op" id="5414829">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5414837">&#34;stateError&#34;</span><span class="op" id="5414849">,</span><br>
<span class="lineno"></span><span class="op" id="5414851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5414854">func</span>&nbsp;<span class="op" id="5414859">(</span><span class="ident" id="5414860">s</span>&nbsp;<span class="ident" id="5414862">state</span><span class="op" id="5414867">)</span>&nbsp;<span class="ident" id="5414869">String</span><span class="op" id="5414875">(</span><span class="op" id="5414876">)</span>&nbsp;<span class="builtintype" id="5414878">string</span>&nbsp;<span class="op" id="5414885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5414888">if</span>&nbsp;<span class="builtintype" id="5414891">int</span><span class="op" id="5414894">(</span><span class="ident" id="5414895">s</span><span class="op" id="5414896">)</span>&nbsp;<span class="op" id="5414898">&lt;</span>&nbsp;<span class="builtinfunc" id="5414900">len</span><span class="op" id="5414903">(</span><span class="ident" id="5414904">stateNames</span><span class="op" id="5414914">)</span>&nbsp;<span class="op" id="5414916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5414920">return</span>&nbsp;<span class="ident" id="5414927">stateNames</span><span class="op" id="5414937">[</span><span class="ident" id="5414938">s</span><span class="op" id="5414939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5414942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5414945">return</span>&nbsp;<span class="ident" id="5414952">fmt</span><span class="op" id="5414955">.</span><span class="ident" id="5414956">Sprintf</span><span class="op" id="5414963">(</span><span class="string" id="5414964">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="5414982">,</span>&nbsp;<span class="builtintype" id="5414984">int</span><span class="op" id="5414987">(</span><span class="ident" id="5414988">s</span><span class="op" id="5414989">)</span><span class="op" id="5414990">)</span><br>
<span class="lineno">170</span><span class="op" id="5414992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414995">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5415071">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="5415128">func</span>&nbsp;<span class="ident" id="5415133">isComment</span><span class="op" id="5415142">(</span><span class="ident" id="5415143">s</span>&nbsp;<span class="ident" id="5415145">state</span><span class="op" id="5415150">)</span>&nbsp;<span class="builtintype" id="5415152">bool</span>&nbsp;<span class="op" id="5415157">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415160">switch</span>&nbsp;<span class="ident" id="5415167">s</span>&nbsp;<span class="op" id="5415169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415172">case</span>&nbsp;<span class="ident" id="5415177">stateHTMLCmt</span><span class="op" id="5415189">,</span>&nbsp;<span class="ident" id="5415191">stateJSBlockCmt</span><span class="op" id="5415206">,</span>&nbsp;<span class="ident" id="5415208">stateJSLineCmt</span><span class="op" id="5415222">,</span>&nbsp;<span class="ident" id="5415224">stateCSSBlockCmt</span><span class="op" id="5415240">,</span>&nbsp;<span class="ident" id="5415242">stateCSSLineCmt</span><span class="op" id="5415257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415261">return</span>&nbsp;<span class="builtintype" id="5415268">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5415274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415277">return</span>&nbsp;<span class="builtintype" id="5415284">false</span><br>
<span class="lineno">180</span><span class="op" id="5415290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5415293">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5415355">func</span>&nbsp;<span class="ident" id="5415360">isInTag</span><span class="op" id="5415367">(</span><span class="ident" id="5415368">s</span>&nbsp;<span class="ident" id="5415370">state</span><span class="op" id="5415375">)</span>&nbsp;<span class="builtintype" id="5415377">bool</span>&nbsp;<span class="op" id="5415382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415385">switch</span>&nbsp;<span class="ident" id="5415392">s</span>&nbsp;<span class="op" id="5415394">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415397">case</span>&nbsp;<span class="ident" id="5415402">stateTag</span><span class="op" id="5415410">,</span>&nbsp;<span class="ident" id="5415412">stateAttrName</span><span class="op" id="5415425">,</span>&nbsp;<span class="ident" id="5415427">stateAfterName</span><span class="op" id="5415441">,</span>&nbsp;<span class="ident" id="5415443">stateBeforeValue</span><span class="op" id="5415459">,</span>&nbsp;<span class="ident" id="5415461">stateAttr</span><span class="op" id="5415470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415474">return</span>&nbsp;<span class="builtintype" id="5415481">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5415487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5415490">return</span>&nbsp;<span class="builtintype" id="5415497">false</span><br>
<span class="lineno"></span><span class="op" id="5415503">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5415506">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="5415574">type</span>&nbsp;<span class="ident" id="5415579">delim</span>&nbsp;<span class="builtintype" id="5415585">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5415592">const</span>&nbsp;<span class="op" id="5415598">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5415601">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415645">delimNone</span>&nbsp;<span class="ident" id="5415655">delim</span>&nbsp;<span class="op" id="5415661">=</span>&nbsp;<span class="ident" id="5415663">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5415669">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415743">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5415761">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415835">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5415853">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5415923">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5415949">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="5415968">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="5415971">var</span>&nbsp;<span class="ident" id="5415975">delimNames</span>&nbsp;<span class="op" id="5415986">=</span>&nbsp;<span class="op" id="5415988">[</span><span class="op" id="5415989">...</span><span class="op" id="5415992">]</span><span class="builtintype" id="5415993">string</span><span class="op" id="5415999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416002">delimNone</span><span class="op" id="5416011">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5416022">&#34;delimNone&#34;</span><span class="op" id="5416033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416036">delimDoubleQuote</span><span class="op" id="5416052">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5416056">&#34;delimDoubleQuote&#34;</span><span class="op" id="5416074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416077">delimSingleQuote</span><span class="op" id="5416093">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5416097">&#34;delimSingleQuote&#34;</span><span class="op" id="5416115">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416118">delimSpaceOrTagEnd</span><span class="op" id="5416136">:</span>&nbsp;<span class="string" id="5416138">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="5416158">,</span><br>
<span class="lineno"></span><span class="op" id="5416160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5416163">func</span>&nbsp;<span class="op" id="5416168">(</span><span class="ident" id="5416169">d</span>&nbsp;<span class="ident" id="5416171">delim</span><span class="op" id="5416176">)</span>&nbsp;<span class="ident" id="5416178">String</span><span class="op" id="5416184">(</span><span class="op" id="5416185">)</span>&nbsp;<span class="builtintype" id="5416187">string</span>&nbsp;<span class="op" id="5416194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416197">if</span>&nbsp;<span class="builtintype" id="5416200">int</span><span class="op" id="5416203">(</span><span class="ident" id="5416204">d</span><span class="op" id="5416205">)</span>&nbsp;<span class="op" id="5416207">&lt;</span>&nbsp;<span class="builtinfunc" id="5416209">len</span><span class="op" id="5416212">(</span><span class="ident" id="5416213">delimNames</span><span class="op" id="5416223">)</span>&nbsp;<span class="op" id="5416225">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416229">return</span>&nbsp;<span class="ident" id="5416236">delimNames</span><span class="op" id="5416246">[</span><span class="ident" id="5416247">d</span><span class="op" id="5416248">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5416251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5416254">return</span>&nbsp;<span class="ident" id="5416261">fmt</span><span class="op" id="5416264">.</span><span class="ident" id="5416265">Sprintf</span><span class="op" id="5416272">(</span><span class="string" id="5416273">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="5416291">,</span>&nbsp;<span class="builtintype" id="5416293">int</span><span class="op" id="5416296">(</span><span class="ident" id="5416297">d</span><span class="op" id="5416298">)</span><span class="op" id="5416299">)</span><br>
<span class="lineno"></span><span class="op" id="5416301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5416304">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5416384">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="5416408">type</span>&nbsp;<span class="ident" id="5416413">urlPart</span>&nbsp;<span class="builtintype" id="5416421">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5416428">const</span>&nbsp;<span class="op" id="5416434">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416437">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416505">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416544">urlPartNone</span>&nbsp;<span class="ident" id="5416556">urlPart</span>&nbsp;<span class="op" id="5416564">=</span>&nbsp;<span class="ident" id="5416566">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416572">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416646">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416687">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416704">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416773">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416808">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416828">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5416897">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416928">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="5416943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5416946">var</span>&nbsp;<span class="ident" id="5416950">urlPartNames</span>&nbsp;<span class="op" id="5416963">=</span>&nbsp;<span class="op" id="5416965">[</span><span class="op" id="5416966">...</span><span class="op" id="5416969">]</span><span class="builtintype" id="5416970">string</span><span class="op" id="5416976">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5416979">urlPartNone</span><span class="op" id="5416990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5416999">&#34;urlPartNone&#34;</span><span class="op" id="5417012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417015">urlPartPreQuery</span><span class="op" id="5417030">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5417035">&#34;urlPartPreQuery&#34;</span><span class="op" id="5417052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417055">urlPartQueryOrFrag</span><span class="op" id="5417073">:</span>&nbsp;<span class="string" id="5417075">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="5417095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417098">urlPartUnknown</span><span class="op" id="5417112">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5417118">&#34;urlPartUnknown&#34;</span><span class="op" id="5417134">,</span><br>
<span class="lineno"></span><span class="op" id="5417136">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5417139">func</span>&nbsp;<span class="op" id="5417144">(</span><span class="ident" id="5417145">u</span>&nbsp;<span class="ident" id="5417147">urlPart</span><span class="op" id="5417154">)</span>&nbsp;<span class="ident" id="5417156">String</span><span class="op" id="5417162">(</span><span class="op" id="5417163">)</span>&nbsp;<span class="builtintype" id="5417165">string</span>&nbsp;<span class="op" id="5417172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417175">if</span>&nbsp;<span class="builtintype" id="5417178">int</span><span class="op" id="5417181">(</span><span class="ident" id="5417182">u</span><span class="op" id="5417183">)</span>&nbsp;<span class="op" id="5417185">&lt;</span>&nbsp;<span class="builtinfunc" id="5417187">len</span><span class="op" id="5417190">(</span><span class="ident" id="5417191">urlPartNames</span><span class="op" id="5417203">)</span>&nbsp;<span class="op" id="5417205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417209">return</span>&nbsp;<span class="ident" id="5417216">urlPartNames</span><span class="op" id="5417228">[</span><span class="ident" id="5417229">u</span><span class="op" id="5417230">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417233">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417236">return</span>&nbsp;<span class="ident" id="5417243">fmt</span><span class="op" id="5417246">.</span><span class="ident" id="5417247">Sprintf</span><span class="op" id="5417254">(</span><span class="string" id="5417255">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="5417275">,</span>&nbsp;<span class="builtintype" id="5417277">int</span><span class="op" id="5417280">(</span><span class="ident" id="5417281">u</span><span class="op" id="5417282">)</span><span class="op" id="5417283">)</span><br>
<span class="lineno"></span><span class="op" id="5417285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5417288">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5417363">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="5417385">type</span>&nbsp;<span class="ident" id="5417390">jsCtx</span>&nbsp;<span class="builtintype" id="5417396">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5417403">const</span>&nbsp;<span class="op" id="5417409">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5417412">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417477">jsCtxRegexp</span>&nbsp;<span class="ident" id="5417489">jsCtx</span>&nbsp;<span class="op" id="5417495">=</span>&nbsp;<span class="ident" id="5417497">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5417503">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417570">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5417582">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5417655">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="5417668">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="5417671">func</span>&nbsp;<span class="op" id="5417676">(</span><span class="ident" id="5417677">c</span>&nbsp;<span class="ident" id="5417679">jsCtx</span><span class="op" id="5417684">)</span>&nbsp;<span class="ident" id="5417686">String</span><span class="op" id="5417692">(</span><span class="op" id="5417693">)</span>&nbsp;<span class="builtintype" id="5417695">string</span>&nbsp;<span class="op" id="5417702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417705">switch</span>&nbsp;<span class="ident" id="5417712">c</span>&nbsp;<span class="op" id="5417714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417717">case</span>&nbsp;<span class="ident" id="5417722">jsCtxRegexp</span><span class="op" id="5417733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417737">return</span>&nbsp;<span class="string" id="5417744">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417759">case</span>&nbsp;<span class="ident" id="5417764">jsCtxDivOp</span><span class="op" id="5417774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417778">return</span>&nbsp;<span class="string" id="5417785">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417799">case</span>&nbsp;<span class="ident" id="5417804">jsCtxUnknown</span><span class="op" id="5417816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417820">return</span>&nbsp;<span class="string" id="5417827">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5417843">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5417846">return</span>&nbsp;<span class="ident" id="5417853">fmt</span><span class="op" id="5417856">.</span><span class="ident" id="5417857">Sprintf</span><span class="op" id="5417864">(</span><span class="string" id="5417865">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="5417883">,</span>&nbsp;<span class="builtintype" id="5417885">int</span><span class="op" id="5417888">(</span><span class="ident" id="5417889">c</span><span class="op" id="5417890">)</span><span class="op" id="5417891">)</span><br>
<span class="lineno"></span><span class="op" id="5417893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5417896">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="5417976">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="5418056">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5418130">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5418209">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5418240">type</span>&nbsp;<span class="ident" id="5418245">element</span>&nbsp;<span class="builtintype" id="5418253">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5418260">const</span>&nbsp;<span class="op" id="5418266">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5418269">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418339">elementNone</span>&nbsp;<span class="ident" id="5418351">element</span>&nbsp;<span class="op" id="5418359">=</span>&nbsp;<span class="ident" id="5418361">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5418367">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418431">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5418446">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418508">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5418522">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418588">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5418605">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418665">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="5418678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5418681">var</span>&nbsp;<span class="ident" id="5418685">elementNames</span>&nbsp;<span class="op" id="5418698">=</span>&nbsp;<span class="op" id="5418700">[</span><span class="op" id="5418701">...</span><span class="op" id="5418704">]</span><span class="builtintype" id="5418705">string</span><span class="op" id="5418711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418714">elementNone</span><span class="op" id="5418725">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5418731">&#34;elementNone&#34;</span><span class="op" id="5418744">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418747">elementScript</span><span class="op" id="5418760">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5418764">&#34;elementScript&#34;</span><span class="op" id="5418779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418782">elementStyle</span><span class="op" id="5418794">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5418799">&#34;elementStyle&#34;</span><span class="op" id="5418813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418816">elementTextarea</span><span class="op" id="5418831">:</span>&nbsp;<span class="string" id="5418833">&#34;elementTextarea&#34;</span><span class="op" id="5418850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5418853">elementTitle</span><span class="op" id="5418865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5418870">&#34;elementTitle&#34;</span><span class="op" id="5418884">,</span><br>
<span class="lineno"></span><span class="op" id="5418886">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="5418889">func</span>&nbsp;<span class="op" id="5418894">(</span><span class="ident" id="5418895">e</span>&nbsp;<span class="ident" id="5418897">element</span><span class="op" id="5418904">)</span>&nbsp;<span class="ident" id="5418906">String</span><span class="op" id="5418912">(</span><span class="op" id="5418913">)</span>&nbsp;<span class="builtintype" id="5418915">string</span>&nbsp;<span class="op" id="5418922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418925">if</span>&nbsp;<span class="builtintype" id="5418928">int</span><span class="op" id="5418931">(</span><span class="ident" id="5418932">e</span><span class="op" id="5418933">)</span>&nbsp;<span class="op" id="5418935">&lt;</span>&nbsp;<span class="builtinfunc" id="5418937">len</span><span class="op" id="5418940">(</span><span class="ident" id="5418941">elementNames</span><span class="op" id="5418953">)</span>&nbsp;<span class="op" id="5418955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418959">return</span>&nbsp;<span class="ident" id="5418966">elementNames</span><span class="op" id="5418978">[</span><span class="ident" id="5418979">e</span><span class="op" id="5418980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5418983">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5418986">return</span>&nbsp;<span class="ident" id="5418993">fmt</span><span class="op" id="5418996">.</span><span class="ident" id="5418997">Sprintf</span><span class="op" id="5419004">(</span><span class="string" id="5419005">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="5419025">,</span>&nbsp;<span class="builtintype" id="5419027">int</span><span class="op" id="5419030">(</span><span class="ident" id="5419031">e</span><span class="op" id="5419032">)</span><span class="op" id="5419033">)</span><br>
<span class="lineno"></span><span class="op" id="5419035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5419038">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5419113">type</span>&nbsp;<span class="ident" id="5419118">attr</span>&nbsp;<span class="builtintype" id="5419123">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5419130">const</span>&nbsp;<span class="op" id="5419136">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5419139">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419203">attrNone</span>&nbsp;<span class="ident" id="5419212">attr</span>&nbsp;<span class="op" id="5419217">=</span>&nbsp;<span class="ident" id="5419219">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5419225">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419283">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5419295">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419364">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5419375">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419437">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="5419445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5419448">var</span>&nbsp;<span class="ident" id="5419452">attrNames</span>&nbsp;<span class="op" id="5419462">=</span>&nbsp;<span class="op" id="5419464">[</span><span class="op" id="5419465">...</span><span class="op" id="5419468">]</span><span class="builtintype" id="5419469">string</span><span class="op" id="5419475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419478">attrNone</span><span class="op" id="5419486">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5419490">&#34;attrNone&#34;</span><span class="op" id="5419500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419503">attrScript</span><span class="op" id="5419513">:</span>&nbsp;<span class="string" id="5419515">&#34;attrScript&#34;</span><span class="op" id="5419527">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419530">attrStyle</span><span class="op" id="5419539">:</span>&nbsp;&nbsp;<span class="string" id="5419542">&#34;attrStyle&#34;</span><span class="op" id="5419553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5419556">attrURL</span><span class="op" id="5419563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5419568">&#34;attrURL&#34;</span><span class="op" id="5419577">,</span><br>
<span class="lineno"></span><span class="op" id="5419579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5419582">func</span>&nbsp;<span class="op" id="5419587">(</span><span class="ident" id="5419588">a</span>&nbsp;<span class="ident" id="5419590">attr</span><span class="op" id="5419594">)</span>&nbsp;<span class="ident" id="5419596">String</span><span class="op" id="5419602">(</span><span class="op" id="5419603">)</span>&nbsp;<span class="builtintype" id="5419605">string</span>&nbsp;<span class="op" id="5419612">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419615">if</span>&nbsp;<span class="builtintype" id="5419618">int</span><span class="op" id="5419621">(</span><span class="ident" id="5419622">a</span><span class="op" id="5419623">)</span>&nbsp;<span class="op" id="5419625">&lt;</span>&nbsp;<span class="builtinfunc" id="5419627">len</span><span class="op" id="5419630">(</span><span class="ident" id="5419631">attrNames</span><span class="op" id="5419640">)</span>&nbsp;<span class="op" id="5419642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419646">return</span>&nbsp;<span class="ident" id="5419653">attrNames</span><span class="op" id="5419662">[</span><span class="ident" id="5419663">a</span><span class="op" id="5419664">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5419667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5419670">return</span>&nbsp;<span class="ident" id="5419677">fmt</span><span class="op" id="5419680">.</span><span class="ident" id="5419681">Sprintf</span><span class="op" id="5419688">(</span><span class="string" id="5419689">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="5419706">,</span>&nbsp;<span class="builtintype" id="5419708">int</span><span class="op" id="5419711">(</span><span class="ident" id="5419712">a</span><span class="op" id="5419713">)</span><span class="op" id="5419714">)</span><br>
<span class="lineno"></span><span class="op" id="5419716">}</span>
</div>
</body>
</html>
