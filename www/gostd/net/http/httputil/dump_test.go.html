<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httputil</h2>
<ul>
<li><a href="/gostd/net/http/httputil/dump.go.html">dump.go</a></li>
<li><a href="/gostd/net/http/httputil/dump_test.go.html" class="current">dump_test.go</a></li>
<li><a href="/gostd/net/http/httputil/httputil.go.html">httputil.go</a></li>
<li><a href="/gostd/net/http/httputil/persist.go.html">persist.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy.go.html">reverseproxy.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy_test.go.html">reverseproxy_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8113602">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8113657">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8113711">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8113762">package</span>&nbsp;<span class="ident" id="8113770">httputil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8113780">import</span>&nbsp;<span class="op" id="8113787">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113790">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113799">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113806">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113812">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113825">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113837">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113848">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113859">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8113870">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8113880">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8113883">type</span>&nbsp;<span class="ident" id="8113888">dumpTest</span>&nbsp;<span class="keyword" id="8113897">struct</span>&nbsp;<span class="op" id="8113904">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113907">Req</span>&nbsp;&nbsp;<span class="ident" id="8113912">http</span><span class="op" id="8113916">.</span><span class="ident" id="8113917">Request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8113926">Body</span>&nbsp;<span class="keyword" id="8113931">interface</span><span class="op" id="8113940">{</span><span class="op" id="8113941">}</span>&nbsp;<span class="comment" id="8113943">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114009">WantDump</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8114021">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114029">WantDumpOut</span>&nbsp;<span class="builtintype" id="8114041">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114049">NoBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8114061">bool</span>&nbsp;<span class="comment" id="8114066">//&nbsp;if&nbsp;true,&nbsp;set&nbsp;DumpRequest{,Out}&nbsp;body&nbsp;to&nbsp;false</span><br>
<span class="lineno"></span><span class="op" id="8114114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8114117">var</span>&nbsp;<span class="ident" id="8114121">dumpTests</span>&nbsp;<span class="op" id="8114131">=</span>&nbsp;<span class="op" id="8114133">[</span><span class="op" id="8114134">]</span><span class="ident" id="8114135">dumpTest</span><span class="op" id="8114143">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8114147">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114203">Req</span><span class="op" id="8114206">:</span>&nbsp;<span class="ident" id="8114208">http</span><span class="op" id="8114212">.</span><span class="ident" id="8114213">Request</span><span class="op" id="8114220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114225">Method</span><span class="op" id="8114231">:</span>&nbsp;<span class="string" id="8114233">&#34;GET&#34;</span><span class="op" id="8114238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114243">URL</span><span class="op" id="8114246">:</span>&nbsp;<span class="op" id="8114248">&amp;</span><span class="ident" id="8114249">url</span><span class="op" id="8114252">.</span><span class="ident" id="8114253">URL</span><span class="op" id="8114256">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114262">Scheme</span><span class="op" id="8114268">:</span>&nbsp;<span class="string" id="8114270">&#34;http&#34;</span><span class="op" id="8114276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114282">Host</span><span class="op" id="8114286">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8114290">&#34;www.google.com&#34;</span><span class="op" id="8114306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114312">Path</span><span class="op" id="8114316">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8114320">&#34;/search&#34;</span><span class="op" id="8114329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114334">}</span><span class="op" id="8114335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114340">ProtoMajor</span><span class="op" id="8114350">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8114358">1</span><span class="op" id="8114359">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114364">ProtoMinor</span><span class="op" id="8114374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8114382">1</span><span class="op" id="8114383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114388">TransferEncoding</span><span class="op" id="8114404">:</span>&nbsp;<span class="op" id="8114406">[</span><span class="op" id="8114407">]</span><span class="builtintype" id="8114408">string</span><span class="op" id="8114414">{</span><span class="string" id="8114415">&#34;chunked&#34;</span><span class="op" id="8114424">}</span><span class="op" id="8114425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114429">}</span><span class="op" id="8114430">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114435">Body</span><span class="op" id="8114439">:</span>&nbsp;<span class="op" id="8114441">[</span><span class="op" id="8114442">]</span><span class="builtintype" id="8114443">byte</span><span class="op" id="8114447">(</span><span class="string" id="8114448">&#34;abcdef&#34;</span><span class="op" id="8114456">)</span><span class="op" id="8114457">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114462">WantDump</span><span class="op" id="8114470">:</span>&nbsp;<span class="string" id="8114472">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8114499">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8114504">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8114531">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8114536">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8114573">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114578">chunk</span><span class="op" id="8114583">(</span><span class="string" id="8114584">&#34;abcdef&#34;</span><span class="op" id="8114592">)</span>&nbsp;<span class="op" id="8114594">+</span>&nbsp;<span class="ident" id="8114596">chunk</span><span class="op" id="8114601">(</span><span class="string" id="8114602">&#34;&#34;</span><span class="op" id="8114604">)</span><span class="op" id="8114605">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114608">}</span><span class="op" id="8114609">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8114613">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8114696">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114730">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114734">Req</span><span class="op" id="8114737">:</span>&nbsp;<span class="ident" id="8114739">http</span><span class="op" id="8114743">.</span><span class="ident" id="8114744">Request</span><span class="op" id="8114751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114756">Method</span><span class="op" id="8114762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8114768">&#34;GET&#34;</span><span class="op" id="8114773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114778">URL</span><span class="op" id="8114781">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114790">mustParseURL</span><span class="op" id="8114802">(</span><span class="string" id="8114803">&#34;/foo&#34;</span><span class="op" id="8114809">)</span><span class="op" id="8114810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114815">ProtoMajor</span><span class="op" id="8114825">:</span>&nbsp;<span class="num" id="8114827">1</span><span class="op" id="8114828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114833">ProtoMinor</span><span class="op" id="8114843">:</span>&nbsp;<span class="num" id="8114845">0</span><span class="op" id="8114846">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114851">Header</span><span class="op" id="8114857">:</span>&nbsp;<span class="ident" id="8114859">http</span><span class="op" id="8114863">.</span><span class="ident" id="8114864">Header</span><span class="op" id="8114870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8114876">&#34;X-Foo&#34;</span><span class="op" id="8114883">:</span>&nbsp;<span class="op" id="8114885">[</span><span class="op" id="8114886">]</span><span class="builtintype" id="8114887">string</span><span class="op" id="8114893">{</span><span class="string" id="8114894">&#34;X-Bar&#34;</span><span class="op" id="8114901">}</span><span class="op" id="8114902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114907">}</span><span class="op" id="8114908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114912">}</span><span class="op" id="8114913">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114918">WantDump</span><span class="op" id="8114926">:</span>&nbsp;<span class="string" id="8114928">&#34;GET&nbsp;/foo&nbsp;HTTP/1.0\r\n&#34;</span>&nbsp;<span class="op" id="8114952">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8114957">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="8114979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114982">}</span><span class="op" id="8114983">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8114987">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8114991">Req</span><span class="op" id="8114994">:</span>&nbsp;<span class="op" id="8114996">*</span><span class="ident" id="8114997">mustNewRequest</span><span class="op" id="8115011">(</span><span class="string" id="8115012">&#34;GET&#34;</span><span class="op" id="8115017">,</span>&nbsp;<span class="string" id="8115019">&#34;http://example.com/foo&#34;</span><span class="op" id="8115043">,</span>&nbsp;<span class="builtintype" id="8115045">nil</span><span class="op" id="8115048">)</span><span class="op" id="8115049">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115054">WantDumpOut</span><span class="op" id="8115065">:</span>&nbsp;<span class="string" id="8115067">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8115091">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115096">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8115120">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115125">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8115163">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115168">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8115199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115202">}</span><span class="op" id="8115203">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8115207">//&nbsp;Test&nbsp;that&nbsp;an&nbsp;https&nbsp;URL&nbsp;doesn&#39;t&nbsp;try&nbsp;to&nbsp;do&nbsp;an&nbsp;SSL&nbsp;negotiation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8115271">//&nbsp;with&nbsp;a&nbsp;bytes.Buffer&nbsp;and&nbsp;hang&nbsp;with&nbsp;all&nbsp;goroutines&nbsp;not</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8115328">//&nbsp;runnable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115346">Req</span><span class="op" id="8115349">:</span>&nbsp;<span class="op" id="8115351">*</span><span class="ident" id="8115352">mustNewRequest</span><span class="op" id="8115366">(</span><span class="string" id="8115367">&#34;GET&#34;</span><span class="op" id="8115372">,</span>&nbsp;<span class="string" id="8115374">&#34;https://example.com/foo&#34;</span><span class="op" id="8115399">,</span>&nbsp;<span class="builtintype" id="8115401">nil</span><span class="op" id="8115404">)</span><span class="op" id="8115405">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115410">WantDumpOut</span><span class="op" id="8115421">:</span>&nbsp;<span class="string" id="8115423">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8115447">+</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115452">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8115476">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115481">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8115519">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115524">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8115555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115558">}</span><span class="op" id="8115559">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8115563">//&nbsp;Request&nbsp;with&nbsp;Body,&nbsp;but&nbsp;Dump&nbsp;requested&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115621">Req</span><span class="op" id="8115624">:</span>&nbsp;<span class="ident" id="8115626">http</span><span class="op" id="8115630">.</span><span class="ident" id="8115631">Request</span><span class="op" id="8115638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115643">Method</span><span class="op" id="8115649">:</span>&nbsp;<span class="string" id="8115651">&#34;POST&#34;</span><span class="op" id="8115657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115662">URL</span><span class="op" id="8115665">:</span>&nbsp;<span class="op" id="8115667">&amp;</span><span class="ident" id="8115668">url</span><span class="op" id="8115671">.</span><span class="ident" id="8115672">URL</span><span class="op" id="8115675">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115681">Scheme</span><span class="op" id="8115687">:</span>&nbsp;<span class="string" id="8115689">&#34;http&#34;</span><span class="op" id="8115695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115701">Host</span><span class="op" id="8115705">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8115709">&#34;post.tld&#34;</span><span class="op" id="8115719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115725">Path</span><span class="op" id="8115729">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8115733">&#34;/&#34;</span><span class="op" id="8115736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115741">}</span><span class="op" id="8115742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115747">ContentLength</span><span class="op" id="8115760">:</span>&nbsp;<span class="num" id="8115762">6</span><span class="op" id="8115763">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115768">ProtoMajor</span><span class="op" id="8115778">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8115783">1</span><span class="op" id="8115784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115789">ProtoMinor</span><span class="op" id="8115799">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8115804">1</span><span class="op" id="8115805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8115809">}</span><span class="op" id="8115810">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115815">Body</span><span class="op" id="8115819">:</span>&nbsp;<span class="op" id="8115821">[</span><span class="op" id="8115822">]</span><span class="builtintype" id="8115823">byte</span><span class="op" id="8115827">(</span><span class="string" id="8115828">&#34;abcdef&#34;</span><span class="op" id="8115836">)</span><span class="op" id="8115837">,</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8115842">WantDumpOut</span><span class="op" id="8115853">:</span>&nbsp;<span class="string" id="8115855">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8115877">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115882">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="8115903">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115908">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8115946">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115951">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8115975">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8115980">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8116011">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116016">NoBody</span><span class="op" id="8116022">:</span>&nbsp;<span class="builtintype" id="8116024">true</span><span class="op" id="8116028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116031">}</span><span class="op" id="8116032">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8116036">//&nbsp;Request&nbsp;with&nbsp;Body&nbsp;&gt;&nbsp;8196&nbsp;(default&nbsp;buffer&nbsp;size)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116091">Req</span><span class="op" id="8116094">:</span>&nbsp;<span class="ident" id="8116096">http</span><span class="op" id="8116100">.</span><span class="ident" id="8116101">Request</span><span class="op" id="8116108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116113">Method</span><span class="op" id="8116119">:</span>&nbsp;<span class="string" id="8116121">&#34;POST&#34;</span><span class="op" id="8116127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116132">URL</span><span class="op" id="8116135">:</span>&nbsp;<span class="op" id="8116137">&amp;</span><span class="ident" id="8116138">url</span><span class="op" id="8116141">.</span><span class="ident" id="8116142">URL</span><span class="op" id="8116145">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116151">Scheme</span><span class="op" id="8116157">:</span>&nbsp;<span class="string" id="8116159">&#34;http&#34;</span><span class="op" id="8116165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116171">Host</span><span class="op" id="8116175">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8116179">&#34;post.tld&#34;</span><span class="op" id="8116189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116195">Path</span><span class="op" id="8116199">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8116203">&#34;/&#34;</span><span class="op" id="8116206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116211">}</span><span class="op" id="8116212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116217">ContentLength</span><span class="op" id="8116230">:</span>&nbsp;<span class="num" id="8116232">8193</span><span class="op" id="8116236">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116241">ProtoMajor</span><span class="op" id="8116251">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116256">1</span><span class="op" id="8116257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116262">ProtoMinor</span><span class="op" id="8116272">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8116277">1</span><span class="op" id="8116278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116282">}</span><span class="op" id="8116283">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116288">Body</span><span class="op" id="8116292">:</span>&nbsp;<span class="ident" id="8116294">bytes</span><span class="op" id="8116299">.</span><span class="ident" id="8116300">Repeat</span><span class="op" id="8116306">(</span><span class="op" id="8116307">[</span><span class="op" id="8116308">]</span><span class="builtintype" id="8116309">byte</span><span class="op" id="8116313">(</span><span class="string" id="8116314">&#34;a&#34;</span><span class="op" id="8116317">)</span><span class="op" id="8116318">,</span>&nbsp;<span class="num" id="8116320">8193</span><span class="op" id="8116324">)</span><span class="op" id="8116325">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116330">WantDumpOut</span><span class="op" id="8116341">:</span>&nbsp;<span class="string" id="8116343">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8116365">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8116370">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="8116391">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8116396">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8116434">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8116439">&#34;Content-Length:&nbsp;8193\r\n&#34;</span>&nbsp;<span class="op" id="8116466">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8116471">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8116503">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116508">strings</span><span class="op" id="8116515">.</span><span class="ident" id="8116516">Repeat</span><span class="op" id="8116522">(</span><span class="string" id="8116523">&#34;a&#34;</span><span class="op" id="8116526">,</span>&nbsp;<span class="num" id="8116528">8193</span><span class="op" id="8116532">)</span><span class="op" id="8116533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116536">}</span><span class="op" id="8116537">,</span><br>
<span class="lineno"></span><span class="op" id="8116539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="8116542">func</span>&nbsp;<span class="ident" id="8116547">TestDumpRequest</span><span class="op" id="8116562">(</span><span class="ident" id="8116563">t</span>&nbsp;<span class="op" id="8116565">*</span><span class="ident" id="8116566">testing</span><span class="op" id="8116573">.</span><span class="ident" id="8116574">T</span><span class="op" id="8116575">)</span>&nbsp;<span class="op" id="8116577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116580">numg0</span>&nbsp;<span class="op" id="8116586">:=</span>&nbsp;<span class="ident" id="8116589">runtime</span><span class="op" id="8116596">.</span><span class="ident" id="8116597">NumGoroutine</span><span class="op" id="8116609">(</span><span class="op" id="8116610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116613">for</span>&nbsp;<span class="ident" id="8116617">i</span><span class="op" id="8116618">,</span>&nbsp;<span class="ident" id="8116620">tt</span>&nbsp;<span class="op" id="8116623">:=</span>&nbsp;<span class="keyword" id="8116626">range</span>&nbsp;<span class="ident" id="8116632">dumpTests</span>&nbsp;<span class="op" id="8116642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116646">setBody</span>&nbsp;<span class="op" id="8116654">:=</span>&nbsp;<span class="keyword" id="8116657">func</span><span class="op" id="8116661">(</span><span class="op" id="8116662">)</span>&nbsp;<span class="op" id="8116664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116669">if</span>&nbsp;<span class="ident" id="8116672">tt</span><span class="op" id="8116674">.</span><span class="ident" id="8116675">Body</span>&nbsp;<span class="op" id="8116680">==</span>&nbsp;<span class="builtintype" id="8116683">nil</span>&nbsp;<span class="op" id="8116687">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116693">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116708">switch</span>&nbsp;<span class="ident" id="8116715">b</span>&nbsp;<span class="op" id="8116717">:=</span>&nbsp;<span class="ident" id="8116720">tt</span><span class="op" id="8116722">.</span><span class="ident" id="8116723">Body</span><span class="op" id="8116727">.</span><span class="op" id="8116728">(</span><span class="keyword" id="8116729">type</span><span class="op" id="8116733">)</span>&nbsp;<span class="op" id="8116735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116740">case</span>&nbsp;<span class="op" id="8116745">[</span><span class="op" id="8116746">]</span><span class="builtintype" id="8116747">byte</span><span class="op" id="8116751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116757">tt</span><span class="op" id="8116759">.</span><span class="ident" id="8116760">Req</span><span class="op" id="8116763">.</span><span class="ident" id="8116764">Body</span>&nbsp;<span class="op" id="8116769">=</span>&nbsp;<span class="ident" id="8116771">ioutil</span><span class="op" id="8116777">.</span><span class="ident" id="8116778">NopCloser</span><span class="op" id="8116787">(</span><span class="ident" id="8116788">bytes</span><span class="op" id="8116793">.</span><span class="ident" id="8116794">NewReader</span><span class="op" id="8116803">(</span><span class="ident" id="8116804">b</span><span class="op" id="8116805">)</span><span class="op" id="8116806">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116811">case</span>&nbsp;<span class="keyword" id="8116816">func</span><span class="op" id="8116820">(</span><span class="op" id="8116821">)</span>&nbsp;<span class="ident" id="8116823">io</span><span class="op" id="8116825">.</span><span class="ident" id="8116826">ReadCloser</span><span class="op" id="8116836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116842">tt</span><span class="op" id="8116844">.</span><span class="ident" id="8116845">Req</span><span class="op" id="8116848">.</span><span class="ident" id="8116849">Body</span>&nbsp;<span class="op" id="8116854">=</span>&nbsp;<span class="ident" id="8116856">b</span><span class="op" id="8116857">(</span><span class="op" id="8116858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116863">default</span><span class="op" id="8116870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116876">t</span><span class="op" id="8116877">.</span><span class="ident" id="8116878">Fatalf</span><span class="op" id="8116884">(</span><span class="string" id="8116885">&#34;Test&nbsp;%d:&nbsp;unsupported&nbsp;Body&nbsp;of&nbsp;%T&#34;</span><span class="op" id="8116918">,</span>&nbsp;<span class="ident" id="8116920">i</span><span class="op" id="8116921">,</span>&nbsp;<span class="ident" id="8116923">tt</span><span class="op" id="8116925">.</span><span class="ident" id="8116926">Body</span><span class="op" id="8116930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116935">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8116939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116943">setBody</span><span class="op" id="8116950">(</span><span class="op" id="8116951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8116955">if</span>&nbsp;<span class="ident" id="8116958">tt</span><span class="op" id="8116960">.</span><span class="ident" id="8116961">Req</span><span class="op" id="8116964">.</span><span class="ident" id="8116965">Header</span>&nbsp;<span class="op" id="8116972">==</span>&nbsp;<span class="builtintype" id="8116975">nil</span>&nbsp;<span class="op" id="8116979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8116984">tt</span><span class="op" id="8116986">.</span><span class="ident" id="8116987">Req</span><span class="op" id="8116990">.</span><span class="ident" id="8116991">Header</span>&nbsp;<span class="op" id="8116998">=</span>&nbsp;<span class="builtinfunc" id="8117000">make</span><span class="op" id="8117004">(</span><span class="ident" id="8117005">http</span><span class="op" id="8117009">.</span><span class="ident" id="8117010">Header</span><span class="op" id="8117016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117020">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117025">if</span>&nbsp;<span class="ident" id="8117028">tt</span><span class="op" id="8117030">.</span><span class="ident" id="8117031">WantDump</span>&nbsp;<span class="op" id="8117040">!=</span>&nbsp;<span class="string" id="8117043">&#34;&#34;</span>&nbsp;<span class="op" id="8117046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117051">setBody</span><span class="op" id="8117058">(</span><span class="op" id="8117059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117064">dump</span><span class="op" id="8117068">,</span>&nbsp;<span class="ident" id="8117070">err</span>&nbsp;<span class="op" id="8117074">:=</span>&nbsp;<span class="ident" id="8117077">DumpRequest</span><span class="op" id="8117088">(</span><span class="op" id="8117089">&amp;</span><span class="ident" id="8117090">tt</span><span class="op" id="8117092">.</span><span class="ident" id="8117093">Req</span><span class="op" id="8117096">,</span>&nbsp;<span class="op" id="8117098">!</span><span class="ident" id="8117099">tt</span><span class="op" id="8117101">.</span><span class="ident" id="8117102">NoBody</span><span class="op" id="8117108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117113">if</span>&nbsp;<span class="ident" id="8117116">err</span>&nbsp;<span class="op" id="8117120">!=</span>&nbsp;<span class="builtintype" id="8117123">nil</span>&nbsp;<span class="op" id="8117127">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117133">t</span><span class="op" id="8117134">.</span><span class="ident" id="8117135">Errorf</span><span class="op" id="8117141">(</span><span class="string" id="8117142">&#34;DumpRequest&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8117163">,</span>&nbsp;<span class="ident" id="8117165">i</span><span class="op" id="8117166">,</span>&nbsp;<span class="ident" id="8117168">err</span><span class="op" id="8117171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117177">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117194">if</span>&nbsp;<span class="builtintype" id="8117197">string</span><span class="op" id="8117203">(</span><span class="ident" id="8117204">dump</span><span class="op" id="8117208">)</span>&nbsp;<span class="op" id="8117210">!=</span>&nbsp;<span class="ident" id="8117213">tt</span><span class="op" id="8117215">.</span><span class="ident" id="8117216">WantDump</span>&nbsp;<span class="op" id="8117225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117231">t</span><span class="op" id="8117232">.</span><span class="ident" id="8117233">Errorf</span><span class="op" id="8117239">(</span><span class="string" id="8117240">&#34;DumpRequest&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8117284">,</span>&nbsp;<span class="ident" id="8117286">i</span><span class="op" id="8117287">,</span>&nbsp;<span class="ident" id="8117289">tt</span><span class="op" id="8117291">.</span><span class="ident" id="8117292">WantDump</span><span class="op" id="8117300">,</span>&nbsp;<span class="builtintype" id="8117302">string</span><span class="op" id="8117308">(</span><span class="ident" id="8117309">dump</span><span class="op" id="8117313">)</span><span class="op" id="8117314">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117320">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117341">if</span>&nbsp;<span class="ident" id="8117344">tt</span><span class="op" id="8117346">.</span><span class="ident" id="8117347">WantDumpOut</span>&nbsp;<span class="op" id="8117359">!=</span>&nbsp;<span class="string" id="8117362">&#34;&#34;</span>&nbsp;<span class="op" id="8117365">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117370">setBody</span><span class="op" id="8117377">(</span><span class="op" id="8117378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117383">dump</span><span class="op" id="8117387">,</span>&nbsp;<span class="ident" id="8117389">err</span>&nbsp;<span class="op" id="8117393">:=</span>&nbsp;<span class="ident" id="8117396">DumpRequestOut</span><span class="op" id="8117410">(</span><span class="op" id="8117411">&amp;</span><span class="ident" id="8117412">tt</span><span class="op" id="8117414">.</span><span class="ident" id="8117415">Req</span><span class="op" id="8117418">,</span>&nbsp;<span class="op" id="8117420">!</span><span class="ident" id="8117421">tt</span><span class="op" id="8117423">.</span><span class="ident" id="8117424">NoBody</span><span class="op" id="8117430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117435">if</span>&nbsp;<span class="ident" id="8117438">err</span>&nbsp;<span class="op" id="8117442">!=</span>&nbsp;<span class="builtintype" id="8117445">nil</span>&nbsp;<span class="op" id="8117449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117455">t</span><span class="op" id="8117456">.</span><span class="ident" id="8117457">Errorf</span><span class="op" id="8117463">(</span><span class="string" id="8117464">&#34;DumpRequestOut&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8117488">,</span>&nbsp;<span class="ident" id="8117490">i</span><span class="op" id="8117491">,</span>&nbsp;<span class="ident" id="8117493">err</span><span class="op" id="8117496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117502">continue</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117519">if</span>&nbsp;<span class="builtintype" id="8117522">string</span><span class="op" id="8117528">(</span><span class="ident" id="8117529">dump</span><span class="op" id="8117533">)</span>&nbsp;<span class="op" id="8117535">!=</span>&nbsp;<span class="ident" id="8117538">tt</span><span class="op" id="8117540">.</span><span class="ident" id="8117541">WantDumpOut</span>&nbsp;<span class="op" id="8117553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117559">t</span><span class="op" id="8117560">.</span><span class="ident" id="8117561">Errorf</span><span class="op" id="8117567">(</span><span class="string" id="8117568">&#34;DumpRequestOut&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8117615">,</span>&nbsp;<span class="ident" id="8117617">i</span><span class="op" id="8117618">,</span>&nbsp;<span class="ident" id="8117620">tt</span><span class="op" id="8117622">.</span><span class="ident" id="8117623">WantDumpOut</span><span class="op" id="8117634">,</span>&nbsp;<span class="builtintype" id="8117636">string</span><span class="op" id="8117642">(</span><span class="ident" id="8117643">dump</span><span class="op" id="8117647">)</span><span class="op" id="8117648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117654">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117666">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117676">if</span>&nbsp;<span class="ident" id="8117679">dg</span>&nbsp;<span class="op" id="8117682">:=</span>&nbsp;<span class="ident" id="8117685">runtime</span><span class="op" id="8117692">.</span><span class="ident" id="8117693">NumGoroutine</span><span class="op" id="8117705">(</span><span class="op" id="8117706">)</span>&nbsp;<span class="op" id="8117708">-</span>&nbsp;<span class="ident" id="8117710">numg0</span><span class="op" id="8117715">;</span>&nbsp;<span class="ident" id="8117717">dg</span>&nbsp;<span class="op" id="8117720">&gt;</span>&nbsp;<span class="num" id="8117722">4</span>&nbsp;<span class="op" id="8117724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117728">buf</span>&nbsp;<span class="op" id="8117732">:=</span>&nbsp;<span class="builtinfunc" id="8117735">make</span><span class="op" id="8117739">(</span><span class="op" id="8117740">[</span><span class="op" id="8117741">]</span><span class="builtintype" id="8117742">byte</span><span class="op" id="8117746">,</span>&nbsp;<span class="num" id="8117748">4096</span><span class="op" id="8117752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117756">buf</span>&nbsp;<span class="op" id="8117760">=</span>&nbsp;<span class="ident" id="8117762">buf</span><span class="op" id="8117765">[</span><span class="op" id="8117766">:</span><span class="ident" id="8117767">runtime</span><span class="op" id="8117774">.</span><span class="ident" id="8117775">Stack</span><span class="op" id="8117780">(</span><span class="ident" id="8117781">buf</span><span class="op" id="8117784">,</span>&nbsp;<span class="builtintype" id="8117786">true</span><span class="op" id="8117790">)</span><span class="op" id="8117791">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117795">t</span><span class="op" id="8117796">.</span><span class="ident" id="8117797">Errorf</span><span class="op" id="8117803">(</span><span class="string" id="8117804">&#34;Unexpectedly&nbsp;large&nbsp;number&nbsp;of&nbsp;new&nbsp;goroutines:&nbsp;%d&nbsp;new:&nbsp;%s&#34;</span><span class="op" id="8117861">,</span>&nbsp;<span class="ident" id="8117863">dg</span><span class="op" id="8117865">,</span>&nbsp;<span class="ident" id="8117867">buf</span><span class="op" id="8117870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8117873">}</span><br>
<span class="lineno"></span><span class="op" id="8117875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8117878">func</span>&nbsp;<span class="ident" id="8117883">chunk</span><span class="op" id="8117888">(</span><span class="ident" id="8117889">s</span>&nbsp;<span class="builtintype" id="8117891">string</span><span class="op" id="8117897">)</span>&nbsp;<span class="builtintype" id="8117899">string</span>&nbsp;<span class="op" id="8117906">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8117909">return</span>&nbsp;<span class="ident" id="8117916">fmt</span><span class="op" id="8117919">.</span><span class="ident" id="8117920">Sprintf</span><span class="op" id="8117927">(</span><span class="string" id="8117928">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="8117942">,</span>&nbsp;<span class="builtinfunc" id="8117944">len</span><span class="op" id="8117947">(</span><span class="ident" id="8117948">s</span><span class="op" id="8117949">)</span><span class="op" id="8117950">,</span>&nbsp;<span class="ident" id="8117952">s</span><span class="op" id="8117953">)</span><br>
<span class="lineno"></span><span class="op" id="8117955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8117958">func</span>&nbsp;<span class="ident" id="8117963">mustParseURL</span><span class="op" id="8117975">(</span><span class="ident" id="8117976">s</span>&nbsp;<span class="builtintype" id="8117978">string</span><span class="op" id="8117984">)</span>&nbsp;<span class="op" id="8117986">*</span><span class="ident" id="8117987">url</span><span class="op" id="8117990">.</span><span class="ident" id="8117991">URL</span>&nbsp;<span class="op" id="8117995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8117998">u</span><span class="op" id="8117999">,</span>&nbsp;<span class="ident" id="8118001">err</span>&nbsp;<span class="op" id="8118005">:=</span>&nbsp;<span class="ident" id="8118008">url</span><span class="op" id="8118011">.</span><span class="ident" id="8118012">Parse</span><span class="op" id="8118017">(</span><span class="ident" id="8118018">s</span><span class="op" id="8118019">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8118022">if</span>&nbsp;<span class="ident" id="8118025">err</span>&nbsp;<span class="op" id="8118029">!=</span>&nbsp;<span class="builtintype" id="8118032">nil</span>&nbsp;<span class="op" id="8118036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8118040">panic</span><span class="op" id="8118045">(</span><span class="ident" id="8118046">fmt</span><span class="op" id="8118049">.</span><span class="ident" id="8118050">Sprintf</span><span class="op" id="8118057">(</span><span class="string" id="8118058">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8118084">,</span>&nbsp;<span class="ident" id="8118086">s</span><span class="op" id="8118087">,</span>&nbsp;<span class="ident" id="8118089">err</span><span class="op" id="8118092">)</span><span class="op" id="8118093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8118099">return</span>&nbsp;<span class="ident" id="8118106">u</span><br>
<span class="lineno"></span><span class="op" id="8118108">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="8118111">func</span>&nbsp;<span class="ident" id="8118116">mustNewRequest</span><span class="op" id="8118130">(</span><span class="ident" id="8118131">method</span><span class="op" id="8118137">,</span>&nbsp;<span class="ident" id="8118139">url</span>&nbsp;<span class="builtintype" id="8118143">string</span><span class="op" id="8118149">,</span>&nbsp;<span class="ident" id="8118151">body</span>&nbsp;<span class="ident" id="8118156">io</span><span class="op" id="8118158">.</span><span class="ident" id="8118159">Reader</span><span class="op" id="8118165">)</span>&nbsp;<span class="op" id="8118167">*</span><span class="ident" id="8118168">http</span><span class="op" id="8118172">.</span><span class="ident" id="8118173">Request</span>&nbsp;<span class="op" id="8118181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118184">req</span><span class="op" id="8118187">,</span>&nbsp;<span class="ident" id="8118189">err</span>&nbsp;<span class="op" id="8118193">:=</span>&nbsp;<span class="ident" id="8118196">http</span><span class="op" id="8118200">.</span><span class="ident" id="8118201">NewRequest</span><span class="op" id="8118211">(</span><span class="ident" id="8118212">method</span><span class="op" id="8118218">,</span>&nbsp;<span class="ident" id="8118220">url</span><span class="op" id="8118223">,</span>&nbsp;<span class="ident" id="8118225">body</span><span class="op" id="8118229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8118232">if</span>&nbsp;<span class="ident" id="8118235">err</span>&nbsp;<span class="op" id="8118239">!=</span>&nbsp;<span class="builtintype" id="8118242">nil</span>&nbsp;<span class="op" id="8118246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8118250">panic</span><span class="op" id="8118255">(</span><span class="ident" id="8118256">fmt</span><span class="op" id="8118259">.</span><span class="ident" id="8118260">Sprintf</span><span class="op" id="8118267">(</span><span class="string" id="8118268">&#34;NewRequest(%q,&nbsp;%q,&nbsp;%p)&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8118301">,</span>&nbsp;<span class="ident" id="8118303">method</span><span class="op" id="8118309">,</span>&nbsp;<span class="ident" id="8118311">url</span><span class="op" id="8118314">,</span>&nbsp;<span class="ident" id="8118316">body</span><span class="op" id="8118320">,</span>&nbsp;<span class="ident" id="8118322">err</span><span class="op" id="8118325">)</span><span class="op" id="8118326">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8118332">return</span>&nbsp;<span class="ident" id="8118339">req</span><br>
<span class="lineno"></span><span class="op" id="8118343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8118346">var</span>&nbsp;<span class="ident" id="8118350">dumpResTests</span>&nbsp;<span class="op" id="8118363">=</span>&nbsp;<span class="op" id="8118365">[</span><span class="op" id="8118366">]</span><span class="keyword" id="8118367">struct</span>&nbsp;<span class="op" id="8118374">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118377">res</span>&nbsp;&nbsp;<span class="op" id="8118382">*</span><span class="ident" id="8118383">http</span><span class="op" id="8118387">.</span><span class="ident" id="8118388">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118398">body</span>&nbsp;<span class="builtintype" id="8118403">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118409">want</span>&nbsp;<span class="builtintype" id="8118414">string</span><br>
<span class="lineno"></span><span class="op" id="8118421">}</span><span class="op" id="8118422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118425">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118429">res</span><span class="op" id="8118432">:</span>&nbsp;<span class="op" id="8118434">&amp;</span><span class="ident" id="8118435">http</span><span class="op" id="8118439">.</span><span class="ident" id="8118440">Response</span><span class="op" id="8118448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118453">Status</span><span class="op" id="8118459">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8118468">&#34;200&nbsp;OK&#34;</span><span class="op" id="8118476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118481">StatusCode</span><span class="op" id="8118491">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118496">200</span><span class="op" id="8118499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118504">Proto</span><span class="op" id="8118509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8118519">&#34;HTTP/1.1&#34;</span><span class="op" id="8118529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118534">ProtoMajor</span><span class="op" id="8118544">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118549">1</span><span class="op" id="8118550">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118555">ProtoMinor</span><span class="op" id="8118565">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118570">1</span><span class="op" id="8118571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118576">ContentLength</span><span class="op" id="8118589">:</span>&nbsp;<span class="num" id="8118591">50</span><span class="op" id="8118593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118598">Header</span><span class="op" id="8118604">:</span>&nbsp;<span class="ident" id="8118606">http</span><span class="op" id="8118610">.</span><span class="ident" id="8118611">Header</span><span class="op" id="8118617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8118623">&#34;Foo&#34;</span><span class="op" id="8118628">:</span>&nbsp;<span class="op" id="8118630">[</span><span class="op" id="8118631">]</span><span class="builtintype" id="8118632">string</span><span class="op" id="8118638">{</span><span class="string" id="8118639">&#34;Bar&#34;</span><span class="op" id="8118644">}</span><span class="op" id="8118645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118650">}</span><span class="op" id="8118651">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118656">Body</span><span class="op" id="8118660">:</span>&nbsp;<span class="ident" id="8118662">ioutil</span><span class="op" id="8118668">.</span><span class="ident" id="8118669">NopCloser</span><span class="op" id="8118678">(</span><span class="ident" id="8118679">strings</span><span class="op" id="8118686">.</span><span class="ident" id="8118687">NewReader</span><span class="op" id="8118696">(</span><span class="string" id="8118697">&#34;foo&#34;</span><span class="op" id="8118702">)</span><span class="op" id="8118703">)</span><span class="op" id="8118704">,</span>&nbsp;<span class="comment" id="8118706">//&nbsp;shouldn&#39;t&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118729">}</span><span class="op" id="8118730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118734">body</span><span class="op" id="8118738">:</span>&nbsp;<span class="builtintype" id="8118740">false</span><span class="op" id="8118745">,</span>&nbsp;<span class="comment" id="8118747">//&nbsp;to&nbsp;verify&nbsp;we&nbsp;see&nbsp;50,&nbsp;not&nbsp;empty&nbsp;or&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118789">want</span><span class="op" id="8118793">:</span>&nbsp;<span class="string" id="8118795">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Content-Length:&nbsp;50<br>
<span class="lineno">235</span>Foo:&nbsp;Bar`</span><span class="op" id="8118840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118843">}</span><span class="op" id="8118844">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8118848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118852">res</span><span class="op" id="8118855">:</span>&nbsp;<span class="op" id="8118857">&amp;</span><span class="ident" id="8118858">http</span><span class="op" id="8118862">.</span><span class="ident" id="8118863">Response</span><span class="op" id="8118871">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118876">Status</span><span class="op" id="8118882">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8118891">&#34;200&nbsp;OK&#34;</span><span class="op" id="8118899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118904">StatusCode</span><span class="op" id="8118914">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118919">200</span><span class="op" id="8118922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118927">Proto</span><span class="op" id="8118932">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8118942">&#34;HTTP/1.1&#34;</span><span class="op" id="8118952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118957">ProtoMajor</span><span class="op" id="8118967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118972">1</span><span class="op" id="8118973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118978">ProtoMinor</span><span class="op" id="8118988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8118993">1</span><span class="op" id="8118994">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8118999">ContentLength</span><span class="op" id="8119012">:</span>&nbsp;<span class="num" id="8119014">3</span><span class="op" id="8119015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119020">Body</span><span class="op" id="8119024">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119035">ioutil</span><span class="op" id="8119041">.</span><span class="ident" id="8119042">NopCloser</span><span class="op" id="8119051">(</span><span class="ident" id="8119052">strings</span><span class="op" id="8119059">.</span><span class="ident" id="8119060">NewReader</span><span class="op" id="8119069">(</span><span class="string" id="8119070">&#34;foo&#34;</span><span class="op" id="8119075">)</span><span class="op" id="8119076">)</span><span class="op" id="8119077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119081">}</span><span class="op" id="8119082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119086">body</span><span class="op" id="8119090">:</span>&nbsp;<span class="builtintype" id="8119092">true</span><span class="op" id="8119096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119100">want</span><span class="op" id="8119104">:</span>&nbsp;<span class="string" id="8119106">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno">250</span>Content-Length:&nbsp;3<br>
<span class="lineno"></span><br>
<span class="lineno"></span>foo`</span><span class="op" id="8119146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119149">}</span><span class="op" id="8119150">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119158">res</span><span class="op" id="8119161">:</span>&nbsp;<span class="op" id="8119163">&amp;</span><span class="ident" id="8119164">http</span><span class="op" id="8119168">.</span><span class="ident" id="8119169">Response</span><span class="op" id="8119177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119182">Status</span><span class="op" id="8119188">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8119200">&#34;200&nbsp;OK&#34;</span><span class="op" id="8119208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119213">StatusCode</span><span class="op" id="8119223">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8119231">200</span><span class="op" id="8119234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119239">Proto</span><span class="op" id="8119244">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8119257">&#34;HTTP/1.1&#34;</span><span class="op" id="8119267">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119272">ProtoMajor</span><span class="op" id="8119282">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8119290">1</span><span class="op" id="8119291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119296">ProtoMinor</span><span class="op" id="8119306">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8119314">1</span><span class="op" id="8119315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119320">ContentLength</span><span class="op" id="8119333">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119338">-</span><span class="num" id="8119339">1</span><span class="op" id="8119340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119345">Body</span><span class="op" id="8119349">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119363">ioutil</span><span class="op" id="8119369">.</span><span class="ident" id="8119370">NopCloser</span><span class="op" id="8119379">(</span><span class="ident" id="8119380">strings</span><span class="op" id="8119387">.</span><span class="ident" id="8119388">NewReader</span><span class="op" id="8119397">(</span><span class="string" id="8119398">&#34;foo&#34;</span><span class="op" id="8119403">)</span><span class="op" id="8119404">)</span><span class="op" id="8119405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119410">TransferEncoding</span><span class="op" id="8119426">:</span>&nbsp;<span class="op" id="8119428">[</span><span class="op" id="8119429">]</span><span class="builtintype" id="8119430">string</span><span class="op" id="8119436">{</span><span class="string" id="8119437">&#34;chunked&#34;</span><span class="op" id="8119446">}</span><span class="op" id="8119447">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119451">}</span><span class="op" id="8119452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119456">body</span><span class="op" id="8119460">:</span>&nbsp;<span class="builtintype" id="8119462">true</span><span class="op" id="8119466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119470">want</span><span class="op" id="8119474">:</span>&nbsp;<span class="string" id="8119476">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">270</span>3<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>0`</span><span class="op" id="8119529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119532">}</span><span class="op" id="8119533">,</span><br>
<span class="lineno"></span><span class="op" id="8119535">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="8119538">func</span>&nbsp;<span class="ident" id="8119543">TestDumpResponse</span><span class="op" id="8119559">(</span><span class="ident" id="8119560">t</span>&nbsp;<span class="op" id="8119562">*</span><span class="ident" id="8119563">testing</span><span class="op" id="8119570">.</span><span class="ident" id="8119571">T</span><span class="op" id="8119572">)</span>&nbsp;<span class="op" id="8119574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119577">for</span>&nbsp;<span class="ident" id="8119581">i</span><span class="op" id="8119582">,</span>&nbsp;<span class="ident" id="8119584">tt</span>&nbsp;<span class="op" id="8119587">:=</span>&nbsp;<span class="keyword" id="8119590">range</span>&nbsp;<span class="ident" id="8119596">dumpResTests</span>&nbsp;<span class="op" id="8119609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119613">gotb</span><span class="op" id="8119617">,</span>&nbsp;<span class="ident" id="8119619">err</span>&nbsp;<span class="op" id="8119623">:=</span>&nbsp;<span class="ident" id="8119626">DumpResponse</span><span class="op" id="8119638">(</span><span class="ident" id="8119639">tt</span><span class="op" id="8119641">.</span><span class="ident" id="8119642">res</span><span class="op" id="8119645">,</span>&nbsp;<span class="ident" id="8119647">tt</span><span class="op" id="8119649">.</span><span class="ident" id="8119650">body</span><span class="op" id="8119654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119658">if</span>&nbsp;<span class="ident" id="8119661">err</span>&nbsp;<span class="op" id="8119665">!=</span>&nbsp;<span class="builtintype" id="8119668">nil</span>&nbsp;<span class="op" id="8119672">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119677">t</span><span class="op" id="8119678">.</span><span class="ident" id="8119679">Errorf</span><span class="op" id="8119685">(</span><span class="string" id="8119686">&#34;%d.&nbsp;DumpResponse&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8119709">,</span>&nbsp;<span class="ident" id="8119711">i</span><span class="op" id="8119712">,</span>&nbsp;<span class="ident" id="8119714">err</span><span class="op" id="8119717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119722">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119737">got</span>&nbsp;<span class="op" id="8119741">:=</span>&nbsp;<span class="builtintype" id="8119744">string</span><span class="op" id="8119750">(</span><span class="ident" id="8119751">gotb</span><span class="op" id="8119755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119759">got</span>&nbsp;<span class="op" id="8119763">=</span>&nbsp;<span class="ident" id="8119765">strings</span><span class="op" id="8119772">.</span><span class="ident" id="8119773">TrimSpace</span><span class="op" id="8119782">(</span><span class="ident" id="8119783">got</span><span class="op" id="8119786">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119790">got</span>&nbsp;<span class="op" id="8119794">=</span>&nbsp;<span class="ident" id="8119796">strings</span><span class="op" id="8119803">.</span><span class="ident" id="8119804">Replace</span><span class="op" id="8119811">(</span><span class="ident" id="8119812">got</span><span class="op" id="8119815">,</span>&nbsp;<span class="string" id="8119817">&#34;\r&#34;</span><span class="op" id="8119821">,</span>&nbsp;<span class="string" id="8119823">&#34;&#34;</span><span class="op" id="8119825">,</span>&nbsp;<span class="op" id="8119827">-</span><span class="num" id="8119828">1</span><span class="op" id="8119829">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8119834">if</span>&nbsp;<span class="ident" id="8119837">got</span>&nbsp;<span class="op" id="8119841">!=</span>&nbsp;<span class="ident" id="8119844">tt</span><span class="op" id="8119846">.</span><span class="ident" id="8119847">want</span>&nbsp;<span class="op" id="8119852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8119857">t</span><span class="op" id="8119858">.</span><span class="ident" id="8119859">Errorf</span><span class="op" id="8119865">(</span><span class="string" id="8119866">&#34;%d.\nDumpResponse&nbsp;got:\n%s\n\nWant:\n%s\n&#34;</span><span class="op" id="8119909">,</span>&nbsp;<span class="ident" id="8119911">i</span><span class="op" id="8119912">,</span>&nbsp;<span class="ident" id="8119914">got</span><span class="op" id="8119917">,</span>&nbsp;<span class="ident" id="8119919">tt</span><span class="op" id="8119921">.</span><span class="ident" id="8119922">want</span><span class="op" id="8119926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119930">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8119933">}</span><br>
<span class="lineno"></span><span class="op" id="8119935">}</span>
</div>
</body>
</html>
