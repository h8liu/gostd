<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html" class="current">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4578965">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4579020">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4579074">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4579125">package</span>&nbsp;<span class="ident" id="4579133">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4579138">import</span>&nbsp;<span class="op" id="4579145">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579148">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579157">&#34;crypto/aes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579171">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579188">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579203">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579220">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579237">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4579247">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4579252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4579255">//&nbsp;sessionState&nbsp;contains&nbsp;the&nbsp;information&nbsp;that&nbsp;is&nbsp;serialized&nbsp;into&nbsp;a&nbsp;session</span><br>
<span class="lineno"></span><span class="comment" id="4579330">//&nbsp;ticket&nbsp;in&nbsp;order&nbsp;to&nbsp;later&nbsp;resume&nbsp;a&nbsp;connection.</span><br>
<span class="lineno">20</span><span class="keyword" id="4579379">type</span>&nbsp;<span class="ident" id="4579384">sessionState</span>&nbsp;<span class="keyword" id="4579397">struct</span>&nbsp;<span class="op" id="4579404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579407">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579420">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579428">cipherSuite</span>&nbsp;&nbsp;<span class="builtintype" id="4579441">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579449">masterSecret</span>&nbsp;<span class="op" id="4579462">[</span><span class="op" id="4579463">]</span><span class="builtintype" id="4579464">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579470">certificates</span>&nbsp;<span class="op" id="4579483">[</span><span class="op" id="4579484">]</span><span class="op" id="4579485">[</span><span class="op" id="4579486">]</span><span class="builtintype" id="4579487">byte</span><br>
<span class="lineno">25</span><span class="op" id="4579492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4579495">func</span>&nbsp;<span class="op" id="4579500">(</span><span class="ident" id="4579501">s</span>&nbsp;<span class="op" id="4579503">*</span><span class="ident" id="4579504"><a href="/gostd/crypto/tls/ticket.go.html#4579384">sessionState</a></span><span class="op" id="4579516">)</span>&nbsp;<span class="ident" id="4579518">equal</span><span class="op" id="4579523">(</span><span class="ident" id="4579524">i</span>&nbsp;<span class="keyword" id="4579526">interface</span><span class="op" id="4579535">{</span><span class="op" id="4579536">}</span><span class="op" id="4579537">)</span>&nbsp;<span class="builtintype" id="4579539">bool</span>&nbsp;<span class="op" id="4579544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579547">s1</span><span class="op" id="4579549">,</span>&nbsp;<span class="ident" id="4579551">ok</span>&nbsp;<span class="op" id="4579554">:=</span>&nbsp;<span class="ident" id="4579557"><a href="/gostd/crypto/tls/ticket.go.html#4579524">i</a></span><span class="op" id="4579558">.</span><span class="op" id="4579559">(</span><span class="op" id="4579560">*</span><span class="ident" id="4579561"><a href="/gostd/crypto/tls/ticket.go.html#4579384">sessionState</a></span><span class="op" id="4579573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579576">if</span>&nbsp;<span class="op" id="4579579">!</span><span class="ident" id="4579580"><a href="/gostd/crypto/tls/ticket.go.html#4579551">ok</a></span>&nbsp;<span class="op" id="4579583">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579587">return</span>&nbsp;<span class="builtintype" id="4579594">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579605">if</span>&nbsp;<span class="ident" id="4579608"><a href="/gostd/crypto/tls/ticket.go.html#4579501">s</a></span><span class="op" id="4579609">.</span><span class="ident" id="4579610"><a href="/gostd/crypto/tls/ticket.go.html#4579407">vers</a></span>&nbsp;<span class="op" id="4579615">!=</span>&nbsp;<span class="ident" id="4579618"><a href="/gostd/crypto/tls/ticket.go.html#4579547">s1</a></span><span class="op" id="4579620">.</span><span class="ident" id="4579621"><a href="/gostd/crypto/tls/ticket.go.html#4579407">vers</a></span>&nbsp;<span class="op" id="4579626">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579631"><a href="/gostd/crypto/tls/ticket.go.html#4579501">s</a></span><span class="op" id="4579632">.</span><span class="ident" id="4579633"><a href="/gostd/crypto/tls/ticket.go.html#4579428">cipherSuite</a></span>&nbsp;<span class="op" id="4579645">!=</span>&nbsp;<span class="ident" id="4579648"><a href="/gostd/crypto/tls/ticket.go.html#4579547">s1</a></span><span class="op" id="4579650">.</span><span class="ident" id="4579651"><a href="/gostd/crypto/tls/ticket.go.html#4579428">cipherSuite</a></span>&nbsp;<span class="op" id="4579663">||</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579668">!</span><span class="ident" id="4579669"><a href="/gostd/crypto/tls/ticket.go.html#4579148">bytes</a></span><span class="op" id="4579674">.</span><span class="ident" id="4579675"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4579680">(</span><span class="ident" id="4579681"><a href="/gostd/crypto/tls/ticket.go.html#4579501">s</a></span><span class="op" id="4579682">.</span><span class="ident" id="4579683"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span><span class="op" id="4579695">,</span>&nbsp;<span class="ident" id="4579697"><a href="/gostd/crypto/tls/ticket.go.html#4579547">s1</a></span><span class="op" id="4579699">.</span><span class="ident" id="4579700"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span><span class="op" id="4579712">)</span>&nbsp;<span class="op" id="4579714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579718">return</span>&nbsp;<span class="builtintype" id="4579725">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579736">if</span>&nbsp;<span class="builtinfunc" id="4579739">len</span><span class="op" id="4579742">(</span><span class="ident" id="4579743"><a href="/gostd/crypto/tls/ticket.go.html#4579501">s</a></span><span class="op" id="4579744">.</span><span class="ident" id="4579745"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span><span class="op" id="4579757">)</span>&nbsp;<span class="op" id="4579759">!=</span>&nbsp;<span class="builtinfunc" id="4579762">len</span><span class="op" id="4579765">(</span><span class="ident" id="4579766"><a href="/gostd/crypto/tls/ticket.go.html#4579547">s1</a></span><span class="op" id="4579768">.</span><span class="ident" id="4579769"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span><span class="op" id="4579781">)</span>&nbsp;<span class="op" id="4579783">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579787">return</span>&nbsp;<span class="builtintype" id="4579794">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579805">for</span>&nbsp;<span class="ident" id="4579809">i</span>&nbsp;<span class="op" id="4579811">:=</span>&nbsp;<span class="keyword" id="4579814">range</span>&nbsp;<span class="ident" id="4579820"><a href="/gostd/crypto/tls/ticket.go.html#4579501">s</a></span><span class="op" id="4579821">.</span><span class="ident" id="4579822"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span>&nbsp;<span class="op" id="4579835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579839">if</span>&nbsp;<span class="op" id="4579842">!</span><span class="ident" id="4579843"><a href="/gostd/crypto/tls/ticket.go.html#4579148">bytes</a></span><span class="op" id="4579848">.</span><span class="ident" id="4579849"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4579854">(</span><span class="ident" id="4579855"><a href="/gostd/crypto/tls/ticket.go.html#4579501">s</a></span><span class="op" id="4579856">.</span><span class="ident" id="4579857"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span><span class="op" id="4579869">[</span><span class="ident" id="4579870"><a href="/gostd/crypto/tls/ticket.go.html#4579809">i</a></span><span class="op" id="4579871">]</span><span class="op" id="4579872">,</span>&nbsp;<span class="ident" id="4579874"><a href="/gostd/crypto/tls/ticket.go.html#4579547">s1</a></span><span class="op" id="4579876">.</span><span class="ident" id="4579877"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span><span class="op" id="4579889">[</span><span class="ident" id="4579890"><a href="/gostd/crypto/tls/ticket.go.html#4579809">i</a></span><span class="op" id="4579891">]</span><span class="op" id="4579892">)</span>&nbsp;<span class="op" id="4579894">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579899">return</span>&nbsp;<span class="builtintype" id="4579906">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4579921">return</span>&nbsp;<span class="builtintype" id="4579928">true</span><br>
<span class="lineno">50</span><span class="op" id="4579933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4579936">func</span>&nbsp;<span class="op" id="4579941">(</span><span class="ident" id="4579942">s</span>&nbsp;<span class="op" id="4579944">*</span><span class="ident" id="4579945"><a href="/gostd/crypto/tls/ticket.go.html#4579384">sessionState</a></span><span class="op" id="4579957">)</span>&nbsp;<span class="ident" id="4579959">marshal</span><span class="op" id="4579966">(</span><span class="op" id="4579967">)</span>&nbsp;<span class="op" id="4579969">[</span><span class="op" id="4579970">]</span><span class="builtintype" id="4579971">byte</span>&nbsp;<span class="op" id="4579976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4579979">length</span>&nbsp;<span class="op" id="4579986">:=</span>&nbsp;<span class="num" id="4579989">2</span>&nbsp;<span class="op" id="4579991">+</span>&nbsp;<span class="num" id="4579993">2</span>&nbsp;<span class="op" id="4579995">+</span>&nbsp;<span class="num" id="4579997">2</span>&nbsp;<span class="op" id="4579999">+</span>&nbsp;<span class="builtinfunc" id="4580001">len</span><span class="op" id="4580004">(</span><span class="ident" id="4580005"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580006">.</span><span class="ident" id="4580007"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span><span class="op" id="4580019">)</span>&nbsp;<span class="op" id="4580021">+</span>&nbsp;<span class="num" id="4580023">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580026">for</span>&nbsp;<span class="ident" id="4580030">_</span><span class="op" id="4580031">,</span>&nbsp;<span class="ident" id="4580033">cert</span>&nbsp;<span class="op" id="4580038">:=</span>&nbsp;<span class="keyword" id="4580041">range</span>&nbsp;<span class="ident" id="4580047"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580048">.</span><span class="ident" id="4580049"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span>&nbsp;<span class="op" id="4580062">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580066"><a href="/gostd/crypto/tls/ticket.go.html#4579979">length</a></span>&nbsp;<span class="op" id="4580073">+=</span>&nbsp;<span class="num" id="4580076">4</span>&nbsp;<span class="op" id="4580078">+</span>&nbsp;<span class="builtinfunc" id="4580080">len</span><span class="op" id="4580083">(</span><span class="ident" id="4580084"><a href="/gostd/crypto/tls/ticket.go.html#4580033">cert</a></span><span class="op" id="4580088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580095">ret</span>&nbsp;<span class="op" id="4580099">:=</span>&nbsp;<span class="builtinfunc" id="4580102">make</span><span class="op" id="4580106">(</span><span class="op" id="4580107">[</span><span class="op" id="4580108">]</span><span class="builtintype" id="4580109">byte</span><span class="op" id="4580113">,</span>&nbsp;<span class="ident" id="4580115"><a href="/gostd/crypto/tls/ticket.go.html#4579979">length</a></span><span class="op" id="4580121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580124">x</span>&nbsp;<span class="op" id="4580126">:=</span>&nbsp;<span class="ident" id="4580129"><a href="/gostd/crypto/tls/ticket.go.html#4580095">ret</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580134"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580135">[</span><span class="num" id="4580136">0</span><span class="op" id="4580137">]</span>&nbsp;<span class="op" id="4580139">=</span>&nbsp;<span class="builtintype" id="4580141">byte</span><span class="op" id="4580145">(</span><span class="ident" id="4580146"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580147">.</span><span class="ident" id="4580148"><a href="/gostd/crypto/tls/ticket.go.html#4579407">vers</a></span>&nbsp;<span class="op" id="4580153">&gt;&gt;</span>&nbsp;<span class="num" id="4580156">8</span><span class="op" id="4580157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580160"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580161">[</span><span class="num" id="4580162">1</span><span class="op" id="4580163">]</span>&nbsp;<span class="op" id="4580165">=</span>&nbsp;<span class="builtintype" id="4580167">byte</span><span class="op" id="4580171">(</span><span class="ident" id="4580172"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580173">.</span><span class="ident" id="4580174"><a href="/gostd/crypto/tls/ticket.go.html#4579407">vers</a></span><span class="op" id="4580178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580181"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580182">[</span><span class="num" id="4580183">2</span><span class="op" id="4580184">]</span>&nbsp;<span class="op" id="4580186">=</span>&nbsp;<span class="builtintype" id="4580188">byte</span><span class="op" id="4580192">(</span><span class="ident" id="4580193"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580194">.</span><span class="ident" id="4580195"><a href="/gostd/crypto/tls/ticket.go.html#4579428">cipherSuite</a></span>&nbsp;<span class="op" id="4580207">&gt;&gt;</span>&nbsp;<span class="num" id="4580210">8</span><span class="op" id="4580211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580214"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580215">[</span><span class="num" id="4580216">3</span><span class="op" id="4580217">]</span>&nbsp;<span class="op" id="4580219">=</span>&nbsp;<span class="builtintype" id="4580221">byte</span><span class="op" id="4580225">(</span><span class="ident" id="4580226"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580227">.</span><span class="ident" id="4580228"><a href="/gostd/crypto/tls/ticket.go.html#4579428">cipherSuite</a></span><span class="op" id="4580239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580242"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580243">[</span><span class="num" id="4580244">4</span><span class="op" id="4580245">]</span>&nbsp;<span class="op" id="4580247">=</span>&nbsp;<span class="builtintype" id="4580249">byte</span><span class="op" id="4580253">(</span><span class="builtinfunc" id="4580254">len</span><span class="op" id="4580257">(</span><span class="ident" id="4580258"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580259">.</span><span class="ident" id="4580260"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span><span class="op" id="4580272">)</span>&nbsp;<span class="op" id="4580274">&gt;&gt;</span>&nbsp;<span class="num" id="4580277">8</span><span class="op" id="4580278">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580281"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580282">[</span><span class="num" id="4580283">5</span><span class="op" id="4580284">]</span>&nbsp;<span class="op" id="4580286">=</span>&nbsp;<span class="builtintype" id="4580288">byte</span><span class="op" id="4580292">(</span><span class="builtinfunc" id="4580293">len</span><span class="op" id="4580296">(</span><span class="ident" id="4580297"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580298">.</span><span class="ident" id="4580299"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span><span class="op" id="4580311">)</span><span class="op" id="4580312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580315"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span>&nbsp;<span class="op" id="4580317">=</span>&nbsp;<span class="ident" id="4580319"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580320">[</span><span class="num" id="4580321">6</span><span class="op" id="4580322">:</span><span class="op" id="4580323">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4580326">copy</span><span class="op" id="4580330">(</span><span class="ident" id="4580331"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580332">,</span>&nbsp;<span class="ident" id="4580334"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580335">.</span><span class="ident" id="4580336"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span><span class="op" id="4580348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580351"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span>&nbsp;<span class="op" id="4580353">=</span>&nbsp;<span class="ident" id="4580355"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580356">[</span><span class="builtinfunc" id="4580357">len</span><span class="op" id="4580360">(</span><span class="ident" id="4580361"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580362">.</span><span class="ident" id="4580363"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span><span class="op" id="4580375">)</span><span class="op" id="4580376">:</span><span class="op" id="4580377">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580381"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580382">[</span><span class="num" id="4580383">0</span><span class="op" id="4580384">]</span>&nbsp;<span class="op" id="4580386">=</span>&nbsp;<span class="builtintype" id="4580388">byte</span><span class="op" id="4580392">(</span><span class="builtinfunc" id="4580393">len</span><span class="op" id="4580396">(</span><span class="ident" id="4580397"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580398">.</span><span class="ident" id="4580399"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span><span class="op" id="4580411">)</span>&nbsp;<span class="op" id="4580413">&gt;&gt;</span>&nbsp;<span class="num" id="4580416">8</span><span class="op" id="4580417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580420"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580421">[</span><span class="num" id="4580422">1</span><span class="op" id="4580423">]</span>&nbsp;<span class="op" id="4580425">=</span>&nbsp;<span class="builtintype" id="4580427">byte</span><span class="op" id="4580431">(</span><span class="builtinfunc" id="4580432">len</span><span class="op" id="4580435">(</span><span class="ident" id="4580436"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580437">.</span><span class="ident" id="4580438"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span><span class="op" id="4580450">)</span><span class="op" id="4580451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580454"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span>&nbsp;<span class="op" id="4580456">=</span>&nbsp;<span class="ident" id="4580458"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580459">[</span><span class="num" id="4580460">2</span><span class="op" id="4580461">:</span><span class="op" id="4580462">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580466">for</span>&nbsp;<span class="ident" id="4580470">_</span><span class="op" id="4580471">,</span>&nbsp;<span class="ident" id="4580473">cert</span>&nbsp;<span class="op" id="4580478">:=</span>&nbsp;<span class="keyword" id="4580481">range</span>&nbsp;<span class="ident" id="4580487"><a href="/gostd/crypto/tls/ticket.go.html#4579942">s</a></span><span class="op" id="4580488">.</span><span class="ident" id="4580489"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span>&nbsp;<span class="op" id="4580502">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580506"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580507">[</span><span class="num" id="4580508">0</span><span class="op" id="4580509">]</span>&nbsp;<span class="op" id="4580511">=</span>&nbsp;<span class="builtintype" id="4580513">byte</span><span class="op" id="4580517">(</span><span class="builtinfunc" id="4580518">len</span><span class="op" id="4580521">(</span><span class="ident" id="4580522"><a href="/gostd/crypto/tls/ticket.go.html#4580473">cert</a></span><span class="op" id="4580526">)</span>&nbsp;<span class="op" id="4580528">&gt;&gt;</span>&nbsp;<span class="num" id="4580531">24</span><span class="op" id="4580533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580537"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580538">[</span><span class="num" id="4580539">1</span><span class="op" id="4580540">]</span>&nbsp;<span class="op" id="4580542">=</span>&nbsp;<span class="builtintype" id="4580544">byte</span><span class="op" id="4580548">(</span><span class="builtinfunc" id="4580549">len</span><span class="op" id="4580552">(</span><span class="ident" id="4580553"><a href="/gostd/crypto/tls/ticket.go.html#4580473">cert</a></span><span class="op" id="4580557">)</span>&nbsp;<span class="op" id="4580559">&gt;&gt;</span>&nbsp;<span class="num" id="4580562">16</span><span class="op" id="4580564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580568"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580569">[</span><span class="num" id="4580570">2</span><span class="op" id="4580571">]</span>&nbsp;<span class="op" id="4580573">=</span>&nbsp;<span class="builtintype" id="4580575">byte</span><span class="op" id="4580579">(</span><span class="builtinfunc" id="4580580">len</span><span class="op" id="4580583">(</span><span class="ident" id="4580584"><a href="/gostd/crypto/tls/ticket.go.html#4580473">cert</a></span><span class="op" id="4580588">)</span>&nbsp;<span class="op" id="4580590">&gt;&gt;</span>&nbsp;<span class="num" id="4580593">8</span><span class="op" id="4580594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580598"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580599">[</span><span class="num" id="4580600">3</span><span class="op" id="4580601">]</span>&nbsp;<span class="op" id="4580603">=</span>&nbsp;<span class="builtintype" id="4580605">byte</span><span class="op" id="4580609">(</span><span class="builtinfunc" id="4580610">len</span><span class="op" id="4580613">(</span><span class="ident" id="4580614"><a href="/gostd/crypto/tls/ticket.go.html#4580473">cert</a></span><span class="op" id="4580618">)</span><span class="op" id="4580619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4580623">copy</span><span class="op" id="4580627">(</span><span class="ident" id="4580628"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580629">[</span><span class="num" id="4580630">4</span><span class="op" id="4580631">:</span><span class="op" id="4580632">]</span><span class="op" id="4580633">,</span>&nbsp;<span class="ident" id="4580635"><a href="/gostd/crypto/tls/ticket.go.html#4580473">cert</a></span><span class="op" id="4580639">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580643"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span>&nbsp;<span class="op" id="4580645">=</span>&nbsp;<span class="ident" id="4580647"><a href="/gostd/crypto/tls/ticket.go.html#4580124">x</a></span><span class="op" id="4580648">[</span><span class="num" id="4580649">4</span><span class="op" id="4580650">+</span><span class="builtinfunc" id="4580651">len</span><span class="op" id="4580654">(</span><span class="ident" id="4580655"><a href="/gostd/crypto/tls/ticket.go.html#4580473">cert</a></span><span class="op" id="4580659">)</span><span class="op" id="4580660">:</span><span class="op" id="4580661">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580668">return</span>&nbsp;<span class="ident" id="4580675"><a href="/gostd/crypto/tls/ticket.go.html#4580095">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4580679">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4580682">func</span>&nbsp;<span class="op" id="4580687">(</span><span class="ident" id="4580688">s</span>&nbsp;<span class="op" id="4580690">*</span><span class="ident" id="4580691"><a href="/gostd/crypto/tls/ticket.go.html#4579384">sessionState</a></span><span class="op" id="4580703">)</span>&nbsp;<span class="ident" id="4580705">unmarshal</span><span class="op" id="4580714">(</span><span class="ident" id="4580715">data</span>&nbsp;<span class="op" id="4580720">[</span><span class="op" id="4580721">]</span><span class="builtintype" id="4580722">byte</span><span class="op" id="4580726">)</span>&nbsp;<span class="builtintype" id="4580728">bool</span>&nbsp;<span class="op" id="4580733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580736">if</span>&nbsp;<span class="builtinfunc" id="4580739">len</span><span class="op" id="4580742">(</span><span class="ident" id="4580743"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580747">)</span>&nbsp;<span class="op" id="4580749">&lt;</span>&nbsp;<span class="num" id="4580751">8</span>&nbsp;<span class="op" id="4580753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580757">return</span>&nbsp;<span class="builtintype" id="4580764">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580771">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580775"><a href="/gostd/crypto/tls/ticket.go.html#4580688">s</a></span><span class="op" id="4580776">.</span><span class="ident" id="4580777"><a href="/gostd/crypto/tls/ticket.go.html#4579407">vers</a></span>&nbsp;<span class="op" id="4580782">=</span>&nbsp;<span class="builtintype" id="4580784">uint16</span><span class="op" id="4580790">(</span><span class="ident" id="4580791"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580795">[</span><span class="num" id="4580796">0</span><span class="op" id="4580797">]</span><span class="op" id="4580798">)</span><span class="op" id="4580799">&lt;&lt;</span><span class="num" id="4580801">8</span>&nbsp;<span class="op" id="4580803">|</span>&nbsp;<span class="builtintype" id="4580805">uint16</span><span class="op" id="4580811">(</span><span class="ident" id="4580812"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580816">[</span><span class="num" id="4580817">1</span><span class="op" id="4580818">]</span><span class="op" id="4580819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580822"><a href="/gostd/crypto/tls/ticket.go.html#4580688">s</a></span><span class="op" id="4580823">.</span><span class="ident" id="4580824"><a href="/gostd/crypto/tls/ticket.go.html#4579428">cipherSuite</a></span>&nbsp;<span class="op" id="4580836">=</span>&nbsp;<span class="builtintype" id="4580838">uint16</span><span class="op" id="4580844">(</span><span class="ident" id="4580845"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580849">[</span><span class="num" id="4580850">2</span><span class="op" id="4580851">]</span><span class="op" id="4580852">)</span><span class="op" id="4580853">&lt;&lt;</span><span class="num" id="4580855">8</span>&nbsp;<span class="op" id="4580857">|</span>&nbsp;<span class="builtintype" id="4580859">uint16</span><span class="op" id="4580865">(</span><span class="ident" id="4580866"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580870">[</span><span class="num" id="4580871">3</span><span class="op" id="4580872">]</span><span class="op" id="4580873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580876">masterSecretLen</span>&nbsp;<span class="op" id="4580892">:=</span>&nbsp;<span class="builtintype" id="4580895">int</span><span class="op" id="4580898">(</span><span class="ident" id="4580899"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580903">[</span><span class="num" id="4580904">4</span><span class="op" id="4580905">]</span><span class="op" id="4580906">)</span><span class="op" id="4580907">&lt;&lt;</span><span class="num" id="4580909">8</span>&nbsp;<span class="op" id="4580911">|</span>&nbsp;<span class="builtintype" id="4580913">int</span><span class="op" id="4580916">(</span><span class="ident" id="4580917"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580921">[</span><span class="num" id="4580922">5</span><span class="op" id="4580923">]</span><span class="op" id="4580924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580927"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span>&nbsp;<span class="op" id="4580932">=</span>&nbsp;<span class="ident" id="4580934"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580938">[</span><span class="num" id="4580939">6</span><span class="op" id="4580940">:</span><span class="op" id="4580941">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580944">if</span>&nbsp;<span class="builtinfunc" id="4580947">len</span><span class="op" id="4580950">(</span><span class="ident" id="4580951"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4580955">)</span>&nbsp;<span class="op" id="4580957">&lt;</span>&nbsp;<span class="ident" id="4580959"><a href="/gostd/crypto/tls/ticket.go.html#4580876">masterSecretLen</a></span>&nbsp;<span class="op" id="4580975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4580979">return</span>&nbsp;<span class="builtintype" id="4580986">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4580993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4580997"><a href="/gostd/crypto/tls/ticket.go.html#4580688">s</a></span><span class="op" id="4580998">.</span><span class="ident" id="4580999"><a href="/gostd/crypto/tls/ticket.go.html#4579449">masterSecret</a></span>&nbsp;<span class="op" id="4581012">=</span>&nbsp;<span class="ident" id="4581014"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581018">[</span><span class="op" id="4581019">:</span><span class="ident" id="4581020"><a href="/gostd/crypto/tls/ticket.go.html#4580876">masterSecretLen</a></span><span class="op" id="4581035">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581038"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span>&nbsp;<span class="op" id="4581043">=</span>&nbsp;<span class="ident" id="4581045"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581049">[</span><span class="ident" id="4581050"><a href="/gostd/crypto/tls/ticket.go.html#4580876">masterSecretLen</a></span><span class="op" id="4581065">:</span><span class="op" id="4581066">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581070">if</span>&nbsp;<span class="builtinfunc" id="4581073">len</span><span class="op" id="4581076">(</span><span class="ident" id="4581077"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581081">)</span>&nbsp;<span class="op" id="4581083">&lt;</span>&nbsp;<span class="num" id="4581085">2</span>&nbsp;<span class="op" id="4581087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581091">return</span>&nbsp;<span class="builtintype" id="4581098">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581105">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581109">numCerts</span>&nbsp;<span class="op" id="4581118">:=</span>&nbsp;<span class="builtintype" id="4581121">int</span><span class="op" id="4581124">(</span><span class="ident" id="4581125"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581129">[</span><span class="num" id="4581130">0</span><span class="op" id="4581131">]</span><span class="op" id="4581132">)</span><span class="op" id="4581133">&lt;&lt;</span><span class="num" id="4581135">8</span>&nbsp;<span class="op" id="4581137">|</span>&nbsp;<span class="builtintype" id="4581139">int</span><span class="op" id="4581142">(</span><span class="ident" id="4581143"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581147">[</span><span class="num" id="4581148">1</span><span class="op" id="4581149">]</span><span class="op" id="4581150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581153"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span>&nbsp;<span class="op" id="4581158">=</span>&nbsp;<span class="ident" id="4581160"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581164">[</span><span class="num" id="4581165">2</span><span class="op" id="4581166">:</span><span class="op" id="4581167">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581171"><a href="/gostd/crypto/tls/ticket.go.html#4580688">s</a></span><span class="op" id="4581172">.</span><span class="ident" id="4581173"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span>&nbsp;<span class="op" id="4581186">=</span>&nbsp;<span class="builtinfunc" id="4581188">make</span><span class="op" id="4581192">(</span><span class="op" id="4581193">[</span><span class="op" id="4581194">]</span><span class="op" id="4581195">[</span><span class="op" id="4581196">]</span><span class="builtintype" id="4581197">byte</span><span class="op" id="4581201">,</span>&nbsp;<span class="ident" id="4581203"><a href="/gostd/crypto/tls/ticket.go.html#4581109">numCerts</a></span><span class="op" id="4581211">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581214">for</span>&nbsp;<span class="ident" id="4581218">i</span>&nbsp;<span class="op" id="4581220">:=</span>&nbsp;<span class="keyword" id="4581223">range</span>&nbsp;<span class="ident" id="4581229"><a href="/gostd/crypto/tls/ticket.go.html#4580688">s</a></span><span class="op" id="4581230">.</span><span class="ident" id="4581231"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span>&nbsp;<span class="op" id="4581244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581248">if</span>&nbsp;<span class="builtinfunc" id="4581251">len</span><span class="op" id="4581254">(</span><span class="ident" id="4581255"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581259">)</span>&nbsp;<span class="op" id="4581261">&lt;</span>&nbsp;<span class="num" id="4581263">4</span>&nbsp;<span class="op" id="4581265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581270">return</span>&nbsp;<span class="builtintype" id="4581277">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581289">certLen</span>&nbsp;<span class="op" id="4581297">:=</span>&nbsp;<span class="builtintype" id="4581300">int</span><span class="op" id="4581303">(</span><span class="ident" id="4581304"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581308">[</span><span class="num" id="4581309">0</span><span class="op" id="4581310">]</span><span class="op" id="4581311">)</span><span class="op" id="4581312">&lt;&lt;</span><span class="num" id="4581314">24</span>&nbsp;<span class="op" id="4581317">|</span>&nbsp;<span class="builtintype" id="4581319">int</span><span class="op" id="4581322">(</span><span class="ident" id="4581323"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581327">[</span><span class="num" id="4581328">1</span><span class="op" id="4581329">]</span><span class="op" id="4581330">)</span><span class="op" id="4581331">&lt;&lt;</span><span class="num" id="4581333">16</span>&nbsp;<span class="op" id="4581336">|</span>&nbsp;<span class="builtintype" id="4581338">int</span><span class="op" id="4581341">(</span><span class="ident" id="4581342"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581346">[</span><span class="num" id="4581347">2</span><span class="op" id="4581348">]</span><span class="op" id="4581349">)</span><span class="op" id="4581350">&lt;&lt;</span><span class="num" id="4581352">8</span>&nbsp;<span class="op" id="4581354">|</span>&nbsp;<span class="builtintype" id="4581356">int</span><span class="op" id="4581359">(</span><span class="ident" id="4581360"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581364">[</span><span class="num" id="4581365">3</span><span class="op" id="4581366">]</span><span class="op" id="4581367">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581371"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span>&nbsp;<span class="op" id="4581376">=</span>&nbsp;<span class="ident" id="4581378"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581382">[</span><span class="num" id="4581383">4</span><span class="op" id="4581384">:</span><span class="op" id="4581385">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581389">if</span>&nbsp;<span class="ident" id="4581392"><a href="/gostd/crypto/tls/ticket.go.html#4581289">certLen</a></span>&nbsp;<span class="op" id="4581400">&lt;</span>&nbsp;<span class="num" id="4581402">0</span>&nbsp;<span class="op" id="4581404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581409">return</span>&nbsp;<span class="builtintype" id="4581416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581428">if</span>&nbsp;<span class="builtinfunc" id="4581431">len</span><span class="op" id="4581434">(</span><span class="ident" id="4581435"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581439">)</span>&nbsp;<span class="op" id="4581441">&lt;</span>&nbsp;<span class="ident" id="4581443"><a href="/gostd/crypto/tls/ticket.go.html#4581289">certLen</a></span>&nbsp;<span class="op" id="4581451">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581456">return</span>&nbsp;<span class="builtintype" id="4581463">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581475"><a href="/gostd/crypto/tls/ticket.go.html#4580688">s</a></span><span class="op" id="4581476">.</span><span class="ident" id="4581477"><a href="/gostd/crypto/tls/ticket.go.html#4579470">certificates</a></span><span class="op" id="4581489">[</span><span class="ident" id="4581490"><a href="/gostd/crypto/tls/ticket.go.html#4581218">i</a></span><span class="op" id="4581491">]</span>&nbsp;<span class="op" id="4581493">=</span>&nbsp;<span class="ident" id="4581495"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581499">[</span><span class="op" id="4581500">:</span><span class="ident" id="4581501"><a href="/gostd/crypto/tls/ticket.go.html#4581289">certLen</a></span><span class="op" id="4581508">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581512"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span>&nbsp;<span class="op" id="4581517">=</span>&nbsp;<span class="ident" id="4581519"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581523">[</span><span class="ident" id="4581524"><a href="/gostd/crypto/tls/ticket.go.html#4581289">certLen</a></span><span class="op" id="4581531">:</span><span class="op" id="4581532">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581535">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581539">if</span>&nbsp;<span class="builtinfunc" id="4581542">len</span><span class="op" id="4581545">(</span><span class="ident" id="4581546"><a href="/gostd/crypto/tls/ticket.go.html#4580715">data</a></span><span class="op" id="4581550">)</span>&nbsp;<span class="op" id="4581552">&gt;</span>&nbsp;<span class="num" id="4581554">0</span>&nbsp;<span class="op" id="4581556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581560">return</span>&nbsp;<span class="builtintype" id="4581567">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581578">return</span>&nbsp;<span class="builtintype" id="4581585">true</span><br>
<span class="lineno"></span><span class="op" id="4581590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4581593">func</span>&nbsp;<span class="op" id="4581598">(</span><span class="ident" id="4581599">c</span>&nbsp;<span class="op" id="4581601">*</span><span class="ident" id="4581602"><a href="/gostd/crypto/tls/conn.go.html#4461903">Conn</a></span><span class="op" id="4581606">)</span>&nbsp;<span class="ident" id="4581608">encryptTicket</span><span class="op" id="4581621">(</span><span class="ident" id="4581622">state</span>&nbsp;<span class="op" id="4581628">*</span><span class="ident" id="4581629"><a href="/gostd/crypto/tls/ticket.go.html#4579384">sessionState</a></span><span class="op" id="4581641">)</span>&nbsp;<span class="op" id="4581643">(</span><span class="op" id="4581644">[</span><span class="op" id="4581645">]</span><span class="builtintype" id="4581646">byte</span><span class="op" id="4581650">,</span>&nbsp;<span class="builtintype" id="4581652">error</span><span class="op" id="4581657">)</span>&nbsp;<span class="op" id="4581659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581662">serialized</span>&nbsp;<span class="op" id="4581673">:=</span>&nbsp;<span class="ident" id="4581676"><a href="/gostd/crypto/tls/ticket.go.html#4581622">state</a></span><span class="op" id="4581681">.</span><span class="ident" id="4581682"><a href="/gostd/crypto/tls/ticket.go.html#4579959">marshal</a></span><span class="op" id="4581689">(</span><span class="op" id="4581690">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581693">encrypted</span>&nbsp;<span class="op" id="4581703">:=</span>&nbsp;<span class="builtinfunc" id="4581706">make</span><span class="op" id="4581710">(</span><span class="op" id="4581711">[</span><span class="op" id="4581712">]</span><span class="builtintype" id="4581713">byte</span><span class="op" id="4581717">,</span>&nbsp;<span class="ident" id="4581719"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4581722">.</span><span class="ident" id="4581723"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4581732">+</span><span class="builtinfunc" id="4581733">len</span><span class="op" id="4581736">(</span><span class="ident" id="4581737"><a href="/gostd/crypto/tls/ticket.go.html#4581662">serialized</a></span><span class="op" id="4581747">)</span><span class="op" id="4581748">+</span><span class="ident" id="4581749"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4581755">.</span><span class="ident" id="4581756"><a href="/gostd/crypto/sha256/sha256.go.html#4758698">Size</a></span><span class="op" id="4581760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581763">iv</span>&nbsp;<span class="op" id="4581766">:=</span>&nbsp;<span class="ident" id="4581769"><a href="/gostd/crypto/tls/ticket.go.html#4581693">encrypted</a></span><span class="op" id="4581778">[</span><span class="op" id="4581779">:</span><span class="ident" id="4581780"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4581783">.</span><span class="ident" id="4581784"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4581793">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581796">macBytes</span>&nbsp;<span class="op" id="4581805">:=</span>&nbsp;<span class="ident" id="4581808"><a href="/gostd/crypto/tls/ticket.go.html#4581693">encrypted</a></span><span class="op" id="4581817">[</span><span class="builtinfunc" id="4581818">len</span><span class="op" id="4581821">(</span><span class="ident" id="4581822"><a href="/gostd/crypto/tls/ticket.go.html#4581693">encrypted</a></span><span class="op" id="4581831">)</span><span class="op" id="4581832">-</span><span class="ident" id="4581833"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4581839">.</span><span class="ident" id="4581840"><a href="/gostd/crypto/sha256/sha256.go.html#4758698">Size</a></span><span class="op" id="4581844">:</span><span class="op" id="4581845">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581849">if</span>&nbsp;<span class="ident" id="4581852">_</span><span class="op" id="4581853">,</span>&nbsp;<span class="ident" id="4581855">err</span>&nbsp;<span class="op" id="4581859">:=</span>&nbsp;<span class="ident" id="4581862"><a href="/gostd/crypto/tls/ticket.go.html#4579247">io</a></span><span class="op" id="4581864">.</span><span class="ident" id="4581865"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="4581873">(</span><span class="ident" id="4581874"><a href="/gostd/crypto/tls/ticket.go.html#4581599">c</a></span><span class="op" id="4581875">.</span><span class="ident" id="4581876"><a href="/gostd/crypto/tls/conn.go.html#4462274">config</a></span><span class="op" id="4581882">.</span><span class="ident" id="4581883"><a href="/gostd/crypto/tls/common.go.html#4455096">rand</a></span><span class="op" id="4581887">(</span><span class="op" id="4581888">)</span><span class="op" id="4581889">,</span>&nbsp;<span class="ident" id="4581891"><a href="/gostd/crypto/tls/ticket.go.html#4581763">iv</a></span><span class="op" id="4581893">)</span><span class="op" id="4581894">;</span>&nbsp;<span class="ident" id="4581896"><a href="/gostd/crypto/tls/ticket.go.html#4581855">err</a></span>&nbsp;<span class="op" id="4581900">!=</span>&nbsp;<span class="builtintype" id="4581903">nil</span>&nbsp;<span class="op" id="4581907">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581911">return</span>&nbsp;<span class="builtintype" id="4581918">nil</span><span class="op" id="4581921">,</span>&nbsp;<span class="ident" id="4581923"><a href="/gostd/crypto/tls/ticket.go.html#4581855">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4581928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4581931">block</span><span class="op" id="4581936">,</span>&nbsp;<span class="ident" id="4581938">err</span>&nbsp;<span class="op" id="4581942">:=</span>&nbsp;<span class="ident" id="4581945"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4581948">.</span><span class="ident" id="4581949"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4581958">(</span><span class="ident" id="4581959"><a href="/gostd/crypto/tls/ticket.go.html#4581599">c</a></span><span class="op" id="4581960">.</span><span class="ident" id="4581961"><a href="/gostd/crypto/tls/conn.go.html#4462274">config</a></span><span class="op" id="4581967">.</span><span class="ident" id="4581968"><a href="/gostd/crypto/tls/common.go.html#4454006">SessionTicketKey</a></span><span class="op" id="4581984">[</span><span class="op" id="4581985">:</span><span class="num" id="4581986">16</span><span class="op" id="4581988">]</span><span class="op" id="4581989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4581992">if</span>&nbsp;<span class="ident" id="4581995"><a href="/gostd/crypto/tls/ticket.go.html#4581938">err</a></span>&nbsp;<span class="op" id="4581999">!=</span>&nbsp;<span class="builtintype" id="4582002">nil</span>&nbsp;<span class="op" id="4582006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582010">return</span>&nbsp;<span class="builtintype" id="4582017">nil</span><span class="op" id="4582020">,</span>&nbsp;<span class="ident" id="4582022"><a href="/gostd/crypto/tls/ticket.go.html#4579237">errors</a></span><span class="op" id="4582028">.</span><span class="ident" id="4582029"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4582032">(</span><span class="string" id="4582033">&#34;tls:&nbsp;failed&nbsp;to&nbsp;create&nbsp;cipher&nbsp;while&nbsp;encrypting&nbsp;ticket:&nbsp;&#34;</span>&nbsp;<span class="op" id="4582090">+</span>&nbsp;<span class="ident" id="4582092"><a href="/gostd/crypto/tls/ticket.go.html#4581938">err</a></span><span class="op" id="4582095">.</span><span class="ident" id="4582096">Error</span><span class="op" id="4582101">(</span><span class="op" id="4582102">)</span><span class="op" id="4582103">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582109"><a href="/gostd/crypto/tls/ticket.go.html#4579171">cipher</a></span><span class="op" id="4582115">.</span><span class="ident" id="4582116"><a href="/gostd/crypto/cipher/ctr.go.html#4412419">NewCTR</a></span><span class="op" id="4582122">(</span><span class="ident" id="4582123"><a href="/gostd/crypto/tls/ticket.go.html#4581931">block</a></span><span class="op" id="4582128">,</span>&nbsp;<span class="ident" id="4582130"><a href="/gostd/crypto/tls/ticket.go.html#4581763">iv</a></span><span class="op" id="4582132">)</span><span class="op" id="4582133">.</span><span class="ident" id="4582134"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="4582146">(</span><span class="ident" id="4582147"><a href="/gostd/crypto/tls/ticket.go.html#4581693">encrypted</a></span><span class="op" id="4582156">[</span><span class="ident" id="4582157"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4582160">.</span><span class="ident" id="4582161"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4582170">:</span><span class="op" id="4582171">]</span><span class="op" id="4582172">,</span>&nbsp;<span class="ident" id="4582174"><a href="/gostd/crypto/tls/ticket.go.html#4581662">serialized</a></span><span class="op" id="4582184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582188">mac</span>&nbsp;<span class="op" id="4582192">:=</span>&nbsp;<span class="ident" id="4582195"><a href="/gostd/crypto/tls/ticket.go.html#4579188">hmac</a></span><span class="op" id="4582199">.</span><span class="ident" id="4582200"><a href="/gostd/crypto/hmac/hmac.go.html#4605122">New</a></span><span class="op" id="4582203">(</span><span class="ident" id="4582204"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4582210">.</span><span class="ident" id="4582211"><a href="/gostd/crypto/sha256/sha256.go.html#4759893">New</a></span><span class="op" id="4582214">,</span>&nbsp;<span class="ident" id="4582216"><a href="/gostd/crypto/tls/ticket.go.html#4581599">c</a></span><span class="op" id="4582217">.</span><span class="ident" id="4582218"><a href="/gostd/crypto/tls/conn.go.html#4462274">config</a></span><span class="op" id="4582224">.</span><span class="ident" id="4582225"><a href="/gostd/crypto/tls/common.go.html#4454006">SessionTicketKey</a></span><span class="op" id="4582241">[</span><span class="num" id="4582242">16</span><span class="op" id="4582244">:</span><span class="num" id="4582245">32</span><span class="op" id="4582247">]</span><span class="op" id="4582248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582251"><a href="/gostd/crypto/tls/ticket.go.html#4582188">mac</a></span><span class="op" id="4582254">.</span><span class="ident" id="4582255"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4582260">(</span><span class="ident" id="4582261"><a href="/gostd/crypto/tls/ticket.go.html#4581693">encrypted</a></span><span class="op" id="4582270">[</span><span class="op" id="4582271">:</span><span class="builtinfunc" id="4582272">len</span><span class="op" id="4582275">(</span><span class="ident" id="4582276"><a href="/gostd/crypto/tls/ticket.go.html#4581693">encrypted</a></span><span class="op" id="4582285">)</span><span class="op" id="4582286">-</span><span class="ident" id="4582287"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4582293">.</span><span class="ident" id="4582294"><a href="/gostd/crypto/sha256/sha256.go.html#4758698">Size</a></span><span class="op" id="4582298">]</span><span class="op" id="4582299">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582302"><a href="/gostd/crypto/tls/ticket.go.html#4582188">mac</a></span><span class="op" id="4582305">.</span><span class="ident" id="4582306"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4582309">(</span><span class="ident" id="4582310"><a href="/gostd/crypto/tls/ticket.go.html#4581796">macBytes</a></span><span class="op" id="4582318">[</span><span class="op" id="4582319">:</span><span class="num" id="4582320">0</span><span class="op" id="4582321">]</span><span class="op" id="4582322">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582326">return</span>&nbsp;<span class="ident" id="4582333"><a href="/gostd/crypto/tls/ticket.go.html#4581693">encrypted</a></span><span class="op" id="4582342">,</span>&nbsp;<span class="builtintype" id="4582344">nil</span><br>
<span class="lineno"></span><span class="op" id="4582348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="4582351">func</span>&nbsp;<span class="op" id="4582356">(</span><span class="ident" id="4582357">c</span>&nbsp;<span class="op" id="4582359">*</span><span class="ident" id="4582360"><a href="/gostd/crypto/tls/conn.go.html#4461903">Conn</a></span><span class="op" id="4582364">)</span>&nbsp;<span class="ident" id="4582366">decryptTicket</span><span class="op" id="4582379">(</span><span class="ident" id="4582380">encrypted</span>&nbsp;<span class="op" id="4582390">[</span><span class="op" id="4582391">]</span><span class="builtintype" id="4582392">byte</span><span class="op" id="4582396">)</span>&nbsp;<span class="op" id="4582398">(</span><span class="op" id="4582399">*</span><span class="ident" id="4582400"><a href="/gostd/crypto/tls/ticket.go.html#4579384">sessionState</a></span><span class="op" id="4582412">,</span>&nbsp;<span class="builtintype" id="4582414">bool</span><span class="op" id="4582418">)</span>&nbsp;<span class="op" id="4582420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582423">if</span>&nbsp;<span class="ident" id="4582426"><a href="/gostd/crypto/tls/ticket.go.html#4582357">c</a></span><span class="op" id="4582427">.</span><span class="ident" id="4582428"><a href="/gostd/crypto/tls/conn.go.html#4462274">config</a></span><span class="op" id="4582434">.</span><span class="ident" id="4582435"><a href="/gostd/crypto/tls/common.go.html#4453556">SessionTicketsDisabled</a></span>&nbsp;<span class="op" id="4582458">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4582463">len</span><span class="op" id="4582466">(</span><span class="ident" id="4582467"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582476">)</span>&nbsp;<span class="op" id="4582478">&lt;</span>&nbsp;<span class="ident" id="4582480"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4582483">.</span><span class="ident" id="4582484"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4582493">+</span><span class="ident" id="4582494"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4582500">.</span><span class="ident" id="4582501"><a href="/gostd/crypto/sha256/sha256.go.html#4758698">Size</a></span>&nbsp;<span class="op" id="4582506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582510">return</span>&nbsp;<span class="builtintype" id="4582517">nil</span><span class="op" id="4582520">,</span>&nbsp;<span class="builtintype" id="4582522">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582529">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582533">iv</span>&nbsp;<span class="op" id="4582536">:=</span>&nbsp;<span class="ident" id="4582539"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582548">[</span><span class="op" id="4582549">:</span><span class="ident" id="4582550"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4582553">.</span><span class="ident" id="4582554"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4582563">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582566">macBytes</span>&nbsp;<span class="op" id="4582575">:=</span>&nbsp;<span class="ident" id="4582578"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582587">[</span><span class="builtinfunc" id="4582588">len</span><span class="op" id="4582591">(</span><span class="ident" id="4582592"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582601">)</span><span class="op" id="4582602">-</span><span class="ident" id="4582603"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4582609">.</span><span class="ident" id="4582610"><a href="/gostd/crypto/sha256/sha256.go.html#4758698">Size</a></span><span class="op" id="4582614">:</span><span class="op" id="4582615">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582619">mac</span>&nbsp;<span class="op" id="4582623">:=</span>&nbsp;<span class="ident" id="4582626"><a href="/gostd/crypto/tls/ticket.go.html#4579188">hmac</a></span><span class="op" id="4582630">.</span><span class="ident" id="4582631"><a href="/gostd/crypto/hmac/hmac.go.html#4605122">New</a></span><span class="op" id="4582634">(</span><span class="ident" id="4582635"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4582641">.</span><span class="ident" id="4582642"><a href="/gostd/crypto/sha256/sha256.go.html#4759893">New</a></span><span class="op" id="4582645">,</span>&nbsp;<span class="ident" id="4582647"><a href="/gostd/crypto/tls/ticket.go.html#4582357">c</a></span><span class="op" id="4582648">.</span><span class="ident" id="4582649"><a href="/gostd/crypto/tls/conn.go.html#4462274">config</a></span><span class="op" id="4582655">.</span><span class="ident" id="4582656"><a href="/gostd/crypto/tls/common.go.html#4454006">SessionTicketKey</a></span><span class="op" id="4582672">[</span><span class="num" id="4582673">16</span><span class="op" id="4582675">:</span><span class="num" id="4582676">32</span><span class="op" id="4582678">]</span><span class="op" id="4582679">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582682"><a href="/gostd/crypto/tls/ticket.go.html#4582619">mac</a></span><span class="op" id="4582685">.</span><span class="ident" id="4582686"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4582691">(</span><span class="ident" id="4582692"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582701">[</span><span class="op" id="4582702">:</span><span class="builtinfunc" id="4582703">len</span><span class="op" id="4582706">(</span><span class="ident" id="4582707"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582716">)</span><span class="op" id="4582717">-</span><span class="ident" id="4582718"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4582724">.</span><span class="ident" id="4582725"><a href="/gostd/crypto/sha256/sha256.go.html#4758698">Size</a></span><span class="op" id="4582729">]</span><span class="op" id="4582730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582733">expected</span>&nbsp;<span class="op" id="4582742">:=</span>&nbsp;<span class="ident" id="4582745"><a href="/gostd/crypto/tls/ticket.go.html#4582619">mac</a></span><span class="op" id="4582748">.</span><span class="ident" id="4582749"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4582752">(</span><span class="builtintype" id="4582753">nil</span><span class="op" id="4582756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582760">if</span>&nbsp;<span class="ident" id="4582763"><a href="/gostd/crypto/tls/ticket.go.html#4579220">subtle</a></span><span class="op" id="4582769">.</span><span class="ident" id="4582770"><a href="/gostd/crypto/subtle/constant_time.go.html#4428560">ConstantTimeCompare</a></span><span class="op" id="4582789">(</span><span class="ident" id="4582790"><a href="/gostd/crypto/tls/ticket.go.html#4582566">macBytes</a></span><span class="op" id="4582798">,</span>&nbsp;<span class="ident" id="4582800"><a href="/gostd/crypto/tls/ticket.go.html#4582733">expected</a></span><span class="op" id="4582808">)</span>&nbsp;<span class="op" id="4582810">!=</span>&nbsp;<span class="num" id="4582813">1</span>&nbsp;<span class="op" id="4582815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582819">return</span>&nbsp;<span class="builtintype" id="4582826">nil</span><span class="op" id="4582829">,</span>&nbsp;<span class="builtintype" id="4582831">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582842">block</span><span class="op" id="4582847">,</span>&nbsp;<span class="ident" id="4582849">err</span>&nbsp;<span class="op" id="4582853">:=</span>&nbsp;<span class="ident" id="4582856"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4582859">.</span><span class="ident" id="4582860"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4582869">(</span><span class="ident" id="4582870"><a href="/gostd/crypto/tls/ticket.go.html#4582357">c</a></span><span class="op" id="4582871">.</span><span class="ident" id="4582872"><a href="/gostd/crypto/tls/conn.go.html#4462274">config</a></span><span class="op" id="4582878">.</span><span class="ident" id="4582879"><a href="/gostd/crypto/tls/common.go.html#4454006">SessionTicketKey</a></span><span class="op" id="4582895">[</span><span class="op" id="4582896">:</span><span class="num" id="4582897">16</span><span class="op" id="4582899">]</span><span class="op" id="4582900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582903">if</span>&nbsp;<span class="ident" id="4582906"><a href="/gostd/crypto/tls/ticket.go.html#4582849">err</a></span>&nbsp;<span class="op" id="4582910">!=</span>&nbsp;<span class="builtintype" id="4582913">nil</span>&nbsp;<span class="op" id="4582917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4582921">return</span>&nbsp;<span class="builtintype" id="4582928">nil</span><span class="op" id="4582931">,</span>&nbsp;<span class="builtintype" id="4582933">false</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4582940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4582943">ciphertext</span>&nbsp;<span class="op" id="4582954">:=</span>&nbsp;<span class="ident" id="4582957"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582966">[</span><span class="ident" id="4582967"><a href="/gostd/crypto/tls/ticket.go.html#4579157">aes</a></span><span class="op" id="4582970">.</span><span class="ident" id="4582971"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span>&nbsp;<span class="op" id="4582981">:</span>&nbsp;<span class="builtinfunc" id="4582983">len</span><span class="op" id="4582986">(</span><span class="ident" id="4582987"><a href="/gostd/crypto/tls/ticket.go.html#4582380">encrypted</a></span><span class="op" id="4582996">)</span><span class="op" id="4582997">-</span><span class="ident" id="4582998"><a href="/gostd/crypto/tls/ticket.go.html#4579203">sha256</a></span><span class="op" id="4583004">.</span><span class="ident" id="4583005"><a href="/gostd/crypto/sha256/sha256.go.html#4758698">Size</a></span><span class="op" id="4583009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583012">plaintext</span>&nbsp;<span class="op" id="4583022">:=</span>&nbsp;<span class="ident" id="4583025"><a href="/gostd/crypto/tls/ticket.go.html#4582943">ciphertext</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583037"><a href="/gostd/crypto/tls/ticket.go.html#4579171">cipher</a></span><span class="op" id="4583043">.</span><span class="ident" id="4583044"><a href="/gostd/crypto/cipher/ctr.go.html#4412419">NewCTR</a></span><span class="op" id="4583050">(</span><span class="ident" id="4583051"><a href="/gostd/crypto/tls/ticket.go.html#4582842">block</a></span><span class="op" id="4583056">,</span>&nbsp;<span class="ident" id="4583058"><a href="/gostd/crypto/tls/ticket.go.html#4582533">iv</a></span><span class="op" id="4583060">)</span><span class="op" id="4583061">.</span><span class="ident" id="4583062"><a href="/gostd/crypto/cipher/cipher.go.html#4411241">XORKeyStream</a></span><span class="op" id="4583074">(</span><span class="ident" id="4583075"><a href="/gostd/crypto/tls/ticket.go.html#4583012">plaintext</a></span><span class="op" id="4583084">,</span>&nbsp;<span class="ident" id="4583086"><a href="/gostd/crypto/tls/ticket.go.html#4582943">ciphertext</a></span><span class="op" id="4583096">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583100">state</span>&nbsp;<span class="op" id="4583106">:=</span>&nbsp;<span class="builtinfunc" id="4583109">new</span><span class="op" id="4583112">(</span><span class="ident" id="4583113"><a href="/gostd/crypto/tls/ticket.go.html#4579384">sessionState</a></span><span class="op" id="4583125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4583128">ok</span>&nbsp;<span class="op" id="4583131">:=</span>&nbsp;<span class="ident" id="4583134"><a href="/gostd/crypto/tls/ticket.go.html#4583100">state</a></span><span class="op" id="4583139">.</span><span class="ident" id="4583140"><a href="/gostd/crypto/tls/ticket.go.html#4580705">unmarshal</a></span><span class="op" id="4583149">(</span><span class="ident" id="4583150"><a href="/gostd/crypto/tls/ticket.go.html#4583012">plaintext</a></span><span class="op" id="4583159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4583162">return</span>&nbsp;<span class="ident" id="4583169"><a href="/gostd/crypto/tls/ticket.go.html#4583100">state</a></span><span class="op" id="4583174">,</span>&nbsp;<span class="ident" id="4583176"><a href="/gostd/crypto/tls/ticket.go.html#4583128">ok</a></span><br>
<span class="lineno"></span><span class="op" id="4583179">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
