<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3796879">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3796934">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3796988">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3797039">package</span>&nbsp;<span class="ident" id="3797047">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3797052">import</span>&nbsp;<span class="op" id="3797059">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3797062">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="3797080">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3797083">func</span>&nbsp;<span class="ident" id="3797088">cryptBlock</span><span class="op" id="3797098">(</span><span class="ident" id="3797099">subkeys</span>&nbsp;<span class="op" id="3797107">[</span><span class="op" id="3797108">]</span><span class="ident" id="3797109">uint64</span><span class="op" id="3797115">,</span>&nbsp;<span class="ident" id="3797117">dst</span><span class="op" id="3797120">,</span>&nbsp;<span class="ident" id="3797122">src</span>&nbsp;<span class="op" id="3797126">[</span><span class="op" id="3797127">]</span><span class="builtintype" id="3797128">byte</span><span class="op" id="3797132">,</span>&nbsp;<span class="ident" id="3797134">decrypt</span>&nbsp;<span class="builtintype" id="3797142">bool</span><span class="op" id="3797146">)</span>&nbsp;<span class="op" id="3797148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797151">b</span>&nbsp;<span class="op" id="3797153">:=</span>&nbsp;<span class="ident" id="3797156">binary</span><span class="op" id="3797162">.</span><span class="ident" id="3797163">BigEndian</span><span class="op" id="3797172">.</span><span class="ident" id="3797173">Uint64</span><span class="op" id="3797179">(</span><span class="ident" id="3797180">src</span><span class="op" id="3797183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797186">b</span>&nbsp;<span class="op" id="3797188">=</span>&nbsp;<span class="ident" id="3797190">permuteInitialBlock</span><span class="op" id="3797209">(</span><span class="ident" id="3797210">b</span><span class="op" id="3797211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797214">left</span><span class="op" id="3797218">,</span>&nbsp;<span class="ident" id="3797220">right</span>&nbsp;<span class="op" id="3797226">:=</span>&nbsp;<span class="builtintype" id="3797229">uint32</span><span class="op" id="3797235">(</span><span class="ident" id="3797236">b</span><span class="op" id="3797237">&gt;&gt;</span><span class="num" id="3797239">32</span><span class="op" id="3797241">)</span><span class="op" id="3797242">,</span>&nbsp;<span class="builtintype" id="3797244">uint32</span><span class="op" id="3797250">(</span><span class="ident" id="3797251">b</span><span class="op" id="3797252">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797256">var</span>&nbsp;<span class="ident" id="3797260">subkey</span>&nbsp;<span class="ident" id="3797267">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797275">for</span>&nbsp;<span class="ident" id="3797279">i</span>&nbsp;<span class="op" id="3797281">:=</span>&nbsp;<span class="num" id="3797284">0</span><span class="op" id="3797285">;</span>&nbsp;<span class="ident" id="3797287">i</span>&nbsp;<span class="op" id="3797289">&lt;</span>&nbsp;<span class="num" id="3797291">16</span><span class="op" id="3797293">;</span>&nbsp;<span class="ident" id="3797295">i</span><span class="op" id="3797296">++</span>&nbsp;<span class="op" id="3797299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797303">if</span>&nbsp;<span class="ident" id="3797306">decrypt</span>&nbsp;<span class="op" id="3797314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797319">subkey</span>&nbsp;<span class="op" id="3797326">=</span>&nbsp;<span class="ident" id="3797328">subkeys</span><span class="op" id="3797335">[</span><span class="num" id="3797336">15</span><span class="op" id="3797338">-</span><span class="ident" id="3797339">i</span><span class="op" id="3797340">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3797344">}</span>&nbsp;<span class="keyword" id="3797346">else</span>&nbsp;<span class="op" id="3797351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797356">subkey</span>&nbsp;<span class="op" id="3797363">=</span>&nbsp;<span class="ident" id="3797365">subkeys</span><span class="op" id="3797372">[</span><span class="ident" id="3797373">i</span><span class="op" id="3797374">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3797378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797383">left</span><span class="op" id="3797387">,</span>&nbsp;<span class="ident" id="3797389">right</span>&nbsp;<span class="op" id="3797395">=</span>&nbsp;<span class="ident" id="3797397">right</span><span class="op" id="3797402">,</span>&nbsp;<span class="ident" id="3797404">left</span><span class="op" id="3797408">^</span><span class="ident" id="3797409">feistel</span><span class="op" id="3797416">(</span><span class="ident" id="3797417">right</span><span class="op" id="3797422">,</span>&nbsp;<span class="ident" id="3797424">subkey</span><span class="op" id="3797430">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3797433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797436">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797490">preOutput</span>&nbsp;<span class="op" id="3797500">:=</span>&nbsp;<span class="op" id="3797503">(</span><span class="ident" id="3797504">uint64</span><span class="op" id="3797510">(</span><span class="ident" id="3797511">right</span><span class="op" id="3797516">)</span>&nbsp;<span class="op" id="3797518">&lt;&lt;</span>&nbsp;<span class="num" id="3797521">32</span><span class="op" id="3797523">)</span>&nbsp;<span class="op" id="3797525">|</span>&nbsp;<span class="ident" id="3797527">uint64</span><span class="op" id="3797533">(</span><span class="ident" id="3797534">left</span><span class="op" id="3797538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797541">binary</span><span class="op" id="3797547">.</span><span class="ident" id="3797548">BigEndian</span><span class="op" id="3797557">.</span><span class="ident" id="3797558">PutUint64</span><span class="op" id="3797567">(</span><span class="ident" id="3797568">dst</span><span class="op" id="3797571">,</span>&nbsp;<span class="ident" id="3797573">permuteFinalBlock</span><span class="op" id="3797590">(</span><span class="ident" id="3797591">preOutput</span><span class="op" id="3797600">)</span><span class="op" id="3797601">)</span><br>
<span class="lineno"></span><span class="op" id="3797603">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3797606">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3797665">func</span>&nbsp;<span class="ident" id="3797670">encryptBlock</span><span class="op" id="3797682">(</span><span class="ident" id="3797683">subkeys</span>&nbsp;<span class="op" id="3797691">[</span><span class="op" id="3797692">]</span><span class="ident" id="3797693">uint64</span><span class="op" id="3797699">,</span>&nbsp;<span class="ident" id="3797701">dst</span><span class="op" id="3797704">,</span>&nbsp;<span class="ident" id="3797706">src</span>&nbsp;<span class="op" id="3797710">[</span><span class="op" id="3797711">]</span><span class="builtintype" id="3797712">byte</span><span class="op" id="3797716">)</span>&nbsp;<span class="op" id="3797718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797721">cryptBlock</span><span class="op" id="3797731">(</span><span class="ident" id="3797732">subkeys</span><span class="op" id="3797739">,</span>&nbsp;<span class="ident" id="3797741">dst</span><span class="op" id="3797744">,</span>&nbsp;<span class="ident" id="3797746">src</span><span class="op" id="3797749">,</span>&nbsp;<span class="builtintype" id="3797751">false</span><span class="op" id="3797756">)</span><br>
<span class="lineno"></span><span class="op" id="3797758">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3797761">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3797820">func</span>&nbsp;<span class="ident" id="3797825">decryptBlock</span><span class="op" id="3797837">(</span><span class="ident" id="3797838">subkeys</span>&nbsp;<span class="op" id="3797846">[</span><span class="op" id="3797847">]</span><span class="ident" id="3797848">uint64</span><span class="op" id="3797854">,</span>&nbsp;<span class="ident" id="3797856">dst</span><span class="op" id="3797859">,</span>&nbsp;<span class="ident" id="3797861">src</span>&nbsp;<span class="op" id="3797865">[</span><span class="op" id="3797866">]</span><span class="builtintype" id="3797867">byte</span><span class="op" id="3797871">)</span>&nbsp;<span class="op" id="3797873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797876">cryptBlock</span><span class="op" id="3797886">(</span><span class="ident" id="3797887">subkeys</span><span class="op" id="3797894">,</span>&nbsp;<span class="ident" id="3797896">dst</span><span class="op" id="3797899">,</span>&nbsp;<span class="ident" id="3797901">src</span><span class="op" id="3797904">,</span>&nbsp;<span class="builtintype" id="3797906">true</span><span class="op" id="3797910">)</span><br>
<span class="lineno"></span><span class="op" id="3797912">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3797915">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="3797939">func</span>&nbsp;<span class="ident" id="3797944">feistel</span><span class="op" id="3797951">(</span><span class="ident" id="3797952">right</span>&nbsp;<span class="builtintype" id="3797958">uint32</span><span class="op" id="3797964">,</span>&nbsp;<span class="ident" id="3797966">key</span>&nbsp;<span class="ident" id="3797970">uint64</span><span class="op" id="3797976">)</span>&nbsp;<span class="op" id="3797978">(</span><span class="ident" id="3797979">result</span>&nbsp;<span class="builtintype" id="3797986">uint32</span><span class="op" id="3797992">)</span>&nbsp;<span class="op" id="3797994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797997">sBoxLocations</span>&nbsp;<span class="op" id="3798011">:=</span>&nbsp;<span class="ident" id="3798014">key</span>&nbsp;<span class="op" id="3798018">^</span>&nbsp;<span class="ident" id="3798020">expandBlock</span><span class="op" id="3798031">(</span><span class="ident" id="3798032">right</span><span class="op" id="3798037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798040">var</span>&nbsp;<span class="ident" id="3798044">sBoxResult</span>&nbsp;<span class="builtintype" id="3798055">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798063">for</span>&nbsp;<span class="ident" id="3798067">i</span>&nbsp;<span class="op" id="3798069">:=</span>&nbsp;<span class="builtintype" id="3798072">uint8</span><span class="op" id="3798077">(</span><span class="num" id="3798078">0</span><span class="op" id="3798079">)</span><span class="op" id="3798080">;</span>&nbsp;<span class="ident" id="3798082">i</span>&nbsp;<span class="op" id="3798084">&lt;</span>&nbsp;<span class="num" id="3798086">8</span><span class="op" id="3798087">;</span>&nbsp;<span class="ident" id="3798089">i</span><span class="op" id="3798090">++</span>&nbsp;<span class="op" id="3798093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798097">sBoxLocation</span>&nbsp;<span class="op" id="3798110">:=</span>&nbsp;<span class="builtintype" id="3798113">uint8</span><span class="op" id="3798118">(</span><span class="ident" id="3798119">sBoxLocations</span><span class="op" id="3798132">&gt;&gt;</span><span class="num" id="3798134">42</span><span class="op" id="3798136">)</span>&nbsp;<span class="op" id="3798138">&amp;</span>&nbsp;<span class="num" id="3798140">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798147">sBoxLocations</span>&nbsp;<span class="op" id="3798161">&lt;&lt;=</span>&nbsp;<span class="num" id="3798165">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798169">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798208">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798240">row</span>&nbsp;<span class="op" id="3798244">:=</span>&nbsp;<span class="op" id="3798247">(</span><span class="ident" id="3798248">sBoxLocation</span>&nbsp;<span class="op" id="3798261">&amp;</span>&nbsp;<span class="num" id="3798263">0x1</span><span class="op" id="3798266">)</span>&nbsp;<span class="op" id="3798268">|</span>&nbsp;<span class="op" id="3798270">(</span><span class="op" id="3798271">(</span><span class="ident" id="3798272">sBoxLocation</span>&nbsp;<span class="op" id="3798285">&amp;</span>&nbsp;<span class="num" id="3798287">0x20</span><span class="op" id="3798291">)</span>&nbsp;<span class="op" id="3798293">&gt;&gt;</span>&nbsp;<span class="num" id="3798296">4</span><span class="op" id="3798297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798301">column</span>&nbsp;<span class="op" id="3798308">:=</span>&nbsp;<span class="op" id="3798311">(</span><span class="ident" id="3798312">sBoxLocation</span>&nbsp;<span class="op" id="3798325">&gt;&gt;</span>&nbsp;<span class="num" id="3798328">1</span><span class="op" id="3798329">)</span>&nbsp;<span class="op" id="3798331">&amp;</span>&nbsp;<span class="num" id="3798333">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798339">sBoxResult</span>&nbsp;<span class="op" id="3798350">^=</span>&nbsp;<span class="ident" id="3798353">feistelBox</span><span class="op" id="3798363">[</span><span class="ident" id="3798364">i</span><span class="op" id="3798365">]</span><span class="op" id="3798366">[</span><span class="num" id="3798367">16</span><span class="op" id="3798369">*</span><span class="ident" id="3798370">row</span><span class="op" id="3798373">+</span><span class="ident" id="3798374">column</span><span class="op" id="3798380">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798386">return</span>&nbsp;<span class="ident" id="3798393">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="3798404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3798407">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="3798475">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="3798509">var</span>&nbsp;<span class="ident" id="3798513">feistelBox</span>&nbsp;<span class="op" id="3798524">[</span><span class="num" id="3798525">8</span><span class="op" id="3798526">]</span><span class="op" id="3798527">[</span><span class="num" id="3798528">64</span><span class="op" id="3798530">]</span><span class="builtintype" id="3798531">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3798539">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="3798601">func</span>&nbsp;<span class="ident" id="3798606">permuteBlock</span><span class="op" id="3798618">(</span><span class="ident" id="3798619">src</span>&nbsp;<span class="ident" id="3798623">uint64</span><span class="op" id="3798629">,</span>&nbsp;<span class="ident" id="3798631">permutation</span>&nbsp;<span class="op" id="3798643">[</span><span class="op" id="3798644">]</span><span class="builtintype" id="3798645">uint8</span><span class="op" id="3798650">)</span>&nbsp;<span class="op" id="3798652">(</span><span class="ident" id="3798653">block</span>&nbsp;<span class="ident" id="3798659">uint64</span><span class="op" id="3798665">)</span>&nbsp;<span class="op" id="3798667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798670">for</span>&nbsp;<span class="ident" id="3798674">position</span><span class="op" id="3798682">,</span>&nbsp;<span class="ident" id="3798684">n</span>&nbsp;<span class="op" id="3798686">:=</span>&nbsp;<span class="keyword" id="3798689">range</span>&nbsp;<span class="ident" id="3798695">permutation</span>&nbsp;<span class="op" id="3798707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798711">bit</span>&nbsp;<span class="op" id="3798715">:=</span>&nbsp;<span class="op" id="3798718">(</span><span class="ident" id="3798719">src</span>&nbsp;<span class="op" id="3798723">&gt;&gt;</span>&nbsp;<span class="ident" id="3798726">n</span><span class="op" id="3798727">)</span>&nbsp;<span class="op" id="3798729">&amp;</span>&nbsp;<span class="num" id="3798731">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798735">block</span>&nbsp;<span class="op" id="3798741">|=</span>&nbsp;<span class="ident" id="3798744">bit</span>&nbsp;<span class="op" id="3798748">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3798751">uint</span><span class="op" id="3798755">(</span><span class="op" id="3798756">(</span><span class="builtinfunc" id="3798757">len</span><span class="op" id="3798760">(</span><span class="ident" id="3798761">permutation</span><span class="op" id="3798772">)</span><span class="op" id="3798773">-</span><span class="num" id="3798774">1</span><span class="op" id="3798775">)</span><span class="op" id="3798776">-</span><span class="ident" id="3798777">position</span><span class="op" id="3798785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798791">return</span><br>
<span class="lineno"></span><span class="op" id="3798798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3798801">func</span>&nbsp;<span class="ident" id="3798806">init</span><span class="op" id="3798810">(</span><span class="op" id="3798811">)</span>&nbsp;<span class="op" id="3798813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798816">for</span>&nbsp;<span class="ident" id="3798820">s</span>&nbsp;<span class="op" id="3798822">:=</span>&nbsp;<span class="keyword" id="3798825">range</span>&nbsp;<span class="ident" id="3798831">sBoxes</span>&nbsp;<span class="op" id="3798838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798842">for</span>&nbsp;<span class="ident" id="3798846">i</span>&nbsp;<span class="op" id="3798848">:=</span>&nbsp;<span class="num" id="3798851">0</span><span class="op" id="3798852">;</span>&nbsp;<span class="ident" id="3798854">i</span>&nbsp;<span class="op" id="3798856">&lt;</span>&nbsp;<span class="num" id="3798858">4</span><span class="op" id="3798859">;</span>&nbsp;<span class="ident" id="3798861">i</span><span class="op" id="3798862">++</span>&nbsp;<span class="op" id="3798865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798870">for</span>&nbsp;<span class="ident" id="3798874">j</span>&nbsp;<span class="op" id="3798876">:=</span>&nbsp;<span class="num" id="3798879">0</span><span class="op" id="3798880">;</span>&nbsp;<span class="ident" id="3798882">j</span>&nbsp;<span class="op" id="3798884">&lt;</span>&nbsp;<span class="num" id="3798886">16</span><span class="op" id="3798888">;</span>&nbsp;<span class="ident" id="3798890">j</span><span class="op" id="3798891">++</span>&nbsp;<span class="op" id="3798894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798900">f</span>&nbsp;<span class="op" id="3798902">:=</span>&nbsp;<span class="ident" id="3798905">uint64</span><span class="op" id="3798911">(</span><span class="ident" id="3798912">sBoxes</span><span class="op" id="3798918">[</span><span class="ident" id="3798919">s</span><span class="op" id="3798920">]</span><span class="op" id="3798921">[</span><span class="ident" id="3798922">i</span><span class="op" id="3798923">]</span><span class="op" id="3798924">[</span><span class="ident" id="3798925">j</span><span class="op" id="3798926">]</span><span class="op" id="3798927">)</span>&nbsp;<span class="op" id="3798929">&lt;&lt;</span>&nbsp;<span class="op" id="3798932">(</span><span class="num" id="3798933">4</span>&nbsp;<span class="op" id="3798935">*</span>&nbsp;<span class="op" id="3798937">(</span><span class="num" id="3798938">7</span>&nbsp;<span class="op" id="3798940">-</span>&nbsp;<span class="builtintype" id="3798942">uint</span><span class="op" id="3798946">(</span><span class="ident" id="3798947">s</span><span class="op" id="3798948">)</span><span class="op" id="3798949">)</span><span class="op" id="3798950">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798956">f</span>&nbsp;<span class="op" id="3798958">=</span>&nbsp;<span class="ident" id="3798960">permuteBlock</span><span class="op" id="3798972">(</span><span class="ident" id="3798973">uint64</span><span class="op" id="3798979">(</span><span class="ident" id="3798980">f</span><span class="op" id="3798981">)</span><span class="op" id="3798982">,</span>&nbsp;<span class="ident" id="3798984">permutationFunction</span><span class="op" id="3799003">[</span><span class="op" id="3799004">:</span><span class="op" id="3799005">]</span><span class="op" id="3799006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799012">feistelBox</span><span class="op" id="3799022">[</span><span class="ident" id="3799023">s</span><span class="op" id="3799024">]</span><span class="op" id="3799025">[</span><span class="num" id="3799026">16</span><span class="op" id="3799028">*</span><span class="ident" id="3799029">i</span><span class="op" id="3799030">+</span><span class="ident" id="3799031">j</span><span class="op" id="3799032">]</span>&nbsp;<span class="op" id="3799034">=</span>&nbsp;<span class="builtintype" id="3799036">uint32</span><span class="op" id="3799042">(</span><span class="ident" id="3799043">f</span><span class="op" id="3799044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799056">}</span><br>
<span class="lineno">80</span><span class="op" id="3799058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3799061">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3799111">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="3799152">func</span>&nbsp;<span class="ident" id="3799157">expandBlock</span><span class="op" id="3799168">(</span><span class="ident" id="3799169">src</span>&nbsp;<span class="builtintype" id="3799173">uint32</span><span class="op" id="3799179">)</span>&nbsp;<span class="op" id="3799181">(</span><span class="ident" id="3799182">block</span>&nbsp;<span class="ident" id="3799188">uint64</span><span class="op" id="3799194">)</span>&nbsp;<span class="op" id="3799196">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799199">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799243">src</span>&nbsp;<span class="op" id="3799247">=</span>&nbsp;<span class="op" id="3799249">(</span><span class="ident" id="3799250">src</span>&nbsp;<span class="op" id="3799254">&lt;&lt;</span>&nbsp;<span class="num" id="3799257">5</span><span class="op" id="3799258">)</span>&nbsp;<span class="op" id="3799260">|</span>&nbsp;<span class="op" id="3799262">(</span><span class="ident" id="3799263">src</span>&nbsp;<span class="op" id="3799267">&gt;&gt;</span>&nbsp;<span class="num" id="3799270">27</span><span class="op" id="3799272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799275">for</span>&nbsp;<span class="ident" id="3799279">i</span>&nbsp;<span class="op" id="3799281">:=</span>&nbsp;<span class="num" id="3799284">0</span><span class="op" id="3799285">;</span>&nbsp;<span class="ident" id="3799287">i</span>&nbsp;<span class="op" id="3799289">&lt;</span>&nbsp;<span class="num" id="3799291">8</span><span class="op" id="3799292">;</span>&nbsp;<span class="ident" id="3799294">i</span><span class="op" id="3799295">++</span>&nbsp;<span class="op" id="3799298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799302">block</span>&nbsp;<span class="op" id="3799308">&lt;&lt;=</span>&nbsp;<span class="num" id="3799312">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799316">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799350">block</span>&nbsp;<span class="op" id="3799356">|=</span>&nbsp;<span class="ident" id="3799359">uint64</span><span class="op" id="3799365">(</span><span class="ident" id="3799366">src</span><span class="op" id="3799369">)</span>&nbsp;<span class="op" id="3799371">&amp;</span>&nbsp;<span class="op" id="3799373">(</span><span class="num" id="3799374">1</span><span class="op" id="3799375">&lt;&lt;</span><span class="num" id="3799377">6</span>&nbsp;<span class="op" id="3799379">-</span>&nbsp;<span class="num" id="3799381">1</span><span class="op" id="3799382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799386">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799410">src</span>&nbsp;<span class="op" id="3799414">=</span>&nbsp;<span class="op" id="3799416">(</span><span class="ident" id="3799417">src</span>&nbsp;<span class="op" id="3799421">&lt;&lt;</span>&nbsp;<span class="num" id="3799424">4</span><span class="op" id="3799425">)</span>&nbsp;<span class="op" id="3799427">|</span>&nbsp;<span class="op" id="3799429">(</span><span class="ident" id="3799430">src</span>&nbsp;<span class="op" id="3799434">&gt;&gt;</span>&nbsp;<span class="num" id="3799437">28</span><span class="op" id="3799439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799445">return</span><br>
<span class="lineno">95</span><span class="op" id="3799452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3799455">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3799519">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3799545">func</span>&nbsp;<span class="ident" id="3799550">permuteInitialBlock</span><span class="op" id="3799569">(</span><span class="ident" id="3799570">block</span>&nbsp;<span class="ident" id="3799576">uint64</span><span class="op" id="3799582">)</span>&nbsp;<span class="ident" id="3799584">uint64</span>&nbsp;<span class="op" id="3799591">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799594">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799640">b1</span>&nbsp;<span class="op" id="3799643">:=</span>&nbsp;<span class="ident" id="3799646">block</span>&nbsp;<span class="op" id="3799652">&gt;&gt;</span>&nbsp;<span class="num" id="3799655">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799659">b2</span>&nbsp;<span class="op" id="3799662">:=</span>&nbsp;<span class="ident" id="3799665">block</span>&nbsp;<span class="op" id="3799671">&lt;&lt;</span>&nbsp;<span class="num" id="3799674">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799678">block</span>&nbsp;<span class="op" id="3799684">^=</span>&nbsp;<span class="ident" id="3799687">b1</span>&nbsp;<span class="op" id="3799690">^</span>&nbsp;<span class="ident" id="3799692">b2</span>&nbsp;<span class="op" id="3799695">^</span>&nbsp;<span class="ident" id="3799697">b1</span><span class="op" id="3799699">&lt;&lt;</span><span class="num" id="3799701">48</span>&nbsp;<span class="op" id="3799704">^</span>&nbsp;<span class="ident" id="3799706">b2</span><span class="op" id="3799708">&gt;&gt;</span><span class="num" id="3799710">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799715">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799751">b1</span>&nbsp;<span class="op" id="3799754">=</span>&nbsp;<span class="ident" id="3799756">block</span>&nbsp;<span class="op" id="3799762">&gt;&gt;</span>&nbsp;<span class="num" id="3799765">32</span>&nbsp;<span class="op" id="3799768">&amp;</span>&nbsp;<span class="num" id="3799770">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799780">b2</span>&nbsp;<span class="op" id="3799783">=</span>&nbsp;<span class="op" id="3799785">(</span><span class="ident" id="3799786">block</span>&nbsp;<span class="op" id="3799792">&amp;</span>&nbsp;<span class="num" id="3799794">0xff00ff00</span><span class="op" id="3799804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799807">block</span>&nbsp;<span class="op" id="3799813">^=</span>&nbsp;<span class="ident" id="3799816">b1</span><span class="op" id="3799818">&lt;&lt;</span><span class="num" id="3799820">32</span>&nbsp;<span class="op" id="3799823">^</span>&nbsp;<span class="ident" id="3799825">b2</span>&nbsp;<span class="op" id="3799828">^</span>&nbsp;<span class="ident" id="3799830">b1</span><span class="op" id="3799832">&lt;&lt;</span><span class="num" id="3799834">8</span>&nbsp;<span class="op" id="3799836">^</span>&nbsp;<span class="ident" id="3799838">b2</span><span class="op" id="3799840">&lt;&lt;</span><span class="num" id="3799842">24</span>&nbsp;<span class="comment" id="3799845">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799876">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799963">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799991">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800019">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800047">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800075">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800131">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800160">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800203">b1</span>&nbsp;<span class="op" id="3800206">=</span>&nbsp;<span class="ident" id="3800208">block</span>&nbsp;<span class="op" id="3800214">&amp;</span>&nbsp;<span class="num" id="3800216">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800236">b2</span>&nbsp;<span class="op" id="3800239">=</span>&nbsp;<span class="ident" id="3800241">block</span>&nbsp;<span class="op" id="3800247">&amp;</span>&nbsp;<span class="num" id="3800249">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800269">block</span>&nbsp;<span class="op" id="3800275">^=</span>&nbsp;<span class="ident" id="3800278">b1</span>&nbsp;<span class="op" id="3800281">^</span>&nbsp;<span class="ident" id="3800283">b2</span>&nbsp;<span class="op" id="3800286">^</span>&nbsp;<span class="ident" id="3800288">b1</span><span class="op" id="3800290">&gt;&gt;</span><span class="num" id="3800292">12</span>&nbsp;<span class="op" id="3800295">^</span>&nbsp;<span class="ident" id="3800297">b2</span><span class="op" id="3800299">&lt;&lt;</span><span class="num" id="3800301">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800306">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800336">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800340">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800365">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800369">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800385">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800401">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800417">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800443">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800481">b1</span>&nbsp;<span class="op" id="3800484">=</span>&nbsp;<span class="ident" id="3800486">block</span>&nbsp;<span class="op" id="3800492">&amp;</span>&nbsp;<span class="num" id="3800494">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800514">b2</span>&nbsp;<span class="op" id="3800517">=</span>&nbsp;<span class="ident" id="3800519">block</span>&nbsp;<span class="op" id="3800525">&amp;</span>&nbsp;<span class="num" id="3800527">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800547">block</span>&nbsp;<span class="op" id="3800553">^=</span>&nbsp;<span class="ident" id="3800556">b1</span>&nbsp;<span class="op" id="3800559">^</span>&nbsp;<span class="ident" id="3800561">b2</span>&nbsp;<span class="op" id="3800564">^</span>&nbsp;<span class="ident" id="3800566">b1</span><span class="op" id="3800568">&gt;&gt;</span><span class="num" id="3800570">6</span>&nbsp;<span class="op" id="3800572">^</span>&nbsp;<span class="ident" id="3800574">b2</span><span class="op" id="3800576">&lt;&lt;</span><span class="num" id="3800578">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800582">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800612">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800622">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800632">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800642">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800652">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800662">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800672">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800682">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800711">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800749">b1</span>&nbsp;<span class="op" id="3800752">=</span>&nbsp;<span class="ident" id="3800754">block</span>&nbsp;<span class="op" id="3800760">&amp;</span>&nbsp;<span class="num" id="3800762">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800782">block</span>&nbsp;<span class="op" id="3800788">^=</span>&nbsp;<span class="ident" id="3800791">b1</span>&nbsp;<span class="op" id="3800794">^</span>&nbsp;<span class="ident" id="3800796">b1</span><span class="op" id="3800798">&gt;&gt;</span><span class="num" id="3800800">33</span>&nbsp;<span class="op" id="3800803">^</span>&nbsp;<span class="ident" id="3800805">b1</span><span class="op" id="3800807">&lt;&lt;</span><span class="num" id="3800809">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800814">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800844">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800871">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800898">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800925">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800952">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3800979">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3801006">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3801033">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801060">return</span>&nbsp;<span class="ident" id="3801067">block</span><br>
<span class="lineno"></span><span class="op" id="3801073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3801076">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3801140">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3801164">func</span>&nbsp;<span class="ident" id="3801169">permuteFinalBlock</span><span class="op" id="3801186">(</span><span class="ident" id="3801187">block</span>&nbsp;<span class="ident" id="3801193">uint64</span><span class="op" id="3801199">)</span>&nbsp;<span class="ident" id="3801201">uint64</span>&nbsp;<span class="op" id="3801208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3801211">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3801269">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801295">b1</span>&nbsp;<span class="op" id="3801298">:=</span>&nbsp;<span class="ident" id="3801301">block</span>&nbsp;<span class="op" id="3801307">&amp;</span>&nbsp;<span class="num" id="3801309">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801329">block</span>&nbsp;<span class="op" id="3801335">^=</span>&nbsp;<span class="ident" id="3801338">b1</span>&nbsp;<span class="op" id="3801341">^</span>&nbsp;<span class="ident" id="3801343">b1</span><span class="op" id="3801345">&gt;&gt;</span><span class="num" id="3801347">33</span>&nbsp;<span class="op" id="3801350">^</span>&nbsp;<span class="ident" id="3801352">b1</span><span class="op" id="3801354">&lt;&lt;</span><span class="num" id="3801356">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801361">b1</span>&nbsp;<span class="op" id="3801364">=</span>&nbsp;<span class="ident" id="3801366">block</span>&nbsp;<span class="op" id="3801372">&amp;</span>&nbsp;<span class="num" id="3801374">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801394">b2</span>&nbsp;<span class="op" id="3801397">:=</span>&nbsp;<span class="ident" id="3801400">block</span>&nbsp;<span class="op" id="3801406">&amp;</span>&nbsp;<span class="num" id="3801408">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801428">block</span>&nbsp;<span class="op" id="3801434">^=</span>&nbsp;<span class="ident" id="3801437">b1</span>&nbsp;<span class="op" id="3801440">^</span>&nbsp;<span class="ident" id="3801442">b2</span>&nbsp;<span class="op" id="3801445">^</span>&nbsp;<span class="ident" id="3801447">b1</span><span class="op" id="3801449">&gt;&gt;</span><span class="num" id="3801451">6</span>&nbsp;<span class="op" id="3801453">^</span>&nbsp;<span class="ident" id="3801455">b2</span><span class="op" id="3801457">&lt;&lt;</span><span class="num" id="3801459">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801463">b1</span>&nbsp;<span class="op" id="3801466">=</span>&nbsp;<span class="ident" id="3801468">block</span>&nbsp;<span class="op" id="3801474">&amp;</span>&nbsp;<span class="num" id="3801476">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801496">b2</span>&nbsp;<span class="op" id="3801499">=</span>&nbsp;<span class="ident" id="3801501">block</span>&nbsp;<span class="op" id="3801507">&amp;</span>&nbsp;<span class="num" id="3801509">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801529">block</span>&nbsp;<span class="op" id="3801535">^=</span>&nbsp;<span class="ident" id="3801538">b1</span>&nbsp;<span class="op" id="3801541">^</span>&nbsp;<span class="ident" id="3801543">b2</span>&nbsp;<span class="op" id="3801546">^</span>&nbsp;<span class="ident" id="3801548">b1</span><span class="op" id="3801550">&gt;&gt;</span><span class="num" id="3801552">12</span>&nbsp;<span class="op" id="3801555">^</span>&nbsp;<span class="ident" id="3801557">b2</span><span class="op" id="3801559">&lt;&lt;</span><span class="num" id="3801561">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801566">b1</span>&nbsp;<span class="op" id="3801569">=</span>&nbsp;<span class="ident" id="3801571">block</span>&nbsp;<span class="op" id="3801577">&gt;&gt;</span>&nbsp;<span class="num" id="3801580">32</span>&nbsp;<span class="op" id="3801583">&amp;</span>&nbsp;<span class="num" id="3801585">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801595">b2</span>&nbsp;<span class="op" id="3801598">=</span>&nbsp;<span class="op" id="3801600">(</span><span class="ident" id="3801601">block</span>&nbsp;<span class="op" id="3801607">&amp;</span>&nbsp;<span class="num" id="3801609">0xff00ff00</span><span class="op" id="3801619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801622">block</span>&nbsp;<span class="op" id="3801628">^=</span>&nbsp;<span class="ident" id="3801631">b1</span><span class="op" id="3801633">&lt;&lt;</span><span class="num" id="3801635">32</span>&nbsp;<span class="op" id="3801638">^</span>&nbsp;<span class="ident" id="3801640">b2</span>&nbsp;<span class="op" id="3801643">^</span>&nbsp;<span class="ident" id="3801645">b1</span><span class="op" id="3801647">&lt;&lt;</span><span class="num" id="3801649">8</span>&nbsp;<span class="op" id="3801651">^</span>&nbsp;<span class="ident" id="3801653">b2</span><span class="op" id="3801655">&lt;&lt;</span><span class="num" id="3801657">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801662">b1</span>&nbsp;<span class="op" id="3801665">=</span>&nbsp;<span class="ident" id="3801667">block</span>&nbsp;<span class="op" id="3801673">&gt;&gt;</span>&nbsp;<span class="num" id="3801676">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801680">b2</span>&nbsp;<span class="op" id="3801683">=</span>&nbsp;<span class="ident" id="3801685">block</span>&nbsp;<span class="op" id="3801691">&lt;&lt;</span>&nbsp;<span class="num" id="3801694">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801698">block</span>&nbsp;<span class="op" id="3801704">^=</span>&nbsp;<span class="ident" id="3801707">b1</span>&nbsp;<span class="op" id="3801710">^</span>&nbsp;<span class="ident" id="3801712">b2</span>&nbsp;<span class="op" id="3801715">^</span>&nbsp;<span class="ident" id="3801717">b1</span><span class="op" id="3801719">&lt;&lt;</span><span class="num" id="3801721">48</span>&nbsp;<span class="op" id="3801724">^</span>&nbsp;<span class="ident" id="3801726">b2</span><span class="op" id="3801728">&gt;&gt;</span><span class="num" id="3801730">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801734">return</span>&nbsp;<span class="ident" id="3801741">block</span><br>
<span class="lineno"></span><span class="op" id="3801747">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3801750">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="3801796">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="3801824">func</span>&nbsp;<span class="ident" id="3801829">ksRotate</span><span class="op" id="3801837">(</span><span class="ident" id="3801838">in</span>&nbsp;<span class="builtintype" id="3801841">uint32</span><span class="op" id="3801847">)</span>&nbsp;<span class="op" id="3801849">(</span><span class="ident" id="3801850">out</span>&nbsp;<span class="op" id="3801854">[</span><span class="op" id="3801855">]</span><span class="builtintype" id="3801856">uint32</span><span class="op" id="3801862">)</span>&nbsp;<span class="op" id="3801864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801867">out</span>&nbsp;<span class="op" id="3801871">=</span>&nbsp;<span class="builtinfunc" id="3801873">make</span><span class="op" id="3801877">(</span><span class="op" id="3801878">[</span><span class="op" id="3801879">]</span><span class="builtintype" id="3801880">uint32</span><span class="op" id="3801886">,</span>&nbsp;<span class="num" id="3801888">16</span><span class="op" id="3801890">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801893">last</span>&nbsp;<span class="op" id="3801898">:=</span>&nbsp;<span class="ident" id="3801901">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801905">for</span>&nbsp;<span class="ident" id="3801909">i</span>&nbsp;<span class="op" id="3801911">:=</span>&nbsp;<span class="num" id="3801914">0</span><span class="op" id="3801915">;</span>&nbsp;<span class="ident" id="3801917">i</span>&nbsp;<span class="op" id="3801919">&lt;</span>&nbsp;<span class="num" id="3801921">16</span><span class="op" id="3801923">;</span>&nbsp;<span class="ident" id="3801925">i</span><span class="op" id="3801926">++</span>&nbsp;<span class="op" id="3801929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3801933">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801965">left</span>&nbsp;<span class="op" id="3801970">:=</span>&nbsp;<span class="op" id="3801973">(</span><span class="ident" id="3801974">last</span>&nbsp;<span class="op" id="3801979">&lt;&lt;</span>&nbsp;<span class="op" id="3801982">(</span><span class="num" id="3801983">4</span>&nbsp;<span class="op" id="3801985">+</span>&nbsp;<span class="ident" id="3801987">ksRotations</span><span class="op" id="3801998">[</span><span class="ident" id="3801999">i</span><span class="op" id="3802000">]</span><span class="op" id="3802001">)</span><span class="op" id="3802002">)</span>&nbsp;<span class="op" id="3802004">&gt;&gt;</span>&nbsp;<span class="num" id="3802007">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802011">right</span>&nbsp;<span class="op" id="3802017">:=</span>&nbsp;<span class="op" id="3802020">(</span><span class="ident" id="3802021">last</span>&nbsp;<span class="op" id="3802026">&lt;&lt;</span>&nbsp;<span class="num" id="3802029">4</span><span class="op" id="3802030">)</span>&nbsp;<span class="op" id="3802032">&gt;&gt;</span>&nbsp;<span class="op" id="3802035">(</span><span class="num" id="3802036">32</span>&nbsp;<span class="op" id="3802039">-</span>&nbsp;<span class="ident" id="3802041">ksRotations</span><span class="op" id="3802052">[</span><span class="ident" id="3802053">i</span><span class="op" id="3802054">]</span><span class="op" id="3802055">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802059">out</span><span class="op" id="3802062">[</span><span class="ident" id="3802063">i</span><span class="op" id="3802064">]</span>&nbsp;<span class="op" id="3802066">=</span>&nbsp;<span class="ident" id="3802068">left</span>&nbsp;<span class="op" id="3802073">|</span>&nbsp;<span class="ident" id="3802075">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802083">last</span>&nbsp;<span class="op" id="3802088">=</span>&nbsp;<span class="ident" id="3802090">out</span><span class="op" id="3802093">[</span><span class="ident" id="3802094">i</span><span class="op" id="3802095">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802101">return</span><br>
<span class="lineno"></span><span class="op" id="3802108">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="3802111">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="3802162">func</span>&nbsp;<span class="op" id="3802167">(</span><span class="ident" id="3802168">c</span>&nbsp;<span class="op" id="3802170">*</span><span class="ident" id="3802171">desCipher</span><span class="op" id="3802180">)</span>&nbsp;<span class="ident" id="3802182">generateSubkeys</span><span class="op" id="3802197">(</span><span class="ident" id="3802198">keyBytes</span>&nbsp;<span class="op" id="3802207">[</span><span class="op" id="3802208">]</span><span class="builtintype" id="3802209">byte</span><span class="op" id="3802213">)</span>&nbsp;<span class="op" id="3802215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802218">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802251">key</span>&nbsp;<span class="op" id="3802255">:=</span>&nbsp;<span class="ident" id="3802258">binary</span><span class="op" id="3802264">.</span><span class="ident" id="3802265">BigEndian</span><span class="op" id="3802274">.</span><span class="ident" id="3802275">Uint64</span><span class="op" id="3802281">(</span><span class="ident" id="3802282">keyBytes</span><span class="op" id="3802290">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802293">permutedKey</span>&nbsp;<span class="op" id="3802305">:=</span>&nbsp;<span class="ident" id="3802308">permuteBlock</span><span class="op" id="3802320">(</span><span class="ident" id="3802321">key</span><span class="op" id="3802324">,</span>&nbsp;<span class="ident" id="3802326">permutedChoice1</span><span class="op" id="3802341">[</span><span class="op" id="3802342">:</span><span class="op" id="3802343">]</span><span class="op" id="3802344">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802348">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802417">leftRotations</span>&nbsp;<span class="op" id="3802431">:=</span>&nbsp;<span class="ident" id="3802434">ksRotate</span><span class="op" id="3802442">(</span><span class="builtintype" id="3802443">uint32</span><span class="op" id="3802449">(</span><span class="ident" id="3802450">permutedKey</span>&nbsp;<span class="op" id="3802462">&gt;&gt;</span>&nbsp;<span class="num" id="3802465">28</span><span class="op" id="3802467">)</span><span class="op" id="3802468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802471">rightRotations</span>&nbsp;<span class="op" id="3802486">:=</span>&nbsp;<span class="ident" id="3802489">ksRotate</span><span class="op" id="3802497">(</span><span class="builtintype" id="3802498">uint32</span><span class="op" id="3802504">(</span><span class="ident" id="3802505">permutedKey</span><span class="op" id="3802516">&lt;&lt;</span><span class="num" id="3802518">4</span><span class="op" id="3802519">)</span>&nbsp;<span class="op" id="3802521">&gt;&gt;</span>&nbsp;<span class="num" id="3802524">4</span><span class="op" id="3802525">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802529">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802550">for</span>&nbsp;<span class="ident" id="3802554">i</span>&nbsp;<span class="op" id="3802556">:=</span>&nbsp;<span class="num" id="3802559">0</span><span class="op" id="3802560">;</span>&nbsp;<span class="ident" id="3802562">i</span>&nbsp;<span class="op" id="3802564">&lt;</span>&nbsp;<span class="num" id="3802566">16</span><span class="op" id="3802568">;</span>&nbsp;<span class="ident" id="3802570">i</span><span class="op" id="3802571">++</span>&nbsp;<span class="op" id="3802574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802578">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802626">pc2Input</span>&nbsp;<span class="op" id="3802635">:=</span>&nbsp;<span class="ident" id="3802638">uint64</span><span class="op" id="3802644">(</span><span class="ident" id="3802645">leftRotations</span><span class="op" id="3802658">[</span><span class="ident" id="3802659">i</span><span class="op" id="3802660">]</span><span class="op" id="3802661">)</span><span class="op" id="3802662">&lt;&lt;</span><span class="num" id="3802664">28</span>&nbsp;<span class="op" id="3802667">|</span>&nbsp;<span class="ident" id="3802669">uint64</span><span class="op" id="3802675">(</span><span class="ident" id="3802676">rightRotations</span><span class="op" id="3802690">[</span><span class="ident" id="3802691">i</span><span class="op" id="3802692">]</span><span class="op" id="3802693">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802697">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802740">c</span><span class="op" id="3802741">.</span><span class="ident" id="3802742">subkeys</span><span class="op" id="3802749">[</span><span class="ident" id="3802750">i</span><span class="op" id="3802751">]</span>&nbsp;<span class="op" id="3802753">=</span>&nbsp;<span class="ident" id="3802755">permuteBlock</span><span class="op" id="3802767">(</span><span class="ident" id="3802768">pc2Input</span><span class="op" id="3802776">,</span>&nbsp;<span class="ident" id="3802778">permutedChoice2</span><span class="op" id="3802793">[</span><span class="op" id="3802794">:</span><span class="op" id="3802795">]</span><span class="op" id="3802796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802799">}</span><br>
<span class="lineno"></span><span class="op" id="3802801">}</span>
</div>
</body>
</html>
