<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8390379">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8390434">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8390488">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8390539">package</span>&nbsp;<span class="ident" id="8390547">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8390552">import</span>&nbsp;<span class="op" id="8390559">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8390562">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8390571">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8390577">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8390590">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8390603">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8390609">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8390619">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8390622">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8390669">type</span>&nbsp;<span class="ident" id="8390674">WriteTest</span>&nbsp;<span class="keyword" id="8390684">struct</span>&nbsp;<span class="op" id="8390691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390694">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8390701">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390709">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8390716">[</span><span class="op" id="8390717">]</span><span class="builtintype" id="8390718">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390724">Method</span>&nbsp;<span class="builtintype" id="8390731">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390739">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8390746"><a href="/archive/zip/writer_test.go.html#8390603">os</a></span><span class="op" id="8390748">.</span><span class="ident" id="8390749">FileMode</span><br>
<span class="lineno"></span><span class="op" id="8390758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8390761">var</span>&nbsp;<span class="ident" id="8390765">writeTests</span>&nbsp;<span class="op" id="8390776">=</span>&nbsp;<span class="op" id="8390778">[</span><span class="op" id="8390779">]</span><span class="ident" id="8390780"><a href="/archive/zip/writer_test.go.html#8390674">WriteTest</a></span><span class="op" id="8390789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8390792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390796">Name</span><span class="op" id="8390800">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8390804">&#34;foo&#34;</span><span class="op" id="8390809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390813">Data</span><span class="op" id="8390817">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8390821">[</span><span class="op" id="8390822">]</span><span class="builtintype" id="8390823">byte</span><span class="op" id="8390827">(</span><span class="string" id="8390828">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="8390888">)</span><span class="op" id="8390889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390893">Method</span><span class="op" id="8390899">:</span>&nbsp;<span class="ident" id="8390901"><a href="/archive/zip/struct.go.html#5697026">Store</a></span><span class="op" id="8390906">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390910">Mode</span><span class="op" id="8390914">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8390918">0666</span><span class="op" id="8390922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8390925">}</span><span class="op" id="8390926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8390929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390933">Name</span><span class="op" id="8390937">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8390941">&#34;bar&#34;</span><span class="op" id="8390946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390950">Data</span><span class="op" id="8390954">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8390958">nil</span><span class="op" id="8390961">,</span>&nbsp;<span class="comment" id="8390963">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8390995">Method</span><span class="op" id="8391001">:</span>&nbsp;<span class="ident" id="8391003"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8391010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391014">Mode</span><span class="op" id="8391018">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8391022">0644</span><span class="op" id="8391026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391029">}</span><span class="op" id="8391030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391037">Name</span><span class="op" id="8391041">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8391045">&#34;setuid&#34;</span><span class="op" id="8391053">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391057">Data</span><span class="op" id="8391061">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8391065">[</span><span class="op" id="8391066">]</span><span class="builtintype" id="8391067">byte</span><span class="op" id="8391071">(</span><span class="string" id="8391072">&#34;setuid&nbsp;file&#34;</span><span class="op" id="8391085">)</span><span class="op" id="8391086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391090">Method</span><span class="op" id="8391096">:</span>&nbsp;<span class="ident" id="8391098"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8391105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391109">Mode</span><span class="op" id="8391113">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8391117">0755</span>&nbsp;<span class="op" id="8391122">|</span>&nbsp;<span class="ident" id="8391124"><a href="/archive/zip/writer_test.go.html#8390603">os</a></span><span class="op" id="8391126">.</span><span class="ident" id="8391127">ModeSetuid</span><span class="op" id="8391137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391140">}</span><span class="op" id="8391141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391144">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391148">Name</span><span class="op" id="8391152">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8391156">&#34;setgid&#34;</span><span class="op" id="8391164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391168">Data</span><span class="op" id="8391172">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8391176">[</span><span class="op" id="8391177">]</span><span class="builtintype" id="8391178">byte</span><span class="op" id="8391182">(</span><span class="string" id="8391183">&#34;setgid&nbsp;file&#34;</span><span class="op" id="8391196">)</span><span class="op" id="8391197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391201">Method</span><span class="op" id="8391207">:</span>&nbsp;<span class="ident" id="8391209"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8391216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391220">Mode</span><span class="op" id="8391224">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8391228">0755</span>&nbsp;<span class="op" id="8391233">|</span>&nbsp;<span class="ident" id="8391235"><a href="/archive/zip/writer_test.go.html#8390603">os</a></span><span class="op" id="8391237">.</span><span class="ident" id="8391238">ModeSetgid</span><span class="op" id="8391248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391251">}</span><span class="op" id="8391252">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391259">Name</span><span class="op" id="8391263">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8391267">&#34;symlink&#34;</span><span class="op" id="8391276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391280">Data</span><span class="op" id="8391284">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8391288">[</span><span class="op" id="8391289">]</span><span class="builtintype" id="8391290">byte</span><span class="op" id="8391294">(</span><span class="string" id="8391295">&#34;../link/target&#34;</span><span class="op" id="8391311">)</span><span class="op" id="8391312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391316">Method</span><span class="op" id="8391322">:</span>&nbsp;<span class="ident" id="8391324"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8391331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391335">Mode</span><span class="op" id="8391339">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8391343">0755</span>&nbsp;<span class="op" id="8391348">|</span>&nbsp;<span class="ident" id="8391350"><a href="/archive/zip/writer_test.go.html#8390603">os</a></span><span class="op" id="8391352">.</span><span class="ident" id="8391353">ModeSymlink</span><span class="op" id="8391364">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391367">}</span><span class="op" id="8391368">,</span><br>
<span class="lineno"></span><span class="op" id="8391370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8391373">func</span>&nbsp;<span class="ident" id="8391378">TestWriter</span><span class="op" id="8391388">(</span><span class="ident" id="8391389">t</span>&nbsp;<span class="op" id="8391391">*</span><span class="ident" id="8391392"><a href="/archive/zip/writer_test.go.html#8390609">testing</a></span><span class="op" id="8391399">.</span><span class="ident" id="8391400">T</span><span class="op" id="8391401">)</span>&nbsp;<span class="op" id="8391403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391406">largeData</span>&nbsp;<span class="op" id="8391416">:=</span>&nbsp;<span class="builtinfunc" id="8391419">make</span><span class="op" id="8391423">(</span><span class="op" id="8391424">[</span><span class="op" id="8391425">]</span><span class="builtintype" id="8391426">byte</span><span class="op" id="8391430">,</span>&nbsp;<span class="num" id="8391432">1</span><span class="op" id="8391433">&lt;&lt;</span><span class="num" id="8391435">17</span><span class="op" id="8391437">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8391440">for</span>&nbsp;<span class="ident" id="8391444">i</span>&nbsp;<span class="op" id="8391446">:=</span>&nbsp;<span class="keyword" id="8391449">range</span>&nbsp;<span class="ident" id="8391455"><a href="/archive/zip/writer_test.go.html#8391406">largeData</a></span>&nbsp;<span class="op" id="8391465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391469"><a href="/archive/zip/writer_test.go.html#8391406">largeData</a></span><span class="op" id="8391478">[</span><span class="ident" id="8391479"><a href="/archive/zip/writer_test.go.html#8391444">i</a></span><span class="op" id="8391480">]</span>&nbsp;<span class="op" id="8391482">=</span>&nbsp;<span class="builtintype" id="8391484">byte</span><span class="op" id="8391488">(</span><span class="ident" id="8391489"><a href="/archive/zip/writer_test.go.html#8390590">rand</a></span><span class="op" id="8391493">.</span><span class="ident" id="8391494">Int</span><span class="op" id="8391497">(</span><span class="op" id="8391498">)</span><span class="op" id="8391499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391505"><a href="/archive/zip/writer_test.go.html#8390765">writeTests</a></span><span class="op" id="8391515">[</span><span class="num" id="8391516">1</span><span class="op" id="8391517">]</span><span class="op" id="8391518">.</span><span class="ident" id="8391519">Data</span>&nbsp;<span class="op" id="8391524">=</span>&nbsp;<span class="ident" id="8391526"><a href="/archive/zip/writer_test.go.html#8391406">largeData</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8391537">defer</span>&nbsp;<span class="keyword" id="8391543">func</span><span class="op" id="8391547">(</span><span class="op" id="8391548">)</span>&nbsp;<span class="op" id="8391550">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391554"><a href="/archive/zip/writer_test.go.html#8390765">writeTests</a></span><span class="op" id="8391564">[</span><span class="num" id="8391565">1</span><span class="op" id="8391566">]</span><span class="op" id="8391567">.</span><span class="ident" id="8391568">Data</span>&nbsp;<span class="op" id="8391573">=</span>&nbsp;<span class="ident" id="8391575">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391580">}</span><span class="op" id="8391581">(</span><span class="op" id="8391582">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8391586">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391607">buf</span>&nbsp;<span class="op" id="8391611">:=</span>&nbsp;<span class="builtinfunc" id="8391614">new</span><span class="op" id="8391617">(</span><span class="ident" id="8391618"><a href="/archive/zip/writer_test.go.html#8390562">bytes</a></span><span class="op" id="8391623">.</span><span class="ident" id="8391624">Buffer</span><span class="op" id="8391630">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391633">w</span>&nbsp;<span class="op" id="8391635">:=</span>&nbsp;<span class="ident" id="8391638"><a href="/archive/zip/writer.go.html#5705354">NewWriter</a></span><span class="op" id="8391647">(</span><span class="ident" id="8391648"><a href="/archive/zip/writer_test.go.html#8391607">buf</a></span><span class="op" id="8391651">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8391655">for</span>&nbsp;<span class="ident" id="8391659">_</span><span class="op" id="8391660">,</span>&nbsp;<span class="ident" id="8391662">wt</span>&nbsp;<span class="op" id="8391665">:=</span>&nbsp;<span class="keyword" id="8391668">range</span>&nbsp;<span class="ident" id="8391674"><a href="/archive/zip/writer_test.go.html#8390765">writeTests</a></span>&nbsp;<span class="op" id="8391685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391689"><a href="/archive/zip/writer_test.go.html#8392340">testCreate</a></span><span class="op" id="8391699">(</span><span class="ident" id="8391700"><a href="/archive/zip/writer_test.go.html#8391389">t</a></span><span class="op" id="8391701">,</span>&nbsp;<span class="ident" id="8391703"><a href="/archive/zip/writer_test.go.html#8391633">w</a></span><span class="op" id="8391704">,</span>&nbsp;<span class="op" id="8391706">&amp;</span><span class="ident" id="8391707"><a href="/archive/zip/writer_test.go.html#8391662">wt</a></span><span class="op" id="8391709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391712">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8391716">if</span>&nbsp;<span class="ident" id="8391719">err</span>&nbsp;<span class="op" id="8391723">:=</span>&nbsp;<span class="ident" id="8391726"><a href="/archive/zip/writer_test.go.html#8391633">w</a></span><span class="op" id="8391727">.</span><span class="ident" id="8391728">Close</span><span class="op" id="8391733">(</span><span class="op" id="8391734">)</span><span class="op" id="8391735">;</span>&nbsp;<span class="ident" id="8391737"><a href="/archive/zip/writer_test.go.html#8391719">err</a></span>&nbsp;<span class="op" id="8391741">!=</span>&nbsp;<span class="ident" id="8391744">nil</span>&nbsp;<span class="op" id="8391748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391752"><a href="/archive/zip/writer_test.go.html#8391389">t</a></span><span class="op" id="8391753">.</span><span class="ident" id="8391754">Fatal</span><span class="op" id="8391759">(</span><span class="ident" id="8391760"><a href="/archive/zip/writer_test.go.html#8391719">err</a></span><span class="op" id="8391763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8391770">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391787">r</span><span class="op" id="8391788">,</span>&nbsp;<span class="ident" id="8391790">err</span>&nbsp;<span class="op" id="8391794">:=</span>&nbsp;<span class="ident" id="8391797"><a href="/archive/zip/reader.go.html#5682445">NewReader</a></span><span class="op" id="8391806">(</span><span class="ident" id="8391807"><a href="/archive/zip/writer_test.go.html#8390562">bytes</a></span><span class="op" id="8391812">.</span><span class="ident" id="8391813">NewReader</span><span class="op" id="8391822">(</span><span class="ident" id="8391823"><a href="/archive/zip/writer_test.go.html#8391607">buf</a></span><span class="op" id="8391826">.</span><span class="ident" id="8391827">Bytes</span><span class="op" id="8391832">(</span><span class="op" id="8391833">)</span><span class="op" id="8391834">)</span><span class="op" id="8391835">,</span>&nbsp;<span class="ident" id="8391837">int64</span><span class="op" id="8391842">(</span><span class="ident" id="8391843"><a href="/archive/zip/writer_test.go.html#8391607">buf</a></span><span class="op" id="8391846">.</span><span class="ident" id="8391847">Len</span><span class="op" id="8391850">(</span><span class="op" id="8391851">)</span><span class="op" id="8391852">)</span><span class="op" id="8391853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8391856">if</span>&nbsp;<span class="ident" id="8391859"><a href="/archive/zip/writer_test.go.html#8391790">err</a></span>&nbsp;<span class="op" id="8391863">!=</span>&nbsp;<span class="ident" id="8391866">nil</span>&nbsp;<span class="op" id="8391870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391874"><a href="/archive/zip/writer_test.go.html#8391389">t</a></span><span class="op" id="8391875">.</span><span class="ident" id="8391876">Fatal</span><span class="op" id="8391881">(</span><span class="ident" id="8391882"><a href="/archive/zip/writer_test.go.html#8391790">err</a></span><span class="op" id="8391885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391888">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8391891">for</span>&nbsp;<span class="ident" id="8391895">i</span><span class="op" id="8391896">,</span>&nbsp;<span class="ident" id="8391898">wt</span>&nbsp;<span class="op" id="8391901">:=</span>&nbsp;<span class="keyword" id="8391904">range</span>&nbsp;<span class="ident" id="8391910"><a href="/archive/zip/writer_test.go.html#8390765">writeTests</a></span>&nbsp;<span class="op" id="8391921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8391925"><a href="/archive/zip/writer_test.go.html#8392647">testReadFile</a></span><span class="op" id="8391937">(</span><span class="ident" id="8391938"><a href="/archive/zip/writer_test.go.html#8391389">t</a></span><span class="op" id="8391939">,</span>&nbsp;<span class="ident" id="8391941"><a href="/archive/zip/writer_test.go.html#8391787">r</a></span><span class="op" id="8391942">.</span><span class="ident" id="8391943">File</span><span class="op" id="8391947">[</span><span class="ident" id="8391948"><a href="/archive/zip/writer_test.go.html#8391895">i</a></span><span class="op" id="8391949">]</span><span class="op" id="8391950">,</span>&nbsp;<span class="op" id="8391952">&amp;</span><span class="ident" id="8391953"><a href="/archive/zip/writer_test.go.html#8391898">wt</a></span><span class="op" id="8391955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8391958">}</span><br>
<span class="lineno"></span><span class="op" id="8391960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8391963">func</span>&nbsp;<span class="ident" id="8391968">TestWriterFlush</span><span class="op" id="8391983">(</span><span class="ident" id="8391984">t</span>&nbsp;<span class="op" id="8391986">*</span><span class="ident" id="8391987"><a href="/archive/zip/writer_test.go.html#8390609">testing</a></span><span class="op" id="8391994">.</span><span class="ident" id="8391995">T</span><span class="op" id="8391996">)</span>&nbsp;<span class="op" id="8391998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392001">var</span>&nbsp;<span class="ident" id="8392005">buf</span>&nbsp;<span class="ident" id="8392009"><a href="/archive/zip/writer_test.go.html#8390562">bytes</a></span><span class="op" id="8392014">.</span><span class="ident" id="8392015">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392023">w</span>&nbsp;<span class="op" id="8392025">:=</span>&nbsp;<span class="ident" id="8392028"><a href="/archive/zip/writer.go.html#5705354">NewWriter</a></span><span class="op" id="8392037">(</span><span class="keyword" id="8392038">struct</span><span class="op" id="8392044">{</span>&nbsp;<span class="ident" id="8392046"><a href="/archive/zip/writer_test.go.html#8390571">io</a></span><span class="op" id="8392048">.</span><span class="ident" id="8392049">Writer</span>&nbsp;<span class="op" id="8392056">}</span><span class="op" id="8392057">{</span><span class="op" id="8392058">&amp;</span><span class="ident" id="8392059"><a href="/archive/zip/writer_test.go.html#8392005">buf</a></span><span class="op" id="8392062">}</span><span class="op" id="8392063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392066">_</span><span class="op" id="8392067">,</span>&nbsp;<span class="ident" id="8392069">err</span>&nbsp;<span class="op" id="8392073">:=</span>&nbsp;<span class="ident" id="8392076"><a href="/archive/zip/writer_test.go.html#8392023">w</a></span><span class="op" id="8392077">.</span><span class="ident" id="8392078">Create</span><span class="op" id="8392084">(</span><span class="string" id="8392085">&#34;foo&#34;</span><span class="op" id="8392090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392093">if</span>&nbsp;<span class="ident" id="8392096"><a href="/archive/zip/writer_test.go.html#8392069">err</a></span>&nbsp;<span class="op" id="8392100">!=</span>&nbsp;<span class="ident" id="8392103">nil</span>&nbsp;<span class="op" id="8392107">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392111"><a href="/archive/zip/writer_test.go.html#8391984">t</a></span><span class="op" id="8392112">.</span><span class="ident" id="8392113">Fatal</span><span class="op" id="8392118">(</span><span class="ident" id="8392119"><a href="/archive/zip/writer_test.go.html#8392069">err</a></span><span class="op" id="8392122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392128">if</span>&nbsp;<span class="ident" id="8392131"><a href="/archive/zip/writer_test.go.html#8392005">buf</a></span><span class="op" id="8392134">.</span><span class="ident" id="8392135">Len</span><span class="op" id="8392138">(</span><span class="op" id="8392139">)</span>&nbsp;<span class="op" id="8392141">&gt;</span>&nbsp;<span class="num" id="8392143">0</span>&nbsp;<span class="op" id="8392145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392149"><a href="/archive/zip/writer_test.go.html#8391984">t</a></span><span class="op" id="8392150">.</span><span class="ident" id="8392151">Fatalf</span><span class="op" id="8392157">(</span><span class="string" id="8392158">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="8392197">,</span>&nbsp;<span class="ident" id="8392199"><a href="/archive/zip/writer_test.go.html#8392005">buf</a></span><span class="op" id="8392202">.</span><span class="ident" id="8392203">Len</span><span class="op" id="8392206">(</span><span class="op" id="8392207">)</span><span class="op" id="8392208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392211">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392214">if</span>&nbsp;<span class="ident" id="8392217">err</span>&nbsp;<span class="op" id="8392221">:=</span>&nbsp;<span class="ident" id="8392224"><a href="/archive/zip/writer_test.go.html#8392023">w</a></span><span class="op" id="8392225">.</span><span class="ident" id="8392226">Flush</span><span class="op" id="8392231">(</span><span class="op" id="8392232">)</span><span class="op" id="8392233">;</span>&nbsp;<span class="ident" id="8392235"><a href="/archive/zip/writer_test.go.html#8392217">err</a></span>&nbsp;<span class="op" id="8392239">!=</span>&nbsp;<span class="ident" id="8392242">nil</span>&nbsp;<span class="op" id="8392246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392250"><a href="/archive/zip/writer_test.go.html#8391984">t</a></span><span class="op" id="8392251">.</span><span class="ident" id="8392252">Fatal</span><span class="op" id="8392257">(</span><span class="ident" id="8392258"><a href="/archive/zip/writer_test.go.html#8392217">err</a></span><span class="op" id="8392261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392267">if</span>&nbsp;<span class="ident" id="8392270"><a href="/archive/zip/writer_test.go.html#8392005">buf</a></span><span class="op" id="8392273">.</span><span class="ident" id="8392274">Len</span><span class="op" id="8392277">(</span><span class="op" id="8392278">)</span>&nbsp;<span class="op" id="8392280">==</span>&nbsp;<span class="num" id="8392283">0</span>&nbsp;<span class="op" id="8392285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392289"><a href="/archive/zip/writer_test.go.html#8391984">t</a></span><span class="op" id="8392290">.</span><span class="ident" id="8392291">Fatal</span><span class="op" id="8392296">(</span><span class="string" id="8392297">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="8392327">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392330">}</span><br>
<span class="lineno"></span><span class="op" id="8392332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8392335">func</span>&nbsp;<span class="ident" id="8392340">testCreate</span><span class="op" id="8392350">(</span><span class="ident" id="8392351">t</span>&nbsp;<span class="op" id="8392353">*</span><span class="ident" id="8392354"><a href="/archive/zip/writer_test.go.html#8390609">testing</a></span><span class="op" id="8392361">.</span><span class="ident" id="8392362">T</span><span class="op" id="8392363">,</span>&nbsp;<span class="ident" id="8392365">w</span>&nbsp;<span class="op" id="8392367">*</span><span class="ident" id="8392368"><a href="/archive/zip/writer.go.html#5705147">Writer</a></span><span class="op" id="8392374">,</span>&nbsp;<span class="ident" id="8392376">wt</span>&nbsp;<span class="op" id="8392379">*</span><span class="ident" id="8392380"><a href="/archive/zip/writer_test.go.html#8390674">WriteTest</a></span><span class="op" id="8392389">)</span>&nbsp;<span class="op" id="8392391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392394">header</span>&nbsp;<span class="op" id="8392401">:=</span>&nbsp;<span class="op" id="8392404">&amp;</span><span class="ident" id="8392405"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8392415">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392419">Name</span><span class="op" id="8392423">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8392427"><a href="/archive/zip/writer_test.go.html#8392376">wt</a></span><span class="op" id="8392429">.</span><span class="ident" id="8392430">Name</span><span class="op" id="8392434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392438">Method</span><span class="op" id="8392444">:</span>&nbsp;<span class="ident" id="8392446"><a href="/archive/zip/writer_test.go.html#8392376">wt</a></span><span class="op" id="8392448">.</span><span class="ident" id="8392449">Method</span><span class="op" id="8392455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392461">if</span>&nbsp;<span class="ident" id="8392464"><a href="/archive/zip/writer_test.go.html#8392376">wt</a></span><span class="op" id="8392466">.</span><span class="ident" id="8392467">Mode</span>&nbsp;<span class="op" id="8392472">!=</span>&nbsp;<span class="num" id="8392475">0</span>&nbsp;<span class="op" id="8392477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392481"><a href="/archive/zip/writer_test.go.html#8392394">header</a></span><span class="op" id="8392487">.</span><span class="ident" id="8392488">SetMode</span><span class="op" id="8392495">(</span><span class="ident" id="8392496"><a href="/archive/zip/writer_test.go.html#8392376">wt</a></span><span class="op" id="8392498">.</span><span class="ident" id="8392499">Mode</span><span class="op" id="8392503">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392509">f</span><span class="op" id="8392510">,</span>&nbsp;<span class="ident" id="8392512">err</span>&nbsp;<span class="op" id="8392516">:=</span>&nbsp;<span class="ident" id="8392519"><a href="/archive/zip/writer_test.go.html#8392365">w</a></span><span class="op" id="8392520">.</span><span class="ident" id="8392521">CreateHeader</span><span class="op" id="8392533">(</span><span class="ident" id="8392534"><a href="/archive/zip/writer_test.go.html#8392394">header</a></span><span class="op" id="8392540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392543">if</span>&nbsp;<span class="ident" id="8392546"><a href="/archive/zip/writer_test.go.html#8392512">err</a></span>&nbsp;<span class="op" id="8392550">!=</span>&nbsp;<span class="ident" id="8392553">nil</span>&nbsp;<span class="op" id="8392557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392561"><a href="/archive/zip/writer_test.go.html#8392351">t</a></span><span class="op" id="8392562">.</span><span class="ident" id="8392563">Fatal</span><span class="op" id="8392568">(</span><span class="ident" id="8392569"><a href="/archive/zip/writer_test.go.html#8392512">err</a></span><span class="op" id="8392572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392575">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392578">_</span><span class="op" id="8392579">,</span>&nbsp;<span class="ident" id="8392581"><a href="/archive/zip/writer_test.go.html#8392512">err</a></span>&nbsp;<span class="op" id="8392585">=</span>&nbsp;<span class="ident" id="8392587"><a href="/archive/zip/writer_test.go.html#8392509">f</a></span><span class="op" id="8392588">.</span><span class="ident" id="8392589">Write</span><span class="op" id="8392594">(</span><span class="ident" id="8392595"><a href="/archive/zip/writer_test.go.html#8392376">wt</a></span><span class="op" id="8392597">.</span><span class="ident" id="8392598">Data</span><span class="op" id="8392602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392605">if</span>&nbsp;<span class="ident" id="8392608"><a href="/archive/zip/writer_test.go.html#8392512">err</a></span>&nbsp;<span class="op" id="8392612">!=</span>&nbsp;<span class="ident" id="8392615">nil</span>&nbsp;<span class="op" id="8392619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392623"><a href="/archive/zip/writer_test.go.html#8392351">t</a></span><span class="op" id="8392624">.</span><span class="ident" id="8392625">Fatal</span><span class="op" id="8392630">(</span><span class="ident" id="8392631"><a href="/archive/zip/writer_test.go.html#8392512">err</a></span><span class="op" id="8392634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392637">}</span><br>
<span class="lineno"></span><span class="op" id="8392639">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8392642">func</span>&nbsp;<span class="ident" id="8392647">testReadFile</span><span class="op" id="8392659">(</span><span class="ident" id="8392660">t</span>&nbsp;<span class="op" id="8392662">*</span><span class="ident" id="8392663"><a href="/archive/zip/writer_test.go.html#8390609">testing</a></span><span class="op" id="8392670">.</span><span class="ident" id="8392671">T</span><span class="op" id="8392672">,</span>&nbsp;<span class="ident" id="8392674">f</span>&nbsp;<span class="op" id="8392676">*</span><span class="ident" id="8392677"><a href="/archive/zip/reader.go.html#5681778">File</a></span><span class="op" id="8392681">,</span>&nbsp;<span class="ident" id="8392683">wt</span>&nbsp;<span class="op" id="8392686">*</span><span class="ident" id="8392687"><a href="/archive/zip/writer_test.go.html#8390674">WriteTest</a></span><span class="op" id="8392696">)</span>&nbsp;<span class="op" id="8392698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392701">if</span>&nbsp;<span class="ident" id="8392704"><a href="/archive/zip/writer_test.go.html#8392674">f</a></span><span class="op" id="8392705">.</span><span class="ident" id="8392706">Name</span>&nbsp;<span class="op" id="8392711">!=</span>&nbsp;<span class="ident" id="8392714"><a href="/archive/zip/writer_test.go.html#8392683">wt</a></span><span class="op" id="8392716">.</span><span class="ident" id="8392717">Name</span>&nbsp;<span class="op" id="8392722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392726"><a href="/archive/zip/writer_test.go.html#8392660">t</a></span><span class="op" id="8392727">.</span><span class="ident" id="8392728">Fatalf</span><span class="op" id="8392734">(</span><span class="string" id="8392735">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8392763">,</span>&nbsp;<span class="ident" id="8392765"><a href="/archive/zip/writer_test.go.html#8392674">f</a></span><span class="op" id="8392766">.</span><span class="ident" id="8392767">Name</span><span class="op" id="8392771">,</span>&nbsp;<span class="ident" id="8392773"><a href="/archive/zip/writer_test.go.html#8392683">wt</a></span><span class="op" id="8392775">.</span><span class="ident" id="8392776">Name</span><span class="op" id="8392780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392783">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392786"><a href="/archive/zip/reader_test.go.html#8384544">testFileMode</a></span><span class="op" id="8392798">(</span><span class="ident" id="8392799"><a href="/archive/zip/writer_test.go.html#8392660">t</a></span><span class="op" id="8392800">,</span>&nbsp;<span class="ident" id="8392802"><a href="/archive/zip/writer_test.go.html#8392683">wt</a></span><span class="op" id="8392804">.</span><span class="ident" id="8392805">Name</span><span class="op" id="8392809">,</span>&nbsp;<span class="ident" id="8392811"><a href="/archive/zip/writer_test.go.html#8392674">f</a></span><span class="op" id="8392812">,</span>&nbsp;<span class="ident" id="8392814"><a href="/archive/zip/writer_test.go.html#8392683">wt</a></span><span class="op" id="8392816">.</span><span class="ident" id="8392817">Mode</span><span class="op" id="8392821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392824">rc</span><span class="op" id="8392826">,</span>&nbsp;<span class="ident" id="8392828">err</span>&nbsp;<span class="op" id="8392832">:=</span>&nbsp;<span class="ident" id="8392835"><a href="/archive/zip/writer_test.go.html#8392674">f</a></span><span class="op" id="8392836">.</span><span class="ident" id="8392837">Open</span><span class="op" id="8392841">(</span><span class="op" id="8392842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392845">if</span>&nbsp;<span class="ident" id="8392848"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span>&nbsp;<span class="op" id="8392852">!=</span>&nbsp;<span class="ident" id="8392855">nil</span>&nbsp;<span class="op" id="8392859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392863"><a href="/archive/zip/writer_test.go.html#8392660">t</a></span><span class="op" id="8392864">.</span><span class="ident" id="8392865">Fatal</span><span class="op" id="8392870">(</span><span class="string" id="8392871">&#34;opening:&#34;</span><span class="op" id="8392881">,</span>&nbsp;<span class="ident" id="8392883"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span><span class="op" id="8392886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392889">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392892">b</span><span class="op" id="8392893">,</span>&nbsp;<span class="ident" id="8392895"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span>&nbsp;<span class="op" id="8392899">:=</span>&nbsp;<span class="ident" id="8392902"><a href="/archive/zip/writer_test.go.html#8390577">ioutil</a></span><span class="op" id="8392908">.</span><span class="ident" id="8392909">ReadAll</span><span class="op" id="8392916">(</span><span class="ident" id="8392917"><a href="/archive/zip/writer_test.go.html#8392824">rc</a></span><span class="op" id="8392919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392922">if</span>&nbsp;<span class="ident" id="8392925"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span>&nbsp;<span class="op" id="8392929">!=</span>&nbsp;<span class="ident" id="8392932">nil</span>&nbsp;<span class="op" id="8392936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392940"><a href="/archive/zip/writer_test.go.html#8392660">t</a></span><span class="op" id="8392941">.</span><span class="ident" id="8392942">Fatal</span><span class="op" id="8392947">(</span><span class="string" id="8392948">&#34;reading:&#34;</span><span class="op" id="8392958">,</span>&nbsp;<span class="ident" id="8392960"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span><span class="op" id="8392963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8392966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8392969"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span>&nbsp;<span class="op" id="8392973">=</span>&nbsp;<span class="ident" id="8392975"><a href="/archive/zip/writer_test.go.html#8392824">rc</a></span><span class="op" id="8392977">.</span><span class="ident" id="8392978">Close</span><span class="op" id="8392983">(</span><span class="op" id="8392984">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8392987">if</span>&nbsp;<span class="ident" id="8392990"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span>&nbsp;<span class="op" id="8392994">!=</span>&nbsp;<span class="ident" id="8392997">nil</span>&nbsp;<span class="op" id="8393001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393005"><a href="/archive/zip/writer_test.go.html#8392660">t</a></span><span class="op" id="8393006">.</span><span class="ident" id="8393007">Fatal</span><span class="op" id="8393012">(</span><span class="string" id="8393013">&#34;closing:&#34;</span><span class="op" id="8393023">,</span>&nbsp;<span class="ident" id="8393025"><a href="/archive/zip/writer_test.go.html#8392828">err</a></span><span class="op" id="8393028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8393031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8393034">if</span>&nbsp;<span class="op" id="8393037">!</span><span class="ident" id="8393038"><a href="/archive/zip/writer_test.go.html#8390562">bytes</a></span><span class="op" id="8393043">.</span><span class="ident" id="8393044">Equal</span><span class="op" id="8393049">(</span><span class="ident" id="8393050"><a href="/archive/zip/writer_test.go.html#8392892">b</a></span><span class="op" id="8393051">,</span>&nbsp;<span class="ident" id="8393053"><a href="/archive/zip/writer_test.go.html#8392683">wt</a></span><span class="op" id="8393055">.</span><span class="ident" id="8393056">Data</span><span class="op" id="8393060">)</span>&nbsp;<span class="op" id="8393062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393066"><a href="/archive/zip/writer_test.go.html#8392660">t</a></span><span class="op" id="8393067">.</span><span class="ident" id="8393068">Errorf</span><span class="op" id="8393074">(</span><span class="string" id="8393075">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8393102">,</span>&nbsp;<span class="ident" id="8393104"><a href="/archive/zip/writer_test.go.html#8392892">b</a></span><span class="op" id="8393105">,</span>&nbsp;<span class="ident" id="8393107"><a href="/archive/zip/writer_test.go.html#8392683">wt</a></span><span class="op" id="8393109">.</span><span class="ident" id="8393110">Data</span><span class="op" id="8393114">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8393117">}</span><br>
<span class="lineno"></span><span class="op" id="8393119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8393122">func</span>&nbsp;<span class="ident" id="8393127">BenchmarkCompressedZipGarbage</span><span class="op" id="8393156">(</span><span class="ident" id="8393157">b</span>&nbsp;<span class="op" id="8393159">*</span><span class="ident" id="8393160"><a href="/archive/zip/writer_test.go.html#8390609">testing</a></span><span class="op" id="8393167">.</span><span class="ident" id="8393168">B</span><span class="op" id="8393169">)</span>&nbsp;<span class="op" id="8393171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393174"><a href="/archive/zip/writer_test.go.html#8393157">b</a></span><span class="op" id="8393175">.</span><span class="ident" id="8393176">ReportAllocs</span><span class="op" id="8393188">(</span><span class="op" id="8393189">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8393192">var</span>&nbsp;<span class="ident" id="8393196">buf</span>&nbsp;<span class="ident" id="8393200"><a href="/archive/zip/writer_test.go.html#8390562">bytes</a></span><span class="op" id="8393205">.</span><span class="ident" id="8393206">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393214">bigBuf</span>&nbsp;<span class="op" id="8393221">:=</span>&nbsp;<span class="ident" id="8393224"><a href="/archive/zip/writer_test.go.html#8390562">bytes</a></span><span class="op" id="8393229">.</span><span class="ident" id="8393230">Repeat</span><span class="op" id="8393236">(</span><span class="op" id="8393237">[</span><span class="op" id="8393238">]</span><span class="builtintype" id="8393239">byte</span><span class="op" id="8393243">(</span><span class="string" id="8393244">&#34;a&#34;</span><span class="op" id="8393247">)</span><span class="op" id="8393248">,</span>&nbsp;<span class="num" id="8393250">1</span><span class="op" id="8393251">&lt;&lt;</span><span class="num" id="8393253">20</span><span class="op" id="8393255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8393258">for</span>&nbsp;<span class="ident" id="8393262">i</span>&nbsp;<span class="op" id="8393264">:=</span>&nbsp;<span class="num" id="8393267">0</span><span class="op" id="8393268">;</span>&nbsp;<span class="ident" id="8393270"><a href="/archive/zip/writer_test.go.html#8393262">i</a></span>&nbsp;<span class="op" id="8393272">&lt;</span>&nbsp;<span class="ident" id="8393274"><a href="/archive/zip/writer_test.go.html#8393157">b</a></span><span class="op" id="8393275">.</span><span class="ident" id="8393276">N</span><span class="op" id="8393277">;</span>&nbsp;<span class="ident" id="8393279"><a href="/archive/zip/writer_test.go.html#8393262">i</a></span><span class="op" id="8393280">++</span>&nbsp;<span class="op" id="8393283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393287"><a href="/archive/zip/writer_test.go.html#8393196">buf</a></span><span class="op" id="8393290">.</span><span class="ident" id="8393291">Reset</span><span class="op" id="8393296">(</span><span class="op" id="8393297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393301">zw</span>&nbsp;<span class="op" id="8393304">:=</span>&nbsp;<span class="ident" id="8393307"><a href="/archive/zip/writer.go.html#5705354">NewWriter</a></span><span class="op" id="8393316">(</span><span class="op" id="8393317">&amp;</span><span class="ident" id="8393318"><a href="/archive/zip/writer_test.go.html#8393196">buf</a></span><span class="op" id="8393321">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8393325">for</span>&nbsp;<span class="ident" id="8393329">j</span>&nbsp;<span class="op" id="8393331">:=</span>&nbsp;<span class="num" id="8393334">0</span><span class="op" id="8393335">;</span>&nbsp;<span class="ident" id="8393337"><a href="/archive/zip/writer_test.go.html#8393329">j</a></span>&nbsp;<span class="op" id="8393339">&lt;</span>&nbsp;<span class="num" id="8393341">3</span><span class="op" id="8393342">;</span>&nbsp;<span class="ident" id="8393344"><a href="/archive/zip/writer_test.go.html#8393329">j</a></span><span class="op" id="8393345">++</span>&nbsp;<span class="op" id="8393348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393353">w</span><span class="op" id="8393354">,</span>&nbsp;<span class="ident" id="8393356">_</span>&nbsp;<span class="op" id="8393358">:=</span>&nbsp;<span class="ident" id="8393361"><a href="/archive/zip/writer_test.go.html#8393301">zw</a></span><span class="op" id="8393363">.</span><span class="ident" id="8393364">CreateHeader</span><span class="op" id="8393376">(</span><span class="op" id="8393377">&amp;</span><span class="ident" id="8393378"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8393388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393394">Name</span><span class="op" id="8393398">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8393402">&#34;foo&#34;</span><span class="op" id="8393407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393413">Method</span><span class="op" id="8393419">:</span>&nbsp;<span class="ident" id="8393421"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8393428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8393433">}</span><span class="op" id="8393434">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393439"><a href="/archive/zip/writer_test.go.html#8393353">w</a></span><span class="op" id="8393440">.</span><span class="ident" id="8393441">Write</span><span class="op" id="8393446">(</span><span class="ident" id="8393447"><a href="/archive/zip/writer_test.go.html#8393214">bigBuf</a></span><span class="op" id="8393453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8393457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393461"><a href="/archive/zip/writer_test.go.html#8393301">zw</a></span><span class="op" id="8393463">.</span><span class="ident" id="8393464">Close</span><span class="op" id="8393469">(</span><span class="op" id="8393470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8393473">}</span><br>
<span class="lineno"></span><span class="op" id="8393475">}</span>
</div>
</body>
</html>
