<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html" class="current">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4750688">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4750743">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4750797">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4750848">//&nbsp;Represents&nbsp;JSON&nbsp;data&nbsp;structure&nbsp;using&nbsp;native&nbsp;Go&nbsp;types:&nbsp;booleans,&nbsp;floats,</span><br>
<span class="lineno"></span><span class="comment" id="4750923">//&nbsp;strings,&nbsp;arrays,&nbsp;and&nbsp;maps.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4750954">package</span>&nbsp;<span class="ident" id="4750962">json</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4750968">import</span>&nbsp;<span class="op" id="4750975">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4750978">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4750987">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4750999">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751018">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751028">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751035">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751046">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751057">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751068">&#34;unicode&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751079">&#34;unicode/utf16&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4751096">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4751111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4751114">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;JSON-encoded&nbsp;data&nbsp;and&nbsp;stores&nbsp;the&nbsp;result</span><br>
<span class="lineno">25</span><span class="comment" id="4751178">//&nbsp;in&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to&nbsp;by&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4751211">//</span><br>
<span class="lineno"></span><span class="comment" id="4751214">//&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;encodings&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4751266">//&nbsp;Marshal&nbsp;uses,&nbsp;allocating&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;pointers&nbsp;as&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4751335">//&nbsp;with&nbsp;the&nbsp;following&nbsp;additional&nbsp;rules:</span><br>
<span class="lineno">30</span><span class="comment" id="4751375">//</span><br>
<span class="lineno"></span><span class="comment" id="4751378">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;pointer,&nbsp;Unmarshal&nbsp;first&nbsp;handles&nbsp;the&nbsp;case&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4751451">//&nbsp;the&nbsp;JSON&nbsp;being&nbsp;the&nbsp;JSON&nbsp;literal&nbsp;null.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;Unmarshal&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="4751522">//&nbsp;the&nbsp;pointer&nbsp;to&nbsp;nil.&nbsp;&nbsp;Otherwise,&nbsp;Unmarshal&nbsp;unmarshals&nbsp;the&nbsp;JSON&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4751592">//&nbsp;the&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;the&nbsp;pointer.&nbsp;&nbsp;If&nbsp;the&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;Unmarshal</span><br>
<span class="lineno">35</span><span class="comment" id="4751666">//&nbsp;allocates&nbsp;a&nbsp;new&nbsp;value&nbsp;for&nbsp;it&nbsp;to&nbsp;point&nbsp;to.</span><br>
<span class="lineno"></span><span class="comment" id="4751711">//</span><br>
<span class="lineno"></span><span class="comment" id="4751714">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;struct,&nbsp;Unmarshal&nbsp;matches&nbsp;incoming&nbsp;object</span><br>
<span class="lineno"></span><span class="comment" id="4751784">//&nbsp;keys&nbsp;to&nbsp;the&nbsp;keys&nbsp;used&nbsp;by&nbsp;Marshal&nbsp;(either&nbsp;the&nbsp;struct&nbsp;field&nbsp;name&nbsp;or&nbsp;its&nbsp;tag),</span><br>
<span class="lineno"></span><span class="comment" id="4751863">//&nbsp;preferring&nbsp;an&nbsp;exact&nbsp;match&nbsp;but&nbsp;also&nbsp;accepting&nbsp;a&nbsp;case-insensitive&nbsp;match.</span><br>
<span class="lineno">40</span><span class="comment" id="4751937">//</span><br>
<span class="lineno"></span><span class="comment" id="4751940">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;an&nbsp;interface&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="4751986">//&nbsp;Unmarshal&nbsp;stores&nbsp;one&nbsp;of&nbsp;these&nbsp;in&nbsp;the&nbsp;interface&nbsp;value:</span><br>
<span class="lineno"></span><span class="comment" id="4752043">//</span><br>
<span class="lineno"></span><span class="comment" id="4752046">//&nbsp;&nbsp;&nbsp;&nbsp;bool,&nbsp;for&nbsp;JSON&nbsp;booleans</span><br>
<span class="lineno">45</span><span class="comment" id="4752073">//&nbsp;&nbsp;&nbsp;&nbsp;float64,&nbsp;for&nbsp;JSON&nbsp;numbers</span><br>
<span class="lineno"></span><span class="comment" id="4752102">//&nbsp;&nbsp;&nbsp;&nbsp;string,&nbsp;for&nbsp;JSON&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="4752130">//&nbsp;&nbsp;&nbsp;&nbsp;[]interface{},&nbsp;for&nbsp;JSON&nbsp;arrays</span><br>
<span class="lineno"></span><span class="comment" id="4752164">//&nbsp;&nbsp;&nbsp;&nbsp;map[string]interface{},&nbsp;for&nbsp;JSON&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="4752208">//&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;for&nbsp;JSON&nbsp;null</span><br>
<span class="lineno">50</span><span class="comment" id="4752229">//</span><br>
<span class="lineno"></span><span class="comment" id="4752232">//&nbsp;If&nbsp;a&nbsp;JSON&nbsp;value&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;given&nbsp;target&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="4752295">//&nbsp;or&nbsp;if&nbsp;a&nbsp;JSON&nbsp;number&nbsp;overflows&nbsp;the&nbsp;target&nbsp;type,&nbsp;Unmarshal</span><br>
<span class="lineno"></span><span class="comment" id="4752355">//&nbsp;skips&nbsp;that&nbsp;field&nbsp;and&nbsp;completes&nbsp;the&nbsp;unmarshalling&nbsp;as&nbsp;best&nbsp;it&nbsp;can.</span><br>
<span class="lineno"></span><span class="comment" id="4752423">//&nbsp;If&nbsp;no&nbsp;more&nbsp;serious&nbsp;errors&nbsp;are&nbsp;encountered,&nbsp;Unmarshal&nbsp;returns</span><br>
<span class="lineno">55</span><span class="comment" id="4752487">//&nbsp;an&nbsp;UnmarshalTypeError&nbsp;describing&nbsp;the&nbsp;earliest&nbsp;such&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4752548">//</span><br>
<span class="lineno"></span><span class="comment" id="4752551">//&nbsp;The&nbsp;JSON&nbsp;null&nbsp;value&nbsp;unmarshals&nbsp;into&nbsp;an&nbsp;interface,&nbsp;map,&nbsp;pointer,&nbsp;or&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4752627">//&nbsp;by&nbsp;setting&nbsp;that&nbsp;Go&nbsp;value&nbsp;to&nbsp;nil.&nbsp;Because&nbsp;null&nbsp;is&nbsp;often&nbsp;used&nbsp;in&nbsp;JSON&nbsp;to&nbsp;mean</span><br>
<span class="lineno"></span><span class="comment" id="4752706">//&nbsp;``not&nbsp;present,&#39;&#39;&nbsp;unmarshaling&nbsp;a&nbsp;JSON&nbsp;null&nbsp;into&nbsp;any&nbsp;other&nbsp;Go&nbsp;type&nbsp;has&nbsp;no&nbsp;effect</span><br>
<span class="lineno">60</span><span class="comment" id="4752788">//&nbsp;on&nbsp;the&nbsp;value&nbsp;and&nbsp;produces&nbsp;no&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4752827">//</span><br>
<span class="lineno"></span><span class="comment" id="4752830">//&nbsp;When&nbsp;unmarshaling&nbsp;quoted&nbsp;strings,&nbsp;invalid&nbsp;UTF-8&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4752884">//&nbsp;invalid&nbsp;UTF-16&nbsp;surrogate&nbsp;pairs&nbsp;are&nbsp;not&nbsp;treated&nbsp;as&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4752947">//&nbsp;Instead,&nbsp;they&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;Unicode&nbsp;replacement</span><br>
<span class="lineno">65</span><span class="comment" id="4753004">//&nbsp;character&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="comment" id="4753025">//</span><br>
<span class="lineno"></span><span class="keyword" id="4753028">func</span>&nbsp;<span class="ident" id="4753033">Unmarshal</span><span class="op" id="4753042">(</span><span class="ident" id="4753043">data</span>&nbsp;<span class="op" id="4753048">[</span><span class="op" id="4753049">]</span><span class="builtintype" id="4753050">byte</span><span class="op" id="4753054">,</span>&nbsp;<span class="ident" id="4753056">v</span>&nbsp;<span class="keyword" id="4753058">interface</span><span class="op" id="4753067">{</span><span class="op" id="4753068">}</span><span class="op" id="4753069">)</span>&nbsp;<span class="builtintype" id="4753071">error</span>&nbsp;<span class="op" id="4753077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753080">//&nbsp;Check&nbsp;for&nbsp;well-formedness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753111">//&nbsp;Avoids&nbsp;filling&nbsp;out&nbsp;half&nbsp;a&nbsp;data&nbsp;structure</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753156">//&nbsp;before&nbsp;discovering&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4753200">var</span>&nbsp;<span class="ident" id="4753204">d</span>&nbsp;<span class="ident" id="4753206">decodeState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753219">err</span>&nbsp;<span class="op" id="4753223">:=</span>&nbsp;<span class="ident" id="4753226">checkValid</span><span class="op" id="4753236">(</span><span class="ident" id="4753237">data</span><span class="op" id="4753241">,</span>&nbsp;<span class="op" id="4753243">&amp;</span><span class="ident" id="4753244">d</span><span class="op" id="4753245">.</span><span class="ident" id="4753246">scan</span><span class="op" id="4753250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4753253">if</span>&nbsp;<span class="ident" id="4753256">err</span>&nbsp;<span class="op" id="4753260">!=</span>&nbsp;<span class="ident" id="4753263">nil</span>&nbsp;<span class="op" id="4753267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4753271">return</span>&nbsp;<span class="ident" id="4753278">err</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4753283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753287">d</span><span class="op" id="4753288">.</span><span class="ident" id="4753289">init</span><span class="op" id="4753293">(</span><span class="ident" id="4753294">data</span><span class="op" id="4753298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4753301">return</span>&nbsp;<span class="ident" id="4753308">d</span><span class="op" id="4753309">.</span><span class="ident" id="4753310">unmarshal</span><span class="op" id="4753319">(</span><span class="ident" id="4753320">v</span><span class="op" id="4753321">)</span><br>
<span class="lineno"></span><span class="op" id="4753323">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4753326">//&nbsp;Unmarshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="4753381">//&nbsp;that&nbsp;can&nbsp;unmarshal&nbsp;a&nbsp;JSON&nbsp;description&nbsp;of&nbsp;themselves.</span><br>
<span class="lineno"></span><span class="comment" id="4753437">//&nbsp;The&nbsp;input&nbsp;can&nbsp;be&nbsp;assumed&nbsp;to&nbsp;be&nbsp;a&nbsp;valid&nbsp;encoding&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4753491">//&nbsp;a&nbsp;JSON&nbsp;value.&nbsp;UnmarshalJSON&nbsp;must&nbsp;copy&nbsp;the&nbsp;JSON&nbsp;data</span><br>
<span class="lineno">85</span><span class="comment" id="4753546">//&nbsp;if&nbsp;it&nbsp;wishes&nbsp;to&nbsp;retain&nbsp;the&nbsp;data&nbsp;after&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="4753598">type</span>&nbsp;<span class="ident" id="4753603">Unmarshaler</span>&nbsp;<span class="keyword" id="4753615">interface</span>&nbsp;<span class="op" id="4753625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753628">UnmarshalJSON</span><span class="op" id="4753641">(</span><span class="op" id="4753642">[</span><span class="op" id="4753643">]</span><span class="builtintype" id="4753644">byte</span><span class="op" id="4753648">)</span>&nbsp;<span class="builtintype" id="4753650">error</span><br>
<span class="lineno"></span><span class="op" id="4753656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="4753659">//&nbsp;An&nbsp;UnmarshalTypeError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;that&nbsp;was</span><br>
<span class="lineno"></span><span class="comment" id="4753716">//&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;value&nbsp;of&nbsp;a&nbsp;specific&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4753770">type</span>&nbsp;<span class="ident" id="4753775">UnmarshalTypeError</span>&nbsp;<span class="keyword" id="4753794">struct</span>&nbsp;<span class="op" id="4753801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753804">Value</span>&nbsp;<span class="builtintype" id="4753810">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753823">//&nbsp;description&nbsp;of&nbsp;JSON&nbsp;value&nbsp;-&nbsp;&#34;bool&#34;,&nbsp;&#34;array&#34;,&nbsp;&#34;number&nbsp;-5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753884">Type</span>&nbsp;&nbsp;<span class="ident" id="4753890">reflect</span><span class="op" id="4753897">.</span><span class="ident" id="4753898">Type</span>&nbsp;<span class="comment" id="4753903">//&nbsp;type&nbsp;of&nbsp;Go&nbsp;value&nbsp;it&nbsp;could&nbsp;not&nbsp;be&nbsp;assigned&nbsp;to</span><br>
<span class="lineno">95</span><span class="op" id="4753951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4753954">func</span>&nbsp;<span class="op" id="4753959">(</span><span class="ident" id="4753960">e</span>&nbsp;<span class="op" id="4753962">*</span><span class="ident" id="4753963">UnmarshalTypeError</span><span class="op" id="4753981">)</span>&nbsp;<span class="ident" id="4753983">Error</span><span class="op" id="4753988">(</span><span class="op" id="4753989">)</span>&nbsp;<span class="builtintype" id="4753991">string</span>&nbsp;<span class="op" id="4753998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754001">return</span>&nbsp;<span class="string" id="4754008">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;&#34;</span>&nbsp;<span class="op" id="4754034">+</span>&nbsp;<span class="ident" id="4754036">e</span><span class="op" id="4754037">.</span><span class="ident" id="4754038">Value</span>&nbsp;<span class="op" id="4754044">+</span>&nbsp;<span class="string" id="4754046">&#34;&nbsp;into&nbsp;Go&nbsp;value&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="4754072">+</span>&nbsp;<span class="ident" id="4754074">e</span><span class="op" id="4754075">.</span><span class="ident" id="4754076">Type</span><span class="op" id="4754080">.</span><span class="ident" id="4754081">String</span><span class="op" id="4754087">(</span><span class="op" id="4754088">)</span><br>
<span class="lineno"></span><span class="op" id="4754090">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4754093">//&nbsp;An&nbsp;UnmarshalFieldError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;object&nbsp;key&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4754152">//&nbsp;led&nbsp;to&nbsp;an&nbsp;unexported&nbsp;(and&nbsp;therefore&nbsp;unwritable)&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="4754217">//&nbsp;(No&nbsp;longer&nbsp;used;&nbsp;kept&nbsp;for&nbsp;compatibility.)</span><br>
<span class="lineno"></span><span class="keyword" id="4754262">type</span>&nbsp;<span class="ident" id="4754267">UnmarshalFieldError</span>&nbsp;<span class="keyword" id="4754287">struct</span>&nbsp;<span class="op" id="4754294">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754297">Key</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4754303">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754311">Type</span>&nbsp;&nbsp;<span class="ident" id="4754317">reflect</span><span class="op" id="4754324">.</span><span class="ident" id="4754325">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754331">Field</span>&nbsp;<span class="ident" id="4754337">reflect</span><span class="op" id="4754344">.</span><span class="ident" id="4754345">StructField</span><br>
<span class="lineno"></span><span class="op" id="4754357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="4754360">func</span>&nbsp;<span class="op" id="4754365">(</span><span class="ident" id="4754366">e</span>&nbsp;<span class="op" id="4754368">*</span><span class="ident" id="4754369">UnmarshalFieldError</span><span class="op" id="4754388">)</span>&nbsp;<span class="ident" id="4754390">Error</span><span class="op" id="4754395">(</span><span class="op" id="4754396">)</span>&nbsp;<span class="builtintype" id="4754398">string</span>&nbsp;<span class="op" id="4754405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754408">return</span>&nbsp;<span class="string" id="4754415">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;object&nbsp;key&nbsp;&#34;</span>&nbsp;<span class="op" id="4754452">+</span>&nbsp;<span class="ident" id="4754454">strconv</span><span class="op" id="4754461">.</span><span class="ident" id="4754462">Quote</span><span class="op" id="4754467">(</span><span class="ident" id="4754468">e</span><span class="op" id="4754469">.</span><span class="ident" id="4754470">Key</span><span class="op" id="4754473">)</span>&nbsp;<span class="op" id="4754475">+</span>&nbsp;<span class="string" id="4754477">&#34;&nbsp;into&nbsp;unexported&nbsp;field&nbsp;&#34;</span>&nbsp;<span class="op" id="4754503">+</span>&nbsp;<span class="ident" id="4754505">e</span><span class="op" id="4754506">.</span><span class="ident" id="4754507">Field</span><span class="op" id="4754512">.</span><span class="ident" id="4754513">Name</span>&nbsp;<span class="op" id="4754518">+</span>&nbsp;<span class="string" id="4754520">&#34;&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="4754532">+</span>&nbsp;<span class="ident" id="4754534">e</span><span class="op" id="4754535">.</span><span class="ident" id="4754536">Type</span><span class="op" id="4754540">.</span><span class="ident" id="4754541">String</span><span class="op" id="4754547">(</span><span class="op" id="4754548">)</span><br>
<span class="lineno"></span><span class="op" id="4754550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4754553">//&nbsp;An&nbsp;InvalidUnmarshalError&nbsp;describes&nbsp;an&nbsp;invalid&nbsp;argument&nbsp;passed&nbsp;to&nbsp;Unmarshal.</span><br>
<span class="lineno">115</span><span class="comment" id="4754632">//&nbsp;(The&nbsp;argument&nbsp;to&nbsp;Unmarshal&nbsp;must&nbsp;be&nbsp;a&nbsp;non-nil&nbsp;pointer.)</span><br>
<span class="lineno"></span><span class="keyword" id="4754690">type</span>&nbsp;<span class="ident" id="4754695">InvalidUnmarshalError</span>&nbsp;<span class="keyword" id="4754717">struct</span>&nbsp;<span class="op" id="4754724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754727">Type</span>&nbsp;<span class="ident" id="4754732">reflect</span><span class="op" id="4754739">.</span><span class="ident" id="4754740">Type</span><br>
<span class="lineno"></span><span class="op" id="4754745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="4754748">func</span>&nbsp;<span class="op" id="4754753">(</span><span class="ident" id="4754754">e</span>&nbsp;<span class="op" id="4754756">*</span><span class="ident" id="4754757">InvalidUnmarshalError</span><span class="op" id="4754778">)</span>&nbsp;<span class="ident" id="4754780">Error</span><span class="op" id="4754785">(</span><span class="op" id="4754786">)</span>&nbsp;<span class="builtintype" id="4754788">string</span>&nbsp;<span class="op" id="4754795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754798">if</span>&nbsp;<span class="ident" id="4754801">e</span><span class="op" id="4754802">.</span><span class="ident" id="4754803">Type</span>&nbsp;<span class="op" id="4754808">==</span>&nbsp;<span class="ident" id="4754811">nil</span>&nbsp;<span class="op" id="4754815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754819">return</span>&nbsp;<span class="string" id="4754826">&#34;json:&nbsp;Unmarshal(nil)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754854">if</span>&nbsp;<span class="ident" id="4754857">e</span><span class="op" id="4754858">.</span><span class="ident" id="4754859">Type</span><span class="op" id="4754863">.</span><span class="ident" id="4754864">Kind</span><span class="op" id="4754868">(</span><span class="op" id="4754869">)</span>&nbsp;<span class="op" id="4754871">!=</span>&nbsp;<span class="ident" id="4754874">reflect</span><span class="op" id="4754881">.</span><span class="ident" id="4754882">Ptr</span>&nbsp;<span class="op" id="4754886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754890">return</span>&nbsp;<span class="string" id="4754897">&#34;json:&nbsp;Unmarshal(non-pointer&nbsp;&#34;</span>&nbsp;<span class="op" id="4754928">+</span>&nbsp;<span class="ident" id="4754930">e</span><span class="op" id="4754931">.</span><span class="ident" id="4754932">Type</span><span class="op" id="4754936">.</span><span class="ident" id="4754937">String</span><span class="op" id="4754943">(</span><span class="op" id="4754944">)</span>&nbsp;<span class="op" id="4754946">+</span>&nbsp;<span class="string" id="4754948">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754956">return</span>&nbsp;<span class="string" id="4754963">&#34;json:&nbsp;Unmarshal(nil&nbsp;&#34;</span>&nbsp;<span class="op" id="4754986">+</span>&nbsp;<span class="ident" id="4754988">e</span><span class="op" id="4754989">.</span><span class="ident" id="4754990">Type</span><span class="op" id="4754994">.</span><span class="ident" id="4754995">String</span><span class="op" id="4755001">(</span><span class="op" id="4755002">)</span>&nbsp;<span class="op" id="4755004">+</span>&nbsp;<span class="string" id="4755006">&#34;)&#34;</span><br>
<span class="lineno"></span><span class="op" id="4755010">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="4755013">func</span>&nbsp;<span class="op" id="4755018">(</span><span class="ident" id="4755019">d</span>&nbsp;<span class="op" id="4755021">*</span><span class="ident" id="4755022">decodeState</span><span class="op" id="4755033">)</span>&nbsp;<span class="ident" id="4755035">unmarshal</span><span class="op" id="4755044">(</span><span class="ident" id="4755045">v</span>&nbsp;<span class="keyword" id="4755047">interface</span><span class="op" id="4755056">{</span><span class="op" id="4755057">}</span><span class="op" id="4755058">)</span>&nbsp;<span class="op" id="4755060">(</span><span class="ident" id="4755061">err</span>&nbsp;<span class="builtintype" id="4755065">error</span><span class="op" id="4755070">)</span>&nbsp;<span class="op" id="4755072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755075">defer</span>&nbsp;<span class="keyword" id="4755081">func</span><span class="op" id="4755085">(</span><span class="op" id="4755086">)</span>&nbsp;<span class="op" id="4755088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755092">if</span>&nbsp;<span class="ident" id="4755095">r</span>&nbsp;<span class="op" id="4755097">:=</span>&nbsp;<span class="builtinfunc" id="4755100">recover</span><span class="op" id="4755107">(</span><span class="op" id="4755108">)</span><span class="op" id="4755109">;</span>&nbsp;<span class="ident" id="4755111">r</span>&nbsp;<span class="op" id="4755113">!=</span>&nbsp;<span class="ident" id="4755116">nil</span>&nbsp;<span class="op" id="4755120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755125">if</span>&nbsp;<span class="ident" id="4755128">_</span><span class="op" id="4755129">,</span>&nbsp;<span class="ident" id="4755131">ok</span>&nbsp;<span class="op" id="4755134">:=</span>&nbsp;<span class="ident" id="4755137">r</span><span class="op" id="4755138">.</span><span class="op" id="4755139">(</span><span class="ident" id="4755140">runtime</span><span class="op" id="4755147">.</span><span class="ident" id="4755148">Error</span><span class="op" id="4755153">)</span><span class="op" id="4755154">;</span>&nbsp;<span class="ident" id="4755156">ok</span>&nbsp;<span class="op" id="4755159">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4755165">panic</span><span class="op" id="4755170">(</span><span class="ident" id="4755171">r</span><span class="op" id="4755172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755182">err</span>&nbsp;<span class="op" id="4755186">=</span>&nbsp;<span class="ident" id="4755188">r</span><span class="op" id="4755189">.</span><span class="op" id="4755190">(</span><span class="builtintype" id="4755191">error</span><span class="op" id="4755196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755203">}</span><span class="op" id="4755204">(</span><span class="op" id="4755205">)</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755209">rv</span>&nbsp;<span class="op" id="4755212">:=</span>&nbsp;<span class="ident" id="4755215">reflect</span><span class="op" id="4755222">.</span><span class="ident" id="4755223">ValueOf</span><span class="op" id="4755230">(</span><span class="ident" id="4755231">v</span><span class="op" id="4755232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755235">if</span>&nbsp;<span class="ident" id="4755238">rv</span><span class="op" id="4755240">.</span><span class="ident" id="4755241">Kind</span><span class="op" id="4755245">(</span><span class="op" id="4755246">)</span>&nbsp;<span class="op" id="4755248">!=</span>&nbsp;<span class="ident" id="4755251">reflect</span><span class="op" id="4755258">.</span><span class="ident" id="4755259">Ptr</span>&nbsp;<span class="op" id="4755263">||</span>&nbsp;<span class="ident" id="4755266">rv</span><span class="op" id="4755268">.</span><span class="ident" id="4755269">IsNil</span><span class="op" id="4755274">(</span><span class="op" id="4755275">)</span>&nbsp;<span class="op" id="4755277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755281">return</span>&nbsp;<span class="op" id="4755288">&amp;</span><span class="ident" id="4755289">InvalidUnmarshalError</span><span class="op" id="4755310">{</span><span class="ident" id="4755311">reflect</span><span class="op" id="4755318">.</span><span class="ident" id="4755319">TypeOf</span><span class="op" id="4755325">(</span><span class="ident" id="4755326">v</span><span class="op" id="4755327">)</span><span class="op" id="4755328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755331">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755335">d</span><span class="op" id="4755336">.</span><span class="ident" id="4755337">scan</span><span class="op" id="4755341">.</span><span class="ident" id="4755342">reset</span><span class="op" id="4755347">(</span><span class="op" id="4755348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4755351">//&nbsp;We&nbsp;decode&nbsp;rv&nbsp;not&nbsp;rv.Elem&nbsp;because&nbsp;the&nbsp;Unmarshaler&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4755414">//&nbsp;test&nbsp;must&nbsp;be&nbsp;applied&nbsp;at&nbsp;the&nbsp;top&nbsp;level&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755470">d</span><span class="op" id="4755471">.</span><span class="ident" id="4755472">value</span><span class="op" id="4755477">(</span><span class="ident" id="4755478">rv</span><span class="op" id="4755480">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755483">return</span>&nbsp;<span class="ident" id="4755490">d</span><span class="op" id="4755491">.</span><span class="ident" id="4755492">savedError</span><br>
<span class="lineno"></span><span class="op" id="4755503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755506">//&nbsp;A&nbsp;Number&nbsp;represents&nbsp;a&nbsp;JSON&nbsp;number&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="4755552">type</span>&nbsp;<span class="ident" id="4755557">Number</span>&nbsp;<span class="builtintype" id="4755564">string</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4755572">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;literal&nbsp;text&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4755622">func</span>&nbsp;<span class="op" id="4755627">(</span><span class="ident" id="4755628">n</span>&nbsp;<span class="ident" id="4755630">Number</span><span class="op" id="4755636">)</span>&nbsp;<span class="ident" id="4755638">String</span><span class="op" id="4755644">(</span><span class="op" id="4755645">)</span>&nbsp;<span class="builtintype" id="4755647">string</span>&nbsp;<span class="op" id="4755654">{</span>&nbsp;<span class="keyword" id="4755656">return</span>&nbsp;<span class="builtintype" id="4755663">string</span><span class="op" id="4755669">(</span><span class="ident" id="4755670">n</span><span class="op" id="4755671">)</span>&nbsp;<span class="op" id="4755673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755676">//&nbsp;Float64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;a&nbsp;float64.</span><br>
<span class="lineno">160</span><span class="keyword" id="4755720">func</span>&nbsp;<span class="op" id="4755725">(</span><span class="ident" id="4755726">n</span>&nbsp;<span class="ident" id="4755728">Number</span><span class="op" id="4755734">)</span>&nbsp;<span class="ident" id="4755736">Float64</span><span class="op" id="4755743">(</span><span class="op" id="4755744">)</span>&nbsp;<span class="op" id="4755746">(</span><span class="builtintype" id="4755747">float64</span><span class="op" id="4755754">,</span>&nbsp;<span class="builtintype" id="4755756">error</span><span class="op" id="4755761">)</span>&nbsp;<span class="op" id="4755763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755766">return</span>&nbsp;<span class="ident" id="4755773">strconv</span><span class="op" id="4755780">.</span><span class="ident" id="4755781">ParseFloat</span><span class="op" id="4755791">(</span><span class="builtintype" id="4755792">string</span><span class="op" id="4755798">(</span><span class="ident" id="4755799">n</span><span class="op" id="4755800">)</span><span class="op" id="4755801">,</span>&nbsp;<span class="num" id="4755803">64</span><span class="op" id="4755805">)</span><br>
<span class="lineno"></span><span class="op" id="4755807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755810">//&nbsp;Int64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;an&nbsp;int64.</span><br>
<span class="lineno">165</span><span class="keyword" id="4755851">func</span>&nbsp;<span class="op" id="4755856">(</span><span class="ident" id="4755857">n</span>&nbsp;<span class="ident" id="4755859">Number</span><span class="op" id="4755865">)</span>&nbsp;<span class="ident" id="4755867">Int64</span><span class="op" id="4755872">(</span><span class="op" id="4755873">)</span>&nbsp;<span class="op" id="4755875">(</span><span class="ident" id="4755876">int64</span><span class="op" id="4755881">,</span>&nbsp;<span class="builtintype" id="4755883">error</span><span class="op" id="4755888">)</span>&nbsp;<span class="op" id="4755890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755893">return</span>&nbsp;<span class="ident" id="4755900">strconv</span><span class="op" id="4755907">.</span><span class="ident" id="4755908">ParseInt</span><span class="op" id="4755916">(</span><span class="builtintype" id="4755917">string</span><span class="op" id="4755923">(</span><span class="ident" id="4755924">n</span><span class="op" id="4755925">)</span><span class="op" id="4755926">,</span>&nbsp;<span class="num" id="4755928">10</span><span class="op" id="4755930">,</span>&nbsp;<span class="num" id="4755932">64</span><span class="op" id="4755934">)</span><br>
<span class="lineno"></span><span class="op" id="4755936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755939">//&nbsp;decodeState&nbsp;represents&nbsp;the&nbsp;state&nbsp;while&nbsp;decoding&nbsp;a&nbsp;JSON&nbsp;value.</span><br>
<span class="lineno">170</span><span class="keyword" id="4756004">type</span>&nbsp;<span class="ident" id="4756009">decodeState</span>&nbsp;<span class="keyword" id="4756021">struct</span>&nbsp;<span class="op" id="4756028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756031">data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756042">[</span><span class="op" id="4756043">]</span><span class="builtintype" id="4756044">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756050">off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4756061">int</span>&nbsp;<span class="comment" id="4756065">//&nbsp;read&nbsp;offset&nbsp;in&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756089">scan</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756100">scanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756109">nextscan</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4756120">scanner</span>&nbsp;<span class="comment" id="4756128">//&nbsp;for&nbsp;calls&nbsp;to&nbsp;nextValue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756155">savedError</span>&nbsp;<span class="builtintype" id="4756166">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756173">useNumber</span>&nbsp;&nbsp;<span class="builtintype" id="4756184">bool</span><br>
<span class="lineno"></span><span class="op" id="4756189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4756192">//&nbsp;errPhase&nbsp;is&nbsp;used&nbsp;for&nbsp;errors&nbsp;that&nbsp;should&nbsp;not&nbsp;happen&nbsp;unless</span><br>
<span class="lineno">180</span><span class="comment" id="4756253">//&nbsp;there&nbsp;is&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;JSON&nbsp;decoder&nbsp;or&nbsp;something&nbsp;is&nbsp;editing</span><br>
<span class="lineno"></span><span class="comment" id="4756315">//&nbsp;the&nbsp;data&nbsp;slice&nbsp;while&nbsp;the&nbsp;decoder&nbsp;executes.</span><br>
<span class="lineno"></span><span class="keyword" id="4756361">var</span>&nbsp;<span class="ident" id="4756365">errPhase</span>&nbsp;<span class="op" id="4756374">=</span>&nbsp;<span class="ident" id="4756376">errors</span><span class="op" id="4756382">.</span><span class="ident" id="4756383">New</span><span class="op" id="4756386">(</span><span class="string" id="4756387">&#34;JSON&nbsp;decoder&nbsp;out&nbsp;of&nbsp;sync&nbsp;-&nbsp;data&nbsp;changing&nbsp;underfoot?&#34;</span><span class="op" id="4756440">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756443">func</span>&nbsp;<span class="op" id="4756448">(</span><span class="ident" id="4756449">d</span>&nbsp;<span class="op" id="4756451">*</span><span class="ident" id="4756452">decodeState</span><span class="op" id="4756463">)</span>&nbsp;<span class="ident" id="4756465">init</span><span class="op" id="4756469">(</span><span class="ident" id="4756470">data</span>&nbsp;<span class="op" id="4756475">[</span><span class="op" id="4756476">]</span><span class="builtintype" id="4756477">byte</span><span class="op" id="4756481">)</span>&nbsp;<span class="op" id="4756483">*</span><span class="ident" id="4756484">decodeState</span>&nbsp;<span class="op" id="4756496">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756499">d</span><span class="op" id="4756500">.</span><span class="ident" id="4756501">data</span>&nbsp;<span class="op" id="4756506">=</span>&nbsp;<span class="ident" id="4756508">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756514">d</span><span class="op" id="4756515">.</span><span class="ident" id="4756516">off</span>&nbsp;<span class="op" id="4756520">=</span>&nbsp;<span class="num" id="4756522">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756525">d</span><span class="op" id="4756526">.</span><span class="ident" id="4756527">savedError</span>&nbsp;<span class="op" id="4756538">=</span>&nbsp;<span class="ident" id="4756540">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756545">return</span>&nbsp;<span class="ident" id="4756552">d</span><br>
<span class="lineno"></span><span class="op" id="4756554">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4756557">//&nbsp;error&nbsp;aborts&nbsp;the&nbsp;decoding&nbsp;by&nbsp;panicking&nbsp;with&nbsp;err.</span><br>
<span class="lineno"></span><span class="keyword" id="4756609">func</span>&nbsp;<span class="op" id="4756614">(</span><span class="ident" id="4756615">d</span>&nbsp;<span class="op" id="4756617">*</span><span class="ident" id="4756618">decodeState</span><span class="op" id="4756629">)</span>&nbsp;<span class="builtintype" id="4756631">error</span><span class="op" id="4756636">(</span><span class="ident" id="4756637">err</span>&nbsp;<span class="builtintype" id="4756641">error</span><span class="op" id="4756646">)</span>&nbsp;<span class="op" id="4756648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4756651">panic</span><span class="op" id="4756656">(</span><span class="ident" id="4756657">err</span><span class="op" id="4756660">)</span><br>
<span class="lineno"></span><span class="op" id="4756662">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="4756665">//&nbsp;saveError&nbsp;saves&nbsp;the&nbsp;first&nbsp;err&nbsp;it&nbsp;is&nbsp;called&nbsp;with,</span><br>
<span class="lineno"></span><span class="comment" id="4756717">//&nbsp;for&nbsp;reporting&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;unmarshal.</span><br>
<span class="lineno"></span><span class="keyword" id="4756763">func</span>&nbsp;<span class="op" id="4756768">(</span><span class="ident" id="4756769">d</span>&nbsp;<span class="op" id="4756771">*</span><span class="ident" id="4756772">decodeState</span><span class="op" id="4756783">)</span>&nbsp;<span class="ident" id="4756785">saveError</span><span class="op" id="4756794">(</span><span class="ident" id="4756795">err</span>&nbsp;<span class="builtintype" id="4756799">error</span><span class="op" id="4756804">)</span>&nbsp;<span class="op" id="4756806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756809">if</span>&nbsp;<span class="ident" id="4756812">d</span><span class="op" id="4756813">.</span><span class="ident" id="4756814">savedError</span>&nbsp;<span class="op" id="4756825">==</span>&nbsp;<span class="ident" id="4756828">nil</span>&nbsp;<span class="op" id="4756832">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756836">d</span><span class="op" id="4756837">.</span><span class="ident" id="4756838">savedError</span>&nbsp;<span class="op" id="4756849">=</span>&nbsp;<span class="ident" id="4756851">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756856">}</span><br>
<span class="lineno"></span><span class="op" id="4756858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4756861">//&nbsp;next&nbsp;cuts&nbsp;off&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;full&nbsp;JSON&nbsp;value&nbsp;in&nbsp;d.data[d.off:].</span><br>
<span class="lineno">205</span><span class="comment" id="4756934">//&nbsp;The&nbsp;next&nbsp;value&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;an&nbsp;object&nbsp;or&nbsp;array,&nbsp;not&nbsp;a&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="4757002">func</span>&nbsp;<span class="op" id="4757007">(</span><span class="ident" id="4757008">d</span>&nbsp;<span class="op" id="4757010">*</span><span class="ident" id="4757011">decodeState</span><span class="op" id="4757022">)</span>&nbsp;<span class="ident" id="4757024">next</span><span class="op" id="4757028">(</span><span class="op" id="4757029">)</span>&nbsp;<span class="op" id="4757031">[</span><span class="op" id="4757032">]</span><span class="builtintype" id="4757033">byte</span>&nbsp;<span class="op" id="4757038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757041">c</span>&nbsp;<span class="op" id="4757043">:=</span>&nbsp;<span class="ident" id="4757046">d</span><span class="op" id="4757047">.</span><span class="ident" id="4757048">data</span><span class="op" id="4757052">[</span><span class="ident" id="4757053">d</span><span class="op" id="4757054">.</span><span class="ident" id="4757055">off</span><span class="op" id="4757058">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757061">item</span><span class="op" id="4757065">,</span>&nbsp;<span class="ident" id="4757067">rest</span><span class="op" id="4757071">,</span>&nbsp;<span class="ident" id="4757073">err</span>&nbsp;<span class="op" id="4757077">:=</span>&nbsp;<span class="ident" id="4757080">nextValue</span><span class="op" id="4757089">(</span><span class="ident" id="4757090">d</span><span class="op" id="4757091">.</span><span class="ident" id="4757092">data</span><span class="op" id="4757096">[</span><span class="ident" id="4757097">d</span><span class="op" id="4757098">.</span><span class="ident" id="4757099">off</span><span class="op" id="4757102">:</span><span class="op" id="4757103">]</span><span class="op" id="4757104">,</span>&nbsp;<span class="op" id="4757106">&amp;</span><span class="ident" id="4757107">d</span><span class="op" id="4757108">.</span><span class="ident" id="4757109">nextscan</span><span class="op" id="4757117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757120">if</span>&nbsp;<span class="ident" id="4757123">err</span>&nbsp;<span class="op" id="4757127">!=</span>&nbsp;<span class="ident" id="4757130">nil</span>&nbsp;<span class="op" id="4757134">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757138">d</span><span class="op" id="4757139">.</span><span class="builtintype" id="4757140">error</span><span class="op" id="4757145">(</span><span class="ident" id="4757146">err</span><span class="op" id="4757149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757155">d</span><span class="op" id="4757156">.</span><span class="ident" id="4757157">off</span>&nbsp;<span class="op" id="4757161">=</span>&nbsp;<span class="builtinfunc" id="4757163">len</span><span class="op" id="4757166">(</span><span class="ident" id="4757167">d</span><span class="op" id="4757168">.</span><span class="ident" id="4757169">data</span><span class="op" id="4757173">)</span>&nbsp;<span class="op" id="4757175">-</span>&nbsp;<span class="builtinfunc" id="4757177">len</span><span class="op" id="4757180">(</span><span class="ident" id="4757181">rest</span><span class="op" id="4757185">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757189">//&nbsp;Our&nbsp;scanner&nbsp;has&nbsp;seen&nbsp;the&nbsp;opening&nbsp;brace/bracket</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757240">//&nbsp;and&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;the&nbsp;object.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757296">//&nbsp;invent&nbsp;a&nbsp;closing&nbsp;brace/bracket&nbsp;to&nbsp;get&nbsp;it&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757346">if</span>&nbsp;<span class="ident" id="4757349">c</span>&nbsp;<span class="op" id="4757351">==</span>&nbsp;<span class="string" id="4757354">&#39;{&#39;</span>&nbsp;<span class="op" id="4757358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757362">d</span><span class="op" id="4757363">.</span><span class="ident" id="4757364">scan</span><span class="op" id="4757368">.</span><span class="ident" id="4757369">step</span><span class="op" id="4757373">(</span><span class="op" id="4757374">&amp;</span><span class="ident" id="4757375">d</span><span class="op" id="4757376">.</span><span class="ident" id="4757377">scan</span><span class="op" id="4757381">,</span>&nbsp;<span class="string" id="4757383">&#39;}&#39;</span><span class="op" id="4757386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757389">}</span>&nbsp;<span class="keyword" id="4757391">else</span>&nbsp;<span class="op" id="4757396">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757400">d</span><span class="op" id="4757401">.</span><span class="ident" id="4757402">scan</span><span class="op" id="4757406">.</span><span class="ident" id="4757407">step</span><span class="op" id="4757411">(</span><span class="op" id="4757412">&amp;</span><span class="ident" id="4757413">d</span><span class="op" id="4757414">.</span><span class="ident" id="4757415">scan</span><span class="op" id="4757419">,</span>&nbsp;<span class="string" id="4757421">&#39;]&#39;</span><span class="op" id="4757424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757431">return</span>&nbsp;<span class="ident" id="4757438">item</span><br>
<span class="lineno"></span><span class="op" id="4757443">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="4757446">//&nbsp;scanWhile&nbsp;processes&nbsp;bytes&nbsp;in&nbsp;d.data[d.off:]&nbsp;until&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4757502">//&nbsp;receives&nbsp;a&nbsp;scan&nbsp;code&nbsp;not&nbsp;equal&nbsp;to&nbsp;op.</span><br>
<span class="lineno"></span><span class="comment" id="4757543">//&nbsp;It&nbsp;updates&nbsp;d.off&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;scan&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword" id="4757594">func</span>&nbsp;<span class="op" id="4757599">(</span><span class="ident" id="4757600">d</span>&nbsp;<span class="op" id="4757602">*</span><span class="ident" id="4757603">decodeState</span><span class="op" id="4757614">)</span>&nbsp;<span class="ident" id="4757616">scanWhile</span><span class="op" id="4757625">(</span><span class="ident" id="4757626">op</span>&nbsp;<span class="builtintype" id="4757629">int</span><span class="op" id="4757632">)</span>&nbsp;<span class="builtintype" id="4757634">int</span>&nbsp;<span class="op" id="4757638">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757641">var</span>&nbsp;<span class="ident" id="4757645">newOp</span>&nbsp;<span class="builtintype" id="4757651">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757656">for</span>&nbsp;<span class="op" id="4757660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757664">if</span>&nbsp;<span class="ident" id="4757667">d</span><span class="op" id="4757668">.</span><span class="ident" id="4757669">off</span>&nbsp;<span class="op" id="4757673">&gt;=</span>&nbsp;<span class="builtinfunc" id="4757676">len</span><span class="op" id="4757679">(</span><span class="ident" id="4757680">d</span><span class="op" id="4757681">.</span><span class="ident" id="4757682">data</span><span class="op" id="4757686">)</span>&nbsp;<span class="op" id="4757688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757693">newOp</span>&nbsp;<span class="op" id="4757699">=</span>&nbsp;<span class="ident" id="4757701">d</span><span class="op" id="4757702">.</span><span class="ident" id="4757703">scan</span><span class="op" id="4757707">.</span><span class="ident" id="4757708">eof</span><span class="op" id="4757711">(</span><span class="op" id="4757712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757717">d</span><span class="op" id="4757718">.</span><span class="ident" id="4757719">off</span>&nbsp;<span class="op" id="4757723">=</span>&nbsp;<span class="builtinfunc" id="4757725">len</span><span class="op" id="4757728">(</span><span class="ident" id="4757729">d</span><span class="op" id="4757730">.</span><span class="ident" id="4757731">data</span><span class="op" id="4757735">)</span>&nbsp;<span class="op" id="4757737">+</span>&nbsp;<span class="num" id="4757739">1</span>&nbsp;<span class="comment" id="4757741">//&nbsp;mark&nbsp;processed&nbsp;EOF&nbsp;with&nbsp;len+1</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757776">}</span>&nbsp;<span class="keyword" id="4757778">else</span>&nbsp;<span class="op" id="4757783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757788">c</span>&nbsp;<span class="op" id="4757790">:=</span>&nbsp;<span class="builtintype" id="4757793">int</span><span class="op" id="4757796">(</span><span class="ident" id="4757797">d</span><span class="op" id="4757798">.</span><span class="ident" id="4757799">data</span><span class="op" id="4757803">[</span><span class="ident" id="4757804">d</span><span class="op" id="4757805">.</span><span class="ident" id="4757806">off</span><span class="op" id="4757809">]</span><span class="op" id="4757810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757815">d</span><span class="op" id="4757816">.</span><span class="ident" id="4757817">off</span><span class="op" id="4757820">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757826">newOp</span>&nbsp;<span class="op" id="4757832">=</span>&nbsp;<span class="ident" id="4757834">d</span><span class="op" id="4757835">.</span><span class="ident" id="4757836">scan</span><span class="op" id="4757840">.</span><span class="ident" id="4757841">step</span><span class="op" id="4757845">(</span><span class="op" id="4757846">&amp;</span><span class="ident" id="4757847">d</span><span class="op" id="4757848">.</span><span class="ident" id="4757849">scan</span><span class="op" id="4757853">,</span>&nbsp;<span class="ident" id="4757855">c</span><span class="op" id="4757856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757860">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757864">if</span>&nbsp;<span class="ident" id="4757867">newOp</span>&nbsp;<span class="op" id="4757873">!=</span>&nbsp;<span class="ident" id="4757876">op</span>&nbsp;<span class="op" id="4757879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757884">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757898">return</span>&nbsp;<span class="ident" id="4757905">newOp</span><br>
<span class="lineno">245</span><span class="op" id="4757911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4757914">//&nbsp;value&nbsp;decodes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;from&nbsp;d.data[d.off:]&nbsp;into&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4757980">//&nbsp;it&nbsp;updates&nbsp;d.off&nbsp;to&nbsp;point&nbsp;past&nbsp;the&nbsp;decoded&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4758033">func</span>&nbsp;<span class="op" id="4758038">(</span><span class="ident" id="4758039">d</span>&nbsp;<span class="op" id="4758041">*</span><span class="ident" id="4758042">decodeState</span><span class="op" id="4758053">)</span>&nbsp;<span class="ident" id="4758055">value</span><span class="op" id="4758060">(</span><span class="ident" id="4758061">v</span>&nbsp;<span class="ident" id="4758063">reflect</span><span class="op" id="4758070">.</span><span class="ident" id="4758071">Value</span><span class="op" id="4758076">)</span>&nbsp;<span class="op" id="4758078">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758081">if</span>&nbsp;<span class="op" id="4758084">!</span><span class="ident" id="4758085">v</span><span class="op" id="4758086">.</span><span class="ident" id="4758087">IsValid</span><span class="op" id="4758094">(</span><span class="op" id="4758095">)</span>&nbsp;<span class="op" id="4758097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758101">_</span><span class="op" id="4758102">,</span>&nbsp;<span class="ident" id="4758104">rest</span><span class="op" id="4758108">,</span>&nbsp;<span class="ident" id="4758110">err</span>&nbsp;<span class="op" id="4758114">:=</span>&nbsp;<span class="ident" id="4758117">nextValue</span><span class="op" id="4758126">(</span><span class="ident" id="4758127">d</span><span class="op" id="4758128">.</span><span class="ident" id="4758129">data</span><span class="op" id="4758133">[</span><span class="ident" id="4758134">d</span><span class="op" id="4758135">.</span><span class="ident" id="4758136">off</span><span class="op" id="4758139">:</span><span class="op" id="4758140">]</span><span class="op" id="4758141">,</span>&nbsp;<span class="op" id="4758143">&amp;</span><span class="ident" id="4758144">d</span><span class="op" id="4758145">.</span><span class="ident" id="4758146">nextscan</span><span class="op" id="4758154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758158">if</span>&nbsp;<span class="ident" id="4758161">err</span>&nbsp;<span class="op" id="4758165">!=</span>&nbsp;<span class="ident" id="4758168">nil</span>&nbsp;<span class="op" id="4758172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758177">d</span><span class="op" id="4758178">.</span><span class="builtintype" id="4758179">error</span><span class="op" id="4758184">(</span><span class="ident" id="4758185">err</span><span class="op" id="4758188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4758192">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758196">d</span><span class="op" id="4758197">.</span><span class="ident" id="4758198">off</span>&nbsp;<span class="op" id="4758202">=</span>&nbsp;<span class="builtinfunc" id="4758204">len</span><span class="op" id="4758207">(</span><span class="ident" id="4758208">d</span><span class="op" id="4758209">.</span><span class="ident" id="4758210">data</span><span class="op" id="4758214">)</span>&nbsp;<span class="op" id="4758216">-</span>&nbsp;<span class="builtinfunc" id="4758218">len</span><span class="op" id="4758221">(</span><span class="ident" id="4758222">rest</span><span class="op" id="4758226">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758231">//&nbsp;d.scan&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758292">//&nbsp;Feed&nbsp;in&nbsp;an&nbsp;empty&nbsp;string&nbsp;-&nbsp;the&nbsp;shortest,&nbsp;simplest&nbsp;value&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758354">//&nbsp;so&nbsp;that&nbsp;it&nbsp;knows&nbsp;we&nbsp;got&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758408">if</span>&nbsp;<span class="ident" id="4758411">d</span><span class="op" id="4758412">.</span><span class="ident" id="4758413">scan</span><span class="op" id="4758417">.</span><span class="ident" id="4758418">redo</span>&nbsp;<span class="op" id="4758423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758428">//&nbsp;rewind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758442">d</span><span class="op" id="4758443">.</span><span class="ident" id="4758444">scan</span><span class="op" id="4758448">.</span><span class="ident" id="4758449">redo</span>&nbsp;<span class="op" id="4758454">=</span>&nbsp;<span class="builtintype" id="4758456">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758465">d</span><span class="op" id="4758466">.</span><span class="ident" id="4758467">scan</span><span class="op" id="4758471">.</span><span class="ident" id="4758472">step</span>&nbsp;<span class="op" id="4758477">=</span>&nbsp;<span class="ident" id="4758479">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4758497">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758501">d</span><span class="op" id="4758502">.</span><span class="ident" id="4758503">scan</span><span class="op" id="4758507">.</span><span class="ident" id="4758508">step</span><span class="op" id="4758512">(</span><span class="op" id="4758513">&amp;</span><span class="ident" id="4758514">d</span><span class="op" id="4758515">.</span><span class="ident" id="4758516">scan</span><span class="op" id="4758520">,</span>&nbsp;<span class="string" id="4758522">&#39;&#34;&#39;</span><span class="op" id="4758525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758529">d</span><span class="op" id="4758530">.</span><span class="ident" id="4758531">scan</span><span class="op" id="4758535">.</span><span class="ident" id="4758536">step</span><span class="op" id="4758540">(</span><span class="op" id="4758541">&amp;</span><span class="ident" id="4758542">d</span><span class="op" id="4758543">.</span><span class="ident" id="4758544">scan</span><span class="op" id="4758548">,</span>&nbsp;<span class="string" id="4758550">&#39;&#34;&#39;</span><span class="op" id="4758553">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758558">n</span>&nbsp;<span class="op" id="4758560">:=</span>&nbsp;<span class="builtinfunc" id="4758563">len</span><span class="op" id="4758566">(</span><span class="ident" id="4758567">d</span><span class="op" id="4758568">.</span><span class="ident" id="4758569">scan</span><span class="op" id="4758573">.</span><span class="ident" id="4758574">parseState</span><span class="op" id="4758584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758588">if</span>&nbsp;<span class="ident" id="4758591">n</span>&nbsp;<span class="op" id="4758593">&gt;</span>&nbsp;<span class="num" id="4758595">0</span>&nbsp;<span class="op" id="4758597">&amp;&amp;</span>&nbsp;<span class="ident" id="4758600">d</span><span class="op" id="4758601">.</span><span class="ident" id="4758602">scan</span><span class="op" id="4758606">.</span><span class="ident" id="4758607">parseState</span><span class="op" id="4758617">[</span><span class="ident" id="4758618">n</span><span class="op" id="4758619">-</span><span class="num" id="4758620">1</span><span class="op" id="4758621">]</span>&nbsp;<span class="op" id="4758623">==</span>&nbsp;<span class="ident" id="4758626">parseObjectKey</span>&nbsp;<span class="op" id="4758641">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758646">//&nbsp;d.scan&nbsp;thinks&nbsp;we&nbsp;just&nbsp;read&nbsp;an&nbsp;object&nbsp;key;&nbsp;finish&nbsp;the&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758712">d</span><span class="op" id="4758713">.</span><span class="ident" id="4758714">scan</span><span class="op" id="4758718">.</span><span class="ident" id="4758719">step</span><span class="op" id="4758723">(</span><span class="op" id="4758724">&amp;</span><span class="ident" id="4758725">d</span><span class="op" id="4758726">.</span><span class="ident" id="4758727">scan</span><span class="op" id="4758731">,</span>&nbsp;<span class="string" id="4758733">&#39;:&#39;</span><span class="op" id="4758736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758741">d</span><span class="op" id="4758742">.</span><span class="ident" id="4758743">scan</span><span class="op" id="4758747">.</span><span class="ident" id="4758748">step</span><span class="op" id="4758752">(</span><span class="op" id="4758753">&amp;</span><span class="ident" id="4758754">d</span><span class="op" id="4758755">.</span><span class="ident" id="4758756">scan</span><span class="op" id="4758760">,</span>&nbsp;<span class="string" id="4758762">&#39;&#34;&#39;</span><span class="op" id="4758765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758770">d</span><span class="op" id="4758771">.</span><span class="ident" id="4758772">scan</span><span class="op" id="4758776">.</span><span class="ident" id="4758777">step</span><span class="op" id="4758781">(</span><span class="op" id="4758782">&amp;</span><span class="ident" id="4758783">d</span><span class="op" id="4758784">.</span><span class="ident" id="4758785">scan</span><span class="op" id="4758789">,</span>&nbsp;<span class="string" id="4758791">&#39;&#34;&#39;</span><span class="op" id="4758794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758799">d</span><span class="op" id="4758800">.</span><span class="ident" id="4758801">scan</span><span class="op" id="4758805">.</span><span class="ident" id="4758806">step</span><span class="op" id="4758810">(</span><span class="op" id="4758811">&amp;</span><span class="ident" id="4758812">d</span><span class="op" id="4758813">.</span><span class="ident" id="4758814">scan</span><span class="op" id="4758818">,</span>&nbsp;<span class="string" id="4758820">&#39;}&#39;</span><span class="op" id="4758823">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4758827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758832">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4758840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758844">switch</span>&nbsp;<span class="ident" id="4758851">op</span>&nbsp;<span class="op" id="4758854">:=</span>&nbsp;<span class="ident" id="4758857">d</span><span class="op" id="4758858">.</span><span class="ident" id="4758859">scanWhile</span><span class="op" id="4758868">(</span><span class="ident" id="4758869">scanSkipSpace</span><span class="op" id="4758882">)</span><span class="op" id="4758883">;</span>&nbsp;<span class="ident" id="4758885">op</span>&nbsp;<span class="op" id="4758888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758891">default</span><span class="op" id="4758898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758902">d</span><span class="op" id="4758903">.</span><span class="builtintype" id="4758904">error</span><span class="op" id="4758909">(</span><span class="ident" id="4758910">errPhase</span><span class="op" id="4758918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758922">case</span>&nbsp;<span class="ident" id="4758927">scanBeginArray</span><span class="op" id="4758941">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758945">d</span><span class="op" id="4758946">.</span><span class="ident" id="4758947">array</span><span class="op" id="4758952">(</span><span class="ident" id="4758953">v</span><span class="op" id="4758954">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758958">case</span>&nbsp;<span class="ident" id="4758963">scanBeginObject</span><span class="op" id="4758978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758982">d</span><span class="op" id="4758983">.</span><span class="ident" id="4758984">object</span><span class="op" id="4758990">(</span><span class="ident" id="4758991">v</span><span class="op" id="4758992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758996">case</span>&nbsp;<span class="ident" id="4759001">scanBeginLiteral</span><span class="op" id="4759017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759021">d</span><span class="op" id="4759022">.</span><span class="ident" id="4759023">literal</span><span class="op" id="4759030">(</span><span class="ident" id="4759031">v</span><span class="op" id="4759032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759035">}</span><br>
<span class="lineno"></span><span class="op" id="4759037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4759040">type</span>&nbsp;<span class="ident" id="4759045">unquotedValue</span>&nbsp;<span class="keyword" id="4759059">struct</span><span class="op" id="4759065">{</span><span class="op" id="4759066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4759069">//&nbsp;valueQuoted&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;decodes&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4759112">//&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;literal&nbsp;null&nbsp;into&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4759178">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;anything&nbsp;other&nbsp;than&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;null,</span><br>
<span class="lineno">300</span><span class="comment" id="4759246">//&nbsp;valueQuoted&nbsp;returns&nbsp;unquotedValue{}.</span><br>
<span class="lineno"></span><span class="keyword" id="4759286">func</span>&nbsp;<span class="op" id="4759291">(</span><span class="ident" id="4759292">d</span>&nbsp;<span class="op" id="4759294">*</span><span class="ident" id="4759295">decodeState</span><span class="op" id="4759306">)</span>&nbsp;<span class="ident" id="4759308">valueQuoted</span><span class="op" id="4759319">(</span><span class="op" id="4759320">)</span>&nbsp;<span class="keyword" id="4759322">interface</span><span class="op" id="4759331">{</span><span class="op" id="4759332">}</span>&nbsp;<span class="op" id="4759334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759337">switch</span>&nbsp;<span class="ident" id="4759344">op</span>&nbsp;<span class="op" id="4759347">:=</span>&nbsp;<span class="ident" id="4759350">d</span><span class="op" id="4759351">.</span><span class="ident" id="4759352">scanWhile</span><span class="op" id="4759361">(</span><span class="ident" id="4759362">scanSkipSpace</span><span class="op" id="4759375">)</span><span class="op" id="4759376">;</span>&nbsp;<span class="ident" id="4759378">op</span>&nbsp;<span class="op" id="4759381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759384">default</span><span class="op" id="4759391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759395">d</span><span class="op" id="4759396">.</span><span class="builtintype" id="4759397">error</span><span class="op" id="4759402">(</span><span class="ident" id="4759403">errPhase</span><span class="op" id="4759411">)</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759415">case</span>&nbsp;<span class="ident" id="4759420">scanBeginArray</span><span class="op" id="4759434">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759438">d</span><span class="op" id="4759439">.</span><span class="ident" id="4759440">array</span><span class="op" id="4759445">(</span><span class="ident" id="4759446">reflect</span><span class="op" id="4759453">.</span><span class="ident" id="4759454">Value</span><span class="op" id="4759459">{</span><span class="op" id="4759460">}</span><span class="op" id="4759461">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759465">case</span>&nbsp;<span class="ident" id="4759470">scanBeginObject</span><span class="op" id="4759485">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759489">d</span><span class="op" id="4759490">.</span><span class="ident" id="4759491">object</span><span class="op" id="4759497">(</span><span class="ident" id="4759498">reflect</span><span class="op" id="4759505">.</span><span class="ident" id="4759506">Value</span><span class="op" id="4759511">{</span><span class="op" id="4759512">}</span><span class="op" id="4759513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759517">case</span>&nbsp;<span class="ident" id="4759522">scanBeginLiteral</span><span class="op" id="4759538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759542">switch</span>&nbsp;<span class="ident" id="4759549">v</span>&nbsp;<span class="op" id="4759551">:=</span>&nbsp;<span class="ident" id="4759554">d</span><span class="op" id="4759555">.</span><span class="ident" id="4759556">literalInterface</span><span class="op" id="4759572">(</span><span class="op" id="4759573">)</span><span class="op" id="4759574">.</span><span class="op" id="4759575">(</span><span class="keyword" id="4759576">type</span><span class="op" id="4759580">)</span>&nbsp;<span class="op" id="4759582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759586">case</span>&nbsp;<span class="ident" id="4759591">nil</span><span class="op" id="4759594">,</span>&nbsp;<span class="builtintype" id="4759596">string</span><span class="op" id="4759602">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759607">return</span>&nbsp;<span class="ident" id="4759614">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759624">return</span>&nbsp;<span class="ident" id="4759631">unquotedValue</span><span class="op" id="4759644">{</span><span class="op" id="4759645">}</span><br>
<span class="lineno"></span><span class="op" id="4759647">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="4759650">//&nbsp;indirect&nbsp;walks&nbsp;down&nbsp;v&nbsp;allocating&nbsp;pointers&nbsp;as&nbsp;needed,</span><br>
<span class="lineno"></span><span class="comment" id="4759706">//&nbsp;until&nbsp;it&nbsp;gets&nbsp;to&nbsp;a&nbsp;non-pointer.</span><br>
<span class="lineno"></span><span class="comment" id="4759741">//&nbsp;if&nbsp;it&nbsp;encounters&nbsp;an&nbsp;Unmarshaler,&nbsp;indirect&nbsp;stops&nbsp;and&nbsp;returns&nbsp;that.</span><br>
<span class="lineno"></span><span class="comment" id="4759810">//&nbsp;if&nbsp;decodingNull&nbsp;is&nbsp;true,&nbsp;indirect&nbsp;stops&nbsp;at&nbsp;the&nbsp;last&nbsp;pointer&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;set&nbsp;to&nbsp;nil.</span><br>
<span class="lineno">325</span><span class="keyword" id="4759898">func</span>&nbsp;<span class="op" id="4759903">(</span><span class="ident" id="4759904">d</span>&nbsp;<span class="op" id="4759906">*</span><span class="ident" id="4759907">decodeState</span><span class="op" id="4759918">)</span>&nbsp;<span class="ident" id="4759920">indirect</span><span class="op" id="4759928">(</span><span class="ident" id="4759929">v</span>&nbsp;<span class="ident" id="4759931">reflect</span><span class="op" id="4759938">.</span><span class="ident" id="4759939">Value</span><span class="op" id="4759944">,</span>&nbsp;<span class="ident" id="4759946">decodingNull</span>&nbsp;<span class="builtintype" id="4759959">bool</span><span class="op" id="4759963">)</span>&nbsp;<span class="op" id="4759965">(</span><span class="ident" id="4759966">Unmarshaler</span><span class="op" id="4759977">,</span>&nbsp;<span class="ident" id="4759979">encoding</span><span class="op" id="4759987">.</span><span class="ident" id="4759988">TextUnmarshaler</span><span class="op" id="4760003">,</span>&nbsp;<span class="ident" id="4760005">reflect</span><span class="op" id="4760012">.</span><span class="ident" id="4760013">Value</span><span class="op" id="4760018">)</span>&nbsp;<span class="op" id="4760020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760023">//&nbsp;If&nbsp;v&nbsp;is&nbsp;a&nbsp;named&nbsp;type&nbsp;and&nbsp;is&nbsp;addressable,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760068">//&nbsp;start&nbsp;with&nbsp;its&nbsp;address,&nbsp;so&nbsp;that&nbsp;if&nbsp;the&nbsp;type&nbsp;has&nbsp;pointer&nbsp;methods,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760137">//&nbsp;we&nbsp;find&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760155">if</span>&nbsp;<span class="ident" id="4760158">v</span><span class="op" id="4760159">.</span><span class="ident" id="4760160">Kind</span><span class="op" id="4760164">(</span><span class="op" id="4760165">)</span>&nbsp;<span class="op" id="4760167">!=</span>&nbsp;<span class="ident" id="4760170">reflect</span><span class="op" id="4760177">.</span><span class="ident" id="4760178">Ptr</span>&nbsp;<span class="op" id="4760182">&amp;&amp;</span>&nbsp;<span class="ident" id="4760185">v</span><span class="op" id="4760186">.</span><span class="ident" id="4760187">Type</span><span class="op" id="4760191">(</span><span class="op" id="4760192">)</span><span class="op" id="4760193">.</span><span class="ident" id="4760194">Name</span><span class="op" id="4760198">(</span><span class="op" id="4760199">)</span>&nbsp;<span class="op" id="4760201">!=</span>&nbsp;<span class="string" id="4760204">&#34;&#34;</span>&nbsp;<span class="op" id="4760207">&amp;&amp;</span>&nbsp;<span class="ident" id="4760210">v</span><span class="op" id="4760211">.</span><span class="ident" id="4760212">CanAddr</span><span class="op" id="4760219">(</span><span class="op" id="4760220">)</span>&nbsp;<span class="op" id="4760222">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760226">v</span>&nbsp;<span class="op" id="4760228">=</span>&nbsp;<span class="ident" id="4760230">v</span><span class="op" id="4760231">.</span><span class="ident" id="4760232">Addr</span><span class="op" id="4760236">(</span><span class="op" id="4760237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760243">for</span>&nbsp;<span class="op" id="4760247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760251">//&nbsp;Load&nbsp;value&nbsp;from&nbsp;interface,&nbsp;but&nbsp;only&nbsp;if&nbsp;the&nbsp;result&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760314">//&nbsp;usefully&nbsp;addressable.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760341">if</span>&nbsp;<span class="ident" id="4760344">v</span><span class="op" id="4760345">.</span><span class="ident" id="4760346">Kind</span><span class="op" id="4760350">(</span><span class="op" id="4760351">)</span>&nbsp;<span class="op" id="4760353">==</span>&nbsp;<span class="ident" id="4760356">reflect</span><span class="op" id="4760363">.</span><span class="ident" id="4760364">Interface</span>&nbsp;<span class="op" id="4760374">&amp;&amp;</span>&nbsp;<span class="op" id="4760377">!</span><span class="ident" id="4760378">v</span><span class="op" id="4760379">.</span><span class="ident" id="4760380">IsNil</span><span class="op" id="4760385">(</span><span class="op" id="4760386">)</span>&nbsp;<span class="op" id="4760388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760393">e</span>&nbsp;<span class="op" id="4760395">:=</span>&nbsp;<span class="ident" id="4760398">v</span><span class="op" id="4760399">.</span><span class="ident" id="4760400">Elem</span><span class="op" id="4760404">(</span><span class="op" id="4760405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760410">if</span>&nbsp;<span class="ident" id="4760413">e</span><span class="op" id="4760414">.</span><span class="ident" id="4760415">Kind</span><span class="op" id="4760419">(</span><span class="op" id="4760420">)</span>&nbsp;<span class="op" id="4760422">==</span>&nbsp;<span class="ident" id="4760425">reflect</span><span class="op" id="4760432">.</span><span class="ident" id="4760433">Ptr</span>&nbsp;<span class="op" id="4760437">&amp;&amp;</span>&nbsp;<span class="op" id="4760440">!</span><span class="ident" id="4760441">e</span><span class="op" id="4760442">.</span><span class="ident" id="4760443">IsNil</span><span class="op" id="4760448">(</span><span class="op" id="4760449">)</span>&nbsp;<span class="op" id="4760451">&amp;&amp;</span>&nbsp;<span class="op" id="4760454">(</span><span class="op" id="4760455">!</span><span class="ident" id="4760456">decodingNull</span>&nbsp;<span class="op" id="4760469">||</span>&nbsp;<span class="ident" id="4760472">e</span><span class="op" id="4760473">.</span><span class="ident" id="4760474">Elem</span><span class="op" id="4760478">(</span><span class="op" id="4760479">)</span><span class="op" id="4760480">.</span><span class="ident" id="4760481">Kind</span><span class="op" id="4760485">(</span><span class="op" id="4760486">)</span>&nbsp;<span class="op" id="4760488">==</span>&nbsp;<span class="ident" id="4760491">reflect</span><span class="op" id="4760498">.</span><span class="ident" id="4760499">Ptr</span><span class="op" id="4760502">)</span>&nbsp;<span class="op" id="4760504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760510">v</span>&nbsp;<span class="op" id="4760512">=</span>&nbsp;<span class="ident" id="4760514">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760520">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760541">if</span>&nbsp;<span class="ident" id="4760544">v</span><span class="op" id="4760545">.</span><span class="ident" id="4760546">Kind</span><span class="op" id="4760550">(</span><span class="op" id="4760551">)</span>&nbsp;<span class="op" id="4760553">!=</span>&nbsp;<span class="ident" id="4760556">reflect</span><span class="op" id="4760563">.</span><span class="ident" id="4760564">Ptr</span>&nbsp;<span class="op" id="4760568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760573">break</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760586">if</span>&nbsp;<span class="ident" id="4760589">v</span><span class="op" id="4760590">.</span><span class="ident" id="4760591">Elem</span><span class="op" id="4760595">(</span><span class="op" id="4760596">)</span><span class="op" id="4760597">.</span><span class="ident" id="4760598">Kind</span><span class="op" id="4760602">(</span><span class="op" id="4760603">)</span>&nbsp;<span class="op" id="4760605">!=</span>&nbsp;<span class="ident" id="4760608">reflect</span><span class="op" id="4760615">.</span><span class="ident" id="4760616">Ptr</span>&nbsp;<span class="op" id="4760620">&amp;&amp;</span>&nbsp;<span class="ident" id="4760623">decodingNull</span>&nbsp;<span class="op" id="4760636">&amp;&amp;</span>&nbsp;<span class="ident" id="4760639">v</span><span class="op" id="4760640">.</span><span class="ident" id="4760641">CanSet</span><span class="op" id="4760647">(</span><span class="op" id="4760648">)</span>&nbsp;<span class="op" id="4760650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760655">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760663">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760667">if</span>&nbsp;<span class="ident" id="4760670">v</span><span class="op" id="4760671">.</span><span class="ident" id="4760672">IsNil</span><span class="op" id="4760677">(</span><span class="op" id="4760678">)</span>&nbsp;<span class="op" id="4760680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760685">v</span><span class="op" id="4760686">.</span><span class="ident" id="4760687">Set</span><span class="op" id="4760690">(</span><span class="ident" id="4760691">reflect</span><span class="op" id="4760698">.</span><span class="ident" id="4760699">New</span><span class="op" id="4760702">(</span><span class="ident" id="4760703">v</span><span class="op" id="4760704">.</span><span class="ident" id="4760705">Type</span><span class="op" id="4760709">(</span><span class="op" id="4760710">)</span><span class="op" id="4760711">.</span><span class="ident" id="4760712">Elem</span><span class="op" id="4760716">(</span><span class="op" id="4760717">)</span><span class="op" id="4760718">)</span><span class="op" id="4760719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760727">if</span>&nbsp;<span class="ident" id="4760730">v</span><span class="op" id="4760731">.</span><span class="ident" id="4760732">Type</span><span class="op" id="4760736">(</span><span class="op" id="4760737">)</span><span class="op" id="4760738">.</span><span class="ident" id="4760739">NumMethod</span><span class="op" id="4760748">(</span><span class="op" id="4760749">)</span>&nbsp;<span class="op" id="4760751">&gt;</span>&nbsp;<span class="num" id="4760753">0</span>&nbsp;<span class="op" id="4760755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760760">if</span>&nbsp;<span class="ident" id="4760763">u</span><span class="op" id="4760764">,</span>&nbsp;<span class="ident" id="4760766">ok</span>&nbsp;<span class="op" id="4760769">:=</span>&nbsp;<span class="ident" id="4760772">v</span><span class="op" id="4760773">.</span><span class="ident" id="4760774">Interface</span><span class="op" id="4760783">(</span><span class="op" id="4760784">)</span><span class="op" id="4760785">.</span><span class="op" id="4760786">(</span><span class="ident" id="4760787">Unmarshaler</span><span class="op" id="4760798">)</span><span class="op" id="4760799">;</span>&nbsp;<span class="ident" id="4760801">ok</span>&nbsp;<span class="op" id="4760804">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760810">return</span>&nbsp;<span class="ident" id="4760817">u</span><span class="op" id="4760818">,</span>&nbsp;<span class="ident" id="4760820">nil</span><span class="op" id="4760823">,</span>&nbsp;<span class="ident" id="4760825">reflect</span><span class="op" id="4760832">.</span><span class="ident" id="4760833">Value</span><span class="op" id="4760838">{</span><span class="op" id="4760839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760849">if</span>&nbsp;<span class="ident" id="4760852">u</span><span class="op" id="4760853">,</span>&nbsp;<span class="ident" id="4760855">ok</span>&nbsp;<span class="op" id="4760858">:=</span>&nbsp;<span class="ident" id="4760861">v</span><span class="op" id="4760862">.</span><span class="ident" id="4760863">Interface</span><span class="op" id="4760872">(</span><span class="op" id="4760873">)</span><span class="op" id="4760874">.</span><span class="op" id="4760875">(</span><span class="ident" id="4760876">encoding</span><span class="op" id="4760884">.</span><span class="ident" id="4760885">TextUnmarshaler</span><span class="op" id="4760900">)</span><span class="op" id="4760901">;</span>&nbsp;<span class="ident" id="4760903">ok</span>&nbsp;<span class="op" id="4760906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760912">return</span>&nbsp;<span class="ident" id="4760919">nil</span><span class="op" id="4760922">,</span>&nbsp;<span class="ident" id="4760924">u</span><span class="op" id="4760925">,</span>&nbsp;<span class="ident" id="4760927">reflect</span><span class="op" id="4760934">.</span><span class="ident" id="4760935">Value</span><span class="op" id="4760940">{</span><span class="op" id="4760941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760946">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760954">v</span>&nbsp;<span class="op" id="4760956">=</span>&nbsp;<span class="ident" id="4760958">v</span><span class="op" id="4760959">.</span><span class="ident" id="4760960">Elem</span><span class="op" id="4760964">(</span><span class="op" id="4760965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760971">return</span>&nbsp;<span class="ident" id="4760978">nil</span><span class="op" id="4760981">,</span>&nbsp;<span class="ident" id="4760983">nil</span><span class="op" id="4760986">,</span>&nbsp;<span class="ident" id="4760988">v</span><br>
<span class="lineno"></span><span class="op" id="4760990">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="4760993">//&nbsp;array&nbsp;consumes&nbsp;an&nbsp;array&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4761070">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;array&nbsp;(&#39;[&#39;)&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="4761130">func</span>&nbsp;<span class="op" id="4761135">(</span><span class="ident" id="4761136">d</span>&nbsp;<span class="op" id="4761138">*</span><span class="ident" id="4761139">decodeState</span><span class="op" id="4761150">)</span>&nbsp;<span class="ident" id="4761152">array</span><span class="op" id="4761157">(</span><span class="ident" id="4761158">v</span>&nbsp;<span class="ident" id="4761160">reflect</span><span class="op" id="4761167">.</span><span class="ident" id="4761168">Value</span><span class="op" id="4761173">)</span>&nbsp;<span class="op" id="4761175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4761178">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761205">u</span><span class="op" id="4761206">,</span>&nbsp;<span class="ident" id="4761208">ut</span><span class="op" id="4761210">,</span>&nbsp;<span class="ident" id="4761212">pv</span>&nbsp;<span class="op" id="4761215">:=</span>&nbsp;<span class="ident" id="4761218">d</span><span class="op" id="4761219">.</span><span class="ident" id="4761220">indirect</span><span class="op" id="4761228">(</span><span class="ident" id="4761229">v</span><span class="op" id="4761230">,</span>&nbsp;<span class="builtintype" id="4761232">false</span><span class="op" id="4761237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761240">if</span>&nbsp;<span class="ident" id="4761243">u</span>&nbsp;<span class="op" id="4761245">!=</span>&nbsp;<span class="ident" id="4761248">nil</span>&nbsp;<span class="op" id="4761252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761256">d</span><span class="op" id="4761257">.</span><span class="ident" id="4761258">off</span><span class="op" id="4761261">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761266">err</span>&nbsp;<span class="op" id="4761270">:=</span>&nbsp;<span class="ident" id="4761273">u</span><span class="op" id="4761274">.</span><span class="ident" id="4761275">UnmarshalJSON</span><span class="op" id="4761288">(</span><span class="ident" id="4761289">d</span><span class="op" id="4761290">.</span><span class="ident" id="4761291">next</span><span class="op" id="4761295">(</span><span class="op" id="4761296">)</span><span class="op" id="4761297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761301">if</span>&nbsp;<span class="ident" id="4761304">err</span>&nbsp;<span class="op" id="4761308">!=</span>&nbsp;<span class="ident" id="4761311">nil</span>&nbsp;<span class="op" id="4761315">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761320">d</span><span class="op" id="4761321">.</span><span class="builtintype" id="4761322">error</span><span class="op" id="4761327">(</span><span class="ident" id="4761328">err</span><span class="op" id="4761331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761339">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761350">if</span>&nbsp;<span class="ident" id="4761353">ut</span>&nbsp;<span class="op" id="4761356">!=</span>&nbsp;<span class="ident" id="4761359">nil</span>&nbsp;<span class="op" id="4761363">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761367">d</span><span class="op" id="4761368">.</span><span class="ident" id="4761369">saveError</span><span class="op" id="4761378">(</span><span class="op" id="4761379">&amp;</span><span class="ident" id="4761380">UnmarshalTypeError</span><span class="op" id="4761398">{</span><span class="string" id="4761399">&#34;array&#34;</span><span class="op" id="4761406">,</span>&nbsp;<span class="ident" id="4761408">v</span><span class="op" id="4761409">.</span><span class="ident" id="4761410">Type</span><span class="op" id="4761414">(</span><span class="op" id="4761415">)</span><span class="op" id="4761416">}</span><span class="op" id="4761417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761421">d</span><span class="op" id="4761422">.</span><span class="ident" id="4761423">off</span><span class="op" id="4761426">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761431">d</span><span class="op" id="4761432">.</span><span class="ident" id="4761433">next</span><span class="op" id="4761437">(</span><span class="op" id="4761438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761442">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761450">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761454">v</span>&nbsp;<span class="op" id="4761456">=</span>&nbsp;<span class="ident" id="4761458">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4761463">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761489">switch</span>&nbsp;<span class="ident" id="4761496">v</span><span class="op" id="4761497">.</span><span class="ident" id="4761498">Kind</span><span class="op" id="4761502">(</span><span class="op" id="4761503">)</span>&nbsp;<span class="op" id="4761505">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761508">case</span>&nbsp;<span class="ident" id="4761513">reflect</span><span class="op" id="4761520">.</span><span class="ident" id="4761521">Interface</span><span class="op" id="4761530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761534">if</span>&nbsp;<span class="ident" id="4761537">v</span><span class="op" id="4761538">.</span><span class="ident" id="4761539">NumMethod</span><span class="op" id="4761548">(</span><span class="op" id="4761549">)</span>&nbsp;<span class="op" id="4761551">==</span>&nbsp;<span class="num" id="4761554">0</span>&nbsp;<span class="op" id="4761556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4761561">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761625">v</span><span class="op" id="4761626">.</span><span class="ident" id="4761627">Set</span><span class="op" id="4761630">(</span><span class="ident" id="4761631">reflect</span><span class="op" id="4761638">.</span><span class="ident" id="4761639">ValueOf</span><span class="op" id="4761646">(</span><span class="ident" id="4761647">d</span><span class="op" id="4761648">.</span><span class="ident" id="4761649">arrayInterface</span><span class="op" id="4761663">(</span><span class="op" id="4761664">)</span><span class="op" id="4761665">)</span><span class="op" id="4761666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761671">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4761684">//&nbsp;Otherwise&nbsp;it&#39;s&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761713">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761726">default</span><span class="op" id="4761733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761737">d</span><span class="op" id="4761738">.</span><span class="ident" id="4761739">saveError</span><span class="op" id="4761748">(</span><span class="op" id="4761749">&amp;</span><span class="ident" id="4761750">UnmarshalTypeError</span><span class="op" id="4761768">{</span><span class="string" id="4761769">&#34;array&#34;</span><span class="op" id="4761776">,</span>&nbsp;<span class="ident" id="4761778">v</span><span class="op" id="4761779">.</span><span class="ident" id="4761780">Type</span><span class="op" id="4761784">(</span><span class="op" id="4761785">)</span><span class="op" id="4761786">}</span><span class="op" id="4761787">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761791">d</span><span class="op" id="4761792">.</span><span class="ident" id="4761793">off</span><span class="op" id="4761796">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761801">d</span><span class="op" id="4761802">.</span><span class="ident" id="4761803">next</span><span class="op" id="4761807">(</span><span class="op" id="4761808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761812">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761820">case</span>&nbsp;<span class="ident" id="4761825">reflect</span><span class="op" id="4761832">.</span><span class="ident" id="4761833">Array</span><span class="op" id="4761838">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761841">case</span>&nbsp;<span class="ident" id="4761846">reflect</span><span class="op" id="4761853">.</span><span class="ident" id="4761854">Slice</span><span class="op" id="4761859">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761863">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761874">i</span>&nbsp;<span class="op" id="4761876">:=</span>&nbsp;<span class="num" id="4761879">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761882">for</span>&nbsp;<span class="op" id="4761886">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4761890">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761950">op</span>&nbsp;<span class="op" id="4761953">:=</span>&nbsp;<span class="ident" id="4761956">d</span><span class="op" id="4761957">.</span><span class="ident" id="4761958">scanWhile</span><span class="op" id="4761967">(</span><span class="ident" id="4761968">scanSkipSpace</span><span class="op" id="4761981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761985">if</span>&nbsp;<span class="ident" id="4761988">op</span>&nbsp;<span class="op" id="4761991">==</span>&nbsp;<span class="ident" id="4761994">scanEndArray</span>&nbsp;<span class="op" id="4762007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762012">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762020">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762025">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762081">d</span><span class="op" id="4762082">.</span><span class="ident" id="4762083">off</span><span class="op" id="4762086">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762091">d</span><span class="op" id="4762092">.</span><span class="ident" id="4762093">scan</span><span class="op" id="4762097">.</span><span class="ident" id="4762098">undo</span><span class="op" id="4762102">(</span><span class="ident" id="4762103">op</span><span class="op" id="4762105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762110">//&nbsp;Get&nbsp;element&nbsp;of&nbsp;array,&nbsp;growing&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762159">if</span>&nbsp;<span class="ident" id="4762162">v</span><span class="op" id="4762163">.</span><span class="ident" id="4762164">Kind</span><span class="op" id="4762168">(</span><span class="op" id="4762169">)</span>&nbsp;<span class="op" id="4762171">==</span>&nbsp;<span class="ident" id="4762174">reflect</span><span class="op" id="4762181">.</span><span class="ident" id="4762182">Slice</span>&nbsp;<span class="op" id="4762188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762193">//&nbsp;Grow&nbsp;slice&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762223">if</span>&nbsp;<span class="ident" id="4762226">i</span>&nbsp;<span class="op" id="4762228">&gt;=</span>&nbsp;<span class="ident" id="4762231">v</span><span class="op" id="4762232">.</span><span class="ident" id="4762233">Cap</span><span class="op" id="4762236">(</span><span class="op" id="4762237">)</span>&nbsp;<span class="op" id="4762239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762245">newcap</span>&nbsp;<span class="op" id="4762252">:=</span>&nbsp;<span class="ident" id="4762255">v</span><span class="op" id="4762256">.</span><span class="ident" id="4762257">Cap</span><span class="op" id="4762260">(</span><span class="op" id="4762261">)</span>&nbsp;<span class="op" id="4762263">+</span>&nbsp;<span class="ident" id="4762265">v</span><span class="op" id="4762266">.</span><span class="ident" id="4762267">Cap</span><span class="op" id="4762270">(</span><span class="op" id="4762271">)</span><span class="op" id="4762272">/</span><span class="num" id="4762273">2</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762279">if</span>&nbsp;<span class="ident" id="4762282">newcap</span>&nbsp;<span class="op" id="4762289">&lt;</span>&nbsp;<span class="num" id="4762291">4</span>&nbsp;<span class="op" id="4762293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762300">newcap</span>&nbsp;<span class="op" id="4762307">=</span>&nbsp;<span class="num" id="4762309">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762321">newv</span>&nbsp;<span class="op" id="4762326">:=</span>&nbsp;<span class="ident" id="4762329">reflect</span><span class="op" id="4762336">.</span><span class="ident" id="4762337">MakeSlice</span><span class="op" id="4762346">(</span><span class="ident" id="4762347">v</span><span class="op" id="4762348">.</span><span class="ident" id="4762349">Type</span><span class="op" id="4762353">(</span><span class="op" id="4762354">)</span><span class="op" id="4762355">,</span>&nbsp;<span class="ident" id="4762357">v</span><span class="op" id="4762358">.</span><span class="ident" id="4762359">Len</span><span class="op" id="4762362">(</span><span class="op" id="4762363">)</span><span class="op" id="4762364">,</span>&nbsp;<span class="ident" id="4762366">newcap</span><span class="op" id="4762372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762378">reflect</span><span class="op" id="4762385">.</span><span class="ident" id="4762386">Copy</span><span class="op" id="4762390">(</span><span class="ident" id="4762391">newv</span><span class="op" id="4762395">,</span>&nbsp;<span class="ident" id="4762397">v</span><span class="op" id="4762398">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762404">v</span><span class="op" id="4762405">.</span><span class="ident" id="4762406">Set</span><span class="op" id="4762409">(</span><span class="ident" id="4762410">newv</span><span class="op" id="4762414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762424">if</span>&nbsp;<span class="ident" id="4762427">i</span>&nbsp;<span class="op" id="4762429">&gt;=</span>&nbsp;<span class="ident" id="4762432">v</span><span class="op" id="4762433">.</span><span class="ident" id="4762434">Len</span><span class="op" id="4762437">(</span><span class="op" id="4762438">)</span>&nbsp;<span class="op" id="4762440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762446">v</span><span class="op" id="4762447">.</span><span class="ident" id="4762448">SetLen</span><span class="op" id="4762454">(</span><span class="ident" id="4762455">i</span>&nbsp;<span class="op" id="4762457">+</span>&nbsp;<span class="num" id="4762459">1</span><span class="op" id="4762460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762465">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762474">if</span>&nbsp;<span class="ident" id="4762477">i</span>&nbsp;<span class="op" id="4762479">&lt;</span>&nbsp;<span class="ident" id="4762481">v</span><span class="op" id="4762482">.</span><span class="ident" id="4762483">Len</span><span class="op" id="4762486">(</span><span class="op" id="4762487">)</span>&nbsp;<span class="op" id="4762489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762494">//&nbsp;Decode&nbsp;into&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762521">d</span><span class="op" id="4762522">.</span><span class="ident" id="4762523">value</span><span class="op" id="4762528">(</span><span class="ident" id="4762529">v</span><span class="op" id="4762530">.</span><span class="ident" id="4762531">Index</span><span class="op" id="4762536">(</span><span class="ident" id="4762537">i</span><span class="op" id="4762538">)</span><span class="op" id="4762539">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762543">}</span>&nbsp;<span class="keyword" id="4762545">else</span>&nbsp;<span class="op" id="4762550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762555">//&nbsp;Ran&nbsp;out&nbsp;of&nbsp;fixed&nbsp;array:&nbsp;skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762591">d</span><span class="op" id="4762592">.</span><span class="ident" id="4762593">value</span><span class="op" id="4762598">(</span><span class="ident" id="4762599">reflect</span><span class="op" id="4762606">.</span><span class="ident" id="4762607">Value</span><span class="op" id="4762612">{</span><span class="op" id="4762613">}</span><span class="op" id="4762614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762622">i</span><span class="op" id="4762623">++</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762629">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762661">op</span>&nbsp;<span class="op" id="4762664">=</span>&nbsp;<span class="ident" id="4762666">d</span><span class="op" id="4762667">.</span><span class="ident" id="4762668">scanWhile</span><span class="op" id="4762677">(</span><span class="ident" id="4762678">scanSkipSpace</span><span class="op" id="4762691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762695">if</span>&nbsp;<span class="ident" id="4762698">op</span>&nbsp;<span class="op" id="4762701">==</span>&nbsp;<span class="ident" id="4762704">scanEndArray</span>&nbsp;<span class="op" id="4762717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762722">break</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762734">if</span>&nbsp;<span class="ident" id="4762737">op</span>&nbsp;<span class="op" id="4762740">!=</span>&nbsp;<span class="ident" id="4762743">scanArrayValue</span>&nbsp;<span class="op" id="4762758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762763">d</span><span class="op" id="4762764">.</span><span class="builtintype" id="4762765">error</span><span class="op" id="4762770">(</span><span class="ident" id="4762771">errPhase</span><span class="op" id="4762779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762786">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762790">if</span>&nbsp;<span class="ident" id="4762793">i</span>&nbsp;<span class="op" id="4762795">&lt;</span>&nbsp;<span class="ident" id="4762797">v</span><span class="op" id="4762798">.</span><span class="ident" id="4762799">Len</span><span class="op" id="4762802">(</span><span class="op" id="4762803">)</span>&nbsp;<span class="op" id="4762805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762809">if</span>&nbsp;<span class="ident" id="4762812">v</span><span class="op" id="4762813">.</span><span class="ident" id="4762814">Kind</span><span class="op" id="4762818">(</span><span class="op" id="4762819">)</span>&nbsp;<span class="op" id="4762821">==</span>&nbsp;<span class="ident" id="4762824">reflect</span><span class="op" id="4762831">.</span><span class="ident" id="4762832">Array</span>&nbsp;<span class="op" id="4762838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762843">//&nbsp;Array.&nbsp;&nbsp;Zero&nbsp;the&nbsp;rest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762872">z</span>&nbsp;<span class="op" id="4762874">:=</span>&nbsp;<span class="ident" id="4762877">reflect</span><span class="op" id="4762884">.</span><span class="ident" id="4762885">Zero</span><span class="op" id="4762889">(</span><span class="ident" id="4762890">v</span><span class="op" id="4762891">.</span><span class="ident" id="4762892">Type</span><span class="op" id="4762896">(</span><span class="op" id="4762897">)</span><span class="op" id="4762898">.</span><span class="ident" id="4762899">Elem</span><span class="op" id="4762903">(</span><span class="op" id="4762904">)</span><span class="op" id="4762905">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762910">for</span>&nbsp;<span class="op" id="4762914">;</span>&nbsp;<span class="ident" id="4762916">i</span>&nbsp;<span class="op" id="4762918">&lt;</span>&nbsp;<span class="ident" id="4762920">v</span><span class="op" id="4762921">.</span><span class="ident" id="4762922">Len</span><span class="op" id="4762925">(</span><span class="op" id="4762926">)</span><span class="op" id="4762927">;</span>&nbsp;<span class="ident" id="4762929">i</span><span class="op" id="4762930">++</span>&nbsp;<span class="op" id="4762933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762939">v</span><span class="op" id="4762940">.</span><span class="ident" id="4762941">Index</span><span class="op" id="4762946">(</span><span class="ident" id="4762947">i</span><span class="op" id="4762948">)</span><span class="op" id="4762949">.</span><span class="ident" id="4762950">Set</span><span class="op" id="4762953">(</span><span class="ident" id="4762954">z</span><span class="op" id="4762955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762964">}</span>&nbsp;<span class="keyword" id="4762966">else</span>&nbsp;<span class="op" id="4762971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762976">v</span><span class="op" id="4762977">.</span><span class="ident" id="4762978">SetLen</span><span class="op" id="4762984">(</span><span class="ident" id="4762985">i</span><span class="op" id="4762986">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762996">if</span>&nbsp;<span class="ident" id="4762999">i</span>&nbsp;<span class="op" id="4763001">==</span>&nbsp;<span class="num" id="4763004">0</span>&nbsp;<span class="op" id="4763006">&amp;&amp;</span>&nbsp;<span class="ident" id="4763009">v</span><span class="op" id="4763010">.</span><span class="ident" id="4763011">Kind</span><span class="op" id="4763015">(</span><span class="op" id="4763016">)</span>&nbsp;<span class="op" id="4763018">==</span>&nbsp;<span class="ident" id="4763021">reflect</span><span class="op" id="4763028">.</span><span class="ident" id="4763029">Slice</span>&nbsp;<span class="op" id="4763035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763039">v</span><span class="op" id="4763040">.</span><span class="ident" id="4763041">Set</span><span class="op" id="4763044">(</span><span class="ident" id="4763045">reflect</span><span class="op" id="4763052">.</span><span class="ident" id="4763053">MakeSlice</span><span class="op" id="4763062">(</span><span class="ident" id="4763063">v</span><span class="op" id="4763064">.</span><span class="ident" id="4763065">Type</span><span class="op" id="4763069">(</span><span class="op" id="4763070">)</span><span class="op" id="4763071">,</span>&nbsp;<span class="num" id="4763073">0</span><span class="op" id="4763074">,</span>&nbsp;<span class="num" id="4763076">0</span><span class="op" id="4763077">)</span><span class="op" id="4763078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763081">}</span><br>
<span class="lineno">470</span><span class="op" id="4763083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4763086">var</span>&nbsp;<span class="ident" id="4763090">nullLiteral</span>&nbsp;<span class="op" id="4763102">=</span>&nbsp;<span class="op" id="4763104">[</span><span class="op" id="4763105">]</span><span class="builtintype" id="4763106">byte</span><span class="op" id="4763110">(</span><span class="string" id="4763111">&#34;null&#34;</span><span class="op" id="4763117">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4763120">//&nbsp;object&nbsp;consumes&nbsp;an&nbsp;object&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno">475</span><span class="comment" id="4763199">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;(&#39;{&#39;)&nbsp;of&nbsp;the&nbsp;object&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="4763260">func</span>&nbsp;<span class="op" id="4763265">(</span><span class="ident" id="4763266">d</span>&nbsp;<span class="op" id="4763268">*</span><span class="ident" id="4763269">decodeState</span><span class="op" id="4763280">)</span>&nbsp;<span class="ident" id="4763282">object</span><span class="op" id="4763288">(</span><span class="ident" id="4763289">v</span>&nbsp;<span class="ident" id="4763291">reflect</span><span class="op" id="4763298">.</span><span class="ident" id="4763299">Value</span><span class="op" id="4763304">)</span>&nbsp;<span class="op" id="4763306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763309">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763336">u</span><span class="op" id="4763337">,</span>&nbsp;<span class="ident" id="4763339">ut</span><span class="op" id="4763341">,</span>&nbsp;<span class="ident" id="4763343">pv</span>&nbsp;<span class="op" id="4763346">:=</span>&nbsp;<span class="ident" id="4763349">d</span><span class="op" id="4763350">.</span><span class="ident" id="4763351">indirect</span><span class="op" id="4763359">(</span><span class="ident" id="4763360">v</span><span class="op" id="4763361">,</span>&nbsp;<span class="builtintype" id="4763363">false</span><span class="op" id="4763368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763371">if</span>&nbsp;<span class="ident" id="4763374">u</span>&nbsp;<span class="op" id="4763376">!=</span>&nbsp;<span class="ident" id="4763379">nil</span>&nbsp;<span class="op" id="4763383">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763387">d</span><span class="op" id="4763388">.</span><span class="ident" id="4763389">off</span><span class="op" id="4763392">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763397">err</span>&nbsp;<span class="op" id="4763401">:=</span>&nbsp;<span class="ident" id="4763404">u</span><span class="op" id="4763405">.</span><span class="ident" id="4763406">UnmarshalJSON</span><span class="op" id="4763419">(</span><span class="ident" id="4763420">d</span><span class="op" id="4763421">.</span><span class="ident" id="4763422">next</span><span class="op" id="4763426">(</span><span class="op" id="4763427">)</span><span class="op" id="4763428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763432">if</span>&nbsp;<span class="ident" id="4763435">err</span>&nbsp;<span class="op" id="4763439">!=</span>&nbsp;<span class="ident" id="4763442">nil</span>&nbsp;<span class="op" id="4763446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763451">d</span><span class="op" id="4763452">.</span><span class="builtintype" id="4763453">error</span><span class="op" id="4763458">(</span><span class="ident" id="4763459">err</span><span class="op" id="4763462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763466">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763470">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763481">if</span>&nbsp;<span class="ident" id="4763484">ut</span>&nbsp;<span class="op" id="4763487">!=</span>&nbsp;<span class="ident" id="4763490">nil</span>&nbsp;<span class="op" id="4763494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763498">d</span><span class="op" id="4763499">.</span><span class="ident" id="4763500">saveError</span><span class="op" id="4763509">(</span><span class="op" id="4763510">&amp;</span><span class="ident" id="4763511">UnmarshalTypeError</span><span class="op" id="4763529">{</span><span class="string" id="4763530">&#34;object&#34;</span><span class="op" id="4763538">,</span>&nbsp;<span class="ident" id="4763540">v</span><span class="op" id="4763541">.</span><span class="ident" id="4763542">Type</span><span class="op" id="4763546">(</span><span class="op" id="4763547">)</span><span class="op" id="4763548">}</span><span class="op" id="4763549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763553">d</span><span class="op" id="4763554">.</span><span class="ident" id="4763555">off</span><span class="op" id="4763558">--</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763563">d</span><span class="op" id="4763564">.</span><span class="ident" id="4763565">next</span><span class="op" id="4763569">(</span><span class="op" id="4763570">)</span>&nbsp;<span class="comment" id="4763572">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763600">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763611">v</span>&nbsp;<span class="op" id="4763613">=</span>&nbsp;<span class="ident" id="4763615">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763620">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763682">if</span>&nbsp;<span class="ident" id="4763685">v</span><span class="op" id="4763686">.</span><span class="ident" id="4763687">Kind</span><span class="op" id="4763691">(</span><span class="op" id="4763692">)</span>&nbsp;<span class="op" id="4763694">==</span>&nbsp;<span class="ident" id="4763697">reflect</span><span class="op" id="4763704">.</span><span class="ident" id="4763705">Interface</span>&nbsp;<span class="op" id="4763715">&amp;&amp;</span>&nbsp;<span class="ident" id="4763718">v</span><span class="op" id="4763719">.</span><span class="ident" id="4763720">NumMethod</span><span class="op" id="4763729">(</span><span class="op" id="4763730">)</span>&nbsp;<span class="op" id="4763732">==</span>&nbsp;<span class="num" id="4763735">0</span>&nbsp;<span class="op" id="4763737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763741">v</span><span class="op" id="4763742">.</span><span class="ident" id="4763743">Set</span><span class="op" id="4763746">(</span><span class="ident" id="4763747">reflect</span><span class="op" id="4763754">.</span><span class="ident" id="4763755">ValueOf</span><span class="op" id="4763762">(</span><span class="ident" id="4763763">d</span><span class="op" id="4763764">.</span><span class="ident" id="4763765">objectInterface</span><span class="op" id="4763780">(</span><span class="op" id="4763781">)</span><span class="op" id="4763782">)</span><span class="op" id="4763783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763787">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763795">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763799">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target:&nbsp;struct&nbsp;or&nbsp;map[string]T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763848">switch</span>&nbsp;<span class="ident" id="4763855">v</span><span class="op" id="4763856">.</span><span class="ident" id="4763857">Kind</span><span class="op" id="4763861">(</span><span class="op" id="4763862">)</span>&nbsp;<span class="op" id="4763864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763867">case</span>&nbsp;<span class="ident" id="4763872">reflect</span><span class="op" id="4763879">.</span><span class="ident" id="4763880">Map</span><span class="op" id="4763883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763887">//&nbsp;map&nbsp;must&nbsp;have&nbsp;string&nbsp;kind</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763918">t</span>&nbsp;<span class="op" id="4763920">:=</span>&nbsp;<span class="ident" id="4763923">v</span><span class="op" id="4763924">.</span><span class="ident" id="4763925">Type</span><span class="op" id="4763929">(</span><span class="op" id="4763930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763934">if</span>&nbsp;<span class="ident" id="4763937">t</span><span class="op" id="4763938">.</span><span class="ident" id="4763939">Key</span><span class="op" id="4763942">(</span><span class="op" id="4763943">)</span><span class="op" id="4763944">.</span><span class="ident" id="4763945">Kind</span><span class="op" id="4763949">(</span><span class="op" id="4763950">)</span>&nbsp;<span class="op" id="4763952">!=</span>&nbsp;<span class="ident" id="4763955">reflect</span><span class="op" id="4763962">.</span><span class="ident" id="4763963">String</span>&nbsp;<span class="op" id="4763970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763975">d</span><span class="op" id="4763976">.</span><span class="ident" id="4763977">saveError</span><span class="op" id="4763986">(</span><span class="op" id="4763987">&amp;</span><span class="ident" id="4763988">UnmarshalTypeError</span><span class="op" id="4764006">{</span><span class="string" id="4764007">&#34;object&#34;</span><span class="op" id="4764015">,</span>&nbsp;<span class="ident" id="4764017">v</span><span class="op" id="4764018">.</span><span class="ident" id="4764019">Type</span><span class="op" id="4764023">(</span><span class="op" id="4764024">)</span><span class="op" id="4764025">}</span><span class="op" id="4764026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764031">d</span><span class="op" id="4764032">.</span><span class="ident" id="4764033">off</span><span class="op" id="4764036">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764042">d</span><span class="op" id="4764043">.</span><span class="ident" id="4764044">next</span><span class="op" id="4764048">(</span><span class="op" id="4764049">)</span>&nbsp;<span class="comment" id="4764051">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764080">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4764089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764093">if</span>&nbsp;<span class="ident" id="4764096">v</span><span class="op" id="4764097">.</span><span class="ident" id="4764098">IsNil</span><span class="op" id="4764103">(</span><span class="op" id="4764104">)</span>&nbsp;<span class="op" id="4764106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764111">v</span><span class="op" id="4764112">.</span><span class="ident" id="4764113">Set</span><span class="op" id="4764116">(</span><span class="ident" id="4764117">reflect</span><span class="op" id="4764124">.</span><span class="ident" id="4764125">MakeMap</span><span class="op" id="4764132">(</span><span class="ident" id="4764133">t</span><span class="op" id="4764134">)</span><span class="op" id="4764135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4764139">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764142">case</span>&nbsp;<span class="ident" id="4764147">reflect</span><span class="op" id="4764154">.</span><span class="ident" id="4764155">Struct</span><span class="op" id="4764161">:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764165">default</span><span class="op" id="4764172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764176">d</span><span class="op" id="4764177">.</span><span class="ident" id="4764178">saveError</span><span class="op" id="4764187">(</span><span class="op" id="4764188">&amp;</span><span class="ident" id="4764189">UnmarshalTypeError</span><span class="op" id="4764207">{</span><span class="string" id="4764208">&#34;object&#34;</span><span class="op" id="4764216">,</span>&nbsp;<span class="ident" id="4764218">v</span><span class="op" id="4764219">.</span><span class="ident" id="4764220">Type</span><span class="op" id="4764224">(</span><span class="op" id="4764225">)</span><span class="op" id="4764226">}</span><span class="op" id="4764227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764231">d</span><span class="op" id="4764232">.</span><span class="ident" id="4764233">off</span><span class="op" id="4764236">--</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764241">d</span><span class="op" id="4764242">.</span><span class="ident" id="4764243">next</span><span class="op" id="4764247">(</span><span class="op" id="4764248">)</span>&nbsp;<span class="comment" id="4764250">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764278">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4764286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764290">var</span>&nbsp;<span class="ident" id="4764294">mapElem</span>&nbsp;<span class="ident" id="4764302">reflect</span><span class="op" id="4764309">.</span><span class="ident" id="4764310">Value</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764318">for</span>&nbsp;<span class="op" id="4764322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4764326">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764374">op</span>&nbsp;<span class="op" id="4764377">:=</span>&nbsp;<span class="ident" id="4764380">d</span><span class="op" id="4764381">.</span><span class="ident" id="4764382">scanWhile</span><span class="op" id="4764391">(</span><span class="ident" id="4764392">scanSkipSpace</span><span class="op" id="4764405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764409">if</span>&nbsp;<span class="ident" id="4764412">op</span>&nbsp;<span class="op" id="4764415">==</span>&nbsp;<span class="ident" id="4764418">scanEndObject</span>&nbsp;<span class="op" id="4764432">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4764437">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764491">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4764499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764503">if</span>&nbsp;<span class="ident" id="4764506">op</span>&nbsp;<span class="op" id="4764509">!=</span>&nbsp;<span class="ident" id="4764512">scanBeginLiteral</span>&nbsp;<span class="op" id="4764529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764534">d</span><span class="op" id="4764535">.</span><span class="builtintype" id="4764536">error</span><span class="op" id="4764541">(</span><span class="ident" id="4764542">errPhase</span><span class="op" id="4764550">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4764554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4764559">//&nbsp;Read&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764574">start</span>&nbsp;<span class="op" id="4764580">:=</span>&nbsp;<span class="ident" id="4764583">d</span><span class="op" id="4764584">.</span><span class="ident" id="4764585">off</span>&nbsp;<span class="op" id="4764589">-</span>&nbsp;<span class="num" id="4764591">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764595">op</span>&nbsp;<span class="op" id="4764598">=</span>&nbsp;<span class="ident" id="4764600">d</span><span class="op" id="4764601">.</span><span class="ident" id="4764602">scanWhile</span><span class="op" id="4764611">(</span><span class="ident" id="4764612">scanContinue</span><span class="op" id="4764624">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764628">item</span>&nbsp;<span class="op" id="4764633">:=</span>&nbsp;<span class="ident" id="4764636">d</span><span class="op" id="4764637">.</span><span class="ident" id="4764638">data</span><span class="op" id="4764642">[</span><span class="ident" id="4764643">start</span>&nbsp;<span class="op" id="4764649">:</span>&nbsp;<span class="ident" id="4764651">d</span><span class="op" id="4764652">.</span><span class="ident" id="4764653">off</span><span class="op" id="4764656">-</span><span class="num" id="4764657">1</span><span class="op" id="4764658">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764662">key</span><span class="op" id="4764665">,</span>&nbsp;<span class="ident" id="4764667">ok</span>&nbsp;<span class="op" id="4764670">:=</span>&nbsp;<span class="ident" id="4764673">unquoteBytes</span><span class="op" id="4764685">(</span><span class="ident" id="4764686">item</span><span class="op" id="4764690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764694">if</span>&nbsp;<span class="op" id="4764697">!</span><span class="ident" id="4764698">ok</span>&nbsp;<span class="op" id="4764701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764706">d</span><span class="op" id="4764707">.</span><span class="builtintype" id="4764708">error</span><span class="op" id="4764713">(</span><span class="ident" id="4764714">errPhase</span><span class="op" id="4764722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4764726">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4764731">//&nbsp;Figure&nbsp;out&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764775">var</span>&nbsp;<span class="ident" id="4764779">subv</span>&nbsp;<span class="ident" id="4764784">reflect</span><span class="op" id="4764791">.</span><span class="ident" id="4764792">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764800">destring</span>&nbsp;<span class="op" id="4764809">:=</span>&nbsp;<span class="builtintype" id="4764812">false</span>&nbsp;<span class="comment" id="4764818">//&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;wrapped&nbsp;in&nbsp;a&nbsp;string&nbsp;to&nbsp;be&nbsp;decoded&nbsp;first</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764885">if</span>&nbsp;<span class="ident" id="4764888">v</span><span class="op" id="4764889">.</span><span class="ident" id="4764890">Kind</span><span class="op" id="4764894">(</span><span class="op" id="4764895">)</span>&nbsp;<span class="op" id="4764897">==</span>&nbsp;<span class="ident" id="4764900">reflect</span><span class="op" id="4764907">.</span><span class="ident" id="4764908">Map</span>&nbsp;<span class="op" id="4764912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764917">elemType</span>&nbsp;<span class="op" id="4764926">:=</span>&nbsp;<span class="ident" id="4764929">v</span><span class="op" id="4764930">.</span><span class="ident" id="4764931">Type</span><span class="op" id="4764935">(</span><span class="op" id="4764936">)</span><span class="op" id="4764937">.</span><span class="ident" id="4764938">Elem</span><span class="op" id="4764942">(</span><span class="op" id="4764943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764948">if</span>&nbsp;<span class="op" id="4764951">!</span><span class="ident" id="4764952">mapElem</span><span class="op" id="4764959">.</span><span class="ident" id="4764960">IsValid</span><span class="op" id="4764967">(</span><span class="op" id="4764968">)</span>&nbsp;<span class="op" id="4764970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764976">mapElem</span>&nbsp;<span class="op" id="4764984">=</span>&nbsp;<span class="ident" id="4764986">reflect</span><span class="op" id="4764993">.</span><span class="ident" id="4764994">New</span><span class="op" id="4764997">(</span><span class="ident" id="4764998">elemType</span><span class="op" id="4765006">)</span><span class="op" id="4765007">.</span><span class="ident" id="4765008">Elem</span><span class="op" id="4765012">(</span><span class="op" id="4765013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765018">}</span>&nbsp;<span class="keyword" id="4765020">else</span>&nbsp;<span class="op" id="4765025">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765031">mapElem</span><span class="op" id="4765038">.</span><span class="ident" id="4765039">Set</span><span class="op" id="4765042">(</span><span class="ident" id="4765043">reflect</span><span class="op" id="4765050">.</span><span class="ident" id="4765051">Zero</span><span class="op" id="4765055">(</span><span class="ident" id="4765056">elemType</span><span class="op" id="4765064">)</span><span class="op" id="4765065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765075">subv</span>&nbsp;<span class="op" id="4765080">=</span>&nbsp;<span class="ident" id="4765082">mapElem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765092">}</span>&nbsp;<span class="keyword" id="4765094">else</span>&nbsp;<span class="op" id="4765099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765104">var</span>&nbsp;<span class="ident" id="4765108">f</span>&nbsp;<span class="op" id="4765110">*</span><span class="ident" id="4765111">field</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765120">fields</span>&nbsp;<span class="op" id="4765127">:=</span>&nbsp;<span class="ident" id="4765130">cachedTypeFields</span><span class="op" id="4765146">(</span><span class="ident" id="4765147">v</span><span class="op" id="4765148">.</span><span class="ident" id="4765149">Type</span><span class="op" id="4765153">(</span><span class="op" id="4765154">)</span><span class="op" id="4765155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765160">for</span>&nbsp;<span class="ident" id="4765164">i</span>&nbsp;<span class="op" id="4765166">:=</span>&nbsp;<span class="keyword" id="4765169">range</span>&nbsp;<span class="ident" id="4765175">fields</span>&nbsp;<span class="op" id="4765182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765188">ff</span>&nbsp;<span class="op" id="4765191">:=</span>&nbsp;<span class="op" id="4765194">&amp;</span><span class="ident" id="4765195">fields</span><span class="op" id="4765201">[</span><span class="ident" id="4765202">i</span><span class="op" id="4765203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765209">if</span>&nbsp;<span class="ident" id="4765212">bytes</span><span class="op" id="4765217">.</span><span class="ident" id="4765218">Equal</span><span class="op" id="4765223">(</span><span class="ident" id="4765224">ff</span><span class="op" id="4765226">.</span><span class="ident" id="4765227">nameBytes</span><span class="op" id="4765236">,</span>&nbsp;<span class="ident" id="4765238">key</span><span class="op" id="4765241">)</span>&nbsp;<span class="op" id="4765243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765250">f</span>&nbsp;<span class="op" id="4765252">=</span>&nbsp;<span class="ident" id="4765254">ff</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765262">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765278">if</span>&nbsp;<span class="ident" id="4765281">f</span>&nbsp;<span class="op" id="4765283">==</span>&nbsp;<span class="ident" id="4765286">nil</span>&nbsp;<span class="op" id="4765290">&amp;&amp;</span>&nbsp;<span class="ident" id="4765293">ff</span><span class="op" id="4765295">.</span><span class="ident" id="4765296">equalFold</span><span class="op" id="4765305">(</span><span class="ident" id="4765306">ff</span><span class="op" id="4765308">.</span><span class="ident" id="4765309">nameBytes</span><span class="op" id="4765318">,</span>&nbsp;<span class="ident" id="4765320">key</span><span class="op" id="4765323">)</span>&nbsp;<span class="op" id="4765325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765332">f</span>&nbsp;<span class="op" id="4765334">=</span>&nbsp;<span class="ident" id="4765336">ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765343">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765353">if</span>&nbsp;<span class="ident" id="4765356">f</span>&nbsp;<span class="op" id="4765358">!=</span>&nbsp;<span class="ident" id="4765361">nil</span>&nbsp;<span class="op" id="4765365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765371">subv</span>&nbsp;<span class="op" id="4765376">=</span>&nbsp;<span class="ident" id="4765378">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765384">destring</span>&nbsp;<span class="op" id="4765393">=</span>&nbsp;<span class="ident" id="4765395">f</span><span class="op" id="4765396">.</span><span class="ident" id="4765397">quoted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765408">for</span>&nbsp;<span class="ident" id="4765412">_</span><span class="op" id="4765413">,</span>&nbsp;<span class="ident" id="4765415">i</span>&nbsp;<span class="op" id="4765417">:=</span>&nbsp;<span class="keyword" id="4765420">range</span>&nbsp;<span class="ident" id="4765426">f</span><span class="op" id="4765427">.</span><span class="ident" id="4765428">index</span>&nbsp;<span class="op" id="4765434">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765441">if</span>&nbsp;<span class="ident" id="4765444">subv</span><span class="op" id="4765448">.</span><span class="ident" id="4765449">Kind</span><span class="op" id="4765453">(</span><span class="op" id="4765454">)</span>&nbsp;<span class="op" id="4765456">==</span>&nbsp;<span class="ident" id="4765459">reflect</span><span class="op" id="4765466">.</span><span class="ident" id="4765467">Ptr</span>&nbsp;<span class="op" id="4765471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765479">if</span>&nbsp;<span class="ident" id="4765482">subv</span><span class="op" id="4765486">.</span><span class="ident" id="4765487">IsNil</span><span class="op" id="4765492">(</span><span class="op" id="4765493">)</span>&nbsp;<span class="op" id="4765495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765504">subv</span><span class="op" id="4765508">.</span><span class="ident" id="4765509">Set</span><span class="op" id="4765512">(</span><span class="ident" id="4765513">reflect</span><span class="op" id="4765520">.</span><span class="ident" id="4765521">New</span><span class="op" id="4765524">(</span><span class="ident" id="4765525">subv</span><span class="op" id="4765529">.</span><span class="ident" id="4765530">Type</span><span class="op" id="4765534">(</span><span class="op" id="4765535">)</span><span class="op" id="4765536">.</span><span class="ident" id="4765537">Elem</span><span class="op" id="4765541">(</span><span class="op" id="4765542">)</span><span class="op" id="4765543">)</span><span class="op" id="4765544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765560">subv</span>&nbsp;<span class="op" id="4765565">=</span>&nbsp;<span class="ident" id="4765567">subv</span><span class="op" id="4765571">.</span><span class="ident" id="4765572">Elem</span><span class="op" id="4765576">(</span><span class="op" id="4765577">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765591">subv</span>&nbsp;<span class="op" id="4765596">=</span>&nbsp;<span class="ident" id="4765598">subv</span><span class="op" id="4765602">.</span><span class="ident" id="4765603">Field</span><span class="op" id="4765608">(</span><span class="ident" id="4765609">i</span><span class="op" id="4765610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765625">}</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765630">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765656">if</span>&nbsp;<span class="ident" id="4765659">op</span>&nbsp;<span class="op" id="4765662">==</span>&nbsp;<span class="ident" id="4765665">scanSkipSpace</span>&nbsp;<span class="op" id="4765679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765684">op</span>&nbsp;<span class="op" id="4765687">=</span>&nbsp;<span class="ident" id="4765689">d</span><span class="op" id="4765690">.</span><span class="ident" id="4765691">scanWhile</span><span class="op" id="4765700">(</span><span class="ident" id="4765701">scanSkipSpace</span><span class="op" id="4765714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765718">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765722">if</span>&nbsp;<span class="ident" id="4765725">op</span>&nbsp;<span class="op" id="4765728">!=</span>&nbsp;<span class="ident" id="4765731">scanObjectKey</span>&nbsp;<span class="op" id="4765745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765750">d</span><span class="op" id="4765751">.</span><span class="builtintype" id="4765752">error</span><span class="op" id="4765757">(</span><span class="ident" id="4765758">errPhase</span><span class="op" id="4765766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765775">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765792">if</span>&nbsp;<span class="ident" id="4765795">destring</span>&nbsp;<span class="op" id="4765804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765809">switch</span>&nbsp;<span class="ident" id="4765816">qv</span>&nbsp;<span class="op" id="4765819">:=</span>&nbsp;<span class="ident" id="4765822">d</span><span class="op" id="4765823">.</span><span class="ident" id="4765824">valueQuoted</span><span class="op" id="4765835">(</span><span class="op" id="4765836">)</span><span class="op" id="4765837">.</span><span class="op" id="4765838">(</span><span class="keyword" id="4765839">type</span><span class="op" id="4765843">)</span>&nbsp;<span class="op" id="4765845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765850">case</span>&nbsp;<span class="ident" id="4765855">nil</span><span class="op" id="4765858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765864">d</span><span class="op" id="4765865">.</span><span class="ident" id="4765866">literalStore</span><span class="op" id="4765878">(</span><span class="ident" id="4765879">nullLiteral</span><span class="op" id="4765890">,</span>&nbsp;<span class="ident" id="4765892">subv</span><span class="op" id="4765896">,</span>&nbsp;<span class="builtintype" id="4765898">false</span><span class="op" id="4765903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765908">case</span>&nbsp;<span class="builtintype" id="4765913">string</span><span class="op" id="4765919">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765925">d</span><span class="op" id="4765926">.</span><span class="ident" id="4765927">literalStore</span><span class="op" id="4765939">(</span><span class="op" id="4765940">[</span><span class="op" id="4765941">]</span><span class="builtintype" id="4765942">byte</span><span class="op" id="4765946">(</span><span class="ident" id="4765947">qv</span><span class="op" id="4765949">)</span><span class="op" id="4765950">,</span>&nbsp;<span class="ident" id="4765952">subv</span><span class="op" id="4765956">,</span>&nbsp;<span class="builtintype" id="4765958">true</span><span class="op" id="4765962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765967">default</span><span class="op" id="4765974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765980">d</span><span class="op" id="4765981">.</span><span class="ident" id="4765982">saveError</span><span class="op" id="4765991">(</span><span class="ident" id="4765992">fmt</span><span class="op" id="4765995">.</span><span class="ident" id="4765996">Errorf</span><span class="op" id="4766002">(</span><span class="string" id="4766003">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;unquoted&nbsp;value&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4766088">,</span>&nbsp;<span class="ident" id="4766090">item</span><span class="op" id="4766094">,</span>&nbsp;<span class="ident" id="4766096">v</span><span class="op" id="4766097">.</span><span class="ident" id="4766098">Type</span><span class="op" id="4766102">(</span><span class="op" id="4766103">)</span><span class="op" id="4766104">)</span><span class="op" id="4766105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766114">}</span>&nbsp;<span class="keyword" id="4766116">else</span>&nbsp;<span class="op" id="4766121">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766126">d</span><span class="op" id="4766127">.</span><span class="ident" id="4766128">value</span><span class="op" id="4766133">(</span><span class="ident" id="4766134">subv</span><span class="op" id="4766138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4766147">//&nbsp;Write&nbsp;value&nbsp;back&nbsp;to&nbsp;map;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4766177">//&nbsp;if&nbsp;using&nbsp;struct,&nbsp;subv&nbsp;points&nbsp;into&nbsp;struct&nbsp;already.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766232">if</span>&nbsp;<span class="ident" id="4766235">v</span><span class="op" id="4766236">.</span><span class="ident" id="4766237">Kind</span><span class="op" id="4766241">(</span><span class="op" id="4766242">)</span>&nbsp;<span class="op" id="4766244">==</span>&nbsp;<span class="ident" id="4766247">reflect</span><span class="op" id="4766254">.</span><span class="ident" id="4766255">Map</span>&nbsp;<span class="op" id="4766259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766264">kv</span>&nbsp;<span class="op" id="4766267">:=</span>&nbsp;<span class="ident" id="4766270">reflect</span><span class="op" id="4766277">.</span><span class="ident" id="4766278">ValueOf</span><span class="op" id="4766285">(</span><span class="ident" id="4766286">key</span><span class="op" id="4766289">)</span><span class="op" id="4766290">.</span><span class="ident" id="4766291">Convert</span><span class="op" id="4766298">(</span><span class="ident" id="4766299">v</span><span class="op" id="4766300">.</span><span class="ident" id="4766301">Type</span><span class="op" id="4766305">(</span><span class="op" id="4766306">)</span><span class="op" id="4766307">.</span><span class="ident" id="4766308">Key</span><span class="op" id="4766311">(</span><span class="op" id="4766312">)</span><span class="op" id="4766313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766318">v</span><span class="op" id="4766319">.</span><span class="ident" id="4766320">SetMapIndex</span><span class="op" id="4766331">(</span><span class="ident" id="4766332">kv</span><span class="op" id="4766334">,</span>&nbsp;<span class="ident" id="4766336">subv</span><span class="op" id="4766340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4766349">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766381">op</span>&nbsp;<span class="op" id="4766384">=</span>&nbsp;<span class="ident" id="4766386">d</span><span class="op" id="4766387">.</span><span class="ident" id="4766388">scanWhile</span><span class="op" id="4766397">(</span><span class="ident" id="4766398">scanSkipSpace</span><span class="op" id="4766411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766415">if</span>&nbsp;<span class="ident" id="4766418">op</span>&nbsp;<span class="op" id="4766421">==</span>&nbsp;<span class="ident" id="4766424">scanEndObject</span>&nbsp;<span class="op" id="4766438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766443">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766451">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766455">if</span>&nbsp;<span class="ident" id="4766458">op</span>&nbsp;<span class="op" id="4766461">!=</span>&nbsp;<span class="ident" id="4766464">scanObjectValue</span>&nbsp;<span class="op" id="4766480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766485">d</span><span class="op" id="4766486">.</span><span class="builtintype" id="4766487">error</span><span class="op" id="4766492">(</span><span class="ident" id="4766493">errPhase</span><span class="op" id="4766501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766508">}</span><br>
<span class="lineno"></span><span class="op" id="4766510">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="comment" id="4766513">//&nbsp;literal&nbsp;consumes&nbsp;a&nbsp;literal&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4766593">//&nbsp;The&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;literal&nbsp;has&nbsp;been&nbsp;read&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="4766648">//&nbsp;(that&#39;s&nbsp;how&nbsp;the&nbsp;caller&nbsp;knows&nbsp;it&#39;s&nbsp;a&nbsp;literal).</span><br>
<span class="lineno"></span><span class="keyword" id="4766697">func</span>&nbsp;<span class="op" id="4766702">(</span><span class="ident" id="4766703">d</span>&nbsp;<span class="op" id="4766705">*</span><span class="ident" id="4766706">decodeState</span><span class="op" id="4766717">)</span>&nbsp;<span class="ident" id="4766719">literal</span><span class="op" id="4766726">(</span><span class="ident" id="4766727">v</span>&nbsp;<span class="ident" id="4766729">reflect</span><span class="op" id="4766736">.</span><span class="ident" id="4766737">Value</span><span class="op" id="4766742">)</span>&nbsp;<span class="op" id="4766744">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4766747">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766805">start</span>&nbsp;<span class="op" id="4766811">:=</span>&nbsp;<span class="ident" id="4766814">d</span><span class="op" id="4766815">.</span><span class="ident" id="4766816">off</span>&nbsp;<span class="op" id="4766820">-</span>&nbsp;<span class="num" id="4766822">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766825">op</span>&nbsp;<span class="op" id="4766828">:=</span>&nbsp;<span class="ident" id="4766831">d</span><span class="op" id="4766832">.</span><span class="ident" id="4766833">scanWhile</span><span class="op" id="4766842">(</span><span class="ident" id="4766843">scanContinue</span><span class="op" id="4766855">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4766859">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766900">d</span><span class="op" id="4766901">.</span><span class="ident" id="4766902">off</span><span class="op" id="4766905">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766909">d</span><span class="op" id="4766910">.</span><span class="ident" id="4766911">scan</span><span class="op" id="4766915">.</span><span class="ident" id="4766916">undo</span><span class="op" id="4766920">(</span><span class="ident" id="4766921">op</span><span class="op" id="4766923">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766927">d</span><span class="op" id="4766928">.</span><span class="ident" id="4766929">literalStore</span><span class="op" id="4766941">(</span><span class="ident" id="4766942">d</span><span class="op" id="4766943">.</span><span class="ident" id="4766944">data</span><span class="op" id="4766948">[</span><span class="ident" id="4766949">start</span><span class="op" id="4766954">:</span><span class="ident" id="4766955">d</span><span class="op" id="4766956">.</span><span class="ident" id="4766957">off</span><span class="op" id="4766960">]</span><span class="op" id="4766961">,</span>&nbsp;<span class="ident" id="4766963">v</span><span class="op" id="4766964">,</span>&nbsp;<span class="builtintype" id="4766966">false</span><span class="op" id="4766971">)</span><br>
<span class="lineno"></span><span class="op" id="4766973">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="4766976">//&nbsp;convertNumber&nbsp;converts&nbsp;the&nbsp;number&nbsp;literal&nbsp;s&nbsp;to&nbsp;a&nbsp;float64&nbsp;or&nbsp;a&nbsp;Number</span><br>
<span class="lineno"></span><span class="comment" id="4767048">//&nbsp;depending&nbsp;on&nbsp;the&nbsp;setting&nbsp;of&nbsp;d.useNumber.</span><br>
<span class="lineno"></span><span class="keyword" id="4767092">func</span>&nbsp;<span class="op" id="4767097">(</span><span class="ident" id="4767098">d</span>&nbsp;<span class="op" id="4767100">*</span><span class="ident" id="4767101">decodeState</span><span class="op" id="4767112">)</span>&nbsp;<span class="ident" id="4767114">convertNumber</span><span class="op" id="4767127">(</span><span class="ident" id="4767128">s</span>&nbsp;<span class="builtintype" id="4767130">string</span><span class="op" id="4767136">)</span>&nbsp;<span class="op" id="4767138">(</span><span class="keyword" id="4767139">interface</span><span class="op" id="4767148">{</span><span class="op" id="4767149">}</span><span class="op" id="4767150">,</span>&nbsp;<span class="builtintype" id="4767152">error</span><span class="op" id="4767157">)</span>&nbsp;<span class="op" id="4767159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767162">if</span>&nbsp;<span class="ident" id="4767165">d</span><span class="op" id="4767166">.</span><span class="ident" id="4767167">useNumber</span>&nbsp;<span class="op" id="4767177">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767181">return</span>&nbsp;<span class="ident" id="4767188">Number</span><span class="op" id="4767194">(</span><span class="ident" id="4767195">s</span><span class="op" id="4767196">)</span><span class="op" id="4767197">,</span>&nbsp;<span class="ident" id="4767199">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767207">f</span><span class="op" id="4767208">,</span>&nbsp;<span class="ident" id="4767210">err</span>&nbsp;<span class="op" id="4767214">:=</span>&nbsp;<span class="ident" id="4767217">strconv</span><span class="op" id="4767224">.</span><span class="ident" id="4767225">ParseFloat</span><span class="op" id="4767235">(</span><span class="ident" id="4767236">s</span><span class="op" id="4767237">,</span>&nbsp;<span class="num" id="4767239">64</span><span class="op" id="4767241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767244">if</span>&nbsp;<span class="ident" id="4767247">err</span>&nbsp;<span class="op" id="4767251">!=</span>&nbsp;<span class="ident" id="4767254">nil</span>&nbsp;<span class="op" id="4767258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767262">return</span>&nbsp;<span class="ident" id="4767269">nil</span><span class="op" id="4767272">,</span>&nbsp;<span class="op" id="4767274">&amp;</span><span class="ident" id="4767275">UnmarshalTypeError</span><span class="op" id="4767293">{</span><span class="string" id="4767294">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4767304">+</span>&nbsp;<span class="ident" id="4767306">s</span><span class="op" id="4767307">,</span>&nbsp;<span class="ident" id="4767309">reflect</span><span class="op" id="4767316">.</span><span class="ident" id="4767317">TypeOf</span><span class="op" id="4767323">(</span><span class="num" id="4767324">0.0</span><span class="op" id="4767327">)</span><span class="op" id="4767328">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767334">return</span>&nbsp;<span class="ident" id="4767341">f</span><span class="op" id="4767342">,</span>&nbsp;<span class="ident" id="4767344">nil</span><br>
<span class="lineno"></span><span class="op" id="4767348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4767351">var</span>&nbsp;<span class="ident" id="4767355">numberType</span>&nbsp;<span class="op" id="4767366">=</span>&nbsp;<span class="ident" id="4767368">reflect</span><span class="op" id="4767375">.</span><span class="ident" id="4767376">TypeOf</span><span class="op" id="4767382">(</span><span class="ident" id="4767383">Number</span><span class="op" id="4767389">(</span><span class="string" id="4767390">&#34;&#34;</span><span class="op" id="4767392">)</span><span class="op" id="4767393">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span><span class="comment" id="4767396">//&nbsp;literalStore&nbsp;decodes&nbsp;a&nbsp;literal&nbsp;stored&nbsp;in&nbsp;item&nbsp;into&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4767453">//</span><br>
<span class="lineno"></span><span class="comment" id="4767456">//&nbsp;fromQuoted&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;literal&nbsp;came&nbsp;from&nbsp;unwrapping&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4767524">//&nbsp;string&nbsp;from&nbsp;the&nbsp;&#34;,string&#34;&nbsp;struct&nbsp;tag&nbsp;option.&nbsp;this&nbsp;is&nbsp;used&nbsp;only&nbsp;to</span><br>
<span class="lineno">660</span><span class="comment" id="4767593">//&nbsp;produce&nbsp;more&nbsp;helpful&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="4767633">func</span>&nbsp;<span class="op" id="4767638">(</span><span class="ident" id="4767639">d</span>&nbsp;<span class="op" id="4767641">*</span><span class="ident" id="4767642">decodeState</span><span class="op" id="4767653">)</span>&nbsp;<span class="ident" id="4767655">literalStore</span><span class="op" id="4767667">(</span><span class="ident" id="4767668">item</span>&nbsp;<span class="op" id="4767673">[</span><span class="op" id="4767674">]</span><span class="builtintype" id="4767675">byte</span><span class="op" id="4767679">,</span>&nbsp;<span class="ident" id="4767681">v</span>&nbsp;<span class="ident" id="4767683">reflect</span><span class="op" id="4767690">.</span><span class="ident" id="4767691">Value</span><span class="op" id="4767696">,</span>&nbsp;<span class="ident" id="4767698">fromQuoted</span>&nbsp;<span class="builtintype" id="4767709">bool</span><span class="op" id="4767713">)</span>&nbsp;<span class="op" id="4767715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4767718">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767745">if</span>&nbsp;<span class="builtinfunc" id="4767748">len</span><span class="op" id="4767751">(</span><span class="ident" id="4767752">item</span><span class="op" id="4767756">)</span>&nbsp;<span class="op" id="4767758">==</span>&nbsp;<span class="num" id="4767761">0</span>&nbsp;<span class="op" id="4767763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4767767">//Empty&nbsp;string&nbsp;given</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767790">d</span><span class="op" id="4767791">.</span><span class="ident" id="4767792">saveError</span><span class="op" id="4767801">(</span><span class="ident" id="4767802">fmt</span><span class="op" id="4767805">.</span><span class="ident" id="4767806">Errorf</span><span class="op" id="4767812">(</span><span class="string" id="4767813">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4767886">,</span>&nbsp;<span class="ident" id="4767888">item</span><span class="op" id="4767892">,</span>&nbsp;<span class="ident" id="4767894">v</span><span class="op" id="4767895">.</span><span class="ident" id="4767896">Type</span><span class="op" id="4767900">(</span><span class="op" id="4767901">)</span><span class="op" id="4767902">)</span><span class="op" id="4767903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767907">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767918">wantptr</span>&nbsp;<span class="op" id="4767926">:=</span>&nbsp;<span class="ident" id="4767929">item</span><span class="op" id="4767933">[</span><span class="num" id="4767934">0</span><span class="op" id="4767935">]</span>&nbsp;<span class="op" id="4767937">==</span>&nbsp;<span class="string" id="4767940">&#39;n&#39;</span>&nbsp;<span class="comment" id="4767944">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767953">u</span><span class="op" id="4767954">,</span>&nbsp;<span class="ident" id="4767956">ut</span><span class="op" id="4767958">,</span>&nbsp;<span class="ident" id="4767960">pv</span>&nbsp;<span class="op" id="4767963">:=</span>&nbsp;<span class="ident" id="4767966">d</span><span class="op" id="4767967">.</span><span class="ident" id="4767968">indirect</span><span class="op" id="4767976">(</span><span class="ident" id="4767977">v</span><span class="op" id="4767978">,</span>&nbsp;<span class="ident" id="4767980">wantptr</span><span class="op" id="4767987">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767990">if</span>&nbsp;<span class="ident" id="4767993">u</span>&nbsp;<span class="op" id="4767995">!=</span>&nbsp;<span class="ident" id="4767998">nil</span>&nbsp;<span class="op" id="4768002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768006">err</span>&nbsp;<span class="op" id="4768010">:=</span>&nbsp;<span class="ident" id="4768013">u</span><span class="op" id="4768014">.</span><span class="ident" id="4768015">UnmarshalJSON</span><span class="op" id="4768028">(</span><span class="ident" id="4768029">item</span><span class="op" id="4768033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768037">if</span>&nbsp;<span class="ident" id="4768040">err</span>&nbsp;<span class="op" id="4768044">!=</span>&nbsp;<span class="ident" id="4768047">nil</span>&nbsp;<span class="op" id="4768051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768056">d</span><span class="op" id="4768057">.</span><span class="builtintype" id="4768058">error</span><span class="op" id="4768063">(</span><span class="ident" id="4768064">err</span><span class="op" id="4768067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768071">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768075">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768086">if</span>&nbsp;<span class="ident" id="4768089">ut</span>&nbsp;<span class="op" id="4768092">!=</span>&nbsp;<span class="ident" id="4768095">nil</span>&nbsp;<span class="op" id="4768099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768103">if</span>&nbsp;<span class="ident" id="4768106">item</span><span class="op" id="4768110">[</span><span class="num" id="4768111">0</span><span class="op" id="4768112">]</span>&nbsp;<span class="op" id="4768114">!=</span>&nbsp;<span class="string" id="4768117">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4768121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768126">if</span>&nbsp;<span class="ident" id="4768129">fromQuoted</span>&nbsp;<span class="op" id="4768140">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768146">d</span><span class="op" id="4768147">.</span><span class="ident" id="4768148">saveError</span><span class="op" id="4768157">(</span><span class="ident" id="4768158">fmt</span><span class="op" id="4768161">.</span><span class="ident" id="4768162">Errorf</span><span class="op" id="4768168">(</span><span class="string" id="4768169">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4768242">,</span>&nbsp;<span class="ident" id="4768244">item</span><span class="op" id="4768248">,</span>&nbsp;<span class="ident" id="4768250">v</span><span class="op" id="4768251">.</span><span class="ident" id="4768252">Type</span><span class="op" id="4768256">(</span><span class="op" id="4768257">)</span><span class="op" id="4768258">)</span><span class="op" id="4768259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768264">}</span>&nbsp;<span class="keyword" id="4768266">else</span>&nbsp;<span class="op" id="4768271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768277">d</span><span class="op" id="4768278">.</span><span class="ident" id="4768279">saveError</span><span class="op" id="4768288">(</span><span class="op" id="4768289">&amp;</span><span class="ident" id="4768290">UnmarshalTypeError</span><span class="op" id="4768308">{</span><span class="string" id="4768309">&#34;string&#34;</span><span class="op" id="4768317">,</span>&nbsp;<span class="ident" id="4768319">v</span><span class="op" id="4768320">.</span><span class="ident" id="4768321">Type</span><span class="op" id="4768325">(</span><span class="op" id="4768326">)</span><span class="op" id="4768327">}</span><span class="op" id="4768328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768337">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768341">s</span><span class="op" id="4768342">,</span>&nbsp;<span class="ident" id="4768344">ok</span>&nbsp;<span class="op" id="4768347">:=</span>&nbsp;<span class="ident" id="4768350">unquoteBytes</span><span class="op" id="4768362">(</span><span class="ident" id="4768363">item</span><span class="op" id="4768367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768371">if</span>&nbsp;<span class="op" id="4768374">!</span><span class="ident" id="4768375">ok</span>&nbsp;<span class="op" id="4768378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768383">if</span>&nbsp;<span class="ident" id="4768386">fromQuoted</span>&nbsp;<span class="op" id="4768397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768403">d</span><span class="op" id="4768404">.</span><span class="builtintype" id="4768405">error</span><span class="op" id="4768410">(</span><span class="ident" id="4768411">fmt</span><span class="op" id="4768414">.</span><span class="ident" id="4768415">Errorf</span><span class="op" id="4768421">(</span><span class="string" id="4768422">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4768495">,</span>&nbsp;<span class="ident" id="4768497">item</span><span class="op" id="4768501">,</span>&nbsp;<span class="ident" id="4768503">v</span><span class="op" id="4768504">.</span><span class="ident" id="4768505">Type</span><span class="op" id="4768509">(</span><span class="op" id="4768510">)</span><span class="op" id="4768511">)</span><span class="op" id="4768512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768517">}</span>&nbsp;<span class="keyword" id="4768519">else</span>&nbsp;<span class="op" id="4768524">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768530">d</span><span class="op" id="4768531">.</span><span class="builtintype" id="4768532">error</span><span class="op" id="4768537">(</span><span class="ident" id="4768538">errPhase</span><span class="op" id="4768546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768559">err</span>&nbsp;<span class="op" id="4768563">:=</span>&nbsp;<span class="ident" id="4768566">ut</span><span class="op" id="4768568">.</span><span class="ident" id="4768569">UnmarshalText</span><span class="op" id="4768582">(</span><span class="ident" id="4768583">s</span><span class="op" id="4768584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768588">if</span>&nbsp;<span class="ident" id="4768591">err</span>&nbsp;<span class="op" id="4768595">!=</span>&nbsp;<span class="ident" id="4768598">nil</span>&nbsp;<span class="op" id="4768602">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768607">d</span><span class="op" id="4768608">.</span><span class="builtintype" id="4768609">error</span><span class="op" id="4768614">(</span><span class="ident" id="4768615">err</span><span class="op" id="4768618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768626">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768638">v</span>&nbsp;<span class="op" id="4768640">=</span>&nbsp;<span class="ident" id="4768642">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768647">switch</span>&nbsp;<span class="ident" id="4768654">c</span>&nbsp;<span class="op" id="4768656">:=</span>&nbsp;<span class="ident" id="4768659">item</span><span class="op" id="4768663">[</span><span class="num" id="4768664">0</span><span class="op" id="4768665">]</span><span class="op" id="4768666">;</span>&nbsp;<span class="ident" id="4768668">c</span>&nbsp;<span class="op" id="4768670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768673">case</span>&nbsp;<span class="string" id="4768678">&#39;n&#39;</span><span class="op" id="4768681">:</span>&nbsp;<span class="comment" id="4768683">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768693">switch</span>&nbsp;<span class="ident" id="4768700">v</span><span class="op" id="4768701">.</span><span class="ident" id="4768702">Kind</span><span class="op" id="4768706">(</span><span class="op" id="4768707">)</span>&nbsp;<span class="op" id="4768709">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768713">case</span>&nbsp;<span class="ident" id="4768718">reflect</span><span class="op" id="4768725">.</span><span class="ident" id="4768726">Interface</span><span class="op" id="4768735">,</span>&nbsp;<span class="ident" id="4768737">reflect</span><span class="op" id="4768744">.</span><span class="ident" id="4768745">Ptr</span><span class="op" id="4768748">,</span>&nbsp;<span class="ident" id="4768750">reflect</span><span class="op" id="4768757">.</span><span class="ident" id="4768758">Map</span><span class="op" id="4768761">,</span>&nbsp;<span class="ident" id="4768763">reflect</span><span class="op" id="4768770">.</span><span class="ident" id="4768771">Slice</span><span class="op" id="4768776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768781">v</span><span class="op" id="4768782">.</span><span class="ident" id="4768783">Set</span><span class="op" id="4768786">(</span><span class="ident" id="4768787">reflect</span><span class="op" id="4768794">.</span><span class="ident" id="4768795">Zero</span><span class="op" id="4768799">(</span><span class="ident" id="4768800">v</span><span class="op" id="4768801">.</span><span class="ident" id="4768802">Type</span><span class="op" id="4768806">(</span><span class="op" id="4768807">)</span><span class="op" id="4768808">)</span><span class="op" id="4768809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4768814">//&nbsp;otherwise,&nbsp;ignore&nbsp;null&nbsp;for&nbsp;primitives/string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768867">case</span>&nbsp;<span class="string" id="4768872">&#39;t&#39;</span><span class="op" id="4768875">,</span>&nbsp;<span class="string" id="4768877">&#39;f&#39;</span><span class="op" id="4768880">:</span>&nbsp;<span class="comment" id="4768882">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768899">value</span>&nbsp;<span class="op" id="4768905">:=</span>&nbsp;<span class="ident" id="4768908">c</span>&nbsp;<span class="op" id="4768910">==</span>&nbsp;<span class="string" id="4768913">&#39;t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768919">switch</span>&nbsp;<span class="ident" id="4768926">v</span><span class="op" id="4768927">.</span><span class="ident" id="4768928">Kind</span><span class="op" id="4768932">(</span><span class="op" id="4768933">)</span>&nbsp;<span class="op" id="4768935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768939">default</span><span class="op" id="4768946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768951">if</span>&nbsp;<span class="ident" id="4768954">fromQuoted</span>&nbsp;<span class="op" id="4768965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768971">d</span><span class="op" id="4768972">.</span><span class="ident" id="4768973">saveError</span><span class="op" id="4768982">(</span><span class="ident" id="4768983">fmt</span><span class="op" id="4768986">.</span><span class="ident" id="4768987">Errorf</span><span class="op" id="4768993">(</span><span class="string" id="4768994">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4769067">,</span>&nbsp;<span class="ident" id="4769069">item</span><span class="op" id="4769073">,</span>&nbsp;<span class="ident" id="4769075">v</span><span class="op" id="4769076">.</span><span class="ident" id="4769077">Type</span><span class="op" id="4769081">(</span><span class="op" id="4769082">)</span><span class="op" id="4769083">)</span><span class="op" id="4769084">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769089">}</span>&nbsp;<span class="keyword" id="4769091">else</span>&nbsp;<span class="op" id="4769096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769102">d</span><span class="op" id="4769103">.</span><span class="ident" id="4769104">saveError</span><span class="op" id="4769113">(</span><span class="op" id="4769114">&amp;</span><span class="ident" id="4769115">UnmarshalTypeError</span><span class="op" id="4769133">{</span><span class="string" id="4769134">&#34;bool&#34;</span><span class="op" id="4769140">,</span>&nbsp;<span class="ident" id="4769142">v</span><span class="op" id="4769143">.</span><span class="ident" id="4769144">Type</span><span class="op" id="4769148">(</span><span class="op" id="4769149">)</span><span class="op" id="4769150">}</span><span class="op" id="4769151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769160">case</span>&nbsp;<span class="ident" id="4769165">reflect</span><span class="op" id="4769172">.</span><span class="ident" id="4769173">Bool</span><span class="op" id="4769177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769182">v</span><span class="op" id="4769183">.</span><span class="ident" id="4769184">SetBool</span><span class="op" id="4769191">(</span><span class="ident" id="4769192">value</span><span class="op" id="4769197">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769201">case</span>&nbsp;<span class="ident" id="4769206">reflect</span><span class="op" id="4769213">.</span><span class="ident" id="4769214">Interface</span><span class="op" id="4769223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769228">if</span>&nbsp;<span class="ident" id="4769231">v</span><span class="op" id="4769232">.</span><span class="ident" id="4769233">NumMethod</span><span class="op" id="4769242">(</span><span class="op" id="4769243">)</span>&nbsp;<span class="op" id="4769245">==</span>&nbsp;<span class="num" id="4769248">0</span>&nbsp;<span class="op" id="4769250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769256">v</span><span class="op" id="4769257">.</span><span class="ident" id="4769258">Set</span><span class="op" id="4769261">(</span><span class="ident" id="4769262">reflect</span><span class="op" id="4769269">.</span><span class="ident" id="4769270">ValueOf</span><span class="op" id="4769277">(</span><span class="ident" id="4769278">value</span><span class="op" id="4769283">)</span><span class="op" id="4769284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769289">}</span>&nbsp;<span class="keyword" id="4769291">else</span>&nbsp;<span class="op" id="4769296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769302">d</span><span class="op" id="4769303">.</span><span class="ident" id="4769304">saveError</span><span class="op" id="4769313">(</span><span class="op" id="4769314">&amp;</span><span class="ident" id="4769315">UnmarshalTypeError</span><span class="op" id="4769333">{</span><span class="string" id="4769334">&#34;bool&#34;</span><span class="op" id="4769340">,</span>&nbsp;<span class="ident" id="4769342">v</span><span class="op" id="4769343">.</span><span class="ident" id="4769344">Type</span><span class="op" id="4769348">(</span><span class="op" id="4769349">)</span><span class="op" id="4769350">}</span><span class="op" id="4769351">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769364">case</span>&nbsp;<span class="string" id="4769369">&#39;&#34;&#39;</span><span class="op" id="4769372">:</span>&nbsp;<span class="comment" id="4769374">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769386">s</span><span class="op" id="4769387">,</span>&nbsp;<span class="ident" id="4769389">ok</span>&nbsp;<span class="op" id="4769392">:=</span>&nbsp;<span class="ident" id="4769395">unquoteBytes</span><span class="op" id="4769407">(</span><span class="ident" id="4769408">item</span><span class="op" id="4769412">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769416">if</span>&nbsp;<span class="op" id="4769419">!</span><span class="ident" id="4769420">ok</span>&nbsp;<span class="op" id="4769423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769428">if</span>&nbsp;<span class="ident" id="4769431">fromQuoted</span>&nbsp;<span class="op" id="4769442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769448">d</span><span class="op" id="4769449">.</span><span class="builtintype" id="4769450">error</span><span class="op" id="4769455">(</span><span class="ident" id="4769456">fmt</span><span class="op" id="4769459">.</span><span class="ident" id="4769460">Errorf</span><span class="op" id="4769466">(</span><span class="string" id="4769467">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4769540">,</span>&nbsp;<span class="ident" id="4769542">item</span><span class="op" id="4769546">,</span>&nbsp;<span class="ident" id="4769548">v</span><span class="op" id="4769549">.</span><span class="ident" id="4769550">Type</span><span class="op" id="4769554">(</span><span class="op" id="4769555">)</span><span class="op" id="4769556">)</span><span class="op" id="4769557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769562">}</span>&nbsp;<span class="keyword" id="4769564">else</span>&nbsp;<span class="op" id="4769569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769575">d</span><span class="op" id="4769576">.</span><span class="builtintype" id="4769577">error</span><span class="op" id="4769582">(</span><span class="ident" id="4769583">errPhase</span><span class="op" id="4769591">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769604">switch</span>&nbsp;<span class="ident" id="4769611">v</span><span class="op" id="4769612">.</span><span class="ident" id="4769613">Kind</span><span class="op" id="4769617">(</span><span class="op" id="4769618">)</span>&nbsp;<span class="op" id="4769620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769624">default</span><span class="op" id="4769631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769636">d</span><span class="op" id="4769637">.</span><span class="ident" id="4769638">saveError</span><span class="op" id="4769647">(</span><span class="op" id="4769648">&amp;</span><span class="ident" id="4769649">UnmarshalTypeError</span><span class="op" id="4769667">{</span><span class="string" id="4769668">&#34;string&#34;</span><span class="op" id="4769676">,</span>&nbsp;<span class="ident" id="4769678">v</span><span class="op" id="4769679">.</span><span class="ident" id="4769680">Type</span><span class="op" id="4769684">(</span><span class="op" id="4769685">)</span><span class="op" id="4769686">}</span><span class="op" id="4769687">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769691">case</span>&nbsp;<span class="ident" id="4769696">reflect</span><span class="op" id="4769703">.</span><span class="ident" id="4769704">Slice</span><span class="op" id="4769709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769714">if</span>&nbsp;<span class="ident" id="4769717">v</span><span class="op" id="4769718">.</span><span class="ident" id="4769719">Type</span><span class="op" id="4769723">(</span><span class="op" id="4769724">)</span>&nbsp;<span class="op" id="4769726">!=</span>&nbsp;<span class="ident" id="4769729">byteSliceType</span>&nbsp;<span class="op" id="4769743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769749">d</span><span class="op" id="4769750">.</span><span class="ident" id="4769751">saveError</span><span class="op" id="4769760">(</span><span class="op" id="4769761">&amp;</span><span class="ident" id="4769762">UnmarshalTypeError</span><span class="op" id="4769780">{</span><span class="string" id="4769781">&#34;string&#34;</span><span class="op" id="4769789">,</span>&nbsp;<span class="ident" id="4769791">v</span><span class="op" id="4769792">.</span><span class="ident" id="4769793">Type</span><span class="op" id="4769797">(</span><span class="op" id="4769798">)</span><span class="op" id="4769799">}</span><span class="op" id="4769800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769806">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769815">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769820">b</span>&nbsp;<span class="op" id="4769822">:=</span>&nbsp;<span class="builtinfunc" id="4769825">make</span><span class="op" id="4769829">(</span><span class="op" id="4769830">[</span><span class="op" id="4769831">]</span><span class="builtintype" id="4769832">byte</span><span class="op" id="4769836">,</span>&nbsp;<span class="ident" id="4769838">base64</span><span class="op" id="4769844">.</span><span class="ident" id="4769845">StdEncoding</span><span class="op" id="4769856">.</span><span class="ident" id="4769857">DecodedLen</span><span class="op" id="4769867">(</span><span class="builtinfunc" id="4769868">len</span><span class="op" id="4769871">(</span><span class="ident" id="4769872">s</span><span class="op" id="4769873">)</span><span class="op" id="4769874">)</span><span class="op" id="4769875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769880">n</span><span class="op" id="4769881">,</span>&nbsp;<span class="ident" id="4769883">err</span>&nbsp;<span class="op" id="4769887">:=</span>&nbsp;<span class="ident" id="4769890">base64</span><span class="op" id="4769896">.</span><span class="ident" id="4769897">StdEncoding</span><span class="op" id="4769908">.</span><span class="ident" id="4769909">Decode</span><span class="op" id="4769915">(</span><span class="ident" id="4769916">b</span><span class="op" id="4769917">,</span>&nbsp;<span class="ident" id="4769919">s</span><span class="op" id="4769920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769925">if</span>&nbsp;<span class="ident" id="4769928">err</span>&nbsp;<span class="op" id="4769932">!=</span>&nbsp;<span class="ident" id="4769935">nil</span>&nbsp;<span class="op" id="4769939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769945">d</span><span class="op" id="4769946">.</span><span class="ident" id="4769947">saveError</span><span class="op" id="4769956">(</span><span class="ident" id="4769957">err</span><span class="op" id="4769960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769966">break</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769980">v</span><span class="op" id="4769981">.</span><span class="ident" id="4769982">Set</span><span class="op" id="4769985">(</span><span class="ident" id="4769986">reflect</span><span class="op" id="4769993">.</span><span class="ident" id="4769994">ValueOf</span><span class="op" id="4770001">(</span><span class="ident" id="4770002">b</span><span class="op" id="4770003">[</span><span class="num" id="4770004">0</span><span class="op" id="4770005">:</span><span class="ident" id="4770006">n</span><span class="op" id="4770007">]</span><span class="op" id="4770008">)</span><span class="op" id="4770009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770013">case</span>&nbsp;<span class="ident" id="4770018">reflect</span><span class="op" id="4770025">.</span><span class="ident" id="4770026">String</span><span class="op" id="4770032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770037">v</span><span class="op" id="4770038">.</span><span class="ident" id="4770039">SetString</span><span class="op" id="4770048">(</span><span class="builtintype" id="4770049">string</span><span class="op" id="4770055">(</span><span class="ident" id="4770056">s</span><span class="op" id="4770057">)</span><span class="op" id="4770058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770062">case</span>&nbsp;<span class="ident" id="4770067">reflect</span><span class="op" id="4770074">.</span><span class="ident" id="4770075">Interface</span><span class="op" id="4770084">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770089">if</span>&nbsp;<span class="ident" id="4770092">v</span><span class="op" id="4770093">.</span><span class="ident" id="4770094">NumMethod</span><span class="op" id="4770103">(</span><span class="op" id="4770104">)</span>&nbsp;<span class="op" id="4770106">==</span>&nbsp;<span class="num" id="4770109">0</span>&nbsp;<span class="op" id="4770111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770117">v</span><span class="op" id="4770118">.</span><span class="ident" id="4770119">Set</span><span class="op" id="4770122">(</span><span class="ident" id="4770123">reflect</span><span class="op" id="4770130">.</span><span class="ident" id="4770131">ValueOf</span><span class="op" id="4770138">(</span><span class="builtintype" id="4770139">string</span><span class="op" id="4770145">(</span><span class="ident" id="4770146">s</span><span class="op" id="4770147">)</span><span class="op" id="4770148">)</span><span class="op" id="4770149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770154">}</span>&nbsp;<span class="keyword" id="4770156">else</span>&nbsp;<span class="op" id="4770161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770167">d</span><span class="op" id="4770168">.</span><span class="ident" id="4770169">saveError</span><span class="op" id="4770178">(</span><span class="op" id="4770179">&amp;</span><span class="ident" id="4770180">UnmarshalTypeError</span><span class="op" id="4770198">{</span><span class="string" id="4770199">&#34;string&#34;</span><span class="op" id="4770207">,</span>&nbsp;<span class="ident" id="4770209">v</span><span class="op" id="4770210">.</span><span class="ident" id="4770211">Type</span><span class="op" id="4770215">(</span><span class="op" id="4770216">)</span><span class="op" id="4770217">}</span><span class="op" id="4770218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770223">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770231">default</span><span class="op" id="4770238">:</span>&nbsp;<span class="comment" id="4770240">//&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770252">if</span>&nbsp;<span class="ident" id="4770255">c</span>&nbsp;<span class="op" id="4770257">!=</span>&nbsp;<span class="string" id="4770260">&#39;-&#39;</span>&nbsp;<span class="op" id="4770264">&amp;&amp;</span>&nbsp;<span class="op" id="4770267">(</span><span class="ident" id="4770268">c</span>&nbsp;<span class="op" id="4770270">&lt;</span>&nbsp;<span class="string" id="4770272">&#39;0&#39;</span>&nbsp;<span class="op" id="4770276">||</span>&nbsp;<span class="ident" id="4770279">c</span>&nbsp;<span class="op" id="4770281">&gt;</span>&nbsp;<span class="string" id="4770283">&#39;9&#39;</span><span class="op" id="4770286">)</span>&nbsp;<span class="op" id="4770288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770293">if</span>&nbsp;<span class="ident" id="4770296">fromQuoted</span>&nbsp;<span class="op" id="4770307">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770313">d</span><span class="op" id="4770314">.</span><span class="builtintype" id="4770315">error</span><span class="op" id="4770320">(</span><span class="ident" id="4770321">fmt</span><span class="op" id="4770324">.</span><span class="ident" id="4770325">Errorf</span><span class="op" id="4770331">(</span><span class="string" id="4770332">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4770405">,</span>&nbsp;<span class="ident" id="4770407">item</span><span class="op" id="4770411">,</span>&nbsp;<span class="ident" id="4770413">v</span><span class="op" id="4770414">.</span><span class="ident" id="4770415">Type</span><span class="op" id="4770419">(</span><span class="op" id="4770420">)</span><span class="op" id="4770421">)</span><span class="op" id="4770422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770427">}</span>&nbsp;<span class="keyword" id="4770429">else</span>&nbsp;<span class="op" id="4770434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770440">d</span><span class="op" id="4770441">.</span><span class="builtintype" id="4770442">error</span><span class="op" id="4770447">(</span><span class="ident" id="4770448">errPhase</span><span class="op" id="4770456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770465">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770469">s</span>&nbsp;<span class="op" id="4770471">:=</span>&nbsp;<span class="builtintype" id="4770474">string</span><span class="op" id="4770480">(</span><span class="ident" id="4770481">item</span><span class="op" id="4770485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770489">switch</span>&nbsp;<span class="ident" id="4770496">v</span><span class="op" id="4770497">.</span><span class="ident" id="4770498">Kind</span><span class="op" id="4770502">(</span><span class="op" id="4770503">)</span>&nbsp;<span class="op" id="4770505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770509">default</span><span class="op" id="4770516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770521">if</span>&nbsp;<span class="ident" id="4770524">v</span><span class="op" id="4770525">.</span><span class="ident" id="4770526">Kind</span><span class="op" id="4770530">(</span><span class="op" id="4770531">)</span>&nbsp;<span class="op" id="4770533">==</span>&nbsp;<span class="ident" id="4770536">reflect</span><span class="op" id="4770543">.</span><span class="ident" id="4770544">String</span>&nbsp;<span class="op" id="4770551">&amp;&amp;</span>&nbsp;<span class="ident" id="4770554">v</span><span class="op" id="4770555">.</span><span class="ident" id="4770556">Type</span><span class="op" id="4770560">(</span><span class="op" id="4770561">)</span>&nbsp;<span class="op" id="4770563">==</span>&nbsp;<span class="ident" id="4770566">numberType</span>&nbsp;<span class="op" id="4770577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770583">v</span><span class="op" id="4770584">.</span><span class="ident" id="4770585">SetString</span><span class="op" id="4770594">(</span><span class="ident" id="4770595">s</span><span class="op" id="4770596">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770602">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770616">if</span>&nbsp;<span class="ident" id="4770619">fromQuoted</span>&nbsp;<span class="op" id="4770630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770636">d</span><span class="op" id="4770637">.</span><span class="builtintype" id="4770638">error</span><span class="op" id="4770643">(</span><span class="ident" id="4770644">fmt</span><span class="op" id="4770647">.</span><span class="ident" id="4770648">Errorf</span><span class="op" id="4770654">(</span><span class="string" id="4770655">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4770728">,</span>&nbsp;<span class="ident" id="4770730">item</span><span class="op" id="4770734">,</span>&nbsp;<span class="ident" id="4770736">v</span><span class="op" id="4770737">.</span><span class="ident" id="4770738">Type</span><span class="op" id="4770742">(</span><span class="op" id="4770743">)</span><span class="op" id="4770744">)</span><span class="op" id="4770745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770750">}</span>&nbsp;<span class="keyword" id="4770752">else</span>&nbsp;<span class="op" id="4770757">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770763">d</span><span class="op" id="4770764">.</span><span class="builtintype" id="4770765">error</span><span class="op" id="4770770">(</span><span class="op" id="4770771">&amp;</span><span class="ident" id="4770772">UnmarshalTypeError</span><span class="op" id="4770790">{</span><span class="string" id="4770791">&#34;number&#34;</span><span class="op" id="4770799">,</span>&nbsp;<span class="ident" id="4770801">v</span><span class="op" id="4770802">.</span><span class="ident" id="4770803">Type</span><span class="op" id="4770807">(</span><span class="op" id="4770808">)</span><span class="op" id="4770809">}</span><span class="op" id="4770810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770819">case</span>&nbsp;<span class="ident" id="4770824">reflect</span><span class="op" id="4770831">.</span><span class="ident" id="4770832">Interface</span><span class="op" id="4770841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770846">n</span><span class="op" id="4770847">,</span>&nbsp;<span class="ident" id="4770849">err</span>&nbsp;<span class="op" id="4770853">:=</span>&nbsp;<span class="ident" id="4770856">d</span><span class="op" id="4770857">.</span><span class="ident" id="4770858">convertNumber</span><span class="op" id="4770871">(</span><span class="ident" id="4770872">s</span><span class="op" id="4770873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770878">if</span>&nbsp;<span class="ident" id="4770881">err</span>&nbsp;<span class="op" id="4770885">!=</span>&nbsp;<span class="ident" id="4770888">nil</span>&nbsp;<span class="op" id="4770892">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770898">d</span><span class="op" id="4770899">.</span><span class="ident" id="4770900">saveError</span><span class="op" id="4770909">(</span><span class="ident" id="4770910">err</span><span class="op" id="4770913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770919">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770933">if</span>&nbsp;<span class="ident" id="4770936">v</span><span class="op" id="4770937">.</span><span class="ident" id="4770938">NumMethod</span><span class="op" id="4770947">(</span><span class="op" id="4770948">)</span>&nbsp;<span class="op" id="4770950">!=</span>&nbsp;<span class="num" id="4770953">0</span>&nbsp;<span class="op" id="4770955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770961">d</span><span class="op" id="4770962">.</span><span class="ident" id="4770963">saveError</span><span class="op" id="4770972">(</span><span class="op" id="4770973">&amp;</span><span class="ident" id="4770974">UnmarshalTypeError</span><span class="op" id="4770992">{</span><span class="string" id="4770993">&#34;number&#34;</span><span class="op" id="4771001">,</span>&nbsp;<span class="ident" id="4771003">v</span><span class="op" id="4771004">.</span><span class="ident" id="4771005">Type</span><span class="op" id="4771009">(</span><span class="op" id="4771010">)</span><span class="op" id="4771011">}</span><span class="op" id="4771012">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771018">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771032">v</span><span class="op" id="4771033">.</span><span class="ident" id="4771034">Set</span><span class="op" id="4771037">(</span><span class="ident" id="4771038">reflect</span><span class="op" id="4771045">.</span><span class="ident" id="4771046">ValueOf</span><span class="op" id="4771053">(</span><span class="ident" id="4771054">n</span><span class="op" id="4771055">)</span><span class="op" id="4771056">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771061">case</span>&nbsp;<span class="ident" id="4771066">reflect</span><span class="op" id="4771073">.</span><span class="ident" id="4771074">Int</span><span class="op" id="4771077">,</span>&nbsp;<span class="ident" id="4771079">reflect</span><span class="op" id="4771086">.</span><span class="ident" id="4771087">Int8</span><span class="op" id="4771091">,</span>&nbsp;<span class="ident" id="4771093">reflect</span><span class="op" id="4771100">.</span><span class="ident" id="4771101">Int16</span><span class="op" id="4771106">,</span>&nbsp;<span class="ident" id="4771108">reflect</span><span class="op" id="4771115">.</span><span class="ident" id="4771116">Int32</span><span class="op" id="4771121">,</span>&nbsp;<span class="ident" id="4771123">reflect</span><span class="op" id="4771130">.</span><span class="ident" id="4771131">Int64</span><span class="op" id="4771136">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771141">n</span><span class="op" id="4771142">,</span>&nbsp;<span class="ident" id="4771144">err</span>&nbsp;<span class="op" id="4771148">:=</span>&nbsp;<span class="ident" id="4771151">strconv</span><span class="op" id="4771158">.</span><span class="ident" id="4771159">ParseInt</span><span class="op" id="4771167">(</span><span class="ident" id="4771168">s</span><span class="op" id="4771169">,</span>&nbsp;<span class="num" id="4771171">10</span><span class="op" id="4771173">,</span>&nbsp;<span class="num" id="4771175">64</span><span class="op" id="4771177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771182">if</span>&nbsp;<span class="ident" id="4771185">err</span>&nbsp;<span class="op" id="4771189">!=</span>&nbsp;<span class="ident" id="4771192">nil</span>&nbsp;<span class="op" id="4771196">||</span>&nbsp;<span class="ident" id="4771199">v</span><span class="op" id="4771200">.</span><span class="ident" id="4771201">OverflowInt</span><span class="op" id="4771212">(</span><span class="ident" id="4771213">n</span><span class="op" id="4771214">)</span>&nbsp;<span class="op" id="4771216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771222">d</span><span class="op" id="4771223">.</span><span class="ident" id="4771224">saveError</span><span class="op" id="4771233">(</span><span class="op" id="4771234">&amp;</span><span class="ident" id="4771235">UnmarshalTypeError</span><span class="op" id="4771253">{</span><span class="string" id="4771254">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4771264">+</span>&nbsp;<span class="ident" id="4771266">s</span><span class="op" id="4771267">,</span>&nbsp;<span class="ident" id="4771269">v</span><span class="op" id="4771270">.</span><span class="ident" id="4771271">Type</span><span class="op" id="4771275">(</span><span class="op" id="4771276">)</span><span class="op" id="4771277">}</span><span class="op" id="4771278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771284">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771293">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771298">v</span><span class="op" id="4771299">.</span><span class="ident" id="4771300">SetInt</span><span class="op" id="4771306">(</span><span class="ident" id="4771307">n</span><span class="op" id="4771308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771313">case</span>&nbsp;<span class="ident" id="4771318">reflect</span><span class="op" id="4771325">.</span><span class="ident" id="4771326">Uint</span><span class="op" id="4771330">,</span>&nbsp;<span class="ident" id="4771332">reflect</span><span class="op" id="4771339">.</span><span class="ident" id="4771340">Uint8</span><span class="op" id="4771345">,</span>&nbsp;<span class="ident" id="4771347">reflect</span><span class="op" id="4771354">.</span><span class="ident" id="4771355">Uint16</span><span class="op" id="4771361">,</span>&nbsp;<span class="ident" id="4771363">reflect</span><span class="op" id="4771370">.</span><span class="ident" id="4771371">Uint32</span><span class="op" id="4771377">,</span>&nbsp;<span class="ident" id="4771379">reflect</span><span class="op" id="4771386">.</span><span class="ident" id="4771387">Uint64</span><span class="op" id="4771393">,</span>&nbsp;<span class="ident" id="4771395">reflect</span><span class="op" id="4771402">.</span><span class="ident" id="4771403">Uintptr</span><span class="op" id="4771410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771415">n</span><span class="op" id="4771416">,</span>&nbsp;<span class="ident" id="4771418">err</span>&nbsp;<span class="op" id="4771422">:=</span>&nbsp;<span class="ident" id="4771425">strconv</span><span class="op" id="4771432">.</span><span class="ident" id="4771433">ParseUint</span><span class="op" id="4771442">(</span><span class="ident" id="4771443">s</span><span class="op" id="4771444">,</span>&nbsp;<span class="num" id="4771446">10</span><span class="op" id="4771448">,</span>&nbsp;<span class="num" id="4771450">64</span><span class="op" id="4771452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771457">if</span>&nbsp;<span class="ident" id="4771460">err</span>&nbsp;<span class="op" id="4771464">!=</span>&nbsp;<span class="ident" id="4771467">nil</span>&nbsp;<span class="op" id="4771471">||</span>&nbsp;<span class="ident" id="4771474">v</span><span class="op" id="4771475">.</span><span class="ident" id="4771476">OverflowUint</span><span class="op" id="4771488">(</span><span class="ident" id="4771489">n</span><span class="op" id="4771490">)</span>&nbsp;<span class="op" id="4771492">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771498">d</span><span class="op" id="4771499">.</span><span class="ident" id="4771500">saveError</span><span class="op" id="4771509">(</span><span class="op" id="4771510">&amp;</span><span class="ident" id="4771511">UnmarshalTypeError</span><span class="op" id="4771529">{</span><span class="string" id="4771530">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4771540">+</span>&nbsp;<span class="ident" id="4771542">s</span><span class="op" id="4771543">,</span>&nbsp;<span class="ident" id="4771545">v</span><span class="op" id="4771546">.</span><span class="ident" id="4771547">Type</span><span class="op" id="4771551">(</span><span class="op" id="4771552">)</span><span class="op" id="4771553">}</span><span class="op" id="4771554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771560">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771574">v</span><span class="op" id="4771575">.</span><span class="ident" id="4771576">SetUint</span><span class="op" id="4771583">(</span><span class="ident" id="4771584">n</span><span class="op" id="4771585">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771590">case</span>&nbsp;<span class="ident" id="4771595">reflect</span><span class="op" id="4771602">.</span><span class="ident" id="4771603">Float32</span><span class="op" id="4771610">,</span>&nbsp;<span class="ident" id="4771612">reflect</span><span class="op" id="4771619">.</span><span class="ident" id="4771620">Float64</span><span class="op" id="4771627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771632">n</span><span class="op" id="4771633">,</span>&nbsp;<span class="ident" id="4771635">err</span>&nbsp;<span class="op" id="4771639">:=</span>&nbsp;<span class="ident" id="4771642">strconv</span><span class="op" id="4771649">.</span><span class="ident" id="4771650">ParseFloat</span><span class="op" id="4771660">(</span><span class="ident" id="4771661">s</span><span class="op" id="4771662">,</span>&nbsp;<span class="ident" id="4771664">v</span><span class="op" id="4771665">.</span><span class="ident" id="4771666">Type</span><span class="op" id="4771670">(</span><span class="op" id="4771671">)</span><span class="op" id="4771672">.</span><span class="ident" id="4771673">Bits</span><span class="op" id="4771677">(</span><span class="op" id="4771678">)</span><span class="op" id="4771679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771684">if</span>&nbsp;<span class="ident" id="4771687">err</span>&nbsp;<span class="op" id="4771691">!=</span>&nbsp;<span class="ident" id="4771694">nil</span>&nbsp;<span class="op" id="4771698">||</span>&nbsp;<span class="ident" id="4771701">v</span><span class="op" id="4771702">.</span><span class="ident" id="4771703">OverflowFloat</span><span class="op" id="4771716">(</span><span class="ident" id="4771717">n</span><span class="op" id="4771718">)</span>&nbsp;<span class="op" id="4771720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771726">d</span><span class="op" id="4771727">.</span><span class="ident" id="4771728">saveError</span><span class="op" id="4771737">(</span><span class="op" id="4771738">&amp;</span><span class="ident" id="4771739">UnmarshalTypeError</span><span class="op" id="4771757">{</span><span class="string" id="4771758">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4771768">+</span>&nbsp;<span class="ident" id="4771770">s</span><span class="op" id="4771771">,</span>&nbsp;<span class="ident" id="4771773">v</span><span class="op" id="4771774">.</span><span class="ident" id="4771775">Type</span><span class="op" id="4771779">(</span><span class="op" id="4771780">)</span><span class="op" id="4771781">}</span><span class="op" id="4771782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771788">break</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771802">v</span><span class="op" id="4771803">.</span><span class="ident" id="4771804">SetFloat</span><span class="op" id="4771812">(</span><span class="ident" id="4771813">n</span><span class="op" id="4771814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771821">}</span><br>
<span class="lineno"></span><span class="op" id="4771823">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="comment" id="4771826">//&nbsp;The&nbsp;xxxInterface&nbsp;routines&nbsp;build&nbsp;up&nbsp;a&nbsp;value&nbsp;to&nbsp;be&nbsp;stored</span><br>
<span class="lineno"></span><span class="comment" id="4771885">//&nbsp;in&nbsp;an&nbsp;empty&nbsp;interface.&nbsp;&nbsp;They&nbsp;are&nbsp;not&nbsp;strictly&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4771945">//&nbsp;but&nbsp;they&nbsp;avoid&nbsp;the&nbsp;weight&nbsp;of&nbsp;reflection&nbsp;in&nbsp;this&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="4772010">//&nbsp;valueInterface&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;returns&nbsp;interface{}</span><br>
<span class="lineno"></span><span class="keyword" id="4772066">func</span>&nbsp;<span class="op" id="4772071">(</span><span class="ident" id="4772072">d</span>&nbsp;<span class="op" id="4772074">*</span><span class="ident" id="4772075">decodeState</span><span class="op" id="4772086">)</span>&nbsp;<span class="ident" id="4772088">valueInterface</span><span class="op" id="4772102">(</span><span class="op" id="4772103">)</span>&nbsp;<span class="keyword" id="4772105">interface</span><span class="op" id="4772114">{</span><span class="op" id="4772115">}</span>&nbsp;<span class="op" id="4772117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772120">switch</span>&nbsp;<span class="ident" id="4772127">d</span><span class="op" id="4772128">.</span><span class="ident" id="4772129">scanWhile</span><span class="op" id="4772138">(</span><span class="ident" id="4772139">scanSkipSpace</span><span class="op" id="4772152">)</span>&nbsp;<span class="op" id="4772154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772157">default</span><span class="op" id="4772164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772168">d</span><span class="op" id="4772169">.</span><span class="builtintype" id="4772170">error</span><span class="op" id="4772175">(</span><span class="ident" id="4772176">errPhase</span><span class="op" id="4772184">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4772188">panic</span><span class="op" id="4772193">(</span><span class="string" id="4772194">&#34;unreachable&#34;</span><span class="op" id="4772207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772210">case</span>&nbsp;<span class="ident" id="4772215">scanBeginArray</span><span class="op" id="4772229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772233">return</span>&nbsp;<span class="ident" id="4772240">d</span><span class="op" id="4772241">.</span><span class="ident" id="4772242">arrayInterface</span><span class="op" id="4772256">(</span><span class="op" id="4772257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772260">case</span>&nbsp;<span class="ident" id="4772265">scanBeginObject</span><span class="op" id="4772280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772284">return</span>&nbsp;<span class="ident" id="4772291">d</span><span class="op" id="4772292">.</span><span class="ident" id="4772293">objectInterface</span><span class="op" id="4772308">(</span><span class="op" id="4772309">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772312">case</span>&nbsp;<span class="ident" id="4772317">scanBeginLiteral</span><span class="op" id="4772333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772337">return</span>&nbsp;<span class="ident" id="4772344">d</span><span class="op" id="4772345">.</span><span class="ident" id="4772346">literalInterface</span><span class="op" id="4772362">(</span><span class="op" id="4772363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772366">}</span><br>
<span class="lineno"></span><span class="op" id="4772368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4772371">//&nbsp;arrayInterface&nbsp;is&nbsp;like&nbsp;array&nbsp;but&nbsp;returns&nbsp;[]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="4772430">func</span>&nbsp;<span class="op" id="4772435">(</span><span class="ident" id="4772436">d</span>&nbsp;<span class="op" id="4772438">*</span><span class="ident" id="4772439">decodeState</span><span class="op" id="4772450">)</span>&nbsp;<span class="ident" id="4772452">arrayInterface</span><span class="op" id="4772466">(</span><span class="op" id="4772467">)</span>&nbsp;<span class="op" id="4772469">[</span><span class="op" id="4772470">]</span><span class="keyword" id="4772471">interface</span><span class="op" id="4772480">{</span><span class="op" id="4772481">}</span>&nbsp;<span class="op" id="4772483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772486">var</span>&nbsp;<span class="ident" id="4772490">v</span>&nbsp;<span class="op" id="4772492">=</span>&nbsp;<span class="builtinfunc" id="4772494">make</span><span class="op" id="4772498">(</span><span class="op" id="4772499">[</span><span class="op" id="4772500">]</span><span class="keyword" id="4772501">interface</span><span class="op" id="4772510">{</span><span class="op" id="4772511">}</span><span class="op" id="4772512">,</span>&nbsp;<span class="num" id="4772514">0</span><span class="op" id="4772515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772518">for</span>&nbsp;<span class="op" id="4772522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4772526">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772586">op</span>&nbsp;<span class="op" id="4772589">:=</span>&nbsp;<span class="ident" id="4772592">d</span><span class="op" id="4772593">.</span><span class="ident" id="4772594">scanWhile</span><span class="op" id="4772603">(</span><span class="ident" id="4772604">scanSkipSpace</span><span class="op" id="4772617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772621">if</span>&nbsp;<span class="ident" id="4772624">op</span>&nbsp;<span class="op" id="4772627">==</span>&nbsp;<span class="ident" id="4772630">scanEndArray</span>&nbsp;<span class="op" id="4772643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772648">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4772661">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772717">d</span><span class="op" id="4772718">.</span><span class="ident" id="4772719">off</span><span class="op" id="4772722">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772727">d</span><span class="op" id="4772728">.</span><span class="ident" id="4772729">scan</span><span class="op" id="4772733">.</span><span class="ident" id="4772734">undo</span><span class="op" id="4772738">(</span><span class="ident" id="4772739">op</span><span class="op" id="4772741">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772746">v</span>&nbsp;<span class="op" id="4772748">=</span>&nbsp;<span class="builtinfunc" id="4772750">append</span><span class="op" id="4772756">(</span><span class="ident" id="4772757">v</span><span class="op" id="4772758">,</span>&nbsp;<span class="ident" id="4772760">d</span><span class="op" id="4772761">.</span><span class="ident" id="4772762">valueInterface</span><span class="op" id="4772776">(</span><span class="op" id="4772777">)</span><span class="op" id="4772778">)</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4772783">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772815">op</span>&nbsp;<span class="op" id="4772818">=</span>&nbsp;<span class="ident" id="4772820">d</span><span class="op" id="4772821">.</span><span class="ident" id="4772822">scanWhile</span><span class="op" id="4772831">(</span><span class="ident" id="4772832">scanSkipSpace</span><span class="op" id="4772845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772849">if</span>&nbsp;<span class="ident" id="4772852">op</span>&nbsp;<span class="op" id="4772855">==</span>&nbsp;<span class="ident" id="4772858">scanEndArray</span>&nbsp;<span class="op" id="4772871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772876">break</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772888">if</span>&nbsp;<span class="ident" id="4772891">op</span>&nbsp;<span class="op" id="4772894">!=</span>&nbsp;<span class="ident" id="4772897">scanArrayValue</span>&nbsp;<span class="op" id="4772912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772917">d</span><span class="op" id="4772918">.</span><span class="builtintype" id="4772919">error</span><span class="op" id="4772924">(</span><span class="ident" id="4772925">errPhase</span><span class="op" id="4772933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772940">}</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772943">return</span>&nbsp;<span class="ident" id="4772950">v</span><br>
<span class="lineno"></span><span class="op" id="4772952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4772955">//&nbsp;objectInterface&nbsp;is&nbsp;like&nbsp;object&nbsp;but&nbsp;returns&nbsp;map[string]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="4773025">func</span>&nbsp;<span class="op" id="4773030">(</span><span class="ident" id="4773031">d</span>&nbsp;<span class="op" id="4773033">*</span><span class="ident" id="4773034">decodeState</span><span class="op" id="4773045">)</span>&nbsp;<span class="ident" id="4773047">objectInterface</span><span class="op" id="4773062">(</span><span class="op" id="4773063">)</span>&nbsp;<span class="keyword" id="4773065">map</span><span class="op" id="4773068">[</span><span class="builtintype" id="4773069">string</span><span class="op" id="4773075">]</span><span class="keyword" id="4773076">interface</span><span class="op" id="4773085">{</span><span class="op" id="4773086">}</span>&nbsp;<span class="op" id="4773088">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773091">m</span>&nbsp;<span class="op" id="4773093">:=</span>&nbsp;<span class="builtinfunc" id="4773096">make</span><span class="op" id="4773100">(</span><span class="keyword" id="4773101">map</span><span class="op" id="4773104">[</span><span class="builtintype" id="4773105">string</span><span class="op" id="4773111">]</span><span class="keyword" id="4773112">interface</span><span class="op" id="4773121">{</span><span class="op" id="4773122">}</span><span class="op" id="4773123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773126">for</span>&nbsp;<span class="op" id="4773130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773134">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773182">op</span>&nbsp;<span class="op" id="4773185">:=</span>&nbsp;<span class="ident" id="4773188">d</span><span class="op" id="4773189">.</span><span class="ident" id="4773190">scanWhile</span><span class="op" id="4773199">(</span><span class="ident" id="4773200">scanSkipSpace</span><span class="op" id="4773213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773217">if</span>&nbsp;<span class="ident" id="4773220">op</span>&nbsp;<span class="op" id="4773223">==</span>&nbsp;<span class="ident" id="4773226">scanEndObject</span>&nbsp;<span class="op" id="4773240">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773245">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773299">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773311">if</span>&nbsp;<span class="ident" id="4773314">op</span>&nbsp;<span class="op" id="4773317">!=</span>&nbsp;<span class="ident" id="4773320">scanBeginLiteral</span>&nbsp;<span class="op" id="4773337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773342">d</span><span class="op" id="4773343">.</span><span class="builtintype" id="4773344">error</span><span class="op" id="4773349">(</span><span class="ident" id="4773350">errPhase</span><span class="op" id="4773358">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773367">//&nbsp;Read&nbsp;string&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773389">start</span>&nbsp;<span class="op" id="4773395">:=</span>&nbsp;<span class="ident" id="4773398">d</span><span class="op" id="4773399">.</span><span class="ident" id="4773400">off</span>&nbsp;<span class="op" id="4773404">-</span>&nbsp;<span class="num" id="4773406">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773410">op</span>&nbsp;<span class="op" id="4773413">=</span>&nbsp;<span class="ident" id="4773415">d</span><span class="op" id="4773416">.</span><span class="ident" id="4773417">scanWhile</span><span class="op" id="4773426">(</span><span class="ident" id="4773427">scanContinue</span><span class="op" id="4773439">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773443">item</span>&nbsp;<span class="op" id="4773448">:=</span>&nbsp;<span class="ident" id="4773451">d</span><span class="op" id="4773452">.</span><span class="ident" id="4773453">data</span><span class="op" id="4773457">[</span><span class="ident" id="4773458">start</span>&nbsp;<span class="op" id="4773464">:</span>&nbsp;<span class="ident" id="4773466">d</span><span class="op" id="4773467">.</span><span class="ident" id="4773468">off</span><span class="op" id="4773471">-</span><span class="num" id="4773472">1</span><span class="op" id="4773473">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773477">key</span><span class="op" id="4773480">,</span>&nbsp;<span class="ident" id="4773482">ok</span>&nbsp;<span class="op" id="4773485">:=</span>&nbsp;<span class="ident" id="4773488">unquote</span><span class="op" id="4773495">(</span><span class="ident" id="4773496">item</span><span class="op" id="4773500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773504">if</span>&nbsp;<span class="op" id="4773507">!</span><span class="ident" id="4773508">ok</span>&nbsp;<span class="op" id="4773511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773516">d</span><span class="op" id="4773517">.</span><span class="builtintype" id="4773518">error</span><span class="op" id="4773523">(</span><span class="ident" id="4773524">errPhase</span><span class="op" id="4773532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773536">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773541">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773567">if</span>&nbsp;<span class="ident" id="4773570">op</span>&nbsp;<span class="op" id="4773573">==</span>&nbsp;<span class="ident" id="4773576">scanSkipSpace</span>&nbsp;<span class="op" id="4773590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773595">op</span>&nbsp;<span class="op" id="4773598">=</span>&nbsp;<span class="ident" id="4773600">d</span><span class="op" id="4773601">.</span><span class="ident" id="4773602">scanWhile</span><span class="op" id="4773611">(</span><span class="ident" id="4773612">scanSkipSpace</span><span class="op" id="4773625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773629">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773633">if</span>&nbsp;<span class="ident" id="4773636">op</span>&nbsp;<span class="op" id="4773639">!=</span>&nbsp;<span class="ident" id="4773642">scanObjectKey</span>&nbsp;<span class="op" id="4773656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773661">d</span><span class="op" id="4773662">.</span><span class="builtintype" id="4773663">error</span><span class="op" id="4773668">(</span><span class="ident" id="4773669">errPhase</span><span class="op" id="4773677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773686">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773703">m</span><span class="op" id="4773704">[</span><span class="ident" id="4773705">key</span><span class="op" id="4773708">]</span>&nbsp;<span class="op" id="4773710">=</span>&nbsp;<span class="ident" id="4773712">d</span><span class="op" id="4773713">.</span><span class="ident" id="4773714">valueInterface</span><span class="op" id="4773728">(</span><span class="op" id="4773729">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773734">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773766">op</span>&nbsp;<span class="op" id="4773769">=</span>&nbsp;<span class="ident" id="4773771">d</span><span class="op" id="4773772">.</span><span class="ident" id="4773773">scanWhile</span><span class="op" id="4773782">(</span><span class="ident" id="4773783">scanSkipSpace</span><span class="op" id="4773796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773800">if</span>&nbsp;<span class="ident" id="4773803">op</span>&nbsp;<span class="op" id="4773806">==</span>&nbsp;<span class="ident" id="4773809">scanEndObject</span>&nbsp;<span class="op" id="4773823">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773828">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773840">if</span>&nbsp;<span class="ident" id="4773843">op</span>&nbsp;<span class="op" id="4773846">!=</span>&nbsp;<span class="ident" id="4773849">scanObjectValue</span>&nbsp;<span class="op" id="4773865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773870">d</span><span class="op" id="4773871">.</span><span class="builtintype" id="4773872">error</span><span class="op" id="4773877">(</span><span class="ident" id="4773878">errPhase</span><span class="op" id="4773886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773890">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773896">return</span>&nbsp;<span class="ident" id="4773903">m</span><br>
<span class="lineno"></span><span class="op" id="4773905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4773908">//&nbsp;literalInterface&nbsp;is&nbsp;like&nbsp;literal&nbsp;but&nbsp;returns&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno">915</span><span class="keyword" id="4773976">func</span>&nbsp;<span class="op" id="4773981">(</span><span class="ident" id="4773982">d</span>&nbsp;<span class="op" id="4773984">*</span><span class="ident" id="4773985">decodeState</span><span class="op" id="4773996">)</span>&nbsp;<span class="ident" id="4773998">literalInterface</span><span class="op" id="4774014">(</span><span class="op" id="4774015">)</span>&nbsp;<span class="keyword" id="4774017">interface</span><span class="op" id="4774026">{</span><span class="op" id="4774027">}</span>&nbsp;<span class="op" id="4774029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4774032">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774090">start</span>&nbsp;<span class="op" id="4774096">:=</span>&nbsp;<span class="ident" id="4774099">d</span><span class="op" id="4774100">.</span><span class="ident" id="4774101">off</span>&nbsp;<span class="op" id="4774105">-</span>&nbsp;<span class="num" id="4774107">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774110">op</span>&nbsp;<span class="op" id="4774113">:=</span>&nbsp;<span class="ident" id="4774116">d</span><span class="op" id="4774117">.</span><span class="ident" id="4774118">scanWhile</span><span class="op" id="4774127">(</span><span class="ident" id="4774128">scanContinue</span><span class="op" id="4774140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4774144">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774185">d</span><span class="op" id="4774186">.</span><span class="ident" id="4774187">off</span><span class="op" id="4774190">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774194">d</span><span class="op" id="4774195">.</span><span class="ident" id="4774196">scan</span><span class="op" id="4774200">.</span><span class="ident" id="4774201">undo</span><span class="op" id="4774205">(</span><span class="ident" id="4774206">op</span><span class="op" id="4774208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774211">item</span>&nbsp;<span class="op" id="4774216">:=</span>&nbsp;<span class="ident" id="4774219">d</span><span class="op" id="4774220">.</span><span class="ident" id="4774221">data</span><span class="op" id="4774225">[</span><span class="ident" id="4774226">start</span><span class="op" id="4774231">:</span><span class="ident" id="4774232">d</span><span class="op" id="4774233">.</span><span class="ident" id="4774234">off</span><span class="op" id="4774237">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774241">switch</span>&nbsp;<span class="ident" id="4774248">c</span>&nbsp;<span class="op" id="4774250">:=</span>&nbsp;<span class="ident" id="4774253">item</span><span class="op" id="4774257">[</span><span class="num" id="4774258">0</span><span class="op" id="4774259">]</span><span class="op" id="4774260">;</span>&nbsp;<span class="ident" id="4774262">c</span>&nbsp;<span class="op" id="4774264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774267">case</span>&nbsp;<span class="string" id="4774272">&#39;n&#39;</span><span class="op" id="4774275">:</span>&nbsp;<span class="comment" id="4774277">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774287">return</span>&nbsp;<span class="ident" id="4774294">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774300">case</span>&nbsp;<span class="string" id="4774305">&#39;t&#39;</span><span class="op" id="4774308">,</span>&nbsp;<span class="string" id="4774310">&#39;f&#39;</span><span class="op" id="4774313">:</span>&nbsp;<span class="comment" id="4774315">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774332">return</span>&nbsp;<span class="ident" id="4774339">c</span>&nbsp;<span class="op" id="4774341">==</span>&nbsp;<span class="string" id="4774344">&#39;t&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774350">case</span>&nbsp;<span class="string" id="4774355">&#39;&#34;&#39;</span><span class="op" id="4774358">:</span>&nbsp;<span class="comment" id="4774360">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774372">s</span><span class="op" id="4774373">,</span>&nbsp;<span class="ident" id="4774375">ok</span>&nbsp;<span class="op" id="4774378">:=</span>&nbsp;<span class="ident" id="4774381">unquote</span><span class="op" id="4774388">(</span><span class="ident" id="4774389">item</span><span class="op" id="4774393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774397">if</span>&nbsp;<span class="op" id="4774400">!</span><span class="ident" id="4774401">ok</span>&nbsp;<span class="op" id="4774404">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774409">d</span><span class="op" id="4774410">.</span><span class="builtintype" id="4774411">error</span><span class="op" id="4774416">(</span><span class="ident" id="4774417">errPhase</span><span class="op" id="4774425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774433">return</span>&nbsp;<span class="ident" id="4774440">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774444">default</span><span class="op" id="4774451">:</span>&nbsp;<span class="comment" id="4774453">//&nbsp;number</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774465">if</span>&nbsp;<span class="ident" id="4774468">c</span>&nbsp;<span class="op" id="4774470">!=</span>&nbsp;<span class="string" id="4774473">&#39;-&#39;</span>&nbsp;<span class="op" id="4774477">&amp;&amp;</span>&nbsp;<span class="op" id="4774480">(</span><span class="ident" id="4774481">c</span>&nbsp;<span class="op" id="4774483">&lt;</span>&nbsp;<span class="string" id="4774485">&#39;0&#39;</span>&nbsp;<span class="op" id="4774489">||</span>&nbsp;<span class="ident" id="4774492">c</span>&nbsp;<span class="op" id="4774494">&gt;</span>&nbsp;<span class="string" id="4774496">&#39;9&#39;</span><span class="op" id="4774499">)</span>&nbsp;<span class="op" id="4774501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774506">d</span><span class="op" id="4774507">.</span><span class="builtintype" id="4774508">error</span><span class="op" id="4774513">(</span><span class="ident" id="4774514">errPhase</span><span class="op" id="4774522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774530">n</span><span class="op" id="4774531">,</span>&nbsp;<span class="ident" id="4774533">err</span>&nbsp;<span class="op" id="4774537">:=</span>&nbsp;<span class="ident" id="4774540">d</span><span class="op" id="4774541">.</span><span class="ident" id="4774542">convertNumber</span><span class="op" id="4774555">(</span><span class="builtintype" id="4774556">string</span><span class="op" id="4774562">(</span><span class="ident" id="4774563">item</span><span class="op" id="4774567">)</span><span class="op" id="4774568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774572">if</span>&nbsp;<span class="ident" id="4774575">err</span>&nbsp;<span class="op" id="4774579">!=</span>&nbsp;<span class="ident" id="4774582">nil</span>&nbsp;<span class="op" id="4774586">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774591">d</span><span class="op" id="4774592">.</span><span class="ident" id="4774593">saveError</span><span class="op" id="4774602">(</span><span class="ident" id="4774603">err</span><span class="op" id="4774606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774614">return</span>&nbsp;<span class="ident" id="4774621">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774624">}</span><br>
<span class="lineno"></span><span class="op" id="4774626">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="comment" id="4774629">//&nbsp;getu4&nbsp;decodes&nbsp;\uXXXX&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s,&nbsp;returning&nbsp;the&nbsp;hex&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="4774703">//&nbsp;or&nbsp;it&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="4774724">func</span>&nbsp;<span class="ident" id="4774729">getu4</span><span class="op" id="4774734">(</span><span class="ident" id="4774735">s</span>&nbsp;<span class="op" id="4774737">[</span><span class="op" id="4774738">]</span><span class="builtintype" id="4774739">byte</span><span class="op" id="4774743">)</span>&nbsp;<span class="builtintype" id="4774745">rune</span>&nbsp;<span class="op" id="4774750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774753">if</span>&nbsp;<span class="builtinfunc" id="4774756">len</span><span class="op" id="4774759">(</span><span class="ident" id="4774760">s</span><span class="op" id="4774761">)</span>&nbsp;<span class="op" id="4774763">&lt;</span>&nbsp;<span class="num" id="4774765">6</span>&nbsp;<span class="op" id="4774767">||</span>&nbsp;<span class="ident" id="4774770">s</span><span class="op" id="4774771">[</span><span class="num" id="4774772">0</span><span class="op" id="4774773">]</span>&nbsp;<span class="op" id="4774775">!=</span>&nbsp;<span class="string" id="4774778">&#39;\\&#39;</span>&nbsp;<span class="op" id="4774783">||</span>&nbsp;<span class="ident" id="4774786">s</span><span class="op" id="4774787">[</span><span class="num" id="4774788">1</span><span class="op" id="4774789">]</span>&nbsp;<span class="op" id="4774791">!=</span>&nbsp;<span class="string" id="4774794">&#39;u&#39;</span>&nbsp;<span class="op" id="4774798">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774802">return</span>&nbsp;<span class="op" id="4774809">-</span><span class="num" id="4774810">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774816">r</span><span class="op" id="4774817">,</span>&nbsp;<span class="ident" id="4774819">err</span>&nbsp;<span class="op" id="4774823">:=</span>&nbsp;<span class="ident" id="4774826">strconv</span><span class="op" id="4774833">.</span><span class="ident" id="4774834">ParseUint</span><span class="op" id="4774843">(</span><span class="builtintype" id="4774844">string</span><span class="op" id="4774850">(</span><span class="ident" id="4774851">s</span><span class="op" id="4774852">[</span><span class="num" id="4774853">2</span><span class="op" id="4774854">:</span><span class="num" id="4774855">6</span><span class="op" id="4774856">]</span><span class="op" id="4774857">)</span><span class="op" id="4774858">,</span>&nbsp;<span class="num" id="4774860">16</span><span class="op" id="4774862">,</span>&nbsp;<span class="num" id="4774864">64</span><span class="op" id="4774866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774869">if</span>&nbsp;<span class="ident" id="4774872">err</span>&nbsp;<span class="op" id="4774876">!=</span>&nbsp;<span class="ident" id="4774879">nil</span>&nbsp;<span class="op" id="4774883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774887">return</span>&nbsp;<span class="op" id="4774894">-</span><span class="num" id="4774895">1</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774901">return</span>&nbsp;<span class="builtintype" id="4774908">rune</span><span class="op" id="4774912">(</span><span class="ident" id="4774913">r</span><span class="op" id="4774914">)</span><br>
<span class="lineno"></span><span class="op" id="4774916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4774919">//&nbsp;unquote&nbsp;converts&nbsp;a&nbsp;quoted&nbsp;JSON&nbsp;string&nbsp;literal&nbsp;s&nbsp;into&nbsp;an&nbsp;actual&nbsp;string&nbsp;t.</span><br>
<span class="lineno">965</span><span class="comment" id="4774995">//&nbsp;The&nbsp;rules&nbsp;are&nbsp;different&nbsp;than&nbsp;for&nbsp;Go,&nbsp;so&nbsp;cannot&nbsp;use&nbsp;strconv.Unquote.</span><br>
<span class="lineno"></span><span class="keyword" id="4775066">func</span>&nbsp;<span class="ident" id="4775071">unquote</span><span class="op" id="4775078">(</span><span class="ident" id="4775079">s</span>&nbsp;<span class="op" id="4775081">[</span><span class="op" id="4775082">]</span><span class="builtintype" id="4775083">byte</span><span class="op" id="4775087">)</span>&nbsp;<span class="op" id="4775089">(</span><span class="ident" id="4775090">t</span>&nbsp;<span class="builtintype" id="4775092">string</span><span class="op" id="4775098">,</span>&nbsp;<span class="ident" id="4775100">ok</span>&nbsp;<span class="builtintype" id="4775103">bool</span><span class="op" id="4775107">)</span>&nbsp;<span class="op" id="4775109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775112">s</span><span class="op" id="4775113">,</span>&nbsp;<span class="ident" id="4775115">ok</span>&nbsp;<span class="op" id="4775118">=</span>&nbsp;<span class="ident" id="4775120">unquoteBytes</span><span class="op" id="4775132">(</span><span class="ident" id="4775133">s</span><span class="op" id="4775134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775137">t</span>&nbsp;<span class="op" id="4775139">=</span>&nbsp;<span class="builtintype" id="4775141">string</span><span class="op" id="4775147">(</span><span class="ident" id="4775148">s</span><span class="op" id="4775149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775152">return</span><br>
<span class="lineno">970</span><span class="op" id="4775159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4775162">func</span>&nbsp;<span class="ident" id="4775167">unquoteBytes</span><span class="op" id="4775179">(</span><span class="ident" id="4775180">s</span>&nbsp;<span class="op" id="4775182">[</span><span class="op" id="4775183">]</span><span class="builtintype" id="4775184">byte</span><span class="op" id="4775188">)</span>&nbsp;<span class="op" id="4775190">(</span><span class="ident" id="4775191">t</span>&nbsp;<span class="op" id="4775193">[</span><span class="op" id="4775194">]</span><span class="builtintype" id="4775195">byte</span><span class="op" id="4775199">,</span>&nbsp;<span class="ident" id="4775201">ok</span>&nbsp;<span class="builtintype" id="4775204">bool</span><span class="op" id="4775208">)</span>&nbsp;<span class="op" id="4775210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775213">if</span>&nbsp;<span class="builtinfunc" id="4775216">len</span><span class="op" id="4775219">(</span><span class="ident" id="4775220">s</span><span class="op" id="4775221">)</span>&nbsp;<span class="op" id="4775223">&lt;</span>&nbsp;<span class="num" id="4775225">2</span>&nbsp;<span class="op" id="4775227">||</span>&nbsp;<span class="ident" id="4775230">s</span><span class="op" id="4775231">[</span><span class="num" id="4775232">0</span><span class="op" id="4775233">]</span>&nbsp;<span class="op" id="4775235">!=</span>&nbsp;<span class="string" id="4775238">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4775242">||</span>&nbsp;<span class="ident" id="4775245">s</span><span class="op" id="4775246">[</span><span class="builtinfunc" id="4775247">len</span><span class="op" id="4775250">(</span><span class="ident" id="4775251">s</span><span class="op" id="4775252">)</span><span class="op" id="4775253">-</span><span class="num" id="4775254">1</span><span class="op" id="4775255">]</span>&nbsp;<span class="op" id="4775257">!=</span>&nbsp;<span class="string" id="4775260">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4775264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775268">return</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775279">s</span>&nbsp;<span class="op" id="4775281">=</span>&nbsp;<span class="ident" id="4775283">s</span><span class="op" id="4775284">[</span><span class="num" id="4775285">1</span>&nbsp;<span class="op" id="4775287">:</span>&nbsp;<span class="builtinfunc" id="4775289">len</span><span class="op" id="4775292">(</span><span class="ident" id="4775293">s</span><span class="op" id="4775294">)</span><span class="op" id="4775295">-</span><span class="num" id="4775296">1</span><span class="op" id="4775297">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4775301">//&nbsp;Check&nbsp;for&nbsp;unusual&nbsp;characters.&nbsp;If&nbsp;there&nbsp;are&nbsp;none,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4775354">//&nbsp;then&nbsp;no&nbsp;unquoting&nbsp;is&nbsp;needed,&nbsp;so&nbsp;return&nbsp;a&nbsp;slice&nbsp;of&nbsp;the</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4775412">//&nbsp;original&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775432">r</span>&nbsp;<span class="op" id="4775434">:=</span>&nbsp;<span class="num" id="4775437">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775440">for</span>&nbsp;<span class="ident" id="4775444">r</span>&nbsp;<span class="op" id="4775446">&lt;</span>&nbsp;<span class="builtinfunc" id="4775448">len</span><span class="op" id="4775451">(</span><span class="ident" id="4775452">s</span><span class="op" id="4775453">)</span>&nbsp;<span class="op" id="4775455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775459">c</span>&nbsp;<span class="op" id="4775461">:=</span>&nbsp;<span class="ident" id="4775464">s</span><span class="op" id="4775465">[</span><span class="ident" id="4775466">r</span><span class="op" id="4775467">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775471">if</span>&nbsp;<span class="ident" id="4775474">c</span>&nbsp;<span class="op" id="4775476">==</span>&nbsp;<span class="string" id="4775479">&#39;\\&#39;</span>&nbsp;<span class="op" id="4775484">||</span>&nbsp;<span class="ident" id="4775487">c</span>&nbsp;<span class="op" id="4775489">==</span>&nbsp;<span class="string" id="4775492">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4775496">||</span>&nbsp;<span class="ident" id="4775499">c</span>&nbsp;<span class="op" id="4775501">&lt;</span>&nbsp;<span class="string" id="4775503">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4775507">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775512">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775524">if</span>&nbsp;<span class="ident" id="4775527">c</span>&nbsp;<span class="op" id="4775529">&lt;</span>&nbsp;<span class="ident" id="4775531">utf8</span><span class="op" id="4775535">.</span><span class="ident" id="4775536">RuneSelf</span>&nbsp;<span class="op" id="4775545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775550">r</span><span class="op" id="4775551">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775557">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775572">rr</span><span class="op" id="4775574">,</span>&nbsp;<span class="ident" id="4775576">size</span>&nbsp;<span class="op" id="4775581">:=</span>&nbsp;<span class="ident" id="4775584">utf8</span><span class="op" id="4775588">.</span><span class="ident" id="4775589">DecodeRune</span><span class="op" id="4775599">(</span><span class="ident" id="4775600">s</span><span class="op" id="4775601">[</span><span class="ident" id="4775602">r</span><span class="op" id="4775603">:</span><span class="op" id="4775604">]</span><span class="op" id="4775605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775609">if</span>&nbsp;<span class="ident" id="4775612">rr</span>&nbsp;<span class="op" id="4775615">==</span>&nbsp;<span class="ident" id="4775618">utf8</span><span class="op" id="4775622">.</span><span class="ident" id="4775623">RuneError</span>&nbsp;<span class="op" id="4775633">&amp;&amp;</span>&nbsp;<span class="ident" id="4775636">size</span>&nbsp;<span class="op" id="4775641">==</span>&nbsp;<span class="num" id="4775644">1</span>&nbsp;<span class="op" id="4775646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775651">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775659">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775663">r</span>&nbsp;<span class="op" id="4775665">+=</span>&nbsp;<span class="ident" id="4775668">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775677">if</span>&nbsp;<span class="ident" id="4775680">r</span>&nbsp;<span class="op" id="4775682">==</span>&nbsp;<span class="builtinfunc" id="4775685">len</span><span class="op" id="4775688">(</span><span class="ident" id="4775689">s</span><span class="op" id="4775690">)</span>&nbsp;<span class="op" id="4775692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775696">return</span>&nbsp;<span class="ident" id="4775703">s</span><span class="op" id="4775704">,</span>&nbsp;<span class="builtintype" id="4775706">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775712">}</span><br>
<span class="lineno">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775716">b</span>&nbsp;<span class="op" id="4775718">:=</span>&nbsp;<span class="builtinfunc" id="4775721">make</span><span class="op" id="4775725">(</span><span class="op" id="4775726">[</span><span class="op" id="4775727">]</span><span class="builtintype" id="4775728">byte</span><span class="op" id="4775732">,</span>&nbsp;<span class="builtinfunc" id="4775734">len</span><span class="op" id="4775737">(</span><span class="ident" id="4775738">s</span><span class="op" id="4775739">)</span><span class="op" id="4775740">+</span><span class="num" id="4775741">2</span><span class="op" id="4775742">*</span><span class="ident" id="4775743">utf8</span><span class="op" id="4775747">.</span><span class="ident" id="4775748">UTFMax</span><span class="op" id="4775754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775757">w</span>&nbsp;<span class="op" id="4775759">:=</span>&nbsp;<span class="builtinfunc" id="4775762">copy</span><span class="op" id="4775766">(</span><span class="ident" id="4775767">b</span><span class="op" id="4775768">,</span>&nbsp;<span class="ident" id="4775770">s</span><span class="op" id="4775771">[</span><span class="num" id="4775772">0</span><span class="op" id="4775773">:</span><span class="ident" id="4775774">r</span><span class="op" id="4775775">]</span><span class="op" id="4775776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775779">for</span>&nbsp;<span class="ident" id="4775783">r</span>&nbsp;<span class="op" id="4775785">&lt;</span>&nbsp;<span class="builtinfunc" id="4775787">len</span><span class="op" id="4775790">(</span><span class="ident" id="4775791">s</span><span class="op" id="4775792">)</span>&nbsp;<span class="op" id="4775794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4775798">//&nbsp;Out&nbsp;of&nbsp;room?&nbsp;&nbsp;Can&nbsp;only&nbsp;happen&nbsp;if&nbsp;s&nbsp;is&nbsp;full&nbsp;of</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4775849">//&nbsp;malformed&nbsp;UTF-8&nbsp;and&nbsp;we&#39;re&nbsp;replacing&nbsp;each</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4775895">//&nbsp;byte&nbsp;with&nbsp;RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775921">if</span>&nbsp;<span class="ident" id="4775924">w</span>&nbsp;<span class="op" id="4775926">&gt;=</span>&nbsp;<span class="builtinfunc" id="4775929">len</span><span class="op" id="4775932">(</span><span class="ident" id="4775933">b</span><span class="op" id="4775934">)</span><span class="op" id="4775935">-</span><span class="num" id="4775936">2</span><span class="op" id="4775937">*</span><span class="ident" id="4775938">utf8</span><span class="op" id="4775942">.</span><span class="ident" id="4775943">UTFMax</span>&nbsp;<span class="op" id="4775950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775955">nb</span>&nbsp;<span class="op" id="4775958">:=</span>&nbsp;<span class="builtinfunc" id="4775961">make</span><span class="op" id="4775965">(</span><span class="op" id="4775966">[</span><span class="op" id="4775967">]</span><span class="builtintype" id="4775968">byte</span><span class="op" id="4775972">,</span>&nbsp;<span class="op" id="4775974">(</span><span class="builtinfunc" id="4775975">len</span><span class="op" id="4775978">(</span><span class="ident" id="4775979">b</span><span class="op" id="4775980">)</span><span class="op" id="4775981">+</span><span class="ident" id="4775982">utf8</span><span class="op" id="4775986">.</span><span class="ident" id="4775987">UTFMax</span><span class="op" id="4775993">)</span><span class="op" id="4775994">*</span><span class="num" id="4775995">2</span><span class="op" id="4775996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4776001">copy</span><span class="op" id="4776005">(</span><span class="ident" id="4776006">nb</span><span class="op" id="4776008">,</span>&nbsp;<span class="ident" id="4776010">b</span><span class="op" id="4776011">[</span><span class="num" id="4776012">0</span><span class="op" id="4776013">:</span><span class="ident" id="4776014">w</span><span class="op" id="4776015">]</span><span class="op" id="4776016">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776021">b</span>&nbsp;<span class="op" id="4776023">=</span>&nbsp;<span class="ident" id="4776025">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776034">switch</span>&nbsp;<span class="ident" id="4776041">c</span>&nbsp;<span class="op" id="4776043">:=</span>&nbsp;<span class="ident" id="4776046">s</span><span class="op" id="4776047">[</span><span class="ident" id="4776048">r</span><span class="op" id="4776049">]</span><span class="op" id="4776050">;</span>&nbsp;<span class="op" id="4776052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776056">case</span>&nbsp;<span class="ident" id="4776061">c</span>&nbsp;<span class="op" id="4776063">==</span>&nbsp;<span class="string" id="4776066">&#39;\\&#39;</span><span class="op" id="4776070">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776075">r</span><span class="op" id="4776076">++</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776082">if</span>&nbsp;<span class="ident" id="4776085">r</span>&nbsp;<span class="op" id="4776087">&gt;=</span>&nbsp;<span class="builtinfunc" id="4776090">len</span><span class="op" id="4776093">(</span><span class="ident" id="4776094">s</span><span class="op" id="4776095">)</span>&nbsp;<span class="op" id="4776097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776103">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776118">switch</span>&nbsp;<span class="ident" id="4776125">s</span><span class="op" id="4776126">[</span><span class="ident" id="4776127">r</span><span class="op" id="4776128">]</span>&nbsp;<span class="op" id="4776130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776135">default</span><span class="op" id="4776142">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776148">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776158">case</span>&nbsp;<span class="string" id="4776163">&#39;&#34;&#39;</span><span class="op" id="4776166">,</span>&nbsp;<span class="string" id="4776168">&#39;\\&#39;</span><span class="op" id="4776172">,</span>&nbsp;<span class="string" id="4776174">&#39;/&#39;</span><span class="op" id="4776177">,</span>&nbsp;<span class="string" id="4776179">&#39;\&#39;&#39;</span><span class="op" id="4776183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776189">b</span><span class="op" id="4776190">[</span><span class="ident" id="4776191">w</span><span class="op" id="4776192">]</span>&nbsp;<span class="op" id="4776194">=</span>&nbsp;<span class="ident" id="4776196">s</span><span class="op" id="4776197">[</span><span class="ident" id="4776198">r</span><span class="op" id="4776199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776205">r</span><span class="op" id="4776206">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776213">w</span><span class="op" id="4776214">++</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776220">case</span>&nbsp;<span class="string" id="4776225">&#39;b&#39;</span><span class="op" id="4776228">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776234">b</span><span class="op" id="4776235">[</span><span class="ident" id="4776236">w</span><span class="op" id="4776237">]</span>&nbsp;<span class="op" id="4776239">=</span>&nbsp;<span class="string" id="4776241">&#39;\b&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776250">r</span><span class="op" id="4776251">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776258">w</span><span class="op" id="4776259">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776265">case</span>&nbsp;<span class="string" id="4776270">&#39;f&#39;</span><span class="op" id="4776273">:</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776279">b</span><span class="op" id="4776280">[</span><span class="ident" id="4776281">w</span><span class="op" id="4776282">]</span>&nbsp;<span class="op" id="4776284">=</span>&nbsp;<span class="string" id="4776286">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776295">r</span><span class="op" id="4776296">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776303">w</span><span class="op" id="4776304">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776310">case</span>&nbsp;<span class="string" id="4776315">&#39;n&#39;</span><span class="op" id="4776318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776324">b</span><span class="op" id="4776325">[</span><span class="ident" id="4776326">w</span><span class="op" id="4776327">]</span>&nbsp;<span class="op" id="4776329">=</span>&nbsp;<span class="string" id="4776331">&#39;\n&#39;</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776340">r</span><span class="op" id="4776341">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776348">w</span><span class="op" id="4776349">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776355">case</span>&nbsp;<span class="string" id="4776360">&#39;r&#39;</span><span class="op" id="4776363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776369">b</span><span class="op" id="4776370">[</span><span class="ident" id="4776371">w</span><span class="op" id="4776372">]</span>&nbsp;<span class="op" id="4776374">=</span>&nbsp;<span class="string" id="4776376">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776385">r</span><span class="op" id="4776386">++</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776393">w</span><span class="op" id="4776394">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776400">case</span>&nbsp;<span class="string" id="4776405">&#39;t&#39;</span><span class="op" id="4776408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776414">b</span><span class="op" id="4776415">[</span><span class="ident" id="4776416">w</span><span class="op" id="4776417">]</span>&nbsp;<span class="op" id="4776419">=</span>&nbsp;<span class="string" id="4776421">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776430">r</span><span class="op" id="4776431">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776438">w</span><span class="op" id="4776439">++</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776445">case</span>&nbsp;<span class="string" id="4776450">&#39;u&#39;</span><span class="op" id="4776453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776459">r</span><span class="op" id="4776460">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776467">rr</span>&nbsp;<span class="op" id="4776470">:=</span>&nbsp;<span class="ident" id="4776473">getu4</span><span class="op" id="4776478">(</span><span class="ident" id="4776479">s</span><span class="op" id="4776480">[</span><span class="ident" id="4776481">r</span><span class="op" id="4776482">:</span><span class="op" id="4776483">]</span><span class="op" id="4776484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776490">if</span>&nbsp;<span class="ident" id="4776493">rr</span>&nbsp;<span class="op" id="4776496">&lt;</span>&nbsp;<span class="num" id="4776498">0</span>&nbsp;<span class="op" id="4776500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776507">return</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776524">r</span>&nbsp;<span class="op" id="4776526">+=</span>&nbsp;<span class="num" id="4776529">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776535">if</span>&nbsp;<span class="ident" id="4776538">utf16</span><span class="op" id="4776543">.</span><span class="ident" id="4776544">IsSurrogate</span><span class="op" id="4776555">(</span><span class="ident" id="4776556">rr</span><span class="op" id="4776558">)</span>&nbsp;<span class="op" id="4776560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776567">rr1</span>&nbsp;<span class="op" id="4776571">:=</span>&nbsp;<span class="ident" id="4776574">getu4</span><span class="op" id="4776579">(</span><span class="ident" id="4776580">s</span><span class="op" id="4776581">[</span><span class="ident" id="4776582">r</span><span class="op" id="4776583">:</span><span class="op" id="4776584">]</span><span class="op" id="4776585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776592">if</span>&nbsp;<span class="ident" id="4776595">dec</span>&nbsp;<span class="op" id="4776599">:=</span>&nbsp;<span class="ident" id="4776602">utf16</span><span class="op" id="4776607">.</span><span class="ident" id="4776608">DecodeRune</span><span class="op" id="4776618">(</span><span class="ident" id="4776619">rr</span><span class="op" id="4776621">,</span>&nbsp;<span class="ident" id="4776623">rr1</span><span class="op" id="4776626">)</span><span class="op" id="4776627">;</span>&nbsp;<span class="ident" id="4776629">dec</span>&nbsp;<span class="op" id="4776633">!=</span>&nbsp;<span class="ident" id="4776636">unicode</span><span class="op" id="4776643">.</span><span class="ident" id="4776644">ReplacementChar</span>&nbsp;<span class="op" id="4776660">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4776668">//&nbsp;A&nbsp;valid&nbsp;pair;&nbsp;consume.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776700">r</span>&nbsp;<span class="op" id="4776702">+=</span>&nbsp;<span class="num" id="4776705">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776713">w</span>&nbsp;<span class="op" id="4776715">+=</span>&nbsp;<span class="ident" id="4776718">utf8</span><span class="op" id="4776722">.</span><span class="ident" id="4776723">EncodeRune</span><span class="op" id="4776733">(</span><span class="ident" id="4776734">b</span><span class="op" id="4776735">[</span><span class="ident" id="4776736">w</span><span class="op" id="4776737">:</span><span class="op" id="4776738">]</span><span class="op" id="4776739">,</span>&nbsp;<span class="ident" id="4776741">dec</span><span class="op" id="4776744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776752">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776763">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4776770">//&nbsp;Invalid&nbsp;surrogate;&nbsp;fall&nbsp;back&nbsp;to&nbsp;replacement&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776828">rr</span>&nbsp;<span class="op" id="4776831">=</span>&nbsp;<span class="ident" id="4776833">unicode</span><span class="op" id="4776840">.</span><span class="ident" id="4776841">ReplacementChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776867">w</span>&nbsp;<span class="op" id="4776869">+=</span>&nbsp;<span class="ident" id="4776872">utf8</span><span class="op" id="4776876">.</span><span class="ident" id="4776877">EncodeRune</span><span class="op" id="4776887">(</span><span class="ident" id="4776888">b</span><span class="op" id="4776889">[</span><span class="ident" id="4776890">w</span><span class="op" id="4776891">:</span><span class="op" id="4776892">]</span><span class="op" id="4776893">,</span>&nbsp;<span class="ident" id="4776895">rr</span><span class="op" id="4776897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776902">}</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4776907">//&nbsp;Quote,&nbsp;control&nbsp;characters&nbsp;are&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776951">case</span>&nbsp;<span class="ident" id="4776956">c</span>&nbsp;<span class="op" id="4776958">==</span>&nbsp;<span class="string" id="4776961">&#39;&#34;&#39;</span><span class="op" id="4776964">,</span>&nbsp;<span class="ident" id="4776966">c</span>&nbsp;<span class="op" id="4776968">&lt;</span>&nbsp;<span class="string" id="4776970">&#39;&nbsp;&#39;</span><span class="op" id="4776973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776978">return</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4776988">//&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776999">case</span>&nbsp;<span class="ident" id="4777004">c</span>&nbsp;<span class="op" id="4777006">&lt;</span>&nbsp;<span class="ident" id="4777008">utf8</span><span class="op" id="4777012">.</span><span class="ident" id="4777013">RuneSelf</span><span class="op" id="4777021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777026">b</span><span class="op" id="4777027">[</span><span class="ident" id="4777028">w</span><span class="op" id="4777029">]</span>&nbsp;<span class="op" id="4777031">=</span>&nbsp;<span class="ident" id="4777033">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777038">r</span><span class="op" id="4777039">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777045">w</span><span class="op" id="4777046">++</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4777052">//&nbsp;Coerce&nbsp;to&nbsp;well-formed&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777086">default</span><span class="op" id="4777093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777098">rr</span><span class="op" id="4777100">,</span>&nbsp;<span class="ident" id="4777102">size</span>&nbsp;<span class="op" id="4777107">:=</span>&nbsp;<span class="ident" id="4777110">utf8</span><span class="op" id="4777114">.</span><span class="ident" id="4777115">DecodeRune</span><span class="op" id="4777125">(</span><span class="ident" id="4777126">s</span><span class="op" id="4777127">[</span><span class="ident" id="4777128">r</span><span class="op" id="4777129">:</span><span class="op" id="4777130">]</span><span class="op" id="4777131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777136">r</span>&nbsp;<span class="op" id="4777138">+=</span>&nbsp;<span class="ident" id="4777141">size</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777149">w</span>&nbsp;<span class="op" id="4777151">+=</span>&nbsp;<span class="ident" id="4777154">utf8</span><span class="op" id="4777158">.</span><span class="ident" id="4777159">EncodeRune</span><span class="op" id="4777169">(</span><span class="ident" id="4777170">b</span><span class="op" id="4777171">[</span><span class="ident" id="4777172">w</span><span class="op" id="4777173">:</span><span class="op" id="4777174">]</span><span class="op" id="4777175">,</span>&nbsp;<span class="ident" id="4777177">rr</span><span class="op" id="4777179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777189">return</span>&nbsp;<span class="ident" id="4777196">b</span><span class="op" id="4777197">[</span><span class="num" id="4777198">0</span><span class="op" id="4777199">:</span><span class="ident" id="4777200">w</span><span class="op" id="4777201">]</span><span class="op" id="4777202">,</span>&nbsp;<span class="builtintype" id="4777204">true</span><br>
<span class="lineno"></span><span class="op" id="4777209">}</span>
</div>
</body>
</html>
