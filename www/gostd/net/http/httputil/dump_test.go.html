<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httputil</h2>
<ul>
<li><a href="/gostd/net/http/httputil/dump.go.html">dump.go</a></li>
<li><a href="/gostd/net/http/httputil/dump_test.go.html" class="current">dump_test.go</a></li>
<li><a href="/gostd/net/http/httputil/httputil.go.html">httputil.go</a></li>
<li><a href="/gostd/net/http/httputil/persist.go.html">persist.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy.go.html">reverseproxy.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy_test.go.html">reverseproxy_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7510561">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7510616">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7510670">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7510721">package</span>&nbsp;<span class="ident" id="7510729">httputil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7510739">import</span>&nbsp;<span class="op" id="7510746">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510749">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510758">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510765">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510771">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510784">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510796">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510807">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510818">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7510829">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7510839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7510842">type</span>&nbsp;<span class="ident" id="7510847">dumpTest</span>&nbsp;<span class="keyword" id="7510856">struct</span>&nbsp;<span class="op" id="7510863">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510866">Req</span>&nbsp;&nbsp;<span class="ident" id="7510871">http</span><span class="op" id="7510875">.</span><span class="ident" id="7510876">Request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510885">Body</span>&nbsp;<span class="keyword" id="7510890">interface</span><span class="op" id="7510899">{</span><span class="op" id="7510900">}</span>&nbsp;<span class="comment" id="7510902">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510968">WantDump</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7510980">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510988">WantDumpOut</span>&nbsp;<span class="builtintype" id="7511000">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511008">NoBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7511020">bool</span>&nbsp;<span class="comment" id="7511025">//&nbsp;if&nbsp;true,&nbsp;set&nbsp;DumpRequest{,Out}&nbsp;body&nbsp;to&nbsp;false</span><br>
<span class="lineno"></span><span class="op" id="7511073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7511076">var</span>&nbsp;<span class="ident" id="7511080">dumpTests</span>&nbsp;<span class="op" id="7511090">=</span>&nbsp;<span class="op" id="7511092">[</span><span class="op" id="7511093">]</span><span class="ident" id="7511094">dumpTest</span><span class="op" id="7511102">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7511106">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511162">Req</span><span class="op" id="7511165">:</span>&nbsp;<span class="ident" id="7511167">http</span><span class="op" id="7511171">.</span><span class="ident" id="7511172">Request</span><span class="op" id="7511179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511184">Method</span><span class="op" id="7511190">:</span>&nbsp;<span class="string" id="7511192">&#34;GET&#34;</span><span class="op" id="7511197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511202">URL</span><span class="op" id="7511205">:</span>&nbsp;<span class="op" id="7511207">&amp;</span><span class="ident" id="7511208">url</span><span class="op" id="7511211">.</span><span class="ident" id="7511212">URL</span><span class="op" id="7511215">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511221">Scheme</span><span class="op" id="7511227">:</span>&nbsp;<span class="string" id="7511229">&#34;http&#34;</span><span class="op" id="7511235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511241">Host</span><span class="op" id="7511245">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7511249">&#34;www.google.com&#34;</span><span class="op" id="7511265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511271">Path</span><span class="op" id="7511275">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7511279">&#34;/search&#34;</span><span class="op" id="7511288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511293">}</span><span class="op" id="7511294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511299">ProtoMajor</span><span class="op" id="7511309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7511317">1</span><span class="op" id="7511318">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511323">ProtoMinor</span><span class="op" id="7511333">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7511341">1</span><span class="op" id="7511342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511347">TransferEncoding</span><span class="op" id="7511363">:</span>&nbsp;<span class="op" id="7511365">[</span><span class="op" id="7511366">]</span><span class="builtintype" id="7511367">string</span><span class="op" id="7511373">{</span><span class="string" id="7511374">&#34;chunked&#34;</span><span class="op" id="7511383">}</span><span class="op" id="7511384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511388">}</span><span class="op" id="7511389">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511394">Body</span><span class="op" id="7511398">:</span>&nbsp;<span class="op" id="7511400">[</span><span class="op" id="7511401">]</span><span class="builtintype" id="7511402">byte</span><span class="op" id="7511406">(</span><span class="string" id="7511407">&#34;abcdef&#34;</span><span class="op" id="7511415">)</span><span class="op" id="7511416">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511421">WantDump</span><span class="op" id="7511429">:</span>&nbsp;<span class="string" id="7511431">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7511458">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7511463">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7511490">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7511495">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7511532">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511537">chunk</span><span class="op" id="7511542">(</span><span class="string" id="7511543">&#34;abcdef&#34;</span><span class="op" id="7511551">)</span>&nbsp;<span class="op" id="7511553">+</span>&nbsp;<span class="ident" id="7511555">chunk</span><span class="op" id="7511560">(</span><span class="string" id="7511561">&#34;&#34;</span><span class="op" id="7511563">)</span><span class="op" id="7511564">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511567">}</span><span class="op" id="7511568">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7511572">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7511655">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511689">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511693">Req</span><span class="op" id="7511696">:</span>&nbsp;<span class="ident" id="7511698">http</span><span class="op" id="7511702">.</span><span class="ident" id="7511703">Request</span><span class="op" id="7511710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511715">Method</span><span class="op" id="7511721">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7511727">&#34;GET&#34;</span><span class="op" id="7511732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511737">URL</span><span class="op" id="7511740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511749">mustParseURL</span><span class="op" id="7511761">(</span><span class="string" id="7511762">&#34;/foo&#34;</span><span class="op" id="7511768">)</span><span class="op" id="7511769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511774">ProtoMajor</span><span class="op" id="7511784">:</span>&nbsp;<span class="num" id="7511786">1</span><span class="op" id="7511787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511792">ProtoMinor</span><span class="op" id="7511802">:</span>&nbsp;<span class="num" id="7511804">0</span><span class="op" id="7511805">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511810">Header</span><span class="op" id="7511816">:</span>&nbsp;<span class="ident" id="7511818">http</span><span class="op" id="7511822">.</span><span class="ident" id="7511823">Header</span><span class="op" id="7511829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7511835">&#34;X-Foo&#34;</span><span class="op" id="7511842">:</span>&nbsp;<span class="op" id="7511844">[</span><span class="op" id="7511845">]</span><span class="builtintype" id="7511846">string</span><span class="op" id="7511852">{</span><span class="string" id="7511853">&#34;X-Bar&#34;</span><span class="op" id="7511860">}</span><span class="op" id="7511861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511866">}</span><span class="op" id="7511867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511871">}</span><span class="op" id="7511872">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511877">WantDump</span><span class="op" id="7511885">:</span>&nbsp;<span class="string" id="7511887">&#34;GET&nbsp;/foo&nbsp;HTTP/1.0\r\n&#34;</span>&nbsp;<span class="op" id="7511911">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7511916">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7511938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511941">}</span><span class="op" id="7511942">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511946">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511950">Req</span><span class="op" id="7511953">:</span>&nbsp;<span class="op" id="7511955">*</span><span class="ident" id="7511956">mustNewRequest</span><span class="op" id="7511970">(</span><span class="string" id="7511971">&#34;GET&#34;</span><span class="op" id="7511976">,</span>&nbsp;<span class="string" id="7511978">&#34;http://example.com/foo&#34;</span><span class="op" id="7512002">,</span>&nbsp;<span class="ident" id="7512004">nil</span><span class="op" id="7512007">)</span><span class="op" id="7512008">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512013">WantDumpOut</span><span class="op" id="7512024">:</span>&nbsp;<span class="string" id="7512026">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7512050">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512055">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7512079">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512084">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7512122">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512127">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7512158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7512161">}</span><span class="op" id="7512162">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7512166">//&nbsp;Test&nbsp;that&nbsp;an&nbsp;https&nbsp;URL&nbsp;doesn&#39;t&nbsp;try&nbsp;to&nbsp;do&nbsp;an&nbsp;SSL&nbsp;negotiation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7512230">//&nbsp;with&nbsp;a&nbsp;bytes.Buffer&nbsp;and&nbsp;hang&nbsp;with&nbsp;all&nbsp;goroutines&nbsp;not</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7512287">//&nbsp;runnable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7512301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512305">Req</span><span class="op" id="7512308">:</span>&nbsp;<span class="op" id="7512310">*</span><span class="ident" id="7512311">mustNewRequest</span><span class="op" id="7512325">(</span><span class="string" id="7512326">&#34;GET&#34;</span><span class="op" id="7512331">,</span>&nbsp;<span class="string" id="7512333">&#34;https://example.com/foo&#34;</span><span class="op" id="7512358">,</span>&nbsp;<span class="ident" id="7512360">nil</span><span class="op" id="7512363">)</span><span class="op" id="7512364">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512369">WantDumpOut</span><span class="op" id="7512380">:</span>&nbsp;<span class="string" id="7512382">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7512406">+</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512411">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7512435">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512440">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7512478">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512483">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7512514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7512517">}</span><span class="op" id="7512518">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7512522">//&nbsp;Request&nbsp;with&nbsp;Body,&nbsp;but&nbsp;Dump&nbsp;requested&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7512576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512580">Req</span><span class="op" id="7512583">:</span>&nbsp;<span class="ident" id="7512585">http</span><span class="op" id="7512589">.</span><span class="ident" id="7512590">Request</span><span class="op" id="7512597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512602">Method</span><span class="op" id="7512608">:</span>&nbsp;<span class="string" id="7512610">&#34;POST&#34;</span><span class="op" id="7512616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512621">URL</span><span class="op" id="7512624">:</span>&nbsp;<span class="op" id="7512626">&amp;</span><span class="ident" id="7512627">url</span><span class="op" id="7512630">.</span><span class="ident" id="7512631">URL</span><span class="op" id="7512634">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512640">Scheme</span><span class="op" id="7512646">:</span>&nbsp;<span class="string" id="7512648">&#34;http&#34;</span><span class="op" id="7512654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512660">Host</span><span class="op" id="7512664">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7512668">&#34;post.tld&#34;</span><span class="op" id="7512678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512684">Path</span><span class="op" id="7512688">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7512692">&#34;/&#34;</span><span class="op" id="7512695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7512700">}</span><span class="op" id="7512701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512706">ContentLength</span><span class="op" id="7512719">:</span>&nbsp;<span class="num" id="7512721">6</span><span class="op" id="7512722">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512727">ProtoMajor</span><span class="op" id="7512737">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7512742">1</span><span class="op" id="7512743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512748">ProtoMinor</span><span class="op" id="7512758">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7512763">1</span><span class="op" id="7512764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7512768">}</span><span class="op" id="7512769">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512774">Body</span><span class="op" id="7512778">:</span>&nbsp;<span class="op" id="7512780">[</span><span class="op" id="7512781">]</span><span class="builtintype" id="7512782">byte</span><span class="op" id="7512786">(</span><span class="string" id="7512787">&#34;abcdef&#34;</span><span class="op" id="7512795">)</span><span class="op" id="7512796">,</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512801">WantDumpOut</span><span class="op" id="7512812">:</span>&nbsp;<span class="string" id="7512814">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7512836">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512841">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="7512862">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512867">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7512905">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512910">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7512934">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7512939">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7512970">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7512975">NoBody</span><span class="op" id="7512981">:</span>&nbsp;<span class="builtintype" id="7512983">true</span><span class="op" id="7512987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7512990">}</span><span class="op" id="7512991">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7512995">//&nbsp;Request&nbsp;with&nbsp;Body&nbsp;&gt;&nbsp;8196&nbsp;(default&nbsp;buffer&nbsp;size)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513050">Req</span><span class="op" id="7513053">:</span>&nbsp;<span class="ident" id="7513055">http</span><span class="op" id="7513059">.</span><span class="ident" id="7513060">Request</span><span class="op" id="7513067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513072">Method</span><span class="op" id="7513078">:</span>&nbsp;<span class="string" id="7513080">&#34;POST&#34;</span><span class="op" id="7513086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513091">URL</span><span class="op" id="7513094">:</span>&nbsp;<span class="op" id="7513096">&amp;</span><span class="ident" id="7513097">url</span><span class="op" id="7513100">.</span><span class="ident" id="7513101">URL</span><span class="op" id="7513104">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513110">Scheme</span><span class="op" id="7513116">:</span>&nbsp;<span class="string" id="7513118">&#34;http&#34;</span><span class="op" id="7513124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513130">Host</span><span class="op" id="7513134">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7513138">&#34;post.tld&#34;</span><span class="op" id="7513148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513154">Path</span><span class="op" id="7513158">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7513162">&#34;/&#34;</span><span class="op" id="7513165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513170">}</span><span class="op" id="7513171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513176">ContentLength</span><span class="op" id="7513189">:</span>&nbsp;<span class="num" id="7513191">8193</span><span class="op" id="7513195">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513200">ProtoMajor</span><span class="op" id="7513210">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7513215">1</span><span class="op" id="7513216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513221">ProtoMinor</span><span class="op" id="7513231">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7513236">1</span><span class="op" id="7513237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513241">}</span><span class="op" id="7513242">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513247">Body</span><span class="op" id="7513251">:</span>&nbsp;<span class="ident" id="7513253">bytes</span><span class="op" id="7513258">.</span><span class="ident" id="7513259">Repeat</span><span class="op" id="7513265">(</span><span class="op" id="7513266">[</span><span class="op" id="7513267">]</span><span class="builtintype" id="7513268">byte</span><span class="op" id="7513272">(</span><span class="string" id="7513273">&#34;a&#34;</span><span class="op" id="7513276">)</span><span class="op" id="7513277">,</span>&nbsp;<span class="num" id="7513279">8193</span><span class="op" id="7513283">)</span><span class="op" id="7513284">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513289">WantDumpOut</span><span class="op" id="7513300">:</span>&nbsp;<span class="string" id="7513302">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7513324">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7513329">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="7513350">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7513355">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7513393">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7513398">&#34;Content-Length:&nbsp;8193\r\n&#34;</span>&nbsp;<span class="op" id="7513425">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7513430">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7513462">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513467">strings</span><span class="op" id="7513474">.</span><span class="ident" id="7513475">Repeat</span><span class="op" id="7513481">(</span><span class="string" id="7513482">&#34;a&#34;</span><span class="op" id="7513485">,</span>&nbsp;<span class="num" id="7513487">8193</span><span class="op" id="7513491">)</span><span class="op" id="7513492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513495">}</span><span class="op" id="7513496">,</span><br>
<span class="lineno"></span><span class="op" id="7513498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7513501">func</span>&nbsp;<span class="ident" id="7513506">TestDumpRequest</span><span class="op" id="7513521">(</span><span class="ident" id="7513522">t</span>&nbsp;<span class="op" id="7513524">*</span><span class="ident" id="7513525">testing</span><span class="op" id="7513532">.</span><span class="ident" id="7513533">T</span><span class="op" id="7513534">)</span>&nbsp;<span class="op" id="7513536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513539">numg0</span>&nbsp;<span class="op" id="7513545">:=</span>&nbsp;<span class="ident" id="7513548">runtime</span><span class="op" id="7513555">.</span><span class="ident" id="7513556">NumGoroutine</span><span class="op" id="7513568">(</span><span class="op" id="7513569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513572">for</span>&nbsp;<span class="ident" id="7513576">i</span><span class="op" id="7513577">,</span>&nbsp;<span class="ident" id="7513579">tt</span>&nbsp;<span class="op" id="7513582">:=</span>&nbsp;<span class="keyword" id="7513585">range</span>&nbsp;<span class="ident" id="7513591">dumpTests</span>&nbsp;<span class="op" id="7513601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513605">setBody</span>&nbsp;<span class="op" id="7513613">:=</span>&nbsp;<span class="keyword" id="7513616">func</span><span class="op" id="7513620">(</span><span class="op" id="7513621">)</span>&nbsp;<span class="op" id="7513623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513628">if</span>&nbsp;<span class="ident" id="7513631">tt</span><span class="op" id="7513633">.</span><span class="ident" id="7513634">Body</span>&nbsp;<span class="op" id="7513639">==</span>&nbsp;<span class="ident" id="7513642">nil</span>&nbsp;<span class="op" id="7513646">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513652">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513667">switch</span>&nbsp;<span class="ident" id="7513674">b</span>&nbsp;<span class="op" id="7513676">:=</span>&nbsp;<span class="ident" id="7513679">tt</span><span class="op" id="7513681">.</span><span class="ident" id="7513682">Body</span><span class="op" id="7513686">.</span><span class="op" id="7513687">(</span><span class="keyword" id="7513688">type</span><span class="op" id="7513692">)</span>&nbsp;<span class="op" id="7513694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513699">case</span>&nbsp;<span class="op" id="7513704">[</span><span class="op" id="7513705">]</span><span class="builtintype" id="7513706">byte</span><span class="op" id="7513710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513716">tt</span><span class="op" id="7513718">.</span><span class="ident" id="7513719">Req</span><span class="op" id="7513722">.</span><span class="ident" id="7513723">Body</span>&nbsp;<span class="op" id="7513728">=</span>&nbsp;<span class="ident" id="7513730">ioutil</span><span class="op" id="7513736">.</span><span class="ident" id="7513737">NopCloser</span><span class="op" id="7513746">(</span><span class="ident" id="7513747">bytes</span><span class="op" id="7513752">.</span><span class="ident" id="7513753">NewReader</span><span class="op" id="7513762">(</span><span class="ident" id="7513763">b</span><span class="op" id="7513764">)</span><span class="op" id="7513765">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513770">case</span>&nbsp;<span class="keyword" id="7513775">func</span><span class="op" id="7513779">(</span><span class="op" id="7513780">)</span>&nbsp;<span class="ident" id="7513782">io</span><span class="op" id="7513784">.</span><span class="ident" id="7513785">ReadCloser</span><span class="op" id="7513795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513801">tt</span><span class="op" id="7513803">.</span><span class="ident" id="7513804">Req</span><span class="op" id="7513807">.</span><span class="ident" id="7513808">Body</span>&nbsp;<span class="op" id="7513813">=</span>&nbsp;<span class="ident" id="7513815">b</span><span class="op" id="7513816">(</span><span class="op" id="7513817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513822">default</span><span class="op" id="7513829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513835">t</span><span class="op" id="7513836">.</span><span class="ident" id="7513837">Fatalf</span><span class="op" id="7513843">(</span><span class="string" id="7513844">&#34;Test&nbsp;%d:&nbsp;unsupported&nbsp;Body&nbsp;of&nbsp;%T&#34;</span><span class="op" id="7513877">,</span>&nbsp;<span class="ident" id="7513879">i</span><span class="op" id="7513880">,</span>&nbsp;<span class="ident" id="7513882">tt</span><span class="op" id="7513884">.</span><span class="ident" id="7513885">Body</span><span class="op" id="7513889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513894">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513902">setBody</span><span class="op" id="7513909">(</span><span class="op" id="7513910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513914">if</span>&nbsp;<span class="ident" id="7513917">tt</span><span class="op" id="7513919">.</span><span class="ident" id="7513920">Req</span><span class="op" id="7513923">.</span><span class="ident" id="7513924">Header</span>&nbsp;<span class="op" id="7513931">==</span>&nbsp;<span class="ident" id="7513934">nil</span>&nbsp;<span class="op" id="7513938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513943">tt</span><span class="op" id="7513945">.</span><span class="ident" id="7513946">Req</span><span class="op" id="7513949">.</span><span class="ident" id="7513950">Header</span>&nbsp;<span class="op" id="7513957">=</span>&nbsp;<span class="builtinfunc" id="7513959">make</span><span class="op" id="7513963">(</span><span class="ident" id="7513964">http</span><span class="op" id="7513968">.</span><span class="ident" id="7513969">Header</span><span class="op" id="7513975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513979">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7513984">if</span>&nbsp;<span class="ident" id="7513987">tt</span><span class="op" id="7513989">.</span><span class="ident" id="7513990">WantDump</span>&nbsp;<span class="op" id="7513999">!=</span>&nbsp;<span class="string" id="7514002">&#34;&#34;</span>&nbsp;<span class="op" id="7514005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514010">setBody</span><span class="op" id="7514017">(</span><span class="op" id="7514018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514023">dump</span><span class="op" id="7514027">,</span>&nbsp;<span class="ident" id="7514029">err</span>&nbsp;<span class="op" id="7514033">:=</span>&nbsp;<span class="ident" id="7514036">DumpRequest</span><span class="op" id="7514047">(</span><span class="op" id="7514048">&amp;</span><span class="ident" id="7514049">tt</span><span class="op" id="7514051">.</span><span class="ident" id="7514052">Req</span><span class="op" id="7514055">,</span>&nbsp;<span class="op" id="7514057">!</span><span class="ident" id="7514058">tt</span><span class="op" id="7514060">.</span><span class="ident" id="7514061">NoBody</span><span class="op" id="7514067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514072">if</span>&nbsp;<span class="ident" id="7514075">err</span>&nbsp;<span class="op" id="7514079">!=</span>&nbsp;<span class="ident" id="7514082">nil</span>&nbsp;<span class="op" id="7514086">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514092">t</span><span class="op" id="7514093">.</span><span class="ident" id="7514094">Errorf</span><span class="op" id="7514100">(</span><span class="string" id="7514101">&#34;DumpRequest&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7514122">,</span>&nbsp;<span class="ident" id="7514124">i</span><span class="op" id="7514125">,</span>&nbsp;<span class="ident" id="7514127">err</span><span class="op" id="7514130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514136">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514153">if</span>&nbsp;<span class="builtintype" id="7514156">string</span><span class="op" id="7514162">(</span><span class="ident" id="7514163">dump</span><span class="op" id="7514167">)</span>&nbsp;<span class="op" id="7514169">!=</span>&nbsp;<span class="ident" id="7514172">tt</span><span class="op" id="7514174">.</span><span class="ident" id="7514175">WantDump</span>&nbsp;<span class="op" id="7514184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514190">t</span><span class="op" id="7514191">.</span><span class="ident" id="7514192">Errorf</span><span class="op" id="7514198">(</span><span class="string" id="7514199">&#34;DumpRequest&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7514243">,</span>&nbsp;<span class="ident" id="7514245">i</span><span class="op" id="7514246">,</span>&nbsp;<span class="ident" id="7514248">tt</span><span class="op" id="7514250">.</span><span class="ident" id="7514251">WantDump</span><span class="op" id="7514259">,</span>&nbsp;<span class="builtintype" id="7514261">string</span><span class="op" id="7514267">(</span><span class="ident" id="7514268">dump</span><span class="op" id="7514272">)</span><span class="op" id="7514273">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514279">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514300">if</span>&nbsp;<span class="ident" id="7514303">tt</span><span class="op" id="7514305">.</span><span class="ident" id="7514306">WantDumpOut</span>&nbsp;<span class="op" id="7514318">!=</span>&nbsp;<span class="string" id="7514321">&#34;&#34;</span>&nbsp;<span class="op" id="7514324">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514329">setBody</span><span class="op" id="7514336">(</span><span class="op" id="7514337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514342">dump</span><span class="op" id="7514346">,</span>&nbsp;<span class="ident" id="7514348">err</span>&nbsp;<span class="op" id="7514352">:=</span>&nbsp;<span class="ident" id="7514355">DumpRequestOut</span><span class="op" id="7514369">(</span><span class="op" id="7514370">&amp;</span><span class="ident" id="7514371">tt</span><span class="op" id="7514373">.</span><span class="ident" id="7514374">Req</span><span class="op" id="7514377">,</span>&nbsp;<span class="op" id="7514379">!</span><span class="ident" id="7514380">tt</span><span class="op" id="7514382">.</span><span class="ident" id="7514383">NoBody</span><span class="op" id="7514389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514394">if</span>&nbsp;<span class="ident" id="7514397">err</span>&nbsp;<span class="op" id="7514401">!=</span>&nbsp;<span class="ident" id="7514404">nil</span>&nbsp;<span class="op" id="7514408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514414">t</span><span class="op" id="7514415">.</span><span class="ident" id="7514416">Errorf</span><span class="op" id="7514422">(</span><span class="string" id="7514423">&#34;DumpRequestOut&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7514447">,</span>&nbsp;<span class="ident" id="7514449">i</span><span class="op" id="7514450">,</span>&nbsp;<span class="ident" id="7514452">err</span><span class="op" id="7514455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514461">continue</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514478">if</span>&nbsp;<span class="builtintype" id="7514481">string</span><span class="op" id="7514487">(</span><span class="ident" id="7514488">dump</span><span class="op" id="7514492">)</span>&nbsp;<span class="op" id="7514494">!=</span>&nbsp;<span class="ident" id="7514497">tt</span><span class="op" id="7514499">.</span><span class="ident" id="7514500">WantDumpOut</span>&nbsp;<span class="op" id="7514512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514518">t</span><span class="op" id="7514519">.</span><span class="ident" id="7514520">Errorf</span><span class="op" id="7514526">(</span><span class="string" id="7514527">&#34;DumpRequestOut&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7514574">,</span>&nbsp;<span class="ident" id="7514576">i</span><span class="op" id="7514577">,</span>&nbsp;<span class="ident" id="7514579">tt</span><span class="op" id="7514581">.</span><span class="ident" id="7514582">WantDumpOut</span><span class="op" id="7514593">,</span>&nbsp;<span class="builtintype" id="7514595">string</span><span class="op" id="7514601">(</span><span class="ident" id="7514602">dump</span><span class="op" id="7514606">)</span><span class="op" id="7514607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514613">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514625">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514635">if</span>&nbsp;<span class="ident" id="7514638">dg</span>&nbsp;<span class="op" id="7514641">:=</span>&nbsp;<span class="ident" id="7514644">runtime</span><span class="op" id="7514651">.</span><span class="ident" id="7514652">NumGoroutine</span><span class="op" id="7514664">(</span><span class="op" id="7514665">)</span>&nbsp;<span class="op" id="7514667">-</span>&nbsp;<span class="ident" id="7514669">numg0</span><span class="op" id="7514674">;</span>&nbsp;<span class="ident" id="7514676">dg</span>&nbsp;<span class="op" id="7514679">&gt;</span>&nbsp;<span class="num" id="7514681">4</span>&nbsp;<span class="op" id="7514683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514687">buf</span>&nbsp;<span class="op" id="7514691">:=</span>&nbsp;<span class="builtinfunc" id="7514694">make</span><span class="op" id="7514698">(</span><span class="op" id="7514699">[</span><span class="op" id="7514700">]</span><span class="builtintype" id="7514701">byte</span><span class="op" id="7514705">,</span>&nbsp;<span class="num" id="7514707">4096</span><span class="op" id="7514711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514715">buf</span>&nbsp;<span class="op" id="7514719">=</span>&nbsp;<span class="ident" id="7514721">buf</span><span class="op" id="7514724">[</span><span class="op" id="7514725">:</span><span class="ident" id="7514726">runtime</span><span class="op" id="7514733">.</span><span class="ident" id="7514734">Stack</span><span class="op" id="7514739">(</span><span class="ident" id="7514740">buf</span><span class="op" id="7514743">,</span>&nbsp;<span class="builtintype" id="7514745">true</span><span class="op" id="7514749">)</span><span class="op" id="7514750">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514754">t</span><span class="op" id="7514755">.</span><span class="ident" id="7514756">Errorf</span><span class="op" id="7514762">(</span><span class="string" id="7514763">&#34;Unexpectedly&nbsp;large&nbsp;number&nbsp;of&nbsp;new&nbsp;goroutines:&nbsp;%d&nbsp;new:&nbsp;%s&#34;</span><span class="op" id="7514820">,</span>&nbsp;<span class="ident" id="7514822">dg</span><span class="op" id="7514824">,</span>&nbsp;<span class="ident" id="7514826">buf</span><span class="op" id="7514829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514832">}</span><br>
<span class="lineno"></span><span class="op" id="7514834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7514837">func</span>&nbsp;<span class="ident" id="7514842">chunk</span><span class="op" id="7514847">(</span><span class="ident" id="7514848">s</span>&nbsp;<span class="builtintype" id="7514850">string</span><span class="op" id="7514856">)</span>&nbsp;<span class="builtintype" id="7514858">string</span>&nbsp;<span class="op" id="7514865">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514868">return</span>&nbsp;<span class="ident" id="7514875">fmt</span><span class="op" id="7514878">.</span><span class="ident" id="7514879">Sprintf</span><span class="op" id="7514886">(</span><span class="string" id="7514887">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7514901">,</span>&nbsp;<span class="builtinfunc" id="7514903">len</span><span class="op" id="7514906">(</span><span class="ident" id="7514907">s</span><span class="op" id="7514908">)</span><span class="op" id="7514909">,</span>&nbsp;<span class="ident" id="7514911">s</span><span class="op" id="7514912">)</span><br>
<span class="lineno"></span><span class="op" id="7514914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7514917">func</span>&nbsp;<span class="ident" id="7514922">mustParseURL</span><span class="op" id="7514934">(</span><span class="ident" id="7514935">s</span>&nbsp;<span class="builtintype" id="7514937">string</span><span class="op" id="7514943">)</span>&nbsp;<span class="op" id="7514945">*</span><span class="ident" id="7514946">url</span><span class="op" id="7514949">.</span><span class="ident" id="7514950">URL</span>&nbsp;<span class="op" id="7514954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514957">u</span><span class="op" id="7514958">,</span>&nbsp;<span class="ident" id="7514960">err</span>&nbsp;<span class="op" id="7514964">:=</span>&nbsp;<span class="ident" id="7514967">url</span><span class="op" id="7514970">.</span><span class="ident" id="7514971">Parse</span><span class="op" id="7514976">(</span><span class="ident" id="7514977">s</span><span class="op" id="7514978">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514981">if</span>&nbsp;<span class="ident" id="7514984">err</span>&nbsp;<span class="op" id="7514988">!=</span>&nbsp;<span class="ident" id="7514991">nil</span>&nbsp;<span class="op" id="7514995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7514999">panic</span><span class="op" id="7515004">(</span><span class="ident" id="7515005">fmt</span><span class="op" id="7515008">.</span><span class="ident" id="7515009">Sprintf</span><span class="op" id="7515016">(</span><span class="string" id="7515017">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7515043">,</span>&nbsp;<span class="ident" id="7515045">s</span><span class="op" id="7515046">,</span>&nbsp;<span class="ident" id="7515048">err</span><span class="op" id="7515051">)</span><span class="op" id="7515052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515058">return</span>&nbsp;<span class="ident" id="7515065">u</span><br>
<span class="lineno"></span><span class="op" id="7515067">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="7515070">func</span>&nbsp;<span class="ident" id="7515075">mustNewRequest</span><span class="op" id="7515089">(</span><span class="ident" id="7515090">method</span><span class="op" id="7515096">,</span>&nbsp;<span class="ident" id="7515098">url</span>&nbsp;<span class="builtintype" id="7515102">string</span><span class="op" id="7515108">,</span>&nbsp;<span class="ident" id="7515110">body</span>&nbsp;<span class="ident" id="7515115">io</span><span class="op" id="7515117">.</span><span class="ident" id="7515118">Reader</span><span class="op" id="7515124">)</span>&nbsp;<span class="op" id="7515126">*</span><span class="ident" id="7515127">http</span><span class="op" id="7515131">.</span><span class="ident" id="7515132">Request</span>&nbsp;<span class="op" id="7515140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515143">req</span><span class="op" id="7515146">,</span>&nbsp;<span class="ident" id="7515148">err</span>&nbsp;<span class="op" id="7515152">:=</span>&nbsp;<span class="ident" id="7515155">http</span><span class="op" id="7515159">.</span><span class="ident" id="7515160">NewRequest</span><span class="op" id="7515170">(</span><span class="ident" id="7515171">method</span><span class="op" id="7515177">,</span>&nbsp;<span class="ident" id="7515179">url</span><span class="op" id="7515182">,</span>&nbsp;<span class="ident" id="7515184">body</span><span class="op" id="7515188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515191">if</span>&nbsp;<span class="ident" id="7515194">err</span>&nbsp;<span class="op" id="7515198">!=</span>&nbsp;<span class="ident" id="7515201">nil</span>&nbsp;<span class="op" id="7515205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7515209">panic</span><span class="op" id="7515214">(</span><span class="ident" id="7515215">fmt</span><span class="op" id="7515218">.</span><span class="ident" id="7515219">Sprintf</span><span class="op" id="7515226">(</span><span class="string" id="7515227">&#34;NewRequest(%q,&nbsp;%q,&nbsp;%p)&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7515260">,</span>&nbsp;<span class="ident" id="7515262">method</span><span class="op" id="7515268">,</span>&nbsp;<span class="ident" id="7515270">url</span><span class="op" id="7515273">,</span>&nbsp;<span class="ident" id="7515275">body</span><span class="op" id="7515279">,</span>&nbsp;<span class="ident" id="7515281">err</span><span class="op" id="7515284">)</span><span class="op" id="7515285">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515291">return</span>&nbsp;<span class="ident" id="7515298">req</span><br>
<span class="lineno"></span><span class="op" id="7515302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7515305">var</span>&nbsp;<span class="ident" id="7515309">dumpResTests</span>&nbsp;<span class="op" id="7515322">=</span>&nbsp;<span class="op" id="7515324">[</span><span class="op" id="7515325">]</span><span class="keyword" id="7515326">struct</span>&nbsp;<span class="op" id="7515333">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515336">res</span>&nbsp;&nbsp;<span class="op" id="7515341">*</span><span class="ident" id="7515342">http</span><span class="op" id="7515346">.</span><span class="ident" id="7515347">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515357">body</span>&nbsp;<span class="builtintype" id="7515362">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515368">want</span>&nbsp;<span class="builtintype" id="7515373">string</span><br>
<span class="lineno"></span><span class="op" id="7515380">}</span><span class="op" id="7515381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515384">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515388">res</span><span class="op" id="7515391">:</span>&nbsp;<span class="op" id="7515393">&amp;</span><span class="ident" id="7515394">http</span><span class="op" id="7515398">.</span><span class="ident" id="7515399">Response</span><span class="op" id="7515407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515412">Status</span><span class="op" id="7515418">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7515427">&#34;200&nbsp;OK&#34;</span><span class="op" id="7515435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515440">StatusCode</span><span class="op" id="7515450">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7515455">200</span><span class="op" id="7515458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515463">Proto</span><span class="op" id="7515468">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7515478">&#34;HTTP/1.1&#34;</span><span class="op" id="7515488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515493">ProtoMajor</span><span class="op" id="7515503">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7515508">1</span><span class="op" id="7515509">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515514">ProtoMinor</span><span class="op" id="7515524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7515529">1</span><span class="op" id="7515530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515535">ContentLength</span><span class="op" id="7515548">:</span>&nbsp;<span class="num" id="7515550">50</span><span class="op" id="7515552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515557">Header</span><span class="op" id="7515563">:</span>&nbsp;<span class="ident" id="7515565">http</span><span class="op" id="7515569">.</span><span class="ident" id="7515570">Header</span><span class="op" id="7515576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7515582">&#34;Foo&#34;</span><span class="op" id="7515587">:</span>&nbsp;<span class="op" id="7515589">[</span><span class="op" id="7515590">]</span><span class="builtintype" id="7515591">string</span><span class="op" id="7515597">{</span><span class="string" id="7515598">&#34;Bar&#34;</span><span class="op" id="7515603">}</span><span class="op" id="7515604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515609">}</span><span class="op" id="7515610">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515615">Body</span><span class="op" id="7515619">:</span>&nbsp;<span class="ident" id="7515621">ioutil</span><span class="op" id="7515627">.</span><span class="ident" id="7515628">NopCloser</span><span class="op" id="7515637">(</span><span class="ident" id="7515638">strings</span><span class="op" id="7515645">.</span><span class="ident" id="7515646">NewReader</span><span class="op" id="7515655">(</span><span class="string" id="7515656">&#34;foo&#34;</span><span class="op" id="7515661">)</span><span class="op" id="7515662">)</span><span class="op" id="7515663">,</span>&nbsp;<span class="comment" id="7515665">//&nbsp;shouldn&#39;t&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515688">}</span><span class="op" id="7515689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515693">body</span><span class="op" id="7515697">:</span>&nbsp;<span class="builtintype" id="7515699">false</span><span class="op" id="7515704">,</span>&nbsp;<span class="comment" id="7515706">//&nbsp;to&nbsp;verify&nbsp;we&nbsp;see&nbsp;50,&nbsp;not&nbsp;empty&nbsp;or&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515748">want</span><span class="op" id="7515752">:</span>&nbsp;<span class="string" id="7515754">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Content-Length:&nbsp;50<br>
<span class="lineno">235</span>Foo:&nbsp;Bar`</span><span class="op" id="7515799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515802">}</span><span class="op" id="7515803">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515811">res</span><span class="op" id="7515814">:</span>&nbsp;<span class="op" id="7515816">&amp;</span><span class="ident" id="7515817">http</span><span class="op" id="7515821">.</span><span class="ident" id="7515822">Response</span><span class="op" id="7515830">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515835">Status</span><span class="op" id="7515841">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7515850">&#34;200&nbsp;OK&#34;</span><span class="op" id="7515858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515863">StatusCode</span><span class="op" id="7515873">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7515878">200</span><span class="op" id="7515881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515886">Proto</span><span class="op" id="7515891">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7515901">&#34;HTTP/1.1&#34;</span><span class="op" id="7515911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515916">ProtoMajor</span><span class="op" id="7515926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7515931">1</span><span class="op" id="7515932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515937">ProtoMinor</span><span class="op" id="7515947">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7515952">1</span><span class="op" id="7515953">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515958">ContentLength</span><span class="op" id="7515971">:</span>&nbsp;<span class="num" id="7515973">3</span><span class="op" id="7515974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515979">Body</span><span class="op" id="7515983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515994">ioutil</span><span class="op" id="7516000">.</span><span class="ident" id="7516001">NopCloser</span><span class="op" id="7516010">(</span><span class="ident" id="7516011">strings</span><span class="op" id="7516018">.</span><span class="ident" id="7516019">NewReader</span><span class="op" id="7516028">(</span><span class="string" id="7516029">&#34;foo&#34;</span><span class="op" id="7516034">)</span><span class="op" id="7516035">)</span><span class="op" id="7516036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516040">}</span><span class="op" id="7516041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516045">body</span><span class="op" id="7516049">:</span>&nbsp;<span class="builtintype" id="7516051">true</span><span class="op" id="7516055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516059">want</span><span class="op" id="7516063">:</span>&nbsp;<span class="string" id="7516065">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno">250</span>Content-Length:&nbsp;3<br>
<span class="lineno"></span><br>
<span class="lineno"></span>foo`</span><span class="op" id="7516105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516108">}</span><span class="op" id="7516109">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516117">res</span><span class="op" id="7516120">:</span>&nbsp;<span class="op" id="7516122">&amp;</span><span class="ident" id="7516123">http</span><span class="op" id="7516127">.</span><span class="ident" id="7516128">Response</span><span class="op" id="7516136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516141">Status</span><span class="op" id="7516147">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7516159">&#34;200&nbsp;OK&#34;</span><span class="op" id="7516167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516172">StatusCode</span><span class="op" id="7516182">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7516190">200</span><span class="op" id="7516193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516198">Proto</span><span class="op" id="7516203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7516216">&#34;HTTP/1.1&#34;</span><span class="op" id="7516226">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516231">ProtoMajor</span><span class="op" id="7516241">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7516249">1</span><span class="op" id="7516250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516255">ProtoMinor</span><span class="op" id="7516265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7516273">1</span><span class="op" id="7516274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516279">ContentLength</span><span class="op" id="7516292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516297">-</span><span class="num" id="7516298">1</span><span class="op" id="7516299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516304">Body</span><span class="op" id="7516308">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516322">ioutil</span><span class="op" id="7516328">.</span><span class="ident" id="7516329">NopCloser</span><span class="op" id="7516338">(</span><span class="ident" id="7516339">strings</span><span class="op" id="7516346">.</span><span class="ident" id="7516347">NewReader</span><span class="op" id="7516356">(</span><span class="string" id="7516357">&#34;foo&#34;</span><span class="op" id="7516362">)</span><span class="op" id="7516363">)</span><span class="op" id="7516364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516369">TransferEncoding</span><span class="op" id="7516385">:</span>&nbsp;<span class="op" id="7516387">[</span><span class="op" id="7516388">]</span><span class="builtintype" id="7516389">string</span><span class="op" id="7516395">{</span><span class="string" id="7516396">&#34;chunked&#34;</span><span class="op" id="7516405">}</span><span class="op" id="7516406">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516410">}</span><span class="op" id="7516411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516415">body</span><span class="op" id="7516419">:</span>&nbsp;<span class="builtintype" id="7516421">true</span><span class="op" id="7516425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516429">want</span><span class="op" id="7516433">:</span>&nbsp;<span class="string" id="7516435">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">270</span>3<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>0`</span><span class="op" id="7516488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516491">}</span><span class="op" id="7516492">,</span><br>
<span class="lineno"></span><span class="op" id="7516494">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="7516497">func</span>&nbsp;<span class="ident" id="7516502">TestDumpResponse</span><span class="op" id="7516518">(</span><span class="ident" id="7516519">t</span>&nbsp;<span class="op" id="7516521">*</span><span class="ident" id="7516522">testing</span><span class="op" id="7516529">.</span><span class="ident" id="7516530">T</span><span class="op" id="7516531">)</span>&nbsp;<span class="op" id="7516533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7516536">for</span>&nbsp;<span class="ident" id="7516540">i</span><span class="op" id="7516541">,</span>&nbsp;<span class="ident" id="7516543">tt</span>&nbsp;<span class="op" id="7516546">:=</span>&nbsp;<span class="keyword" id="7516549">range</span>&nbsp;<span class="ident" id="7516555">dumpResTests</span>&nbsp;<span class="op" id="7516568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516572">gotb</span><span class="op" id="7516576">,</span>&nbsp;<span class="ident" id="7516578">err</span>&nbsp;<span class="op" id="7516582">:=</span>&nbsp;<span class="ident" id="7516585">DumpResponse</span><span class="op" id="7516597">(</span><span class="ident" id="7516598">tt</span><span class="op" id="7516600">.</span><span class="ident" id="7516601">res</span><span class="op" id="7516604">,</span>&nbsp;<span class="ident" id="7516606">tt</span><span class="op" id="7516608">.</span><span class="ident" id="7516609">body</span><span class="op" id="7516613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7516617">if</span>&nbsp;<span class="ident" id="7516620">err</span>&nbsp;<span class="op" id="7516624">!=</span>&nbsp;<span class="ident" id="7516627">nil</span>&nbsp;<span class="op" id="7516631">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516636">t</span><span class="op" id="7516637">.</span><span class="ident" id="7516638">Errorf</span><span class="op" id="7516644">(</span><span class="string" id="7516645">&#34;%d.&nbsp;DumpResponse&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7516668">,</span>&nbsp;<span class="ident" id="7516670">i</span><span class="op" id="7516671">,</span>&nbsp;<span class="ident" id="7516673">err</span><span class="op" id="7516676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7516681">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516696">got</span>&nbsp;<span class="op" id="7516700">:=</span>&nbsp;<span class="builtintype" id="7516703">string</span><span class="op" id="7516709">(</span><span class="ident" id="7516710">gotb</span><span class="op" id="7516714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516718">got</span>&nbsp;<span class="op" id="7516722">=</span>&nbsp;<span class="ident" id="7516724">strings</span><span class="op" id="7516731">.</span><span class="ident" id="7516732">TrimSpace</span><span class="op" id="7516741">(</span><span class="ident" id="7516742">got</span><span class="op" id="7516745">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516749">got</span>&nbsp;<span class="op" id="7516753">=</span>&nbsp;<span class="ident" id="7516755">strings</span><span class="op" id="7516762">.</span><span class="ident" id="7516763">Replace</span><span class="op" id="7516770">(</span><span class="ident" id="7516771">got</span><span class="op" id="7516774">,</span>&nbsp;<span class="string" id="7516776">&#34;\r&#34;</span><span class="op" id="7516780">,</span>&nbsp;<span class="string" id="7516782">&#34;&#34;</span><span class="op" id="7516784">,</span>&nbsp;<span class="op" id="7516786">-</span><span class="num" id="7516787">1</span><span class="op" id="7516788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7516793">if</span>&nbsp;<span class="ident" id="7516796">got</span>&nbsp;<span class="op" id="7516800">!=</span>&nbsp;<span class="ident" id="7516803">tt</span><span class="op" id="7516805">.</span><span class="ident" id="7516806">want</span>&nbsp;<span class="op" id="7516811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7516816">t</span><span class="op" id="7516817">.</span><span class="ident" id="7516818">Errorf</span><span class="op" id="7516824">(</span><span class="string" id="7516825">&#34;%d.\nDumpResponse&nbsp;got:\n%s\n\nWant:\n%s\n&#34;</span><span class="op" id="7516868">,</span>&nbsp;<span class="ident" id="7516870">i</span><span class="op" id="7516871">,</span>&nbsp;<span class="ident" id="7516873">got</span><span class="op" id="7516876">,</span>&nbsp;<span class="ident" id="7516878">tt</span><span class="op" id="7516880">.</span><span class="ident" id="7516881">want</span><span class="op" id="7516885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516889">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516892">}</span><br>
<span class="lineno"></span><span class="op" id="7516894">}</span>
</div>
</body>
</html>
