<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8548527">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8548582">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8548636">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8548687">package</span>&nbsp;<span class="ident" id="8548695">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8548700">import</span>&nbsp;<span class="op" id="8548707">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548710">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548719">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548726">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8548736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8548739">type</span>&nbsp;<span class="ident" id="8548744">rc4Test</span>&nbsp;<span class="keyword" id="8548752">struct</span>&nbsp;<span class="op" id="8548759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548762">key</span><span class="op" id="8548765">,</span>&nbsp;<span class="ident" id="8548767">keystream</span>&nbsp;<span class="op" id="8548777">[</span><span class="op" id="8548778">]</span><span class="builtintype" id="8548779">byte</span><br>
<span class="lineno">15</span><span class="op" id="8548784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8548787">var</span>&nbsp;<span class="ident" id="8548791">golden</span>&nbsp;<span class="op" id="8548798">=</span>&nbsp;<span class="op" id="8548800">[</span><span class="op" id="8548801">]</span><span class="ident" id="8548802">rc4Test</span><span class="op" id="8548809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8548812">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8548875">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548953">[</span><span class="op" id="8548954">]</span><span class="builtintype" id="8548955">byte</span><span class="op" id="8548959">{</span><span class="num" id="8548960">0x01</span><span class="op" id="8548964">,</span>&nbsp;<span class="num" id="8548966">0x23</span><span class="op" id="8548970">,</span>&nbsp;<span class="num" id="8548972">0x45</span><span class="op" id="8548976">,</span>&nbsp;<span class="num" id="8548978">0x67</span><span class="op" id="8548982">,</span>&nbsp;<span class="num" id="8548984">0x89</span><span class="op" id="8548988">,</span>&nbsp;<span class="num" id="8548990">0xab</span><span class="op" id="8548994">,</span>&nbsp;<span class="num" id="8548996">0xcd</span><span class="op" id="8549000">,</span>&nbsp;<span class="num" id="8549002">0xef</span><span class="op" id="8549006">}</span><span class="op" id="8549007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549011">[</span><span class="op" id="8549012">]</span><span class="builtintype" id="8549013">byte</span><span class="op" id="8549017">{</span><span class="num" id="8549018">0x74</span><span class="op" id="8549022">,</span>&nbsp;<span class="num" id="8549024">0x94</span><span class="op" id="8549028">,</span>&nbsp;<span class="num" id="8549030">0xc2</span><span class="op" id="8549034">,</span>&nbsp;<span class="num" id="8549036">0xe7</span><span class="op" id="8549040">,</span>&nbsp;<span class="num" id="8549042">0x10</span><span class="op" id="8549046">,</span>&nbsp;<span class="num" id="8549048">0x4b</span><span class="op" id="8549052">,</span>&nbsp;<span class="num" id="8549054">0x08</span><span class="op" id="8549058">,</span>&nbsp;<span class="num" id="8549060">0x79</span><span class="op" id="8549064">}</span><span class="op" id="8549065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549068">}</span><span class="op" id="8549069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549072">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549076">[</span><span class="op" id="8549077">]</span><span class="builtintype" id="8549078">byte</span><span class="op" id="8549082">{</span><span class="num" id="8549083">0x00</span><span class="op" id="8549087">,</span>&nbsp;<span class="num" id="8549089">0x00</span><span class="op" id="8549093">,</span>&nbsp;<span class="num" id="8549095">0x00</span><span class="op" id="8549099">,</span>&nbsp;<span class="num" id="8549101">0x00</span><span class="op" id="8549105">,</span>&nbsp;<span class="num" id="8549107">0x00</span><span class="op" id="8549111">,</span>&nbsp;<span class="num" id="8549113">0x00</span><span class="op" id="8549117">,</span>&nbsp;<span class="num" id="8549119">0x00</span><span class="op" id="8549123">,</span>&nbsp;<span class="num" id="8549125">0x00</span><span class="op" id="8549129">}</span><span class="op" id="8549130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549134">[</span><span class="op" id="8549135">]</span><span class="builtintype" id="8549136">byte</span><span class="op" id="8549140">{</span><span class="num" id="8549141">0xde</span><span class="op" id="8549145">,</span>&nbsp;<span class="num" id="8549147">0x18</span><span class="op" id="8549151">,</span>&nbsp;<span class="num" id="8549153">0x89</span><span class="op" id="8549157">,</span>&nbsp;<span class="num" id="8549159">0x41</span><span class="op" id="8549163">,</span>&nbsp;<span class="num" id="8549165">0xa3</span><span class="op" id="8549169">,</span>&nbsp;<span class="num" id="8549171">0x37</span><span class="op" id="8549175">,</span>&nbsp;<span class="num" id="8549177">0x5d</span><span class="op" id="8549181">,</span>&nbsp;<span class="num" id="8549183">0x3a</span><span class="op" id="8549187">}</span><span class="op" id="8549188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549191">}</span><span class="op" id="8549192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549199">[</span><span class="op" id="8549200">]</span><span class="builtintype" id="8549201">byte</span><span class="op" id="8549205">{</span><span class="num" id="8549206">0xef</span><span class="op" id="8549210">,</span>&nbsp;<span class="num" id="8549212">0x01</span><span class="op" id="8549216">,</span>&nbsp;<span class="num" id="8549218">0x23</span><span class="op" id="8549222">,</span>&nbsp;<span class="num" id="8549224">0x45</span><span class="op" id="8549228">}</span><span class="op" id="8549229">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549233">[</span><span class="op" id="8549234">]</span><span class="builtintype" id="8549235">byte</span><span class="op" id="8549239">{</span><span class="num" id="8549240">0xd6</span><span class="op" id="8549244">,</span>&nbsp;<span class="num" id="8549246">0xa1</span><span class="op" id="8549250">,</span>&nbsp;<span class="num" id="8549252">0x41</span><span class="op" id="8549256">,</span>&nbsp;<span class="num" id="8549258">0xa7</span><span class="op" id="8549262">,</span>&nbsp;<span class="num" id="8549264">0xec</span><span class="op" id="8549268">,</span>&nbsp;<span class="num" id="8549270">0x3c</span><span class="op" id="8549274">,</span>&nbsp;<span class="num" id="8549276">0x38</span><span class="op" id="8549280">,</span>&nbsp;<span class="num" id="8549282">0xdf</span><span class="op" id="8549286">,</span>&nbsp;<span class="num" id="8549288">0xbd</span><span class="op" id="8549292">,</span>&nbsp;<span class="num" id="8549294">0x61</span><span class="op" id="8549298">}</span><span class="op" id="8549299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549302">}</span><span class="op" id="8549303">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8549307">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549382">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549386">[</span><span class="op" id="8549387">]</span><span class="builtintype" id="8549388">byte</span><span class="op" id="8549392">{</span><span class="num" id="8549393">0x4b</span><span class="op" id="8549397">,</span>&nbsp;<span class="num" id="8549399">0x65</span><span class="op" id="8549403">,</span>&nbsp;<span class="num" id="8549405">0x79</span><span class="op" id="8549409">}</span><span class="op" id="8549410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549414">[</span><span class="op" id="8549415">]</span><span class="builtintype" id="8549416">byte</span><span class="op" id="8549420">{</span><span class="num" id="8549421">0xeb</span><span class="op" id="8549425">,</span>&nbsp;<span class="num" id="8549427">0x9f</span><span class="op" id="8549431">,</span>&nbsp;<span class="num" id="8549433">0x77</span><span class="op" id="8549437">,</span>&nbsp;<span class="num" id="8549439">0x81</span><span class="op" id="8549443">,</span>&nbsp;<span class="num" id="8549445">0xb7</span><span class="op" id="8549449">,</span>&nbsp;<span class="num" id="8549451">0x34</span><span class="op" id="8549455">,</span>&nbsp;<span class="num" id="8549457">0xca</span><span class="op" id="8549461">,</span>&nbsp;<span class="num" id="8549463">0x72</span><span class="op" id="8549467">,</span>&nbsp;<span class="num" id="8549469">0xa7</span><span class="op" id="8549473">,</span>&nbsp;<span class="num" id="8549475">0x19</span><span class="op" id="8549479">}</span><span class="op" id="8549480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549483">}</span><span class="op" id="8549484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549491">[</span><span class="op" id="8549492">]</span><span class="builtintype" id="8549493">byte</span><span class="op" id="8549497">{</span><span class="num" id="8549498">0x57</span><span class="op" id="8549502">,</span>&nbsp;<span class="num" id="8549504">0x69</span><span class="op" id="8549508">,</span>&nbsp;<span class="num" id="8549510">0x6b</span><span class="op" id="8549514">,</span>&nbsp;<span class="num" id="8549516">0x69</span><span class="op" id="8549520">}</span><span class="op" id="8549521">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549525">[</span><span class="op" id="8549526">]</span><span class="builtintype" id="8549527">byte</span><span class="op" id="8549531">{</span><span class="num" id="8549532">0x60</span><span class="op" id="8549536">,</span>&nbsp;<span class="num" id="8549538">0x44</span><span class="op" id="8549542">,</span>&nbsp;<span class="num" id="8549544">0xdb</span><span class="op" id="8549548">,</span>&nbsp;<span class="num" id="8549550">0x6d</span><span class="op" id="8549554">,</span>&nbsp;<span class="num" id="8549556">0x41</span><span class="op" id="8549560">,</span>&nbsp;<span class="num" id="8549562">0xb7</span><span class="op" id="8549566">}</span><span class="op" id="8549567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549570">}</span><span class="op" id="8549571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549578">[</span><span class="op" id="8549579">]</span><span class="builtintype" id="8549580">byte</span><span class="op" id="8549584">{</span><span class="num" id="8549585">0x00</span><span class="op" id="8549589">,</span>&nbsp;<span class="num" id="8549591">0x00</span><span class="op" id="8549595">,</span>&nbsp;<span class="num" id="8549597">0x00</span><span class="op" id="8549601">,</span>&nbsp;<span class="num" id="8549603">0x00</span><span class="op" id="8549607">,</span>&nbsp;<span class="num" id="8549609">0x00</span><span class="op" id="8549613">,</span>&nbsp;<span class="num" id="8549615">0x00</span><span class="op" id="8549619">,</span>&nbsp;<span class="num" id="8549621">0x00</span><span class="op" id="8549625">,</span>&nbsp;<span class="num" id="8549627">0x00</span><span class="op" id="8549631">}</span><span class="op" id="8549632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549636">[</span><span class="op" id="8549637">]</span><span class="builtintype" id="8549638">byte</span><span class="op" id="8549642">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8549647">0xde</span><span class="op" id="8549651">,</span>&nbsp;<span class="num" id="8549653">0x18</span><span class="op" id="8549657">,</span>&nbsp;<span class="num" id="8549659">0x89</span><span class="op" id="8549663">,</span>&nbsp;<span class="num" id="8549665">0x41</span><span class="op" id="8549669">,</span>&nbsp;<span class="num" id="8549671">0xa3</span><span class="op" id="8549675">,</span>&nbsp;<span class="num" id="8549677">0x37</span><span class="op" id="8549681">,</span>&nbsp;<span class="num" id="8549683">0x5d</span><span class="op" id="8549687">,</span>&nbsp;<span class="num" id="8549689">0x3a</span><span class="op" id="8549693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8549698">0x8a</span><span class="op" id="8549702">,</span>&nbsp;<span class="num" id="8549704">0x06</span><span class="op" id="8549708">,</span>&nbsp;<span class="num" id="8549710">0x1e</span><span class="op" id="8549714">,</span>&nbsp;<span class="num" id="8549716">0x67</span><span class="op" id="8549720">,</span>&nbsp;<span class="num" id="8549722">0x57</span><span class="op" id="8549726">,</span>&nbsp;<span class="num" id="8549728">0x6e</span><span class="op" id="8549732">,</span>&nbsp;<span class="num" id="8549734">0x92</span><span class="op" id="8549738">,</span>&nbsp;<span class="num" id="8549740">0x6d</span><span class="op" id="8549744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8549749">0xc7</span><span class="op" id="8549753">,</span>&nbsp;<span class="num" id="8549755">0x1a</span><span class="op" id="8549759">,</span>&nbsp;<span class="num" id="8549761">0x7f</span><span class="op" id="8549765">,</span>&nbsp;<span class="num" id="8549767">0xa3</span><span class="op" id="8549771">,</span>&nbsp;<span class="num" id="8549773">0xf0</span><span class="op" id="8549777">,</span>&nbsp;<span class="num" id="8549779">0xcc</span><span class="op" id="8549783">,</span>&nbsp;<span class="num" id="8549785">0xeb</span><span class="op" id="8549789">,</span>&nbsp;<span class="num" id="8549791">0x97</span><span class="op" id="8549795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8549800">0x45</span><span class="op" id="8549804">,</span>&nbsp;<span class="num" id="8549806">0x2b</span><span class="op" id="8549810">,</span>&nbsp;<span class="num" id="8549812">0x4d</span><span class="op" id="8549816">,</span>&nbsp;<span class="num" id="8549818">0x32</span><span class="op" id="8549822">,</span>&nbsp;<span class="num" id="8549824">0x27</span><span class="op" id="8549828">,</span>&nbsp;<span class="num" id="8549830">0x96</span><span class="op" id="8549834">,</span>&nbsp;<span class="num" id="8549836">0x5f</span><span class="op" id="8549840">,</span>&nbsp;<span class="num" id="8549842">0x9e</span><span class="op" id="8549846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8549851">0xa8</span><span class="op" id="8549855">,</span>&nbsp;<span class="num" id="8549857">0xcc</span><span class="op" id="8549861">,</span>&nbsp;<span class="num" id="8549863">0x75</span><span class="op" id="8549867">,</span>&nbsp;<span class="num" id="8549869">0x07</span><span class="op" id="8549873">,</span>&nbsp;<span class="num" id="8549875">0x6d</span><span class="op" id="8549879">,</span>&nbsp;<span class="num" id="8549881">0x9f</span><span class="op" id="8549885">,</span>&nbsp;<span class="num" id="8549887">0xb9</span><span class="op" id="8549891">,</span>&nbsp;<span class="num" id="8549893">0xc5</span><span class="op" id="8549897">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8549902">0x41</span><span class="op" id="8549906">,</span>&nbsp;<span class="num" id="8549908">0x7a</span><span class="op" id="8549912">,</span>&nbsp;<span class="num" id="8549914">0xa5</span><span class="op" id="8549918">,</span>&nbsp;<span class="num" id="8549920">0xcb</span><span class="op" id="8549924">,</span>&nbsp;<span class="num" id="8549926">0x30</span><span class="op" id="8549930">,</span>&nbsp;<span class="num" id="8549932">0xfc</span><span class="op" id="8549936">,</span>&nbsp;<span class="num" id="8549938">0x22</span><span class="op" id="8549942">,</span>&nbsp;<span class="num" id="8549944">0x19</span><span class="op" id="8549948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8549953">0x8b</span><span class="op" id="8549957">,</span>&nbsp;<span class="num" id="8549959">0x34</span><span class="op" id="8549963">,</span>&nbsp;<span class="num" id="8549965">0x98</span><span class="op" id="8549969">,</span>&nbsp;<span class="num" id="8549971">0x2d</span><span class="op" id="8549975">,</span>&nbsp;<span class="num" id="8549977">0xbb</span><span class="op" id="8549981">,</span>&nbsp;<span class="num" id="8549983">0x62</span><span class="op" id="8549987">,</span>&nbsp;<span class="num" id="8549989">0x9e</span><span class="op" id="8549993">,</span>&nbsp;<span class="num" id="8549995">0xc0</span><span class="op" id="8549999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550004">0x4b</span><span class="op" id="8550008">,</span>&nbsp;<span class="num" id="8550010">0x4f</span><span class="op" id="8550014">,</span>&nbsp;<span class="num" id="8550016">0x8b</span><span class="op" id="8550020">,</span>&nbsp;<span class="num" id="8550022">0x05</span><span class="op" id="8550026">,</span>&nbsp;<span class="num" id="8550028">0xa0</span><span class="op" id="8550032">,</span>&nbsp;<span class="num" id="8550034">0x71</span><span class="op" id="8550038">,</span>&nbsp;<span class="num" id="8550040">0x08</span><span class="op" id="8550044">,</span>&nbsp;<span class="num" id="8550046">0x50</span><span class="op" id="8550050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550055">0x92</span><span class="op" id="8550059">,</span>&nbsp;<span class="num" id="8550061">0xa0</span><span class="op" id="8550065">,</span>&nbsp;<span class="num" id="8550067">0xc3</span><span class="op" id="8550071">,</span>&nbsp;<span class="num" id="8550073">0x58</span><span class="op" id="8550077">,</span>&nbsp;<span class="num" id="8550079">0x4a</span><span class="op" id="8550083">,</span>&nbsp;<span class="num" id="8550085">0x48</span><span class="op" id="8550089">,</span>&nbsp;<span class="num" id="8550091">0xe4</span><span class="op" id="8550095">,</span>&nbsp;<span class="num" id="8550097">0xa3</span><span class="op" id="8550101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550106">0x0a</span><span class="op" id="8550110">,</span>&nbsp;<span class="num" id="8550112">0x39</span><span class="op" id="8550116">,</span>&nbsp;<span class="num" id="8550118">0x7b</span><span class="op" id="8550122">,</span>&nbsp;<span class="num" id="8550124">0x8a</span><span class="op" id="8550128">,</span>&nbsp;<span class="num" id="8550130">0xcd</span><span class="op" id="8550134">,</span>&nbsp;<span class="num" id="8550136">0x1d</span><span class="op" id="8550140">,</span>&nbsp;<span class="num" id="8550142">0x00</span><span class="op" id="8550146">,</span>&nbsp;<span class="num" id="8550148">0x9e</span><span class="op" id="8550152">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550157">0xc8</span><span class="op" id="8550161">,</span>&nbsp;<span class="num" id="8550163">0x7d</span><span class="op" id="8550167">,</span>&nbsp;<span class="num" id="8550169">0x68</span><span class="op" id="8550173">,</span>&nbsp;<span class="num" id="8550175">0x11</span><span class="op" id="8550179">,</span>&nbsp;<span class="num" id="8550181">0xf2</span><span class="op" id="8550185">,</span>&nbsp;<span class="num" id="8550187">0x2c</span><span class="op" id="8550191">,</span>&nbsp;<span class="num" id="8550193">0xf4</span><span class="op" id="8550197">,</span>&nbsp;<span class="num" id="8550199">0x9c</span><span class="op" id="8550203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550208">0xa3</span><span class="op" id="8550212">,</span>&nbsp;<span class="num" id="8550214">0xe5</span><span class="op" id="8550218">,</span>&nbsp;<span class="num" id="8550220">0x93</span><span class="op" id="8550224">,</span>&nbsp;<span class="num" id="8550226">0x54</span><span class="op" id="8550230">,</span>&nbsp;<span class="num" id="8550232">0xb9</span><span class="op" id="8550236">,</span>&nbsp;<span class="num" id="8550238">0x45</span><span class="op" id="8550242">,</span>&nbsp;<span class="num" id="8550244">0x15</span><span class="op" id="8550248">,</span>&nbsp;<span class="num" id="8550250">0x35</span><span class="op" id="8550254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550259">0xa2</span><span class="op" id="8550263">,</span>&nbsp;<span class="num" id="8550265">0x18</span><span class="op" id="8550269">,</span>&nbsp;<span class="num" id="8550271">0x7a</span><span class="op" id="8550275">,</span>&nbsp;<span class="num" id="8550277">0x86</span><span class="op" id="8550281">,</span>&nbsp;<span class="num" id="8550283">0x42</span><span class="op" id="8550287">,</span>&nbsp;<span class="num" id="8550289">0x6c</span><span class="op" id="8550293">,</span>&nbsp;<span class="num" id="8550295">0xca</span><span class="op" id="8550299">,</span>&nbsp;<span class="num" id="8550301">0x7d</span><span class="op" id="8550305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550310">0x5e</span><span class="op" id="8550314">,</span>&nbsp;<span class="num" id="8550316">0x82</span><span class="op" id="8550320">,</span>&nbsp;<span class="num" id="8550322">0x3e</span><span class="op" id="8550326">,</span>&nbsp;<span class="num" id="8550328">0xba</span><span class="op" id="8550332">,</span>&nbsp;<span class="num" id="8550334">0x00</span><span class="op" id="8550338">,</span>&nbsp;<span class="num" id="8550340">0x44</span><span class="op" id="8550344">,</span>&nbsp;<span class="num" id="8550346">0x12</span><span class="op" id="8550350">,</span>&nbsp;<span class="num" id="8550352">0x67</span><span class="op" id="8550356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550361">0x12</span><span class="op" id="8550365">,</span>&nbsp;<span class="num" id="8550367">0x57</span><span class="op" id="8550371">,</span>&nbsp;<span class="num" id="8550373">0xb8</span><span class="op" id="8550377">,</span>&nbsp;<span class="num" id="8550379">0xd8</span><span class="op" id="8550383">,</span>&nbsp;<span class="num" id="8550385">0x60</span><span class="op" id="8550389">,</span>&nbsp;<span class="num" id="8550391">0xae</span><span class="op" id="8550395">,</span>&nbsp;<span class="num" id="8550397">0x4c</span><span class="op" id="8550401">,</span>&nbsp;<span class="num" id="8550403">0xbd</span><span class="op" id="8550407">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550412">0x4c</span><span class="op" id="8550416">,</span>&nbsp;<span class="num" id="8550418">0x49</span><span class="op" id="8550422">,</span>&nbsp;<span class="num" id="8550424">0x06</span><span class="op" id="8550428">,</span>&nbsp;<span class="num" id="8550430">0xbb</span><span class="op" id="8550434">,</span>&nbsp;<span class="num" id="8550436">0xc5</span><span class="op" id="8550440">,</span>&nbsp;<span class="num" id="8550442">0x35</span><span class="op" id="8550446">,</span>&nbsp;<span class="num" id="8550448">0xef</span><span class="op" id="8550452">,</span>&nbsp;<span class="num" id="8550454">0xe1</span><span class="op" id="8550458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550463">0x58</span><span class="op" id="8550467">,</span>&nbsp;<span class="num" id="8550469">0x7f</span><span class="op" id="8550473">,</span>&nbsp;<span class="num" id="8550475">0x08</span><span class="op" id="8550479">,</span>&nbsp;<span class="num" id="8550481">0xdb</span><span class="op" id="8550485">,</span>&nbsp;<span class="num" id="8550487">0x33</span><span class="op" id="8550491">,</span>&nbsp;<span class="num" id="8550493">0x95</span><span class="op" id="8550497">,</span>&nbsp;<span class="num" id="8550499">0x5c</span><span class="op" id="8550503">,</span>&nbsp;<span class="num" id="8550505">0xdb</span><span class="op" id="8550509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550514">0xcb</span><span class="op" id="8550518">,</span>&nbsp;<span class="num" id="8550520">0xad</span><span class="op" id="8550524">,</span>&nbsp;<span class="num" id="8550526">0x9b</span><span class="op" id="8550530">,</span>&nbsp;<span class="num" id="8550532">0x10</span><span class="op" id="8550536">,</span>&nbsp;<span class="num" id="8550538">0xf5</span><span class="op" id="8550542">,</span>&nbsp;<span class="num" id="8550544">0x3f</span><span class="op" id="8550548">,</span>&nbsp;<span class="num" id="8550550">0xc4</span><span class="op" id="8550554">,</span>&nbsp;<span class="num" id="8550556">0xe5</span><span class="op" id="8550560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550565">0x2c</span><span class="op" id="8550569">,</span>&nbsp;<span class="num" id="8550571">0x59</span><span class="op" id="8550575">,</span>&nbsp;<span class="num" id="8550577">0x15</span><span class="op" id="8550581">,</span>&nbsp;<span class="num" id="8550583">0x65</span><span class="op" id="8550587">,</span>&nbsp;<span class="num" id="8550589">0x51</span><span class="op" id="8550593">,</span>&nbsp;<span class="num" id="8550595">0x84</span><span class="op" id="8550599">,</span>&nbsp;<span class="num" id="8550601">0x87</span><span class="op" id="8550605">,</span>&nbsp;<span class="num" id="8550607">0xfe</span><span class="op" id="8550611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550616">0x08</span><span class="op" id="8550620">,</span>&nbsp;<span class="num" id="8550622">0x4d</span><span class="op" id="8550626">,</span>&nbsp;<span class="num" id="8550628">0x0e</span><span class="op" id="8550632">,</span>&nbsp;<span class="num" id="8550634">0x3f</span><span class="op" id="8550638">,</span>&nbsp;<span class="num" id="8550640">0x03</span><span class="op" id="8550644">,</span>&nbsp;<span class="num" id="8550646">0xde</span><span class="op" id="8550650">,</span>&nbsp;<span class="num" id="8550652">0xbc</span><span class="op" id="8550656">,</span>&nbsp;<span class="num" id="8550658">0xc9</span><span class="op" id="8550662">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550667">0xda</span><span class="op" id="8550671">,</span>&nbsp;<span class="num" id="8550673">0x1c</span><span class="op" id="8550677">,</span>&nbsp;<span class="num" id="8550679">0xe9</span><span class="op" id="8550683">,</span>&nbsp;<span class="num" id="8550685">0x0d</span><span class="op" id="8550689">,</span>&nbsp;<span class="num" id="8550691">0x08</span><span class="op" id="8550695">,</span>&nbsp;<span class="num" id="8550697">0x5c</span><span class="op" id="8550701">,</span>&nbsp;<span class="num" id="8550703">0x2d</span><span class="op" id="8550707">,</span>&nbsp;<span class="num" id="8550709">0x8a</span><span class="op" id="8550713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550718">0x19</span><span class="op" id="8550722">,</span>&nbsp;<span class="num" id="8550724">0xd8</span><span class="op" id="8550728">,</span>&nbsp;<span class="num" id="8550730">0x37</span><span class="op" id="8550734">,</span>&nbsp;<span class="num" id="8550736">0x30</span><span class="op" id="8550740">,</span>&nbsp;<span class="num" id="8550742">0x86</span><span class="op" id="8550746">,</span>&nbsp;<span class="num" id="8550748">0x16</span><span class="op" id="8550752">,</span>&nbsp;<span class="num" id="8550754">0x36</span><span class="op" id="8550758">,</span>&nbsp;<span class="num" id="8550760">0x92</span><span class="op" id="8550764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550769">0x14</span><span class="op" id="8550773">,</span>&nbsp;<span class="num" id="8550775">0x2b</span><span class="op" id="8550779">,</span>&nbsp;<span class="num" id="8550781">0xd8</span><span class="op" id="8550785">,</span>&nbsp;<span class="num" id="8550787">0xfc</span><span class="op" id="8550791">,</span>&nbsp;<span class="num" id="8550793">0x5d</span><span class="op" id="8550797">,</span>&nbsp;<span class="num" id="8550799">0x7a</span><span class="op" id="8550803">,</span>&nbsp;<span class="num" id="8550805">0x73</span><span class="op" id="8550809">,</span>&nbsp;<span class="num" id="8550811">0x49</span><span class="op" id="8550815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550820">0x6a</span><span class="op" id="8550824">,</span>&nbsp;<span class="num" id="8550826">0x8e</span><span class="op" id="8550830">,</span>&nbsp;<span class="num" id="8550832">0x59</span><span class="op" id="8550836">,</span>&nbsp;<span class="num" id="8550838">0xee</span><span class="op" id="8550842">,</span>&nbsp;<span class="num" id="8550844">0x7e</span><span class="op" id="8550848">,</span>&nbsp;<span class="num" id="8550850">0xcf</span><span class="op" id="8550854">,</span>&nbsp;<span class="num" id="8550856">0x6b</span><span class="op" id="8550860">,</span>&nbsp;<span class="num" id="8550862">0x94</span><span class="op" id="8550866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550871">0x06</span><span class="op" id="8550875">,</span>&nbsp;<span class="num" id="8550877">0x63</span><span class="op" id="8550881">,</span>&nbsp;<span class="num" id="8550883">0xf4</span><span class="op" id="8550887">,</span>&nbsp;<span class="num" id="8550889">0xa6</span><span class="op" id="8550893">,</span>&nbsp;<span class="num" id="8550895">0xbe</span><span class="op" id="8550899">,</span>&nbsp;<span class="num" id="8550901">0xe6</span><span class="op" id="8550905">,</span>&nbsp;<span class="num" id="8550907">0x5b</span><span class="op" id="8550911">,</span>&nbsp;<span class="num" id="8550913">0xd2</span><span class="op" id="8550917">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550922">0xc8</span><span class="op" id="8550926">,</span>&nbsp;<span class="num" id="8550928">0x5c</span><span class="op" id="8550932">,</span>&nbsp;<span class="num" id="8550934">0x46</span><span class="op" id="8550938">,</span>&nbsp;<span class="num" id="8550940">0x98</span><span class="op" id="8550944">,</span>&nbsp;<span class="num" id="8550946">0x6c</span><span class="op" id="8550950">,</span>&nbsp;<span class="num" id="8550952">0x1b</span><span class="op" id="8550956">,</span>&nbsp;<span class="num" id="8550958">0xef</span><span class="op" id="8550962">,</span>&nbsp;<span class="num" id="8550964">0x34</span><span class="op" id="8550968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550973">0x90</span><span class="op" id="8550977">,</span>&nbsp;<span class="num" id="8550979">0xd3</span><span class="op" id="8550983">,</span>&nbsp;<span class="num" id="8550985">0x7b</span><span class="op" id="8550989">,</span>&nbsp;<span class="num" id="8550991">0x38</span><span class="op" id="8550995">,</span>&nbsp;<span class="num" id="8550997">0xda</span><span class="op" id="8551001">,</span>&nbsp;<span class="num" id="8551003">0x85</span><span class="op" id="8551007">,</span>&nbsp;<span class="num" id="8551009">0xd3</span><span class="op" id="8551013">,</span>&nbsp;<span class="num" id="8551015">0x2e</span><span class="op" id="8551019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8551024">0x97</span><span class="op" id="8551028">,</span>&nbsp;<span class="num" id="8551030">0x39</span><span class="op" id="8551034">,</span>&nbsp;<span class="num" id="8551036">0xcb</span><span class="op" id="8551040">,</span>&nbsp;<span class="num" id="8551042">0x23</span><span class="op" id="8551046">,</span>&nbsp;<span class="num" id="8551048">0x4a</span><span class="op" id="8551052">,</span>&nbsp;<span class="num" id="8551054">0x2b</span><span class="op" id="8551058">,</span>&nbsp;<span class="num" id="8551060">0xe7</span><span class="op" id="8551064">,</span>&nbsp;<span class="num" id="8551066">0x40</span><span class="op" id="8551070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551074">}</span><span class="op" id="8551075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551078">}</span><span class="op" id="8551079">,</span><br>
<span class="lineno">75</span><span class="op" id="8551081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8551084">func</span>&nbsp;<span class="ident" id="8551089">testEncrypt</span><span class="op" id="8551100">(</span><span class="ident" id="8551101">t</span>&nbsp;<span class="op" id="8551103">*</span><span class="ident" id="8551104">testing</span><span class="op" id="8551111">.</span><span class="ident" id="8551112">T</span><span class="op" id="8551113">,</span>&nbsp;<span class="ident" id="8551115">desc</span>&nbsp;<span class="builtintype" id="8551120">string</span><span class="op" id="8551126">,</span>&nbsp;<span class="ident" id="8551128">c</span>&nbsp;<span class="op" id="8551130">*</span><span class="ident" id="8551131">Cipher</span><span class="op" id="8551137">,</span>&nbsp;<span class="ident" id="8551139">src</span><span class="op" id="8551142">,</span>&nbsp;<span class="ident" id="8551144">expect</span>&nbsp;<span class="op" id="8551151">[</span><span class="op" id="8551152">]</span><span class="builtintype" id="8551153">byte</span><span class="op" id="8551157">)</span>&nbsp;<span class="op" id="8551159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551162">dst</span>&nbsp;<span class="op" id="8551166">:=</span>&nbsp;<span class="builtinfunc" id="8551169">make</span><span class="op" id="8551173">(</span><span class="op" id="8551174">[</span><span class="op" id="8551175">]</span><span class="builtintype" id="8551176">byte</span><span class="op" id="8551180">,</span>&nbsp;<span class="builtinfunc" id="8551182">len</span><span class="op" id="8551185">(</span><span class="ident" id="8551186">src</span><span class="op" id="8551189">)</span><span class="op" id="8551190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551193">c</span><span class="op" id="8551194">.</span><span class="ident" id="8551195">XORKeyStream</span><span class="op" id="8551207">(</span><span class="ident" id="8551208">dst</span><span class="op" id="8551211">,</span>&nbsp;<span class="ident" id="8551213">src</span><span class="op" id="8551216">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551219">for</span>&nbsp;<span class="ident" id="8551223">i</span><span class="op" id="8551224">,</span>&nbsp;<span class="ident" id="8551226">v</span>&nbsp;<span class="op" id="8551228">:=</span>&nbsp;<span class="keyword" id="8551231">range</span>&nbsp;<span class="ident" id="8551237">dst</span>&nbsp;<span class="op" id="8551241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551245">if</span>&nbsp;<span class="ident" id="8551248">v</span>&nbsp;<span class="op" id="8551250">!=</span>&nbsp;<span class="ident" id="8551253">expect</span><span class="op" id="8551259">[</span><span class="ident" id="8551260">i</span><span class="op" id="8551261">]</span>&nbsp;<span class="op" id="8551263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551268">t</span><span class="op" id="8551269">.</span><span class="ident" id="8551270">Fatalf</span><span class="op" id="8551276">(</span><span class="string" id="8551277">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="8551321">,</span>&nbsp;<span class="ident" id="8551323">desc</span><span class="op" id="8551327">,</span>&nbsp;<span class="ident" id="8551329">i</span><span class="op" id="8551330">,</span>&nbsp;<span class="ident" id="8551332">dst</span><span class="op" id="8551335">,</span>&nbsp;<span class="ident" id="8551337">expect</span><span class="op" id="8551343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551350">}</span><br>
<span class="lineno">85</span><span class="op" id="8551352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8551355">func</span>&nbsp;<span class="ident" id="8551360">TestGolden</span><span class="op" id="8551370">(</span><span class="ident" id="8551371">t</span>&nbsp;<span class="op" id="8551373">*</span><span class="ident" id="8551374">testing</span><span class="op" id="8551381">.</span><span class="ident" id="8551382">T</span><span class="op" id="8551383">)</span>&nbsp;<span class="op" id="8551385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551388">for</span>&nbsp;<span class="ident" id="8551392">gi</span><span class="op" id="8551394">,</span>&nbsp;<span class="ident" id="8551396">g</span>&nbsp;<span class="op" id="8551398">:=</span>&nbsp;<span class="keyword" id="8551401">range</span>&nbsp;<span class="ident" id="8551407">golden</span>&nbsp;<span class="op" id="8551414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551418">data</span>&nbsp;<span class="op" id="8551423">:=</span>&nbsp;<span class="builtinfunc" id="8551426">make</span><span class="op" id="8551430">(</span><span class="op" id="8551431">[</span><span class="op" id="8551432">]</span><span class="builtintype" id="8551433">byte</span><span class="op" id="8551437">,</span>&nbsp;<span class="builtinfunc" id="8551439">len</span><span class="op" id="8551442">(</span><span class="ident" id="8551443">g</span><span class="op" id="8551444">.</span><span class="ident" id="8551445">keystream</span><span class="op" id="8551454">)</span><span class="op" id="8551455">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551459">for</span>&nbsp;<span class="ident" id="8551463">i</span>&nbsp;<span class="op" id="8551465">:=</span>&nbsp;<span class="keyword" id="8551468">range</span>&nbsp;<span class="ident" id="8551474">data</span>&nbsp;<span class="op" id="8551479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551484">data</span><span class="op" id="8551488">[</span><span class="ident" id="8551489">i</span><span class="op" id="8551490">]</span>&nbsp;<span class="op" id="8551492">=</span>&nbsp;<span class="builtintype" id="8551494">byte</span><span class="op" id="8551498">(</span><span class="ident" id="8551499">i</span><span class="op" id="8551500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551509">expect</span>&nbsp;<span class="op" id="8551516">:=</span>&nbsp;<span class="builtinfunc" id="8551519">make</span><span class="op" id="8551523">(</span><span class="op" id="8551524">[</span><span class="op" id="8551525">]</span><span class="builtintype" id="8551526">byte</span><span class="op" id="8551530">,</span>&nbsp;<span class="builtinfunc" id="8551532">len</span><span class="op" id="8551535">(</span><span class="ident" id="8551536">g</span><span class="op" id="8551537">.</span><span class="ident" id="8551538">keystream</span><span class="op" id="8551547">)</span><span class="op" id="8551548">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551552">for</span>&nbsp;<span class="ident" id="8551556">i</span>&nbsp;<span class="op" id="8551558">:=</span>&nbsp;<span class="keyword" id="8551561">range</span>&nbsp;<span class="ident" id="8551567">expect</span>&nbsp;<span class="op" id="8551574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551579">expect</span><span class="op" id="8551585">[</span><span class="ident" id="8551586">i</span><span class="op" id="8551587">]</span>&nbsp;<span class="op" id="8551589">=</span>&nbsp;<span class="builtintype" id="8551591">byte</span><span class="op" id="8551595">(</span><span class="ident" id="8551596">i</span><span class="op" id="8551597">)</span>&nbsp;<span class="op" id="8551599">^</span>&nbsp;<span class="ident" id="8551601">g</span><span class="op" id="8551602">.</span><span class="ident" id="8551603">keystream</span><span class="op" id="8551612">[</span><span class="ident" id="8551613">i</span><span class="op" id="8551614">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551623">for</span>&nbsp;<span class="ident" id="8551627">size</span>&nbsp;<span class="op" id="8551632">:=</span>&nbsp;<span class="num" id="8551635">1</span><span class="op" id="8551636">;</span>&nbsp;<span class="ident" id="8551638">size</span>&nbsp;<span class="op" id="8551643">&lt;=</span>&nbsp;<span class="builtinfunc" id="8551646">len</span><span class="op" id="8551649">(</span><span class="ident" id="8551650">g</span><span class="op" id="8551651">.</span><span class="ident" id="8551652">keystream</span><span class="op" id="8551661">)</span><span class="op" id="8551662">;</span>&nbsp;<span class="ident" id="8551664">size</span><span class="op" id="8551668">++</span>&nbsp;<span class="op" id="8551671">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551676">c</span><span class="op" id="8551677">,</span>&nbsp;<span class="ident" id="8551679">err</span>&nbsp;<span class="op" id="8551683">:=</span>&nbsp;<span class="ident" id="8551686">NewCipher</span><span class="op" id="8551695">(</span><span class="ident" id="8551696">g</span><span class="op" id="8551697">.</span><span class="ident" id="8551698">key</span><span class="op" id="8551701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551706">if</span>&nbsp;<span class="ident" id="8551709">err</span>&nbsp;<span class="op" id="8551713">!=</span>&nbsp;<span class="ident" id="8551716">nil</span>&nbsp;<span class="op" id="8551720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551726">t</span><span class="op" id="8551727">.</span><span class="ident" id="8551728">Fatalf</span><span class="op" id="8551734">(</span><span class="string" id="8551735">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="8551755">,</span>&nbsp;<span class="ident" id="8551757">gi</span><span class="op" id="8551759">,</span>&nbsp;<span class="ident" id="8551761">err</span><span class="op" id="8551764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551775">off</span>&nbsp;<span class="op" id="8551779">:=</span>&nbsp;<span class="num" id="8551782">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551787">for</span>&nbsp;<span class="ident" id="8551791">off</span>&nbsp;<span class="op" id="8551795">&lt;</span>&nbsp;<span class="builtinfunc" id="8551797">len</span><span class="op" id="8551800">(</span><span class="ident" id="8551801">g</span><span class="op" id="8551802">.</span><span class="ident" id="8551803">keystream</span><span class="op" id="8551812">)</span>&nbsp;<span class="op" id="8551814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551820">n</span>&nbsp;<span class="op" id="8551822">:=</span>&nbsp;<span class="builtinfunc" id="8551825">len</span><span class="op" id="8551828">(</span><span class="ident" id="8551829">g</span><span class="op" id="8551830">.</span><span class="ident" id="8551831">keystream</span><span class="op" id="8551840">)</span>&nbsp;<span class="op" id="8551842">-</span>&nbsp;<span class="ident" id="8551844">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551852">if</span>&nbsp;<span class="ident" id="8551855">n</span>&nbsp;<span class="op" id="8551857">&gt;</span>&nbsp;<span class="ident" id="8551859">size</span>&nbsp;<span class="op" id="8551864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551871">n</span>&nbsp;<span class="op" id="8551873">=</span>&nbsp;<span class="ident" id="8551875">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551890">desc</span>&nbsp;<span class="op" id="8551895">:=</span>&nbsp;<span class="ident" id="8551898">fmt</span><span class="op" id="8551901">.</span><span class="ident" id="8551902">Sprintf</span><span class="op" id="8551909">(</span><span class="string" id="8551910">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="8551923">,</span>&nbsp;<span class="ident" id="8551925">gi</span><span class="op" id="8551927">,</span>&nbsp;<span class="ident" id="8551929">off</span><span class="op" id="8551932">,</span>&nbsp;<span class="ident" id="8551934">off</span><span class="op" id="8551937">+</span><span class="ident" id="8551938">n</span><span class="op" id="8551939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551945">testEncrypt</span><span class="op" id="8551956">(</span><span class="ident" id="8551957">t</span><span class="op" id="8551958">,</span>&nbsp;<span class="ident" id="8551960">desc</span><span class="op" id="8551964">,</span>&nbsp;<span class="ident" id="8551966">c</span><span class="op" id="8551967">,</span>&nbsp;<span class="ident" id="8551969">data</span><span class="op" id="8551973">[</span><span class="ident" id="8551974">off</span><span class="op" id="8551977">:</span><span class="ident" id="8551978">off</span><span class="op" id="8551981">+</span><span class="ident" id="8551982">n</span><span class="op" id="8551983">]</span><span class="op" id="8551984">,</span>&nbsp;<span class="ident" id="8551986">expect</span><span class="op" id="8551992">[</span><span class="ident" id="8551993">off</span><span class="op" id="8551996">:</span><span class="ident" id="8551997">off</span><span class="op" id="8552000">+</span><span class="ident" id="8552001">n</span><span class="op" id="8552002">]</span><span class="op" id="8552003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552009">off</span>&nbsp;<span class="op" id="8552013">+=</span>&nbsp;<span class="ident" id="8552016">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552021">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552028">}</span><br>
<span class="lineno"></span><span class="op" id="8552030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8552033">func</span>&nbsp;<span class="ident" id="8552038">TestBlock</span><span class="op" id="8552047">(</span><span class="ident" id="8552048">t</span>&nbsp;<span class="op" id="8552050">*</span><span class="ident" id="8552051">testing</span><span class="op" id="8552058">.</span><span class="ident" id="8552059">T</span><span class="op" id="8552060">)</span>&nbsp;<span class="op" id="8552062">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552065">testBlock</span><span class="op" id="8552074">(</span><span class="ident" id="8552075">t</span><span class="op" id="8552076">,</span>&nbsp;<span class="op" id="8552078">(</span><span class="op" id="8552079">*</span><span class="ident" id="8552080">Cipher</span><span class="op" id="8552086">)</span><span class="op" id="8552087">.</span><span class="ident" id="8552088">XORKeyStream</span><span class="op" id="8552100">)</span><br>
<span class="lineno"></span><span class="op" id="8552102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8552105">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="8552134">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="8552201">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="8552245">func</span>&nbsp;<span class="ident" id="8552250">TestBlockGeneric</span><span class="op" id="8552266">(</span><span class="ident" id="8552267">t</span>&nbsp;<span class="op" id="8552269">*</span><span class="ident" id="8552270">testing</span><span class="op" id="8552277">.</span><span class="ident" id="8552278">T</span><span class="op" id="8552279">)</span>&nbsp;<span class="op" id="8552281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552284">testBlock</span><span class="op" id="8552293">(</span><span class="ident" id="8552294">t</span><span class="op" id="8552295">,</span>&nbsp;<span class="op" id="8552297">(</span><span class="op" id="8552298">*</span><span class="ident" id="8552299">Cipher</span><span class="op" id="8552305">)</span><span class="op" id="8552306">.</span><span class="ident" id="8552307">xorKeyStreamGeneric</span><span class="op" id="8552326">)</span><br>
<span class="lineno"></span><span class="op" id="8552328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8552331">func</span>&nbsp;<span class="ident" id="8552336">testBlock</span><span class="op" id="8552345">(</span><span class="ident" id="8552346">t</span>&nbsp;<span class="op" id="8552348">*</span><span class="ident" id="8552349">testing</span><span class="op" id="8552356">.</span><span class="ident" id="8552357">T</span><span class="op" id="8552358">,</span>&nbsp;<span class="ident" id="8552360">xor</span>&nbsp;<span class="keyword" id="8552364">func</span><span class="op" id="8552368">(</span><span class="ident" id="8552369">c</span>&nbsp;<span class="op" id="8552371">*</span><span class="ident" id="8552372">Cipher</span><span class="op" id="8552378">,</span>&nbsp;<span class="ident" id="8552380">dst</span><span class="op" id="8552383">,</span>&nbsp;<span class="ident" id="8552385">src</span>&nbsp;<span class="op" id="8552389">[</span><span class="op" id="8552390">]</span><span class="builtintype" id="8552391">byte</span><span class="op" id="8552395">)</span><span class="op" id="8552396">)</span>&nbsp;<span class="op" id="8552398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552401">c1a</span><span class="op" id="8552404">,</span>&nbsp;<span class="ident" id="8552406">_</span>&nbsp;<span class="op" id="8552408">:=</span>&nbsp;<span class="ident" id="8552411">NewCipher</span><span class="op" id="8552420">(</span><span class="ident" id="8552421">golden</span><span class="op" id="8552427">[</span><span class="num" id="8552428">0</span><span class="op" id="8552429">]</span><span class="op" id="8552430">.</span><span class="ident" id="8552431">key</span><span class="op" id="8552434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552437">c1b</span><span class="op" id="8552440">,</span>&nbsp;<span class="ident" id="8552442">_</span>&nbsp;<span class="op" id="8552444">:=</span>&nbsp;<span class="ident" id="8552447">NewCipher</span><span class="op" id="8552456">(</span><span class="ident" id="8552457">golden</span><span class="op" id="8552463">[</span><span class="num" id="8552464">1</span><span class="op" id="8552465">]</span><span class="op" id="8552466">.</span><span class="ident" id="8552467">key</span><span class="op" id="8552470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552473">data1</span>&nbsp;<span class="op" id="8552479">:=</span>&nbsp;<span class="builtinfunc" id="8552482">make</span><span class="op" id="8552486">(</span><span class="op" id="8552487">[</span><span class="op" id="8552488">]</span><span class="builtintype" id="8552489">byte</span><span class="op" id="8552493">,</span>&nbsp;<span class="num" id="8552495">1</span><span class="op" id="8552496">&lt;&lt;</span><span class="num" id="8552498">20</span><span class="op" id="8552500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552503">for</span>&nbsp;<span class="ident" id="8552507">i</span>&nbsp;<span class="op" id="8552509">:=</span>&nbsp;<span class="keyword" id="8552512">range</span>&nbsp;<span class="ident" id="8552518">data1</span>&nbsp;<span class="op" id="8552524">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552528">xor</span><span class="op" id="8552531">(</span><span class="ident" id="8552532">c1a</span><span class="op" id="8552535">,</span>&nbsp;<span class="ident" id="8552537">data1</span><span class="op" id="8552542">[</span><span class="ident" id="8552543">i</span><span class="op" id="8552544">:</span><span class="ident" id="8552545">i</span><span class="op" id="8552546">+</span><span class="num" id="8552547">1</span><span class="op" id="8552548">]</span><span class="op" id="8552549">,</span>&nbsp;<span class="ident" id="8552551">data1</span><span class="op" id="8552556">[</span><span class="ident" id="8552557">i</span><span class="op" id="8552558">:</span><span class="ident" id="8552559">i</span><span class="op" id="8552560">+</span><span class="num" id="8552561">1</span><span class="op" id="8552562">]</span><span class="op" id="8552563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552567">xor</span><span class="op" id="8552570">(</span><span class="ident" id="8552571">c1b</span><span class="op" id="8552574">,</span>&nbsp;<span class="ident" id="8552576">data1</span><span class="op" id="8552581">[</span><span class="ident" id="8552582">i</span><span class="op" id="8552583">:</span><span class="ident" id="8552584">i</span><span class="op" id="8552585">+</span><span class="num" id="8552586">1</span><span class="op" id="8552587">]</span><span class="op" id="8552588">,</span>&nbsp;<span class="ident" id="8552590">data1</span><span class="op" id="8552595">[</span><span class="ident" id="8552596">i</span><span class="op" id="8552597">:</span><span class="ident" id="8552598">i</span><span class="op" id="8552599">+</span><span class="num" id="8552600">1</span><span class="op" id="8552601">]</span><span class="op" id="8552602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552609">c2a</span><span class="op" id="8552612">,</span>&nbsp;<span class="ident" id="8552614">_</span>&nbsp;<span class="op" id="8552616">:=</span>&nbsp;<span class="ident" id="8552619">NewCipher</span><span class="op" id="8552628">(</span><span class="ident" id="8552629">golden</span><span class="op" id="8552635">[</span><span class="num" id="8552636">0</span><span class="op" id="8552637">]</span><span class="op" id="8552638">.</span><span class="ident" id="8552639">key</span><span class="op" id="8552642">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552645">c2b</span><span class="op" id="8552648">,</span>&nbsp;<span class="ident" id="8552650">_</span>&nbsp;<span class="op" id="8552652">:=</span>&nbsp;<span class="ident" id="8552655">NewCipher</span><span class="op" id="8552664">(</span><span class="ident" id="8552665">golden</span><span class="op" id="8552671">[</span><span class="num" id="8552672">1</span><span class="op" id="8552673">]</span><span class="op" id="8552674">.</span><span class="ident" id="8552675">key</span><span class="op" id="8552678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552681">data2</span>&nbsp;<span class="op" id="8552687">:=</span>&nbsp;<span class="builtinfunc" id="8552690">make</span><span class="op" id="8552694">(</span><span class="op" id="8552695">[</span><span class="op" id="8552696">]</span><span class="builtintype" id="8552697">byte</span><span class="op" id="8552701">,</span>&nbsp;<span class="num" id="8552703">1</span><span class="op" id="8552704">&lt;&lt;</span><span class="num" id="8552706">20</span><span class="op" id="8552708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552711">xor</span><span class="op" id="8552714">(</span><span class="ident" id="8552715">c2a</span><span class="op" id="8552718">,</span>&nbsp;<span class="ident" id="8552720">data2</span><span class="op" id="8552725">,</span>&nbsp;<span class="ident" id="8552727">data2</span><span class="op" id="8552732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552735">xor</span><span class="op" id="8552738">(</span><span class="ident" id="8552739">c2b</span><span class="op" id="8552742">,</span>&nbsp;<span class="ident" id="8552744">data2</span><span class="op" id="8552749">,</span>&nbsp;<span class="ident" id="8552751">data2</span><span class="op" id="8552756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552760">if</span>&nbsp;<span class="op" id="8552763">!</span><span class="ident" id="8552764">bytes</span><span class="op" id="8552769">.</span><span class="ident" id="8552770">Equal</span><span class="op" id="8552775">(</span><span class="ident" id="8552776">data1</span><span class="op" id="8552781">,</span>&nbsp;<span class="ident" id="8552783">data2</span><span class="op" id="8552788">)</span>&nbsp;<span class="op" id="8552790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552794">t</span><span class="op" id="8552795">.</span><span class="ident" id="8552796">Fatalf</span><span class="op" id="8552802">(</span><span class="string" id="8552803">&#34;bad&nbsp;block&#34;</span><span class="op" id="8552814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552817">}</span><br>
<span class="lineno"></span><span class="op" id="8552819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8552822">func</span>&nbsp;<span class="ident" id="8552827">benchmark</span><span class="op" id="8552836">(</span><span class="ident" id="8552837">b</span>&nbsp;<span class="op" id="8552839">*</span><span class="ident" id="8552840">testing</span><span class="op" id="8552847">.</span><span class="ident" id="8552848">B</span><span class="op" id="8552849">,</span>&nbsp;<span class="ident" id="8552851">size</span>&nbsp;<span class="ident" id="8552856">int64</span><span class="op" id="8552861">)</span>&nbsp;<span class="op" id="8552863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552866">buf</span>&nbsp;<span class="op" id="8552870">:=</span>&nbsp;<span class="builtinfunc" id="8552873">make</span><span class="op" id="8552877">(</span><span class="op" id="8552878">[</span><span class="op" id="8552879">]</span><span class="builtintype" id="8552880">byte</span><span class="op" id="8552884">,</span>&nbsp;<span class="ident" id="8552886">size</span><span class="op" id="8552890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552893">c</span><span class="op" id="8552894">,</span>&nbsp;<span class="ident" id="8552896">err</span>&nbsp;<span class="op" id="8552900">:=</span>&nbsp;<span class="ident" id="8552903">NewCipher</span><span class="op" id="8552912">(</span><span class="ident" id="8552913">golden</span><span class="op" id="8552919">[</span><span class="num" id="8552920">0</span><span class="op" id="8552921">]</span><span class="op" id="8552922">.</span><span class="ident" id="8552923">key</span><span class="op" id="8552926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552929">if</span>&nbsp;<span class="ident" id="8552932">err</span>&nbsp;<span class="op" id="8552936">!=</span>&nbsp;<span class="ident" id="8552939">nil</span>&nbsp;<span class="op" id="8552943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8552947">panic</span><span class="op" id="8552952">(</span><span class="ident" id="8552953">err</span><span class="op" id="8552956">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552962">b</span><span class="op" id="8552963">.</span><span class="ident" id="8552964">SetBytes</span><span class="op" id="8552972">(</span><span class="ident" id="8552973">size</span><span class="op" id="8552977">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552981">for</span>&nbsp;<span class="ident" id="8552985">i</span>&nbsp;<span class="op" id="8552987">:=</span>&nbsp;<span class="num" id="8552990">0</span><span class="op" id="8552991">;</span>&nbsp;<span class="ident" id="8552993">i</span>&nbsp;<span class="op" id="8552995">&lt;</span>&nbsp;<span class="ident" id="8552997">b</span><span class="op" id="8552998">.</span><span class="ident" id="8552999">N</span><span class="op" id="8553000">;</span>&nbsp;<span class="ident" id="8553002">i</span><span class="op" id="8553003">++</span>&nbsp;<span class="op" id="8553006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8553010">c</span><span class="op" id="8553011">.</span><span class="ident" id="8553012">XORKeyStream</span><span class="op" id="8553024">(</span><span class="ident" id="8553025">buf</span><span class="op" id="8553028">,</span>&nbsp;<span class="ident" id="8553030">buf</span><span class="op" id="8553033">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8553036">}</span><br>
<span class="lineno"></span><span class="op" id="8553038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8553041">func</span>&nbsp;<span class="ident" id="8553046">BenchmarkRC4_128</span><span class="op" id="8553062">(</span><span class="ident" id="8553063">b</span>&nbsp;<span class="op" id="8553065">*</span><span class="ident" id="8553066">testing</span><span class="op" id="8553073">.</span><span class="ident" id="8553074">B</span><span class="op" id="8553075">)</span>&nbsp;<span class="op" id="8553077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8553080">benchmark</span><span class="op" id="8553089">(</span><span class="ident" id="8553090">b</span><span class="op" id="8553091">,</span>&nbsp;<span class="num" id="8553093">128</span><span class="op" id="8553096">)</span><br>
<span class="lineno">165</span><span class="op" id="8553098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8553101">func</span>&nbsp;<span class="ident" id="8553106">BenchmarkRC4_1K</span><span class="op" id="8553121">(</span><span class="ident" id="8553122">b</span>&nbsp;<span class="op" id="8553124">*</span><span class="ident" id="8553125">testing</span><span class="op" id="8553132">.</span><span class="ident" id="8553133">B</span><span class="op" id="8553134">)</span>&nbsp;<span class="op" id="8553136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8553139">benchmark</span><span class="op" id="8553148">(</span><span class="ident" id="8553149">b</span><span class="op" id="8553150">,</span>&nbsp;<span class="num" id="8553152">1024</span><span class="op" id="8553156">)</span><br>
<span class="lineno"></span><span class="op" id="8553158">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8553161">func</span>&nbsp;<span class="ident" id="8553166">BenchmarkRC4_8K</span><span class="op" id="8553181">(</span><span class="ident" id="8553182">b</span>&nbsp;<span class="op" id="8553184">*</span><span class="ident" id="8553185">testing</span><span class="op" id="8553192">.</span><span class="ident" id="8553193">B</span><span class="op" id="8553194">)</span>&nbsp;<span class="op" id="8553196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8553199">benchmark</span><span class="op" id="8553208">(</span><span class="ident" id="8553209">b</span><span class="op" id="8553210">,</span>&nbsp;<span class="num" id="8553212">8096</span><span class="op" id="8553216">)</span><br>
<span class="lineno"></span><span class="op" id="8553218">}</span>
</div>
</body>
</html>
