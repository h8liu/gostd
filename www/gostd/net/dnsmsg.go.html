<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3252472">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3252527">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3252581">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3252632">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3252671">//</span><br>
<span class="lineno"></span><span class="comment" id="3252674">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3252734">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3252773">//</span><br>
<span class="lineno">10</span><span class="comment" id="3252776">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3252836">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3252901">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3252968">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3252992">//</span><br>
<span class="lineno">15</span><span class="comment" id="3252995">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3253059">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3253129">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3253192">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3253225">//</span><br>
<span class="lineno">20</span><span class="comment" id="3253228">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3253304">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3253371">package</span>&nbsp;<span class="ident" id="3253379">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3253384">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3253403">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3253422">const</span>&nbsp;<span class="op" id="3253428">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3253431">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253483">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253496">=</span>&nbsp;<span class="num" id="3253498">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253501">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253514">=</span>&nbsp;<span class="num" id="3253516">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253519">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253532">=</span>&nbsp;<span class="num" id="3253534">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253537">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253550">=</span>&nbsp;<span class="num" id="3253552">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253555">dnsTypeCNAME</span>&nbsp;<span class="op" id="3253568">=</span>&nbsp;<span class="num" id="3253570">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253573">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3253586">=</span>&nbsp;<span class="num" id="3253588">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253591">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253604">=</span>&nbsp;<span class="num" id="3253606">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253609">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253622">=</span>&nbsp;<span class="num" id="3253624">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253627">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253640">=</span>&nbsp;<span class="num" id="3253642">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253645">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3253658">=</span>&nbsp;<span class="num" id="3253660">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253664">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3253677">=</span>&nbsp;<span class="num" id="3253679">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253683">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3253696">=</span>&nbsp;<span class="num" id="3253698">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253702">dnsTypeHINFO</span>&nbsp;<span class="op" id="3253715">=</span>&nbsp;<span class="num" id="3253717">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253721">dnsTypeMINFO</span>&nbsp;<span class="op" id="3253734">=</span>&nbsp;<span class="num" id="3253736">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253740">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253753">=</span>&nbsp;<span class="num" id="3253755">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253759">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3253772">=</span>&nbsp;<span class="num" id="3253774">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253778">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3253791">=</span>&nbsp;<span class="num" id="3253793">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253797">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3253810">=</span>&nbsp;<span class="num" id="3253812">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3253817">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253850">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3253863">=</span>&nbsp;<span class="num" id="3253865">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253870">dnsTypeMAILB</span>&nbsp;<span class="op" id="3253883">=</span>&nbsp;<span class="num" id="3253885">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253890">dnsTypeMAILA</span>&nbsp;<span class="op" id="3253903">=</span>&nbsp;<span class="num" id="3253905">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253910">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3253923">=</span>&nbsp;<span class="num" id="3253925">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3253931">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253960">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3253975">=</span>&nbsp;<span class="num" id="3253977">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3253980">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3253995">=</span>&nbsp;<span class="num" id="3253997">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254000">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3254015">=</span>&nbsp;<span class="num" id="3254017">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254020">dnsClassHESIOD</span>&nbsp;<span class="op" id="3254035">=</span>&nbsp;<span class="num" id="3254037">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254040">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254055">=</span>&nbsp;<span class="num" id="3254057">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254063">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254080">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254103">=</span>&nbsp;<span class="num" id="3254105">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254108">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254131">=</span>&nbsp;<span class="num" id="3254133">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254136">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3254159">=</span>&nbsp;<span class="num" id="3254161">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254164">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254187">=</span>&nbsp;<span class="num" id="3254189">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254192">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3254215">=</span>&nbsp;<span class="num" id="3254217">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254220">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254243">=</span>&nbsp;<span class="num" id="3254245">5</span><br>
<span class="lineno"></span><span class="op" id="3254247">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3254250">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3254317">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3254344">type</span>&nbsp;<span class="ident" id="3254349">dnsStruct</span>&nbsp;<span class="keyword" id="3254359">interface</span>&nbsp;<span class="op" id="3254369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254372">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254429">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254487">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254543">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254593">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254649">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254691">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3254747">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254785">Walk</span><span class="op" id="3254789">(</span><span class="ident" id="3254790">f</span>&nbsp;<span class="keyword" id="3254792">func</span><span class="op" id="3254796">(</span><span class="ident" id="3254797">v</span>&nbsp;<span class="keyword" id="3254799">interface</span><span class="op" id="3254808">{</span><span class="op" id="3254809">}</span><span class="op" id="3254810">,</span>&nbsp;<span class="ident" id="3254812">name</span><span class="op" id="3254816">,</span>&nbsp;<span class="ident" id="3254818">tag</span>&nbsp;<span class="builtintype" id="3254822">string</span><span class="op" id="3254828">)</span>&nbsp;<span class="op" id="3254830">(</span><span class="ident" id="3254831">ok</span>&nbsp;<span class="builtintype" id="3254834">bool</span><span class="op" id="3254838">)</span><span class="op" id="3254839">)</span>&nbsp;<span class="op" id="3254841">(</span><span class="ident" id="3254842">ok</span>&nbsp;<span class="builtintype" id="3254845">bool</span><span class="op" id="3254849">)</span><br>
<span class="lineno"></span><span class="op" id="3254851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3254854">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3254900">type</span>&nbsp;<span class="ident" id="3254905">dnsHeader</span>&nbsp;<span class="keyword" id="3254915">struct</span>&nbsp;<span class="op" id="3254922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254925">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3254960">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3254968">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3255003">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255011">Qdcount</span><span class="op" id="3255018">,</span>&nbsp;<span class="ident" id="3255020">Ancount</span><span class="op" id="3255027">,</span>&nbsp;<span class="ident" id="3255029">Nscount</span><span class="op" id="3255036">,</span>&nbsp;<span class="ident" id="3255038">Arcount</span>&nbsp;<span class="builtintype" id="3255046">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3255053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3255056">func</span>&nbsp;<span class="op" id="3255061">(</span><span class="ident" id="3255062">h</span>&nbsp;<span class="op" id="3255064">*</span><span class="ident" id="3255065">dnsHeader</span><span class="op" id="3255074">)</span>&nbsp;<span class="ident" id="3255076">Walk</span><span class="op" id="3255080">(</span><span class="ident" id="3255081">f</span>&nbsp;<span class="keyword" id="3255083">func</span><span class="op" id="3255087">(</span><span class="ident" id="3255088">v</span>&nbsp;<span class="keyword" id="3255090">interface</span><span class="op" id="3255099">{</span><span class="op" id="3255100">}</span><span class="op" id="3255101">,</span>&nbsp;<span class="ident" id="3255103">name</span><span class="op" id="3255107">,</span>&nbsp;<span class="ident" id="3255109">tag</span>&nbsp;<span class="builtintype" id="3255113">string</span><span class="op" id="3255119">)</span>&nbsp;<span class="builtintype" id="3255121">bool</span><span class="op" id="3255125">)</span>&nbsp;<span class="builtintype" id="3255127">bool</span>&nbsp;<span class="op" id="3255132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3255135">return</span>&nbsp;<span class="ident" id="3255142">f</span><span class="op" id="3255143">(</span><span class="op" id="3255144">&amp;</span><span class="ident" id="3255145">h</span><span class="op" id="3255146">.</span><span class="ident" id="3255147">Id</span><span class="op" id="3255149">,</span>&nbsp;<span class="string" id="3255151">&#34;Id&#34;</span><span class="op" id="3255155">,</span>&nbsp;<span class="string" id="3255157">&#34;&#34;</span><span class="op" id="3255159">)</span>&nbsp;<span class="op" id="3255161">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255166">f</span><span class="op" id="3255167">(</span><span class="op" id="3255168">&amp;</span><span class="ident" id="3255169">h</span><span class="op" id="3255170">.</span><span class="ident" id="3255171">Bits</span><span class="op" id="3255175">,</span>&nbsp;<span class="string" id="3255177">&#34;Bits&#34;</span><span class="op" id="3255183">,</span>&nbsp;<span class="string" id="3255185">&#34;&#34;</span><span class="op" id="3255187">)</span>&nbsp;<span class="op" id="3255189">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255194">f</span><span class="op" id="3255195">(</span><span class="op" id="3255196">&amp;</span><span class="ident" id="3255197">h</span><span class="op" id="3255198">.</span><span class="ident" id="3255199">Qdcount</span><span class="op" id="3255206">,</span>&nbsp;<span class="string" id="3255208">&#34;Qdcount&#34;</span><span class="op" id="3255217">,</span>&nbsp;<span class="string" id="3255219">&#34;&#34;</span><span class="op" id="3255221">)</span>&nbsp;<span class="op" id="3255223">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255228">f</span><span class="op" id="3255229">(</span><span class="op" id="3255230">&amp;</span><span class="ident" id="3255231">h</span><span class="op" id="3255232">.</span><span class="ident" id="3255233">Ancount</span><span class="op" id="3255240">,</span>&nbsp;<span class="string" id="3255242">&#34;Ancount&#34;</span><span class="op" id="3255251">,</span>&nbsp;<span class="string" id="3255253">&#34;&#34;</span><span class="op" id="3255255">)</span>&nbsp;<span class="op" id="3255257">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255262">f</span><span class="op" id="3255263">(</span><span class="op" id="3255264">&amp;</span><span class="ident" id="3255265">h</span><span class="op" id="3255266">.</span><span class="ident" id="3255267">Nscount</span><span class="op" id="3255274">,</span>&nbsp;<span class="string" id="3255276">&#34;Nscount&#34;</span><span class="op" id="3255285">,</span>&nbsp;<span class="string" id="3255287">&#34;&#34;</span><span class="op" id="3255289">)</span>&nbsp;<span class="op" id="3255291">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255296">f</span><span class="op" id="3255297">(</span><span class="op" id="3255298">&amp;</span><span class="ident" id="3255299">h</span><span class="op" id="3255300">.</span><span class="ident" id="3255301">Arcount</span><span class="op" id="3255308">,</span>&nbsp;<span class="string" id="3255310">&#34;Arcount&#34;</span><span class="op" id="3255319">,</span>&nbsp;<span class="string" id="3255321">&#34;&#34;</span><span class="op" id="3255323">)</span><br>
<span class="lineno"></span><span class="op" id="3255325">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3255328">const</span>&nbsp;<span class="op" id="3255334">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255337">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255356">_QR</span>&nbsp;<span class="op" id="3255360">=</span>&nbsp;<span class="num" id="3255362">1</span>&nbsp;<span class="op" id="3255364">&lt;&lt;</span>&nbsp;<span class="num" id="3255367">15</span>&nbsp;<span class="comment" id="3255370">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255402">_AA</span>&nbsp;<span class="op" id="3255406">=</span>&nbsp;<span class="num" id="3255408">1</span>&nbsp;<span class="op" id="3255410">&lt;&lt;</span>&nbsp;<span class="num" id="3255413">10</span>&nbsp;<span class="comment" id="3255416">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255434">_TC</span>&nbsp;<span class="op" id="3255438">=</span>&nbsp;<span class="num" id="3255440">1</span>&nbsp;<span class="op" id="3255442">&lt;&lt;</span>&nbsp;<span class="num" id="3255445">9</span>&nbsp;&nbsp;<span class="comment" id="3255448">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255462">_RD</span>&nbsp;<span class="op" id="3255466">=</span>&nbsp;<span class="num" id="3255468">1</span>&nbsp;<span class="op" id="3255470">&lt;&lt;</span>&nbsp;<span class="num" id="3255473">8</span>&nbsp;&nbsp;<span class="comment" id="3255476">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255498">_RA</span>&nbsp;<span class="op" id="3255502">=</span>&nbsp;<span class="num" id="3255504">1</span>&nbsp;<span class="op" id="3255506">&lt;&lt;</span>&nbsp;<span class="num" id="3255509">7</span>&nbsp;&nbsp;<span class="comment" id="3255512">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3255535">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3255538">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3255554">type</span>&nbsp;<span class="ident" id="3255559">dnsQuestion</span>&nbsp;<span class="keyword" id="3255571">struct</span>&nbsp;<span class="op" id="3255578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255581">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3255588">string</span>&nbsp;<span class="string" id="3255595">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3255615">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255677">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3255684">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255692">Qclass</span>&nbsp;<span class="builtintype" id="3255699">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3255706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3255709">func</span>&nbsp;<span class="op" id="3255714">(</span><span class="ident" id="3255715">q</span>&nbsp;<span class="op" id="3255717">*</span><span class="ident" id="3255718">dnsQuestion</span><span class="op" id="3255729">)</span>&nbsp;<span class="ident" id="3255731">Walk</span><span class="op" id="3255735">(</span><span class="ident" id="3255736">f</span>&nbsp;<span class="keyword" id="3255738">func</span><span class="op" id="3255742">(</span><span class="ident" id="3255743">v</span>&nbsp;<span class="keyword" id="3255745">interface</span><span class="op" id="3255754">{</span><span class="op" id="3255755">}</span><span class="op" id="3255756">,</span>&nbsp;<span class="ident" id="3255758">name</span><span class="op" id="3255762">,</span>&nbsp;<span class="ident" id="3255764">tag</span>&nbsp;<span class="builtintype" id="3255768">string</span><span class="op" id="3255774">)</span>&nbsp;<span class="builtintype" id="3255776">bool</span><span class="op" id="3255780">)</span>&nbsp;<span class="builtintype" id="3255782">bool</span>&nbsp;<span class="op" id="3255787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3255790">return</span>&nbsp;<span class="ident" id="3255797">f</span><span class="op" id="3255798">(</span><span class="op" id="3255799">&amp;</span><span class="ident" id="3255800">q</span><span class="op" id="3255801">.</span><span class="ident" id="3255802">Name</span><span class="op" id="3255806">,</span>&nbsp;<span class="string" id="3255808">&#34;Name&#34;</span><span class="op" id="3255814">,</span>&nbsp;<span class="string" id="3255816">&#34;domain&#34;</span><span class="op" id="3255824">)</span>&nbsp;<span class="op" id="3255826">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255831">f</span><span class="op" id="3255832">(</span><span class="op" id="3255833">&amp;</span><span class="ident" id="3255834">q</span><span class="op" id="3255835">.</span><span class="ident" id="3255836">Qtype</span><span class="op" id="3255841">,</span>&nbsp;<span class="string" id="3255843">&#34;Qtype&#34;</span><span class="op" id="3255850">,</span>&nbsp;<span class="string" id="3255852">&#34;&#34;</span><span class="op" id="3255854">)</span>&nbsp;<span class="op" id="3255856">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255861">f</span><span class="op" id="3255862">(</span><span class="op" id="3255863">&amp;</span><span class="ident" id="3255864">q</span><span class="op" id="3255865">.</span><span class="ident" id="3255866">Qclass</span><span class="op" id="3255872">,</span>&nbsp;<span class="string" id="3255874">&#34;Qclass&#34;</span><span class="op" id="3255882">,</span>&nbsp;<span class="string" id="3255884">&#34;&#34;</span><span class="op" id="3255886">)</span><br>
<span class="lineno"></span><span class="op" id="3255888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3255891">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3255928">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3255965">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3256004">type</span>&nbsp;<span class="ident" id="3256009">dnsRR_Header</span>&nbsp;<span class="keyword" id="3256022">struct</span>&nbsp;<span class="op" id="3256029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256032">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3256041">string</span>&nbsp;<span class="string" id="3256048">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256069">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3256078">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256086">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3256095">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256103">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3256112">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256120">Rdlength</span>&nbsp;<span class="builtintype" id="3256129">uint16</span>&nbsp;<span class="comment" id="3256136">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3256167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3256170">func</span>&nbsp;<span class="op" id="3256175">(</span><span class="ident" id="3256176">h</span>&nbsp;<span class="op" id="3256178">*</span><span class="ident" id="3256179">dnsRR_Header</span><span class="op" id="3256191">)</span>&nbsp;<span class="ident" id="3256193">Header</span><span class="op" id="3256199">(</span><span class="op" id="3256200">)</span>&nbsp;<span class="op" id="3256202">*</span><span class="ident" id="3256203">dnsRR_Header</span>&nbsp;<span class="op" id="3256216">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3256219">return</span>&nbsp;<span class="ident" id="3256226">h</span><br>
<span class="lineno"></span><span class="op" id="3256228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3256231">func</span>&nbsp;<span class="op" id="3256236">(</span><span class="ident" id="3256237">h</span>&nbsp;<span class="op" id="3256239">*</span><span class="ident" id="3256240">dnsRR_Header</span><span class="op" id="3256252">)</span>&nbsp;<span class="ident" id="3256254">Walk</span><span class="op" id="3256258">(</span><span class="ident" id="3256259">f</span>&nbsp;<span class="keyword" id="3256261">func</span><span class="op" id="3256265">(</span><span class="ident" id="3256266">v</span>&nbsp;<span class="keyword" id="3256268">interface</span><span class="op" id="3256277">{</span><span class="op" id="3256278">}</span><span class="op" id="3256279">,</span>&nbsp;<span class="ident" id="3256281">name</span><span class="op" id="3256285">,</span>&nbsp;<span class="ident" id="3256287">tag</span>&nbsp;<span class="builtintype" id="3256291">string</span><span class="op" id="3256297">)</span>&nbsp;<span class="builtintype" id="3256299">bool</span><span class="op" id="3256303">)</span>&nbsp;<span class="builtintype" id="3256305">bool</span>&nbsp;<span class="op" id="3256310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3256313">return</span>&nbsp;<span class="ident" id="3256320">f</span><span class="op" id="3256321">(</span><span class="op" id="3256322">&amp;</span><span class="ident" id="3256323">h</span><span class="op" id="3256324">.</span><span class="ident" id="3256325">Name</span><span class="op" id="3256329">,</span>&nbsp;<span class="string" id="3256331">&#34;Name&#34;</span><span class="op" id="3256337">,</span>&nbsp;<span class="string" id="3256339">&#34;domain&#34;</span><span class="op" id="3256347">)</span>&nbsp;<span class="op" id="3256349">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256354">f</span><span class="op" id="3256355">(</span><span class="op" id="3256356">&amp;</span><span class="ident" id="3256357">h</span><span class="op" id="3256358">.</span><span class="ident" id="3256359">Rrtype</span><span class="op" id="3256365">,</span>&nbsp;<span class="string" id="3256367">&#34;Rrtype&#34;</span><span class="op" id="3256375">,</span>&nbsp;<span class="string" id="3256377">&#34;&#34;</span><span class="op" id="3256379">)</span>&nbsp;<span class="op" id="3256381">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256386">f</span><span class="op" id="3256387">(</span><span class="op" id="3256388">&amp;</span><span class="ident" id="3256389">h</span><span class="op" id="3256390">.</span><span class="ident" id="3256391">Class</span><span class="op" id="3256396">,</span>&nbsp;<span class="string" id="3256398">&#34;Class&#34;</span><span class="op" id="3256405">,</span>&nbsp;<span class="string" id="3256407">&#34;&#34;</span><span class="op" id="3256409">)</span>&nbsp;<span class="op" id="3256411">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256416">f</span><span class="op" id="3256417">(</span><span class="op" id="3256418">&amp;</span><span class="ident" id="3256419">h</span><span class="op" id="3256420">.</span><span class="ident" id="3256421">Ttl</span><span class="op" id="3256424">,</span>&nbsp;<span class="string" id="3256426">&#34;Ttl&#34;</span><span class="op" id="3256431">,</span>&nbsp;<span class="string" id="3256433">&#34;&#34;</span><span class="op" id="3256435">)</span>&nbsp;<span class="op" id="3256437">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256442">f</span><span class="op" id="3256443">(</span><span class="op" id="3256444">&amp;</span><span class="ident" id="3256445">h</span><span class="op" id="3256446">.</span><span class="ident" id="3256447">Rdlength</span><span class="op" id="3256455">,</span>&nbsp;<span class="string" id="3256457">&#34;Rdlength&#34;</span><span class="op" id="3256467">,</span>&nbsp;<span class="string" id="3256469">&#34;&#34;</span><span class="op" id="3256471">)</span><br>
<span class="lineno"></span><span class="op" id="3256473">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3256476">type</span>&nbsp;<span class="ident" id="3256481">dnsRR</span>&nbsp;<span class="keyword" id="3256487">interface</span>&nbsp;<span class="op" id="3256497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256500">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256511">Header</span><span class="op" id="3256517">(</span><span class="op" id="3256518">)</span>&nbsp;<span class="op" id="3256520">*</span><span class="ident" id="3256521">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3256534">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3256537">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3256586">type</span>&nbsp;<span class="ident" id="3256591">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3256603">struct</span>&nbsp;<span class="op" id="3256610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256613">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3256619">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256633">Cname</span>&nbsp;<span class="builtintype" id="3256639">string</span>&nbsp;<span class="string" id="3256646">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3256666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3256669">func</span>&nbsp;<span class="op" id="3256674">(</span><span class="ident" id="3256675">rr</span>&nbsp;<span class="op" id="3256678">*</span><span class="ident" id="3256679">dnsRR_CNAME</span><span class="op" id="3256690">)</span>&nbsp;<span class="ident" id="3256692">Header</span><span class="op" id="3256698">(</span><span class="op" id="3256699">)</span>&nbsp;<span class="op" id="3256701">*</span><span class="ident" id="3256702">dnsRR_Header</span>&nbsp;<span class="op" id="3256715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3256718">return</span>&nbsp;<span class="op" id="3256725">&amp;</span><span class="ident" id="3256726">rr</span><span class="op" id="3256728">.</span><span class="ident" id="3256729">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3256733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3256736">func</span>&nbsp;<span class="op" id="3256741">(</span><span class="ident" id="3256742">rr</span>&nbsp;<span class="op" id="3256745">*</span><span class="ident" id="3256746">dnsRR_CNAME</span><span class="op" id="3256757">)</span>&nbsp;<span class="ident" id="3256759">Walk</span><span class="op" id="3256763">(</span><span class="ident" id="3256764">f</span>&nbsp;<span class="keyword" id="3256766">func</span><span class="op" id="3256770">(</span><span class="ident" id="3256771">v</span>&nbsp;<span class="keyword" id="3256773">interface</span><span class="op" id="3256782">{</span><span class="op" id="3256783">}</span><span class="op" id="3256784">,</span>&nbsp;<span class="ident" id="3256786">name</span><span class="op" id="3256790">,</span>&nbsp;<span class="ident" id="3256792">tag</span>&nbsp;<span class="builtintype" id="3256796">string</span><span class="op" id="3256802">)</span>&nbsp;<span class="builtintype" id="3256804">bool</span><span class="op" id="3256808">)</span>&nbsp;<span class="builtintype" id="3256810">bool</span>&nbsp;<span class="op" id="3256815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3256818">return</span>&nbsp;<span class="ident" id="3256825">rr</span><span class="op" id="3256827">.</span><span class="ident" id="3256828">Hdr</span><span class="op" id="3256831">.</span><span class="ident" id="3256832">Walk</span><span class="op" id="3256836">(</span><span class="ident" id="3256837">f</span><span class="op" id="3256838">)</span>&nbsp;<span class="op" id="3256840">&amp;&amp;</span>&nbsp;<span class="ident" id="3256843">f</span><span class="op" id="3256844">(</span><span class="op" id="3256845">&amp;</span><span class="ident" id="3256846">rr</span><span class="op" id="3256848">.</span><span class="ident" id="3256849">Cname</span><span class="op" id="3256854">,</span>&nbsp;<span class="string" id="3256856">&#34;Cname&#34;</span><span class="op" id="3256863">,</span>&nbsp;<span class="string" id="3256865">&#34;domain&#34;</span><span class="op" id="3256873">)</span><br>
<span class="lineno"></span><span class="op" id="3256875">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3256878">type</span>&nbsp;<span class="ident" id="3256883">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3256895">struct</span>&nbsp;<span class="op" id="3256902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256905">Hdr</span>&nbsp;<span class="ident" id="3256909">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256923">Cpu</span>&nbsp;<span class="builtintype" id="3256927">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256935">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3256939">string</span><br>
<span class="lineno">170</span><span class="op" id="3256946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3256949">func</span>&nbsp;<span class="op" id="3256954">(</span><span class="ident" id="3256955">rr</span>&nbsp;<span class="op" id="3256958">*</span><span class="ident" id="3256959">dnsRR_HINFO</span><span class="op" id="3256970">)</span>&nbsp;<span class="ident" id="3256972">Header</span><span class="op" id="3256978">(</span><span class="op" id="3256979">)</span>&nbsp;<span class="op" id="3256981">*</span><span class="ident" id="3256982">dnsRR_Header</span>&nbsp;<span class="op" id="3256995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3256998">return</span>&nbsp;<span class="op" id="3257005">&amp;</span><span class="ident" id="3257006">rr</span><span class="op" id="3257008">.</span><span class="ident" id="3257009">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3257013">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3257016">func</span>&nbsp;<span class="op" id="3257021">(</span><span class="ident" id="3257022">rr</span>&nbsp;<span class="op" id="3257025">*</span><span class="ident" id="3257026">dnsRR_HINFO</span><span class="op" id="3257037">)</span>&nbsp;<span class="ident" id="3257039">Walk</span><span class="op" id="3257043">(</span><span class="ident" id="3257044">f</span>&nbsp;<span class="keyword" id="3257046">func</span><span class="op" id="3257050">(</span><span class="ident" id="3257051">v</span>&nbsp;<span class="keyword" id="3257053">interface</span><span class="op" id="3257062">{</span><span class="op" id="3257063">}</span><span class="op" id="3257064">,</span>&nbsp;<span class="ident" id="3257066">name</span><span class="op" id="3257070">,</span>&nbsp;<span class="ident" id="3257072">tag</span>&nbsp;<span class="builtintype" id="3257076">string</span><span class="op" id="3257082">)</span>&nbsp;<span class="builtintype" id="3257084">bool</span><span class="op" id="3257088">)</span>&nbsp;<span class="builtintype" id="3257090">bool</span>&nbsp;<span class="op" id="3257095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3257098">return</span>&nbsp;<span class="ident" id="3257105">rr</span><span class="op" id="3257107">.</span><span class="ident" id="3257108">Hdr</span><span class="op" id="3257111">.</span><span class="ident" id="3257112">Walk</span><span class="op" id="3257116">(</span><span class="ident" id="3257117">f</span><span class="op" id="3257118">)</span>&nbsp;<span class="op" id="3257120">&amp;&amp;</span>&nbsp;<span class="ident" id="3257123">f</span><span class="op" id="3257124">(</span><span class="op" id="3257125">&amp;</span><span class="ident" id="3257126">rr</span><span class="op" id="3257128">.</span><span class="ident" id="3257129">Cpu</span><span class="op" id="3257132">,</span>&nbsp;<span class="string" id="3257134">&#34;Cpu&#34;</span><span class="op" id="3257139">,</span>&nbsp;<span class="string" id="3257141">&#34;&#34;</span><span class="op" id="3257143">)</span>&nbsp;<span class="op" id="3257145">&amp;&amp;</span>&nbsp;<span class="ident" id="3257148">f</span><span class="op" id="3257149">(</span><span class="op" id="3257150">&amp;</span><span class="ident" id="3257151">rr</span><span class="op" id="3257153">.</span><span class="ident" id="3257154">Os</span><span class="op" id="3257156">,</span>&nbsp;<span class="string" id="3257158">&#34;Os&#34;</span><span class="op" id="3257162">,</span>&nbsp;<span class="string" id="3257164">&#34;&#34;</span><span class="op" id="3257166">)</span><br>
<span class="lineno"></span><span class="op" id="3257168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3257171">type</span>&nbsp;<span class="ident" id="3257176">dnsRR_MB</span>&nbsp;<span class="keyword" id="3257185">struct</span>&nbsp;<span class="op" id="3257192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257195">Hdr</span>&nbsp;<span class="ident" id="3257199">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257213">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3257217">string</span>&nbsp;<span class="string" id="3257224">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3257244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3257247">func</span>&nbsp;<span class="op" id="3257252">(</span><span class="ident" id="3257253">rr</span>&nbsp;<span class="op" id="3257256">*</span><span class="ident" id="3257257">dnsRR_MB</span><span class="op" id="3257265">)</span>&nbsp;<span class="ident" id="3257267">Header</span><span class="op" id="3257273">(</span><span class="op" id="3257274">)</span>&nbsp;<span class="op" id="3257276">*</span><span class="ident" id="3257277">dnsRR_Header</span>&nbsp;<span class="op" id="3257290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3257293">return</span>&nbsp;<span class="op" id="3257300">&amp;</span><span class="ident" id="3257301">rr</span><span class="op" id="3257303">.</span><span class="ident" id="3257304">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3257308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3257311">func</span>&nbsp;<span class="op" id="3257316">(</span><span class="ident" id="3257317">rr</span>&nbsp;<span class="op" id="3257320">*</span><span class="ident" id="3257321">dnsRR_MB</span><span class="op" id="3257329">)</span>&nbsp;<span class="ident" id="3257331">Walk</span><span class="op" id="3257335">(</span><span class="ident" id="3257336">f</span>&nbsp;<span class="keyword" id="3257338">func</span><span class="op" id="3257342">(</span><span class="ident" id="3257343">v</span>&nbsp;<span class="keyword" id="3257345">interface</span><span class="op" id="3257354">{</span><span class="op" id="3257355">}</span><span class="op" id="3257356">,</span>&nbsp;<span class="ident" id="3257358">name</span><span class="op" id="3257362">,</span>&nbsp;<span class="ident" id="3257364">tag</span>&nbsp;<span class="builtintype" id="3257368">string</span><span class="op" id="3257374">)</span>&nbsp;<span class="builtintype" id="3257376">bool</span><span class="op" id="3257380">)</span>&nbsp;<span class="builtintype" id="3257382">bool</span>&nbsp;<span class="op" id="3257387">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3257390">return</span>&nbsp;<span class="ident" id="3257397">rr</span><span class="op" id="3257399">.</span><span class="ident" id="3257400">Hdr</span><span class="op" id="3257403">.</span><span class="ident" id="3257404">Walk</span><span class="op" id="3257408">(</span><span class="ident" id="3257409">f</span><span class="op" id="3257410">)</span>&nbsp;<span class="op" id="3257412">&amp;&amp;</span>&nbsp;<span class="ident" id="3257415">f</span><span class="op" id="3257416">(</span><span class="op" id="3257417">&amp;</span><span class="ident" id="3257418">rr</span><span class="op" id="3257420">.</span><span class="ident" id="3257421">Mb</span><span class="op" id="3257423">,</span>&nbsp;<span class="string" id="3257425">&#34;Mb&#34;</span><span class="op" id="3257429">,</span>&nbsp;<span class="string" id="3257431">&#34;domain&#34;</span><span class="op" id="3257439">)</span><br>
<span class="lineno"></span><span class="op" id="3257441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3257444">type</span>&nbsp;<span class="ident" id="3257449">dnsRR_MG</span>&nbsp;<span class="keyword" id="3257458">struct</span>&nbsp;<span class="op" id="3257465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257468">Hdr</span>&nbsp;<span class="ident" id="3257472">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257486">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3257490">string</span>&nbsp;<span class="string" id="3257497">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3257517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3257520">func</span>&nbsp;<span class="op" id="3257525">(</span><span class="ident" id="3257526">rr</span>&nbsp;<span class="op" id="3257529">*</span><span class="ident" id="3257530">dnsRR_MG</span><span class="op" id="3257538">)</span>&nbsp;<span class="ident" id="3257540">Header</span><span class="op" id="3257546">(</span><span class="op" id="3257547">)</span>&nbsp;<span class="op" id="3257549">*</span><span class="ident" id="3257550">dnsRR_Header</span>&nbsp;<span class="op" id="3257563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3257566">return</span>&nbsp;<span class="op" id="3257573">&amp;</span><span class="ident" id="3257574">rr</span><span class="op" id="3257576">.</span><span class="ident" id="3257577">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3257581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3257584">func</span>&nbsp;<span class="op" id="3257589">(</span><span class="ident" id="3257590">rr</span>&nbsp;<span class="op" id="3257593">*</span><span class="ident" id="3257594">dnsRR_MG</span><span class="op" id="3257602">)</span>&nbsp;<span class="ident" id="3257604">Walk</span><span class="op" id="3257608">(</span><span class="ident" id="3257609">f</span>&nbsp;<span class="keyword" id="3257611">func</span><span class="op" id="3257615">(</span><span class="ident" id="3257616">v</span>&nbsp;<span class="keyword" id="3257618">interface</span><span class="op" id="3257627">{</span><span class="op" id="3257628">}</span><span class="op" id="3257629">,</span>&nbsp;<span class="ident" id="3257631">name</span><span class="op" id="3257635">,</span>&nbsp;<span class="ident" id="3257637">tag</span>&nbsp;<span class="builtintype" id="3257641">string</span><span class="op" id="3257647">)</span>&nbsp;<span class="builtintype" id="3257649">bool</span><span class="op" id="3257653">)</span>&nbsp;<span class="builtintype" id="3257655">bool</span>&nbsp;<span class="op" id="3257660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3257663">return</span>&nbsp;<span class="ident" id="3257670">rr</span><span class="op" id="3257672">.</span><span class="ident" id="3257673">Hdr</span><span class="op" id="3257676">.</span><span class="ident" id="3257677">Walk</span><span class="op" id="3257681">(</span><span class="ident" id="3257682">f</span><span class="op" id="3257683">)</span>&nbsp;<span class="op" id="3257685">&amp;&amp;</span>&nbsp;<span class="ident" id="3257688">f</span><span class="op" id="3257689">(</span><span class="op" id="3257690">&amp;</span><span class="ident" id="3257691">rr</span><span class="op" id="3257693">.</span><span class="ident" id="3257694">Mg</span><span class="op" id="3257696">,</span>&nbsp;<span class="string" id="3257698">&#34;Mg&#34;</span><span class="op" id="3257702">,</span>&nbsp;<span class="string" id="3257704">&#34;domain&#34;</span><span class="op" id="3257712">)</span><br>
<span class="lineno"></span><span class="op" id="3257714">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3257717">type</span>&nbsp;<span class="ident" id="3257722">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3257734">struct</span>&nbsp;<span class="op" id="3257741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257744">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3257750">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257764">Rmail</span>&nbsp;<span class="builtintype" id="3257770">string</span>&nbsp;<span class="string" id="3257777">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257798">Email</span>&nbsp;<span class="builtintype" id="3257804">string</span>&nbsp;<span class="string" id="3257811">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3257831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3257834">func</span>&nbsp;<span class="op" id="3257839">(</span><span class="ident" id="3257840">rr</span>&nbsp;<span class="op" id="3257843">*</span><span class="ident" id="3257844">dnsRR_MINFO</span><span class="op" id="3257855">)</span>&nbsp;<span class="ident" id="3257857">Header</span><span class="op" id="3257863">(</span><span class="op" id="3257864">)</span>&nbsp;<span class="op" id="3257866">*</span><span class="ident" id="3257867">dnsRR_Header</span>&nbsp;<span class="op" id="3257880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3257883">return</span>&nbsp;<span class="op" id="3257890">&amp;</span><span class="ident" id="3257891">rr</span><span class="op" id="3257893">.</span><span class="ident" id="3257894">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3257898">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3257901">func</span>&nbsp;<span class="op" id="3257906">(</span><span class="ident" id="3257907">rr</span>&nbsp;<span class="op" id="3257910">*</span><span class="ident" id="3257911">dnsRR_MINFO</span><span class="op" id="3257922">)</span>&nbsp;<span class="ident" id="3257924">Walk</span><span class="op" id="3257928">(</span><span class="ident" id="3257929">f</span>&nbsp;<span class="keyword" id="3257931">func</span><span class="op" id="3257935">(</span><span class="ident" id="3257936">v</span>&nbsp;<span class="keyword" id="3257938">interface</span><span class="op" id="3257947">{</span><span class="op" id="3257948">}</span><span class="op" id="3257949">,</span>&nbsp;<span class="ident" id="3257951">name</span><span class="op" id="3257955">,</span>&nbsp;<span class="ident" id="3257957">tag</span>&nbsp;<span class="builtintype" id="3257961">string</span><span class="op" id="3257967">)</span>&nbsp;<span class="builtintype" id="3257969">bool</span><span class="op" id="3257973">)</span>&nbsp;<span class="builtintype" id="3257975">bool</span>&nbsp;<span class="op" id="3257980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3257983">return</span>&nbsp;<span class="ident" id="3257990">rr</span><span class="op" id="3257992">.</span><span class="ident" id="3257993">Hdr</span><span class="op" id="3257996">.</span><span class="ident" id="3257997">Walk</span><span class="op" id="3258001">(</span><span class="ident" id="3258002">f</span><span class="op" id="3258003">)</span>&nbsp;<span class="op" id="3258005">&amp;&amp;</span>&nbsp;<span class="ident" id="3258008">f</span><span class="op" id="3258009">(</span><span class="op" id="3258010">&amp;</span><span class="ident" id="3258011">rr</span><span class="op" id="3258013">.</span><span class="ident" id="3258014">Rmail</span><span class="op" id="3258019">,</span>&nbsp;<span class="string" id="3258021">&#34;Rmail&#34;</span><span class="op" id="3258028">,</span>&nbsp;<span class="string" id="3258030">&#34;domain&#34;</span><span class="op" id="3258038">)</span>&nbsp;<span class="op" id="3258040">&amp;&amp;</span>&nbsp;<span class="ident" id="3258043">f</span><span class="op" id="3258044">(</span><span class="op" id="3258045">&amp;</span><span class="ident" id="3258046">rr</span><span class="op" id="3258048">.</span><span class="ident" id="3258049">Email</span><span class="op" id="3258054">,</span>&nbsp;<span class="string" id="3258056">&#34;Email&#34;</span><span class="op" id="3258063">,</span>&nbsp;<span class="string" id="3258065">&#34;domain&#34;</span><span class="op" id="3258073">)</span><br>
<span class="lineno"></span><span class="op" id="3258075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3258078">type</span>&nbsp;<span class="ident" id="3258083">dnsRR_MR</span>&nbsp;<span class="keyword" id="3258092">struct</span>&nbsp;<span class="op" id="3258099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258102">Hdr</span>&nbsp;<span class="ident" id="3258106">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258120">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3258124">string</span>&nbsp;<span class="string" id="3258131">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3258151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3258154">func</span>&nbsp;<span class="op" id="3258159">(</span><span class="ident" id="3258160">rr</span>&nbsp;<span class="op" id="3258163">*</span><span class="ident" id="3258164">dnsRR_MR</span><span class="op" id="3258172">)</span>&nbsp;<span class="ident" id="3258174">Header</span><span class="op" id="3258180">(</span><span class="op" id="3258181">)</span>&nbsp;<span class="op" id="3258183">*</span><span class="ident" id="3258184">dnsRR_Header</span>&nbsp;<span class="op" id="3258197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258200">return</span>&nbsp;<span class="op" id="3258207">&amp;</span><span class="ident" id="3258208">rr</span><span class="op" id="3258210">.</span><span class="ident" id="3258211">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3258215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258218">func</span>&nbsp;<span class="op" id="3258223">(</span><span class="ident" id="3258224">rr</span>&nbsp;<span class="op" id="3258227">*</span><span class="ident" id="3258228">dnsRR_MR</span><span class="op" id="3258236">)</span>&nbsp;<span class="ident" id="3258238">Walk</span><span class="op" id="3258242">(</span><span class="ident" id="3258243">f</span>&nbsp;<span class="keyword" id="3258245">func</span><span class="op" id="3258249">(</span><span class="ident" id="3258250">v</span>&nbsp;<span class="keyword" id="3258252">interface</span><span class="op" id="3258261">{</span><span class="op" id="3258262">}</span><span class="op" id="3258263">,</span>&nbsp;<span class="ident" id="3258265">name</span><span class="op" id="3258269">,</span>&nbsp;<span class="ident" id="3258271">tag</span>&nbsp;<span class="builtintype" id="3258275">string</span><span class="op" id="3258281">)</span>&nbsp;<span class="builtintype" id="3258283">bool</span><span class="op" id="3258287">)</span>&nbsp;<span class="builtintype" id="3258289">bool</span>&nbsp;<span class="op" id="3258294">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258297">return</span>&nbsp;<span class="ident" id="3258304">rr</span><span class="op" id="3258306">.</span><span class="ident" id="3258307">Hdr</span><span class="op" id="3258310">.</span><span class="ident" id="3258311">Walk</span><span class="op" id="3258315">(</span><span class="ident" id="3258316">f</span><span class="op" id="3258317">)</span>&nbsp;<span class="op" id="3258319">&amp;&amp;</span>&nbsp;<span class="ident" id="3258322">f</span><span class="op" id="3258323">(</span><span class="op" id="3258324">&amp;</span><span class="ident" id="3258325">rr</span><span class="op" id="3258327">.</span><span class="ident" id="3258328">Mr</span><span class="op" id="3258330">,</span>&nbsp;<span class="string" id="3258332">&#34;Mr&#34;</span><span class="op" id="3258336">,</span>&nbsp;<span class="string" id="3258338">&#34;domain&#34;</span><span class="op" id="3258346">)</span><br>
<span class="lineno"></span><span class="op" id="3258348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258351">type</span>&nbsp;<span class="ident" id="3258356">dnsRR_MX</span>&nbsp;<span class="keyword" id="3258365">struct</span>&nbsp;<span class="op" id="3258372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258375">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3258380">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258394">Pref</span>&nbsp;<span class="builtintype" id="3258399">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258407">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3258412">string</span>&nbsp;<span class="string" id="3258419">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3258439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258442">func</span>&nbsp;<span class="op" id="3258447">(</span><span class="ident" id="3258448">rr</span>&nbsp;<span class="op" id="3258451">*</span><span class="ident" id="3258452">dnsRR_MX</span><span class="op" id="3258460">)</span>&nbsp;<span class="ident" id="3258462">Header</span><span class="op" id="3258468">(</span><span class="op" id="3258469">)</span>&nbsp;<span class="op" id="3258471">*</span><span class="ident" id="3258472">dnsRR_Header</span>&nbsp;<span class="op" id="3258485">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258488">return</span>&nbsp;<span class="op" id="3258495">&amp;</span><span class="ident" id="3258496">rr</span><span class="op" id="3258498">.</span><span class="ident" id="3258499">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3258503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258506">func</span>&nbsp;<span class="op" id="3258511">(</span><span class="ident" id="3258512">rr</span>&nbsp;<span class="op" id="3258515">*</span><span class="ident" id="3258516">dnsRR_MX</span><span class="op" id="3258524">)</span>&nbsp;<span class="ident" id="3258526">Walk</span><span class="op" id="3258530">(</span><span class="ident" id="3258531">f</span>&nbsp;<span class="keyword" id="3258533">func</span><span class="op" id="3258537">(</span><span class="ident" id="3258538">v</span>&nbsp;<span class="keyword" id="3258540">interface</span><span class="op" id="3258549">{</span><span class="op" id="3258550">}</span><span class="op" id="3258551">,</span>&nbsp;<span class="ident" id="3258553">name</span><span class="op" id="3258557">,</span>&nbsp;<span class="ident" id="3258559">tag</span>&nbsp;<span class="builtintype" id="3258563">string</span><span class="op" id="3258569">)</span>&nbsp;<span class="builtintype" id="3258571">bool</span><span class="op" id="3258575">)</span>&nbsp;<span class="builtintype" id="3258577">bool</span>&nbsp;<span class="op" id="3258582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258585">return</span>&nbsp;<span class="ident" id="3258592">rr</span><span class="op" id="3258594">.</span><span class="ident" id="3258595">Hdr</span><span class="op" id="3258598">.</span><span class="ident" id="3258599">Walk</span><span class="op" id="3258603">(</span><span class="ident" id="3258604">f</span><span class="op" id="3258605">)</span>&nbsp;<span class="op" id="3258607">&amp;&amp;</span>&nbsp;<span class="ident" id="3258610">f</span><span class="op" id="3258611">(</span><span class="op" id="3258612">&amp;</span><span class="ident" id="3258613">rr</span><span class="op" id="3258615">.</span><span class="ident" id="3258616">Pref</span><span class="op" id="3258620">,</span>&nbsp;<span class="string" id="3258622">&#34;Pref&#34;</span><span class="op" id="3258628">,</span>&nbsp;<span class="string" id="3258630">&#34;&#34;</span><span class="op" id="3258632">)</span>&nbsp;<span class="op" id="3258634">&amp;&amp;</span>&nbsp;<span class="ident" id="3258637">f</span><span class="op" id="3258638">(</span><span class="op" id="3258639">&amp;</span><span class="ident" id="3258640">rr</span><span class="op" id="3258642">.</span><span class="ident" id="3258643">Mx</span><span class="op" id="3258645">,</span>&nbsp;<span class="string" id="3258647">&#34;Mx&#34;</span><span class="op" id="3258651">,</span>&nbsp;<span class="string" id="3258653">&#34;domain&#34;</span><span class="op" id="3258661">)</span><br>
<span class="lineno">245</span><span class="op" id="3258663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258666">type</span>&nbsp;<span class="ident" id="3258671">dnsRR_NS</span>&nbsp;<span class="keyword" id="3258680">struct</span>&nbsp;<span class="op" id="3258687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258690">Hdr</span>&nbsp;<span class="ident" id="3258694">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258708">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3258712">string</span>&nbsp;<span class="string" id="3258719">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3258739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258742">func</span>&nbsp;<span class="op" id="3258747">(</span><span class="ident" id="3258748">rr</span>&nbsp;<span class="op" id="3258751">*</span><span class="ident" id="3258752">dnsRR_NS</span><span class="op" id="3258760">)</span>&nbsp;<span class="ident" id="3258762">Header</span><span class="op" id="3258768">(</span><span class="op" id="3258769">)</span>&nbsp;<span class="op" id="3258771">*</span><span class="ident" id="3258772">dnsRR_Header</span>&nbsp;<span class="op" id="3258785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258788">return</span>&nbsp;<span class="op" id="3258795">&amp;</span><span class="ident" id="3258796">rr</span><span class="op" id="3258798">.</span><span class="ident" id="3258799">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3258803">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3258806">func</span>&nbsp;<span class="op" id="3258811">(</span><span class="ident" id="3258812">rr</span>&nbsp;<span class="op" id="3258815">*</span><span class="ident" id="3258816">dnsRR_NS</span><span class="op" id="3258824">)</span>&nbsp;<span class="ident" id="3258826">Walk</span><span class="op" id="3258830">(</span><span class="ident" id="3258831">f</span>&nbsp;<span class="keyword" id="3258833">func</span><span class="op" id="3258837">(</span><span class="ident" id="3258838">v</span>&nbsp;<span class="keyword" id="3258840">interface</span><span class="op" id="3258849">{</span><span class="op" id="3258850">}</span><span class="op" id="3258851">,</span>&nbsp;<span class="ident" id="3258853">name</span><span class="op" id="3258857">,</span>&nbsp;<span class="ident" id="3258859">tag</span>&nbsp;<span class="builtintype" id="3258863">string</span><span class="op" id="3258869">)</span>&nbsp;<span class="builtintype" id="3258871">bool</span><span class="op" id="3258875">)</span>&nbsp;<span class="builtintype" id="3258877">bool</span>&nbsp;<span class="op" id="3258882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258885">return</span>&nbsp;<span class="ident" id="3258892">rr</span><span class="op" id="3258894">.</span><span class="ident" id="3258895">Hdr</span><span class="op" id="3258898">.</span><span class="ident" id="3258899">Walk</span><span class="op" id="3258903">(</span><span class="ident" id="3258904">f</span><span class="op" id="3258905">)</span>&nbsp;<span class="op" id="3258907">&amp;&amp;</span>&nbsp;<span class="ident" id="3258910">f</span><span class="op" id="3258911">(</span><span class="op" id="3258912">&amp;</span><span class="ident" id="3258913">rr</span><span class="op" id="3258915">.</span><span class="ident" id="3258916">Ns</span><span class="op" id="3258918">,</span>&nbsp;<span class="string" id="3258920">&#34;Ns&#34;</span><span class="op" id="3258924">,</span>&nbsp;<span class="string" id="3258926">&#34;domain&#34;</span><span class="op" id="3258934">)</span><br>
<span class="lineno"></span><span class="op" id="3258936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3258939">type</span>&nbsp;<span class="ident" id="3258944">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3258954">struct</span>&nbsp;<span class="op" id="3258961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258964">Hdr</span>&nbsp;<span class="ident" id="3258968">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258982">Ptr</span>&nbsp;<span class="builtintype" id="3258986">string</span>&nbsp;<span class="string" id="3258993">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3259013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3259016">func</span>&nbsp;<span class="op" id="3259021">(</span><span class="ident" id="3259022">rr</span>&nbsp;<span class="op" id="3259025">*</span><span class="ident" id="3259026">dnsRR_PTR</span><span class="op" id="3259035">)</span>&nbsp;<span class="ident" id="3259037">Header</span><span class="op" id="3259043">(</span><span class="op" id="3259044">)</span>&nbsp;<span class="op" id="3259046">*</span><span class="ident" id="3259047">dnsRR_Header</span>&nbsp;<span class="op" id="3259060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259063">return</span>&nbsp;<span class="op" id="3259070">&amp;</span><span class="ident" id="3259071">rr</span><span class="op" id="3259073">.</span><span class="ident" id="3259074">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3259078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259081">func</span>&nbsp;<span class="op" id="3259086">(</span><span class="ident" id="3259087">rr</span>&nbsp;<span class="op" id="3259090">*</span><span class="ident" id="3259091">dnsRR_PTR</span><span class="op" id="3259100">)</span>&nbsp;<span class="ident" id="3259102">Walk</span><span class="op" id="3259106">(</span><span class="ident" id="3259107">f</span>&nbsp;<span class="keyword" id="3259109">func</span><span class="op" id="3259113">(</span><span class="ident" id="3259114">v</span>&nbsp;<span class="keyword" id="3259116">interface</span><span class="op" id="3259125">{</span><span class="op" id="3259126">}</span><span class="op" id="3259127">,</span>&nbsp;<span class="ident" id="3259129">name</span><span class="op" id="3259133">,</span>&nbsp;<span class="ident" id="3259135">tag</span>&nbsp;<span class="builtintype" id="3259139">string</span><span class="op" id="3259145">)</span>&nbsp;<span class="builtintype" id="3259147">bool</span><span class="op" id="3259151">)</span>&nbsp;<span class="builtintype" id="3259153">bool</span>&nbsp;<span class="op" id="3259158">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259161">return</span>&nbsp;<span class="ident" id="3259168">rr</span><span class="op" id="3259170">.</span><span class="ident" id="3259171">Hdr</span><span class="op" id="3259174">.</span><span class="ident" id="3259175">Walk</span><span class="op" id="3259179">(</span><span class="ident" id="3259180">f</span><span class="op" id="3259181">)</span>&nbsp;<span class="op" id="3259183">&amp;&amp;</span>&nbsp;<span class="ident" id="3259186">f</span><span class="op" id="3259187">(</span><span class="op" id="3259188">&amp;</span><span class="ident" id="3259189">rr</span><span class="op" id="3259191">.</span><span class="ident" id="3259192">Ptr</span><span class="op" id="3259195">,</span>&nbsp;<span class="string" id="3259197">&#34;Ptr&#34;</span><span class="op" id="3259202">,</span>&nbsp;<span class="string" id="3259204">&#34;domain&#34;</span><span class="op" id="3259212">)</span><br>
<span class="lineno"></span><span class="op" id="3259214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259217">type</span>&nbsp;<span class="ident" id="3259222">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3259232">struct</span>&nbsp;<span class="op" id="3259239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259242">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3259250">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259264">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3259272">string</span>&nbsp;<span class="string" id="3259279">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259300">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3259308">string</span>&nbsp;<span class="string" id="3259315">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259336">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3259344">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259352">Refresh</span>&nbsp;<span class="builtintype" id="3259360">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259368">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3259376">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259384">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3259392">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259400">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3259408">uint32</span><br>
<span class="lineno"></span><span class="op" id="3259415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259418">func</span>&nbsp;<span class="op" id="3259423">(</span><span class="ident" id="3259424">rr</span>&nbsp;<span class="op" id="3259427">*</span><span class="ident" id="3259428">dnsRR_SOA</span><span class="op" id="3259437">)</span>&nbsp;<span class="ident" id="3259439">Header</span><span class="op" id="3259445">(</span><span class="op" id="3259446">)</span>&nbsp;<span class="op" id="3259448">*</span><span class="ident" id="3259449">dnsRR_Header</span>&nbsp;<span class="op" id="3259462">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259465">return</span>&nbsp;<span class="op" id="3259472">&amp;</span><span class="ident" id="3259473">rr</span><span class="op" id="3259475">.</span><span class="ident" id="3259476">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3259480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259483">func</span>&nbsp;<span class="op" id="3259488">(</span><span class="ident" id="3259489">rr</span>&nbsp;<span class="op" id="3259492">*</span><span class="ident" id="3259493">dnsRR_SOA</span><span class="op" id="3259502">)</span>&nbsp;<span class="ident" id="3259504">Walk</span><span class="op" id="3259508">(</span><span class="ident" id="3259509">f</span>&nbsp;<span class="keyword" id="3259511">func</span><span class="op" id="3259515">(</span><span class="ident" id="3259516">v</span>&nbsp;<span class="keyword" id="3259518">interface</span><span class="op" id="3259527">{</span><span class="op" id="3259528">}</span><span class="op" id="3259529">,</span>&nbsp;<span class="ident" id="3259531">name</span><span class="op" id="3259535">,</span>&nbsp;<span class="ident" id="3259537">tag</span>&nbsp;<span class="builtintype" id="3259541">string</span><span class="op" id="3259547">)</span>&nbsp;<span class="builtintype" id="3259549">bool</span><span class="op" id="3259553">)</span>&nbsp;<span class="builtintype" id="3259555">bool</span>&nbsp;<span class="op" id="3259560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259563">return</span>&nbsp;<span class="ident" id="3259570">rr</span><span class="op" id="3259572">.</span><span class="ident" id="3259573">Hdr</span><span class="op" id="3259576">.</span><span class="ident" id="3259577">Walk</span><span class="op" id="3259581">(</span><span class="ident" id="3259582">f</span><span class="op" id="3259583">)</span>&nbsp;<span class="op" id="3259585">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259590">f</span><span class="op" id="3259591">(</span><span class="op" id="3259592">&amp;</span><span class="ident" id="3259593">rr</span><span class="op" id="3259595">.</span><span class="ident" id="3259596">Ns</span><span class="op" id="3259598">,</span>&nbsp;<span class="string" id="3259600">&#34;Ns&#34;</span><span class="op" id="3259604">,</span>&nbsp;<span class="string" id="3259606">&#34;domain&#34;</span><span class="op" id="3259614">)</span>&nbsp;<span class="op" id="3259616">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259621">f</span><span class="op" id="3259622">(</span><span class="op" id="3259623">&amp;</span><span class="ident" id="3259624">rr</span><span class="op" id="3259626">.</span><span class="ident" id="3259627">Mbox</span><span class="op" id="3259631">,</span>&nbsp;<span class="string" id="3259633">&#34;Mbox&#34;</span><span class="op" id="3259639">,</span>&nbsp;<span class="string" id="3259641">&#34;domain&#34;</span><span class="op" id="3259649">)</span>&nbsp;<span class="op" id="3259651">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259656">f</span><span class="op" id="3259657">(</span><span class="op" id="3259658">&amp;</span><span class="ident" id="3259659">rr</span><span class="op" id="3259661">.</span><span class="ident" id="3259662">Serial</span><span class="op" id="3259668">,</span>&nbsp;<span class="string" id="3259670">&#34;Serial&#34;</span><span class="op" id="3259678">,</span>&nbsp;<span class="string" id="3259680">&#34;&#34;</span><span class="op" id="3259682">)</span>&nbsp;<span class="op" id="3259684">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259689">f</span><span class="op" id="3259690">(</span><span class="op" id="3259691">&amp;</span><span class="ident" id="3259692">rr</span><span class="op" id="3259694">.</span><span class="ident" id="3259695">Refresh</span><span class="op" id="3259702">,</span>&nbsp;<span class="string" id="3259704">&#34;Refresh&#34;</span><span class="op" id="3259713">,</span>&nbsp;<span class="string" id="3259715">&#34;&#34;</span><span class="op" id="3259717">)</span>&nbsp;<span class="op" id="3259719">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259724">f</span><span class="op" id="3259725">(</span><span class="op" id="3259726">&amp;</span><span class="ident" id="3259727">rr</span><span class="op" id="3259729">.</span><span class="ident" id="3259730">Retry</span><span class="op" id="3259735">,</span>&nbsp;<span class="string" id="3259737">&#34;Retry&#34;</span><span class="op" id="3259744">,</span>&nbsp;<span class="string" id="3259746">&#34;&#34;</span><span class="op" id="3259748">)</span>&nbsp;<span class="op" id="3259750">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259755">f</span><span class="op" id="3259756">(</span><span class="op" id="3259757">&amp;</span><span class="ident" id="3259758">rr</span><span class="op" id="3259760">.</span><span class="ident" id="3259761">Expire</span><span class="op" id="3259767">,</span>&nbsp;<span class="string" id="3259769">&#34;Expire&#34;</span><span class="op" id="3259777">,</span>&nbsp;<span class="string" id="3259779">&#34;&#34;</span><span class="op" id="3259781">)</span>&nbsp;<span class="op" id="3259783">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259788">f</span><span class="op" id="3259789">(</span><span class="op" id="3259790">&amp;</span><span class="ident" id="3259791">rr</span><span class="op" id="3259793">.</span><span class="ident" id="3259794">Minttl</span><span class="op" id="3259800">,</span>&nbsp;<span class="string" id="3259802">&#34;Minttl&#34;</span><span class="op" id="3259810">,</span>&nbsp;<span class="string" id="3259812">&#34;&#34;</span><span class="op" id="3259814">)</span><br>
<span class="lineno"></span><span class="op" id="3259816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259819">type</span>&nbsp;<span class="ident" id="3259824">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3259834">struct</span>&nbsp;<span class="op" id="3259841">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259844">Hdr</span>&nbsp;<span class="ident" id="3259848">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259862">Txt</span>&nbsp;<span class="builtintype" id="3259866">string</span>&nbsp;<span class="comment" id="3259873">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3259892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259895">func</span>&nbsp;<span class="op" id="3259900">(</span><span class="ident" id="3259901">rr</span>&nbsp;<span class="op" id="3259904">*</span><span class="ident" id="3259905">dnsRR_TXT</span><span class="op" id="3259914">)</span>&nbsp;<span class="ident" id="3259916">Header</span><span class="op" id="3259922">(</span><span class="op" id="3259923">)</span>&nbsp;<span class="op" id="3259925">*</span><span class="ident" id="3259926">dnsRR_Header</span>&nbsp;<span class="op" id="3259939">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259942">return</span>&nbsp;<span class="op" id="3259949">&amp;</span><span class="ident" id="3259950">rr</span><span class="op" id="3259952">.</span><span class="ident" id="3259953">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3259957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259960">func</span>&nbsp;<span class="op" id="3259965">(</span><span class="ident" id="3259966">rr</span>&nbsp;<span class="op" id="3259969">*</span><span class="ident" id="3259970">dnsRR_TXT</span><span class="op" id="3259979">)</span>&nbsp;<span class="ident" id="3259981">Walk</span><span class="op" id="3259985">(</span><span class="ident" id="3259986">f</span>&nbsp;<span class="keyword" id="3259988">func</span><span class="op" id="3259992">(</span><span class="ident" id="3259993">v</span>&nbsp;<span class="keyword" id="3259995">interface</span><span class="op" id="3260004">{</span><span class="op" id="3260005">}</span><span class="op" id="3260006">,</span>&nbsp;<span class="ident" id="3260008">name</span><span class="op" id="3260012">,</span>&nbsp;<span class="ident" id="3260014">tag</span>&nbsp;<span class="builtintype" id="3260018">string</span><span class="op" id="3260024">)</span>&nbsp;<span class="builtintype" id="3260026">bool</span><span class="op" id="3260030">)</span>&nbsp;<span class="builtintype" id="3260032">bool</span>&nbsp;<span class="op" id="3260037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260040">return</span>&nbsp;<span class="ident" id="3260047">rr</span><span class="op" id="3260049">.</span><span class="ident" id="3260050">Hdr</span><span class="op" id="3260053">.</span><span class="ident" id="3260054">Walk</span><span class="op" id="3260058">(</span><span class="ident" id="3260059">f</span><span class="op" id="3260060">)</span>&nbsp;<span class="op" id="3260062">&amp;&amp;</span>&nbsp;<span class="ident" id="3260065">f</span><span class="op" id="3260066">(</span><span class="op" id="3260067">&amp;</span><span class="ident" id="3260068">rr</span><span class="op" id="3260070">.</span><span class="ident" id="3260071">Txt</span><span class="op" id="3260074">,</span>&nbsp;<span class="string" id="3260076">&#34;Txt&#34;</span><span class="op" id="3260081">,</span>&nbsp;<span class="string" id="3260083">&#34;&#34;</span><span class="op" id="3260085">)</span><br>
<span class="lineno">310</span><span class="op" id="3260087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260090">type</span>&nbsp;<span class="ident" id="3260095">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3260105">struct</span>&nbsp;<span class="op" id="3260112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260115">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3260124">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260138">Priority</span>&nbsp;<span class="builtintype" id="3260147">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260155">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3260164">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260172">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3260181">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260189">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3260198">string</span>&nbsp;<span class="string" id="3260205">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3260225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3260228">func</span>&nbsp;<span class="op" id="3260233">(</span><span class="ident" id="3260234">rr</span>&nbsp;<span class="op" id="3260237">*</span><span class="ident" id="3260238">dnsRR_SRV</span><span class="op" id="3260247">)</span>&nbsp;<span class="ident" id="3260249">Header</span><span class="op" id="3260255">(</span><span class="op" id="3260256">)</span>&nbsp;<span class="op" id="3260258">*</span><span class="ident" id="3260259">dnsRR_Header</span>&nbsp;<span class="op" id="3260272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260275">return</span>&nbsp;<span class="op" id="3260282">&amp;</span><span class="ident" id="3260283">rr</span><span class="op" id="3260285">.</span><span class="ident" id="3260286">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3260290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260293">func</span>&nbsp;<span class="op" id="3260298">(</span><span class="ident" id="3260299">rr</span>&nbsp;<span class="op" id="3260302">*</span><span class="ident" id="3260303">dnsRR_SRV</span><span class="op" id="3260312">)</span>&nbsp;<span class="ident" id="3260314">Walk</span><span class="op" id="3260318">(</span><span class="ident" id="3260319">f</span>&nbsp;<span class="keyword" id="3260321">func</span><span class="op" id="3260325">(</span><span class="ident" id="3260326">v</span>&nbsp;<span class="keyword" id="3260328">interface</span><span class="op" id="3260337">{</span><span class="op" id="3260338">}</span><span class="op" id="3260339">,</span>&nbsp;<span class="ident" id="3260341">name</span><span class="op" id="3260345">,</span>&nbsp;<span class="ident" id="3260347">tag</span>&nbsp;<span class="builtintype" id="3260351">string</span><span class="op" id="3260357">)</span>&nbsp;<span class="builtintype" id="3260359">bool</span><span class="op" id="3260363">)</span>&nbsp;<span class="builtintype" id="3260365">bool</span>&nbsp;<span class="op" id="3260370">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260373">return</span>&nbsp;<span class="ident" id="3260380">rr</span><span class="op" id="3260382">.</span><span class="ident" id="3260383">Hdr</span><span class="op" id="3260386">.</span><span class="ident" id="3260387">Walk</span><span class="op" id="3260391">(</span><span class="ident" id="3260392">f</span><span class="op" id="3260393">)</span>&nbsp;<span class="op" id="3260395">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260400">f</span><span class="op" id="3260401">(</span><span class="op" id="3260402">&amp;</span><span class="ident" id="3260403">rr</span><span class="op" id="3260405">.</span><span class="ident" id="3260406">Priority</span><span class="op" id="3260414">,</span>&nbsp;<span class="string" id="3260416">&#34;Priority&#34;</span><span class="op" id="3260426">,</span>&nbsp;<span class="string" id="3260428">&#34;&#34;</span><span class="op" id="3260430">)</span>&nbsp;<span class="op" id="3260432">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260437">f</span><span class="op" id="3260438">(</span><span class="op" id="3260439">&amp;</span><span class="ident" id="3260440">rr</span><span class="op" id="3260442">.</span><span class="ident" id="3260443">Weight</span><span class="op" id="3260449">,</span>&nbsp;<span class="string" id="3260451">&#34;Weight&#34;</span><span class="op" id="3260459">,</span>&nbsp;<span class="string" id="3260461">&#34;&#34;</span><span class="op" id="3260463">)</span>&nbsp;<span class="op" id="3260465">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260470">f</span><span class="op" id="3260471">(</span><span class="op" id="3260472">&amp;</span><span class="ident" id="3260473">rr</span><span class="op" id="3260475">.</span><span class="ident" id="3260476">Port</span><span class="op" id="3260480">,</span>&nbsp;<span class="string" id="3260482">&#34;Port&#34;</span><span class="op" id="3260488">,</span>&nbsp;<span class="string" id="3260490">&#34;&#34;</span><span class="op" id="3260492">)</span>&nbsp;<span class="op" id="3260494">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260499">f</span><span class="op" id="3260500">(</span><span class="op" id="3260501">&amp;</span><span class="ident" id="3260502">rr</span><span class="op" id="3260504">.</span><span class="ident" id="3260505">Target</span><span class="op" id="3260511">,</span>&nbsp;<span class="string" id="3260513">&#34;Target&#34;</span><span class="op" id="3260521">,</span>&nbsp;<span class="string" id="3260523">&#34;domain&#34;</span><span class="op" id="3260531">)</span><br>
<span class="lineno">330</span><span class="op" id="3260533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260536">type</span>&nbsp;<span class="ident" id="3260541">dnsRR_A</span>&nbsp;<span class="keyword" id="3260549">struct</span>&nbsp;<span class="op" id="3260556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260559">Hdr</span>&nbsp;<span class="ident" id="3260563">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260577">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3260581">uint32</span>&nbsp;<span class="string" id="3260588">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3260601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260604">func</span>&nbsp;<span class="op" id="3260609">(</span><span class="ident" id="3260610">rr</span>&nbsp;<span class="op" id="3260613">*</span><span class="ident" id="3260614">dnsRR_A</span><span class="op" id="3260621">)</span>&nbsp;<span class="ident" id="3260623">Header</span><span class="op" id="3260629">(</span><span class="op" id="3260630">)</span>&nbsp;<span class="op" id="3260632">*</span><span class="ident" id="3260633">dnsRR_Header</span>&nbsp;<span class="op" id="3260646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260649">return</span>&nbsp;<span class="op" id="3260656">&amp;</span><span class="ident" id="3260657">rr</span><span class="op" id="3260659">.</span><span class="ident" id="3260660">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3260664">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3260667">func</span>&nbsp;<span class="op" id="3260672">(</span><span class="ident" id="3260673">rr</span>&nbsp;<span class="op" id="3260676">*</span><span class="ident" id="3260677">dnsRR_A</span><span class="op" id="3260684">)</span>&nbsp;<span class="ident" id="3260686">Walk</span><span class="op" id="3260690">(</span><span class="ident" id="3260691">f</span>&nbsp;<span class="keyword" id="3260693">func</span><span class="op" id="3260697">(</span><span class="ident" id="3260698">v</span>&nbsp;<span class="keyword" id="3260700">interface</span><span class="op" id="3260709">{</span><span class="op" id="3260710">}</span><span class="op" id="3260711">,</span>&nbsp;<span class="ident" id="3260713">name</span><span class="op" id="3260717">,</span>&nbsp;<span class="ident" id="3260719">tag</span>&nbsp;<span class="builtintype" id="3260723">string</span><span class="op" id="3260729">)</span>&nbsp;<span class="builtintype" id="3260731">bool</span><span class="op" id="3260735">)</span>&nbsp;<span class="builtintype" id="3260737">bool</span>&nbsp;<span class="op" id="3260742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260745">return</span>&nbsp;<span class="ident" id="3260752">rr</span><span class="op" id="3260754">.</span><span class="ident" id="3260755">Hdr</span><span class="op" id="3260758">.</span><span class="ident" id="3260759">Walk</span><span class="op" id="3260763">(</span><span class="ident" id="3260764">f</span><span class="op" id="3260765">)</span>&nbsp;<span class="op" id="3260767">&amp;&amp;</span>&nbsp;<span class="ident" id="3260770">f</span><span class="op" id="3260771">(</span><span class="op" id="3260772">&amp;</span><span class="ident" id="3260773">rr</span><span class="op" id="3260775">.</span><span class="ident" id="3260776">A</span><span class="op" id="3260777">,</span>&nbsp;<span class="string" id="3260779">&#34;A&#34;</span><span class="op" id="3260782">,</span>&nbsp;<span class="string" id="3260784">&#34;ipv4&#34;</span><span class="op" id="3260790">)</span><br>
<span class="lineno"></span><span class="op" id="3260792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3260795">type</span>&nbsp;<span class="ident" id="3260800">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3260811">struct</span>&nbsp;<span class="op" id="3260818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260821">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3260826">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260840">AAAA</span>&nbsp;<span class="op" id="3260845">[</span><span class="num" id="3260846">16</span><span class="op" id="3260848">]</span><span class="builtintype" id="3260849">byte</span>&nbsp;<span class="string" id="3260854">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3260867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3260870">func</span>&nbsp;<span class="op" id="3260875">(</span><span class="ident" id="3260876">rr</span>&nbsp;<span class="op" id="3260879">*</span><span class="ident" id="3260880">dnsRR_AAAA</span><span class="op" id="3260890">)</span>&nbsp;<span class="ident" id="3260892">Header</span><span class="op" id="3260898">(</span><span class="op" id="3260899">)</span>&nbsp;<span class="op" id="3260901">*</span><span class="ident" id="3260902">dnsRR_Header</span>&nbsp;<span class="op" id="3260915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260918">return</span>&nbsp;<span class="op" id="3260925">&amp;</span><span class="ident" id="3260926">rr</span><span class="op" id="3260928">.</span><span class="ident" id="3260929">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3260933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260936">func</span>&nbsp;<span class="op" id="3260941">(</span><span class="ident" id="3260942">rr</span>&nbsp;<span class="op" id="3260945">*</span><span class="ident" id="3260946">dnsRR_AAAA</span><span class="op" id="3260956">)</span>&nbsp;<span class="ident" id="3260958">Walk</span><span class="op" id="3260962">(</span><span class="ident" id="3260963">f</span>&nbsp;<span class="keyword" id="3260965">func</span><span class="op" id="3260969">(</span><span class="ident" id="3260970">v</span>&nbsp;<span class="keyword" id="3260972">interface</span><span class="op" id="3260981">{</span><span class="op" id="3260982">}</span><span class="op" id="3260983">,</span>&nbsp;<span class="ident" id="3260985">name</span><span class="op" id="3260989">,</span>&nbsp;<span class="ident" id="3260991">tag</span>&nbsp;<span class="builtintype" id="3260995">string</span><span class="op" id="3261001">)</span>&nbsp;<span class="builtintype" id="3261003">bool</span><span class="op" id="3261007">)</span>&nbsp;<span class="builtintype" id="3261009">bool</span>&nbsp;<span class="op" id="3261014">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3261017">return</span>&nbsp;<span class="ident" id="3261024">rr</span><span class="op" id="3261026">.</span><span class="ident" id="3261027">Hdr</span><span class="op" id="3261030">.</span><span class="ident" id="3261031">Walk</span><span class="op" id="3261035">(</span><span class="ident" id="3261036">f</span><span class="op" id="3261037">)</span>&nbsp;<span class="op" id="3261039">&amp;&amp;</span>&nbsp;<span class="ident" id="3261042">f</span><span class="op" id="3261043">(</span><span class="ident" id="3261044">rr</span><span class="op" id="3261046">.</span><span class="ident" id="3261047">AAAA</span><span class="op" id="3261051">[</span><span class="op" id="3261052">:</span><span class="op" id="3261053">]</span><span class="op" id="3261054">,</span>&nbsp;<span class="string" id="3261056">&#34;AAAA&#34;</span><span class="op" id="3261062">,</span>&nbsp;<span class="string" id="3261064">&#34;ipv6&#34;</span><span class="op" id="3261070">)</span><br>
<span class="lineno"></span><span class="op" id="3261072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3261075">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3261101">//</span><br>
<span class="lineno">360</span><span class="comment" id="3261104">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3261166">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3261233">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3261295">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3261361">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3261383">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3261429">var</span>&nbsp;<span class="ident" id="3261433">rr_mk</span>&nbsp;<span class="op" id="3261439">=</span>&nbsp;<span class="keyword" id="3261441">map</span><span class="op" id="3261444">[</span><span class="builtintype" id="3261445">int</span><span class="op" id="3261448">]</span><span class="keyword" id="3261449">func</span><span class="op" id="3261453">(</span><span class="op" id="3261454">)</span>&nbsp;<span class="ident" id="3261456">dnsRR</span><span class="op" id="3261461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261464">dnsTypeCNAME</span><span class="op" id="3261476">:</span>&nbsp;<span class="keyword" id="3261478">func</span><span class="op" id="3261482">(</span><span class="op" id="3261483">)</span>&nbsp;<span class="ident" id="3261485">dnsRR</span>&nbsp;<span class="op" id="3261491">{</span>&nbsp;<span class="keyword" id="3261493">return</span>&nbsp;<span class="builtinfunc" id="3261500">new</span><span class="op" id="3261503">(</span><span class="ident" id="3261504">dnsRR_CNAME</span><span class="op" id="3261515">)</span>&nbsp;<span class="op" id="3261517">}</span><span class="op" id="3261518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261521">dnsTypeHINFO</span><span class="op" id="3261533">:</span>&nbsp;<span class="keyword" id="3261535">func</span><span class="op" id="3261539">(</span><span class="op" id="3261540">)</span>&nbsp;<span class="ident" id="3261542">dnsRR</span>&nbsp;<span class="op" id="3261548">{</span>&nbsp;<span class="keyword" id="3261550">return</span>&nbsp;<span class="builtinfunc" id="3261557">new</span><span class="op" id="3261560">(</span><span class="ident" id="3261561">dnsRR_HINFO</span><span class="op" id="3261572">)</span>&nbsp;<span class="op" id="3261574">}</span><span class="op" id="3261575">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261578">dnsTypeMB</span><span class="op" id="3261587">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3261592">func</span><span class="op" id="3261596">(</span><span class="op" id="3261597">)</span>&nbsp;<span class="ident" id="3261599">dnsRR</span>&nbsp;<span class="op" id="3261605">{</span>&nbsp;<span class="keyword" id="3261607">return</span>&nbsp;<span class="builtinfunc" id="3261614">new</span><span class="op" id="3261617">(</span><span class="ident" id="3261618">dnsRR_MB</span><span class="op" id="3261626">)</span>&nbsp;<span class="op" id="3261628">}</span><span class="op" id="3261629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261632">dnsTypeMG</span><span class="op" id="3261641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3261646">func</span><span class="op" id="3261650">(</span><span class="op" id="3261651">)</span>&nbsp;<span class="ident" id="3261653">dnsRR</span>&nbsp;<span class="op" id="3261659">{</span>&nbsp;<span class="keyword" id="3261661">return</span>&nbsp;<span class="builtinfunc" id="3261668">new</span><span class="op" id="3261671">(</span><span class="ident" id="3261672">dnsRR_MG</span><span class="op" id="3261680">)</span>&nbsp;<span class="op" id="3261682">}</span><span class="op" id="3261683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261686">dnsTypeMINFO</span><span class="op" id="3261698">:</span>&nbsp;<span class="keyword" id="3261700">func</span><span class="op" id="3261704">(</span><span class="op" id="3261705">)</span>&nbsp;<span class="ident" id="3261707">dnsRR</span>&nbsp;<span class="op" id="3261713">{</span>&nbsp;<span class="keyword" id="3261715">return</span>&nbsp;<span class="builtinfunc" id="3261722">new</span><span class="op" id="3261725">(</span><span class="ident" id="3261726">dnsRR_MINFO</span><span class="op" id="3261737">)</span>&nbsp;<span class="op" id="3261739">}</span><span class="op" id="3261740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261743">dnsTypeMR</span><span class="op" id="3261752">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3261757">func</span><span class="op" id="3261761">(</span><span class="op" id="3261762">)</span>&nbsp;<span class="ident" id="3261764">dnsRR</span>&nbsp;<span class="op" id="3261770">{</span>&nbsp;<span class="keyword" id="3261772">return</span>&nbsp;<span class="builtinfunc" id="3261779">new</span><span class="op" id="3261782">(</span><span class="ident" id="3261783">dnsRR_MR</span><span class="op" id="3261791">)</span>&nbsp;<span class="op" id="3261793">}</span><span class="op" id="3261794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261797">dnsTypeMX</span><span class="op" id="3261806">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3261811">func</span><span class="op" id="3261815">(</span><span class="op" id="3261816">)</span>&nbsp;<span class="ident" id="3261818">dnsRR</span>&nbsp;<span class="op" id="3261824">{</span>&nbsp;<span class="keyword" id="3261826">return</span>&nbsp;<span class="builtinfunc" id="3261833">new</span><span class="op" id="3261836">(</span><span class="ident" id="3261837">dnsRR_MX</span><span class="op" id="3261845">)</span>&nbsp;<span class="op" id="3261847">}</span><span class="op" id="3261848">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261851">dnsTypeNS</span><span class="op" id="3261860">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3261865">func</span><span class="op" id="3261869">(</span><span class="op" id="3261870">)</span>&nbsp;<span class="ident" id="3261872">dnsRR</span>&nbsp;<span class="op" id="3261878">{</span>&nbsp;<span class="keyword" id="3261880">return</span>&nbsp;<span class="builtinfunc" id="3261887">new</span><span class="op" id="3261890">(</span><span class="ident" id="3261891">dnsRR_NS</span><span class="op" id="3261899">)</span>&nbsp;<span class="op" id="3261901">}</span><span class="op" id="3261902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261905">dnsTypePTR</span><span class="op" id="3261915">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3261919">func</span><span class="op" id="3261923">(</span><span class="op" id="3261924">)</span>&nbsp;<span class="ident" id="3261926">dnsRR</span>&nbsp;<span class="op" id="3261932">{</span>&nbsp;<span class="keyword" id="3261934">return</span>&nbsp;<span class="builtinfunc" id="3261941">new</span><span class="op" id="3261944">(</span><span class="ident" id="3261945">dnsRR_PTR</span><span class="op" id="3261954">)</span>&nbsp;<span class="op" id="3261956">}</span><span class="op" id="3261957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261960">dnsTypeSOA</span><span class="op" id="3261970">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3261974">func</span><span class="op" id="3261978">(</span><span class="op" id="3261979">)</span>&nbsp;<span class="ident" id="3261981">dnsRR</span>&nbsp;<span class="op" id="3261987">{</span>&nbsp;<span class="keyword" id="3261989">return</span>&nbsp;<span class="builtinfunc" id="3261996">new</span><span class="op" id="3261999">(</span><span class="ident" id="3262000">dnsRR_SOA</span><span class="op" id="3262009">)</span>&nbsp;<span class="op" id="3262011">}</span><span class="op" id="3262012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262015">dnsTypeTXT</span><span class="op" id="3262025">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3262029">func</span><span class="op" id="3262033">(</span><span class="op" id="3262034">)</span>&nbsp;<span class="ident" id="3262036">dnsRR</span>&nbsp;<span class="op" id="3262042">{</span>&nbsp;<span class="keyword" id="3262044">return</span>&nbsp;<span class="builtinfunc" id="3262051">new</span><span class="op" id="3262054">(</span><span class="ident" id="3262055">dnsRR_TXT</span><span class="op" id="3262064">)</span>&nbsp;<span class="op" id="3262066">}</span><span class="op" id="3262067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262070">dnsTypeSRV</span><span class="op" id="3262080">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3262084">func</span><span class="op" id="3262088">(</span><span class="op" id="3262089">)</span>&nbsp;<span class="ident" id="3262091">dnsRR</span>&nbsp;<span class="op" id="3262097">{</span>&nbsp;<span class="keyword" id="3262099">return</span>&nbsp;<span class="builtinfunc" id="3262106">new</span><span class="op" id="3262109">(</span><span class="ident" id="3262110">dnsRR_SRV</span><span class="op" id="3262119">)</span>&nbsp;<span class="op" id="3262121">}</span><span class="op" id="3262122">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262125">dnsTypeA</span><span class="op" id="3262133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3262139">func</span><span class="op" id="3262143">(</span><span class="op" id="3262144">)</span>&nbsp;<span class="ident" id="3262146">dnsRR</span>&nbsp;<span class="op" id="3262152">{</span>&nbsp;<span class="keyword" id="3262154">return</span>&nbsp;<span class="builtinfunc" id="3262161">new</span><span class="op" id="3262164">(</span><span class="ident" id="3262165">dnsRR_A</span><span class="op" id="3262172">)</span>&nbsp;<span class="op" id="3262174">}</span><span class="op" id="3262175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262178">dnsTypeAAAA</span><span class="op" id="3262189">:</span>&nbsp;&nbsp;<span class="keyword" id="3262192">func</span><span class="op" id="3262196">(</span><span class="op" id="3262197">)</span>&nbsp;<span class="ident" id="3262199">dnsRR</span>&nbsp;<span class="op" id="3262205">{</span>&nbsp;<span class="keyword" id="3262207">return</span>&nbsp;<span class="builtinfunc" id="3262214">new</span><span class="op" id="3262217">(</span><span class="ident" id="3262218">dnsRR_AAAA</span><span class="op" id="3262228">)</span>&nbsp;<span class="op" id="3262230">}</span><span class="op" id="3262231">,</span><br>
<span class="lineno"></span><span class="op" id="3262233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3262236">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3262276">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3262326">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3262385">func</span>&nbsp;<span class="ident" id="3262390">packDomainName</span><span class="op" id="3262404">(</span><span class="ident" id="3262405">s</span>&nbsp;<span class="builtintype" id="3262407">string</span><span class="op" id="3262413">,</span>&nbsp;<span class="ident" id="3262415">msg</span>&nbsp;<span class="op" id="3262419">[</span><span class="op" id="3262420">]</span><span class="builtintype" id="3262421">byte</span><span class="op" id="3262425">,</span>&nbsp;<span class="ident" id="3262427">off</span>&nbsp;<span class="builtintype" id="3262431">int</span><span class="op" id="3262434">)</span>&nbsp;<span class="op" id="3262436">(</span><span class="ident" id="3262437">off1</span>&nbsp;<span class="builtintype" id="3262442">int</span><span class="op" id="3262445">,</span>&nbsp;<span class="ident" id="3262447">ok</span>&nbsp;<span class="builtintype" id="3262450">bool</span><span class="op" id="3262454">)</span>&nbsp;<span class="op" id="3262456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3262459">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262502">if</span>&nbsp;<span class="ident" id="3262505">n</span>&nbsp;<span class="op" id="3262507">:=</span>&nbsp;<span class="builtinfunc" id="3262510">len</span><span class="op" id="3262513">(</span><span class="ident" id="3262514">s</span><span class="op" id="3262515">)</span><span class="op" id="3262516">;</span>&nbsp;<span class="ident" id="3262518">n</span>&nbsp;<span class="op" id="3262520">==</span>&nbsp;<span class="num" id="3262523">0</span>&nbsp;<span class="op" id="3262525">||</span>&nbsp;<span class="ident" id="3262528">s</span><span class="op" id="3262529">[</span><span class="ident" id="3262530">n</span><span class="op" id="3262531">-</span><span class="num" id="3262532">1</span><span class="op" id="3262533">]</span>&nbsp;<span class="op" id="3262535">!=</span>&nbsp;<span class="string" id="3262538">&#39;.&#39;</span>&nbsp;<span class="op" id="3262542">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262546">s</span>&nbsp;<span class="op" id="3262548">+=</span>&nbsp;<span class="string" id="3262551">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3262556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3262560">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3262601">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3262647">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3262682">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262728">tot</span>&nbsp;<span class="op" id="3262732">:=</span>&nbsp;<span class="builtinfunc" id="3262735">len</span><span class="op" id="3262738">(</span><span class="ident" id="3262739">s</span><span class="op" id="3262740">)</span>&nbsp;<span class="op" id="3262742">+</span>&nbsp;<span class="num" id="3262744">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262747">if</span>&nbsp;<span class="ident" id="3262750">off</span><span class="op" id="3262753">+</span><span class="ident" id="3262754">tot</span>&nbsp;<span class="op" id="3262758">&gt;</span>&nbsp;<span class="builtinfunc" id="3262760">len</span><span class="op" id="3262763">(</span><span class="ident" id="3262764">msg</span><span class="op" id="3262767">)</span>&nbsp;<span class="op" id="3262769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262773">return</span>&nbsp;<span class="builtinfunc" id="3262780">len</span><span class="op" id="3262783">(</span><span class="ident" id="3262784">msg</span><span class="op" id="3262787">)</span><span class="op" id="3262788">,</span>&nbsp;<span class="builtintype" id="3262790">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3262797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3262801">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262857">begin</span>&nbsp;<span class="op" id="3262863">:=</span>&nbsp;<span class="num" id="3262866">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262869">for</span>&nbsp;<span class="ident" id="3262873">i</span>&nbsp;<span class="op" id="3262875">:=</span>&nbsp;<span class="num" id="3262878">0</span><span class="op" id="3262879">;</span>&nbsp;<span class="ident" id="3262881">i</span>&nbsp;<span class="op" id="3262883">&lt;</span>&nbsp;<span class="builtinfunc" id="3262885">len</span><span class="op" id="3262888">(</span><span class="ident" id="3262889">s</span><span class="op" id="3262890">)</span><span class="op" id="3262891">;</span>&nbsp;<span class="ident" id="3262893">i</span><span class="op" id="3262894">++</span>&nbsp;<span class="op" id="3262897">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262901">if</span>&nbsp;<span class="ident" id="3262904">s</span><span class="op" id="3262905">[</span><span class="ident" id="3262906">i</span><span class="op" id="3262907">]</span>&nbsp;<span class="op" id="3262909">==</span>&nbsp;<span class="string" id="3262912">&#39;.&#39;</span>&nbsp;<span class="op" id="3262916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262921">if</span>&nbsp;<span class="ident" id="3262924">i</span><span class="op" id="3262925">-</span><span class="ident" id="3262926">begin</span>&nbsp;<span class="op" id="3262932">&gt;=</span>&nbsp;<span class="num" id="3262935">1</span><span class="op" id="3262936">&lt;&lt;</span><span class="num" id="3262938">6</span>&nbsp;<span class="op" id="3262940">{</span>&nbsp;<span class="comment" id="3262942">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262986">return</span>&nbsp;<span class="builtinfunc" id="3262993">len</span><span class="op" id="3262996">(</span><span class="ident" id="3262997">msg</span><span class="op" id="3263000">)</span><span class="op" id="3263001">,</span>&nbsp;<span class="builtintype" id="3263003">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3263012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263017">msg</span><span class="op" id="3263020">[</span><span class="ident" id="3263021">off</span><span class="op" id="3263024">]</span>&nbsp;<span class="op" id="3263026">=</span>&nbsp;<span class="builtintype" id="3263028">byte</span><span class="op" id="3263032">(</span><span class="ident" id="3263033">i</span>&nbsp;<span class="op" id="3263035">-</span>&nbsp;<span class="ident" id="3263037">begin</span><span class="op" id="3263042">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263047">off</span><span class="op" id="3263050">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3263056">for</span>&nbsp;<span class="ident" id="3263060">j</span>&nbsp;<span class="op" id="3263062">:=</span>&nbsp;<span class="ident" id="3263065">begin</span><span class="op" id="3263070">;</span>&nbsp;<span class="ident" id="3263072">j</span>&nbsp;<span class="op" id="3263074">&lt;</span>&nbsp;<span class="ident" id="3263076">i</span><span class="op" id="3263077">;</span>&nbsp;<span class="ident" id="3263079">j</span><span class="op" id="3263080">++</span>&nbsp;<span class="op" id="3263083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263089">msg</span><span class="op" id="3263092">[</span><span class="ident" id="3263093">off</span><span class="op" id="3263096">]</span>&nbsp;<span class="op" id="3263098">=</span>&nbsp;<span class="ident" id="3263100">s</span><span class="op" id="3263101">[</span><span class="ident" id="3263102">j</span><span class="op" id="3263103">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263109">off</span><span class="op" id="3263112">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3263118">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263123">begin</span>&nbsp;<span class="op" id="3263129">=</span>&nbsp;<span class="ident" id="3263131">i</span>&nbsp;<span class="op" id="3263133">+</span>&nbsp;<span class="num" id="3263135">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3263139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3263142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263145">msg</span><span class="op" id="3263148">[</span><span class="ident" id="3263149">off</span><span class="op" id="3263152">]</span>&nbsp;<span class="op" id="3263154">=</span>&nbsp;<span class="num" id="3263156">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263159">off</span><span class="op" id="3263162">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3263166">return</span>&nbsp;<span class="ident" id="3263173">off</span><span class="op" id="3263176">,</span>&nbsp;<span class="builtintype" id="3263178">true</span><br>
<span class="lineno"></span><span class="op" id="3263183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3263186">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3263211">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3263276">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3263341">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3263402">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3263463">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3263526">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3263595">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3263633">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3263682">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3263748">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3263794">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3263856">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3263917">func</span>&nbsp;<span class="ident" id="3263922">unpackDomainName</span><span class="op" id="3263938">(</span><span class="ident" id="3263939">msg</span>&nbsp;<span class="op" id="3263943">[</span><span class="op" id="3263944">]</span><span class="builtintype" id="3263945">byte</span><span class="op" id="3263949">,</span>&nbsp;<span class="ident" id="3263951">off</span>&nbsp;<span class="builtintype" id="3263955">int</span><span class="op" id="3263958">)</span>&nbsp;<span class="op" id="3263960">(</span><span class="ident" id="3263961">s</span>&nbsp;<span class="builtintype" id="3263963">string</span><span class="op" id="3263969">,</span>&nbsp;<span class="ident" id="3263971">off1</span>&nbsp;<span class="builtintype" id="3263976">int</span><span class="op" id="3263979">,</span>&nbsp;<span class="ident" id="3263981">ok</span>&nbsp;<span class="builtintype" id="3263984">bool</span><span class="op" id="3263988">)</span>&nbsp;<span class="op" id="3263990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263993">s</span>&nbsp;<span class="op" id="3263995">=</span>&nbsp;<span class="string" id="3263997">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264001">ptr</span>&nbsp;<span class="op" id="3264005">:=</span>&nbsp;<span class="num" id="3264008">0</span>&nbsp;<span class="comment" id="3264010">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3264041">Loop</span><span class="op" id="3264045">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264048">for</span>&nbsp;<span class="op" id="3264052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264056">if</span>&nbsp;<span class="ident" id="3264059">off</span>&nbsp;<span class="op" id="3264063">&gt;=</span>&nbsp;<span class="builtinfunc" id="3264066">len</span><span class="op" id="3264069">(</span><span class="ident" id="3264070">msg</span><span class="op" id="3264073">)</span>&nbsp;<span class="op" id="3264075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264080">return</span>&nbsp;<span class="string" id="3264087">&#34;&#34;</span><span class="op" id="3264089">,</span>&nbsp;<span class="builtinfunc" id="3264091">len</span><span class="op" id="3264094">(</span><span class="ident" id="3264095">msg</span><span class="op" id="3264098">)</span><span class="op" id="3264099">,</span>&nbsp;<span class="builtintype" id="3264101">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264113">c</span>&nbsp;<span class="op" id="3264115">:=</span>&nbsp;<span class="builtintype" id="3264118">int</span><span class="op" id="3264121">(</span><span class="ident" id="3264122">msg</span><span class="op" id="3264125">[</span><span class="ident" id="3264126">off</span><span class="op" id="3264129">]</span><span class="op" id="3264130">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264134">off</span><span class="op" id="3264137">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264142">switch</span>&nbsp;<span class="ident" id="3264149">c</span>&nbsp;<span class="op" id="3264151">&amp;</span>&nbsp;<span class="num" id="3264153">0xC0</span>&nbsp;<span class="op" id="3264158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264162">case</span>&nbsp;<span class="num" id="3264167">0x00</span><span class="op" id="3264171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264176">if</span>&nbsp;<span class="ident" id="3264179">c</span>&nbsp;<span class="op" id="3264181">==</span>&nbsp;<span class="num" id="3264184">0x00</span>&nbsp;<span class="op" id="3264189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264195">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264214">break</span>&nbsp;<span class="ident" id="3264220">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264233">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264254">if</span>&nbsp;<span class="ident" id="3264257">off</span><span class="op" id="3264260">+</span><span class="ident" id="3264261">c</span>&nbsp;<span class="op" id="3264263">&gt;</span>&nbsp;<span class="builtinfunc" id="3264265">len</span><span class="op" id="3264268">(</span><span class="ident" id="3264269">msg</span><span class="op" id="3264272">)</span>&nbsp;<span class="op" id="3264274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264280">return</span>&nbsp;<span class="string" id="3264287">&#34;&#34;</span><span class="op" id="3264289">,</span>&nbsp;<span class="builtinfunc" id="3264291">len</span><span class="op" id="3264294">(</span><span class="ident" id="3264295">msg</span><span class="op" id="3264298">)</span><span class="op" id="3264299">,</span>&nbsp;<span class="builtintype" id="3264301">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264315">s</span>&nbsp;<span class="op" id="3264317">+=</span>&nbsp;<span class="builtintype" id="3264320">string</span><span class="op" id="3264326">(</span><span class="ident" id="3264327">msg</span><span class="op" id="3264330">[</span><span class="ident" id="3264331">off</span><span class="op" id="3264334">:</span><span class="ident" id="3264335">off</span><span class="op" id="3264338">+</span><span class="ident" id="3264339">c</span><span class="op" id="3264340">]</span><span class="op" id="3264341">)</span>&nbsp;<span class="op" id="3264343">+</span>&nbsp;<span class="string" id="3264345">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264352">off</span>&nbsp;<span class="op" id="3264356">+=</span>&nbsp;<span class="ident" id="3264359">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264363">case</span>&nbsp;<span class="num" id="3264368">0xC0</span><span class="op" id="3264372">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264377">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264417">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264458">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264505">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264551">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264579">if</span>&nbsp;<span class="ident" id="3264582">off</span>&nbsp;<span class="op" id="3264586">&gt;=</span>&nbsp;<span class="builtinfunc" id="3264589">len</span><span class="op" id="3264592">(</span><span class="ident" id="3264593">msg</span><span class="op" id="3264596">)</span>&nbsp;<span class="op" id="3264598">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264604">return</span>&nbsp;<span class="string" id="3264611">&#34;&#34;</span><span class="op" id="3264613">,</span>&nbsp;<span class="builtinfunc" id="3264615">len</span><span class="op" id="3264618">(</span><span class="ident" id="3264619">msg</span><span class="op" id="3264622">)</span><span class="op" id="3264623">,</span>&nbsp;<span class="builtintype" id="3264625">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264639">c1</span>&nbsp;<span class="op" id="3264642">:=</span>&nbsp;<span class="ident" id="3264645">msg</span><span class="op" id="3264648">[</span><span class="ident" id="3264649">off</span><span class="op" id="3264652">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264657">off</span><span class="op" id="3264660">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264666">if</span>&nbsp;<span class="ident" id="3264669">ptr</span>&nbsp;<span class="op" id="3264673">==</span>&nbsp;<span class="num" id="3264676">0</span>&nbsp;<span class="op" id="3264678">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264684">off1</span>&nbsp;<span class="op" id="3264689">=</span>&nbsp;<span class="ident" id="3264691">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264703">if</span>&nbsp;<span class="ident" id="3264706">ptr</span><span class="op" id="3264709">++</span><span class="op" id="3264711">;</span>&nbsp;<span class="ident" id="3264713">ptr</span>&nbsp;<span class="op" id="3264717">&gt;</span>&nbsp;<span class="num" id="3264719">10</span>&nbsp;<span class="op" id="3264722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264728">return</span>&nbsp;<span class="string" id="3264735">&#34;&#34;</span><span class="op" id="3264737">,</span>&nbsp;<span class="builtinfunc" id="3264739">len</span><span class="op" id="3264742">(</span><span class="ident" id="3264743">msg</span><span class="op" id="3264746">)</span><span class="op" id="3264747">,</span>&nbsp;<span class="builtintype" id="3264749">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264758">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264763">off</span>&nbsp;<span class="op" id="3264767">=</span>&nbsp;<span class="op" id="3264769">(</span><span class="ident" id="3264770">c</span><span class="op" id="3264771">^</span><span class="num" id="3264772">0xC0</span><span class="op" id="3264776">)</span><span class="op" id="3264777">&lt;&lt;</span><span class="num" id="3264779">8</span>&nbsp;<span class="op" id="3264781">|</span>&nbsp;<span class="builtintype" id="3264783">int</span><span class="op" id="3264786">(</span><span class="ident" id="3264787">c1</span><span class="op" id="3264789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264793">default</span><span class="op" id="3264800">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264805">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264838">return</span>&nbsp;<span class="string" id="3264845">&#34;&#34;</span><span class="op" id="3264847">,</span>&nbsp;<span class="builtinfunc" id="3264849">len</span><span class="op" id="3264852">(</span><span class="ident" id="3264853">msg</span><span class="op" id="3264856">)</span><span class="op" id="3264857">,</span>&nbsp;<span class="builtintype" id="3264859">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264867">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264873">if</span>&nbsp;<span class="ident" id="3264876">ptr</span>&nbsp;<span class="op" id="3264880">==</span>&nbsp;<span class="num" id="3264883">0</span>&nbsp;<span class="op" id="3264885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264889">off1</span>&nbsp;<span class="op" id="3264894">=</span>&nbsp;<span class="ident" id="3264896">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3264901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3264904">return</span>&nbsp;<span class="ident" id="3264911">s</span><span class="op" id="3264912">,</span>&nbsp;<span class="ident" id="3264914">off1</span><span class="op" id="3264918">,</span>&nbsp;<span class="builtintype" id="3264920">true</span><br>
<span class="lineno">485</span><span class="op" id="3264925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3264928">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3264998">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3265059">func</span>&nbsp;<span class="ident" id="3265064">packStruct</span><span class="op" id="3265074">(</span><span class="ident" id="3265075">any</span>&nbsp;<span class="ident" id="3265079">dnsStruct</span><span class="op" id="3265088">,</span>&nbsp;<span class="ident" id="3265090">msg</span>&nbsp;<span class="op" id="3265094">[</span><span class="op" id="3265095">]</span><span class="builtintype" id="3265096">byte</span><span class="op" id="3265100">,</span>&nbsp;<span class="ident" id="3265102">off</span>&nbsp;<span class="builtintype" id="3265106">int</span><span class="op" id="3265109">)</span>&nbsp;<span class="op" id="3265111">(</span><span class="ident" id="3265112">off1</span>&nbsp;<span class="builtintype" id="3265117">int</span><span class="op" id="3265120">,</span>&nbsp;<span class="ident" id="3265122">ok</span>&nbsp;<span class="builtintype" id="3265125">bool</span><span class="op" id="3265129">)</span>&nbsp;<span class="op" id="3265131">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265134">ok</span>&nbsp;<span class="op" id="3265137">=</span>&nbsp;<span class="ident" id="3265139">any</span><span class="op" id="3265142">.</span><span class="ident" id="3265143">Walk</span><span class="op" id="3265147">(</span><span class="keyword" id="3265148">func</span><span class="op" id="3265152">(</span><span class="ident" id="3265153">field</span>&nbsp;<span class="keyword" id="3265159">interface</span><span class="op" id="3265168">{</span><span class="op" id="3265169">}</span><span class="op" id="3265170">,</span>&nbsp;<span class="ident" id="3265172">name</span><span class="op" id="3265176">,</span>&nbsp;<span class="ident" id="3265178">tag</span>&nbsp;<span class="builtintype" id="3265182">string</span><span class="op" id="3265188">)</span>&nbsp;<span class="builtintype" id="3265190">bool</span>&nbsp;<span class="op" id="3265195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265199">switch</span>&nbsp;<span class="ident" id="3265206">fv</span>&nbsp;<span class="op" id="3265209">:=</span>&nbsp;<span class="ident" id="3265212">field</span><span class="op" id="3265217">.</span><span class="op" id="3265218">(</span><span class="keyword" id="3265219">type</span><span class="op" id="3265223">)</span>&nbsp;<span class="op" id="3265225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265229">default</span><span class="op" id="3265236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3265241">println</span><span class="op" id="3265248">(</span><span class="string" id="3265249">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3265281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265286">return</span>&nbsp;<span class="builtintype" id="3265293">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265301">case</span>&nbsp;<span class="op" id="3265306">*</span><span class="builtintype" id="3265307">uint16</span><span class="op" id="3265313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265318">i</span>&nbsp;<span class="op" id="3265320">:=</span>&nbsp;<span class="op" id="3265323">*</span><span class="ident" id="3265324">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265330">if</span>&nbsp;<span class="ident" id="3265333">off</span><span class="op" id="3265336">+</span><span class="num" id="3265337">2</span>&nbsp;<span class="op" id="3265339">&gt;</span>&nbsp;<span class="builtinfunc" id="3265341">len</span><span class="op" id="3265344">(</span><span class="ident" id="3265345">msg</span><span class="op" id="3265348">)</span>&nbsp;<span class="op" id="3265350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265356">return</span>&nbsp;<span class="builtintype" id="3265363">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3265372">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265377">msg</span><span class="op" id="3265380">[</span><span class="ident" id="3265381">off</span><span class="op" id="3265384">]</span>&nbsp;<span class="op" id="3265386">=</span>&nbsp;<span class="builtintype" id="3265388">byte</span><span class="op" id="3265392">(</span><span class="ident" id="3265393">i</span>&nbsp;<span class="op" id="3265395">&gt;&gt;</span>&nbsp;<span class="num" id="3265398">8</span><span class="op" id="3265399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265404">msg</span><span class="op" id="3265407">[</span><span class="ident" id="3265408">off</span><span class="op" id="3265411">+</span><span class="num" id="3265412">1</span><span class="op" id="3265413">]</span>&nbsp;<span class="op" id="3265415">=</span>&nbsp;<span class="builtintype" id="3265417">byte</span><span class="op" id="3265421">(</span><span class="ident" id="3265422">i</span><span class="op" id="3265423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265428">off</span>&nbsp;<span class="op" id="3265432">+=</span>&nbsp;<span class="num" id="3265435">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265439">case</span>&nbsp;<span class="op" id="3265444">*</span><span class="builtintype" id="3265445">uint32</span><span class="op" id="3265451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265456">i</span>&nbsp;<span class="op" id="3265458">:=</span>&nbsp;<span class="op" id="3265461">*</span><span class="ident" id="3265462">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265468">msg</span><span class="op" id="3265471">[</span><span class="ident" id="3265472">off</span><span class="op" id="3265475">]</span>&nbsp;<span class="op" id="3265477">=</span>&nbsp;<span class="builtintype" id="3265479">byte</span><span class="op" id="3265483">(</span><span class="ident" id="3265484">i</span>&nbsp;<span class="op" id="3265486">&gt;&gt;</span>&nbsp;<span class="num" id="3265489">24</span><span class="op" id="3265491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265496">msg</span><span class="op" id="3265499">[</span><span class="ident" id="3265500">off</span><span class="op" id="3265503">+</span><span class="num" id="3265504">1</span><span class="op" id="3265505">]</span>&nbsp;<span class="op" id="3265507">=</span>&nbsp;<span class="builtintype" id="3265509">byte</span><span class="op" id="3265513">(</span><span class="ident" id="3265514">i</span>&nbsp;<span class="op" id="3265516">&gt;&gt;</span>&nbsp;<span class="num" id="3265519">16</span><span class="op" id="3265521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265526">msg</span><span class="op" id="3265529">[</span><span class="ident" id="3265530">off</span><span class="op" id="3265533">+</span><span class="num" id="3265534">2</span><span class="op" id="3265535">]</span>&nbsp;<span class="op" id="3265537">=</span>&nbsp;<span class="builtintype" id="3265539">byte</span><span class="op" id="3265543">(</span><span class="ident" id="3265544">i</span>&nbsp;<span class="op" id="3265546">&gt;&gt;</span>&nbsp;<span class="num" id="3265549">8</span><span class="op" id="3265550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265555">msg</span><span class="op" id="3265558">[</span><span class="ident" id="3265559">off</span><span class="op" id="3265562">+</span><span class="num" id="3265563">3</span><span class="op" id="3265564">]</span>&nbsp;<span class="op" id="3265566">=</span>&nbsp;<span class="builtintype" id="3265568">byte</span><span class="op" id="3265572">(</span><span class="ident" id="3265573">i</span><span class="op" id="3265574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265579">off</span>&nbsp;<span class="op" id="3265583">+=</span>&nbsp;<span class="num" id="3265586">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265590">case</span>&nbsp;<span class="op" id="3265595">[</span><span class="op" id="3265596">]</span><span class="builtintype" id="3265597">byte</span><span class="op" id="3265601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265606">n</span>&nbsp;<span class="op" id="3265608">:=</span>&nbsp;<span class="builtinfunc" id="3265611">len</span><span class="op" id="3265614">(</span><span class="ident" id="3265615">fv</span><span class="op" id="3265617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265622">if</span>&nbsp;<span class="ident" id="3265625">off</span><span class="op" id="3265628">+</span><span class="ident" id="3265629">n</span>&nbsp;<span class="op" id="3265631">&gt;</span>&nbsp;<span class="builtinfunc" id="3265633">len</span><span class="op" id="3265636">(</span><span class="ident" id="3265637">msg</span><span class="op" id="3265640">)</span>&nbsp;<span class="op" id="3265642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265648">return</span>&nbsp;<span class="builtintype" id="3265655">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3265664">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3265669">copy</span><span class="op" id="3265673">(</span><span class="ident" id="3265674">msg</span><span class="op" id="3265677">[</span><span class="ident" id="3265678">off</span><span class="op" id="3265681">:</span><span class="ident" id="3265682">off</span><span class="op" id="3265685">+</span><span class="ident" id="3265686">n</span><span class="op" id="3265687">]</span><span class="op" id="3265688">,</span>&nbsp;<span class="ident" id="3265690">fv</span><span class="op" id="3265692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265697">off</span>&nbsp;<span class="op" id="3265701">+=</span>&nbsp;<span class="ident" id="3265704">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265708">case</span>&nbsp;<span class="op" id="3265713">*</span><span class="builtintype" id="3265714">string</span><span class="op" id="3265720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265725">s</span>&nbsp;<span class="op" id="3265727">:=</span>&nbsp;<span class="op" id="3265730">*</span><span class="ident" id="3265731">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265737">switch</span>&nbsp;<span class="ident" id="3265744">tag</span>&nbsp;<span class="op" id="3265748">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265753">default</span><span class="op" id="3265760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3265766">println</span><span class="op" id="3265773">(</span><span class="string" id="3265774">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3265804">,</span>&nbsp;<span class="ident" id="3265806">tag</span><span class="op" id="3265809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265815">return</span>&nbsp;<span class="builtintype" id="3265822">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265831">case</span>&nbsp;<span class="string" id="3265836">&#34;domain&#34;</span><span class="op" id="3265844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265850">off</span><span class="op" id="3265853">,</span>&nbsp;<span class="ident" id="3265855">ok</span>&nbsp;<span class="op" id="3265858">=</span>&nbsp;<span class="ident" id="3265860">packDomainName</span><span class="op" id="3265874">(</span><span class="ident" id="3265875">s</span><span class="op" id="3265876">,</span>&nbsp;<span class="ident" id="3265878">msg</span><span class="op" id="3265881">,</span>&nbsp;<span class="ident" id="3265883">off</span><span class="op" id="3265886">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265892">if</span>&nbsp;<span class="op" id="3265895">!</span><span class="ident" id="3265896">ok</span>&nbsp;<span class="op" id="3265899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265906">return</span>&nbsp;<span class="builtintype" id="3265913">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3265923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265928">case</span>&nbsp;<span class="string" id="3265933">&#34;&#34;</span><span class="op" id="3265935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3265941">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265979">if</span>&nbsp;<span class="builtinfunc" id="3265982">len</span><span class="op" id="3265985">(</span><span class="ident" id="3265986">s</span><span class="op" id="3265987">)</span>&nbsp;<span class="op" id="3265989">&gt;</span>&nbsp;<span class="num" id="3265991">255</span>&nbsp;<span class="op" id="3265995">||</span>&nbsp;<span class="ident" id="3265998">off</span><span class="op" id="3266001">+</span><span class="num" id="3266002">1</span><span class="op" id="3266003">+</span><span class="builtinfunc" id="3266004">len</span><span class="op" id="3266007">(</span><span class="ident" id="3266008">s</span><span class="op" id="3266009">)</span>&nbsp;<span class="op" id="3266011">&gt;</span>&nbsp;<span class="builtinfunc" id="3266013">len</span><span class="op" id="3266016">(</span><span class="ident" id="3266017">msg</span><span class="op" id="3266020">)</span>&nbsp;<span class="op" id="3266022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266029">return</span>&nbsp;<span class="builtintype" id="3266036">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266052">msg</span><span class="op" id="3266055">[</span><span class="ident" id="3266056">off</span><span class="op" id="3266059">]</span>&nbsp;<span class="op" id="3266061">=</span>&nbsp;<span class="builtintype" id="3266063">byte</span><span class="op" id="3266067">(</span><span class="builtinfunc" id="3266068">len</span><span class="op" id="3266071">(</span><span class="ident" id="3266072">s</span><span class="op" id="3266073">)</span><span class="op" id="3266074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266080">off</span><span class="op" id="3266083">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266090">off</span>&nbsp;<span class="op" id="3266094">+=</span>&nbsp;<span class="builtinfunc" id="3266097">copy</span><span class="op" id="3266101">(</span><span class="ident" id="3266102">msg</span><span class="op" id="3266105">[</span><span class="ident" id="3266106">off</span><span class="op" id="3266109">:</span><span class="op" id="3266110">]</span><span class="op" id="3266111">,</span>&nbsp;<span class="ident" id="3266113">s</span><span class="op" id="3266114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266127">return</span>&nbsp;<span class="builtintype" id="3266134">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266140">}</span><span class="op" id="3266141">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266144">if</span>&nbsp;<span class="op" id="3266147">!</span><span class="ident" id="3266148">ok</span>&nbsp;<span class="op" id="3266151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266155">return</span>&nbsp;<span class="builtinfunc" id="3266162">len</span><span class="op" id="3266165">(</span><span class="ident" id="3266166">msg</span><span class="op" id="3266169">)</span><span class="op" id="3266170">,</span>&nbsp;<span class="builtintype" id="3266172">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266182">return</span>&nbsp;<span class="ident" id="3266189">off</span><span class="op" id="3266192">,</span>&nbsp;<span class="builtintype" id="3266194">true</span><br>
<span class="lineno"></span><span class="op" id="3266199">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3266202">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3266267">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3266328">func</span>&nbsp;<span class="ident" id="3266333">unpackStruct</span><span class="op" id="3266345">(</span><span class="ident" id="3266346">any</span>&nbsp;<span class="ident" id="3266350">dnsStruct</span><span class="op" id="3266359">,</span>&nbsp;<span class="ident" id="3266361">msg</span>&nbsp;<span class="op" id="3266365">[</span><span class="op" id="3266366">]</span><span class="builtintype" id="3266367">byte</span><span class="op" id="3266371">,</span>&nbsp;<span class="ident" id="3266373">off</span>&nbsp;<span class="builtintype" id="3266377">int</span><span class="op" id="3266380">)</span>&nbsp;<span class="op" id="3266382">(</span><span class="ident" id="3266383">off1</span>&nbsp;<span class="builtintype" id="3266388">int</span><span class="op" id="3266391">,</span>&nbsp;<span class="ident" id="3266393">ok</span>&nbsp;<span class="builtintype" id="3266396">bool</span><span class="op" id="3266400">)</span>&nbsp;<span class="op" id="3266402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266405">ok</span>&nbsp;<span class="op" id="3266408">=</span>&nbsp;<span class="ident" id="3266410">any</span><span class="op" id="3266413">.</span><span class="ident" id="3266414">Walk</span><span class="op" id="3266418">(</span><span class="keyword" id="3266419">func</span><span class="op" id="3266423">(</span><span class="ident" id="3266424">field</span>&nbsp;<span class="keyword" id="3266430">interface</span><span class="op" id="3266439">{</span><span class="op" id="3266440">}</span><span class="op" id="3266441">,</span>&nbsp;<span class="ident" id="3266443">name</span><span class="op" id="3266447">,</span>&nbsp;<span class="ident" id="3266449">tag</span>&nbsp;<span class="builtintype" id="3266453">string</span><span class="op" id="3266459">)</span>&nbsp;<span class="builtintype" id="3266461">bool</span>&nbsp;<span class="op" id="3266466">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266470">switch</span>&nbsp;<span class="ident" id="3266477">fv</span>&nbsp;<span class="op" id="3266480">:=</span>&nbsp;<span class="ident" id="3266483">field</span><span class="op" id="3266488">.</span><span class="op" id="3266489">(</span><span class="keyword" id="3266490">type</span><span class="op" id="3266494">)</span>&nbsp;<span class="op" id="3266496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266500">default</span><span class="op" id="3266507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3266512">println</span><span class="op" id="3266519">(</span><span class="string" id="3266520">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3266552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266557">return</span>&nbsp;<span class="builtintype" id="3266564">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266572">case</span>&nbsp;<span class="op" id="3266577">*</span><span class="builtintype" id="3266578">uint16</span><span class="op" id="3266584">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266589">if</span>&nbsp;<span class="ident" id="3266592">off</span><span class="op" id="3266595">+</span><span class="num" id="3266596">2</span>&nbsp;<span class="op" id="3266598">&gt;</span>&nbsp;<span class="builtinfunc" id="3266600">len</span><span class="op" id="3266603">(</span><span class="ident" id="3266604">msg</span><span class="op" id="3266607">)</span>&nbsp;<span class="op" id="3266609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266615">return</span>&nbsp;<span class="builtintype" id="3266622">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266636">*</span><span class="ident" id="3266637">fv</span>&nbsp;<span class="op" id="3266640">=</span>&nbsp;<span class="builtintype" id="3266642">uint16</span><span class="op" id="3266648">(</span><span class="ident" id="3266649">msg</span><span class="op" id="3266652">[</span><span class="ident" id="3266653">off</span><span class="op" id="3266656">]</span><span class="op" id="3266657">)</span><span class="op" id="3266658">&lt;&lt;</span><span class="num" id="3266660">8</span>&nbsp;<span class="op" id="3266662">|</span>&nbsp;<span class="builtintype" id="3266664">uint16</span><span class="op" id="3266670">(</span><span class="ident" id="3266671">msg</span><span class="op" id="3266674">[</span><span class="ident" id="3266675">off</span><span class="op" id="3266678">+</span><span class="num" id="3266679">1</span><span class="op" id="3266680">]</span><span class="op" id="3266681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266686">off</span>&nbsp;<span class="op" id="3266690">+=</span>&nbsp;<span class="num" id="3266693">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266697">case</span>&nbsp;<span class="op" id="3266702">*</span><span class="builtintype" id="3266703">uint32</span><span class="op" id="3266709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266714">if</span>&nbsp;<span class="ident" id="3266717">off</span><span class="op" id="3266720">+</span><span class="num" id="3266721">4</span>&nbsp;<span class="op" id="3266723">&gt;</span>&nbsp;<span class="builtinfunc" id="3266725">len</span><span class="op" id="3266728">(</span><span class="ident" id="3266729">msg</span><span class="op" id="3266732">)</span>&nbsp;<span class="op" id="3266734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266740">return</span>&nbsp;<span class="builtintype" id="3266747">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266761">*</span><span class="ident" id="3266762">fv</span>&nbsp;<span class="op" id="3266765">=</span>&nbsp;<span class="builtintype" id="3266767">uint32</span><span class="op" id="3266773">(</span><span class="ident" id="3266774">msg</span><span class="op" id="3266777">[</span><span class="ident" id="3266778">off</span><span class="op" id="3266781">]</span><span class="op" id="3266782">)</span><span class="op" id="3266783">&lt;&lt;</span><span class="num" id="3266785">24</span>&nbsp;<span class="op" id="3266788">|</span>&nbsp;<span class="builtintype" id="3266790">uint32</span><span class="op" id="3266796">(</span><span class="ident" id="3266797">msg</span><span class="op" id="3266800">[</span><span class="ident" id="3266801">off</span><span class="op" id="3266804">+</span><span class="num" id="3266805">1</span><span class="op" id="3266806">]</span><span class="op" id="3266807">)</span><span class="op" id="3266808">&lt;&lt;</span><span class="num" id="3266810">16</span>&nbsp;<span class="op" id="3266813">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3266819">uint32</span><span class="op" id="3266825">(</span><span class="ident" id="3266826">msg</span><span class="op" id="3266829">[</span><span class="ident" id="3266830">off</span><span class="op" id="3266833">+</span><span class="num" id="3266834">2</span><span class="op" id="3266835">]</span><span class="op" id="3266836">)</span><span class="op" id="3266837">&lt;&lt;</span><span class="num" id="3266839">8</span>&nbsp;<span class="op" id="3266841">|</span>&nbsp;<span class="builtintype" id="3266843">uint32</span><span class="op" id="3266849">(</span><span class="ident" id="3266850">msg</span><span class="op" id="3266853">[</span><span class="ident" id="3266854">off</span><span class="op" id="3266857">+</span><span class="num" id="3266858">3</span><span class="op" id="3266859">]</span><span class="op" id="3266860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266865">off</span>&nbsp;<span class="op" id="3266869">+=</span>&nbsp;<span class="num" id="3266872">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266876">case</span>&nbsp;<span class="op" id="3266881">[</span><span class="op" id="3266882">]</span><span class="builtintype" id="3266883">byte</span><span class="op" id="3266887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266892">n</span>&nbsp;<span class="op" id="3266894">:=</span>&nbsp;<span class="builtinfunc" id="3266897">len</span><span class="op" id="3266900">(</span><span class="ident" id="3266901">fv</span><span class="op" id="3266903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266908">if</span>&nbsp;<span class="ident" id="3266911">off</span><span class="op" id="3266914">+</span><span class="ident" id="3266915">n</span>&nbsp;<span class="op" id="3266917">&gt;</span>&nbsp;<span class="builtinfunc" id="3266919">len</span><span class="op" id="3266922">(</span><span class="ident" id="3266923">msg</span><span class="op" id="3266926">)</span>&nbsp;<span class="op" id="3266928">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266934">return</span>&nbsp;<span class="builtintype" id="3266941">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3266955">copy</span><span class="op" id="3266959">(</span><span class="ident" id="3266960">fv</span><span class="op" id="3266962">,</span>&nbsp;<span class="ident" id="3266964">msg</span><span class="op" id="3266967">[</span><span class="ident" id="3266968">off</span><span class="op" id="3266971">:</span><span class="ident" id="3266972">off</span><span class="op" id="3266975">+</span><span class="ident" id="3266976">n</span><span class="op" id="3266977">]</span><span class="op" id="3266978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266983">off</span>&nbsp;<span class="op" id="3266987">+=</span>&nbsp;<span class="ident" id="3266990">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266994">case</span>&nbsp;<span class="op" id="3266999">*</span><span class="builtintype" id="3267000">string</span><span class="op" id="3267006">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267011">var</span>&nbsp;<span class="ident" id="3267015">s</span>&nbsp;<span class="builtintype" id="3267017">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267027">switch</span>&nbsp;<span class="ident" id="3267034">tag</span>&nbsp;<span class="op" id="3267038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267043">default</span><span class="op" id="3267050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3267056">println</span><span class="op" id="3267063">(</span><span class="string" id="3267064">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3267094">,</span>&nbsp;<span class="ident" id="3267096">tag</span><span class="op" id="3267099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267105">return</span>&nbsp;<span class="builtintype" id="3267112">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267121">case</span>&nbsp;<span class="string" id="3267126">&#34;domain&#34;</span><span class="op" id="3267134">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267140">s</span><span class="op" id="3267141">,</span>&nbsp;<span class="ident" id="3267143">off</span><span class="op" id="3267146">,</span>&nbsp;<span class="ident" id="3267148">ok</span>&nbsp;<span class="op" id="3267151">=</span>&nbsp;<span class="ident" id="3267153">unpackDomainName</span><span class="op" id="3267169">(</span><span class="ident" id="3267170">msg</span><span class="op" id="3267173">,</span>&nbsp;<span class="ident" id="3267175">off</span><span class="op" id="3267178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267184">if</span>&nbsp;<span class="op" id="3267187">!</span><span class="ident" id="3267188">ok</span>&nbsp;<span class="op" id="3267191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267198">return</span>&nbsp;<span class="builtintype" id="3267205">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267215">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267220">case</span>&nbsp;<span class="string" id="3267225">&#34;&#34;</span><span class="op" id="3267227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267233">if</span>&nbsp;<span class="ident" id="3267236">off</span>&nbsp;<span class="op" id="3267240">&gt;=</span>&nbsp;<span class="builtinfunc" id="3267243">len</span><span class="op" id="3267246">(</span><span class="ident" id="3267247">msg</span><span class="op" id="3267250">)</span>&nbsp;<span class="op" id="3267252">||</span>&nbsp;<span class="ident" id="3267255">off</span><span class="op" id="3267258">+</span><span class="num" id="3267259">1</span><span class="op" id="3267260">+</span><span class="builtintype" id="3267261">int</span><span class="op" id="3267264">(</span><span class="ident" id="3267265">msg</span><span class="op" id="3267268">[</span><span class="ident" id="3267269">off</span><span class="op" id="3267272">]</span><span class="op" id="3267273">)</span>&nbsp;<span class="op" id="3267275">&gt;</span>&nbsp;<span class="builtinfunc" id="3267277">len</span><span class="op" id="3267280">(</span><span class="ident" id="3267281">msg</span><span class="op" id="3267284">)</span>&nbsp;<span class="op" id="3267286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267293">return</span>&nbsp;<span class="builtintype" id="3267300">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267316">n</span>&nbsp;<span class="op" id="3267318">:=</span>&nbsp;<span class="builtintype" id="3267321">int</span><span class="op" id="3267324">(</span><span class="ident" id="3267325">msg</span><span class="op" id="3267328">[</span><span class="ident" id="3267329">off</span><span class="op" id="3267332">]</span><span class="op" id="3267333">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267339">off</span><span class="op" id="3267342">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267349">b</span>&nbsp;<span class="op" id="3267351">:=</span>&nbsp;<span class="builtinfunc" id="3267354">make</span><span class="op" id="3267358">(</span><span class="op" id="3267359">[</span><span class="op" id="3267360">]</span><span class="builtintype" id="3267361">byte</span><span class="op" id="3267365">,</span>&nbsp;<span class="ident" id="3267367">n</span><span class="op" id="3267368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267374">for</span>&nbsp;<span class="ident" id="3267378">i</span>&nbsp;<span class="op" id="3267380">:=</span>&nbsp;<span class="num" id="3267383">0</span><span class="op" id="3267384">;</span>&nbsp;<span class="ident" id="3267386">i</span>&nbsp;<span class="op" id="3267388">&lt;</span>&nbsp;<span class="ident" id="3267390">n</span><span class="op" id="3267391">;</span>&nbsp;<span class="ident" id="3267393">i</span><span class="op" id="3267394">++</span>&nbsp;<span class="op" id="3267397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267404">b</span><span class="op" id="3267405">[</span><span class="ident" id="3267406">i</span><span class="op" id="3267407">]</span>&nbsp;<span class="op" id="3267409">=</span>&nbsp;<span class="ident" id="3267411">msg</span><span class="op" id="3267414">[</span><span class="ident" id="3267415">off</span><span class="op" id="3267418">+</span><span class="ident" id="3267419">i</span><span class="op" id="3267420">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267426">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267432">off</span>&nbsp;<span class="op" id="3267436">+=</span>&nbsp;<span class="ident" id="3267439">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267445">s</span>&nbsp;<span class="op" id="3267447">=</span>&nbsp;<span class="builtintype" id="3267449">string</span><span class="op" id="3267455">(</span><span class="ident" id="3267456">b</span><span class="op" id="3267457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267467">*</span><span class="ident" id="3267468">fv</span>&nbsp;<span class="op" id="3267471">=</span>&nbsp;<span class="ident" id="3267473">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267477">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267481">return</span>&nbsp;<span class="builtintype" id="3267488">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267494">}</span><span class="op" id="3267495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267498">if</span>&nbsp;<span class="op" id="3267501">!</span><span class="ident" id="3267502">ok</span>&nbsp;<span class="op" id="3267505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267509">return</span>&nbsp;<span class="builtinfunc" id="3267516">len</span><span class="op" id="3267519">(</span><span class="ident" id="3267520">msg</span><span class="op" id="3267523">)</span><span class="op" id="3267524">,</span>&nbsp;<span class="builtintype" id="3267526">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267533">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267536">return</span>&nbsp;<span class="ident" id="3267543">off</span><span class="op" id="3267546">,</span>&nbsp;<span class="builtintype" id="3267548">true</span><br>
<span class="lineno"></span><span class="op" id="3267553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3267556">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3267623">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3267643">func</span>&nbsp;<span class="ident" id="3267648">printStruct</span><span class="op" id="3267659">(</span><span class="ident" id="3267660">any</span>&nbsp;<span class="ident" id="3267664">dnsStruct</span><span class="op" id="3267673">)</span>&nbsp;<span class="builtintype" id="3267675">string</span>&nbsp;<span class="op" id="3267682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267685">s</span>&nbsp;<span class="op" id="3267687">:=</span>&nbsp;<span class="string" id="3267690">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267695">i</span>&nbsp;<span class="op" id="3267697">:=</span>&nbsp;<span class="num" id="3267700">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267703">any</span><span class="op" id="3267706">.</span><span class="ident" id="3267707">Walk</span><span class="op" id="3267711">(</span><span class="keyword" id="3267712">func</span><span class="op" id="3267716">(</span><span class="ident" id="3267717">val</span>&nbsp;<span class="keyword" id="3267721">interface</span><span class="op" id="3267730">{</span><span class="op" id="3267731">}</span><span class="op" id="3267732">,</span>&nbsp;<span class="ident" id="3267734">name</span><span class="op" id="3267738">,</span>&nbsp;<span class="ident" id="3267740">tag</span>&nbsp;<span class="builtintype" id="3267744">string</span><span class="op" id="3267750">)</span>&nbsp;<span class="builtintype" id="3267752">bool</span>&nbsp;<span class="op" id="3267757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267761">i</span><span class="op" id="3267762">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267767">if</span>&nbsp;<span class="ident" id="3267770">i</span>&nbsp;<span class="op" id="3267772">&gt;</span>&nbsp;<span class="num" id="3267774">1</span>&nbsp;<span class="op" id="3267776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267781">s</span>&nbsp;<span class="op" id="3267783">+=</span>&nbsp;<span class="string" id="3267786">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267797">s</span>&nbsp;<span class="op" id="3267799">+=</span>&nbsp;<span class="ident" id="3267802">name</span>&nbsp;<span class="op" id="3267807">+</span>&nbsp;<span class="string" id="3267809">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267815">switch</span>&nbsp;<span class="ident" id="3267822">tag</span>&nbsp;<span class="op" id="3267826">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267830">case</span>&nbsp;<span class="string" id="3267835">&#34;ipv4&#34;</span><span class="op" id="3267841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267846">i</span>&nbsp;<span class="op" id="3267848">:=</span>&nbsp;<span class="op" id="3267851">*</span><span class="ident" id="3267852">val</span><span class="op" id="3267855">.</span><span class="op" id="3267856">(</span><span class="op" id="3267857">*</span><span class="builtintype" id="3267858">uint32</span><span class="op" id="3267864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267869">s</span>&nbsp;<span class="op" id="3267871">+=</span>&nbsp;<span class="ident" id="3267874">IPv4</span><span class="op" id="3267878">(</span><span class="builtintype" id="3267879">byte</span><span class="op" id="3267883">(</span><span class="ident" id="3267884">i</span><span class="op" id="3267885">&gt;&gt;</span><span class="num" id="3267887">24</span><span class="op" id="3267889">)</span><span class="op" id="3267890">,</span>&nbsp;<span class="builtintype" id="3267892">byte</span><span class="op" id="3267896">(</span><span class="ident" id="3267897">i</span><span class="op" id="3267898">&gt;&gt;</span><span class="num" id="3267900">16</span><span class="op" id="3267902">)</span><span class="op" id="3267903">,</span>&nbsp;<span class="builtintype" id="3267905">byte</span><span class="op" id="3267909">(</span><span class="ident" id="3267910">i</span><span class="op" id="3267911">&gt;&gt;</span><span class="num" id="3267913">8</span><span class="op" id="3267914">)</span><span class="op" id="3267915">,</span>&nbsp;<span class="builtintype" id="3267917">byte</span><span class="op" id="3267921">(</span><span class="ident" id="3267922">i</span><span class="op" id="3267923">)</span><span class="op" id="3267924">)</span><span class="op" id="3267925">.</span><span class="ident" id="3267926">String</span><span class="op" id="3267932">(</span><span class="op" id="3267933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267937">case</span>&nbsp;<span class="string" id="3267942">&#34;ipv6&#34;</span><span class="op" id="3267948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267953">i</span>&nbsp;<span class="op" id="3267955">:=</span>&nbsp;<span class="ident" id="3267958">val</span><span class="op" id="3267961">.</span><span class="op" id="3267962">(</span><span class="op" id="3267963">[</span><span class="op" id="3267964">]</span><span class="builtintype" id="3267965">byte</span><span class="op" id="3267969">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267974">s</span>&nbsp;<span class="op" id="3267976">+=</span>&nbsp;<span class="ident" id="3267979">IP</span><span class="op" id="3267981">(</span><span class="ident" id="3267982">i</span><span class="op" id="3267983">)</span><span class="op" id="3267984">.</span><span class="ident" id="3267985">String</span><span class="op" id="3267991">(</span><span class="op" id="3267992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267996">default</span><span class="op" id="3268003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268008">var</span>&nbsp;<span class="ident" id="3268012">i</span>&nbsp;<span class="ident" id="3268014">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268023">switch</span>&nbsp;<span class="ident" id="3268030">v</span>&nbsp;<span class="op" id="3268032">:=</span>&nbsp;<span class="ident" id="3268035">val</span><span class="op" id="3268038">.</span><span class="op" id="3268039">(</span><span class="keyword" id="3268040">type</span><span class="op" id="3268044">)</span>&nbsp;<span class="op" id="3268046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268051">default</span><span class="op" id="3268058">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3268064">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268092">s</span>&nbsp;<span class="op" id="3268094">+=</span>&nbsp;<span class="string" id="3268097">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268118">return</span>&nbsp;<span class="builtintype" id="3268125">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268133">case</span>&nbsp;<span class="op" id="3268138">*</span><span class="builtintype" id="3268139">string</span><span class="op" id="3268145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268151">s</span>&nbsp;<span class="op" id="3268153">+=</span>&nbsp;<span class="op" id="3268156">*</span><span class="ident" id="3268157">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268163">return</span>&nbsp;<span class="builtintype" id="3268170">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268178">case</span>&nbsp;<span class="op" id="3268183">[</span><span class="op" id="3268184">]</span><span class="builtintype" id="3268185">byte</span><span class="op" id="3268189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268195">s</span>&nbsp;<span class="op" id="3268197">+=</span>&nbsp;<span class="builtintype" id="3268200">string</span><span class="op" id="3268206">(</span><span class="ident" id="3268207">v</span><span class="op" id="3268208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268214">return</span>&nbsp;<span class="builtintype" id="3268221">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268229">case</span>&nbsp;<span class="op" id="3268234">*</span><span class="builtintype" id="3268235">bool</span><span class="op" id="3268239">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268245">if</span>&nbsp;<span class="op" id="3268248">*</span><span class="ident" id="3268249">v</span>&nbsp;<span class="op" id="3268251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268258">s</span>&nbsp;<span class="op" id="3268260">+=</span>&nbsp;<span class="string" id="3268263">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268274">}</span>&nbsp;<span class="keyword" id="3268276">else</span>&nbsp;<span class="op" id="3268281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268288">s</span>&nbsp;<span class="op" id="3268290">+=</span>&nbsp;<span class="string" id="3268293">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268305">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268311">return</span>&nbsp;<span class="builtintype" id="3268318">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268326">case</span>&nbsp;<span class="op" id="3268331">*</span><span class="builtintype" id="3268332">int</span><span class="op" id="3268335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268341">i</span>&nbsp;<span class="op" id="3268343">=</span>&nbsp;<span class="ident" id="3268345">int64</span><span class="op" id="3268350">(</span><span class="op" id="3268351">*</span><span class="ident" id="3268352">v</span><span class="op" id="3268353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268358">case</span>&nbsp;<span class="op" id="3268363">*</span><span class="builtintype" id="3268364">uint</span><span class="op" id="3268368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268374">i</span>&nbsp;<span class="op" id="3268376">=</span>&nbsp;<span class="ident" id="3268378">int64</span><span class="op" id="3268383">(</span><span class="op" id="3268384">*</span><span class="ident" id="3268385">v</span><span class="op" id="3268386">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268391">case</span>&nbsp;<span class="op" id="3268396">*</span><span class="builtintype" id="3268397">uint8</span><span class="op" id="3268402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268408">i</span>&nbsp;<span class="op" id="3268410">=</span>&nbsp;<span class="ident" id="3268412">int64</span><span class="op" id="3268417">(</span><span class="op" id="3268418">*</span><span class="ident" id="3268419">v</span><span class="op" id="3268420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268425">case</span>&nbsp;<span class="op" id="3268430">*</span><span class="builtintype" id="3268431">uint16</span><span class="op" id="3268437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268443">i</span>&nbsp;<span class="op" id="3268445">=</span>&nbsp;<span class="ident" id="3268447">int64</span><span class="op" id="3268452">(</span><span class="op" id="3268453">*</span><span class="ident" id="3268454">v</span><span class="op" id="3268455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268460">case</span>&nbsp;<span class="op" id="3268465">*</span><span class="builtintype" id="3268466">uint32</span><span class="op" id="3268472">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268478">i</span>&nbsp;<span class="op" id="3268480">=</span>&nbsp;<span class="ident" id="3268482">int64</span><span class="op" id="3268487">(</span><span class="op" id="3268488">*</span><span class="ident" id="3268489">v</span><span class="op" id="3268490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268495">case</span>&nbsp;<span class="op" id="3268500">*</span><span class="ident" id="3268501">uint64</span><span class="op" id="3268507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268513">i</span>&nbsp;<span class="op" id="3268515">=</span>&nbsp;<span class="ident" id="3268517">int64</span><span class="op" id="3268522">(</span><span class="op" id="3268523">*</span><span class="ident" id="3268524">v</span><span class="op" id="3268525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268530">case</span>&nbsp;<span class="op" id="3268535">*</span><span class="builtintype" id="3268536">uintptr</span><span class="op" id="3268543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268549">i</span>&nbsp;<span class="op" id="3268551">=</span>&nbsp;<span class="ident" id="3268553">int64</span><span class="op" id="3268558">(</span><span class="op" id="3268559">*</span><span class="ident" id="3268560">v</span><span class="op" id="3268561">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268571">s</span>&nbsp;<span class="op" id="3268573">+=</span>&nbsp;<span class="ident" id="3268576">itoa</span><span class="op" id="3268580">(</span><span class="builtintype" id="3268581">int</span><span class="op" id="3268584">(</span><span class="ident" id="3268585">i</span><span class="op" id="3268586">)</span><span class="op" id="3268587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268595">return</span>&nbsp;<span class="builtintype" id="3268602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268608">}</span><span class="op" id="3268609">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268612">s</span>&nbsp;<span class="op" id="3268614">+=</span>&nbsp;<span class="string" id="3268617">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268622">return</span>&nbsp;<span class="ident" id="3268629">s</span><br>
<span class="lineno"></span><span class="op" id="3268631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3268634">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3268661">func</span>&nbsp;<span class="ident" id="3268666">packRR</span><span class="op" id="3268672">(</span><span class="ident" id="3268673">rr</span>&nbsp;<span class="ident" id="3268676">dnsRR</span><span class="op" id="3268681">,</span>&nbsp;<span class="ident" id="3268683">msg</span>&nbsp;<span class="op" id="3268687">[</span><span class="op" id="3268688">]</span><span class="builtintype" id="3268689">byte</span><span class="op" id="3268693">,</span>&nbsp;<span class="ident" id="3268695">off</span>&nbsp;<span class="builtintype" id="3268699">int</span><span class="op" id="3268702">)</span>&nbsp;<span class="op" id="3268704">(</span><span class="ident" id="3268705">off2</span>&nbsp;<span class="builtintype" id="3268710">int</span><span class="op" id="3268713">,</span>&nbsp;<span class="ident" id="3268715">ok</span>&nbsp;<span class="builtintype" id="3268718">bool</span><span class="op" id="3268722">)</span>&nbsp;<span class="op" id="3268724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268727">var</span>&nbsp;<span class="ident" id="3268731">off1</span>&nbsp;<span class="builtintype" id="3268736">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3268741">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3268784">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3268821">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3268877">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3268903">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268925">off1</span><span class="op" id="3268929">,</span>&nbsp;<span class="ident" id="3268931">ok</span>&nbsp;<span class="op" id="3268934">=</span>&nbsp;<span class="ident" id="3268936">packStruct</span><span class="op" id="3268946">(</span><span class="ident" id="3268947">rr</span><span class="op" id="3268949">.</span><span class="ident" id="3268950">Header</span><span class="op" id="3268956">(</span><span class="op" id="3268957">)</span><span class="op" id="3268958">,</span>&nbsp;<span class="ident" id="3268960">msg</span><span class="op" id="3268963">,</span>&nbsp;<span class="ident" id="3268965">off</span><span class="op" id="3268968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268971">off2</span><span class="op" id="3268975">,</span>&nbsp;<span class="ident" id="3268977">ok</span>&nbsp;<span class="op" id="3268980">=</span>&nbsp;<span class="ident" id="3268982">packStruct</span><span class="op" id="3268992">(</span><span class="ident" id="3268993">rr</span><span class="op" id="3268995">,</span>&nbsp;<span class="ident" id="3268997">msg</span><span class="op" id="3269000">,</span>&nbsp;<span class="ident" id="3269002">off</span><span class="op" id="3269005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269008">if</span>&nbsp;<span class="op" id="3269011">!</span><span class="ident" id="3269012">ok</span>&nbsp;<span class="op" id="3269015">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269019">return</span>&nbsp;<span class="builtinfunc" id="3269026">len</span><span class="op" id="3269029">(</span><span class="ident" id="3269030">msg</span><span class="op" id="3269033">)</span><span class="op" id="3269034">,</span>&nbsp;<span class="builtintype" id="3269036">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3269046">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269106">rr</span><span class="op" id="3269108">.</span><span class="ident" id="3269109">Header</span><span class="op" id="3269115">(</span><span class="op" id="3269116">)</span><span class="op" id="3269117">.</span><span class="ident" id="3269118">Rdlength</span>&nbsp;<span class="op" id="3269127">=</span>&nbsp;<span class="builtintype" id="3269129">uint16</span><span class="op" id="3269135">(</span><span class="ident" id="3269136">off2</span>&nbsp;<span class="op" id="3269141">-</span>&nbsp;<span class="ident" id="3269143">off1</span><span class="op" id="3269147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269150">packStruct</span><span class="op" id="3269160">(</span><span class="ident" id="3269161">rr</span><span class="op" id="3269163">.</span><span class="ident" id="3269164">Header</span><span class="op" id="3269170">(</span><span class="op" id="3269171">)</span><span class="op" id="3269172">,</span>&nbsp;<span class="ident" id="3269174">msg</span><span class="op" id="3269177">,</span>&nbsp;<span class="ident" id="3269179">off</span><span class="op" id="3269182">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269185">return</span>&nbsp;<span class="ident" id="3269192">off2</span><span class="op" id="3269196">,</span>&nbsp;<span class="builtintype" id="3269198">true</span><br>
<span class="lineno"></span><span class="op" id="3269203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3269206">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3269235">func</span>&nbsp;<span class="ident" id="3269240">unpackRR</span><span class="op" id="3269248">(</span><span class="ident" id="3269249">msg</span>&nbsp;<span class="op" id="3269253">[</span><span class="op" id="3269254">]</span><span class="builtintype" id="3269255">byte</span><span class="op" id="3269259">,</span>&nbsp;<span class="ident" id="3269261">off</span>&nbsp;<span class="builtintype" id="3269265">int</span><span class="op" id="3269268">)</span>&nbsp;<span class="op" id="3269270">(</span><span class="ident" id="3269271">rr</span>&nbsp;<span class="ident" id="3269274">dnsRR</span><span class="op" id="3269279">,</span>&nbsp;<span class="ident" id="3269281">off1</span>&nbsp;<span class="builtintype" id="3269286">int</span><span class="op" id="3269289">,</span>&nbsp;<span class="ident" id="3269291">ok</span>&nbsp;<span class="builtintype" id="3269294">bool</span><span class="op" id="3269298">)</span>&nbsp;<span class="op" id="3269300">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3269303">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269362">var</span>&nbsp;<span class="ident" id="3269366">h</span>&nbsp;<span class="ident" id="3269368">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269382">off0</span>&nbsp;<span class="op" id="3269387">:=</span>&nbsp;<span class="ident" id="3269390">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269395">if</span>&nbsp;<span class="ident" id="3269398">off</span><span class="op" id="3269401">,</span>&nbsp;<span class="ident" id="3269403">ok</span>&nbsp;<span class="op" id="3269406">=</span>&nbsp;<span class="ident" id="3269408">unpackStruct</span><span class="op" id="3269420">(</span><span class="op" id="3269421">&amp;</span><span class="ident" id="3269422">h</span><span class="op" id="3269423">,</span>&nbsp;<span class="ident" id="3269425">msg</span><span class="op" id="3269428">,</span>&nbsp;<span class="ident" id="3269430">off</span><span class="op" id="3269433">)</span><span class="op" id="3269434">;</span>&nbsp;<span class="op" id="3269436">!</span><span class="ident" id="3269437">ok</span>&nbsp;<span class="op" id="3269440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269444">return</span>&nbsp;<span class="ident" id="3269451">nil</span><span class="op" id="3269454">,</span>&nbsp;<span class="builtinfunc" id="3269456">len</span><span class="op" id="3269459">(</span><span class="ident" id="3269460">msg</span><span class="op" id="3269463">)</span><span class="op" id="3269464">,</span>&nbsp;<span class="builtintype" id="3269466">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269476">end</span>&nbsp;<span class="op" id="3269480">:=</span>&nbsp;<span class="ident" id="3269483">off</span>&nbsp;<span class="op" id="3269487">+</span>&nbsp;<span class="builtintype" id="3269489">int</span><span class="op" id="3269492">(</span><span class="ident" id="3269493">h</span><span class="op" id="3269494">.</span><span class="ident" id="3269495">Rdlength</span><span class="op" id="3269503">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3269507">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3269550">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269601">mk</span><span class="op" id="3269603">,</span>&nbsp;<span class="ident" id="3269605">known</span>&nbsp;<span class="op" id="3269611">:=</span>&nbsp;<span class="ident" id="3269614">rr_mk</span><span class="op" id="3269619">[</span><span class="builtintype" id="3269620">int</span><span class="op" id="3269623">(</span><span class="ident" id="3269624">h</span><span class="op" id="3269625">.</span><span class="ident" id="3269626">Rrtype</span><span class="op" id="3269632">)</span><span class="op" id="3269633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269636">if</span>&nbsp;<span class="op" id="3269639">!</span><span class="ident" id="3269640">known</span>&nbsp;<span class="op" id="3269646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269650">return</span>&nbsp;<span class="op" id="3269657">&amp;</span><span class="ident" id="3269658">h</span><span class="op" id="3269659">,</span>&nbsp;<span class="ident" id="3269661">end</span><span class="op" id="3269664">,</span>&nbsp;<span class="builtintype" id="3269666">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269675">rr</span>&nbsp;<span class="op" id="3269678">=</span>&nbsp;<span class="ident" id="3269680">mk</span><span class="op" id="3269682">(</span><span class="op" id="3269683">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269686">off</span><span class="op" id="3269689">,</span>&nbsp;<span class="ident" id="3269691">ok</span>&nbsp;<span class="op" id="3269694">=</span>&nbsp;<span class="ident" id="3269696">unpackStruct</span><span class="op" id="3269708">(</span><span class="ident" id="3269709">rr</span><span class="op" id="3269711">,</span>&nbsp;<span class="ident" id="3269713">msg</span><span class="op" id="3269716">,</span>&nbsp;<span class="ident" id="3269718">off0</span><span class="op" id="3269722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269725">if</span>&nbsp;<span class="ident" id="3269728">off</span>&nbsp;<span class="op" id="3269732">!=</span>&nbsp;<span class="ident" id="3269735">end</span>&nbsp;<span class="op" id="3269739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269743">return</span>&nbsp;<span class="op" id="3269750">&amp;</span><span class="ident" id="3269751">h</span><span class="op" id="3269752">,</span>&nbsp;<span class="ident" id="3269754">end</span><span class="op" id="3269757">,</span>&nbsp;<span class="builtintype" id="3269759">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269768">return</span>&nbsp;<span class="ident" id="3269775">rr</span><span class="op" id="3269777">,</span>&nbsp;<span class="ident" id="3269779">off</span><span class="op" id="3269782">,</span>&nbsp;<span class="ident" id="3269784">ok</span><br>
<span class="lineno">710</span><span class="op" id="3269787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3269790">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3269833">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3269879">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3269927">type</span>&nbsp;<span class="ident" id="3269932">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3269942">struct</span>&nbsp;<span class="op" id="3269949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269952">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3269972">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269980">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3270000">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270006">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3270026">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270031">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3270051">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270057">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3270077">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270083">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3270103">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270109">recursion_available</span>&nbsp;<span class="builtintype" id="3270129">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270135">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3270155">int</span><br>
<span class="lineno">725</span><span class="op" id="3270159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3270162">func</span>&nbsp;<span class="op" id="3270167">(</span><span class="ident" id="3270168">h</span>&nbsp;<span class="op" id="3270170">*</span><span class="ident" id="3270171">dnsMsgHdr</span><span class="op" id="3270180">)</span>&nbsp;<span class="ident" id="3270182">Walk</span><span class="op" id="3270186">(</span><span class="ident" id="3270187">f</span>&nbsp;<span class="keyword" id="3270189">func</span><span class="op" id="3270193">(</span><span class="ident" id="3270194">v</span>&nbsp;<span class="keyword" id="3270196">interface</span><span class="op" id="3270205">{</span><span class="op" id="3270206">}</span><span class="op" id="3270207">,</span>&nbsp;<span class="ident" id="3270209">name</span><span class="op" id="3270213">,</span>&nbsp;<span class="ident" id="3270215">tag</span>&nbsp;<span class="builtintype" id="3270219">string</span><span class="op" id="3270225">)</span>&nbsp;<span class="builtintype" id="3270227">bool</span><span class="op" id="3270231">)</span>&nbsp;<span class="builtintype" id="3270233">bool</span>&nbsp;<span class="op" id="3270238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270241">return</span>&nbsp;<span class="ident" id="3270248">f</span><span class="op" id="3270249">(</span><span class="op" id="3270250">&amp;</span><span class="ident" id="3270251">h</span><span class="op" id="3270252">.</span><span class="ident" id="3270253">id</span><span class="op" id="3270255">,</span>&nbsp;<span class="string" id="3270257">&#34;id&#34;</span><span class="op" id="3270261">,</span>&nbsp;<span class="string" id="3270263">&#34;&#34;</span><span class="op" id="3270265">)</span>&nbsp;<span class="op" id="3270267">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270272">f</span><span class="op" id="3270273">(</span><span class="op" id="3270274">&amp;</span><span class="ident" id="3270275">h</span><span class="op" id="3270276">.</span><span class="ident" id="3270277">response</span><span class="op" id="3270285">,</span>&nbsp;<span class="string" id="3270287">&#34;response&#34;</span><span class="op" id="3270297">,</span>&nbsp;<span class="string" id="3270299">&#34;&#34;</span><span class="op" id="3270301">)</span>&nbsp;<span class="op" id="3270303">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270308">f</span><span class="op" id="3270309">(</span><span class="op" id="3270310">&amp;</span><span class="ident" id="3270311">h</span><span class="op" id="3270312">.</span><span class="ident" id="3270313">opcode</span><span class="op" id="3270319">,</span>&nbsp;<span class="string" id="3270321">&#34;opcode&#34;</span><span class="op" id="3270329">,</span>&nbsp;<span class="string" id="3270331">&#34;&#34;</span><span class="op" id="3270333">)</span>&nbsp;<span class="op" id="3270335">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270340">f</span><span class="op" id="3270341">(</span><span class="op" id="3270342">&amp;</span><span class="ident" id="3270343">h</span><span class="op" id="3270344">.</span><span class="ident" id="3270345">authoritative</span><span class="op" id="3270358">,</span>&nbsp;<span class="string" id="3270360">&#34;authoritative&#34;</span><span class="op" id="3270375">,</span>&nbsp;<span class="string" id="3270377">&#34;&#34;</span><span class="op" id="3270379">)</span>&nbsp;<span class="op" id="3270381">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270386">f</span><span class="op" id="3270387">(</span><span class="op" id="3270388">&amp;</span><span class="ident" id="3270389">h</span><span class="op" id="3270390">.</span><span class="ident" id="3270391">truncated</span><span class="op" id="3270400">,</span>&nbsp;<span class="string" id="3270402">&#34;truncated&#34;</span><span class="op" id="3270413">,</span>&nbsp;<span class="string" id="3270415">&#34;&#34;</span><span class="op" id="3270417">)</span>&nbsp;<span class="op" id="3270419">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270424">f</span><span class="op" id="3270425">(</span><span class="op" id="3270426">&amp;</span><span class="ident" id="3270427">h</span><span class="op" id="3270428">.</span><span class="ident" id="3270429">recursion_desired</span><span class="op" id="3270446">,</span>&nbsp;<span class="string" id="3270448">&#34;recursion_desired&#34;</span><span class="op" id="3270467">,</span>&nbsp;<span class="string" id="3270469">&#34;&#34;</span><span class="op" id="3270471">)</span>&nbsp;<span class="op" id="3270473">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270478">f</span><span class="op" id="3270479">(</span><span class="op" id="3270480">&amp;</span><span class="ident" id="3270481">h</span><span class="op" id="3270482">.</span><span class="ident" id="3270483">recursion_available</span><span class="op" id="3270502">,</span>&nbsp;<span class="string" id="3270504">&#34;recursion_available&#34;</span><span class="op" id="3270525">,</span>&nbsp;<span class="string" id="3270527">&#34;&#34;</span><span class="op" id="3270529">)</span>&nbsp;<span class="op" id="3270531">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270536">f</span><span class="op" id="3270537">(</span><span class="op" id="3270538">&amp;</span><span class="ident" id="3270539">h</span><span class="op" id="3270540">.</span><span class="ident" id="3270541">rcode</span><span class="op" id="3270546">,</span>&nbsp;<span class="string" id="3270548">&#34;rcode&#34;</span><span class="op" id="3270555">,</span>&nbsp;<span class="string" id="3270557">&#34;&#34;</span><span class="op" id="3270559">)</span><br>
<span class="lineno"></span><span class="op" id="3270561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3270564">type</span>&nbsp;<span class="ident" id="3270569">dnsMsg</span>&nbsp;<span class="keyword" id="3270576">struct</span>&nbsp;<span class="op" id="3270583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270586">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270597">question</span>&nbsp;<span class="op" id="3270606">[</span><span class="op" id="3270607">]</span><span class="ident" id="3270608">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270621">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3270630">[</span><span class="op" id="3270631">]</span><span class="ident" id="3270632">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270639">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270648">[</span><span class="op" id="3270649">]</span><span class="ident" id="3270650">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270657">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270666">[</span><span class="op" id="3270667">]</span><span class="ident" id="3270668">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3270674">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3270677">func</span>&nbsp;<span class="op" id="3270682">(</span><span class="ident" id="3270683">dns</span>&nbsp;<span class="op" id="3270687">*</span><span class="ident" id="3270688">dnsMsg</span><span class="op" id="3270694">)</span>&nbsp;<span class="ident" id="3270696">Pack</span><span class="op" id="3270700">(</span><span class="op" id="3270701">)</span>&nbsp;<span class="op" id="3270703">(</span><span class="ident" id="3270704">msg</span>&nbsp;<span class="op" id="3270708">[</span><span class="op" id="3270709">]</span><span class="builtintype" id="3270710">byte</span><span class="op" id="3270714">,</span>&nbsp;<span class="ident" id="3270716">ok</span>&nbsp;<span class="builtintype" id="3270719">bool</span><span class="op" id="3270723">)</span>&nbsp;<span class="op" id="3270725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270728">var</span>&nbsp;<span class="ident" id="3270732">dh</span>&nbsp;<span class="ident" id="3270735">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3270747">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270803">dh</span><span class="op" id="3270805">.</span><span class="ident" id="3270806">Id</span>&nbsp;<span class="op" id="3270809">=</span>&nbsp;<span class="ident" id="3270811">dns</span><span class="op" id="3270814">.</span><span class="ident" id="3270815">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270819">dh</span><span class="op" id="3270821">.</span><span class="ident" id="3270822">Bits</span>&nbsp;<span class="op" id="3270827">=</span>&nbsp;<span class="builtintype" id="3270829">uint16</span><span class="op" id="3270835">(</span><span class="ident" id="3270836">dns</span><span class="op" id="3270839">.</span><span class="ident" id="3270840">opcode</span><span class="op" id="3270846">)</span><span class="op" id="3270847">&lt;&lt;</span><span class="num" id="3270849">11</span>&nbsp;<span class="op" id="3270852">|</span>&nbsp;<span class="builtintype" id="3270854">uint16</span><span class="op" id="3270860">(</span><span class="ident" id="3270861">dns</span><span class="op" id="3270864">.</span><span class="ident" id="3270865">rcode</span><span class="op" id="3270870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270873">if</span>&nbsp;<span class="ident" id="3270876">dns</span><span class="op" id="3270879">.</span><span class="ident" id="3270880">recursion_available</span>&nbsp;<span class="op" id="3270900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270904">dh</span><span class="op" id="3270906">.</span><span class="ident" id="3270907">Bits</span>&nbsp;<span class="op" id="3270912">|=</span>&nbsp;<span class="ident" id="3270915">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270920">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270923">if</span>&nbsp;<span class="ident" id="3270926">dns</span><span class="op" id="3270929">.</span><span class="ident" id="3270930">recursion_desired</span>&nbsp;<span class="op" id="3270948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270952">dh</span><span class="op" id="3270954">.</span><span class="ident" id="3270955">Bits</span>&nbsp;<span class="op" id="3270960">|=</span>&nbsp;<span class="ident" id="3270963">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270971">if</span>&nbsp;<span class="ident" id="3270974">dns</span><span class="op" id="3270977">.</span><span class="ident" id="3270978">truncated</span>&nbsp;<span class="op" id="3270988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270992">dh</span><span class="op" id="3270994">.</span><span class="ident" id="3270995">Bits</span>&nbsp;<span class="op" id="3271000">|=</span>&nbsp;<span class="ident" id="3271003">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271011">if</span>&nbsp;<span class="ident" id="3271014">dns</span><span class="op" id="3271017">.</span><span class="ident" id="3271018">authoritative</span>&nbsp;<span class="op" id="3271032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271036">dh</span><span class="op" id="3271038">.</span><span class="ident" id="3271039">Bits</span>&nbsp;<span class="op" id="3271044">|=</span>&nbsp;<span class="ident" id="3271047">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271055">if</span>&nbsp;<span class="ident" id="3271058">dns</span><span class="op" id="3271061">.</span><span class="ident" id="3271062">response</span>&nbsp;<span class="op" id="3271071">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271075">dh</span><span class="op" id="3271077">.</span><span class="ident" id="3271078">Bits</span>&nbsp;<span class="op" id="3271083">|=</span>&nbsp;<span class="ident" id="3271086">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3271095">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271130">question</span>&nbsp;<span class="op" id="3271139">:=</span>&nbsp;<span class="ident" id="3271142">dns</span><span class="op" id="3271145">.</span><span class="ident" id="3271146">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271156">answer</span>&nbsp;<span class="op" id="3271163">:=</span>&nbsp;<span class="ident" id="3271166">dns</span><span class="op" id="3271169">.</span><span class="ident" id="3271170">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271178">ns</span>&nbsp;<span class="op" id="3271181">:=</span>&nbsp;<span class="ident" id="3271184">dns</span><span class="op" id="3271187">.</span><span class="ident" id="3271188">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271192">extra</span>&nbsp;<span class="op" id="3271198">:=</span>&nbsp;<span class="ident" id="3271201">dns</span><span class="op" id="3271204">.</span><span class="ident" id="3271205">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271213">dh</span><span class="op" id="3271215">.</span><span class="ident" id="3271216">Qdcount</span>&nbsp;<span class="op" id="3271224">=</span>&nbsp;<span class="builtintype" id="3271226">uint16</span><span class="op" id="3271232">(</span><span class="builtinfunc" id="3271233">len</span><span class="op" id="3271236">(</span><span class="ident" id="3271237">question</span><span class="op" id="3271245">)</span><span class="op" id="3271246">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271249">dh</span><span class="op" id="3271251">.</span><span class="ident" id="3271252">Ancount</span>&nbsp;<span class="op" id="3271260">=</span>&nbsp;<span class="builtintype" id="3271262">uint16</span><span class="op" id="3271268">(</span><span class="builtinfunc" id="3271269">len</span><span class="op" id="3271272">(</span><span class="ident" id="3271273">answer</span><span class="op" id="3271279">)</span><span class="op" id="3271280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271283">dh</span><span class="op" id="3271285">.</span><span class="ident" id="3271286">Nscount</span>&nbsp;<span class="op" id="3271294">=</span>&nbsp;<span class="builtintype" id="3271296">uint16</span><span class="op" id="3271302">(</span><span class="builtinfunc" id="3271303">len</span><span class="op" id="3271306">(</span><span class="ident" id="3271307">ns</span><span class="op" id="3271309">)</span><span class="op" id="3271310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271313">dh</span><span class="op" id="3271315">.</span><span class="ident" id="3271316">Arcount</span>&nbsp;<span class="op" id="3271324">=</span>&nbsp;<span class="builtintype" id="3271326">uint16</span><span class="op" id="3271332">(</span><span class="builtinfunc" id="3271333">len</span><span class="op" id="3271336">(</span><span class="ident" id="3271337">extra</span><span class="op" id="3271342">)</span><span class="op" id="3271343">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3271347">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3271396">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3271442">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271480">msg</span>&nbsp;<span class="op" id="3271484">=</span>&nbsp;<span class="builtinfunc" id="3271486">make</span><span class="op" id="3271490">(</span><span class="op" id="3271491">[</span><span class="op" id="3271492">]</span><span class="builtintype" id="3271493">byte</span><span class="op" id="3271497">,</span>&nbsp;<span class="num" id="3271499">2000</span><span class="op" id="3271503">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3271507">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271551">off</span>&nbsp;<span class="op" id="3271555">:=</span>&nbsp;<span class="num" id="3271558">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271561">off</span><span class="op" id="3271564">,</span>&nbsp;<span class="ident" id="3271566">ok</span>&nbsp;<span class="op" id="3271569">=</span>&nbsp;<span class="ident" id="3271571">packStruct</span><span class="op" id="3271581">(</span><span class="op" id="3271582">&amp;</span><span class="ident" id="3271583">dh</span><span class="op" id="3271585">,</span>&nbsp;<span class="ident" id="3271587">msg</span><span class="op" id="3271590">,</span>&nbsp;<span class="ident" id="3271592">off</span><span class="op" id="3271595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271598">for</span>&nbsp;<span class="ident" id="3271602">i</span>&nbsp;<span class="op" id="3271604">:=</span>&nbsp;<span class="num" id="3271607">0</span><span class="op" id="3271608">;</span>&nbsp;<span class="ident" id="3271610">i</span>&nbsp;<span class="op" id="3271612">&lt;</span>&nbsp;<span class="builtinfunc" id="3271614">len</span><span class="op" id="3271617">(</span><span class="ident" id="3271618">question</span><span class="op" id="3271626">)</span><span class="op" id="3271627">;</span>&nbsp;<span class="ident" id="3271629">i</span><span class="op" id="3271630">++</span>&nbsp;<span class="op" id="3271633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271637">off</span><span class="op" id="3271640">,</span>&nbsp;<span class="ident" id="3271642">ok</span>&nbsp;<span class="op" id="3271645">=</span>&nbsp;<span class="ident" id="3271647">packStruct</span><span class="op" id="3271657">(</span><span class="op" id="3271658">&amp;</span><span class="ident" id="3271659">question</span><span class="op" id="3271667">[</span><span class="ident" id="3271668">i</span><span class="op" id="3271669">]</span><span class="op" id="3271670">,</span>&nbsp;<span class="ident" id="3271672">msg</span><span class="op" id="3271675">,</span>&nbsp;<span class="ident" id="3271677">off</span><span class="op" id="3271680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271683">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271686">for</span>&nbsp;<span class="ident" id="3271690">i</span>&nbsp;<span class="op" id="3271692">:=</span>&nbsp;<span class="num" id="3271695">0</span><span class="op" id="3271696">;</span>&nbsp;<span class="ident" id="3271698">i</span>&nbsp;<span class="op" id="3271700">&lt;</span>&nbsp;<span class="builtinfunc" id="3271702">len</span><span class="op" id="3271705">(</span><span class="ident" id="3271706">answer</span><span class="op" id="3271712">)</span><span class="op" id="3271713">;</span>&nbsp;<span class="ident" id="3271715">i</span><span class="op" id="3271716">++</span>&nbsp;<span class="op" id="3271719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271723">off</span><span class="op" id="3271726">,</span>&nbsp;<span class="ident" id="3271728">ok</span>&nbsp;<span class="op" id="3271731">=</span>&nbsp;<span class="ident" id="3271733">packRR</span><span class="op" id="3271739">(</span><span class="ident" id="3271740">answer</span><span class="op" id="3271746">[</span><span class="ident" id="3271747">i</span><span class="op" id="3271748">]</span><span class="op" id="3271749">,</span>&nbsp;<span class="ident" id="3271751">msg</span><span class="op" id="3271754">,</span>&nbsp;<span class="ident" id="3271756">off</span><span class="op" id="3271759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271765">for</span>&nbsp;<span class="ident" id="3271769">i</span>&nbsp;<span class="op" id="3271771">:=</span>&nbsp;<span class="num" id="3271774">0</span><span class="op" id="3271775">;</span>&nbsp;<span class="ident" id="3271777">i</span>&nbsp;<span class="op" id="3271779">&lt;</span>&nbsp;<span class="builtinfunc" id="3271781">len</span><span class="op" id="3271784">(</span><span class="ident" id="3271785">ns</span><span class="op" id="3271787">)</span><span class="op" id="3271788">;</span>&nbsp;<span class="ident" id="3271790">i</span><span class="op" id="3271791">++</span>&nbsp;<span class="op" id="3271794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271798">off</span><span class="op" id="3271801">,</span>&nbsp;<span class="ident" id="3271803">ok</span>&nbsp;<span class="op" id="3271806">=</span>&nbsp;<span class="ident" id="3271808">packRR</span><span class="op" id="3271814">(</span><span class="ident" id="3271815">ns</span><span class="op" id="3271817">[</span><span class="ident" id="3271818">i</span><span class="op" id="3271819">]</span><span class="op" id="3271820">,</span>&nbsp;<span class="ident" id="3271822">msg</span><span class="op" id="3271825">,</span>&nbsp;<span class="ident" id="3271827">off</span><span class="op" id="3271830">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271836">for</span>&nbsp;<span class="ident" id="3271840">i</span>&nbsp;<span class="op" id="3271842">:=</span>&nbsp;<span class="num" id="3271845">0</span><span class="op" id="3271846">;</span>&nbsp;<span class="ident" id="3271848">i</span>&nbsp;<span class="op" id="3271850">&lt;</span>&nbsp;<span class="builtinfunc" id="3271852">len</span><span class="op" id="3271855">(</span><span class="ident" id="3271856">extra</span><span class="op" id="3271861">)</span><span class="op" id="3271862">;</span>&nbsp;<span class="ident" id="3271864">i</span><span class="op" id="3271865">++</span>&nbsp;<span class="op" id="3271868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271872">off</span><span class="op" id="3271875">,</span>&nbsp;<span class="ident" id="3271877">ok</span>&nbsp;<span class="op" id="3271880">=</span>&nbsp;<span class="ident" id="3271882">packRR</span><span class="op" id="3271888">(</span><span class="ident" id="3271889">extra</span><span class="op" id="3271894">[</span><span class="ident" id="3271895">i</span><span class="op" id="3271896">]</span><span class="op" id="3271897">,</span>&nbsp;<span class="ident" id="3271899">msg</span><span class="op" id="3271902">,</span>&nbsp;<span class="ident" id="3271904">off</span><span class="op" id="3271907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271913">if</span>&nbsp;<span class="op" id="3271916">!</span><span class="ident" id="3271917">ok</span>&nbsp;<span class="op" id="3271920">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271924">return</span>&nbsp;<span class="ident" id="3271931">nil</span><span class="op" id="3271934">,</span>&nbsp;<span class="builtintype" id="3271936">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271946">return</span>&nbsp;<span class="ident" id="3271953">msg</span><span class="op" id="3271956">[</span><span class="num" id="3271957">0</span><span class="op" id="3271958">:</span><span class="ident" id="3271959">off</span><span class="op" id="3271962">]</span><span class="op" id="3271963">,</span>&nbsp;<span class="builtintype" id="3271965">true</span><br>
<span class="lineno"></span><span class="op" id="3271970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3271973">func</span>&nbsp;<span class="op" id="3271978">(</span><span class="ident" id="3271979">dns</span>&nbsp;<span class="op" id="3271983">*</span><span class="ident" id="3271984">dnsMsg</span><span class="op" id="3271990">)</span>&nbsp;<span class="ident" id="3271992">Unpack</span><span class="op" id="3271998">(</span><span class="ident" id="3271999">msg</span>&nbsp;<span class="op" id="3272003">[</span><span class="op" id="3272004">]</span><span class="builtintype" id="3272005">byte</span><span class="op" id="3272009">)</span>&nbsp;<span class="builtintype" id="3272011">bool</span>&nbsp;<span class="op" id="3272016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3272019">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272031">var</span>&nbsp;<span class="ident" id="3272035">dh</span>&nbsp;<span class="ident" id="3272038">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272049">off</span>&nbsp;<span class="op" id="3272053">:=</span>&nbsp;<span class="num" id="3272056">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272059">var</span>&nbsp;<span class="ident" id="3272063">ok</span>&nbsp;<span class="builtintype" id="3272066">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272072">if</span>&nbsp;<span class="ident" id="3272075">off</span><span class="op" id="3272078">,</span>&nbsp;<span class="ident" id="3272080">ok</span>&nbsp;<span class="op" id="3272083">=</span>&nbsp;<span class="ident" id="3272085">unpackStruct</span><span class="op" id="3272097">(</span><span class="op" id="3272098">&amp;</span><span class="ident" id="3272099">dh</span><span class="op" id="3272101">,</span>&nbsp;<span class="ident" id="3272103">msg</span><span class="op" id="3272106">,</span>&nbsp;<span class="ident" id="3272108">off</span><span class="op" id="3272111">)</span><span class="op" id="3272112">;</span>&nbsp;<span class="op" id="3272114">!</span><span class="ident" id="3272115">ok</span>&nbsp;<span class="op" id="3272118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272122">return</span>&nbsp;<span class="builtintype" id="3272129">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272139">dns</span><span class="op" id="3272142">.</span><span class="ident" id="3272143">id</span>&nbsp;<span class="op" id="3272146">=</span>&nbsp;<span class="ident" id="3272148">dh</span><span class="op" id="3272150">.</span><span class="ident" id="3272151">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272155">dns</span><span class="op" id="3272158">.</span><span class="ident" id="3272159">response</span>&nbsp;<span class="op" id="3272168">=</span>&nbsp;<span class="op" id="3272170">(</span><span class="ident" id="3272171">dh</span><span class="op" id="3272173">.</span><span class="ident" id="3272174">Bits</span>&nbsp;<span class="op" id="3272179">&amp;</span>&nbsp;<span class="ident" id="3272181">_QR</span><span class="op" id="3272184">)</span>&nbsp;<span class="op" id="3272186">!=</span>&nbsp;<span class="num" id="3272189">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272192">dns</span><span class="op" id="3272195">.</span><span class="ident" id="3272196">opcode</span>&nbsp;<span class="op" id="3272203">=</span>&nbsp;<span class="builtintype" id="3272205">int</span><span class="op" id="3272208">(</span><span class="ident" id="3272209">dh</span><span class="op" id="3272211">.</span><span class="ident" id="3272212">Bits</span><span class="op" id="3272216">&gt;&gt;</span><span class="num" id="3272218">11</span><span class="op" id="3272220">)</span>&nbsp;<span class="op" id="3272222">&amp;</span>&nbsp;<span class="num" id="3272224">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272229">dns</span><span class="op" id="3272232">.</span><span class="ident" id="3272233">authoritative</span>&nbsp;<span class="op" id="3272247">=</span>&nbsp;<span class="op" id="3272249">(</span><span class="ident" id="3272250">dh</span><span class="op" id="3272252">.</span><span class="ident" id="3272253">Bits</span>&nbsp;<span class="op" id="3272258">&amp;</span>&nbsp;<span class="ident" id="3272260">_AA</span><span class="op" id="3272263">)</span>&nbsp;<span class="op" id="3272265">!=</span>&nbsp;<span class="num" id="3272268">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272271">dns</span><span class="op" id="3272274">.</span><span class="ident" id="3272275">truncated</span>&nbsp;<span class="op" id="3272285">=</span>&nbsp;<span class="op" id="3272287">(</span><span class="ident" id="3272288">dh</span><span class="op" id="3272290">.</span><span class="ident" id="3272291">Bits</span>&nbsp;<span class="op" id="3272296">&amp;</span>&nbsp;<span class="ident" id="3272298">_TC</span><span class="op" id="3272301">)</span>&nbsp;<span class="op" id="3272303">!=</span>&nbsp;<span class="num" id="3272306">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272309">dns</span><span class="op" id="3272312">.</span><span class="ident" id="3272313">recursion_desired</span>&nbsp;<span class="op" id="3272331">=</span>&nbsp;<span class="op" id="3272333">(</span><span class="ident" id="3272334">dh</span><span class="op" id="3272336">.</span><span class="ident" id="3272337">Bits</span>&nbsp;<span class="op" id="3272342">&amp;</span>&nbsp;<span class="ident" id="3272344">_RD</span><span class="op" id="3272347">)</span>&nbsp;<span class="op" id="3272349">!=</span>&nbsp;<span class="num" id="3272352">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272355">dns</span><span class="op" id="3272358">.</span><span class="ident" id="3272359">recursion_available</span>&nbsp;<span class="op" id="3272379">=</span>&nbsp;<span class="op" id="3272381">(</span><span class="ident" id="3272382">dh</span><span class="op" id="3272384">.</span><span class="ident" id="3272385">Bits</span>&nbsp;<span class="op" id="3272390">&amp;</span>&nbsp;<span class="ident" id="3272392">_RA</span><span class="op" id="3272395">)</span>&nbsp;<span class="op" id="3272397">!=</span>&nbsp;<span class="num" id="3272400">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272403">dns</span><span class="op" id="3272406">.</span><span class="ident" id="3272407">rcode</span>&nbsp;<span class="op" id="3272413">=</span>&nbsp;<span class="builtintype" id="3272415">int</span><span class="op" id="3272418">(</span><span class="ident" id="3272419">dh</span><span class="op" id="3272421">.</span><span class="ident" id="3272422">Bits</span>&nbsp;<span class="op" id="3272427">&amp;</span>&nbsp;<span class="num" id="3272429">0xF</span><span class="op" id="3272432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3272436">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272448">dns</span><span class="op" id="3272451">.</span><span class="ident" id="3272452">question</span>&nbsp;<span class="op" id="3272461">=</span>&nbsp;<span class="builtinfunc" id="3272463">make</span><span class="op" id="3272467">(</span><span class="op" id="3272468">[</span><span class="op" id="3272469">]</span><span class="ident" id="3272470">dnsQuestion</span><span class="op" id="3272481">,</span>&nbsp;<span class="ident" id="3272483">dh</span><span class="op" id="3272485">.</span><span class="ident" id="3272486">Qdcount</span><span class="op" id="3272493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272496">dns</span><span class="op" id="3272499">.</span><span class="ident" id="3272500">answer</span>&nbsp;<span class="op" id="3272507">=</span>&nbsp;<span class="builtinfunc" id="3272509">make</span><span class="op" id="3272513">(</span><span class="op" id="3272514">[</span><span class="op" id="3272515">]</span><span class="ident" id="3272516">dnsRR</span><span class="op" id="3272521">,</span>&nbsp;<span class="num" id="3272523">0</span><span class="op" id="3272524">,</span>&nbsp;<span class="ident" id="3272526">dh</span><span class="op" id="3272528">.</span><span class="ident" id="3272529">Ancount</span><span class="op" id="3272536">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272539">dns</span><span class="op" id="3272542">.</span><span class="ident" id="3272543">ns</span>&nbsp;<span class="op" id="3272546">=</span>&nbsp;<span class="builtinfunc" id="3272548">make</span><span class="op" id="3272552">(</span><span class="op" id="3272553">[</span><span class="op" id="3272554">]</span><span class="ident" id="3272555">dnsRR</span><span class="op" id="3272560">,</span>&nbsp;<span class="num" id="3272562">0</span><span class="op" id="3272563">,</span>&nbsp;<span class="ident" id="3272565">dh</span><span class="op" id="3272567">.</span><span class="ident" id="3272568">Nscount</span><span class="op" id="3272575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272578">dns</span><span class="op" id="3272581">.</span><span class="ident" id="3272582">extra</span>&nbsp;<span class="op" id="3272588">=</span>&nbsp;<span class="builtinfunc" id="3272590">make</span><span class="op" id="3272594">(</span><span class="op" id="3272595">[</span><span class="op" id="3272596">]</span><span class="ident" id="3272597">dnsRR</span><span class="op" id="3272602">,</span>&nbsp;<span class="num" id="3272604">0</span><span class="op" id="3272605">,</span>&nbsp;<span class="ident" id="3272607">dh</span><span class="op" id="3272609">.</span><span class="ident" id="3272610">Arcount</span><span class="op" id="3272617">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272621">var</span>&nbsp;<span class="ident" id="3272625">rec</span>&nbsp;<span class="ident" id="3272629">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272637">for</span>&nbsp;<span class="ident" id="3272641">i</span>&nbsp;<span class="op" id="3272643">:=</span>&nbsp;<span class="num" id="3272646">0</span><span class="op" id="3272647">;</span>&nbsp;<span class="ident" id="3272649">i</span>&nbsp;<span class="op" id="3272651">&lt;</span>&nbsp;<span class="builtinfunc" id="3272653">len</span><span class="op" id="3272656">(</span><span class="ident" id="3272657">dns</span><span class="op" id="3272660">.</span><span class="ident" id="3272661">question</span><span class="op" id="3272669">)</span><span class="op" id="3272670">;</span>&nbsp;<span class="ident" id="3272672">i</span><span class="op" id="3272673">++</span>&nbsp;<span class="op" id="3272676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272680">off</span><span class="op" id="3272683">,</span>&nbsp;<span class="ident" id="3272685">ok</span>&nbsp;<span class="op" id="3272688">=</span>&nbsp;<span class="ident" id="3272690">unpackStruct</span><span class="op" id="3272702">(</span><span class="op" id="3272703">&amp;</span><span class="ident" id="3272704">dns</span><span class="op" id="3272707">.</span><span class="ident" id="3272708">question</span><span class="op" id="3272716">[</span><span class="ident" id="3272717">i</span><span class="op" id="3272718">]</span><span class="op" id="3272719">,</span>&nbsp;<span class="ident" id="3272721">msg</span><span class="op" id="3272724">,</span>&nbsp;<span class="ident" id="3272726">off</span><span class="op" id="3272729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272735">for</span>&nbsp;<span class="ident" id="3272739">i</span>&nbsp;<span class="op" id="3272741">:=</span>&nbsp;<span class="num" id="3272744">0</span><span class="op" id="3272745">;</span>&nbsp;<span class="ident" id="3272747">i</span>&nbsp;<span class="op" id="3272749">&lt;</span>&nbsp;<span class="builtintype" id="3272751">int</span><span class="op" id="3272754">(</span><span class="ident" id="3272755">dh</span><span class="op" id="3272757">.</span><span class="ident" id="3272758">Ancount</span><span class="op" id="3272765">)</span><span class="op" id="3272766">;</span>&nbsp;<span class="ident" id="3272768">i</span><span class="op" id="3272769">++</span>&nbsp;<span class="op" id="3272772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272776">rec</span><span class="op" id="3272779">,</span>&nbsp;<span class="ident" id="3272781">off</span><span class="op" id="3272784">,</span>&nbsp;<span class="ident" id="3272786">ok</span>&nbsp;<span class="op" id="3272789">=</span>&nbsp;<span class="ident" id="3272791">unpackRR</span><span class="op" id="3272799">(</span><span class="ident" id="3272800">msg</span><span class="op" id="3272803">,</span>&nbsp;<span class="ident" id="3272805">off</span><span class="op" id="3272808">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272812">if</span>&nbsp;<span class="op" id="3272815">!</span><span class="ident" id="3272816">ok</span>&nbsp;<span class="op" id="3272819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272824">return</span>&nbsp;<span class="builtintype" id="3272831">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272843">dns</span><span class="op" id="3272846">.</span><span class="ident" id="3272847">answer</span>&nbsp;<span class="op" id="3272854">=</span>&nbsp;<span class="builtinfunc" id="3272856">append</span><span class="op" id="3272862">(</span><span class="ident" id="3272863">dns</span><span class="op" id="3272866">.</span><span class="ident" id="3272867">answer</span><span class="op" id="3272873">,</span>&nbsp;<span class="ident" id="3272875">rec</span><span class="op" id="3272878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272881">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272884">for</span>&nbsp;<span class="ident" id="3272888">i</span>&nbsp;<span class="op" id="3272890">:=</span>&nbsp;<span class="num" id="3272893">0</span><span class="op" id="3272894">;</span>&nbsp;<span class="ident" id="3272896">i</span>&nbsp;<span class="op" id="3272898">&lt;</span>&nbsp;<span class="builtintype" id="3272900">int</span><span class="op" id="3272903">(</span><span class="ident" id="3272904">dh</span><span class="op" id="3272906">.</span><span class="ident" id="3272907">Nscount</span><span class="op" id="3272914">)</span><span class="op" id="3272915">;</span>&nbsp;<span class="ident" id="3272917">i</span><span class="op" id="3272918">++</span>&nbsp;<span class="op" id="3272921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272925">rec</span><span class="op" id="3272928">,</span>&nbsp;<span class="ident" id="3272930">off</span><span class="op" id="3272933">,</span>&nbsp;<span class="ident" id="3272935">ok</span>&nbsp;<span class="op" id="3272938">=</span>&nbsp;<span class="ident" id="3272940">unpackRR</span><span class="op" id="3272948">(</span><span class="ident" id="3272949">msg</span><span class="op" id="3272952">,</span>&nbsp;<span class="ident" id="3272954">off</span><span class="op" id="3272957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272961">if</span>&nbsp;<span class="op" id="3272964">!</span><span class="ident" id="3272965">ok</span>&nbsp;<span class="op" id="3272968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272973">return</span>&nbsp;<span class="builtintype" id="3272980">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272988">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272992">dns</span><span class="op" id="3272995">.</span><span class="ident" id="3272996">ns</span>&nbsp;<span class="op" id="3272999">=</span>&nbsp;<span class="builtinfunc" id="3273001">append</span><span class="op" id="3273007">(</span><span class="ident" id="3273008">dns</span><span class="op" id="3273011">.</span><span class="ident" id="3273012">ns</span><span class="op" id="3273014">,</span>&nbsp;<span class="ident" id="3273016">rec</span><span class="op" id="3273019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273025">for</span>&nbsp;<span class="ident" id="3273029">i</span>&nbsp;<span class="op" id="3273031">:=</span>&nbsp;<span class="num" id="3273034">0</span><span class="op" id="3273035">;</span>&nbsp;<span class="ident" id="3273037">i</span>&nbsp;<span class="op" id="3273039">&lt;</span>&nbsp;<span class="builtintype" id="3273041">int</span><span class="op" id="3273044">(</span><span class="ident" id="3273045">dh</span><span class="op" id="3273047">.</span><span class="ident" id="3273048">Arcount</span><span class="op" id="3273055">)</span><span class="op" id="3273056">;</span>&nbsp;<span class="ident" id="3273058">i</span><span class="op" id="3273059">++</span>&nbsp;<span class="op" id="3273062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273066">rec</span><span class="op" id="3273069">,</span>&nbsp;<span class="ident" id="3273071">off</span><span class="op" id="3273074">,</span>&nbsp;<span class="ident" id="3273076">ok</span>&nbsp;<span class="op" id="3273079">=</span>&nbsp;<span class="ident" id="3273081">unpackRR</span><span class="op" id="3273089">(</span><span class="ident" id="3273090">msg</span><span class="op" id="3273093">,</span>&nbsp;<span class="ident" id="3273095">off</span><span class="op" id="3273098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273102">if</span>&nbsp;<span class="op" id="3273105">!</span><span class="ident" id="3273106">ok</span>&nbsp;<span class="op" id="3273109">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273114">return</span>&nbsp;<span class="builtintype" id="3273121">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273133">dns</span><span class="op" id="3273136">.</span><span class="ident" id="3273137">extra</span>&nbsp;<span class="op" id="3273143">=</span>&nbsp;<span class="builtinfunc" id="3273145">append</span><span class="op" id="3273151">(</span><span class="ident" id="3273152">dns</span><span class="op" id="3273155">.</span><span class="ident" id="3273156">extra</span><span class="op" id="3273161">,</span>&nbsp;<span class="ident" id="3273163">rec</span><span class="op" id="3273166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273172">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273197">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273260">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273266">return</span>&nbsp;<span class="builtintype" id="3273273">true</span><br>
<span class="lineno"></span><span class="op" id="3273278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3273281">func</span>&nbsp;<span class="op" id="3273286">(</span><span class="ident" id="3273287">dns</span>&nbsp;<span class="op" id="3273291">*</span><span class="ident" id="3273292">dnsMsg</span><span class="op" id="3273298">)</span>&nbsp;<span class="ident" id="3273300">String</span><span class="op" id="3273306">(</span><span class="op" id="3273307">)</span>&nbsp;<span class="builtintype" id="3273309">string</span>&nbsp;<span class="op" id="3273316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273319">s</span>&nbsp;<span class="op" id="3273321">:=</span>&nbsp;<span class="string" id="3273324">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3273332">+</span>&nbsp;<span class="ident" id="3273334">printStruct</span><span class="op" id="3273345">(</span><span class="op" id="3273346">&amp;</span><span class="ident" id="3273347">dns</span><span class="op" id="3273350">.</span><span class="ident" id="3273351">dnsMsgHdr</span><span class="op" id="3273360">)</span>&nbsp;<span class="op" id="3273362">+</span>&nbsp;<span class="string" id="3273364">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273370">if</span>&nbsp;<span class="builtinfunc" id="3273373">len</span><span class="op" id="3273376">(</span><span class="ident" id="3273377">dns</span><span class="op" id="3273380">.</span><span class="ident" id="3273381">question</span><span class="op" id="3273389">)</span>&nbsp;<span class="op" id="3273391">&gt;</span>&nbsp;<span class="num" id="3273393">0</span>&nbsp;<span class="op" id="3273395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273399">s</span>&nbsp;<span class="op" id="3273401">+=</span>&nbsp;<span class="string" id="3273404">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273423">for</span>&nbsp;<span class="ident" id="3273427">i</span>&nbsp;<span class="op" id="3273429">:=</span>&nbsp;<span class="num" id="3273432">0</span><span class="op" id="3273433">;</span>&nbsp;<span class="ident" id="3273435">i</span>&nbsp;<span class="op" id="3273437">&lt;</span>&nbsp;<span class="builtinfunc" id="3273439">len</span><span class="op" id="3273442">(</span><span class="ident" id="3273443">dns</span><span class="op" id="3273446">.</span><span class="ident" id="3273447">question</span><span class="op" id="3273455">)</span><span class="op" id="3273456">;</span>&nbsp;<span class="ident" id="3273458">i</span><span class="op" id="3273459">++</span>&nbsp;<span class="op" id="3273462">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273467">s</span>&nbsp;<span class="op" id="3273469">+=</span>&nbsp;<span class="ident" id="3273472">printStruct</span><span class="op" id="3273483">(</span><span class="op" id="3273484">&amp;</span><span class="ident" id="3273485">dns</span><span class="op" id="3273488">.</span><span class="ident" id="3273489">question</span><span class="op" id="3273497">[</span><span class="ident" id="3273498">i</span><span class="op" id="3273499">]</span><span class="op" id="3273500">)</span>&nbsp;<span class="op" id="3273502">+</span>&nbsp;<span class="string" id="3273504">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273517">if</span>&nbsp;<span class="builtinfunc" id="3273520">len</span><span class="op" id="3273523">(</span><span class="ident" id="3273524">dns</span><span class="op" id="3273527">.</span><span class="ident" id="3273528">answer</span><span class="op" id="3273534">)</span>&nbsp;<span class="op" id="3273536">&gt;</span>&nbsp;<span class="num" id="3273538">0</span>&nbsp;<span class="op" id="3273540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273544">s</span>&nbsp;<span class="op" id="3273546">+=</span>&nbsp;<span class="string" id="3273549">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273566">for</span>&nbsp;<span class="ident" id="3273570">i</span>&nbsp;<span class="op" id="3273572">:=</span>&nbsp;<span class="num" id="3273575">0</span><span class="op" id="3273576">;</span>&nbsp;<span class="ident" id="3273578">i</span>&nbsp;<span class="op" id="3273580">&lt;</span>&nbsp;<span class="builtinfunc" id="3273582">len</span><span class="op" id="3273585">(</span><span class="ident" id="3273586">dns</span><span class="op" id="3273589">.</span><span class="ident" id="3273590">answer</span><span class="op" id="3273596">)</span><span class="op" id="3273597">;</span>&nbsp;<span class="ident" id="3273599">i</span><span class="op" id="3273600">++</span>&nbsp;<span class="op" id="3273603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273608">s</span>&nbsp;<span class="op" id="3273610">+=</span>&nbsp;<span class="ident" id="3273613">printStruct</span><span class="op" id="3273624">(</span><span class="ident" id="3273625">dns</span><span class="op" id="3273628">.</span><span class="ident" id="3273629">answer</span><span class="op" id="3273635">[</span><span class="ident" id="3273636">i</span><span class="op" id="3273637">]</span><span class="op" id="3273638">)</span>&nbsp;<span class="op" id="3273640">+</span>&nbsp;<span class="string" id="3273642">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273655">if</span>&nbsp;<span class="builtinfunc" id="3273658">len</span><span class="op" id="3273661">(</span><span class="ident" id="3273662">dns</span><span class="op" id="3273665">.</span><span class="ident" id="3273666">ns</span><span class="op" id="3273668">)</span>&nbsp;<span class="op" id="3273670">&gt;</span>&nbsp;<span class="num" id="3273672">0</span>&nbsp;<span class="op" id="3273674">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273678">s</span>&nbsp;<span class="op" id="3273680">+=</span>&nbsp;<span class="string" id="3273683">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273705">for</span>&nbsp;<span class="ident" id="3273709">i</span>&nbsp;<span class="op" id="3273711">:=</span>&nbsp;<span class="num" id="3273714">0</span><span class="op" id="3273715">;</span>&nbsp;<span class="ident" id="3273717">i</span>&nbsp;<span class="op" id="3273719">&lt;</span>&nbsp;<span class="builtinfunc" id="3273721">len</span><span class="op" id="3273724">(</span><span class="ident" id="3273725">dns</span><span class="op" id="3273728">.</span><span class="ident" id="3273729">ns</span><span class="op" id="3273731">)</span><span class="op" id="3273732">;</span>&nbsp;<span class="ident" id="3273734">i</span><span class="op" id="3273735">++</span>&nbsp;<span class="op" id="3273738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273743">s</span>&nbsp;<span class="op" id="3273745">+=</span>&nbsp;<span class="ident" id="3273748">printStruct</span><span class="op" id="3273759">(</span><span class="ident" id="3273760">dns</span><span class="op" id="3273763">.</span><span class="ident" id="3273764">ns</span><span class="op" id="3273766">[</span><span class="ident" id="3273767">i</span><span class="op" id="3273768">]</span><span class="op" id="3273769">)</span>&nbsp;<span class="op" id="3273771">+</span>&nbsp;<span class="string" id="3273773">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273783">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273786">if</span>&nbsp;<span class="builtinfunc" id="3273789">len</span><span class="op" id="3273792">(</span><span class="ident" id="3273793">dns</span><span class="op" id="3273796">.</span><span class="ident" id="3273797">extra</span><span class="op" id="3273802">)</span>&nbsp;<span class="op" id="3273804">&gt;</span>&nbsp;<span class="num" id="3273806">0</span>&nbsp;<span class="op" id="3273808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273812">s</span>&nbsp;<span class="op" id="3273814">+=</span>&nbsp;<span class="string" id="3273817">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273832">for</span>&nbsp;<span class="ident" id="3273836">i</span>&nbsp;<span class="op" id="3273838">:=</span>&nbsp;<span class="num" id="3273841">0</span><span class="op" id="3273842">;</span>&nbsp;<span class="ident" id="3273844">i</span>&nbsp;<span class="op" id="3273846">&lt;</span>&nbsp;<span class="builtinfunc" id="3273848">len</span><span class="op" id="3273851">(</span><span class="ident" id="3273852">dns</span><span class="op" id="3273855">.</span><span class="ident" id="3273856">extra</span><span class="op" id="3273861">)</span><span class="op" id="3273862">;</span>&nbsp;<span class="ident" id="3273864">i</span><span class="op" id="3273865">++</span>&nbsp;<span class="op" id="3273868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273873">s</span>&nbsp;<span class="op" id="3273875">+=</span>&nbsp;<span class="ident" id="3273878">printStruct</span><span class="op" id="3273889">(</span><span class="ident" id="3273890">dns</span><span class="op" id="3273893">.</span><span class="ident" id="3273894">extra</span><span class="op" id="3273899">[</span><span class="ident" id="3273900">i</span><span class="op" id="3273901">]</span><span class="op" id="3273902">)</span>&nbsp;<span class="op" id="3273904">+</span>&nbsp;<span class="string" id="3273906">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273913">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273919">return</span>&nbsp;<span class="ident" id="3273926">s</span><br>
<span class="lineno"></span><span class="op" id="3273928">}</span>
</div>
</body>
</html>
