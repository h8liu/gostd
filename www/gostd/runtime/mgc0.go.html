<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html" class="current">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1786215">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1786270">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1786324">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1786375">package</span>&nbsp;<span class="ident" id="1786383">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1786392">import</span>&nbsp;<span class="string" id="1786399">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1786409">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*m.</span><br>
<span class="lineno">10</span><span class="keyword" id="1786451">func</span>&nbsp;<span class="ident" id="1786456">gc_m_ptr</span><span class="op" id="1786464">(</span><span class="ident" id="1786465">ret</span>&nbsp;<span class="op" id="1786469">*</span><span class="keyword" id="1786470">interface</span><span class="op" id="1786479">{</span><span class="op" id="1786480">}</span><span class="op" id="1786481">)</span>&nbsp;<span class="op" id="1786483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786486">*</span><span class="ident" id="1786487">ret</span>&nbsp;<span class="op" id="1786491">=</span>&nbsp;<span class="op" id="1786493">(</span><span class="op" id="1786494">*</span><span class="ident" id="1786495">m</span><span class="op" id="1786496">)</span><span class="op" id="1786497">(</span><span class="ident" id="1786498">nil</span><span class="op" id="1786501">)</span><br>
<span class="lineno"></span><span class="op" id="1786503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1786506">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*g.</span><br>
<span class="lineno">15</span><span class="keyword" id="1786548">func</span>&nbsp;<span class="ident" id="1786553">gc_g_ptr</span><span class="op" id="1786561">(</span><span class="ident" id="1786562">ret</span>&nbsp;<span class="op" id="1786566">*</span><span class="keyword" id="1786567">interface</span><span class="op" id="1786576">{</span><span class="op" id="1786577">}</span><span class="op" id="1786578">)</span>&nbsp;<span class="op" id="1786580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786583">*</span><span class="ident" id="1786584">ret</span>&nbsp;<span class="op" id="1786588">=</span>&nbsp;<span class="op" id="1786590">(</span><span class="op" id="1786591">*</span><span class="ident" id="1786592">g</span><span class="op" id="1786593">)</span><span class="op" id="1786594">(</span><span class="ident" id="1786595">nil</span><span class="op" id="1786598">)</span><br>
<span class="lineno"></span><span class="op" id="1786600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1786603">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*itab.</span><br>
<span class="lineno">20</span><span class="keyword" id="1786648">func</span>&nbsp;<span class="ident" id="1786653">gc_itab_ptr</span><span class="op" id="1786664">(</span><span class="ident" id="1786665">ret</span>&nbsp;<span class="op" id="1786669">*</span><span class="keyword" id="1786670">interface</span><span class="op" id="1786679">{</span><span class="op" id="1786680">}</span><span class="op" id="1786681">)</span>&nbsp;<span class="op" id="1786683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786686">*</span><span class="ident" id="1786687">ret</span>&nbsp;<span class="op" id="1786691">=</span>&nbsp;<span class="op" id="1786693">(</span><span class="op" id="1786694">*</span><span class="ident" id="1786695">itab</span><span class="op" id="1786699">)</span><span class="op" id="1786700">(</span><span class="ident" id="1786701">nil</span><span class="op" id="1786704">)</span><br>
<span class="lineno"></span><span class="op" id="1786706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1786709">func</span>&nbsp;<span class="ident" id="1786714">gc_unixnanotime</span><span class="op" id="1786729">(</span><span class="ident" id="1786730">now</span>&nbsp;<span class="op" id="1786734">*</span><span class="ident" id="1786735">int64</span><span class="op" id="1786740">)</span>&nbsp;<span class="op" id="1786742">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786745">sec</span><span class="op" id="1786748">,</span>&nbsp;<span class="ident" id="1786750">nsec</span>&nbsp;<span class="op" id="1786755">:=</span>&nbsp;<span class="ident" id="1786758">timenow</span><span class="op" id="1786765">(</span><span class="op" id="1786766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786769">*</span><span class="ident" id="1786770">now</span>&nbsp;<span class="op" id="1786774">=</span>&nbsp;<span class="ident" id="1786776">sec</span><span class="op" id="1786779">*</span><span class="num" id="1786780">1e9</span>&nbsp;<span class="op" id="1786784">+</span>&nbsp;<span class="ident" id="1786786">int64</span><span class="op" id="1786791">(</span><span class="ident" id="1786792">nsec</span><span class="op" id="1786796">)</span><br>
<span class="lineno"></span><span class="op" id="1786798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1786801">func</span>&nbsp;<span class="ident" id="1786806">freeOSMemory</span><span class="op" id="1786818">(</span><span class="op" id="1786819">)</span>&nbsp;<span class="op" id="1786821">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786824">gogc</span><span class="op" id="1786828">(</span><span class="num" id="1786829">2</span><span class="op" id="1786830">)</span>&nbsp;<span class="comment" id="1786832">//&nbsp;force&nbsp;GC&nbsp;and&nbsp;do&nbsp;eager&nbsp;sweep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786864">onM</span><span class="op" id="1786867">(</span><span class="ident" id="1786868">scavenge_m</span><span class="op" id="1786878">)</span><br>
<span class="lineno"></span><span class="op" id="1786880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1786883">var</span>&nbsp;<span class="ident" id="1786887">poolcleanup</span>&nbsp;<span class="keyword" id="1786899">func</span><span class="op" id="1786903">(</span><span class="op" id="1786904">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="1786907">func</span>&nbsp;<span class="ident" id="1786912">registerPoolCleanup</span><span class="op" id="1786931">(</span><span class="ident" id="1786932">f</span>&nbsp;<span class="keyword" id="1786934">func</span><span class="op" id="1786938">(</span><span class="op" id="1786939">)</span><span class="op" id="1786940">)</span>&nbsp;<span class="op" id="1786942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786945">poolcleanup</span>&nbsp;<span class="op" id="1786957">=</span>&nbsp;<span class="ident" id="1786959">f</span><br>
<span class="lineno"></span><span class="op" id="1786961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="1786964">func</span>&nbsp;<span class="ident" id="1786969">clearpools</span><span class="op" id="1786979">(</span><span class="op" id="1786980">)</span>&nbsp;<span class="op" id="1786982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786985">//&nbsp;clear&nbsp;sync.Pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787006">if</span>&nbsp;<span class="ident" id="1787009">poolcleanup</span>&nbsp;<span class="op" id="1787021">!=</span>&nbsp;<span class="ident" id="1787024">nil</span>&nbsp;<span class="op" id="1787028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787032">poolcleanup</span><span class="op" id="1787043">(</span><span class="op" id="1787044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787047">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787051">for</span>&nbsp;<span class="ident" id="1787055">_</span><span class="op" id="1787056">,</span>&nbsp;<span class="ident" id="1787058">p</span>&nbsp;<span class="op" id="1787060">:=</span>&nbsp;<span class="keyword" id="1787063">range</span>&nbsp;<span class="op" id="1787069">&amp;</span><span class="ident" id="1787070">allp</span>&nbsp;<span class="op" id="1787075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787079">if</span>&nbsp;<span class="ident" id="1787082">p</span>&nbsp;<span class="op" id="1787084">==</span>&nbsp;<span class="ident" id="1787087">nil</span>&nbsp;<span class="op" id="1787091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787096">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787104">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787108">//&nbsp;clear&nbsp;tinyalloc&nbsp;pool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787134">if</span>&nbsp;<span class="ident" id="1787137">c</span>&nbsp;<span class="op" id="1787139">:=</span>&nbsp;<span class="ident" id="1787142">p</span><span class="op" id="1787143">.</span><span class="ident" id="1787144">mcache</span><span class="op" id="1787150">;</span>&nbsp;<span class="ident" id="1787152">c</span>&nbsp;<span class="op" id="1787154">!=</span>&nbsp;<span class="ident" id="1787157">nil</span>&nbsp;<span class="op" id="1787161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787166">c</span><span class="op" id="1787167">.</span><span class="ident" id="1787168">tiny</span>&nbsp;<span class="op" id="1787173">=</span>&nbsp;<span class="ident" id="1787175">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787182">c</span><span class="op" id="1787183">.</span><span class="ident" id="1787184">tinysize</span>&nbsp;<span class="op" id="1787193">=</span>&nbsp;<span class="num" id="1787195">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787201">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787263">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787331">var</span>&nbsp;<span class="ident" id="1787335">sg</span><span class="op" id="1787337">,</span>&nbsp;<span class="ident" id="1787339">sgnext</span>&nbsp;<span class="op" id="1787346">*</span><span class="ident" id="1787347">sudog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787356">for</span>&nbsp;<span class="ident" id="1787360">sg</span>&nbsp;<span class="op" id="1787363">=</span>&nbsp;<span class="ident" id="1787365">c</span><span class="op" id="1787366">.</span><span class="ident" id="1787367">sudogcache</span><span class="op" id="1787377">;</span>&nbsp;<span class="ident" id="1787379">sg</span>&nbsp;<span class="op" id="1787382">!=</span>&nbsp;<span class="ident" id="1787385">nil</span><span class="op" id="1787388">;</span>&nbsp;<span class="ident" id="1787390">sg</span>&nbsp;<span class="op" id="1787393">=</span>&nbsp;<span class="ident" id="1787395">sgnext</span>&nbsp;<span class="op" id="1787402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787408">sgnext</span>&nbsp;<span class="op" id="1787415">=</span>&nbsp;<span class="ident" id="1787417">sg</span><span class="op" id="1787419">.</span><span class="ident" id="1787420">next</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787429">sg</span><span class="op" id="1787431">.</span><span class="ident" id="1787432">next</span>&nbsp;<span class="op" id="1787437">=</span>&nbsp;<span class="ident" id="1787439">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787451">c</span><span class="op" id="1787452">.</span><span class="ident" id="1787453">sudogcache</span>&nbsp;<span class="op" id="1787464">=</span>&nbsp;<span class="ident" id="1787466">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787477">//&nbsp;clear&nbsp;defer&nbsp;pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787500">for</span>&nbsp;<span class="ident" id="1787504">i</span>&nbsp;<span class="op" id="1787506">:=</span>&nbsp;<span class="keyword" id="1787509">range</span>&nbsp;<span class="ident" id="1787515">p</span><span class="op" id="1787516">.</span><span class="ident" id="1787517">deferpool</span>&nbsp;<span class="op" id="1787527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787532">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787594">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787662">var</span>&nbsp;<span class="ident" id="1787666">d</span><span class="op" id="1787667">,</span>&nbsp;<span class="ident" id="1787669">dlink</span>&nbsp;<span class="op" id="1787675">*</span><span class="ident" id="1787676">_defer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787686">for</span>&nbsp;<span class="ident" id="1787690">d</span>&nbsp;<span class="op" id="1787692">=</span>&nbsp;<span class="ident" id="1787694">p</span><span class="op" id="1787695">.</span><span class="ident" id="1787696">deferpool</span><span class="op" id="1787705">[</span><span class="ident" id="1787706">i</span><span class="op" id="1787707">]</span><span class="op" id="1787708">;</span>&nbsp;<span class="ident" id="1787710">d</span>&nbsp;<span class="op" id="1787712">!=</span>&nbsp;<span class="ident" id="1787715">nil</span><span class="op" id="1787718">;</span>&nbsp;<span class="ident" id="1787720">d</span>&nbsp;<span class="op" id="1787722">=</span>&nbsp;<span class="ident" id="1787724">dlink</span>&nbsp;<span class="op" id="1787730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787736">dlink</span>&nbsp;<span class="op" id="1787742">=</span>&nbsp;<span class="ident" id="1787744">d</span><span class="op" id="1787745">.</span><span class="ident" id="1787746">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787755">d</span><span class="op" id="1787756">.</span><span class="ident" id="1787757">link</span>&nbsp;<span class="op" id="1787762">=</span>&nbsp;<span class="ident" id="1787764">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787776">p</span><span class="op" id="1787777">.</span><span class="ident" id="1787778">deferpool</span><span class="op" id="1787787">[</span><span class="ident" id="1787788">i</span><span class="op" id="1787789">]</span>&nbsp;<span class="op" id="1787791">=</span>&nbsp;<span class="ident" id="1787793">nil</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787802">}</span><br>
<span class="lineno"></span><span class="op" id="1787804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1787807">func</span>&nbsp;<span class="ident" id="1787812">gosweepone</span><span class="op" id="1787822">(</span><span class="op" id="1787823">)</span>&nbsp;<span class="builtintype" id="1787825">uintptr</span><br>
<span class="lineno">80</span><span class="keyword" id="1787833">func</span>&nbsp;<span class="ident" id="1787838">gosweepdone</span><span class="op" id="1787849">(</span><span class="op" id="1787850">)</span>&nbsp;<span class="builtintype" id="1787852">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1787858">func</span>&nbsp;<span class="ident" id="1787863">bgsweep</span><span class="op" id="1787870">(</span><span class="op" id="1787871">)</span>&nbsp;<span class="op" id="1787873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787876">getg</span><span class="op" id="1787880">(</span><span class="op" id="1787881">)</span><span class="op" id="1787882">.</span><span class="ident" id="1787883">issystem</span>&nbsp;<span class="op" id="1787892">=</span>&nbsp;<span class="builtintype" id="1787894">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787900">for</span>&nbsp;<span class="op" id="1787904">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787908">for</span>&nbsp;<span class="ident" id="1787912">gosweepone</span><span class="op" id="1787922">(</span><span class="op" id="1787923">)</span>&nbsp;<span class="op" id="1787925">!=</span>&nbsp;<span class="op" id="1787928">^</span><span class="builtintype" id="1787929">uintptr</span><span class="op" id="1787936">(</span><span class="num" id="1787937">0</span><span class="op" id="1787938">)</span>&nbsp;<span class="op" id="1787940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787945">sweep</span><span class="op" id="1787950">.</span><span class="ident" id="1787951">nbgsweep</span><span class="op" id="1787959">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787965">Gosched</span><span class="op" id="1787972">(</span><span class="op" id="1787973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787981">lock</span><span class="op" id="1787985">(</span><span class="op" id="1787986">&amp;</span><span class="ident" id="1787987">gclock</span><span class="op" id="1787993">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787997">if</span>&nbsp;<span class="op" id="1788000">!</span><span class="ident" id="1788001">gosweepdone</span><span class="op" id="1788012">(</span><span class="op" id="1788013">)</span>&nbsp;<span class="op" id="1788015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788020">//&nbsp;This&nbsp;can&nbsp;happen&nbsp;if&nbsp;a&nbsp;GC&nbsp;runs&nbsp;between</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788063">//&nbsp;gosweepone&nbsp;returning&nbsp;^0&nbsp;above</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788099">//&nbsp;and&nbsp;the&nbsp;lock&nbsp;being&nbsp;acquired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788134">unlock</span><span class="op" id="1788140">(</span><span class="op" id="1788141">&amp;</span><span class="ident" id="1788142">gclock</span><span class="op" id="1788148">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1788153">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1788164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788168">sweep</span><span class="op" id="1788173">.</span><span class="ident" id="1788174">parked</span>&nbsp;<span class="op" id="1788181">=</span>&nbsp;<span class="builtintype" id="1788183">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788190">goparkunlock</span><span class="op" id="1788202">(</span><span class="op" id="1788203">&amp;</span><span class="ident" id="1788204">gclock</span><span class="op" id="1788210">,</span>&nbsp;<span class="string" id="1788212">&#34;GC&nbsp;sweep&nbsp;wait&#34;</span><span class="op" id="1788227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1788230">}</span><br>
<span class="lineno">100</span><span class="op" id="1788232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788235">//&nbsp;NOTE:&nbsp;Really&nbsp;dst&nbsp;*unsafe.Pointer,&nbsp;src&nbsp;unsafe.Pointer,</span><br>
<span class="lineno"></span><span class="comment" id="1788292">//&nbsp;but&nbsp;if&nbsp;we&nbsp;do&nbsp;that,&nbsp;Go&nbsp;inserts&nbsp;a&nbsp;write&nbsp;barrier&nbsp;on&nbsp;*dst&nbsp;=&nbsp;src.</span><br>
<span class="lineno"></span><span class="comment" id="1788356">//go:nosplit</span><br>
<span class="lineno">105</span><span class="keyword" id="1788369">func</span>&nbsp;<span class="ident" id="1788374">writebarrierptr</span><span class="op" id="1788389">(</span><span class="ident" id="1788390">dst</span>&nbsp;<span class="op" id="1788394">*</span><span class="builtintype" id="1788395">uintptr</span><span class="op" id="1788402">,</span>&nbsp;<span class="ident" id="1788404">src</span>&nbsp;<span class="builtintype" id="1788408">uintptr</span><span class="op" id="1788415">)</span>&nbsp;<span class="op" id="1788417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1788420">*</span><span class="ident" id="1788421">dst</span>&nbsp;<span class="op" id="1788425">=</span>&nbsp;<span class="ident" id="1788427">src</span><br>
<span class="lineno"></span><span class="op" id="1788431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788434">//go:nosplit</span><br>
<span class="lineno">110</span><span class="keyword" id="1788447">func</span>&nbsp;<span class="ident" id="1788452">writebarrierstring</span><span class="op" id="1788470">(</span><span class="ident" id="1788471">dst</span>&nbsp;<span class="op" id="1788475">*</span><span class="op" id="1788476">[</span><span class="num" id="1788477">2</span><span class="op" id="1788478">]</span><span class="builtintype" id="1788479">uintptr</span><span class="op" id="1788486">,</span>&nbsp;<span class="ident" id="1788488">src</span>&nbsp;<span class="op" id="1788492">[</span><span class="num" id="1788493">2</span><span class="op" id="1788494">]</span><span class="builtintype" id="1788495">uintptr</span><span class="op" id="1788502">)</span>&nbsp;<span class="op" id="1788504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788507">dst</span><span class="op" id="1788510">[</span><span class="num" id="1788511">0</span><span class="op" id="1788512">]</span>&nbsp;<span class="op" id="1788514">=</span>&nbsp;<span class="ident" id="1788516">src</span><span class="op" id="1788519">[</span><span class="num" id="1788520">0</span><span class="op" id="1788521">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788524">dst</span><span class="op" id="1788527">[</span><span class="num" id="1788528">1</span><span class="op" id="1788529">]</span>&nbsp;<span class="op" id="1788531">=</span>&nbsp;<span class="ident" id="1788533">src</span><span class="op" id="1788536">[</span><span class="num" id="1788537">1</span><span class="op" id="1788538">]</span><br>
<span class="lineno"></span><span class="op" id="1788540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="1788543">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1788556">func</span>&nbsp;<span class="ident" id="1788561">writebarrierslice</span><span class="op" id="1788578">(</span><span class="ident" id="1788579">dst</span>&nbsp;<span class="op" id="1788583">*</span><span class="op" id="1788584">[</span><span class="num" id="1788585">3</span><span class="op" id="1788586">]</span><span class="builtintype" id="1788587">uintptr</span><span class="op" id="1788594">,</span>&nbsp;<span class="ident" id="1788596">src</span>&nbsp;<span class="op" id="1788600">[</span><span class="num" id="1788601">3</span><span class="op" id="1788602">]</span><span class="builtintype" id="1788603">uintptr</span><span class="op" id="1788610">)</span>&nbsp;<span class="op" id="1788612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788615">dst</span><span class="op" id="1788618">[</span><span class="num" id="1788619">0</span><span class="op" id="1788620">]</span>&nbsp;<span class="op" id="1788622">=</span>&nbsp;<span class="ident" id="1788624">src</span><span class="op" id="1788627">[</span><span class="num" id="1788628">0</span><span class="op" id="1788629">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788632">dst</span><span class="op" id="1788635">[</span><span class="num" id="1788636">1</span><span class="op" id="1788637">]</span>&nbsp;<span class="op" id="1788639">=</span>&nbsp;<span class="ident" id="1788641">src</span><span class="op" id="1788644">[</span><span class="num" id="1788645">1</span><span class="op" id="1788646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788649">dst</span><span class="op" id="1788652">[</span><span class="num" id="1788653">2</span><span class="op" id="1788654">]</span>&nbsp;<span class="op" id="1788656">=</span>&nbsp;<span class="ident" id="1788658">src</span><span class="op" id="1788661">[</span><span class="num" id="1788662">2</span><span class="op" id="1788663">]</span><br>
<span class="lineno">120</span><span class="op" id="1788665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788668">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1788681">func</span>&nbsp;<span class="ident" id="1788686">writebarrieriface</span><span class="op" id="1788703">(</span><span class="ident" id="1788704">dst</span>&nbsp;<span class="op" id="1788708">*</span><span class="op" id="1788709">[</span><span class="num" id="1788710">2</span><span class="op" id="1788711">]</span><span class="builtintype" id="1788712">uintptr</span><span class="op" id="1788719">,</span>&nbsp;<span class="ident" id="1788721">src</span>&nbsp;<span class="op" id="1788725">[</span><span class="num" id="1788726">2</span><span class="op" id="1788727">]</span><span class="builtintype" id="1788728">uintptr</span><span class="op" id="1788735">)</span>&nbsp;<span class="op" id="1788737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788740">dst</span><span class="op" id="1788743">[</span><span class="num" id="1788744">0</span><span class="op" id="1788745">]</span>&nbsp;<span class="op" id="1788747">=</span>&nbsp;<span class="ident" id="1788749">src</span><span class="op" id="1788752">[</span><span class="num" id="1788753">0</span><span class="op" id="1788754">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788757">dst</span><span class="op" id="1788760">[</span><span class="num" id="1788761">1</span><span class="op" id="1788762">]</span>&nbsp;<span class="op" id="1788764">=</span>&nbsp;<span class="ident" id="1788766">src</span><span class="op" id="1788769">[</span><span class="num" id="1788770">1</span><span class="op" id="1788771">]</span><br>
<span class="lineno"></span><span class="op" id="1788773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788776">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1788789">func</span>&nbsp;<span class="ident" id="1788794">writebarrierfat2</span><span class="op" id="1788810">(</span><span class="ident" id="1788811">dst</span>&nbsp;<span class="op" id="1788815">*</span><span class="op" id="1788816">[</span><span class="num" id="1788817">2</span><span class="op" id="1788818">]</span><span class="builtintype" id="1788819">uintptr</span><span class="op" id="1788826">,</span>&nbsp;<span class="ident" id="1788828">_</span>&nbsp;<span class="op" id="1788830">*</span><span class="builtintype" id="1788831">byte</span><span class="op" id="1788835">,</span>&nbsp;<span class="ident" id="1788837">src</span>&nbsp;<span class="op" id="1788841">[</span><span class="num" id="1788842">2</span><span class="op" id="1788843">]</span><span class="builtintype" id="1788844">uintptr</span><span class="op" id="1788851">)</span>&nbsp;<span class="op" id="1788853">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788856">dst</span><span class="op" id="1788859">[</span><span class="num" id="1788860">0</span><span class="op" id="1788861">]</span>&nbsp;<span class="op" id="1788863">=</span>&nbsp;<span class="ident" id="1788865">src</span><span class="op" id="1788868">[</span><span class="num" id="1788869">0</span><span class="op" id="1788870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788873">dst</span><span class="op" id="1788876">[</span><span class="num" id="1788877">1</span><span class="op" id="1788878">]</span>&nbsp;<span class="op" id="1788880">=</span>&nbsp;<span class="ident" id="1788882">src</span><span class="op" id="1788885">[</span><span class="num" id="1788886">1</span><span class="op" id="1788887">]</span><br>
<span class="lineno"></span><span class="op" id="1788889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788892">//go:nosplit</span><br>
<span class="lineno">135</span><span class="keyword" id="1788905">func</span>&nbsp;<span class="ident" id="1788910">writebarrierfat3</span><span class="op" id="1788926">(</span><span class="ident" id="1788927">dst</span>&nbsp;<span class="op" id="1788931">*</span><span class="op" id="1788932">[</span><span class="num" id="1788933">3</span><span class="op" id="1788934">]</span><span class="builtintype" id="1788935">uintptr</span><span class="op" id="1788942">,</span>&nbsp;<span class="ident" id="1788944">_</span>&nbsp;<span class="op" id="1788946">*</span><span class="builtintype" id="1788947">byte</span><span class="op" id="1788951">,</span>&nbsp;<span class="ident" id="1788953">src</span>&nbsp;<span class="op" id="1788957">[</span><span class="num" id="1788958">3</span><span class="op" id="1788959">]</span><span class="builtintype" id="1788960">uintptr</span><span class="op" id="1788967">)</span>&nbsp;<span class="op" id="1788969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788972">dst</span><span class="op" id="1788975">[</span><span class="num" id="1788976">0</span><span class="op" id="1788977">]</span>&nbsp;<span class="op" id="1788979">=</span>&nbsp;<span class="ident" id="1788981">src</span><span class="op" id="1788984">[</span><span class="num" id="1788985">0</span><span class="op" id="1788986">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788989">dst</span><span class="op" id="1788992">[</span><span class="num" id="1788993">1</span><span class="op" id="1788994">]</span>&nbsp;<span class="op" id="1788996">=</span>&nbsp;<span class="ident" id="1788998">src</span><span class="op" id="1789001">[</span><span class="num" id="1789002">1</span><span class="op" id="1789003">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789006">dst</span><span class="op" id="1789009">[</span><span class="num" id="1789010">2</span><span class="op" id="1789011">]</span>&nbsp;<span class="op" id="1789013">=</span>&nbsp;<span class="ident" id="1789015">src</span><span class="op" id="1789018">[</span><span class="num" id="1789019">2</span><span class="op" id="1789020">]</span><br>
<span class="lineno"></span><span class="op" id="1789022">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1789025">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1789038">func</span>&nbsp;<span class="ident" id="1789043">writebarrierfat4</span><span class="op" id="1789059">(</span><span class="ident" id="1789060">dst</span>&nbsp;<span class="op" id="1789064">*</span><span class="op" id="1789065">[</span><span class="num" id="1789066">4</span><span class="op" id="1789067">]</span><span class="builtintype" id="1789068">uintptr</span><span class="op" id="1789075">,</span>&nbsp;<span class="ident" id="1789077">_</span>&nbsp;<span class="op" id="1789079">*</span><span class="builtintype" id="1789080">byte</span><span class="op" id="1789084">,</span>&nbsp;<span class="ident" id="1789086">src</span>&nbsp;<span class="op" id="1789090">[</span><span class="num" id="1789091">4</span><span class="op" id="1789092">]</span><span class="builtintype" id="1789093">uintptr</span><span class="op" id="1789100">)</span>&nbsp;<span class="op" id="1789102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789105">dst</span><span class="op" id="1789108">[</span><span class="num" id="1789109">0</span><span class="op" id="1789110">]</span>&nbsp;<span class="op" id="1789112">=</span>&nbsp;<span class="ident" id="1789114">src</span><span class="op" id="1789117">[</span><span class="num" id="1789118">0</span><span class="op" id="1789119">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789122">dst</span><span class="op" id="1789125">[</span><span class="num" id="1789126">1</span><span class="op" id="1789127">]</span>&nbsp;<span class="op" id="1789129">=</span>&nbsp;<span class="ident" id="1789131">src</span><span class="op" id="1789134">[</span><span class="num" id="1789135">1</span><span class="op" id="1789136">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789139">dst</span><span class="op" id="1789142">[</span><span class="num" id="1789143">2</span><span class="op" id="1789144">]</span>&nbsp;<span class="op" id="1789146">=</span>&nbsp;<span class="ident" id="1789148">src</span><span class="op" id="1789151">[</span><span class="num" id="1789152">2</span><span class="op" id="1789153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789156">dst</span><span class="op" id="1789159">[</span><span class="num" id="1789160">3</span><span class="op" id="1789161">]</span>&nbsp;<span class="op" id="1789163">=</span>&nbsp;<span class="ident" id="1789165">src</span><span class="op" id="1789168">[</span><span class="num" id="1789169">3</span><span class="op" id="1789170">]</span><br>
<span class="lineno"></span><span class="op" id="1789172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1789175">//go:nosplit</span><br>
<span class="lineno">150</span><span class="keyword" id="1789188">func</span>&nbsp;<span class="ident" id="1789193">writebarrierfat</span><span class="op" id="1789208">(</span><span class="ident" id="1789209">typ</span>&nbsp;<span class="op" id="1789213">*</span><span class="ident" id="1789214">_type</span><span class="op" id="1789219">,</span>&nbsp;<span class="ident" id="1789221">dst</span><span class="op" id="1789224">,</span>&nbsp;<span class="ident" id="1789226">src</span>&nbsp;<span class="ident" id="1789230">unsafe</span><span class="op" id="1789236">.</span><span class="ident" id="1789237">Pointer</span><span class="op" id="1789244">)</span>&nbsp;<span class="op" id="1789246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789249">memmove</span><span class="op" id="1789256">(</span><span class="ident" id="1789257">dst</span><span class="op" id="1789260">,</span>&nbsp;<span class="ident" id="1789262">src</span><span class="op" id="1789265">,</span>&nbsp;<span class="ident" id="1789267">typ</span><span class="op" id="1789270">.</span><span class="ident" id="1789271">size</span><span class="op" id="1789275">)</span><br>
<span class="lineno"></span><span class="op" id="1789277">}</span>
</div>
</body>
</html>
