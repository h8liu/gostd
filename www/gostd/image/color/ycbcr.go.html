<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html" class="current">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3404062">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3404117">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3404171">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3404222">package</span>&nbsp;<span class="ident" id="3404230">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3404237">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="3404294">func</span>&nbsp;<span class="ident" id="3404299">RGBToYCbCr</span><span class="op" id="3404309">(</span><span class="ident" id="3404310">r</span><span class="op" id="3404311">,</span>&nbsp;<span class="ident" id="3404313">g</span><span class="op" id="3404314">,</span>&nbsp;<span class="ident" id="3404316">b</span>&nbsp;<span class="builtintype" id="3404318">uint8</span><span class="op" id="3404323">)</span>&nbsp;<span class="op" id="3404325">(</span><span class="builtintype" id="3404326">uint8</span><span class="op" id="3404331">,</span>&nbsp;<span class="builtintype" id="3404333">uint8</span><span class="op" id="3404338">,</span>&nbsp;<span class="builtintype" id="3404340">uint8</span><span class="op" id="3404345">)</span>&nbsp;<span class="op" id="3404347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3404350">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3404383">//&nbsp;&nbsp;&nbsp;&nbsp;Y&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3404424">//&nbsp;&nbsp;&nbsp;&nbsp;Cb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3404471">//&nbsp;&nbsp;&nbsp;&nbsp;Cr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3404518">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404585">r1</span>&nbsp;<span class="op" id="3404588">:=</span>&nbsp;<span class="builtintype" id="3404591">int</span><span class="op" id="3404594">(</span><span class="ident" id="3404595">r</span><span class="op" id="3404596">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404599">g1</span>&nbsp;<span class="op" id="3404602">:=</span>&nbsp;<span class="builtintype" id="3404605">int</span><span class="op" id="3404608">(</span><span class="ident" id="3404609">g</span><span class="op" id="3404610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404613">b1</span>&nbsp;<span class="op" id="3404616">:=</span>&nbsp;<span class="builtintype" id="3404619">int</span><span class="op" id="3404622">(</span><span class="ident" id="3404623">b</span><span class="op" id="3404624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404627">yy</span>&nbsp;<span class="op" id="3404630">:=</span>&nbsp;<span class="op" id="3404633">(</span><span class="num" id="3404634">19595</span><span class="op" id="3404639">*</span><span class="ident" id="3404640">r1</span>&nbsp;<span class="op" id="3404643">+</span>&nbsp;<span class="num" id="3404645">38470</span><span class="op" id="3404650">*</span><span class="ident" id="3404651">g1</span>&nbsp;<span class="op" id="3404654">+</span>&nbsp;<span class="num" id="3404656">7471</span><span class="op" id="3404660">*</span><span class="ident" id="3404661">b1</span>&nbsp;<span class="op" id="3404664">+</span>&nbsp;<span class="num" id="3404666">1</span><span class="op" id="3404667">&lt;&lt;</span><span class="num" id="3404669">15</span><span class="op" id="3404671">)</span>&nbsp;<span class="op" id="3404673">&gt;&gt;</span>&nbsp;<span class="num" id="3404676">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404680">cb</span>&nbsp;<span class="op" id="3404683">:=</span>&nbsp;<span class="op" id="3404686">(</span><span class="op" id="3404687">-</span><span class="num" id="3404688">11056</span><span class="op" id="3404693">*</span><span class="ident" id="3404694">r1</span>&nbsp;<span class="op" id="3404697">-</span>&nbsp;<span class="num" id="3404699">21712</span><span class="op" id="3404704">*</span><span class="ident" id="3404705">g1</span>&nbsp;<span class="op" id="3404708">+</span>&nbsp;<span class="num" id="3404710">32768</span><span class="op" id="3404715">*</span><span class="ident" id="3404716">b1</span>&nbsp;<span class="op" id="3404719">+</span>&nbsp;<span class="num" id="3404721">257</span><span class="op" id="3404724">&lt;&lt;</span><span class="num" id="3404726">15</span><span class="op" id="3404728">)</span>&nbsp;<span class="op" id="3404730">&gt;&gt;</span>&nbsp;<span class="num" id="3404733">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404737">cr</span>&nbsp;<span class="op" id="3404740">:=</span>&nbsp;<span class="op" id="3404743">(</span><span class="num" id="3404744">32768</span><span class="op" id="3404749">*</span><span class="ident" id="3404750">r1</span>&nbsp;<span class="op" id="3404753">-</span>&nbsp;<span class="num" id="3404755">27440</span><span class="op" id="3404760">*</span><span class="ident" id="3404761">g1</span>&nbsp;<span class="op" id="3404764">-</span>&nbsp;<span class="num" id="3404766">5328</span><span class="op" id="3404770">*</span><span class="ident" id="3404771">b1</span>&nbsp;<span class="op" id="3404774">+</span>&nbsp;<span class="num" id="3404776">257</span><span class="op" id="3404779">&lt;&lt;</span><span class="num" id="3404781">15</span><span class="op" id="3404783">)</span>&nbsp;<span class="op" id="3404785">&gt;&gt;</span>&nbsp;<span class="num" id="3404788">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3404792">if</span>&nbsp;<span class="ident" id="3404795">yy</span>&nbsp;<span class="op" id="3404798">&lt;</span>&nbsp;<span class="num" id="3404800">0</span>&nbsp;<span class="op" id="3404802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404806">yy</span>&nbsp;<span class="op" id="3404809">=</span>&nbsp;<span class="num" id="3404811">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3404814">}</span>&nbsp;<span class="keyword" id="3404816">else</span>&nbsp;<span class="keyword" id="3404821">if</span>&nbsp;<span class="ident" id="3404824">yy</span>&nbsp;<span class="op" id="3404827">&gt;</span>&nbsp;<span class="num" id="3404829">255</span>&nbsp;<span class="op" id="3404833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404837">yy</span>&nbsp;<span class="op" id="3404840">=</span>&nbsp;<span class="num" id="3404842">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3404847">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3404850">if</span>&nbsp;<span class="ident" id="3404853">cb</span>&nbsp;<span class="op" id="3404856">&lt;</span>&nbsp;<span class="num" id="3404858">0</span>&nbsp;<span class="op" id="3404860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404864">cb</span>&nbsp;<span class="op" id="3404867">=</span>&nbsp;<span class="num" id="3404869">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3404872">}</span>&nbsp;<span class="keyword" id="3404874">else</span>&nbsp;<span class="keyword" id="3404879">if</span>&nbsp;<span class="ident" id="3404882">cb</span>&nbsp;<span class="op" id="3404885">&gt;</span>&nbsp;<span class="num" id="3404887">255</span>&nbsp;<span class="op" id="3404891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404895">cb</span>&nbsp;<span class="op" id="3404898">=</span>&nbsp;<span class="num" id="3404900">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3404905">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3404908">if</span>&nbsp;<span class="ident" id="3404911">cr</span>&nbsp;<span class="op" id="3404914">&lt;</span>&nbsp;<span class="num" id="3404916">0</span>&nbsp;<span class="op" id="3404918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404922">cr</span>&nbsp;<span class="op" id="3404925">=</span>&nbsp;<span class="num" id="3404927">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3404930">}</span>&nbsp;<span class="keyword" id="3404932">else</span>&nbsp;<span class="keyword" id="3404937">if</span>&nbsp;<span class="ident" id="3404940">cr</span>&nbsp;<span class="op" id="3404943">&gt;</span>&nbsp;<span class="num" id="3404945">255</span>&nbsp;<span class="op" id="3404949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3404953">cr</span>&nbsp;<span class="op" id="3404956">=</span>&nbsp;<span class="num" id="3404958">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3404963">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3404966">return</span>&nbsp;<span class="builtintype" id="3404973">uint8</span><span class="op" id="3404978">(</span><span class="ident" id="3404979">yy</span><span class="op" id="3404981">)</span><span class="op" id="3404982">,</span>&nbsp;<span class="builtintype" id="3404984">uint8</span><span class="op" id="3404989">(</span><span class="ident" id="3404990">cb</span><span class="op" id="3404992">)</span><span class="op" id="3404993">,</span>&nbsp;<span class="builtintype" id="3404995">uint8</span><span class="op" id="3405000">(</span><span class="ident" id="3405001">cr</span><span class="op" id="3405003">)</span><br>
<span class="lineno"></span><span class="op" id="3405005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3405008">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="3405065">func</span>&nbsp;<span class="ident" id="3405070">YCbCrToRGB</span><span class="op" id="3405080">(</span><span class="ident" id="3405081">y</span><span class="op" id="3405082">,</span>&nbsp;<span class="ident" id="3405084">cb</span><span class="op" id="3405086">,</span>&nbsp;<span class="ident" id="3405088">cr</span>&nbsp;<span class="builtintype" id="3405091">uint8</span><span class="op" id="3405096">)</span>&nbsp;<span class="op" id="3405098">(</span><span class="builtintype" id="3405099">uint8</span><span class="op" id="3405104">,</span>&nbsp;<span class="builtintype" id="3405106">uint8</span><span class="op" id="3405111">,</span>&nbsp;<span class="builtintype" id="3405113">uint8</span><span class="op" id="3405118">)</span>&nbsp;<span class="op" id="3405120">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3405123">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3405156">//&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3405186">//&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3405235">//&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3405265">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405332">yy1</span>&nbsp;<span class="op" id="3405336">:=</span>&nbsp;<span class="builtintype" id="3405339">int</span><span class="op" id="3405342">(</span><span class="ident" id="3405343">y</span><span class="op" id="3405344">)</span><span class="op" id="3405345">&lt;&lt;</span><span class="num" id="3405347">16</span>&nbsp;<span class="op" id="3405350">+</span>&nbsp;<span class="num" id="3405352">1</span><span class="op" id="3405353">&lt;&lt;</span><span class="num" id="3405355">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405359">cb1</span>&nbsp;<span class="op" id="3405363">:=</span>&nbsp;<span class="builtintype" id="3405366">int</span><span class="op" id="3405369">(</span><span class="ident" id="3405370">cb</span><span class="op" id="3405372">)</span>&nbsp;<span class="op" id="3405374">-</span>&nbsp;<span class="num" id="3405376">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405381">cr1</span>&nbsp;<span class="op" id="3405385">:=</span>&nbsp;<span class="builtintype" id="3405388">int</span><span class="op" id="3405391">(</span><span class="ident" id="3405392">cr</span><span class="op" id="3405394">)</span>&nbsp;<span class="op" id="3405396">-</span>&nbsp;<span class="num" id="3405398">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405403">r</span>&nbsp;<span class="op" id="3405405">:=</span>&nbsp;<span class="op" id="3405408">(</span><span class="ident" id="3405409">yy1</span>&nbsp;<span class="op" id="3405413">+</span>&nbsp;<span class="num" id="3405415">91881</span><span class="op" id="3405420">*</span><span class="ident" id="3405421">cr1</span><span class="op" id="3405424">)</span>&nbsp;<span class="op" id="3405426">&gt;&gt;</span>&nbsp;<span class="num" id="3405429">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405433">g</span>&nbsp;<span class="op" id="3405435">:=</span>&nbsp;<span class="op" id="3405438">(</span><span class="ident" id="3405439">yy1</span>&nbsp;<span class="op" id="3405443">-</span>&nbsp;<span class="num" id="3405445">22554</span><span class="op" id="3405450">*</span><span class="ident" id="3405451">cb1</span>&nbsp;<span class="op" id="3405455">-</span>&nbsp;<span class="num" id="3405457">46802</span><span class="op" id="3405462">*</span><span class="ident" id="3405463">cr1</span><span class="op" id="3405466">)</span>&nbsp;<span class="op" id="3405468">&gt;&gt;</span>&nbsp;<span class="num" id="3405471">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405475">b</span>&nbsp;<span class="op" id="3405477">:=</span>&nbsp;<span class="op" id="3405480">(</span><span class="ident" id="3405481">yy1</span>&nbsp;<span class="op" id="3405485">+</span>&nbsp;<span class="num" id="3405487">116130</span><span class="op" id="3405493">*</span><span class="ident" id="3405494">cb1</span><span class="op" id="3405497">)</span>&nbsp;<span class="op" id="3405499">&gt;&gt;</span>&nbsp;<span class="num" id="3405502">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3405506">if</span>&nbsp;<span class="ident" id="3405509">r</span>&nbsp;<span class="op" id="3405511">&lt;</span>&nbsp;<span class="num" id="3405513">0</span>&nbsp;<span class="op" id="3405515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405519">r</span>&nbsp;<span class="op" id="3405521">=</span>&nbsp;<span class="num" id="3405523">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3405526">}</span>&nbsp;<span class="keyword" id="3405528">else</span>&nbsp;<span class="keyword" id="3405533">if</span>&nbsp;<span class="ident" id="3405536">r</span>&nbsp;<span class="op" id="3405538">&gt;</span>&nbsp;<span class="num" id="3405540">255</span>&nbsp;<span class="op" id="3405544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405548">r</span>&nbsp;<span class="op" id="3405550">=</span>&nbsp;<span class="num" id="3405552">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3405557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3405560">if</span>&nbsp;<span class="ident" id="3405563">g</span>&nbsp;<span class="op" id="3405565">&lt;</span>&nbsp;<span class="num" id="3405567">0</span>&nbsp;<span class="op" id="3405569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405573">g</span>&nbsp;<span class="op" id="3405575">=</span>&nbsp;<span class="num" id="3405577">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3405580">}</span>&nbsp;<span class="keyword" id="3405582">else</span>&nbsp;<span class="keyword" id="3405587">if</span>&nbsp;<span class="ident" id="3405590">g</span>&nbsp;<span class="op" id="3405592">&gt;</span>&nbsp;<span class="num" id="3405594">255</span>&nbsp;<span class="op" id="3405598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405602">g</span>&nbsp;<span class="op" id="3405604">=</span>&nbsp;<span class="num" id="3405606">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3405611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3405614">if</span>&nbsp;<span class="ident" id="3405617">b</span>&nbsp;<span class="op" id="3405619">&lt;</span>&nbsp;<span class="num" id="3405621">0</span>&nbsp;<span class="op" id="3405623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405627">b</span>&nbsp;<span class="op" id="3405629">=</span>&nbsp;<span class="num" id="3405631">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3405634">}</span>&nbsp;<span class="keyword" id="3405636">else</span>&nbsp;<span class="keyword" id="3405641">if</span>&nbsp;<span class="ident" id="3405644">b</span>&nbsp;<span class="op" id="3405646">&gt;</span>&nbsp;<span class="num" id="3405648">255</span>&nbsp;<span class="op" id="3405652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3405656">b</span>&nbsp;<span class="op" id="3405658">=</span>&nbsp;<span class="num" id="3405660">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3405665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3405668">return</span>&nbsp;<span class="builtintype" id="3405675">uint8</span><span class="op" id="3405680">(</span><span class="ident" id="3405681">r</span><span class="op" id="3405682">)</span><span class="op" id="3405683">,</span>&nbsp;<span class="builtintype" id="3405685">uint8</span><span class="op" id="3405690">(</span><span class="ident" id="3405691">g</span><span class="op" id="3405692">)</span><span class="op" id="3405693">,</span>&nbsp;<span class="builtintype" id="3405695">uint8</span><span class="op" id="3405700">(</span><span class="ident" id="3405701">b</span><span class="op" id="3405702">)</span><br>
<span class="lineno"></span><span class="op" id="3405704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3405707">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="3405786">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="3405825">//</span><br>
<span class="lineno"></span><span class="comment" id="3405828">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="3405902">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="3405977">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="3406055">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="3406108">//</span><br>
<span class="lineno"></span><span class="comment" id="3406111">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="3406190">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="3406265">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="3406337">type</span>&nbsp;<span class="ident" id="3406342">YCbCr</span>&nbsp;<span class="keyword" id="3406348">struct</span>&nbsp;<span class="op" id="3406355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3406358">Y</span><span class="op" id="3406359">,</span>&nbsp;<span class="ident" id="3406361">Cb</span><span class="op" id="3406363">,</span>&nbsp;<span class="ident" id="3406365">Cr</span>&nbsp;<span class="builtintype" id="3406368">uint8</span><br>
<span class="lineno"></span><span class="op" id="3406374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3406377">func</span>&nbsp;<span class="op" id="3406382">(</span><span class="ident" id="3406383">c</span>&nbsp;<span class="ident" id="3406385">YCbCr</span><span class="op" id="3406390">)</span>&nbsp;<span class="ident" id="3406392">RGBA</span><span class="op" id="3406396">(</span><span class="op" id="3406397">)</span>&nbsp;<span class="op" id="3406399">(</span><span class="builtintype" id="3406400">uint32</span><span class="op" id="3406406">,</span>&nbsp;<span class="builtintype" id="3406408">uint32</span><span class="op" id="3406414">,</span>&nbsp;<span class="builtintype" id="3406416">uint32</span><span class="op" id="3406422">,</span>&nbsp;<span class="builtintype" id="3406424">uint32</span><span class="op" id="3406430">)</span>&nbsp;<span class="op" id="3406432">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3406435">r</span><span class="op" id="3406436">,</span>&nbsp;<span class="ident" id="3406438">g</span><span class="op" id="3406439">,</span>&nbsp;<span class="ident" id="3406441">b</span>&nbsp;<span class="op" id="3406443">:=</span>&nbsp;<span class="ident" id="3406446">YCbCrToRGB</span><span class="op" id="3406456">(</span><span class="ident" id="3406457">c</span><span class="op" id="3406458">.</span><span class="ident" id="3406459">Y</span><span class="op" id="3406460">,</span>&nbsp;<span class="ident" id="3406462">c</span><span class="op" id="3406463">.</span><span class="ident" id="3406464">Cb</span><span class="op" id="3406466">,</span>&nbsp;<span class="ident" id="3406468">c</span><span class="op" id="3406469">.</span><span class="ident" id="3406470">Cr</span><span class="op" id="3406472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3406475">return</span>&nbsp;<span class="builtintype" id="3406482">uint32</span><span class="op" id="3406488">(</span><span class="ident" id="3406489">r</span><span class="op" id="3406490">)</span>&nbsp;<span class="op" id="3406492">*</span>&nbsp;<span class="num" id="3406494">0x101</span><span class="op" id="3406499">,</span>&nbsp;<span class="builtintype" id="3406501">uint32</span><span class="op" id="3406507">(</span><span class="ident" id="3406508">g</span><span class="op" id="3406509">)</span>&nbsp;<span class="op" id="3406511">*</span>&nbsp;<span class="num" id="3406513">0x101</span><span class="op" id="3406518">,</span>&nbsp;<span class="builtintype" id="3406520">uint32</span><span class="op" id="3406526">(</span><span class="ident" id="3406527">b</span><span class="op" id="3406528">)</span>&nbsp;<span class="op" id="3406530">*</span>&nbsp;<span class="num" id="3406532">0x101</span><span class="op" id="3406537">,</span>&nbsp;<span class="num" id="3406539">0xffff</span><br>
<span class="lineno"></span><span class="op" id="3406546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3406549">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="3406595">var</span>&nbsp;<span class="ident" id="3406599">YCbCrModel</span>&nbsp;<span class="ident" id="3406610">Model</span>&nbsp;<span class="op" id="3406616">=</span>&nbsp;<span class="ident" id="3406618">ModelFunc</span><span class="op" id="3406627">(</span><span class="ident" id="3406628">yCbCrModel</span><span class="op" id="3406638">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3406641">func</span>&nbsp;<span class="ident" id="3406646">yCbCrModel</span><span class="op" id="3406656">(</span><span class="ident" id="3406657">c</span>&nbsp;<span class="ident" id="3406659">Color</span><span class="op" id="3406664">)</span>&nbsp;<span class="ident" id="3406666">Color</span>&nbsp;<span class="op" id="3406672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3406675">if</span>&nbsp;<span class="ident" id="3406678">_</span><span class="op" id="3406679">,</span>&nbsp;<span class="ident" id="3406681">ok</span>&nbsp;<span class="op" id="3406684">:=</span>&nbsp;<span class="ident" id="3406687">c</span><span class="op" id="3406688">.</span><span class="op" id="3406689">(</span><span class="ident" id="3406690">YCbCr</span><span class="op" id="3406695">)</span><span class="op" id="3406696">;</span>&nbsp;<span class="ident" id="3406698">ok</span>&nbsp;<span class="op" id="3406701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3406705">return</span>&nbsp;<span class="ident" id="3406712">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3406715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3406718">r</span><span class="op" id="3406719">,</span>&nbsp;<span class="ident" id="3406721">g</span><span class="op" id="3406722">,</span>&nbsp;<span class="ident" id="3406724">b</span><span class="op" id="3406725">,</span>&nbsp;<span class="ident" id="3406727">_</span>&nbsp;<span class="op" id="3406729">:=</span>&nbsp;<span class="ident" id="3406732">c</span><span class="op" id="3406733">.</span><span class="ident" id="3406734">RGBA</span><span class="op" id="3406738">(</span><span class="op" id="3406739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3406742">y</span><span class="op" id="3406743">,</span>&nbsp;<span class="ident" id="3406745">u</span><span class="op" id="3406746">,</span>&nbsp;<span class="ident" id="3406748">v</span>&nbsp;<span class="op" id="3406750">:=</span>&nbsp;<span class="ident" id="3406753">RGBToYCbCr</span><span class="op" id="3406763">(</span><span class="builtintype" id="3406764">uint8</span><span class="op" id="3406769">(</span><span class="ident" id="3406770">r</span><span class="op" id="3406771">&gt;&gt;</span><span class="num" id="3406773">8</span><span class="op" id="3406774">)</span><span class="op" id="3406775">,</span>&nbsp;<span class="builtintype" id="3406777">uint8</span><span class="op" id="3406782">(</span><span class="ident" id="3406783">g</span><span class="op" id="3406784">&gt;&gt;</span><span class="num" id="3406786">8</span><span class="op" id="3406787">)</span><span class="op" id="3406788">,</span>&nbsp;<span class="builtintype" id="3406790">uint8</span><span class="op" id="3406795">(</span><span class="ident" id="3406796">b</span><span class="op" id="3406797">&gt;&gt;</span><span class="num" id="3406799">8</span><span class="op" id="3406800">)</span><span class="op" id="3406801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3406804">return</span>&nbsp;<span class="ident" id="3406811">YCbCr</span><span class="op" id="3406816">{</span><span class="ident" id="3406817">y</span><span class="op" id="3406818">,</span>&nbsp;<span class="ident" id="3406820">u</span><span class="op" id="3406821">,</span>&nbsp;<span class="ident" id="3406823">v</span><span class="op" id="3406824">}</span><br>
<span class="lineno"></span><span class="op" id="3406826">}</span>
</div>
</body>
</html>
