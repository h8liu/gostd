<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7915933">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7915988">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7916042">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7916093">package</span>&nbsp;<span class="ident" id="7916101">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7916106">import</span>&nbsp;<span class="op" id="7916113">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7916116">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7916126">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="7916129">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7916173">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="7916217">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="7916262">func</span>&nbsp;<span class="ident" id="7916267">TestPowx</span><span class="op" id="7916275">(</span><span class="ident" id="7916276">t</span>&nbsp;<span class="op" id="7916278">*</span><span class="ident" id="7916279">testing</span><span class="op" id="7916286">.</span><span class="ident" id="7916287">T</span><span class="op" id="7916288">)</span>&nbsp;<span class="op" id="7916290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916293">p</span>&nbsp;<span class="op" id="7916295">:=</span>&nbsp;<span class="num" id="7916298">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916301">for</span>&nbsp;<span class="ident" id="7916305">i</span>&nbsp;<span class="op" id="7916307">:=</span>&nbsp;<span class="num" id="7916310">0</span><span class="op" id="7916311">;</span>&nbsp;<span class="ident" id="7916313">i</span>&nbsp;<span class="op" id="7916315">&lt;</span>&nbsp;<span class="builtinfunc" id="7916317">len</span><span class="op" id="7916320">(</span><span class="ident" id="7916321">powx</span><span class="op" id="7916325">)</span><span class="op" id="7916326">;</span>&nbsp;<span class="ident" id="7916328">i</span><span class="op" id="7916329">++</span>&nbsp;<span class="op" id="7916332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916336">if</span>&nbsp;<span class="ident" id="7916339">powx</span><span class="op" id="7916343">[</span><span class="ident" id="7916344">i</span><span class="op" id="7916345">]</span>&nbsp;<span class="op" id="7916347">!=</span>&nbsp;<span class="builtintype" id="7916350">byte</span><span class="op" id="7916354">(</span><span class="ident" id="7916355">p</span><span class="op" id="7916356">)</span>&nbsp;<span class="op" id="7916358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916363">t</span><span class="op" id="7916364">.</span><span class="ident" id="7916365">Errorf</span><span class="op" id="7916371">(</span><span class="string" id="7916372">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7916398">,</span>&nbsp;<span class="ident" id="7916400">i</span><span class="op" id="7916401">,</span>&nbsp;<span class="ident" id="7916403">powx</span><span class="op" id="7916407">[</span><span class="ident" id="7916408">i</span><span class="op" id="7916409">]</span><span class="op" id="7916410">,</span>&nbsp;<span class="ident" id="7916412">p</span><span class="op" id="7916413">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7916417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916421">p</span>&nbsp;<span class="op" id="7916423">&lt;&lt;=</span>&nbsp;<span class="num" id="7916427">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916431">if</span>&nbsp;<span class="ident" id="7916434">p</span><span class="op" id="7916435">&amp;</span><span class="num" id="7916436">0x100</span>&nbsp;<span class="op" id="7916442">!=</span>&nbsp;<span class="num" id="7916445">0</span>&nbsp;<span class="op" id="7916447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916452">p</span>&nbsp;<span class="op" id="7916454">^=</span>&nbsp;<span class="ident" id="7916457">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7916464">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7916467">}</span><br>
<span class="lineno"></span><span class="op" id="7916469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7916472">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="7916525">func</span>&nbsp;<span class="ident" id="7916530">mul</span><span class="op" id="7916533">(</span><span class="ident" id="7916534">b</span><span class="op" id="7916535">,</span>&nbsp;<span class="ident" id="7916537">c</span>&nbsp;<span class="builtintype" id="7916539">uint32</span><span class="op" id="7916545">)</span>&nbsp;<span class="builtintype" id="7916547">uint32</span>&nbsp;<span class="op" id="7916554">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916557">i</span>&nbsp;<span class="op" id="7916559">:=</span>&nbsp;<span class="ident" id="7916562">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916565">j</span>&nbsp;<span class="op" id="7916567">:=</span>&nbsp;<span class="ident" id="7916570">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916573">s</span>&nbsp;<span class="op" id="7916575">:=</span>&nbsp;<span class="builtintype" id="7916578">uint32</span><span class="op" id="7916584">(</span><span class="num" id="7916585">0</span><span class="op" id="7916586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916589">for</span>&nbsp;<span class="ident" id="7916593">k</span>&nbsp;<span class="op" id="7916595">:=</span>&nbsp;<span class="builtintype" id="7916598">uint32</span><span class="op" id="7916604">(</span><span class="num" id="7916605">1</span><span class="op" id="7916606">)</span><span class="op" id="7916607">;</span>&nbsp;<span class="ident" id="7916609">k</span>&nbsp;<span class="op" id="7916611">&lt;</span>&nbsp;<span class="num" id="7916613">0x100</span>&nbsp;<span class="op" id="7916619">&amp;&amp;</span>&nbsp;<span class="ident" id="7916622">j</span>&nbsp;<span class="op" id="7916624">!=</span>&nbsp;<span class="num" id="7916627">0</span><span class="op" id="7916628">;</span>&nbsp;<span class="ident" id="7916630">k</span>&nbsp;<span class="op" id="7916632">&lt;&lt;=</span>&nbsp;<span class="num" id="7916636">1</span>&nbsp;<span class="op" id="7916638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7916642">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;xⁿ</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916684">if</span>&nbsp;<span class="ident" id="7916687">j</span><span class="op" id="7916688">&amp;</span><span class="ident" id="7916689">k</span>&nbsp;<span class="op" id="7916691">!=</span>&nbsp;<span class="num" id="7916694">0</span>&nbsp;<span class="op" id="7916696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7916701">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916738">s</span>&nbsp;<span class="op" id="7916740">^=</span>&nbsp;<span class="ident" id="7916743">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916748">j</span>&nbsp;<span class="op" id="7916750">^=</span>&nbsp;<span class="ident" id="7916753">k</span>&nbsp;<span class="comment" id="7916755">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7916791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7916796">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916839">i</span>&nbsp;<span class="op" id="7916841">&lt;&lt;=</span>&nbsp;<span class="num" id="7916845">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916849">if</span>&nbsp;<span class="ident" id="7916852">i</span><span class="op" id="7916853">&amp;</span><span class="num" id="7916854">0x100</span>&nbsp;<span class="op" id="7916860">!=</span>&nbsp;<span class="num" id="7916863">0</span>&nbsp;<span class="op" id="7916865">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7916870">i</span>&nbsp;<span class="op" id="7916872">^=</span>&nbsp;<span class="ident" id="7916875">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7916882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7916885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916888">return</span>&nbsp;<span class="ident" id="7916895">s</span><br>
<span class="lineno"></span><span class="op" id="7916897">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="7916900">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n²&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="7916957">func</span>&nbsp;<span class="ident" id="7916962">TestMul</span><span class="op" id="7916969">(</span><span class="ident" id="7916970">t</span>&nbsp;<span class="op" id="7916972">*</span><span class="ident" id="7916973">testing</span><span class="op" id="7916980">.</span><span class="ident" id="7916981">T</span><span class="op" id="7916982">)</span>&nbsp;<span class="op" id="7916984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7916987">for</span>&nbsp;<span class="ident" id="7916991">i</span>&nbsp;<span class="op" id="7916993">:=</span>&nbsp;<span class="builtintype" id="7916996">uint32</span><span class="op" id="7917002">(</span><span class="num" id="7917003">0</span><span class="op" id="7917004">)</span><span class="op" id="7917005">;</span>&nbsp;<span class="ident" id="7917007">i</span>&nbsp;<span class="op" id="7917009">&lt;</span>&nbsp;<span class="num" id="7917011">256</span><span class="op" id="7917014">;</span>&nbsp;<span class="ident" id="7917016">i</span><span class="op" id="7917017">++</span>&nbsp;<span class="op" id="7917020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917024">for</span>&nbsp;<span class="ident" id="7917028">j</span>&nbsp;<span class="op" id="7917030">:=</span>&nbsp;<span class="builtintype" id="7917033">uint32</span><span class="op" id="7917039">(</span><span class="num" id="7917040">0</span><span class="op" id="7917041">)</span><span class="op" id="7917042">;</span>&nbsp;<span class="ident" id="7917044">j</span>&nbsp;<span class="op" id="7917046">&lt;</span>&nbsp;<span class="num" id="7917048">256</span><span class="op" id="7917051">;</span>&nbsp;<span class="ident" id="7917053">j</span><span class="op" id="7917054">++</span>&nbsp;<span class="op" id="7917057">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7917062">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7917094">s</span>&nbsp;<span class="op" id="7917096">:=</span>&nbsp;<span class="builtintype" id="7917099">uint8</span><span class="op" id="7917104">(</span><span class="num" id="7917105">0</span><span class="op" id="7917106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917111">for</span>&nbsp;<span class="ident" id="7917115">k</span>&nbsp;<span class="op" id="7917117">:=</span>&nbsp;<span class="builtintype" id="7917120">uint</span><span class="op" id="7917124">(</span><span class="num" id="7917125">0</span><span class="op" id="7917126">)</span><span class="op" id="7917127">;</span>&nbsp;<span class="ident" id="7917129">k</span>&nbsp;<span class="op" id="7917131">&lt;</span>&nbsp;<span class="num" id="7917133">8</span><span class="op" id="7917134">;</span>&nbsp;<span class="ident" id="7917136">k</span><span class="op" id="7917137">++</span>&nbsp;<span class="op" id="7917140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917146">for</span>&nbsp;<span class="ident" id="7917150">l</span>&nbsp;<span class="op" id="7917152">:=</span>&nbsp;<span class="builtintype" id="7917155">uint</span><span class="op" id="7917159">(</span><span class="num" id="7917160">0</span><span class="op" id="7917161">)</span><span class="op" id="7917162">;</span>&nbsp;<span class="ident" id="7917164">l</span>&nbsp;<span class="op" id="7917166">&lt;</span>&nbsp;<span class="num" id="7917168">8</span><span class="op" id="7917169">;</span>&nbsp;<span class="ident" id="7917171">l</span><span class="op" id="7917172">++</span>&nbsp;<span class="op" id="7917175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917182">if</span>&nbsp;<span class="ident" id="7917185">i</span><span class="op" id="7917186">&amp;</span><span class="op" id="7917187">(</span><span class="num" id="7917188">1</span><span class="op" id="7917189">&lt;&lt;</span><span class="ident" id="7917191">k</span><span class="op" id="7917192">)</span>&nbsp;<span class="op" id="7917194">!=</span>&nbsp;<span class="num" id="7917197">0</span>&nbsp;<span class="op" id="7917199">&amp;&amp;</span>&nbsp;<span class="ident" id="7917202">j</span><span class="op" id="7917203">&amp;</span><span class="op" id="7917204">(</span><span class="num" id="7917205">1</span><span class="op" id="7917206">&lt;&lt;</span><span class="ident" id="7917208">l</span><span class="op" id="7917209">)</span>&nbsp;<span class="op" id="7917211">!=</span>&nbsp;<span class="num" id="7917214">0</span>&nbsp;<span class="op" id="7917216">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7917224">s</span>&nbsp;<span class="op" id="7917226">^=</span>&nbsp;<span class="ident" id="7917229">powx</span><span class="op" id="7917233">[</span><span class="ident" id="7917234">k</span><span class="op" id="7917235">+</span><span class="ident" id="7917236">l</span><span class="op" id="7917237">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917260">if</span>&nbsp;<span class="ident" id="7917263">x</span>&nbsp;<span class="op" id="7917265">:=</span>&nbsp;<span class="ident" id="7917268">mul</span><span class="op" id="7917271">(</span><span class="ident" id="7917272">i</span><span class="op" id="7917273">,</span>&nbsp;<span class="ident" id="7917275">j</span><span class="op" id="7917276">)</span><span class="op" id="7917277">;</span>&nbsp;<span class="ident" id="7917279">x</span>&nbsp;<span class="op" id="7917281">!=</span>&nbsp;<span class="builtintype" id="7917284">uint32</span><span class="op" id="7917290">(</span><span class="ident" id="7917291">s</span><span class="op" id="7917292">)</span>&nbsp;<span class="op" id="7917294">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7917300">t</span><span class="op" id="7917301">.</span><span class="ident" id="7917302">Fatalf</span><span class="op" id="7917308">(</span><span class="string" id="7917309">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7917340">,</span>&nbsp;<span class="ident" id="7917342">i</span><span class="op" id="7917343">,</span>&nbsp;<span class="ident" id="7917345">j</span><span class="op" id="7917346">,</span>&nbsp;<span class="ident" id="7917348">x</span><span class="op" id="7917349">,</span>&nbsp;<span class="ident" id="7917351">s</span><span class="op" id="7917352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917364">}</span><br>
<span class="lineno"></span><span class="op" id="7917366">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="7917369">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="7917419">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="7917467">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="7917516">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="7917563">func</span>&nbsp;<span class="ident" id="7917568">TestSboxes</span><span class="op" id="7917578">(</span><span class="ident" id="7917579">t</span>&nbsp;<span class="op" id="7917581">*</span><span class="ident" id="7917582">testing</span><span class="op" id="7917589">.</span><span class="ident" id="7917590">T</span><span class="op" id="7917591">)</span>&nbsp;<span class="op" id="7917593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917596">for</span>&nbsp;<span class="ident" id="7917600">i</span>&nbsp;<span class="op" id="7917602">:=</span>&nbsp;<span class="num" id="7917605">0</span><span class="op" id="7917606">;</span>&nbsp;<span class="ident" id="7917608">i</span>&nbsp;<span class="op" id="7917610">&lt;</span>&nbsp;<span class="num" id="7917612">256</span><span class="op" id="7917615">;</span>&nbsp;<span class="ident" id="7917617">i</span><span class="op" id="7917618">++</span>&nbsp;<span class="op" id="7917621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917625">if</span>&nbsp;<span class="ident" id="7917628">j</span>&nbsp;<span class="op" id="7917630">:=</span>&nbsp;<span class="ident" id="7917633">sbox0</span><span class="op" id="7917638">[</span><span class="ident" id="7917639">sbox1</span><span class="op" id="7917644">[</span><span class="ident" id="7917645">i</span><span class="op" id="7917646">]</span><span class="op" id="7917647">]</span><span class="op" id="7917648">;</span>&nbsp;<span class="ident" id="7917650">j</span>&nbsp;<span class="op" id="7917652">!=</span>&nbsp;<span class="builtintype" id="7917655">byte</span><span class="op" id="7917659">(</span><span class="ident" id="7917660">i</span><span class="op" id="7917661">)</span>&nbsp;<span class="op" id="7917663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7917668">t</span><span class="op" id="7917669">.</span><span class="ident" id="7917670">Errorf</span><span class="op" id="7917676">(</span><span class="string" id="7917677">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7917702">,</span>&nbsp;<span class="ident" id="7917704">i</span><span class="op" id="7917705">,</span>&nbsp;<span class="ident" id="7917707">j</span><span class="op" id="7917708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917712">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917716">if</span>&nbsp;<span class="ident" id="7917719">j</span>&nbsp;<span class="op" id="7917721">:=</span>&nbsp;<span class="ident" id="7917724">sbox1</span><span class="op" id="7917729">[</span><span class="ident" id="7917730">sbox0</span><span class="op" id="7917735">[</span><span class="ident" id="7917736">i</span><span class="op" id="7917737">]</span><span class="op" id="7917738">]</span><span class="op" id="7917739">;</span>&nbsp;<span class="ident" id="7917741">j</span>&nbsp;<span class="op" id="7917743">!=</span>&nbsp;<span class="builtintype" id="7917746">byte</span><span class="op" id="7917750">(</span><span class="ident" id="7917751">i</span><span class="op" id="7917752">)</span>&nbsp;<span class="op" id="7917754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7917759">t</span><span class="op" id="7917760">.</span><span class="ident" id="7917761">Errorf</span><span class="op" id="7917767">(</span><span class="string" id="7917768">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7917793">,</span>&nbsp;<span class="ident" id="7917795">i</span><span class="op" id="7917796">,</span>&nbsp;<span class="ident" id="7917798">j</span><span class="op" id="7917799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7917806">}</span><br>
<span class="lineno"></span><span class="op" id="7917808">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="7917811">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="7917855">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7917902">func</span>&nbsp;<span class="ident" id="7917907">TestTe</span><span class="op" id="7917913">(</span><span class="ident" id="7917914">t</span>&nbsp;<span class="op" id="7917916">*</span><span class="ident" id="7917917">testing</span><span class="op" id="7917924">.</span><span class="ident" id="7917925">T</span><span class="op" id="7917926">)</span>&nbsp;<span class="op" id="7917928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7917931">for</span>&nbsp;<span class="ident" id="7917935">i</span>&nbsp;<span class="op" id="7917937">:=</span>&nbsp;<span class="num" id="7917940">0</span><span class="op" id="7917941">;</span>&nbsp;<span class="ident" id="7917943">i</span>&nbsp;<span class="op" id="7917945">&lt;</span>&nbsp;<span class="num" id="7917947">256</span><span class="op" id="7917950">;</span>&nbsp;<span class="ident" id="7917952">i</span><span class="op" id="7917953">++</span>&nbsp;<span class="op" id="7917956">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7917960">s</span>&nbsp;<span class="op" id="7917962">:=</span>&nbsp;<span class="builtintype" id="7917965">uint32</span><span class="op" id="7917971">(</span><span class="ident" id="7917972">sbox0</span><span class="op" id="7917977">[</span><span class="ident" id="7917978">i</span><span class="op" id="7917979">]</span><span class="op" id="7917980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7917984">s2</span>&nbsp;<span class="op" id="7917987">:=</span>&nbsp;<span class="ident" id="7917990">mul</span><span class="op" id="7917993">(</span><span class="ident" id="7917994">s</span><span class="op" id="7917995">,</span>&nbsp;<span class="num" id="7917997">2</span><span class="op" id="7917998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918002">s3</span>&nbsp;<span class="op" id="7918005">:=</span>&nbsp;<span class="ident" id="7918008">mul</span><span class="op" id="7918011">(</span><span class="ident" id="7918012">s</span><span class="op" id="7918013">,</span>&nbsp;<span class="num" id="7918015">3</span><span class="op" id="7918016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918020">w</span>&nbsp;<span class="op" id="7918022">:=</span>&nbsp;<span class="ident" id="7918025">s2</span><span class="op" id="7918027">&lt;&lt;</span><span class="num" id="7918029">24</span>&nbsp;<span class="op" id="7918032">|</span>&nbsp;<span class="ident" id="7918034">s</span><span class="op" id="7918035">&lt;&lt;</span><span class="num" id="7918037">16</span>&nbsp;<span class="op" id="7918040">|</span>&nbsp;<span class="ident" id="7918042">s</span><span class="op" id="7918043">&lt;&lt;</span><span class="num" id="7918045">8</span>&nbsp;<span class="op" id="7918047">|</span>&nbsp;<span class="ident" id="7918049">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918054">te</span>&nbsp;<span class="op" id="7918057">:=</span>&nbsp;<span class="op" id="7918060">[</span><span class="op" id="7918061">]</span><span class="op" id="7918062">[</span><span class="num" id="7918063">256</span><span class="op" id="7918066">]</span><span class="builtintype" id="7918067">uint32</span><span class="op" id="7918073">{</span><span class="ident" id="7918074">te0</span><span class="op" id="7918077">,</span>&nbsp;<span class="ident" id="7918079">te1</span><span class="op" id="7918082">,</span>&nbsp;<span class="ident" id="7918084">te2</span><span class="op" id="7918087">,</span>&nbsp;<span class="ident" id="7918089">te3</span><span class="op" id="7918092">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7918096">for</span>&nbsp;<span class="ident" id="7918100">j</span>&nbsp;<span class="op" id="7918102">:=</span>&nbsp;<span class="num" id="7918105">0</span><span class="op" id="7918106">;</span>&nbsp;<span class="ident" id="7918108">j</span>&nbsp;<span class="op" id="7918110">&lt;</span>&nbsp;<span class="num" id="7918112">4</span><span class="op" id="7918113">;</span>&nbsp;<span class="ident" id="7918115">j</span><span class="op" id="7918116">++</span>&nbsp;<span class="op" id="7918119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7918124">if</span>&nbsp;<span class="ident" id="7918127">x</span>&nbsp;<span class="op" id="7918129">:=</span>&nbsp;<span class="ident" id="7918132">te</span><span class="op" id="7918134">[</span><span class="ident" id="7918135">j</span><span class="op" id="7918136">]</span><span class="op" id="7918137">[</span><span class="ident" id="7918138">i</span><span class="op" id="7918139">]</span><span class="op" id="7918140">;</span>&nbsp;<span class="ident" id="7918142">x</span>&nbsp;<span class="op" id="7918144">!=</span>&nbsp;<span class="ident" id="7918147">w</span>&nbsp;<span class="op" id="7918149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918155">t</span><span class="op" id="7918156">.</span><span class="ident" id="7918157">Fatalf</span><span class="op" id="7918163">(</span><span class="string" id="7918164">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7918192">,</span>&nbsp;<span class="ident" id="7918194">j</span><span class="op" id="7918195">,</span>&nbsp;<span class="ident" id="7918197">i</span><span class="op" id="7918198">,</span>&nbsp;<span class="ident" id="7918200">x</span><span class="op" id="7918201">,</span>&nbsp;<span class="ident" id="7918203">w</span><span class="op" id="7918204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918214">w</span>&nbsp;<span class="op" id="7918216">=</span>&nbsp;<span class="ident" id="7918218">w</span><span class="op" id="7918219">&lt;&lt;</span><span class="num" id="7918221">24</span>&nbsp;<span class="op" id="7918224">|</span>&nbsp;<span class="ident" id="7918226">w</span><span class="op" id="7918227">&gt;&gt;</span><span class="num" id="7918229">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918236">}</span><br>
<span class="lineno"></span><span class="op" id="7918238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7918241">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="7918285">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7918332">func</span>&nbsp;<span class="ident" id="7918337">TestTd</span><span class="op" id="7918343">(</span><span class="ident" id="7918344">t</span>&nbsp;<span class="op" id="7918346">*</span><span class="ident" id="7918347">testing</span><span class="op" id="7918354">.</span><span class="ident" id="7918355">T</span><span class="op" id="7918356">)</span>&nbsp;<span class="op" id="7918358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7918361">for</span>&nbsp;<span class="ident" id="7918365">i</span>&nbsp;<span class="op" id="7918367">:=</span>&nbsp;<span class="num" id="7918370">0</span><span class="op" id="7918371">;</span>&nbsp;<span class="ident" id="7918373">i</span>&nbsp;<span class="op" id="7918375">&lt;</span>&nbsp;<span class="num" id="7918377">256</span><span class="op" id="7918380">;</span>&nbsp;<span class="ident" id="7918382">i</span><span class="op" id="7918383">++</span>&nbsp;<span class="op" id="7918386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918390">s</span>&nbsp;<span class="op" id="7918392">:=</span>&nbsp;<span class="builtintype" id="7918395">uint32</span><span class="op" id="7918401">(</span><span class="ident" id="7918402">sbox1</span><span class="op" id="7918407">[</span><span class="ident" id="7918408">i</span><span class="op" id="7918409">]</span><span class="op" id="7918410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918414">s9</span>&nbsp;<span class="op" id="7918417">:=</span>&nbsp;<span class="ident" id="7918420">mul</span><span class="op" id="7918423">(</span><span class="ident" id="7918424">s</span><span class="op" id="7918425">,</span>&nbsp;<span class="num" id="7918427">0x9</span><span class="op" id="7918430">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918434">sb</span>&nbsp;<span class="op" id="7918437">:=</span>&nbsp;<span class="ident" id="7918440">mul</span><span class="op" id="7918443">(</span><span class="ident" id="7918444">s</span><span class="op" id="7918445">,</span>&nbsp;<span class="num" id="7918447">0xb</span><span class="op" id="7918450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918454">sd</span>&nbsp;<span class="op" id="7918457">:=</span>&nbsp;<span class="ident" id="7918460">mul</span><span class="op" id="7918463">(</span><span class="ident" id="7918464">s</span><span class="op" id="7918465">,</span>&nbsp;<span class="num" id="7918467">0xd</span><span class="op" id="7918470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918474">se</span>&nbsp;<span class="op" id="7918477">:=</span>&nbsp;<span class="ident" id="7918480">mul</span><span class="op" id="7918483">(</span><span class="ident" id="7918484">s</span><span class="op" id="7918485">,</span>&nbsp;<span class="num" id="7918487">0xe</span><span class="op" id="7918490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918494">w</span>&nbsp;<span class="op" id="7918496">:=</span>&nbsp;<span class="ident" id="7918499">se</span><span class="op" id="7918501">&lt;&lt;</span><span class="num" id="7918503">24</span>&nbsp;<span class="op" id="7918506">|</span>&nbsp;<span class="ident" id="7918508">s9</span><span class="op" id="7918510">&lt;&lt;</span><span class="num" id="7918512">16</span>&nbsp;<span class="op" id="7918515">|</span>&nbsp;<span class="ident" id="7918517">sd</span><span class="op" id="7918519">&lt;&lt;</span><span class="num" id="7918521">8</span>&nbsp;<span class="op" id="7918523">|</span>&nbsp;<span class="ident" id="7918525">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918530">td</span>&nbsp;<span class="op" id="7918533">:=</span>&nbsp;<span class="op" id="7918536">[</span><span class="op" id="7918537">]</span><span class="op" id="7918538">[</span><span class="num" id="7918539">256</span><span class="op" id="7918542">]</span><span class="builtintype" id="7918543">uint32</span><span class="op" id="7918549">{</span><span class="ident" id="7918550">td0</span><span class="op" id="7918553">,</span>&nbsp;<span class="ident" id="7918555">td1</span><span class="op" id="7918558">,</span>&nbsp;<span class="ident" id="7918560">td2</span><span class="op" id="7918563">,</span>&nbsp;<span class="ident" id="7918565">td3</span><span class="op" id="7918568">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7918572">for</span>&nbsp;<span class="ident" id="7918576">j</span>&nbsp;<span class="op" id="7918578">:=</span>&nbsp;<span class="num" id="7918581">0</span><span class="op" id="7918582">;</span>&nbsp;<span class="ident" id="7918584">j</span>&nbsp;<span class="op" id="7918586">&lt;</span>&nbsp;<span class="num" id="7918588">4</span><span class="op" id="7918589">;</span>&nbsp;<span class="ident" id="7918591">j</span><span class="op" id="7918592">++</span>&nbsp;<span class="op" id="7918595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7918600">if</span>&nbsp;<span class="ident" id="7918603">x</span>&nbsp;<span class="op" id="7918605">:=</span>&nbsp;<span class="ident" id="7918608">td</span><span class="op" id="7918610">[</span><span class="ident" id="7918611">j</span><span class="op" id="7918612">]</span><span class="op" id="7918613">[</span><span class="ident" id="7918614">i</span><span class="op" id="7918615">]</span><span class="op" id="7918616">;</span>&nbsp;<span class="ident" id="7918618">x</span>&nbsp;<span class="op" id="7918620">!=</span>&nbsp;<span class="ident" id="7918623">w</span>&nbsp;<span class="op" id="7918625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918631">t</span><span class="op" id="7918632">.</span><span class="ident" id="7918633">Fatalf</span><span class="op" id="7918639">(</span><span class="string" id="7918640">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7918668">,</span>&nbsp;<span class="ident" id="7918670">j</span><span class="op" id="7918671">,</span>&nbsp;<span class="ident" id="7918673">i</span><span class="op" id="7918674">,</span>&nbsp;<span class="ident" id="7918676">x</span><span class="op" id="7918677">,</span>&nbsp;<span class="ident" id="7918679">w</span><span class="op" id="7918680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918690">w</span>&nbsp;<span class="op" id="7918692">=</span>&nbsp;<span class="ident" id="7918694">w</span><span class="op" id="7918695">&lt;&lt;</span><span class="num" id="7918697">24</span>&nbsp;<span class="op" id="7918700">|</span>&nbsp;<span class="ident" id="7918702">w</span><span class="op" id="7918703">&gt;&gt;</span><span class="num" id="7918705">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918712">}</span><br>
<span class="lineno"></span><span class="op" id="7918714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7918717">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="7918752">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7918820">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="7918870">type</span>&nbsp;<span class="ident" id="7918875">KeyTest</span>&nbsp;<span class="keyword" id="7918883">struct</span>&nbsp;<span class="op" id="7918890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918893">key</span>&nbsp;<span class="op" id="7918897">[</span><span class="op" id="7918898">]</span><span class="builtintype" id="7918899">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918905">enc</span>&nbsp;<span class="op" id="7918909">[</span><span class="op" id="7918910">]</span><span class="builtintype" id="7918911">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7918919">dec</span>&nbsp;<span class="op" id="7918923">[</span><span class="op" id="7918924">]</span><span class="builtintype" id="7918925">uint32</span>&nbsp;<span class="comment" id="7918932">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="7919006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7919009">var</span>&nbsp;<span class="ident" id="7919013">keyTests</span>&nbsp;<span class="op" id="7919022">=</span>&nbsp;<span class="op" id="7919024">[</span><span class="op" id="7919025">]</span><span class="ident" id="7919026">KeyTest</span><span class="op" id="7919033">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7919040">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919085">[</span><span class="op" id="7919086">]</span><span class="builtintype" id="7919087">byte</span><span class="op" id="7919091">{</span><span class="num" id="7919092">0x2b</span><span class="op" id="7919096">,</span>&nbsp;<span class="num" id="7919098">0x7e</span><span class="op" id="7919102">,</span>&nbsp;<span class="num" id="7919104">0x15</span><span class="op" id="7919108">,</span>&nbsp;<span class="num" id="7919110">0x16</span><span class="op" id="7919114">,</span>&nbsp;<span class="num" id="7919116">0x28</span><span class="op" id="7919120">,</span>&nbsp;<span class="num" id="7919122">0xae</span><span class="op" id="7919126">,</span>&nbsp;<span class="num" id="7919128">0xd2</span><span class="op" id="7919132">,</span>&nbsp;<span class="num" id="7919134">0xa6</span><span class="op" id="7919138">,</span>&nbsp;<span class="num" id="7919140">0xab</span><span class="op" id="7919144">,</span>&nbsp;<span class="num" id="7919146">0xf7</span><span class="op" id="7919150">,</span>&nbsp;<span class="num" id="7919152">0x15</span><span class="op" id="7919156">,</span>&nbsp;<span class="num" id="7919158">0x88</span><span class="op" id="7919162">,</span>&nbsp;<span class="num" id="7919164">0x09</span><span class="op" id="7919168">,</span>&nbsp;<span class="num" id="7919170">0xcf</span><span class="op" id="7919174">,</span>&nbsp;<span class="num" id="7919176">0x4f</span><span class="op" id="7919180">,</span>&nbsp;<span class="num" id="7919182">0x3c</span><span class="op" id="7919186">}</span><span class="op" id="7919187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919191">[</span><span class="op" id="7919192">]</span><span class="builtintype" id="7919193">uint32</span><span class="op" id="7919199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919204">0x2b7e1516</span><span class="op" id="7919214">,</span>&nbsp;<span class="num" id="7919216">0x28aed2a6</span><span class="op" id="7919226">,</span>&nbsp;<span class="num" id="7919228">0xabf71588</span><span class="op" id="7919238">,</span>&nbsp;<span class="num" id="7919240">0x09cf4f3c</span><span class="op" id="7919250">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919255">0xa0fafe17</span><span class="op" id="7919265">,</span>&nbsp;<span class="num" id="7919267">0x88542cb1</span><span class="op" id="7919277">,</span>&nbsp;<span class="num" id="7919279">0x23a33939</span><span class="op" id="7919289">,</span>&nbsp;<span class="num" id="7919291">0x2a6c7605</span><span class="op" id="7919301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919306">0xf2c295f2</span><span class="op" id="7919316">,</span>&nbsp;<span class="num" id="7919318">0x7a96b943</span><span class="op" id="7919328">,</span>&nbsp;<span class="num" id="7919330">0x5935807a</span><span class="op" id="7919340">,</span>&nbsp;<span class="num" id="7919342">0x7359f67f</span><span class="op" id="7919352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919357">0x3d80477d</span><span class="op" id="7919367">,</span>&nbsp;<span class="num" id="7919369">0x4716fe3e</span><span class="op" id="7919379">,</span>&nbsp;<span class="num" id="7919381">0x1e237e44</span><span class="op" id="7919391">,</span>&nbsp;<span class="num" id="7919393">0x6d7a883b</span><span class="op" id="7919403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919408">0xef44a541</span><span class="op" id="7919418">,</span>&nbsp;<span class="num" id="7919420">0xa8525b7f</span><span class="op" id="7919430">,</span>&nbsp;<span class="num" id="7919432">0xb671253b</span><span class="op" id="7919442">,</span>&nbsp;<span class="num" id="7919444">0xdb0bad00</span><span class="op" id="7919454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919459">0xd4d1c6f8</span><span class="op" id="7919469">,</span>&nbsp;<span class="num" id="7919471">0x7c839d87</span><span class="op" id="7919481">,</span>&nbsp;<span class="num" id="7919483">0xcaf2b8bc</span><span class="op" id="7919493">,</span>&nbsp;<span class="num" id="7919495">0x11f915bc</span><span class="op" id="7919505">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919510">0x6d88a37a</span><span class="op" id="7919520">,</span>&nbsp;<span class="num" id="7919522">0x110b3efd</span><span class="op" id="7919532">,</span>&nbsp;<span class="num" id="7919534">0xdbf98641</span><span class="op" id="7919544">,</span>&nbsp;<span class="num" id="7919546">0xca0093fd</span><span class="op" id="7919556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919561">0x4e54f70e</span><span class="op" id="7919571">,</span>&nbsp;<span class="num" id="7919573">0x5f5fc9f3</span><span class="op" id="7919583">,</span>&nbsp;<span class="num" id="7919585">0x84a64fb2</span><span class="op" id="7919595">,</span>&nbsp;<span class="num" id="7919597">0x4ea6dc4f</span><span class="op" id="7919607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919612">0xead27321</span><span class="op" id="7919622">,</span>&nbsp;<span class="num" id="7919624">0xb58dbad2</span><span class="op" id="7919634">,</span>&nbsp;<span class="num" id="7919636">0x312bf560</span><span class="op" id="7919646">,</span>&nbsp;<span class="num" id="7919648">0x7f8d292f</span><span class="op" id="7919658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919663">0xac7766f3</span><span class="op" id="7919673">,</span>&nbsp;<span class="num" id="7919675">0x19fadc21</span><span class="op" id="7919685">,</span>&nbsp;<span class="num" id="7919687">0x28d12941</span><span class="op" id="7919697">,</span>&nbsp;<span class="num" id="7919699">0x575c006e</span><span class="op" id="7919709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919714">0xd014f9a8</span><span class="op" id="7919724">,</span>&nbsp;<span class="num" id="7919726">0xc9ee2589</span><span class="op" id="7919736">,</span>&nbsp;<span class="num" id="7919738">0xe13f0cc8</span><span class="op" id="7919748">,</span>&nbsp;<span class="num" id="7919750">0xb6630ca6</span><span class="op" id="7919760">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919764">}</span><span class="op" id="7919765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919769">[</span><span class="op" id="7919770">]</span><span class="builtintype" id="7919771">uint32</span><span class="op" id="7919777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919782">0xd014f9a8</span><span class="op" id="7919792">,</span>&nbsp;<span class="num" id="7919794">0xc9ee2589</span><span class="op" id="7919804">,</span>&nbsp;<span class="num" id="7919806">0xe13f0cc8</span><span class="op" id="7919816">,</span>&nbsp;<span class="num" id="7919818">0xb6630ca6</span><span class="op" id="7919828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919833">0xc7b5a63</span><span class="op" id="7919842">,</span>&nbsp;<span class="num" id="7919844">0x1319eafe</span><span class="op" id="7919854">,</span>&nbsp;<span class="num" id="7919856">0xb0398890</span><span class="op" id="7919866">,</span>&nbsp;<span class="num" id="7919868">0x664cfbb4</span><span class="op" id="7919878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919883">0xdf7d925a</span><span class="op" id="7919893">,</span>&nbsp;<span class="num" id="7919895">0x1f62b09d</span><span class="op" id="7919905">,</span>&nbsp;<span class="num" id="7919907">0xa320626e</span><span class="op" id="7919917">,</span>&nbsp;<span class="num" id="7919919">0xd6757324</span><span class="op" id="7919929">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919934">0x12c07647</span><span class="op" id="7919944">,</span>&nbsp;<span class="num" id="7919946">0xc01f22c7</span><span class="op" id="7919956">,</span>&nbsp;<span class="num" id="7919958">0xbc42d2f3</span><span class="op" id="7919968">,</span>&nbsp;<span class="num" id="7919970">0x7555114a</span><span class="op" id="7919980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7919985">0x6efcd876</span><span class="op" id="7919995">,</span>&nbsp;<span class="num" id="7919997">0xd2df5480</span><span class="op" id="7920007">,</span>&nbsp;<span class="num" id="7920009">0x7c5df034</span><span class="op" id="7920019">,</span>&nbsp;<span class="num" id="7920021">0xc917c3b9</span><span class="op" id="7920031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920036">0x6ea30afc</span><span class="op" id="7920046">,</span>&nbsp;<span class="num" id="7920048">0xbc238cf6</span><span class="op" id="7920058">,</span>&nbsp;<span class="num" id="7920060">0xae82a4b4</span><span class="op" id="7920070">,</span>&nbsp;<span class="num" id="7920072">0xb54a338d</span><span class="op" id="7920082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920087">0x90884413</span><span class="op" id="7920097">,</span>&nbsp;<span class="num" id="7920099">0xd280860a</span><span class="op" id="7920109">,</span>&nbsp;<span class="num" id="7920111">0x12a12842</span><span class="op" id="7920121">,</span>&nbsp;<span class="num" id="7920123">0x1bc89739</span><span class="op" id="7920133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920138">0x7c1f13f7</span><span class="op" id="7920148">,</span>&nbsp;<span class="num" id="7920150">0x4208c219</span><span class="op" id="7920160">,</span>&nbsp;<span class="num" id="7920162">0xc021ae48</span><span class="op" id="7920172">,</span>&nbsp;<span class="num" id="7920174">0x969bf7b</span><span class="op" id="7920183">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920188">0xcc7505eb</span><span class="op" id="7920198">,</span>&nbsp;<span class="num" id="7920200">0x3e17d1ee</span><span class="op" id="7920210">,</span>&nbsp;<span class="num" id="7920212">0x82296c51</span><span class="op" id="7920222">,</span>&nbsp;<span class="num" id="7920224">0xc9481133</span><span class="op" id="7920234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920239">0x2b3708a7</span><span class="op" id="7920249">,</span>&nbsp;<span class="num" id="7920251">0xf262d405</span><span class="op" id="7920261">,</span>&nbsp;<span class="num" id="7920263">0xbc3ebdbf</span><span class="op" id="7920273">,</span>&nbsp;<span class="num" id="7920275">0x4b617d62</span><span class="op" id="7920285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920290">0x2b7e1516</span><span class="op" id="7920300">,</span>&nbsp;<span class="num" id="7920302">0x28aed2a6</span><span class="op" id="7920312">,</span>&nbsp;<span class="num" id="7920314">0xabf71588</span><span class="op" id="7920324">,</span>&nbsp;<span class="num" id="7920326">0x9cf4f3c</span><span class="op" id="7920335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920339">}</span><span class="op" id="7920340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920343">}</span><span class="op" id="7920344">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7920351">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920396">[</span><span class="op" id="7920397">]</span><span class="builtintype" id="7920398">byte</span><span class="op" id="7920402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920407">0x8e</span><span class="op" id="7920411">,</span>&nbsp;<span class="num" id="7920413">0x73</span><span class="op" id="7920417">,</span>&nbsp;<span class="num" id="7920419">0xb0</span><span class="op" id="7920423">,</span>&nbsp;<span class="num" id="7920425">0xf7</span><span class="op" id="7920429">,</span>&nbsp;<span class="num" id="7920431">0xda</span><span class="op" id="7920435">,</span>&nbsp;<span class="num" id="7920437">0x0e</span><span class="op" id="7920441">,</span>&nbsp;<span class="num" id="7920443">0x64</span><span class="op" id="7920447">,</span>&nbsp;<span class="num" id="7920449">0x52</span><span class="op" id="7920453">,</span>&nbsp;<span class="num" id="7920455">0xc8</span><span class="op" id="7920459">,</span>&nbsp;<span class="num" id="7920461">0x10</span><span class="op" id="7920465">,</span>&nbsp;<span class="num" id="7920467">0xf3</span><span class="op" id="7920471">,</span>&nbsp;<span class="num" id="7920473">0x2b</span><span class="op" id="7920477">,</span>&nbsp;<span class="num" id="7920479">0x80</span><span class="op" id="7920483">,</span>&nbsp;<span class="num" id="7920485">0x90</span><span class="op" id="7920489">,</span>&nbsp;<span class="num" id="7920491">0x79</span><span class="op" id="7920495">,</span>&nbsp;<span class="num" id="7920497">0xe5</span><span class="op" id="7920501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920506">0x62</span><span class="op" id="7920510">,</span>&nbsp;<span class="num" id="7920512">0xf8</span><span class="op" id="7920516">,</span>&nbsp;<span class="num" id="7920518">0xea</span><span class="op" id="7920522">,</span>&nbsp;<span class="num" id="7920524">0xd2</span><span class="op" id="7920528">,</span>&nbsp;<span class="num" id="7920530">0x52</span><span class="op" id="7920534">,</span>&nbsp;<span class="num" id="7920536">0x2c</span><span class="op" id="7920540">,</span>&nbsp;<span class="num" id="7920542">0x6b</span><span class="op" id="7920546">,</span>&nbsp;<span class="num" id="7920548">0x7b</span><span class="op" id="7920552">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920556">}</span><span class="op" id="7920557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920561">[</span><span class="op" id="7920562">]</span><span class="builtintype" id="7920563">uint32</span><span class="op" id="7920569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920574">0x8e73b0f7</span><span class="op" id="7920584">,</span>&nbsp;<span class="num" id="7920586">0xda0e6452</span><span class="op" id="7920596">,</span>&nbsp;<span class="num" id="7920598">0xc810f32b</span><span class="op" id="7920608">,</span>&nbsp;<span class="num" id="7920610">0x809079e5</span><span class="op" id="7920620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920625">0x62f8ead2</span><span class="op" id="7920635">,</span>&nbsp;<span class="num" id="7920637">0x522c6b7b</span><span class="op" id="7920647">,</span>&nbsp;<span class="num" id="7920649">0xfe0c91f7</span><span class="op" id="7920659">,</span>&nbsp;<span class="num" id="7920661">0x2402f5a5</span><span class="op" id="7920671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920676">0xec12068e</span><span class="op" id="7920686">,</span>&nbsp;<span class="num" id="7920688">0x6c827f6b</span><span class="op" id="7920698">,</span>&nbsp;<span class="num" id="7920700">0x0e7a95b9</span><span class="op" id="7920710">,</span>&nbsp;<span class="num" id="7920712">0x5c56fec2</span><span class="op" id="7920722">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920727">0x4db7b4bd</span><span class="op" id="7920737">,</span>&nbsp;<span class="num" id="7920739">0x69b54118</span><span class="op" id="7920749">,</span>&nbsp;<span class="num" id="7920751">0x85a74796</span><span class="op" id="7920761">,</span>&nbsp;<span class="num" id="7920763">0xe92538fd</span><span class="op" id="7920773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920778">0xe75fad44</span><span class="op" id="7920788">,</span>&nbsp;<span class="num" id="7920790">0xbb095386</span><span class="op" id="7920800">,</span>&nbsp;<span class="num" id="7920802">0x485af057</span><span class="op" id="7920812">,</span>&nbsp;<span class="num" id="7920814">0x21efb14f</span><span class="op" id="7920824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920829">0xa448f6d9</span><span class="op" id="7920839">,</span>&nbsp;<span class="num" id="7920841">0x4d6dce24</span><span class="op" id="7920851">,</span>&nbsp;<span class="num" id="7920853">0xaa326360</span><span class="op" id="7920863">,</span>&nbsp;<span class="num" id="7920865">0x113b30e6</span><span class="op" id="7920875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920880">0xa25e7ed5</span><span class="op" id="7920890">,</span>&nbsp;<span class="num" id="7920892">0x83b1cf9a</span><span class="op" id="7920902">,</span>&nbsp;<span class="num" id="7920904">0x27f93943</span><span class="op" id="7920914">,</span>&nbsp;<span class="num" id="7920916">0x6a94f767</span><span class="op" id="7920926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920931">0xc0a69407</span><span class="op" id="7920941">,</span>&nbsp;<span class="num" id="7920943">0xd19da4e1</span><span class="op" id="7920953">,</span>&nbsp;<span class="num" id="7920955">0xec1786eb</span><span class="op" id="7920965">,</span>&nbsp;<span class="num" id="7920967">0x6fa64971</span><span class="op" id="7920977">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7920982">0x485f7032</span><span class="op" id="7920992">,</span>&nbsp;<span class="num" id="7920994">0x22cb8755</span><span class="op" id="7921004">,</span>&nbsp;<span class="num" id="7921006">0xe26d1352</span><span class="op" id="7921016">,</span>&nbsp;<span class="num" id="7921018">0x33f0b7b3</span><span class="op" id="7921028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921033">0x40beeb28</span><span class="op" id="7921043">,</span>&nbsp;<span class="num" id="7921045">0x2f18a259</span><span class="op" id="7921055">,</span>&nbsp;<span class="num" id="7921057">0x6747d26b</span><span class="op" id="7921067">,</span>&nbsp;<span class="num" id="7921069">0x458c553e</span><span class="op" id="7921079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921084">0xa7e1466c</span><span class="op" id="7921094">,</span>&nbsp;<span class="num" id="7921096">0x9411f1df</span><span class="op" id="7921106">,</span>&nbsp;<span class="num" id="7921108">0x821f750a</span><span class="op" id="7921118">,</span>&nbsp;<span class="num" id="7921120">0xad07d753</span><span class="op" id="7921130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921135">0xca400538</span><span class="op" id="7921145">,</span>&nbsp;<span class="num" id="7921147">0x8fcc5006</span><span class="op" id="7921157">,</span>&nbsp;<span class="num" id="7921159">0x282d166a</span><span class="op" id="7921169">,</span>&nbsp;<span class="num" id="7921171">0xbc3ce7b5</span><span class="op" id="7921181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921186">0xe98ba06f</span><span class="op" id="7921196">,</span>&nbsp;<span class="num" id="7921198">0x448c773c</span><span class="op" id="7921208">,</span>&nbsp;<span class="num" id="7921210">0x8ecc7204</span><span class="op" id="7921220">,</span>&nbsp;<span class="num" id="7921222">0x01002202</span><span class="op" id="7921232">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921236">}</span><span class="op" id="7921237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921241">nil</span><span class="op" id="7921244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921247">}</span><span class="op" id="7921248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7921255">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921300">[</span><span class="op" id="7921301">]</span><span class="builtintype" id="7921302">byte</span><span class="op" id="7921306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921311">0x60</span><span class="op" id="7921315">,</span>&nbsp;<span class="num" id="7921317">0x3d</span><span class="op" id="7921321">,</span>&nbsp;<span class="num" id="7921323">0xeb</span><span class="op" id="7921327">,</span>&nbsp;<span class="num" id="7921329">0x10</span><span class="op" id="7921333">,</span>&nbsp;<span class="num" id="7921335">0x15</span><span class="op" id="7921339">,</span>&nbsp;<span class="num" id="7921341">0xca</span><span class="op" id="7921345">,</span>&nbsp;<span class="num" id="7921347">0x71</span><span class="op" id="7921351">,</span>&nbsp;<span class="num" id="7921353">0xbe</span><span class="op" id="7921357">,</span>&nbsp;<span class="num" id="7921359">0x2b</span><span class="op" id="7921363">,</span>&nbsp;<span class="num" id="7921365">0x73</span><span class="op" id="7921369">,</span>&nbsp;<span class="num" id="7921371">0xae</span><span class="op" id="7921375">,</span>&nbsp;<span class="num" id="7921377">0xf0</span><span class="op" id="7921381">,</span>&nbsp;<span class="num" id="7921383">0x85</span><span class="op" id="7921387">,</span>&nbsp;<span class="num" id="7921389">0x7d</span><span class="op" id="7921393">,</span>&nbsp;<span class="num" id="7921395">0x77</span><span class="op" id="7921399">,</span>&nbsp;<span class="num" id="7921401">0x81</span><span class="op" id="7921405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921410">0x1f</span><span class="op" id="7921414">,</span>&nbsp;<span class="num" id="7921416">0x35</span><span class="op" id="7921420">,</span>&nbsp;<span class="num" id="7921422">0x2c</span><span class="op" id="7921426">,</span>&nbsp;<span class="num" id="7921428">0x07</span><span class="op" id="7921432">,</span>&nbsp;<span class="num" id="7921434">0x3b</span><span class="op" id="7921438">,</span>&nbsp;<span class="num" id="7921440">0x61</span><span class="op" id="7921444">,</span>&nbsp;<span class="num" id="7921446">0x08</span><span class="op" id="7921450">,</span>&nbsp;<span class="num" id="7921452">0xd7</span><span class="op" id="7921456">,</span>&nbsp;<span class="num" id="7921458">0x2d</span><span class="op" id="7921462">,</span>&nbsp;<span class="num" id="7921464">0x98</span><span class="op" id="7921468">,</span>&nbsp;<span class="num" id="7921470">0x10</span><span class="op" id="7921474">,</span>&nbsp;<span class="num" id="7921476">0xa3</span><span class="op" id="7921480">,</span>&nbsp;<span class="num" id="7921482">0x09</span><span class="op" id="7921486">,</span>&nbsp;<span class="num" id="7921488">0x14</span><span class="op" id="7921492">,</span>&nbsp;<span class="num" id="7921494">0xdf</span><span class="op" id="7921498">,</span>&nbsp;<span class="num" id="7921500">0xf4</span><span class="op" id="7921504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921508">}</span><span class="op" id="7921509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921513">[</span><span class="op" id="7921514">]</span><span class="builtintype" id="7921515">uint32</span><span class="op" id="7921521">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921526">0x603deb10</span><span class="op" id="7921536">,</span>&nbsp;<span class="num" id="7921538">0x15ca71be</span><span class="op" id="7921548">,</span>&nbsp;<span class="num" id="7921550">0x2b73aef0</span><span class="op" id="7921560">,</span>&nbsp;<span class="num" id="7921562">0x857d7781</span><span class="op" id="7921572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921577">0x1f352c07</span><span class="op" id="7921587">,</span>&nbsp;<span class="num" id="7921589">0x3b6108d7</span><span class="op" id="7921599">,</span>&nbsp;<span class="num" id="7921601">0x2d9810a3</span><span class="op" id="7921611">,</span>&nbsp;<span class="num" id="7921613">0x0914dff4</span><span class="op" id="7921623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921628">0x9ba35411</span><span class="op" id="7921638">,</span>&nbsp;<span class="num" id="7921640">0x8e6925af</span><span class="op" id="7921650">,</span>&nbsp;<span class="num" id="7921652">0xa51a8b5f</span><span class="op" id="7921662">,</span>&nbsp;<span class="num" id="7921664">0x2067fcde</span><span class="op" id="7921674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921679">0xa8b09c1a</span><span class="op" id="7921689">,</span>&nbsp;<span class="num" id="7921691">0x93d194cd</span><span class="op" id="7921701">,</span>&nbsp;<span class="num" id="7921703">0xbe49846e</span><span class="op" id="7921713">,</span>&nbsp;<span class="num" id="7921715">0xb75d5b9a</span><span class="op" id="7921725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921730">0xd59aecb8</span><span class="op" id="7921740">,</span>&nbsp;<span class="num" id="7921742">0x5bf3c917</span><span class="op" id="7921752">,</span>&nbsp;<span class="num" id="7921754">0xfee94248</span><span class="op" id="7921764">,</span>&nbsp;<span class="num" id="7921766">0xde8ebe96</span><span class="op" id="7921776">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921781">0xb5a9328a</span><span class="op" id="7921791">,</span>&nbsp;<span class="num" id="7921793">0x2678a647</span><span class="op" id="7921803">,</span>&nbsp;<span class="num" id="7921805">0x98312229</span><span class="op" id="7921815">,</span>&nbsp;<span class="num" id="7921817">0x2f6c79b3</span><span class="op" id="7921827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921832">0x812c81ad</span><span class="op" id="7921842">,</span>&nbsp;<span class="num" id="7921844">0xdadf48ba</span><span class="op" id="7921854">,</span>&nbsp;<span class="num" id="7921856">0x24360af2</span><span class="op" id="7921866">,</span>&nbsp;<span class="num" id="7921868">0xfab8b464</span><span class="op" id="7921878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921883">0x98c5bfc9</span><span class="op" id="7921893">,</span>&nbsp;<span class="num" id="7921895">0xbebd198e</span><span class="op" id="7921905">,</span>&nbsp;<span class="num" id="7921907">0x268c3ba7</span><span class="op" id="7921917">,</span>&nbsp;<span class="num" id="7921919">0x09e04214</span><span class="op" id="7921929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921934">0x68007bac</span><span class="op" id="7921944">,</span>&nbsp;<span class="num" id="7921946">0xb2df3316</span><span class="op" id="7921956">,</span>&nbsp;<span class="num" id="7921958">0x96e939e4</span><span class="op" id="7921968">,</span>&nbsp;<span class="num" id="7921970">0x6c518d80</span><span class="op" id="7921980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7921985">0xc814e204</span><span class="op" id="7921995">,</span>&nbsp;<span class="num" id="7921997">0x76a9fb8a</span><span class="op" id="7922007">,</span>&nbsp;<span class="num" id="7922009">0x5025c02d</span><span class="op" id="7922019">,</span>&nbsp;<span class="num" id="7922021">0x59c58239</span><span class="op" id="7922031">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7922036">0xde136967</span><span class="op" id="7922046">,</span>&nbsp;<span class="num" id="7922048">0x6ccc5a71</span><span class="op" id="7922058">,</span>&nbsp;<span class="num" id="7922060">0xfa256395</span><span class="op" id="7922070">,</span>&nbsp;<span class="num" id="7922072">0x9674ee15</span><span class="op" id="7922082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7922087">0x5886ca5d</span><span class="op" id="7922097">,</span>&nbsp;<span class="num" id="7922099">0x2e2f31d7</span><span class="op" id="7922109">,</span>&nbsp;<span class="num" id="7922111">0x7e0af1fa</span><span class="op" id="7922121">,</span>&nbsp;<span class="num" id="7922123">0x27cf73c3</span><span class="op" id="7922133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7922138">0x749c47ab</span><span class="op" id="7922148">,</span>&nbsp;<span class="num" id="7922150">0x18501dda</span><span class="op" id="7922160">,</span>&nbsp;<span class="num" id="7922162">0xe2757e4f</span><span class="op" id="7922172">,</span>&nbsp;<span class="num" id="7922174">0x7401905a</span><span class="op" id="7922184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7922189">0xcafaaae3</span><span class="op" id="7922199">,</span>&nbsp;<span class="num" id="7922201">0xe4d59b34</span><span class="op" id="7922211">,</span>&nbsp;<span class="num" id="7922213">0x9adf6ace</span><span class="op" id="7922223">,</span>&nbsp;<span class="num" id="7922225">0xbd10190d</span><span class="op" id="7922235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7922240">0xfe4890d1</span><span class="op" id="7922250">,</span>&nbsp;<span class="num" id="7922252">0xe6188d0b</span><span class="op" id="7922262">,</span>&nbsp;<span class="num" id="7922264">0x046df344</span><span class="op" id="7922274">,</span>&nbsp;<span class="num" id="7922276">0x706c631e</span><span class="op" id="7922286">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922290">}</span><span class="op" id="7922291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922295">nil</span><span class="op" id="7922298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922301">}</span><span class="op" id="7922302">,</span><br>
<span class="lineno"></span><span class="op" id="7922304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="7922307">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7922356">func</span>&nbsp;<span class="ident" id="7922361">TestExpandKey</span><span class="op" id="7922374">(</span><span class="ident" id="7922375">t</span>&nbsp;<span class="op" id="7922377">*</span><span class="ident" id="7922378">testing</span><span class="op" id="7922385">.</span><span class="ident" id="7922386">T</span><span class="op" id="7922387">)</span>&nbsp;<span class="op" id="7922389">{</span><br>
<span class="lineno"></span><span class="ident" id="7922391">L</span><span class="op" id="7922392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922395">for</span>&nbsp;<span class="ident" id="7922399">i</span><span class="op" id="7922400">,</span>&nbsp;<span class="ident" id="7922402">tt</span>&nbsp;<span class="op" id="7922405">:=</span>&nbsp;<span class="keyword" id="7922408">range</span>&nbsp;<span class="ident" id="7922414">keyTests</span>&nbsp;<span class="op" id="7922423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922427">enc</span>&nbsp;<span class="op" id="7922431">:=</span>&nbsp;<span class="builtinfunc" id="7922434">make</span><span class="op" id="7922438">(</span><span class="op" id="7922439">[</span><span class="op" id="7922440">]</span><span class="builtintype" id="7922441">uint32</span><span class="op" id="7922447">,</span>&nbsp;<span class="builtinfunc" id="7922449">len</span><span class="op" id="7922452">(</span><span class="ident" id="7922453">tt</span><span class="op" id="7922455">.</span><span class="ident" id="7922456">enc</span><span class="op" id="7922459">)</span><span class="op" id="7922460">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922464">var</span>&nbsp;<span class="ident" id="7922468">dec</span>&nbsp;<span class="op" id="7922472">[</span><span class="op" id="7922473">]</span><span class="builtintype" id="7922474">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922483">if</span>&nbsp;<span class="ident" id="7922486">tt</span><span class="op" id="7922488">.</span><span class="ident" id="7922489">dec</span>&nbsp;<span class="op" id="7922493">!=</span>&nbsp;<span class="ident" id="7922496">nil</span>&nbsp;<span class="op" id="7922500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922505">dec</span>&nbsp;<span class="op" id="7922509">=</span>&nbsp;<span class="builtinfunc" id="7922511">make</span><span class="op" id="7922515">(</span><span class="op" id="7922516">[</span><span class="op" id="7922517">]</span><span class="builtintype" id="7922518">uint32</span><span class="op" id="7922524">,</span>&nbsp;<span class="builtinfunc" id="7922526">len</span><span class="op" id="7922529">(</span><span class="ident" id="7922530">tt</span><span class="op" id="7922532">.</span><span class="ident" id="7922533">dec</span><span class="op" id="7922536">)</span><span class="op" id="7922537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7922545">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7922612">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7922677">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922746">expandKeyGo</span><span class="op" id="7922757">(</span><span class="ident" id="7922758">tt</span><span class="op" id="7922760">.</span><span class="ident" id="7922761">key</span><span class="op" id="7922764">,</span>&nbsp;<span class="ident" id="7922766">enc</span><span class="op" id="7922769">,</span>&nbsp;<span class="ident" id="7922771">dec</span><span class="op" id="7922774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922778">for</span>&nbsp;<span class="ident" id="7922782">j</span><span class="op" id="7922783">,</span>&nbsp;<span class="ident" id="7922785">v</span>&nbsp;<span class="op" id="7922787">:=</span>&nbsp;<span class="keyword" id="7922790">range</span>&nbsp;<span class="ident" id="7922796">enc</span>&nbsp;<span class="op" id="7922800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922805">if</span>&nbsp;<span class="ident" id="7922808">v</span>&nbsp;<span class="op" id="7922810">!=</span>&nbsp;<span class="ident" id="7922813">tt</span><span class="op" id="7922815">.</span><span class="ident" id="7922816">enc</span><span class="op" id="7922819">[</span><span class="ident" id="7922820">j</span><span class="op" id="7922821">]</span>&nbsp;<span class="op" id="7922823">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922829">t</span><span class="op" id="7922830">.</span><span class="ident" id="7922831">Errorf</span><span class="op" id="7922837">(</span><span class="string" id="7922838">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7922871">,</span>&nbsp;<span class="ident" id="7922873">i</span><span class="op" id="7922874">,</span>&nbsp;<span class="ident" id="7922876">j</span><span class="op" id="7922877">,</span>&nbsp;<span class="ident" id="7922879">v</span><span class="op" id="7922880">,</span>&nbsp;<span class="ident" id="7922882">tt</span><span class="op" id="7922884">.</span><span class="ident" id="7922885">enc</span><span class="op" id="7922888">[</span><span class="ident" id="7922889">j</span><span class="op" id="7922890">]</span><span class="op" id="7922891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922897">continue</span>&nbsp;<span class="ident" id="7922906">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922919">if</span>&nbsp;<span class="ident" id="7922922">dec</span>&nbsp;<span class="op" id="7922926">!=</span>&nbsp;<span class="ident" id="7922929">nil</span>&nbsp;<span class="op" id="7922933">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922938">for</span>&nbsp;<span class="ident" id="7922942">j</span><span class="op" id="7922943">,</span>&nbsp;<span class="ident" id="7922945">v</span>&nbsp;<span class="op" id="7922947">:=</span>&nbsp;<span class="keyword" id="7922950">range</span>&nbsp;<span class="ident" id="7922956">dec</span>&nbsp;<span class="op" id="7922960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922966">if</span>&nbsp;<span class="ident" id="7922969">v</span>&nbsp;<span class="op" id="7922971">!=</span>&nbsp;<span class="ident" id="7922974">tt</span><span class="op" id="7922976">.</span><span class="ident" id="7922977">dec</span><span class="op" id="7922980">[</span><span class="ident" id="7922981">j</span><span class="op" id="7922982">]</span>&nbsp;<span class="op" id="7922984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922991">t</span><span class="op" id="7922992">.</span><span class="ident" id="7922993">Errorf</span><span class="op" id="7922999">(</span><span class="string" id="7923000">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7923033">,</span>&nbsp;<span class="ident" id="7923035">i</span><span class="op" id="7923036">,</span>&nbsp;<span class="ident" id="7923038">j</span><span class="op" id="7923039">,</span>&nbsp;<span class="ident" id="7923041">v</span><span class="op" id="7923042">,</span>&nbsp;<span class="ident" id="7923044">tt</span><span class="op" id="7923046">.</span><span class="ident" id="7923047">dec</span><span class="op" id="7923050">[</span><span class="ident" id="7923051">j</span><span class="op" id="7923052">]</span><span class="op" id="7923053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923060">continue</span>&nbsp;<span class="ident" id="7923069">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923075">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923087">}</span><br>
<span class="lineno"></span><span class="op" id="7923089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="7923092">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="7923156">type</span>&nbsp;<span class="ident" id="7923161">CryptTest</span>&nbsp;<span class="keyword" id="7923171">struct</span>&nbsp;<span class="op" id="7923178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923181">key</span>&nbsp;<span class="op" id="7923185">[</span><span class="op" id="7923186">]</span><span class="builtintype" id="7923187">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923193">in</span>&nbsp;&nbsp;<span class="op" id="7923197">[</span><span class="op" id="7923198">]</span><span class="builtintype" id="7923199">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923205">out</span>&nbsp;<span class="op" id="7923209">[</span><span class="op" id="7923210">]</span><span class="builtintype" id="7923211">byte</span><br>
<span class="lineno">250</span><span class="op" id="7923216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7923219">var</span>&nbsp;<span class="ident" id="7923223">encryptTests</span>&nbsp;<span class="op" id="7923236">=</span>&nbsp;<span class="op" id="7923238">[</span><span class="op" id="7923239">]</span><span class="ident" id="7923240">CryptTest</span><span class="op" id="7923249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923256">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923273">[</span><span class="op" id="7923274">]</span><span class="builtintype" id="7923275">byte</span><span class="op" id="7923279">{</span><span class="num" id="7923280">0x2b</span><span class="op" id="7923284">,</span>&nbsp;<span class="num" id="7923286">0x7e</span><span class="op" id="7923290">,</span>&nbsp;<span class="num" id="7923292">0x15</span><span class="op" id="7923296">,</span>&nbsp;<span class="num" id="7923298">0x16</span><span class="op" id="7923302">,</span>&nbsp;<span class="num" id="7923304">0x28</span><span class="op" id="7923308">,</span>&nbsp;<span class="num" id="7923310">0xae</span><span class="op" id="7923314">,</span>&nbsp;<span class="num" id="7923316">0xd2</span><span class="op" id="7923320">,</span>&nbsp;<span class="num" id="7923322">0xa6</span><span class="op" id="7923326">,</span>&nbsp;<span class="num" id="7923328">0xab</span><span class="op" id="7923332">,</span>&nbsp;<span class="num" id="7923334">0xf7</span><span class="op" id="7923338">,</span>&nbsp;<span class="num" id="7923340">0x15</span><span class="op" id="7923344">,</span>&nbsp;<span class="num" id="7923346">0x88</span><span class="op" id="7923350">,</span>&nbsp;<span class="num" id="7923352">0x09</span><span class="op" id="7923356">,</span>&nbsp;<span class="num" id="7923358">0xcf</span><span class="op" id="7923362">,</span>&nbsp;<span class="num" id="7923364">0x4f</span><span class="op" id="7923368">,</span>&nbsp;<span class="num" id="7923370">0x3c</span><span class="op" id="7923374">}</span><span class="op" id="7923375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923379">[</span><span class="op" id="7923380">]</span><span class="builtintype" id="7923381">byte</span><span class="op" id="7923385">{</span><span class="num" id="7923386">0x32</span><span class="op" id="7923390">,</span>&nbsp;<span class="num" id="7923392">0x43</span><span class="op" id="7923396">,</span>&nbsp;<span class="num" id="7923398">0xf6</span><span class="op" id="7923402">,</span>&nbsp;<span class="num" id="7923404">0xa8</span><span class="op" id="7923408">,</span>&nbsp;<span class="num" id="7923410">0x88</span><span class="op" id="7923414">,</span>&nbsp;<span class="num" id="7923416">0x5a</span><span class="op" id="7923420">,</span>&nbsp;<span class="num" id="7923422">0x30</span><span class="op" id="7923426">,</span>&nbsp;<span class="num" id="7923428">0x8d</span><span class="op" id="7923432">,</span>&nbsp;<span class="num" id="7923434">0x31</span><span class="op" id="7923438">,</span>&nbsp;<span class="num" id="7923440">0x31</span><span class="op" id="7923444">,</span>&nbsp;<span class="num" id="7923446">0x98</span><span class="op" id="7923450">,</span>&nbsp;<span class="num" id="7923452">0xa2</span><span class="op" id="7923456">,</span>&nbsp;<span class="num" id="7923458">0xe0</span><span class="op" id="7923462">,</span>&nbsp;<span class="num" id="7923464">0x37</span><span class="op" id="7923468">,</span>&nbsp;<span class="num" id="7923470">0x07</span><span class="op" id="7923474">,</span>&nbsp;<span class="num" id="7923476">0x34</span><span class="op" id="7923480">}</span><span class="op" id="7923481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923485">[</span><span class="op" id="7923486">]</span><span class="builtintype" id="7923487">byte</span><span class="op" id="7923491">{</span><span class="num" id="7923492">0x39</span><span class="op" id="7923496">,</span>&nbsp;<span class="num" id="7923498">0x25</span><span class="op" id="7923502">,</span>&nbsp;<span class="num" id="7923504">0x84</span><span class="op" id="7923508">,</span>&nbsp;<span class="num" id="7923510">0x1d</span><span class="op" id="7923514">,</span>&nbsp;<span class="num" id="7923516">0x02</span><span class="op" id="7923520">,</span>&nbsp;<span class="num" id="7923522">0xdc</span><span class="op" id="7923526">,</span>&nbsp;<span class="num" id="7923528">0x09</span><span class="op" id="7923532">,</span>&nbsp;<span class="num" id="7923534">0xfb</span><span class="op" id="7923538">,</span>&nbsp;<span class="num" id="7923540">0xdc</span><span class="op" id="7923544">,</span>&nbsp;<span class="num" id="7923546">0x11</span><span class="op" id="7923550">,</span>&nbsp;<span class="num" id="7923552">0x85</span><span class="op" id="7923556">,</span>&nbsp;<span class="num" id="7923558">0x97</span><span class="op" id="7923562">,</span>&nbsp;<span class="num" id="7923564">0x19</span><span class="op" id="7923568">,</span>&nbsp;<span class="num" id="7923570">0x6a</span><span class="op" id="7923574">,</span>&nbsp;<span class="num" id="7923576">0x0b</span><span class="op" id="7923580">,</span>&nbsp;<span class="num" id="7923582">0x32</span><span class="op" id="7923586">}</span><span class="op" id="7923587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923590">}</span><span class="op" id="7923591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923594">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923598">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923626">[</span><span class="op" id="7923627">]</span><span class="builtintype" id="7923628">byte</span><span class="op" id="7923632">{</span><span class="num" id="7923633">0x00</span><span class="op" id="7923637">,</span>&nbsp;<span class="num" id="7923639">0x01</span><span class="op" id="7923643">,</span>&nbsp;<span class="num" id="7923645">0x02</span><span class="op" id="7923649">,</span>&nbsp;<span class="num" id="7923651">0x03</span><span class="op" id="7923655">,</span>&nbsp;<span class="num" id="7923657">0x04</span><span class="op" id="7923661">,</span>&nbsp;<span class="num" id="7923663">0x05</span><span class="op" id="7923667">,</span>&nbsp;<span class="num" id="7923669">0x06</span><span class="op" id="7923673">,</span>&nbsp;<span class="num" id="7923675">0x07</span><span class="op" id="7923679">,</span>&nbsp;<span class="num" id="7923681">0x08</span><span class="op" id="7923685">,</span>&nbsp;<span class="num" id="7923687">0x09</span><span class="op" id="7923691">,</span>&nbsp;<span class="num" id="7923693">0x0a</span><span class="op" id="7923697">,</span>&nbsp;<span class="num" id="7923699">0x0b</span><span class="op" id="7923703">,</span>&nbsp;<span class="num" id="7923705">0x0c</span><span class="op" id="7923709">,</span>&nbsp;<span class="num" id="7923711">0x0d</span><span class="op" id="7923715">,</span>&nbsp;<span class="num" id="7923717">0x0e</span><span class="op" id="7923721">,</span>&nbsp;<span class="num" id="7923723">0x0f</span><span class="op" id="7923727">}</span><span class="op" id="7923728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923732">[</span><span class="op" id="7923733">]</span><span class="builtintype" id="7923734">byte</span><span class="op" id="7923738">{</span><span class="num" id="7923739">0x00</span><span class="op" id="7923743">,</span>&nbsp;<span class="num" id="7923745">0x11</span><span class="op" id="7923749">,</span>&nbsp;<span class="num" id="7923751">0x22</span><span class="op" id="7923755">,</span>&nbsp;<span class="num" id="7923757">0x33</span><span class="op" id="7923761">,</span>&nbsp;<span class="num" id="7923763">0x44</span><span class="op" id="7923767">,</span>&nbsp;<span class="num" id="7923769">0x55</span><span class="op" id="7923773">,</span>&nbsp;<span class="num" id="7923775">0x66</span><span class="op" id="7923779">,</span>&nbsp;<span class="num" id="7923781">0x77</span><span class="op" id="7923785">,</span>&nbsp;<span class="num" id="7923787">0x88</span><span class="op" id="7923791">,</span>&nbsp;<span class="num" id="7923793">0x99</span><span class="op" id="7923797">,</span>&nbsp;<span class="num" id="7923799">0xaa</span><span class="op" id="7923803">,</span>&nbsp;<span class="num" id="7923805">0xbb</span><span class="op" id="7923809">,</span>&nbsp;<span class="num" id="7923811">0xcc</span><span class="op" id="7923815">,</span>&nbsp;<span class="num" id="7923817">0xdd</span><span class="op" id="7923821">,</span>&nbsp;<span class="num" id="7923823">0xee</span><span class="op" id="7923827">,</span>&nbsp;<span class="num" id="7923829">0xff</span><span class="op" id="7923833">}</span><span class="op" id="7923834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923838">[</span><span class="op" id="7923839">]</span><span class="builtintype" id="7923840">byte</span><span class="op" id="7923844">{</span><span class="num" id="7923845">0x69</span><span class="op" id="7923849">,</span>&nbsp;<span class="num" id="7923851">0xc4</span><span class="op" id="7923855">,</span>&nbsp;<span class="num" id="7923857">0xe0</span><span class="op" id="7923861">,</span>&nbsp;<span class="num" id="7923863">0xd8</span><span class="op" id="7923867">,</span>&nbsp;<span class="num" id="7923869">0x6a</span><span class="op" id="7923873">,</span>&nbsp;<span class="num" id="7923875">0x7b</span><span class="op" id="7923879">,</span>&nbsp;<span class="num" id="7923881">0x04</span><span class="op" id="7923885">,</span>&nbsp;<span class="num" id="7923887">0x30</span><span class="op" id="7923891">,</span>&nbsp;<span class="num" id="7923893">0xd8</span><span class="op" id="7923897">,</span>&nbsp;<span class="num" id="7923899">0xcd</span><span class="op" id="7923903">,</span>&nbsp;<span class="num" id="7923905">0xb7</span><span class="op" id="7923909">,</span>&nbsp;<span class="num" id="7923911">0x80</span><span class="op" id="7923915">,</span>&nbsp;<span class="num" id="7923917">0x70</span><span class="op" id="7923921">,</span>&nbsp;<span class="num" id="7923923">0xb4</span><span class="op" id="7923927">,</span>&nbsp;<span class="num" id="7923929">0xc5</span><span class="op" id="7923933">,</span>&nbsp;<span class="num" id="7923935">0x5a</span><span class="op" id="7923939">}</span><span class="op" id="7923940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923943">}</span><span class="op" id="7923944">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7923951">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923979">[</span><span class="op" id="7923980">]</span><span class="builtintype" id="7923981">byte</span><span class="op" id="7923985">{</span><span class="num" id="7923986">0x00</span><span class="op" id="7923990">,</span>&nbsp;<span class="num" id="7923992">0x01</span><span class="op" id="7923996">,</span>&nbsp;<span class="num" id="7923998">0x02</span><span class="op" id="7924002">,</span>&nbsp;<span class="num" id="7924004">0x03</span><span class="op" id="7924008">,</span>&nbsp;<span class="num" id="7924010">0x04</span><span class="op" id="7924014">,</span>&nbsp;<span class="num" id="7924016">0x05</span><span class="op" id="7924020">,</span>&nbsp;<span class="num" id="7924022">0x06</span><span class="op" id="7924026">,</span>&nbsp;<span class="num" id="7924028">0x07</span><span class="op" id="7924032">,</span>&nbsp;<span class="num" id="7924034">0x08</span><span class="op" id="7924038">,</span>&nbsp;<span class="num" id="7924040">0x09</span><span class="op" id="7924044">,</span>&nbsp;<span class="num" id="7924046">0x0a</span><span class="op" id="7924050">,</span>&nbsp;<span class="num" id="7924052">0x0b</span><span class="op" id="7924056">,</span>&nbsp;<span class="num" id="7924058">0x0c</span><span class="op" id="7924062">,</span>&nbsp;<span class="num" id="7924064">0x0d</span><span class="op" id="7924068">,</span>&nbsp;<span class="num" id="7924070">0x0e</span><span class="op" id="7924074">,</span>&nbsp;<span class="num" id="7924076">0x0f</span><span class="op" id="7924080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7924085">0x10</span><span class="op" id="7924089">,</span>&nbsp;<span class="num" id="7924091">0x11</span><span class="op" id="7924095">,</span>&nbsp;<span class="num" id="7924097">0x12</span><span class="op" id="7924101">,</span>&nbsp;<span class="num" id="7924103">0x13</span><span class="op" id="7924107">,</span>&nbsp;<span class="num" id="7924109">0x14</span><span class="op" id="7924113">,</span>&nbsp;<span class="num" id="7924115">0x15</span><span class="op" id="7924119">,</span>&nbsp;<span class="num" id="7924121">0x16</span><span class="op" id="7924125">,</span>&nbsp;<span class="num" id="7924127">0x17</span><span class="op" id="7924131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924135">}</span><span class="op" id="7924136">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924140">[</span><span class="op" id="7924141">]</span><span class="builtintype" id="7924142">byte</span><span class="op" id="7924146">{</span><span class="num" id="7924147">0x00</span><span class="op" id="7924151">,</span>&nbsp;<span class="num" id="7924153">0x11</span><span class="op" id="7924157">,</span>&nbsp;<span class="num" id="7924159">0x22</span><span class="op" id="7924163">,</span>&nbsp;<span class="num" id="7924165">0x33</span><span class="op" id="7924169">,</span>&nbsp;<span class="num" id="7924171">0x44</span><span class="op" id="7924175">,</span>&nbsp;<span class="num" id="7924177">0x55</span><span class="op" id="7924181">,</span>&nbsp;<span class="num" id="7924183">0x66</span><span class="op" id="7924187">,</span>&nbsp;<span class="num" id="7924189">0x77</span><span class="op" id="7924193">,</span>&nbsp;<span class="num" id="7924195">0x88</span><span class="op" id="7924199">,</span>&nbsp;<span class="num" id="7924201">0x99</span><span class="op" id="7924205">,</span>&nbsp;<span class="num" id="7924207">0xaa</span><span class="op" id="7924211">,</span>&nbsp;<span class="num" id="7924213">0xbb</span><span class="op" id="7924217">,</span>&nbsp;<span class="num" id="7924219">0xcc</span><span class="op" id="7924223">,</span>&nbsp;<span class="num" id="7924225">0xdd</span><span class="op" id="7924229">,</span>&nbsp;<span class="num" id="7924231">0xee</span><span class="op" id="7924235">,</span>&nbsp;<span class="num" id="7924237">0xff</span><span class="op" id="7924241">}</span><span class="op" id="7924242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924246">[</span><span class="op" id="7924247">]</span><span class="builtintype" id="7924248">byte</span><span class="op" id="7924252">{</span><span class="num" id="7924253">0xdd</span><span class="op" id="7924257">,</span>&nbsp;<span class="num" id="7924259">0xa9</span><span class="op" id="7924263">,</span>&nbsp;<span class="num" id="7924265">0x7c</span><span class="op" id="7924269">,</span>&nbsp;<span class="num" id="7924271">0xa4</span><span class="op" id="7924275">,</span>&nbsp;<span class="num" id="7924277">0x86</span><span class="op" id="7924281">,</span>&nbsp;<span class="num" id="7924283">0x4c</span><span class="op" id="7924287">,</span>&nbsp;<span class="num" id="7924289">0xdf</span><span class="op" id="7924293">,</span>&nbsp;<span class="num" id="7924295">0xe0</span><span class="op" id="7924299">,</span>&nbsp;<span class="num" id="7924301">0x6e</span><span class="op" id="7924305">,</span>&nbsp;<span class="num" id="7924307">0xaf</span><span class="op" id="7924311">,</span>&nbsp;<span class="num" id="7924313">0x70</span><span class="op" id="7924317">,</span>&nbsp;<span class="num" id="7924319">0xa0</span><span class="op" id="7924323">,</span>&nbsp;<span class="num" id="7924325">0xec</span><span class="op" id="7924329">,</span>&nbsp;<span class="num" id="7924331">0x0d</span><span class="op" id="7924335">,</span>&nbsp;<span class="num" id="7924337">0x71</span><span class="op" id="7924341">,</span>&nbsp;<span class="num" id="7924343">0x91</span><span class="op" id="7924347">}</span><span class="op" id="7924348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924351">}</span><span class="op" id="7924352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7924359">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924387">[</span><span class="op" id="7924388">]</span><span class="builtintype" id="7924389">byte</span><span class="op" id="7924393">{</span><span class="num" id="7924394">0x00</span><span class="op" id="7924398">,</span>&nbsp;<span class="num" id="7924400">0x01</span><span class="op" id="7924404">,</span>&nbsp;<span class="num" id="7924406">0x02</span><span class="op" id="7924410">,</span>&nbsp;<span class="num" id="7924412">0x03</span><span class="op" id="7924416">,</span>&nbsp;<span class="num" id="7924418">0x04</span><span class="op" id="7924422">,</span>&nbsp;<span class="num" id="7924424">0x05</span><span class="op" id="7924428">,</span>&nbsp;<span class="num" id="7924430">0x06</span><span class="op" id="7924434">,</span>&nbsp;<span class="num" id="7924436">0x07</span><span class="op" id="7924440">,</span>&nbsp;<span class="num" id="7924442">0x08</span><span class="op" id="7924446">,</span>&nbsp;<span class="num" id="7924448">0x09</span><span class="op" id="7924452">,</span>&nbsp;<span class="num" id="7924454">0x0a</span><span class="op" id="7924458">,</span>&nbsp;<span class="num" id="7924460">0x0b</span><span class="op" id="7924464">,</span>&nbsp;<span class="num" id="7924466">0x0c</span><span class="op" id="7924470">,</span>&nbsp;<span class="num" id="7924472">0x0d</span><span class="op" id="7924476">,</span>&nbsp;<span class="num" id="7924478">0x0e</span><span class="op" id="7924482">,</span>&nbsp;<span class="num" id="7924484">0x0f</span><span class="op" id="7924488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7924493">0x10</span><span class="op" id="7924497">,</span>&nbsp;<span class="num" id="7924499">0x11</span><span class="op" id="7924503">,</span>&nbsp;<span class="num" id="7924505">0x12</span><span class="op" id="7924509">,</span>&nbsp;<span class="num" id="7924511">0x13</span><span class="op" id="7924515">,</span>&nbsp;<span class="num" id="7924517">0x14</span><span class="op" id="7924521">,</span>&nbsp;<span class="num" id="7924523">0x15</span><span class="op" id="7924527">,</span>&nbsp;<span class="num" id="7924529">0x16</span><span class="op" id="7924533">,</span>&nbsp;<span class="num" id="7924535">0x17</span><span class="op" id="7924539">,</span>&nbsp;<span class="num" id="7924541">0x18</span><span class="op" id="7924545">,</span>&nbsp;<span class="num" id="7924547">0x19</span><span class="op" id="7924551">,</span>&nbsp;<span class="num" id="7924553">0x1a</span><span class="op" id="7924557">,</span>&nbsp;<span class="num" id="7924559">0x1b</span><span class="op" id="7924563">,</span>&nbsp;<span class="num" id="7924565">0x1c</span><span class="op" id="7924569">,</span>&nbsp;<span class="num" id="7924571">0x1d</span><span class="op" id="7924575">,</span>&nbsp;<span class="num" id="7924577">0x1e</span><span class="op" id="7924581">,</span>&nbsp;<span class="num" id="7924583">0x1f</span><span class="op" id="7924587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924591">}</span><span class="op" id="7924592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924596">[</span><span class="op" id="7924597">]</span><span class="builtintype" id="7924598">byte</span><span class="op" id="7924602">{</span><span class="num" id="7924603">0x00</span><span class="op" id="7924607">,</span>&nbsp;<span class="num" id="7924609">0x11</span><span class="op" id="7924613">,</span>&nbsp;<span class="num" id="7924615">0x22</span><span class="op" id="7924619">,</span>&nbsp;<span class="num" id="7924621">0x33</span><span class="op" id="7924625">,</span>&nbsp;<span class="num" id="7924627">0x44</span><span class="op" id="7924631">,</span>&nbsp;<span class="num" id="7924633">0x55</span><span class="op" id="7924637">,</span>&nbsp;<span class="num" id="7924639">0x66</span><span class="op" id="7924643">,</span>&nbsp;<span class="num" id="7924645">0x77</span><span class="op" id="7924649">,</span>&nbsp;<span class="num" id="7924651">0x88</span><span class="op" id="7924655">,</span>&nbsp;<span class="num" id="7924657">0x99</span><span class="op" id="7924661">,</span>&nbsp;<span class="num" id="7924663">0xaa</span><span class="op" id="7924667">,</span>&nbsp;<span class="num" id="7924669">0xbb</span><span class="op" id="7924673">,</span>&nbsp;<span class="num" id="7924675">0xcc</span><span class="op" id="7924679">,</span>&nbsp;<span class="num" id="7924681">0xdd</span><span class="op" id="7924685">,</span>&nbsp;<span class="num" id="7924687">0xee</span><span class="op" id="7924691">,</span>&nbsp;<span class="num" id="7924693">0xff</span><span class="op" id="7924697">}</span><span class="op" id="7924698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924702">[</span><span class="op" id="7924703">]</span><span class="builtintype" id="7924704">byte</span><span class="op" id="7924708">{</span><span class="num" id="7924709">0x8e</span><span class="op" id="7924713">,</span>&nbsp;<span class="num" id="7924715">0xa2</span><span class="op" id="7924719">,</span>&nbsp;<span class="num" id="7924721">0xb7</span><span class="op" id="7924725">,</span>&nbsp;<span class="num" id="7924727">0xca</span><span class="op" id="7924731">,</span>&nbsp;<span class="num" id="7924733">0x51</span><span class="op" id="7924737">,</span>&nbsp;<span class="num" id="7924739">0x67</span><span class="op" id="7924743">,</span>&nbsp;<span class="num" id="7924745">0x45</span><span class="op" id="7924749">,</span>&nbsp;<span class="num" id="7924751">0xbf</span><span class="op" id="7924755">,</span>&nbsp;<span class="num" id="7924757">0xea</span><span class="op" id="7924761">,</span>&nbsp;<span class="num" id="7924763">0xfc</span><span class="op" id="7924767">,</span>&nbsp;<span class="num" id="7924769">0x49</span><span class="op" id="7924773">,</span>&nbsp;<span class="num" id="7924775">0x90</span><span class="op" id="7924779">,</span>&nbsp;<span class="num" id="7924781">0x4b</span><span class="op" id="7924785">,</span>&nbsp;<span class="num" id="7924787">0x49</span><span class="op" id="7924791">,</span>&nbsp;<span class="num" id="7924793">0x60</span><span class="op" id="7924797">,</span>&nbsp;<span class="num" id="7924799">0x89</span><span class="op" id="7924803">}</span><span class="op" id="7924804">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924807">}</span><span class="op" id="7924808">,</span><br>
<span class="lineno"></span><span class="op" id="7924810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7924813">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7924861">func</span>&nbsp;<span class="ident" id="7924866">TestEncryptBlock</span><span class="op" id="7924882">(</span><span class="ident" id="7924883">t</span>&nbsp;<span class="op" id="7924885">*</span><span class="ident" id="7924886">testing</span><span class="op" id="7924893">.</span><span class="ident" id="7924894">T</span><span class="op" id="7924895">)</span>&nbsp;<span class="op" id="7924897">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924900">for</span>&nbsp;<span class="ident" id="7924904">i</span><span class="op" id="7924905">,</span>&nbsp;<span class="ident" id="7924907">tt</span>&nbsp;<span class="op" id="7924910">:=</span>&nbsp;<span class="keyword" id="7924913">range</span>&nbsp;<span class="ident" id="7924919">encryptTests</span>&nbsp;<span class="op" id="7924932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924936">n</span>&nbsp;<span class="op" id="7924938">:=</span>&nbsp;<span class="builtinfunc" id="7924941">len</span><span class="op" id="7924944">(</span><span class="ident" id="7924945">tt</span><span class="op" id="7924947">.</span><span class="ident" id="7924948">key</span><span class="op" id="7924951">)</span>&nbsp;<span class="op" id="7924953">+</span>&nbsp;<span class="num" id="7924955">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924960">enc</span>&nbsp;<span class="op" id="7924964">:=</span>&nbsp;<span class="builtinfunc" id="7924967">make</span><span class="op" id="7924971">(</span><span class="op" id="7924972">[</span><span class="op" id="7924973">]</span><span class="builtintype" id="7924974">uint32</span><span class="op" id="7924980">,</span>&nbsp;<span class="ident" id="7924982">n</span><span class="op" id="7924983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924987">dec</span>&nbsp;<span class="op" id="7924991">:=</span>&nbsp;<span class="builtinfunc" id="7924994">make</span><span class="op" id="7924998">(</span><span class="op" id="7924999">[</span><span class="op" id="7925000">]</span><span class="builtintype" id="7925001">uint32</span><span class="op" id="7925007">,</span>&nbsp;<span class="ident" id="7925009">n</span><span class="op" id="7925010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925014">expandKey</span><span class="op" id="7925023">(</span><span class="ident" id="7925024">tt</span><span class="op" id="7925026">.</span><span class="ident" id="7925027">key</span><span class="op" id="7925030">,</span>&nbsp;<span class="ident" id="7925032">enc</span><span class="op" id="7925035">,</span>&nbsp;<span class="ident" id="7925037">dec</span><span class="op" id="7925040">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925044">out</span>&nbsp;<span class="op" id="7925048">:=</span>&nbsp;<span class="builtinfunc" id="7925051">make</span><span class="op" id="7925055">(</span><span class="op" id="7925056">[</span><span class="op" id="7925057">]</span><span class="builtintype" id="7925058">byte</span><span class="op" id="7925062">,</span>&nbsp;<span class="builtinfunc" id="7925064">len</span><span class="op" id="7925067">(</span><span class="ident" id="7925068">tt</span><span class="op" id="7925070">.</span><span class="ident" id="7925071">in</span><span class="op" id="7925073">)</span><span class="op" id="7925074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925078">encryptBlock</span><span class="op" id="7925090">(</span><span class="ident" id="7925091">enc</span><span class="op" id="7925094">,</span>&nbsp;<span class="ident" id="7925096">out</span><span class="op" id="7925099">,</span>&nbsp;<span class="ident" id="7925101">tt</span><span class="op" id="7925103">.</span><span class="ident" id="7925104">in</span><span class="op" id="7925106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925110">for</span>&nbsp;<span class="ident" id="7925114">j</span><span class="op" id="7925115">,</span>&nbsp;<span class="ident" id="7925117">v</span>&nbsp;<span class="op" id="7925119">:=</span>&nbsp;<span class="keyword" id="7925122">range</span>&nbsp;<span class="ident" id="7925128">out</span>&nbsp;<span class="op" id="7925132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925137">if</span>&nbsp;<span class="ident" id="7925140">v</span>&nbsp;<span class="op" id="7925142">!=</span>&nbsp;<span class="ident" id="7925145">tt</span><span class="op" id="7925147">.</span><span class="ident" id="7925148">out</span><span class="op" id="7925151">[</span><span class="ident" id="7925152">j</span><span class="op" id="7925153">]</span>&nbsp;<span class="op" id="7925155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925161">t</span><span class="op" id="7925162">.</span><span class="ident" id="7925163">Errorf</span><span class="op" id="7925169">(</span><span class="string" id="7925170">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7925212">,</span>&nbsp;<span class="ident" id="7925214">i</span><span class="op" id="7925215">,</span>&nbsp;<span class="ident" id="7925217">j</span><span class="op" id="7925218">,</span>&nbsp;<span class="ident" id="7925220">v</span><span class="op" id="7925221">,</span>&nbsp;<span class="ident" id="7925223">tt</span><span class="op" id="7925225">.</span><span class="ident" id="7925226">out</span><span class="op" id="7925229">[</span><span class="ident" id="7925230">j</span><span class="op" id="7925231">]</span><span class="op" id="7925232">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925238">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925254">}</span><br>
<span class="lineno"></span><span class="op" id="7925256">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="7925259">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7925307">func</span>&nbsp;<span class="ident" id="7925312">TestDecryptBlock</span><span class="op" id="7925328">(</span><span class="ident" id="7925329">t</span>&nbsp;<span class="op" id="7925331">*</span><span class="ident" id="7925332">testing</span><span class="op" id="7925339">.</span><span class="ident" id="7925340">T</span><span class="op" id="7925341">)</span>&nbsp;<span class="op" id="7925343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925346">for</span>&nbsp;<span class="ident" id="7925350">i</span><span class="op" id="7925351">,</span>&nbsp;<span class="ident" id="7925353">tt</span>&nbsp;<span class="op" id="7925356">:=</span>&nbsp;<span class="keyword" id="7925359">range</span>&nbsp;<span class="ident" id="7925365">encryptTests</span>&nbsp;<span class="op" id="7925378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925382">n</span>&nbsp;<span class="op" id="7925384">:=</span>&nbsp;<span class="builtinfunc" id="7925387">len</span><span class="op" id="7925390">(</span><span class="ident" id="7925391">tt</span><span class="op" id="7925393">.</span><span class="ident" id="7925394">key</span><span class="op" id="7925397">)</span>&nbsp;<span class="op" id="7925399">+</span>&nbsp;<span class="num" id="7925401">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925406">enc</span>&nbsp;<span class="op" id="7925410">:=</span>&nbsp;<span class="builtinfunc" id="7925413">make</span><span class="op" id="7925417">(</span><span class="op" id="7925418">[</span><span class="op" id="7925419">]</span><span class="builtintype" id="7925420">uint32</span><span class="op" id="7925426">,</span>&nbsp;<span class="ident" id="7925428">n</span><span class="op" id="7925429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925433">dec</span>&nbsp;<span class="op" id="7925437">:=</span>&nbsp;<span class="builtinfunc" id="7925440">make</span><span class="op" id="7925444">(</span><span class="op" id="7925445">[</span><span class="op" id="7925446">]</span><span class="builtintype" id="7925447">uint32</span><span class="op" id="7925453">,</span>&nbsp;<span class="ident" id="7925455">n</span><span class="op" id="7925456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925460">expandKey</span><span class="op" id="7925469">(</span><span class="ident" id="7925470">tt</span><span class="op" id="7925472">.</span><span class="ident" id="7925473">key</span><span class="op" id="7925476">,</span>&nbsp;<span class="ident" id="7925478">enc</span><span class="op" id="7925481">,</span>&nbsp;<span class="ident" id="7925483">dec</span><span class="op" id="7925486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925490">plain</span>&nbsp;<span class="op" id="7925496">:=</span>&nbsp;<span class="builtinfunc" id="7925499">make</span><span class="op" id="7925503">(</span><span class="op" id="7925504">[</span><span class="op" id="7925505">]</span><span class="builtintype" id="7925506">byte</span><span class="op" id="7925510">,</span>&nbsp;<span class="builtinfunc" id="7925512">len</span><span class="op" id="7925515">(</span><span class="ident" id="7925516">tt</span><span class="op" id="7925518">.</span><span class="ident" id="7925519">in</span><span class="op" id="7925521">)</span><span class="op" id="7925522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925526">decryptBlock</span><span class="op" id="7925538">(</span><span class="ident" id="7925539">dec</span><span class="op" id="7925542">,</span>&nbsp;<span class="ident" id="7925544">plain</span><span class="op" id="7925549">,</span>&nbsp;<span class="ident" id="7925551">tt</span><span class="op" id="7925553">.</span><span class="ident" id="7925554">out</span><span class="op" id="7925557">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925561">for</span>&nbsp;<span class="ident" id="7925565">j</span><span class="op" id="7925566">,</span>&nbsp;<span class="ident" id="7925568">v</span>&nbsp;<span class="op" id="7925570">:=</span>&nbsp;<span class="keyword" id="7925573">range</span>&nbsp;<span class="ident" id="7925579">plain</span>&nbsp;<span class="op" id="7925585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925590">if</span>&nbsp;<span class="ident" id="7925593">v</span>&nbsp;<span class="op" id="7925595">!=</span>&nbsp;<span class="ident" id="7925598">tt</span><span class="op" id="7925600">.</span><span class="ident" id="7925601">in</span><span class="op" id="7925603">[</span><span class="ident" id="7925604">j</span><span class="op" id="7925605">]</span>&nbsp;<span class="op" id="7925607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925613">t</span><span class="op" id="7925614">.</span><span class="ident" id="7925615">Errorf</span><span class="op" id="7925621">(</span><span class="string" id="7925622">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7925666">,</span>&nbsp;<span class="ident" id="7925668">i</span><span class="op" id="7925669">,</span>&nbsp;<span class="ident" id="7925671">j</span><span class="op" id="7925672">,</span>&nbsp;<span class="ident" id="7925674">v</span><span class="op" id="7925675">,</span>&nbsp;<span class="ident" id="7925677">tt</span><span class="op" id="7925679">.</span><span class="ident" id="7925680">in</span><span class="op" id="7925682">[</span><span class="ident" id="7925683">j</span><span class="op" id="7925684">]</span><span class="op" id="7925685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925691">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925700">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925707">}</span><br>
<span class="lineno"></span><span class="op" id="7925709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7925712">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="7925769">func</span>&nbsp;<span class="ident" id="7925774">TestCipherEncrypt</span><span class="op" id="7925791">(</span><span class="ident" id="7925792">t</span>&nbsp;<span class="op" id="7925794">*</span><span class="ident" id="7925795">testing</span><span class="op" id="7925802">.</span><span class="ident" id="7925803">T</span><span class="op" id="7925804">)</span>&nbsp;<span class="op" id="7925806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925809">for</span>&nbsp;<span class="ident" id="7925813">i</span><span class="op" id="7925814">,</span>&nbsp;<span class="ident" id="7925816">tt</span>&nbsp;<span class="op" id="7925819">:=</span>&nbsp;<span class="keyword" id="7925822">range</span>&nbsp;<span class="ident" id="7925828">encryptTests</span>&nbsp;<span class="op" id="7925841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925845">c</span><span class="op" id="7925846">,</span>&nbsp;<span class="ident" id="7925848">err</span>&nbsp;<span class="op" id="7925852">:=</span>&nbsp;<span class="ident" id="7925855">NewCipher</span><span class="op" id="7925864">(</span><span class="ident" id="7925865">tt</span><span class="op" id="7925867">.</span><span class="ident" id="7925868">key</span><span class="op" id="7925871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925875">if</span>&nbsp;<span class="ident" id="7925878">err</span>&nbsp;<span class="op" id="7925882">!=</span>&nbsp;<span class="ident" id="7925885">nil</span>&nbsp;<span class="op" id="7925889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925894">t</span><span class="op" id="7925895">.</span><span class="ident" id="7925896">Errorf</span><span class="op" id="7925902">(</span><span class="string" id="7925903">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7925929">,</span>&nbsp;<span class="builtinfunc" id="7925931">len</span><span class="op" id="7925934">(</span><span class="ident" id="7925935">tt</span><span class="op" id="7925937">.</span><span class="ident" id="7925938">key</span><span class="op" id="7925941">)</span><span class="op" id="7925942">,</span>&nbsp;<span class="ident" id="7925944">err</span><span class="op" id="7925947">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925952">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925967">out</span>&nbsp;<span class="op" id="7925971">:=</span>&nbsp;<span class="builtinfunc" id="7925974">make</span><span class="op" id="7925978">(</span><span class="op" id="7925979">[</span><span class="op" id="7925980">]</span><span class="builtintype" id="7925981">byte</span><span class="op" id="7925985">,</span>&nbsp;<span class="builtinfunc" id="7925987">len</span><span class="op" id="7925990">(</span><span class="ident" id="7925991">tt</span><span class="op" id="7925993">.</span><span class="ident" id="7925994">in</span><span class="op" id="7925996">)</span><span class="op" id="7925997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926001">c</span><span class="op" id="7926002">.</span><span class="ident" id="7926003">Encrypt</span><span class="op" id="7926010">(</span><span class="ident" id="7926011">out</span><span class="op" id="7926014">,</span>&nbsp;<span class="ident" id="7926016">tt</span><span class="op" id="7926018">.</span><span class="ident" id="7926019">in</span><span class="op" id="7926021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926025">for</span>&nbsp;<span class="ident" id="7926029">j</span><span class="op" id="7926030">,</span>&nbsp;<span class="ident" id="7926032">v</span>&nbsp;<span class="op" id="7926034">:=</span>&nbsp;<span class="keyword" id="7926037">range</span>&nbsp;<span class="ident" id="7926043">out</span>&nbsp;<span class="op" id="7926047">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926052">if</span>&nbsp;<span class="ident" id="7926055">v</span>&nbsp;<span class="op" id="7926057">!=</span>&nbsp;<span class="ident" id="7926060">tt</span><span class="op" id="7926062">.</span><span class="ident" id="7926063">out</span><span class="op" id="7926066">[</span><span class="ident" id="7926067">j</span><span class="op" id="7926068">]</span>&nbsp;<span class="op" id="7926070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926076">t</span><span class="op" id="7926077">.</span><span class="ident" id="7926078">Errorf</span><span class="op" id="7926084">(</span><span class="string" id="7926085">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7926129">,</span>&nbsp;<span class="ident" id="7926131">i</span><span class="op" id="7926132">,</span>&nbsp;<span class="ident" id="7926134">j</span><span class="op" id="7926135">,</span>&nbsp;<span class="ident" id="7926137">v</span><span class="op" id="7926138">,</span>&nbsp;<span class="ident" id="7926140">tt</span><span class="op" id="7926142">.</span><span class="ident" id="7926143">out</span><span class="op" id="7926146">[</span><span class="ident" id="7926147">j</span><span class="op" id="7926148">]</span><span class="op" id="7926149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926155">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926168">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926171">}</span><br>
<span class="lineno"></span><span class="op" id="7926173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7926176">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7926226">func</span>&nbsp;<span class="ident" id="7926231">TestCipherDecrypt</span><span class="op" id="7926248">(</span><span class="ident" id="7926249">t</span>&nbsp;<span class="op" id="7926251">*</span><span class="ident" id="7926252">testing</span><span class="op" id="7926259">.</span><span class="ident" id="7926260">T</span><span class="op" id="7926261">)</span>&nbsp;<span class="op" id="7926263">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926266">for</span>&nbsp;<span class="ident" id="7926270">i</span><span class="op" id="7926271">,</span>&nbsp;<span class="ident" id="7926273">tt</span>&nbsp;<span class="op" id="7926276">:=</span>&nbsp;<span class="keyword" id="7926279">range</span>&nbsp;<span class="ident" id="7926285">encryptTests</span>&nbsp;<span class="op" id="7926298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926302">c</span><span class="op" id="7926303">,</span>&nbsp;<span class="ident" id="7926305">err</span>&nbsp;<span class="op" id="7926309">:=</span>&nbsp;<span class="ident" id="7926312">NewCipher</span><span class="op" id="7926321">(</span><span class="ident" id="7926322">tt</span><span class="op" id="7926324">.</span><span class="ident" id="7926325">key</span><span class="op" id="7926328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926332">if</span>&nbsp;<span class="ident" id="7926335">err</span>&nbsp;<span class="op" id="7926339">!=</span>&nbsp;<span class="ident" id="7926342">nil</span>&nbsp;<span class="op" id="7926346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926351">t</span><span class="op" id="7926352">.</span><span class="ident" id="7926353">Errorf</span><span class="op" id="7926359">(</span><span class="string" id="7926360">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7926386">,</span>&nbsp;<span class="builtinfunc" id="7926388">len</span><span class="op" id="7926391">(</span><span class="ident" id="7926392">tt</span><span class="op" id="7926394">.</span><span class="ident" id="7926395">key</span><span class="op" id="7926398">)</span><span class="op" id="7926399">,</span>&nbsp;<span class="ident" id="7926401">err</span><span class="op" id="7926404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926409">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926424">plain</span>&nbsp;<span class="op" id="7926430">:=</span>&nbsp;<span class="builtinfunc" id="7926433">make</span><span class="op" id="7926437">(</span><span class="op" id="7926438">[</span><span class="op" id="7926439">]</span><span class="builtintype" id="7926440">byte</span><span class="op" id="7926444">,</span>&nbsp;<span class="builtinfunc" id="7926446">len</span><span class="op" id="7926449">(</span><span class="ident" id="7926450">tt</span><span class="op" id="7926452">.</span><span class="ident" id="7926453">in</span><span class="op" id="7926455">)</span><span class="op" id="7926456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926460">c</span><span class="op" id="7926461">.</span><span class="ident" id="7926462">Decrypt</span><span class="op" id="7926469">(</span><span class="ident" id="7926470">plain</span><span class="op" id="7926475">,</span>&nbsp;<span class="ident" id="7926477">tt</span><span class="op" id="7926479">.</span><span class="ident" id="7926480">out</span><span class="op" id="7926483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926487">for</span>&nbsp;<span class="ident" id="7926491">j</span><span class="op" id="7926492">,</span>&nbsp;<span class="ident" id="7926494">v</span>&nbsp;<span class="op" id="7926496">:=</span>&nbsp;<span class="keyword" id="7926499">range</span>&nbsp;<span class="ident" id="7926505">plain</span>&nbsp;<span class="op" id="7926511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926516">if</span>&nbsp;<span class="ident" id="7926519">v</span>&nbsp;<span class="op" id="7926521">!=</span>&nbsp;<span class="ident" id="7926524">tt</span><span class="op" id="7926526">.</span><span class="ident" id="7926527">in</span><span class="op" id="7926529">[</span><span class="ident" id="7926530">j</span><span class="op" id="7926531">]</span>&nbsp;<span class="op" id="7926533">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926539">t</span><span class="op" id="7926540">.</span><span class="ident" id="7926541">Errorf</span><span class="op" id="7926547">(</span><span class="string" id="7926548">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7926592">,</span>&nbsp;<span class="ident" id="7926594">i</span><span class="op" id="7926595">,</span>&nbsp;<span class="ident" id="7926597">j</span><span class="op" id="7926598">,</span>&nbsp;<span class="ident" id="7926600">v</span><span class="op" id="7926601">,</span>&nbsp;<span class="ident" id="7926603">tt</span><span class="op" id="7926605">.</span><span class="ident" id="7926606">in</span><span class="op" id="7926608">[</span><span class="ident" id="7926609">j</span><span class="op" id="7926610">]</span><span class="op" id="7926611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926617">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926633">}</span><br>
<span class="lineno">355</span><span class="op" id="7926635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7926638">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="7926666">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="7926698">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="7926717">func</span>&nbsp;<span class="ident" id="7926722">TestShortBlocks</span><span class="op" id="7926737">(</span><span class="ident" id="7926738">t</span>&nbsp;<span class="op" id="7926740">*</span><span class="ident" id="7926741">testing</span><span class="op" id="7926748">.</span><span class="ident" id="7926749">T</span><span class="op" id="7926750">)</span>&nbsp;<span class="op" id="7926752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926755">bytes</span>&nbsp;<span class="op" id="7926761">:=</span>&nbsp;<span class="keyword" id="7926764">func</span><span class="op" id="7926768">(</span><span class="ident" id="7926769">n</span>&nbsp;<span class="builtintype" id="7926771">int</span><span class="op" id="7926774">)</span>&nbsp;<span class="op" id="7926776">[</span><span class="op" id="7926777">]</span><span class="builtintype" id="7926778">byte</span>&nbsp;<span class="op" id="7926783">{</span>&nbsp;<span class="keyword" id="7926785">return</span>&nbsp;<span class="builtinfunc" id="7926792">make</span><span class="op" id="7926796">(</span><span class="op" id="7926797">[</span><span class="op" id="7926798">]</span><span class="builtintype" id="7926799">byte</span><span class="op" id="7926803">,</span>&nbsp;<span class="ident" id="7926805">n</span><span class="op" id="7926806">)</span>&nbsp;<span class="op" id="7926808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926812">c</span><span class="op" id="7926813">,</span>&nbsp;<span class="ident" id="7926815">_</span>&nbsp;<span class="op" id="7926817">:=</span>&nbsp;<span class="ident" id="7926820">NewCipher</span><span class="op" id="7926829">(</span><span class="ident" id="7926830">bytes</span><span class="op" id="7926835">(</span><span class="num" id="7926836">16</span><span class="op" id="7926838">)</span><span class="op" id="7926839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926843">mustPanic</span><span class="op" id="7926852">(</span><span class="ident" id="7926853">t</span><span class="op" id="7926854">,</span>&nbsp;<span class="string" id="7926856">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7926890">,</span>&nbsp;<span class="keyword" id="7926892">func</span><span class="op" id="7926896">(</span><span class="op" id="7926897">)</span>&nbsp;<span class="op" id="7926899">{</span>&nbsp;<span class="ident" id="7926901">c</span><span class="op" id="7926902">.</span><span class="ident" id="7926903">Encrypt</span><span class="op" id="7926910">(</span><span class="ident" id="7926911">bytes</span><span class="op" id="7926916">(</span><span class="num" id="7926917">1</span><span class="op" id="7926918">)</span><span class="op" id="7926919">,</span>&nbsp;<span class="ident" id="7926921">bytes</span><span class="op" id="7926926">(</span><span class="num" id="7926927">1</span><span class="op" id="7926928">)</span><span class="op" id="7926929">)</span>&nbsp;<span class="op" id="7926931">}</span><span class="op" id="7926932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926935">mustPanic</span><span class="op" id="7926944">(</span><span class="ident" id="7926945">t</span><span class="op" id="7926946">,</span>&nbsp;<span class="string" id="7926948">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7926982">,</span>&nbsp;<span class="keyword" id="7926984">func</span><span class="op" id="7926988">(</span><span class="op" id="7926989">)</span>&nbsp;<span class="op" id="7926991">{</span>&nbsp;<span class="ident" id="7926993">c</span><span class="op" id="7926994">.</span><span class="ident" id="7926995">Decrypt</span><span class="op" id="7927002">(</span><span class="ident" id="7927003">bytes</span><span class="op" id="7927008">(</span><span class="num" id="7927009">1</span><span class="op" id="7927010">)</span><span class="op" id="7927011">,</span>&nbsp;<span class="ident" id="7927013">bytes</span><span class="op" id="7927018">(</span><span class="num" id="7927019">1</span><span class="op" id="7927020">)</span><span class="op" id="7927021">)</span>&nbsp;<span class="op" id="7927023">}</span><span class="op" id="7927024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927027">mustPanic</span><span class="op" id="7927036">(</span><span class="ident" id="7927037">t</span><span class="op" id="7927038">,</span>&nbsp;<span class="string" id="7927040">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7927074">,</span>&nbsp;<span class="keyword" id="7927076">func</span><span class="op" id="7927080">(</span><span class="op" id="7927081">)</span>&nbsp;<span class="op" id="7927083">{</span>&nbsp;<span class="ident" id="7927085">c</span><span class="op" id="7927086">.</span><span class="ident" id="7927087">Encrypt</span><span class="op" id="7927094">(</span><span class="ident" id="7927095">bytes</span><span class="op" id="7927100">(</span><span class="num" id="7927101">100</span><span class="op" id="7927104">)</span><span class="op" id="7927105">,</span>&nbsp;<span class="ident" id="7927107">bytes</span><span class="op" id="7927112">(</span><span class="num" id="7927113">1</span><span class="op" id="7927114">)</span><span class="op" id="7927115">)</span>&nbsp;<span class="op" id="7927117">}</span><span class="op" id="7927118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927121">mustPanic</span><span class="op" id="7927130">(</span><span class="ident" id="7927131">t</span><span class="op" id="7927132">,</span>&nbsp;<span class="string" id="7927134">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7927168">,</span>&nbsp;<span class="keyword" id="7927170">func</span><span class="op" id="7927174">(</span><span class="op" id="7927175">)</span>&nbsp;<span class="op" id="7927177">{</span>&nbsp;<span class="ident" id="7927179">c</span><span class="op" id="7927180">.</span><span class="ident" id="7927181">Decrypt</span><span class="op" id="7927188">(</span><span class="ident" id="7927189">bytes</span><span class="op" id="7927194">(</span><span class="num" id="7927195">100</span><span class="op" id="7927198">)</span><span class="op" id="7927199">,</span>&nbsp;<span class="ident" id="7927201">bytes</span><span class="op" id="7927206">(</span><span class="num" id="7927207">1</span><span class="op" id="7927208">)</span><span class="op" id="7927209">)</span>&nbsp;<span class="op" id="7927211">}</span><span class="op" id="7927212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927215">mustPanic</span><span class="op" id="7927224">(</span><span class="ident" id="7927225">t</span><span class="op" id="7927226">,</span>&nbsp;<span class="string" id="7927228">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7927263">,</span>&nbsp;<span class="keyword" id="7927265">func</span><span class="op" id="7927269">(</span><span class="op" id="7927270">)</span>&nbsp;<span class="op" id="7927272">{</span>&nbsp;<span class="ident" id="7927274">c</span><span class="op" id="7927275">.</span><span class="ident" id="7927276">Encrypt</span><span class="op" id="7927283">(</span><span class="ident" id="7927284">bytes</span><span class="op" id="7927289">(</span><span class="num" id="7927290">1</span><span class="op" id="7927291">)</span><span class="op" id="7927292">,</span>&nbsp;<span class="ident" id="7927294">bytes</span><span class="op" id="7927299">(</span><span class="num" id="7927300">100</span><span class="op" id="7927303">)</span><span class="op" id="7927304">)</span>&nbsp;<span class="op" id="7927306">}</span><span class="op" id="7927307">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927310">mustPanic</span><span class="op" id="7927319">(</span><span class="ident" id="7927320">t</span><span class="op" id="7927321">,</span>&nbsp;<span class="string" id="7927323">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7927358">,</span>&nbsp;<span class="keyword" id="7927360">func</span><span class="op" id="7927364">(</span><span class="op" id="7927365">)</span>&nbsp;<span class="op" id="7927367">{</span>&nbsp;<span class="ident" id="7927369">c</span><span class="op" id="7927370">.</span><span class="ident" id="7927371">Decrypt</span><span class="op" id="7927378">(</span><span class="ident" id="7927379">bytes</span><span class="op" id="7927384">(</span><span class="num" id="7927385">1</span><span class="op" id="7927386">)</span><span class="op" id="7927387">,</span>&nbsp;<span class="ident" id="7927389">bytes</span><span class="op" id="7927394">(</span><span class="num" id="7927395">100</span><span class="op" id="7927398">)</span><span class="op" id="7927399">)</span>&nbsp;<span class="op" id="7927401">}</span><span class="op" id="7927402">)</span><br>
<span class="lineno"></span><span class="op" id="7927404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7927407">func</span>&nbsp;<span class="ident" id="7927412">mustPanic</span><span class="op" id="7927421">(</span><span class="ident" id="7927422">t</span>&nbsp;<span class="op" id="7927424">*</span><span class="ident" id="7927425">testing</span><span class="op" id="7927432">.</span><span class="ident" id="7927433">T</span><span class="op" id="7927434">,</span>&nbsp;<span class="ident" id="7927436">msg</span>&nbsp;<span class="builtintype" id="7927440">string</span><span class="op" id="7927446">,</span>&nbsp;<span class="ident" id="7927448">f</span>&nbsp;<span class="keyword" id="7927450">func</span><span class="op" id="7927454">(</span><span class="op" id="7927455">)</span><span class="op" id="7927456">)</span>&nbsp;<span class="op" id="7927458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927461">defer</span>&nbsp;<span class="keyword" id="7927467">func</span><span class="op" id="7927471">(</span><span class="op" id="7927472">)</span>&nbsp;<span class="op" id="7927474">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927478">err</span>&nbsp;<span class="op" id="7927482">:=</span>&nbsp;<span class="builtinfunc" id="7927485">recover</span><span class="op" id="7927492">(</span><span class="op" id="7927493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927497">if</span>&nbsp;<span class="ident" id="7927500">err</span>&nbsp;<span class="op" id="7927504">==</span>&nbsp;<span class="ident" id="7927507">nil</span>&nbsp;<span class="op" id="7927511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927516">t</span><span class="op" id="7927517">.</span><span class="ident" id="7927518">Errorf</span><span class="op" id="7927524">(</span><span class="string" id="7927525">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7927560">,</span>&nbsp;<span class="ident" id="7927562">msg</span><span class="op" id="7927565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927569">}</span>&nbsp;<span class="keyword" id="7927571">else</span>&nbsp;<span class="keyword" id="7927576">if</span>&nbsp;<span class="ident" id="7927579">err</span>&nbsp;<span class="op" id="7927583">!=</span>&nbsp;<span class="ident" id="7927586">msg</span>&nbsp;<span class="op" id="7927590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927595">t</span><span class="op" id="7927596">.</span><span class="ident" id="7927597">Errorf</span><span class="op" id="7927603">(</span><span class="string" id="7927604">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7927629">,</span>&nbsp;<span class="ident" id="7927631">err</span><span class="op" id="7927634">,</span>&nbsp;<span class="ident" id="7927636">msg</span><span class="op" id="7927639">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927646">}</span><span class="op" id="7927647">(</span><span class="op" id="7927648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927651">f</span><span class="op" id="7927652">(</span><span class="op" id="7927653">)</span><br>
<span class="lineno"></span><span class="op" id="7927655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="7927658">func</span>&nbsp;<span class="ident" id="7927663">BenchmarkEncrypt</span><span class="op" id="7927679">(</span><span class="ident" id="7927680">b</span>&nbsp;<span class="op" id="7927682">*</span><span class="ident" id="7927683">testing</span><span class="op" id="7927690">.</span><span class="ident" id="7927691">B</span><span class="op" id="7927692">)</span>&nbsp;<span class="op" id="7927694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927697">tt</span>&nbsp;<span class="op" id="7927700">:=</span>&nbsp;<span class="ident" id="7927703">encryptTests</span><span class="op" id="7927715">[</span><span class="num" id="7927716">0</span><span class="op" id="7927717">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927720">c</span><span class="op" id="7927721">,</span>&nbsp;<span class="ident" id="7927723">err</span>&nbsp;<span class="op" id="7927727">:=</span>&nbsp;<span class="ident" id="7927730">NewCipher</span><span class="op" id="7927739">(</span><span class="ident" id="7927740">tt</span><span class="op" id="7927742">.</span><span class="ident" id="7927743">key</span><span class="op" id="7927746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927749">if</span>&nbsp;<span class="ident" id="7927752">err</span>&nbsp;<span class="op" id="7927756">!=</span>&nbsp;<span class="ident" id="7927759">nil</span>&nbsp;<span class="op" id="7927763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927767">b</span><span class="op" id="7927768">.</span><span class="ident" id="7927769">Fatal</span><span class="op" id="7927774">(</span><span class="string" id="7927775">&#34;NewCipher:&#34;</span><span class="op" id="7927787">,</span>&nbsp;<span class="ident" id="7927789">err</span><span class="op" id="7927792">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927798">out</span>&nbsp;<span class="op" id="7927802">:=</span>&nbsp;<span class="builtinfunc" id="7927805">make</span><span class="op" id="7927809">(</span><span class="op" id="7927810">[</span><span class="op" id="7927811">]</span><span class="builtintype" id="7927812">byte</span><span class="op" id="7927816">,</span>&nbsp;<span class="builtinfunc" id="7927818">len</span><span class="op" id="7927821">(</span><span class="ident" id="7927822">tt</span><span class="op" id="7927824">.</span><span class="ident" id="7927825">in</span><span class="op" id="7927827">)</span><span class="op" id="7927828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927831">b</span><span class="op" id="7927832">.</span><span class="ident" id="7927833">SetBytes</span><span class="op" id="7927841">(</span><span class="ident" id="7927842">int64</span><span class="op" id="7927847">(</span><span class="builtinfunc" id="7927848">len</span><span class="op" id="7927851">(</span><span class="ident" id="7927852">out</span><span class="op" id="7927855">)</span><span class="op" id="7927856">)</span><span class="op" id="7927857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927860">b</span><span class="op" id="7927861">.</span><span class="ident" id="7927862">ResetTimer</span><span class="op" id="7927872">(</span><span class="op" id="7927873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927876">for</span>&nbsp;<span class="ident" id="7927880">i</span>&nbsp;<span class="op" id="7927882">:=</span>&nbsp;<span class="num" id="7927885">0</span><span class="op" id="7927886">;</span>&nbsp;<span class="ident" id="7927888">i</span>&nbsp;<span class="op" id="7927890">&lt;</span>&nbsp;<span class="ident" id="7927892">b</span><span class="op" id="7927893">.</span><span class="ident" id="7927894">N</span><span class="op" id="7927895">;</span>&nbsp;<span class="ident" id="7927897">i</span><span class="op" id="7927898">++</span>&nbsp;<span class="op" id="7927901">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927905">c</span><span class="op" id="7927906">.</span><span class="ident" id="7927907">Encrypt</span><span class="op" id="7927914">(</span><span class="ident" id="7927915">out</span><span class="op" id="7927918">,</span>&nbsp;<span class="ident" id="7927920">tt</span><span class="op" id="7927922">.</span><span class="ident" id="7927923">in</span><span class="op" id="7927925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927928">}</span><br>
<span class="lineno"></span><span class="op" id="7927930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7927933">func</span>&nbsp;<span class="ident" id="7927938">BenchmarkDecrypt</span><span class="op" id="7927954">(</span><span class="ident" id="7927955">b</span>&nbsp;<span class="op" id="7927957">*</span><span class="ident" id="7927958">testing</span><span class="op" id="7927965">.</span><span class="ident" id="7927966">B</span><span class="op" id="7927967">)</span>&nbsp;<span class="op" id="7927969">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927972">tt</span>&nbsp;<span class="op" id="7927975">:=</span>&nbsp;<span class="ident" id="7927978">encryptTests</span><span class="op" id="7927990">[</span><span class="num" id="7927991">0</span><span class="op" id="7927992">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927995">c</span><span class="op" id="7927996">,</span>&nbsp;<span class="ident" id="7927998">err</span>&nbsp;<span class="op" id="7928002">:=</span>&nbsp;<span class="ident" id="7928005">NewCipher</span><span class="op" id="7928014">(</span><span class="ident" id="7928015">tt</span><span class="op" id="7928017">.</span><span class="ident" id="7928018">key</span><span class="op" id="7928021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928024">if</span>&nbsp;<span class="ident" id="7928027">err</span>&nbsp;<span class="op" id="7928031">!=</span>&nbsp;<span class="ident" id="7928034">nil</span>&nbsp;<span class="op" id="7928038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928042">b</span><span class="op" id="7928043">.</span><span class="ident" id="7928044">Fatal</span><span class="op" id="7928049">(</span><span class="string" id="7928050">&#34;NewCipher:&#34;</span><span class="op" id="7928062">,</span>&nbsp;<span class="ident" id="7928064">err</span><span class="op" id="7928067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928070">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928073">out</span>&nbsp;<span class="op" id="7928077">:=</span>&nbsp;<span class="builtinfunc" id="7928080">make</span><span class="op" id="7928084">(</span><span class="op" id="7928085">[</span><span class="op" id="7928086">]</span><span class="builtintype" id="7928087">byte</span><span class="op" id="7928091">,</span>&nbsp;<span class="builtinfunc" id="7928093">len</span><span class="op" id="7928096">(</span><span class="ident" id="7928097">tt</span><span class="op" id="7928099">.</span><span class="ident" id="7928100">out</span><span class="op" id="7928103">)</span><span class="op" id="7928104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928107">b</span><span class="op" id="7928108">.</span><span class="ident" id="7928109">SetBytes</span><span class="op" id="7928117">(</span><span class="ident" id="7928118">int64</span><span class="op" id="7928123">(</span><span class="builtinfunc" id="7928124">len</span><span class="op" id="7928127">(</span><span class="ident" id="7928128">out</span><span class="op" id="7928131">)</span><span class="op" id="7928132">)</span><span class="op" id="7928133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928136">b</span><span class="op" id="7928137">.</span><span class="ident" id="7928138">ResetTimer</span><span class="op" id="7928148">(</span><span class="op" id="7928149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928152">for</span>&nbsp;<span class="ident" id="7928156">i</span>&nbsp;<span class="op" id="7928158">:=</span>&nbsp;<span class="num" id="7928161">0</span><span class="op" id="7928162">;</span>&nbsp;<span class="ident" id="7928164">i</span>&nbsp;<span class="op" id="7928166">&lt;</span>&nbsp;<span class="ident" id="7928168">b</span><span class="op" id="7928169">.</span><span class="ident" id="7928170">N</span><span class="op" id="7928171">;</span>&nbsp;<span class="ident" id="7928173">i</span><span class="op" id="7928174">++</span>&nbsp;<span class="op" id="7928177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928181">c</span><span class="op" id="7928182">.</span><span class="ident" id="7928183">Decrypt</span><span class="op" id="7928190">(</span><span class="ident" id="7928191">out</span><span class="op" id="7928194">,</span>&nbsp;<span class="ident" id="7928196">tt</span><span class="op" id="7928198">.</span><span class="ident" id="7928199">out</span><span class="op" id="7928202">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928205">}</span><br>
<span class="lineno"></span><span class="op" id="7928207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7928210">func</span>&nbsp;<span class="ident" id="7928215">BenchmarkExpand</span><span class="op" id="7928230">(</span><span class="ident" id="7928231">b</span>&nbsp;<span class="op" id="7928233">*</span><span class="ident" id="7928234">testing</span><span class="op" id="7928241">.</span><span class="ident" id="7928242">B</span><span class="op" id="7928243">)</span>&nbsp;<span class="op" id="7928245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928248">tt</span>&nbsp;<span class="op" id="7928251">:=</span>&nbsp;<span class="ident" id="7928254">encryptTests</span><span class="op" id="7928266">[</span><span class="num" id="7928267">0</span><span class="op" id="7928268">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928271">n</span>&nbsp;<span class="op" id="7928273">:=</span>&nbsp;<span class="builtinfunc" id="7928276">len</span><span class="op" id="7928279">(</span><span class="ident" id="7928280">tt</span><span class="op" id="7928282">.</span><span class="ident" id="7928283">key</span><span class="op" id="7928286">)</span>&nbsp;<span class="op" id="7928288">+</span>&nbsp;<span class="num" id="7928290">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928294">c</span>&nbsp;<span class="op" id="7928296">:=</span>&nbsp;<span class="op" id="7928299">&amp;</span><span class="ident" id="7928300">aesCipher</span><span class="op" id="7928309">{</span><span class="builtinfunc" id="7928310">make</span><span class="op" id="7928314">(</span><span class="op" id="7928315">[</span><span class="op" id="7928316">]</span><span class="builtintype" id="7928317">uint32</span><span class="op" id="7928323">,</span>&nbsp;<span class="ident" id="7928325">n</span><span class="op" id="7928326">)</span><span class="op" id="7928327">,</span>&nbsp;<span class="builtinfunc" id="7928329">make</span><span class="op" id="7928333">(</span><span class="op" id="7928334">[</span><span class="op" id="7928335">]</span><span class="builtintype" id="7928336">uint32</span><span class="op" id="7928342">,</span>&nbsp;<span class="ident" id="7928344">n</span><span class="op" id="7928345">)</span><span class="op" id="7928346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928349">b</span><span class="op" id="7928350">.</span><span class="ident" id="7928351">ResetTimer</span><span class="op" id="7928361">(</span><span class="op" id="7928362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928365">for</span>&nbsp;<span class="ident" id="7928369">i</span>&nbsp;<span class="op" id="7928371">:=</span>&nbsp;<span class="num" id="7928374">0</span><span class="op" id="7928375">;</span>&nbsp;<span class="ident" id="7928377">i</span>&nbsp;<span class="op" id="7928379">&lt;</span>&nbsp;<span class="ident" id="7928381">b</span><span class="op" id="7928382">.</span><span class="ident" id="7928383">N</span><span class="op" id="7928384">;</span>&nbsp;<span class="ident" id="7928386">i</span><span class="op" id="7928387">++</span>&nbsp;<span class="op" id="7928390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928394">expandKey</span><span class="op" id="7928403">(</span><span class="ident" id="7928404">tt</span><span class="op" id="7928406">.</span><span class="ident" id="7928407">key</span><span class="op" id="7928410">,</span>&nbsp;<span class="ident" id="7928412">c</span><span class="op" id="7928413">.</span><span class="ident" id="7928414">enc</span><span class="op" id="7928417">,</span>&nbsp;<span class="ident" id="7928419">c</span><span class="op" id="7928420">.</span><span class="ident" id="7928421">dec</span><span class="op" id="7928424">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928427">}</span><br>
<span class="lineno"></span><span class="op" id="7928429">}</span>
</div>
</body>
</html>
