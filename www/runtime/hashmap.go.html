<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1763775">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1763830">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1763884">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1763935">package</span>&nbsp;<span class="ident" id="1763943">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1763952">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;the&nbsp;implementation&nbsp;of&nbsp;Go&#39;s&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="1764011">//</span><br>
<span class="lineno"></span><span class="comment" id="1764014">//&nbsp;A&nbsp;map&nbsp;is&nbsp;just&nbsp;a&nbsp;hash&nbsp;table.&nbsp;&nbsp;The&nbsp;data&nbsp;is&nbsp;arranged</span><br>
<span class="lineno">10</span><span class="comment" id="1764067">//&nbsp;into&nbsp;an&nbsp;array&nbsp;of&nbsp;buckets.&nbsp;&nbsp;Each&nbsp;bucket&nbsp;contains&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1764124">//&nbsp;8&nbsp;key/value&nbsp;pairs.&nbsp;&nbsp;The&nbsp;low-order&nbsp;bits&nbsp;of&nbsp;the&nbsp;hash&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1764182">//&nbsp;used&nbsp;to&nbsp;select&nbsp;a&nbsp;bucket.&nbsp;&nbsp;Each&nbsp;bucket&nbsp;contains&nbsp;a&nbsp;few</span><br>
<span class="lineno"></span><span class="comment" id="1764238">//&nbsp;high-order&nbsp;bits&nbsp;of&nbsp;each&nbsp;hash&nbsp;to&nbsp;distinguish&nbsp;the&nbsp;entries</span><br>
<span class="lineno"></span><span class="comment" id="1764297">//&nbsp;within&nbsp;a&nbsp;single&nbsp;bucket.</span><br>
<span class="lineno">15</span><span class="comment" id="1764324">//</span><br>
<span class="lineno"></span><span class="comment" id="1764327">//&nbsp;If&nbsp;more&nbsp;than&nbsp;8&nbsp;keys&nbsp;hash&nbsp;to&nbsp;a&nbsp;bucket,&nbsp;we&nbsp;chain&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="1764380">//&nbsp;extra&nbsp;buckets.</span><br>
<span class="lineno"></span><span class="comment" id="1764398">//</span><br>
<span class="lineno"></span><span class="comment" id="1764401">//&nbsp;When&nbsp;the&nbsp;hashtable&nbsp;grows,&nbsp;we&nbsp;allocate&nbsp;a&nbsp;new&nbsp;array</span><br>
<span class="lineno">20</span><span class="comment" id="1764454">//&nbsp;of&nbsp;buckets&nbsp;twice&nbsp;as&nbsp;big.&nbsp;&nbsp;Buckets&nbsp;are&nbsp;incrementally</span><br>
<span class="lineno"></span><span class="comment" id="1764509">//&nbsp;copied&nbsp;from&nbsp;the&nbsp;old&nbsp;bucket&nbsp;array&nbsp;to&nbsp;the&nbsp;new&nbsp;bucket&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="1764570">//</span><br>
<span class="lineno"></span><span class="comment" id="1764573">//&nbsp;Map&nbsp;iterators&nbsp;walk&nbsp;through&nbsp;the&nbsp;array&nbsp;of&nbsp;buckets&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1764628">//&nbsp;return&nbsp;the&nbsp;keys&nbsp;in&nbsp;walk&nbsp;order&nbsp;(bucket&nbsp;#,&nbsp;then&nbsp;overflow</span><br>
<span class="lineno">25</span><span class="comment" id="1764686">//&nbsp;chain&nbsp;order,&nbsp;then&nbsp;bucket&nbsp;index).&nbsp;&nbsp;To&nbsp;maintain&nbsp;iteration</span><br>
<span class="lineno"></span><span class="comment" id="1764745">//&nbsp;semantics,&nbsp;we&nbsp;never&nbsp;move&nbsp;keys&nbsp;within&nbsp;their&nbsp;bucket&nbsp;(if</span><br>
<span class="lineno"></span><span class="comment" id="1764802">//&nbsp;we&nbsp;did,&nbsp;keys&nbsp;might&nbsp;be&nbsp;returned&nbsp;0&nbsp;or&nbsp;2&nbsp;times).&nbsp;&nbsp;When</span><br>
<span class="lineno"></span><span class="comment" id="1764857">//&nbsp;growing&nbsp;the&nbsp;table,&nbsp;iterators&nbsp;remain&nbsp;iterating&nbsp;through&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1764918">//&nbsp;old&nbsp;table&nbsp;and&nbsp;must&nbsp;check&nbsp;the&nbsp;new&nbsp;table&nbsp;if&nbsp;the&nbsp;bucket</span><br>
<span class="lineno">30</span><span class="comment" id="1764974">//&nbsp;they&nbsp;are&nbsp;iterating&nbsp;through&nbsp;has&nbsp;been&nbsp;moved&nbsp;(&#34;evacuated&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="1765033">//&nbsp;to&nbsp;the&nbsp;new&nbsp;table.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1765055">//&nbsp;Picking&nbsp;loadFactor:&nbsp;too&nbsp;large&nbsp;and&nbsp;we&nbsp;have&nbsp;lots&nbsp;of&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="1765117">//&nbsp;buckets,&nbsp;too&nbsp;small&nbsp;and&nbsp;we&nbsp;waste&nbsp;a&nbsp;lot&nbsp;of&nbsp;space.&nbsp;&nbsp;I&nbsp;wrote</span><br>
<span class="lineno">35</span><span class="comment" id="1765177">//&nbsp;a&nbsp;simple&nbsp;program&nbsp;to&nbsp;check&nbsp;some&nbsp;stats&nbsp;for&nbsp;different&nbsp;loads:</span><br>
<span class="lineno"></span><span class="comment" id="1765238">//&nbsp;(64-bit,&nbsp;8&nbsp;byte&nbsp;keys&nbsp;and&nbsp;values)</span><br>
<span class="lineno"></span><span class="comment" id="1765274">//&nbsp;&nbsp;loadFactor&nbsp;&nbsp;&nbsp;&nbsp;%overflow&nbsp;&nbsp;bytes/entry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hitprobe&nbsp;&nbsp;&nbsp;&nbsp;missprobe</span><br>
<span class="lineno"></span><span class="comment" id="1765341">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20.77&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.00</span><br>
<span class="lineno"></span><span class="comment" id="1765408">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17.30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.50</span><br>
<span class="lineno">40</span><span class="comment" id="1765475">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.85&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14.77&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.00</span><br>
<span class="lineno"></span><span class="comment" id="1765542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.94&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.75&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.50</span><br>
<span class="lineno"></span><span class="comment" id="1765609">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15.27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11.67&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.00</span><br>
<span class="lineno"></span><span class="comment" id="1765676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20.90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.50</span><br>
<span class="lineno"></span><span class="comment" id="1765743">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27.14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.00</span><br>
<span class="lineno">45</span><span class="comment" id="1765810">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;34.03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.73&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.75&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.50</span><br>
<span class="lineno"></span><span class="comment" id="1765877">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;41.10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.00</span><br>
<span class="lineno"></span><span class="comment" id="1765944">//</span><br>
<span class="lineno"></span><span class="comment" id="1765947">//&nbsp;%overflow&nbsp;&nbsp;&nbsp;=&nbsp;percentage&nbsp;of&nbsp;buckets&nbsp;which&nbsp;have&nbsp;an&nbsp;overflow&nbsp;bucket</span><br>
<span class="lineno"></span><span class="comment" id="1766016">//&nbsp;bytes/entry&nbsp;=&nbsp;overhead&nbsp;bytes&nbsp;used&nbsp;per&nbsp;key/value&nbsp;pair</span><br>
<span class="lineno">50</span><span class="comment" id="1766072">//&nbsp;hitprobe&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;#&nbsp;of&nbsp;entries&nbsp;to&nbsp;check&nbsp;when&nbsp;looking&nbsp;up&nbsp;a&nbsp;present&nbsp;key</span><br>
<span class="lineno"></span><span class="comment" id="1766141">//&nbsp;missprobe&nbsp;&nbsp;&nbsp;=&nbsp;#&nbsp;of&nbsp;entries&nbsp;to&nbsp;check&nbsp;when&nbsp;looking&nbsp;up&nbsp;an&nbsp;absent&nbsp;key</span><br>
<span class="lineno"></span><span class="comment" id="1766210">//</span><br>
<span class="lineno"></span><span class="comment" id="1766213">//&nbsp;Keep&nbsp;in&nbsp;mind&nbsp;this&nbsp;data&nbsp;is&nbsp;for&nbsp;maximally&nbsp;loaded&nbsp;tables,&nbsp;i.e.&nbsp;just</span><br>
<span class="lineno"></span><span class="comment" id="1766281">//&nbsp;before&nbsp;the&nbsp;table&nbsp;grows.&nbsp;&nbsp;Typical&nbsp;tables&nbsp;will&nbsp;be&nbsp;somewhat&nbsp;less&nbsp;loaded.</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="1766355">import</span>&nbsp;<span class="op" id="1766362">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1766365">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1766374">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="1766377">const</span>&nbsp;<span class="op" id="1766383">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766386">//&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;key/value&nbsp;pairs&nbsp;a&nbsp;bucket&nbsp;can&nbsp;hold.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1766443">bucketCntBits</span>&nbsp;<span class="op" id="1766457">=</span>&nbsp;<span class="num" id="1766459">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1766462">bucketCnt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1766476">=</span>&nbsp;<span class="num" id="1766478">1</span>&nbsp;<span class="op" id="1766480">&lt;&lt;</span>&nbsp;<span class="ident" id="1766483"><a href="/runtime/hashmap.go.html#1766443">bucketCntBits</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766499">//&nbsp;Maximum&nbsp;average&nbsp;load&nbsp;of&nbsp;a&nbsp;bucket&nbsp;that&nbsp;triggers&nbsp;growth.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1766558">loadFactor</span>&nbsp;<span class="op" id="1766569">=</span>&nbsp;<span class="num" id="1766571">6.5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766577">//&nbsp;Maximum&nbsp;key&nbsp;or&nbsp;value&nbsp;size&nbsp;to&nbsp;keep&nbsp;inline&nbsp;(instead&nbsp;of&nbsp;mallocing&nbsp;per&nbsp;element).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766658">//&nbsp;Must&nbsp;fit&nbsp;in&nbsp;a&nbsp;uint8.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766683">//&nbsp;Fast&nbsp;versions&nbsp;cannot&nbsp;handle&nbsp;big&nbsp;values&nbsp;-&nbsp;the&nbsp;cutoff&nbsp;size&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766748">//&nbsp;fast&nbsp;versions&nbsp;in&nbsp;../../cmd/gc/walk.c&nbsp;must&nbsp;be&nbsp;at&nbsp;most&nbsp;this&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1766817">maxKeySize</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1766830">=</span>&nbsp;<span class="num" id="1766832">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1766837">maxValueSize</span>&nbsp;<span class="op" id="1766850">=</span>&nbsp;<span class="num" id="1766852">128</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766858">//&nbsp;data&nbsp;offset&nbsp;should&nbsp;be&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;bmap&nbsp;struct,&nbsp;but&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766929">//&nbsp;aligned&nbsp;correctly.&nbsp;&nbsp;For&nbsp;amd64p32&nbsp;this&nbsp;means&nbsp;64-bit&nbsp;alignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766994">//&nbsp;even&nbsp;though&nbsp;pointers&nbsp;are&nbsp;32&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767031">dataOffset</span>&nbsp;<span class="op" id="1767042">=</span>&nbsp;<span class="ident" id="1767044"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1767050">.</span><span class="ident" id="1767051">Offsetof</span><span class="op" id="1767059">(</span><span class="keyword" id="1767060">struct</span>&nbsp;<span class="op" id="1767067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767071">b</span>&nbsp;<span class="ident" id="1767073"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767080">v</span>&nbsp;<span class="ident" id="1767082">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767089">}</span><span class="op" id="1767090">{</span><span class="op" id="1767091">}</span><span class="op" id="1767092">.</span><span class="ident" id="1767093">v</span><span class="op" id="1767094">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767098">//&nbsp;Possible&nbsp;tophash&nbsp;values.&nbsp;&nbsp;We&nbsp;reserve&nbsp;a&nbsp;few&nbsp;possibilities&nbsp;for&nbsp;special&nbsp;marks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767178">//&nbsp;Each&nbsp;bucket&nbsp;(including&nbsp;its&nbsp;overflow&nbsp;buckets,&nbsp;if&nbsp;any)&nbsp;will&nbsp;have&nbsp;either&nbsp;all&nbsp;or&nbsp;none&nbsp;of&nbsp;its</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767271">//&nbsp;entries&nbsp;in&nbsp;the&nbsp;evacuated*&nbsp;states&nbsp;(except&nbsp;during&nbsp;the&nbsp;evacuate()&nbsp;method,&nbsp;which&nbsp;only&nbsp;happens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767365">//&nbsp;during&nbsp;map&nbsp;writes&nbsp;and&nbsp;thus&nbsp;no&nbsp;one&nbsp;else&nbsp;can&nbsp;observe&nbsp;the&nbsp;map&nbsp;during&nbsp;that&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767447">empty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1767462">=</span>&nbsp;<span class="num" id="1767464">0</span>&nbsp;<span class="comment" id="1767466">//&nbsp;cell&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767484">evacuatedEmpty</span>&nbsp;<span class="op" id="1767499">=</span>&nbsp;<span class="num" id="1767501">1</span>&nbsp;<span class="comment" id="1767503">//&nbsp;cell&nbsp;is&nbsp;empty,&nbsp;bucket&nbsp;is&nbsp;evacuated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767543">evacuatedX</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1767558">=</span>&nbsp;<span class="num" id="1767560">2</span>&nbsp;<span class="comment" id="1767562">//&nbsp;key/value&nbsp;is&nbsp;valid.&nbsp;&nbsp;Entry&nbsp;has&nbsp;been&nbsp;evacuated&nbsp;to&nbsp;first&nbsp;half&nbsp;of&nbsp;larger&nbsp;table.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767643">evacuatedY</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1767658">=</span>&nbsp;<span class="num" id="1767660">3</span>&nbsp;<span class="comment" id="1767662">//&nbsp;same&nbsp;as&nbsp;above,&nbsp;but&nbsp;evacuated&nbsp;to&nbsp;second&nbsp;half&nbsp;of&nbsp;larger&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767727">minTopHash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1767742">=</span>&nbsp;<span class="num" id="1767744">4</span>&nbsp;<span class="comment" id="1767746">//&nbsp;minimum&nbsp;tophash&nbsp;for&nbsp;a&nbsp;normal&nbsp;filled&nbsp;cell.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767793">//&nbsp;flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767803">iterator</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1767815">=</span>&nbsp;<span class="num" id="1767817">1</span>&nbsp;<span class="comment" id="1767819">//&nbsp;there&nbsp;may&nbsp;be&nbsp;an&nbsp;iterator&nbsp;using&nbsp;buckets</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767862">oldIterator</span>&nbsp;<span class="op" id="1767874">=</span>&nbsp;<span class="num" id="1767876">2</span>&nbsp;<span class="comment" id="1767878">//&nbsp;there&nbsp;may&nbsp;be&nbsp;an&nbsp;iterator&nbsp;using&nbsp;oldbuckets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767925">//&nbsp;sentinel&nbsp;bucket&nbsp;ID&nbsp;for&nbsp;iterator&nbsp;checks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767968">noCheck</span>&nbsp;<span class="op" id="1767976">=</span>&nbsp;<span class="num" id="1767978">1</span><span class="op" id="1767979">&lt;&lt;</span><span class="op" id="1767981">(</span><span class="num" id="1767982">8</span><span class="op" id="1767983">*</span><span class="ident" id="1767984"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1767991">)</span>&nbsp;<span class="op" id="1767993">-</span>&nbsp;<span class="num" id="1767995">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767999">//&nbsp;trigger&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;at&nbsp;every&nbsp;alloc&nbsp;called&nbsp;from&nbsp;this&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768069">checkgc</span>&nbsp;<span class="op" id="1768077">=</span>&nbsp;<span class="ident" id="1768079">false</span><br>
<span class="lineno"></span><span class="op" id="1768085">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1768088">//&nbsp;A&nbsp;header&nbsp;for&nbsp;a&nbsp;Go&nbsp;map.</span><br>
<span class="lineno">105</span><span class="keyword" id="1768114">type</span>&nbsp;<span class="ident" id="1768119">hmap</span>&nbsp;<span class="keyword" id="1768124">struct</span>&nbsp;<span class="op" id="1768131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768134">//&nbsp;Note:&nbsp;the&nbsp;format&nbsp;of&nbsp;the&nbsp;Hmap&nbsp;is&nbsp;encoded&nbsp;in&nbsp;../../cmd/gc/reflect.c&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768208">//&nbsp;../reflect/type.go.&nbsp;&nbsp;Don&#39;t&nbsp;change&nbsp;this&nbsp;structure&nbsp;without&nbsp;also&nbsp;changing&nbsp;that&nbsp;code!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768294">count</span>&nbsp;<span class="builtintype" id="1768300">int</span>&nbsp;<span class="comment" id="1768304">//&nbsp;#&nbsp;live&nbsp;cells&nbsp;==&nbsp;size&nbsp;of&nbsp;map.&nbsp;&nbsp;Must&nbsp;be&nbsp;first&nbsp;(used&nbsp;by&nbsp;len()&nbsp;builtin)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768376">flags</span>&nbsp;<span class="builtintype" id="1768382">uint32</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768390">hash0</span>&nbsp;<span class="builtintype" id="1768396">uint32</span>&nbsp;<span class="comment" id="1768403">//&nbsp;hash&nbsp;seed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768417">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1768423">uint8</span>&nbsp;&nbsp;<span class="comment" id="1768430">//&nbsp;log_2&nbsp;of&nbsp;#&nbsp;of&nbsp;buckets&nbsp;(can&nbsp;hold&nbsp;up&nbsp;to&nbsp;loadFactor&nbsp;*&nbsp;2^B&nbsp;items)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768497">buckets</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768508"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1768514">.</span><span class="ident" id="1768515">Pointer</span>&nbsp;<span class="comment" id="1768523">//&nbsp;array&nbsp;of&nbsp;2^B&nbsp;Buckets.&nbsp;may&nbsp;be&nbsp;nil&nbsp;if&nbsp;count==0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768573">oldbuckets</span>&nbsp;<span class="ident" id="1768584"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1768590">.</span><span class="ident" id="1768591">Pointer</span>&nbsp;<span class="comment" id="1768599">//&nbsp;previous&nbsp;bucket&nbsp;array&nbsp;of&nbsp;half&nbsp;the&nbsp;size,&nbsp;non-nil&nbsp;only&nbsp;when&nbsp;growing</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768669">nevacuate</span>&nbsp;&nbsp;<span class="builtintype" id="1768680">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1768695">//&nbsp;progress&nbsp;counter&nbsp;for&nbsp;evacuation&nbsp;(buckets&nbsp;less&nbsp;than&nbsp;this&nbsp;have&nbsp;been&nbsp;evacuated)</span><br>
<span class="lineno"></span><span class="op" id="1768775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1768778">//&nbsp;A&nbsp;bucket&nbsp;for&nbsp;a&nbsp;Go&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="1768804">type</span>&nbsp;<span class="ident" id="1768809">bmap</span>&nbsp;<span class="keyword" id="1768814">struct</span>&nbsp;<span class="op" id="1768821">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768824">tophash</span>&nbsp;&nbsp;<span class="op" id="1768833">[</span><span class="ident" id="1768834"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1768843">]</span><span class="builtintype" id="1768844">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768851">overflow</span>&nbsp;<span class="op" id="1768860">*</span><span class="ident" id="1768861"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768867">//&nbsp;Followed&nbsp;by&nbsp;bucketCnt&nbsp;keys&nbsp;and&nbsp;then&nbsp;bucketCnt&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768925">//&nbsp;NOTE:&nbsp;packing&nbsp;all&nbsp;the&nbsp;keys&nbsp;together&nbsp;and&nbsp;then&nbsp;all&nbsp;the&nbsp;values&nbsp;together&nbsp;makes&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769008">//&nbsp;code&nbsp;a&nbsp;bit&nbsp;more&nbsp;complicated&nbsp;than&nbsp;alternating&nbsp;key/value/key/value/...&nbsp;but&nbsp;it&nbsp;allows</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769095">//&nbsp;us&nbsp;to&nbsp;eliminate&nbsp;padding&nbsp;which&nbsp;would&nbsp;be&nbsp;needed&nbsp;for,&nbsp;e.g.,&nbsp;map[int64]int8.</span><br>
<span class="lineno"></span><span class="op" id="1769171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1769174">//&nbsp;A&nbsp;hash&nbsp;iteration&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1769205">//&nbsp;If&nbsp;you&nbsp;modify&nbsp;hiter,&nbsp;also&nbsp;change&nbsp;cmd/gc/reflect.c&nbsp;to&nbsp;indicate</span><br>
<span class="lineno">130</span><span class="comment" id="1769270">//&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="1769303">type</span>&nbsp;<span class="ident" id="1769308">hiter</span>&nbsp;<span class="keyword" id="1769314">struct</span>&nbsp;<span class="op" id="1769321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769324">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769336"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1769342">.</span><span class="ident" id="1769343">Pointer</span>&nbsp;<span class="comment" id="1769351">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;first&nbsp;position.&nbsp;&nbsp;Write&nbsp;nil&nbsp;to&nbsp;indicate&nbsp;iteration&nbsp;end&nbsp;(see&nbsp;cmd/gc/range.c).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769441">value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769453"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1769459">.</span><span class="ident" id="1769460">Pointer</span>&nbsp;<span class="comment" id="1769468">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;second&nbsp;position&nbsp;(see&nbsp;cmd/gc/range.c).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769521">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1769533">*</span><span class="ident" id="1769534"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769543">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1769555">*</span><span class="ident" id="1769556"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769562">buckets</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769574"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1769580">.</span><span class="ident" id="1769581">Pointer</span>&nbsp;<span class="comment" id="1769589">//&nbsp;bucket&nbsp;ptr&nbsp;at&nbsp;hash_iter&nbsp;initialization&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769637">bptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1769649">*</span><span class="ident" id="1769650"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1769664">//&nbsp;current&nbsp;bucket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769683">startBucket</span>&nbsp;<span class="builtintype" id="1769695">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1769710">//&nbsp;bucket&nbsp;iteration&nbsp;started&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769742">offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769754">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1769769">//&nbsp;intra-bucket&nbsp;offset&nbsp;to&nbsp;start&nbsp;from&nbsp;during&nbsp;iteration&nbsp;(should&nbsp;be&nbsp;big&nbsp;enough&nbsp;to&nbsp;hold&nbsp;bucketCnt-1)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769867">wrapped</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769879">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1769894">//&nbsp;already&nbsp;wrapped&nbsp;around&nbsp;from&nbsp;end&nbsp;of&nbsp;bucket&nbsp;array&nbsp;to&nbsp;beginning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769959">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769971">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769978">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769990">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769997">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1770009">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770018">checkBucket</span>&nbsp;<span class="builtintype" id="1770030">uintptr</span><br>
<span class="lineno">145</span><span class="op" id="1770038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1770041">func</span>&nbsp;<span class="ident" id="1770046">evacuated</span><span class="op" id="1770055">(</span><span class="ident" id="1770056">b</span>&nbsp;<span class="op" id="1770058">*</span><span class="ident" id="1770059"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1770063">)</span>&nbsp;<span class="builtintype" id="1770065">bool</span>&nbsp;<span class="op" id="1770070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770073">h</span>&nbsp;<span class="op" id="1770075">:=</span>&nbsp;<span class="ident" id="1770078"><a href="/runtime/hashmap.go.html#1770056">b</a></span><span class="op" id="1770079">.</span><span class="ident" id="1770080">tophash</span><span class="op" id="1770087">[</span><span class="num" id="1770088">0</span><span class="op" id="1770089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770092">return</span>&nbsp;<span class="ident" id="1770099"><a href="/runtime/hashmap.go.html#1770073">h</a></span>&nbsp;<span class="op" id="1770101">&gt;</span>&nbsp;<span class="ident" id="1770103"><a href="/runtime/hashmap.go.html#1767447">empty</a></span>&nbsp;<span class="op" id="1770109">&amp;&amp;</span>&nbsp;<span class="ident" id="1770112"><a href="/runtime/hashmap.go.html#1770073">h</a></span>&nbsp;<span class="op" id="1770114">&lt;</span>&nbsp;<span class="ident" id="1770116"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span><br>
<span class="lineno">150</span><span class="op" id="1770127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1770130">func</span>&nbsp;<span class="ident" id="1770135">makemap</span><span class="op" id="1770142">(</span><span class="ident" id="1770143">t</span>&nbsp;<span class="op" id="1770145">*</span><span class="ident" id="1770146"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1770153">,</span>&nbsp;<span class="ident" id="1770155">hint</span>&nbsp;<span class="ident" id="1770160">int64</span><span class="op" id="1770165">)</span>&nbsp;<span class="op" id="1770167">*</span><span class="ident" id="1770168"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span>&nbsp;<span class="op" id="1770173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770176">if</span>&nbsp;<span class="ident" id="1770179">sz</span>&nbsp;<span class="op" id="1770182">:=</span>&nbsp;<span class="ident" id="1770185"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1770191">.</span><span class="ident" id="1770192">Sizeof</span><span class="op" id="1770198">(</span><span class="ident" id="1770199"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1770203">{</span><span class="op" id="1770204">}</span><span class="op" id="1770205">)</span><span class="op" id="1770206">;</span>&nbsp;<span class="ident" id="1770208"><a href="/runtime/hashmap.go.html#1770179">sz</a></span>&nbsp;<span class="op" id="1770211">&gt;</span>&nbsp;<span class="num" id="1770213">48</span>&nbsp;<span class="op" id="1770216">||</span>&nbsp;<span class="ident" id="1770219"><a href="/runtime/hashmap.go.html#1770179">sz</a></span>&nbsp;<span class="op" id="1770222">!=</span>&nbsp;<span class="builtintype" id="1770225">uintptr</span><span class="op" id="1770232">(</span><span class="ident" id="1770233"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770234">.</span><span class="ident" id="1770235">hmap</span><span class="op" id="1770239">.</span><span class="ident" id="1770240">size</span><span class="op" id="1770244">)</span>&nbsp;<span class="op" id="1770246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770250"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1770257">(</span><span class="string" id="1770258">&#34;bad&nbsp;hmap&nbsp;size&#34;</span><span class="op" id="1770273">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1770276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770280">if</span>&nbsp;<span class="ident" id="1770283"><a href="/runtime/hashmap.go.html#1770155">hint</a></span>&nbsp;<span class="op" id="1770288">&lt;</span>&nbsp;<span class="num" id="1770290">0</span>&nbsp;<span class="op" id="1770292">||</span>&nbsp;<span class="ident" id="1770295">int64</span><span class="op" id="1770300">(</span><span class="builtintype" id="1770301">int32</span><span class="op" id="1770306">(</span><span class="ident" id="1770307"><a href="/runtime/hashmap.go.html#1770155">hint</a></span><span class="op" id="1770311">)</span><span class="op" id="1770312">)</span>&nbsp;<span class="op" id="1770314">!=</span>&nbsp;<span class="ident" id="1770317"><a href="/runtime/hashmap.go.html#1770155">hint</a></span>&nbsp;<span class="op" id="1770322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1770326">panic</span><span class="op" id="1770331">(</span><span class="string" id="1770332">&#34;makemap:&nbsp;size&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="1770360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1770364">//&nbsp;TODO:&nbsp;make&nbsp;hint&nbsp;an&nbsp;int,&nbsp;then&nbsp;none&nbsp;of&nbsp;this&nbsp;nonsense</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1770419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770423">if</span>&nbsp;<span class="op" id="1770426">!</span><span class="ident" id="1770427"><a href="/runtime/hashmap.go.html#1791360">ismapkey</a></span><span class="op" id="1770435">(</span><span class="ident" id="1770436"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770437">.</span><span class="ident" id="1770438">key</span><span class="op" id="1770441">)</span>&nbsp;<span class="op" id="1770443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770447"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1770454">(</span><span class="string" id="1770455">&#34;runtime.makemap:&nbsp;unsupported&nbsp;map&nbsp;key&nbsp;type&#34;</span><span class="op" id="1770498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1770501">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1770505">//&nbsp;check&nbsp;compiler&#39;s&nbsp;and&nbsp;reflect&#39;s&nbsp;math</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770545">if</span>&nbsp;<span class="ident" id="1770548"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770549">.</span><span class="ident" id="1770550">key</span><span class="op" id="1770553">.</span><span class="ident" id="1770554">size</span>&nbsp;<span class="op" id="1770559">&gt;</span>&nbsp;<span class="ident" id="1770561"><a href="/runtime/hashmap.go.html#1766817">maxKeySize</a></span>&nbsp;<span class="op" id="1770572">&amp;&amp;</span>&nbsp;<span class="op" id="1770575">(</span><span class="op" id="1770576">!</span><span class="ident" id="1770577"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770578">.</span><span class="ident" id="1770579">indirectkey</span>&nbsp;<span class="op" id="1770591">||</span>&nbsp;<span class="ident" id="1770594"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770595">.</span><span class="ident" id="1770596">keysize</span>&nbsp;<span class="op" id="1770604">!=</span>&nbsp;<span class="builtintype" id="1770607">uint8</span><span class="op" id="1770612">(</span><span class="ident" id="1770613"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1770620">)</span><span class="op" id="1770621">)</span>&nbsp;<span class="op" id="1770623">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770628"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770629">.</span><span class="ident" id="1770630">key</span><span class="op" id="1770633">.</span><span class="ident" id="1770634">size</span>&nbsp;<span class="op" id="1770639">&lt;=</span>&nbsp;<span class="ident" id="1770642"><a href="/runtime/hashmap.go.html#1766817">maxKeySize</a></span>&nbsp;<span class="op" id="1770653">&amp;&amp;</span>&nbsp;<span class="op" id="1770656">(</span><span class="ident" id="1770657"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770658">.</span><span class="ident" id="1770659">indirectkey</span>&nbsp;<span class="op" id="1770671">||</span>&nbsp;<span class="ident" id="1770674"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770675">.</span><span class="ident" id="1770676">keysize</span>&nbsp;<span class="op" id="1770684">!=</span>&nbsp;<span class="builtintype" id="1770687">uint8</span><span class="op" id="1770692">(</span><span class="ident" id="1770693"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770694">.</span><span class="ident" id="1770695">key</span><span class="op" id="1770698">.</span><span class="ident" id="1770699">size</span><span class="op" id="1770703">)</span><span class="op" id="1770704">)</span>&nbsp;<span class="op" id="1770706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770710"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1770717">(</span><span class="string" id="1770718">&#34;key&nbsp;size&nbsp;wrong&#34;</span><span class="op" id="1770734">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1770737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770740">if</span>&nbsp;<span class="ident" id="1770743"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770744">.</span><span class="ident" id="1770745">elem</span><span class="op" id="1770749">.</span><span class="ident" id="1770750">size</span>&nbsp;<span class="op" id="1770755">&gt;</span>&nbsp;<span class="ident" id="1770757"><a href="/runtime/hashmap.go.html#1766837">maxValueSize</a></span>&nbsp;<span class="op" id="1770770">&amp;&amp;</span>&nbsp;<span class="op" id="1770773">(</span><span class="op" id="1770774">!</span><span class="ident" id="1770775"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770776">.</span><span class="ident" id="1770777">indirectvalue</span>&nbsp;<span class="op" id="1770791">||</span>&nbsp;<span class="ident" id="1770794"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770795">.</span><span class="ident" id="1770796">valuesize</span>&nbsp;<span class="op" id="1770806">!=</span>&nbsp;<span class="builtintype" id="1770809">uint8</span><span class="op" id="1770814">(</span><span class="ident" id="1770815"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1770822">)</span><span class="op" id="1770823">)</span>&nbsp;<span class="op" id="1770825">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770830"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770831">.</span><span class="ident" id="1770832">elem</span><span class="op" id="1770836">.</span><span class="ident" id="1770837">size</span>&nbsp;<span class="op" id="1770842">&lt;=</span>&nbsp;<span class="ident" id="1770845"><a href="/runtime/hashmap.go.html#1766837">maxValueSize</a></span>&nbsp;<span class="op" id="1770858">&amp;&amp;</span>&nbsp;<span class="op" id="1770861">(</span><span class="ident" id="1770862"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770863">.</span><span class="ident" id="1770864">indirectvalue</span>&nbsp;<span class="op" id="1770878">||</span>&nbsp;<span class="ident" id="1770881"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770882">.</span><span class="ident" id="1770883">valuesize</span>&nbsp;<span class="op" id="1770893">!=</span>&nbsp;<span class="builtintype" id="1770896">uint8</span><span class="op" id="1770901">(</span><span class="ident" id="1770902"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1770903">.</span><span class="ident" id="1770904">elem</span><span class="op" id="1770908">.</span><span class="ident" id="1770909">size</span><span class="op" id="1770913">)</span><span class="op" id="1770914">)</span>&nbsp;<span class="op" id="1770916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770920"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1770927">(</span><span class="string" id="1770928">&#34;value&nbsp;size&nbsp;wrong&#34;</span><span class="op" id="1770946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1770949">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1770953">//&nbsp;invariants&nbsp;we&nbsp;depend&nbsp;on.&nbsp;&nbsp;We&nbsp;should&nbsp;probably&nbsp;check&nbsp;these&nbsp;at&nbsp;compile&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771030">//&nbsp;somewhere,&nbsp;but&nbsp;for&nbsp;now&nbsp;we&#39;ll&nbsp;do&nbsp;it&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771075">if</span>&nbsp;<span class="ident" id="1771078"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771079">.</span><span class="ident" id="1771080">key</span><span class="op" id="1771083">.</span><span class="ident" id="1771084">align</span>&nbsp;<span class="op" id="1771090">&gt;</span>&nbsp;<span class="ident" id="1771092"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1771102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771106"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1771113">(</span><span class="string" id="1771114">&#34;key&nbsp;align&nbsp;too&nbsp;big&#34;</span><span class="op" id="1771133">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771139">if</span>&nbsp;<span class="ident" id="1771142"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771143">.</span><span class="ident" id="1771144">elem</span><span class="op" id="1771148">.</span><span class="ident" id="1771149">align</span>&nbsp;<span class="op" id="1771155">&gt;</span>&nbsp;<span class="ident" id="1771157"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1771167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771171"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1771178">(</span><span class="string" id="1771179">&#34;value&nbsp;align&nbsp;too&nbsp;big&#34;</span><span class="op" id="1771200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771206">if</span>&nbsp;<span class="builtintype" id="1771209">uintptr</span><span class="op" id="1771216">(</span><span class="ident" id="1771217"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771218">.</span><span class="ident" id="1771219">key</span><span class="op" id="1771222">.</span><span class="ident" id="1771223">size</span><span class="op" id="1771227">)</span><span class="op" id="1771228">%</span><span class="builtintype" id="1771229">uintptr</span><span class="op" id="1771236">(</span><span class="ident" id="1771237"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771238">.</span><span class="ident" id="1771239">key</span><span class="op" id="1771242">.</span><span class="ident" id="1771243">align</span><span class="op" id="1771248">)</span>&nbsp;<span class="op" id="1771250">!=</span>&nbsp;<span class="num" id="1771253">0</span>&nbsp;<span class="op" id="1771255">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771259"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1771266">(</span><span class="string" id="1771267">&#34;key&nbsp;size&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;key&nbsp;align&#34;</span><span class="op" id="1771305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771311">if</span>&nbsp;<span class="builtintype" id="1771314">uintptr</span><span class="op" id="1771321">(</span><span class="ident" id="1771322"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771323">.</span><span class="ident" id="1771324">elem</span><span class="op" id="1771328">.</span><span class="ident" id="1771329">size</span><span class="op" id="1771333">)</span><span class="op" id="1771334">%</span><span class="builtintype" id="1771335">uintptr</span><span class="op" id="1771342">(</span><span class="ident" id="1771343"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771344">.</span><span class="ident" id="1771345">elem</span><span class="op" id="1771349">.</span><span class="ident" id="1771350">align</span><span class="op" id="1771355">)</span>&nbsp;<span class="op" id="1771357">!=</span>&nbsp;<span class="num" id="1771360">0</span>&nbsp;<span class="op" id="1771362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771366"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1771373">(</span><span class="string" id="1771374">&#34;value&nbsp;size&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;value&nbsp;align&#34;</span><span class="op" id="1771416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771419">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771422">if</span>&nbsp;<span class="ident" id="1771425"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1771435">&lt;</span>&nbsp;<span class="num" id="1771437">8</span>&nbsp;<span class="op" id="1771439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771443"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1771450">(</span><span class="string" id="1771451">&#34;bucketsize&nbsp;too&nbsp;small&nbsp;for&nbsp;proper&nbsp;alignment&#34;</span><span class="op" id="1771494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771500">if</span>&nbsp;<span class="ident" id="1771503"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1771513">%</span><span class="builtintype" id="1771514">uintptr</span><span class="op" id="1771521">(</span><span class="ident" id="1771522"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771523">.</span><span class="ident" id="1771524">key</span><span class="op" id="1771527">.</span><span class="ident" id="1771528">align</span><span class="op" id="1771533">)</span>&nbsp;<span class="op" id="1771535">!=</span>&nbsp;<span class="num" id="1771538">0</span>&nbsp;<span class="op" id="1771540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771544"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1771551">(</span><span class="string" id="1771552">&#34;need&nbsp;padding&nbsp;in&nbsp;bucket&nbsp;(key)&#34;</span><span class="op" id="1771582">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771588">if</span>&nbsp;<span class="ident" id="1771591"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1771601">%</span><span class="builtintype" id="1771602">uintptr</span><span class="op" id="1771609">(</span><span class="ident" id="1771610"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1771611">.</span><span class="ident" id="1771612">elem</span><span class="op" id="1771616">.</span><span class="ident" id="1771617">align</span><span class="op" id="1771622">)</span>&nbsp;<span class="op" id="1771624">!=</span>&nbsp;<span class="num" id="1771627">0</span>&nbsp;<span class="op" id="1771629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771633"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1771640">(</span><span class="string" id="1771641">&#34;need&nbsp;padding&nbsp;in&nbsp;bucket&nbsp;(value)&#34;</span><span class="op" id="1771673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771680">//&nbsp;find&nbsp;size&nbsp;parameter&nbsp;which&nbsp;will&nbsp;hold&nbsp;the&nbsp;requested&nbsp;#&nbsp;of&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771748">B</span>&nbsp;<span class="op" id="1771750">:=</span>&nbsp;<span class="builtintype" id="1771753">uint8</span><span class="op" id="1771758">(</span><span class="num" id="1771759">0</span><span class="op" id="1771760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771763">for</span>&nbsp;<span class="op" id="1771767">;</span>&nbsp;<span class="ident" id="1771769"><a href="/runtime/hashmap.go.html#1770155">hint</a></span>&nbsp;<span class="op" id="1771774">&gt;</span>&nbsp;<span class="ident" id="1771776"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1771786">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1771789">float32</span><span class="op" id="1771796">(</span><span class="ident" id="1771797"><a href="/runtime/hashmap.go.html#1770155">hint</a></span><span class="op" id="1771801">)</span>&nbsp;<span class="op" id="1771803">&gt;</span>&nbsp;<span class="ident" id="1771805"><a href="/runtime/hashmap.go.html#1766558">loadFactor</a></span><span class="op" id="1771815">*</span><span class="builtintype" id="1771816">float32</span><span class="op" id="1771823">(</span><span class="builtintype" id="1771824">uintptr</span><span class="op" id="1771831">(</span><span class="num" id="1771832">1</span><span class="op" id="1771833">)</span><span class="op" id="1771834">&lt;&lt;</span><span class="ident" id="1771836"><a href="/runtime/hashmap.go.html#1771748">B</a></span><span class="op" id="1771837">)</span><span class="op" id="1771838">;</span>&nbsp;<span class="ident" id="1771840"><a href="/runtime/hashmap.go.html#1771748">B</a></span><span class="op" id="1771841">++</span>&nbsp;<span class="op" id="1771844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771851">//&nbsp;allocate&nbsp;initial&nbsp;hash&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771883">//&nbsp;if&nbsp;B&nbsp;==&nbsp;0,&nbsp;the&nbsp;buckets&nbsp;field&nbsp;is&nbsp;allocated&nbsp;lazily&nbsp;later&nbsp;(in&nbsp;mapassign)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771957">//&nbsp;If&nbsp;hint&nbsp;is&nbsp;large&nbsp;zeroing&nbsp;this&nbsp;memory&nbsp;could&nbsp;take&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772018">var</span>&nbsp;<span class="ident" id="1772022">buckets</span>&nbsp;<span class="ident" id="1772030"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1772036">.</span><span class="ident" id="1772037">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772046">if</span>&nbsp;<span class="ident" id="1772049"><a href="/runtime/hashmap.go.html#1771748">B</a></span>&nbsp;<span class="op" id="1772051">!=</span>&nbsp;<span class="num" id="1772054">0</span>&nbsp;<span class="op" id="1772056">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772060">if</span>&nbsp;<span class="ident" id="1772063"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1772071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772076"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1772084">.</span><span class="ident" id="1772085">next_gc</span>&nbsp;<span class="op" id="1772093">=</span>&nbsp;<span class="ident" id="1772095"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1772103">.</span><span class="ident" id="1772104">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1772117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772121"><a href="/runtime/hashmap.go.html#1772022">buckets</a></span>&nbsp;<span class="op" id="1772129">=</span>&nbsp;<span class="ident" id="1772131"><a href="/runtime/malloc.go.html#1828735">newarray</a></span><span class="op" id="1772139">(</span><span class="ident" id="1772140"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1772141">.</span><span class="ident" id="1772142">bucket</span><span class="op" id="1772148">,</span>&nbsp;<span class="builtintype" id="1772150">uintptr</span><span class="op" id="1772157">(</span><span class="num" id="1772158">1</span><span class="op" id="1772159">)</span><span class="op" id="1772160">&lt;&lt;</span><span class="ident" id="1772162"><a href="/runtime/hashmap.go.html#1771748">B</a></span><span class="op" id="1772163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1772166">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1772170">//&nbsp;initialize&nbsp;Hmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772190">if</span>&nbsp;<span class="ident" id="1772193"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1772201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772205"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1772213">.</span><span class="ident" id="1772214">next_gc</span>&nbsp;<span class="op" id="1772222">=</span>&nbsp;<span class="ident" id="1772224"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1772232">.</span><span class="ident" id="1772233">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1772245">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772248">h</span>&nbsp;<span class="op" id="1772250">:=</span>&nbsp;<span class="op" id="1772253">(</span><span class="op" id="1772254">*</span><span class="ident" id="1772255"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1772259">)</span><span class="op" id="1772260">(</span><span class="ident" id="1772261"><a href="/runtime/malloc.go.html#1828515">newobject</a></span><span class="op" id="1772270">(</span><span class="ident" id="1772271"><a href="/runtime/hashmap.go.html#1770143">t</a></span><span class="op" id="1772272">.</span><span class="ident" id="1772273">hmap</span><span class="op" id="1772277">)</span><span class="op" id="1772278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772281"><a href="/runtime/hashmap.go.html#1772248">h</a></span><span class="op" id="1772282">.</span><span class="ident" id="1772283">count</span>&nbsp;<span class="op" id="1772289">=</span>&nbsp;<span class="num" id="1772291">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772294"><a href="/runtime/hashmap.go.html#1772248">h</a></span><span class="op" id="1772295">.</span><span class="ident" id="1772296">B</span>&nbsp;<span class="op" id="1772298">=</span>&nbsp;<span class="ident" id="1772300"><a href="/runtime/hashmap.go.html#1771748">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772303"><a href="/runtime/hashmap.go.html#1772248">h</a></span><span class="op" id="1772304">.</span><span class="ident" id="1772305">flags</span>&nbsp;<span class="op" id="1772311">=</span>&nbsp;<span class="num" id="1772313">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772316"><a href="/runtime/hashmap.go.html#1772248">h</a></span><span class="op" id="1772317">.</span><span class="ident" id="1772318">hash0</span>&nbsp;<span class="op" id="1772324">=</span>&nbsp;<span class="ident" id="1772326"><a href="/runtime/stubs.go.html#1972912">fastrand1</a></span><span class="op" id="1772335">(</span><span class="op" id="1772336">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772339"><a href="/runtime/hashmap.go.html#1772248">h</a></span><span class="op" id="1772340">.</span><span class="ident" id="1772341">buckets</span>&nbsp;<span class="op" id="1772349">=</span>&nbsp;<span class="ident" id="1772351"><a href="/runtime/hashmap.go.html#1772022">buckets</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772360"><a href="/runtime/hashmap.go.html#1772248">h</a></span><span class="op" id="1772361">.</span><span class="ident" id="1772362">oldbuckets</span>&nbsp;<span class="op" id="1772373">=</span>&nbsp;<span class="ident" id="1772375">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772380"><a href="/runtime/hashmap.go.html#1772248">h</a></span><span class="op" id="1772381">.</span><span class="ident" id="1772382">nevacuate</span>&nbsp;<span class="op" id="1772392">=</span>&nbsp;<span class="num" id="1772394">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772398">return</span>&nbsp;<span class="ident" id="1772405"><a href="/runtime/hashmap.go.html#1772248">h</a></span><br>
<span class="lineno">230</span><span class="op" id="1772407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1772410">//&nbsp;mapaccess1&nbsp;returns&nbsp;a&nbsp;pointer&nbsp;to&nbsp;h[key].&nbsp;&nbsp;Never&nbsp;returns&nbsp;nil,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="1772481">//&nbsp;it&nbsp;will&nbsp;return&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;zero&nbsp;object&nbsp;for&nbsp;the&nbsp;value&nbsp;type&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1772552">//&nbsp;the&nbsp;key&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno">235</span><span class="comment" id="1772582">//&nbsp;NOTE:&nbsp;The&nbsp;returned&nbsp;pointer&nbsp;may&nbsp;keep&nbsp;the&nbsp;whole&nbsp;map&nbsp;live,&nbsp;so&nbsp;don&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="1772650">//&nbsp;hold&nbsp;onto&nbsp;it&nbsp;for&nbsp;very&nbsp;long.</span><br>
<span class="lineno"></span><span class="keyword" id="1772681">func</span>&nbsp;<span class="ident" id="1772686">mapaccess1</span><span class="op" id="1772696">(</span><span class="ident" id="1772697">t</span>&nbsp;<span class="op" id="1772699">*</span><span class="ident" id="1772700"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1772707">,</span>&nbsp;<span class="ident" id="1772709">h</span>&nbsp;<span class="op" id="1772711">*</span><span class="ident" id="1772712"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1772716">,</span>&nbsp;<span class="ident" id="1772718">key</span>&nbsp;<span class="ident" id="1772722"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1772728">.</span><span class="ident" id="1772729">Pointer</span><span class="op" id="1772736">)</span>&nbsp;<span class="ident" id="1772738"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1772744">.</span><span class="ident" id="1772745">Pointer</span>&nbsp;<span class="op" id="1772753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772756">if</span>&nbsp;<span class="ident" id="1772759"><a href="/runtime/race0.go.html#1906481">raceenabled</a></span>&nbsp;<span class="op" id="1772771">&amp;&amp;</span>&nbsp;<span class="ident" id="1772774"><a href="/runtime/hashmap.go.html#1772709">h</a></span>&nbsp;<span class="op" id="1772776">!=</span>&nbsp;<span class="ident" id="1772779">nil</span>&nbsp;<span class="op" id="1772783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772787">callerpc</span>&nbsp;<span class="op" id="1772796">:=</span>&nbsp;<span class="ident" id="1772799"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1772810">(</span><span class="ident" id="1772811"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1772817">.</span><span class="ident" id="1772818">Pointer</span><span class="op" id="1772825">(</span><span class="op" id="1772826">&amp;</span><span class="ident" id="1772827"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1772828">)</span><span class="op" id="1772829">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772833">pc</span>&nbsp;<span class="op" id="1772836">:=</span>&nbsp;<span class="ident" id="1772839"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1772845">(</span><span class="ident" id="1772846"><a href="/runtime/hashmap.go.html#1772686">mapaccess1</a></span><span class="op" id="1772856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772860"><a href="/runtime/race0.go.html#1907159">racereadpc</a></span><span class="op" id="1772870">(</span><span class="ident" id="1772871"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1772877">.</span><span class="ident" id="1772878">Pointer</span><span class="op" id="1772885">(</span><span class="ident" id="1772886"><a href="/runtime/hashmap.go.html#1772709">h</a></span><span class="op" id="1772887">)</span><span class="op" id="1772888">,</span>&nbsp;<span class="ident" id="1772890"><a href="/runtime/hashmap.go.html#1772787">callerpc</a></span><span class="op" id="1772898">,</span>&nbsp;<span class="ident" id="1772900"><a href="/runtime/hashmap.go.html#1772833">pc</a></span><span class="op" id="1772902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1772906"><a href="/runtime/race0.go.html#1906583">raceReadObjectPC</a></span><span class="op" id="1772922">(</span><span class="ident" id="1772923"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1772924">.</span><span class="ident" id="1772925">key</span><span class="op" id="1772928">,</span>&nbsp;<span class="ident" id="1772930"><a href="/runtime/hashmap.go.html#1772718">key</a></span><span class="op" id="1772933">,</span>&nbsp;<span class="ident" id="1772935"><a href="/runtime/hashmap.go.html#1772787">callerpc</a></span><span class="op" id="1772943">,</span>&nbsp;<span class="ident" id="1772945"><a href="/runtime/hashmap.go.html#1772833">pc</a></span><span class="op" id="1772947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1772950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772953">if</span>&nbsp;<span class="ident" id="1772956"><a href="/runtime/hashmap.go.html#1772709">h</a></span>&nbsp;<span class="op" id="1772958">==</span>&nbsp;<span class="ident" id="1772961">nil</span>&nbsp;<span class="op" id="1772965">||</span>&nbsp;<span class="ident" id="1772968"><a href="/runtime/hashmap.go.html#1772709">h</a></span><span class="op" id="1772969">.</span><span class="ident" id="1772970">count</span>&nbsp;<span class="op" id="1772976">==</span>&nbsp;<span class="num" id="1772979">0</span>&nbsp;<span class="op" id="1772981">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1772985">return</span>&nbsp;<span class="ident" id="1772992"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1772998">.</span><span class="ident" id="1772999">Pointer</span><span class="op" id="1773006">(</span><span class="ident" id="1773007"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773008">.</span><span class="ident" id="1773009">elem</span><span class="op" id="1773013">.</span><span class="ident" id="1773014">zero</span><span class="op" id="1773018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773024">alg</span>&nbsp;<span class="op" id="1773028">:=</span>&nbsp;<span class="ident" id="1773031"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1773036">(</span><span class="ident" id="1773037"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773038">.</span><span class="ident" id="1773039">key</span><span class="op" id="1773042">.</span><span class="ident" id="1773043">alg</span><span class="op" id="1773046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773049">hash</span>&nbsp;<span class="op" id="1773054">:=</span>&nbsp;<span class="ident" id="1773057"><a href="/runtime/hashmap.go.html#1773024">alg</a></span><span class="op" id="1773060">.</span><span class="ident" id="1773061">hash</span><span class="op" id="1773065">(</span><span class="ident" id="1773066"><a href="/runtime/hashmap.go.html#1772718">key</a></span><span class="op" id="1773069">,</span>&nbsp;<span class="builtintype" id="1773071">uintptr</span><span class="op" id="1773078">(</span><span class="ident" id="1773079"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773080">.</span><span class="ident" id="1773081">key</span><span class="op" id="1773084">.</span><span class="ident" id="1773085">size</span><span class="op" id="1773089">)</span><span class="op" id="1773090">,</span>&nbsp;<span class="builtintype" id="1773092">uintptr</span><span class="op" id="1773099">(</span><span class="ident" id="1773100"><a href="/runtime/hashmap.go.html#1772709">h</a></span><span class="op" id="1773101">.</span><span class="ident" id="1773102">hash0</span><span class="op" id="1773107">)</span><span class="op" id="1773108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773111">m</span>&nbsp;<span class="op" id="1773113">:=</span>&nbsp;<span class="builtintype" id="1773116">uintptr</span><span class="op" id="1773123">(</span><span class="num" id="1773124">1</span><span class="op" id="1773125">)</span><span class="op" id="1773126">&lt;&lt;</span><span class="ident" id="1773128"><a href="/runtime/hashmap.go.html#1772709">h</a></span><span class="op" id="1773129">.</span><span class="ident" id="1773130">B</span>&nbsp;<span class="op" id="1773132">-</span>&nbsp;<span class="num" id="1773134">1</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773137">b</span>&nbsp;<span class="op" id="1773139">:=</span>&nbsp;<span class="op" id="1773142">(</span><span class="op" id="1773143">*</span><span class="ident" id="1773144"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1773148">)</span><span class="op" id="1773149">(</span><span class="ident" id="1773150"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1773153">(</span><span class="ident" id="1773154"><a href="/runtime/hashmap.go.html#1772709">h</a></span><span class="op" id="1773155">.</span><span class="ident" id="1773156">buckets</span><span class="op" id="1773163">,</span>&nbsp;<span class="op" id="1773165">(</span><span class="ident" id="1773166"><a href="/runtime/hashmap.go.html#1773049">hash</a></span><span class="op" id="1773170">&amp;</span><span class="ident" id="1773171"><a href="/runtime/hashmap.go.html#1773111">m</a></span><span class="op" id="1773172">)</span><span class="op" id="1773173">*</span><span class="builtintype" id="1773174">uintptr</span><span class="op" id="1773181">(</span><span class="ident" id="1773182"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773183">.</span><span class="ident" id="1773184">bucketsize</span><span class="op" id="1773194">)</span><span class="op" id="1773195">)</span><span class="op" id="1773196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773199">if</span>&nbsp;<span class="ident" id="1773202">c</span>&nbsp;<span class="op" id="1773204">:=</span>&nbsp;<span class="ident" id="1773207"><a href="/runtime/hashmap.go.html#1772709">h</a></span><span class="op" id="1773208">.</span><span class="ident" id="1773209">oldbuckets</span><span class="op" id="1773219">;</span>&nbsp;<span class="ident" id="1773221"><a href="/runtime/hashmap.go.html#1773202">c</a></span>&nbsp;<span class="op" id="1773223">!=</span>&nbsp;<span class="ident" id="1773226">nil</span>&nbsp;<span class="op" id="1773230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773234">oldb</span>&nbsp;<span class="op" id="1773239">:=</span>&nbsp;<span class="op" id="1773242">(</span><span class="op" id="1773243">*</span><span class="ident" id="1773244"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1773248">)</span><span class="op" id="1773249">(</span><span class="ident" id="1773250"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1773253">(</span><span class="ident" id="1773254"><a href="/runtime/hashmap.go.html#1773202">c</a></span><span class="op" id="1773255">,</span>&nbsp;<span class="op" id="1773257">(</span><span class="ident" id="1773258"><a href="/runtime/hashmap.go.html#1773049">hash</a></span><span class="op" id="1773262">&amp;</span><span class="op" id="1773263">(</span><span class="ident" id="1773264"><a href="/runtime/hashmap.go.html#1773111">m</a></span><span class="op" id="1773265">&gt;&gt;</span><span class="num" id="1773267">1</span><span class="op" id="1773268">)</span><span class="op" id="1773269">)</span><span class="op" id="1773270">*</span><span class="builtintype" id="1773271">uintptr</span><span class="op" id="1773278">(</span><span class="ident" id="1773279"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773280">.</span><span class="ident" id="1773281">bucketsize</span><span class="op" id="1773291">)</span><span class="op" id="1773292">)</span><span class="op" id="1773293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773297">if</span>&nbsp;<span class="op" id="1773300">!</span><span class="ident" id="1773301"><a href="/runtime/hashmap.go.html#1770046">evacuated</a></span><span class="op" id="1773310">(</span><span class="ident" id="1773311"><a href="/runtime/hashmap.go.html#1773234">oldb</a></span><span class="op" id="1773315">)</span>&nbsp;<span class="op" id="1773317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773322"><a href="/runtime/hashmap.go.html#1773137">b</a></span>&nbsp;<span class="op" id="1773324">=</span>&nbsp;<span class="ident" id="1773326"><a href="/runtime/hashmap.go.html#1773234">oldb</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773339">top</span>&nbsp;<span class="op" id="1773343">:=</span>&nbsp;<span class="builtintype" id="1773346">uint8</span><span class="op" id="1773351">(</span><span class="ident" id="1773352"><a href="/runtime/hashmap.go.html#1773049">hash</a></span>&nbsp;<span class="op" id="1773357">&gt;&gt;</span>&nbsp;<span class="op" id="1773360">(</span><span class="ident" id="1773361"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1773368">*</span><span class="num" id="1773369">8</span>&nbsp;<span class="op" id="1773371">-</span>&nbsp;<span class="num" id="1773373">8</span><span class="op" id="1773374">)</span><span class="op" id="1773375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773378">if</span>&nbsp;<span class="ident" id="1773381"><a href="/runtime/hashmap.go.html#1773339">top</a></span>&nbsp;<span class="op" id="1773385">&lt;</span>&nbsp;<span class="ident" id="1773387"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span>&nbsp;<span class="op" id="1773398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773402"><a href="/runtime/hashmap.go.html#1773339">top</a></span>&nbsp;<span class="op" id="1773406">+=</span>&nbsp;<span class="ident" id="1773409"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773424">for</span>&nbsp;<span class="op" id="1773428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773432">for</span>&nbsp;<span class="ident" id="1773436">i</span>&nbsp;<span class="op" id="1773438">:=</span>&nbsp;<span class="builtintype" id="1773441">uintptr</span><span class="op" id="1773448">(</span><span class="num" id="1773449">0</span><span class="op" id="1773450">)</span><span class="op" id="1773451">;</span>&nbsp;<span class="ident" id="1773453"><a href="/runtime/hashmap.go.html#1773436">i</a></span>&nbsp;<span class="op" id="1773455">&lt;</span>&nbsp;<span class="ident" id="1773457"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1773466">;</span>&nbsp;<span class="ident" id="1773468"><a href="/runtime/hashmap.go.html#1773436">i</a></span><span class="op" id="1773469">++</span>&nbsp;<span class="op" id="1773472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773477">if</span>&nbsp;<span class="ident" id="1773480"><a href="/runtime/hashmap.go.html#1773137">b</a></span><span class="op" id="1773481">.</span><span class="ident" id="1773482">tophash</span><span class="op" id="1773489">[</span><span class="ident" id="1773490"><a href="/runtime/hashmap.go.html#1773436">i</a></span><span class="op" id="1773491">]</span>&nbsp;<span class="op" id="1773493">!=</span>&nbsp;<span class="ident" id="1773496"><a href="/runtime/hashmap.go.html#1773339">top</a></span>&nbsp;<span class="op" id="1773500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773506">continue</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773523">k</span>&nbsp;<span class="op" id="1773525">:=</span>&nbsp;<span class="ident" id="1773528"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1773531">(</span><span class="ident" id="1773532"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1773538">.</span><span class="ident" id="1773539">Pointer</span><span class="op" id="1773546">(</span><span class="ident" id="1773547"><a href="/runtime/hashmap.go.html#1773137">b</a></span><span class="op" id="1773548">)</span><span class="op" id="1773549">,</span>&nbsp;<span class="ident" id="1773551"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1773561">+</span><span class="ident" id="1773562"><a href="/runtime/hashmap.go.html#1773436">i</a></span><span class="op" id="1773563">*</span><span class="builtintype" id="1773564">uintptr</span><span class="op" id="1773571">(</span><span class="ident" id="1773572"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773573">.</span><span class="ident" id="1773574">keysize</span><span class="op" id="1773581">)</span><span class="op" id="1773582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773587">if</span>&nbsp;<span class="ident" id="1773590"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773591">.</span><span class="ident" id="1773592">indirectkey</span>&nbsp;<span class="op" id="1773604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773610"><a href="/runtime/hashmap.go.html#1773523">k</a></span>&nbsp;<span class="op" id="1773612">=</span>&nbsp;<span class="op" id="1773614">*</span><span class="op" id="1773615">(</span><span class="op" id="1773616">(</span><span class="op" id="1773617">*</span><span class="ident" id="1773618"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1773624">.</span><span class="ident" id="1773625">Pointer</span><span class="op" id="1773632">)</span><span class="op" id="1773633">(</span><span class="ident" id="1773634"><a href="/runtime/hashmap.go.html#1773523">k</a></span><span class="op" id="1773635">)</span><span class="op" id="1773636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773641">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773646">if</span>&nbsp;<span class="ident" id="1773649"><a href="/runtime/hashmap.go.html#1773024">alg</a></span><span class="op" id="1773652">.</span><span class="ident" id="1773653">equal</span><span class="op" id="1773658">(</span><span class="ident" id="1773659"><a href="/runtime/hashmap.go.html#1772718">key</a></span><span class="op" id="1773662">,</span>&nbsp;<span class="ident" id="1773664"><a href="/runtime/hashmap.go.html#1773523">k</a></span><span class="op" id="1773665">,</span>&nbsp;<span class="builtintype" id="1773667">uintptr</span><span class="op" id="1773674">(</span><span class="ident" id="1773675"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773676">.</span><span class="ident" id="1773677">key</span><span class="op" id="1773680">.</span><span class="ident" id="1773681">size</span><span class="op" id="1773685">)</span><span class="op" id="1773686">)</span>&nbsp;<span class="op" id="1773688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773694">v</span>&nbsp;<span class="op" id="1773696">:=</span>&nbsp;<span class="ident" id="1773699"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1773702">(</span><span class="ident" id="1773703"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1773709">.</span><span class="ident" id="1773710">Pointer</span><span class="op" id="1773717">(</span><span class="ident" id="1773718"><a href="/runtime/hashmap.go.html#1773137">b</a></span><span class="op" id="1773719">)</span><span class="op" id="1773720">,</span>&nbsp;<span class="ident" id="1773722"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1773732">+</span><span class="ident" id="1773733"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1773742">*</span><span class="builtintype" id="1773743">uintptr</span><span class="op" id="1773750">(</span><span class="ident" id="1773751"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773752">.</span><span class="ident" id="1773753">keysize</span><span class="op" id="1773760">)</span><span class="op" id="1773761">+</span><span class="ident" id="1773762"><a href="/runtime/hashmap.go.html#1773436">i</a></span><span class="op" id="1773763">*</span><span class="builtintype" id="1773764">uintptr</span><span class="op" id="1773771">(</span><span class="ident" id="1773772"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773773">.</span><span class="ident" id="1773774">valuesize</span><span class="op" id="1773783">)</span><span class="op" id="1773784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773790">if</span>&nbsp;<span class="ident" id="1773793"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773794">.</span><span class="ident" id="1773795">indirectvalue</span>&nbsp;<span class="op" id="1773809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773816"><a href="/runtime/hashmap.go.html#1773694">v</a></span>&nbsp;<span class="op" id="1773818">=</span>&nbsp;<span class="op" id="1773820">*</span><span class="op" id="1773821">(</span><span class="op" id="1773822">(</span><span class="op" id="1773823">*</span><span class="ident" id="1773824"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1773830">.</span><span class="ident" id="1773831">Pointer</span><span class="op" id="1773838">)</span><span class="op" id="1773839">(</span><span class="ident" id="1773840"><a href="/runtime/hashmap.go.html#1773694">v</a></span><span class="op" id="1773841">)</span><span class="op" id="1773842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773848">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773854">return</span>&nbsp;<span class="ident" id="1773861"><a href="/runtime/hashmap.go.html#1773694">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1773874"><a href="/runtime/hashmap.go.html#1773137">b</a></span>&nbsp;<span class="op" id="1773876">=</span>&nbsp;<span class="ident" id="1773878"><a href="/runtime/hashmap.go.html#1773137">b</a></span><span class="op" id="1773879">.</span><span class="ident" id="1773880">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773891">if</span>&nbsp;<span class="ident" id="1773894"><a href="/runtime/hashmap.go.html#1773137">b</a></span>&nbsp;<span class="op" id="1773896">==</span>&nbsp;<span class="ident" id="1773899">nil</span>&nbsp;<span class="op" id="1773903">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1773908">return</span>&nbsp;<span class="ident" id="1773915"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1773921">.</span><span class="ident" id="1773922">Pointer</span><span class="op" id="1773929">(</span><span class="ident" id="1773930"><a href="/runtime/hashmap.go.html#1772697">t</a></span><span class="op" id="1773931">.</span><span class="ident" id="1773932">elem</span><span class="op" id="1773936">.</span><span class="ident" id="1773937">zero</span><span class="op" id="1773941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1773948">}</span><br>
<span class="lineno"></span><span class="op" id="1773950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="1773953">func</span>&nbsp;<span class="ident" id="1773958">mapaccess2</span><span class="op" id="1773968">(</span><span class="ident" id="1773969">t</span>&nbsp;<span class="op" id="1773971">*</span><span class="ident" id="1773972"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1773979">,</span>&nbsp;<span class="ident" id="1773981">h</span>&nbsp;<span class="op" id="1773983">*</span><span class="ident" id="1773984"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1773988">,</span>&nbsp;<span class="ident" id="1773990">key</span>&nbsp;<span class="ident" id="1773994"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774000">.</span><span class="ident" id="1774001">Pointer</span><span class="op" id="1774008">)</span>&nbsp;<span class="op" id="1774010">(</span><span class="ident" id="1774011"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774017">.</span><span class="ident" id="1774018">Pointer</span><span class="op" id="1774025">,</span>&nbsp;<span class="builtintype" id="1774027">bool</span><span class="op" id="1774031">)</span>&nbsp;<span class="op" id="1774033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774036">if</span>&nbsp;<span class="ident" id="1774039"><a href="/runtime/race0.go.html#1906481">raceenabled</a></span>&nbsp;<span class="op" id="1774051">&amp;&amp;</span>&nbsp;<span class="ident" id="1774054"><a href="/runtime/hashmap.go.html#1773981">h</a></span>&nbsp;<span class="op" id="1774056">!=</span>&nbsp;<span class="ident" id="1774059">nil</span>&nbsp;<span class="op" id="1774063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774067">callerpc</span>&nbsp;<span class="op" id="1774076">:=</span>&nbsp;<span class="ident" id="1774079"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1774090">(</span><span class="ident" id="1774091"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774097">.</span><span class="ident" id="1774098">Pointer</span><span class="op" id="1774105">(</span><span class="op" id="1774106">&amp;</span><span class="ident" id="1774107"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774108">)</span><span class="op" id="1774109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774113">pc</span>&nbsp;<span class="op" id="1774116">:=</span>&nbsp;<span class="ident" id="1774119"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1774125">(</span><span class="ident" id="1774126"><a href="/runtime/hashmap.go.html#1773958">mapaccess2</a></span><span class="op" id="1774136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774140"><a href="/runtime/race0.go.html#1907159">racereadpc</a></span><span class="op" id="1774150">(</span><span class="ident" id="1774151"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774157">.</span><span class="ident" id="1774158">Pointer</span><span class="op" id="1774165">(</span><span class="ident" id="1774166"><a href="/runtime/hashmap.go.html#1773981">h</a></span><span class="op" id="1774167">)</span><span class="op" id="1774168">,</span>&nbsp;<span class="ident" id="1774170"><a href="/runtime/hashmap.go.html#1774067">callerpc</a></span><span class="op" id="1774178">,</span>&nbsp;<span class="ident" id="1774180"><a href="/runtime/hashmap.go.html#1774113">pc</a></span><span class="op" id="1774182">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774186"><a href="/runtime/race0.go.html#1906583">raceReadObjectPC</a></span><span class="op" id="1774202">(</span><span class="ident" id="1774203"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774204">.</span><span class="ident" id="1774205">key</span><span class="op" id="1774208">,</span>&nbsp;<span class="ident" id="1774210"><a href="/runtime/hashmap.go.html#1773990">key</a></span><span class="op" id="1774213">,</span>&nbsp;<span class="ident" id="1774215"><a href="/runtime/hashmap.go.html#1774067">callerpc</a></span><span class="op" id="1774223">,</span>&nbsp;<span class="ident" id="1774225"><a href="/runtime/hashmap.go.html#1774113">pc</a></span><span class="op" id="1774227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1774230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774233">if</span>&nbsp;<span class="ident" id="1774236"><a href="/runtime/hashmap.go.html#1773981">h</a></span>&nbsp;<span class="op" id="1774238">==</span>&nbsp;<span class="ident" id="1774241">nil</span>&nbsp;<span class="op" id="1774245">||</span>&nbsp;<span class="ident" id="1774248"><a href="/runtime/hashmap.go.html#1773981">h</a></span><span class="op" id="1774249">.</span><span class="ident" id="1774250">count</span>&nbsp;<span class="op" id="1774256">==</span>&nbsp;<span class="num" id="1774259">0</span>&nbsp;<span class="op" id="1774261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774265">return</span>&nbsp;<span class="ident" id="1774272"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774278">.</span><span class="ident" id="1774279">Pointer</span><span class="op" id="1774286">(</span><span class="ident" id="1774287"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774288">.</span><span class="ident" id="1774289">elem</span><span class="op" id="1774293">.</span><span class="ident" id="1774294">zero</span><span class="op" id="1774298">)</span><span class="op" id="1774299">,</span>&nbsp;<span class="ident" id="1774301">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1774308">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774311">alg</span>&nbsp;<span class="op" id="1774315">:=</span>&nbsp;<span class="ident" id="1774318"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1774323">(</span><span class="ident" id="1774324"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774325">.</span><span class="ident" id="1774326">key</span><span class="op" id="1774329">.</span><span class="ident" id="1774330">alg</span><span class="op" id="1774333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774336">hash</span>&nbsp;<span class="op" id="1774341">:=</span>&nbsp;<span class="ident" id="1774344"><a href="/runtime/hashmap.go.html#1774311">alg</a></span><span class="op" id="1774347">.</span><span class="ident" id="1774348">hash</span><span class="op" id="1774352">(</span><span class="ident" id="1774353"><a href="/runtime/hashmap.go.html#1773990">key</a></span><span class="op" id="1774356">,</span>&nbsp;<span class="builtintype" id="1774358">uintptr</span><span class="op" id="1774365">(</span><span class="ident" id="1774366"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774367">.</span><span class="ident" id="1774368">key</span><span class="op" id="1774371">.</span><span class="ident" id="1774372">size</span><span class="op" id="1774376">)</span><span class="op" id="1774377">,</span>&nbsp;<span class="builtintype" id="1774379">uintptr</span><span class="op" id="1774386">(</span><span class="ident" id="1774387"><a href="/runtime/hashmap.go.html#1773981">h</a></span><span class="op" id="1774388">.</span><span class="ident" id="1774389">hash0</span><span class="op" id="1774394">)</span><span class="op" id="1774395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774398">m</span>&nbsp;<span class="op" id="1774400">:=</span>&nbsp;<span class="builtintype" id="1774403">uintptr</span><span class="op" id="1774410">(</span><span class="num" id="1774411">1</span><span class="op" id="1774412">)</span><span class="op" id="1774413">&lt;&lt;</span><span class="ident" id="1774415"><a href="/runtime/hashmap.go.html#1773981">h</a></span><span class="op" id="1774416">.</span><span class="ident" id="1774417">B</span>&nbsp;<span class="op" id="1774419">-</span>&nbsp;<span class="num" id="1774421">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774424">b</span>&nbsp;<span class="op" id="1774426">:=</span>&nbsp;<span class="op" id="1774429">(</span><span class="op" id="1774430">*</span><span class="ident" id="1774431"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1774435">)</span><span class="op" id="1774436">(</span><span class="ident" id="1774437"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774443">.</span><span class="ident" id="1774444">Pointer</span><span class="op" id="1774451">(</span><span class="builtintype" id="1774452">uintptr</span><span class="op" id="1774459">(</span><span class="ident" id="1774460"><a href="/runtime/hashmap.go.html#1773981">h</a></span><span class="op" id="1774461">.</span><span class="ident" id="1774462">buckets</span><span class="op" id="1774469">)</span>&nbsp;<span class="op" id="1774471">+</span>&nbsp;<span class="op" id="1774473">(</span><span class="ident" id="1774474"><a href="/runtime/hashmap.go.html#1774336">hash</a></span><span class="op" id="1774478">&amp;</span><span class="ident" id="1774479"><a href="/runtime/hashmap.go.html#1774398">m</a></span><span class="op" id="1774480">)</span><span class="op" id="1774481">*</span><span class="builtintype" id="1774482">uintptr</span><span class="op" id="1774489">(</span><span class="ident" id="1774490"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774491">.</span><span class="ident" id="1774492">bucketsize</span><span class="op" id="1774502">)</span><span class="op" id="1774503">)</span><span class="op" id="1774504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774507">if</span>&nbsp;<span class="ident" id="1774510">c</span>&nbsp;<span class="op" id="1774512">:=</span>&nbsp;<span class="ident" id="1774515"><a href="/runtime/hashmap.go.html#1773981">h</a></span><span class="op" id="1774516">.</span><span class="ident" id="1774517">oldbuckets</span><span class="op" id="1774527">;</span>&nbsp;<span class="ident" id="1774529"><a href="/runtime/hashmap.go.html#1774510">c</a></span>&nbsp;<span class="op" id="1774531">!=</span>&nbsp;<span class="ident" id="1774534">nil</span>&nbsp;<span class="op" id="1774538">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774542">oldb</span>&nbsp;<span class="op" id="1774547">:=</span>&nbsp;<span class="op" id="1774550">(</span><span class="op" id="1774551">*</span><span class="ident" id="1774552"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1774556">)</span><span class="op" id="1774557">(</span><span class="ident" id="1774558"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774564">.</span><span class="ident" id="1774565">Pointer</span><span class="op" id="1774572">(</span><span class="builtintype" id="1774573">uintptr</span><span class="op" id="1774580">(</span><span class="ident" id="1774581"><a href="/runtime/hashmap.go.html#1774510">c</a></span><span class="op" id="1774582">)</span>&nbsp;<span class="op" id="1774584">+</span>&nbsp;<span class="op" id="1774586">(</span><span class="ident" id="1774587"><a href="/runtime/hashmap.go.html#1774336">hash</a></span><span class="op" id="1774591">&amp;</span><span class="op" id="1774592">(</span><span class="ident" id="1774593"><a href="/runtime/hashmap.go.html#1774398">m</a></span><span class="op" id="1774594">&gt;&gt;</span><span class="num" id="1774596">1</span><span class="op" id="1774597">)</span><span class="op" id="1774598">)</span><span class="op" id="1774599">*</span><span class="builtintype" id="1774600">uintptr</span><span class="op" id="1774607">(</span><span class="ident" id="1774608"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774609">.</span><span class="ident" id="1774610">bucketsize</span><span class="op" id="1774620">)</span><span class="op" id="1774621">)</span><span class="op" id="1774622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774626">if</span>&nbsp;<span class="op" id="1774629">!</span><span class="ident" id="1774630"><a href="/runtime/hashmap.go.html#1770046">evacuated</a></span><span class="op" id="1774639">(</span><span class="ident" id="1774640"><a href="/runtime/hashmap.go.html#1774542">oldb</a></span><span class="op" id="1774644">)</span>&nbsp;<span class="op" id="1774646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774651"><a href="/runtime/hashmap.go.html#1774424">b</a></span>&nbsp;<span class="op" id="1774653">=</span>&nbsp;<span class="ident" id="1774655"><a href="/runtime/hashmap.go.html#1774542">oldb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1774662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1774665">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774668">top</span>&nbsp;<span class="op" id="1774672">:=</span>&nbsp;<span class="builtintype" id="1774675">uint8</span><span class="op" id="1774680">(</span><span class="ident" id="1774681"><a href="/runtime/hashmap.go.html#1774336">hash</a></span>&nbsp;<span class="op" id="1774686">&gt;&gt;</span>&nbsp;<span class="op" id="1774689">(</span><span class="ident" id="1774690"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1774697">*</span><span class="num" id="1774698">8</span>&nbsp;<span class="op" id="1774700">-</span>&nbsp;<span class="num" id="1774702">8</span><span class="op" id="1774703">)</span><span class="op" id="1774704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774707">if</span>&nbsp;<span class="ident" id="1774710"><a href="/runtime/hashmap.go.html#1774668">top</a></span>&nbsp;<span class="op" id="1774714">&lt;</span>&nbsp;<span class="ident" id="1774716"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span>&nbsp;<span class="op" id="1774727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774731"><a href="/runtime/hashmap.go.html#1774668">top</a></span>&nbsp;<span class="op" id="1774735">+=</span>&nbsp;<span class="ident" id="1774738"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1774750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774753">for</span>&nbsp;<span class="op" id="1774757">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774761">for</span>&nbsp;<span class="ident" id="1774765">i</span>&nbsp;<span class="op" id="1774767">:=</span>&nbsp;<span class="builtintype" id="1774770">uintptr</span><span class="op" id="1774777">(</span><span class="num" id="1774778">0</span><span class="op" id="1774779">)</span><span class="op" id="1774780">;</span>&nbsp;<span class="ident" id="1774782"><a href="/runtime/hashmap.go.html#1774765">i</a></span>&nbsp;<span class="op" id="1774784">&lt;</span>&nbsp;<span class="ident" id="1774786"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1774795">;</span>&nbsp;<span class="ident" id="1774797"><a href="/runtime/hashmap.go.html#1774765">i</a></span><span class="op" id="1774798">++</span>&nbsp;<span class="op" id="1774801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774806">if</span>&nbsp;<span class="ident" id="1774809"><a href="/runtime/hashmap.go.html#1774424">b</a></span><span class="op" id="1774810">.</span><span class="ident" id="1774811">tophash</span><span class="op" id="1774818">[</span><span class="ident" id="1774819"><a href="/runtime/hashmap.go.html#1774765">i</a></span><span class="op" id="1774820">]</span>&nbsp;<span class="op" id="1774822">!=</span>&nbsp;<span class="ident" id="1774825"><a href="/runtime/hashmap.go.html#1774668">top</a></span>&nbsp;<span class="op" id="1774829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774835">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1774847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774852">k</span>&nbsp;<span class="op" id="1774854">:=</span>&nbsp;<span class="ident" id="1774857"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1774860">(</span><span class="ident" id="1774861"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774867">.</span><span class="ident" id="1774868">Pointer</span><span class="op" id="1774875">(</span><span class="ident" id="1774876"><a href="/runtime/hashmap.go.html#1774424">b</a></span><span class="op" id="1774877">)</span><span class="op" id="1774878">,</span>&nbsp;<span class="ident" id="1774880"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1774890">+</span><span class="ident" id="1774891"><a href="/runtime/hashmap.go.html#1774765">i</a></span><span class="op" id="1774892">*</span><span class="builtintype" id="1774893">uintptr</span><span class="op" id="1774900">(</span><span class="ident" id="1774901"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774902">.</span><span class="ident" id="1774903">keysize</span><span class="op" id="1774910">)</span><span class="op" id="1774911">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774916">if</span>&nbsp;<span class="ident" id="1774919"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1774920">.</span><span class="ident" id="1774921">indirectkey</span>&nbsp;<span class="op" id="1774933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1774939"><a href="/runtime/hashmap.go.html#1774852">k</a></span>&nbsp;<span class="op" id="1774941">=</span>&nbsp;<span class="op" id="1774943">*</span><span class="op" id="1774944">(</span><span class="op" id="1774945">(</span><span class="op" id="1774946">*</span><span class="ident" id="1774947"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1774953">.</span><span class="ident" id="1774954">Pointer</span><span class="op" id="1774961">)</span><span class="op" id="1774962">(</span><span class="ident" id="1774963"><a href="/runtime/hashmap.go.html#1774852">k</a></span><span class="op" id="1774964">)</span><span class="op" id="1774965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1774970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1774975">if</span>&nbsp;<span class="ident" id="1774978"><a href="/runtime/hashmap.go.html#1774311">alg</a></span><span class="op" id="1774981">.</span><span class="ident" id="1774982">equal</span><span class="op" id="1774987">(</span><span class="ident" id="1774988"><a href="/runtime/hashmap.go.html#1773990">key</a></span><span class="op" id="1774991">,</span>&nbsp;<span class="ident" id="1774993"><a href="/runtime/hashmap.go.html#1774852">k</a></span><span class="op" id="1774994">,</span>&nbsp;<span class="builtintype" id="1774996">uintptr</span><span class="op" id="1775003">(</span><span class="ident" id="1775004"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1775005">.</span><span class="ident" id="1775006">key</span><span class="op" id="1775009">.</span><span class="ident" id="1775010">size</span><span class="op" id="1775014">)</span><span class="op" id="1775015">)</span>&nbsp;<span class="op" id="1775017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775023">v</span>&nbsp;<span class="op" id="1775025">:=</span>&nbsp;<span class="ident" id="1775028"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1775031">(</span><span class="ident" id="1775032"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775038">.</span><span class="ident" id="1775039">Pointer</span><span class="op" id="1775046">(</span><span class="ident" id="1775047"><a href="/runtime/hashmap.go.html#1774424">b</a></span><span class="op" id="1775048">)</span><span class="op" id="1775049">,</span>&nbsp;<span class="ident" id="1775051"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1775061">+</span><span class="ident" id="1775062"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1775071">*</span><span class="builtintype" id="1775072">uintptr</span><span class="op" id="1775079">(</span><span class="ident" id="1775080"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1775081">.</span><span class="ident" id="1775082">keysize</span><span class="op" id="1775089">)</span><span class="op" id="1775090">+</span><span class="ident" id="1775091"><a href="/runtime/hashmap.go.html#1774765">i</a></span><span class="op" id="1775092">*</span><span class="builtintype" id="1775093">uintptr</span><span class="op" id="1775100">(</span><span class="ident" id="1775101"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1775102">.</span><span class="ident" id="1775103">valuesize</span><span class="op" id="1775112">)</span><span class="op" id="1775113">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775119">if</span>&nbsp;<span class="ident" id="1775122"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1775123">.</span><span class="ident" id="1775124">indirectvalue</span>&nbsp;<span class="op" id="1775138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775145"><a href="/runtime/hashmap.go.html#1775023">v</a></span>&nbsp;<span class="op" id="1775147">=</span>&nbsp;<span class="op" id="1775149">*</span><span class="op" id="1775150">(</span><span class="op" id="1775151">(</span><span class="op" id="1775152">*</span><span class="ident" id="1775153"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775159">.</span><span class="ident" id="1775160">Pointer</span><span class="op" id="1775167">)</span><span class="op" id="1775168">(</span><span class="ident" id="1775169"><a href="/runtime/hashmap.go.html#1775023">v</a></span><span class="op" id="1775170">)</span><span class="op" id="1775171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775183">return</span>&nbsp;<span class="ident" id="1775190"><a href="/runtime/hashmap.go.html#1775023">v</a></span><span class="op" id="1775191">,</span>&nbsp;<span class="ident" id="1775193">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775201">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775209"><a href="/runtime/hashmap.go.html#1774424">b</a></span>&nbsp;<span class="op" id="1775211">=</span>&nbsp;<span class="ident" id="1775213"><a href="/runtime/hashmap.go.html#1774424">b</a></span><span class="op" id="1775214">.</span><span class="ident" id="1775215">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775226">if</span>&nbsp;<span class="ident" id="1775229"><a href="/runtime/hashmap.go.html#1774424">b</a></span>&nbsp;<span class="op" id="1775231">==</span>&nbsp;<span class="ident" id="1775234">nil</span>&nbsp;<span class="op" id="1775238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775243">return</span>&nbsp;<span class="ident" id="1775250"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775256">.</span><span class="ident" id="1775257">Pointer</span><span class="op" id="1775264">(</span><span class="ident" id="1775265"><a href="/runtime/hashmap.go.html#1773969">t</a></span><span class="op" id="1775266">.</span><span class="ident" id="1775267">elem</span><span class="op" id="1775271">.</span><span class="ident" id="1775272">zero</span><span class="op" id="1775276">)</span><span class="op" id="1775277">,</span>&nbsp;<span class="ident" id="1775279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775287">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775290">}</span><br>
<span class="lineno"></span><span class="op" id="1775292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1775295">//&nbsp;returns&nbsp;both&nbsp;key&nbsp;and&nbsp;value.&nbsp;&nbsp;Used&nbsp;by&nbsp;map&nbsp;iterator</span><br>
<span class="lineno"></span><span class="keyword" id="1775348">func</span>&nbsp;<span class="ident" id="1775353">mapaccessK</span><span class="op" id="1775363">(</span><span class="ident" id="1775364">t</span>&nbsp;<span class="op" id="1775366">*</span><span class="ident" id="1775367"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1775374">,</span>&nbsp;<span class="ident" id="1775376">h</span>&nbsp;<span class="op" id="1775378">*</span><span class="ident" id="1775379"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1775383">,</span>&nbsp;<span class="ident" id="1775385">key</span>&nbsp;<span class="ident" id="1775389"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775395">.</span><span class="ident" id="1775396">Pointer</span><span class="op" id="1775403">)</span>&nbsp;<span class="op" id="1775405">(</span><span class="ident" id="1775406"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775412">.</span><span class="ident" id="1775413">Pointer</span><span class="op" id="1775420">,</span>&nbsp;<span class="ident" id="1775422"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775428">.</span><span class="ident" id="1775429">Pointer</span><span class="op" id="1775436">)</span>&nbsp;<span class="op" id="1775438">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775441">if</span>&nbsp;<span class="ident" id="1775444"><a href="/runtime/hashmap.go.html#1775376">h</a></span>&nbsp;<span class="op" id="1775446">==</span>&nbsp;<span class="ident" id="1775449">nil</span>&nbsp;<span class="op" id="1775453">||</span>&nbsp;<span class="ident" id="1775456"><a href="/runtime/hashmap.go.html#1775376">h</a></span><span class="op" id="1775457">.</span><span class="ident" id="1775458">count</span>&nbsp;<span class="op" id="1775464">==</span>&nbsp;<span class="num" id="1775467">0</span>&nbsp;<span class="op" id="1775469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775473">return</span>&nbsp;<span class="ident" id="1775480">nil</span><span class="op" id="1775483">,</span>&nbsp;<span class="ident" id="1775485">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775493">alg</span>&nbsp;<span class="op" id="1775497">:=</span>&nbsp;<span class="ident" id="1775500"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1775505">(</span><span class="ident" id="1775506"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1775507">.</span><span class="ident" id="1775508">key</span><span class="op" id="1775511">.</span><span class="ident" id="1775512">alg</span><span class="op" id="1775515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775518">hash</span>&nbsp;<span class="op" id="1775523">:=</span>&nbsp;<span class="ident" id="1775526"><a href="/runtime/hashmap.go.html#1775493">alg</a></span><span class="op" id="1775529">.</span><span class="ident" id="1775530">hash</span><span class="op" id="1775534">(</span><span class="ident" id="1775535"><a href="/runtime/hashmap.go.html#1775385">key</a></span><span class="op" id="1775538">,</span>&nbsp;<span class="builtintype" id="1775540">uintptr</span><span class="op" id="1775547">(</span><span class="ident" id="1775548"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1775549">.</span><span class="ident" id="1775550">key</span><span class="op" id="1775553">.</span><span class="ident" id="1775554">size</span><span class="op" id="1775558">)</span><span class="op" id="1775559">,</span>&nbsp;<span class="builtintype" id="1775561">uintptr</span><span class="op" id="1775568">(</span><span class="ident" id="1775569"><a href="/runtime/hashmap.go.html#1775376">h</a></span><span class="op" id="1775570">.</span><span class="ident" id="1775571">hash0</span><span class="op" id="1775576">)</span><span class="op" id="1775577">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775580">m</span>&nbsp;<span class="op" id="1775582">:=</span>&nbsp;<span class="builtintype" id="1775585">uintptr</span><span class="op" id="1775592">(</span><span class="num" id="1775593">1</span><span class="op" id="1775594">)</span><span class="op" id="1775595">&lt;&lt;</span><span class="ident" id="1775597"><a href="/runtime/hashmap.go.html#1775376">h</a></span><span class="op" id="1775598">.</span><span class="ident" id="1775599">B</span>&nbsp;<span class="op" id="1775601">-</span>&nbsp;<span class="num" id="1775603">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775606">b</span>&nbsp;<span class="op" id="1775608">:=</span>&nbsp;<span class="op" id="1775611">(</span><span class="op" id="1775612">*</span><span class="ident" id="1775613"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1775617">)</span><span class="op" id="1775618">(</span><span class="ident" id="1775619"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775625">.</span><span class="ident" id="1775626">Pointer</span><span class="op" id="1775633">(</span><span class="builtintype" id="1775634">uintptr</span><span class="op" id="1775641">(</span><span class="ident" id="1775642"><a href="/runtime/hashmap.go.html#1775376">h</a></span><span class="op" id="1775643">.</span><span class="ident" id="1775644">buckets</span><span class="op" id="1775651">)</span>&nbsp;<span class="op" id="1775653">+</span>&nbsp;<span class="op" id="1775655">(</span><span class="ident" id="1775656"><a href="/runtime/hashmap.go.html#1775518">hash</a></span><span class="op" id="1775660">&amp;</span><span class="ident" id="1775661"><a href="/runtime/hashmap.go.html#1775580">m</a></span><span class="op" id="1775662">)</span><span class="op" id="1775663">*</span><span class="builtintype" id="1775664">uintptr</span><span class="op" id="1775671">(</span><span class="ident" id="1775672"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1775673">.</span><span class="ident" id="1775674">bucketsize</span><span class="op" id="1775684">)</span><span class="op" id="1775685">)</span><span class="op" id="1775686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775689">if</span>&nbsp;<span class="ident" id="1775692">c</span>&nbsp;<span class="op" id="1775694">:=</span>&nbsp;<span class="ident" id="1775697"><a href="/runtime/hashmap.go.html#1775376">h</a></span><span class="op" id="1775698">.</span><span class="ident" id="1775699">oldbuckets</span><span class="op" id="1775709">;</span>&nbsp;<span class="ident" id="1775711"><a href="/runtime/hashmap.go.html#1775692">c</a></span>&nbsp;<span class="op" id="1775713">!=</span>&nbsp;<span class="ident" id="1775716">nil</span>&nbsp;<span class="op" id="1775720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775724">oldb</span>&nbsp;<span class="op" id="1775729">:=</span>&nbsp;<span class="op" id="1775732">(</span><span class="op" id="1775733">*</span><span class="ident" id="1775734"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1775738">)</span><span class="op" id="1775739">(</span><span class="ident" id="1775740"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1775746">.</span><span class="ident" id="1775747">Pointer</span><span class="op" id="1775754">(</span><span class="builtintype" id="1775755">uintptr</span><span class="op" id="1775762">(</span><span class="ident" id="1775763"><a href="/runtime/hashmap.go.html#1775692">c</a></span><span class="op" id="1775764">)</span>&nbsp;<span class="op" id="1775766">+</span>&nbsp;<span class="op" id="1775768">(</span><span class="ident" id="1775769"><a href="/runtime/hashmap.go.html#1775518">hash</a></span><span class="op" id="1775773">&amp;</span><span class="op" id="1775774">(</span><span class="ident" id="1775775"><a href="/runtime/hashmap.go.html#1775580">m</a></span><span class="op" id="1775776">&gt;&gt;</span><span class="num" id="1775778">1</span><span class="op" id="1775779">)</span><span class="op" id="1775780">)</span><span class="op" id="1775781">*</span><span class="builtintype" id="1775782">uintptr</span><span class="op" id="1775789">(</span><span class="ident" id="1775790"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1775791">.</span><span class="ident" id="1775792">bucketsize</span><span class="op" id="1775802">)</span><span class="op" id="1775803">)</span><span class="op" id="1775804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775808">if</span>&nbsp;<span class="op" id="1775811">!</span><span class="ident" id="1775812"><a href="/runtime/hashmap.go.html#1770046">evacuated</a></span><span class="op" id="1775821">(</span><span class="ident" id="1775822"><a href="/runtime/hashmap.go.html#1775724">oldb</a></span><span class="op" id="1775826">)</span>&nbsp;<span class="op" id="1775828">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775833"><a href="/runtime/hashmap.go.html#1775606">b</a></span>&nbsp;<span class="op" id="1775835">=</span>&nbsp;<span class="ident" id="1775837"><a href="/runtime/hashmap.go.html#1775724">oldb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775850">top</span>&nbsp;<span class="op" id="1775854">:=</span>&nbsp;<span class="builtintype" id="1775857">uint8</span><span class="op" id="1775862">(</span><span class="ident" id="1775863"><a href="/runtime/hashmap.go.html#1775518">hash</a></span>&nbsp;<span class="op" id="1775868">&gt;&gt;</span>&nbsp;<span class="op" id="1775871">(</span><span class="ident" id="1775872"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1775879">*</span><span class="num" id="1775880">8</span>&nbsp;<span class="op" id="1775882">-</span>&nbsp;<span class="num" id="1775884">8</span><span class="op" id="1775885">)</span><span class="op" id="1775886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775889">if</span>&nbsp;<span class="ident" id="1775892"><a href="/runtime/hashmap.go.html#1775850">top</a></span>&nbsp;<span class="op" id="1775896">&lt;</span>&nbsp;<span class="ident" id="1775898"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span>&nbsp;<span class="op" id="1775909">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1775913"><a href="/runtime/hashmap.go.html#1775850">top</a></span>&nbsp;<span class="op" id="1775917">+=</span>&nbsp;<span class="ident" id="1775920"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1775932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775935">for</span>&nbsp;<span class="op" id="1775939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775943">for</span>&nbsp;<span class="ident" id="1775947">i</span>&nbsp;<span class="op" id="1775949">:=</span>&nbsp;<span class="builtintype" id="1775952">uintptr</span><span class="op" id="1775959">(</span><span class="num" id="1775960">0</span><span class="op" id="1775961">)</span><span class="op" id="1775962">;</span>&nbsp;<span class="ident" id="1775964"><a href="/runtime/hashmap.go.html#1775947">i</a></span>&nbsp;<span class="op" id="1775966">&lt;</span>&nbsp;<span class="ident" id="1775968"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1775977">;</span>&nbsp;<span class="ident" id="1775979"><a href="/runtime/hashmap.go.html#1775947">i</a></span><span class="op" id="1775980">++</span>&nbsp;<span class="op" id="1775983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1775988">if</span>&nbsp;<span class="ident" id="1775991"><a href="/runtime/hashmap.go.html#1775606">b</a></span><span class="op" id="1775992">.</span><span class="ident" id="1775993">tophash</span><span class="op" id="1776000">[</span><span class="ident" id="1776001"><a href="/runtime/hashmap.go.html#1775947">i</a></span><span class="op" id="1776002">]</span>&nbsp;<span class="op" id="1776004">!=</span>&nbsp;<span class="ident" id="1776007"><a href="/runtime/hashmap.go.html#1775850">top</a></span>&nbsp;<span class="op" id="1776011">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776017">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776034">k</span>&nbsp;<span class="op" id="1776036">:=</span>&nbsp;<span class="ident" id="1776039"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1776042">(</span><span class="ident" id="1776043"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776049">.</span><span class="ident" id="1776050">Pointer</span><span class="op" id="1776057">(</span><span class="ident" id="1776058"><a href="/runtime/hashmap.go.html#1775606">b</a></span><span class="op" id="1776059">)</span><span class="op" id="1776060">,</span>&nbsp;<span class="ident" id="1776062"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1776072">+</span><span class="ident" id="1776073"><a href="/runtime/hashmap.go.html#1775947">i</a></span><span class="op" id="1776074">*</span><span class="builtintype" id="1776075">uintptr</span><span class="op" id="1776082">(</span><span class="ident" id="1776083"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1776084">.</span><span class="ident" id="1776085">keysize</span><span class="op" id="1776092">)</span><span class="op" id="1776093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776098">if</span>&nbsp;<span class="ident" id="1776101"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1776102">.</span><span class="ident" id="1776103">indirectkey</span>&nbsp;<span class="op" id="1776115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776121"><a href="/runtime/hashmap.go.html#1776034">k</a></span>&nbsp;<span class="op" id="1776123">=</span>&nbsp;<span class="op" id="1776125">*</span><span class="op" id="1776126">(</span><span class="op" id="1776127">(</span><span class="op" id="1776128">*</span><span class="ident" id="1776129"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776135">.</span><span class="ident" id="1776136">Pointer</span><span class="op" id="1776143">)</span><span class="op" id="1776144">(</span><span class="ident" id="1776145"><a href="/runtime/hashmap.go.html#1776034">k</a></span><span class="op" id="1776146">)</span><span class="op" id="1776147">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776157">if</span>&nbsp;<span class="ident" id="1776160"><a href="/runtime/hashmap.go.html#1775493">alg</a></span><span class="op" id="1776163">.</span><span class="ident" id="1776164">equal</span><span class="op" id="1776169">(</span><span class="ident" id="1776170"><a href="/runtime/hashmap.go.html#1775385">key</a></span><span class="op" id="1776173">,</span>&nbsp;<span class="ident" id="1776175"><a href="/runtime/hashmap.go.html#1776034">k</a></span><span class="op" id="1776176">,</span>&nbsp;<span class="builtintype" id="1776178">uintptr</span><span class="op" id="1776185">(</span><span class="ident" id="1776186"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1776187">.</span><span class="ident" id="1776188">key</span><span class="op" id="1776191">.</span><span class="ident" id="1776192">size</span><span class="op" id="1776196">)</span><span class="op" id="1776197">)</span>&nbsp;<span class="op" id="1776199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776205">v</span>&nbsp;<span class="op" id="1776207">:=</span>&nbsp;<span class="ident" id="1776210"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1776213">(</span><span class="ident" id="1776214"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776220">.</span><span class="ident" id="1776221">Pointer</span><span class="op" id="1776228">(</span><span class="ident" id="1776229"><a href="/runtime/hashmap.go.html#1775606">b</a></span><span class="op" id="1776230">)</span><span class="op" id="1776231">,</span>&nbsp;<span class="ident" id="1776233"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1776243">+</span><span class="ident" id="1776244"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1776253">*</span><span class="builtintype" id="1776254">uintptr</span><span class="op" id="1776261">(</span><span class="ident" id="1776262"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1776263">.</span><span class="ident" id="1776264">keysize</span><span class="op" id="1776271">)</span><span class="op" id="1776272">+</span><span class="ident" id="1776273"><a href="/runtime/hashmap.go.html#1775947">i</a></span><span class="op" id="1776274">*</span><span class="builtintype" id="1776275">uintptr</span><span class="op" id="1776282">(</span><span class="ident" id="1776283"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1776284">.</span><span class="ident" id="1776285">valuesize</span><span class="op" id="1776294">)</span><span class="op" id="1776295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776301">if</span>&nbsp;<span class="ident" id="1776304"><a href="/runtime/hashmap.go.html#1775364">t</a></span><span class="op" id="1776305">.</span><span class="ident" id="1776306">indirectvalue</span>&nbsp;<span class="op" id="1776320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776327"><a href="/runtime/hashmap.go.html#1776205">v</a></span>&nbsp;<span class="op" id="1776329">=</span>&nbsp;<span class="op" id="1776331">*</span><span class="op" id="1776332">(</span><span class="op" id="1776333">(</span><span class="op" id="1776334">*</span><span class="ident" id="1776335"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776341">.</span><span class="ident" id="1776342">Pointer</span><span class="op" id="1776349">)</span><span class="op" id="1776350">(</span><span class="ident" id="1776351"><a href="/runtime/hashmap.go.html#1776205">v</a></span><span class="op" id="1776352">)</span><span class="op" id="1776353">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776365">return</span>&nbsp;<span class="ident" id="1776372"><a href="/runtime/hashmap.go.html#1776034">k</a></span><span class="op" id="1776373">,</span>&nbsp;<span class="ident" id="1776375"><a href="/runtime/hashmap.go.html#1776205">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776388"><a href="/runtime/hashmap.go.html#1775606">b</a></span>&nbsp;<span class="op" id="1776390">=</span>&nbsp;<span class="ident" id="1776392"><a href="/runtime/hashmap.go.html#1775606">b</a></span><span class="op" id="1776393">.</span><span class="ident" id="1776394">overflow</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776405">if</span>&nbsp;<span class="ident" id="1776408"><a href="/runtime/hashmap.go.html#1775606">b</a></span>&nbsp;<span class="op" id="1776410">==</span>&nbsp;<span class="ident" id="1776413">nil</span>&nbsp;<span class="op" id="1776417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776422">return</span>&nbsp;<span class="ident" id="1776429">nil</span><span class="op" id="1776432">,</span>&nbsp;<span class="ident" id="1776434">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776443">}</span><br>
<span class="lineno"></span><span class="op" id="1776445">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="1776448">func</span>&nbsp;<span class="ident" id="1776453">mapassign1</span><span class="op" id="1776463">(</span><span class="ident" id="1776464">t</span>&nbsp;<span class="op" id="1776466">*</span><span class="ident" id="1776467"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1776474">,</span>&nbsp;<span class="ident" id="1776476">h</span>&nbsp;<span class="op" id="1776478">*</span><span class="ident" id="1776479"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1776483">,</span>&nbsp;<span class="ident" id="1776485">key</span>&nbsp;<span class="ident" id="1776489"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776495">.</span><span class="ident" id="1776496">Pointer</span><span class="op" id="1776503">,</span>&nbsp;<span class="ident" id="1776505">val</span>&nbsp;<span class="ident" id="1776509"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776515">.</span><span class="ident" id="1776516">Pointer</span><span class="op" id="1776523">)</span>&nbsp;<span class="op" id="1776525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776528">if</span>&nbsp;<span class="ident" id="1776531"><a href="/runtime/hashmap.go.html#1776476">h</a></span>&nbsp;<span class="op" id="1776533">==</span>&nbsp;<span class="ident" id="1776536">nil</span>&nbsp;<span class="op" id="1776540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1776544">panic</span><span class="op" id="1776549">(</span><span class="string" id="1776550">&#34;assignment&nbsp;to&nbsp;entry&nbsp;in&nbsp;nil&nbsp;map&#34;</span><span class="op" id="1776582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776585">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776588">if</span>&nbsp;<span class="ident" id="1776591"><a href="/runtime/race0.go.html#1906481">raceenabled</a></span>&nbsp;<span class="op" id="1776603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776607">callerpc</span>&nbsp;<span class="op" id="1776616">:=</span>&nbsp;<span class="ident" id="1776619"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1776630">(</span><span class="ident" id="1776631"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776637">.</span><span class="ident" id="1776638">Pointer</span><span class="op" id="1776645">(</span><span class="op" id="1776646">&amp;</span><span class="ident" id="1776647"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1776648">)</span><span class="op" id="1776649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776653">pc</span>&nbsp;<span class="op" id="1776656">:=</span>&nbsp;<span class="ident" id="1776659"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1776665">(</span><span class="ident" id="1776666"><a href="/runtime/hashmap.go.html#1776453">mapassign1</a></span><span class="op" id="1776676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776680"><a href="/runtime/race0.go.html#1907063">racewritepc</a></span><span class="op" id="1776691">(</span><span class="ident" id="1776692"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1776698">.</span><span class="ident" id="1776699">Pointer</span><span class="op" id="1776706">(</span><span class="ident" id="1776707"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1776708">)</span><span class="op" id="1776709">,</span>&nbsp;<span class="ident" id="1776711"><a href="/runtime/hashmap.go.html#1776607">callerpc</a></span><span class="op" id="1776719">,</span>&nbsp;<span class="ident" id="1776721"><a href="/runtime/hashmap.go.html#1776653">pc</a></span><span class="op" id="1776723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776727"><a href="/runtime/race0.go.html#1906583">raceReadObjectPC</a></span><span class="op" id="1776743">(</span><span class="ident" id="1776744"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1776745">.</span><span class="ident" id="1776746">key</span><span class="op" id="1776749">,</span>&nbsp;<span class="ident" id="1776751"><a href="/runtime/hashmap.go.html#1776485">key</a></span><span class="op" id="1776754">,</span>&nbsp;<span class="ident" id="1776756"><a href="/runtime/hashmap.go.html#1776607">callerpc</a></span><span class="op" id="1776764">,</span>&nbsp;<span class="ident" id="1776766"><a href="/runtime/hashmap.go.html#1776653">pc</a></span><span class="op" id="1776768">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776772"><a href="/runtime/race0.go.html#1906583">raceReadObjectPC</a></span><span class="op" id="1776788">(</span><span class="ident" id="1776789"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1776790">.</span><span class="ident" id="1776791">elem</span><span class="op" id="1776795">,</span>&nbsp;<span class="ident" id="1776797"><a href="/runtime/hashmap.go.html#1776505">val</a></span><span class="op" id="1776800">,</span>&nbsp;<span class="ident" id="1776802"><a href="/runtime/hashmap.go.html#1776607">callerpc</a></span><span class="op" id="1776810">,</span>&nbsp;<span class="ident" id="1776812"><a href="/runtime/hashmap.go.html#1776653">pc</a></span><span class="op" id="1776814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776821">alg</span>&nbsp;<span class="op" id="1776825">:=</span>&nbsp;<span class="ident" id="1776828"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1776833">(</span><span class="ident" id="1776834"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1776835">.</span><span class="ident" id="1776836">key</span><span class="op" id="1776839">.</span><span class="ident" id="1776840">alg</span><span class="op" id="1776843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776846">hash</span>&nbsp;<span class="op" id="1776851">:=</span>&nbsp;<span class="ident" id="1776854"><a href="/runtime/hashmap.go.html#1776821">alg</a></span><span class="op" id="1776857">.</span><span class="ident" id="1776858">hash</span><span class="op" id="1776862">(</span><span class="ident" id="1776863"><a href="/runtime/hashmap.go.html#1776485">key</a></span><span class="op" id="1776866">,</span>&nbsp;<span class="builtintype" id="1776868">uintptr</span><span class="op" id="1776875">(</span><span class="ident" id="1776876"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1776877">.</span><span class="ident" id="1776878">key</span><span class="op" id="1776881">.</span><span class="ident" id="1776882">size</span><span class="op" id="1776886">)</span><span class="op" id="1776887">,</span>&nbsp;<span class="builtintype" id="1776889">uintptr</span><span class="op" id="1776896">(</span><span class="ident" id="1776897"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1776898">.</span><span class="ident" id="1776899">hash0</span><span class="op" id="1776904">)</span><span class="op" id="1776905">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776909">if</span>&nbsp;<span class="ident" id="1776912"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1776913">.</span><span class="ident" id="1776914">buckets</span>&nbsp;<span class="op" id="1776922">==</span>&nbsp;<span class="ident" id="1776925">nil</span>&nbsp;<span class="op" id="1776929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1776933">if</span>&nbsp;<span class="ident" id="1776936"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1776944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776949"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1776957">.</span><span class="ident" id="1776958">next_gc</span>&nbsp;<span class="op" id="1776966">=</span>&nbsp;<span class="ident" id="1776968"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1776976">.</span><span class="ident" id="1776977">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1776990">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1776994"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1776995">.</span><span class="ident" id="1776996">buckets</span>&nbsp;<span class="op" id="1777004">=</span>&nbsp;<span class="ident" id="1777006"><a href="/runtime/malloc.go.html#1828735">newarray</a></span><span class="op" id="1777014">(</span><span class="ident" id="1777015"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777016">.</span><span class="ident" id="1777017">bucket</span><span class="op" id="1777023">,</span>&nbsp;<span class="num" id="1777025">1</span><span class="op" id="1777026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1777029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1777032">again</span><span class="op" id="1777037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777040">bucket</span>&nbsp;<span class="op" id="1777047">:=</span>&nbsp;<span class="ident" id="1777050"><a href="/runtime/hashmap.go.html#1776846">hash</a></span>&nbsp;<span class="op" id="1777055">&amp;</span>&nbsp;<span class="op" id="1777057">(</span><span class="builtintype" id="1777058">uintptr</span><span class="op" id="1777065">(</span><span class="num" id="1777066">1</span><span class="op" id="1777067">)</span><span class="op" id="1777068">&lt;&lt;</span><span class="ident" id="1777070"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1777071">.</span><span class="ident" id="1777072">B</span>&nbsp;<span class="op" id="1777074">-</span>&nbsp;<span class="num" id="1777076">1</span><span class="op" id="1777077">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777080">if</span>&nbsp;<span class="ident" id="1777083"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1777084">.</span><span class="ident" id="1777085">oldbuckets</span>&nbsp;<span class="op" id="1777096">!=</span>&nbsp;<span class="ident" id="1777099">nil</span>&nbsp;<span class="op" id="1777103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777107"><a href="/runtime/hashmap.go.html#1786704">growWork</a></span><span class="op" id="1777115">(</span><span class="ident" id="1777116"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777117">,</span>&nbsp;<span class="ident" id="1777119"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1777120">,</span>&nbsp;<span class="ident" id="1777122"><a href="/runtime/hashmap.go.html#1777040">bucket</a></span><span class="op" id="1777128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1777131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777134">b</span>&nbsp;<span class="op" id="1777136">:=</span>&nbsp;<span class="op" id="1777139">(</span><span class="op" id="1777140">*</span><span class="ident" id="1777141"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1777145">)</span><span class="op" id="1777146">(</span><span class="ident" id="1777147"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1777153">.</span><span class="ident" id="1777154">Pointer</span><span class="op" id="1777161">(</span><span class="builtintype" id="1777162">uintptr</span><span class="op" id="1777169">(</span><span class="ident" id="1777170"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1777171">.</span><span class="ident" id="1777172">buckets</span><span class="op" id="1777179">)</span>&nbsp;<span class="op" id="1777181">+</span>&nbsp;<span class="ident" id="1777183"><a href="/runtime/hashmap.go.html#1777040">bucket</a></span><span class="op" id="1777189">*</span><span class="builtintype" id="1777190">uintptr</span><span class="op" id="1777197">(</span><span class="ident" id="1777198"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777199">.</span><span class="ident" id="1777200">bucketsize</span><span class="op" id="1777210">)</span><span class="op" id="1777211">)</span><span class="op" id="1777212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777215">top</span>&nbsp;<span class="op" id="1777219">:=</span>&nbsp;<span class="builtintype" id="1777222">uint8</span><span class="op" id="1777227">(</span><span class="ident" id="1777228"><a href="/runtime/hashmap.go.html#1776846">hash</a></span>&nbsp;<span class="op" id="1777233">&gt;&gt;</span>&nbsp;<span class="op" id="1777236">(</span><span class="ident" id="1777237"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1777244">*</span><span class="num" id="1777245">8</span>&nbsp;<span class="op" id="1777247">-</span>&nbsp;<span class="num" id="1777249">8</span><span class="op" id="1777250">)</span><span class="op" id="1777251">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777254">if</span>&nbsp;<span class="ident" id="1777257"><a href="/runtime/hashmap.go.html#1777215">top</a></span>&nbsp;<span class="op" id="1777261">&lt;</span>&nbsp;<span class="ident" id="1777263"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span>&nbsp;<span class="op" id="1777274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777278"><a href="/runtime/hashmap.go.html#1777215">top</a></span>&nbsp;<span class="op" id="1777282">+=</span>&nbsp;<span class="ident" id="1777285"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1777297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777301">var</span>&nbsp;<span class="ident" id="1777305">inserti</span>&nbsp;<span class="op" id="1777313">*</span><span class="builtintype" id="1777314">uint8</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777321">var</span>&nbsp;<span class="ident" id="1777325">insertk</span>&nbsp;<span class="ident" id="1777333"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1777339">.</span><span class="ident" id="1777340">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777349">var</span>&nbsp;<span class="ident" id="1777353">insertv</span>&nbsp;<span class="ident" id="1777361"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1777367">.</span><span class="ident" id="1777368">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777377">for</span>&nbsp;<span class="op" id="1777381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777385">for</span>&nbsp;<span class="ident" id="1777389">i</span>&nbsp;<span class="op" id="1777391">:=</span>&nbsp;<span class="builtintype" id="1777394">uintptr</span><span class="op" id="1777401">(</span><span class="num" id="1777402">0</span><span class="op" id="1777403">)</span><span class="op" id="1777404">;</span>&nbsp;<span class="ident" id="1777406"><a href="/runtime/hashmap.go.html#1777389">i</a></span>&nbsp;<span class="op" id="1777408">&lt;</span>&nbsp;<span class="ident" id="1777410"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1777419">;</span>&nbsp;<span class="ident" id="1777421"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1777422">++</span>&nbsp;<span class="op" id="1777425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777430">if</span>&nbsp;<span class="ident" id="1777433"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1777434">.</span><span class="ident" id="1777435">tophash</span><span class="op" id="1777442">[</span><span class="ident" id="1777443"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1777444">]</span>&nbsp;<span class="op" id="1777446">!=</span>&nbsp;<span class="ident" id="1777449"><a href="/runtime/hashmap.go.html#1777215">top</a></span>&nbsp;<span class="op" id="1777453">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777459">if</span>&nbsp;<span class="ident" id="1777462"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1777463">.</span><span class="ident" id="1777464">tophash</span><span class="op" id="1777471">[</span><span class="ident" id="1777472"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1777473">]</span>&nbsp;<span class="op" id="1777475">==</span>&nbsp;<span class="ident" id="1777478"><a href="/runtime/hashmap.go.html#1767447">empty</a></span>&nbsp;<span class="op" id="1777484">&amp;&amp;</span>&nbsp;<span class="ident" id="1777487"><a href="/runtime/hashmap.go.html#1777305">inserti</a></span>&nbsp;<span class="op" id="1777495">==</span>&nbsp;<span class="ident" id="1777498">nil</span>&nbsp;<span class="op" id="1777502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777509"><a href="/runtime/hashmap.go.html#1777305">inserti</a></span>&nbsp;<span class="op" id="1777517">=</span>&nbsp;<span class="op" id="1777519">&amp;</span><span class="ident" id="1777520"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1777521">.</span><span class="ident" id="1777522">tophash</span><span class="op" id="1777529">[</span><span class="ident" id="1777530"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1777531">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777538"><a href="/runtime/hashmap.go.html#1777325">insertk</a></span>&nbsp;<span class="op" id="1777546">=</span>&nbsp;<span class="ident" id="1777548"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1777551">(</span><span class="ident" id="1777552"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1777558">.</span><span class="ident" id="1777559">Pointer</span><span class="op" id="1777566">(</span><span class="ident" id="1777567"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1777568">)</span><span class="op" id="1777569">,</span>&nbsp;<span class="ident" id="1777571"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1777581">+</span><span class="ident" id="1777582"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1777583">*</span><span class="builtintype" id="1777584">uintptr</span><span class="op" id="1777591">(</span><span class="ident" id="1777592"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777593">.</span><span class="ident" id="1777594">keysize</span><span class="op" id="1777601">)</span><span class="op" id="1777602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777609"><a href="/runtime/hashmap.go.html#1777353">insertv</a></span>&nbsp;<span class="op" id="1777617">=</span>&nbsp;<span class="ident" id="1777619"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1777622">(</span><span class="ident" id="1777623"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1777629">.</span><span class="ident" id="1777630">Pointer</span><span class="op" id="1777637">(</span><span class="ident" id="1777638"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1777639">)</span><span class="op" id="1777640">,</span>&nbsp;<span class="ident" id="1777642"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1777652">+</span><span class="ident" id="1777653"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1777662">*</span><span class="builtintype" id="1777663">uintptr</span><span class="op" id="1777670">(</span><span class="ident" id="1777671"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777672">.</span><span class="ident" id="1777673">keysize</span><span class="op" id="1777680">)</span><span class="op" id="1777681">+</span><span class="ident" id="1777682"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1777683">*</span><span class="builtintype" id="1777684">uintptr</span><span class="op" id="1777691">(</span><span class="ident" id="1777692"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777693">.</span><span class="ident" id="1777694">valuesize</span><span class="op" id="1777703">)</span><span class="op" id="1777704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1777710">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777716">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1777728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777733">k</span>&nbsp;<span class="op" id="1777735">:=</span>&nbsp;<span class="ident" id="1777738"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1777741">(</span><span class="ident" id="1777742"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1777748">.</span><span class="ident" id="1777749">Pointer</span><span class="op" id="1777756">(</span><span class="ident" id="1777757"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1777758">)</span><span class="op" id="1777759">,</span>&nbsp;<span class="ident" id="1777761"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1777771">+</span><span class="ident" id="1777772"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1777773">*</span><span class="builtintype" id="1777774">uintptr</span><span class="op" id="1777781">(</span><span class="ident" id="1777782"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777783">.</span><span class="ident" id="1777784">keysize</span><span class="op" id="1777791">)</span><span class="op" id="1777792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777797">k2</span>&nbsp;<span class="op" id="1777800">:=</span>&nbsp;<span class="ident" id="1777803"><a href="/runtime/hashmap.go.html#1777733">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777808">if</span>&nbsp;<span class="ident" id="1777811"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777812">.</span><span class="ident" id="1777813">indirectkey</span>&nbsp;<span class="op" id="1777825">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777831"><a href="/runtime/hashmap.go.html#1777797">k2</a></span>&nbsp;<span class="op" id="1777834">=</span>&nbsp;<span class="op" id="1777836">*</span><span class="op" id="1777837">(</span><span class="op" id="1777838">(</span><span class="op" id="1777839">*</span><span class="ident" id="1777840"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1777846">.</span><span class="ident" id="1777847">Pointer</span><span class="op" id="1777854">)</span><span class="op" id="1777855">(</span><span class="ident" id="1777856"><a href="/runtime/hashmap.go.html#1777797">k2</a></span><span class="op" id="1777858">)</span><span class="op" id="1777859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1777864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777869">if</span>&nbsp;<span class="op" id="1777872">!</span><span class="ident" id="1777873"><a href="/runtime/hashmap.go.html#1776821">alg</a></span><span class="op" id="1777876">.</span><span class="ident" id="1777877">equal</span><span class="op" id="1777882">(</span><span class="ident" id="1777883"><a href="/runtime/hashmap.go.html#1776485">key</a></span><span class="op" id="1777886">,</span>&nbsp;<span class="ident" id="1777888"><a href="/runtime/hashmap.go.html#1777797">k2</a></span><span class="op" id="1777890">,</span>&nbsp;<span class="builtintype" id="1777892">uintptr</span><span class="op" id="1777899">(</span><span class="ident" id="1777900"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1777901">.</span><span class="ident" id="1777902">key</span><span class="op" id="1777905">.</span><span class="ident" id="1777906">size</span><span class="op" id="1777910">)</span><span class="op" id="1777911">)</span>&nbsp;<span class="op" id="1777913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1777919">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1777931">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1777936">//&nbsp;already&nbsp;have&nbsp;a&nbsp;mapping&nbsp;for&nbsp;key.&nbsp;&nbsp;Update&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777986"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1777993">(</span><span class="ident" id="1777994"><a href="/runtime/hashmap.go.html#1777797">k2</a></span><span class="op" id="1777996">,</span>&nbsp;<span class="ident" id="1777998"><a href="/runtime/hashmap.go.html#1776485">key</a></span><span class="op" id="1778001">,</span>&nbsp;<span class="builtintype" id="1778003">uintptr</span><span class="op" id="1778010">(</span><span class="ident" id="1778011"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778012">.</span><span class="ident" id="1778013">key</span><span class="op" id="1778016">.</span><span class="ident" id="1778017">size</span><span class="op" id="1778021">)</span><span class="op" id="1778022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778027">v</span>&nbsp;<span class="op" id="1778029">:=</span>&nbsp;<span class="ident" id="1778032"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1778035">(</span><span class="ident" id="1778036"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1778042">.</span><span class="ident" id="1778043">Pointer</span><span class="op" id="1778050">(</span><span class="ident" id="1778051"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1778052">)</span><span class="op" id="1778053">,</span>&nbsp;<span class="ident" id="1778055"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1778065">+</span><span class="ident" id="1778066"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1778075">*</span><span class="builtintype" id="1778076">uintptr</span><span class="op" id="1778083">(</span><span class="ident" id="1778084"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778085">.</span><span class="ident" id="1778086">keysize</span><span class="op" id="1778093">)</span><span class="op" id="1778094">+</span><span class="ident" id="1778095"><a href="/runtime/hashmap.go.html#1777389">i</a></span><span class="op" id="1778096">*</span><span class="builtintype" id="1778097">uintptr</span><span class="op" id="1778104">(</span><span class="ident" id="1778105"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778106">.</span><span class="ident" id="1778107">valuesize</span><span class="op" id="1778116">)</span><span class="op" id="1778117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778122">v2</span>&nbsp;<span class="op" id="1778125">:=</span>&nbsp;<span class="ident" id="1778128"><a href="/runtime/hashmap.go.html#1778027">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778133">if</span>&nbsp;<span class="ident" id="1778136"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778137">.</span><span class="ident" id="1778138">indirectvalue</span>&nbsp;<span class="op" id="1778152">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778158"><a href="/runtime/hashmap.go.html#1778122">v2</a></span>&nbsp;<span class="op" id="1778161">=</span>&nbsp;<span class="op" id="1778163">*</span><span class="op" id="1778164">(</span><span class="op" id="1778165">(</span><span class="op" id="1778166">*</span><span class="ident" id="1778167"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1778173">.</span><span class="ident" id="1778174">Pointer</span><span class="op" id="1778181">)</span><span class="op" id="1778182">(</span><span class="ident" id="1778183"><a href="/runtime/hashmap.go.html#1778122">v2</a></span><span class="op" id="1778185">)</span><span class="op" id="1778186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1778191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778196"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1778203">(</span><span class="ident" id="1778204"><a href="/runtime/hashmap.go.html#1778122">v2</a></span><span class="op" id="1778206">,</span>&nbsp;<span class="ident" id="1778208"><a href="/runtime/hashmap.go.html#1776505">val</a></span><span class="op" id="1778211">,</span>&nbsp;<span class="builtintype" id="1778213">uintptr</span><span class="op" id="1778220">(</span><span class="ident" id="1778221"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778222">.</span><span class="ident" id="1778223">elem</span><span class="op" id="1778227">.</span><span class="ident" id="1778228">size</span><span class="op" id="1778232">)</span><span class="op" id="1778233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778238">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1778247">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778251">if</span>&nbsp;<span class="ident" id="1778254"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1778255">.</span><span class="ident" id="1778256">overflow</span>&nbsp;<span class="op" id="1778265">==</span>&nbsp;<span class="ident" id="1778268">nil</span>&nbsp;<span class="op" id="1778272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778277">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1778285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778289"><a href="/runtime/hashmap.go.html#1777134">b</a></span>&nbsp;<span class="op" id="1778291">=</span>&nbsp;<span class="ident" id="1778293"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1778294">.</span><span class="ident" id="1778295">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1778305">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1778309">//&nbsp;did&nbsp;not&nbsp;find&nbsp;mapping&nbsp;for&nbsp;key.&nbsp;&nbsp;Allocate&nbsp;new&nbsp;cell&nbsp;&amp;&nbsp;add&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778375">if</span>&nbsp;<span class="builtintype" id="1778378">float32</span><span class="op" id="1778385">(</span><span class="ident" id="1778386"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1778387">.</span><span class="ident" id="1778388">count</span><span class="op" id="1778393">)</span>&nbsp;<span class="op" id="1778395">&gt;=</span>&nbsp;<span class="ident" id="1778398"><a href="/runtime/hashmap.go.html#1766558">loadFactor</a></span><span class="op" id="1778408">*</span><span class="builtintype" id="1778409">float32</span><span class="op" id="1778416">(</span><span class="op" id="1778417">(</span><span class="builtintype" id="1778418">uintptr</span><span class="op" id="1778425">(</span><span class="num" id="1778426">1</span><span class="op" id="1778427">)</span><span class="op" id="1778428">&lt;&lt;</span><span class="ident" id="1778430"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1778431">.</span><span class="ident" id="1778432">B</span><span class="op" id="1778433">)</span><span class="op" id="1778434">)</span>&nbsp;<span class="op" id="1778436">&amp;&amp;</span>&nbsp;<span class="ident" id="1778439"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1778440">.</span><span class="ident" id="1778441">count</span>&nbsp;<span class="op" id="1778447">&gt;=</span>&nbsp;<span class="ident" id="1778450"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1778460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778464"><a href="/runtime/hashmap.go.html#1786125">hashGrow</a></span><span class="op" id="1778472">(</span><span class="ident" id="1778473"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778474">,</span>&nbsp;<span class="ident" id="1778476"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1778477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778481">goto</span>&nbsp;<span class="ident" id="1778486">again</span>&nbsp;<span class="comment" id="1778492">//&nbsp;Growing&nbsp;the&nbsp;table&nbsp;invalidates&nbsp;everything,&nbsp;so&nbsp;try&nbsp;again</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1778551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778555">if</span>&nbsp;<span class="ident" id="1778558"><a href="/runtime/hashmap.go.html#1777305">inserti</a></span>&nbsp;<span class="op" id="1778566">==</span>&nbsp;<span class="ident" id="1778569">nil</span>&nbsp;<span class="op" id="1778573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1778577">//&nbsp;all&nbsp;current&nbsp;buckets&nbsp;are&nbsp;full,&nbsp;allocate&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778632">if</span>&nbsp;<span class="ident" id="1778635"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1778643">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778648"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1778656">.</span><span class="ident" id="1778657">next_gc</span>&nbsp;<span class="op" id="1778665">=</span>&nbsp;<span class="ident" id="1778667"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1778675">.</span><span class="ident" id="1778676">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1778689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778693">newb</span>&nbsp;<span class="op" id="1778698">:=</span>&nbsp;<span class="op" id="1778701">(</span><span class="op" id="1778702">*</span><span class="ident" id="1778703"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1778707">)</span><span class="op" id="1778708">(</span><span class="ident" id="1778709"><a href="/runtime/malloc.go.html#1828515">newobject</a></span><span class="op" id="1778718">(</span><span class="ident" id="1778719"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778720">.</span><span class="ident" id="1778721">bucket</span><span class="op" id="1778727">)</span><span class="op" id="1778728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778732"><a href="/runtime/hashmap.go.html#1777134">b</a></span><span class="op" id="1778733">.</span><span class="ident" id="1778734">overflow</span>&nbsp;<span class="op" id="1778743">=</span>&nbsp;<span class="ident" id="1778745"><a href="/runtime/hashmap.go.html#1778693">newb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778752"><a href="/runtime/hashmap.go.html#1777305">inserti</a></span>&nbsp;<span class="op" id="1778760">=</span>&nbsp;<span class="op" id="1778762">&amp;</span><span class="ident" id="1778763"><a href="/runtime/hashmap.go.html#1778693">newb</a></span><span class="op" id="1778767">.</span><span class="ident" id="1778768">tophash</span><span class="op" id="1778775">[</span><span class="num" id="1778776">0</span><span class="op" id="1778777">]</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778781"><a href="/runtime/hashmap.go.html#1777325">insertk</a></span>&nbsp;<span class="op" id="1778789">=</span>&nbsp;<span class="ident" id="1778791"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1778794">(</span><span class="ident" id="1778795"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1778801">.</span><span class="ident" id="1778802">Pointer</span><span class="op" id="1778809">(</span><span class="ident" id="1778810"><a href="/runtime/hashmap.go.html#1778693">newb</a></span><span class="op" id="1778814">)</span><span class="op" id="1778815">,</span>&nbsp;<span class="ident" id="1778817"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1778827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778831"><a href="/runtime/hashmap.go.html#1777353">insertv</a></span>&nbsp;<span class="op" id="1778839">=</span>&nbsp;<span class="ident" id="1778841"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1778844">(</span><span class="ident" id="1778845"><a href="/runtime/hashmap.go.html#1777325">insertk</a></span><span class="op" id="1778852">,</span>&nbsp;<span class="ident" id="1778854"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1778863">*</span><span class="builtintype" id="1778864">uintptr</span><span class="op" id="1778871">(</span><span class="ident" id="1778872"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778873">.</span><span class="ident" id="1778874">keysize</span><span class="op" id="1778881">)</span><span class="op" id="1778882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1778885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1778889">//&nbsp;store&nbsp;new&nbsp;key/value&nbsp;at&nbsp;insert&nbsp;position</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778932">if</span>&nbsp;<span class="ident" id="1778935"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1778936">.</span><span class="ident" id="1778937">indirectkey</span>&nbsp;<span class="op" id="1778949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1778953">if</span>&nbsp;<span class="ident" id="1778956"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1778964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778969"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1778977">.</span><span class="ident" id="1778978">next_gc</span>&nbsp;<span class="op" id="1778986">=</span>&nbsp;<span class="ident" id="1778988"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1778996">.</span><span class="ident" id="1778997">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779014">kmem</span>&nbsp;<span class="op" id="1779019">:=</span>&nbsp;<span class="ident" id="1779022"><a href="/runtime/malloc.go.html#1828515">newobject</a></span><span class="op" id="1779031">(</span><span class="ident" id="1779032"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1779033">.</span><span class="ident" id="1779034">key</span><span class="op" id="1779037">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779041">*</span><span class="op" id="1779042">(</span><span class="op" id="1779043">*</span><span class="ident" id="1779044"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1779050">.</span><span class="ident" id="1779051">Pointer</span><span class="op" id="1779058">)</span><span class="op" id="1779059">(</span><span class="ident" id="1779060"><a href="/runtime/hashmap.go.html#1777325">insertk</a></span><span class="op" id="1779067">)</span>&nbsp;<span class="op" id="1779069">=</span>&nbsp;<span class="ident" id="1779071"><a href="/runtime/hashmap.go.html#1779014">kmem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779078"><a href="/runtime/hashmap.go.html#1777325">insertk</a></span>&nbsp;<span class="op" id="1779086">=</span>&nbsp;<span class="ident" id="1779088"><a href="/runtime/hashmap.go.html#1779014">kmem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1779097">if</span>&nbsp;<span class="ident" id="1779100"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1779101">.</span><span class="ident" id="1779102">indirectvalue</span>&nbsp;<span class="op" id="1779116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1779120">if</span>&nbsp;<span class="ident" id="1779123"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1779131">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779136"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1779144">.</span><span class="ident" id="1779145">next_gc</span>&nbsp;<span class="op" id="1779153">=</span>&nbsp;<span class="ident" id="1779155"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1779163">.</span><span class="ident" id="1779164">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779181">vmem</span>&nbsp;<span class="op" id="1779186">:=</span>&nbsp;<span class="ident" id="1779189"><a href="/runtime/malloc.go.html#1828515">newobject</a></span><span class="op" id="1779198">(</span><span class="ident" id="1779199"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1779200">.</span><span class="ident" id="1779201">elem</span><span class="op" id="1779205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779209">*</span><span class="op" id="1779210">(</span><span class="op" id="1779211">*</span><span class="ident" id="1779212"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1779218">.</span><span class="ident" id="1779219">Pointer</span><span class="op" id="1779226">)</span><span class="op" id="1779227">(</span><span class="ident" id="1779228"><a href="/runtime/hashmap.go.html#1777353">insertv</a></span><span class="op" id="1779235">)</span>&nbsp;<span class="op" id="1779237">=</span>&nbsp;<span class="ident" id="1779239"><a href="/runtime/hashmap.go.html#1779181">vmem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779246"><a href="/runtime/hashmap.go.html#1777353">insertv</a></span>&nbsp;<span class="op" id="1779254">=</span>&nbsp;<span class="ident" id="1779256"><a href="/runtime/hashmap.go.html#1779181">vmem</a></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779265"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1779272">(</span><span class="ident" id="1779273"><a href="/runtime/hashmap.go.html#1777325">insertk</a></span><span class="op" id="1779280">,</span>&nbsp;<span class="ident" id="1779282"><a href="/runtime/hashmap.go.html#1776485">key</a></span><span class="op" id="1779285">,</span>&nbsp;<span class="builtintype" id="1779287">uintptr</span><span class="op" id="1779294">(</span><span class="ident" id="1779295"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1779296">.</span><span class="ident" id="1779297">key</span><span class="op" id="1779300">.</span><span class="ident" id="1779301">size</span><span class="op" id="1779305">)</span><span class="op" id="1779306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779309"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1779316">(</span><span class="ident" id="1779317"><a href="/runtime/hashmap.go.html#1777353">insertv</a></span><span class="op" id="1779324">,</span>&nbsp;<span class="ident" id="1779326"><a href="/runtime/hashmap.go.html#1776505">val</a></span><span class="op" id="1779329">,</span>&nbsp;<span class="builtintype" id="1779331">uintptr</span><span class="op" id="1779338">(</span><span class="ident" id="1779339"><a href="/runtime/hashmap.go.html#1776464">t</a></span><span class="op" id="1779340">.</span><span class="ident" id="1779341">elem</span><span class="op" id="1779345">.</span><span class="ident" id="1779346">size</span><span class="op" id="1779350">)</span><span class="op" id="1779351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779354">*</span><span class="ident" id="1779355"><a href="/runtime/hashmap.go.html#1777305">inserti</a></span>&nbsp;<span class="op" id="1779363">=</span>&nbsp;<span class="ident" id="1779365"><a href="/runtime/hashmap.go.html#1777215">top</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779370"><a href="/runtime/hashmap.go.html#1776476">h</a></span><span class="op" id="1779371">.</span><span class="ident" id="1779372">count</span><span class="op" id="1779377">++</span><br>
<span class="lineno">485</span><span class="op" id="1779380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1779383">func</span>&nbsp;<span class="ident" id="1779388">mapdelete</span><span class="op" id="1779397">(</span><span class="ident" id="1779398">t</span>&nbsp;<span class="op" id="1779400">*</span><span class="ident" id="1779401"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1779408">,</span>&nbsp;<span class="ident" id="1779410">h</span>&nbsp;<span class="op" id="1779412">*</span><span class="ident" id="1779413"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1779417">,</span>&nbsp;<span class="ident" id="1779419">key</span>&nbsp;<span class="ident" id="1779423"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1779429">.</span><span class="ident" id="1779430">Pointer</span><span class="op" id="1779437">)</span>&nbsp;<span class="op" id="1779439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1779442">if</span>&nbsp;<span class="ident" id="1779445"><a href="/runtime/race0.go.html#1906481">raceenabled</a></span>&nbsp;<span class="op" id="1779457">&amp;&amp;</span>&nbsp;<span class="ident" id="1779460"><a href="/runtime/hashmap.go.html#1779410">h</a></span>&nbsp;<span class="op" id="1779462">!=</span>&nbsp;<span class="ident" id="1779465">nil</span>&nbsp;<span class="op" id="1779469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779473">callerpc</span>&nbsp;<span class="op" id="1779482">:=</span>&nbsp;<span class="ident" id="1779485"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1779496">(</span><span class="ident" id="1779497"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1779503">.</span><span class="ident" id="1779504">Pointer</span><span class="op" id="1779511">(</span><span class="op" id="1779512">&amp;</span><span class="ident" id="1779513"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1779514">)</span><span class="op" id="1779515">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779519">pc</span>&nbsp;<span class="op" id="1779522">:=</span>&nbsp;<span class="ident" id="1779525"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1779531">(</span><span class="ident" id="1779532"><a href="/runtime/hashmap.go.html#1779388">mapdelete</a></span><span class="op" id="1779541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779545"><a href="/runtime/race0.go.html#1907063">racewritepc</a></span><span class="op" id="1779556">(</span><span class="ident" id="1779557"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1779563">.</span><span class="ident" id="1779564">Pointer</span><span class="op" id="1779571">(</span><span class="ident" id="1779572"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1779573">)</span><span class="op" id="1779574">,</span>&nbsp;<span class="ident" id="1779576"><a href="/runtime/hashmap.go.html#1779473">callerpc</a></span><span class="op" id="1779584">,</span>&nbsp;<span class="ident" id="1779586"><a href="/runtime/hashmap.go.html#1779519">pc</a></span><span class="op" id="1779588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779592"><a href="/runtime/race0.go.html#1906583">raceReadObjectPC</a></span><span class="op" id="1779608">(</span><span class="ident" id="1779609"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1779610">.</span><span class="ident" id="1779611">key</span><span class="op" id="1779614">,</span>&nbsp;<span class="ident" id="1779616"><a href="/runtime/hashmap.go.html#1779419">key</a></span><span class="op" id="1779619">,</span>&nbsp;<span class="ident" id="1779621"><a href="/runtime/hashmap.go.html#1779473">callerpc</a></span><span class="op" id="1779629">,</span>&nbsp;<span class="ident" id="1779631"><a href="/runtime/hashmap.go.html#1779519">pc</a></span><span class="op" id="1779633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1779639">if</span>&nbsp;<span class="ident" id="1779642"><a href="/runtime/hashmap.go.html#1779410">h</a></span>&nbsp;<span class="op" id="1779644">==</span>&nbsp;<span class="ident" id="1779647">nil</span>&nbsp;<span class="op" id="1779651">||</span>&nbsp;<span class="ident" id="1779654"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1779655">.</span><span class="ident" id="1779656">count</span>&nbsp;<span class="op" id="1779662">==</span>&nbsp;<span class="num" id="1779665">0</span>&nbsp;<span class="op" id="1779667">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1779671">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779682">alg</span>&nbsp;<span class="op" id="1779686">:=</span>&nbsp;<span class="ident" id="1779689"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1779694">(</span><span class="ident" id="1779695"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1779696">.</span><span class="ident" id="1779697">key</span><span class="op" id="1779700">.</span><span class="ident" id="1779701">alg</span><span class="op" id="1779704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779707">hash</span>&nbsp;<span class="op" id="1779712">:=</span>&nbsp;<span class="ident" id="1779715"><a href="/runtime/hashmap.go.html#1779682">alg</a></span><span class="op" id="1779718">.</span><span class="ident" id="1779719">hash</span><span class="op" id="1779723">(</span><span class="ident" id="1779724"><a href="/runtime/hashmap.go.html#1779419">key</a></span><span class="op" id="1779727">,</span>&nbsp;<span class="builtintype" id="1779729">uintptr</span><span class="op" id="1779736">(</span><span class="ident" id="1779737"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1779738">.</span><span class="ident" id="1779739">key</span><span class="op" id="1779742">.</span><span class="ident" id="1779743">size</span><span class="op" id="1779747">)</span><span class="op" id="1779748">,</span>&nbsp;<span class="builtintype" id="1779750">uintptr</span><span class="op" id="1779757">(</span><span class="ident" id="1779758"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1779759">.</span><span class="ident" id="1779760">hash0</span><span class="op" id="1779765">)</span><span class="op" id="1779766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779769">bucket</span>&nbsp;<span class="op" id="1779776">:=</span>&nbsp;<span class="ident" id="1779779"><a href="/runtime/hashmap.go.html#1779707">hash</a></span>&nbsp;<span class="op" id="1779784">&amp;</span>&nbsp;<span class="op" id="1779786">(</span><span class="builtintype" id="1779787">uintptr</span><span class="op" id="1779794">(</span><span class="num" id="1779795">1</span><span class="op" id="1779796">)</span><span class="op" id="1779797">&lt;&lt;</span><span class="ident" id="1779799"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1779800">.</span><span class="ident" id="1779801">B</span>&nbsp;<span class="op" id="1779803">-</span>&nbsp;<span class="num" id="1779805">1</span><span class="op" id="1779806">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1779809">if</span>&nbsp;<span class="ident" id="1779812"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1779813">.</span><span class="ident" id="1779814">oldbuckets</span>&nbsp;<span class="op" id="1779825">!=</span>&nbsp;<span class="ident" id="1779828">nil</span>&nbsp;<span class="op" id="1779832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779836"><a href="/runtime/hashmap.go.html#1786704">growWork</a></span><span class="op" id="1779844">(</span><span class="ident" id="1779845"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1779846">,</span>&nbsp;<span class="ident" id="1779848"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1779849">,</span>&nbsp;<span class="ident" id="1779851"><a href="/runtime/hashmap.go.html#1779769">bucket</a></span><span class="op" id="1779857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1779860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779863">b</span>&nbsp;<span class="op" id="1779865">:=</span>&nbsp;<span class="op" id="1779868">(</span><span class="op" id="1779869">*</span><span class="ident" id="1779870"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1779874">)</span><span class="op" id="1779875">(</span><span class="ident" id="1779876"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1779882">.</span><span class="ident" id="1779883">Pointer</span><span class="op" id="1779890">(</span><span class="builtintype" id="1779891">uintptr</span><span class="op" id="1779898">(</span><span class="ident" id="1779899"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1779900">.</span><span class="ident" id="1779901">buckets</span><span class="op" id="1779908">)</span>&nbsp;<span class="op" id="1779910">+</span>&nbsp;<span class="ident" id="1779912"><a href="/runtime/hashmap.go.html#1779769">bucket</a></span><span class="op" id="1779918">*</span><span class="builtintype" id="1779919">uintptr</span><span class="op" id="1779926">(</span><span class="ident" id="1779927"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1779928">.</span><span class="ident" id="1779929">bucketsize</span><span class="op" id="1779939">)</span><span class="op" id="1779940">)</span><span class="op" id="1779941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779944">top</span>&nbsp;<span class="op" id="1779948">:=</span>&nbsp;<span class="builtintype" id="1779951">uint8</span><span class="op" id="1779956">(</span><span class="ident" id="1779957"><a href="/runtime/hashmap.go.html#1779707">hash</a></span>&nbsp;<span class="op" id="1779962">&gt;&gt;</span>&nbsp;<span class="op" id="1779965">(</span><span class="ident" id="1779966"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1779973">*</span><span class="num" id="1779974">8</span>&nbsp;<span class="op" id="1779976">-</span>&nbsp;<span class="num" id="1779978">8</span><span class="op" id="1779979">)</span><span class="op" id="1779980">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1779983">if</span>&nbsp;<span class="ident" id="1779986"><a href="/runtime/hashmap.go.html#1779944">top</a></span>&nbsp;<span class="op" id="1779990">&lt;</span>&nbsp;<span class="ident" id="1779992"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span>&nbsp;<span class="op" id="1780003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780007"><a href="/runtime/hashmap.go.html#1779944">top</a></span>&nbsp;<span class="op" id="1780011">+=</span>&nbsp;<span class="ident" id="1780014"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780029">for</span>&nbsp;<span class="op" id="1780033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780037">for</span>&nbsp;<span class="ident" id="1780041">i</span>&nbsp;<span class="op" id="1780043">:=</span>&nbsp;<span class="builtintype" id="1780046">uintptr</span><span class="op" id="1780053">(</span><span class="num" id="1780054">0</span><span class="op" id="1780055">)</span><span class="op" id="1780056">;</span>&nbsp;<span class="ident" id="1780058"><a href="/runtime/hashmap.go.html#1780041">i</a></span>&nbsp;<span class="op" id="1780060">&lt;</span>&nbsp;<span class="ident" id="1780062"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1780071">;</span>&nbsp;<span class="ident" id="1780073"><a href="/runtime/hashmap.go.html#1780041">i</a></span><span class="op" id="1780074">++</span>&nbsp;<span class="op" id="1780077">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780082">if</span>&nbsp;<span class="ident" id="1780085"><a href="/runtime/hashmap.go.html#1779863">b</a></span><span class="op" id="1780086">.</span><span class="ident" id="1780087">tophash</span><span class="op" id="1780094">[</span><span class="ident" id="1780095"><a href="/runtime/hashmap.go.html#1780041">i</a></span><span class="op" id="1780096">]</span>&nbsp;<span class="op" id="1780098">!=</span>&nbsp;<span class="ident" id="1780101"><a href="/runtime/hashmap.go.html#1779944">top</a></span>&nbsp;<span class="op" id="1780105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780111">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780128">k</span>&nbsp;<span class="op" id="1780130">:=</span>&nbsp;<span class="ident" id="1780133"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1780136">(</span><span class="ident" id="1780137"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1780143">.</span><span class="ident" id="1780144">Pointer</span><span class="op" id="1780151">(</span><span class="ident" id="1780152"><a href="/runtime/hashmap.go.html#1779863">b</a></span><span class="op" id="1780153">)</span><span class="op" id="1780154">,</span>&nbsp;<span class="ident" id="1780156"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1780166">+</span><span class="ident" id="1780167"><a href="/runtime/hashmap.go.html#1780041">i</a></span><span class="op" id="1780168">*</span><span class="builtintype" id="1780169">uintptr</span><span class="op" id="1780176">(</span><span class="ident" id="1780177"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1780178">.</span><span class="ident" id="1780179">keysize</span><span class="op" id="1780186">)</span><span class="op" id="1780187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780192">k2</span>&nbsp;<span class="op" id="1780195">:=</span>&nbsp;<span class="ident" id="1780198"><a href="/runtime/hashmap.go.html#1780128">k</a></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780203">if</span>&nbsp;<span class="ident" id="1780206"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1780207">.</span><span class="ident" id="1780208">indirectkey</span>&nbsp;<span class="op" id="1780220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780226"><a href="/runtime/hashmap.go.html#1780192">k2</a></span>&nbsp;<span class="op" id="1780229">=</span>&nbsp;<span class="op" id="1780231">*</span><span class="op" id="1780232">(</span><span class="op" id="1780233">(</span><span class="op" id="1780234">*</span><span class="ident" id="1780235"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1780241">.</span><span class="ident" id="1780242">Pointer</span><span class="op" id="1780249">)</span><span class="op" id="1780250">(</span><span class="ident" id="1780251"><a href="/runtime/hashmap.go.html#1780192">k2</a></span><span class="op" id="1780253">)</span><span class="op" id="1780254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780264">if</span>&nbsp;<span class="op" id="1780267">!</span><span class="ident" id="1780268"><a href="/runtime/hashmap.go.html#1779682">alg</a></span><span class="op" id="1780271">.</span><span class="ident" id="1780272">equal</span><span class="op" id="1780277">(</span><span class="ident" id="1780278"><a href="/runtime/hashmap.go.html#1779419">key</a></span><span class="op" id="1780281">,</span>&nbsp;<span class="ident" id="1780283"><a href="/runtime/hashmap.go.html#1780192">k2</a></span><span class="op" id="1780285">,</span>&nbsp;<span class="builtintype" id="1780287">uintptr</span><span class="op" id="1780294">(</span><span class="ident" id="1780295"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1780296">.</span><span class="ident" id="1780297">key</span><span class="op" id="1780300">.</span><span class="ident" id="1780301">size</span><span class="op" id="1780305">)</span><span class="op" id="1780306">)</span>&nbsp;<span class="op" id="1780308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780314">continue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780331"><a href="/runtime/stubs.go.html#1972552">memclr</a></span><span class="op" id="1780337">(</span><span class="ident" id="1780338"><a href="/runtime/hashmap.go.html#1780128">k</a></span><span class="op" id="1780339">,</span>&nbsp;<span class="builtintype" id="1780341">uintptr</span><span class="op" id="1780348">(</span><span class="ident" id="1780349"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1780350">.</span><span class="ident" id="1780351">keysize</span><span class="op" id="1780358">)</span><span class="op" id="1780359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780364">v</span>&nbsp;<span class="op" id="1780366">:=</span>&nbsp;<span class="ident" id="1780369"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1780375">.</span><span class="ident" id="1780376">Pointer</span><span class="op" id="1780383">(</span><span class="builtintype" id="1780384">uintptr</span><span class="op" id="1780391">(</span><span class="ident" id="1780392"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1780398">.</span><span class="ident" id="1780399">Pointer</span><span class="op" id="1780406">(</span><span class="ident" id="1780407"><a href="/runtime/hashmap.go.html#1779863">b</a></span><span class="op" id="1780408">)</span><span class="op" id="1780409">)</span>&nbsp;<span class="op" id="1780411">+</span>&nbsp;<span class="ident" id="1780413"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span>&nbsp;<span class="op" id="1780424">+</span>&nbsp;<span class="ident" id="1780426"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1780435">*</span><span class="builtintype" id="1780436">uintptr</span><span class="op" id="1780443">(</span><span class="ident" id="1780444"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1780445">.</span><span class="ident" id="1780446">keysize</span><span class="op" id="1780453">)</span>&nbsp;<span class="op" id="1780455">+</span>&nbsp;<span class="ident" id="1780457"><a href="/runtime/hashmap.go.html#1780041">i</a></span><span class="op" id="1780458">*</span><span class="builtintype" id="1780459">uintptr</span><span class="op" id="1780466">(</span><span class="ident" id="1780467"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1780468">.</span><span class="ident" id="1780469">valuesize</span><span class="op" id="1780478">)</span><span class="op" id="1780479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780484"><a href="/runtime/stubs.go.html#1972552">memclr</a></span><span class="op" id="1780490">(</span><span class="ident" id="1780491"><a href="/runtime/hashmap.go.html#1780364">v</a></span><span class="op" id="1780492">,</span>&nbsp;<span class="builtintype" id="1780494">uintptr</span><span class="op" id="1780501">(</span><span class="ident" id="1780502"><a href="/runtime/hashmap.go.html#1779398">t</a></span><span class="op" id="1780503">.</span><span class="ident" id="1780504">valuesize</span><span class="op" id="1780513">)</span><span class="op" id="1780514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780519"><a href="/runtime/hashmap.go.html#1779863">b</a></span><span class="op" id="1780520">.</span><span class="ident" id="1780521">tophash</span><span class="op" id="1780528">[</span><span class="ident" id="1780529"><a href="/runtime/hashmap.go.html#1780041">i</a></span><span class="op" id="1780530">]</span>&nbsp;<span class="op" id="1780532">=</span>&nbsp;<span class="ident" id="1780534"><a href="/runtime/hashmap.go.html#1767447">empty</a></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780543"><a href="/runtime/hashmap.go.html#1779410">h</a></span><span class="op" id="1780544">.</span><span class="ident" id="1780545">count</span><span class="op" id="1780550">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780556">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780569"><a href="/runtime/hashmap.go.html#1779863">b</a></span>&nbsp;<span class="op" id="1780571">=</span>&nbsp;<span class="ident" id="1780573"><a href="/runtime/hashmap.go.html#1779863">b</a></span><span class="op" id="1780574">.</span><span class="ident" id="1780575">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780586">if</span>&nbsp;<span class="ident" id="1780589"><a href="/runtime/hashmap.go.html#1779863">b</a></span>&nbsp;<span class="op" id="1780591">==</span>&nbsp;<span class="ident" id="1780594">nil</span>&nbsp;<span class="op" id="1780598">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780603">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780615">}</span><br>
<span class="lineno"></span><span class="op" id="1780617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="keyword" id="1780620">func</span>&nbsp;<span class="ident" id="1780625">mapiterinit</span><span class="op" id="1780636">(</span><span class="ident" id="1780637">t</span>&nbsp;<span class="op" id="1780639">*</span><span class="ident" id="1780640"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1780647">,</span>&nbsp;<span class="ident" id="1780649">h</span>&nbsp;<span class="op" id="1780651">*</span><span class="ident" id="1780652"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1780656">,</span>&nbsp;<span class="ident" id="1780658">it</span>&nbsp;<span class="op" id="1780661">*</span><span class="ident" id="1780662"><a href="/runtime/hashmap.go.html#1769308">hiter</a></span><span class="op" id="1780667">)</span>&nbsp;<span class="op" id="1780669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1780672">//&nbsp;Clear&nbsp;pointer&nbsp;fields&nbsp;so&nbsp;garbage&nbsp;collector&nbsp;does&nbsp;not&nbsp;complain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780737"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1780739">.</span><span class="ident" id="1780740">key</span>&nbsp;<span class="op" id="1780744">=</span>&nbsp;<span class="ident" id="1780746">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780751"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1780753">.</span><span class="ident" id="1780754">value</span>&nbsp;<span class="op" id="1780760">=</span>&nbsp;<span class="ident" id="1780762">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780767"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1780769">.</span><span class="ident" id="1780770">t</span>&nbsp;<span class="op" id="1780772">=</span>&nbsp;<span class="ident" id="1780774">nil</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780779"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1780781">.</span><span class="ident" id="1780782">h</span>&nbsp;<span class="op" id="1780784">=</span>&nbsp;<span class="ident" id="1780786">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780791"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1780793">.</span><span class="ident" id="1780794">buckets</span>&nbsp;<span class="op" id="1780802">=</span>&nbsp;<span class="ident" id="1780804">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780809"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1780811">.</span><span class="ident" id="1780812">bptr</span>&nbsp;<span class="op" id="1780817">=</span>&nbsp;<span class="ident" id="1780819">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780825">if</span>&nbsp;<span class="ident" id="1780828"><a href="/runtime/race0.go.html#1906481">raceenabled</a></span>&nbsp;<span class="op" id="1780840">&amp;&amp;</span>&nbsp;<span class="ident" id="1780843"><a href="/runtime/hashmap.go.html#1780649">h</a></span>&nbsp;<span class="op" id="1780845">!=</span>&nbsp;<span class="ident" id="1780848">nil</span>&nbsp;<span class="op" id="1780852">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780856">callerpc</span>&nbsp;<span class="op" id="1780865">:=</span>&nbsp;<span class="ident" id="1780868"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1780879">(</span><span class="ident" id="1780880"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1780886">.</span><span class="ident" id="1780887">Pointer</span><span class="op" id="1780894">(</span><span class="op" id="1780895">&amp;</span><span class="ident" id="1780896"><a href="/runtime/hashmap.go.html#1780637">t</a></span><span class="op" id="1780897">)</span><span class="op" id="1780898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780902"><a href="/runtime/race0.go.html#1907159">racereadpc</a></span><span class="op" id="1780912">(</span><span class="ident" id="1780913"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1780919">.</span><span class="ident" id="1780920">Pointer</span><span class="op" id="1780927">(</span><span class="ident" id="1780928"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1780929">)</span><span class="op" id="1780930">,</span>&nbsp;<span class="ident" id="1780932"><a href="/runtime/hashmap.go.html#1780856">callerpc</a></span><span class="op" id="1780940">,</span>&nbsp;<span class="ident" id="1780942"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1780948">(</span><span class="ident" id="1780949"><a href="/runtime/hashmap.go.html#1780625">mapiterinit</a></span><span class="op" id="1780960">)</span><span class="op" id="1780961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780968">if</span>&nbsp;<span class="ident" id="1780971"><a href="/runtime/hashmap.go.html#1780649">h</a></span>&nbsp;<span class="op" id="1780973">==</span>&nbsp;<span class="ident" id="1780976">nil</span>&nbsp;<span class="op" id="1780980">||</span>&nbsp;<span class="ident" id="1780983"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1780984">.</span><span class="ident" id="1780985">count</span>&nbsp;<span class="op" id="1780991">==</span>&nbsp;<span class="num" id="1780994">0</span>&nbsp;<span class="op" id="1780996">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781000"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781002">.</span><span class="ident" id="1781003">key</span>&nbsp;<span class="op" id="1781007">=</span>&nbsp;<span class="ident" id="1781009">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781015"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781017">.</span><span class="ident" id="1781018">value</span>&nbsp;<span class="op" id="1781024">=</span>&nbsp;<span class="ident" id="1781026">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781032">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781044">if</span>&nbsp;<span class="ident" id="1781047"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1781053">.</span><span class="ident" id="1781054">Sizeof</span><span class="op" id="1781060">(</span><span class="ident" id="1781061"><a href="/runtime/hashmap.go.html#1769308">hiter</a></span><span class="op" id="1781066">{</span><span class="op" id="1781067">}</span><span class="op" id="1781068">)</span><span class="op" id="1781069">/</span><span class="ident" id="1781070"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span>&nbsp;<span class="op" id="1781078">!=</span>&nbsp;<span class="num" id="1781081">10</span>&nbsp;<span class="op" id="1781084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781088"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1781095">(</span><span class="string" id="1781096">&#34;hash_iter&nbsp;size&nbsp;incorrect&#34;</span><span class="op" id="1781122">)</span>&nbsp;<span class="comment" id="1781124">//&nbsp;see&nbsp;../../cmd/gc/reflect.c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781158"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781160">.</span><span class="ident" id="1781161">t</span>&nbsp;<span class="op" id="1781163">=</span>&nbsp;<span class="ident" id="1781165"><a href="/runtime/hashmap.go.html#1780637">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781168"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781170">.</span><span class="ident" id="1781171">h</span>&nbsp;<span class="op" id="1781173">=</span>&nbsp;<span class="ident" id="1781175"><a href="/runtime/hashmap.go.html#1780649">h</a></span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1781179">//&nbsp;grab&nbsp;snapshot&nbsp;of&nbsp;bucket&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781213"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781215">.</span><span class="ident" id="1781216">B</span>&nbsp;<span class="op" id="1781218">=</span>&nbsp;<span class="ident" id="1781220"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1781221">.</span><span class="ident" id="1781222">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781225"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781227">.</span><span class="ident" id="1781228">buckets</span>&nbsp;<span class="op" id="1781236">=</span>&nbsp;<span class="ident" id="1781238"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1781239">.</span><span class="ident" id="1781240">buckets</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1781250">//&nbsp;decide&nbsp;where&nbsp;to&nbsp;start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781276">r</span>&nbsp;<span class="op" id="1781278">:=</span>&nbsp;<span class="builtintype" id="1781281">uintptr</span><span class="op" id="1781288">(</span><span class="ident" id="1781289"><a href="/runtime/stubs.go.html#1972912">fastrand1</a></span><span class="op" id="1781298">(</span><span class="op" id="1781299">)</span><span class="op" id="1781300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781303">if</span>&nbsp;<span class="ident" id="1781306"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1781307">.</span><span class="ident" id="1781308">B</span>&nbsp;<span class="op" id="1781310">&gt;</span>&nbsp;<span class="num" id="1781312">31</span><span class="op" id="1781314">-</span><span class="ident" id="1781315"><a href="/runtime/hashmap.go.html#1766443">bucketCntBits</a></span>&nbsp;<span class="op" id="1781329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781333"><a href="/runtime/hashmap.go.html#1781276">r</a></span>&nbsp;<span class="op" id="1781335">+=</span>&nbsp;<span class="builtintype" id="1781338">uintptr</span><span class="op" id="1781345">(</span><span class="ident" id="1781346"><a href="/runtime/stubs.go.html#1972912">fastrand1</a></span><span class="op" id="1781355">(</span><span class="op" id="1781356">)</span><span class="op" id="1781357">)</span>&nbsp;<span class="op" id="1781359">&lt;&lt;</span>&nbsp;<span class="num" id="1781362">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781366">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781369"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781371">.</span><span class="ident" id="1781372">startBucket</span>&nbsp;<span class="op" id="1781384">=</span>&nbsp;<span class="ident" id="1781386"><a href="/runtime/hashmap.go.html#1781276">r</a></span>&nbsp;<span class="op" id="1781388">&amp;</span>&nbsp;<span class="op" id="1781390">(</span><span class="builtintype" id="1781391">uintptr</span><span class="op" id="1781398">(</span><span class="num" id="1781399">1</span><span class="op" id="1781400">)</span><span class="op" id="1781401">&lt;&lt;</span><span class="ident" id="1781403"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1781404">.</span><span class="ident" id="1781405">B</span>&nbsp;<span class="op" id="1781407">-</span>&nbsp;<span class="num" id="1781409">1</span><span class="op" id="1781410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781413"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781415">.</span><span class="ident" id="1781416">offset</span>&nbsp;<span class="op" id="1781423">=</span>&nbsp;<span class="builtintype" id="1781425">uint8</span><span class="op" id="1781430">(</span><span class="ident" id="1781431"><a href="/runtime/hashmap.go.html#1781276">r</a></span>&nbsp;<span class="op" id="1781433">&gt;&gt;</span>&nbsp;<span class="ident" id="1781436"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1781437">.</span><span class="ident" id="1781438">B</span>&nbsp;<span class="op" id="1781440">&amp;</span>&nbsp;<span class="op" id="1781442">(</span><span class="ident" id="1781443"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1781453">-</span>&nbsp;<span class="num" id="1781455">1</span><span class="op" id="1781456">)</span><span class="op" id="1781457">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1781461">//&nbsp;iterator&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781480"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781482">.</span><span class="ident" id="1781483">bucket</span>&nbsp;<span class="op" id="1781490">=</span>&nbsp;<span class="ident" id="1781492"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781494">.</span><span class="ident" id="1781495">startBucket</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781508"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781510">.</span><span class="ident" id="1781511">wrapped</span>&nbsp;<span class="op" id="1781519">=</span>&nbsp;<span class="ident" id="1781521">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781528"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781530">.</span><span class="ident" id="1781531">bptr</span>&nbsp;<span class="op" id="1781536">=</span>&nbsp;<span class="ident" id="1781538">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1781544">//&nbsp;Remember&nbsp;we&nbsp;have&nbsp;an&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1781578">//&nbsp;Can&nbsp;run&nbsp;concurrently&nbsp;with&nbsp;another&nbsp;hash_iter_init().</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781634">for</span>&nbsp;<span class="op" id="1781638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781642">old</span>&nbsp;<span class="op" id="1781646">:=</span>&nbsp;<span class="ident" id="1781649"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1781650">.</span><span class="ident" id="1781651">flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781659">if</span>&nbsp;<span class="ident" id="1781662"><a href="/runtime/hashmap.go.html#1781642">old</a></span>&nbsp;<span class="op" id="1781666">==</span>&nbsp;<span class="ident" id="1781669"><a href="/runtime/hashmap.go.html#1781642">old</a></span><span class="op" id="1781672">|</span><span class="ident" id="1781673"><a href="/runtime/hashmap.go.html#1767803">iterator</a></span><span class="op" id="1781681">|</span><span class="ident" id="1781682"><a href="/runtime/hashmap.go.html#1767862">oldIterator</a></span>&nbsp;<span class="op" id="1781694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781699">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781707">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781711">if</span>&nbsp;<span class="ident" id="1781714"><a href="/runtime/stubs.go.html#1974711">cas</a></span><span class="op" id="1781717">(</span><span class="op" id="1781718">&amp;</span><span class="ident" id="1781719"><a href="/runtime/hashmap.go.html#1780649">h</a></span><span class="op" id="1781720">.</span><span class="ident" id="1781721">flags</span><span class="op" id="1781726">,</span>&nbsp;<span class="ident" id="1781728"><a href="/runtime/hashmap.go.html#1781642">old</a></span><span class="op" id="1781731">,</span>&nbsp;<span class="ident" id="1781733"><a href="/runtime/hashmap.go.html#1781642">old</a></span><span class="op" id="1781736">|</span><span class="ident" id="1781737"><a href="/runtime/hashmap.go.html#1767803">iterator</a></span><span class="op" id="1781745">|</span><span class="ident" id="1781746"><a href="/runtime/hashmap.go.html#1767862">oldIterator</a></span><span class="op" id="1781757">)</span>&nbsp;<span class="op" id="1781759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781764">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781779"><a href="/runtime/hashmap.go.html#1781803">mapiternext</a></span><span class="op" id="1781790">(</span><span class="ident" id="1781791"><a href="/runtime/hashmap.go.html#1780658">it</a></span><span class="op" id="1781793">)</span><br>
<span class="lineno"></span><span class="op" id="1781795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1781798">func</span>&nbsp;<span class="ident" id="1781803">mapiternext</span><span class="op" id="1781814">(</span><span class="ident" id="1781815">it</span>&nbsp;<span class="op" id="1781818">*</span><span class="ident" id="1781819"><a href="/runtime/hashmap.go.html#1769308">hiter</a></span><span class="op" id="1781824">)</span>&nbsp;<span class="op" id="1781826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781829">h</span>&nbsp;<span class="op" id="1781831">:=</span>&nbsp;<span class="ident" id="1781834"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1781836">.</span><span class="ident" id="1781837">h</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781840">if</span>&nbsp;<span class="ident" id="1781843"><a href="/runtime/race0.go.html#1906481">raceenabled</a></span>&nbsp;<span class="op" id="1781855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781859">callerpc</span>&nbsp;<span class="op" id="1781868">:=</span>&nbsp;<span class="ident" id="1781871"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1781882">(</span><span class="ident" id="1781883"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1781889">.</span><span class="ident" id="1781890">Pointer</span><span class="op" id="1781897">(</span><span class="op" id="1781898">&amp;</span><span class="ident" id="1781899"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1781901">)</span><span class="op" id="1781902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781906"><a href="/runtime/race0.go.html#1907159">racereadpc</a></span><span class="op" id="1781916">(</span><span class="ident" id="1781917"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1781923">.</span><span class="ident" id="1781924">Pointer</span><span class="op" id="1781931">(</span><span class="ident" id="1781932"><a href="/runtime/hashmap.go.html#1781829">h</a></span><span class="op" id="1781933">)</span><span class="op" id="1781934">,</span>&nbsp;<span class="ident" id="1781936"><a href="/runtime/hashmap.go.html#1781859">callerpc</a></span><span class="op" id="1781944">,</span>&nbsp;<span class="ident" id="1781946"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1781952">(</span><span class="ident" id="1781953"><a href="/runtime/hashmap.go.html#1781803">mapiternext</a></span><span class="op" id="1781964">)</span><span class="op" id="1781965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781971">t</span>&nbsp;<span class="op" id="1781973">:=</span>&nbsp;<span class="ident" id="1781976"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1781978">.</span><span class="ident" id="1781979">t</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781982">bucket</span>&nbsp;<span class="op" id="1781989">:=</span>&nbsp;<span class="ident" id="1781992"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1781994">.</span><span class="ident" id="1781995">bucket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782003">b</span>&nbsp;<span class="op" id="1782005">:=</span>&nbsp;<span class="ident" id="1782008"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782010">.</span><span class="ident" id="1782011">bptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782017">i</span>&nbsp;<span class="op" id="1782019">:=</span>&nbsp;<span class="ident" id="1782022"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782024">.</span><span class="ident" id="1782025">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782028">checkBucket</span>&nbsp;<span class="op" id="1782040">:=</span>&nbsp;<span class="ident" id="1782043"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782045">.</span><span class="ident" id="1782046">checkBucket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782059">alg</span>&nbsp;<span class="op" id="1782063">:=</span>&nbsp;<span class="ident" id="1782066"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1782071">(</span><span class="ident" id="1782072"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1782073">.</span><span class="ident" id="1782074">key</span><span class="op" id="1782077">.</span><span class="ident" id="1782078">alg</span><span class="op" id="1782081">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="ident" id="1782084">next</span><span class="op" id="1782088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782091">if</span>&nbsp;<span class="ident" id="1782094"><a href="/runtime/hashmap.go.html#1782003">b</a></span>&nbsp;<span class="op" id="1782096">==</span>&nbsp;<span class="ident" id="1782099">nil</span>&nbsp;<span class="op" id="1782103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782107">if</span>&nbsp;<span class="ident" id="1782110"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span>&nbsp;<span class="op" id="1782117">==</span>&nbsp;<span class="ident" id="1782120"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782122">.</span><span class="ident" id="1782123">startBucket</span>&nbsp;<span class="op" id="1782135">&amp;&amp;</span>&nbsp;<span class="ident" id="1782138"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782140">.</span><span class="ident" id="1782141">wrapped</span>&nbsp;<span class="op" id="1782149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1782154">//&nbsp;end&nbsp;of&nbsp;iteration</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782177"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782179">.</span><span class="ident" id="1782180">key</span>&nbsp;<span class="op" id="1782184">=</span>&nbsp;<span class="ident" id="1782186">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782193"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782195">.</span><span class="ident" id="1782196">value</span>&nbsp;<span class="op" id="1782202">=</span>&nbsp;<span class="ident" id="1782204">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782211">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782224">if</span>&nbsp;<span class="ident" id="1782227"><a href="/runtime/hashmap.go.html#1781829">h</a></span><span class="op" id="1782228">.</span><span class="ident" id="1782229">oldbuckets</span>&nbsp;<span class="op" id="1782240">!=</span>&nbsp;<span class="ident" id="1782243">nil</span>&nbsp;<span class="op" id="1782247">&amp;&amp;</span>&nbsp;<span class="ident" id="1782250"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782252">.</span><span class="ident" id="1782253">B</span>&nbsp;<span class="op" id="1782255">==</span>&nbsp;<span class="ident" id="1782258"><a href="/runtime/hashmap.go.html#1781829">h</a></span><span class="op" id="1782259">.</span><span class="ident" id="1782260">B</span>&nbsp;<span class="op" id="1782262">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1782267">//&nbsp;Iterator&nbsp;was&nbsp;started&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;a&nbsp;grow,&nbsp;and&nbsp;the&nbsp;grow&nbsp;isn&#39;t&nbsp;done&nbsp;yet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1782348">//&nbsp;If&nbsp;the&nbsp;bucket&nbsp;we&#39;re&nbsp;looking&nbsp;at&nbsp;hasn&#39;t&nbsp;been&nbsp;filled&nbsp;in&nbsp;yet&nbsp;(i.e.&nbsp;the&nbsp;old</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1782425">//&nbsp;bucket&nbsp;hasn&#39;t&nbsp;been&nbsp;evacuated)&nbsp;then&nbsp;we&nbsp;need&nbsp;to&nbsp;iterate&nbsp;through&nbsp;the&nbsp;old</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1782501">//&nbsp;bucket&nbsp;and&nbsp;only&nbsp;return&nbsp;the&nbsp;ones&nbsp;that&nbsp;will&nbsp;be&nbsp;migrated&nbsp;to&nbsp;this&nbsp;bucket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782577">oldbucket</span>&nbsp;<span class="op" id="1782587">:=</span>&nbsp;<span class="ident" id="1782590"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span>&nbsp;<span class="op" id="1782597">&amp;</span>&nbsp;<span class="op" id="1782599">(</span><span class="builtintype" id="1782600">uintptr</span><span class="op" id="1782607">(</span><span class="num" id="1782608">1</span><span class="op" id="1782609">)</span><span class="op" id="1782610">&lt;&lt;</span><span class="op" id="1782612">(</span><span class="ident" id="1782613"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782615">.</span><span class="ident" id="1782616">B</span><span class="op" id="1782617">-</span><span class="num" id="1782618">1</span><span class="op" id="1782619">)</span>&nbsp;<span class="op" id="1782621">-</span>&nbsp;<span class="num" id="1782623">1</span><span class="op" id="1782624">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782629"><a href="/runtime/hashmap.go.html#1782003">b</a></span>&nbsp;<span class="op" id="1782631">=</span>&nbsp;<span class="op" id="1782633">(</span><span class="op" id="1782634">*</span><span class="ident" id="1782635"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1782639">)</span><span class="op" id="1782640">(</span><span class="ident" id="1782641"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1782644">(</span><span class="ident" id="1782645"><a href="/runtime/hashmap.go.html#1781829">h</a></span><span class="op" id="1782646">.</span><span class="ident" id="1782647">oldbuckets</span><span class="op" id="1782657">,</span>&nbsp;<span class="ident" id="1782659"><a href="/runtime/hashmap.go.html#1782577">oldbucket</a></span><span class="op" id="1782668">*</span><span class="builtintype" id="1782669">uintptr</span><span class="op" id="1782676">(</span><span class="ident" id="1782677"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1782678">.</span><span class="ident" id="1782679">bucketsize</span><span class="op" id="1782689">)</span><span class="op" id="1782690">)</span><span class="op" id="1782691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782696">if</span>&nbsp;<span class="op" id="1782699">!</span><span class="ident" id="1782700"><a href="/runtime/hashmap.go.html#1770046">evacuated</a></span><span class="op" id="1782709">(</span><span class="ident" id="1782710"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1782711">)</span>&nbsp;<span class="op" id="1782713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782719"><a href="/runtime/hashmap.go.html#1782028">checkBucket</a></span>&nbsp;<span class="op" id="1782731">=</span>&nbsp;<span class="ident" id="1782733"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782743">}</span>&nbsp;<span class="keyword" id="1782745">else</span>&nbsp;<span class="op" id="1782750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782756"><a href="/runtime/hashmap.go.html#1782003">b</a></span>&nbsp;<span class="op" id="1782758">=</span>&nbsp;<span class="op" id="1782760">(</span><span class="op" id="1782761">*</span><span class="ident" id="1782762"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1782766">)</span><span class="op" id="1782767">(</span><span class="ident" id="1782768"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1782771">(</span><span class="ident" id="1782772"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782774">.</span><span class="ident" id="1782775">buckets</span><span class="op" id="1782782">,</span>&nbsp;<span class="ident" id="1782784"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span><span class="op" id="1782790">*</span><span class="builtintype" id="1782791">uintptr</span><span class="op" id="1782798">(</span><span class="ident" id="1782799"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1782800">.</span><span class="ident" id="1782801">bucketsize</span><span class="op" id="1782811">)</span><span class="op" id="1782812">)</span><span class="op" id="1782813">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782819"><a href="/runtime/hashmap.go.html#1782028">checkBucket</a></span>&nbsp;<span class="op" id="1782831">=</span>&nbsp;<span class="ident" id="1782833"><a href="/runtime/hashmap.go.html#1767968">noCheck</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782848">}</span>&nbsp;<span class="keyword" id="1782850">else</span>&nbsp;<span class="op" id="1782855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782860"><a href="/runtime/hashmap.go.html#1782003">b</a></span>&nbsp;<span class="op" id="1782862">=</span>&nbsp;<span class="op" id="1782864">(</span><span class="op" id="1782865">*</span><span class="ident" id="1782866"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1782870">)</span><span class="op" id="1782871">(</span><span class="ident" id="1782872"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1782875">(</span><span class="ident" id="1782876"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782878">.</span><span class="ident" id="1782879">buckets</span><span class="op" id="1782886">,</span>&nbsp;<span class="ident" id="1782888"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span><span class="op" id="1782894">*</span><span class="builtintype" id="1782895">uintptr</span><span class="op" id="1782902">(</span><span class="ident" id="1782903"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1782904">.</span><span class="ident" id="1782905">bucketsize</span><span class="op" id="1782915">)</span><span class="op" id="1782916">)</span><span class="op" id="1782917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782922"><a href="/runtime/hashmap.go.html#1782028">checkBucket</a></span>&nbsp;<span class="op" id="1782934">=</span>&nbsp;<span class="ident" id="1782936"><a href="/runtime/hashmap.go.html#1767968">noCheck</a></span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782950"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span><span class="op" id="1782956">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782961">if</span>&nbsp;<span class="ident" id="1782964"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span>&nbsp;<span class="op" id="1782971">==</span>&nbsp;<span class="builtintype" id="1782974">uintptr</span><span class="op" id="1782981">(</span><span class="num" id="1782982">1</span><span class="op" id="1782983">)</span><span class="op" id="1782984">&lt;&lt;</span><span class="ident" id="1782986"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1782988">.</span><span class="ident" id="1782989">B</span>&nbsp;<span class="op" id="1782991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782996"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span>&nbsp;<span class="op" id="1783003">=</span>&nbsp;<span class="num" id="1783005">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783010"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1783012">.</span><span class="ident" id="1783013">wrapped</span>&nbsp;<span class="op" id="1783021">=</span>&nbsp;<span class="ident" id="1783023">true</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1783030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783034"><a href="/runtime/hashmap.go.html#1782017">i</a></span>&nbsp;<span class="op" id="1783036">=</span>&nbsp;<span class="num" id="1783038">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1783041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783044">for</span>&nbsp;<span class="op" id="1783048">;</span>&nbsp;<span class="ident" id="1783050"><a href="/runtime/hashmap.go.html#1782017">i</a></span>&nbsp;<span class="op" id="1783052">&lt;</span>&nbsp;<span class="ident" id="1783054"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1783063">;</span>&nbsp;<span class="ident" id="1783065"><a href="/runtime/hashmap.go.html#1782017">i</a></span><span class="op" id="1783066">++</span>&nbsp;<span class="op" id="1783069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783073">offi</span>&nbsp;<span class="op" id="1783078">:=</span>&nbsp;<span class="op" id="1783081">(</span><span class="ident" id="1783082"><a href="/runtime/hashmap.go.html#1782017">i</a></span>&nbsp;<span class="op" id="1783084">+</span>&nbsp;<span class="ident" id="1783086"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1783088">.</span><span class="ident" id="1783089">offset</span><span class="op" id="1783095">)</span>&nbsp;<span class="op" id="1783097">&amp;</span>&nbsp;<span class="op" id="1783099">(</span><span class="ident" id="1783100"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1783110">-</span>&nbsp;<span class="num" id="1783112">1</span><span class="op" id="1783113">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783117">k</span>&nbsp;<span class="op" id="1783119">:=</span>&nbsp;<span class="ident" id="1783122"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1783125">(</span><span class="ident" id="1783126"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1783132">.</span><span class="ident" id="1783133">Pointer</span><span class="op" id="1783140">(</span><span class="ident" id="1783141"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1783142">)</span><span class="op" id="1783143">,</span>&nbsp;<span class="ident" id="1783145"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1783155">+</span><span class="builtintype" id="1783156">uintptr</span><span class="op" id="1783163">(</span><span class="ident" id="1783164"><a href="/runtime/hashmap.go.html#1783073">offi</a></span><span class="op" id="1783168">)</span><span class="op" id="1783169">*</span><span class="builtintype" id="1783170">uintptr</span><span class="op" id="1783177">(</span><span class="ident" id="1783178"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1783179">.</span><span class="ident" id="1783180">keysize</span><span class="op" id="1783187">)</span><span class="op" id="1783188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783192">v</span>&nbsp;<span class="op" id="1783194">:=</span>&nbsp;<span class="ident" id="1783197"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1783200">(</span><span class="ident" id="1783201"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1783207">.</span><span class="ident" id="1783208">Pointer</span><span class="op" id="1783215">(</span><span class="ident" id="1783216"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1783217">)</span><span class="op" id="1783218">,</span>&nbsp;<span class="ident" id="1783220"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1783230">+</span><span class="ident" id="1783231"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1783240">*</span><span class="builtintype" id="1783241">uintptr</span><span class="op" id="1783248">(</span><span class="ident" id="1783249"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1783250">.</span><span class="ident" id="1783251">keysize</span><span class="op" id="1783258">)</span><span class="op" id="1783259">+</span><span class="builtintype" id="1783260">uintptr</span><span class="op" id="1783267">(</span><span class="ident" id="1783268"><a href="/runtime/hashmap.go.html#1783073">offi</a></span><span class="op" id="1783272">)</span><span class="op" id="1783273">*</span><span class="builtintype" id="1783274">uintptr</span><span class="op" id="1783281">(</span><span class="ident" id="1783282"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1783283">.</span><span class="ident" id="1783284">valuesize</span><span class="op" id="1783293">)</span><span class="op" id="1783294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783298">if</span>&nbsp;<span class="ident" id="1783301"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1783302">.</span><span class="ident" id="1783303">tophash</span><span class="op" id="1783310">[</span><span class="ident" id="1783311"><a href="/runtime/hashmap.go.html#1783073">offi</a></span><span class="op" id="1783315">]</span>&nbsp;<span class="op" id="1783317">!=</span>&nbsp;<span class="ident" id="1783320"><a href="/runtime/hashmap.go.html#1767447">empty</a></span>&nbsp;<span class="op" id="1783326">&amp;&amp;</span>&nbsp;<span class="ident" id="1783329"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1783330">.</span><span class="ident" id="1783331">tophash</span><span class="op" id="1783338">[</span><span class="ident" id="1783339"><a href="/runtime/hashmap.go.html#1783073">offi</a></span><span class="op" id="1783343">]</span>&nbsp;<span class="op" id="1783345">!=</span>&nbsp;<span class="ident" id="1783348"><a href="/runtime/hashmap.go.html#1767484">evacuatedEmpty</a></span>&nbsp;<span class="op" id="1783363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783368">if</span>&nbsp;<span class="ident" id="1783371"><a href="/runtime/hashmap.go.html#1782028">checkBucket</a></span>&nbsp;<span class="op" id="1783383">!=</span>&nbsp;<span class="ident" id="1783386"><a href="/runtime/hashmap.go.html#1767968">noCheck</a></span>&nbsp;<span class="op" id="1783394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783400">//&nbsp;Special&nbsp;case:&nbsp;iterator&nbsp;was&nbsp;started&nbsp;during&nbsp;a&nbsp;grow&nbsp;and&nbsp;the</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783464">//&nbsp;grow&nbsp;is&nbsp;not&nbsp;done&nbsp;yet.&nbsp;&nbsp;We&#39;re&nbsp;working&nbsp;on&nbsp;a&nbsp;bucket&nbsp;whose</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783526">//&nbsp;oldbucket&nbsp;has&nbsp;not&nbsp;been&nbsp;evacuated&nbsp;yet.&nbsp;&nbsp;Or&nbsp;at&nbsp;least,&nbsp;it&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783595">//&nbsp;evacuated&nbsp;when&nbsp;we&nbsp;started&nbsp;the&nbsp;bucket.&nbsp;&nbsp;So&nbsp;we&#39;re&nbsp;iterating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783660">//&nbsp;through&nbsp;the&nbsp;oldbucket,&nbsp;skipping&nbsp;any&nbsp;keys&nbsp;that&nbsp;will&nbsp;go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783721">//&nbsp;to&nbsp;the&nbsp;other&nbsp;new&nbsp;bucket&nbsp;(each&nbsp;oldbucket&nbsp;expands&nbsp;to&nbsp;two</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783783">//&nbsp;buckets&nbsp;during&nbsp;a&nbsp;grow).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783814">k2</span>&nbsp;<span class="op" id="1783817">:=</span>&nbsp;<span class="ident" id="1783820"><a href="/runtime/hashmap.go.html#1783117">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783826">if</span>&nbsp;<span class="ident" id="1783829"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1783830">.</span><span class="ident" id="1783831">indirectkey</span>&nbsp;<span class="op" id="1783843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783850"><a href="/runtime/hashmap.go.html#1783814">k2</a></span>&nbsp;<span class="op" id="1783853">=</span>&nbsp;<span class="op" id="1783855">*</span><span class="op" id="1783856">(</span><span class="op" id="1783857">(</span><span class="op" id="1783858">*</span><span class="ident" id="1783859"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1783865">.</span><span class="ident" id="1783866">Pointer</span><span class="op" id="1783873">)</span><span class="op" id="1783874">(</span><span class="ident" id="1783875"><a href="/runtime/hashmap.go.html#1783814">k2</a></span><span class="op" id="1783877">)</span><span class="op" id="1783878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1783884">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783890">if</span>&nbsp;<span class="ident" id="1783893"><a href="/runtime/hashmap.go.html#1782059">alg</a></span><span class="op" id="1783896">.</span><span class="ident" id="1783897">equal</span><span class="op" id="1783902">(</span><span class="ident" id="1783903"><a href="/runtime/hashmap.go.html#1783814">k2</a></span><span class="op" id="1783905">,</span>&nbsp;<span class="ident" id="1783907"><a href="/runtime/hashmap.go.html#1783814">k2</a></span><span class="op" id="1783909">,</span>&nbsp;<span class="builtintype" id="1783911">uintptr</span><span class="op" id="1783918">(</span><span class="ident" id="1783919"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1783920">.</span><span class="ident" id="1783921">key</span><span class="op" id="1783924">.</span><span class="ident" id="1783925">size</span><span class="op" id="1783929">)</span><span class="op" id="1783930">)</span>&nbsp;<span class="op" id="1783932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783939">//&nbsp;If&nbsp;the&nbsp;item&nbsp;in&nbsp;the&nbsp;oldbucket&nbsp;is&nbsp;not&nbsp;destined&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783996">//&nbsp;the&nbsp;current&nbsp;new&nbsp;bucket&nbsp;in&nbsp;the&nbsp;iteration,&nbsp;skip&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784054">hash</span>&nbsp;<span class="op" id="1784059">:=</span>&nbsp;<span class="ident" id="1784062"><a href="/runtime/hashmap.go.html#1782059">alg</a></span><span class="op" id="1784065">.</span><span class="ident" id="1784066">hash</span><span class="op" id="1784070">(</span><span class="ident" id="1784071"><a href="/runtime/hashmap.go.html#1783814">k2</a></span><span class="op" id="1784073">,</span>&nbsp;<span class="builtintype" id="1784075">uintptr</span><span class="op" id="1784082">(</span><span class="ident" id="1784083"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1784084">.</span><span class="ident" id="1784085">key</span><span class="op" id="1784088">.</span><span class="ident" id="1784089">size</span><span class="op" id="1784093">)</span><span class="op" id="1784094">,</span>&nbsp;<span class="builtintype" id="1784096">uintptr</span><span class="op" id="1784103">(</span><span class="ident" id="1784104"><a href="/runtime/hashmap.go.html#1781829">h</a></span><span class="op" id="1784105">.</span><span class="ident" id="1784106">hash0</span><span class="op" id="1784111">)</span><span class="op" id="1784112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784119">if</span>&nbsp;<span class="ident" id="1784122"><a href="/runtime/hashmap.go.html#1784054">hash</a></span><span class="op" id="1784126">&amp;</span><span class="op" id="1784127">(</span><span class="builtintype" id="1784128">uintptr</span><span class="op" id="1784135">(</span><span class="num" id="1784136">1</span><span class="op" id="1784137">)</span><span class="op" id="1784138">&lt;&lt;</span><span class="ident" id="1784140"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1784142">.</span><span class="ident" id="1784143">B</span><span class="op" id="1784144">-</span><span class="num" id="1784145">1</span><span class="op" id="1784146">)</span>&nbsp;<span class="op" id="1784148">!=</span>&nbsp;<span class="ident" id="1784151"><a href="/runtime/hashmap.go.html#1782028">checkBucket</a></span>&nbsp;<span class="op" id="1784163">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784171">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784191">}</span>&nbsp;<span class="keyword" id="1784193">else</span>&nbsp;<span class="op" id="1784198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784205">//&nbsp;Hash&nbsp;isn&#39;t&nbsp;repeatable&nbsp;if&nbsp;k&nbsp;!=&nbsp;k&nbsp;(NaNs).&nbsp;&nbsp;We&nbsp;need&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784264">//&nbsp;repeatable&nbsp;and&nbsp;randomish&nbsp;choice&nbsp;of&nbsp;which&nbsp;direction</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784323">//&nbsp;to&nbsp;send&nbsp;NaNs&nbsp;during&nbsp;evacuation.&nbsp;&nbsp;We&#39;ll&nbsp;use&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784382">//&nbsp;bit&nbsp;of&nbsp;tophash&nbsp;to&nbsp;decide&nbsp;which&nbsp;way&nbsp;NaNs&nbsp;go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784434">//&nbsp;NOTE:&nbsp;this&nbsp;case&nbsp;is&nbsp;why&nbsp;we&nbsp;need&nbsp;two&nbsp;evacuate&nbsp;tophash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784494">//&nbsp;values,&nbsp;evacuatedX&nbsp;and&nbsp;evacuatedY,&nbsp;that&nbsp;differ&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784552">//&nbsp;their&nbsp;low&nbsp;bit.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784575">if</span>&nbsp;<span class="ident" id="1784578"><a href="/runtime/hashmap.go.html#1782028">checkBucket</a></span><span class="op" id="1784589">&gt;&gt;</span><span class="op" id="1784591">(</span><span class="ident" id="1784592"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1784594">.</span><span class="ident" id="1784595">B</span><span class="op" id="1784596">-</span><span class="num" id="1784597">1</span><span class="op" id="1784598">)</span>&nbsp;<span class="op" id="1784600">!=</span>&nbsp;<span class="builtintype" id="1784603">uintptr</span><span class="op" id="1784610">(</span><span class="ident" id="1784611"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1784612">.</span><span class="ident" id="1784613">tophash</span><span class="op" id="1784620">[</span><span class="ident" id="1784621"><a href="/runtime/hashmap.go.html#1783073">offi</a></span><span class="op" id="1784625">]</span><span class="op" id="1784626">&amp;</span><span class="num" id="1784627">1</span><span class="op" id="1784628">)</span>&nbsp;<span class="op" id="1784630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784638">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784663">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784668">if</span>&nbsp;<span class="ident" id="1784671"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1784672">.</span><span class="ident" id="1784673">tophash</span><span class="op" id="1784680">[</span><span class="ident" id="1784681"><a href="/runtime/hashmap.go.html#1783073">offi</a></span><span class="op" id="1784685">]</span>&nbsp;<span class="op" id="1784687">!=</span>&nbsp;<span class="ident" id="1784690"><a href="/runtime/hashmap.go.html#1767543">evacuatedX</a></span>&nbsp;<span class="op" id="1784701">&amp;&amp;</span>&nbsp;<span class="ident" id="1784704"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1784705">.</span><span class="ident" id="1784706">tophash</span><span class="op" id="1784713">[</span><span class="ident" id="1784714"><a href="/runtime/hashmap.go.html#1783073">offi</a></span><span class="op" id="1784718">]</span>&nbsp;<span class="op" id="1784720">!=</span>&nbsp;<span class="ident" id="1784723"><a href="/runtime/hashmap.go.html#1767643">evacuatedY</a></span>&nbsp;<span class="op" id="1784734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784740">//&nbsp;this&nbsp;is&nbsp;the&nbsp;golden&nbsp;data,&nbsp;we&nbsp;can&nbsp;return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784790">if</span>&nbsp;<span class="ident" id="1784793"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1784794">.</span><span class="ident" id="1784795">indirectkey</span>&nbsp;<span class="op" id="1784807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784814"><a href="/runtime/hashmap.go.html#1783117">k</a></span>&nbsp;<span class="op" id="1784816">=</span>&nbsp;<span class="op" id="1784818">*</span><span class="op" id="1784819">(</span><span class="op" id="1784820">(</span><span class="op" id="1784821">*</span><span class="ident" id="1784822"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1784828">.</span><span class="ident" id="1784829">Pointer</span><span class="op" id="1784836">)</span><span class="op" id="1784837">(</span><span class="ident" id="1784838"><a href="/runtime/hashmap.go.html#1783117">k</a></span><span class="op" id="1784839">)</span><span class="op" id="1784840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784846">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784852"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1784854">.</span><span class="ident" id="1784855">key</span>&nbsp;<span class="op" id="1784859">=</span>&nbsp;<span class="ident" id="1784861"><a href="/runtime/hashmap.go.html#1783117">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784867">if</span>&nbsp;<span class="ident" id="1784870"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1784871">.</span><span class="ident" id="1784872">indirectvalue</span>&nbsp;<span class="op" id="1784886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784893"><a href="/runtime/hashmap.go.html#1783192">v</a></span>&nbsp;<span class="op" id="1784895">=</span>&nbsp;<span class="op" id="1784897">*</span><span class="op" id="1784898">(</span><span class="op" id="1784899">(</span><span class="op" id="1784900">*</span><span class="ident" id="1784901"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1784907">.</span><span class="ident" id="1784908">Pointer</span><span class="op" id="1784915">)</span><span class="op" id="1784916">(</span><span class="ident" id="1784917"><a href="/runtime/hashmap.go.html#1783192">v</a></span><span class="op" id="1784918">)</span><span class="op" id="1784919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784931"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1784933">.</span><span class="ident" id="1784934">value</span>&nbsp;<span class="op" id="1784940">=</span>&nbsp;<span class="ident" id="1784942"><a href="/runtime/hashmap.go.html#1783192">v</a></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784947">}</span>&nbsp;<span class="keyword" id="1784949">else</span>&nbsp;<span class="op" id="1784954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1784960">//&nbsp;The&nbsp;hash&nbsp;table&nbsp;has&nbsp;grown&nbsp;since&nbsp;the&nbsp;iterator&nbsp;was&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785024">//&nbsp;The&nbsp;golden&nbsp;data&nbsp;for&nbsp;this&nbsp;key&nbsp;is&nbsp;now&nbsp;somewhere&nbsp;else.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785083">k2</span>&nbsp;<span class="op" id="1785086">:=</span>&nbsp;<span class="ident" id="1785089"><a href="/runtime/hashmap.go.html#1783117">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785095">if</span>&nbsp;<span class="ident" id="1785098"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1785099">.</span><span class="ident" id="1785100">indirectkey</span>&nbsp;<span class="op" id="1785112">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785119"><a href="/runtime/hashmap.go.html#1785083">k2</a></span>&nbsp;<span class="op" id="1785122">=</span>&nbsp;<span class="op" id="1785124">*</span><span class="op" id="1785125">(</span><span class="op" id="1785126">(</span><span class="op" id="1785127">*</span><span class="ident" id="1785128"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1785134">.</span><span class="ident" id="1785135">Pointer</span><span class="op" id="1785142">)</span><span class="op" id="1785143">(</span><span class="ident" id="1785144"><a href="/runtime/hashmap.go.html#1785083">k2</a></span><span class="op" id="1785146">)</span><span class="op" id="1785147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785159">if</span>&nbsp;<span class="ident" id="1785162"><a href="/runtime/hashmap.go.html#1782059">alg</a></span><span class="op" id="1785165">.</span><span class="ident" id="1785166">equal</span><span class="op" id="1785171">(</span><span class="ident" id="1785172"><a href="/runtime/hashmap.go.html#1785083">k2</a></span><span class="op" id="1785174">,</span>&nbsp;<span class="ident" id="1785176"><a href="/runtime/hashmap.go.html#1785083">k2</a></span><span class="op" id="1785178">,</span>&nbsp;<span class="builtintype" id="1785180">uintptr</span><span class="op" id="1785187">(</span><span class="ident" id="1785188"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1785189">.</span><span class="ident" id="1785190">key</span><span class="op" id="1785193">.</span><span class="ident" id="1785194">size</span><span class="op" id="1785198">)</span><span class="op" id="1785199">)</span>&nbsp;<span class="op" id="1785201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785208">//&nbsp;Check&nbsp;the&nbsp;current&nbsp;hash&nbsp;table&nbsp;for&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785259">//&nbsp;This&nbsp;code&nbsp;handles&nbsp;the&nbsp;case&nbsp;where&nbsp;the&nbsp;key</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785308">//&nbsp;has&nbsp;been&nbsp;deleted,&nbsp;updated,&nbsp;or&nbsp;deleted&nbsp;and&nbsp;reinserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785370">//&nbsp;NOTE:&nbsp;we&nbsp;need&nbsp;to&nbsp;regrab&nbsp;the&nbsp;key&nbsp;as&nbsp;it&nbsp;has&nbsp;potentially&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785437">//&nbsp;updated&nbsp;to&nbsp;an&nbsp;equal()&nbsp;but&nbsp;not&nbsp;identical&nbsp;key&nbsp;(e.g.&nbsp;+0.0&nbsp;vs&nbsp;-0.0).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785510">rk</span><span class="op" id="1785512">,</span>&nbsp;<span class="ident" id="1785514">rv</span>&nbsp;<span class="op" id="1785517">:=</span>&nbsp;<span class="ident" id="1785520"><a href="/runtime/hashmap.go.html#1775353">mapaccessK</a></span><span class="op" id="1785530">(</span><span class="ident" id="1785531"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1785532">,</span>&nbsp;<span class="ident" id="1785534"><a href="/runtime/hashmap.go.html#1781829">h</a></span><span class="op" id="1785535">,</span>&nbsp;<span class="ident" id="1785537"><a href="/runtime/hashmap.go.html#1785083">k2</a></span><span class="op" id="1785539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785546">if</span>&nbsp;<span class="ident" id="1785549"><a href="/runtime/hashmap.go.html#1785510">rk</a></span>&nbsp;<span class="op" id="1785552">==</span>&nbsp;<span class="ident" id="1785555">nil</span>&nbsp;<span class="op" id="1785559">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785567">continue</span>&nbsp;<span class="comment" id="1785576">//&nbsp;key&nbsp;has&nbsp;been&nbsp;deleted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785612"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1785614">.</span><span class="ident" id="1785615">key</span>&nbsp;<span class="op" id="1785619">=</span>&nbsp;<span class="ident" id="1785621"><a href="/runtime/hashmap.go.html#1785510">rk</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785629"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1785631">.</span><span class="ident" id="1785632">value</span>&nbsp;<span class="op" id="1785638">=</span>&nbsp;<span class="ident" id="1785640"><a href="/runtime/hashmap.go.html#1785514">rv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785647">}</span>&nbsp;<span class="keyword" id="1785649">else</span>&nbsp;<span class="op" id="1785654">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785661">//&nbsp;if&nbsp;key!=key&nbsp;then&nbsp;the&nbsp;entry&nbsp;can&#39;t&nbsp;be&nbsp;deleted&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785716">//&nbsp;updated,&nbsp;so&nbsp;we&nbsp;can&nbsp;just&nbsp;return&nbsp;it.&nbsp;&nbsp;That&#39;s&nbsp;lucky&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785777">//&nbsp;us&nbsp;because&nbsp;when&nbsp;key!=key&nbsp;we&nbsp;can&#39;t&nbsp;look&nbsp;it&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1785830">//&nbsp;successfully&nbsp;in&nbsp;the&nbsp;current&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785873"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1785875">.</span><span class="ident" id="1785876">key</span>&nbsp;<span class="op" id="1785880">=</span>&nbsp;<span class="ident" id="1785882"><a href="/runtime/hashmap.go.html#1785083">k2</a></span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785890">if</span>&nbsp;<span class="ident" id="1785893"><a href="/runtime/hashmap.go.html#1781971">t</a></span><span class="op" id="1785894">.</span><span class="ident" id="1785895">indirectvalue</span>&nbsp;<span class="op" id="1785909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785917"><a href="/runtime/hashmap.go.html#1783192">v</a></span>&nbsp;<span class="op" id="1785919">=</span>&nbsp;<span class="op" id="1785921">*</span><span class="op" id="1785922">(</span><span class="op" id="1785923">(</span><span class="op" id="1785924">*</span><span class="ident" id="1785925"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1785931">.</span><span class="ident" id="1785932">Pointer</span><span class="op" id="1785939">)</span><span class="op" id="1785940">(</span><span class="ident" id="1785941"><a href="/runtime/hashmap.go.html#1783192">v</a></span><span class="op" id="1785942">)</span><span class="op" id="1785943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785957"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1785959">.</span><span class="ident" id="1785960">value</span>&nbsp;<span class="op" id="1785966">=</span>&nbsp;<span class="ident" id="1785968"><a href="/runtime/hashmap.go.html#1783192">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785974">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785984"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1785986">.</span><span class="ident" id="1785987">bucket</span>&nbsp;<span class="op" id="1785994">=</span>&nbsp;<span class="ident" id="1785996"><a href="/runtime/hashmap.go.html#1781982">bucket</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786006"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1786008">.</span><span class="ident" id="1786009">bptr</span>&nbsp;<span class="op" id="1786014">=</span>&nbsp;<span class="ident" id="1786016"><a href="/runtime/hashmap.go.html#1782003">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786021"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1786023">.</span><span class="ident" id="1786024">i</span>&nbsp;<span class="op" id="1786026">=</span>&nbsp;<span class="ident" id="1786028"><a href="/runtime/hashmap.go.html#1782017">i</a></span>&nbsp;<span class="op" id="1786030">+</span>&nbsp;<span class="num" id="1786032">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786037"><a href="/runtime/hashmap.go.html#1781815">it</a></span><span class="op" id="1786039">.</span><span class="ident" id="1786040">checkBucket</span>&nbsp;<span class="op" id="1786052">=</span>&nbsp;<span class="ident" id="1786054"><a href="/runtime/hashmap.go.html#1782028">checkBucket</a></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786069">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786084"><a href="/runtime/hashmap.go.html#1782003">b</a></span>&nbsp;<span class="op" id="1786086">=</span>&nbsp;<span class="ident" id="1786088"><a href="/runtime/hashmap.go.html#1782003">b</a></span><span class="op" id="1786089">.</span><span class="ident" id="1786090">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786100"><a href="/runtime/hashmap.go.html#1782017">i</a></span>&nbsp;<span class="op" id="1786102">=</span>&nbsp;<span class="num" id="1786104">0</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786107">goto</span>&nbsp;<span class="ident" id="1786112">next</span><br>
<span class="lineno"></span><span class="op" id="1786117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1786120">func</span>&nbsp;<span class="ident" id="1786125">hashGrow</span><span class="op" id="1786133">(</span><span class="ident" id="1786134">t</span>&nbsp;<span class="op" id="1786136">*</span><span class="ident" id="1786137"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1786144">,</span>&nbsp;<span class="ident" id="1786146">h</span>&nbsp;<span class="op" id="1786148">*</span><span class="ident" id="1786149"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1786153">)</span>&nbsp;<span class="op" id="1786155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786158">if</span>&nbsp;<span class="ident" id="1786161"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786162">.</span><span class="ident" id="1786163">oldbuckets</span>&nbsp;<span class="op" id="1786174">!=</span>&nbsp;<span class="ident" id="1786177">nil</span>&nbsp;<span class="op" id="1786181">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786185"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1786192">(</span><span class="string" id="1786193">&#34;evacuation&nbsp;not&nbsp;done&nbsp;in&nbsp;time&#34;</span><span class="op" id="1786222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786228">oldbuckets</span>&nbsp;<span class="op" id="1786239">:=</span>&nbsp;<span class="ident" id="1786242"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786243">.</span><span class="ident" id="1786244">buckets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786253">if</span>&nbsp;<span class="ident" id="1786256"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1786264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786268"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1786276">.</span><span class="ident" id="1786277">next_gc</span>&nbsp;<span class="op" id="1786285">=</span>&nbsp;<span class="ident" id="1786287"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1786295">.</span><span class="ident" id="1786296">heap_alloc</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786311">newbuckets</span>&nbsp;<span class="op" id="1786322">:=</span>&nbsp;<span class="ident" id="1786325"><a href="/runtime/malloc.go.html#1828735">newarray</a></span><span class="op" id="1786333">(</span><span class="ident" id="1786334"><a href="/runtime/hashmap.go.html#1786134">t</a></span><span class="op" id="1786335">.</span><span class="ident" id="1786336">bucket</span><span class="op" id="1786342">,</span>&nbsp;<span class="builtintype" id="1786344">uintptr</span><span class="op" id="1786351">(</span><span class="num" id="1786352">1</span><span class="op" id="1786353">)</span><span class="op" id="1786354">&lt;&lt;</span><span class="op" id="1786356">(</span><span class="ident" id="1786357"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786358">.</span><span class="ident" id="1786359">B</span><span class="op" id="1786360">+</span><span class="num" id="1786361">1</span><span class="op" id="1786362">)</span><span class="op" id="1786363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786366">flags</span>&nbsp;<span class="op" id="1786372">:=</span>&nbsp;<span class="ident" id="1786375"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786376">.</span><span class="ident" id="1786377">flags</span>&nbsp;<span class="op" id="1786383">&amp;^</span>&nbsp;<span class="op" id="1786386">(</span><span class="ident" id="1786387"><a href="/runtime/hashmap.go.html#1767803">iterator</a></span>&nbsp;<span class="op" id="1786396">|</span>&nbsp;<span class="ident" id="1786398"><a href="/runtime/hashmap.go.html#1767862">oldIterator</a></span><span class="op" id="1786409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786412">if</span>&nbsp;<span class="ident" id="1786415"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786416">.</span><span class="ident" id="1786417">flags</span><span class="op" id="1786422">&amp;</span><span class="ident" id="1786423"><a href="/runtime/hashmap.go.html#1767803">iterator</a></span>&nbsp;<span class="op" id="1786432">!=</span>&nbsp;<span class="num" id="1786435">0</span>&nbsp;<span class="op" id="1786437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786441"><a href="/runtime/hashmap.go.html#1786366">flags</a></span>&nbsp;<span class="op" id="1786447">|=</span>&nbsp;<span class="ident" id="1786450"><a href="/runtime/hashmap.go.html#1767862">oldIterator</a></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786466">//&nbsp;commit&nbsp;the&nbsp;grow&nbsp;(atomic&nbsp;wrt&nbsp;gc)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786502"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786503">.</span><span class="ident" id="1786504">B</span><span class="op" id="1786505">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786509"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786510">.</span><span class="ident" id="1786511">flags</span>&nbsp;<span class="op" id="1786517">=</span>&nbsp;<span class="ident" id="1786519"><a href="/runtime/hashmap.go.html#1786366">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786526"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786527">.</span><span class="ident" id="1786528">oldbuckets</span>&nbsp;<span class="op" id="1786539">=</span>&nbsp;<span class="ident" id="1786541"><a href="/runtime/hashmap.go.html#1786228">oldbuckets</a></span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786553"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786554">.</span><span class="ident" id="1786555">buckets</span>&nbsp;<span class="op" id="1786563">=</span>&nbsp;<span class="ident" id="1786565"><a href="/runtime/hashmap.go.html#1786311">newbuckets</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786577"><a href="/runtime/hashmap.go.html#1786146">h</a></span><span class="op" id="1786578">.</span><span class="ident" id="1786579">nevacuate</span>&nbsp;<span class="op" id="1786589">=</span>&nbsp;<span class="num" id="1786591">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786595">//&nbsp;the&nbsp;actual&nbsp;copying&nbsp;of&nbsp;the&nbsp;hash&nbsp;table&nbsp;data&nbsp;is&nbsp;done&nbsp;incrementally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786663">//&nbsp;by&nbsp;growWork()&nbsp;and&nbsp;evacuate().</span><br>
<span class="lineno">750</span><span class="op" id="1786696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1786699">func</span>&nbsp;<span class="ident" id="1786704">growWork</span><span class="op" id="1786712">(</span><span class="ident" id="1786713">t</span>&nbsp;<span class="op" id="1786715">*</span><span class="ident" id="1786716"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1786723">,</span>&nbsp;<span class="ident" id="1786725">h</span>&nbsp;<span class="op" id="1786727">*</span><span class="ident" id="1786728"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1786732">,</span>&nbsp;<span class="ident" id="1786734">bucket</span>&nbsp;<span class="builtintype" id="1786741">uintptr</span><span class="op" id="1786748">)</span>&nbsp;<span class="op" id="1786750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786753">noldbuckets</span>&nbsp;<span class="op" id="1786765">:=</span>&nbsp;<span class="builtintype" id="1786768">uintptr</span><span class="op" id="1786775">(</span><span class="num" id="1786776">1</span><span class="op" id="1786777">)</span>&nbsp;<span class="op" id="1786779">&lt;&lt;</span>&nbsp;<span class="op" id="1786782">(</span><span class="ident" id="1786783"><a href="/runtime/hashmap.go.html#1786725">h</a></span><span class="op" id="1786784">.</span><span class="ident" id="1786785">B</span>&nbsp;<span class="op" id="1786787">-</span>&nbsp;<span class="num" id="1786789">1</span><span class="op" id="1786790">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786794">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;evacuate&nbsp;the&nbsp;oldbucket&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786848">//&nbsp;to&nbsp;the&nbsp;bucket&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786885"><a href="/runtime/hashmap.go.html#1787052">evacuate</a></span><span class="op" id="1786893">(</span><span class="ident" id="1786894"><a href="/runtime/hashmap.go.html#1786713">t</a></span><span class="op" id="1786895">,</span>&nbsp;<span class="ident" id="1786897"><a href="/runtime/hashmap.go.html#1786725">h</a></span><span class="op" id="1786898">,</span>&nbsp;<span class="ident" id="1786900"><a href="/runtime/hashmap.go.html#1786734">bucket</a></span><span class="op" id="1786906">&amp;</span><span class="op" id="1786907">(</span><span class="ident" id="1786908"><a href="/runtime/hashmap.go.html#1786753">noldbuckets</a></span><span class="op" id="1786919">-</span><span class="num" id="1786920">1</span><span class="op" id="1786921">)</span><span class="op" id="1786922">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786926">//&nbsp;evacuate&nbsp;one&nbsp;more&nbsp;oldbucket&nbsp;to&nbsp;make&nbsp;progress&nbsp;on&nbsp;growing</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786986">if</span>&nbsp;<span class="ident" id="1786989"><a href="/runtime/hashmap.go.html#1786725">h</a></span><span class="op" id="1786990">.</span><span class="ident" id="1786991">oldbuckets</span>&nbsp;<span class="op" id="1787002">!=</span>&nbsp;<span class="ident" id="1787005">nil</span>&nbsp;<span class="op" id="1787009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787013"><a href="/runtime/hashmap.go.html#1787052">evacuate</a></span><span class="op" id="1787021">(</span><span class="ident" id="1787022"><a href="/runtime/hashmap.go.html#1786713">t</a></span><span class="op" id="1787023">,</span>&nbsp;<span class="ident" id="1787025"><a href="/runtime/hashmap.go.html#1786725">h</a></span><span class="op" id="1787026">,</span>&nbsp;<span class="ident" id="1787028"><a href="/runtime/hashmap.go.html#1786725">h</a></span><span class="op" id="1787029">.</span><span class="ident" id="1787030">nevacuate</span><span class="op" id="1787039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1787042">}</span><br>
<span class="lineno"></span><span class="op" id="1787044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span><span class="keyword" id="1787047">func</span>&nbsp;<span class="ident" id="1787052">evacuate</span><span class="op" id="1787060">(</span><span class="ident" id="1787061">t</span>&nbsp;<span class="op" id="1787063">*</span><span class="ident" id="1787064"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1787071">,</span>&nbsp;<span class="ident" id="1787073">h</span>&nbsp;<span class="op" id="1787075">*</span><span class="ident" id="1787076"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1787080">,</span>&nbsp;<span class="ident" id="1787082">oldbucket</span>&nbsp;<span class="builtintype" id="1787092">uintptr</span><span class="op" id="1787099">)</span>&nbsp;<span class="op" id="1787101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787104">b</span>&nbsp;<span class="op" id="1787106">:=</span>&nbsp;<span class="op" id="1787109">(</span><span class="op" id="1787110">*</span><span class="ident" id="1787111"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1787115">)</span><span class="op" id="1787116">(</span><span class="ident" id="1787117"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787120">(</span><span class="ident" id="1787121"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1787122">.</span><span class="ident" id="1787123">oldbuckets</span><span class="op" id="1787133">,</span>&nbsp;<span class="ident" id="1787135"><a href="/runtime/hashmap.go.html#1787082">oldbucket</a></span><span class="op" id="1787144">*</span><span class="builtintype" id="1787145">uintptr</span><span class="op" id="1787152">(</span><span class="ident" id="1787153"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787154">.</span><span class="ident" id="1787155">bucketsize</span><span class="op" id="1787165">)</span><span class="op" id="1787166">)</span><span class="op" id="1787167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787170">newbit</span>&nbsp;<span class="op" id="1787177">:=</span>&nbsp;<span class="builtintype" id="1787180">uintptr</span><span class="op" id="1787187">(</span><span class="num" id="1787188">1</span><span class="op" id="1787189">)</span>&nbsp;<span class="op" id="1787191">&lt;&lt;</span>&nbsp;<span class="op" id="1787194">(</span><span class="ident" id="1787195"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1787196">.</span><span class="ident" id="1787197">B</span>&nbsp;<span class="op" id="1787199">-</span>&nbsp;<span class="num" id="1787201">1</span><span class="op" id="1787202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787205">alg</span>&nbsp;<span class="op" id="1787209">:=</span>&nbsp;<span class="ident" id="1787212"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1787217">(</span><span class="ident" id="1787218"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787219">.</span><span class="ident" id="1787220">key</span><span class="op" id="1787223">.</span><span class="ident" id="1787224">alg</span><span class="op" id="1787227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787230">if</span>&nbsp;<span class="op" id="1787233">!</span><span class="ident" id="1787234"><a href="/runtime/hashmap.go.html#1770046">evacuated</a></span><span class="op" id="1787243">(</span><span class="ident" id="1787244"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1787245">)</span>&nbsp;<span class="op" id="1787247">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787251">//&nbsp;TODO:&nbsp;reuse&nbsp;overflow&nbsp;buckets&nbsp;instead&nbsp;of&nbsp;using&nbsp;new&nbsp;ones,&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1787321">//&nbsp;is&nbsp;no&nbsp;iterator&nbsp;using&nbsp;the&nbsp;old&nbsp;buckets.&nbsp;&nbsp;(If&nbsp;!oldIterator.)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787385">x</span>&nbsp;<span class="op" id="1787387">:=</span>&nbsp;<span class="op" id="1787390">(</span><span class="op" id="1787391">*</span><span class="ident" id="1787392"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1787396">)</span><span class="op" id="1787397">(</span><span class="ident" id="1787398"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787401">(</span><span class="ident" id="1787402"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1787403">.</span><span class="ident" id="1787404">buckets</span><span class="op" id="1787411">,</span>&nbsp;<span class="ident" id="1787413"><a href="/runtime/hashmap.go.html#1787082">oldbucket</a></span><span class="op" id="1787422">*</span><span class="builtintype" id="1787423">uintptr</span><span class="op" id="1787430">(</span><span class="ident" id="1787431"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787432">.</span><span class="ident" id="1787433">bucketsize</span><span class="op" id="1787443">)</span><span class="op" id="1787444">)</span><span class="op" id="1787445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787449">y</span>&nbsp;<span class="op" id="1787451">:=</span>&nbsp;<span class="op" id="1787454">(</span><span class="op" id="1787455">*</span><span class="ident" id="1787456"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1787460">)</span><span class="op" id="1787461">(</span><span class="ident" id="1787462"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787465">(</span><span class="ident" id="1787466"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1787467">.</span><span class="ident" id="1787468">buckets</span><span class="op" id="1787475">,</span>&nbsp;<span class="op" id="1787477">(</span><span class="ident" id="1787478"><a href="/runtime/hashmap.go.html#1787082">oldbucket</a></span><span class="op" id="1787487">+</span><span class="ident" id="1787488"><a href="/runtime/hashmap.go.html#1787170">newbit</a></span><span class="op" id="1787494">)</span><span class="op" id="1787495">*</span><span class="builtintype" id="1787496">uintptr</span><span class="op" id="1787503">(</span><span class="ident" id="1787504"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787505">.</span><span class="ident" id="1787506">bucketsize</span><span class="op" id="1787516">)</span><span class="op" id="1787517">)</span><span class="op" id="1787518">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787522">xi</span>&nbsp;<span class="op" id="1787525">:=</span>&nbsp;<span class="num" id="1787528">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787532">yi</span>&nbsp;<span class="op" id="1787535">:=</span>&nbsp;<span class="num" id="1787538">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787542">xk</span>&nbsp;<span class="op" id="1787545">:=</span>&nbsp;<span class="ident" id="1787548"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787551">(</span><span class="ident" id="1787552"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1787558">.</span><span class="ident" id="1787559">Pointer</span><span class="op" id="1787566">(</span><span class="ident" id="1787567"><a href="/runtime/hashmap.go.html#1787385">x</a></span><span class="op" id="1787568">)</span><span class="op" id="1787569">,</span>&nbsp;<span class="ident" id="1787571"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1787581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787585">yk</span>&nbsp;<span class="op" id="1787588">:=</span>&nbsp;<span class="ident" id="1787591"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787594">(</span><span class="ident" id="1787595"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1787601">.</span><span class="ident" id="1787602">Pointer</span><span class="op" id="1787609">(</span><span class="ident" id="1787610"><a href="/runtime/hashmap.go.html#1787449">y</a></span><span class="op" id="1787611">)</span><span class="op" id="1787612">,</span>&nbsp;<span class="ident" id="1787614"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1787624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787628">xv</span>&nbsp;<span class="op" id="1787631">:=</span>&nbsp;<span class="ident" id="1787634"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787637">(</span><span class="ident" id="1787638"><a href="/runtime/hashmap.go.html#1787542">xk</a></span><span class="op" id="1787640">,</span>&nbsp;<span class="ident" id="1787642"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1787651">*</span><span class="builtintype" id="1787652">uintptr</span><span class="op" id="1787659">(</span><span class="ident" id="1787660"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787661">.</span><span class="ident" id="1787662">keysize</span><span class="op" id="1787669">)</span><span class="op" id="1787670">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787674">yv</span>&nbsp;<span class="op" id="1787677">:=</span>&nbsp;<span class="ident" id="1787680"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787683">(</span><span class="ident" id="1787684"><a href="/runtime/hashmap.go.html#1787585">yk</a></span><span class="op" id="1787686">,</span>&nbsp;<span class="ident" id="1787688"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1787697">*</span><span class="builtintype" id="1787698">uintptr</span><span class="op" id="1787705">(</span><span class="ident" id="1787706"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787707">.</span><span class="ident" id="1787708">keysize</span><span class="op" id="1787715">)</span><span class="op" id="1787716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787720">for</span>&nbsp;<span class="op" id="1787724">;</span>&nbsp;<span class="ident" id="1787726"><a href="/runtime/hashmap.go.html#1787104">b</a></span>&nbsp;<span class="op" id="1787728">!=</span>&nbsp;<span class="ident" id="1787731">nil</span><span class="op" id="1787734">;</span>&nbsp;<span class="ident" id="1787736"><a href="/runtime/hashmap.go.html#1787104">b</a></span>&nbsp;<span class="op" id="1787738">=</span>&nbsp;<span class="ident" id="1787740"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1787741">.</span><span class="ident" id="1787742">overflow</span>&nbsp;<span class="op" id="1787751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787756">k</span>&nbsp;<span class="op" id="1787758">:=</span>&nbsp;<span class="ident" id="1787761"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787764">(</span><span class="ident" id="1787765"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1787771">.</span><span class="ident" id="1787772">Pointer</span><span class="op" id="1787779">(</span><span class="ident" id="1787780"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1787781">)</span><span class="op" id="1787782">,</span>&nbsp;<span class="ident" id="1787784"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1787794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787799">v</span>&nbsp;<span class="op" id="1787801">:=</span>&nbsp;<span class="ident" id="1787804"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787807">(</span><span class="ident" id="1787808"><a href="/runtime/hashmap.go.html#1787756">k</a></span><span class="op" id="1787809">,</span>&nbsp;<span class="ident" id="1787811"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1787820">*</span><span class="builtintype" id="1787821">uintptr</span><span class="op" id="1787828">(</span><span class="ident" id="1787829"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787830">.</span><span class="ident" id="1787831">keysize</span><span class="op" id="1787838">)</span><span class="op" id="1787839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787844">for</span>&nbsp;<span class="ident" id="1787848">i</span>&nbsp;<span class="op" id="1787850">:=</span>&nbsp;<span class="num" id="1787853">0</span><span class="op" id="1787854">;</span>&nbsp;<span class="ident" id="1787856"><a href="/runtime/hashmap.go.html#1787848">i</a></span>&nbsp;<span class="op" id="1787858">&lt;</span>&nbsp;<span class="ident" id="1787860"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1787869">;</span>&nbsp;<span class="ident" id="1787871"><a href="/runtime/hashmap.go.html#1787848">i</a></span><span class="op" id="1787872">,</span>&nbsp;<span class="ident" id="1787874"><a href="/runtime/hashmap.go.html#1787756">k</a></span><span class="op" id="1787875">,</span>&nbsp;<span class="ident" id="1787877"><a href="/runtime/hashmap.go.html#1787799">v</a></span>&nbsp;<span class="op" id="1787879">=</span>&nbsp;<span class="ident" id="1787881"><a href="/runtime/hashmap.go.html#1787848">i</a></span><span class="op" id="1787882">+</span><span class="num" id="1787883">1</span><span class="op" id="1787884">,</span>&nbsp;<span class="ident" id="1787886"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787889">(</span><span class="ident" id="1787890"><a href="/runtime/hashmap.go.html#1787756">k</a></span><span class="op" id="1787891">,</span>&nbsp;<span class="builtintype" id="1787893">uintptr</span><span class="op" id="1787900">(</span><span class="ident" id="1787901"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787902">.</span><span class="ident" id="1787903">keysize</span><span class="op" id="1787910">)</span><span class="op" id="1787911">)</span><span class="op" id="1787912">,</span>&nbsp;<span class="ident" id="1787914"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1787917">(</span><span class="ident" id="1787918"><a href="/runtime/hashmap.go.html#1787799">v</a></span><span class="op" id="1787919">,</span>&nbsp;<span class="builtintype" id="1787921">uintptr</span><span class="op" id="1787928">(</span><span class="ident" id="1787929"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1787930">.</span><span class="ident" id="1787931">valuesize</span><span class="op" id="1787940">)</span><span class="op" id="1787941">)</span>&nbsp;<span class="op" id="1787943">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787949">top</span>&nbsp;<span class="op" id="1787953">:=</span>&nbsp;<span class="ident" id="1787956"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1787957">.</span><span class="ident" id="1787958">tophash</span><span class="op" id="1787965">[</span><span class="ident" id="1787966"><a href="/runtime/hashmap.go.html#1787848">i</a></span><span class="op" id="1787967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1787973">if</span>&nbsp;<span class="ident" id="1787976"><a href="/runtime/hashmap.go.html#1787949">top</a></span>&nbsp;<span class="op" id="1787980">==</span>&nbsp;<span class="ident" id="1787983"><a href="/runtime/hashmap.go.html#1767447">empty</a></span>&nbsp;<span class="op" id="1787989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1787996"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1787997">.</span><span class="ident" id="1787998">tophash</span><span class="op" id="1788005">[</span><span class="ident" id="1788006"><a href="/runtime/hashmap.go.html#1787848">i</a></span><span class="op" id="1788007">]</span>&nbsp;<span class="op" id="1788009">=</span>&nbsp;<span class="ident" id="1788011"><a href="/runtime/hashmap.go.html#1767484">evacuatedEmpty</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1788031">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1788044">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1788050">if</span>&nbsp;<span class="ident" id="1788053"><a href="/runtime/hashmap.go.html#1787949">top</a></span>&nbsp;<span class="op" id="1788057">&lt;</span>&nbsp;<span class="ident" id="1788059"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span>&nbsp;<span class="op" id="1788070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788077"><a href="/runtime/panic.go.html#1894294">gothrow</a></span><span class="op" id="1788084">(</span><span class="string" id="1788085">&#34;bad&nbsp;map&nbsp;state&#34;</span><span class="op" id="1788100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1788106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788112">k2</span>&nbsp;<span class="op" id="1788115">:=</span>&nbsp;<span class="ident" id="1788118"><a href="/runtime/hashmap.go.html#1787756">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1788124">if</span>&nbsp;<span class="ident" id="1788127"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1788128">.</span><span class="ident" id="1788129">indirectkey</span>&nbsp;<span class="op" id="1788141">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788148"><a href="/runtime/hashmap.go.html#1788112">k2</a></span>&nbsp;<span class="op" id="1788151">=</span>&nbsp;<span class="op" id="1788153">*</span><span class="op" id="1788154">(</span><span class="op" id="1788155">(</span><span class="op" id="1788156">*</span><span class="ident" id="1788157"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1788163">.</span><span class="ident" id="1788164">Pointer</span><span class="op" id="1788171">)</span><span class="op" id="1788172">(</span><span class="ident" id="1788173"><a href="/runtime/hashmap.go.html#1788112">k2</a></span><span class="op" id="1788175">)</span><span class="op" id="1788176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1788182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788188">//&nbsp;Compute&nbsp;hash&nbsp;to&nbsp;make&nbsp;our&nbsp;evacuation&nbsp;decision&nbsp;(whether&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788257">//&nbsp;to&nbsp;send&nbsp;this&nbsp;key/value&nbsp;to&nbsp;bucket&nbsp;x&nbsp;or&nbsp;bucket&nbsp;y).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1788313">hash</span>&nbsp;<span class="op" id="1788318">:=</span>&nbsp;<span class="ident" id="1788321"><a href="/runtime/hashmap.go.html#1787205">alg</a></span><span class="op" id="1788324">.</span><span class="ident" id="1788325">hash</span><span class="op" id="1788329">(</span><span class="ident" id="1788330"><a href="/runtime/hashmap.go.html#1788112">k2</a></span><span class="op" id="1788332">,</span>&nbsp;<span class="builtintype" id="1788334">uintptr</span><span class="op" id="1788341">(</span><span class="ident" id="1788342"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1788343">.</span><span class="ident" id="1788344">key</span><span class="op" id="1788347">.</span><span class="ident" id="1788348">size</span><span class="op" id="1788352">)</span><span class="op" id="1788353">,</span>&nbsp;<span class="builtintype" id="1788355">uintptr</span><span class="op" id="1788362">(</span><span class="ident" id="1788363"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1788364">.</span><span class="ident" id="1788365">hash0</span><span class="op" id="1788370">)</span><span class="op" id="1788371">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1788377">if</span>&nbsp;<span class="ident" id="1788380"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1788381">.</span><span class="ident" id="1788382">flags</span><span class="op" id="1788387">&amp;</span><span class="ident" id="1788388"><a href="/runtime/hashmap.go.html#1767803">iterator</a></span>&nbsp;<span class="op" id="1788397">!=</span>&nbsp;<span class="num" id="1788400">0</span>&nbsp;<span class="op" id="1788402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1788409">if</span>&nbsp;<span class="op" id="1788412">!</span><span class="ident" id="1788413"><a href="/runtime/hashmap.go.html#1787205">alg</a></span><span class="op" id="1788416">.</span><span class="ident" id="1788417">equal</span><span class="op" id="1788422">(</span><span class="ident" id="1788423"><a href="/runtime/hashmap.go.html#1788112">k2</a></span><span class="op" id="1788425">,</span>&nbsp;<span class="ident" id="1788427"><a href="/runtime/hashmap.go.html#1788112">k2</a></span><span class="op" id="1788429">,</span>&nbsp;<span class="builtintype" id="1788431">uintptr</span><span class="op" id="1788438">(</span><span class="ident" id="1788439"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1788440">.</span><span class="ident" id="1788441">key</span><span class="op" id="1788444">.</span><span class="ident" id="1788445">size</span><span class="op" id="1788449">)</span><span class="op" id="1788450">)</span>&nbsp;<span class="op" id="1788452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788460">//&nbsp;If&nbsp;key&nbsp;!=&nbsp;key&nbsp;(NaNs),&nbsp;then&nbsp;the&nbsp;hash&nbsp;could&nbsp;be&nbsp;(and&nbsp;probably</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788528">//&nbsp;will&nbsp;be)&nbsp;entirely&nbsp;different&nbsp;from&nbsp;the&nbsp;old&nbsp;hash.&nbsp;&nbsp;Moreover,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788595">//&nbsp;it&nbsp;isn&#39;t&nbsp;reproducible.&nbsp;&nbsp;Reproducibility&nbsp;is&nbsp;required&nbsp;in&nbsp;the</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788663">//&nbsp;presence&nbsp;of&nbsp;iterators,&nbsp;as&nbsp;our&nbsp;evacuation&nbsp;decision&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788727">//&nbsp;match&nbsp;whatever&nbsp;decision&nbsp;the&nbsp;iterator&nbsp;made.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788779">//&nbsp;Fortunately,&nbsp;we&nbsp;have&nbsp;the&nbsp;freedom&nbsp;to&nbsp;send&nbsp;these&nbsp;keys&nbsp;either</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788847">//&nbsp;way.&nbsp;&nbsp;Also,&nbsp;tophash&nbsp;is&nbsp;meaningless&nbsp;for&nbsp;these&nbsp;kinds&nbsp;of&nbsp;keys.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788916">//&nbsp;We&nbsp;let&nbsp;the&nbsp;low&nbsp;bit&nbsp;of&nbsp;tophash&nbsp;drive&nbsp;the&nbsp;evacuation&nbsp;decision.</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1788986">//&nbsp;We&nbsp;recompute&nbsp;a&nbsp;new&nbsp;random&nbsp;tophash&nbsp;for&nbsp;the&nbsp;next&nbsp;level&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1789051">//&nbsp;these&nbsp;keys&nbsp;will&nbsp;get&nbsp;evenly&nbsp;distributed&nbsp;across&nbsp;all&nbsp;buckets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1789118">//&nbsp;after&nbsp;multiple&nbsp;grows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1789149">if</span>&nbsp;<span class="op" id="1789152">(</span><span class="ident" id="1789153"><a href="/runtime/hashmap.go.html#1787949">top</a></span>&nbsp;<span class="op" id="1789157">&amp;</span>&nbsp;<span class="num" id="1789159">1</span><span class="op" id="1789160">)</span>&nbsp;<span class="op" id="1789162">!=</span>&nbsp;<span class="num" id="1789165">0</span>&nbsp;<span class="op" id="1789167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789176"><a href="/runtime/hashmap.go.html#1788313">hash</a></span>&nbsp;<span class="op" id="1789181">|=</span>&nbsp;<span class="ident" id="1789184"><a href="/runtime/hashmap.go.html#1787170">newbit</a></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789197">}</span>&nbsp;<span class="keyword" id="1789199">else</span>&nbsp;<span class="op" id="1789204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789213"><a href="/runtime/hashmap.go.html#1788313">hash</a></span>&nbsp;<span class="op" id="1789218">&amp;^=</span>&nbsp;<span class="ident" id="1789222"><a href="/runtime/hashmap.go.html#1787170">newbit</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789243"><a href="/runtime/hashmap.go.html#1787949">top</a></span>&nbsp;<span class="op" id="1789247">=</span>&nbsp;<span class="builtintype" id="1789249">uint8</span><span class="op" id="1789254">(</span><span class="ident" id="1789255"><a href="/runtime/hashmap.go.html#1788313">hash</a></span>&nbsp;<span class="op" id="1789260">&gt;&gt;</span>&nbsp;<span class="op" id="1789263">(</span><span class="ident" id="1789264"><a href="/runtime/stubs.go.html#1968375">ptrSize</a></span><span class="op" id="1789271">*</span><span class="num" id="1789272">8</span>&nbsp;<span class="op" id="1789274">-</span>&nbsp;<span class="num" id="1789276">8</span><span class="op" id="1789277">)</span><span class="op" id="1789278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1789286">if</span>&nbsp;<span class="ident" id="1789289"><a href="/runtime/hashmap.go.html#1787949">top</a></span>&nbsp;<span class="op" id="1789293">&lt;</span>&nbsp;<span class="ident" id="1789295"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span>&nbsp;<span class="op" id="1789306">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789315"><a href="/runtime/hashmap.go.html#1787949">top</a></span>&nbsp;<span class="op" id="1789319">+=</span>&nbsp;<span class="ident" id="1789322"><a href="/runtime/hashmap.go.html#1767727">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1789358">if</span>&nbsp;<span class="op" id="1789361">(</span><span class="ident" id="1789362"><a href="/runtime/hashmap.go.html#1788313">hash</a></span>&nbsp;<span class="op" id="1789367">&amp;</span>&nbsp;<span class="ident" id="1789369"><a href="/runtime/hashmap.go.html#1787170">newbit</a></span><span class="op" id="1789375">)</span>&nbsp;<span class="op" id="1789377">==</span>&nbsp;<span class="num" id="1789380">0</span>&nbsp;<span class="op" id="1789382">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789389"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1789390">.</span><span class="ident" id="1789391">tophash</span><span class="op" id="1789398">[</span><span class="ident" id="1789399"><a href="/runtime/hashmap.go.html#1787848">i</a></span><span class="op" id="1789400">]</span>&nbsp;<span class="op" id="1789402">=</span>&nbsp;<span class="ident" id="1789404"><a href="/runtime/hashmap.go.html#1767543">evacuatedX</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1789420">if</span>&nbsp;<span class="ident" id="1789423"><a href="/runtime/hashmap.go.html#1787522">xi</a></span>&nbsp;<span class="op" id="1789426">==</span>&nbsp;<span class="ident" id="1789429"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1789439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1789447">if</span>&nbsp;<span class="ident" id="1789450"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1789458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789467"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1789475">.</span><span class="ident" id="1789476">next_gc</span>&nbsp;<span class="op" id="1789484">=</span>&nbsp;<span class="ident" id="1789486"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1789494">.</span><span class="ident" id="1789495">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789512">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789520">newx</span>&nbsp;<span class="op" id="1789525">:=</span>&nbsp;<span class="op" id="1789528">(</span><span class="op" id="1789529">*</span><span class="ident" id="1789530"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1789534">)</span><span class="op" id="1789535">(</span><span class="ident" id="1789536"><a href="/runtime/malloc.go.html#1828515">newobject</a></span><span class="op" id="1789545">(</span><span class="ident" id="1789546"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1789547">.</span><span class="ident" id="1789548">bucket</span><span class="op" id="1789554">)</span><span class="op" id="1789555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789563"><a href="/runtime/hashmap.go.html#1787385">x</a></span><span class="op" id="1789564">.</span><span class="ident" id="1789565">overflow</span>&nbsp;<span class="op" id="1789574">=</span>&nbsp;<span class="ident" id="1789576"><a href="/runtime/hashmap.go.html#1789520">newx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789587"><a href="/runtime/hashmap.go.html#1787385">x</a></span>&nbsp;<span class="op" id="1789589">=</span>&nbsp;<span class="ident" id="1789591"><a href="/runtime/hashmap.go.html#1789520">newx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789602"><a href="/runtime/hashmap.go.html#1787522">xi</a></span>&nbsp;<span class="op" id="1789605">=</span>&nbsp;<span class="num" id="1789607">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789615"><a href="/runtime/hashmap.go.html#1787542">xk</a></span>&nbsp;<span class="op" id="1789618">=</span>&nbsp;<span class="ident" id="1789620"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1789623">(</span><span class="ident" id="1789624"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1789630">.</span><span class="ident" id="1789631">Pointer</span><span class="op" id="1789638">(</span><span class="ident" id="1789639"><a href="/runtime/hashmap.go.html#1787385">x</a></span><span class="op" id="1789640">)</span><span class="op" id="1789641">,</span>&nbsp;<span class="ident" id="1789643"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1789653">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789661"><a href="/runtime/hashmap.go.html#1787628">xv</a></span>&nbsp;<span class="op" id="1789664">=</span>&nbsp;<span class="ident" id="1789666"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1789669">(</span><span class="ident" id="1789670"><a href="/runtime/hashmap.go.html#1787542">xk</a></span><span class="op" id="1789672">,</span>&nbsp;<span class="ident" id="1789674"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1789683">*</span><span class="builtintype" id="1789684">uintptr</span><span class="op" id="1789691">(</span><span class="ident" id="1789692"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1789693">.</span><span class="ident" id="1789694">keysize</span><span class="op" id="1789701">)</span><span class="op" id="1789702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789716"><a href="/runtime/hashmap.go.html#1787385">x</a></span><span class="op" id="1789717">.</span><span class="ident" id="1789718">tophash</span><span class="op" id="1789725">[</span><span class="ident" id="1789726"><a href="/runtime/hashmap.go.html#1787522">xi</a></span><span class="op" id="1789728">]</span>&nbsp;<span class="op" id="1789730">=</span>&nbsp;<span class="ident" id="1789732"><a href="/runtime/hashmap.go.html#1787949">top</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1789741">if</span>&nbsp;<span class="ident" id="1789744"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1789745">.</span><span class="ident" id="1789746">indirectkey</span>&nbsp;<span class="op" id="1789758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789766">*</span><span class="op" id="1789767">(</span><span class="op" id="1789768">*</span><span class="ident" id="1789769"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1789775">.</span><span class="ident" id="1789776">Pointer</span><span class="op" id="1789783">)</span><span class="op" id="1789784">(</span><span class="ident" id="1789785"><a href="/runtime/hashmap.go.html#1787542">xk</a></span><span class="op" id="1789787">)</span>&nbsp;<span class="op" id="1789789">=</span>&nbsp;<span class="ident" id="1789791"><a href="/runtime/hashmap.go.html#1788112">k2</a></span>&nbsp;<span class="comment" id="1789794">//&nbsp;copy&nbsp;pointer</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789815">}</span>&nbsp;<span class="keyword" id="1789817">else</span>&nbsp;<span class="op" id="1789822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789830"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1789837">(</span><span class="ident" id="1789838"><a href="/runtime/hashmap.go.html#1787542">xk</a></span><span class="op" id="1789840">,</span>&nbsp;<span class="ident" id="1789842"><a href="/runtime/hashmap.go.html#1787756">k</a></span><span class="op" id="1789843">,</span>&nbsp;<span class="builtintype" id="1789845">uintptr</span><span class="op" id="1789852">(</span><span class="ident" id="1789853"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1789854">.</span><span class="ident" id="1789855">key</span><span class="op" id="1789858">.</span><span class="ident" id="1789859">size</span><span class="op" id="1789863">)</span><span class="op" id="1789864">)</span>&nbsp;<span class="comment" id="1789866">//&nbsp;copy&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1789892">if</span>&nbsp;<span class="ident" id="1789895"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1789896">.</span><span class="ident" id="1789897">indirectvalue</span>&nbsp;<span class="op" id="1789911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789919">*</span><span class="op" id="1789920">(</span><span class="op" id="1789921">*</span><span class="ident" id="1789922"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1789928">.</span><span class="ident" id="1789929">Pointer</span><span class="op" id="1789936">)</span><span class="op" id="1789937">(</span><span class="ident" id="1789938"><a href="/runtime/hashmap.go.html#1787628">xv</a></span><span class="op" id="1789940">)</span>&nbsp;<span class="op" id="1789942">=</span>&nbsp;<span class="op" id="1789944">*</span><span class="op" id="1789945">(</span><span class="op" id="1789946">*</span><span class="ident" id="1789947"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1789953">.</span><span class="ident" id="1789954">Pointer</span><span class="op" id="1789961">)</span><span class="op" id="1789962">(</span><span class="ident" id="1789963"><a href="/runtime/hashmap.go.html#1787799">v</a></span><span class="op" id="1789964">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1789971">}</span>&nbsp;<span class="keyword" id="1789973">else</span>&nbsp;<span class="op" id="1789978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1789986"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1789993">(</span><span class="ident" id="1789994"><a href="/runtime/hashmap.go.html#1787628">xv</a></span><span class="op" id="1789996">,</span>&nbsp;<span class="ident" id="1789998"><a href="/runtime/hashmap.go.html#1787799">v</a></span><span class="op" id="1789999">,</span>&nbsp;<span class="builtintype" id="1790001">uintptr</span><span class="op" id="1790008">(</span><span class="ident" id="1790009"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790010">.</span><span class="ident" id="1790011">elem</span><span class="op" id="1790015">.</span><span class="ident" id="1790016">size</span><span class="op" id="1790020">)</span><span class="op" id="1790021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790035"><a href="/runtime/hashmap.go.html#1787522">xi</a></span><span class="op" id="1790037">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790045"><a href="/runtime/hashmap.go.html#1787542">xk</a></span>&nbsp;<span class="op" id="1790048">=</span>&nbsp;<span class="ident" id="1790050"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1790053">(</span><span class="ident" id="1790054"><a href="/runtime/hashmap.go.html#1787542">xk</a></span><span class="op" id="1790056">,</span>&nbsp;<span class="builtintype" id="1790058">uintptr</span><span class="op" id="1790065">(</span><span class="ident" id="1790066"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790067">.</span><span class="ident" id="1790068">keysize</span><span class="op" id="1790075">)</span><span class="op" id="1790076">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790083"><a href="/runtime/hashmap.go.html#1787628">xv</a></span>&nbsp;<span class="op" id="1790086">=</span>&nbsp;<span class="ident" id="1790088"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1790091">(</span><span class="ident" id="1790092"><a href="/runtime/hashmap.go.html#1787628">xv</a></span><span class="op" id="1790094">,</span>&nbsp;<span class="builtintype" id="1790096">uintptr</span><span class="op" id="1790103">(</span><span class="ident" id="1790104"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790105">.</span><span class="ident" id="1790106">valuesize</span><span class="op" id="1790115">)</span><span class="op" id="1790116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790122">}</span>&nbsp;<span class="keyword" id="1790124">else</span>&nbsp;<span class="op" id="1790129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790136"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1790137">.</span><span class="ident" id="1790138">tophash</span><span class="op" id="1790145">[</span><span class="ident" id="1790146"><a href="/runtime/hashmap.go.html#1787848">i</a></span><span class="op" id="1790147">]</span>&nbsp;<span class="op" id="1790149">=</span>&nbsp;<span class="ident" id="1790151"><a href="/runtime/hashmap.go.html#1767643">evacuatedY</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1790167">if</span>&nbsp;<span class="ident" id="1790170"><a href="/runtime/hashmap.go.html#1787532">yi</a></span>&nbsp;<span class="op" id="1790173">==</span>&nbsp;<span class="ident" id="1790176"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span>&nbsp;<span class="op" id="1790186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1790194">if</span>&nbsp;<span class="ident" id="1790197"><a href="/runtime/hashmap.go.html#1768069">checkgc</a></span>&nbsp;<span class="op" id="1790205">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790214"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1790222">.</span><span class="ident" id="1790223">next_gc</span>&nbsp;<span class="op" id="1790231">=</span>&nbsp;<span class="ident" id="1790233"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2023037">memstats</a></span><span class="op" id="1790241">.</span><span class="ident" id="1790242">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790267">newy</span>&nbsp;<span class="op" id="1790272">:=</span>&nbsp;<span class="op" id="1790275">(</span><span class="op" id="1790276">*</span><span class="ident" id="1790277"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1790281">)</span><span class="op" id="1790282">(</span><span class="ident" id="1790283"><a href="/runtime/malloc.go.html#1828515">newobject</a></span><span class="op" id="1790292">(</span><span class="ident" id="1790293"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790294">.</span><span class="ident" id="1790295">bucket</span><span class="op" id="1790301">)</span><span class="op" id="1790302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790310"><a href="/runtime/hashmap.go.html#1787449">y</a></span><span class="op" id="1790311">.</span><span class="ident" id="1790312">overflow</span>&nbsp;<span class="op" id="1790321">=</span>&nbsp;<span class="ident" id="1790323"><a href="/runtime/hashmap.go.html#1790267">newy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790334"><a href="/runtime/hashmap.go.html#1787449">y</a></span>&nbsp;<span class="op" id="1790336">=</span>&nbsp;<span class="ident" id="1790338"><a href="/runtime/hashmap.go.html#1790267">newy</a></span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790349"><a href="/runtime/hashmap.go.html#1787532">yi</a></span>&nbsp;<span class="op" id="1790352">=</span>&nbsp;<span class="num" id="1790354">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790362"><a href="/runtime/hashmap.go.html#1787585">yk</a></span>&nbsp;<span class="op" id="1790365">=</span>&nbsp;<span class="ident" id="1790367"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1790370">(</span><span class="ident" id="1790371"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1790377">.</span><span class="ident" id="1790378">Pointer</span><span class="op" id="1790385">(</span><span class="ident" id="1790386"><a href="/runtime/hashmap.go.html#1787449">y</a></span><span class="op" id="1790387">)</span><span class="op" id="1790388">,</span>&nbsp;<span class="ident" id="1790390"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1790400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790408"><a href="/runtime/hashmap.go.html#1787674">yv</a></span>&nbsp;<span class="op" id="1790411">=</span>&nbsp;<span class="ident" id="1790413"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1790416">(</span><span class="ident" id="1790417"><a href="/runtime/hashmap.go.html#1787585">yk</a></span><span class="op" id="1790419">,</span>&nbsp;<span class="ident" id="1790421"><a href="/runtime/hashmap.go.html#1766462">bucketCnt</a></span><span class="op" id="1790430">*</span><span class="builtintype" id="1790431">uintptr</span><span class="op" id="1790438">(</span><span class="ident" id="1790439"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790440">.</span><span class="ident" id="1790441">keysize</span><span class="op" id="1790448">)</span><span class="op" id="1790449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790463"><a href="/runtime/hashmap.go.html#1787449">y</a></span><span class="op" id="1790464">.</span><span class="ident" id="1790465">tophash</span><span class="op" id="1790472">[</span><span class="ident" id="1790473"><a href="/runtime/hashmap.go.html#1787532">yi</a></span><span class="op" id="1790475">]</span>&nbsp;<span class="op" id="1790477">=</span>&nbsp;<span class="ident" id="1790479"><a href="/runtime/hashmap.go.html#1787949">top</a></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1790488">if</span>&nbsp;<span class="ident" id="1790491"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790492">.</span><span class="ident" id="1790493">indirectkey</span>&nbsp;<span class="op" id="1790505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790513">*</span><span class="op" id="1790514">(</span><span class="op" id="1790515">*</span><span class="ident" id="1790516"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1790522">.</span><span class="ident" id="1790523">Pointer</span><span class="op" id="1790530">)</span><span class="op" id="1790531">(</span><span class="ident" id="1790532"><a href="/runtime/hashmap.go.html#1787585">yk</a></span><span class="op" id="1790534">)</span>&nbsp;<span class="op" id="1790536">=</span>&nbsp;<span class="ident" id="1790538"><a href="/runtime/hashmap.go.html#1788112">k2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790546">}</span>&nbsp;<span class="keyword" id="1790548">else</span>&nbsp;<span class="op" id="1790553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790561"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1790568">(</span><span class="ident" id="1790569"><a href="/runtime/hashmap.go.html#1787585">yk</a></span><span class="op" id="1790571">,</span>&nbsp;<span class="ident" id="1790573"><a href="/runtime/hashmap.go.html#1787756">k</a></span><span class="op" id="1790574">,</span>&nbsp;<span class="builtintype" id="1790576">uintptr</span><span class="op" id="1790583">(</span><span class="ident" id="1790584"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790585">.</span><span class="ident" id="1790586">key</span><span class="op" id="1790589">.</span><span class="ident" id="1790590">size</span><span class="op" id="1790594">)</span><span class="op" id="1790595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790602">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1790609">if</span>&nbsp;<span class="ident" id="1790612"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790613">.</span><span class="ident" id="1790614">indirectvalue</span>&nbsp;<span class="op" id="1790628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790636">*</span><span class="op" id="1790637">(</span><span class="op" id="1790638">*</span><span class="ident" id="1790639"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1790645">.</span><span class="ident" id="1790646">Pointer</span><span class="op" id="1790653">)</span><span class="op" id="1790654">(</span><span class="ident" id="1790655"><a href="/runtime/hashmap.go.html#1787674">yv</a></span><span class="op" id="1790657">)</span>&nbsp;<span class="op" id="1790659">=</span>&nbsp;<span class="op" id="1790661">*</span><span class="op" id="1790662">(</span><span class="op" id="1790663">*</span><span class="ident" id="1790664"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1790670">.</span><span class="ident" id="1790671">Pointer</span><span class="op" id="1790678">)</span><span class="op" id="1790679">(</span><span class="ident" id="1790680"><a href="/runtime/hashmap.go.html#1787799">v</a></span><span class="op" id="1790681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790688">}</span>&nbsp;<span class="keyword" id="1790690">else</span>&nbsp;<span class="op" id="1790695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790703"><a href="/runtime/stubs.go.html#1972675">memmove</a></span><span class="op" id="1790710">(</span><span class="ident" id="1790711"><a href="/runtime/hashmap.go.html#1787674">yv</a></span><span class="op" id="1790713">,</span>&nbsp;<span class="ident" id="1790715"><a href="/runtime/hashmap.go.html#1787799">v</a></span><span class="op" id="1790716">,</span>&nbsp;<span class="builtintype" id="1790718">uintptr</span><span class="op" id="1790725">(</span><span class="ident" id="1790726"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790727">.</span><span class="ident" id="1790728">elem</span><span class="op" id="1790732">.</span><span class="ident" id="1790733">size</span><span class="op" id="1790737">)</span><span class="op" id="1790738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790745">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790752"><a href="/runtime/hashmap.go.html#1787532">yi</a></span><span class="op" id="1790754">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790762"><a href="/runtime/hashmap.go.html#1787585">yk</a></span>&nbsp;<span class="op" id="1790765">=</span>&nbsp;<span class="ident" id="1790767"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1790770">(</span><span class="ident" id="1790771"><a href="/runtime/hashmap.go.html#1787585">yk</a></span><span class="op" id="1790773">,</span>&nbsp;<span class="builtintype" id="1790775">uintptr</span><span class="op" id="1790782">(</span><span class="ident" id="1790783"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790784">.</span><span class="ident" id="1790785">keysize</span><span class="op" id="1790792">)</span><span class="op" id="1790793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790800"><a href="/runtime/hashmap.go.html#1787674">yv</a></span>&nbsp;<span class="op" id="1790803">=</span>&nbsp;<span class="ident" id="1790805"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1790808">(</span><span class="ident" id="1790809"><a href="/runtime/hashmap.go.html#1787674">yv</a></span><span class="op" id="1790811">,</span>&nbsp;<span class="builtintype" id="1790813">uintptr</span><span class="op" id="1790820">(</span><span class="ident" id="1790821"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790822">.</span><span class="ident" id="1790823">valuesize</span><span class="op" id="1790832">)</span><span class="op" id="1790833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790844">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1790848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1790852">//&nbsp;Unlink&nbsp;the&nbsp;overflow&nbsp;buckets&nbsp;&amp;&nbsp;clear&nbsp;key/value&nbsp;to&nbsp;help&nbsp;GC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1790915">if</span>&nbsp;<span class="ident" id="1790918"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1790919">.</span><span class="ident" id="1790920">flags</span><span class="op" id="1790925">&amp;</span><span class="ident" id="1790926"><a href="/runtime/hashmap.go.html#1767862">oldIterator</a></span>&nbsp;<span class="op" id="1790938">==</span>&nbsp;<span class="num" id="1790941">0</span>&nbsp;<span class="op" id="1790943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1790948"><a href="/runtime/hashmap.go.html#1787104">b</a></span>&nbsp;<span class="op" id="1790950">=</span>&nbsp;<span class="op" id="1790952">(</span><span class="op" id="1790953">*</span><span class="ident" id="1790954"><a href="/runtime/hashmap.go.html#1768809">bmap</a></span><span class="op" id="1790958">)</span><span class="op" id="1790959">(</span><span class="ident" id="1790960"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1790963">(</span><span class="ident" id="1790964"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1790965">.</span><span class="ident" id="1790966">oldbuckets</span><span class="op" id="1790976">,</span>&nbsp;<span class="ident" id="1790978"><a href="/runtime/hashmap.go.html#1787082">oldbucket</a></span><span class="op" id="1790987">*</span><span class="builtintype" id="1790988">uintptr</span><span class="op" id="1790995">(</span><span class="ident" id="1790996"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1790997">.</span><span class="ident" id="1790998">bucketsize</span><span class="op" id="1791008">)</span><span class="op" id="1791009">)</span><span class="op" id="1791010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791015"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1791016">.</span><span class="ident" id="1791017">overflow</span>&nbsp;<span class="op" id="1791026">=</span>&nbsp;<span class="ident" id="1791028">nil</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791035"><a href="/runtime/stubs.go.html#1972552">memclr</a></span><span class="op" id="1791041">(</span><span class="ident" id="1791042"><a href="/runtime/stubs.go.html#1968610">add</a></span><span class="op" id="1791045">(</span><span class="ident" id="1791046"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1791052">.</span><span class="ident" id="1791053">Pointer</span><span class="op" id="1791060">(</span><span class="ident" id="1791061"><a href="/runtime/hashmap.go.html#1787104">b</a></span><span class="op" id="1791062">)</span><span class="op" id="1791063">,</span>&nbsp;<span class="ident" id="1791065"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1791075">)</span><span class="op" id="1791076">,</span>&nbsp;<span class="builtintype" id="1791078">uintptr</span><span class="op" id="1791085">(</span><span class="ident" id="1791086"><a href="/runtime/hashmap.go.html#1787061">t</a></span><span class="op" id="1791087">.</span><span class="ident" id="1791088">bucketsize</span><span class="op" id="1791098">)</span><span class="op" id="1791099">-</span><span class="ident" id="1791100"><a href="/runtime/hashmap.go.html#1767031">dataOffset</a></span><span class="op" id="1791110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1791114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1791117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1791121">//&nbsp;Advance&nbsp;evacuation&nbsp;mark</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1791149">if</span>&nbsp;<span class="ident" id="1791152"><a href="/runtime/hashmap.go.html#1787082">oldbucket</a></span>&nbsp;<span class="op" id="1791162">==</span>&nbsp;<span class="ident" id="1791165"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1791166">.</span><span class="ident" id="1791167">nevacuate</span>&nbsp;<span class="op" id="1791177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791181"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1791182">.</span><span class="ident" id="1791183">nevacuate</span>&nbsp;<span class="op" id="1791193">=</span>&nbsp;<span class="ident" id="1791195"><a href="/runtime/hashmap.go.html#1787082">oldbucket</a></span>&nbsp;<span class="op" id="1791205">+</span>&nbsp;<span class="num" id="1791207">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1791211">if</span>&nbsp;<span class="ident" id="1791214"><a href="/runtime/hashmap.go.html#1787082">oldbucket</a></span><span class="op" id="1791223">+</span><span class="num" id="1791224">1</span>&nbsp;<span class="op" id="1791226">==</span>&nbsp;<span class="ident" id="1791229"><a href="/runtime/hashmap.go.html#1787170">newbit</a></span>&nbsp;<span class="op" id="1791236">{</span>&nbsp;<span class="comment" id="1791238">//&nbsp;newbit&nbsp;==&nbsp;#&nbsp;of&nbsp;oldbuckets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1791270">//&nbsp;Growing&nbsp;is&nbsp;all&nbsp;done.&nbsp;&nbsp;Free&nbsp;old&nbsp;main&nbsp;bucket&nbsp;array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791326"><a href="/runtime/hashmap.go.html#1787073">h</a></span><span class="op" id="1791327">.</span><span class="ident" id="1791328">oldbuckets</span>&nbsp;<span class="op" id="1791339">=</span>&nbsp;<span class="ident" id="1791341">nil</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1791347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1791350">}</span><br>
<span class="lineno"></span><span class="op" id="1791352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1791355">func</span>&nbsp;<span class="ident" id="1791360">ismapkey</span><span class="op" id="1791368">(</span><span class="ident" id="1791369">t</span>&nbsp;<span class="op" id="1791371">*</span><span class="ident" id="1791372"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2025572">_type</a></span><span class="op" id="1791377">)</span>&nbsp;<span class="builtintype" id="1791379">bool</span>&nbsp;<span class="op" id="1791384">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1791387">return</span>&nbsp;<span class="ident" id="1791394"><a href="/runtime/alg.go.html#1709230">goalg</a></span><span class="op" id="1791399">(</span><span class="ident" id="1791400"><a href="/runtime/hashmap.go.html#1791369">t</a></span><span class="op" id="1791401">.</span><span class="ident" id="1791402">alg</span><span class="op" id="1791405">)</span><span class="op" id="1791406">.</span><span class="ident" id="1791407">hash</span>&nbsp;<span class="op" id="1791412">!=</span>&nbsp;<span class="ident" id="1791415">nil</span><br>
<span class="lineno"></span><span class="op" id="1791419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1791422">//&nbsp;Reflect&nbsp;stubs.&nbsp;&nbsp;Called&nbsp;from&nbsp;../reflect/asm_*.s</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span><span class="keyword" id="1791473">func</span>&nbsp;<span class="ident" id="1791478">reflect_makemap</span><span class="op" id="1791493">(</span><span class="ident" id="1791494">t</span>&nbsp;<span class="op" id="1791496">*</span><span class="ident" id="1791497"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1791504">)</span>&nbsp;<span class="op" id="1791506">*</span><span class="ident" id="1791507"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span>&nbsp;<span class="op" id="1791512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1791515">return</span>&nbsp;<span class="ident" id="1791522"><a href="/runtime/hashmap.go.html#1770135">makemap</a></span><span class="op" id="1791529">(</span><span class="ident" id="1791530"><a href="/runtime/hashmap.go.html#1791494">t</a></span><span class="op" id="1791531">,</span>&nbsp;<span class="num" id="1791533">0</span><span class="op" id="1791534">)</span><br>
<span class="lineno"></span><span class="op" id="1791536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1791539">func</span>&nbsp;<span class="ident" id="1791544">reflect_mapaccess</span><span class="op" id="1791561">(</span><span class="ident" id="1791562">t</span>&nbsp;<span class="op" id="1791564">*</span><span class="ident" id="1791565"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1791572">,</span>&nbsp;<span class="ident" id="1791574">h</span>&nbsp;<span class="op" id="1791576">*</span><span class="ident" id="1791577"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1791581">,</span>&nbsp;<span class="ident" id="1791583">key</span>&nbsp;<span class="ident" id="1791587"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1791593">.</span><span class="ident" id="1791594">Pointer</span><span class="op" id="1791601">)</span>&nbsp;<span class="ident" id="1791603"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1791609">.</span><span class="ident" id="1791610">Pointer</span>&nbsp;<span class="op" id="1791618">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791621">val</span><span class="op" id="1791624">,</span>&nbsp;<span class="ident" id="1791626">ok</span>&nbsp;<span class="op" id="1791629">:=</span>&nbsp;<span class="ident" id="1791632"><a href="/runtime/hashmap.go.html#1773958">mapaccess2</a></span><span class="op" id="1791642">(</span><span class="ident" id="1791643"><a href="/runtime/hashmap.go.html#1791562">t</a></span><span class="op" id="1791644">,</span>&nbsp;<span class="ident" id="1791646"><a href="/runtime/hashmap.go.html#1791574">h</a></span><span class="op" id="1791647">,</span>&nbsp;<span class="ident" id="1791649"><a href="/runtime/hashmap.go.html#1791583">key</a></span><span class="op" id="1791652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1791655">if</span>&nbsp;<span class="op" id="1791658">!</span><span class="ident" id="1791659"><a href="/runtime/hashmap.go.html#1791626">ok</a></span>&nbsp;<span class="op" id="1791662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1791666">//&nbsp;reflect&nbsp;wants&nbsp;nil&nbsp;for&nbsp;a&nbsp;missing&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791711"><a href="/runtime/hashmap.go.html#1791621">val</a></span>&nbsp;<span class="op" id="1791715">=</span>&nbsp;<span class="ident" id="1791717">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1791722">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1791725">return</span>&nbsp;<span class="ident" id="1791732"><a href="/runtime/hashmap.go.html#1791621">val</a></span><br>
<span class="lineno"></span><span class="op" id="1791736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1791739">func</span>&nbsp;<span class="ident" id="1791744">reflect_mapassign</span><span class="op" id="1791761">(</span><span class="ident" id="1791762">t</span>&nbsp;<span class="op" id="1791764">*</span><span class="ident" id="1791765"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1791772">,</span>&nbsp;<span class="ident" id="1791774">h</span>&nbsp;<span class="op" id="1791776">*</span><span class="ident" id="1791777"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1791781">,</span>&nbsp;<span class="ident" id="1791783">key</span>&nbsp;<span class="ident" id="1791787"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1791793">.</span><span class="ident" id="1791794">Pointer</span><span class="op" id="1791801">,</span>&nbsp;<span class="ident" id="1791803">val</span>&nbsp;<span class="ident" id="1791807"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1791813">.</span><span class="ident" id="1791814">Pointer</span><span class="op" id="1791821">)</span>&nbsp;<span class="op" id="1791823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791826"><a href="/runtime/hashmap.go.html#1776453">mapassign1</a></span><span class="op" id="1791836">(</span><span class="ident" id="1791837"><a href="/runtime/hashmap.go.html#1791762">t</a></span><span class="op" id="1791838">,</span>&nbsp;<span class="ident" id="1791840"><a href="/runtime/hashmap.go.html#1791774">h</a></span><span class="op" id="1791841">,</span>&nbsp;<span class="ident" id="1791843"><a href="/runtime/hashmap.go.html#1791783">key</a></span><span class="op" id="1791846">,</span>&nbsp;<span class="ident" id="1791848"><a href="/runtime/hashmap.go.html#1791803">val</a></span><span class="op" id="1791851">)</span><br>
<span class="lineno">920</span><span class="op" id="1791853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1791856">func</span>&nbsp;<span class="ident" id="1791861">reflect_mapdelete</span><span class="op" id="1791878">(</span><span class="ident" id="1791879">t</span>&nbsp;<span class="op" id="1791881">*</span><span class="ident" id="1791882"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1791889">,</span>&nbsp;<span class="ident" id="1791891">h</span>&nbsp;<span class="op" id="1791893">*</span><span class="ident" id="1791894"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1791898">,</span>&nbsp;<span class="ident" id="1791900">key</span>&nbsp;<span class="ident" id="1791904"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1791910">.</span><span class="ident" id="1791911">Pointer</span><span class="op" id="1791918">)</span>&nbsp;<span class="op" id="1791920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1791923"><a href="/runtime/hashmap.go.html#1779388">mapdelete</a></span><span class="op" id="1791932">(</span><span class="ident" id="1791933"><a href="/runtime/hashmap.go.html#1791879">t</a></span><span class="op" id="1791934">,</span>&nbsp;<span class="ident" id="1791936"><a href="/runtime/hashmap.go.html#1791891">h</a></span><span class="op" id="1791937">,</span>&nbsp;<span class="ident" id="1791939"><a href="/runtime/hashmap.go.html#1791900">key</a></span><span class="op" id="1791942">)</span><br>
<span class="lineno"></span><span class="op" id="1791944">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="1791947">func</span>&nbsp;<span class="ident" id="1791952">reflect_mapiterinit</span><span class="op" id="1791971">(</span><span class="ident" id="1791972">t</span>&nbsp;<span class="op" id="1791974">*</span><span class="ident" id="1791975"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2026121">maptype</a></span><span class="op" id="1791982">,</span>&nbsp;<span class="ident" id="1791984">h</span>&nbsp;<span class="op" id="1791986">*</span><span class="ident" id="1791987"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1791991">)</span>&nbsp;<span class="op" id="1791993">*</span><span class="ident" id="1791994"><a href="/runtime/hashmap.go.html#1769308">hiter</a></span>&nbsp;<span class="op" id="1792000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1792003">it</span>&nbsp;<span class="op" id="1792006">:=</span>&nbsp;<span class="builtinfunc" id="1792009">new</span><span class="op" id="1792012">(</span><span class="ident" id="1792013"><a href="/runtime/hashmap.go.html#1769308">hiter</a></span><span class="op" id="1792018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1792021"><a href="/runtime/hashmap.go.html#1780625">mapiterinit</a></span><span class="op" id="1792032">(</span><span class="ident" id="1792033"><a href="/runtime/hashmap.go.html#1791972">t</a></span><span class="op" id="1792034">,</span>&nbsp;<span class="ident" id="1792036"><a href="/runtime/hashmap.go.html#1791984">h</a></span><span class="op" id="1792037">,</span>&nbsp;<span class="ident" id="1792039"><a href="/runtime/hashmap.go.html#1792003">it</a></span><span class="op" id="1792041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1792044">return</span>&nbsp;<span class="ident" id="1792051"><a href="/runtime/hashmap.go.html#1792003">it</a></span><br>
<span class="lineno">930</span><span class="op" id="1792054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1792057">func</span>&nbsp;<span class="ident" id="1792062">reflect_mapiternext</span><span class="op" id="1792081">(</span><span class="ident" id="1792082">it</span>&nbsp;<span class="op" id="1792085">*</span><span class="ident" id="1792086"><a href="/runtime/hashmap.go.html#1769308">hiter</a></span><span class="op" id="1792091">)</span>&nbsp;<span class="op" id="1792093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1792096"><a href="/runtime/hashmap.go.html#1781803">mapiternext</a></span><span class="op" id="1792107">(</span><span class="ident" id="1792108"><a href="/runtime/hashmap.go.html#1792082">it</a></span><span class="op" id="1792110">)</span><br>
<span class="lineno"></span><span class="op" id="1792112">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="keyword" id="1792115">func</span>&nbsp;<span class="ident" id="1792120">reflect_mapiterkey</span><span class="op" id="1792138">(</span><span class="ident" id="1792139">it</span>&nbsp;<span class="op" id="1792142">*</span><span class="ident" id="1792143"><a href="/runtime/hashmap.go.html#1769308">hiter</a></span><span class="op" id="1792148">)</span>&nbsp;<span class="ident" id="1792150"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1792156">.</span><span class="ident" id="1792157">Pointer</span>&nbsp;<span class="op" id="1792165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1792168">return</span>&nbsp;<span class="ident" id="1792175"><a href="/runtime/hashmap.go.html#1792139">it</a></span><span class="op" id="1792177">.</span><span class="ident" id="1792178">key</span><br>
<span class="lineno"></span><span class="op" id="1792182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span><span class="keyword" id="1792185">func</span>&nbsp;<span class="ident" id="1792190">reflect_maplen</span><span class="op" id="1792204">(</span><span class="ident" id="1792205">h</span>&nbsp;<span class="op" id="1792207">*</span><span class="ident" id="1792208"><a href="/runtime/hashmap.go.html#1768119">hmap</a></span><span class="op" id="1792212">)</span>&nbsp;<span class="builtintype" id="1792214">int</span>&nbsp;<span class="op" id="1792218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1792221">if</span>&nbsp;<span class="ident" id="1792224"><a href="/runtime/hashmap.go.html#1792205">h</a></span>&nbsp;<span class="op" id="1792226">==</span>&nbsp;<span class="ident" id="1792229">nil</span>&nbsp;<span class="op" id="1792233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1792237">return</span>&nbsp;<span class="num" id="1792244">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1792247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1792250">if</span>&nbsp;<span class="ident" id="1792253"><a href="/runtime/race0.go.html#1906481">raceenabled</a></span>&nbsp;<span class="op" id="1792265">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1792269">callerpc</span>&nbsp;<span class="op" id="1792278">:=</span>&nbsp;<span class="ident" id="1792281"><a href="/runtime/stubs.go.html#1976364">getcallerpc</a></span><span class="op" id="1792292">(</span><span class="ident" id="1792293"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1792299">.</span><span class="ident" id="1792300">Pointer</span><span class="op" id="1792307">(</span><span class="op" id="1792308">&amp;</span><span class="ident" id="1792309"><a href="/runtime/hashmap.go.html#1792205">h</a></span><span class="op" id="1792310">)</span><span class="op" id="1792311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1792315"><a href="/runtime/race0.go.html#1907159">racereadpc</a></span><span class="op" id="1792325">(</span><span class="ident" id="1792326"><a href="/runtime/hashmap.go.html#1766365">unsafe</a></span><span class="op" id="1792332">.</span><span class="ident" id="1792333">Pointer</span><span class="op" id="1792340">(</span><span class="ident" id="1792341"><a href="/runtime/hashmap.go.html#1792205">h</a></span><span class="op" id="1792342">)</span><span class="op" id="1792343">,</span>&nbsp;<span class="ident" id="1792345"><a href="/runtime/hashmap.go.html#1792269">callerpc</a></span><span class="op" id="1792353">,</span>&nbsp;<span class="ident" id="1792355"><a href="/runtime/proc.go.html#1905425">funcPC</a></span><span class="op" id="1792361">(</span><span class="ident" id="1792362"><a href="/runtime/hashmap.go.html#1792190">reflect_maplen</a></span><span class="op" id="1792376">)</span><span class="op" id="1792377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1792380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1792383">return</span>&nbsp;<span class="ident" id="1792390"><a href="/runtime/hashmap.go.html#1792205">h</a></span><span class="op" id="1792391">.</span><span class="ident" id="1792392">count</span><br>
<span class="lineno"></span><span class="op" id="1792398">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="1792401">func</span>&nbsp;<span class="ident" id="1792406">reflect_ismapkey</span><span class="op" id="1792422">(</span><span class="ident" id="1792423">t</span>&nbsp;<span class="op" id="1792425">*</span><span class="ident" id="1792426"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2025572">_type</a></span><span class="op" id="1792431">)</span>&nbsp;<span class="builtintype" id="1792433">bool</span>&nbsp;<span class="op" id="1792438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1792441">return</span>&nbsp;<span class="ident" id="1792448"><a href="/runtime/hashmap.go.html#1791360">ismapkey</a></span><span class="op" id="1792456">(</span><span class="ident" id="1792457"><a href="/runtime/hashmap.go.html#1792423">t</a></span><span class="op" id="1792458">)</span><br>
<span class="lineno"></span><span class="op" id="1792460">}</span>
</div>
</body>
</html>
