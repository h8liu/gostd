<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8382474">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8382529">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8382583">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8382634">package</span>&nbsp;<span class="ident" id="8382642">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8382648">import</span>&nbsp;<span class="op" id="8382655">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8382658">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8382668">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8382671">var</span>&nbsp;<span class="ident" id="8382675">typeTests</span>&nbsp;<span class="op" id="8382685">=</span>&nbsp;<span class="ident" id="8382687">initMimeForTests</span><span class="op" id="8382703">(</span><span class="op" id="8382704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8382707">func</span>&nbsp;<span class="ident" id="8382712">TestTypeByExtension</span><span class="op" id="8382731">(</span><span class="ident" id="8382732">t</span>&nbsp;<span class="op" id="8382734">*</span><span class="ident" id="8382735">testing</span><span class="op" id="8382742">.</span><span class="ident" id="8382743">T</span><span class="op" id="8382744">)</span>&nbsp;<span class="op" id="8382746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382749">for</span>&nbsp;<span class="ident" id="8382753">ext</span><span class="op" id="8382756">,</span>&nbsp;<span class="ident" id="8382758">want</span>&nbsp;<span class="op" id="8382763">:=</span>&nbsp;<span class="keyword" id="8382766">range</span>&nbsp;<span class="ident" id="8382772">typeTests</span>&nbsp;<span class="op" id="8382782">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382786">val</span>&nbsp;<span class="op" id="8382790">:=</span>&nbsp;<span class="ident" id="8382793">TypeByExtension</span><span class="op" id="8382808">(</span><span class="ident" id="8382809">ext</span><span class="op" id="8382812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382816">if</span>&nbsp;<span class="ident" id="8382819">val</span>&nbsp;<span class="op" id="8382823">!=</span>&nbsp;<span class="ident" id="8382826">want</span>&nbsp;<span class="op" id="8382831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382836">t</span><span class="op" id="8382837">.</span><span class="ident" id="8382838">Errorf</span><span class="op" id="8382844">(</span><span class="string" id="8382845">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8382880">,</span>&nbsp;<span class="ident" id="8382882">ext</span><span class="op" id="8382885">,</span>&nbsp;<span class="ident" id="8382887">val</span><span class="op" id="8382890">,</span>&nbsp;<span class="ident" id="8382892">want</span><span class="op" id="8382896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382903">}</span><br>
<span class="lineno">20</span><span class="op" id="8382905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8382908">func</span>&nbsp;<span class="ident" id="8382913">TestTypeByExtensionCase</span><span class="op" id="8382936">(</span><span class="ident" id="8382937">t</span>&nbsp;<span class="op" id="8382939">*</span><span class="ident" id="8382940">testing</span><span class="op" id="8382947">.</span><span class="ident" id="8382948">T</span><span class="op" id="8382949">)</span>&nbsp;<span class="op" id="8382951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382954">const</span>&nbsp;<span class="ident" id="8382960">custom</span>&nbsp;<span class="op" id="8382967">=</span>&nbsp;<span class="string" id="8382969">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383002">const</span>&nbsp;<span class="ident" id="8383008">caps</span>&nbsp;<span class="op" id="8383013">=</span>&nbsp;<span class="string" id="8383015">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383041">if</span>&nbsp;<span class="ident" id="8383044">err</span>&nbsp;<span class="op" id="8383048">:=</span>&nbsp;<span class="ident" id="8383051">AddExtensionType</span><span class="op" id="8383067">(</span><span class="string" id="8383068">&#34;.TEST&#34;</span><span class="op" id="8383075">,</span>&nbsp;<span class="ident" id="8383077">caps</span><span class="op" id="8383081">)</span><span class="op" id="8383082">;</span>&nbsp;<span class="ident" id="8383084">err</span>&nbsp;<span class="op" id="8383088">!=</span>&nbsp;<span class="ident" id="8383091">nil</span>&nbsp;<span class="op" id="8383095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383099">t</span><span class="op" id="8383100">.</span><span class="ident" id="8383101">Fatalf</span><span class="op" id="8383107">(</span><span class="string" id="8383108">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="8383139">,</span>&nbsp;<span class="ident" id="8383141">err</span><span class="op" id="8383144">,</span>&nbsp;<span class="ident" id="8383146">custom</span><span class="op" id="8383152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383158">if</span>&nbsp;<span class="ident" id="8383161">err</span>&nbsp;<span class="op" id="8383165">:=</span>&nbsp;<span class="ident" id="8383168">AddExtensionType</span><span class="op" id="8383184">(</span><span class="string" id="8383185">&#34;.tesT&#34;</span><span class="op" id="8383192">,</span>&nbsp;<span class="ident" id="8383194">custom</span><span class="op" id="8383200">)</span><span class="op" id="8383201">;</span>&nbsp;<span class="ident" id="8383203">err</span>&nbsp;<span class="op" id="8383207">!=</span>&nbsp;<span class="ident" id="8383210">nil</span>&nbsp;<span class="op" id="8383214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383218">t</span><span class="op" id="8383219">.</span><span class="ident" id="8383220">Fatalf</span><span class="op" id="8383226">(</span><span class="string" id="8383227">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="8383258">,</span>&nbsp;<span class="ident" id="8383260">err</span><span class="op" id="8383263">,</span>&nbsp;<span class="ident" id="8383265">custom</span><span class="op" id="8383271">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8383278">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383304">if</span>&nbsp;<span class="ident" id="8383307">got</span>&nbsp;<span class="op" id="8383311">:=</span>&nbsp;<span class="ident" id="8383314">TypeByExtension</span><span class="op" id="8383329">(</span><span class="string" id="8383330">&#34;.tesT&#34;</span><span class="op" id="8383337">)</span><span class="op" id="8383338">;</span>&nbsp;<span class="ident" id="8383340">got</span>&nbsp;<span class="op" id="8383344">!=</span>&nbsp;<span class="ident" id="8383347">custom</span>&nbsp;<span class="op" id="8383354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383358">t</span><span class="op" id="8383359">.</span><span class="ident" id="8383360">Fatalf</span><span class="op" id="8383366">(</span><span class="string" id="8383367">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8383395">,</span>&nbsp;<span class="ident" id="8383397">got</span><span class="op" id="8383400">,</span>&nbsp;<span class="ident" id="8383402">custom</span><span class="op" id="8383408">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383414">if</span>&nbsp;<span class="ident" id="8383417">got</span>&nbsp;<span class="op" id="8383421">:=</span>&nbsp;<span class="ident" id="8383424">TypeByExtension</span><span class="op" id="8383439">(</span><span class="string" id="8383440">&#34;.TEST&#34;</span><span class="op" id="8383447">)</span><span class="op" id="8383448">;</span>&nbsp;<span class="ident" id="8383450">got</span>&nbsp;<span class="op" id="8383454">!=</span>&nbsp;<span class="ident" id="8383457">caps</span>&nbsp;<span class="op" id="8383462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383466">t</span><span class="op" id="8383467">.</span><span class="ident" id="8383468">Fatalf</span><span class="op" id="8383474">(</span><span class="string" id="8383475">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8383503">,</span>&nbsp;<span class="ident" id="8383505">got</span><span class="op" id="8383508">,</span>&nbsp;<span class="ident" id="8383510">caps</span><span class="op" id="8383514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8383521">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383542">if</span>&nbsp;<span class="ident" id="8383545">got</span>&nbsp;<span class="op" id="8383549">:=</span>&nbsp;<span class="ident" id="8383552">TypeByExtension</span><span class="op" id="8383567">(</span><span class="string" id="8383568">&#34;.TesT&#34;</span><span class="op" id="8383575">)</span><span class="op" id="8383576">;</span>&nbsp;<span class="ident" id="8383578">got</span>&nbsp;<span class="op" id="8383582">!=</span>&nbsp;<span class="ident" id="8383585">custom</span>&nbsp;<span class="op" id="8383592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383596">t</span><span class="op" id="8383597">.</span><span class="ident" id="8383598">Fatalf</span><span class="op" id="8383604">(</span><span class="string" id="8383605">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8383633">,</span>&nbsp;<span class="ident" id="8383635">got</span><span class="op" id="8383638">,</span>&nbsp;<span class="ident" id="8383640">custom</span><span class="op" id="8383646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383649">}</span><br>
<span class="lineno"></span><span class="op" id="8383651">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8383654">func</span>&nbsp;<span class="ident" id="8383659">TestLookupMallocs</span><span class="op" id="8383676">(</span><span class="ident" id="8383677">t</span>&nbsp;<span class="op" id="8383679">*</span><span class="ident" id="8383680">testing</span><span class="op" id="8383687">.</span><span class="ident" id="8383688">T</span><span class="op" id="8383689">)</span>&nbsp;<span class="op" id="8383691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383694">n</span>&nbsp;<span class="op" id="8383696">:=</span>&nbsp;<span class="ident" id="8383699">testing</span><span class="op" id="8383706">.</span><span class="ident" id="8383707">AllocsPerRun</span><span class="op" id="8383719">(</span><span class="num" id="8383720">10000</span><span class="op" id="8383725">,</span>&nbsp;<span class="keyword" id="8383727">func</span><span class="op" id="8383731">(</span><span class="op" id="8383732">)</span>&nbsp;<span class="op" id="8383734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383738">TypeByExtension</span><span class="op" id="8383753">(</span><span class="string" id="8383754">&#34;.html&#34;</span><span class="op" id="8383761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383765">TypeByExtension</span><span class="op" id="8383780">(</span><span class="string" id="8383781">&#34;.HtML&#34;</span><span class="op" id="8383788">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383791">}</span><span class="op" id="8383792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383795">if</span>&nbsp;<span class="ident" id="8383798">n</span>&nbsp;<span class="op" id="8383800">&gt;</span>&nbsp;<span class="num" id="8383802">0</span>&nbsp;<span class="op" id="8383804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383808">t</span><span class="op" id="8383809">.</span><span class="ident" id="8383810">Errorf</span><span class="op" id="8383816">(</span><span class="string" id="8383817">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="8383838">,</span>&nbsp;<span class="ident" id="8383840">n</span><span class="op" id="8383841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383844">}</span><br>
<span class="lineno"></span><span class="op" id="8383846">}</span>
</div>
</body>
</html>
