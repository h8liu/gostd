<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6585323">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6585379">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6585433">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6585484">package</span>&nbsp;<span class="ident" id="6585492">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6585502">import</span>&nbsp;<span class="op" id="6585509">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585512">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585524">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6585534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6585537">var</span>&nbsp;<span class="ident" id="6585541">toFromBigTests</span>&nbsp;<span class="op" id="6585556">=</span>&nbsp;<span class="op" id="6585558">[</span><span class="op" id="6585559">]</span><span class="builtintype" id="6585560">string</span><span class="op" id="6585566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585569">&#34;0&#34;</span><span class="op" id="6585572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585575">&#34;1&#34;</span><span class="op" id="6585578">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585581">&#34;23&#34;</span><span class="op" id="6585585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585588">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="6585646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6585649">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="6585707">,</span><br>
<span class="lineno"></span><span class="op" id="6585709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6585712">func</span>&nbsp;<span class="ident" id="6585717">p224AlternativeToBig</span><span class="op" id="6585737">(</span><span class="ident" id="6585738">in</span>&nbsp;<span class="op" id="6585741">*</span><span class="ident" id="6585742">p224FieldElement</span><span class="op" id="6585758">)</span>&nbsp;<span class="op" id="6585760">*</span><span class="ident" id="6585761">big</span><span class="op" id="6585764">.</span><span class="ident" id="6585765">Int</span>&nbsp;<span class="op" id="6585769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585772">ret</span>&nbsp;<span class="op" id="6585776">:=</span>&nbsp;<span class="builtinfunc" id="6585779">new</span><span class="op" id="6585782">(</span><span class="ident" id="6585783">big</span><span class="op" id="6585786">.</span><span class="ident" id="6585787">Int</span><span class="op" id="6585790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585793">tmp</span>&nbsp;<span class="op" id="6585797">:=</span>&nbsp;<span class="builtinfunc" id="6585800">new</span><span class="op" id="6585803">(</span><span class="ident" id="6585804">big</span><span class="op" id="6585807">.</span><span class="ident" id="6585808">Int</span><span class="op" id="6585811">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6585815">for</span>&nbsp;<span class="ident" id="6585819">i</span>&nbsp;<span class="op" id="6585821">:=</span>&nbsp;<span class="builtintype" id="6585824">uint</span><span class="op" id="6585828">(</span><span class="num" id="6585829">0</span><span class="op" id="6585830">)</span><span class="op" id="6585831">;</span>&nbsp;<span class="ident" id="6585833">i</span>&nbsp;<span class="op" id="6585835">&lt;</span>&nbsp;<span class="num" id="6585837">8</span><span class="op" id="6585838">;</span>&nbsp;<span class="ident" id="6585840">i</span><span class="op" id="6585841">++</span>&nbsp;<span class="op" id="6585844">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585848">tmp</span><span class="op" id="6585851">.</span><span class="ident" id="6585852">SetInt64</span><span class="op" id="6585860">(</span><span class="ident" id="6585861">int64</span><span class="op" id="6585866">(</span><span class="ident" id="6585867">in</span><span class="op" id="6585869">[</span><span class="ident" id="6585870">i</span><span class="op" id="6585871">]</span><span class="op" id="6585872">)</span><span class="op" id="6585873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585877">tmp</span><span class="op" id="6585880">.</span><span class="ident" id="6585881">Lsh</span><span class="op" id="6585884">(</span><span class="ident" id="6585885">tmp</span><span class="op" id="6585888">,</span>&nbsp;<span class="num" id="6585890">28</span><span class="op" id="6585892">*</span><span class="ident" id="6585893">i</span><span class="op" id="6585894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585898">ret</span><span class="op" id="6585901">.</span><span class="ident" id="6585902">Add</span><span class="op" id="6585905">(</span><span class="ident" id="6585906">ret</span><span class="op" id="6585909">,</span>&nbsp;<span class="ident" id="6585911">tmp</span><span class="op" id="6585914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6585917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6585920">ret</span><span class="op" id="6585923">.</span><span class="ident" id="6585924">Mod</span><span class="op" id="6585927">(</span><span class="ident" id="6585928">ret</span><span class="op" id="6585931">,</span>&nbsp;<span class="ident" id="6585933">p224</span><span class="op" id="6585937">.</span><span class="ident" id="6585938">P</span><span class="op" id="6585939">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6585942">return</span>&nbsp;<span class="ident" id="6585949">ret</span><br>
<span class="lineno"></span><span class="op" id="6585953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6585956">func</span>&nbsp;<span class="ident" id="6585961">TestToFromBig</span><span class="op" id="6585974">(</span><span class="ident" id="6585975">t</span>&nbsp;<span class="op" id="6585977">*</span><span class="ident" id="6585978">testing</span><span class="op" id="6585985">.</span><span class="ident" id="6585986">T</span><span class="op" id="6585987">)</span>&nbsp;<span class="op" id="6585989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6585992">for</span>&nbsp;<span class="ident" id="6585996">i</span><span class="op" id="6585997">,</span>&nbsp;<span class="ident" id="6585999">test</span>&nbsp;<span class="op" id="6586004">:=</span>&nbsp;<span class="keyword" id="6586007">range</span>&nbsp;<span class="ident" id="6586013">toFromBigTests</span>&nbsp;<span class="op" id="6586028">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586032">n</span><span class="op" id="6586033">,</span>&nbsp;<span class="ident" id="6586035">_</span>&nbsp;<span class="op" id="6586037">:=</span>&nbsp;<span class="builtinfunc" id="6586040">new</span><span class="op" id="6586043">(</span><span class="ident" id="6586044">big</span><span class="op" id="6586047">.</span><span class="ident" id="6586048">Int</span><span class="op" id="6586051">)</span><span class="op" id="6586052">.</span><span class="ident" id="6586053">SetString</span><span class="op" id="6586062">(</span><span class="ident" id="6586063">test</span><span class="op" id="6586067">,</span>&nbsp;<span class="num" id="6586069">16</span><span class="op" id="6586071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586075">var</span>&nbsp;<span class="ident" id="6586079">x</span>&nbsp;<span class="ident" id="6586081">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586100">p224FromBig</span><span class="op" id="6586111">(</span><span class="op" id="6586112">&amp;</span><span class="ident" id="6586113">x</span><span class="op" id="6586114">,</span>&nbsp;<span class="ident" id="6586116">n</span><span class="op" id="6586117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586121">m</span>&nbsp;<span class="op" id="6586123">:=</span>&nbsp;<span class="ident" id="6586126">p224ToBig</span><span class="op" id="6586135">(</span><span class="op" id="6586136">&amp;</span><span class="ident" id="6586137">x</span><span class="op" id="6586138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586142">if</span>&nbsp;<span class="ident" id="6586145">n</span><span class="op" id="6586146">.</span><span class="ident" id="6586147">Cmp</span><span class="op" id="6586150">(</span><span class="ident" id="6586151">m</span><span class="op" id="6586152">)</span>&nbsp;<span class="op" id="6586154">!=</span>&nbsp;<span class="num" id="6586157">0</span>&nbsp;<span class="op" id="6586159">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586164">t</span><span class="op" id="6586165">.</span><span class="ident" id="6586166">Errorf</span><span class="op" id="6586172">(</span><span class="string" id="6586173">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="6586188">,</span>&nbsp;<span class="ident" id="6586190">i</span><span class="op" id="6586191">,</span>&nbsp;<span class="ident" id="6586193">n</span><span class="op" id="6586194">,</span>&nbsp;<span class="ident" id="6586196">m</span><span class="op" id="6586197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586205">q</span>&nbsp;<span class="op" id="6586207">:=</span>&nbsp;<span class="ident" id="6586210">p224AlternativeToBig</span><span class="op" id="6586230">(</span><span class="op" id="6586231">&amp;</span><span class="ident" id="6586232">x</span><span class="op" id="6586233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6586237">if</span>&nbsp;<span class="ident" id="6586240">n</span><span class="op" id="6586241">.</span><span class="ident" id="6586242">Cmp</span><span class="op" id="6586245">(</span><span class="ident" id="6586246">q</span><span class="op" id="6586247">)</span>&nbsp;<span class="op" id="6586249">!=</span>&nbsp;<span class="num" id="6586252">0</span>&nbsp;<span class="op" id="6586254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6586259">t</span><span class="op" id="6586260">.</span><span class="ident" id="6586261">Errorf</span><span class="op" id="6586267">(</span><span class="string" id="6586268">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="6586297">,</span>&nbsp;<span class="ident" id="6586299">i</span><span class="op" id="6586300">,</span>&nbsp;<span class="ident" id="6586302">n</span><span class="op" id="6586303">,</span>&nbsp;<span class="ident" id="6586305">m</span><span class="op" id="6586306">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6586313">}</span><br>
<span class="lineno"></span><span class="op" id="6586315">}</span>
</div>
</body>
</html>
