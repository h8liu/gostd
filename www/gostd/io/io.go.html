<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html" class="current">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1378077">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1378132">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1378186">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1378237">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1378296">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1378371">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1378438">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1378505">//</span><br>
<span class="lineno">10</span><span class="comment" id="1378508">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1378584">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1378657">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1378705">package</span>&nbsp;<span class="ident" id="1378713">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1378717">import</span>&nbsp;<span class="op" id="1378724">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1378727">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1378736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1378739">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1378811">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1378854">var</span>&nbsp;<span class="ident" id="1378858">ErrShortWrite</span>&nbsp;<span class="op" id="1378872">=</span>&nbsp;<span class="ident" id="1378874">errors</span><span class="op" id="1378880">.</span><span class="ident" id="1378881">New</span><span class="op" id="1378884">(</span><span class="string" id="1378885">&#34;short&nbsp;write&#34;</span><span class="op" id="1378898">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1378901">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1378981">var</span>&nbsp;<span class="ident" id="1378985">ErrShortBuffer</span>&nbsp;<span class="op" id="1379000">=</span>&nbsp;<span class="ident" id="1379002">errors</span><span class="op" id="1379008">.</span><span class="ident" id="1379009">New</span><span class="op" id="1379012">(</span><span class="string" id="1379013">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1379027">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1379030">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1379100">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1379171">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1379234">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1379306">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1379329">var</span>&nbsp;<span class="ident" id="1379333">EOF</span>&nbsp;<span class="op" id="1379337">=</span>&nbsp;<span class="ident" id="1379339">errors</span><span class="op" id="1379345">.</span><span class="ident" id="1379346">New</span><span class="op" id="1379349">(</span><span class="string" id="1379350">&#34;EOF&#34;</span><span class="op" id="1379355">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1379358">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1379416">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1379475">var</span>&nbsp;<span class="ident" id="1379479">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1379496">=</span>&nbsp;<span class="ident" id="1379498">errors</span><span class="op" id="1379504">.</span><span class="ident" id="1379505">New</span><span class="op" id="1379508">(</span><span class="string" id="1379509">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1379525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1379528">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1379594">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1379657">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1379715">var</span>&nbsp;<span class="ident" id="1379719">ErrNoProgress</span>&nbsp;<span class="op" id="1379733">=</span>&nbsp;<span class="ident" id="1379735">errors</span><span class="op" id="1379741">.</span><span class="ident" id="1379742">New</span><span class="op" id="1379745">(</span><span class="string" id="1379746">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1379791">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1379794">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1379855">//</span><br>
<span class="lineno"></span><span class="comment" id="1379858">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1379931">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1379999">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1380076">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1380147">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1380205">//</span><br>
<span class="lineno">50</span><span class="comment" id="1380208">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1380272">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1380334">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1380403">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1380463">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1380526">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1380591">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1380656">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1380685">//</span><br>
<span class="lineno"></span><span class="comment" id="1380688">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1380753">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1380822">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1380883">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1380909">//</span><br>
<span class="lineno"></span><span class="comment" id="1380912">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1380972">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1381034">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1381099">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1381160">//</span><br>
<span class="lineno"></span><span class="comment" id="1381163">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1381201">type</span>&nbsp;<span class="ident" id="1381206">Reader</span>&nbsp;<span class="keyword" id="1381213">interface</span>&nbsp;<span class="op" id="1381223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1381226">Read</span><span class="op" id="1381230">(</span><span class="ident" id="1381231">p</span>&nbsp;<span class="op" id="1381233">[</span><span class="op" id="1381234">]</span><span class="builtintype" id="1381235">byte</span><span class="op" id="1381239">)</span>&nbsp;<span class="op" id="1381241">(</span><span class="ident" id="1381242">n</span>&nbsp;<span class="builtintype" id="1381244">int</span><span class="op" id="1381247">,</span>&nbsp;<span class="ident" id="1381249">err</span>&nbsp;<span class="builtintype" id="1381253">error</span><span class="op" id="1381258">)</span><br>
<span class="lineno"></span><span class="op" id="1381260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1381263">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1381325">//</span><br>
<span class="lineno"></span><span class="comment" id="1381328">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1381395">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1381463">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1381529">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1381592">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1381651">//</span><br>
<span class="lineno"></span><span class="comment" id="1381654">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1381692">type</span>&nbsp;<span class="ident" id="1381697">Writer</span>&nbsp;<span class="keyword" id="1381704">interface</span>&nbsp;<span class="op" id="1381714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1381717">Write</span><span class="op" id="1381722">(</span><span class="ident" id="1381723">p</span>&nbsp;<span class="op" id="1381725">[</span><span class="op" id="1381726">]</span><span class="builtintype" id="1381727">byte</span><span class="op" id="1381731">)</span>&nbsp;<span class="op" id="1381733">(</span><span class="ident" id="1381734">n</span>&nbsp;<span class="builtintype" id="1381736">int</span><span class="op" id="1381739">,</span>&nbsp;<span class="ident" id="1381741">err</span>&nbsp;<span class="builtintype" id="1381745">error</span><span class="op" id="1381750">)</span><br>
<span class="lineno">85</span><span class="op" id="1381752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1381755">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1381817">//</span><br>
<span class="lineno"></span><span class="comment" id="1381820">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1381880">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1381941">type</span>&nbsp;<span class="ident" id="1381946">Closer</span>&nbsp;<span class="keyword" id="1381953">interface</span>&nbsp;<span class="op" id="1381963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1381966">Close</span><span class="op" id="1381971">(</span><span class="op" id="1381972">)</span>&nbsp;<span class="builtintype" id="1381974">error</span><br>
<span class="lineno"></span><span class="op" id="1381980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1381983">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1382044">//</span><br>
<span class="lineno"></span><span class="comment" id="1382047">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1382109">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1382179">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1382244">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1382314">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1382322">//</span><br>
<span class="lineno"></span><span class="comment" id="1382325">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1382394">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1382463">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1382517">type</span>&nbsp;<span class="ident" id="1382522">Seeker</span>&nbsp;<span class="keyword" id="1382529">interface</span>&nbsp;<span class="op" id="1382539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1382542">Seek</span><span class="op" id="1382546">(</span><span class="ident" id="1382547">offset</span>&nbsp;<span class="ident" id="1382554">int64</span><span class="op" id="1382559">,</span>&nbsp;<span class="ident" id="1382561">whence</span>&nbsp;<span class="builtintype" id="1382568">int</span><span class="op" id="1382571">)</span>&nbsp;<span class="op" id="1382573">(</span><span class="ident" id="1382574">int64</span><span class="op" id="1382579">,</span>&nbsp;<span class="builtintype" id="1382581">error</span><span class="op" id="1382586">)</span><br>
<span class="lineno"></span><span class="op" id="1382588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1382591">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1382668">type</span>&nbsp;<span class="ident" id="1382673">ReadWriter</span>&nbsp;<span class="keyword" id="1382684">interface</span>&nbsp;<span class="op" id="1382694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1382697">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1382705">Writer</span><br>
<span class="lineno"></span><span class="op" id="1382712">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1382715">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1382792">type</span>&nbsp;<span class="ident" id="1382797">ReadCloser</span>&nbsp;<span class="keyword" id="1382808">interface</span>&nbsp;<span class="op" id="1382818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1382821">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1382829">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1382836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1382839">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1382918">type</span>&nbsp;<span class="ident" id="1382923">WriteCloser</span>&nbsp;<span class="keyword" id="1382935">interface</span>&nbsp;<span class="op" id="1382945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1382948">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1382956">Closer</span><br>
<span class="lineno"></span><span class="op" id="1382963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1382966">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1383055">type</span>&nbsp;<span class="ident" id="1383060">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1383076">interface</span>&nbsp;<span class="op" id="1383086">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383089">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383097">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383105">Closer</span><br>
<span class="lineno"></span><span class="op" id="1383112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1383115">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1383191">type</span>&nbsp;<span class="ident" id="1383196">ReadSeeker</span>&nbsp;<span class="keyword" id="1383207">interface</span>&nbsp;<span class="op" id="1383217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383220">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383228">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1383235">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1383238">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1383316">type</span>&nbsp;<span class="ident" id="1383321">WriteSeeker</span>&nbsp;<span class="keyword" id="1383333">interface</span>&nbsp;<span class="op" id="1383343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383346">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383354">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1383361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1383364">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1383452">type</span>&nbsp;<span class="ident" id="1383457">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1383473">interface</span>&nbsp;<span class="op" id="1383483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383486">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383494">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383502">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1383509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1383512">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1383575">//</span><br>
<span class="lineno"></span><span class="comment" id="1383578">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1383628">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1383679">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1383752">//</span><br>
<span class="lineno">160</span><span class="comment" id="1383755">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1383806">type</span>&nbsp;<span class="ident" id="1383811">ReaderFrom</span>&nbsp;<span class="keyword" id="1383822">interface</span>&nbsp;<span class="op" id="1383832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1383835">ReadFrom</span><span class="op" id="1383843">(</span><span class="ident" id="1383844">r</span>&nbsp;<span class="ident" id="1383846">Reader</span><span class="op" id="1383852">)</span>&nbsp;<span class="op" id="1383854">(</span><span class="ident" id="1383855">n</span>&nbsp;<span class="ident" id="1383857">int64</span><span class="op" id="1383862">,</span>&nbsp;<span class="ident" id="1383864">err</span>&nbsp;<span class="builtintype" id="1383868">error</span><span class="op" id="1383873">)</span><br>
<span class="lineno"></span><span class="op" id="1383875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1383878">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1383938">//</span><br>
<span class="lineno"></span><span class="comment" id="1383941">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1384008">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1384075">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1384144">//</span><br>
<span class="lineno"></span><span class="comment" id="1384147">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1384196">type</span>&nbsp;<span class="ident" id="1384201">WriterTo</span>&nbsp;<span class="keyword" id="1384210">interface</span>&nbsp;<span class="op" id="1384220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1384223">WriteTo</span><span class="op" id="1384230">(</span><span class="ident" id="1384231">w</span>&nbsp;<span class="ident" id="1384233">Writer</span><span class="op" id="1384239">)</span>&nbsp;<span class="op" id="1384241">(</span><span class="ident" id="1384242">n</span>&nbsp;<span class="ident" id="1384244">int64</span><span class="op" id="1384249">,</span>&nbsp;<span class="ident" id="1384251">err</span>&nbsp;<span class="builtintype" id="1384255">error</span><span class="op" id="1384260">)</span><br>
<span class="lineno"></span><span class="op" id="1384262">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1384265">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1384330">//</span><br>
<span class="lineno"></span><span class="comment" id="1384333">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1384399">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1384459">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1384513">//</span><br>
<span class="lineno"></span><span class="comment" id="1384516">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1384578">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1384644">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1384677">//</span><br>
<span class="lineno"></span><span class="comment" id="1384680">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1384749">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1384824">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1384900">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1384950">//</span><br>
<span class="lineno"></span><span class="comment" id="1384953">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1385021">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1385089">//</span><br>
<span class="lineno"></span><span class="comment" id="1385092">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1385157">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1385219">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1385235">//</span><br>
<span class="lineno"></span><span class="comment" id="1385238">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1385300">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1385322">//</span><br>
<span class="lineno"></span><span class="comment" id="1385325">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1385363">type</span>&nbsp;<span class="ident" id="1385368">ReaderAt</span>&nbsp;<span class="keyword" id="1385377">interface</span>&nbsp;<span class="op" id="1385387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1385390">ReadAt</span><span class="op" id="1385396">(</span><span class="ident" id="1385397">p</span>&nbsp;<span class="op" id="1385399">[</span><span class="op" id="1385400">]</span><span class="builtintype" id="1385401">byte</span><span class="op" id="1385405">,</span>&nbsp;<span class="ident" id="1385407">off</span>&nbsp;<span class="ident" id="1385411">int64</span><span class="op" id="1385416">)</span>&nbsp;<span class="op" id="1385418">(</span><span class="ident" id="1385419">n</span>&nbsp;<span class="builtintype" id="1385421">int</span><span class="op" id="1385424">,</span>&nbsp;<span class="ident" id="1385426">err</span>&nbsp;<span class="builtintype" id="1385430">error</span><span class="op" id="1385435">)</span><br>
<span class="lineno"></span><span class="op" id="1385437">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1385440">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1385506">//</span><br>
<span class="lineno"></span><span class="comment" id="1385509">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1385577">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1385661">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1385727">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1385792">//</span><br>
<span class="lineno"></span><span class="comment" id="1385795">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1385857">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1385920">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1385936">//</span><br>
<span class="lineno"></span><span class="comment" id="1385939">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1386008">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1386053">//</span><br>
<span class="lineno">220</span><span class="comment" id="1386056">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1386094">type</span>&nbsp;<span class="ident" id="1386099">WriterAt</span>&nbsp;<span class="keyword" id="1386108">interface</span>&nbsp;<span class="op" id="1386118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1386121">WriteAt</span><span class="op" id="1386128">(</span><span class="ident" id="1386129">p</span>&nbsp;<span class="op" id="1386131">[</span><span class="op" id="1386132">]</span><span class="builtintype" id="1386133">byte</span><span class="op" id="1386137">,</span>&nbsp;<span class="ident" id="1386139">off</span>&nbsp;<span class="ident" id="1386143">int64</span><span class="op" id="1386148">)</span>&nbsp;<span class="op" id="1386150">(</span><span class="ident" id="1386151">n</span>&nbsp;<span class="builtintype" id="1386153">int</span><span class="op" id="1386156">,</span>&nbsp;<span class="ident" id="1386158">err</span>&nbsp;<span class="builtintype" id="1386162">error</span><span class="op" id="1386167">)</span><br>
<span class="lineno"></span><span class="op" id="1386169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1386172">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1386235">//</span><br>
<span class="lineno"></span><span class="comment" id="1386238">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1386298">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1386343">type</span>&nbsp;<span class="ident" id="1386348">ByteReader</span>&nbsp;<span class="keyword" id="1386359">interface</span>&nbsp;<span class="op" id="1386369">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1386372">ReadByte</span><span class="op" id="1386380">(</span><span class="op" id="1386381">)</span>&nbsp;<span class="op" id="1386383">(</span><span class="ident" id="1386384">c</span>&nbsp;<span class="builtintype" id="1386386">byte</span><span class="op" id="1386390">,</span>&nbsp;<span class="ident" id="1386392">err</span>&nbsp;<span class="builtintype" id="1386396">error</span><span class="op" id="1386401">)</span><br>
<span class="lineno"></span><span class="op" id="1386403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1386406">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1386477">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1386503">//</span><br>
<span class="lineno"></span><span class="comment" id="1386506">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1386577">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1386614">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1386684">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1386705">type</span>&nbsp;<span class="ident" id="1386710">ByteScanner</span>&nbsp;<span class="keyword" id="1386722">interface</span>&nbsp;<span class="op" id="1386732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1386735">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1386747">UnreadByte</span><span class="op" id="1386757">(</span><span class="op" id="1386758">)</span>&nbsp;<span class="builtintype" id="1386760">error</span><br>
<span class="lineno"></span><span class="op" id="1386766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1386769">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1386833">type</span>&nbsp;<span class="ident" id="1386838">ByteWriter</span>&nbsp;<span class="keyword" id="1386849">interface</span>&nbsp;<span class="op" id="1386859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1386862">WriteByte</span><span class="op" id="1386871">(</span><span class="ident" id="1386872">c</span>&nbsp;<span class="builtintype" id="1386874">byte</span><span class="op" id="1386878">)</span>&nbsp;<span class="builtintype" id="1386880">error</span><br>
<span class="lineno"></span><span class="op" id="1386886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1386889">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1386952">//</span><br>
<span class="lineno"></span><span class="comment" id="1386955">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1387014">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1387080">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1387111">type</span>&nbsp;<span class="ident" id="1387116">RuneReader</span>&nbsp;<span class="keyword" id="1387127">interface</span>&nbsp;<span class="op" id="1387137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1387140">ReadRune</span><span class="op" id="1387148">(</span><span class="op" id="1387149">)</span>&nbsp;<span class="op" id="1387151">(</span><span class="ident" id="1387152">r</span>&nbsp;<span class="builtintype" id="1387154">rune</span><span class="op" id="1387158">,</span>&nbsp;<span class="ident" id="1387160">size</span>&nbsp;<span class="builtintype" id="1387165">int</span><span class="op" id="1387168">,</span>&nbsp;<span class="ident" id="1387170">err</span>&nbsp;<span class="builtintype" id="1387174">error</span><span class="op" id="1387179">)</span><br>
<span class="lineno"></span><span class="op" id="1387181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1387184">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1387255">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1387281">//</span><br>
<span class="lineno"></span><span class="comment" id="1387284">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1387355">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1387392">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1387462">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1387483">type</span>&nbsp;<span class="ident" id="1387488">RuneScanner</span>&nbsp;<span class="keyword" id="1387500">interface</span>&nbsp;<span class="op" id="1387510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1387513">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1387525">UnreadRune</span><span class="op" id="1387535">(</span><span class="op" id="1387536">)</span>&nbsp;<span class="builtintype" id="1387538">error</span><br>
<span class="lineno"></span><span class="op" id="1387544">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1387547">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1387615">type</span>&nbsp;<span class="ident" id="1387620">stringWriter</span>&nbsp;<span class="keyword" id="1387633">interface</span>&nbsp;<span class="op" id="1387643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1387646">WriteString</span><span class="op" id="1387657">(</span><span class="ident" id="1387658">s</span>&nbsp;<span class="builtintype" id="1387660">string</span><span class="op" id="1387666">)</span>&nbsp;<span class="op" id="1387668">(</span><span class="ident" id="1387669">n</span>&nbsp;<span class="builtintype" id="1387671">int</span><span class="op" id="1387674">,</span>&nbsp;<span class="ident" id="1387676">err</span>&nbsp;<span class="builtintype" id="1387680">error</span><span class="op" id="1387685">)</span><br>
<span class="lineno"></span><span class="op" id="1387687">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1387690">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1387780">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1387853">func</span>&nbsp;<span class="ident" id="1387858">WriteString</span><span class="op" id="1387869">(</span><span class="ident" id="1387870">w</span>&nbsp;<span class="ident" id="1387872">Writer</span><span class="op" id="1387878">,</span>&nbsp;<span class="ident" id="1387880">s</span>&nbsp;<span class="builtintype" id="1387882">string</span><span class="op" id="1387888">)</span>&nbsp;<span class="op" id="1387890">(</span><span class="ident" id="1387891">n</span>&nbsp;<span class="builtintype" id="1387893">int</span><span class="op" id="1387896">,</span>&nbsp;<span class="ident" id="1387898">err</span>&nbsp;<span class="builtintype" id="1387902">error</span><span class="op" id="1387907">)</span>&nbsp;<span class="op" id="1387909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1387912">if</span>&nbsp;<span class="ident" id="1387915">sw</span><span class="op" id="1387917">,</span>&nbsp;<span class="ident" id="1387919">ok</span>&nbsp;<span class="op" id="1387922">:=</span>&nbsp;<span class="ident" id="1387925">w</span><span class="op" id="1387926">.</span><span class="op" id="1387927">(</span><span class="ident" id="1387928">stringWriter</span><span class="op" id="1387940">)</span><span class="op" id="1387941">;</span>&nbsp;<span class="ident" id="1387943">ok</span>&nbsp;<span class="op" id="1387946">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1387950">return</span>&nbsp;<span class="ident" id="1387957">sw</span><span class="op" id="1387959">.</span><span class="ident" id="1387960">WriteString</span><span class="op" id="1387971">(</span><span class="ident" id="1387972">s</span><span class="op" id="1387973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1387976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1387979">return</span>&nbsp;<span class="ident" id="1387986">w</span><span class="op" id="1387987">.</span><span class="ident" id="1387988">Write</span><span class="op" id="1387993">(</span><span class="op" id="1387994">[</span><span class="op" id="1387995">]</span><span class="builtintype" id="1387996">byte</span><span class="op" id="1388000">(</span><span class="ident" id="1388001">s</span><span class="op" id="1388002">)</span><span class="op" id="1388003">)</span><br>
<span class="lineno"></span><span class="op" id="1388005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1388008">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1388083">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1388163">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1388211">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1388268">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1388309">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1388390">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1388440">func</span>&nbsp;<span class="ident" id="1388445">ReadAtLeast</span><span class="op" id="1388456">(</span><span class="ident" id="1388457">r</span>&nbsp;<span class="ident" id="1388459">Reader</span><span class="op" id="1388465">,</span>&nbsp;<span class="ident" id="1388467">buf</span>&nbsp;<span class="op" id="1388471">[</span><span class="op" id="1388472">]</span><span class="builtintype" id="1388473">byte</span><span class="op" id="1388477">,</span>&nbsp;<span class="ident" id="1388479">min</span>&nbsp;<span class="builtintype" id="1388483">int</span><span class="op" id="1388486">)</span>&nbsp;<span class="op" id="1388488">(</span><span class="ident" id="1388489">n</span>&nbsp;<span class="builtintype" id="1388491">int</span><span class="op" id="1388494">,</span>&nbsp;<span class="ident" id="1388496">err</span>&nbsp;<span class="builtintype" id="1388500">error</span><span class="op" id="1388505">)</span>&nbsp;<span class="op" id="1388507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1388510">if</span>&nbsp;<span class="builtinfunc" id="1388513">len</span><span class="op" id="1388516">(</span><span class="ident" id="1388517">buf</span><span class="op" id="1388520">)</span>&nbsp;<span class="op" id="1388522">&lt;</span>&nbsp;<span class="ident" id="1388524">min</span>&nbsp;<span class="op" id="1388528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1388532">return</span>&nbsp;<span class="num" id="1388539">0</span><span class="op" id="1388540">,</span>&nbsp;<span class="ident" id="1388542">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1388558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1388561">for</span>&nbsp;<span class="ident" id="1388565">n</span>&nbsp;<span class="op" id="1388567">&lt;</span>&nbsp;<span class="ident" id="1388569">min</span>&nbsp;<span class="op" id="1388573">&amp;&amp;</span>&nbsp;<span class="ident" id="1388576">err</span>&nbsp;<span class="op" id="1388580">==</span>&nbsp;<span class="builtintype" id="1388583">nil</span>&nbsp;<span class="op" id="1388587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1388591">var</span>&nbsp;<span class="ident" id="1388595">nn</span>&nbsp;<span class="builtintype" id="1388598">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388604">nn</span><span class="op" id="1388606">,</span>&nbsp;<span class="ident" id="1388608">err</span>&nbsp;<span class="op" id="1388612">=</span>&nbsp;<span class="ident" id="1388614">r</span><span class="op" id="1388615">.</span><span class="ident" id="1388616">Read</span><span class="op" id="1388620">(</span><span class="ident" id="1388621">buf</span><span class="op" id="1388624">[</span><span class="ident" id="1388625">n</span><span class="op" id="1388626">:</span><span class="op" id="1388627">]</span><span class="op" id="1388628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388632">n</span>&nbsp;<span class="op" id="1388634">+=</span>&nbsp;<span class="ident" id="1388637">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1388641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1388644">if</span>&nbsp;<span class="ident" id="1388647">n</span>&nbsp;<span class="op" id="1388649">&gt;=</span>&nbsp;<span class="ident" id="1388652">min</span>&nbsp;<span class="op" id="1388656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388660">err</span>&nbsp;<span class="op" id="1388664">=</span>&nbsp;<span class="builtintype" id="1388666">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1388671">}</span>&nbsp;<span class="keyword" id="1388673">else</span>&nbsp;<span class="keyword" id="1388678">if</span>&nbsp;<span class="ident" id="1388681">n</span>&nbsp;<span class="op" id="1388683">&gt;</span>&nbsp;<span class="num" id="1388685">0</span>&nbsp;<span class="op" id="1388687">&amp;&amp;</span>&nbsp;<span class="ident" id="1388690">err</span>&nbsp;<span class="op" id="1388694">==</span>&nbsp;<span class="ident" id="1388697">EOF</span>&nbsp;<span class="op" id="1388701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388705">err</span>&nbsp;<span class="op" id="1388709">=</span>&nbsp;<span class="ident" id="1388711">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1388729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1388732">return</span><br>
<span class="lineno"></span><span class="op" id="1388739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1388742">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1388800">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1388880">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1388928">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1388991">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1389029">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1389084">func</span>&nbsp;<span class="ident" id="1389089">ReadFull</span><span class="op" id="1389097">(</span><span class="ident" id="1389098">r</span>&nbsp;<span class="ident" id="1389100">Reader</span><span class="op" id="1389106">,</span>&nbsp;<span class="ident" id="1389108">buf</span>&nbsp;<span class="op" id="1389112">[</span><span class="op" id="1389113">]</span><span class="builtintype" id="1389114">byte</span><span class="op" id="1389118">)</span>&nbsp;<span class="op" id="1389120">(</span><span class="ident" id="1389121">n</span>&nbsp;<span class="builtintype" id="1389123">int</span><span class="op" id="1389126">,</span>&nbsp;<span class="ident" id="1389128">err</span>&nbsp;<span class="builtintype" id="1389132">error</span><span class="op" id="1389137">)</span>&nbsp;<span class="op" id="1389139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1389142">return</span>&nbsp;<span class="ident" id="1389149">ReadAtLeast</span><span class="op" id="1389160">(</span><span class="ident" id="1389161">r</span><span class="op" id="1389162">,</span>&nbsp;<span class="ident" id="1389164">buf</span><span class="op" id="1389167">,</span>&nbsp;<span class="builtinfunc" id="1389169">len</span><span class="op" id="1389172">(</span><span class="ident" id="1389173">buf</span><span class="op" id="1389176">)</span><span class="op" id="1389177">)</span><br>
<span class="lineno"></span><span class="op" id="1389179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1389182">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1389243">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1389301">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1389337">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1389391">//</span><br>
<span class="lineno"></span><span class="comment" id="1389394">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1389441">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1389478">func</span>&nbsp;<span class="ident" id="1389483">CopyN</span><span class="op" id="1389488">(</span><span class="ident" id="1389489">dst</span>&nbsp;<span class="ident" id="1389493">Writer</span><span class="op" id="1389499">,</span>&nbsp;<span class="ident" id="1389501">src</span>&nbsp;<span class="ident" id="1389505">Reader</span><span class="op" id="1389511">,</span>&nbsp;<span class="ident" id="1389513">n</span>&nbsp;<span class="ident" id="1389515">int64</span><span class="op" id="1389520">)</span>&nbsp;<span class="op" id="1389522">(</span><span class="ident" id="1389523">written</span>&nbsp;<span class="ident" id="1389531">int64</span><span class="op" id="1389536">,</span>&nbsp;<span class="ident" id="1389538">err</span>&nbsp;<span class="builtintype" id="1389542">error</span><span class="op" id="1389547">)</span>&nbsp;<span class="op" id="1389549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389552">written</span><span class="op" id="1389559">,</span>&nbsp;<span class="ident" id="1389561">err</span>&nbsp;<span class="op" id="1389565">=</span>&nbsp;<span class="ident" id="1389567">Copy</span><span class="op" id="1389571">(</span><span class="ident" id="1389572">dst</span><span class="op" id="1389575">,</span>&nbsp;<span class="ident" id="1389577">LimitReader</span><span class="op" id="1389588">(</span><span class="ident" id="1389589">src</span><span class="op" id="1389592">,</span>&nbsp;<span class="ident" id="1389594">n</span><span class="op" id="1389595">)</span><span class="op" id="1389596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1389599">if</span>&nbsp;<span class="ident" id="1389602">written</span>&nbsp;<span class="op" id="1389610">==</span>&nbsp;<span class="ident" id="1389613">n</span>&nbsp;<span class="op" id="1389615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1389619">return</span>&nbsp;<span class="ident" id="1389626">n</span><span class="op" id="1389627">,</span>&nbsp;<span class="builtintype" id="1389629">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1389634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1389637">if</span>&nbsp;<span class="ident" id="1389640">written</span>&nbsp;<span class="op" id="1389648">&lt;</span>&nbsp;<span class="ident" id="1389650">n</span>&nbsp;<span class="op" id="1389652">&amp;&amp;</span>&nbsp;<span class="ident" id="1389655">err</span>&nbsp;<span class="op" id="1389659">==</span>&nbsp;<span class="builtintype" id="1389662">nil</span>&nbsp;<span class="op" id="1389666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1389670">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1389714">err</span>&nbsp;<span class="op" id="1389718">=</span>&nbsp;<span class="ident" id="1389720">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1389725">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1389728">return</span><br>
<span class="lineno"></span><span class="op" id="1389735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1389738">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1389797">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1389859">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1389924">//</span><br>
<span class="lineno"></span><span class="comment" id="1389927">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1389984">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1390047">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1390105">//</span><br>
<span class="lineno"></span><span class="comment" id="1390108">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1390153">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1390209">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1390267">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1390324">func</span>&nbsp;<span class="ident" id="1390329">Copy</span><span class="op" id="1390333">(</span><span class="ident" id="1390334">dst</span>&nbsp;<span class="ident" id="1390338">Writer</span><span class="op" id="1390344">,</span>&nbsp;<span class="ident" id="1390346">src</span>&nbsp;<span class="ident" id="1390350">Reader</span><span class="op" id="1390356">)</span>&nbsp;<span class="op" id="1390358">(</span><span class="ident" id="1390359">written</span>&nbsp;<span class="ident" id="1390367">int64</span><span class="op" id="1390372">,</span>&nbsp;<span class="ident" id="1390374">err</span>&nbsp;<span class="builtintype" id="1390378">error</span><span class="op" id="1390383">)</span>&nbsp;<span class="op" id="1390385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1390388">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1390451">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390488">if</span>&nbsp;<span class="ident" id="1390491">wt</span><span class="op" id="1390493">,</span>&nbsp;<span class="ident" id="1390495">ok</span>&nbsp;<span class="op" id="1390498">:=</span>&nbsp;<span class="ident" id="1390501">src</span><span class="op" id="1390504">.</span><span class="op" id="1390505">(</span><span class="ident" id="1390506">WriterTo</span><span class="op" id="1390514">)</span><span class="op" id="1390515">;</span>&nbsp;<span class="ident" id="1390517">ok</span>&nbsp;<span class="op" id="1390520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390524">return</span>&nbsp;<span class="ident" id="1390531">wt</span><span class="op" id="1390533">.</span><span class="ident" id="1390534">WriteTo</span><span class="op" id="1390541">(</span><span class="ident" id="1390542">dst</span><span class="op" id="1390545">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1390548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1390551">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390626">if</span>&nbsp;<span class="ident" id="1390629">rt</span><span class="op" id="1390631">,</span>&nbsp;<span class="ident" id="1390633">ok</span>&nbsp;<span class="op" id="1390636">:=</span>&nbsp;<span class="ident" id="1390639">dst</span><span class="op" id="1390642">.</span><span class="op" id="1390643">(</span><span class="ident" id="1390644">ReaderFrom</span><span class="op" id="1390654">)</span><span class="op" id="1390655">;</span>&nbsp;<span class="ident" id="1390657">ok</span>&nbsp;<span class="op" id="1390660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390664">return</span>&nbsp;<span class="ident" id="1390671">rt</span><span class="op" id="1390673">.</span><span class="ident" id="1390674">ReadFrom</span><span class="op" id="1390682">(</span><span class="ident" id="1390683">src</span><span class="op" id="1390686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1390689">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1390692">buf</span>&nbsp;<span class="op" id="1390696">:=</span>&nbsp;<span class="builtinfunc" id="1390699">make</span><span class="op" id="1390703">(</span><span class="op" id="1390704">[</span><span class="op" id="1390705">]</span><span class="builtintype" id="1390706">byte</span><span class="op" id="1390710">,</span>&nbsp;<span class="num" id="1390712">32</span><span class="op" id="1390714">*</span><span class="num" id="1390715">1024</span><span class="op" id="1390719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390722">for</span>&nbsp;<span class="op" id="1390726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1390730">nr</span><span class="op" id="1390732">,</span>&nbsp;<span class="ident" id="1390734">er</span>&nbsp;<span class="op" id="1390737">:=</span>&nbsp;<span class="ident" id="1390740">src</span><span class="op" id="1390743">.</span><span class="ident" id="1390744">Read</span><span class="op" id="1390748">(</span><span class="ident" id="1390749">buf</span><span class="op" id="1390752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390756">if</span>&nbsp;<span class="ident" id="1390759">nr</span>&nbsp;<span class="op" id="1390762">&gt;</span>&nbsp;<span class="num" id="1390764">0</span>&nbsp;<span class="op" id="1390766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1390771">nw</span><span class="op" id="1390773">,</span>&nbsp;<span class="ident" id="1390775">ew</span>&nbsp;<span class="op" id="1390778">:=</span>&nbsp;<span class="ident" id="1390781">dst</span><span class="op" id="1390784">.</span><span class="ident" id="1390785">Write</span><span class="op" id="1390790">(</span><span class="ident" id="1390791">buf</span><span class="op" id="1390794">[</span><span class="num" id="1390795">0</span><span class="op" id="1390796">:</span><span class="ident" id="1390797">nr</span><span class="op" id="1390799">]</span><span class="op" id="1390800">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390805">if</span>&nbsp;<span class="ident" id="1390808">nw</span>&nbsp;<span class="op" id="1390811">&gt;</span>&nbsp;<span class="num" id="1390813">0</span>&nbsp;<span class="op" id="1390815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1390821">written</span>&nbsp;<span class="op" id="1390829">+=</span>&nbsp;<span class="ident" id="1390832">int64</span><span class="op" id="1390837">(</span><span class="ident" id="1390838">nw</span><span class="op" id="1390840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1390845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390850">if</span>&nbsp;<span class="ident" id="1390853">ew</span>&nbsp;<span class="op" id="1390856">!=</span>&nbsp;<span class="builtintype" id="1390859">nil</span>&nbsp;<span class="op" id="1390863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1390869">err</span>&nbsp;<span class="op" id="1390873">=</span>&nbsp;<span class="ident" id="1390875">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390882">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1390891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390896">if</span>&nbsp;<span class="ident" id="1390899">nr</span>&nbsp;<span class="op" id="1390902">!=</span>&nbsp;<span class="ident" id="1390905">nw</span>&nbsp;<span class="op" id="1390908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1390914">err</span>&nbsp;<span class="op" id="1390918">=</span>&nbsp;<span class="ident" id="1390920">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390938">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1390947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1390951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390955">if</span>&nbsp;<span class="ident" id="1390958">er</span>&nbsp;<span class="op" id="1390961">==</span>&nbsp;<span class="ident" id="1390964">EOF</span>&nbsp;<span class="op" id="1390968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390973">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1390981">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1390985">if</span>&nbsp;<span class="ident" id="1390988">er</span>&nbsp;<span class="op" id="1390991">!=</span>&nbsp;<span class="builtintype" id="1390994">nil</span>&nbsp;<span class="op" id="1390998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391003">err</span>&nbsp;<span class="op" id="1391007">=</span>&nbsp;<span class="ident" id="1391009">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1391015">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1391023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1391026">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1391029">return</span>&nbsp;<span class="ident" id="1391036">written</span><span class="op" id="1391043">,</span>&nbsp;<span class="ident" id="1391045">err</span><br>
<span class="lineno"></span><span class="op" id="1391049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1391052">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1391102">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1391139">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1391193">func</span>&nbsp;<span class="ident" id="1391198">LimitReader</span><span class="op" id="1391209">(</span><span class="ident" id="1391210">r</span>&nbsp;<span class="ident" id="1391212">Reader</span><span class="op" id="1391218">,</span>&nbsp;<span class="ident" id="1391220">n</span>&nbsp;<span class="ident" id="1391222">int64</span><span class="op" id="1391227">)</span>&nbsp;<span class="ident" id="1391229">Reader</span>&nbsp;<span class="op" id="1391236">{</span>&nbsp;<span class="keyword" id="1391238">return</span>&nbsp;<span class="op" id="1391245">&amp;</span><span class="ident" id="1391246">LimitedReader</span><span class="op" id="1391259">{</span><span class="ident" id="1391260">r</span><span class="op" id="1391261">,</span>&nbsp;<span class="ident" id="1391263">n</span><span class="op" id="1391264">}</span>&nbsp;<span class="op" id="1391266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1391269">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1391326">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1391378">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1391428">type</span>&nbsp;<span class="ident" id="1391433">LimitedReader</span>&nbsp;<span class="keyword" id="1391447">struct</span>&nbsp;<span class="op" id="1391454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391457">R</span>&nbsp;<span class="ident" id="1391459">Reader</span>&nbsp;<span class="comment" id="1391466">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391488">N</span>&nbsp;<span class="ident" id="1391490">int64</span>&nbsp;&nbsp;<span class="comment" id="1391497">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1391520">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1391523">func</span>&nbsp;<span class="op" id="1391528">(</span><span class="ident" id="1391529">l</span>&nbsp;<span class="op" id="1391531">*</span><span class="ident" id="1391532">LimitedReader</span><span class="op" id="1391545">)</span>&nbsp;<span class="ident" id="1391547">Read</span><span class="op" id="1391551">(</span><span class="ident" id="1391552">p</span>&nbsp;<span class="op" id="1391554">[</span><span class="op" id="1391555">]</span><span class="builtintype" id="1391556">byte</span><span class="op" id="1391560">)</span>&nbsp;<span class="op" id="1391562">(</span><span class="ident" id="1391563">n</span>&nbsp;<span class="builtintype" id="1391565">int</span><span class="op" id="1391568">,</span>&nbsp;<span class="ident" id="1391570">err</span>&nbsp;<span class="builtintype" id="1391574">error</span><span class="op" id="1391579">)</span>&nbsp;<span class="op" id="1391581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1391584">if</span>&nbsp;<span class="ident" id="1391587">l</span><span class="op" id="1391588">.</span><span class="ident" id="1391589">N</span>&nbsp;<span class="op" id="1391591">&lt;=</span>&nbsp;<span class="num" id="1391594">0</span>&nbsp;<span class="op" id="1391596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1391600">return</span>&nbsp;<span class="num" id="1391607">0</span><span class="op" id="1391608">,</span>&nbsp;<span class="ident" id="1391610">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1391615">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1391618">if</span>&nbsp;<span class="ident" id="1391621">int64</span><span class="op" id="1391626">(</span><span class="builtinfunc" id="1391627">len</span><span class="op" id="1391630">(</span><span class="ident" id="1391631">p</span><span class="op" id="1391632">)</span><span class="op" id="1391633">)</span>&nbsp;<span class="op" id="1391635">&gt;</span>&nbsp;<span class="ident" id="1391637">l</span><span class="op" id="1391638">.</span><span class="ident" id="1391639">N</span>&nbsp;<span class="op" id="1391641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391645">p</span>&nbsp;<span class="op" id="1391647">=</span>&nbsp;<span class="ident" id="1391649">p</span><span class="op" id="1391650">[</span><span class="num" id="1391651">0</span><span class="op" id="1391652">:</span><span class="ident" id="1391653">l</span><span class="op" id="1391654">.</span><span class="ident" id="1391655">N</span><span class="op" id="1391656">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1391659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391662">n</span><span class="op" id="1391663">,</span>&nbsp;<span class="ident" id="1391665">err</span>&nbsp;<span class="op" id="1391669">=</span>&nbsp;<span class="ident" id="1391671">l</span><span class="op" id="1391672">.</span><span class="ident" id="1391673">R</span><span class="op" id="1391674">.</span><span class="ident" id="1391675">Read</span><span class="op" id="1391679">(</span><span class="ident" id="1391680">p</span><span class="op" id="1391681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1391684">l</span><span class="op" id="1391685">.</span><span class="ident" id="1391686">N</span>&nbsp;<span class="op" id="1391688">-=</span>&nbsp;<span class="ident" id="1391691">int64</span><span class="op" id="1391696">(</span><span class="ident" id="1391697">n</span><span class="op" id="1391698">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1391701">return</span><br>
<span class="lineno"></span><span class="op" id="1391708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1391711">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1391773">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1391833">func</span>&nbsp;<span class="ident" id="1391838">NewSectionReader</span><span class="op" id="1391854">(</span><span class="ident" id="1391855">r</span>&nbsp;<span class="ident" id="1391857">ReaderAt</span><span class="op" id="1391865">,</span>&nbsp;<span class="ident" id="1391867">off</span>&nbsp;<span class="ident" id="1391871">int64</span><span class="op" id="1391876">,</span>&nbsp;<span class="ident" id="1391878">n</span>&nbsp;<span class="ident" id="1391880">int64</span><span class="op" id="1391885">)</span>&nbsp;<span class="op" id="1391887">*</span><span class="ident" id="1391888">SectionReader</span>&nbsp;<span class="op" id="1391902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1391905">return</span>&nbsp;<span class="op" id="1391912">&amp;</span><span class="ident" id="1391913">SectionReader</span><span class="op" id="1391926">{</span><span class="ident" id="1391927">r</span><span class="op" id="1391928">,</span>&nbsp;<span class="ident" id="1391930">off</span><span class="op" id="1391933">,</span>&nbsp;<span class="ident" id="1391935">off</span><span class="op" id="1391938">,</span>&nbsp;<span class="ident" id="1391940">off</span>&nbsp;<span class="op" id="1391944">+</span>&nbsp;<span class="ident" id="1391946">n</span><span class="op" id="1391947">}</span><br>
<span class="lineno"></span><span class="op" id="1391949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1391952">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1392016">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1392046">type</span>&nbsp;<span class="ident" id="1392051">SectionReader</span>&nbsp;<span class="keyword" id="1392065">struct</span>&nbsp;<span class="op" id="1392072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392075">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392081">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392091">base</span>&nbsp;&nbsp;<span class="ident" id="1392097">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392104">off</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1392110">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392117">limit</span>&nbsp;<span class="ident" id="1392123">int64</span><br>
<span class="lineno"></span><span class="op" id="1392129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1392132">func</span>&nbsp;<span class="op" id="1392137">(</span><span class="ident" id="1392138">s</span>&nbsp;<span class="op" id="1392140">*</span><span class="ident" id="1392141">SectionReader</span><span class="op" id="1392154">)</span>&nbsp;<span class="ident" id="1392156">Read</span><span class="op" id="1392160">(</span><span class="ident" id="1392161">p</span>&nbsp;<span class="op" id="1392163">[</span><span class="op" id="1392164">]</span><span class="builtintype" id="1392165">byte</span><span class="op" id="1392169">)</span>&nbsp;<span class="op" id="1392171">(</span><span class="ident" id="1392172">n</span>&nbsp;<span class="builtintype" id="1392174">int</span><span class="op" id="1392177">,</span>&nbsp;<span class="ident" id="1392179">err</span>&nbsp;<span class="builtintype" id="1392183">error</span><span class="op" id="1392188">)</span>&nbsp;<span class="op" id="1392190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392193">if</span>&nbsp;<span class="ident" id="1392196">s</span><span class="op" id="1392197">.</span><span class="ident" id="1392198">off</span>&nbsp;<span class="op" id="1392202">&gt;=</span>&nbsp;<span class="ident" id="1392205">s</span><span class="op" id="1392206">.</span><span class="ident" id="1392207">limit</span>&nbsp;<span class="op" id="1392213">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392217">return</span>&nbsp;<span class="num" id="1392224">0</span><span class="op" id="1392225">,</span>&nbsp;<span class="ident" id="1392227">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1392232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392235">if</span>&nbsp;<span class="ident" id="1392238">max</span>&nbsp;<span class="op" id="1392242">:=</span>&nbsp;<span class="ident" id="1392245">s</span><span class="op" id="1392246">.</span><span class="ident" id="1392247">limit</span>&nbsp;<span class="op" id="1392253">-</span>&nbsp;<span class="ident" id="1392255">s</span><span class="op" id="1392256">.</span><span class="ident" id="1392257">off</span><span class="op" id="1392260">;</span>&nbsp;<span class="ident" id="1392262">int64</span><span class="op" id="1392267">(</span><span class="builtinfunc" id="1392268">len</span><span class="op" id="1392271">(</span><span class="ident" id="1392272">p</span><span class="op" id="1392273">)</span><span class="op" id="1392274">)</span>&nbsp;<span class="op" id="1392276">&gt;</span>&nbsp;<span class="ident" id="1392278">max</span>&nbsp;<span class="op" id="1392282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392286">p</span>&nbsp;<span class="op" id="1392288">=</span>&nbsp;<span class="ident" id="1392290">p</span><span class="op" id="1392291">[</span><span class="num" id="1392292">0</span><span class="op" id="1392293">:</span><span class="ident" id="1392294">max</span><span class="op" id="1392297">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1392300">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392303">n</span><span class="op" id="1392304">,</span>&nbsp;<span class="ident" id="1392306">err</span>&nbsp;<span class="op" id="1392310">=</span>&nbsp;<span class="ident" id="1392312">s</span><span class="op" id="1392313">.</span><span class="ident" id="1392314">r</span><span class="op" id="1392315">.</span><span class="ident" id="1392316">ReadAt</span><span class="op" id="1392322">(</span><span class="ident" id="1392323">p</span><span class="op" id="1392324">,</span>&nbsp;<span class="ident" id="1392326">s</span><span class="op" id="1392327">.</span><span class="ident" id="1392328">off</span><span class="op" id="1392331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392334">s</span><span class="op" id="1392335">.</span><span class="ident" id="1392336">off</span>&nbsp;<span class="op" id="1392340">+=</span>&nbsp;<span class="ident" id="1392343">int64</span><span class="op" id="1392348">(</span><span class="ident" id="1392349">n</span><span class="op" id="1392350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392353">return</span><br>
<span class="lineno"></span><span class="op" id="1392360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1392363">var</span>&nbsp;<span class="ident" id="1392367">errWhence</span>&nbsp;<span class="op" id="1392377">=</span>&nbsp;<span class="ident" id="1392379">errors</span><span class="op" id="1392385">.</span><span class="ident" id="1392386">New</span><span class="op" id="1392389">(</span><span class="string" id="1392390">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1392412">)</span><br>
<span class="lineno"></span><span class="keyword" id="1392414">var</span>&nbsp;<span class="ident" id="1392418">errOffset</span>&nbsp;<span class="op" id="1392428">=</span>&nbsp;<span class="ident" id="1392430">errors</span><span class="op" id="1392436">.</span><span class="ident" id="1392437">New</span><span class="op" id="1392440">(</span><span class="string" id="1392441">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1392463">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1392466">func</span>&nbsp;<span class="op" id="1392471">(</span><span class="ident" id="1392472">s</span>&nbsp;<span class="op" id="1392474">*</span><span class="ident" id="1392475">SectionReader</span><span class="op" id="1392488">)</span>&nbsp;<span class="ident" id="1392490">Seek</span><span class="op" id="1392494">(</span><span class="ident" id="1392495">offset</span>&nbsp;<span class="ident" id="1392502">int64</span><span class="op" id="1392507">,</span>&nbsp;<span class="ident" id="1392509">whence</span>&nbsp;<span class="builtintype" id="1392516">int</span><span class="op" id="1392519">)</span>&nbsp;<span class="op" id="1392521">(</span><span class="ident" id="1392522">int64</span><span class="op" id="1392527">,</span>&nbsp;<span class="builtintype" id="1392529">error</span><span class="op" id="1392534">)</span>&nbsp;<span class="op" id="1392536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392539">switch</span>&nbsp;<span class="ident" id="1392546">whence</span>&nbsp;<span class="op" id="1392553">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392556">default</span><span class="op" id="1392563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392567">return</span>&nbsp;<span class="num" id="1392574">0</span><span class="op" id="1392575">,</span>&nbsp;<span class="ident" id="1392577">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392588">case</span>&nbsp;<span class="num" id="1392593">0</span><span class="op" id="1392594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392598">offset</span>&nbsp;<span class="op" id="1392605">+=</span>&nbsp;<span class="ident" id="1392608">s</span><span class="op" id="1392609">.</span><span class="ident" id="1392610">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392616">case</span>&nbsp;<span class="num" id="1392621">1</span><span class="op" id="1392622">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392626">offset</span>&nbsp;<span class="op" id="1392633">+=</span>&nbsp;<span class="ident" id="1392636">s</span><span class="op" id="1392637">.</span><span class="ident" id="1392638">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392643">case</span>&nbsp;<span class="num" id="1392648">2</span><span class="op" id="1392649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392653">offset</span>&nbsp;<span class="op" id="1392660">+=</span>&nbsp;<span class="ident" id="1392663">s</span><span class="op" id="1392664">.</span><span class="ident" id="1392665">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1392672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392675">if</span>&nbsp;<span class="ident" id="1392678">offset</span>&nbsp;<span class="op" id="1392685">&lt;</span>&nbsp;<span class="ident" id="1392687">s</span><span class="op" id="1392688">.</span><span class="ident" id="1392689">base</span>&nbsp;<span class="op" id="1392694">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392698">return</span>&nbsp;<span class="num" id="1392705">0</span><span class="op" id="1392706">,</span>&nbsp;<span class="ident" id="1392708">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1392719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392722">s</span><span class="op" id="1392723">.</span><span class="ident" id="1392724">off</span>&nbsp;<span class="op" id="1392728">=</span>&nbsp;<span class="ident" id="1392730">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392738">return</span>&nbsp;<span class="ident" id="1392745">offset</span>&nbsp;<span class="op" id="1392752">-</span>&nbsp;<span class="ident" id="1392754">s</span><span class="op" id="1392755">.</span><span class="ident" id="1392756">base</span><span class="op" id="1392760">,</span>&nbsp;<span class="builtintype" id="1392762">nil</span><br>
<span class="lineno"></span><span class="op" id="1392766">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1392769">func</span>&nbsp;<span class="op" id="1392774">(</span><span class="ident" id="1392775">s</span>&nbsp;<span class="op" id="1392777">*</span><span class="ident" id="1392778">SectionReader</span><span class="op" id="1392791">)</span>&nbsp;<span class="ident" id="1392793">ReadAt</span><span class="op" id="1392799">(</span><span class="ident" id="1392800">p</span>&nbsp;<span class="op" id="1392802">[</span><span class="op" id="1392803">]</span><span class="builtintype" id="1392804">byte</span><span class="op" id="1392808">,</span>&nbsp;<span class="ident" id="1392810">off</span>&nbsp;<span class="ident" id="1392814">int64</span><span class="op" id="1392819">)</span>&nbsp;<span class="op" id="1392821">(</span><span class="ident" id="1392822">n</span>&nbsp;<span class="builtintype" id="1392824">int</span><span class="op" id="1392827">,</span>&nbsp;<span class="ident" id="1392829">err</span>&nbsp;<span class="builtintype" id="1392833">error</span><span class="op" id="1392838">)</span>&nbsp;<span class="op" id="1392840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392843">if</span>&nbsp;<span class="ident" id="1392846">off</span>&nbsp;<span class="op" id="1392850">&lt;</span>&nbsp;<span class="num" id="1392852">0</span>&nbsp;<span class="op" id="1392854">||</span>&nbsp;<span class="ident" id="1392857">off</span>&nbsp;<span class="op" id="1392861">&gt;=</span>&nbsp;<span class="ident" id="1392864">s</span><span class="op" id="1392865">.</span><span class="ident" id="1392866">limit</span><span class="op" id="1392871">-</span><span class="ident" id="1392872">s</span><span class="op" id="1392873">.</span><span class="ident" id="1392874">base</span>&nbsp;<span class="op" id="1392879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392883">return</span>&nbsp;<span class="num" id="1392890">0</span><span class="op" id="1392891">,</span>&nbsp;<span class="ident" id="1392893">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1392898">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392901">off</span>&nbsp;<span class="op" id="1392905">+=</span>&nbsp;<span class="ident" id="1392908">s</span><span class="op" id="1392909">.</span><span class="ident" id="1392910">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1392916">if</span>&nbsp;<span class="ident" id="1392919">max</span>&nbsp;<span class="op" id="1392923">:=</span>&nbsp;<span class="ident" id="1392926">s</span><span class="op" id="1392927">.</span><span class="ident" id="1392928">limit</span>&nbsp;<span class="op" id="1392934">-</span>&nbsp;<span class="ident" id="1392936">off</span><span class="op" id="1392939">;</span>&nbsp;<span class="ident" id="1392941">int64</span><span class="op" id="1392946">(</span><span class="builtinfunc" id="1392947">len</span><span class="op" id="1392950">(</span><span class="ident" id="1392951">p</span><span class="op" id="1392952">)</span><span class="op" id="1392953">)</span>&nbsp;<span class="op" id="1392955">&gt;</span>&nbsp;<span class="ident" id="1392957">max</span>&nbsp;<span class="op" id="1392961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392965">p</span>&nbsp;<span class="op" id="1392967">=</span>&nbsp;<span class="ident" id="1392969">p</span><span class="op" id="1392970">[</span><span class="num" id="1392971">0</span><span class="op" id="1392972">:</span><span class="ident" id="1392973">max</span><span class="op" id="1392976">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1392980">n</span><span class="op" id="1392981">,</span>&nbsp;<span class="ident" id="1392983">err</span>&nbsp;<span class="op" id="1392987">=</span>&nbsp;<span class="ident" id="1392989">s</span><span class="op" id="1392990">.</span><span class="ident" id="1392991">r</span><span class="op" id="1392992">.</span><span class="ident" id="1392993">ReadAt</span><span class="op" id="1392999">(</span><span class="ident" id="1393000">p</span><span class="op" id="1393001">,</span>&nbsp;<span class="ident" id="1393003">off</span><span class="op" id="1393006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393010">if</span>&nbsp;<span class="ident" id="1393013">err</span>&nbsp;<span class="op" id="1393017">==</span>&nbsp;<span class="builtintype" id="1393020">nil</span>&nbsp;<span class="op" id="1393024">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1393029">err</span>&nbsp;<span class="op" id="1393033">=</span>&nbsp;<span class="ident" id="1393035">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1393041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393045">return</span>&nbsp;<span class="ident" id="1393052">n</span><span class="op" id="1393053">,</span>&nbsp;<span class="ident" id="1393055">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1393060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393063">return</span>&nbsp;<span class="ident" id="1393070">s</span><span class="op" id="1393071">.</span><span class="ident" id="1393072">r</span><span class="op" id="1393073">.</span><span class="ident" id="1393074">ReadAt</span><span class="op" id="1393080">(</span><span class="ident" id="1393081">p</span><span class="op" id="1393082">,</span>&nbsp;<span class="ident" id="1393084">off</span><span class="op" id="1393087">)</span><br>
<span class="lineno">475</span><span class="op" id="1393089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1393092">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1393142">func</span>&nbsp;<span class="op" id="1393147">(</span><span class="ident" id="1393148">s</span>&nbsp;<span class="op" id="1393150">*</span><span class="ident" id="1393151">SectionReader</span><span class="op" id="1393164">)</span>&nbsp;<span class="ident" id="1393166">Size</span><span class="op" id="1393170">(</span><span class="op" id="1393171">)</span>&nbsp;<span class="ident" id="1393173">int64</span>&nbsp;<span class="op" id="1393179">{</span>&nbsp;<span class="keyword" id="1393181">return</span>&nbsp;<span class="ident" id="1393188">s</span><span class="op" id="1393189">.</span><span class="ident" id="1393190">limit</span>&nbsp;<span class="op" id="1393196">-</span>&nbsp;<span class="ident" id="1393198">s</span><span class="op" id="1393199">.</span><span class="ident" id="1393200">base</span>&nbsp;<span class="op" id="1393205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1393208">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1393277">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1393335">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1393399">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1393453">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1393521">func</span>&nbsp;<span class="ident" id="1393526">TeeReader</span><span class="op" id="1393535">(</span><span class="ident" id="1393536">r</span>&nbsp;<span class="ident" id="1393538">Reader</span><span class="op" id="1393544">,</span>&nbsp;<span class="ident" id="1393546">w</span>&nbsp;<span class="ident" id="1393548">Writer</span><span class="op" id="1393554">)</span>&nbsp;<span class="ident" id="1393556">Reader</span>&nbsp;<span class="op" id="1393563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393566">return</span>&nbsp;<span class="op" id="1393573">&amp;</span><span class="ident" id="1393574">teeReader</span><span class="op" id="1393583">{</span><span class="ident" id="1393584">r</span><span class="op" id="1393585">,</span>&nbsp;<span class="ident" id="1393587">w</span><span class="op" id="1393588">}</span><br>
<span class="lineno"></span><span class="op" id="1393590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1393593">type</span>&nbsp;<span class="ident" id="1393598">teeReader</span>&nbsp;<span class="keyword" id="1393608">struct</span>&nbsp;<span class="op" id="1393615">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1393618">r</span>&nbsp;<span class="ident" id="1393620">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1393628">w</span>&nbsp;<span class="ident" id="1393630">Writer</span><br>
<span class="lineno"></span><span class="op" id="1393637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1393640">func</span>&nbsp;<span class="op" id="1393645">(</span><span class="ident" id="1393646">t</span>&nbsp;<span class="op" id="1393648">*</span><span class="ident" id="1393649">teeReader</span><span class="op" id="1393658">)</span>&nbsp;<span class="ident" id="1393660">Read</span><span class="op" id="1393664">(</span><span class="ident" id="1393665">p</span>&nbsp;<span class="op" id="1393667">[</span><span class="op" id="1393668">]</span><span class="builtintype" id="1393669">byte</span><span class="op" id="1393673">)</span>&nbsp;<span class="op" id="1393675">(</span><span class="ident" id="1393676">n</span>&nbsp;<span class="builtintype" id="1393678">int</span><span class="op" id="1393681">,</span>&nbsp;<span class="ident" id="1393683">err</span>&nbsp;<span class="builtintype" id="1393687">error</span><span class="op" id="1393692">)</span>&nbsp;<span class="op" id="1393694">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1393697">n</span><span class="op" id="1393698">,</span>&nbsp;<span class="ident" id="1393700">err</span>&nbsp;<span class="op" id="1393704">=</span>&nbsp;<span class="ident" id="1393706">t</span><span class="op" id="1393707">.</span><span class="ident" id="1393708">r</span><span class="op" id="1393709">.</span><span class="ident" id="1393710">Read</span><span class="op" id="1393714">(</span><span class="ident" id="1393715">p</span><span class="op" id="1393716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393719">if</span>&nbsp;<span class="ident" id="1393722">n</span>&nbsp;<span class="op" id="1393724">&gt;</span>&nbsp;<span class="num" id="1393726">0</span>&nbsp;<span class="op" id="1393728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393732">if</span>&nbsp;<span class="ident" id="1393735">n</span><span class="op" id="1393736">,</span>&nbsp;<span class="ident" id="1393738">err</span>&nbsp;<span class="op" id="1393742">:=</span>&nbsp;<span class="ident" id="1393745">t</span><span class="op" id="1393746">.</span><span class="ident" id="1393747">w</span><span class="op" id="1393748">.</span><span class="ident" id="1393749">Write</span><span class="op" id="1393754">(</span><span class="ident" id="1393755">p</span><span class="op" id="1393756">[</span><span class="op" id="1393757">:</span><span class="ident" id="1393758">n</span><span class="op" id="1393759">]</span><span class="op" id="1393760">)</span><span class="op" id="1393761">;</span>&nbsp;<span class="ident" id="1393763">err</span>&nbsp;<span class="op" id="1393767">!=</span>&nbsp;<span class="builtintype" id="1393770">nil</span>&nbsp;<span class="op" id="1393774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393779">return</span>&nbsp;<span class="ident" id="1393786">n</span><span class="op" id="1393787">,</span>&nbsp;<span class="ident" id="1393789">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1393795">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1393798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1393801">return</span><br>
<span class="lineno"></span><span class="op" id="1393808">}</span>
</div>
</body>
</html>
