<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html" class="current">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4871997">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4872052">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4872106">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4872157">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="4872214">package</span>&nbsp;<span class="ident" id="4872222">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4872228">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="4872281">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="4872352">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="4872423">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="4872491">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="4872517">//</span><br>
<span class="lineno"></span><span class="keyword" id="4872520">type</span>&nbsp;<span class="ident" id="4872525">Ring</span>&nbsp;<span class="keyword" id="4872530">struct</span>&nbsp;<span class="op" id="4872537">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872540">next</span><span class="op" id="4872544">,</span>&nbsp;<span class="ident" id="4872546">prev</span>&nbsp;<span class="op" id="4872551">*</span><span class="ident" id="4872552">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872558">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872569">interface</span><span class="op" id="4872578">{</span><span class="op" id="4872579">}</span>&nbsp;<span class="comment" id="4872581">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="4872629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4872632">func</span>&nbsp;<span class="op" id="4872637">(</span><span class="ident" id="4872638">r</span>&nbsp;<span class="op" id="4872640">*</span><span class="ident" id="4872641">Ring</span><span class="op" id="4872645">)</span>&nbsp;<span class="ident" id="4872647">init</span><span class="op" id="4872651">(</span><span class="op" id="4872652">)</span>&nbsp;<span class="op" id="4872654">*</span><span class="ident" id="4872655">Ring</span>&nbsp;<span class="op" id="4872660">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872663">r</span><span class="op" id="4872664">.</span><span class="ident" id="4872665">next</span>&nbsp;<span class="op" id="4872670">=</span>&nbsp;<span class="ident" id="4872672">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872675">r</span><span class="op" id="4872676">.</span><span class="ident" id="4872677">prev</span>&nbsp;<span class="op" id="4872682">=</span>&nbsp;<span class="ident" id="4872684">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872687">return</span>&nbsp;<span class="ident" id="4872694">r</span><br>
<span class="lineno"></span><span class="op" id="4872696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4872699">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="4872759">func</span>&nbsp;<span class="op" id="4872764">(</span><span class="ident" id="4872765">r</span>&nbsp;<span class="op" id="4872767">*</span><span class="ident" id="4872768">Ring</span><span class="op" id="4872772">)</span>&nbsp;<span class="ident" id="4872774">Next</span><span class="op" id="4872778">(</span><span class="op" id="4872779">)</span>&nbsp;<span class="op" id="4872781">*</span><span class="ident" id="4872782">Ring</span>&nbsp;<span class="op" id="4872787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872790">if</span>&nbsp;<span class="ident" id="4872793">r</span><span class="op" id="4872794">.</span><span class="ident" id="4872795">next</span>&nbsp;<span class="op" id="4872800">==</span>&nbsp;<span class="builtintype" id="4872803">nil</span>&nbsp;<span class="op" id="4872807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872811">return</span>&nbsp;<span class="ident" id="4872818">r</span><span class="op" id="4872819">.</span><span class="ident" id="4872820">init</span><span class="op" id="4872824">(</span><span class="op" id="4872825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872828">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872831">return</span>&nbsp;<span class="ident" id="4872838">r</span><span class="op" id="4872839">.</span><span class="ident" id="4872840">next</span><br>
<span class="lineno"></span><span class="op" id="4872845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4872848">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="4872912">func</span>&nbsp;<span class="op" id="4872917">(</span><span class="ident" id="4872918">r</span>&nbsp;<span class="op" id="4872920">*</span><span class="ident" id="4872921">Ring</span><span class="op" id="4872925">)</span>&nbsp;<span class="ident" id="4872927">Prev</span><span class="op" id="4872931">(</span><span class="op" id="4872932">)</span>&nbsp;<span class="op" id="4872934">*</span><span class="ident" id="4872935">Ring</span>&nbsp;<span class="op" id="4872940">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872943">if</span>&nbsp;<span class="ident" id="4872946">r</span><span class="op" id="4872947">.</span><span class="ident" id="4872948">next</span>&nbsp;<span class="op" id="4872953">==</span>&nbsp;<span class="builtintype" id="4872956">nil</span>&nbsp;<span class="op" id="4872960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872964">return</span>&nbsp;<span class="ident" id="4872971">r</span><span class="op" id="4872972">.</span><span class="ident" id="4872973">init</span><span class="op" id="4872977">(</span><span class="op" id="4872978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872984">return</span>&nbsp;<span class="ident" id="4872991">r</span><span class="op" id="4872992">.</span><span class="ident" id="4872993">prev</span><br>
<span class="lineno"></span><span class="op" id="4872998">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4873001">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="4873073">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="4873140">//</span><br>
<span class="lineno"></span><span class="keyword" id="4873143">func</span>&nbsp;<span class="op" id="4873148">(</span><span class="ident" id="4873149">r</span>&nbsp;<span class="op" id="4873151">*</span><span class="ident" id="4873152">Ring</span><span class="op" id="4873156">)</span>&nbsp;<span class="ident" id="4873158">Move</span><span class="op" id="4873162">(</span><span class="ident" id="4873163">n</span>&nbsp;<span class="builtintype" id="4873165">int</span><span class="op" id="4873168">)</span>&nbsp;<span class="op" id="4873170">*</span><span class="ident" id="4873171">Ring</span>&nbsp;<span class="op" id="4873176">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873179">if</span>&nbsp;<span class="ident" id="4873182">r</span><span class="op" id="4873183">.</span><span class="ident" id="4873184">next</span>&nbsp;<span class="op" id="4873189">==</span>&nbsp;<span class="builtintype" id="4873192">nil</span>&nbsp;<span class="op" id="4873196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873200">return</span>&nbsp;<span class="ident" id="4873207">r</span><span class="op" id="4873208">.</span><span class="ident" id="4873209">init</span><span class="op" id="4873213">(</span><span class="op" id="4873214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873220">switch</span>&nbsp;<span class="op" id="4873227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873230">case</span>&nbsp;<span class="ident" id="4873235">n</span>&nbsp;<span class="op" id="4873237">&lt;</span>&nbsp;<span class="num" id="4873239">0</span><span class="op" id="4873240">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873244">for</span>&nbsp;<span class="op" id="4873248">;</span>&nbsp;<span class="ident" id="4873250">n</span>&nbsp;<span class="op" id="4873252">&lt;</span>&nbsp;<span class="num" id="4873254">0</span><span class="op" id="4873255">;</span>&nbsp;<span class="ident" id="4873257">n</span><span class="op" id="4873258">++</span>&nbsp;<span class="op" id="4873261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873266">r</span>&nbsp;<span class="op" id="4873268">=</span>&nbsp;<span class="ident" id="4873270">r</span><span class="op" id="4873271">.</span><span class="ident" id="4873272">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873282">case</span>&nbsp;<span class="ident" id="4873287">n</span>&nbsp;<span class="op" id="4873289">&gt;</span>&nbsp;<span class="num" id="4873291">0</span><span class="op" id="4873292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873296">for</span>&nbsp;<span class="op" id="4873300">;</span>&nbsp;<span class="ident" id="4873302">n</span>&nbsp;<span class="op" id="4873304">&gt;</span>&nbsp;<span class="num" id="4873306">0</span><span class="op" id="4873307">;</span>&nbsp;<span class="ident" id="4873309">n</span><span class="op" id="4873310">--</span>&nbsp;<span class="op" id="4873313">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873318">r</span>&nbsp;<span class="op" id="4873320">=</span>&nbsp;<span class="ident" id="4873322">r</span><span class="op" id="4873323">.</span><span class="ident" id="4873324">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873337">return</span>&nbsp;<span class="ident" id="4873344">r</span><br>
<span class="lineno"></span><span class="op" id="4873346">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4873349">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="4873386">func</span>&nbsp;<span class="ident" id="4873391">New</span><span class="op" id="4873394">(</span><span class="ident" id="4873395">n</span>&nbsp;<span class="builtintype" id="4873397">int</span><span class="op" id="4873400">)</span>&nbsp;<span class="op" id="4873402">*</span><span class="ident" id="4873403">Ring</span>&nbsp;<span class="op" id="4873408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873411">if</span>&nbsp;<span class="ident" id="4873414">n</span>&nbsp;<span class="op" id="4873416">&lt;=</span>&nbsp;<span class="num" id="4873419">0</span>&nbsp;<span class="op" id="4873421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873425">return</span>&nbsp;<span class="builtintype" id="4873432">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873440">r</span>&nbsp;<span class="op" id="4873442">:=</span>&nbsp;<span class="builtinfunc" id="4873445">new</span><span class="op" id="4873448">(</span><span class="ident" id="4873449">Ring</span><span class="op" id="4873453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873456">p</span>&nbsp;<span class="op" id="4873458">:=</span>&nbsp;<span class="ident" id="4873461">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873464">for</span>&nbsp;<span class="ident" id="4873468">i</span>&nbsp;<span class="op" id="4873470">:=</span>&nbsp;<span class="num" id="4873473">1</span><span class="op" id="4873474">;</span>&nbsp;<span class="ident" id="4873476">i</span>&nbsp;<span class="op" id="4873478">&lt;</span>&nbsp;<span class="ident" id="4873480">n</span><span class="op" id="4873481">;</span>&nbsp;<span class="ident" id="4873483">i</span><span class="op" id="4873484">++</span>&nbsp;<span class="op" id="4873487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873491">p</span><span class="op" id="4873492">.</span><span class="ident" id="4873493">next</span>&nbsp;<span class="op" id="4873498">=</span>&nbsp;<span class="op" id="4873500">&amp;</span><span class="ident" id="4873501">Ring</span><span class="op" id="4873505">{</span><span class="ident" id="4873506">prev</span><span class="op" id="4873510">:</span>&nbsp;<span class="ident" id="4873512">p</span><span class="op" id="4873513">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873517">p</span>&nbsp;<span class="op" id="4873519">=</span>&nbsp;<span class="ident" id="4873521">p</span><span class="op" id="4873522">.</span><span class="ident" id="4873523">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873532">p</span><span class="op" id="4873533">.</span><span class="ident" id="4873534">next</span>&nbsp;<span class="op" id="4873539">=</span>&nbsp;<span class="ident" id="4873541">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873544">r</span><span class="op" id="4873545">.</span><span class="ident" id="4873546">prev</span>&nbsp;<span class="op" id="4873551">=</span>&nbsp;<span class="ident" id="4873553">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873556">return</span>&nbsp;<span class="ident" id="4873563">r</span><br>
<span class="lineno">75</span><span class="op" id="4873565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4873568">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="4873623">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="4873681">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="4873705">//</span><br>
<span class="lineno"></span><span class="comment" id="4873708">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="4873754">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="4873814">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4873873">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="4873932">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="4873988">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="4874005">//</span><br>
<span class="lineno"></span><span class="comment" id="4874008">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="4874056">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="4874118">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4874177">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="4874215">//</span><br>
<span class="lineno"></span><span class="keyword" id="4874218">func</span>&nbsp;<span class="op" id="4874223">(</span><span class="ident" id="4874224">r</span>&nbsp;<span class="op" id="4874226">*</span><span class="ident" id="4874227">Ring</span><span class="op" id="4874231">)</span>&nbsp;<span class="ident" id="4874233">Link</span><span class="op" id="4874237">(</span><span class="ident" id="4874238">s</span>&nbsp;<span class="op" id="4874240">*</span><span class="ident" id="4874241">Ring</span><span class="op" id="4874245">)</span>&nbsp;<span class="op" id="4874247">*</span><span class="ident" id="4874248">Ring</span>&nbsp;<span class="op" id="4874253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874256">n</span>&nbsp;<span class="op" id="4874258">:=</span>&nbsp;<span class="ident" id="4874261">r</span><span class="op" id="4874262">.</span><span class="ident" id="4874263">Next</span><span class="op" id="4874267">(</span><span class="op" id="4874268">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874271">if</span>&nbsp;<span class="ident" id="4874274">s</span>&nbsp;<span class="op" id="4874276">!=</span>&nbsp;<span class="builtintype" id="4874279">nil</span>&nbsp;<span class="op" id="4874283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874287">p</span>&nbsp;<span class="op" id="4874289">:=</span>&nbsp;<span class="ident" id="4874292">s</span><span class="op" id="4874293">.</span><span class="ident" id="4874294">Prev</span><span class="op" id="4874298">(</span><span class="op" id="4874299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4874303">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4874353">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874400">r</span><span class="op" id="4874401">.</span><span class="ident" id="4874402">next</span>&nbsp;<span class="op" id="4874407">=</span>&nbsp;<span class="ident" id="4874409">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874413">s</span><span class="op" id="4874414">.</span><span class="ident" id="4874415">prev</span>&nbsp;<span class="op" id="4874420">=</span>&nbsp;<span class="ident" id="4874422">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874426">n</span><span class="op" id="4874427">.</span><span class="ident" id="4874428">prev</span>&nbsp;<span class="op" id="4874433">=</span>&nbsp;<span class="ident" id="4874435">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874439">p</span><span class="op" id="4874440">.</span><span class="ident" id="4874441">next</span>&nbsp;<span class="op" id="4874446">=</span>&nbsp;<span class="ident" id="4874448">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874454">return</span>&nbsp;<span class="ident" id="4874461">n</span><br>
<span class="lineno">105</span><span class="op" id="4874463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4874466">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="4874531">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="4874589">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="4874648">//</span><br>
<span class="lineno"></span><span class="keyword" id="4874651">func</span>&nbsp;<span class="op" id="4874656">(</span><span class="ident" id="4874657">r</span>&nbsp;<span class="op" id="4874659">*</span><span class="ident" id="4874660">Ring</span><span class="op" id="4874664">)</span>&nbsp;<span class="ident" id="4874666">Unlink</span><span class="op" id="4874672">(</span><span class="ident" id="4874673">n</span>&nbsp;<span class="builtintype" id="4874675">int</span><span class="op" id="4874678">)</span>&nbsp;<span class="op" id="4874680">*</span><span class="ident" id="4874681">Ring</span>&nbsp;<span class="op" id="4874686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874689">if</span>&nbsp;<span class="ident" id="4874692">n</span>&nbsp;<span class="op" id="4874694">&lt;=</span>&nbsp;<span class="num" id="4874697">0</span>&nbsp;<span class="op" id="4874699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874703">return</span>&nbsp;<span class="builtintype" id="4874710">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874715">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874718">return</span>&nbsp;<span class="ident" id="4874725">r</span><span class="op" id="4874726">.</span><span class="ident" id="4874727">Link</span><span class="op" id="4874731">(</span><span class="ident" id="4874732">r</span><span class="op" id="4874733">.</span><span class="ident" id="4874734">Move</span><span class="op" id="4874738">(</span><span class="ident" id="4874739">n</span>&nbsp;<span class="op" id="4874741">+</span>&nbsp;<span class="num" id="4874743">1</span><span class="op" id="4874744">)</span><span class="op" id="4874745">)</span><br>
<span class="lineno"></span><span class="op" id="4874747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4874750">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4874800">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="4874863">//</span><br>
<span class="lineno"></span><span class="keyword" id="4874866">func</span>&nbsp;<span class="op" id="4874871">(</span><span class="ident" id="4874872">r</span>&nbsp;<span class="op" id="4874874">*</span><span class="ident" id="4874875">Ring</span><span class="op" id="4874879">)</span>&nbsp;<span class="ident" id="4874881">Len</span><span class="op" id="4874884">(</span><span class="op" id="4874885">)</span>&nbsp;<span class="builtintype" id="4874887">int</span>&nbsp;<span class="op" id="4874891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874894">n</span>&nbsp;<span class="op" id="4874896">:=</span>&nbsp;<span class="num" id="4874899">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874902">if</span>&nbsp;<span class="ident" id="4874905">r</span>&nbsp;<span class="op" id="4874907">!=</span>&nbsp;<span class="builtintype" id="4874910">nil</span>&nbsp;<span class="op" id="4874914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874918">n</span>&nbsp;<span class="op" id="4874920">=</span>&nbsp;<span class="num" id="4874922">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874926">for</span>&nbsp;<span class="ident" id="4874930">p</span>&nbsp;<span class="op" id="4874932">:=</span>&nbsp;<span class="ident" id="4874935">r</span><span class="op" id="4874936">.</span><span class="ident" id="4874937">Next</span><span class="op" id="4874941">(</span><span class="op" id="4874942">)</span><span class="op" id="4874943">;</span>&nbsp;<span class="ident" id="4874945">p</span>&nbsp;<span class="op" id="4874947">!=</span>&nbsp;<span class="ident" id="4874950">r</span><span class="op" id="4874951">;</span>&nbsp;<span class="ident" id="4874953">p</span>&nbsp;<span class="op" id="4874955">=</span>&nbsp;<span class="ident" id="4874957">p</span><span class="op" id="4874958">.</span><span class="ident" id="4874959">next</span>&nbsp;<span class="op" id="4874964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874969">n</span><span class="op" id="4874970">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874981">return</span>&nbsp;<span class="ident" id="4874988">n</span><br>
<span class="lineno">130</span><span class="op" id="4874990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4874993">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="4875063">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="4875115">func</span>&nbsp;<span class="op" id="4875120">(</span><span class="ident" id="4875121">r</span>&nbsp;<span class="op" id="4875123">*</span><span class="ident" id="4875124">Ring</span><span class="op" id="4875128">)</span>&nbsp;<span class="ident" id="4875130">Do</span><span class="op" id="4875132">(</span><span class="ident" id="4875133">f</span>&nbsp;<span class="keyword" id="4875135">func</span><span class="op" id="4875139">(</span><span class="keyword" id="4875140">interface</span><span class="op" id="4875149">{</span><span class="op" id="4875150">}</span><span class="op" id="4875151">)</span><span class="op" id="4875152">)</span>&nbsp;<span class="op" id="4875154">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4875157">if</span>&nbsp;<span class="ident" id="4875160">r</span>&nbsp;<span class="op" id="4875162">!=</span>&nbsp;<span class="builtintype" id="4875165">nil</span>&nbsp;<span class="op" id="4875169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875173">f</span><span class="op" id="4875174">(</span><span class="ident" id="4875175">r</span><span class="op" id="4875176">.</span><span class="ident" id="4875177">Value</span><span class="op" id="4875182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4875186">for</span>&nbsp;<span class="ident" id="4875190">p</span>&nbsp;<span class="op" id="4875192">:=</span>&nbsp;<span class="ident" id="4875195">r</span><span class="op" id="4875196">.</span><span class="ident" id="4875197">Next</span><span class="op" id="4875201">(</span><span class="op" id="4875202">)</span><span class="op" id="4875203">;</span>&nbsp;<span class="ident" id="4875205">p</span>&nbsp;<span class="op" id="4875207">!=</span>&nbsp;<span class="ident" id="4875210">r</span><span class="op" id="4875211">;</span>&nbsp;<span class="ident" id="4875213">p</span>&nbsp;<span class="op" id="4875215">=</span>&nbsp;<span class="ident" id="4875217">p</span><span class="op" id="4875218">.</span><span class="ident" id="4875219">next</span>&nbsp;<span class="op" id="4875224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875229">f</span><span class="op" id="4875230">(</span><span class="ident" id="4875231">p</span><span class="op" id="4875232">.</span><span class="ident" id="4875233">Value</span><span class="op" id="4875238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4875242">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4875245">}</span><br>
<span class="lineno"></span><span class="op" id="4875247">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
