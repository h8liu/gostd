<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2163916">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2163971">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2164025">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2164076">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2164154">package</span>&nbsp;<span class="ident" id="2164162">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2164166">import</span>&nbsp;<span class="op" id="2164173">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2164176">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2164187">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2164194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2164197">func</span>&nbsp;<span class="ident" id="2164202">sigpipe</span><span class="op" id="2164209">(</span><span class="op" id="2164210">)</span>&nbsp;<span class="comment" id="2164212">//&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2164247">//&nbsp;Readlink&nbsp;returns&nbsp;the&nbsp;destination&nbsp;of&nbsp;the&nbsp;named&nbsp;symbolic&nbsp;link.</span><br>
<span class="lineno"></span><span class="comment" id="2164311">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2164367">func</span>&nbsp;<span class="ident" id="2164372">Readlink</span><span class="op" id="2164380">(</span><span class="ident" id="2164381">name</span>&nbsp;<span class="builtintype" id="2164386">string</span><span class="op" id="2164392">)</span>&nbsp;<span class="op" id="2164394">(</span><span class="builtintype" id="2164395">string</span><span class="op" id="2164401">,</span>&nbsp;<span class="builtintype" id="2164403">error</span><span class="op" id="2164408">)</span>&nbsp;<span class="op" id="2164410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164413">for</span>&nbsp;<span class="builtinfunc" id="2164417">len</span>&nbsp;<span class="op" id="2164421">:=</span>&nbsp;<span class="num" id="2164424">128</span><span class="op" id="2164427">;</span>&nbsp;<span class="op" id="2164429">;</span>&nbsp;<span class="builtinfunc" id="2164431">len</span>&nbsp;<span class="op" id="2164435">*=</span>&nbsp;<span class="num" id="2164438">2</span>&nbsp;<span class="op" id="2164440">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164444">b</span>&nbsp;<span class="op" id="2164446">:=</span>&nbsp;<span class="builtinfunc" id="2164449">make</span><span class="op" id="2164453">(</span><span class="op" id="2164454">[</span><span class="op" id="2164455">]</span><span class="builtintype" id="2164456">byte</span><span class="op" id="2164460">,</span>&nbsp;<span class="builtinfunc" id="2164462">len</span><span class="op" id="2164465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164469">n</span><span class="op" id="2164470">,</span>&nbsp;<span class="ident" id="2164472">e</span>&nbsp;<span class="op" id="2164474">:=</span>&nbsp;<span class="ident" id="2164477">fixCount</span><span class="op" id="2164485">(</span><span class="ident" id="2164486">syscall</span><span class="op" id="2164493">.</span><span class="ident" id="2164494">Readlink</span><span class="op" id="2164502">(</span><span class="ident" id="2164503">name</span><span class="op" id="2164507">,</span>&nbsp;<span class="ident" id="2164509">b</span><span class="op" id="2164510">)</span><span class="op" id="2164511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164515">if</span>&nbsp;<span class="ident" id="2164518">e</span>&nbsp;<span class="op" id="2164520">!=</span>&nbsp;<span class="ident" id="2164523">nil</span>&nbsp;<span class="op" id="2164527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164532">return</span>&nbsp;<span class="string" id="2164539">&#34;&#34;</span><span class="op" id="2164541">,</span>&nbsp;<span class="op" id="2164543">&amp;</span><span class="ident" id="2164544">PathError</span><span class="op" id="2164553">{</span><span class="string" id="2164554">&#34;readlink&#34;</span><span class="op" id="2164564">,</span>&nbsp;<span class="ident" id="2164566">name</span><span class="op" id="2164570">,</span>&nbsp;<span class="ident" id="2164572">e</span><span class="op" id="2164573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164577">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164581">if</span>&nbsp;<span class="ident" id="2164584">n</span>&nbsp;<span class="op" id="2164586">&lt;</span>&nbsp;<span class="builtinfunc" id="2164588">len</span>&nbsp;<span class="op" id="2164592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164597">return</span>&nbsp;<span class="builtintype" id="2164604">string</span><span class="op" id="2164610">(</span><span class="ident" id="2164611">b</span><span class="op" id="2164612">[</span><span class="num" id="2164613">0</span><span class="op" id="2164614">:</span><span class="ident" id="2164615">n</span><span class="op" id="2164616">]</span><span class="op" id="2164617">)</span><span class="op" id="2164618">,</span>&nbsp;<span class="ident" id="2164620">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164629">}</span><br>
<span class="lineno"></span><span class="op" id="2164631">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2164634">func</span>&nbsp;<span class="ident" id="2164639">rename</span><span class="op" id="2164645">(</span><span class="ident" id="2164646">oldname</span><span class="op" id="2164653">,</span>&nbsp;<span class="ident" id="2164655">newname</span>&nbsp;<span class="builtintype" id="2164663">string</span><span class="op" id="2164669">)</span>&nbsp;<span class="builtintype" id="2164671">error</span>&nbsp;<span class="op" id="2164677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164680">e</span>&nbsp;<span class="op" id="2164682">:=</span>&nbsp;<span class="ident" id="2164685">syscall</span><span class="op" id="2164692">.</span><span class="ident" id="2164693">Rename</span><span class="op" id="2164699">(</span><span class="ident" id="2164700">oldname</span><span class="op" id="2164707">,</span>&nbsp;<span class="ident" id="2164709">newname</span><span class="op" id="2164716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164719">if</span>&nbsp;<span class="ident" id="2164722">e</span>&nbsp;<span class="op" id="2164724">!=</span>&nbsp;<span class="ident" id="2164727">nil</span>&nbsp;<span class="op" id="2164731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164735">return</span>&nbsp;<span class="op" id="2164742">&amp;</span><span class="ident" id="2164743">LinkError</span><span class="op" id="2164752">{</span><span class="string" id="2164753">&#34;rename&#34;</span><span class="op" id="2164761">,</span>&nbsp;<span class="ident" id="2164763">oldname</span><span class="op" id="2164770">,</span>&nbsp;<span class="ident" id="2164772">newname</span><span class="op" id="2164779">,</span>&nbsp;<span class="ident" id="2164781">e</span><span class="op" id="2164782">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164788">return</span>&nbsp;<span class="ident" id="2164795">nil</span><br>
<span class="lineno"></span><span class="op" id="2164799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2164802">//&nbsp;syscallMode&nbsp;returns&nbsp;the&nbsp;syscall-specific&nbsp;mode&nbsp;bits&nbsp;from&nbsp;Go&#39;s&nbsp;portable&nbsp;mode&nbsp;bits.</span><br>
<span class="lineno">40</span><span class="keyword" id="2164886">func</span>&nbsp;<span class="ident" id="2164891">syscallMode</span><span class="op" id="2164902">(</span><span class="ident" id="2164903">i</span>&nbsp;<span class="ident" id="2164905">FileMode</span><span class="op" id="2164913">)</span>&nbsp;<span class="op" id="2164915">(</span><span class="ident" id="2164916">o</span>&nbsp;<span class="builtintype" id="2164918">uint32</span><span class="op" id="2164924">)</span>&nbsp;<span class="op" id="2164926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164929">o</span>&nbsp;<span class="op" id="2164931">|=</span>&nbsp;<span class="builtintype" id="2164934">uint32</span><span class="op" id="2164940">(</span><span class="ident" id="2164941">i</span><span class="op" id="2164942">.</span><span class="ident" id="2164943">Perm</span><span class="op" id="2164947">(</span><span class="op" id="2164948">)</span><span class="op" id="2164949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164952">if</span>&nbsp;<span class="ident" id="2164955">i</span><span class="op" id="2164956">&amp;</span><span class="ident" id="2164957">ModeSetuid</span>&nbsp;<span class="op" id="2164968">!=</span>&nbsp;<span class="num" id="2164971">0</span>&nbsp;<span class="op" id="2164973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164977">o</span>&nbsp;<span class="op" id="2164979">|=</span>&nbsp;<span class="ident" id="2164982">syscall</span><span class="op" id="2164989">.</span><span class="ident" id="2164990">S_ISUID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164999">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165002">if</span>&nbsp;<span class="ident" id="2165005">i</span><span class="op" id="2165006">&amp;</span><span class="ident" id="2165007">ModeSetgid</span>&nbsp;<span class="op" id="2165018">!=</span>&nbsp;<span class="num" id="2165021">0</span>&nbsp;<span class="op" id="2165023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2165027">o</span>&nbsp;<span class="op" id="2165029">|=</span>&nbsp;<span class="ident" id="2165032">syscall</span><span class="op" id="2165039">.</span><span class="ident" id="2165040">S_ISGID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2165049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165052">if</span>&nbsp;<span class="ident" id="2165055">i</span><span class="op" id="2165056">&amp;</span><span class="ident" id="2165057">ModeSticky</span>&nbsp;<span class="op" id="2165068">!=</span>&nbsp;<span class="num" id="2165071">0</span>&nbsp;<span class="op" id="2165073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2165077">o</span>&nbsp;<span class="op" id="2165079">|=</span>&nbsp;<span class="ident" id="2165082">syscall</span><span class="op" id="2165089">.</span><span class="ident" id="2165090">S_ISVTX</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2165099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165102">//&nbsp;No&nbsp;mapping&nbsp;for&nbsp;Go&#39;s&nbsp;ModeTemporary&nbsp;(plan9&nbsp;only).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165154">return</span><br>
<span class="lineno"></span><span class="op" id="2165161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2165164">//&nbsp;Chmod&nbsp;changes&nbsp;the&nbsp;mode&nbsp;of&nbsp;the&nbsp;named&nbsp;file&nbsp;to&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="2165217">//&nbsp;If&nbsp;the&nbsp;file&nbsp;is&nbsp;a&nbsp;symbolic&nbsp;link,&nbsp;it&nbsp;changes&nbsp;the&nbsp;mode&nbsp;of&nbsp;the&nbsp;link&#39;s&nbsp;target.</span><br>
<span class="lineno"></span><span class="comment" id="2165294">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2165350">func</span>&nbsp;<span class="ident" id="2165355">Chmod</span><span class="op" id="2165360">(</span><span class="ident" id="2165361">name</span>&nbsp;<span class="builtintype" id="2165366">string</span><span class="op" id="2165372">,</span>&nbsp;<span class="ident" id="2165374">mode</span>&nbsp;<span class="ident" id="2165379">FileMode</span><span class="op" id="2165387">)</span>&nbsp;<span class="builtintype" id="2165389">error</span>&nbsp;<span class="op" id="2165395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165398">if</span>&nbsp;<span class="ident" id="2165401">e</span>&nbsp;<span class="op" id="2165403">:=</span>&nbsp;<span class="ident" id="2165406">syscall</span><span class="op" id="2165413">.</span><span class="ident" id="2165414">Chmod</span><span class="op" id="2165419">(</span><span class="ident" id="2165420">name</span><span class="op" id="2165424">,</span>&nbsp;<span class="ident" id="2165426">syscallMode</span><span class="op" id="2165437">(</span><span class="ident" id="2165438">mode</span><span class="op" id="2165442">)</span><span class="op" id="2165443">)</span><span class="op" id="2165444">;</span>&nbsp;<span class="ident" id="2165446">e</span>&nbsp;<span class="op" id="2165448">!=</span>&nbsp;<span class="ident" id="2165451">nil</span>&nbsp;<span class="op" id="2165455">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165459">return</span>&nbsp;<span class="op" id="2165466">&amp;</span><span class="ident" id="2165467">PathError</span><span class="op" id="2165476">{</span><span class="string" id="2165477">&#34;chmod&#34;</span><span class="op" id="2165484">,</span>&nbsp;<span class="ident" id="2165486">name</span><span class="op" id="2165490">,</span>&nbsp;<span class="ident" id="2165492">e</span><span class="op" id="2165493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2165496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165499">return</span>&nbsp;<span class="ident" id="2165506">nil</span><br>
<span class="lineno"></span><span class="op" id="2165510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="2165513">//&nbsp;Chmod&nbsp;changes&nbsp;the&nbsp;mode&nbsp;of&nbsp;the&nbsp;file&nbsp;to&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="2165560">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2165616">func</span>&nbsp;<span class="op" id="2165621">(</span><span class="ident" id="2165622">f</span>&nbsp;<span class="op" id="2165624">*</span><span class="ident" id="2165625">File</span><span class="op" id="2165629">)</span>&nbsp;<span class="ident" id="2165631">Chmod</span><span class="op" id="2165636">(</span><span class="ident" id="2165637">mode</span>&nbsp;<span class="ident" id="2165642">FileMode</span><span class="op" id="2165650">)</span>&nbsp;<span class="builtintype" id="2165652">error</span>&nbsp;<span class="op" id="2165658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165661">if</span>&nbsp;<span class="ident" id="2165664">f</span>&nbsp;<span class="op" id="2165666">==</span>&nbsp;<span class="ident" id="2165669">nil</span>&nbsp;<span class="op" id="2165673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165677">return</span>&nbsp;<span class="ident" id="2165684">ErrInvalid</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2165696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165699">if</span>&nbsp;<span class="ident" id="2165702">e</span>&nbsp;<span class="op" id="2165704">:=</span>&nbsp;<span class="ident" id="2165707">syscall</span><span class="op" id="2165714">.</span><span class="ident" id="2165715">Fchmod</span><span class="op" id="2165721">(</span><span class="ident" id="2165722">f</span><span class="op" id="2165723">.</span><span class="ident" id="2165724">fd</span><span class="op" id="2165726">,</span>&nbsp;<span class="ident" id="2165728">syscallMode</span><span class="op" id="2165739">(</span><span class="ident" id="2165740">mode</span><span class="op" id="2165744">)</span><span class="op" id="2165745">)</span><span class="op" id="2165746">;</span>&nbsp;<span class="ident" id="2165748">e</span>&nbsp;<span class="op" id="2165750">!=</span>&nbsp;<span class="ident" id="2165753">nil</span>&nbsp;<span class="op" id="2165757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165761">return</span>&nbsp;<span class="op" id="2165768">&amp;</span><span class="ident" id="2165769">PathError</span><span class="op" id="2165778">{</span><span class="string" id="2165779">&#34;chmod&#34;</span><span class="op" id="2165786">,</span>&nbsp;<span class="ident" id="2165788">f</span><span class="op" id="2165789">.</span><span class="ident" id="2165790">name</span><span class="op" id="2165794">,</span>&nbsp;<span class="ident" id="2165796">e</span><span class="op" id="2165797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2165800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2165803">return</span>&nbsp;<span class="ident" id="2165810">nil</span><br>
<span class="lineno">75</span><span class="op" id="2165814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2165817">//&nbsp;Chown&nbsp;changes&nbsp;the&nbsp;numeric&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;named&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2165877">//&nbsp;If&nbsp;the&nbsp;file&nbsp;is&nbsp;a&nbsp;symbolic&nbsp;link,&nbsp;it&nbsp;changes&nbsp;the&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;link&#39;s&nbsp;target.</span><br>
<span class="lineno"></span><span class="comment" id="2165961">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno">80</span><span class="keyword" id="2166017">func</span>&nbsp;<span class="ident" id="2166022">Chown</span><span class="op" id="2166027">(</span><span class="ident" id="2166028">name</span>&nbsp;<span class="builtintype" id="2166033">string</span><span class="op" id="2166039">,</span>&nbsp;<span class="ident" id="2166041">uid</span><span class="op" id="2166044">,</span>&nbsp;<span class="ident" id="2166046">gid</span>&nbsp;<span class="builtintype" id="2166050">int</span><span class="op" id="2166053">)</span>&nbsp;<span class="builtintype" id="2166055">error</span>&nbsp;<span class="op" id="2166061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166064">if</span>&nbsp;<span class="ident" id="2166067">e</span>&nbsp;<span class="op" id="2166069">:=</span>&nbsp;<span class="ident" id="2166072">syscall</span><span class="op" id="2166079">.</span><span class="ident" id="2166080">Chown</span><span class="op" id="2166085">(</span><span class="ident" id="2166086">name</span><span class="op" id="2166090">,</span>&nbsp;<span class="ident" id="2166092">uid</span><span class="op" id="2166095">,</span>&nbsp;<span class="ident" id="2166097">gid</span><span class="op" id="2166100">)</span><span class="op" id="2166101">;</span>&nbsp;<span class="ident" id="2166103">e</span>&nbsp;<span class="op" id="2166105">!=</span>&nbsp;<span class="ident" id="2166108">nil</span>&nbsp;<span class="op" id="2166112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166116">return</span>&nbsp;<span class="op" id="2166123">&amp;</span><span class="ident" id="2166124">PathError</span><span class="op" id="2166133">{</span><span class="string" id="2166134">&#34;chown&#34;</span><span class="op" id="2166141">,</span>&nbsp;<span class="ident" id="2166143">name</span><span class="op" id="2166147">,</span>&nbsp;<span class="ident" id="2166149">e</span><span class="op" id="2166150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166156">return</span>&nbsp;<span class="ident" id="2166163">nil</span><br>
<span class="lineno">85</span><span class="op" id="2166167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2166170">//&nbsp;Lchown&nbsp;changes&nbsp;the&nbsp;numeric&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;named&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2166231">//&nbsp;If&nbsp;the&nbsp;file&nbsp;is&nbsp;a&nbsp;symbolic&nbsp;link,&nbsp;it&nbsp;changes&nbsp;the&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;link&nbsp;itself.</span><br>
<span class="lineno"></span><span class="comment" id="2166313">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno">90</span><span class="keyword" id="2166369">func</span>&nbsp;<span class="ident" id="2166374">Lchown</span><span class="op" id="2166380">(</span><span class="ident" id="2166381">name</span>&nbsp;<span class="builtintype" id="2166386">string</span><span class="op" id="2166392">,</span>&nbsp;<span class="ident" id="2166394">uid</span><span class="op" id="2166397">,</span>&nbsp;<span class="ident" id="2166399">gid</span>&nbsp;<span class="builtintype" id="2166403">int</span><span class="op" id="2166406">)</span>&nbsp;<span class="builtintype" id="2166408">error</span>&nbsp;<span class="op" id="2166414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166417">if</span>&nbsp;<span class="ident" id="2166420">e</span>&nbsp;<span class="op" id="2166422">:=</span>&nbsp;<span class="ident" id="2166425">syscall</span><span class="op" id="2166432">.</span><span class="ident" id="2166433">Lchown</span><span class="op" id="2166439">(</span><span class="ident" id="2166440">name</span><span class="op" id="2166444">,</span>&nbsp;<span class="ident" id="2166446">uid</span><span class="op" id="2166449">,</span>&nbsp;<span class="ident" id="2166451">gid</span><span class="op" id="2166454">)</span><span class="op" id="2166455">;</span>&nbsp;<span class="ident" id="2166457">e</span>&nbsp;<span class="op" id="2166459">!=</span>&nbsp;<span class="ident" id="2166462">nil</span>&nbsp;<span class="op" id="2166466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166470">return</span>&nbsp;<span class="op" id="2166477">&amp;</span><span class="ident" id="2166478">PathError</span><span class="op" id="2166487">{</span><span class="string" id="2166488">&#34;lchown&#34;</span><span class="op" id="2166496">,</span>&nbsp;<span class="ident" id="2166498">name</span><span class="op" id="2166502">,</span>&nbsp;<span class="ident" id="2166504">e</span><span class="op" id="2166505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166511">return</span>&nbsp;<span class="ident" id="2166518">nil</span><br>
<span class="lineno">95</span><span class="op" id="2166522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2166525">//&nbsp;Chown&nbsp;changes&nbsp;the&nbsp;numeric&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;named&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2166585">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2166641">func</span>&nbsp;<span class="op" id="2166646">(</span><span class="ident" id="2166647">f</span>&nbsp;<span class="op" id="2166649">*</span><span class="ident" id="2166650">File</span><span class="op" id="2166654">)</span>&nbsp;<span class="ident" id="2166656">Chown</span><span class="op" id="2166661">(</span><span class="ident" id="2166662">uid</span><span class="op" id="2166665">,</span>&nbsp;<span class="ident" id="2166667">gid</span>&nbsp;<span class="builtintype" id="2166671">int</span><span class="op" id="2166674">)</span>&nbsp;<span class="builtintype" id="2166676">error</span>&nbsp;<span class="op" id="2166682">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166685">if</span>&nbsp;<span class="ident" id="2166688">f</span>&nbsp;<span class="op" id="2166690">==</span>&nbsp;<span class="ident" id="2166693">nil</span>&nbsp;<span class="op" id="2166697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166701">return</span>&nbsp;<span class="ident" id="2166708">ErrInvalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166723">if</span>&nbsp;<span class="ident" id="2166726">e</span>&nbsp;<span class="op" id="2166728">:=</span>&nbsp;<span class="ident" id="2166731">syscall</span><span class="op" id="2166738">.</span><span class="ident" id="2166739">Fchown</span><span class="op" id="2166745">(</span><span class="ident" id="2166746">f</span><span class="op" id="2166747">.</span><span class="ident" id="2166748">fd</span><span class="op" id="2166750">,</span>&nbsp;<span class="ident" id="2166752">uid</span><span class="op" id="2166755">,</span>&nbsp;<span class="ident" id="2166757">gid</span><span class="op" id="2166760">)</span><span class="op" id="2166761">;</span>&nbsp;<span class="ident" id="2166763">e</span>&nbsp;<span class="op" id="2166765">!=</span>&nbsp;<span class="ident" id="2166768">nil</span>&nbsp;<span class="op" id="2166772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166776">return</span>&nbsp;<span class="op" id="2166783">&amp;</span><span class="ident" id="2166784">PathError</span><span class="op" id="2166793">{</span><span class="string" id="2166794">&#34;chown&#34;</span><span class="op" id="2166801">,</span>&nbsp;<span class="ident" id="2166803">f</span><span class="op" id="2166804">.</span><span class="ident" id="2166805">name</span><span class="op" id="2166809">,</span>&nbsp;<span class="ident" id="2166811">e</span><span class="op" id="2166812">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166818">return</span>&nbsp;<span class="ident" id="2166825">nil</span><br>
<span class="lineno"></span><span class="op" id="2166829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2166832">//&nbsp;Truncate&nbsp;changes&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno">110</span><span class="comment" id="2166874">//&nbsp;It&nbsp;does&nbsp;not&nbsp;change&nbsp;the&nbsp;I/O&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2166912">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2166968">func</span>&nbsp;<span class="op" id="2166973">(</span><span class="ident" id="2166974">f</span>&nbsp;<span class="op" id="2166976">*</span><span class="ident" id="2166977">File</span><span class="op" id="2166981">)</span>&nbsp;<span class="ident" id="2166983">Truncate</span><span class="op" id="2166991">(</span><span class="ident" id="2166992">size</span>&nbsp;<span class="ident" id="2166997">int64</span><span class="op" id="2167002">)</span>&nbsp;<span class="builtintype" id="2167004">error</span>&nbsp;<span class="op" id="2167010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167013">if</span>&nbsp;<span class="ident" id="2167016">f</span>&nbsp;<span class="op" id="2167018">==</span>&nbsp;<span class="ident" id="2167021">nil</span>&nbsp;<span class="op" id="2167025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167029">return</span>&nbsp;<span class="ident" id="2167036">ErrInvalid</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167051">if</span>&nbsp;<span class="ident" id="2167054">e</span>&nbsp;<span class="op" id="2167056">:=</span>&nbsp;<span class="ident" id="2167059">syscall</span><span class="op" id="2167066">.</span><span class="ident" id="2167067">Ftruncate</span><span class="op" id="2167076">(</span><span class="ident" id="2167077">f</span><span class="op" id="2167078">.</span><span class="ident" id="2167079">fd</span><span class="op" id="2167081">,</span>&nbsp;<span class="ident" id="2167083">size</span><span class="op" id="2167087">)</span><span class="op" id="2167088">;</span>&nbsp;<span class="ident" id="2167090">e</span>&nbsp;<span class="op" id="2167092">!=</span>&nbsp;<span class="ident" id="2167095">nil</span>&nbsp;<span class="op" id="2167099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167103">return</span>&nbsp;<span class="op" id="2167110">&amp;</span><span class="ident" id="2167111">PathError</span><span class="op" id="2167120">{</span><span class="string" id="2167121">&#34;truncate&#34;</span><span class="op" id="2167131">,</span>&nbsp;<span class="ident" id="2167133">f</span><span class="op" id="2167134">.</span><span class="ident" id="2167135">name</span><span class="op" id="2167139">,</span>&nbsp;<span class="ident" id="2167141">e</span><span class="op" id="2167142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167148">return</span>&nbsp;<span class="ident" id="2167155">nil</span><br>
<span class="lineno">120</span><span class="op" id="2167159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2167162">//&nbsp;Sync&nbsp;commits&nbsp;the&nbsp;current&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;to&nbsp;stable&nbsp;storage.</span><br>
<span class="lineno"></span><span class="comment" id="2167230">//&nbsp;Typically,&nbsp;this&nbsp;means&nbsp;flushing&nbsp;the&nbsp;file&nbsp;system&#39;s&nbsp;in-memory&nbsp;copy</span><br>
<span class="lineno"></span><span class="comment" id="2167297">//&nbsp;of&nbsp;recently&nbsp;written&nbsp;data&nbsp;to&nbsp;disk.</span><br>
<span class="lineno">125</span><span class="keyword" id="2167334">func</span>&nbsp;<span class="op" id="2167339">(</span><span class="ident" id="2167340">f</span>&nbsp;<span class="op" id="2167342">*</span><span class="ident" id="2167343">File</span><span class="op" id="2167347">)</span>&nbsp;<span class="ident" id="2167349">Sync</span><span class="op" id="2167353">(</span><span class="op" id="2167354">)</span>&nbsp;<span class="op" id="2167356">(</span><span class="ident" id="2167357">err</span>&nbsp;<span class="builtintype" id="2167361">error</span><span class="op" id="2167366">)</span>&nbsp;<span class="op" id="2167368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167371">if</span>&nbsp;<span class="ident" id="2167374">f</span>&nbsp;<span class="op" id="2167376">==</span>&nbsp;<span class="ident" id="2167379">nil</span>&nbsp;<span class="op" id="2167383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167387">return</span>&nbsp;<span class="ident" id="2167394">ErrInvalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167409">if</span>&nbsp;<span class="ident" id="2167412">e</span>&nbsp;<span class="op" id="2167414">:=</span>&nbsp;<span class="ident" id="2167417">syscall</span><span class="op" id="2167424">.</span><span class="ident" id="2167425">Fsync</span><span class="op" id="2167430">(</span><span class="ident" id="2167431">f</span><span class="op" id="2167432">.</span><span class="ident" id="2167433">fd</span><span class="op" id="2167435">)</span><span class="op" id="2167436">;</span>&nbsp;<span class="ident" id="2167438">e</span>&nbsp;<span class="op" id="2167440">!=</span>&nbsp;<span class="ident" id="2167443">nil</span>&nbsp;<span class="op" id="2167447">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167451">return</span>&nbsp;<span class="ident" id="2167458">NewSyscallError</span><span class="op" id="2167473">(</span><span class="string" id="2167474">&#34;fsync&#34;</span><span class="op" id="2167481">,</span>&nbsp;<span class="ident" id="2167483">e</span><span class="op" id="2167484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167490">return</span>&nbsp;<span class="ident" id="2167497">nil</span><br>
<span class="lineno"></span><span class="op" id="2167501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2167504">//&nbsp;Chtimes&nbsp;changes&nbsp;the&nbsp;access&nbsp;and&nbsp;modification&nbsp;times&nbsp;of&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="2167570">//&nbsp;file,&nbsp;similar&nbsp;to&nbsp;the&nbsp;Unix&nbsp;utime()&nbsp;or&nbsp;utimes()&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="2167630">//</span><br>
<span class="lineno"></span><span class="comment" id="2167633">//&nbsp;The&nbsp;underlying&nbsp;filesystem&nbsp;may&nbsp;truncate&nbsp;or&nbsp;round&nbsp;the&nbsp;values&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2167700">//&nbsp;less&nbsp;precise&nbsp;time&nbsp;unit.</span><br>
<span class="lineno">140</span><span class="comment" id="2167727">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2167783">func</span>&nbsp;<span class="ident" id="2167788">Chtimes</span><span class="op" id="2167795">(</span><span class="ident" id="2167796">name</span>&nbsp;<span class="builtintype" id="2167801">string</span><span class="op" id="2167807">,</span>&nbsp;<span class="ident" id="2167809">atime</span>&nbsp;<span class="ident" id="2167815">time</span><span class="op" id="2167819">.</span><span class="ident" id="2167820">Time</span><span class="op" id="2167824">,</span>&nbsp;<span class="ident" id="2167826">mtime</span>&nbsp;<span class="ident" id="2167832">time</span><span class="op" id="2167836">.</span><span class="ident" id="2167837">Time</span><span class="op" id="2167841">)</span>&nbsp;<span class="builtintype" id="2167843">error</span>&nbsp;<span class="op" id="2167849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167852">var</span>&nbsp;<span class="ident" id="2167856">utimes</span>&nbsp;<span class="op" id="2167863">[</span><span class="num" id="2167864">2</span><span class="op" id="2167865">]</span><span class="ident" id="2167866">syscall</span><span class="op" id="2167873">.</span><span class="ident" id="2167874">Timespec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167884">utimes</span><span class="op" id="2167890">[</span><span class="num" id="2167891">0</span><span class="op" id="2167892">]</span>&nbsp;<span class="op" id="2167894">=</span>&nbsp;<span class="ident" id="2167896">syscall</span><span class="op" id="2167903">.</span><span class="ident" id="2167904">NsecToTimespec</span><span class="op" id="2167918">(</span><span class="ident" id="2167919">atime</span><span class="op" id="2167924">.</span><span class="ident" id="2167925">UnixNano</span><span class="op" id="2167933">(</span><span class="op" id="2167934">)</span><span class="op" id="2167935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167938">utimes</span><span class="op" id="2167944">[</span><span class="num" id="2167945">1</span><span class="op" id="2167946">]</span>&nbsp;<span class="op" id="2167948">=</span>&nbsp;<span class="ident" id="2167950">syscall</span><span class="op" id="2167957">.</span><span class="ident" id="2167958">NsecToTimespec</span><span class="op" id="2167972">(</span><span class="ident" id="2167973">mtime</span><span class="op" id="2167978">.</span><span class="ident" id="2167979">UnixNano</span><span class="op" id="2167987">(</span><span class="op" id="2167988">)</span><span class="op" id="2167989">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167992">if</span>&nbsp;<span class="ident" id="2167995">e</span>&nbsp;<span class="op" id="2167997">:=</span>&nbsp;<span class="ident" id="2168000">syscall</span><span class="op" id="2168007">.</span><span class="ident" id="2168008">UtimesNano</span><span class="op" id="2168018">(</span><span class="ident" id="2168019">name</span><span class="op" id="2168023">,</span>&nbsp;<span class="ident" id="2168025">utimes</span><span class="op" id="2168031">[</span><span class="num" id="2168032">0</span><span class="op" id="2168033">:</span><span class="op" id="2168034">]</span><span class="op" id="2168035">)</span><span class="op" id="2168036">;</span>&nbsp;<span class="ident" id="2168038">e</span>&nbsp;<span class="op" id="2168040">!=</span>&nbsp;<span class="ident" id="2168043">nil</span>&nbsp;<span class="op" id="2168047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168051">return</span>&nbsp;<span class="op" id="2168058">&amp;</span><span class="ident" id="2168059">PathError</span><span class="op" id="2168068">{</span><span class="string" id="2168069">&#34;chtimes&#34;</span><span class="op" id="2168078">,</span>&nbsp;<span class="ident" id="2168080">name</span><span class="op" id="2168084">,</span>&nbsp;<span class="ident" id="2168086">e</span><span class="op" id="2168087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168093">return</span>&nbsp;<span class="ident" id="2168100">nil</span><br>
<span class="lineno"></span><span class="op" id="2168104">}</span>
</div>
</body>
</html>
