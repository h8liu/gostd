<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5337946">package</span>&nbsp;<span class="ident" id="5337954">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5337960">import</span>&nbsp;<span class="op" id="5337967">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5337970">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5337992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5337995">var</span>&nbsp;<span class="op" id="5337999">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5338002">//&nbsp;op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338009">opSysMap</span>&nbsp;<span class="op" id="5338018">=</span>&nbsp;<span class="keyword" id="5338020">map</span><span class="op" id="5338023">[</span><span class="builtintype" id="5338024">string</span><span class="op" id="5338030">]</span><span class="builtintype" id="5338031">uint32</span><span class="op" id="5338037">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5338041">&#34;halt&#34;</span><span class="op" id="5338047">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5338052">64</span><span class="op" id="5338054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5338058">&#34;syscall&#34;</span><span class="op" id="5338067">:</span>&nbsp;<span class="num" id="5338069">65</span><span class="op" id="5338071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5338075">&#34;usermod&#34;</span><span class="op" id="5338084">:</span>&nbsp;<span class="num" id="5338086">66</span><span class="op" id="5338088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5338092">&#34;iret&#34;</span><span class="op" id="5338098">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5338103">68</span><span class="op" id="5338105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338108">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5338112">//&nbsp;op&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338123">opSys1Map</span>&nbsp;<span class="op" id="5338133">=</span>&nbsp;<span class="keyword" id="5338135">map</span><span class="op" id="5338138">[</span><span class="builtintype" id="5338139">string</span><span class="op" id="5338145">]</span><span class="builtintype" id="5338146">uint32</span><span class="op" id="5338152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5338156">&#34;vtable&#34;</span><span class="op" id="5338164">:</span>&nbsp;<span class="num" id="5338166">67</span><span class="op" id="5338168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5338172">&#34;cpuid&#34;</span><span class="op" id="5338179">:</span>&nbsp;&nbsp;<span class="num" id="5338182">69</span><span class="op" id="5338184">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338187">}</span><br>
<span class="lineno"></span><span class="op" id="5338189">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5338192">func</span>&nbsp;<span class="ident" id="5338197">makeInstSys</span><span class="op" id="5338208">(</span><span class="ident" id="5338209">op</span><span class="op" id="5338211">,</span>&nbsp;<span class="ident" id="5338213">reg</span>&nbsp;<span class="builtintype" id="5338217">uint32</span><span class="op" id="5338223">)</span>&nbsp;<span class="op" id="5338225">*</span><span class="ident" id="5338226"><a href="/lonnie.io/e8vm/asm8/inst.go.html#5330311">inst</a></span>&nbsp;<span class="op" id="5338231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338234">ret</span>&nbsp;<span class="op" id="5338238">:=</span>&nbsp;<span class="op" id="5338241">(</span><span class="op" id="5338242">(</span><span class="ident" id="5338243"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338209">op</a></span>&nbsp;<span class="op" id="5338246">&amp;</span>&nbsp;<span class="num" id="5338248">0xff</span><span class="op" id="5338252">)</span>&nbsp;<span class="op" id="5338254">&lt;&lt;</span>&nbsp;<span class="num" id="5338257">24</span><span class="op" id="5338259">)</span>&nbsp;<span class="op" id="5338261">|</span>&nbsp;<span class="op" id="5338263">(</span><span class="op" id="5338264">(</span><span class="ident" id="5338265"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338213">reg</a></span>&nbsp;<span class="op" id="5338269">&amp;</span>&nbsp;<span class="num" id="5338271">0x7</span><span class="op" id="5338274">)</span>&nbsp;<span class="op" id="5338276">&lt;&lt;</span>&nbsp;<span class="num" id="5338279">21</span><span class="op" id="5338281">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338284">return</span>&nbsp;<span class="op" id="5338291">&amp;</span><span class="ident" id="5338292"><a href="/lonnie.io/e8vm/asm8/inst.go.html#5330311">inst</a></span><span class="op" id="5338296">{</span><span class="ident" id="5338297">inst</span><span class="op" id="5338301">:</span>&nbsp;<span class="ident" id="5338303"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338234">ret</a></span><span class="op" id="5338306">}</span><br>
<span class="lineno"></span><span class="op" id="5338308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5338311">func</span>&nbsp;<span class="ident" id="5338316">parseInstSys</span><span class="op" id="5338328">(</span><span class="ident" id="5338329">p</span>&nbsp;<span class="op" id="5338331">*</span><span class="ident" id="5338332"><a href="/lonnie.io/e8vm/asm8/parser.go.html#5352831">parser</a></span><span class="op" id="5338338">,</span>&nbsp;<span class="ident" id="5338340">ops</span>&nbsp;<span class="op" id="5338344">[</span><span class="op" id="5338345">]</span><span class="op" id="5338346">*</span><span class="ident" id="5338347"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5337970">lex8</a></span><span class="op" id="5338351">.</span><span class="ident" id="5338352">Token</span><span class="op" id="5338357">)</span>&nbsp;<span class="op" id="5338359">(</span><span class="op" id="5338360">*</span><span class="ident" id="5338361"><a href="/lonnie.io/e8vm/asm8/inst.go.html#5330311">inst</a></span><span class="op" id="5338365">,</span>&nbsp;<span class="builtintype" id="5338367">bool</span><span class="op" id="5338371">)</span>&nbsp;<span class="op" id="5338373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338376">op0</span>&nbsp;<span class="op" id="5338380">:=</span>&nbsp;<span class="ident" id="5338383"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338340">ops</a></span><span class="op" id="5338386">[</span><span class="num" id="5338387">0</span><span class="op" id="5338388">]</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338391">opName</span>&nbsp;<span class="op" id="5338398">:=</span>&nbsp;<span class="ident" id="5338401"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338376">op0</a></span><span class="op" id="5338404">.</span><span class="ident" id="5338405">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338410">args</span>&nbsp;<span class="op" id="5338415">:=</span>&nbsp;<span class="ident" id="5338418"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338340">ops</a></span><span class="op" id="5338421">[</span><span class="num" id="5338422">1</span><span class="op" id="5338423">:</span><span class="op" id="5338424">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338427">var</span>&nbsp;<span class="ident" id="5338431">op</span><span class="op" id="5338433">,</span>&nbsp;<span class="ident" id="5338435">reg</span>&nbsp;<span class="builtintype" id="5338439">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338448">argCount</span>&nbsp;<span class="op" id="5338457">:=</span>&nbsp;<span class="keyword" id="5338460">func</span><span class="op" id="5338464">(</span><span class="ident" id="5338465">n</span>&nbsp;<span class="builtintype" id="5338467">int</span><span class="op" id="5338470">)</span>&nbsp;<span class="builtintype" id="5338472">bool</span>&nbsp;<span class="op" id="5338477">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338481">if</span>&nbsp;<span class="op" id="5338484">!</span><span class="ident" id="5338485"><a href="/lonnie.io/e8vm/asm8/parse_arg.go.html#5345685">argCount</a></span><span class="op" id="5338493">(</span><span class="ident" id="5338494"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338329">p</a></span><span class="op" id="5338495">,</span>&nbsp;<span class="ident" id="5338497"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338340">ops</a></span><span class="op" id="5338500">,</span>&nbsp;<span class="ident" id="5338502"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338465">n</a></span><span class="op" id="5338503">)</span>&nbsp;<span class="op" id="5338505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338510">return</span>&nbsp;<span class="ident" id="5338517">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338530">if</span>&nbsp;<span class="ident" id="5338533"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338465">n</a></span>&nbsp;<span class="op" id="5338535">&gt;=</span>&nbsp;<span class="num" id="5338538">1</span>&nbsp;<span class="op" id="5338540">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338545"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338435">reg</a></span>&nbsp;<span class="op" id="5338549">=</span>&nbsp;<span class="ident" id="5338551"><a href="/lonnie.io/e8vm/asm8/parse_reg.go.html#5349323">parseReg</a></span><span class="op" id="5338559">(</span><span class="ident" id="5338560"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338329">p</a></span><span class="op" id="5338561">,</span>&nbsp;<span class="ident" id="5338563"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338410">args</a></span><span class="op" id="5338567">[</span><span class="num" id="5338568">0</span><span class="op" id="5338569">]</span><span class="op" id="5338570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338578">return</span>&nbsp;<span class="ident" id="5338585">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338595">var</span>&nbsp;<span class="ident" id="5338599">found</span>&nbsp;<span class="builtintype" id="5338605">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338611">if</span>&nbsp;<span class="ident" id="5338614"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338431">op</a></span><span class="op" id="5338616">,</span>&nbsp;<span class="ident" id="5338618"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338599">found</a></span>&nbsp;<span class="op" id="5338624">=</span>&nbsp;<span class="ident" id="5338626"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338009">opSysMap</a></span><span class="op" id="5338634">[</span><span class="ident" id="5338635"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338391">opName</a></span><span class="op" id="5338641">]</span><span class="op" id="5338642">;</span>&nbsp;<span class="ident" id="5338644"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338599">found</a></span>&nbsp;<span class="op" id="5338650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5338654">//&nbsp;op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338662"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338448">argCount</a></span><span class="op" id="5338670">(</span><span class="num" id="5338671">0</span><span class="op" id="5338672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338675">}</span>&nbsp;<span class="keyword" id="5338677">else</span>&nbsp;<span class="keyword" id="5338682">if</span>&nbsp;<span class="ident" id="5338685"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338431">op</a></span><span class="op" id="5338687">,</span>&nbsp;<span class="ident" id="5338689"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338599">found</a></span>&nbsp;<span class="op" id="5338695">=</span>&nbsp;<span class="ident" id="5338697"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338123">opSys1Map</a></span><span class="op" id="5338706">[</span><span class="ident" id="5338707"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338391">opName</a></span><span class="op" id="5338713">]</span><span class="op" id="5338714">;</span>&nbsp;<span class="ident" id="5338716"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338599">found</a></span>&nbsp;<span class="op" id="5338722">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5338726">//&nbsp;op&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5338738"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338448">argCount</a></span><span class="op" id="5338746">(</span><span class="num" id="5338747">1</span><span class="op" id="5338748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338751">}</span>&nbsp;<span class="keyword" id="5338753">else</span>&nbsp;<span class="op" id="5338758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338762">return</span>&nbsp;<span class="ident" id="5338769">nil</span><span class="op" id="5338772">,</span>&nbsp;<span class="ident" id="5338774">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5338781">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5338785">return</span>&nbsp;<span class="ident" id="5338792"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338197">makeInstSys</a></span><span class="op" id="5338803">(</span><span class="ident" id="5338804"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338431">op</a></span><span class="op" id="5338806">,</span>&nbsp;<span class="ident" id="5338808"><a href="/lonnie.io/e8vm/asm8/inst_sys.go.html#5338435">reg</a></span><span class="op" id="5338811">)</span><span class="op" id="5338812">,</span>&nbsp;<span class="ident" id="5338814">true</span><br>
<span class="lineno"></span><span class="op" id="5338819">}</span>
</div>
</body>
</html>
