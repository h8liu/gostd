<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/token</h2>
<ul>
<li><a href="/gostd/go/token/position.go.html">position.go</a></li>
<li><a href="/gostd/go/token/position_test.go.html" class="current">position_test.go</a></li>
<li><a href="/gostd/go/token/serialize.go.html">serialize.go</a></li>
<li><a href="/gostd/go/token/serialize_test.go.html">serialize_test.go</a></li>
<li><a href="/gostd/go/token/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8192603">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8192658">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8192712">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8192763">package</span>&nbsp;<span class="ident" id="8192771">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8192778">import</span>&nbsp;<span class="op" id="8192785">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8192788">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8192795">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8192808">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8192816">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8192826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8192829">func</span>&nbsp;<span class="ident" id="8192834">checkPos</span><span class="op" id="8192842">(</span><span class="ident" id="8192843">t</span>&nbsp;<span class="op" id="8192845">*</span><span class="ident" id="8192846">testing</span><span class="op" id="8192853">.</span><span class="ident" id="8192854">T</span><span class="op" id="8192855">,</span>&nbsp;<span class="ident" id="8192857">msg</span>&nbsp;<span class="builtintype" id="8192861">string</span><span class="op" id="8192867">,</span>&nbsp;<span class="ident" id="8192869">got</span><span class="op" id="8192872">,</span>&nbsp;<span class="ident" id="8192874">want</span>&nbsp;<span class="ident" id="8192879">Position</span><span class="op" id="8192887">)</span>&nbsp;<span class="op" id="8192889">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8192892">if</span>&nbsp;<span class="ident" id="8192895">got</span><span class="op" id="8192898">.</span><span class="ident" id="8192899">Filename</span>&nbsp;<span class="op" id="8192908">!=</span>&nbsp;<span class="ident" id="8192911">want</span><span class="op" id="8192915">.</span><span class="ident" id="8192916">Filename</span>&nbsp;<span class="op" id="8192925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8192929">t</span><span class="op" id="8192930">.</span><span class="ident" id="8192931">Errorf</span><span class="op" id="8192937">(</span><span class="string" id="8192938">&#34;%s:&nbsp;got&nbsp;filename&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8192970">,</span>&nbsp;<span class="ident" id="8192972">msg</span><span class="op" id="8192975">,</span>&nbsp;<span class="ident" id="8192977">got</span><span class="op" id="8192980">.</span><span class="ident" id="8192981">Filename</span><span class="op" id="8192989">,</span>&nbsp;<span class="ident" id="8192991">want</span><span class="op" id="8192995">.</span><span class="ident" id="8192996">Filename</span><span class="op" id="8193004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8193010">if</span>&nbsp;<span class="ident" id="8193013">got</span><span class="op" id="8193016">.</span><span class="ident" id="8193017">Offset</span>&nbsp;<span class="op" id="8193024">!=</span>&nbsp;<span class="ident" id="8193027">want</span><span class="op" id="8193031">.</span><span class="ident" id="8193032">Offset</span>&nbsp;<span class="op" id="8193039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193043">t</span><span class="op" id="8193044">.</span><span class="ident" id="8193045">Errorf</span><span class="op" id="8193051">(</span><span class="string" id="8193052">&#34;%s:&nbsp;got&nbsp;offset&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8193082">,</span>&nbsp;<span class="ident" id="8193084">msg</span><span class="op" id="8193087">,</span>&nbsp;<span class="ident" id="8193089">got</span><span class="op" id="8193092">.</span><span class="ident" id="8193093">Offset</span><span class="op" id="8193099">,</span>&nbsp;<span class="ident" id="8193101">want</span><span class="op" id="8193105">.</span><span class="ident" id="8193106">Offset</span><span class="op" id="8193112">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8193118">if</span>&nbsp;<span class="ident" id="8193121">got</span><span class="op" id="8193124">.</span><span class="ident" id="8193125">Line</span>&nbsp;<span class="op" id="8193130">!=</span>&nbsp;<span class="ident" id="8193133">want</span><span class="op" id="8193137">.</span><span class="ident" id="8193138">Line</span>&nbsp;<span class="op" id="8193143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193147">t</span><span class="op" id="8193148">.</span><span class="ident" id="8193149">Errorf</span><span class="op" id="8193155">(</span><span class="string" id="8193156">&#34;%s:&nbsp;got&nbsp;line&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8193184">,</span>&nbsp;<span class="ident" id="8193186">msg</span><span class="op" id="8193189">,</span>&nbsp;<span class="ident" id="8193191">got</span><span class="op" id="8193194">.</span><span class="ident" id="8193195">Line</span><span class="op" id="8193199">,</span>&nbsp;<span class="ident" id="8193201">want</span><span class="op" id="8193205">.</span><span class="ident" id="8193206">Line</span><span class="op" id="8193210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8193216">if</span>&nbsp;<span class="ident" id="8193219">got</span><span class="op" id="8193222">.</span><span class="ident" id="8193223">Column</span>&nbsp;<span class="op" id="8193230">!=</span>&nbsp;<span class="ident" id="8193233">want</span><span class="op" id="8193237">.</span><span class="ident" id="8193238">Column</span>&nbsp;<span class="op" id="8193245">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193249">t</span><span class="op" id="8193250">.</span><span class="ident" id="8193251">Errorf</span><span class="op" id="8193257">(</span><span class="string" id="8193258">&#34;%s:&nbsp;got&nbsp;column&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8193288">,</span>&nbsp;<span class="ident" id="8193290">msg</span><span class="op" id="8193293">,</span>&nbsp;<span class="ident" id="8193295">got</span><span class="op" id="8193298">.</span><span class="ident" id="8193299">Column</span><span class="op" id="8193305">,</span>&nbsp;<span class="ident" id="8193307">want</span><span class="op" id="8193311">.</span><span class="ident" id="8193312">Column</span><span class="op" id="8193318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193321">}</span><br>
<span class="lineno"></span><span class="op" id="8193323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8193326">func</span>&nbsp;<span class="ident" id="8193331">TestNoPos</span><span class="op" id="8193340">(</span><span class="ident" id="8193341">t</span>&nbsp;<span class="op" id="8193343">*</span><span class="ident" id="8193344">testing</span><span class="op" id="8193351">.</span><span class="ident" id="8193352">T</span><span class="op" id="8193353">)</span>&nbsp;<span class="op" id="8193355">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8193358">if</span>&nbsp;<span class="ident" id="8193361">NoPos</span><span class="op" id="8193366">.</span><span class="ident" id="8193367">IsValid</span><span class="op" id="8193374">(</span><span class="op" id="8193375">)</span>&nbsp;<span class="op" id="8193377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193381">t</span><span class="op" id="8193382">.</span><span class="ident" id="8193383">Errorf</span><span class="op" id="8193389">(</span><span class="string" id="8193390">&#34;NoPos&nbsp;should&nbsp;not&nbsp;be&nbsp;valid&#34;</span><span class="op" id="8193417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8193423">var</span>&nbsp;<span class="ident" id="8193427">fset</span>&nbsp;<span class="op" id="8193432">*</span><span class="ident" id="8193433">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193442">checkPos</span><span class="op" id="8193450">(</span><span class="ident" id="8193451">t</span><span class="op" id="8193452">,</span>&nbsp;<span class="string" id="8193454">&#34;nil&nbsp;NoPos&#34;</span><span class="op" id="8193465">,</span>&nbsp;<span class="ident" id="8193467">fset</span><span class="op" id="8193471">.</span><span class="ident" id="8193472">Position</span><span class="op" id="8193480">(</span><span class="ident" id="8193481">NoPos</span><span class="op" id="8193486">)</span><span class="op" id="8193487">,</span>&nbsp;<span class="ident" id="8193489">Position</span><span class="op" id="8193497">{</span><span class="op" id="8193498">}</span><span class="op" id="8193499">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193502">fset</span>&nbsp;<span class="op" id="8193507">=</span>&nbsp;<span class="ident" id="8193509">NewFileSet</span><span class="op" id="8193519">(</span><span class="op" id="8193520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193523">checkPos</span><span class="op" id="8193531">(</span><span class="ident" id="8193532">t</span><span class="op" id="8193533">,</span>&nbsp;<span class="string" id="8193535">&#34;fset&nbsp;NoPos&#34;</span><span class="op" id="8193547">,</span>&nbsp;<span class="ident" id="8193549">fset</span><span class="op" id="8193553">.</span><span class="ident" id="8193554">Position</span><span class="op" id="8193562">(</span><span class="ident" id="8193563">NoPos</span><span class="op" id="8193568">)</span><span class="op" id="8193569">,</span>&nbsp;<span class="ident" id="8193571">Position</span><span class="op" id="8193579">{</span><span class="op" id="8193580">}</span><span class="op" id="8193581">)</span><br>
<span class="lineno"></span><span class="op" id="8193583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8193586">var</span>&nbsp;<span class="ident" id="8193590">tests</span>&nbsp;<span class="op" id="8193596">=</span>&nbsp;<span class="op" id="8193598">[</span><span class="op" id="8193599">]</span><span class="keyword" id="8193600">struct</span>&nbsp;<span class="op" id="8193607">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193610">filename</span>&nbsp;<span class="builtintype" id="8193619">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193627">source</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8193636">[</span><span class="op" id="8193637">]</span><span class="builtintype" id="8193638">byte</span>&nbsp;<span class="comment" id="8193643">//&nbsp;may&nbsp;be&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193658">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8193667">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8193672">lines</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193681">[</span><span class="op" id="8193682">]</span><span class="builtintype" id="8193683">int</span><br>
<span class="lineno"></span><span class="op" id="8193687">}</span><span class="op" id="8193688">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193691">{</span><span class="string" id="8193692">&#34;a&#34;</span><span class="op" id="8193695">,</span>&nbsp;<span class="op" id="8193697">[</span><span class="op" id="8193698">]</span><span class="builtintype" id="8193699">byte</span><span class="op" id="8193703">{</span><span class="op" id="8193704">}</span><span class="op" id="8193705">,</span>&nbsp;<span class="num" id="8193707">0</span><span class="op" id="8193708">,</span>&nbsp;<span class="op" id="8193710">[</span><span class="op" id="8193711">]</span><span class="builtintype" id="8193712">int</span><span class="op" id="8193715">{</span><span class="op" id="8193716">}</span><span class="op" id="8193717">}</span><span class="op" id="8193718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193721">{</span><span class="string" id="8193722">&#34;b&#34;</span><span class="op" id="8193725">,</span>&nbsp;<span class="op" id="8193727">[</span><span class="op" id="8193728">]</span><span class="builtintype" id="8193729">byte</span><span class="op" id="8193733">(</span><span class="string" id="8193734">&#34;01234&#34;</span><span class="op" id="8193741">)</span><span class="op" id="8193742">,</span>&nbsp;<span class="num" id="8193744">5</span><span class="op" id="8193745">,</span>&nbsp;<span class="op" id="8193747">[</span><span class="op" id="8193748">]</span><span class="builtintype" id="8193749">int</span><span class="op" id="8193752">{</span><span class="num" id="8193753">0</span><span class="op" id="8193754">}</span><span class="op" id="8193755">}</span><span class="op" id="8193756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193759">{</span><span class="string" id="8193760">&#34;c&#34;</span><span class="op" id="8193763">,</span>&nbsp;<span class="op" id="8193765">[</span><span class="op" id="8193766">]</span><span class="builtintype" id="8193767">byte</span><span class="op" id="8193771">(</span><span class="string" id="8193772">&#34;\n\n\n\n\n\n\n\n\n&#34;</span><span class="op" id="8193792">)</span><span class="op" id="8193793">,</span>&nbsp;<span class="num" id="8193795">9</span><span class="op" id="8193796">,</span>&nbsp;<span class="op" id="8193798">[</span><span class="op" id="8193799">]</span><span class="builtintype" id="8193800">int</span><span class="op" id="8193803">{</span><span class="num" id="8193804">0</span><span class="op" id="8193805">,</span>&nbsp;<span class="num" id="8193807">1</span><span class="op" id="8193808">,</span>&nbsp;<span class="num" id="8193810">2</span><span class="op" id="8193811">,</span>&nbsp;<span class="num" id="8193813">3</span><span class="op" id="8193814">,</span>&nbsp;<span class="num" id="8193816">4</span><span class="op" id="8193817">,</span>&nbsp;<span class="num" id="8193819">5</span><span class="op" id="8193820">,</span>&nbsp;<span class="num" id="8193822">6</span><span class="op" id="8193823">,</span>&nbsp;<span class="num" id="8193825">7</span><span class="op" id="8193826">,</span>&nbsp;<span class="num" id="8193828">8</span><span class="op" id="8193829">}</span><span class="op" id="8193830">}</span><span class="op" id="8193831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193834">{</span><span class="string" id="8193835">&#34;d&#34;</span><span class="op" id="8193838">,</span>&nbsp;<span class="builtintype" id="8193840">nil</span><span class="op" id="8193843">,</span>&nbsp;<span class="num" id="8193845">100</span><span class="op" id="8193848">,</span>&nbsp;<span class="op" id="8193850">[</span><span class="op" id="8193851">]</span><span class="builtintype" id="8193852">int</span><span class="op" id="8193855">{</span><span class="num" id="8193856">0</span><span class="op" id="8193857">,</span>&nbsp;<span class="num" id="8193859">5</span><span class="op" id="8193860">,</span>&nbsp;<span class="num" id="8193862">10</span><span class="op" id="8193864">,</span>&nbsp;<span class="num" id="8193866">20</span><span class="op" id="8193868">,</span>&nbsp;<span class="num" id="8193870">30</span><span class="op" id="8193872">,</span>&nbsp;<span class="num" id="8193874">70</span><span class="op" id="8193876">,</span>&nbsp;<span class="num" id="8193878">71</span><span class="op" id="8193880">,</span>&nbsp;<span class="num" id="8193882">72</span><span class="op" id="8193884">,</span>&nbsp;<span class="num" id="8193886">80</span><span class="op" id="8193888">,</span>&nbsp;<span class="num" id="8193890">85</span><span class="op" id="8193892">,</span>&nbsp;<span class="num" id="8193894">90</span><span class="op" id="8193896">,</span>&nbsp;<span class="num" id="8193898">99</span><span class="op" id="8193900">}</span><span class="op" id="8193901">}</span><span class="op" id="8193902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193905">{</span><span class="string" id="8193906">&#34;e&#34;</span><span class="op" id="8193909">,</span>&nbsp;<span class="builtintype" id="8193911">nil</span><span class="op" id="8193914">,</span>&nbsp;<span class="num" id="8193916">777</span><span class="op" id="8193919">,</span>&nbsp;<span class="op" id="8193921">[</span><span class="op" id="8193922">]</span><span class="builtintype" id="8193923">int</span><span class="op" id="8193926">{</span><span class="num" id="8193927">0</span><span class="op" id="8193928">,</span>&nbsp;<span class="num" id="8193930">80</span><span class="op" id="8193932">,</span>&nbsp;<span class="num" id="8193934">100</span><span class="op" id="8193937">,</span>&nbsp;<span class="num" id="8193939">120</span><span class="op" id="8193942">,</span>&nbsp;<span class="num" id="8193944">130</span><span class="op" id="8193947">,</span>&nbsp;<span class="num" id="8193949">180</span><span class="op" id="8193952">,</span>&nbsp;<span class="num" id="8193954">267</span><span class="op" id="8193957">,</span>&nbsp;<span class="num" id="8193959">455</span><span class="op" id="8193962">,</span>&nbsp;<span class="num" id="8193964">500</span><span class="op" id="8193967">,</span>&nbsp;<span class="num" id="8193969">567</span><span class="op" id="8193972">,</span>&nbsp;<span class="num" id="8193974">620</span><span class="op" id="8193977">}</span><span class="op" id="8193978">}</span><span class="op" id="8193979">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8193982">{</span><span class="string" id="8193983">&#34;f&#34;</span><span class="op" id="8193986">,</span>&nbsp;<span class="op" id="8193988">[</span><span class="op" id="8193989">]</span><span class="builtintype" id="8193990">byte</span><span class="op" id="8193994">(</span><span class="string" id="8193995">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;&#34;</span><span class="op" id="8194024">)</span><span class="op" id="8194025">,</span>&nbsp;<span class="num" id="8194027">23</span><span class="op" id="8194029">,</span>&nbsp;<span class="op" id="8194031">[</span><span class="op" id="8194032">]</span><span class="builtintype" id="8194033">int</span><span class="op" id="8194036">{</span><span class="num" id="8194037">0</span><span class="op" id="8194038">,</span>&nbsp;<span class="num" id="8194040">10</span><span class="op" id="8194042">,</span>&nbsp;<span class="num" id="8194044">11</span><span class="op" id="8194046">}</span><span class="op" id="8194047">}</span><span class="op" id="8194048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194051">{</span><span class="string" id="8194052">&#34;g&#34;</span><span class="op" id="8194055">,</span>&nbsp;<span class="op" id="8194057">[</span><span class="op" id="8194058">]</span><span class="builtintype" id="8194059">byte</span><span class="op" id="8194063">(</span><span class="string" id="8194064">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;\n&#34;</span><span class="op" id="8194095">)</span><span class="op" id="8194096">,</span>&nbsp;<span class="num" id="8194098">24</span><span class="op" id="8194100">,</span>&nbsp;<span class="op" id="8194102">[</span><span class="op" id="8194103">]</span><span class="builtintype" id="8194104">int</span><span class="op" id="8194107">{</span><span class="num" id="8194108">0</span><span class="op" id="8194109">,</span>&nbsp;<span class="num" id="8194111">10</span><span class="op" id="8194113">,</span>&nbsp;<span class="num" id="8194115">11</span><span class="op" id="8194117">}</span><span class="op" id="8194118">}</span><span class="op" id="8194119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194122">{</span><span class="string" id="8194123">&#34;h&#34;</span><span class="op" id="8194126">,</span>&nbsp;<span class="op" id="8194128">[</span><span class="op" id="8194129">]</span><span class="builtintype" id="8194130">byte</span><span class="op" id="8194134">(</span><span class="string" id="8194135">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;\n&nbsp;&#34;</span><span class="op" id="8194167">)</span><span class="op" id="8194168">,</span>&nbsp;<span class="num" id="8194170">25</span><span class="op" id="8194172">,</span>&nbsp;<span class="op" id="8194174">[</span><span class="op" id="8194175">]</span><span class="builtintype" id="8194176">int</span><span class="op" id="8194179">{</span><span class="num" id="8194180">0</span><span class="op" id="8194181">,</span>&nbsp;<span class="num" id="8194183">10</span><span class="op" id="8194185">,</span>&nbsp;<span class="num" id="8194187">11</span><span class="op" id="8194189">,</span>&nbsp;<span class="num" id="8194191">24</span><span class="op" id="8194193">}</span><span class="op" id="8194194">}</span><span class="op" id="8194195">,</span><br>
<span class="lineno"></span><span class="op" id="8194197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="8194200">func</span>&nbsp;<span class="ident" id="8194205">linecol</span><span class="op" id="8194212">(</span><span class="ident" id="8194213">lines</span>&nbsp;<span class="op" id="8194219">[</span><span class="op" id="8194220">]</span><span class="builtintype" id="8194221">int</span><span class="op" id="8194224">,</span>&nbsp;<span class="ident" id="8194226">offs</span>&nbsp;<span class="builtintype" id="8194231">int</span><span class="op" id="8194234">)</span>&nbsp;<span class="op" id="8194236">(</span><span class="builtintype" id="8194237">int</span><span class="op" id="8194240">,</span>&nbsp;<span class="builtintype" id="8194242">int</span><span class="op" id="8194245">)</span>&nbsp;<span class="op" id="8194247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194250">prevLineOffs</span>&nbsp;<span class="op" id="8194263">:=</span>&nbsp;<span class="num" id="8194266">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194269">for</span>&nbsp;<span class="ident" id="8194273">line</span><span class="op" id="8194277">,</span>&nbsp;<span class="ident" id="8194279">lineOffs</span>&nbsp;<span class="op" id="8194288">:=</span>&nbsp;<span class="keyword" id="8194291">range</span>&nbsp;<span class="ident" id="8194297">lines</span>&nbsp;<span class="op" id="8194303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194307">if</span>&nbsp;<span class="ident" id="8194310">offs</span>&nbsp;<span class="op" id="8194315">&lt;</span>&nbsp;<span class="ident" id="8194317">lineOffs</span>&nbsp;<span class="op" id="8194326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194331">return</span>&nbsp;<span class="ident" id="8194338">line</span><span class="op" id="8194342">,</span>&nbsp;<span class="ident" id="8194344">offs</span>&nbsp;<span class="op" id="8194349">-</span>&nbsp;<span class="ident" id="8194351">prevLineOffs</span>&nbsp;<span class="op" id="8194364">+</span>&nbsp;<span class="num" id="8194366">1</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194374">prevLineOffs</span>&nbsp;<span class="op" id="8194387">=</span>&nbsp;<span class="ident" id="8194389">lineOffs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194402">return</span>&nbsp;<span class="builtinfunc" id="8194409">len</span><span class="op" id="8194412">(</span><span class="ident" id="8194413">lines</span><span class="op" id="8194418">)</span><span class="op" id="8194419">,</span>&nbsp;<span class="ident" id="8194421">offs</span>&nbsp;<span class="op" id="8194426">-</span>&nbsp;<span class="ident" id="8194428">prevLineOffs</span>&nbsp;<span class="op" id="8194441">+</span>&nbsp;<span class="num" id="8194443">1</span><br>
<span class="lineno"></span><span class="op" id="8194445">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8194448">func</span>&nbsp;<span class="ident" id="8194453">verifyPositions</span><span class="op" id="8194468">(</span><span class="ident" id="8194469">t</span>&nbsp;<span class="op" id="8194471">*</span><span class="ident" id="8194472">testing</span><span class="op" id="8194479">.</span><span class="ident" id="8194480">T</span><span class="op" id="8194481">,</span>&nbsp;<span class="ident" id="8194483">fset</span>&nbsp;<span class="op" id="8194488">*</span><span class="ident" id="8194489">FileSet</span><span class="op" id="8194496">,</span>&nbsp;<span class="ident" id="8194498">f</span>&nbsp;<span class="op" id="8194500">*</span><span class="ident" id="8194501">File</span><span class="op" id="8194505">,</span>&nbsp;<span class="ident" id="8194507">lines</span>&nbsp;<span class="op" id="8194513">[</span><span class="op" id="8194514">]</span><span class="builtintype" id="8194515">int</span><span class="op" id="8194518">)</span>&nbsp;<span class="op" id="8194520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194523">for</span>&nbsp;<span class="ident" id="8194527">offs</span>&nbsp;<span class="op" id="8194532">:=</span>&nbsp;<span class="num" id="8194535">0</span><span class="op" id="8194536">;</span>&nbsp;<span class="ident" id="8194538">offs</span>&nbsp;<span class="op" id="8194543">&lt;</span>&nbsp;<span class="ident" id="8194545">f</span><span class="op" id="8194546">.</span><span class="ident" id="8194547">Size</span><span class="op" id="8194551">(</span><span class="op" id="8194552">)</span><span class="op" id="8194553">;</span>&nbsp;<span class="ident" id="8194555">offs</span><span class="op" id="8194559">++</span>&nbsp;<span class="op" id="8194562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194566">p</span>&nbsp;<span class="op" id="8194568">:=</span>&nbsp;<span class="ident" id="8194571">f</span><span class="op" id="8194572">.</span><span class="ident" id="8194573">Pos</span><span class="op" id="8194576">(</span><span class="ident" id="8194577">offs</span><span class="op" id="8194581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194585">offs2</span>&nbsp;<span class="op" id="8194591">:=</span>&nbsp;<span class="ident" id="8194594">f</span><span class="op" id="8194595">.</span><span class="ident" id="8194596">Offset</span><span class="op" id="8194602">(</span><span class="ident" id="8194603">p</span><span class="op" id="8194604">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8194608">if</span>&nbsp;<span class="ident" id="8194611">offs2</span>&nbsp;<span class="op" id="8194617">!=</span>&nbsp;<span class="ident" id="8194620">offs</span>&nbsp;<span class="op" id="8194625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194630">t</span><span class="op" id="8194631">.</span><span class="ident" id="8194632">Errorf</span><span class="op" id="8194638">(</span><span class="string" id="8194639">&#34;%s,&nbsp;Offset:&nbsp;got&nbsp;offset&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8194675">,</span>&nbsp;<span class="ident" id="8194677">f</span><span class="op" id="8194678">.</span><span class="ident" id="8194679">Name</span><span class="op" id="8194683">(</span><span class="op" id="8194684">)</span><span class="op" id="8194685">,</span>&nbsp;<span class="ident" id="8194687">offs2</span><span class="op" id="8194692">,</span>&nbsp;<span class="ident" id="8194694">offs</span><span class="op" id="8194698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194706">line</span><span class="op" id="8194710">,</span>&nbsp;<span class="ident" id="8194712">col</span>&nbsp;<span class="op" id="8194716">:=</span>&nbsp;<span class="ident" id="8194719">linecol</span><span class="op" id="8194726">(</span><span class="ident" id="8194727">lines</span><span class="op" id="8194732">,</span>&nbsp;<span class="ident" id="8194734">offs</span><span class="op" id="8194738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194742">msg</span>&nbsp;<span class="op" id="8194746">:=</span>&nbsp;<span class="ident" id="8194749">fmt</span><span class="op" id="8194752">.</span><span class="ident" id="8194753">Sprintf</span><span class="op" id="8194760">(</span><span class="string" id="8194761">&#34;%s&nbsp;(offs&nbsp;=&nbsp;%d,&nbsp;p&nbsp;=&nbsp;%d)&#34;</span><span class="op" id="8194785">,</span>&nbsp;<span class="ident" id="8194787">f</span><span class="op" id="8194788">.</span><span class="ident" id="8194789">Name</span><span class="op" id="8194793">(</span><span class="op" id="8194794">)</span><span class="op" id="8194795">,</span>&nbsp;<span class="ident" id="8194797">offs</span><span class="op" id="8194801">,</span>&nbsp;<span class="ident" id="8194803">p</span><span class="op" id="8194804">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194808">checkPos</span><span class="op" id="8194816">(</span><span class="ident" id="8194817">t</span><span class="op" id="8194818">,</span>&nbsp;<span class="ident" id="8194820">msg</span><span class="op" id="8194823">,</span>&nbsp;<span class="ident" id="8194825">f</span><span class="op" id="8194826">.</span><span class="ident" id="8194827">Position</span><span class="op" id="8194835">(</span><span class="ident" id="8194836">f</span><span class="op" id="8194837">.</span><span class="ident" id="8194838">Pos</span><span class="op" id="8194841">(</span><span class="ident" id="8194842">offs</span><span class="op" id="8194846">)</span><span class="op" id="8194847">)</span><span class="op" id="8194848">,</span>&nbsp;<span class="ident" id="8194850">Position</span><span class="op" id="8194858">{</span><span class="ident" id="8194859">f</span><span class="op" id="8194860">.</span><span class="ident" id="8194861">Name</span><span class="op" id="8194865">(</span><span class="op" id="8194866">)</span><span class="op" id="8194867">,</span>&nbsp;<span class="ident" id="8194869">offs</span><span class="op" id="8194873">,</span>&nbsp;<span class="ident" id="8194875">line</span><span class="op" id="8194879">,</span>&nbsp;<span class="ident" id="8194881">col</span><span class="op" id="8194884">}</span><span class="op" id="8194885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8194889">checkPos</span><span class="op" id="8194897">(</span><span class="ident" id="8194898">t</span><span class="op" id="8194899">,</span>&nbsp;<span class="ident" id="8194901">msg</span><span class="op" id="8194904">,</span>&nbsp;<span class="ident" id="8194906">fset</span><span class="op" id="8194910">.</span><span class="ident" id="8194911">Position</span><span class="op" id="8194919">(</span><span class="ident" id="8194920">p</span><span class="op" id="8194921">)</span><span class="op" id="8194922">,</span>&nbsp;<span class="ident" id="8194924">Position</span><span class="op" id="8194932">{</span><span class="ident" id="8194933">f</span><span class="op" id="8194934">.</span><span class="ident" id="8194935">Name</span><span class="op" id="8194939">(</span><span class="op" id="8194940">)</span><span class="op" id="8194941">,</span>&nbsp;<span class="ident" id="8194943">offs</span><span class="op" id="8194947">,</span>&nbsp;<span class="ident" id="8194949">line</span><span class="op" id="8194953">,</span>&nbsp;<span class="ident" id="8194955">col</span><span class="op" id="8194958">}</span><span class="op" id="8194959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8194962">}</span><br>
<span class="lineno"></span><span class="op" id="8194964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8194967">func</span>&nbsp;<span class="ident" id="8194972">makeTestSource</span><span class="op" id="8194986">(</span><span class="ident" id="8194987">size</span>&nbsp;<span class="builtintype" id="8194992">int</span><span class="op" id="8194995">,</span>&nbsp;<span class="ident" id="8194997">lines</span>&nbsp;<span class="op" id="8195003">[</span><span class="op" id="8195004">]</span><span class="builtintype" id="8195005">int</span><span class="op" id="8195008">)</span>&nbsp;<span class="op" id="8195010">[</span><span class="op" id="8195011">]</span><span class="builtintype" id="8195012">byte</span>&nbsp;<span class="op" id="8195017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195020">src</span>&nbsp;<span class="op" id="8195024">:=</span>&nbsp;<span class="builtinfunc" id="8195027">make</span><span class="op" id="8195031">(</span><span class="op" id="8195032">[</span><span class="op" id="8195033">]</span><span class="builtintype" id="8195034">byte</span><span class="op" id="8195038">,</span>&nbsp;<span class="ident" id="8195040">size</span><span class="op" id="8195044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195047">for</span>&nbsp;<span class="ident" id="8195051">_</span><span class="op" id="8195052">,</span>&nbsp;<span class="ident" id="8195054">offs</span>&nbsp;<span class="op" id="8195059">:=</span>&nbsp;<span class="keyword" id="8195062">range</span>&nbsp;<span class="ident" id="8195068">lines</span>&nbsp;<span class="op" id="8195074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195078">if</span>&nbsp;<span class="ident" id="8195081">offs</span>&nbsp;<span class="op" id="8195086">&gt;</span>&nbsp;<span class="num" id="8195088">0</span>&nbsp;<span class="op" id="8195090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195095">src</span><span class="op" id="8195098">[</span><span class="ident" id="8195099">offs</span><span class="op" id="8195103">-</span><span class="num" id="8195104">1</span><span class="op" id="8195105">]</span>&nbsp;<span class="op" id="8195107">=</span>&nbsp;<span class="string" id="8195109">&#39;\n&#39;</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195122">return</span>&nbsp;<span class="ident" id="8195129">src</span><br>
<span class="lineno"></span><span class="op" id="8195133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8195136">func</span>&nbsp;<span class="ident" id="8195141">TestPositions</span><span class="op" id="8195154">(</span><span class="ident" id="8195155">t</span>&nbsp;<span class="op" id="8195157">*</span><span class="ident" id="8195158">testing</span><span class="op" id="8195165">.</span><span class="ident" id="8195166">T</span><span class="op" id="8195167">)</span>&nbsp;<span class="op" id="8195169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195172">const</span>&nbsp;<span class="ident" id="8195178">delta</span>&nbsp;<span class="op" id="8195184">=</span>&nbsp;<span class="num" id="8195186">7</span>&nbsp;<span class="comment" id="8195188">//&nbsp;a&nbsp;non-zero&nbsp;base&nbsp;offset&nbsp;increment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195225">fset</span>&nbsp;<span class="op" id="8195230">:=</span>&nbsp;<span class="ident" id="8195233">NewFileSet</span><span class="op" id="8195243">(</span><span class="op" id="8195244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195247">for</span>&nbsp;<span class="ident" id="8195251">_</span><span class="op" id="8195252">,</span>&nbsp;<span class="ident" id="8195254">test</span>&nbsp;<span class="op" id="8195259">:=</span>&nbsp;<span class="keyword" id="8195262">range</span>&nbsp;<span class="ident" id="8195268">tests</span>&nbsp;<span class="op" id="8195274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8195278">//&nbsp;verify&nbsp;consistency&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195315">if</span>&nbsp;<span class="ident" id="8195318">test</span><span class="op" id="8195322">.</span><span class="ident" id="8195323">source</span>&nbsp;<span class="op" id="8195330">!=</span>&nbsp;<span class="builtintype" id="8195333">nil</span>&nbsp;<span class="op" id="8195337">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8195340">len</span><span class="op" id="8195343">(</span><span class="ident" id="8195344">test</span><span class="op" id="8195348">.</span><span class="ident" id="8195349">source</span><span class="op" id="8195355">)</span>&nbsp;<span class="op" id="8195357">!=</span>&nbsp;<span class="ident" id="8195360">test</span><span class="op" id="8195364">.</span><span class="ident" id="8195365">size</span>&nbsp;<span class="op" id="8195370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195375">t</span><span class="op" id="8195376">.</span><span class="ident" id="8195377">Errorf</span><span class="op" id="8195383">(</span><span class="string" id="8195384">&#34;%s:&nbsp;inconsistent&nbsp;test&nbsp;case:&nbsp;got&nbsp;file&nbsp;size&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8195439">,</span>&nbsp;<span class="ident" id="8195441">test</span><span class="op" id="8195445">.</span><span class="ident" id="8195446">filename</span><span class="op" id="8195454">,</span>&nbsp;<span class="builtinfunc" id="8195456">len</span><span class="op" id="8195459">(</span><span class="ident" id="8195460">test</span><span class="op" id="8195464">.</span><span class="ident" id="8195465">source</span><span class="op" id="8195471">)</span><span class="op" id="8195472">,</span>&nbsp;<span class="ident" id="8195474">test</span><span class="op" id="8195478">.</span><span class="ident" id="8195479">size</span><span class="op" id="8195483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8195492">//&nbsp;add&nbsp;file&nbsp;and&nbsp;verify&nbsp;name&nbsp;and&nbsp;size</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195531">f</span>&nbsp;<span class="op" id="8195533">:=</span>&nbsp;<span class="ident" id="8195536">fset</span><span class="op" id="8195540">.</span><span class="ident" id="8195541">AddFile</span><span class="op" id="8195548">(</span><span class="ident" id="8195549">test</span><span class="op" id="8195553">.</span><span class="ident" id="8195554">filename</span><span class="op" id="8195562">,</span>&nbsp;<span class="ident" id="8195564">fset</span><span class="op" id="8195568">.</span><span class="ident" id="8195569">Base</span><span class="op" id="8195573">(</span><span class="op" id="8195574">)</span><span class="op" id="8195575">+</span><span class="ident" id="8195576">delta</span><span class="op" id="8195581">,</span>&nbsp;<span class="ident" id="8195583">test</span><span class="op" id="8195587">.</span><span class="ident" id="8195588">size</span><span class="op" id="8195592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195596">if</span>&nbsp;<span class="ident" id="8195599">f</span><span class="op" id="8195600">.</span><span class="ident" id="8195601">Name</span><span class="op" id="8195605">(</span><span class="op" id="8195606">)</span>&nbsp;<span class="op" id="8195608">!=</span>&nbsp;<span class="ident" id="8195611">test</span><span class="op" id="8195615">.</span><span class="ident" id="8195616">filename</span>&nbsp;<span class="op" id="8195625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195630">t</span><span class="op" id="8195631">.</span><span class="ident" id="8195632">Errorf</span><span class="op" id="8195638">(</span><span class="string" id="8195639">&#34;got&nbsp;filename&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8195665">,</span>&nbsp;<span class="ident" id="8195667">f</span><span class="op" id="8195668">.</span><span class="ident" id="8195669">Name</span><span class="op" id="8195673">(</span><span class="op" id="8195674">)</span><span class="op" id="8195675">,</span>&nbsp;<span class="ident" id="8195677">test</span><span class="op" id="8195681">.</span><span class="ident" id="8195682">filename</span><span class="op" id="8195690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195698">if</span>&nbsp;<span class="ident" id="8195701">f</span><span class="op" id="8195702">.</span><span class="ident" id="8195703">Size</span><span class="op" id="8195707">(</span><span class="op" id="8195708">)</span>&nbsp;<span class="op" id="8195710">!=</span>&nbsp;<span class="ident" id="8195713">test</span><span class="op" id="8195717">.</span><span class="ident" id="8195718">size</span>&nbsp;<span class="op" id="8195723">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195728">t</span><span class="op" id="8195729">.</span><span class="ident" id="8195730">Errorf</span><span class="op" id="8195736">(</span><span class="string" id="8195737">&#34;%s:&nbsp;got&nbsp;file&nbsp;size&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8195768">,</span>&nbsp;<span class="ident" id="8195770">f</span><span class="op" id="8195771">.</span><span class="ident" id="8195772">Name</span><span class="op" id="8195776">(</span><span class="op" id="8195777">)</span><span class="op" id="8195778">,</span>&nbsp;<span class="ident" id="8195780">f</span><span class="op" id="8195781">.</span><span class="ident" id="8195782">Size</span><span class="op" id="8195786">(</span><span class="op" id="8195787">)</span><span class="op" id="8195788">,</span>&nbsp;<span class="ident" id="8195790">test</span><span class="op" id="8195794">.</span><span class="ident" id="8195795">size</span><span class="op" id="8195799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195807">if</span>&nbsp;<span class="ident" id="8195810">fset</span><span class="op" id="8195814">.</span><span class="ident" id="8195815">File</span><span class="op" id="8195819">(</span><span class="ident" id="8195820">f</span><span class="op" id="8195821">.</span><span class="ident" id="8195822">Pos</span><span class="op" id="8195825">(</span><span class="num" id="8195826">0</span><span class="op" id="8195827">)</span><span class="op" id="8195828">)</span>&nbsp;<span class="op" id="8195830">!=</span>&nbsp;<span class="ident" id="8195833">f</span>&nbsp;<span class="op" id="8195835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195840">t</span><span class="op" id="8195841">.</span><span class="ident" id="8195842">Errorf</span><span class="op" id="8195848">(</span><span class="string" id="8195849">&#34;%s:&nbsp;f.Pos(0)&nbsp;was&nbsp;not&nbsp;found&nbsp;in&nbsp;f&#34;</span><span class="op" id="8195882">,</span>&nbsp;<span class="ident" id="8195884">f</span><span class="op" id="8195885">.</span><span class="ident" id="8195886">Name</span><span class="op" id="8195890">(</span><span class="op" id="8195891">)</span><span class="op" id="8195892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8195896">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8195901">//&nbsp;add&nbsp;lines&nbsp;individually&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8195954">for</span>&nbsp;<span class="ident" id="8195958">i</span><span class="op" id="8195959">,</span>&nbsp;<span class="ident" id="8195961">offset</span>&nbsp;<span class="op" id="8195968">:=</span>&nbsp;<span class="keyword" id="8195971">range</span>&nbsp;<span class="ident" id="8195977">test</span><span class="op" id="8195981">.</span><span class="ident" id="8195982">lines</span>&nbsp;<span class="op" id="8195988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8195993">f</span><span class="op" id="8195994">.</span><span class="ident" id="8195995">AddLine</span><span class="op" id="8196002">(</span><span class="ident" id="8196003">offset</span><span class="op" id="8196009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196014">if</span>&nbsp;<span class="ident" id="8196017">f</span><span class="op" id="8196018">.</span><span class="ident" id="8196019">LineCount</span><span class="op" id="8196028">(</span><span class="op" id="8196029">)</span>&nbsp;<span class="op" id="8196031">!=</span>&nbsp;<span class="ident" id="8196034">i</span><span class="op" id="8196035">+</span><span class="num" id="8196036">1</span>&nbsp;<span class="op" id="8196038">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196044">t</span><span class="op" id="8196045">.</span><span class="ident" id="8196046">Errorf</span><span class="op" id="8196052">(</span><span class="string" id="8196053">&#34;%s,&nbsp;AddLine:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8196094">,</span>&nbsp;<span class="ident" id="8196096">f</span><span class="op" id="8196097">.</span><span class="ident" id="8196098">Name</span><span class="op" id="8196102">(</span><span class="op" id="8196103">)</span><span class="op" id="8196104">,</span>&nbsp;<span class="ident" id="8196106">f</span><span class="op" id="8196107">.</span><span class="ident" id="8196108">LineCount</span><span class="op" id="8196117">(</span><span class="op" id="8196118">)</span><span class="op" id="8196119">,</span>&nbsp;<span class="ident" id="8196121">i</span><span class="op" id="8196122">+</span><span class="num" id="8196123">1</span><span class="op" id="8196124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196134">//&nbsp;adding&nbsp;the&nbsp;same&nbsp;offset&nbsp;again&nbsp;should&nbsp;be&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196187">f</span><span class="op" id="8196188">.</span><span class="ident" id="8196189">AddLine</span><span class="op" id="8196196">(</span><span class="ident" id="8196197">offset</span><span class="op" id="8196203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196208">if</span>&nbsp;<span class="ident" id="8196211">f</span><span class="op" id="8196212">.</span><span class="ident" id="8196213">LineCount</span><span class="op" id="8196222">(</span><span class="op" id="8196223">)</span>&nbsp;<span class="op" id="8196225">!=</span>&nbsp;<span class="ident" id="8196228">i</span><span class="op" id="8196229">+</span><span class="num" id="8196230">1</span>&nbsp;<span class="op" id="8196232">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196238">t</span><span class="op" id="8196239">.</span><span class="ident" id="8196240">Errorf</span><span class="op" id="8196246">(</span><span class="string" id="8196247">&#34;%s,&nbsp;AddLine:&nbsp;got&nbsp;unchanged&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8196298">,</span>&nbsp;<span class="ident" id="8196300">f</span><span class="op" id="8196301">.</span><span class="ident" id="8196302">Name</span><span class="op" id="8196306">(</span><span class="op" id="8196307">)</span><span class="op" id="8196308">,</span>&nbsp;<span class="ident" id="8196310">f</span><span class="op" id="8196311">.</span><span class="ident" id="8196312">LineCount</span><span class="op" id="8196321">(</span><span class="op" id="8196322">)</span><span class="op" id="8196323">,</span>&nbsp;<span class="ident" id="8196325">i</span><span class="op" id="8196326">+</span><span class="num" id="8196327">1</span><span class="op" id="8196328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196338">verifyPositions</span><span class="op" id="8196353">(</span><span class="ident" id="8196354">t</span><span class="op" id="8196355">,</span>&nbsp;<span class="ident" id="8196357">fset</span><span class="op" id="8196361">,</span>&nbsp;<span class="ident" id="8196363">f</span><span class="op" id="8196364">,</span>&nbsp;<span class="ident" id="8196366">test</span><span class="op" id="8196370">.</span><span class="ident" id="8196371">lines</span><span class="op" id="8196376">[</span><span class="num" id="8196377">0</span><span class="op" id="8196378">:</span><span class="ident" id="8196379">i</span><span class="op" id="8196380">+</span><span class="num" id="8196381">1</span><span class="op" id="8196382">]</span><span class="op" id="8196383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196392">//&nbsp;add&nbsp;lines&nbsp;with&nbsp;SetLines&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196446">if</span>&nbsp;<span class="ident" id="8196449">ok</span>&nbsp;<span class="op" id="8196452">:=</span>&nbsp;<span class="ident" id="8196455">f</span><span class="op" id="8196456">.</span><span class="ident" id="8196457">SetLines</span><span class="op" id="8196465">(</span><span class="ident" id="8196466">test</span><span class="op" id="8196470">.</span><span class="ident" id="8196471">lines</span><span class="op" id="8196476">)</span><span class="op" id="8196477">;</span>&nbsp;<span class="op" id="8196479">!</span><span class="ident" id="8196480">ok</span>&nbsp;<span class="op" id="8196483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196488">t</span><span class="op" id="8196489">.</span><span class="ident" id="8196490">Errorf</span><span class="op" id="8196496">(</span><span class="string" id="8196497">&#34;%s:&nbsp;SetLines&nbsp;failed&#34;</span><span class="op" id="8196518">,</span>&nbsp;<span class="ident" id="8196520">f</span><span class="op" id="8196521">.</span><span class="ident" id="8196522">Name</span><span class="op" id="8196526">(</span><span class="op" id="8196527">)</span><span class="op" id="8196528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196536">if</span>&nbsp;<span class="ident" id="8196539">f</span><span class="op" id="8196540">.</span><span class="ident" id="8196541">LineCount</span><span class="op" id="8196550">(</span><span class="op" id="8196551">)</span>&nbsp;<span class="op" id="8196553">!=</span>&nbsp;<span class="builtinfunc" id="8196556">len</span><span class="op" id="8196559">(</span><span class="ident" id="8196560">test</span><span class="op" id="8196564">.</span><span class="ident" id="8196565">lines</span><span class="op" id="8196570">)</span>&nbsp;<span class="op" id="8196572">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196577">t</span><span class="op" id="8196578">.</span><span class="ident" id="8196579">Errorf</span><span class="op" id="8196585">(</span><span class="string" id="8196586">&#34;%s,&nbsp;SetLines:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8196628">,</span>&nbsp;<span class="ident" id="8196630">f</span><span class="op" id="8196631">.</span><span class="ident" id="8196632">Name</span><span class="op" id="8196636">(</span><span class="op" id="8196637">)</span><span class="op" id="8196638">,</span>&nbsp;<span class="ident" id="8196640">f</span><span class="op" id="8196641">.</span><span class="ident" id="8196642">LineCount</span><span class="op" id="8196651">(</span><span class="op" id="8196652">)</span><span class="op" id="8196653">,</span>&nbsp;<span class="builtinfunc" id="8196655">len</span><span class="op" id="8196658">(</span><span class="ident" id="8196659">test</span><span class="op" id="8196663">.</span><span class="ident" id="8196664">lines</span><span class="op" id="8196669">)</span><span class="op" id="8196670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196678">verifyPositions</span><span class="op" id="8196693">(</span><span class="ident" id="8196694">t</span><span class="op" id="8196695">,</span>&nbsp;<span class="ident" id="8196697">fset</span><span class="op" id="8196701">,</span>&nbsp;<span class="ident" id="8196703">f</span><span class="op" id="8196704">,</span>&nbsp;<span class="ident" id="8196706">test</span><span class="op" id="8196710">.</span><span class="ident" id="8196711">lines</span><span class="op" id="8196716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196721">//&nbsp;add&nbsp;lines&nbsp;with&nbsp;SetLinesForContent&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196785">src</span>&nbsp;<span class="op" id="8196789">:=</span>&nbsp;<span class="ident" id="8196792">test</span><span class="op" id="8196796">.</span><span class="ident" id="8196797">source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196806">if</span>&nbsp;<span class="ident" id="8196809">src</span>&nbsp;<span class="op" id="8196813">==</span>&nbsp;<span class="builtintype" id="8196816">nil</span>&nbsp;<span class="op" id="8196820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8196825">//&nbsp;no&nbsp;test&nbsp;source&nbsp;available&nbsp;-&nbsp;create&nbsp;one&nbsp;from&nbsp;scratch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196882">src</span>&nbsp;<span class="op" id="8196886">=</span>&nbsp;<span class="ident" id="8196888">makeTestSource</span><span class="op" id="8196902">(</span><span class="ident" id="8196903">test</span><span class="op" id="8196907">.</span><span class="ident" id="8196908">size</span><span class="op" id="8196912">,</span>&nbsp;<span class="ident" id="8196914">test</span><span class="op" id="8196918">.</span><span class="ident" id="8196919">lines</span><span class="op" id="8196924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196928">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196932">f</span><span class="op" id="8196933">.</span><span class="ident" id="8196934">SetLinesForContent</span><span class="op" id="8196952">(</span><span class="ident" id="8196953">src</span><span class="op" id="8196956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196960">if</span>&nbsp;<span class="ident" id="8196963">f</span><span class="op" id="8196964">.</span><span class="ident" id="8196965">LineCount</span><span class="op" id="8196974">(</span><span class="op" id="8196975">)</span>&nbsp;<span class="op" id="8196977">!=</span>&nbsp;<span class="builtinfunc" id="8196980">len</span><span class="op" id="8196983">(</span><span class="ident" id="8196984">test</span><span class="op" id="8196988">.</span><span class="ident" id="8196989">lines</span><span class="op" id="8196994">)</span>&nbsp;<span class="op" id="8196996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197001">t</span><span class="op" id="8197002">.</span><span class="ident" id="8197003">Errorf</span><span class="op" id="8197009">(</span><span class="string" id="8197010">&#34;%s,&nbsp;SetLinesForContent:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8197062">,</span>&nbsp;<span class="ident" id="8197064">f</span><span class="op" id="8197065">.</span><span class="ident" id="8197066">Name</span><span class="op" id="8197070">(</span><span class="op" id="8197071">)</span><span class="op" id="8197072">,</span>&nbsp;<span class="ident" id="8197074">f</span><span class="op" id="8197075">.</span><span class="ident" id="8197076">LineCount</span><span class="op" id="8197085">(</span><span class="op" id="8197086">)</span><span class="op" id="8197087">,</span>&nbsp;<span class="builtinfunc" id="8197089">len</span><span class="op" id="8197092">(</span><span class="ident" id="8197093">test</span><span class="op" id="8197097">.</span><span class="ident" id="8197098">lines</span><span class="op" id="8197103">)</span><span class="op" id="8197104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197112">verifyPositions</span><span class="op" id="8197127">(</span><span class="ident" id="8197128">t</span><span class="op" id="8197129">,</span>&nbsp;<span class="ident" id="8197131">fset</span><span class="op" id="8197135">,</span>&nbsp;<span class="ident" id="8197137">f</span><span class="op" id="8197138">,</span>&nbsp;<span class="ident" id="8197140">test</span><span class="op" id="8197144">.</span><span class="ident" id="8197145">lines</span><span class="op" id="8197150">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197153">}</span><br>
<span class="lineno"></span><span class="op" id="8197155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8197158">func</span>&nbsp;<span class="ident" id="8197163">TestLineInfo</span><span class="op" id="8197175">(</span><span class="ident" id="8197176">t</span>&nbsp;<span class="op" id="8197178">*</span><span class="ident" id="8197179">testing</span><span class="op" id="8197186">.</span><span class="ident" id="8197187">T</span><span class="op" id="8197188">)</span>&nbsp;<span class="op" id="8197190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197193">fset</span>&nbsp;<span class="op" id="8197198">:=</span>&nbsp;<span class="ident" id="8197201">NewFileSet</span><span class="op" id="8197211">(</span><span class="op" id="8197212">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197215">f</span>&nbsp;<span class="op" id="8197217">:=</span>&nbsp;<span class="ident" id="8197220">fset</span><span class="op" id="8197224">.</span><span class="ident" id="8197225">AddFile</span><span class="op" id="8197232">(</span><span class="string" id="8197233">&#34;foo&#34;</span><span class="op" id="8197238">,</span>&nbsp;<span class="ident" id="8197240">fset</span><span class="op" id="8197244">.</span><span class="ident" id="8197245">Base</span><span class="op" id="8197249">(</span><span class="op" id="8197250">)</span><span class="op" id="8197251">,</span>&nbsp;<span class="num" id="8197253">500</span><span class="op" id="8197256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197259">lines</span>&nbsp;<span class="op" id="8197265">:=</span>&nbsp;<span class="op" id="8197268">[</span><span class="op" id="8197269">]</span><span class="builtintype" id="8197270">int</span><span class="op" id="8197273">{</span><span class="num" id="8197274">0</span><span class="op" id="8197275">,</span>&nbsp;<span class="num" id="8197277">42</span><span class="op" id="8197279">,</span>&nbsp;<span class="num" id="8197281">77</span><span class="op" id="8197283">,</span>&nbsp;<span class="num" id="8197285">100</span><span class="op" id="8197288">,</span>&nbsp;<span class="num" id="8197290">210</span><span class="op" id="8197293">,</span>&nbsp;<span class="num" id="8197295">220</span><span class="op" id="8197298">,</span>&nbsp;<span class="num" id="8197300">277</span><span class="op" id="8197303">,</span>&nbsp;<span class="num" id="8197305">300</span><span class="op" id="8197308">,</span>&nbsp;<span class="num" id="8197310">333</span><span class="op" id="8197313">,</span>&nbsp;<span class="num" id="8197315">401</span><span class="op" id="8197318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8197321">//&nbsp;add&nbsp;lines&nbsp;individually&nbsp;and&nbsp;provide&nbsp;alternative&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197389">for</span>&nbsp;<span class="ident" id="8197393">_</span><span class="op" id="8197394">,</span>&nbsp;<span class="ident" id="8197396">offs</span>&nbsp;<span class="op" id="8197401">:=</span>&nbsp;<span class="keyword" id="8197404">range</span>&nbsp;<span class="ident" id="8197410">lines</span>&nbsp;<span class="op" id="8197416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197420">f</span><span class="op" id="8197421">.</span><span class="ident" id="8197422">AddLine</span><span class="op" id="8197429">(</span><span class="ident" id="8197430">offs</span><span class="op" id="8197434">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197438">f</span><span class="op" id="8197439">.</span><span class="ident" id="8197440">AddLineInfo</span><span class="op" id="8197451">(</span><span class="ident" id="8197452">offs</span><span class="op" id="8197456">,</span>&nbsp;<span class="string" id="8197458">&#34;bar&#34;</span><span class="op" id="8197463">,</span>&nbsp;<span class="num" id="8197465">42</span><span class="op" id="8197467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8197473">//&nbsp;verify&nbsp;positions&nbsp;for&nbsp;all&nbsp;offsets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197510">for</span>&nbsp;<span class="ident" id="8197514">offs</span>&nbsp;<span class="op" id="8197519">:=</span>&nbsp;<span class="num" id="8197522">0</span><span class="op" id="8197523">;</span>&nbsp;<span class="ident" id="8197525">offs</span>&nbsp;<span class="op" id="8197530">&lt;=</span>&nbsp;<span class="ident" id="8197533">f</span><span class="op" id="8197534">.</span><span class="ident" id="8197535">Size</span><span class="op" id="8197539">(</span><span class="op" id="8197540">)</span><span class="op" id="8197541">;</span>&nbsp;<span class="ident" id="8197543">offs</span><span class="op" id="8197547">++</span>&nbsp;<span class="op" id="8197550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197554">p</span>&nbsp;<span class="op" id="8197556">:=</span>&nbsp;<span class="ident" id="8197559">f</span><span class="op" id="8197560">.</span><span class="ident" id="8197561">Pos</span><span class="op" id="8197564">(</span><span class="ident" id="8197565">offs</span><span class="op" id="8197569">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197573">_</span><span class="op" id="8197574">,</span>&nbsp;<span class="ident" id="8197576">col</span>&nbsp;<span class="op" id="8197580">:=</span>&nbsp;<span class="ident" id="8197583">linecol</span><span class="op" id="8197590">(</span><span class="ident" id="8197591">lines</span><span class="op" id="8197596">,</span>&nbsp;<span class="ident" id="8197598">offs</span><span class="op" id="8197602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197606">msg</span>&nbsp;<span class="op" id="8197610">:=</span>&nbsp;<span class="ident" id="8197613">fmt</span><span class="op" id="8197616">.</span><span class="ident" id="8197617">Sprintf</span><span class="op" id="8197624">(</span><span class="string" id="8197625">&#34;%s&nbsp;(offs&nbsp;=&nbsp;%d,&nbsp;p&nbsp;=&nbsp;%d)&#34;</span><span class="op" id="8197649">,</span>&nbsp;<span class="ident" id="8197651">f</span><span class="op" id="8197652">.</span><span class="ident" id="8197653">Name</span><span class="op" id="8197657">(</span><span class="op" id="8197658">)</span><span class="op" id="8197659">,</span>&nbsp;<span class="ident" id="8197661">offs</span><span class="op" id="8197665">,</span>&nbsp;<span class="ident" id="8197667">p</span><span class="op" id="8197668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197672">checkPos</span><span class="op" id="8197680">(</span><span class="ident" id="8197681">t</span><span class="op" id="8197682">,</span>&nbsp;<span class="ident" id="8197684">msg</span><span class="op" id="8197687">,</span>&nbsp;<span class="ident" id="8197689">f</span><span class="op" id="8197690">.</span><span class="ident" id="8197691">Position</span><span class="op" id="8197699">(</span><span class="ident" id="8197700">f</span><span class="op" id="8197701">.</span><span class="ident" id="8197702">Pos</span><span class="op" id="8197705">(</span><span class="ident" id="8197706">offs</span><span class="op" id="8197710">)</span><span class="op" id="8197711">)</span><span class="op" id="8197712">,</span>&nbsp;<span class="ident" id="8197714">Position</span><span class="op" id="8197722">{</span><span class="string" id="8197723">&#34;bar&#34;</span><span class="op" id="8197728">,</span>&nbsp;<span class="ident" id="8197730">offs</span><span class="op" id="8197734">,</span>&nbsp;<span class="num" id="8197736">42</span><span class="op" id="8197738">,</span>&nbsp;<span class="ident" id="8197740">col</span><span class="op" id="8197743">}</span><span class="op" id="8197744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197748">checkPos</span><span class="op" id="8197756">(</span><span class="ident" id="8197757">t</span><span class="op" id="8197758">,</span>&nbsp;<span class="ident" id="8197760">msg</span><span class="op" id="8197763">,</span>&nbsp;<span class="ident" id="8197765">fset</span><span class="op" id="8197769">.</span><span class="ident" id="8197770">Position</span><span class="op" id="8197778">(</span><span class="ident" id="8197779">p</span><span class="op" id="8197780">)</span><span class="op" id="8197781">,</span>&nbsp;<span class="ident" id="8197783">Position</span><span class="op" id="8197791">{</span><span class="string" id="8197792">&#34;bar&#34;</span><span class="op" id="8197797">,</span>&nbsp;<span class="ident" id="8197799">offs</span><span class="op" id="8197803">,</span>&nbsp;<span class="num" id="8197805">42</span><span class="op" id="8197807">,</span>&nbsp;<span class="ident" id="8197809">col</span><span class="op" id="8197812">}</span><span class="op" id="8197813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197816">}</span><br>
<span class="lineno">165</span><span class="op" id="8197818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8197821">func</span>&nbsp;<span class="ident" id="8197826">TestFiles</span><span class="op" id="8197835">(</span><span class="ident" id="8197836">t</span>&nbsp;<span class="op" id="8197838">*</span><span class="ident" id="8197839">testing</span><span class="op" id="8197846">.</span><span class="ident" id="8197847">T</span><span class="op" id="8197848">)</span>&nbsp;<span class="op" id="8197850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197853">fset</span>&nbsp;<span class="op" id="8197858">:=</span>&nbsp;<span class="ident" id="8197861">NewFileSet</span><span class="op" id="8197871">(</span><span class="op" id="8197872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197875">for</span>&nbsp;<span class="ident" id="8197879">i</span><span class="op" id="8197880">,</span>&nbsp;<span class="ident" id="8197882">test</span>&nbsp;<span class="op" id="8197887">:=</span>&nbsp;<span class="keyword" id="8197890">range</span>&nbsp;<span class="ident" id="8197896">tests</span>&nbsp;<span class="op" id="8197902">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197906">base</span>&nbsp;<span class="op" id="8197911">:=</span>&nbsp;<span class="ident" id="8197914">fset</span><span class="op" id="8197918">.</span><span class="ident" id="8197919">Base</span><span class="op" id="8197923">(</span><span class="op" id="8197924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197928">if</span>&nbsp;<span class="ident" id="8197931">i</span><span class="op" id="8197932">%</span><span class="num" id="8197933">2</span>&nbsp;<span class="op" id="8197935">==</span>&nbsp;<span class="num" id="8197938">1</span>&nbsp;<span class="op" id="8197940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8197945">//&nbsp;Setting&nbsp;a&nbsp;negative&nbsp;base&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8197992">//&nbsp;fset.Base(),&nbsp;so&nbsp;test&nbsp;some&nbsp;of&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198033">base</span>&nbsp;<span class="op" id="8198038">=</span>&nbsp;<span class="op" id="8198040">-</span><span class="num" id="8198041">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198049">fset</span><span class="op" id="8198053">.</span><span class="ident" id="8198054">AddFile</span><span class="op" id="8198061">(</span><span class="ident" id="8198062">test</span><span class="op" id="8198066">.</span><span class="ident" id="8198067">filename</span><span class="op" id="8198075">,</span>&nbsp;<span class="ident" id="8198077">base</span><span class="op" id="8198081">,</span>&nbsp;<span class="ident" id="8198083">test</span><span class="op" id="8198087">.</span><span class="ident" id="8198088">size</span><span class="op" id="8198092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198096">j</span>&nbsp;<span class="op" id="8198098">:=</span>&nbsp;<span class="num" id="8198101">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198105">fset</span><span class="op" id="8198109">.</span><span class="ident" id="8198110">Iterate</span><span class="op" id="8198117">(</span><span class="keyword" id="8198118">func</span><span class="op" id="8198122">(</span><span class="ident" id="8198123">f</span>&nbsp;<span class="op" id="8198125">*</span><span class="ident" id="8198126">File</span><span class="op" id="8198130">)</span>&nbsp;<span class="builtintype" id="8198132">bool</span>&nbsp;<span class="op" id="8198137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198142">if</span>&nbsp;<span class="ident" id="8198145">f</span><span class="op" id="8198146">.</span><span class="ident" id="8198147">Name</span><span class="op" id="8198151">(</span><span class="op" id="8198152">)</span>&nbsp;<span class="op" id="8198154">!=</span>&nbsp;<span class="ident" id="8198157">tests</span><span class="op" id="8198162">[</span><span class="ident" id="8198163">j</span><span class="op" id="8198164">]</span><span class="op" id="8198165">.</span><span class="ident" id="8198166">filename</span>&nbsp;<span class="op" id="8198175">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198181">t</span><span class="op" id="8198182">.</span><span class="ident" id="8198183">Errorf</span><span class="op" id="8198189">(</span><span class="string" id="8198190">&#34;got&nbsp;filename&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8198218">,</span>&nbsp;<span class="ident" id="8198220">f</span><span class="op" id="8198221">.</span><span class="ident" id="8198222">Name</span><span class="op" id="8198226">(</span><span class="op" id="8198227">)</span><span class="op" id="8198228">,</span>&nbsp;<span class="ident" id="8198230">tests</span><span class="op" id="8198235">[</span><span class="ident" id="8198236">j</span><span class="op" id="8198237">]</span><span class="op" id="8198238">.</span><span class="ident" id="8198239">filename</span><span class="op" id="8198247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198257">j</span><span class="op" id="8198258">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198264">return</span>&nbsp;<span class="builtintype" id="8198271">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198278">}</span><span class="op" id="8198279">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198283">if</span>&nbsp;<span class="ident" id="8198286">j</span>&nbsp;<span class="op" id="8198288">!=</span>&nbsp;<span class="ident" id="8198291">i</span><span class="op" id="8198292">+</span><span class="num" id="8198293">1</span>&nbsp;<span class="op" id="8198295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198300">t</span><span class="op" id="8198301">.</span><span class="ident" id="8198302">Errorf</span><span class="op" id="8198308">(</span><span class="string" id="8198309">&#34;got&nbsp;%d&nbsp;files;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8198332">,</span>&nbsp;<span class="ident" id="8198334">j</span><span class="op" id="8198335">,</span>&nbsp;<span class="ident" id="8198337">i</span><span class="op" id="8198338">+</span><span class="num" id="8198339">1</span><span class="op" id="8198340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198347">}</span><br>
<span class="lineno"></span><span class="op" id="8198349">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="8198352">//&nbsp;FileSet.File&nbsp;should&nbsp;return&nbsp;nil&nbsp;if&nbsp;Pos&nbsp;is&nbsp;past&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;FileSet.</span><br>
<span class="lineno"></span><span class="keyword" id="8198425">func</span>&nbsp;<span class="ident" id="8198430">TestFileSetPastEnd</span><span class="op" id="8198448">(</span><span class="ident" id="8198449">t</span>&nbsp;<span class="op" id="8198451">*</span><span class="ident" id="8198452">testing</span><span class="op" id="8198459">.</span><span class="ident" id="8198460">T</span><span class="op" id="8198461">)</span>&nbsp;<span class="op" id="8198463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198466">fset</span>&nbsp;<span class="op" id="8198471">:=</span>&nbsp;<span class="ident" id="8198474">NewFileSet</span><span class="op" id="8198484">(</span><span class="op" id="8198485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198488">for</span>&nbsp;<span class="ident" id="8198492">_</span><span class="op" id="8198493">,</span>&nbsp;<span class="ident" id="8198495">test</span>&nbsp;<span class="op" id="8198500">:=</span>&nbsp;<span class="keyword" id="8198503">range</span>&nbsp;<span class="ident" id="8198509">tests</span>&nbsp;<span class="op" id="8198515">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198519">fset</span><span class="op" id="8198523">.</span><span class="ident" id="8198524">AddFile</span><span class="op" id="8198531">(</span><span class="ident" id="8198532">test</span><span class="op" id="8198536">.</span><span class="ident" id="8198537">filename</span><span class="op" id="8198545">,</span>&nbsp;<span class="ident" id="8198547">fset</span><span class="op" id="8198551">.</span><span class="ident" id="8198552">Base</span><span class="op" id="8198556">(</span><span class="op" id="8198557">)</span><span class="op" id="8198558">,</span>&nbsp;<span class="ident" id="8198560">test</span><span class="op" id="8198564">.</span><span class="ident" id="8198565">size</span><span class="op" id="8198569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198575">if</span>&nbsp;<span class="ident" id="8198578">f</span>&nbsp;<span class="op" id="8198580">:=</span>&nbsp;<span class="ident" id="8198583">fset</span><span class="op" id="8198587">.</span><span class="ident" id="8198588">File</span><span class="op" id="8198592">(</span><span class="ident" id="8198593">Pos</span><span class="op" id="8198596">(</span><span class="ident" id="8198597">fset</span><span class="op" id="8198601">.</span><span class="ident" id="8198602">Base</span><span class="op" id="8198606">(</span><span class="op" id="8198607">)</span><span class="op" id="8198608">)</span><span class="op" id="8198609">)</span><span class="op" id="8198610">;</span>&nbsp;<span class="ident" id="8198612">f</span>&nbsp;<span class="op" id="8198614">!=</span>&nbsp;<span class="builtintype" id="8198617">nil</span>&nbsp;<span class="op" id="8198621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198625">t</span><span class="op" id="8198626">.</span><span class="ident" id="8198627">Errorf</span><span class="op" id="8198633">(</span><span class="string" id="8198634">&#34;got&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8198652">,</span>&nbsp;<span class="ident" id="8198654">f</span><span class="op" id="8198655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198658">}</span><br>
<span class="lineno">200</span><span class="op" id="8198660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8198663">func</span>&nbsp;<span class="ident" id="8198668">TestFileSetCacheUnlikely</span><span class="op" id="8198692">(</span><span class="ident" id="8198693">t</span>&nbsp;<span class="op" id="8198695">*</span><span class="ident" id="8198696">testing</span><span class="op" id="8198703">.</span><span class="ident" id="8198704">T</span><span class="op" id="8198705">)</span>&nbsp;<span class="op" id="8198707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198710">fset</span>&nbsp;<span class="op" id="8198715">:=</span>&nbsp;<span class="ident" id="8198718">NewFileSet</span><span class="op" id="8198728">(</span><span class="op" id="8198729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198732">offsets</span>&nbsp;<span class="op" id="8198740">:=</span>&nbsp;<span class="builtinfunc" id="8198743">make</span><span class="op" id="8198747">(</span><span class="keyword" id="8198748">map</span><span class="op" id="8198751">[</span><span class="builtintype" id="8198752">string</span><span class="op" id="8198758">]</span><span class="builtintype" id="8198759">int</span><span class="op" id="8198762">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198765">for</span>&nbsp;<span class="ident" id="8198769">_</span><span class="op" id="8198770">,</span>&nbsp;<span class="ident" id="8198772">test</span>&nbsp;<span class="op" id="8198777">:=</span>&nbsp;<span class="keyword" id="8198780">range</span>&nbsp;<span class="ident" id="8198786">tests</span>&nbsp;<span class="op" id="8198792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198796">offsets</span><span class="op" id="8198803">[</span><span class="ident" id="8198804">test</span><span class="op" id="8198808">.</span><span class="ident" id="8198809">filename</span><span class="op" id="8198817">]</span>&nbsp;<span class="op" id="8198819">=</span>&nbsp;<span class="ident" id="8198821">fset</span><span class="op" id="8198825">.</span><span class="ident" id="8198826">Base</span><span class="op" id="8198830">(</span><span class="op" id="8198831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198835">fset</span><span class="op" id="8198839">.</span><span class="ident" id="8198840">AddFile</span><span class="op" id="8198847">(</span><span class="ident" id="8198848">test</span><span class="op" id="8198852">.</span><span class="ident" id="8198853">filename</span><span class="op" id="8198861">,</span>&nbsp;<span class="ident" id="8198863">fset</span><span class="op" id="8198867">.</span><span class="ident" id="8198868">Base</span><span class="op" id="8198872">(</span><span class="op" id="8198873">)</span><span class="op" id="8198874">,</span>&nbsp;<span class="ident" id="8198876">test</span><span class="op" id="8198880">.</span><span class="ident" id="8198881">size</span><span class="op" id="8198885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8198888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198891">for</span>&nbsp;<span class="ident" id="8198895">file</span><span class="op" id="8198899">,</span>&nbsp;<span class="ident" id="8198901">pos</span>&nbsp;<span class="op" id="8198905">:=</span>&nbsp;<span class="keyword" id="8198908">range</span>&nbsp;<span class="ident" id="8198914">offsets</span>&nbsp;<span class="op" id="8198922">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198926">f</span>&nbsp;<span class="op" id="8198928">:=</span>&nbsp;<span class="ident" id="8198931">fset</span><span class="op" id="8198935">.</span><span class="ident" id="8198936">File</span><span class="op" id="8198940">(</span><span class="ident" id="8198941">Pos</span><span class="op" id="8198944">(</span><span class="ident" id="8198945">pos</span><span class="op" id="8198948">)</span><span class="op" id="8198949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198953">if</span>&nbsp;<span class="ident" id="8198956">f</span><span class="op" id="8198957">.</span><span class="ident" id="8198958">Name</span><span class="op" id="8198962">(</span><span class="op" id="8198963">)</span>&nbsp;<span class="op" id="8198965">!=</span>&nbsp;<span class="ident" id="8198968">file</span>&nbsp;<span class="op" id="8198973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198978">t</span><span class="op" id="8198979">.</span><span class="ident" id="8198980">Errorf</span><span class="op" id="8198986">(</span><span class="string" id="8198987">&#34;got&nbsp;%q&nbsp;at&nbsp;position&nbsp;%d,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8199019">,</span>&nbsp;<span class="ident" id="8199021">f</span><span class="op" id="8199022">.</span><span class="ident" id="8199023">Name</span><span class="op" id="8199027">(</span><span class="op" id="8199028">)</span><span class="op" id="8199029">,</span>&nbsp;<span class="ident" id="8199031">pos</span><span class="op" id="8199034">,</span>&nbsp;<span class="ident" id="8199036">file</span><span class="op" id="8199040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199047">}</span><br>
<span class="lineno">215</span><span class="op" id="8199049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8199052">//&nbsp;issue&nbsp;4345.&nbsp;Test&nbsp;concurrent&nbsp;use&nbsp;of&nbsp;FileSet.Pos&nbsp;does&nbsp;not&nbsp;trigger&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="8199121">//&nbsp;race&nbsp;in&nbsp;the&nbsp;FileSet&nbsp;position&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="8199160">func</span>&nbsp;<span class="ident" id="8199165">TestFileSetRace</span><span class="op" id="8199180">(</span><span class="ident" id="8199181">t</span>&nbsp;<span class="op" id="8199183">*</span><span class="ident" id="8199184">testing</span><span class="op" id="8199191">.</span><span class="ident" id="8199192">T</span><span class="op" id="8199193">)</span>&nbsp;<span class="op" id="8199195">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199198">fset</span>&nbsp;<span class="op" id="8199203">:=</span>&nbsp;<span class="ident" id="8199206">NewFileSet</span><span class="op" id="8199216">(</span><span class="op" id="8199217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8199220">for</span>&nbsp;<span class="ident" id="8199224">i</span>&nbsp;<span class="op" id="8199226">:=</span>&nbsp;<span class="num" id="8199229">0</span><span class="op" id="8199230">;</span>&nbsp;<span class="ident" id="8199232">i</span>&nbsp;<span class="op" id="8199234">&lt;</span>&nbsp;<span class="num" id="8199236">100</span><span class="op" id="8199239">;</span>&nbsp;<span class="ident" id="8199241">i</span><span class="op" id="8199242">++</span>&nbsp;<span class="op" id="8199245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199249">fset</span><span class="op" id="8199253">.</span><span class="ident" id="8199254">AddFile</span><span class="op" id="8199261">(</span><span class="ident" id="8199262">fmt</span><span class="op" id="8199265">.</span><span class="ident" id="8199266">Sprintf</span><span class="op" id="8199273">(</span><span class="string" id="8199274">&#34;file-%d&#34;</span><span class="op" id="8199283">,</span>&nbsp;<span class="ident" id="8199285">i</span><span class="op" id="8199286">)</span><span class="op" id="8199287">,</span>&nbsp;<span class="ident" id="8199289">fset</span><span class="op" id="8199293">.</span><span class="ident" id="8199294">Base</span><span class="op" id="8199298">(</span><span class="op" id="8199299">)</span><span class="op" id="8199300">,</span>&nbsp;<span class="num" id="8199302">1031</span><span class="op" id="8199306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199312">max</span>&nbsp;<span class="op" id="8199316">:=</span>&nbsp;<span class="builtintype" id="8199319">int32</span><span class="op" id="8199324">(</span><span class="ident" id="8199325">fset</span><span class="op" id="8199329">.</span><span class="ident" id="8199330">Base</span><span class="op" id="8199334">(</span><span class="op" id="8199335">)</span><span class="op" id="8199336">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8199339">var</span>&nbsp;<span class="ident" id="8199343">stop</span>&nbsp;<span class="ident" id="8199348">sync</span><span class="op" id="8199352">.</span><span class="ident" id="8199353">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199364">r</span>&nbsp;<span class="op" id="8199366">:=</span>&nbsp;<span class="ident" id="8199369">rand</span><span class="op" id="8199373">.</span><span class="ident" id="8199374">New</span><span class="op" id="8199377">(</span><span class="ident" id="8199378">rand</span><span class="op" id="8199382">.</span><span class="ident" id="8199383">NewSource</span><span class="op" id="8199392">(</span><span class="num" id="8199393">7</span><span class="op" id="8199394">)</span><span class="op" id="8199395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8199398">for</span>&nbsp;<span class="ident" id="8199402">i</span>&nbsp;<span class="op" id="8199404">:=</span>&nbsp;<span class="num" id="8199407">0</span><span class="op" id="8199408">;</span>&nbsp;<span class="ident" id="8199410">i</span>&nbsp;<span class="op" id="8199412">&lt;</span>&nbsp;<span class="num" id="8199414">2</span><span class="op" id="8199415">;</span>&nbsp;<span class="ident" id="8199417">i</span><span class="op" id="8199418">++</span>&nbsp;<span class="op" id="8199421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199425">r</span>&nbsp;<span class="op" id="8199427">:=</span>&nbsp;<span class="ident" id="8199430">rand</span><span class="op" id="8199434">.</span><span class="ident" id="8199435">New</span><span class="op" id="8199438">(</span><span class="ident" id="8199439">rand</span><span class="op" id="8199443">.</span><span class="ident" id="8199444">NewSource</span><span class="op" id="8199453">(</span><span class="ident" id="8199454">r</span><span class="op" id="8199455">.</span><span class="ident" id="8199456">Int63</span><span class="op" id="8199461">(</span><span class="op" id="8199462">)</span><span class="op" id="8199463">)</span><span class="op" id="8199464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199468">stop</span><span class="op" id="8199472">.</span><span class="ident" id="8199473">Add</span><span class="op" id="8199476">(</span><span class="num" id="8199477">1</span><span class="op" id="8199478">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8199482">go</span>&nbsp;<span class="keyword" id="8199485">func</span><span class="op" id="8199489">(</span><span class="op" id="8199490">)</span>&nbsp;<span class="op" id="8199492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8199497">for</span>&nbsp;<span class="ident" id="8199501">i</span>&nbsp;<span class="op" id="8199503">:=</span>&nbsp;<span class="num" id="8199506">0</span><span class="op" id="8199507">;</span>&nbsp;<span class="ident" id="8199509">i</span>&nbsp;<span class="op" id="8199511">&lt;</span>&nbsp;<span class="num" id="8199513">1000</span><span class="op" id="8199517">;</span>&nbsp;<span class="ident" id="8199519">i</span><span class="op" id="8199520">++</span>&nbsp;<span class="op" id="8199523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199529">fset</span><span class="op" id="8199533">.</span><span class="ident" id="8199534">Position</span><span class="op" id="8199542">(</span><span class="ident" id="8199543">Pos</span><span class="op" id="8199546">(</span><span class="ident" id="8199547">r</span><span class="op" id="8199548">.</span><span class="ident" id="8199549">Int31n</span><span class="op" id="8199555">(</span><span class="ident" id="8199556">max</span><span class="op" id="8199559">)</span><span class="op" id="8199560">)</span><span class="op" id="8199561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199571">stop</span><span class="op" id="8199575">.</span><span class="ident" id="8199576">Done</span><span class="op" id="8199580">(</span><span class="op" id="8199581">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199585">}</span><span class="op" id="8199586">(</span><span class="op" id="8199587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199593">stop</span><span class="op" id="8199597">.</span><span class="ident" id="8199598">Wait</span><span class="op" id="8199602">(</span><span class="op" id="8199603">)</span><br>
<span class="lineno"></span><span class="op" id="8199605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8199608">func</span>&nbsp;<span class="ident" id="8199613">TestPositionFor</span><span class="op" id="8199628">(</span><span class="ident" id="8199629">t</span>&nbsp;<span class="op" id="8199631">*</span><span class="ident" id="8199632">testing</span><span class="op" id="8199639">.</span><span class="ident" id="8199640">T</span><span class="op" id="8199641">)</span>&nbsp;<span class="op" id="8199643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199646">src</span>&nbsp;<span class="op" id="8199650">:=</span>&nbsp;<span class="op" id="8199653">[</span><span class="op" id="8199654">]</span><span class="builtintype" id="8199655">byte</span><span class="op" id="8199659">(</span><span class="string" id="8199660">`<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>b<br>
<span class="lineno"></span>ar<br>
<span class="lineno">245</span>//line&nbsp;:100<br>
<span class="lineno"></span>foobar<br>
<span class="lineno"></span>//line&nbsp;bar:3<br>
<span class="lineno"></span>done<br>
<span class="lineno"></span>`</span><span class="op" id="8199709">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8199713">const</span>&nbsp;<span class="ident" id="8199719">filename</span>&nbsp;<span class="op" id="8199728">=</span>&nbsp;<span class="string" id="8199730">&#34;foo&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199737">fset</span>&nbsp;<span class="op" id="8199742">:=</span>&nbsp;<span class="ident" id="8199745">NewFileSet</span><span class="op" id="8199755">(</span><span class="op" id="8199756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199759">f</span>&nbsp;<span class="op" id="8199761">:=</span>&nbsp;<span class="ident" id="8199764">fset</span><span class="op" id="8199768">.</span><span class="ident" id="8199769">AddFile</span><span class="op" id="8199776">(</span><span class="ident" id="8199777">filename</span><span class="op" id="8199785">,</span>&nbsp;<span class="ident" id="8199787">fset</span><span class="op" id="8199791">.</span><span class="ident" id="8199792">Base</span><span class="op" id="8199796">(</span><span class="op" id="8199797">)</span><span class="op" id="8199798">,</span>&nbsp;<span class="builtinfunc" id="8199800">len</span><span class="op" id="8199803">(</span><span class="ident" id="8199804">src</span><span class="op" id="8199807">)</span><span class="op" id="8199808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199811">f</span><span class="op" id="8199812">.</span><span class="ident" id="8199813">SetLinesForContent</span><span class="op" id="8199831">(</span><span class="ident" id="8199832">src</span><span class="op" id="8199835">)</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8199839">//&nbsp;verify&nbsp;position&nbsp;info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8199864">for</span>&nbsp;<span class="ident" id="8199868">i</span><span class="op" id="8199869">,</span>&nbsp;<span class="ident" id="8199871">offs</span>&nbsp;<span class="op" id="8199876">:=</span>&nbsp;<span class="keyword" id="8199879">range</span>&nbsp;<span class="ident" id="8199885">f</span><span class="op" id="8199886">.</span><span class="ident" id="8199887">lines</span>&nbsp;<span class="op" id="8199893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199897">got1</span>&nbsp;<span class="op" id="8199902">:=</span>&nbsp;<span class="ident" id="8199905">f</span><span class="op" id="8199906">.</span><span class="ident" id="8199907">PositionFor</span><span class="op" id="8199918">(</span><span class="ident" id="8199919">f</span><span class="op" id="8199920">.</span><span class="ident" id="8199921">Pos</span><span class="op" id="8199924">(</span><span class="ident" id="8199925">offs</span><span class="op" id="8199929">)</span><span class="op" id="8199930">,</span>&nbsp;<span class="builtintype" id="8199932">false</span><span class="op" id="8199937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199941">got2</span>&nbsp;<span class="op" id="8199946">:=</span>&nbsp;<span class="ident" id="8199949">f</span><span class="op" id="8199950">.</span><span class="ident" id="8199951">PositionFor</span><span class="op" id="8199962">(</span><span class="ident" id="8199963">f</span><span class="op" id="8199964">.</span><span class="ident" id="8199965">Pos</span><span class="op" id="8199968">(</span><span class="ident" id="8199969">offs</span><span class="op" id="8199973">)</span><span class="op" id="8199974">,</span>&nbsp;<span class="builtintype" id="8199976">true</span><span class="op" id="8199980">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199984">got3</span>&nbsp;<span class="op" id="8199989">:=</span>&nbsp;<span class="ident" id="8199992">f</span><span class="op" id="8199993">.</span><span class="ident" id="8199994">Position</span><span class="op" id="8200002">(</span><span class="ident" id="8200003">f</span><span class="op" id="8200004">.</span><span class="ident" id="8200005">Pos</span><span class="op" id="8200008">(</span><span class="ident" id="8200009">offs</span><span class="op" id="8200013">)</span><span class="op" id="8200014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200018">want</span>&nbsp;<span class="op" id="8200023">:=</span>&nbsp;<span class="ident" id="8200026">Position</span><span class="op" id="8200034">{</span><span class="ident" id="8200035">filename</span><span class="op" id="8200043">,</span>&nbsp;<span class="ident" id="8200045">offs</span><span class="op" id="8200049">,</span>&nbsp;<span class="ident" id="8200051">i</span>&nbsp;<span class="op" id="8200053">+</span>&nbsp;<span class="num" id="8200055">1</span><span class="op" id="8200056">,</span>&nbsp;<span class="num" id="8200058">1</span><span class="op" id="8200059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200063">checkPos</span><span class="op" id="8200071">(</span><span class="ident" id="8200072">t</span><span class="op" id="8200073">,</span>&nbsp;<span class="string" id="8200075">&#34;1.&nbsp;PositionFor&nbsp;unadjusted&#34;</span><span class="op" id="8200102">,</span>&nbsp;<span class="ident" id="8200104">got1</span><span class="op" id="8200108">,</span>&nbsp;<span class="ident" id="8200110">want</span><span class="op" id="8200114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200118">checkPos</span><span class="op" id="8200126">(</span><span class="ident" id="8200127">t</span><span class="op" id="8200128">,</span>&nbsp;<span class="string" id="8200130">&#34;1.&nbsp;PositionFor&nbsp;adjusted&#34;</span><span class="op" id="8200155">,</span>&nbsp;<span class="ident" id="8200157">got2</span><span class="op" id="8200161">,</span>&nbsp;<span class="ident" id="8200163">want</span><span class="op" id="8200167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200171">checkPos</span><span class="op" id="8200179">(</span><span class="ident" id="8200180">t</span><span class="op" id="8200181">,</span>&nbsp;<span class="string" id="8200183">&#34;1.&nbsp;Position&#34;</span><span class="op" id="8200196">,</span>&nbsp;<span class="ident" id="8200198">got3</span><span class="op" id="8200202">,</span>&nbsp;<span class="ident" id="8200204">want</span><span class="op" id="8200208">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8200211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8200215">//&nbsp;manually&nbsp;add&nbsp;//line&nbsp;info&nbsp;on&nbsp;lines&nbsp;l1,&nbsp;l2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8200260">const</span>&nbsp;<span class="ident" id="8200266">l1</span><span class="op" id="8200268">,</span>&nbsp;<span class="ident" id="8200270">l2</span>&nbsp;<span class="op" id="8200273">=</span>&nbsp;<span class="num" id="8200275">5</span><span class="op" id="8200276">,</span>&nbsp;<span class="num" id="8200278">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200281">f</span><span class="op" id="8200282">.</span><span class="ident" id="8200283">AddLineInfo</span><span class="op" id="8200294">(</span><span class="ident" id="8200295">f</span><span class="op" id="8200296">.</span><span class="ident" id="8200297">lines</span><span class="op" id="8200302">[</span><span class="ident" id="8200303">l1</span><span class="op" id="8200305">-</span><span class="num" id="8200306">1</span><span class="op" id="8200307">]</span><span class="op" id="8200308">,</span>&nbsp;<span class="string" id="8200310">&#34;&#34;</span><span class="op" id="8200312">,</span>&nbsp;<span class="num" id="8200314">100</span><span class="op" id="8200317">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200320">f</span><span class="op" id="8200321">.</span><span class="ident" id="8200322">AddLineInfo</span><span class="op" id="8200333">(</span><span class="ident" id="8200334">f</span><span class="op" id="8200335">.</span><span class="ident" id="8200336">lines</span><span class="op" id="8200341">[</span><span class="ident" id="8200342">l2</span><span class="op" id="8200344">-</span><span class="num" id="8200345">1</span><span class="op" id="8200346">]</span><span class="op" id="8200347">,</span>&nbsp;<span class="string" id="8200349">&#34;bar&#34;</span><span class="op" id="8200354">,</span>&nbsp;<span class="num" id="8200356">3</span><span class="op" id="8200357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8200361">//&nbsp;unadjusted&nbsp;position&nbsp;info&nbsp;must&nbsp;remain&nbsp;unchanged</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8200412">for</span>&nbsp;<span class="ident" id="8200416">i</span><span class="op" id="8200417">,</span>&nbsp;<span class="ident" id="8200419">offs</span>&nbsp;<span class="op" id="8200424">:=</span>&nbsp;<span class="keyword" id="8200427">range</span>&nbsp;<span class="ident" id="8200433">f</span><span class="op" id="8200434">.</span><span class="ident" id="8200435">lines</span>&nbsp;<span class="op" id="8200441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200445">got1</span>&nbsp;<span class="op" id="8200450">:=</span>&nbsp;<span class="ident" id="8200453">f</span><span class="op" id="8200454">.</span><span class="ident" id="8200455">PositionFor</span><span class="op" id="8200466">(</span><span class="ident" id="8200467">f</span><span class="op" id="8200468">.</span><span class="ident" id="8200469">Pos</span><span class="op" id="8200472">(</span><span class="ident" id="8200473">offs</span><span class="op" id="8200477">)</span><span class="op" id="8200478">,</span>&nbsp;<span class="builtintype" id="8200480">false</span><span class="op" id="8200485">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200489">want</span>&nbsp;<span class="op" id="8200494">:=</span>&nbsp;<span class="ident" id="8200497">Position</span><span class="op" id="8200505">{</span><span class="ident" id="8200506">filename</span><span class="op" id="8200514">,</span>&nbsp;<span class="ident" id="8200516">offs</span><span class="op" id="8200520">,</span>&nbsp;<span class="ident" id="8200522">i</span>&nbsp;<span class="op" id="8200524">+</span>&nbsp;<span class="num" id="8200526">1</span><span class="op" id="8200527">,</span>&nbsp;<span class="num" id="8200529">1</span><span class="op" id="8200530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200534">checkPos</span><span class="op" id="8200542">(</span><span class="ident" id="8200543">t</span><span class="op" id="8200544">,</span>&nbsp;<span class="string" id="8200546">&#34;2.&nbsp;PositionFor&nbsp;unadjusted&#34;</span><span class="op" id="8200573">,</span>&nbsp;<span class="ident" id="8200575">got1</span><span class="op" id="8200579">,</span>&nbsp;<span class="ident" id="8200581">want</span><span class="op" id="8200585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8200588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8200592">//&nbsp;adjusted&nbsp;position&nbsp;info&nbsp;should&nbsp;have&nbsp;changed</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8200639">for</span>&nbsp;<span class="ident" id="8200643">i</span><span class="op" id="8200644">,</span>&nbsp;<span class="ident" id="8200646">offs</span>&nbsp;<span class="op" id="8200651">:=</span>&nbsp;<span class="keyword" id="8200654">range</span>&nbsp;<span class="ident" id="8200660">f</span><span class="op" id="8200661">.</span><span class="ident" id="8200662">lines</span>&nbsp;<span class="op" id="8200668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200672">got2</span>&nbsp;<span class="op" id="8200677">:=</span>&nbsp;<span class="ident" id="8200680">f</span><span class="op" id="8200681">.</span><span class="ident" id="8200682">PositionFor</span><span class="op" id="8200693">(</span><span class="ident" id="8200694">f</span><span class="op" id="8200695">.</span><span class="ident" id="8200696">Pos</span><span class="op" id="8200699">(</span><span class="ident" id="8200700">offs</span><span class="op" id="8200704">)</span><span class="op" id="8200705">,</span>&nbsp;<span class="builtintype" id="8200707">true</span><span class="op" id="8200711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200715">got3</span>&nbsp;<span class="op" id="8200720">:=</span>&nbsp;<span class="ident" id="8200723">f</span><span class="op" id="8200724">.</span><span class="ident" id="8200725">Position</span><span class="op" id="8200733">(</span><span class="ident" id="8200734">f</span><span class="op" id="8200735">.</span><span class="ident" id="8200736">Pos</span><span class="op" id="8200739">(</span><span class="ident" id="8200740">offs</span><span class="op" id="8200744">)</span><span class="op" id="8200745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200749">want</span>&nbsp;<span class="op" id="8200754">:=</span>&nbsp;<span class="ident" id="8200757">Position</span><span class="op" id="8200765">{</span><span class="ident" id="8200766">filename</span><span class="op" id="8200774">,</span>&nbsp;<span class="ident" id="8200776">offs</span><span class="op" id="8200780">,</span>&nbsp;<span class="ident" id="8200782">i</span>&nbsp;<span class="op" id="8200784">+</span>&nbsp;<span class="num" id="8200786">1</span><span class="op" id="8200787">,</span>&nbsp;<span class="num" id="8200789">1</span><span class="op" id="8200790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8200794">//&nbsp;manually&nbsp;compute&nbsp;wanted&nbsp;filename&nbsp;and&nbsp;line</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200841">line</span>&nbsp;<span class="op" id="8200846">:=</span>&nbsp;<span class="ident" id="8200849">want</span><span class="op" id="8200853">.</span><span class="ident" id="8200854">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8200861">if</span>&nbsp;<span class="ident" id="8200864">i</span><span class="op" id="8200865">+</span><span class="num" id="8200866">1</span>&nbsp;<span class="op" id="8200868">&gt;=</span>&nbsp;<span class="ident" id="8200871">l1</span>&nbsp;<span class="op" id="8200874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200879">want</span><span class="op" id="8200883">.</span><span class="ident" id="8200884">Filename</span>&nbsp;<span class="op" id="8200893">=</span>&nbsp;<span class="string" id="8200895">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200901">want</span><span class="op" id="8200905">.</span><span class="ident" id="8200906">Line</span>&nbsp;<span class="op" id="8200911">=</span>&nbsp;<span class="ident" id="8200913">line</span>&nbsp;<span class="op" id="8200918">-</span>&nbsp;<span class="ident" id="8200920">l1</span>&nbsp;<span class="op" id="8200923">+</span>&nbsp;<span class="num" id="8200925">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8200931">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8200935">if</span>&nbsp;<span class="ident" id="8200938">i</span><span class="op" id="8200939">+</span><span class="num" id="8200940">1</span>&nbsp;<span class="op" id="8200942">&gt;=</span>&nbsp;<span class="ident" id="8200945">l2</span>&nbsp;<span class="op" id="8200948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200953">want</span><span class="op" id="8200957">.</span><span class="ident" id="8200958">Filename</span>&nbsp;<span class="op" id="8200967">=</span>&nbsp;<span class="string" id="8200969">&#34;bar&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200978">want</span><span class="op" id="8200982">.</span><span class="ident" id="8200983">Line</span>&nbsp;<span class="op" id="8200988">=</span>&nbsp;<span class="ident" id="8200990">line</span>&nbsp;<span class="op" id="8200995">-</span>&nbsp;<span class="ident" id="8200997">l2</span>&nbsp;<span class="op" id="8201000">+</span>&nbsp;<span class="num" id="8201002">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8201006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201010">checkPos</span><span class="op" id="8201018">(</span><span class="ident" id="8201019">t</span><span class="op" id="8201020">,</span>&nbsp;<span class="string" id="8201022">&#34;3.&nbsp;PositionFor&nbsp;adjusted&#34;</span><span class="op" id="8201047">,</span>&nbsp;<span class="ident" id="8201049">got2</span><span class="op" id="8201053">,</span>&nbsp;<span class="ident" id="8201055">want</span><span class="op" id="8201059">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201063">checkPos</span><span class="op" id="8201071">(</span><span class="ident" id="8201072">t</span><span class="op" id="8201073">,</span>&nbsp;<span class="string" id="8201075">&#34;3.&nbsp;Position&#34;</span><span class="op" id="8201088">,</span>&nbsp;<span class="ident" id="8201090">got3</span><span class="op" id="8201094">,</span>&nbsp;<span class="ident" id="8201096">want</span><span class="op" id="8201100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8201103">}</span><br>
<span class="lineno"></span><span class="op" id="8201105">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
