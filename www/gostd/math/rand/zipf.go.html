<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html" class="current">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3330188">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3330243">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3330297">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3330348">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3330376">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3330421">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3330462">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3330523">package</span>&nbsp;<span class="ident" id="3330531">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330537">import</span>&nbsp;<span class="string" id="3330544">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3330552">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3330599">type</span>&nbsp;<span class="ident" id="3330604">Zipf</span>&nbsp;<span class="keyword" id="3330609">struct</span>&nbsp;<span class="op" id="3330616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330619">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3330632">*</span><span class="ident" id="3330633">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330639">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3330652">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330661">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3330674">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330683">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3330696">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330705">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3330718">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330727">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3330740">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330749">oneminusQinv</span>&nbsp;<span class="builtintype" id="3330762">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330771">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3330784">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330793">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3330806">float64</span><br>
<span class="lineno">25</span><span class="op" id="3330814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330817">func</span>&nbsp;<span class="op" id="3330822">(</span><span class="ident" id="3330823">z</span>&nbsp;<span class="op" id="3330825">*</span><span class="ident" id="3330826">Zipf</span><span class="op" id="3330830">)</span>&nbsp;<span class="ident" id="3330832">h</span><span class="op" id="3330833">(</span><span class="ident" id="3330834">x</span>&nbsp;<span class="builtintype" id="3330836">float64</span><span class="op" id="3330843">)</span>&nbsp;<span class="builtintype" id="3330845">float64</span>&nbsp;<span class="op" id="3330853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330856">return</span>&nbsp;<span class="ident" id="3330863">math</span><span class="op" id="3330867">.</span><span class="ident" id="3330868">Exp</span><span class="op" id="3330871">(</span><span class="ident" id="3330872">z</span><span class="op" id="3330873">.</span><span class="ident" id="3330874">oneminusQ</span><span class="op" id="3330883">*</span><span class="ident" id="3330884">math</span><span class="op" id="3330888">.</span><span class="ident" id="3330889">Log</span><span class="op" id="3330892">(</span><span class="ident" id="3330893">z</span><span class="op" id="3330894">.</span><span class="ident" id="3330895">v</span><span class="op" id="3330896">+</span><span class="ident" id="3330897">x</span><span class="op" id="3330898">)</span><span class="op" id="3330899">)</span>&nbsp;<span class="op" id="3330901">*</span>&nbsp;<span class="ident" id="3330903">z</span><span class="op" id="3330904">.</span><span class="ident" id="3330905">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3330918">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3330921">func</span>&nbsp;<span class="op" id="3330926">(</span><span class="ident" id="3330927">z</span>&nbsp;<span class="op" id="3330929">*</span><span class="ident" id="3330930">Zipf</span><span class="op" id="3330934">)</span>&nbsp;<span class="ident" id="3330936">hinv</span><span class="op" id="3330940">(</span><span class="ident" id="3330941">x</span>&nbsp;<span class="builtintype" id="3330943">float64</span><span class="op" id="3330950">)</span>&nbsp;<span class="builtintype" id="3330952">float64</span>&nbsp;<span class="op" id="3330960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330963">return</span>&nbsp;<span class="ident" id="3330970">math</span><span class="op" id="3330974">.</span><span class="ident" id="3330975">Exp</span><span class="op" id="3330978">(</span><span class="ident" id="3330979">z</span><span class="op" id="3330980">.</span><span class="ident" id="3330981">oneminusQinv</span><span class="op" id="3330993">*</span><span class="ident" id="3330994">math</span><span class="op" id="3330998">.</span><span class="ident" id="3330999">Log</span><span class="op" id="3331002">(</span><span class="ident" id="3331003">z</span><span class="op" id="3331004">.</span><span class="ident" id="3331005">oneminusQ</span><span class="op" id="3331014">*</span><span class="ident" id="3331015">x</span><span class="op" id="3331016">)</span><span class="op" id="3331017">)</span>&nbsp;<span class="op" id="3331019">-</span>&nbsp;<span class="ident" id="3331021">z</span><span class="op" id="3331022">.</span><span class="ident" id="3331023">v</span><br>
<span class="lineno"></span><span class="op" id="3331025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3331028">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3331092">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3331153">func</span>&nbsp;<span class="ident" id="3331158">NewZipf</span><span class="op" id="3331165">(</span><span class="ident" id="3331166">r</span>&nbsp;<span class="op" id="3331168">*</span><span class="ident" id="3331169">Rand</span><span class="op" id="3331173">,</span>&nbsp;<span class="ident" id="3331175">s</span>&nbsp;<span class="builtintype" id="3331177">float64</span><span class="op" id="3331184">,</span>&nbsp;<span class="ident" id="3331186">v</span>&nbsp;<span class="builtintype" id="3331188">float64</span><span class="op" id="3331195">,</span>&nbsp;<span class="ident" id="3331197">imax</span>&nbsp;<span class="ident" id="3331202">uint64</span><span class="op" id="3331208">)</span>&nbsp;<span class="op" id="3331210">*</span><span class="ident" id="3331211">Zipf</span>&nbsp;<span class="op" id="3331216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331219">z</span>&nbsp;<span class="op" id="3331221">:=</span>&nbsp;<span class="builtinfunc" id="3331224">new</span><span class="op" id="3331227">(</span><span class="ident" id="3331228">Zipf</span><span class="op" id="3331232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331235">if</span>&nbsp;<span class="ident" id="3331238">s</span>&nbsp;<span class="op" id="3331240">&lt;=</span>&nbsp;<span class="num" id="3331243">1.0</span>&nbsp;<span class="op" id="3331247">||</span>&nbsp;<span class="ident" id="3331250">v</span>&nbsp;<span class="op" id="3331252">&lt;</span>&nbsp;<span class="num" id="3331254">1</span>&nbsp;<span class="op" id="3331256">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331260">return</span>&nbsp;<span class="ident" id="3331267">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331275">z</span><span class="op" id="3331276">.</span><span class="ident" id="3331277">r</span>&nbsp;<span class="op" id="3331279">=</span>&nbsp;<span class="ident" id="3331281">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331284">z</span><span class="op" id="3331285">.</span><span class="ident" id="3331286">imax</span>&nbsp;<span class="op" id="3331291">=</span>&nbsp;<span class="builtintype" id="3331293">float64</span><span class="op" id="3331300">(</span><span class="ident" id="3331301">imax</span><span class="op" id="3331305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331308">z</span><span class="op" id="3331309">.</span><span class="ident" id="3331310">v</span>&nbsp;<span class="op" id="3331312">=</span>&nbsp;<span class="ident" id="3331314">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331317">z</span><span class="op" id="3331318">.</span><span class="ident" id="3331319">q</span>&nbsp;<span class="op" id="3331321">=</span>&nbsp;<span class="ident" id="3331323">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331326">z</span><span class="op" id="3331327">.</span><span class="ident" id="3331328">oneminusQ</span>&nbsp;<span class="op" id="3331338">=</span>&nbsp;<span class="num" id="3331340">1.0</span>&nbsp;<span class="op" id="3331344">-</span>&nbsp;<span class="ident" id="3331346">z</span><span class="op" id="3331347">.</span><span class="ident" id="3331348">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331351">z</span><span class="op" id="3331352">.</span><span class="ident" id="3331353">oneminusQinv</span>&nbsp;<span class="op" id="3331366">=</span>&nbsp;<span class="num" id="3331368">1.0</span>&nbsp;<span class="op" id="3331372">/</span>&nbsp;<span class="ident" id="3331374">z</span><span class="op" id="3331375">.</span><span class="ident" id="3331376">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331387">z</span><span class="op" id="3331388">.</span><span class="ident" id="3331389">hxm</span>&nbsp;<span class="op" id="3331393">=</span>&nbsp;<span class="ident" id="3331395">z</span><span class="op" id="3331396">.</span><span class="ident" id="3331397">h</span><span class="op" id="3331398">(</span><span class="ident" id="3331399">z</span><span class="op" id="3331400">.</span><span class="ident" id="3331401">imax</span>&nbsp;<span class="op" id="3331406">+</span>&nbsp;<span class="num" id="3331408">0.5</span><span class="op" id="3331411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331414">z</span><span class="op" id="3331415">.</span><span class="ident" id="3331416">hx0minusHxm</span>&nbsp;<span class="op" id="3331428">=</span>&nbsp;<span class="ident" id="3331430">z</span><span class="op" id="3331431">.</span><span class="ident" id="3331432">h</span><span class="op" id="3331433">(</span><span class="num" id="3331434">0.5</span><span class="op" id="3331437">)</span>&nbsp;<span class="op" id="3331439">-</span>&nbsp;<span class="ident" id="3331441">math</span><span class="op" id="3331445">.</span><span class="ident" id="3331446">Exp</span><span class="op" id="3331449">(</span><span class="ident" id="3331450">math</span><span class="op" id="3331454">.</span><span class="ident" id="3331455">Log</span><span class="op" id="3331458">(</span><span class="ident" id="3331459">z</span><span class="op" id="3331460">.</span><span class="ident" id="3331461">v</span><span class="op" id="3331462">)</span><span class="op" id="3331463">*</span><span class="op" id="3331464">(</span><span class="op" id="3331465">-</span><span class="ident" id="3331466">z</span><span class="op" id="3331467">.</span><span class="ident" id="3331468">q</span><span class="op" id="3331469">)</span><span class="op" id="3331470">)</span>&nbsp;<span class="op" id="3331472">-</span>&nbsp;<span class="ident" id="3331474">z</span><span class="op" id="3331475">.</span><span class="ident" id="3331476">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331481">z</span><span class="op" id="3331482">.</span><span class="ident" id="3331483">s</span>&nbsp;<span class="op" id="3331485">=</span>&nbsp;<span class="num" id="3331487">1</span>&nbsp;<span class="op" id="3331489">-</span>&nbsp;<span class="ident" id="3331491">z</span><span class="op" id="3331492">.</span><span class="ident" id="3331493">hinv</span><span class="op" id="3331497">(</span><span class="ident" id="3331498">z</span><span class="op" id="3331499">.</span><span class="ident" id="3331500">h</span><span class="op" id="3331501">(</span><span class="num" id="3331502">1.5</span><span class="op" id="3331505">)</span><span class="op" id="3331506">-</span><span class="ident" id="3331507">math</span><span class="op" id="3331511">.</span><span class="ident" id="3331512">Exp</span><span class="op" id="3331515">(</span><span class="op" id="3331516">-</span><span class="ident" id="3331517">z</span><span class="op" id="3331518">.</span><span class="ident" id="3331519">q</span><span class="op" id="3331520">*</span><span class="ident" id="3331521">math</span><span class="op" id="3331525">.</span><span class="ident" id="3331526">Log</span><span class="op" id="3331529">(</span><span class="ident" id="3331530">z</span><span class="op" id="3331531">.</span><span class="ident" id="3331532">v</span><span class="op" id="3331533">+</span><span class="num" id="3331534">1.0</span><span class="op" id="3331537">)</span><span class="op" id="3331538">)</span><span class="op" id="3331539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331542">return</span>&nbsp;<span class="ident" id="3331549">z</span><br>
<span class="lineno"></span><span class="op" id="3331551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3331554">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3331623">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3331646">func</span>&nbsp;<span class="op" id="3331651">(</span><span class="ident" id="3331652">z</span>&nbsp;<span class="op" id="3331654">*</span><span class="ident" id="3331655">Zipf</span><span class="op" id="3331659">)</span>&nbsp;<span class="ident" id="3331661">Uint64</span><span class="op" id="3331667">(</span><span class="op" id="3331668">)</span>&nbsp;<span class="ident" id="3331670">uint64</span>&nbsp;<span class="op" id="3331677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331680">if</span>&nbsp;<span class="ident" id="3331683">z</span>&nbsp;<span class="op" id="3331685">==</span>&nbsp;<span class="ident" id="3331688">nil</span>&nbsp;<span class="op" id="3331692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3331696">panic</span><span class="op" id="3331701">(</span><span class="string" id="3331702">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3331718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331721">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331724">k</span>&nbsp;<span class="op" id="3331726">:=</span>&nbsp;<span class="num" id="3331729">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331735">for</span>&nbsp;<span class="op" id="3331739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331743">r</span>&nbsp;<span class="op" id="3331745">:=</span>&nbsp;<span class="ident" id="3331748">z</span><span class="op" id="3331749">.</span><span class="ident" id="3331750">r</span><span class="op" id="3331751">.</span><span class="ident" id="3331752">Float64</span><span class="op" id="3331759">(</span><span class="op" id="3331760">)</span>&nbsp;<span class="comment" id="3331762">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331778">ur</span>&nbsp;<span class="op" id="3331781">:=</span>&nbsp;<span class="ident" id="3331784">z</span><span class="op" id="3331785">.</span><span class="ident" id="3331786">hxm</span>&nbsp;<span class="op" id="3331790">+</span>&nbsp;<span class="ident" id="3331792">r</span><span class="op" id="3331793">*</span><span class="ident" id="3331794">z</span><span class="op" id="3331795">.</span><span class="ident" id="3331796">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331810">x</span>&nbsp;<span class="op" id="3331812">:=</span>&nbsp;<span class="ident" id="3331815">z</span><span class="op" id="3331816">.</span><span class="ident" id="3331817">hinv</span><span class="op" id="3331821">(</span><span class="ident" id="3331822">ur</span><span class="op" id="3331824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331828">k</span>&nbsp;<span class="op" id="3331830">=</span>&nbsp;<span class="ident" id="3331832">math</span><span class="op" id="3331836">.</span><span class="ident" id="3331837">Floor</span><span class="op" id="3331842">(</span><span class="ident" id="3331843">x</span>&nbsp;<span class="op" id="3331845">+</span>&nbsp;<span class="num" id="3331847">0.5</span><span class="op" id="3331850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331854">if</span>&nbsp;<span class="ident" id="3331857">k</span><span class="op" id="3331858">-</span><span class="ident" id="3331859">x</span>&nbsp;<span class="op" id="3331861">&lt;=</span>&nbsp;<span class="ident" id="3331864">z</span><span class="op" id="3331865">.</span><span class="ident" id="3331866">s</span>&nbsp;<span class="op" id="3331868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331873">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331881">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331885">if</span>&nbsp;<span class="ident" id="3331888">ur</span>&nbsp;<span class="op" id="3331891">&gt;=</span>&nbsp;<span class="ident" id="3331894">z</span><span class="op" id="3331895">.</span><span class="ident" id="3331896">h</span><span class="op" id="3331897">(</span><span class="ident" id="3331898">k</span><span class="op" id="3331899">+</span><span class="num" id="3331900">0.5</span><span class="op" id="3331903">)</span><span class="op" id="3331904">-</span><span class="ident" id="3331905">math</span><span class="op" id="3331909">.</span><span class="ident" id="3331910">Exp</span><span class="op" id="3331913">(</span><span class="op" id="3331914">-</span><span class="ident" id="3331915">math</span><span class="op" id="3331919">.</span><span class="ident" id="3331920">Log</span><span class="op" id="3331923">(</span><span class="ident" id="3331924">k</span><span class="op" id="3331925">+</span><span class="ident" id="3331926">z</span><span class="op" id="3331927">.</span><span class="ident" id="3331928">v</span><span class="op" id="3331929">)</span><span class="op" id="3331930">*</span><span class="ident" id="3331931">z</span><span class="op" id="3331932">.</span><span class="ident" id="3331933">q</span><span class="op" id="3331934">)</span>&nbsp;<span class="op" id="3331936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331941">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331955">return</span>&nbsp;<span class="ident" id="3331962">uint64</span><span class="op" id="3331968">(</span><span class="ident" id="3331969">k</span><span class="op" id="3331970">)</span><br>
<span class="lineno">75</span><span class="op" id="3331972">}</span>
</div>
</body>
</html>
