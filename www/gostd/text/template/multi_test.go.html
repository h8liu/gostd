<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html" class="current">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8000162">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8000217">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8000271">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8000322">package</span>&nbsp;<span class="ident" id="8000330">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8000340">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8000395">import</span>&nbsp;<span class="op" id="8000402">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8000405">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8000414">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8000421">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8000432">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8000443">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8000465">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8000468">const</span>&nbsp;<span class="op" id="8000474">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8000477">noError</span>&nbsp;&nbsp;<span class="op" id="8000486">=</span>&nbsp;<span class="builtintype" id="8000488">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8000494">hasError</span>&nbsp;<span class="op" id="8000503">=</span>&nbsp;<span class="builtintype" id="8000505">false</span><br>
<span class="lineno">20</span><span class="op" id="8000511">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8000514">type</span>&nbsp;<span class="ident" id="8000519">multiParseTest</span>&nbsp;<span class="keyword" id="8000534">struct</span>&nbsp;<span class="op" id="8000541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8000544">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8000552">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8000560">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8000568">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8000576">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8000584">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8000590">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8000598">[</span><span class="op" id="8000599">]</span><span class="builtintype" id="8000600">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8000608">results</span>&nbsp;<span class="op" id="8000616">[</span><span class="op" id="8000617">]</span><span class="builtintype" id="8000618">string</span><br>
<span class="lineno"></span><span class="op" id="8000625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8000628">var</span>&nbsp;<span class="ident" id="8000632">multiParseTests</span>&nbsp;<span class="op" id="8000648">=</span>&nbsp;<span class="op" id="8000650">[</span><span class="op" id="8000651">]</span><span class="ident" id="8000652">multiParseTest</span><span class="op" id="8000666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000669">{</span><span class="string" id="8000670">&#34;empty&#34;</span><span class="op" id="8000677">,</span>&nbsp;<span class="string" id="8000679">&#34;&#34;</span><span class="op" id="8000681">,</span>&nbsp;<span class="ident" id="8000683">noError</span><span class="op" id="8000690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8000694">nil</span><span class="op" id="8000697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8000701">nil</span><span class="op" id="8000704">}</span><span class="op" id="8000705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000708">{</span><span class="string" id="8000709">&#34;one&#34;</span><span class="op" id="8000714">,</span>&nbsp;<span class="string" id="8000716">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="8000746">,</span>&nbsp;<span class="ident" id="8000748">noError</span><span class="op" id="8000755">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000759">[</span><span class="op" id="8000760">]</span><span class="builtintype" id="8000761">string</span><span class="op" id="8000767">{</span><span class="string" id="8000768">&#34;foo&#34;</span><span class="op" id="8000773">}</span><span class="op" id="8000774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000778">[</span><span class="op" id="8000779">]</span><span class="builtintype" id="8000780">string</span><span class="op" id="8000786">{</span><span class="string" id="8000787">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8000794">}</span><span class="op" id="8000795">}</span><span class="op" id="8000796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000799">{</span><span class="string" id="8000800">&#34;two&#34;</span><span class="op" id="8000805">,</span>&nbsp;<span class="string" id="8000807">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="8000865">,</span>&nbsp;<span class="ident" id="8000867">noError</span><span class="op" id="8000874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000878">[</span><span class="op" id="8000879">]</span><span class="builtintype" id="8000880">string</span><span class="op" id="8000886">{</span><span class="string" id="8000887">&#34;foo&#34;</span><span class="op" id="8000892">,</span>&nbsp;<span class="string" id="8000894">&#34;bar&#34;</span><span class="op" id="8000899">}</span><span class="op" id="8000900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000904">[</span><span class="op" id="8000905">]</span><span class="builtintype" id="8000906">string</span><span class="op" id="8000912">{</span><span class="string" id="8000913">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8000920">,</span>&nbsp;<span class="string" id="8000922">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="8000929">}</span><span class="op" id="8000930">}</span><span class="op" id="8000931">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8000934">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8000945">{</span><span class="string" id="8000946">&#34;missing&nbsp;end&#34;</span><span class="op" id="8000959">,</span>&nbsp;<span class="string" id="8000961">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="8000984">,</span>&nbsp;<span class="ident" id="8000986">hasError</span><span class="op" id="8000994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8000998">nil</span><span class="op" id="8001001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8001005">nil</span><span class="op" id="8001008">}</span><span class="op" id="8001009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8001012">{</span><span class="string" id="8001013">&#34;malformed&nbsp;name&#34;</span><span class="op" id="8001029">,</span>&nbsp;<span class="string" id="8001031">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="8001053">,</span>&nbsp;<span class="ident" id="8001055">hasError</span><span class="op" id="8001063">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8001067">nil</span><span class="op" id="8001070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8001074">nil</span><span class="op" id="8001077">}</span><span class="op" id="8001078">,</span><br>
<span class="lineno"></span><span class="op" id="8001080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8001083">func</span>&nbsp;<span class="ident" id="8001088">TestMultiParse</span><span class="op" id="8001102">(</span><span class="ident" id="8001103">t</span>&nbsp;<span class="op" id="8001105">*</span><span class="ident" id="8001106">testing</span><span class="op" id="8001113">.</span><span class="ident" id="8001114">T</span><span class="op" id="8001115">)</span>&nbsp;<span class="op" id="8001117">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001120">for</span>&nbsp;<span class="ident" id="8001124">_</span><span class="op" id="8001125">,</span>&nbsp;<span class="ident" id="8001127">test</span>&nbsp;<span class="op" id="8001132">:=</span>&nbsp;<span class="keyword" id="8001135">range</span>&nbsp;<span class="ident" id="8001141">multiParseTests</span>&nbsp;<span class="op" id="8001157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001161">template</span><span class="op" id="8001169">,</span>&nbsp;<span class="ident" id="8001171">err</span>&nbsp;<span class="op" id="8001175">:=</span>&nbsp;<span class="ident" id="8001178">New</span><span class="op" id="8001181">(</span><span class="string" id="8001182">&#34;root&#34;</span><span class="op" id="8001188">)</span><span class="op" id="8001189">.</span><span class="ident" id="8001190">Parse</span><span class="op" id="8001195">(</span><span class="ident" id="8001196">test</span><span class="op" id="8001200">.</span><span class="ident" id="8001201">input</span><span class="op" id="8001206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001210">switch</span>&nbsp;<span class="op" id="8001217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001221">case</span>&nbsp;<span class="ident" id="8001226">err</span>&nbsp;<span class="op" id="8001230">==</span>&nbsp;<span class="builtintype" id="8001233">nil</span>&nbsp;<span class="op" id="8001237">&amp;&amp;</span>&nbsp;<span class="op" id="8001240">!</span><span class="ident" id="8001241">test</span><span class="op" id="8001245">.</span><span class="ident" id="8001246">ok</span><span class="op" id="8001248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001253">t</span><span class="op" id="8001254">.</span><span class="ident" id="8001255">Errorf</span><span class="op" id="8001261">(</span><span class="string" id="8001262">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8001292">,</span>&nbsp;<span class="ident" id="8001294">test</span><span class="op" id="8001298">.</span><span class="ident" id="8001299">name</span><span class="op" id="8001303">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001308">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001319">case</span>&nbsp;<span class="ident" id="8001324">err</span>&nbsp;<span class="op" id="8001328">!=</span>&nbsp;<span class="builtintype" id="8001331">nil</span>&nbsp;<span class="op" id="8001335">&amp;&amp;</span>&nbsp;<span class="ident" id="8001338">test</span><span class="op" id="8001342">.</span><span class="ident" id="8001343">ok</span><span class="op" id="8001345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001350">t</span><span class="op" id="8001351">.</span><span class="ident" id="8001352">Errorf</span><span class="op" id="8001358">(</span><span class="string" id="8001359">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8001385">,</span>&nbsp;<span class="ident" id="8001387">test</span><span class="op" id="8001391">.</span><span class="ident" id="8001392">name</span><span class="op" id="8001396">,</span>&nbsp;<span class="ident" id="8001398">err</span><span class="op" id="8001401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001406">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001417">case</span>&nbsp;<span class="ident" id="8001422">err</span>&nbsp;<span class="op" id="8001426">!=</span>&nbsp;<span class="builtintype" id="8001429">nil</span>&nbsp;<span class="op" id="8001433">&amp;&amp;</span>&nbsp;<span class="op" id="8001436">!</span><span class="ident" id="8001437">test</span><span class="op" id="8001441">.</span><span class="ident" id="8001442">ok</span><span class="op" id="8001444">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8001449">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001479">if</span>&nbsp;<span class="op" id="8001482">*</span><span class="ident" id="8001483">debug</span>&nbsp;<span class="op" id="8001489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001495">fmt</span><span class="op" id="8001498">.</span><span class="ident" id="8001499">Printf</span><span class="op" id="8001505">(</span><span class="string" id="8001506">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="8001522">,</span>&nbsp;<span class="ident" id="8001524">test</span><span class="op" id="8001528">.</span><span class="ident" id="8001529">name</span><span class="op" id="8001533">,</span>&nbsp;<span class="ident" id="8001535">test</span><span class="op" id="8001539">.</span><span class="ident" id="8001540">input</span><span class="op" id="8001545">,</span>&nbsp;<span class="ident" id="8001547">err</span><span class="op" id="8001550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8001555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001560">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8001571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001575">if</span>&nbsp;<span class="ident" id="8001578">template</span>&nbsp;<span class="op" id="8001587">==</span>&nbsp;<span class="builtintype" id="8001590">nil</span>&nbsp;<span class="op" id="8001594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001599">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8001610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001614">if</span>&nbsp;<span class="builtinfunc" id="8001617">len</span><span class="op" id="8001620">(</span><span class="ident" id="8001621">template</span><span class="op" id="8001629">.</span><span class="ident" id="8001630">tmpl</span><span class="op" id="8001634">)</span>&nbsp;<span class="op" id="8001636">!=</span>&nbsp;<span class="builtinfunc" id="8001639">len</span><span class="op" id="8001642">(</span><span class="ident" id="8001643">test</span><span class="op" id="8001647">.</span><span class="ident" id="8001648">names</span><span class="op" id="8001653">)</span><span class="op" id="8001654">+</span><span class="num" id="8001655">1</span>&nbsp;<span class="op" id="8001657">{</span>&nbsp;<span class="comment" id="8001659">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001677">t</span><span class="op" id="8001678">.</span><span class="ident" id="8001679">Errorf</span><span class="op" id="8001685">(</span><span class="string" id="8001686">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8001735">,</span>&nbsp;<span class="ident" id="8001737">test</span><span class="op" id="8001741">.</span><span class="ident" id="8001742">name</span><span class="op" id="8001746">,</span>&nbsp;<span class="builtinfunc" id="8001748">len</span><span class="op" id="8001751">(</span><span class="ident" id="8001752">test</span><span class="op" id="8001756">.</span><span class="ident" id="8001757">names</span><span class="op" id="8001762">)</span><span class="op" id="8001763">,</span>&nbsp;<span class="builtinfunc" id="8001765">len</span><span class="op" id="8001768">(</span><span class="ident" id="8001769">template</span><span class="op" id="8001777">.</span><span class="ident" id="8001778">tmpl</span><span class="op" id="8001782">)</span><span class="op" id="8001783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001788">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8001799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001803">for</span>&nbsp;<span class="ident" id="8001807">i</span><span class="op" id="8001808">,</span>&nbsp;<span class="ident" id="8001810">name</span>&nbsp;<span class="op" id="8001815">:=</span>&nbsp;<span class="keyword" id="8001818">range</span>&nbsp;<span class="ident" id="8001824">test</span><span class="op" id="8001828">.</span><span class="ident" id="8001829">names</span>&nbsp;<span class="op" id="8001835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001840">tmpl</span><span class="op" id="8001844">,</span>&nbsp;<span class="ident" id="8001846">ok</span>&nbsp;<span class="op" id="8001849">:=</span>&nbsp;<span class="ident" id="8001852">template</span><span class="op" id="8001860">.</span><span class="ident" id="8001861">tmpl</span><span class="op" id="8001865">[</span><span class="ident" id="8001866">name</span><span class="op" id="8001870">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001875">if</span>&nbsp;<span class="op" id="8001878">!</span><span class="ident" id="8001879">ok</span>&nbsp;<span class="op" id="8001882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001888">t</span><span class="op" id="8001889">.</span><span class="ident" id="8001890">Errorf</span><span class="op" id="8001896">(</span><span class="string" id="8001897">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="8001925">,</span>&nbsp;<span class="ident" id="8001927">test</span><span class="op" id="8001931">.</span><span class="ident" id="8001932">name</span><span class="op" id="8001936">,</span>&nbsp;<span class="ident" id="8001938">name</span><span class="op" id="8001942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001948">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8001960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8001965">result</span>&nbsp;<span class="op" id="8001972">:=</span>&nbsp;<span class="ident" id="8001975">tmpl</span><span class="op" id="8001979">.</span><span class="ident" id="8001980">Root</span><span class="op" id="8001984">.</span><span class="ident" id="8001985">String</span><span class="op" id="8001991">(</span><span class="op" id="8001992">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8001997">if</span>&nbsp;<span class="ident" id="8002000">result</span>&nbsp;<span class="op" id="8002007">!=</span>&nbsp;<span class="ident" id="8002010">test</span><span class="op" id="8002014">.</span><span class="ident" id="8002015">results</span><span class="op" id="8002022">[</span><span class="ident" id="8002023">i</span><span class="op" id="8002024">]</span>&nbsp;<span class="op" id="8002026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8002032">t</span><span class="op" id="8002033">.</span><span class="ident" id="8002034">Errorf</span><span class="op" id="8002040">(</span><span class="string" id="8002041">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="8002077">,</span>&nbsp;<span class="ident" id="8002079">test</span><span class="op" id="8002083">.</span><span class="ident" id="8002084">name</span><span class="op" id="8002088">,</span>&nbsp;<span class="ident" id="8002090">test</span><span class="op" id="8002094">.</span><span class="ident" id="8002095">input</span><span class="op" id="8002100">,</span>&nbsp;<span class="ident" id="8002102">result</span><span class="op" id="8002108">,</span>&nbsp;<span class="ident" id="8002110">test</span><span class="op" id="8002114">.</span><span class="ident" id="8002115">results</span><span class="op" id="8002122">[</span><span class="ident" id="8002123">i</span><span class="op" id="8002124">]</span><span class="op" id="8002125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002137">}</span><br>
<span class="lineno">85</span><span class="op" id="8002139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8002142">var</span>&nbsp;<span class="ident" id="8002146">multiExecTests</span>&nbsp;<span class="op" id="8002161">=</span>&nbsp;<span class="op" id="8002163">[</span><span class="op" id="8002164">]</span><span class="ident" id="8002165">execTest</span><span class="op" id="8002173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002176">{</span><span class="string" id="8002177">&#34;empty&#34;</span><span class="op" id="8002184">,</span>&nbsp;<span class="string" id="8002186">&#34;&#34;</span><span class="op" id="8002188">,</span>&nbsp;<span class="string" id="8002190">&#34;&#34;</span><span class="op" id="8002192">,</span>&nbsp;<span class="builtintype" id="8002194">nil</span><span class="op" id="8002197">,</span>&nbsp;<span class="builtintype" id="8002199">true</span><span class="op" id="8002203">}</span><span class="op" id="8002204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002207">{</span><span class="string" id="8002208">&#34;text&#34;</span><span class="op" id="8002214">,</span>&nbsp;<span class="string" id="8002216">&#34;some&nbsp;text&#34;</span><span class="op" id="8002227">,</span>&nbsp;<span class="string" id="8002229">&#34;some&nbsp;text&#34;</span><span class="op" id="8002240">,</span>&nbsp;<span class="builtintype" id="8002242">nil</span><span class="op" id="8002245">,</span>&nbsp;<span class="builtintype" id="8002247">true</span><span class="op" id="8002251">}</span><span class="op" id="8002252">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002255">{</span><span class="string" id="8002256">&#34;invoke&nbsp;x&#34;</span><span class="op" id="8002266">,</span>&nbsp;<span class="string" id="8002268">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="8002290">,</span>&nbsp;<span class="string" id="8002292">&#34;TEXT&#34;</span><span class="op" id="8002298">,</span>&nbsp;<span class="ident" id="8002300">tVal</span><span class="op" id="8002304">,</span>&nbsp;<span class="builtintype" id="8002306">true</span><span class="op" id="8002310">}</span><span class="op" id="8002311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002314">{</span><span class="string" id="8002315">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="8002333">,</span>&nbsp;<span class="string" id="8002335">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="8002353">,</span>&nbsp;<span class="string" id="8002355">&#34;TEXT&#34;</span><span class="op" id="8002361">,</span>&nbsp;<span class="ident" id="8002363">tVal</span><span class="op" id="8002367">,</span>&nbsp;<span class="builtintype" id="8002369">true</span><span class="op" id="8002373">}</span><span class="op" id="8002374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002377">{</span><span class="string" id="8002378">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="8002394">,</span>&nbsp;<span class="string" id="8002396">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="8002419">,</span>&nbsp;<span class="string" id="8002421">&#34;17&#34;</span><span class="op" id="8002425">,</span>&nbsp;<span class="ident" id="8002427">tVal</span><span class="op" id="8002431">,</span>&nbsp;<span class="builtintype" id="8002433">true</span><span class="op" id="8002437">}</span><span class="op" id="8002438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002441">{</span><span class="string" id="8002442">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="8002460">,</span>&nbsp;<span class="string" id="8002462">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="8002486">,</span>&nbsp;<span class="string" id="8002488">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="8002497">,</span>&nbsp;<span class="ident" id="8002499">tVal</span><span class="op" id="8002503">,</span>&nbsp;<span class="builtintype" id="8002505">true</span><span class="op" id="8002509">}</span><span class="op" id="8002510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002513">{</span><span class="string" id="8002514">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="8002527">,</span>&nbsp;<span class="string" id="8002529">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="8002553">,</span>&nbsp;<span class="string" id="8002555">&#34;v&#34;</span><span class="op" id="8002558">,</span>&nbsp;<span class="ident" id="8002560">tVal</span><span class="op" id="8002564">,</span>&nbsp;<span class="builtintype" id="8002566">true</span><span class="op" id="8002570">}</span><span class="op" id="8002571">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002574">{</span><span class="string" id="8002575">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="8002594">,</span>&nbsp;<span class="string" id="8002596">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="8002622">,</span>&nbsp;<span class="string" id="8002624">&#34;17&#34;</span><span class="op" id="8002628">,</span>&nbsp;<span class="ident" id="8002630">tVal</span><span class="op" id="8002634">,</span>&nbsp;<span class="builtintype" id="8002636">true</span><span class="op" id="8002640">}</span><span class="op" id="8002641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002644">{</span><span class="string" id="8002645">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="8002676">,</span>&nbsp;<span class="string" id="8002678">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="8002724">,</span>&nbsp;<span class="string" id="8002726">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="8002737">,</span>&nbsp;<span class="ident" id="8002739">tVal</span><span class="op" id="8002743">,</span>&nbsp;<span class="builtintype" id="8002745">true</span><span class="op" id="8002749">}</span><span class="op" id="8002750">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8002754">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002806">{</span><span class="string" id="8002807">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="8002825">,</span>&nbsp;<span class="string" id="8002827">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="8002845">,</span>&nbsp;<span class="string" id="8002847">&#34;oneArg=joe&#34;</span><span class="op" id="8002859">,</span>&nbsp;<span class="ident" id="8002861">tVal</span><span class="op" id="8002865">,</span>&nbsp;<span class="builtintype" id="8002867">true</span><span class="op" id="8002871">}</span><span class="op" id="8002872">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8002875">{</span><span class="string" id="8002876">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="8002888">,</span>&nbsp;<span class="string" id="8002890">`{{oneArg&nbsp;.}}`</span><span class="op" id="8002904">,</span>&nbsp;<span class="string" id="8002906">&#34;oneArg=joe&#34;</span><span class="op" id="8002918">,</span>&nbsp;<span class="string" id="8002920">&#34;joe&#34;</span><span class="op" id="8002925">,</span>&nbsp;<span class="builtintype" id="8002927">true</span><span class="op" id="8002931">}</span><span class="op" id="8002932">,</span><br>
<span class="lineno"></span><span class="op" id="8002934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8002937">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="8002978">const</span>&nbsp;<span class="ident" id="8002984">multiText1</span>&nbsp;<span class="op" id="8002995">=</span>&nbsp;<span class="string" id="8002997">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8003061">const</span>&nbsp;<span class="ident" id="8003067">multiText2</span>&nbsp;<span class="op" id="8003078">=</span>&nbsp;<span class="string" id="8003080">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8003163">func</span>&nbsp;<span class="ident" id="8003168">TestMultiExecute</span><span class="op" id="8003184">(</span><span class="ident" id="8003185">t</span>&nbsp;<span class="op" id="8003187">*</span><span class="ident" id="8003188">testing</span><span class="op" id="8003195">.</span><span class="ident" id="8003196">T</span><span class="op" id="8003197">)</span>&nbsp;<span class="op" id="8003199">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8003202">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003243">template</span><span class="op" id="8003251">,</span>&nbsp;<span class="ident" id="8003253">err</span>&nbsp;<span class="op" id="8003257">:=</span>&nbsp;<span class="ident" id="8003260">New</span><span class="op" id="8003263">(</span><span class="string" id="8003264">&#34;root&#34;</span><span class="op" id="8003270">)</span><span class="op" id="8003271">.</span><span class="ident" id="8003272">Parse</span><span class="op" id="8003277">(</span><span class="ident" id="8003278">multiText1</span><span class="op" id="8003288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8003291">if</span>&nbsp;<span class="ident" id="8003294">err</span>&nbsp;<span class="op" id="8003298">!=</span>&nbsp;<span class="builtintype" id="8003301">nil</span>&nbsp;<span class="op" id="8003305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003309">t</span><span class="op" id="8003310">.</span><span class="ident" id="8003311">Fatalf</span><span class="op" id="8003317">(</span><span class="string" id="8003318">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="8003341">,</span>&nbsp;<span class="ident" id="8003343">err</span><span class="op" id="8003346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8003349">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003352">_</span><span class="op" id="8003353">,</span>&nbsp;<span class="ident" id="8003355">err</span>&nbsp;<span class="op" id="8003359">=</span>&nbsp;<span class="ident" id="8003361">template</span><span class="op" id="8003369">.</span><span class="ident" id="8003370">Parse</span><span class="op" id="8003375">(</span><span class="ident" id="8003376">multiText2</span><span class="op" id="8003386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8003389">if</span>&nbsp;<span class="ident" id="8003392">err</span>&nbsp;<span class="op" id="8003396">!=</span>&nbsp;<span class="builtintype" id="8003399">nil</span>&nbsp;<span class="op" id="8003403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003407">t</span><span class="op" id="8003408">.</span><span class="ident" id="8003409">Fatalf</span><span class="op" id="8003415">(</span><span class="string" id="8003416">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="8003439">,</span>&nbsp;<span class="ident" id="8003441">err</span><span class="op" id="8003444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8003447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003450">testExecute</span><span class="op" id="8003461">(</span><span class="ident" id="8003462">multiExecTests</span><span class="op" id="8003476">,</span>&nbsp;<span class="ident" id="8003478">template</span><span class="op" id="8003486">,</span>&nbsp;<span class="ident" id="8003488">t</span><span class="op" id="8003489">)</span><br>
<span class="lineno">125</span><span class="op" id="8003491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8003494">func</span>&nbsp;<span class="ident" id="8003499">TestParseFiles</span><span class="op" id="8003513">(</span><span class="ident" id="8003514">t</span>&nbsp;<span class="op" id="8003516">*</span><span class="ident" id="8003517">testing</span><span class="op" id="8003524">.</span><span class="ident" id="8003525">T</span><span class="op" id="8003526">)</span>&nbsp;<span class="op" id="8003528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003531">_</span><span class="op" id="8003532">,</span>&nbsp;<span class="ident" id="8003534">err</span>&nbsp;<span class="op" id="8003538">:=</span>&nbsp;<span class="ident" id="8003541">ParseFiles</span><span class="op" id="8003551">(</span><span class="string" id="8003552">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8003568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8003571">if</span>&nbsp;<span class="ident" id="8003574">err</span>&nbsp;<span class="op" id="8003578">==</span>&nbsp;<span class="builtintype" id="8003581">nil</span>&nbsp;<span class="op" id="8003585">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003589">t</span><span class="op" id="8003590">.</span><span class="ident" id="8003591">Error</span><span class="op" id="8003596">(</span><span class="string" id="8003597">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8003645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8003648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003651">template</span>&nbsp;<span class="op" id="8003660">:=</span>&nbsp;<span class="ident" id="8003663">New</span><span class="op" id="8003666">(</span><span class="string" id="8003667">&#34;root&#34;</span><span class="op" id="8003673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003676">_</span><span class="op" id="8003677">,</span>&nbsp;<span class="ident" id="8003679">err</span>&nbsp;<span class="op" id="8003683">=</span>&nbsp;<span class="ident" id="8003685">template</span><span class="op" id="8003693">.</span><span class="ident" id="8003694">ParseFiles</span><span class="op" id="8003704">(</span><span class="string" id="8003705">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="8003726">,</span>&nbsp;<span class="string" id="8003728">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="8003749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8003752">if</span>&nbsp;<span class="ident" id="8003755">err</span>&nbsp;<span class="op" id="8003759">!=</span>&nbsp;<span class="builtintype" id="8003762">nil</span>&nbsp;<span class="op" id="8003766">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003770">t</span><span class="op" id="8003771">.</span><span class="ident" id="8003772">Fatalf</span><span class="op" id="8003778">(</span><span class="string" id="8003779">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8003804">,</span>&nbsp;<span class="ident" id="8003806">err</span><span class="op" id="8003809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8003812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003815">testExecute</span><span class="op" id="8003826">(</span><span class="ident" id="8003827">multiExecTests</span><span class="op" id="8003841">,</span>&nbsp;<span class="ident" id="8003843">template</span><span class="op" id="8003851">,</span>&nbsp;<span class="ident" id="8003853">t</span><span class="op" id="8003854">)</span><br>
<span class="lineno"></span><span class="op" id="8003856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="8003859">func</span>&nbsp;<span class="ident" id="8003864">TestParseGlob</span><span class="op" id="8003877">(</span><span class="ident" id="8003878">t</span>&nbsp;<span class="op" id="8003880">*</span><span class="ident" id="8003881">testing</span><span class="op" id="8003888">.</span><span class="ident" id="8003889">T</span><span class="op" id="8003890">)</span>&nbsp;<span class="op" id="8003892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003895">_</span><span class="op" id="8003896">,</span>&nbsp;<span class="ident" id="8003898">err</span>&nbsp;<span class="op" id="8003902">:=</span>&nbsp;<span class="ident" id="8003905">ParseGlob</span><span class="op" id="8003914">(</span><span class="string" id="8003915">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8003931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8003934">if</span>&nbsp;<span class="ident" id="8003937">err</span>&nbsp;<span class="op" id="8003941">==</span>&nbsp;<span class="builtintype" id="8003944">nil</span>&nbsp;<span class="op" id="8003948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8003952">t</span><span class="op" id="8003953">.</span><span class="ident" id="8003954">Error</span><span class="op" id="8003959">(</span><span class="string" id="8003960">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8004008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8004011">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004014">_</span><span class="op" id="8004015">,</span>&nbsp;<span class="ident" id="8004017">err</span>&nbsp;<span class="op" id="8004021">=</span>&nbsp;<span class="ident" id="8004023">New</span><span class="op" id="8004026">(</span><span class="string" id="8004027">&#34;error&#34;</span><span class="op" id="8004034">)</span><span class="op" id="8004035">.</span><span class="ident" id="8004036">ParseGlob</span><span class="op" id="8004045">(</span><span class="string" id="8004046">&#34;[x&#34;</span><span class="op" id="8004050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8004053">if</span>&nbsp;<span class="ident" id="8004056">err</span>&nbsp;<span class="op" id="8004060">==</span>&nbsp;<span class="builtintype" id="8004063">nil</span>&nbsp;<span class="op" id="8004067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004071">t</span><span class="op" id="8004072">.</span><span class="ident" id="8004073">Error</span><span class="op" id="8004078">(</span><span class="string" id="8004079">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8004121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8004124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004127">template</span>&nbsp;<span class="op" id="8004136">:=</span>&nbsp;<span class="ident" id="8004139">New</span><span class="op" id="8004142">(</span><span class="string" id="8004143">&#34;root&#34;</span><span class="op" id="8004149">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004152">_</span><span class="op" id="8004153">,</span>&nbsp;<span class="ident" id="8004155">err</span>&nbsp;<span class="op" id="8004159">=</span>&nbsp;<span class="ident" id="8004161">template</span><span class="op" id="8004169">.</span><span class="ident" id="8004170">ParseGlob</span><span class="op" id="8004179">(</span><span class="string" id="8004180">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="8004201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8004204">if</span>&nbsp;<span class="ident" id="8004207">err</span>&nbsp;<span class="op" id="8004211">!=</span>&nbsp;<span class="builtintype" id="8004214">nil</span>&nbsp;<span class="op" id="8004218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004222">t</span><span class="op" id="8004223">.</span><span class="ident" id="8004224">Fatalf</span><span class="op" id="8004230">(</span><span class="string" id="8004231">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8004256">,</span>&nbsp;<span class="ident" id="8004258">err</span><span class="op" id="8004261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8004264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004267">testExecute</span><span class="op" id="8004278">(</span><span class="ident" id="8004279">multiExecTests</span><span class="op" id="8004293">,</span>&nbsp;<span class="ident" id="8004295">template</span><span class="op" id="8004303">,</span>&nbsp;<span class="ident" id="8004305">t</span><span class="op" id="8004306">)</span><br>
<span class="lineno">155</span><span class="op" id="8004308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8004311">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8004407">var</span>&nbsp;<span class="ident" id="8004411">templateFileExecTests</span>&nbsp;<span class="op" id="8004433">=</span>&nbsp;<span class="op" id="8004435">[</span><span class="op" id="8004436">]</span><span class="ident" id="8004437">execTest</span><span class="op" id="8004445">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8004448">{</span><span class="string" id="8004449">&#34;test&#34;</span><span class="op" id="8004455">,</span>&nbsp;<span class="string" id="8004457">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="8004509">,</span>&nbsp;<span class="string" id="8004511">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="8004545">,</span>&nbsp;<span class="num" id="8004547">0</span><span class="op" id="8004548">,</span>&nbsp;<span class="builtintype" id="8004550">true</span><span class="op" id="8004554">}</span><span class="op" id="8004555">,</span><br>
<span class="lineno"></span><span class="op" id="8004557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8004560">func</span>&nbsp;<span class="ident" id="8004565">TestParseFilesWithData</span><span class="op" id="8004587">(</span><span class="ident" id="8004588">t</span>&nbsp;<span class="op" id="8004590">*</span><span class="ident" id="8004591">testing</span><span class="op" id="8004598">.</span><span class="ident" id="8004599">T</span><span class="op" id="8004600">)</span>&nbsp;<span class="op" id="8004602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004605">template</span><span class="op" id="8004613">,</span>&nbsp;<span class="ident" id="8004615">err</span>&nbsp;<span class="op" id="8004619">:=</span>&nbsp;<span class="ident" id="8004622">New</span><span class="op" id="8004625">(</span><span class="string" id="8004626">&#34;root&#34;</span><span class="op" id="8004632">)</span><span class="op" id="8004633">.</span><span class="ident" id="8004634">ParseFiles</span><span class="op" id="8004644">(</span><span class="string" id="8004645">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="8004666">,</span>&nbsp;<span class="string" id="8004668">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="8004689">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8004692">if</span>&nbsp;<span class="ident" id="8004695">err</span>&nbsp;<span class="op" id="8004699">!=</span>&nbsp;<span class="builtintype" id="8004702">nil</span>&nbsp;<span class="op" id="8004706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004710">t</span><span class="op" id="8004711">.</span><span class="ident" id="8004712">Fatalf</span><span class="op" id="8004718">(</span><span class="string" id="8004719">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8004744">,</span>&nbsp;<span class="ident" id="8004746">err</span><span class="op" id="8004749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8004752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004755">testExecute</span><span class="op" id="8004766">(</span><span class="ident" id="8004767">templateFileExecTests</span><span class="op" id="8004788">,</span>&nbsp;<span class="ident" id="8004790">template</span><span class="op" id="8004798">,</span>&nbsp;<span class="ident" id="8004800">t</span><span class="op" id="8004801">)</span><br>
<span class="lineno"></span><span class="op" id="8004803">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8004806">func</span>&nbsp;<span class="ident" id="8004811">TestParseGlobWithData</span><span class="op" id="8004832">(</span><span class="ident" id="8004833">t</span>&nbsp;<span class="op" id="8004835">*</span><span class="ident" id="8004836">testing</span><span class="op" id="8004843">.</span><span class="ident" id="8004844">T</span><span class="op" id="8004845">)</span>&nbsp;<span class="op" id="8004847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004850">template</span><span class="op" id="8004858">,</span>&nbsp;<span class="ident" id="8004860">err</span>&nbsp;<span class="op" id="8004864">:=</span>&nbsp;<span class="ident" id="8004867">New</span><span class="op" id="8004870">(</span><span class="string" id="8004871">&#34;root&#34;</span><span class="op" id="8004877">)</span><span class="op" id="8004878">.</span><span class="ident" id="8004879">ParseGlob</span><span class="op" id="8004888">(</span><span class="string" id="8004889">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="8004910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8004913">if</span>&nbsp;<span class="ident" id="8004916">err</span>&nbsp;<span class="op" id="8004920">!=</span>&nbsp;<span class="builtintype" id="8004923">nil</span>&nbsp;<span class="op" id="8004927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004931">t</span><span class="op" id="8004932">.</span><span class="ident" id="8004933">Fatalf</span><span class="op" id="8004939">(</span><span class="string" id="8004940">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8004965">,</span>&nbsp;<span class="ident" id="8004967">err</span><span class="op" id="8004970">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8004973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8004976">testExecute</span><span class="op" id="8004987">(</span><span class="ident" id="8004988">templateFileExecTests</span><span class="op" id="8005009">,</span>&nbsp;<span class="ident" id="8005011">template</span><span class="op" id="8005019">,</span>&nbsp;<span class="ident" id="8005021">t</span><span class="op" id="8005022">)</span><br>
<span class="lineno"></span><span class="op" id="8005024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8005027">const</span>&nbsp;<span class="op" id="8005033">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005036">cloneText1</span>&nbsp;<span class="op" id="8005047">=</span>&nbsp;<span class="string" id="8005049">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005106">cloneText2</span>&nbsp;<span class="op" id="8005117">=</span>&nbsp;<span class="string" id="8005119">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005145">cloneText3</span>&nbsp;<span class="op" id="8005156">=</span>&nbsp;<span class="string" id="8005158">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005187">cloneText4</span>&nbsp;<span class="op" id="8005198">=</span>&nbsp;<span class="string" id="8005200">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="8005229">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="8005232">func</span>&nbsp;<span class="ident" id="8005237">TestClone</span><span class="op" id="8005246">(</span><span class="ident" id="8005247">t</span>&nbsp;<span class="op" id="8005249">*</span><span class="ident" id="8005250">testing</span><span class="op" id="8005257">.</span><span class="ident" id="8005258">T</span><span class="op" id="8005259">)</span>&nbsp;<span class="op" id="8005261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8005264">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005310">root</span><span class="op" id="8005314">,</span>&nbsp;<span class="ident" id="8005316">err</span>&nbsp;<span class="op" id="8005320">:=</span>&nbsp;<span class="ident" id="8005323">New</span><span class="op" id="8005326">(</span><span class="string" id="8005327">&#34;root&#34;</span><span class="op" id="8005333">)</span><span class="op" id="8005334">.</span><span class="ident" id="8005335">Parse</span><span class="op" id="8005340">(</span><span class="ident" id="8005341">cloneText1</span><span class="op" id="8005351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005354">if</span>&nbsp;<span class="ident" id="8005357">err</span>&nbsp;<span class="op" id="8005361">!=</span>&nbsp;<span class="builtintype" id="8005364">nil</span>&nbsp;<span class="op" id="8005368">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005372">t</span><span class="op" id="8005373">.</span><span class="ident" id="8005374">Fatal</span><span class="op" id="8005379">(</span><span class="ident" id="8005380">err</span><span class="op" id="8005383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8005386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005389">_</span><span class="op" id="8005390">,</span>&nbsp;<span class="ident" id="8005392">err</span>&nbsp;<span class="op" id="8005396">=</span>&nbsp;<span class="ident" id="8005398">root</span><span class="op" id="8005402">.</span><span class="ident" id="8005403">Parse</span><span class="op" id="8005408">(</span><span class="ident" id="8005409">cloneText2</span><span class="op" id="8005419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005422">if</span>&nbsp;<span class="ident" id="8005425">err</span>&nbsp;<span class="op" id="8005429">!=</span>&nbsp;<span class="builtintype" id="8005432">nil</span>&nbsp;<span class="op" id="8005436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005440">t</span><span class="op" id="8005441">.</span><span class="ident" id="8005442">Fatal</span><span class="op" id="8005447">(</span><span class="ident" id="8005448">err</span><span class="op" id="8005451">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8005454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005457">clone</span>&nbsp;<span class="op" id="8005463">:=</span>&nbsp;<span class="ident" id="8005466">Must</span><span class="op" id="8005470">(</span><span class="ident" id="8005471">root</span><span class="op" id="8005475">.</span><span class="ident" id="8005476">Clone</span><span class="op" id="8005481">(</span><span class="op" id="8005482">)</span><span class="op" id="8005483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8005486">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005512">_</span><span class="op" id="8005513">,</span>&nbsp;<span class="ident" id="8005515">err</span>&nbsp;<span class="op" id="8005519">=</span>&nbsp;<span class="ident" id="8005521">root</span><span class="op" id="8005525">.</span><span class="ident" id="8005526">Parse</span><span class="op" id="8005531">(</span><span class="ident" id="8005532">cloneText3</span><span class="op" id="8005542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005545">if</span>&nbsp;<span class="ident" id="8005548">err</span>&nbsp;<span class="op" id="8005552">!=</span>&nbsp;<span class="builtintype" id="8005555">nil</span>&nbsp;<span class="op" id="8005559">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005563">t</span><span class="op" id="8005564">.</span><span class="ident" id="8005565">Fatal</span><span class="op" id="8005570">(</span><span class="ident" id="8005571">err</span><span class="op" id="8005574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8005577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005580">_</span><span class="op" id="8005581">,</span>&nbsp;<span class="ident" id="8005583">err</span>&nbsp;<span class="op" id="8005587">=</span>&nbsp;<span class="ident" id="8005589">clone</span><span class="op" id="8005594">.</span><span class="ident" id="8005595">Parse</span><span class="op" id="8005600">(</span><span class="ident" id="8005601">cloneText4</span><span class="op" id="8005611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005614">if</span>&nbsp;<span class="ident" id="8005617">err</span>&nbsp;<span class="op" id="8005621">!=</span>&nbsp;<span class="builtintype" id="8005624">nil</span>&nbsp;<span class="op" id="8005628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005632">t</span><span class="op" id="8005633">.</span><span class="ident" id="8005634">Fatal</span><span class="op" id="8005639">(</span><span class="ident" id="8005640">err</span><span class="op" id="8005643">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8005646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8005649">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005695">for</span>&nbsp;<span class="ident" id="8005699">k</span><span class="op" id="8005700">,</span>&nbsp;<span class="ident" id="8005702">v</span>&nbsp;<span class="op" id="8005704">:=</span>&nbsp;<span class="keyword" id="8005707">range</span>&nbsp;<span class="ident" id="8005713">clone</span><span class="op" id="8005718">.</span><span class="ident" id="8005719">tmpl</span>&nbsp;<span class="op" id="8005724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005728">if</span>&nbsp;<span class="ident" id="8005731">k</span>&nbsp;<span class="op" id="8005733">==</span>&nbsp;<span class="ident" id="8005736">clone</span><span class="op" id="8005741">.</span><span class="ident" id="8005742">name</span>&nbsp;<span class="op" id="8005747">&amp;&amp;</span>&nbsp;<span class="ident" id="8005750">v</span><span class="op" id="8005751">.</span><span class="ident" id="8005752">tmpl</span><span class="op" id="8005756">[</span><span class="ident" id="8005757">k</span><span class="op" id="8005758">]</span>&nbsp;<span class="op" id="8005760">!=</span>&nbsp;<span class="ident" id="8005763">clone</span>&nbsp;<span class="op" id="8005769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005774">t</span><span class="op" id="8005775">.</span><span class="ident" id="8005776">Error</span><span class="op" id="8005781">(</span><span class="string" id="8005782">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="8005811">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8005815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005819">if</span>&nbsp;<span class="ident" id="8005822">v</span>&nbsp;<span class="op" id="8005824">!=</span>&nbsp;<span class="ident" id="8005827">v</span><span class="op" id="8005828">.</span><span class="ident" id="8005829">tmpl</span><span class="op" id="8005833">[</span><span class="ident" id="8005834">v</span><span class="op" id="8005835">.</span><span class="ident" id="8005836">name</span><span class="op" id="8005840">]</span>&nbsp;<span class="op" id="8005842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005847">t</span><span class="op" id="8005848">.</span><span class="ident" id="8005849">Errorf</span><span class="op" id="8005855">(</span><span class="string" id="8005856">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="8005892">,</span>&nbsp;<span class="ident" id="8005894">k</span><span class="op" id="8005895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8005899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8005902">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8005905">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005923">var</span>&nbsp;<span class="ident" id="8005927">b</span>&nbsp;<span class="ident" id="8005929">bytes</span><span class="op" id="8005934">.</span><span class="ident" id="8005935">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8005943">err</span>&nbsp;<span class="op" id="8005947">=</span>&nbsp;<span class="ident" id="8005949">root</span><span class="op" id="8005953">.</span><span class="ident" id="8005954">ExecuteTemplate</span><span class="op" id="8005969">(</span><span class="op" id="8005970">&amp;</span><span class="ident" id="8005971">b</span><span class="op" id="8005972">,</span>&nbsp;<span class="string" id="8005974">&#34;a&#34;</span><span class="op" id="8005977">,</span>&nbsp;<span class="num" id="8005979">0</span><span class="op" id="8005980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8005983">if</span>&nbsp;<span class="ident" id="8005986">err</span>&nbsp;<span class="op" id="8005990">!=</span>&nbsp;<span class="builtintype" id="8005993">nil</span>&nbsp;<span class="op" id="8005997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006001">t</span><span class="op" id="8006002">.</span><span class="ident" id="8006003">Fatal</span><span class="op" id="8006008">(</span><span class="ident" id="8006009">err</span><span class="op" id="8006012">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006018">if</span>&nbsp;<span class="ident" id="8006021">b</span><span class="op" id="8006022">.</span><span class="ident" id="8006023">String</span><span class="op" id="8006029">(</span><span class="op" id="8006030">)</span>&nbsp;<span class="op" id="8006032">!=</span>&nbsp;<span class="string" id="8006035">&#34;broot&#34;</span>&nbsp;<span class="op" id="8006043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006047">t</span><span class="op" id="8006048">.</span><span class="ident" id="8006049">Errorf</span><span class="op" id="8006055">(</span><span class="string" id="8006056">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8006076">,</span>&nbsp;<span class="string" id="8006078">&#34;broot&#34;</span><span class="op" id="8006085">,</span>&nbsp;<span class="ident" id="8006087">b</span><span class="op" id="8006088">.</span><span class="ident" id="8006089">String</span><span class="op" id="8006095">(</span><span class="op" id="8006096">)</span><span class="op" id="8006097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8006103">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006121">b</span><span class="op" id="8006122">.</span><span class="ident" id="8006123">Reset</span><span class="op" id="8006128">(</span><span class="op" id="8006129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006132">err</span>&nbsp;<span class="op" id="8006136">=</span>&nbsp;<span class="ident" id="8006138">clone</span><span class="op" id="8006143">.</span><span class="ident" id="8006144">ExecuteTemplate</span><span class="op" id="8006159">(</span><span class="op" id="8006160">&amp;</span><span class="ident" id="8006161">b</span><span class="op" id="8006162">,</span>&nbsp;<span class="string" id="8006164">&#34;a&#34;</span><span class="op" id="8006167">,</span>&nbsp;<span class="num" id="8006169">0</span><span class="op" id="8006170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006173">if</span>&nbsp;<span class="ident" id="8006176">err</span>&nbsp;<span class="op" id="8006180">!=</span>&nbsp;<span class="builtintype" id="8006183">nil</span>&nbsp;<span class="op" id="8006187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006191">t</span><span class="op" id="8006192">.</span><span class="ident" id="8006193">Fatal</span><span class="op" id="8006198">(</span><span class="ident" id="8006199">err</span><span class="op" id="8006202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006205">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006208">if</span>&nbsp;<span class="ident" id="8006211">b</span><span class="op" id="8006212">.</span><span class="ident" id="8006213">String</span><span class="op" id="8006219">(</span><span class="op" id="8006220">)</span>&nbsp;<span class="op" id="8006222">!=</span>&nbsp;<span class="string" id="8006225">&#34;bclone&#34;</span>&nbsp;<span class="op" id="8006234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006238">t</span><span class="op" id="8006239">.</span><span class="ident" id="8006240">Errorf</span><span class="op" id="8006246">(</span><span class="string" id="8006247">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8006267">,</span>&nbsp;<span class="string" id="8006269">&#34;bclone&#34;</span><span class="op" id="8006277">,</span>&nbsp;<span class="ident" id="8006279">b</span><span class="op" id="8006280">.</span><span class="ident" id="8006281">String</span><span class="op" id="8006287">(</span><span class="op" id="8006288">)</span><span class="op" id="8006289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006292">}</span><br>
<span class="lineno"></span><span class="op" id="8006294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8006297">func</span>&nbsp;<span class="ident" id="8006302">TestAddParseTree</span><span class="op" id="8006318">(</span><span class="ident" id="8006319">t</span>&nbsp;<span class="op" id="8006321">*</span><span class="ident" id="8006322">testing</span><span class="op" id="8006329">.</span><span class="ident" id="8006330">T</span><span class="op" id="8006331">)</span>&nbsp;<span class="op" id="8006333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8006336">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006363">root</span><span class="op" id="8006367">,</span>&nbsp;<span class="ident" id="8006369">err</span>&nbsp;<span class="op" id="8006373">:=</span>&nbsp;<span class="ident" id="8006376">New</span><span class="op" id="8006379">(</span><span class="string" id="8006380">&#34;root&#34;</span><span class="op" id="8006386">)</span><span class="op" id="8006387">.</span><span class="ident" id="8006388">Parse</span><span class="op" id="8006393">(</span><span class="ident" id="8006394">cloneText1</span><span class="op" id="8006404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006407">if</span>&nbsp;<span class="ident" id="8006410">err</span>&nbsp;<span class="op" id="8006414">!=</span>&nbsp;<span class="builtintype" id="8006417">nil</span>&nbsp;<span class="op" id="8006421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006425">t</span><span class="op" id="8006426">.</span><span class="ident" id="8006427">Fatal</span><span class="op" id="8006432">(</span><span class="ident" id="8006433">err</span><span class="op" id="8006436">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006442">_</span><span class="op" id="8006443">,</span>&nbsp;<span class="ident" id="8006445">err</span>&nbsp;<span class="op" id="8006449">=</span>&nbsp;<span class="ident" id="8006451">root</span><span class="op" id="8006455">.</span><span class="ident" id="8006456">Parse</span><span class="op" id="8006461">(</span><span class="ident" id="8006462">cloneText2</span><span class="op" id="8006472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006475">if</span>&nbsp;<span class="ident" id="8006478">err</span>&nbsp;<span class="op" id="8006482">!=</span>&nbsp;<span class="builtintype" id="8006485">nil</span>&nbsp;<span class="op" id="8006489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006493">t</span><span class="op" id="8006494">.</span><span class="ident" id="8006495">Fatal</span><span class="op" id="8006500">(</span><span class="ident" id="8006501">err</span><span class="op" id="8006504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006507">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8006510">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006536">tree</span><span class="op" id="8006540">,</span>&nbsp;<span class="ident" id="8006542">err</span>&nbsp;<span class="op" id="8006546">:=</span>&nbsp;<span class="ident" id="8006549">parse</span><span class="op" id="8006554">.</span><span class="ident" id="8006555">Parse</span><span class="op" id="8006560">(</span><span class="string" id="8006561">&#34;cloneText3&#34;</span><span class="op" id="8006573">,</span>&nbsp;<span class="ident" id="8006575">cloneText3</span><span class="op" id="8006585">,</span>&nbsp;<span class="string" id="8006587">&#34;&#34;</span><span class="op" id="8006589">,</span>&nbsp;<span class="string" id="8006591">&#34;&#34;</span><span class="op" id="8006593">,</span>&nbsp;<span class="builtintype" id="8006595">nil</span><span class="op" id="8006598">,</span>&nbsp;<span class="ident" id="8006600">builtins</span><span class="op" id="8006608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006611">if</span>&nbsp;<span class="ident" id="8006614">err</span>&nbsp;<span class="op" id="8006618">!=</span>&nbsp;<span class="builtintype" id="8006621">nil</span>&nbsp;<span class="op" id="8006625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006629">t</span><span class="op" id="8006630">.</span><span class="ident" id="8006631">Fatal</span><span class="op" id="8006636">(</span><span class="ident" id="8006637">err</span><span class="op" id="8006640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006643">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006646">added</span><span class="op" id="8006651">,</span>&nbsp;<span class="ident" id="8006653">err</span>&nbsp;<span class="op" id="8006657">:=</span>&nbsp;<span class="ident" id="8006660">root</span><span class="op" id="8006664">.</span><span class="ident" id="8006665">AddParseTree</span><span class="op" id="8006677">(</span><span class="string" id="8006678">&#34;c&#34;</span><span class="op" id="8006681">,</span>&nbsp;<span class="ident" id="8006683">tree</span><span class="op" id="8006687">[</span><span class="string" id="8006688">&#34;c&#34;</span><span class="op" id="8006691">]</span><span class="op" id="8006692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8006695">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006708">var</span>&nbsp;<span class="ident" id="8006712">b</span>&nbsp;<span class="ident" id="8006714">bytes</span><span class="op" id="8006719">.</span><span class="ident" id="8006720">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006728">err</span>&nbsp;<span class="op" id="8006732">=</span>&nbsp;<span class="ident" id="8006734">added</span><span class="op" id="8006739">.</span><span class="ident" id="8006740">ExecuteTemplate</span><span class="op" id="8006755">(</span><span class="op" id="8006756">&amp;</span><span class="ident" id="8006757">b</span><span class="op" id="8006758">,</span>&nbsp;<span class="string" id="8006760">&#34;a&#34;</span><span class="op" id="8006763">,</span>&nbsp;<span class="num" id="8006765">0</span><span class="op" id="8006766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006769">if</span>&nbsp;<span class="ident" id="8006772">err</span>&nbsp;<span class="op" id="8006776">!=</span>&nbsp;<span class="builtintype" id="8006779">nil</span>&nbsp;<span class="op" id="8006783">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006787">t</span><span class="op" id="8006788">.</span><span class="ident" id="8006789">Fatal</span><span class="op" id="8006794">(</span><span class="ident" id="8006795">err</span><span class="op" id="8006798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8006804">if</span>&nbsp;<span class="ident" id="8006807">b</span><span class="op" id="8006808">.</span><span class="ident" id="8006809">String</span><span class="op" id="8006815">(</span><span class="op" id="8006816">)</span>&nbsp;<span class="op" id="8006818">!=</span>&nbsp;<span class="string" id="8006821">&#34;broot&#34;</span>&nbsp;<span class="op" id="8006829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006833">t</span><span class="op" id="8006834">.</span><span class="ident" id="8006835">Errorf</span><span class="op" id="8006841">(</span><span class="string" id="8006842">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8006862">,</span>&nbsp;<span class="string" id="8006864">&#34;broot&#34;</span><span class="op" id="8006871">,</span>&nbsp;<span class="ident" id="8006873">b</span><span class="op" id="8006874">.</span><span class="ident" id="8006875">String</span><span class="op" id="8006881">(</span><span class="op" id="8006882">)</span><span class="op" id="8006883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8006886">}</span><br>
<span class="lineno">260</span><span class="op" id="8006888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8006891">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="8006905">func</span>&nbsp;<span class="ident" id="8006910">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="8006944">(</span><span class="ident" id="8006945">t</span>&nbsp;<span class="op" id="8006947">*</span><span class="ident" id="8006948">testing</span><span class="op" id="8006955">.</span><span class="ident" id="8006956">T</span><span class="op" id="8006957">)</span>&nbsp;<span class="op" id="8006959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8006962">master</span>&nbsp;<span class="op" id="8006969">:=</span>&nbsp;<span class="string" id="8006972">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007004">tmpl</span>&nbsp;<span class="op" id="8007009">:=</span>&nbsp;<span class="ident" id="8007012">New</span><span class="op" id="8007015">(</span><span class="string" id="8007016">&#34;master&#34;</span><span class="op" id="8007024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007027">tree</span><span class="op" id="8007031">,</span>&nbsp;<span class="ident" id="8007033">err</span>&nbsp;<span class="op" id="8007037">:=</span>&nbsp;<span class="ident" id="8007040">parse</span><span class="op" id="8007045">.</span><span class="ident" id="8007046">Parse</span><span class="op" id="8007051">(</span><span class="string" id="8007052">&#34;master&#34;</span><span class="op" id="8007060">,</span>&nbsp;<span class="ident" id="8007062">master</span><span class="op" id="8007068">,</span>&nbsp;<span class="string" id="8007070">&#34;&#34;</span><span class="op" id="8007072">,</span>&nbsp;<span class="string" id="8007074">&#34;&#34;</span><span class="op" id="8007076">,</span>&nbsp;<span class="builtintype" id="8007078">nil</span><span class="op" id="8007081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007084">if</span>&nbsp;<span class="ident" id="8007087">err</span>&nbsp;<span class="op" id="8007091">!=</span>&nbsp;<span class="builtintype" id="8007094">nil</span>&nbsp;<span class="op" id="8007098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007102">t</span><span class="op" id="8007103">.</span><span class="ident" id="8007104">Fatalf</span><span class="op" id="8007110">(</span><span class="string" id="8007111">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="8007137">,</span>&nbsp;<span class="ident" id="8007139">err</span><span class="op" id="8007142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8007145">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007148">masterTree</span>&nbsp;<span class="op" id="8007159">:=</span>&nbsp;<span class="ident" id="8007162">tree</span><span class="op" id="8007166">[</span><span class="string" id="8007167">&#34;master&#34;</span><span class="op" id="8007175">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007178">tmpl</span><span class="op" id="8007182">.</span><span class="ident" id="8007183">AddParseTree</span><span class="op" id="8007195">(</span><span class="string" id="8007196">&#34;master&#34;</span><span class="op" id="8007204">,</span>&nbsp;<span class="ident" id="8007206">masterTree</span><span class="op" id="8007216">)</span>&nbsp;<span class="comment" id="8007218">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="8007235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8007238">func</span>&nbsp;<span class="ident" id="8007243">TestRedefinition</span><span class="op" id="8007259">(</span><span class="ident" id="8007260">t</span>&nbsp;<span class="op" id="8007262">*</span><span class="ident" id="8007263">testing</span><span class="op" id="8007270">.</span><span class="ident" id="8007271">T</span><span class="op" id="8007272">)</span>&nbsp;<span class="op" id="8007274">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007277">var</span>&nbsp;<span class="ident" id="8007281">tmpl</span>&nbsp;<span class="op" id="8007286">*</span><span class="ident" id="8007287">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007297">var</span>&nbsp;<span class="ident" id="8007301">err</span>&nbsp;<span class="builtintype" id="8007305">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007312">if</span>&nbsp;<span class="ident" id="8007315">tmpl</span><span class="op" id="8007319">,</span>&nbsp;<span class="ident" id="8007321">err</span>&nbsp;<span class="op" id="8007325">=</span>&nbsp;<span class="ident" id="8007327">New</span><span class="op" id="8007330">(</span><span class="string" id="8007331">&#34;tmpl1&#34;</span><span class="op" id="8007338">)</span><span class="op" id="8007339">.</span><span class="ident" id="8007340">Parse</span><span class="op" id="8007345">(</span><span class="string" id="8007346">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="8007375">)</span><span class="op" id="8007376">;</span>&nbsp;<span class="ident" id="8007378">err</span>&nbsp;<span class="op" id="8007382">!=</span>&nbsp;<span class="builtintype" id="8007385">nil</span>&nbsp;<span class="op" id="8007389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007393">t</span><span class="op" id="8007394">.</span><span class="ident" id="8007395">Fatalf</span><span class="op" id="8007401">(</span><span class="string" id="8007402">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="8007415">,</span>&nbsp;<span class="ident" id="8007417">err</span><span class="op" id="8007420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8007423">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007426">if</span>&nbsp;<span class="ident" id="8007429">_</span><span class="op" id="8007430">,</span>&nbsp;<span class="ident" id="8007432">err</span>&nbsp;<span class="op" id="8007436">=</span>&nbsp;<span class="ident" id="8007438">tmpl</span><span class="op" id="8007442">.</span><span class="ident" id="8007443">Parse</span><span class="op" id="8007448">(</span><span class="string" id="8007449">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8007478">)</span><span class="op" id="8007479">;</span>&nbsp;<span class="ident" id="8007481">err</span>&nbsp;<span class="op" id="8007485">==</span>&nbsp;<span class="builtintype" id="8007488">nil</span>&nbsp;<span class="op" id="8007492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007496">t</span><span class="op" id="8007497">.</span><span class="ident" id="8007498">Fatal</span><span class="op" id="8007503">(</span><span class="string" id="8007504">&#34;expected&nbsp;error&#34;</span><span class="op" id="8007520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8007523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007526">if</span>&nbsp;<span class="op" id="8007529">!</span><span class="ident" id="8007530">strings</span><span class="op" id="8007537">.</span><span class="ident" id="8007538">Contains</span><span class="op" id="8007546">(</span><span class="ident" id="8007547">err</span><span class="op" id="8007550">.</span><span class="ident" id="8007551">Error</span><span class="op" id="8007556">(</span><span class="op" id="8007557">)</span><span class="op" id="8007558">,</span>&nbsp;<span class="string" id="8007560">&#34;redefinition&#34;</span><span class="op" id="8007574">)</span>&nbsp;<span class="op" id="8007576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007580">t</span><span class="op" id="8007581">.</span><span class="ident" id="8007582">Fatalf</span><span class="op" id="8007588">(</span><span class="string" id="8007589">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8007626">,</span>&nbsp;<span class="ident" id="8007628">err</span><span class="op" id="8007631">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8007634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007637">if</span>&nbsp;<span class="ident" id="8007640">_</span><span class="op" id="8007641">,</span>&nbsp;<span class="ident" id="8007643">err</span>&nbsp;<span class="op" id="8007647">=</span>&nbsp;<span class="ident" id="8007649">tmpl</span><span class="op" id="8007653">.</span><span class="ident" id="8007654">New</span><span class="op" id="8007657">(</span><span class="string" id="8007658">&#34;tmpl2&#34;</span><span class="op" id="8007665">)</span><span class="op" id="8007666">.</span><span class="ident" id="8007667">Parse</span><span class="op" id="8007672">(</span><span class="string" id="8007673">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8007702">)</span><span class="op" id="8007703">;</span>&nbsp;<span class="ident" id="8007705">err</span>&nbsp;<span class="op" id="8007709">==</span>&nbsp;<span class="builtintype" id="8007712">nil</span>&nbsp;<span class="op" id="8007716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007720">t</span><span class="op" id="8007721">.</span><span class="ident" id="8007722">Fatal</span><span class="op" id="8007727">(</span><span class="string" id="8007728">&#34;expected&nbsp;error&#34;</span><span class="op" id="8007744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8007747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8007750">if</span>&nbsp;<span class="op" id="8007753">!</span><span class="ident" id="8007754">strings</span><span class="op" id="8007761">.</span><span class="ident" id="8007762">Contains</span><span class="op" id="8007770">(</span><span class="ident" id="8007771">err</span><span class="op" id="8007774">.</span><span class="ident" id="8007775">Error</span><span class="op" id="8007780">(</span><span class="op" id="8007781">)</span><span class="op" id="8007782">,</span>&nbsp;<span class="string" id="8007784">&#34;redefinition&#34;</span><span class="op" id="8007798">)</span>&nbsp;<span class="op" id="8007800">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8007804">t</span><span class="op" id="8007805">.</span><span class="ident" id="8007806">Fatalf</span><span class="op" id="8007812">(</span><span class="string" id="8007813">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8007850">,</span>&nbsp;<span class="ident" id="8007852">err</span><span class="op" id="8007855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8007858">}</span><br>
<span class="lineno"></span><span class="op" id="8007860">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
