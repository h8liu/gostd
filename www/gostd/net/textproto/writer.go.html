<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html" class="current">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3970390">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3970446">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3970500">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3970551">package</span>&nbsp;<span class="ident" id="3970559">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3970570">import</span>&nbsp;<span class="op" id="3970577">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3970580">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3970589">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3970596">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3970601">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3970604">//&nbsp;A&nbsp;Writer&nbsp;implements&nbsp;convenience&nbsp;methods&nbsp;for&nbsp;writing</span><br>
<span class="lineno"></span><span class="comment" id="3970659">//&nbsp;requests&nbsp;or&nbsp;responses&nbsp;to&nbsp;a&nbsp;text&nbsp;protocol&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">15</span><span class="keyword" id="3970723">type</span>&nbsp;<span class="ident" id="3970728">Writer</span>&nbsp;<span class="keyword" id="3970735">struct</span>&nbsp;<span class="op" id="3970742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3970745">W</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3970749">*</span><span class="ident" id="3970750">bufio</span><span class="op" id="3970755">.</span><span class="ident" id="3970756">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3970764">dot</span>&nbsp;<span class="op" id="3970768">*</span><span class="ident" id="3970769">dotWriter</span><br>
<span class="lineno"></span><span class="op" id="3970779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3970782">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;writing&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="3970830">func</span>&nbsp;<span class="ident" id="3970835">NewWriter</span><span class="op" id="3970844">(</span><span class="ident" id="3970845">w</span>&nbsp;<span class="op" id="3970847">*</span><span class="ident" id="3970848">bufio</span><span class="op" id="3970853">.</span><span class="ident" id="3970854">Writer</span><span class="op" id="3970860">)</span>&nbsp;<span class="op" id="3970862">*</span><span class="ident" id="3970863">Writer</span>&nbsp;<span class="op" id="3970870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970873">return</span>&nbsp;<span class="op" id="3970880">&amp;</span><span class="ident" id="3970881">Writer</span><span class="op" id="3970887">{</span><span class="ident" id="3970888">W</span><span class="op" id="3970889">:</span>&nbsp;<span class="ident" id="3970891">w</span><span class="op" id="3970892">}</span><br>
<span class="lineno"></span><span class="op" id="3970894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3970897">var</span>&nbsp;<span class="ident" id="3970901">crnl</span>&nbsp;<span class="op" id="3970906">=</span>&nbsp;<span class="op" id="3970908">[</span><span class="op" id="3970909">]</span><span class="builtintype" id="3970910">byte</span><span class="op" id="3970914">{</span><span class="string" id="3970915">&#39;\r&#39;</span><span class="op" id="3970919">,</span>&nbsp;<span class="string" id="3970921">&#39;\n&#39;</span><span class="op" id="3970925">}</span><br>
<span class="lineno"></span><span class="keyword" id="3970927">var</span>&nbsp;<span class="ident" id="3970931">dotcrnl</span>&nbsp;<span class="op" id="3970939">=</span>&nbsp;<span class="op" id="3970941">[</span><span class="op" id="3970942">]</span><span class="builtintype" id="3970943">byte</span><span class="op" id="3970947">{</span><span class="string" id="3970948">&#39;.&#39;</span><span class="op" id="3970951">,</span>&nbsp;<span class="string" id="3970953">&#39;\r&#39;</span><span class="op" id="3970957">,</span>&nbsp;<span class="string" id="3970959">&#39;\n&#39;</span><span class="op" id="3970963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3970966">//&nbsp;PrintfLine&nbsp;writes&nbsp;the&nbsp;formatted&nbsp;output&nbsp;followed&nbsp;by&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="keyword" id="3971026">func</span>&nbsp;<span class="op" id="3971031">(</span><span class="ident" id="3971032">w</span>&nbsp;<span class="op" id="3971034">*</span><span class="ident" id="3971035">Writer</span><span class="op" id="3971041">)</span>&nbsp;<span class="ident" id="3971043">PrintfLine</span><span class="op" id="3971053">(</span><span class="ident" id="3971054">format</span>&nbsp;<span class="builtintype" id="3971061">string</span><span class="op" id="3971067">,</span>&nbsp;<span class="ident" id="3971069">args</span>&nbsp;<span class="op" id="3971074">...</span><span class="keyword" id="3971077">interface</span><span class="op" id="3971086">{</span><span class="op" id="3971087">}</span><span class="op" id="3971088">)</span>&nbsp;<span class="builtintype" id="3971090">error</span>&nbsp;<span class="op" id="3971096">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971099">w</span><span class="op" id="3971100">.</span><span class="ident" id="3971101">closeDot</span><span class="op" id="3971109">(</span><span class="op" id="3971110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971113">fmt</span><span class="op" id="3971116">.</span><span class="ident" id="3971117">Fprintf</span><span class="op" id="3971124">(</span><span class="ident" id="3971125">w</span><span class="op" id="3971126">.</span><span class="ident" id="3971127">W</span><span class="op" id="3971128">,</span>&nbsp;<span class="ident" id="3971130">format</span><span class="op" id="3971136">,</span>&nbsp;<span class="ident" id="3971138">args</span><span class="op" id="3971142">...</span><span class="op" id="3971145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971148">w</span><span class="op" id="3971149">.</span><span class="ident" id="3971150">W</span><span class="op" id="3971151">.</span><span class="ident" id="3971152">Write</span><span class="op" id="3971157">(</span><span class="ident" id="3971158">crnl</span><span class="op" id="3971162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971165">return</span>&nbsp;<span class="ident" id="3971172">w</span><span class="op" id="3971173">.</span><span class="ident" id="3971174">W</span><span class="op" id="3971175">.</span><span class="ident" id="3971176">Flush</span><span class="op" id="3971181">(</span><span class="op" id="3971182">)</span><br>
<span class="lineno"></span><span class="op" id="3971184">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3971187">//&nbsp;DotWriter&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;write&nbsp;a&nbsp;dot-encoding&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3971264">//&nbsp;It&nbsp;takes&nbsp;care&nbsp;of&nbsp;inserting&nbsp;leading&nbsp;dots&nbsp;when&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3971323">//&nbsp;translating&nbsp;line-ending&nbsp;\n&nbsp;into&nbsp;\r\n,&nbsp;and&nbsp;adding&nbsp;the&nbsp;final&nbsp;.\r\n&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="3971396">//&nbsp;when&nbsp;the&nbsp;DotWriter&nbsp;is&nbsp;closed.&nbsp;&nbsp;The&nbsp;caller&nbsp;should&nbsp;close&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="3971458">//&nbsp;DotWriter&nbsp;before&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;a&nbsp;method&nbsp;on&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3971510">//</span><br>
<span class="lineno"></span><span class="comment" id="3971513">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Reader&#39;s&nbsp;DotReader&nbsp;method&nbsp;for&nbsp;details&nbsp;about&nbsp;dot-encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="3971600">func</span>&nbsp;<span class="op" id="3971605">(</span><span class="ident" id="3971606">w</span>&nbsp;<span class="op" id="3971608">*</span><span class="ident" id="3971609">Writer</span><span class="op" id="3971615">)</span>&nbsp;<span class="ident" id="3971617">DotWriter</span><span class="op" id="3971626">(</span><span class="op" id="3971627">)</span>&nbsp;<span class="ident" id="3971629">io</span><span class="op" id="3971631">.</span><span class="ident" id="3971632">WriteCloser</span>&nbsp;<span class="op" id="3971644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971647">w</span><span class="op" id="3971648">.</span><span class="ident" id="3971649">closeDot</span><span class="op" id="3971657">(</span><span class="op" id="3971658">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971661">w</span><span class="op" id="3971662">.</span><span class="ident" id="3971663">dot</span>&nbsp;<span class="op" id="3971667">=</span>&nbsp;<span class="op" id="3971669">&amp;</span><span class="ident" id="3971670">dotWriter</span><span class="op" id="3971679">{</span><span class="ident" id="3971680">w</span><span class="op" id="3971681">:</span>&nbsp;<span class="ident" id="3971683">w</span><span class="op" id="3971684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971687">return</span>&nbsp;<span class="ident" id="3971694">w</span><span class="op" id="3971695">.</span><span class="ident" id="3971696">dot</span><br>
<span class="lineno"></span><span class="op" id="3971700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3971703">func</span>&nbsp;<span class="op" id="3971708">(</span><span class="ident" id="3971709">w</span>&nbsp;<span class="op" id="3971711">*</span><span class="ident" id="3971712">Writer</span><span class="op" id="3971718">)</span>&nbsp;<span class="ident" id="3971720">closeDot</span><span class="op" id="3971728">(</span><span class="op" id="3971729">)</span>&nbsp;<span class="op" id="3971731">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971734">if</span>&nbsp;<span class="ident" id="3971737">w</span><span class="op" id="3971738">.</span><span class="ident" id="3971739">dot</span>&nbsp;<span class="op" id="3971743">!=</span>&nbsp;<span class="builtintype" id="3971746">nil</span>&nbsp;<span class="op" id="3971750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971754">w</span><span class="op" id="3971755">.</span><span class="ident" id="3971756">dot</span><span class="op" id="3971759">.</span><span class="ident" id="3971760">Close</span><span class="op" id="3971765">(</span><span class="op" id="3971766">)</span>&nbsp;<span class="comment" id="3971768">//&nbsp;sets&nbsp;w.dot&nbsp;=&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971789">}</span><br>
<span class="lineno"></span><span class="op" id="3971791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3971794">type</span>&nbsp;<span class="ident" id="3971799">dotWriter</span>&nbsp;<span class="keyword" id="3971809">struct</span>&nbsp;<span class="op" id="3971816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971819">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971825">*</span><span class="ident" id="3971826">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971834">state</span>&nbsp;<span class="builtintype" id="3971840">int</span><br>
<span class="lineno"></span><span class="op" id="3971844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="3971847">const</span>&nbsp;<span class="op" id="3971853">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971856">wstateBeginLine</span>&nbsp;<span class="op" id="3971872">=</span>&nbsp;<span class="ident" id="3971874">iota</span>&nbsp;<span class="comment" id="3971879">//&nbsp;beginning&nbsp;of&nbsp;line;&nbsp;initial&nbsp;state;&nbsp;must&nbsp;be&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971930">wstateCR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3971953">//&nbsp;wrote&nbsp;\r&nbsp;(possibly&nbsp;at&nbsp;end&nbsp;of&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971992">wstateData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3972015">//&nbsp;writing&nbsp;data&nbsp;in&nbsp;middle&nbsp;of&nbsp;line</span><br>
<span class="lineno"></span><span class="op" id="3972049">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3972052">func</span>&nbsp;<span class="op" id="3972057">(</span><span class="ident" id="3972058">d</span>&nbsp;<span class="op" id="3972060">*</span><span class="ident" id="3972061">dotWriter</span><span class="op" id="3972070">)</span>&nbsp;<span class="ident" id="3972072">Write</span><span class="op" id="3972077">(</span><span class="ident" id="3972078">b</span>&nbsp;<span class="op" id="3972080">[</span><span class="op" id="3972081">]</span><span class="builtintype" id="3972082">byte</span><span class="op" id="3972086">)</span>&nbsp;<span class="op" id="3972088">(</span><span class="ident" id="3972089">n</span>&nbsp;<span class="builtintype" id="3972091">int</span><span class="op" id="3972094">,</span>&nbsp;<span class="ident" id="3972096">err</span>&nbsp;<span class="builtintype" id="3972100">error</span><span class="op" id="3972105">)</span>&nbsp;<span class="op" id="3972107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972110">bw</span>&nbsp;<span class="op" id="3972113">:=</span>&nbsp;<span class="ident" id="3972116">d</span><span class="op" id="3972117">.</span><span class="ident" id="3972118">w</span><span class="op" id="3972119">.</span><span class="ident" id="3972120">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972123">for</span>&nbsp;<span class="ident" id="3972127">n</span>&nbsp;<span class="op" id="3972129">&lt;</span>&nbsp;<span class="builtinfunc" id="3972131">len</span><span class="op" id="3972134">(</span><span class="ident" id="3972135">b</span><span class="op" id="3972136">)</span>&nbsp;<span class="op" id="3972138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972142">c</span>&nbsp;<span class="op" id="3972144">:=</span>&nbsp;<span class="ident" id="3972147">b</span><span class="op" id="3972148">[</span><span class="ident" id="3972149">n</span><span class="op" id="3972150">]</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972154">switch</span>&nbsp;<span class="ident" id="3972161">d</span><span class="op" id="3972162">.</span><span class="ident" id="3972163">state</span>&nbsp;<span class="op" id="3972169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972173">case</span>&nbsp;<span class="ident" id="3972178">wstateBeginLine</span><span class="op" id="3972193">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972198">d</span><span class="op" id="3972199">.</span><span class="ident" id="3972200">state</span>&nbsp;<span class="op" id="3972206">=</span>&nbsp;<span class="ident" id="3972208">wstateData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972222">if</span>&nbsp;<span class="ident" id="3972225">c</span>&nbsp;<span class="op" id="3972227">==</span>&nbsp;<span class="string" id="3972230">&#39;.&#39;</span>&nbsp;<span class="op" id="3972234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3972240">//&nbsp;escape&nbsp;leading&nbsp;dot</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972266">bw</span><span class="op" id="3972268">.</span><span class="ident" id="3972269">WriteByte</span><span class="op" id="3972278">(</span><span class="string" id="3972279">&#39;.&#39;</span><span class="op" id="3972282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972292">fallthrough</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972307">case</span>&nbsp;<span class="ident" id="3972312">wstateData</span><span class="op" id="3972322">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972327">if</span>&nbsp;<span class="ident" id="3972330">c</span>&nbsp;<span class="op" id="3972332">==</span>&nbsp;<span class="string" id="3972335">&#39;\r&#39;</span>&nbsp;<span class="op" id="3972340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972346">d</span><span class="op" id="3972347">.</span><span class="ident" id="3972348">state</span>&nbsp;<span class="op" id="3972354">=</span>&nbsp;<span class="ident" id="3972356">wstateCR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972373">if</span>&nbsp;<span class="ident" id="3972376">c</span>&nbsp;<span class="op" id="3972378">==</span>&nbsp;<span class="string" id="3972381">&#39;\n&#39;</span>&nbsp;<span class="op" id="3972386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972392">bw</span><span class="op" id="3972394">.</span><span class="ident" id="3972395">WriteByte</span><span class="op" id="3972404">(</span><span class="string" id="3972405">&#39;\r&#39;</span><span class="op" id="3972409">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972415">d</span><span class="op" id="3972416">.</span><span class="ident" id="3972417">state</span>&nbsp;<span class="op" id="3972423">=</span>&nbsp;<span class="ident" id="3972425">wstateBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972449">case</span>&nbsp;<span class="ident" id="3972454">wstateCR</span><span class="op" id="3972462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972467">d</span><span class="op" id="3972468">.</span><span class="ident" id="3972469">state</span>&nbsp;<span class="op" id="3972475">=</span>&nbsp;<span class="ident" id="3972477">wstateData</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972491">if</span>&nbsp;<span class="ident" id="3972494">c</span>&nbsp;<span class="op" id="3972496">==</span>&nbsp;<span class="string" id="3972499">&#39;\n&#39;</span>&nbsp;<span class="op" id="3972504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972510">d</span><span class="op" id="3972511">.</span><span class="ident" id="3972512">state</span>&nbsp;<span class="op" id="3972518">=</span>&nbsp;<span class="ident" id="3972520">wstateBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972547">if</span>&nbsp;<span class="ident" id="3972550">err</span>&nbsp;<span class="op" id="3972554">=</span>&nbsp;<span class="ident" id="3972556">bw</span><span class="op" id="3972558">.</span><span class="ident" id="3972559">WriteByte</span><span class="op" id="3972568">(</span><span class="ident" id="3972569">c</span><span class="op" id="3972570">)</span><span class="op" id="3972571">;</span>&nbsp;<span class="ident" id="3972573">err</span>&nbsp;<span class="op" id="3972577">!=</span>&nbsp;<span class="builtintype" id="3972580">nil</span>&nbsp;<span class="op" id="3972584">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972589">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972601">n</span><span class="op" id="3972602">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972609">return</span><br>
<span class="lineno">100</span><span class="op" id="3972616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3972619">func</span>&nbsp;<span class="op" id="3972624">(</span><span class="ident" id="3972625">d</span>&nbsp;<span class="op" id="3972627">*</span><span class="ident" id="3972628">dotWriter</span><span class="op" id="3972637">)</span>&nbsp;<span class="ident" id="3972639">Close</span><span class="op" id="3972644">(</span><span class="op" id="3972645">)</span>&nbsp;<span class="builtintype" id="3972647">error</span>&nbsp;<span class="op" id="3972653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972656">if</span>&nbsp;<span class="ident" id="3972659">d</span><span class="op" id="3972660">.</span><span class="ident" id="3972661">w</span><span class="op" id="3972662">.</span><span class="ident" id="3972663">dot</span>&nbsp;<span class="op" id="3972667">==</span>&nbsp;<span class="ident" id="3972670">d</span>&nbsp;<span class="op" id="3972672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972676">d</span><span class="op" id="3972677">.</span><span class="ident" id="3972678">w</span><span class="op" id="3972679">.</span><span class="ident" id="3972680">dot</span>&nbsp;<span class="op" id="3972684">=</span>&nbsp;<span class="builtintype" id="3972686">nil</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972694">bw</span>&nbsp;<span class="op" id="3972697">:=</span>&nbsp;<span class="ident" id="3972700">d</span><span class="op" id="3972701">.</span><span class="ident" id="3972702">w</span><span class="op" id="3972703">.</span><span class="ident" id="3972704">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972707">switch</span>&nbsp;<span class="ident" id="3972714">d</span><span class="op" id="3972715">.</span><span class="ident" id="3972716">state</span>&nbsp;<span class="op" id="3972722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972725">default</span><span class="op" id="3972732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972736">bw</span><span class="op" id="3972738">.</span><span class="ident" id="3972739">WriteByte</span><span class="op" id="3972748">(</span><span class="string" id="3972749">&#39;\r&#39;</span><span class="op" id="3972753">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972757">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972770">case</span>&nbsp;<span class="ident" id="3972775">wstateCR</span><span class="op" id="3972783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972787">bw</span><span class="op" id="3972789">.</span><span class="ident" id="3972790">WriteByte</span><span class="op" id="3972799">(</span><span class="string" id="3972800">&#39;\n&#39;</span><span class="op" id="3972804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972808">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972821">case</span>&nbsp;<span class="ident" id="3972826">wstateBeginLine</span><span class="op" id="3972841">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972845">bw</span><span class="op" id="3972847">.</span><span class="ident" id="3972848">Write</span><span class="op" id="3972853">(</span><span class="ident" id="3972854">dotcrnl</span><span class="op" id="3972861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972867">return</span>&nbsp;<span class="ident" id="3972874">bw</span><span class="op" id="3972876">.</span><span class="ident" id="3972877">Flush</span><span class="op" id="3972882">(</span><span class="op" id="3972883">)</span><br>
<span class="lineno"></span><span class="op" id="3972885">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
