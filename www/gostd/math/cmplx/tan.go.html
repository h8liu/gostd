<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6230866">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6230921">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6230975">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6231026">package</span>&nbsp;<span class="ident" id="6231034">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6231041">import</span>&nbsp;<span class="string" id="6231048">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6231056">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6231116">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6231186">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6231244">//</span><br>
<span class="lineno"></span><span class="comment" id="6231247">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6231295">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6231359">//</span><br>
<span class="lineno"></span><span class="comment" id="6231362">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6231423">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6231493">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6231568">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6231635">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6231708">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6231780">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6231794">//</span><br>
<span class="lineno"></span><span class="comment" id="6231797">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6231863">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6231929">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6231942">//</span><br>
<span class="lineno"></span><span class="comment" id="6231945">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6231969">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6231999">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6232027">//</span><br>
<span class="lineno"></span><span class="comment" id="6232030">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6232046">//</span><br>
<span class="lineno">35</span><span class="comment" id="6232049">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6232055">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="6232074">//</span><br>
<span class="lineno"></span><span class="comment" id="6232077">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6232085">//</span><br>
<span class="lineno">40</span><span class="comment" id="6232088">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6232122">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="6232157">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6232190">//</span><br>
<span class="lineno"></span><span class="comment" id="6232193">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="6232254">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="6232310">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="6232339">//</span><br>
<span class="lineno"></span><span class="comment" id="6232342">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="6232369">//</span><br>
<span class="lineno">50</span><span class="comment" id="6232372">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6232385">//</span><br>
<span class="lineno"></span><span class="comment" id="6232388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6232428">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6232486">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="6232546">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6232606">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6232667">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6232700">func</span>&nbsp;<span class="ident" id="6232705">Tan</span><span class="op" id="6232708">(</span><span class="ident" id="6232709">x</span>&nbsp;<span class="builtintype" id="6232711">complex128</span><span class="op" id="6232721">)</span>&nbsp;<span class="builtintype" id="6232723">complex128</span>&nbsp;<span class="op" id="6232734">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232737">d</span>&nbsp;<span class="op" id="6232739">:=</span>&nbsp;<span class="ident" id="6232742">math</span><span class="op" id="6232746">.</span><span class="ident" id="6232747">Cos</span><span class="op" id="6232750">(</span><span class="num" id="6232751">2</span><span class="op" id="6232752">*</span><span class="builtinfunc" id="6232753">real</span><span class="op" id="6232757">(</span><span class="ident" id="6232758">x</span><span class="op" id="6232759">)</span><span class="op" id="6232760">)</span>&nbsp;<span class="op" id="6232762">+</span>&nbsp;<span class="ident" id="6232764">math</span><span class="op" id="6232768">.</span><span class="ident" id="6232769">Cosh</span><span class="op" id="6232773">(</span><span class="num" id="6232774">2</span><span class="op" id="6232775">*</span><span class="builtinfunc" id="6232776">imag</span><span class="op" id="6232780">(</span><span class="ident" id="6232781">x</span><span class="op" id="6232782">)</span><span class="op" id="6232783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232786">if</span>&nbsp;<span class="ident" id="6232789">math</span><span class="op" id="6232793">.</span><span class="ident" id="6232794">Abs</span><span class="op" id="6232797">(</span><span class="ident" id="6232798">d</span><span class="op" id="6232799">)</span>&nbsp;<span class="op" id="6232801">&lt;</span>&nbsp;<span class="num" id="6232803">0.25</span>&nbsp;<span class="op" id="6232808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232812">d</span>&nbsp;<span class="op" id="6232814">=</span>&nbsp;<span class="ident" id="6232816">tanSeries</span><span class="op" id="6232825">(</span><span class="ident" id="6232826">x</span><span class="op" id="6232827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6232830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232833">if</span>&nbsp;<span class="ident" id="6232836">d</span>&nbsp;<span class="op" id="6232838">==</span>&nbsp;<span class="num" id="6232841">0</span>&nbsp;<span class="op" id="6232843">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232847">return</span>&nbsp;<span class="ident" id="6232854">Inf</span><span class="op" id="6232857">(</span><span class="op" id="6232858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6232861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232864">return</span>&nbsp;<span class="builtinfunc" id="6232871">complex</span><span class="op" id="6232878">(</span><span class="ident" id="6232879">math</span><span class="op" id="6232883">.</span><span class="ident" id="6232884">Sin</span><span class="op" id="6232887">(</span><span class="num" id="6232888">2</span><span class="op" id="6232889">*</span><span class="builtinfunc" id="6232890">real</span><span class="op" id="6232894">(</span><span class="ident" id="6232895">x</span><span class="op" id="6232896">)</span><span class="op" id="6232897">)</span><span class="op" id="6232898">/</span><span class="ident" id="6232899">d</span><span class="op" id="6232900">,</span>&nbsp;<span class="ident" id="6232902">math</span><span class="op" id="6232906">.</span><span class="ident" id="6232907">Sinh</span><span class="op" id="6232911">(</span><span class="num" id="6232912">2</span><span class="op" id="6232913">*</span><span class="builtinfunc" id="6232914">imag</span><span class="op" id="6232918">(</span><span class="ident" id="6232919">x</span><span class="op" id="6232920">)</span><span class="op" id="6232921">)</span><span class="op" id="6232922">/</span><span class="ident" id="6232923">d</span><span class="op" id="6232924">)</span><br>
<span class="lineno"></span><span class="op" id="6232926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="6232929">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6232959">//</span><br>
<span class="lineno"></span><span class="comment" id="6232962">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6232978">//</span><br>
<span class="lineno"></span><span class="comment" id="6232981">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="6233039">//</span><br>
<span class="lineno"></span><span class="comment" id="6233042">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6233055">//</span><br>
<span class="lineno"></span><span class="comment" id="6233058">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6233098">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="6233156">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6233217">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6233262">func</span>&nbsp;<span class="ident" id="6233267">Tanh</span><span class="op" id="6233271">(</span><span class="ident" id="6233272">x</span>&nbsp;<span class="builtintype" id="6233274">complex128</span><span class="op" id="6233284">)</span>&nbsp;<span class="builtintype" id="6233286">complex128</span>&nbsp;<span class="op" id="6233297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233300">d</span>&nbsp;<span class="op" id="6233302">:=</span>&nbsp;<span class="ident" id="6233305">math</span><span class="op" id="6233309">.</span><span class="ident" id="6233310">Cosh</span><span class="op" id="6233314">(</span><span class="num" id="6233315">2</span><span class="op" id="6233316">*</span><span class="builtinfunc" id="6233317">real</span><span class="op" id="6233321">(</span><span class="ident" id="6233322">x</span><span class="op" id="6233323">)</span><span class="op" id="6233324">)</span>&nbsp;<span class="op" id="6233326">+</span>&nbsp;<span class="ident" id="6233328">math</span><span class="op" id="6233332">.</span><span class="ident" id="6233333">Cos</span><span class="op" id="6233336">(</span><span class="num" id="6233337">2</span><span class="op" id="6233338">*</span><span class="builtinfunc" id="6233339">imag</span><span class="op" id="6233343">(</span><span class="ident" id="6233344">x</span><span class="op" id="6233345">)</span><span class="op" id="6233346">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233349">if</span>&nbsp;<span class="ident" id="6233352">d</span>&nbsp;<span class="op" id="6233354">==</span>&nbsp;<span class="num" id="6233357">0</span>&nbsp;<span class="op" id="6233359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233363">return</span>&nbsp;<span class="ident" id="6233370">Inf</span><span class="op" id="6233373">(</span><span class="op" id="6233374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233380">return</span>&nbsp;<span class="builtinfunc" id="6233387">complex</span><span class="op" id="6233394">(</span><span class="ident" id="6233395">math</span><span class="op" id="6233399">.</span><span class="ident" id="6233400">Sinh</span><span class="op" id="6233404">(</span><span class="num" id="6233405">2</span><span class="op" id="6233406">*</span><span class="builtinfunc" id="6233407">real</span><span class="op" id="6233411">(</span><span class="ident" id="6233412">x</span><span class="op" id="6233413">)</span><span class="op" id="6233414">)</span><span class="op" id="6233415">/</span><span class="ident" id="6233416">d</span><span class="op" id="6233417">,</span>&nbsp;<span class="ident" id="6233419">math</span><span class="op" id="6233423">.</span><span class="ident" id="6233424">Sin</span><span class="op" id="6233427">(</span><span class="num" id="6233428">2</span><span class="op" id="6233429">*</span><span class="builtinfunc" id="6233430">imag</span><span class="op" id="6233434">(</span><span class="ident" id="6233435">x</span><span class="op" id="6233436">)</span><span class="op" id="6233437">)</span><span class="op" id="6233438">/</span><span class="ident" id="6233439">d</span><span class="op" id="6233440">)</span><br>
<span class="lineno"></span><span class="op" id="6233442">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="6233445">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="6233499">func</span>&nbsp;<span class="ident" id="6233504">reducePi</span><span class="op" id="6233512">(</span><span class="ident" id="6233513">x</span>&nbsp;<span class="builtintype" id="6233515">float64</span><span class="op" id="6233522">)</span>&nbsp;<span class="builtintype" id="6233524">float64</span>&nbsp;<span class="op" id="6233532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233535">const</span>&nbsp;<span class="op" id="6233541">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233545">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233582">DP1</span>&nbsp;<span class="op" id="6233586">=</span>&nbsp;<span class="num" id="6233588">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6233615">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233642">DP2</span>&nbsp;<span class="op" id="6233646">=</span>&nbsp;<span class="num" id="6233648">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="6233675">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233702">DP3</span>&nbsp;<span class="op" id="6233706">=</span>&nbsp;<span class="num" id="6233708">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="6233735">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233764">t</span>&nbsp;<span class="op" id="6233766">:=</span>&nbsp;<span class="ident" id="6233769">x</span>&nbsp;<span class="op" id="6233771">/</span>&nbsp;<span class="ident" id="6233773">math</span><span class="op" id="6233777">.</span><span class="ident" id="6233778">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233782">if</span>&nbsp;<span class="ident" id="6233785">t</span>&nbsp;<span class="op" id="6233787">&gt;=</span>&nbsp;<span class="num" id="6233790">0</span>&nbsp;<span class="op" id="6233792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233796">t</span>&nbsp;<span class="op" id="6233798">+=</span>&nbsp;<span class="num" id="6233801">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233806">}</span>&nbsp;<span class="keyword" id="6233808">else</span>&nbsp;<span class="op" id="6233813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233817">t</span>&nbsp;<span class="op" id="6233819">-=</span>&nbsp;<span class="num" id="6233822">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233827">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233830">t</span>&nbsp;<span class="op" id="6233832">=</span>&nbsp;<span class="builtintype" id="6233834">float64</span><span class="op" id="6233841">(</span><span class="ident" id="6233842">int64</span><span class="op" id="6233847">(</span><span class="ident" id="6233848">t</span><span class="op" id="6233849">)</span><span class="op" id="6233850">)</span>&nbsp;<span class="comment" id="6233852">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233880">return</span>&nbsp;<span class="op" id="6233887">(</span><span class="op" id="6233888">(</span><span class="ident" id="6233889">x</span>&nbsp;<span class="op" id="6233891">-</span>&nbsp;<span class="ident" id="6233893">t</span><span class="op" id="6233894">*</span><span class="ident" id="6233895">DP1</span><span class="op" id="6233898">)</span>&nbsp;<span class="op" id="6233900">-</span>&nbsp;<span class="ident" id="6233902">t</span><span class="op" id="6233903">*</span><span class="ident" id="6233904">DP2</span><span class="op" id="6233907">)</span>&nbsp;<span class="op" id="6233909">-</span>&nbsp;<span class="ident" id="6233911">t</span><span class="op" id="6233912">*</span><span class="ident" id="6233913">DP3</span><br>
<span class="lineno"></span><span class="op" id="6233917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6233920">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="6233970">func</span>&nbsp;<span class="ident" id="6233975">tanSeries</span><span class="op" id="6233984">(</span><span class="ident" id="6233985">z</span>&nbsp;<span class="builtintype" id="6233987">complex128</span><span class="op" id="6233997">)</span>&nbsp;<span class="builtintype" id="6233999">float64</span>&nbsp;<span class="op" id="6234007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234010">const</span>&nbsp;<span class="ident" id="6234016">MACHEP</span>&nbsp;<span class="op" id="6234023">=</span>&nbsp;<span class="num" id="6234025">1.0</span>&nbsp;<span class="op" id="6234029">/</span>&nbsp;<span class="op" id="6234031">(</span><span class="num" id="6234032">1</span>&nbsp;<span class="op" id="6234034">&lt;&lt;</span>&nbsp;<span class="num" id="6234037">53</span><span class="op" id="6234039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234042">x</span>&nbsp;<span class="op" id="6234044">:=</span>&nbsp;<span class="ident" id="6234047">math</span><span class="op" id="6234051">.</span><span class="ident" id="6234052">Abs</span><span class="op" id="6234055">(</span><span class="num" id="6234056">2</span>&nbsp;<span class="op" id="6234058">*</span>&nbsp;<span class="builtinfunc" id="6234060">real</span><span class="op" id="6234064">(</span><span class="ident" id="6234065">z</span><span class="op" id="6234066">)</span><span class="op" id="6234067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234070">y</span>&nbsp;<span class="op" id="6234072">:=</span>&nbsp;<span class="ident" id="6234075">math</span><span class="op" id="6234079">.</span><span class="ident" id="6234080">Abs</span><span class="op" id="6234083">(</span><span class="num" id="6234084">2</span>&nbsp;<span class="op" id="6234086">*</span>&nbsp;<span class="builtinfunc" id="6234088">imag</span><span class="op" id="6234092">(</span><span class="ident" id="6234093">z</span><span class="op" id="6234094">)</span><span class="op" id="6234095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234098">x</span>&nbsp;<span class="op" id="6234100">=</span>&nbsp;<span class="ident" id="6234102">reducePi</span><span class="op" id="6234110">(</span><span class="ident" id="6234111">x</span><span class="op" id="6234112">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234115">x</span>&nbsp;<span class="op" id="6234117">=</span>&nbsp;<span class="ident" id="6234119">x</span>&nbsp;<span class="op" id="6234121">*</span>&nbsp;<span class="ident" id="6234123">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234126">y</span>&nbsp;<span class="op" id="6234128">=</span>&nbsp;<span class="ident" id="6234130">y</span>&nbsp;<span class="op" id="6234132">*</span>&nbsp;<span class="ident" id="6234134">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234137">x2</span>&nbsp;<span class="op" id="6234140">:=</span>&nbsp;<span class="num" id="6234143">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234148">y2</span>&nbsp;<span class="op" id="6234151">:=</span>&nbsp;<span class="num" id="6234154">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234159">f</span>&nbsp;<span class="op" id="6234161">:=</span>&nbsp;<span class="num" id="6234164">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234169">rn</span>&nbsp;<span class="op" id="6234172">:=</span>&nbsp;<span class="num" id="6234175">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234180">d</span>&nbsp;<span class="op" id="6234182">:=</span>&nbsp;<span class="num" id="6234185">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234190">for</span>&nbsp;<span class="op" id="6234194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234198">rn</span>&nbsp;<span class="op" id="6234201">+=</span>&nbsp;<span class="num" id="6234204">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234208">f</span>&nbsp;<span class="op" id="6234210">*=</span>&nbsp;<span class="ident" id="6234213">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234218">rn</span>&nbsp;<span class="op" id="6234221">+=</span>&nbsp;<span class="num" id="6234224">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234228">f</span>&nbsp;<span class="op" id="6234230">*=</span>&nbsp;<span class="ident" id="6234233">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234238">x2</span>&nbsp;<span class="op" id="6234241">*=</span>&nbsp;<span class="ident" id="6234244">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234248">y2</span>&nbsp;<span class="op" id="6234251">*=</span>&nbsp;<span class="ident" id="6234254">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234258">t</span>&nbsp;<span class="op" id="6234260">:=</span>&nbsp;<span class="ident" id="6234263">y2</span>&nbsp;<span class="op" id="6234266">+</span>&nbsp;<span class="ident" id="6234268">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234273">t</span>&nbsp;<span class="op" id="6234275">/=</span>&nbsp;<span class="ident" id="6234278">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234282">d</span>&nbsp;<span class="op" id="6234284">+=</span>&nbsp;<span class="ident" id="6234287">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234292">rn</span>&nbsp;<span class="op" id="6234295">+=</span>&nbsp;<span class="num" id="6234298">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234302">f</span>&nbsp;<span class="op" id="6234304">*=</span>&nbsp;<span class="ident" id="6234307">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234312">rn</span>&nbsp;<span class="op" id="6234315">+=</span>&nbsp;<span class="num" id="6234318">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234322">f</span>&nbsp;<span class="op" id="6234324">*=</span>&nbsp;<span class="ident" id="6234327">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234332">x2</span>&nbsp;<span class="op" id="6234335">*=</span>&nbsp;<span class="ident" id="6234338">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234342">y2</span>&nbsp;<span class="op" id="6234345">*=</span>&nbsp;<span class="ident" id="6234348">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234352">t</span>&nbsp;<span class="op" id="6234354">=</span>&nbsp;<span class="ident" id="6234356">y2</span>&nbsp;<span class="op" id="6234359">-</span>&nbsp;<span class="ident" id="6234361">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234366">t</span>&nbsp;<span class="op" id="6234368">/=</span>&nbsp;<span class="ident" id="6234371">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234375">d</span>&nbsp;<span class="op" id="6234377">+=</span>&nbsp;<span class="ident" id="6234380">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234384">if</span>&nbsp;<span class="ident" id="6234387">math</span><span class="op" id="6234391">.</span><span class="ident" id="6234392">Abs</span><span class="op" id="6234395">(</span><span class="ident" id="6234396">t</span><span class="op" id="6234397">/</span><span class="ident" id="6234398">d</span><span class="op" id="6234399">)</span>&nbsp;<span class="op" id="6234401">&lt;=</span>&nbsp;<span class="ident" id="6234404">MACHEP</span>&nbsp;<span class="op" id="6234411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234416">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6234424">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6234427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234430">return</span>&nbsp;<span class="ident" id="6234437">d</span><br>
<span class="lineno"></span><span class="op" id="6234439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6234442">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="6234472">//</span><br>
<span class="lineno"></span><span class="comment" id="6234475">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6234491">//</span><br>
<span class="lineno"></span><span class="comment" id="6234494">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6234500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="6234519">//</span><br>
<span class="lineno"></span><span class="comment" id="6234522">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6234530">//</span><br>
<span class="lineno"></span><span class="comment" id="6234533">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6234567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="6234602">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="6234635">//</span><br>
<span class="lineno"></span><span class="comment" id="6234638">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="6234693">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="6234750">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="6234773">//</span><br>
<span class="lineno"></span><span class="comment" id="6234776">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6234789">//</span><br>
<span class="lineno"></span><span class="comment" id="6234792">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6234832">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="6234890">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="6234950">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6235010">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6235051">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="6235086">func</span>&nbsp;<span class="ident" id="6235091">Cot</span><span class="op" id="6235094">(</span><span class="ident" id="6235095">x</span>&nbsp;<span class="builtintype" id="6235097">complex128</span><span class="op" id="6235107">)</span>&nbsp;<span class="builtintype" id="6235109">complex128</span>&nbsp;<span class="op" id="6235120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235123">d</span>&nbsp;<span class="op" id="6235125">:=</span>&nbsp;<span class="ident" id="6235128">math</span><span class="op" id="6235132">.</span><span class="ident" id="6235133">Cosh</span><span class="op" id="6235137">(</span><span class="num" id="6235138">2</span><span class="op" id="6235139">*</span><span class="builtinfunc" id="6235140">imag</span><span class="op" id="6235144">(</span><span class="ident" id="6235145">x</span><span class="op" id="6235146">)</span><span class="op" id="6235147">)</span>&nbsp;<span class="op" id="6235149">-</span>&nbsp;<span class="ident" id="6235151">math</span><span class="op" id="6235155">.</span><span class="ident" id="6235156">Cos</span><span class="op" id="6235159">(</span><span class="num" id="6235160">2</span><span class="op" id="6235161">*</span><span class="builtinfunc" id="6235162">real</span><span class="op" id="6235166">(</span><span class="ident" id="6235167">x</span><span class="op" id="6235168">)</span><span class="op" id="6235169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235172">if</span>&nbsp;<span class="ident" id="6235175">math</span><span class="op" id="6235179">.</span><span class="ident" id="6235180">Abs</span><span class="op" id="6235183">(</span><span class="ident" id="6235184">d</span><span class="op" id="6235185">)</span>&nbsp;<span class="op" id="6235187">&lt;</span>&nbsp;<span class="num" id="6235189">0.25</span>&nbsp;<span class="op" id="6235194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235198">d</span>&nbsp;<span class="op" id="6235200">=</span>&nbsp;<span class="ident" id="6235202">tanSeries</span><span class="op" id="6235211">(</span><span class="ident" id="6235212">x</span><span class="op" id="6235213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235216">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235219">if</span>&nbsp;<span class="ident" id="6235222">d</span>&nbsp;<span class="op" id="6235224">==</span>&nbsp;<span class="num" id="6235227">0</span>&nbsp;<span class="op" id="6235229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235233">return</span>&nbsp;<span class="ident" id="6235240">Inf</span><span class="op" id="6235243">(</span><span class="op" id="6235244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235250">return</span>&nbsp;<span class="builtinfunc" id="6235257">complex</span><span class="op" id="6235264">(</span><span class="ident" id="6235265">math</span><span class="op" id="6235269">.</span><span class="ident" id="6235270">Sin</span><span class="op" id="6235273">(</span><span class="num" id="6235274">2</span><span class="op" id="6235275">*</span><span class="builtinfunc" id="6235276">real</span><span class="op" id="6235280">(</span><span class="ident" id="6235281">x</span><span class="op" id="6235282">)</span><span class="op" id="6235283">)</span><span class="op" id="6235284">/</span><span class="ident" id="6235285">d</span><span class="op" id="6235286">,</span>&nbsp;<span class="op" id="6235288">-</span><span class="ident" id="6235289">math</span><span class="op" id="6235293">.</span><span class="ident" id="6235294">Sinh</span><span class="op" id="6235298">(</span><span class="num" id="6235299">2</span><span class="op" id="6235300">*</span><span class="builtinfunc" id="6235301">imag</span><span class="op" id="6235305">(</span><span class="ident" id="6235306">x</span><span class="op" id="6235307">)</span><span class="op" id="6235308">)</span><span class="op" id="6235309">/</span><span class="ident" id="6235310">d</span><span class="op" id="6235311">)</span><br>
<span class="lineno"></span><span class="op" id="6235313">}</span>
</div>
</body>
</html>
