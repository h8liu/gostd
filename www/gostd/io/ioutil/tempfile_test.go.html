<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io/ioutil</h2>
<ul>
<li><a href="/gostd/io/ioutil/ioutil.go.html">ioutil.go</a></li>
<li><a href="/gostd/io/ioutil/ioutil_test.go.html">ioutil_test.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile.go.html">tempfile.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile_test.go.html">tempfile_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6967422">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6967477">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6967531">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6967582">package</span>&nbsp;<span class="ident" id="6967590">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6967598">import</span>&nbsp;<span class="op" id="6967605">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6967608">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6967614">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6967631">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6967641">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6967651">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6967654">func</span>&nbsp;<span class="ident" id="6967659">TestTempFile</span><span class="op" id="6967671">(</span><span class="ident" id="6967672">t</span>&nbsp;<span class="op" id="6967674">*</span><span class="ident" id="6967675">testing</span><span class="op" id="6967682">.</span><span class="ident" id="6967683">T</span><span class="op" id="6967684">)</span>&nbsp;<span class="op" id="6967686">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967689">f</span><span class="op" id="6967690">,</span>&nbsp;<span class="ident" id="6967692">err</span>&nbsp;<span class="op" id="6967696">:=</span>&nbsp;<span class="ident" id="6967699">TempFile</span><span class="op" id="6967707">(</span><span class="string" id="6967708">&#34;/_not_exists_&#34;</span><span class="op" id="6967723">,</span>&nbsp;<span class="string" id="6967725">&#34;foo&#34;</span><span class="op" id="6967730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967733">if</span>&nbsp;<span class="ident" id="6967736">f</span>&nbsp;<span class="op" id="6967738">!=</span>&nbsp;<span class="ident" id="6967741">nil</span>&nbsp;<span class="op" id="6967745">||</span>&nbsp;<span class="ident" id="6967748">err</span>&nbsp;<span class="op" id="6967752">==</span>&nbsp;<span class="ident" id="6967755">nil</span>&nbsp;<span class="op" id="6967759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967763">t</span><span class="op" id="6967764">.</span><span class="ident" id="6967765">Errorf</span><span class="op" id="6967771">(</span><span class="string" id="6967772">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6967815">,</span>&nbsp;<span class="ident" id="6967817">f</span><span class="op" id="6967818">,</span>&nbsp;<span class="ident" id="6967820">err</span><span class="op" id="6967823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967830">dir</span>&nbsp;<span class="op" id="6967834">:=</span>&nbsp;<span class="ident" id="6967837">os</span><span class="op" id="6967839">.</span><span class="ident" id="6967840">TempDir</span><span class="op" id="6967847">(</span><span class="op" id="6967848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967851">f</span><span class="op" id="6967852">,</span>&nbsp;<span class="ident" id="6967854">err</span>&nbsp;<span class="op" id="6967858">=</span>&nbsp;<span class="ident" id="6967860">TempFile</span><span class="op" id="6967868">(</span><span class="ident" id="6967869">dir</span><span class="op" id="6967872">,</span>&nbsp;<span class="string" id="6967874">&#34;ioutil_test&#34;</span><span class="op" id="6967887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967890">if</span>&nbsp;<span class="ident" id="6967893">f</span>&nbsp;<span class="op" id="6967895">==</span>&nbsp;<span class="ident" id="6967898">nil</span>&nbsp;<span class="op" id="6967902">||</span>&nbsp;<span class="ident" id="6967905">err</span>&nbsp;<span class="op" id="6967909">!=</span>&nbsp;<span class="ident" id="6967912">nil</span>&nbsp;<span class="op" id="6967916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967920">t</span><span class="op" id="6967921">.</span><span class="ident" id="6967922">Errorf</span><span class="op" id="6967928">(</span><span class="string" id="6967929">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6967968">,</span>&nbsp;<span class="ident" id="6967970">f</span><span class="op" id="6967971">,</span>&nbsp;<span class="ident" id="6967973">err</span><span class="op" id="6967976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967979">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967982">if</span>&nbsp;<span class="ident" id="6967985">f</span>&nbsp;<span class="op" id="6967987">!=</span>&nbsp;<span class="ident" id="6967990">nil</span>&nbsp;<span class="op" id="6967994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967998">f</span><span class="op" id="6967999">.</span><span class="ident" id="6968000">Close</span><span class="op" id="6968005">(</span><span class="op" id="6968006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968010">os</span><span class="op" id="6968012">.</span><span class="ident" id="6968013">Remove</span><span class="op" id="6968019">(</span><span class="ident" id="6968020">f</span><span class="op" id="6968021">.</span><span class="ident" id="6968022">Name</span><span class="op" id="6968026">(</span><span class="op" id="6968027">)</span><span class="op" id="6968028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968032">re</span>&nbsp;<span class="op" id="6968035">:=</span>&nbsp;<span class="ident" id="6968038">regexp</span><span class="op" id="6968044">.</span><span class="ident" id="6968045">MustCompile</span><span class="op" id="6968056">(</span><span class="string" id="6968057">&#34;^&#34;</span>&nbsp;<span class="op" id="6968061">+</span>&nbsp;<span class="ident" id="6968063">regexp</span><span class="op" id="6968069">.</span><span class="ident" id="6968070">QuoteMeta</span><span class="op" id="6968079">(</span><span class="ident" id="6968080">filepath</span><span class="op" id="6968088">.</span><span class="ident" id="6968089">Join</span><span class="op" id="6968093">(</span><span class="ident" id="6968094">dir</span><span class="op" id="6968097">,</span>&nbsp;<span class="string" id="6968099">&#34;ioutil_test&#34;</span><span class="op" id="6968112">)</span><span class="op" id="6968113">)</span>&nbsp;<span class="op" id="6968115">+</span>&nbsp;<span class="string" id="6968117">&#34;[0-9]+$&#34;</span><span class="op" id="6968126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6968130">if</span>&nbsp;<span class="op" id="6968133">!</span><span class="ident" id="6968134">re</span><span class="op" id="6968136">.</span><span class="ident" id="6968137">MatchString</span><span class="op" id="6968148">(</span><span class="ident" id="6968149">f</span><span class="op" id="6968150">.</span><span class="ident" id="6968151">Name</span><span class="op" id="6968155">(</span><span class="op" id="6968156">)</span><span class="op" id="6968157">)</span>&nbsp;<span class="op" id="6968159">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968164">t</span><span class="op" id="6968165">.</span><span class="ident" id="6968166">Errorf</span><span class="op" id="6968172">(</span><span class="string" id="6968173">&#34;TempFile(`&#34;</span><span class="op" id="6968185">+</span><span class="ident" id="6968186">dir</span><span class="op" id="6968189">+</span><span class="string" id="6968190">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6968229">,</span>&nbsp;<span class="ident" id="6968231">f</span><span class="op" id="6968232">.</span><span class="ident" id="6968233">Name</span><span class="op" id="6968237">(</span><span class="op" id="6968238">)</span><span class="op" id="6968239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968246">}</span><br>
<span class="lineno"></span><span class="op" id="6968248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6968251">func</span>&nbsp;<span class="ident" id="6968256">TestTempDir</span><span class="op" id="6968267">(</span><span class="ident" id="6968268">t</span>&nbsp;<span class="op" id="6968270">*</span><span class="ident" id="6968271">testing</span><span class="op" id="6968278">.</span><span class="ident" id="6968279">T</span><span class="op" id="6968280">)</span>&nbsp;<span class="op" id="6968282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968285">name</span><span class="op" id="6968289">,</span>&nbsp;<span class="ident" id="6968291">err</span>&nbsp;<span class="op" id="6968295">:=</span>&nbsp;<span class="ident" id="6968298">TempDir</span><span class="op" id="6968305">(</span><span class="string" id="6968306">&#34;/_not_exists_&#34;</span><span class="op" id="6968321">,</span>&nbsp;<span class="string" id="6968323">&#34;foo&#34;</span><span class="op" id="6968328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6968331">if</span>&nbsp;<span class="ident" id="6968334">name</span>&nbsp;<span class="op" id="6968339">!=</span>&nbsp;<span class="string" id="6968342">&#34;&#34;</span>&nbsp;<span class="op" id="6968345">||</span>&nbsp;<span class="ident" id="6968348">err</span>&nbsp;<span class="op" id="6968352">==</span>&nbsp;<span class="ident" id="6968355">nil</span>&nbsp;<span class="op" id="6968359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968363">t</span><span class="op" id="6968364">.</span><span class="ident" id="6968365">Errorf</span><span class="op" id="6968371">(</span><span class="string" id="6968372">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6968414">,</span>&nbsp;<span class="ident" id="6968416">name</span><span class="op" id="6968420">,</span>&nbsp;<span class="ident" id="6968422">err</span><span class="op" id="6968425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968428">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968432">dir</span>&nbsp;<span class="op" id="6968436">:=</span>&nbsp;<span class="ident" id="6968439">os</span><span class="op" id="6968441">.</span><span class="ident" id="6968442">TempDir</span><span class="op" id="6968449">(</span><span class="op" id="6968450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968453">name</span><span class="op" id="6968457">,</span>&nbsp;<span class="ident" id="6968459">err</span>&nbsp;<span class="op" id="6968463">=</span>&nbsp;<span class="ident" id="6968465">TempDir</span><span class="op" id="6968472">(</span><span class="ident" id="6968473">dir</span><span class="op" id="6968476">,</span>&nbsp;<span class="string" id="6968478">&#34;ioutil_test&#34;</span><span class="op" id="6968491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6968494">if</span>&nbsp;<span class="ident" id="6968497">name</span>&nbsp;<span class="op" id="6968502">==</span>&nbsp;<span class="string" id="6968505">&#34;&#34;</span>&nbsp;<span class="op" id="6968508">||</span>&nbsp;<span class="ident" id="6968511">err</span>&nbsp;<span class="op" id="6968515">!=</span>&nbsp;<span class="ident" id="6968518">nil</span>&nbsp;<span class="op" id="6968522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968526">t</span><span class="op" id="6968527">.</span><span class="ident" id="6968528">Errorf</span><span class="op" id="6968534">(</span><span class="string" id="6968535">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6968573">,</span>&nbsp;<span class="ident" id="6968575">name</span><span class="op" id="6968579">,</span>&nbsp;<span class="ident" id="6968581">err</span><span class="op" id="6968584">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6968590">if</span>&nbsp;<span class="ident" id="6968593">name</span>&nbsp;<span class="op" id="6968598">!=</span>&nbsp;<span class="string" id="6968601">&#34;&#34;</span>&nbsp;<span class="op" id="6968604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968608">os</span><span class="op" id="6968610">.</span><span class="ident" id="6968611">Remove</span><span class="op" id="6968617">(</span><span class="ident" id="6968618">name</span><span class="op" id="6968622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968626">re</span>&nbsp;<span class="op" id="6968629">:=</span>&nbsp;<span class="ident" id="6968632">regexp</span><span class="op" id="6968638">.</span><span class="ident" id="6968639">MustCompile</span><span class="op" id="6968650">(</span><span class="string" id="6968651">&#34;^&#34;</span>&nbsp;<span class="op" id="6968655">+</span>&nbsp;<span class="ident" id="6968657">regexp</span><span class="op" id="6968663">.</span><span class="ident" id="6968664">QuoteMeta</span><span class="op" id="6968673">(</span><span class="ident" id="6968674">filepath</span><span class="op" id="6968682">.</span><span class="ident" id="6968683">Join</span><span class="op" id="6968687">(</span><span class="ident" id="6968688">dir</span><span class="op" id="6968691">,</span>&nbsp;<span class="string" id="6968693">&#34;ioutil_test&#34;</span><span class="op" id="6968706">)</span><span class="op" id="6968707">)</span>&nbsp;<span class="op" id="6968709">+</span>&nbsp;<span class="string" id="6968711">&#34;[0-9]+$&#34;</span><span class="op" id="6968720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6968724">if</span>&nbsp;<span class="op" id="6968727">!</span><span class="ident" id="6968728">re</span><span class="op" id="6968730">.</span><span class="ident" id="6968731">MatchString</span><span class="op" id="6968742">(</span><span class="ident" id="6968743">name</span><span class="op" id="6968747">)</span>&nbsp;<span class="op" id="6968749">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6968754">t</span><span class="op" id="6968755">.</span><span class="ident" id="6968756">Errorf</span><span class="op" id="6968762">(</span><span class="string" id="6968763">&#34;TempDir(`&#34;</span><span class="op" id="6968774">+</span><span class="ident" id="6968775">dir</span><span class="op" id="6968778">+</span><span class="string" id="6968779">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6968818">,</span>&nbsp;<span class="ident" id="6968820">name</span><span class="op" id="6968824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968831">}</span><br>
<span class="lineno"></span><span class="op" id="6968833">}</span>
</div>
</body>
</html>
