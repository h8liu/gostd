<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html" class="current">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6502682">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6502737">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6502791">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6502842">package</span>&nbsp;<span class="ident" id="6502850">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6502855">import</span>&nbsp;<span class="op" id="6502862">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6502865">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6502874">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6502881">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6502887">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6502898">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6502909">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6502919">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6502922">//&nbsp;Test&nbsp;basic&nbsp;operations&nbsp;in&nbsp;a&nbsp;safe&nbsp;manner.</span><br>
<span class="lineno"></span><span class="keyword" id="6502965">func</span>&nbsp;<span class="ident" id="6502970">TestBasicEncoderDecoder</span><span class="op" id="6502993">(</span><span class="ident" id="6502994">t</span>&nbsp;<span class="op" id="6502996">*</span><span class="ident" id="6502997">testing</span><span class="op" id="6503004">.</span><span class="ident" id="6503005">T</span><span class="op" id="6503006">)</span>&nbsp;<span class="op" id="6503008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503011">var</span>&nbsp;<span class="ident" id="6503015">values</span>&nbsp;<span class="op" id="6503022">=</span>&nbsp;<span class="op" id="6503024">[</span><span class="op" id="6503025">]</span><span class="keyword" id="6503026">interface</span><span class="op" id="6503035">{</span><span class="op" id="6503036">}</span><span class="op" id="6503037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503041">true</span><span class="op" id="6503045">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503049">int</span><span class="op" id="6503052">(</span><span class="num" id="6503053">123</span><span class="op" id="6503056">)</span><span class="op" id="6503057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503061">int8</span><span class="op" id="6503065">(</span><span class="num" id="6503066">123</span><span class="op" id="6503069">)</span><span class="op" id="6503070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503074">int16</span><span class="op" id="6503079">(</span><span class="op" id="6503080">-</span><span class="num" id="6503081">12345</span><span class="op" id="6503086">)</span><span class="op" id="6503087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503091">int32</span><span class="op" id="6503096">(</span><span class="num" id="6503097">123456</span><span class="op" id="6503103">)</span><span class="op" id="6503104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503108">int64</span><span class="op" id="6503113">(</span><span class="op" id="6503114">-</span><span class="num" id="6503115">1234567</span><span class="op" id="6503122">)</span><span class="op" id="6503123">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503127">uint</span><span class="op" id="6503131">(</span><span class="num" id="6503132">123</span><span class="op" id="6503135">)</span><span class="op" id="6503136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503140">uint8</span><span class="op" id="6503145">(</span><span class="num" id="6503146">123</span><span class="op" id="6503149">)</span><span class="op" id="6503150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503154">uint16</span><span class="op" id="6503160">(</span><span class="num" id="6503161">12345</span><span class="op" id="6503166">)</span><span class="op" id="6503167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503171">uint32</span><span class="op" id="6503177">(</span><span class="num" id="6503178">123456</span><span class="op" id="6503184">)</span><span class="op" id="6503185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503189">uint64</span><span class="op" id="6503195">(</span><span class="num" id="6503196">1234567</span><span class="op" id="6503203">)</span><span class="op" id="6503204">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503208">uintptr</span><span class="op" id="6503215">(</span><span class="num" id="6503216">12345678</span><span class="op" id="6503224">)</span><span class="op" id="6503225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503229">float32</span><span class="op" id="6503236">(</span><span class="num" id="6503237">1.2345</span><span class="op" id="6503243">)</span><span class="op" id="6503244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503248">float64</span><span class="op" id="6503255">(</span><span class="num" id="6503256">1.2345678</span><span class="op" id="6503265">)</span><span class="op" id="6503266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503270">complex64</span><span class="op" id="6503279">(</span><span class="num" id="6503280">1.2345</span>&nbsp;<span class="op" id="6503287">+</span>&nbsp;<span class="num" id="6503289">2.3456i</span><span class="op" id="6503296">)</span><span class="op" id="6503297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503301">complex128</span><span class="op" id="6503311">(</span><span class="num" id="6503312">1.2345678</span>&nbsp;<span class="op" id="6503322">+</span>&nbsp;<span class="num" id="6503324">2.3456789i</span><span class="op" id="6503334">)</span><span class="op" id="6503335">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503339">[</span><span class="op" id="6503340">]</span><span class="builtintype" id="6503341">byte</span><span class="op" id="6503345">(</span><span class="string" id="6503346">&#34;hello&#34;</span><span class="op" id="6503353">)</span><span class="op" id="6503354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503358">string</span><span class="op" id="6503364">(</span><span class="string" id="6503365">&#34;hello&#34;</span><span class="op" id="6503372">)</span><span class="op" id="6503373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503379">for</span>&nbsp;<span class="ident" id="6503383">_</span><span class="op" id="6503384">,</span>&nbsp;<span class="ident" id="6503386">value</span>&nbsp;<span class="op" id="6503392">:=</span>&nbsp;<span class="keyword" id="6503395">range</span>&nbsp;<span class="ident" id="6503401">values</span>&nbsp;<span class="op" id="6503408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503412">b</span>&nbsp;<span class="op" id="6503414">:=</span>&nbsp;<span class="builtinfunc" id="6503417">new</span><span class="op" id="6503420">(</span><span class="ident" id="6503421">bytes</span><span class="op" id="6503426">.</span><span class="ident" id="6503427">Buffer</span><span class="op" id="6503433">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503437">enc</span>&nbsp;<span class="op" id="6503441">:=</span>&nbsp;<span class="ident" id="6503444">NewEncoder</span><span class="op" id="6503454">(</span><span class="ident" id="6503455">b</span><span class="op" id="6503456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503460">err</span>&nbsp;<span class="op" id="6503464">:=</span>&nbsp;<span class="ident" id="6503467">enc</span><span class="op" id="6503470">.</span><span class="ident" id="6503471">Encode</span><span class="op" id="6503477">(</span><span class="ident" id="6503478">value</span><span class="op" id="6503483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503487">if</span>&nbsp;<span class="ident" id="6503490">err</span>&nbsp;<span class="op" id="6503494">!=</span>&nbsp;<span class="builtintype" id="6503497">nil</span>&nbsp;<span class="op" id="6503501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503506">t</span><span class="op" id="6503507">.</span><span class="ident" id="6503508">Error</span><span class="op" id="6503513">(</span><span class="string" id="6503514">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="6503529">,</span>&nbsp;<span class="ident" id="6503531">err</span><span class="op" id="6503534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503538">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503542">dec</span>&nbsp;<span class="op" id="6503546">:=</span>&nbsp;<span class="ident" id="6503549">NewDecoder</span><span class="op" id="6503559">(</span><span class="ident" id="6503560">b</span><span class="op" id="6503561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503565">result</span>&nbsp;<span class="op" id="6503572">:=</span>&nbsp;<span class="ident" id="6503575">reflect</span><span class="op" id="6503582">.</span><span class="ident" id="6503583">New</span><span class="op" id="6503586">(</span><span class="ident" id="6503587">reflect</span><span class="op" id="6503594">.</span><span class="ident" id="6503595">TypeOf</span><span class="op" id="6503601">(</span><span class="ident" id="6503602">value</span><span class="op" id="6503607">)</span><span class="op" id="6503608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503612">err</span>&nbsp;<span class="op" id="6503616">=</span>&nbsp;<span class="ident" id="6503618">dec</span><span class="op" id="6503621">.</span><span class="ident" id="6503622">Decode</span><span class="op" id="6503628">(</span><span class="ident" id="6503629">result</span><span class="op" id="6503635">.</span><span class="ident" id="6503636">Interface</span><span class="op" id="6503645">(</span><span class="op" id="6503646">)</span><span class="op" id="6503647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503651">if</span>&nbsp;<span class="ident" id="6503654">err</span>&nbsp;<span class="op" id="6503658">!=</span>&nbsp;<span class="builtintype" id="6503661">nil</span>&nbsp;<span class="op" id="6503665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503670">t</span><span class="op" id="6503671">.</span><span class="ident" id="6503672">Fatalf</span><span class="op" id="6503678">(</span><span class="string" id="6503679">&#34;error&nbsp;decoding&nbsp;%T:&nbsp;%v:&#34;</span><span class="op" id="6503703">,</span>&nbsp;<span class="ident" id="6503705">reflect</span><span class="op" id="6503712">.</span><span class="ident" id="6503713">TypeOf</span><span class="op" id="6503719">(</span><span class="ident" id="6503720">value</span><span class="op" id="6503725">)</span><span class="op" id="6503726">,</span>&nbsp;<span class="ident" id="6503728">err</span><span class="op" id="6503731">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503739">if</span>&nbsp;<span class="op" id="6503742">!</span><span class="ident" id="6503743">reflect</span><span class="op" id="6503750">.</span><span class="ident" id="6503751">DeepEqual</span><span class="op" id="6503760">(</span><span class="ident" id="6503761">value</span><span class="op" id="6503766">,</span>&nbsp;<span class="ident" id="6503768">result</span><span class="op" id="6503774">.</span><span class="ident" id="6503775">Elem</span><span class="op" id="6503779">(</span><span class="op" id="6503780">)</span><span class="op" id="6503781">.</span><span class="ident" id="6503782">Interface</span><span class="op" id="6503791">(</span><span class="op" id="6503792">)</span><span class="op" id="6503793">)</span>&nbsp;<span class="op" id="6503795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503800">t</span><span class="op" id="6503801">.</span><span class="ident" id="6503802">Fatalf</span><span class="op" id="6503808">(</span><span class="string" id="6503809">&#34;%T:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6503833">,</span>&nbsp;<span class="ident" id="6503835">value</span><span class="op" id="6503840">,</span>&nbsp;<span class="ident" id="6503842">value</span><span class="op" id="6503847">,</span>&nbsp;<span class="ident" id="6503849">result</span><span class="op" id="6503855">.</span><span class="ident" id="6503856">Elem</span><span class="op" id="6503860">(</span><span class="op" id="6503861">)</span><span class="op" id="6503862">.</span><span class="ident" id="6503863">Interface</span><span class="op" id="6503872">(</span><span class="op" id="6503873">)</span><span class="op" id="6503874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503881">}</span><br>
<span class="lineno">55</span><span class="op" id="6503883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6503886">type</span>&nbsp;<span class="ident" id="6503891">ET0</span>&nbsp;<span class="keyword" id="6503895">struct</span>&nbsp;<span class="op" id="6503902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503905">A</span>&nbsp;<span class="builtintype" id="6503907">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503912">B</span>&nbsp;<span class="builtintype" id="6503914">string</span><br>
<span class="lineno">60</span><span class="op" id="6503921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6503924">type</span>&nbsp;<span class="ident" id="6503929">ET2</span>&nbsp;<span class="keyword" id="6503933">struct</span>&nbsp;<span class="op" id="6503940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503943">X</span>&nbsp;<span class="builtintype" id="6503945">string</span><br>
<span class="lineno"></span><span class="op" id="6503952">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="6503955">type</span>&nbsp;<span class="ident" id="6503960">ET1</span>&nbsp;<span class="keyword" id="6503964">struct</span>&nbsp;<span class="op" id="6503971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503974">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6503979">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503984">Et2</span>&nbsp;&nbsp;<span class="op" id="6503989">*</span><span class="ident" id="6503990">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503995">Next</span>&nbsp;<span class="op" id="6504000">*</span><span class="ident" id="6504001">ET1</span><br>
<span class="lineno">70</span><span class="op" id="6504005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6504008">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;name&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="6504058">type</span>&nbsp;<span class="ident" id="6504063">ET3</span>&nbsp;<span class="keyword" id="6504067">struct</span>&nbsp;<span class="op" id="6504074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504077">A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6504091">int</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504096">Et2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504110">*</span><span class="ident" id="6504111">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504116">DifferentNext</span>&nbsp;<span class="op" id="6504130">*</span><span class="ident" id="6504131">ET1</span><br>
<span class="lineno"></span><span class="op" id="6504135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6504138">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;type&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno">80</span><span class="keyword" id="6504188">type</span>&nbsp;<span class="ident" id="6504193">ET4</span>&nbsp;<span class="keyword" id="6504197">struct</span>&nbsp;<span class="op" id="6504204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504207">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6504212">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504217">Et2</span>&nbsp;&nbsp;<span class="builtintype" id="6504222">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504231">Next</span>&nbsp;<span class="builtintype" id="6504236">int</span><br>
<span class="lineno"></span><span class="op" id="6504240">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="6504243">func</span>&nbsp;<span class="ident" id="6504248">TestEncoderDecoder</span><span class="op" id="6504266">(</span><span class="ident" id="6504267">t</span>&nbsp;<span class="op" id="6504269">*</span><span class="ident" id="6504270">testing</span><span class="op" id="6504277">.</span><span class="ident" id="6504278">T</span><span class="op" id="6504279">)</span>&nbsp;<span class="op" id="6504281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504284">b</span>&nbsp;<span class="op" id="6504286">:=</span>&nbsp;<span class="builtinfunc" id="6504289">new</span><span class="op" id="6504292">(</span><span class="ident" id="6504293">bytes</span><span class="op" id="6504298">.</span><span class="ident" id="6504299">Buffer</span><span class="op" id="6504305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504308">enc</span>&nbsp;<span class="op" id="6504312">:=</span>&nbsp;<span class="ident" id="6504315">NewEncoder</span><span class="op" id="6504325">(</span><span class="ident" id="6504326">b</span><span class="op" id="6504327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504330">et0</span>&nbsp;<span class="op" id="6504334">:=</span>&nbsp;<span class="builtinfunc" id="6504337">new</span><span class="op" id="6504340">(</span><span class="ident" id="6504341">ET0</span><span class="op" id="6504344">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504347">et0</span><span class="op" id="6504350">.</span><span class="ident" id="6504351">A</span>&nbsp;<span class="op" id="6504353">=</span>&nbsp;<span class="num" id="6504355">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504358">et0</span><span class="op" id="6504361">.</span><span class="ident" id="6504362">B</span>&nbsp;<span class="op" id="6504364">=</span>&nbsp;<span class="string" id="6504366">&#34;gobs&nbsp;of&nbsp;fun&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504381">err</span>&nbsp;<span class="op" id="6504385">:=</span>&nbsp;<span class="ident" id="6504388">enc</span><span class="op" id="6504391">.</span><span class="ident" id="6504392">Encode</span><span class="op" id="6504398">(</span><span class="ident" id="6504399">et0</span><span class="op" id="6504402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504405">if</span>&nbsp;<span class="ident" id="6504408">err</span>&nbsp;<span class="op" id="6504412">!=</span>&nbsp;<span class="builtintype" id="6504415">nil</span>&nbsp;<span class="op" id="6504419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504423">t</span><span class="op" id="6504424">.</span><span class="ident" id="6504425">Error</span><span class="op" id="6504430">(</span><span class="string" id="6504431">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="6504446">,</span>&nbsp;<span class="ident" id="6504448">err</span><span class="op" id="6504451">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6504457">//fmt.Printf(&#34;%&nbsp;x&nbsp;%q\n&#34;,&nbsp;b,&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6504489">//Debug(b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504501">dec</span>&nbsp;<span class="op" id="6504505">:=</span>&nbsp;<span class="ident" id="6504508">NewDecoder</span><span class="op" id="6504518">(</span><span class="ident" id="6504519">b</span><span class="op" id="6504520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504523">newEt0</span>&nbsp;<span class="op" id="6504530">:=</span>&nbsp;<span class="builtinfunc" id="6504533">new</span><span class="op" id="6504536">(</span><span class="ident" id="6504537">ET0</span><span class="op" id="6504540">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504543">err</span>&nbsp;<span class="op" id="6504547">=</span>&nbsp;<span class="ident" id="6504549">dec</span><span class="op" id="6504552">.</span><span class="ident" id="6504553">Decode</span><span class="op" id="6504559">(</span><span class="ident" id="6504560">newEt0</span><span class="op" id="6504566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504569">if</span>&nbsp;<span class="ident" id="6504572">err</span>&nbsp;<span class="op" id="6504576">!=</span>&nbsp;<span class="builtintype" id="6504579">nil</span>&nbsp;<span class="op" id="6504583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504587">t</span><span class="op" id="6504588">.</span><span class="ident" id="6504589">Fatal</span><span class="op" id="6504594">(</span><span class="string" id="6504595">&#34;error&nbsp;decoding&nbsp;ET0:&#34;</span><span class="op" id="6504616">,</span>&nbsp;<span class="ident" id="6504618">err</span><span class="op" id="6504621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504628">if</span>&nbsp;<span class="op" id="6504631">!</span><span class="ident" id="6504632">reflect</span><span class="op" id="6504639">.</span><span class="ident" id="6504640">DeepEqual</span><span class="op" id="6504649">(</span><span class="ident" id="6504650">et0</span><span class="op" id="6504653">,</span>&nbsp;<span class="ident" id="6504655">newEt0</span><span class="op" id="6504661">)</span>&nbsp;<span class="op" id="6504663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504667">t</span><span class="op" id="6504668">.</span><span class="ident" id="6504669">Fatalf</span><span class="op" id="6504675">(</span><span class="string" id="6504676">&#34;invalid&nbsp;data&nbsp;for&nbsp;et0:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="6504721">,</span>&nbsp;<span class="op" id="6504723">*</span><span class="ident" id="6504724">et0</span><span class="op" id="6504727">,</span>&nbsp;<span class="op" id="6504729">*</span><span class="ident" id="6504730">newEt0</span><span class="op" id="6504736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504742">if</span>&nbsp;<span class="ident" id="6504745">b</span><span class="op" id="6504746">.</span><span class="ident" id="6504747">Len</span><span class="op" id="6504750">(</span><span class="op" id="6504751">)</span>&nbsp;<span class="op" id="6504753">!=</span>&nbsp;<span class="num" id="6504756">0</span>&nbsp;<span class="op" id="6504758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504762">t</span><span class="op" id="6504763">.</span><span class="ident" id="6504764">Error</span><span class="op" id="6504769">(</span><span class="string" id="6504770">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="6504783">,</span>&nbsp;<span class="ident" id="6504785">b</span><span class="op" id="6504786">.</span><span class="ident" id="6504787">Len</span><span class="op" id="6504790">(</span><span class="op" id="6504791">)</span><span class="op" id="6504792">,</span>&nbsp;<span class="string" id="6504794">&#34;bytes&nbsp;left&#34;</span><span class="op" id="6504806">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6504812">//&nbsp;&nbsp;&nbsp;&nbsp;t.FailNow()</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504829">b</span>&nbsp;<span class="op" id="6504831">=</span>&nbsp;<span class="builtinfunc" id="6504833">new</span><span class="op" id="6504836">(</span><span class="ident" id="6504837">bytes</span><span class="op" id="6504842">.</span><span class="ident" id="6504843">Buffer</span><span class="op" id="6504849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504852">enc</span>&nbsp;<span class="op" id="6504856">=</span>&nbsp;<span class="ident" id="6504858">NewEncoder</span><span class="op" id="6504868">(</span><span class="ident" id="6504869">b</span><span class="op" id="6504870">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504873">et1</span>&nbsp;<span class="op" id="6504877">:=</span>&nbsp;<span class="builtinfunc" id="6504880">new</span><span class="op" id="6504883">(</span><span class="ident" id="6504884">ET1</span><span class="op" id="6504887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504890">et1</span><span class="op" id="6504893">.</span><span class="ident" id="6504894">A</span>&nbsp;<span class="op" id="6504896">=</span>&nbsp;<span class="num" id="6504898">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504901">et1</span><span class="op" id="6504904">.</span><span class="ident" id="6504905">Et2</span>&nbsp;<span class="op" id="6504909">=</span>&nbsp;<span class="builtinfunc" id="6504911">new</span><span class="op" id="6504914">(</span><span class="ident" id="6504915">ET2</span><span class="op" id="6504918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504921">err</span>&nbsp;<span class="op" id="6504925">=</span>&nbsp;<span class="ident" id="6504927">enc</span><span class="op" id="6504930">.</span><span class="ident" id="6504931">Encode</span><span class="op" id="6504937">(</span><span class="ident" id="6504938">et1</span><span class="op" id="6504941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504944">if</span>&nbsp;<span class="ident" id="6504947">err</span>&nbsp;<span class="op" id="6504951">!=</span>&nbsp;<span class="builtintype" id="6504954">nil</span>&nbsp;<span class="op" id="6504958">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504962">t</span><span class="op" id="6504963">.</span><span class="ident" id="6504964">Error</span><span class="op" id="6504969">(</span><span class="string" id="6504970">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="6504985">,</span>&nbsp;<span class="ident" id="6504987">err</span><span class="op" id="6504990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504996">dec</span>&nbsp;<span class="op" id="6505000">=</span>&nbsp;<span class="ident" id="6505002">NewDecoder</span><span class="op" id="6505012">(</span><span class="ident" id="6505013">b</span><span class="op" id="6505014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505017">newEt1</span>&nbsp;<span class="op" id="6505024">:=</span>&nbsp;<span class="builtinfunc" id="6505027">new</span><span class="op" id="6505030">(</span><span class="ident" id="6505031">ET1</span><span class="op" id="6505034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505037">err</span>&nbsp;<span class="op" id="6505041">=</span>&nbsp;<span class="ident" id="6505043">dec</span><span class="op" id="6505046">.</span><span class="ident" id="6505047">Decode</span><span class="op" id="6505053">(</span><span class="ident" id="6505054">newEt1</span><span class="op" id="6505060">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505063">if</span>&nbsp;<span class="ident" id="6505066">err</span>&nbsp;<span class="op" id="6505070">!=</span>&nbsp;<span class="builtintype" id="6505073">nil</span>&nbsp;<span class="op" id="6505077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505081">t</span><span class="op" id="6505082">.</span><span class="ident" id="6505083">Fatal</span><span class="op" id="6505088">(</span><span class="string" id="6505089">&#34;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="6505110">,</span>&nbsp;<span class="ident" id="6505112">err</span><span class="op" id="6505115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505122">if</span>&nbsp;<span class="op" id="6505125">!</span><span class="ident" id="6505126">reflect</span><span class="op" id="6505133">.</span><span class="ident" id="6505134">DeepEqual</span><span class="op" id="6505143">(</span><span class="ident" id="6505144">et1</span><span class="op" id="6505147">,</span>&nbsp;<span class="ident" id="6505149">newEt1</span><span class="op" id="6505155">)</span>&nbsp;<span class="op" id="6505157">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505161">t</span><span class="op" id="6505162">.</span><span class="ident" id="6505163">Fatalf</span><span class="op" id="6505169">(</span><span class="string" id="6505170">&#34;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="6505215">,</span>&nbsp;<span class="op" id="6505217">*</span><span class="ident" id="6505218">et1</span><span class="op" id="6505221">,</span>&nbsp;<span class="op" id="6505223">*</span><span class="ident" id="6505224">newEt1</span><span class="op" id="6505230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505236">if</span>&nbsp;<span class="ident" id="6505239">b</span><span class="op" id="6505240">.</span><span class="ident" id="6505241">Len</span><span class="op" id="6505244">(</span><span class="op" id="6505245">)</span>&nbsp;<span class="op" id="6505247">!=</span>&nbsp;<span class="num" id="6505250">0</span>&nbsp;<span class="op" id="6505252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505256">t</span><span class="op" id="6505257">.</span><span class="ident" id="6505258">Error</span><span class="op" id="6505263">(</span><span class="string" id="6505264">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="6505277">,</span>&nbsp;<span class="ident" id="6505279">b</span><span class="op" id="6505280">.</span><span class="ident" id="6505281">Len</span><span class="op" id="6505284">(</span><span class="op" id="6505285">)</span><span class="op" id="6505286">,</span>&nbsp;<span class="string" id="6505288">&#34;bytes&nbsp;left&#34;</span><span class="op" id="6505300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505303">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505307">enc</span><span class="op" id="6505310">.</span><span class="ident" id="6505311">Encode</span><span class="op" id="6505317">(</span><span class="ident" id="6505318">et1</span><span class="op" id="6505321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505324">newEt1</span>&nbsp;<span class="op" id="6505331">=</span>&nbsp;<span class="builtinfunc" id="6505333">new</span><span class="op" id="6505336">(</span><span class="ident" id="6505337">ET1</span><span class="op" id="6505340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505343">err</span>&nbsp;<span class="op" id="6505347">=</span>&nbsp;<span class="ident" id="6505349">dec</span><span class="op" id="6505352">.</span><span class="ident" id="6505353">Decode</span><span class="op" id="6505359">(</span><span class="ident" id="6505360">newEt1</span><span class="op" id="6505366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505369">if</span>&nbsp;<span class="ident" id="6505372">err</span>&nbsp;<span class="op" id="6505376">!=</span>&nbsp;<span class="builtintype" id="6505379">nil</span>&nbsp;<span class="op" id="6505383">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505387">t</span><span class="op" id="6505388">.</span><span class="ident" id="6505389">Fatal</span><span class="op" id="6505394">(</span><span class="string" id="6505395">&#34;round&nbsp;2:&nbsp;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="6505425">,</span>&nbsp;<span class="ident" id="6505427">err</span><span class="op" id="6505430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505436">if</span>&nbsp;<span class="op" id="6505439">!</span><span class="ident" id="6505440">reflect</span><span class="op" id="6505447">.</span><span class="ident" id="6505448">DeepEqual</span><span class="op" id="6505457">(</span><span class="ident" id="6505458">et1</span><span class="op" id="6505461">,</span>&nbsp;<span class="ident" id="6505463">newEt1</span><span class="op" id="6505469">)</span>&nbsp;<span class="op" id="6505471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505475">t</span><span class="op" id="6505476">.</span><span class="ident" id="6505477">Fatalf</span><span class="op" id="6505483">(</span><span class="string" id="6505484">&#34;round&nbsp;2:&nbsp;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="6505538">,</span>&nbsp;<span class="op" id="6505540">*</span><span class="ident" id="6505541">et1</span><span class="op" id="6505544">,</span>&nbsp;<span class="op" id="6505546">*</span><span class="ident" id="6505547">newEt1</span><span class="op" id="6505553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505556">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505559">if</span>&nbsp;<span class="ident" id="6505562">b</span><span class="op" id="6505563">.</span><span class="ident" id="6505564">Len</span><span class="op" id="6505567">(</span><span class="op" id="6505568">)</span>&nbsp;<span class="op" id="6505570">!=</span>&nbsp;<span class="num" id="6505573">0</span>&nbsp;<span class="op" id="6505575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505579">t</span><span class="op" id="6505580">.</span><span class="ident" id="6505581">Error</span><span class="op" id="6505586">(</span><span class="string" id="6505587">&#34;round&nbsp;2:&nbsp;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="6505609">,</span>&nbsp;<span class="ident" id="6505611">b</span><span class="op" id="6505612">.</span><span class="ident" id="6505613">Len</span><span class="op" id="6505616">(</span><span class="op" id="6505617">)</span><span class="op" id="6505618">,</span>&nbsp;<span class="string" id="6505620">&#34;bytes&nbsp;left&#34;</span><span class="op" id="6505632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6505639">//&nbsp;Now&nbsp;test&nbsp;with&nbsp;a&nbsp;running&nbsp;encoder/decoder&nbsp;pair&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;type&nbsp;mismatch.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505723">err</span>&nbsp;<span class="op" id="6505727">=</span>&nbsp;<span class="ident" id="6505729">enc</span><span class="op" id="6505732">.</span><span class="ident" id="6505733">Encode</span><span class="op" id="6505739">(</span><span class="ident" id="6505740">et1</span><span class="op" id="6505743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505746">if</span>&nbsp;<span class="ident" id="6505749">err</span>&nbsp;<span class="op" id="6505753">!=</span>&nbsp;<span class="builtintype" id="6505756">nil</span>&nbsp;<span class="op" id="6505760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505764">t</span><span class="op" id="6505765">.</span><span class="ident" id="6505766">Error</span><span class="op" id="6505771">(</span><span class="string" id="6505772">&#34;round&nbsp;3:&nbsp;encoder&nbsp;fail:&#34;</span><span class="op" id="6505796">,</span>&nbsp;<span class="ident" id="6505798">err</span><span class="op" id="6505801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505807">newEt2</span>&nbsp;<span class="op" id="6505814">:=</span>&nbsp;<span class="builtinfunc" id="6505817">new</span><span class="op" id="6505820">(</span><span class="ident" id="6505821">ET2</span><span class="op" id="6505824">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505827">err</span>&nbsp;<span class="op" id="6505831">=</span>&nbsp;<span class="ident" id="6505833">dec</span><span class="op" id="6505836">.</span><span class="ident" id="6505837">Decode</span><span class="op" id="6505843">(</span><span class="ident" id="6505844">newEt2</span><span class="op" id="6505850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6505853">if</span>&nbsp;<span class="ident" id="6505856">err</span>&nbsp;<span class="op" id="6505860">==</span>&nbsp;<span class="builtintype" id="6505863">nil</span>&nbsp;<span class="op" id="6505867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6505871">t</span><span class="op" id="6505872">.</span><span class="ident" id="6505873">Fatal</span><span class="op" id="6505878">(</span><span class="string" id="6505879">&#34;round&nbsp;3:&nbsp;expected&nbsp;`bad&nbsp;type&#39;&nbsp;error&nbsp;decoding&nbsp;ET2&#34;</span><span class="op" id="6505928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6505931">}</span><br>
<span class="lineno"></span><span class="op" id="6505933">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="6505936">//&nbsp;Run&nbsp;one&nbsp;value&nbsp;through&nbsp;the&nbsp;encoder/decoder,&nbsp;but&nbsp;use&nbsp;the&nbsp;wrong&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="6506006">//&nbsp;Input&nbsp;is&nbsp;always&nbsp;an&nbsp;ET1;&nbsp;we&nbsp;compare&nbsp;it&nbsp;to&nbsp;whatever&nbsp;is&nbsp;under&nbsp;&#39;e&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="6506073">func</span>&nbsp;<span class="ident" id="6506078">badTypeCheck</span><span class="op" id="6506090">(</span><span class="ident" id="6506091">e</span>&nbsp;<span class="keyword" id="6506093">interface</span><span class="op" id="6506102">{</span><span class="op" id="6506103">}</span><span class="op" id="6506104">,</span>&nbsp;<span class="ident" id="6506106">shouldFail</span>&nbsp;<span class="builtintype" id="6506117">bool</span><span class="op" id="6506121">,</span>&nbsp;<span class="ident" id="6506123">msg</span>&nbsp;<span class="builtintype" id="6506127">string</span><span class="op" id="6506133">,</span>&nbsp;<span class="ident" id="6506135">t</span>&nbsp;<span class="op" id="6506137">*</span><span class="ident" id="6506138">testing</span><span class="op" id="6506145">.</span><span class="ident" id="6506146">T</span><span class="op" id="6506147">)</span>&nbsp;<span class="op" id="6506149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506152">b</span>&nbsp;<span class="op" id="6506154">:=</span>&nbsp;<span class="builtinfunc" id="6506157">new</span><span class="op" id="6506160">(</span><span class="ident" id="6506161">bytes</span><span class="op" id="6506166">.</span><span class="ident" id="6506167">Buffer</span><span class="op" id="6506173">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506176">enc</span>&nbsp;<span class="op" id="6506180">:=</span>&nbsp;<span class="ident" id="6506183">NewEncoder</span><span class="op" id="6506193">(</span><span class="ident" id="6506194">b</span><span class="op" id="6506195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506198">et1</span>&nbsp;<span class="op" id="6506202">:=</span>&nbsp;<span class="builtinfunc" id="6506205">new</span><span class="op" id="6506208">(</span><span class="ident" id="6506209">ET1</span><span class="op" id="6506212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506215">et1</span><span class="op" id="6506218">.</span><span class="ident" id="6506219">A</span>&nbsp;<span class="op" id="6506221">=</span>&nbsp;<span class="num" id="6506223">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506226">et1</span><span class="op" id="6506229">.</span><span class="ident" id="6506230">Et2</span>&nbsp;<span class="op" id="6506234">=</span>&nbsp;<span class="builtinfunc" id="6506236">new</span><span class="op" id="6506239">(</span><span class="ident" id="6506240">ET2</span><span class="op" id="6506243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506246">err</span>&nbsp;<span class="op" id="6506250">:=</span>&nbsp;<span class="ident" id="6506253">enc</span><span class="op" id="6506256">.</span><span class="ident" id="6506257">Encode</span><span class="op" id="6506263">(</span><span class="ident" id="6506264">et1</span><span class="op" id="6506267">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6506270">if</span>&nbsp;<span class="ident" id="6506273">err</span>&nbsp;<span class="op" id="6506277">!=</span>&nbsp;<span class="builtintype" id="6506280">nil</span>&nbsp;<span class="op" id="6506284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506288">t</span><span class="op" id="6506289">.</span><span class="ident" id="6506290">Error</span><span class="op" id="6506295">(</span><span class="string" id="6506296">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="6506311">,</span>&nbsp;<span class="ident" id="6506313">err</span><span class="op" id="6506316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6506319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506322">dec</span>&nbsp;<span class="op" id="6506326">:=</span>&nbsp;<span class="ident" id="6506329">NewDecoder</span><span class="op" id="6506339">(</span><span class="ident" id="6506340">b</span><span class="op" id="6506341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506344">err</span>&nbsp;<span class="op" id="6506348">=</span>&nbsp;<span class="ident" id="6506350">dec</span><span class="op" id="6506353">.</span><span class="ident" id="6506354">Decode</span><span class="op" id="6506360">(</span><span class="ident" id="6506361">e</span><span class="op" id="6506362">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6506365">if</span>&nbsp;<span class="ident" id="6506368">shouldFail</span>&nbsp;<span class="op" id="6506379">&amp;&amp;</span>&nbsp;<span class="ident" id="6506382">err</span>&nbsp;<span class="op" id="6506386">==</span>&nbsp;<span class="builtintype" id="6506389">nil</span>&nbsp;<span class="op" id="6506393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506397">t</span><span class="op" id="6506398">.</span><span class="ident" id="6506399">Error</span><span class="op" id="6506404">(</span><span class="string" id="6506405">&#34;expected&nbsp;error&nbsp;for&#34;</span><span class="op" id="6506425">,</span>&nbsp;<span class="ident" id="6506427">msg</span><span class="op" id="6506430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6506433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6506436">if</span>&nbsp;<span class="op" id="6506439">!</span><span class="ident" id="6506440">shouldFail</span>&nbsp;<span class="op" id="6506451">&amp;&amp;</span>&nbsp;<span class="ident" id="6506454">err</span>&nbsp;<span class="op" id="6506458">!=</span>&nbsp;<span class="builtintype" id="6506461">nil</span>&nbsp;<span class="op" id="6506465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506469">t</span><span class="op" id="6506470">.</span><span class="ident" id="6506471">Error</span><span class="op" id="6506476">(</span><span class="string" id="6506477">&#34;unexpected&nbsp;error&nbsp;for&#34;</span><span class="op" id="6506499">,</span>&nbsp;<span class="ident" id="6506501">msg</span><span class="op" id="6506504">,</span>&nbsp;<span class="ident" id="6506506">err</span><span class="op" id="6506509">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6506512">}</span><br>
<span class="lineno"></span><span class="op" id="6506514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6506517">//&nbsp;Test&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;bad&nbsp;type&nbsp;the&nbsp;first&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="6506570">func</span>&nbsp;<span class="ident" id="6506575">TestWrongTypeDecoder</span><span class="op" id="6506595">(</span><span class="ident" id="6506596">t</span>&nbsp;<span class="op" id="6506598">*</span><span class="ident" id="6506599">testing</span><span class="op" id="6506606">.</span><span class="ident" id="6506607">T</span><span class="op" id="6506608">)</span>&nbsp;<span class="op" id="6506610">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506613">badTypeCheck</span><span class="op" id="6506625">(</span><span class="builtinfunc" id="6506626">new</span><span class="op" id="6506629">(</span><span class="ident" id="6506630">ET2</span><span class="op" id="6506633">)</span><span class="op" id="6506634">,</span>&nbsp;<span class="builtintype" id="6506636">true</span><span class="op" id="6506640">,</span>&nbsp;<span class="string" id="6506642">&#34;no&nbsp;fields&nbsp;in&nbsp;common&#34;</span><span class="op" id="6506663">,</span>&nbsp;<span class="ident" id="6506665">t</span><span class="op" id="6506666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506669">badTypeCheck</span><span class="op" id="6506681">(</span><span class="builtinfunc" id="6506682">new</span><span class="op" id="6506685">(</span><span class="ident" id="6506686">ET3</span><span class="op" id="6506689">)</span><span class="op" id="6506690">,</span>&nbsp;<span class="builtintype" id="6506692">false</span><span class="op" id="6506697">,</span>&nbsp;<span class="string" id="6506699">&#34;different&nbsp;name&nbsp;of&nbsp;field&#34;</span><span class="op" id="6506724">,</span>&nbsp;<span class="ident" id="6506726">t</span><span class="op" id="6506727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506730">badTypeCheck</span><span class="op" id="6506742">(</span><span class="builtinfunc" id="6506743">new</span><span class="op" id="6506746">(</span><span class="ident" id="6506747">ET4</span><span class="op" id="6506750">)</span><span class="op" id="6506751">,</span>&nbsp;<span class="builtintype" id="6506753">true</span><span class="op" id="6506757">,</span>&nbsp;<span class="string" id="6506759">&#34;different&nbsp;type&nbsp;of&nbsp;field&#34;</span><span class="op" id="6506784">,</span>&nbsp;<span class="ident" id="6506786">t</span><span class="op" id="6506787">)</span><br>
<span class="lineno"></span><span class="op" id="6506789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="6506792">func</span>&nbsp;<span class="ident" id="6506797">corruptDataCheck</span><span class="op" id="6506813">(</span><span class="ident" id="6506814">s</span>&nbsp;<span class="builtintype" id="6506816">string</span><span class="op" id="6506822">,</span>&nbsp;<span class="ident" id="6506824">err</span>&nbsp;<span class="builtintype" id="6506828">error</span><span class="op" id="6506833">,</span>&nbsp;<span class="ident" id="6506835">t</span>&nbsp;<span class="op" id="6506837">*</span><span class="ident" id="6506838">testing</span><span class="op" id="6506845">.</span><span class="ident" id="6506846">T</span><span class="op" id="6506847">)</span>&nbsp;<span class="op" id="6506849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506852">b</span>&nbsp;<span class="op" id="6506854">:=</span>&nbsp;<span class="ident" id="6506857">bytes</span><span class="op" id="6506862">.</span><span class="ident" id="6506863">NewBufferString</span><span class="op" id="6506878">(</span><span class="ident" id="6506879">s</span><span class="op" id="6506880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506883">dec</span>&nbsp;<span class="op" id="6506887">:=</span>&nbsp;<span class="ident" id="6506890">NewDecoder</span><span class="op" id="6506900">(</span><span class="ident" id="6506901">b</span><span class="op" id="6506902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506905">err1</span>&nbsp;<span class="op" id="6506910">:=</span>&nbsp;<span class="ident" id="6506913">dec</span><span class="op" id="6506916">.</span><span class="ident" id="6506917">Decode</span><span class="op" id="6506923">(</span><span class="builtinfunc" id="6506924">new</span><span class="op" id="6506927">(</span><span class="ident" id="6506928">ET2</span><span class="op" id="6506931">)</span><span class="op" id="6506932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6506935">if</span>&nbsp;<span class="ident" id="6506938">err1</span>&nbsp;<span class="op" id="6506943">!=</span>&nbsp;<span class="ident" id="6506946">err</span>&nbsp;<span class="op" id="6506950">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6506954">t</span><span class="op" id="6506955">.</span><span class="ident" id="6506956">Errorf</span><span class="op" id="6506962">(</span><span class="string" id="6506963">&#34;from&nbsp;%q&nbsp;expected&nbsp;error&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="6506998">,</span>&nbsp;<span class="ident" id="6507000">s</span><span class="op" id="6507001">,</span>&nbsp;<span class="ident" id="6507003">err</span><span class="op" id="6507006">,</span>&nbsp;<span class="ident" id="6507008">err1</span><span class="op" id="6507012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507015">}</span><br>
<span class="lineno"></span><span class="op" id="6507017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6507020">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;survive&nbsp;bad&nbsp;data.</span><br>
<span class="lineno">200</span><span class="keyword" id="6507055">func</span>&nbsp;<span class="ident" id="6507060">TestBadData</span><span class="op" id="6507071">(</span><span class="ident" id="6507072">t</span>&nbsp;<span class="op" id="6507074">*</span><span class="ident" id="6507075">testing</span><span class="op" id="6507082">.</span><span class="ident" id="6507083">T</span><span class="op" id="6507084">)</span>&nbsp;<span class="op" id="6507086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507089">corruptDataCheck</span><span class="op" id="6507105">(</span><span class="string" id="6507106">&#34;&#34;</span><span class="op" id="6507108">,</span>&nbsp;<span class="ident" id="6507110">io</span><span class="op" id="6507112">.</span><span class="ident" id="6507113">EOF</span><span class="op" id="6507116">,</span>&nbsp;<span class="ident" id="6507118">t</span><span class="op" id="6507119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507122">corruptDataCheck</span><span class="op" id="6507138">(</span><span class="string" id="6507139">&#34;\x7Fhi&#34;</span><span class="op" id="6507147">,</span>&nbsp;<span class="ident" id="6507149">io</span><span class="op" id="6507151">.</span><span class="ident" id="6507152">ErrUnexpectedEOF</span><span class="op" id="6507168">,</span>&nbsp;<span class="ident" id="6507170">t</span><span class="op" id="6507171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507174">corruptDataCheck</span><span class="op" id="6507190">(</span><span class="string" id="6507191">&#34;\x03now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&#34;</span><span class="op" id="6507229">,</span>&nbsp;<span class="ident" id="6507231">errBadType</span><span class="op" id="6507241">,</span>&nbsp;<span class="ident" id="6507243">t</span><span class="op" id="6507244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6507247">//&nbsp;issue&nbsp;6323.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507263">corruptDataCheck</span><span class="op" id="6507279">(</span><span class="string" id="6507280">&#34;\x04\x24foo&#34;</span><span class="op" id="6507293">,</span>&nbsp;<span class="ident" id="6507295">errRange</span><span class="op" id="6507303">,</span>&nbsp;<span class="ident" id="6507305">t</span><span class="op" id="6507306">)</span><br>
<span class="lineno"></span><span class="op" id="6507308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6507311">//&nbsp;Types&nbsp;not&nbsp;supported&nbsp;at&nbsp;top&nbsp;level&nbsp;by&nbsp;the&nbsp;Encoder.</span><br>
<span class="lineno"></span><span class="keyword" id="6507363">var</span>&nbsp;<span class="ident" id="6507367">unsupportedValues</span>&nbsp;<span class="op" id="6507385">=</span>&nbsp;<span class="op" id="6507387">[</span><span class="op" id="6507388">]</span><span class="keyword" id="6507389">interface</span><span class="op" id="6507398">{</span><span class="op" id="6507399">}</span><span class="op" id="6507400">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6507403">make</span><span class="op" id="6507407">(</span><span class="keyword" id="6507408">chan</span>&nbsp;<span class="builtintype" id="6507413">int</span><span class="op" id="6507416">)</span><span class="op" id="6507417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507420">func</span><span class="op" id="6507424">(</span><span class="ident" id="6507425">a</span>&nbsp;<span class="builtintype" id="6507427">int</span><span class="op" id="6507430">)</span>&nbsp;<span class="builtintype" id="6507432">bool</span>&nbsp;<span class="op" id="6507437">{</span>&nbsp;<span class="keyword" id="6507439">return</span>&nbsp;<span class="builtintype" id="6507446">true</span>&nbsp;<span class="op" id="6507451">}</span><span class="op" id="6507452">,</span><br>
<span class="lineno"></span><span class="op" id="6507454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6507457">func</span>&nbsp;<span class="ident" id="6507462">TestUnsupported</span><span class="op" id="6507477">(</span><span class="ident" id="6507478">t</span>&nbsp;<span class="op" id="6507480">*</span><span class="ident" id="6507481">testing</span><span class="op" id="6507488">.</span><span class="ident" id="6507489">T</span><span class="op" id="6507490">)</span>&nbsp;<span class="op" id="6507492">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507495">var</span>&nbsp;<span class="ident" id="6507499">b</span>&nbsp;<span class="ident" id="6507501">bytes</span><span class="op" id="6507506">.</span><span class="ident" id="6507507">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507515">enc</span>&nbsp;<span class="op" id="6507519">:=</span>&nbsp;<span class="ident" id="6507522">NewEncoder</span><span class="op" id="6507532">(</span><span class="op" id="6507533">&amp;</span><span class="ident" id="6507534">b</span><span class="op" id="6507535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507538">for</span>&nbsp;<span class="ident" id="6507542">_</span><span class="op" id="6507543">,</span>&nbsp;<span class="ident" id="6507545">v</span>&nbsp;<span class="op" id="6507547">:=</span>&nbsp;<span class="keyword" id="6507550">range</span>&nbsp;<span class="ident" id="6507556">unsupportedValues</span>&nbsp;<span class="op" id="6507574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507578">err</span>&nbsp;<span class="op" id="6507582">:=</span>&nbsp;<span class="ident" id="6507585">enc</span><span class="op" id="6507588">.</span><span class="ident" id="6507589">Encode</span><span class="op" id="6507595">(</span><span class="ident" id="6507596">v</span><span class="op" id="6507597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507601">if</span>&nbsp;<span class="ident" id="6507604">err</span>&nbsp;<span class="op" id="6507608">==</span>&nbsp;<span class="builtintype" id="6507611">nil</span>&nbsp;<span class="op" id="6507615">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507620">t</span><span class="op" id="6507621">.</span><span class="ident" id="6507622">Errorf</span><span class="op" id="6507628">(</span><span class="string" id="6507629">&#34;expected&nbsp;error&nbsp;for&nbsp;%T;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6507662">,</span>&nbsp;<span class="ident" id="6507664">v</span><span class="op" id="6507665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507672">}</span><br>
<span class="lineno"></span><span class="op" id="6507674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="6507677">func</span>&nbsp;<span class="ident" id="6507682">encAndDec</span><span class="op" id="6507691">(</span><span class="ident" id="6507692">in</span><span class="op" id="6507694">,</span>&nbsp;<span class="ident" id="6507696">out</span>&nbsp;<span class="keyword" id="6507700">interface</span><span class="op" id="6507709">{</span><span class="op" id="6507710">}</span><span class="op" id="6507711">)</span>&nbsp;<span class="builtintype" id="6507713">error</span>&nbsp;<span class="op" id="6507719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507722">b</span>&nbsp;<span class="op" id="6507724">:=</span>&nbsp;<span class="builtinfunc" id="6507727">new</span><span class="op" id="6507730">(</span><span class="ident" id="6507731">bytes</span><span class="op" id="6507736">.</span><span class="ident" id="6507737">Buffer</span><span class="op" id="6507743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507746">enc</span>&nbsp;<span class="op" id="6507750">:=</span>&nbsp;<span class="ident" id="6507753">NewEncoder</span><span class="op" id="6507763">(</span><span class="ident" id="6507764">b</span><span class="op" id="6507765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507768">err</span>&nbsp;<span class="op" id="6507772">:=</span>&nbsp;<span class="ident" id="6507775">enc</span><span class="op" id="6507778">.</span><span class="ident" id="6507779">Encode</span><span class="op" id="6507785">(</span><span class="ident" id="6507786">in</span><span class="op" id="6507788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507791">if</span>&nbsp;<span class="ident" id="6507794">err</span>&nbsp;<span class="op" id="6507798">!=</span>&nbsp;<span class="builtintype" id="6507801">nil</span>&nbsp;<span class="op" id="6507805">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507809">return</span>&nbsp;<span class="ident" id="6507816">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507824">dec</span>&nbsp;<span class="op" id="6507828">:=</span>&nbsp;<span class="ident" id="6507831">NewDecoder</span><span class="op" id="6507841">(</span><span class="ident" id="6507842">b</span><span class="op" id="6507843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507846">err</span>&nbsp;<span class="op" id="6507850">=</span>&nbsp;<span class="ident" id="6507852">dec</span><span class="op" id="6507855">.</span><span class="ident" id="6507856">Decode</span><span class="op" id="6507862">(</span><span class="ident" id="6507863">out</span><span class="op" id="6507866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507869">if</span>&nbsp;<span class="ident" id="6507872">err</span>&nbsp;<span class="op" id="6507876">!=</span>&nbsp;<span class="builtintype" id="6507879">nil</span>&nbsp;<span class="op" id="6507883">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507887">return</span>&nbsp;<span class="ident" id="6507894">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507902">return</span>&nbsp;<span class="builtintype" id="6507909">nil</span><br>
<span class="lineno"></span><span class="op" id="6507913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="6507916">func</span>&nbsp;<span class="ident" id="6507921">TestTypeToPtrType</span><span class="op" id="6507938">(</span><span class="ident" id="6507939">t</span>&nbsp;<span class="op" id="6507941">*</span><span class="ident" id="6507942">testing</span><span class="op" id="6507949">.</span><span class="ident" id="6507950">T</span><span class="op" id="6507951">)</span>&nbsp;<span class="op" id="6507953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6507956">//&nbsp;Encode&nbsp;a&nbsp;T,&nbsp;decode&nbsp;a&nbsp;*T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507984">type</span>&nbsp;<span class="ident" id="6507989">Type0</span>&nbsp;<span class="keyword" id="6507995">struct</span>&nbsp;<span class="op" id="6508002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508006">A</span>&nbsp;<span class="builtintype" id="6508008">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508013">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508016">t0</span>&nbsp;<span class="op" id="6508019">:=</span>&nbsp;<span class="ident" id="6508022">Type0</span><span class="op" id="6508027">{</span><span class="num" id="6508028">7</span><span class="op" id="6508029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508032">t0p</span>&nbsp;<span class="op" id="6508036">:=</span>&nbsp;<span class="builtinfunc" id="6508039">new</span><span class="op" id="6508042">(</span><span class="ident" id="6508043">Type0</span><span class="op" id="6508048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508051">if</span>&nbsp;<span class="ident" id="6508054">err</span>&nbsp;<span class="op" id="6508058">:=</span>&nbsp;<span class="ident" id="6508061">encAndDec</span><span class="op" id="6508070">(</span><span class="ident" id="6508071">t0</span><span class="op" id="6508073">,</span>&nbsp;<span class="ident" id="6508075">t0p</span><span class="op" id="6508078">)</span><span class="op" id="6508079">;</span>&nbsp;<span class="ident" id="6508081">err</span>&nbsp;<span class="op" id="6508085">!=</span>&nbsp;<span class="builtintype" id="6508088">nil</span>&nbsp;<span class="op" id="6508092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508096">t</span><span class="op" id="6508097">.</span><span class="ident" id="6508098">Error</span><span class="op" id="6508103">(</span><span class="ident" id="6508104">err</span><span class="op" id="6508107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508110">}</span><br>
<span class="lineno">250</span><span class="op" id="6508112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6508115">func</span>&nbsp;<span class="ident" id="6508120">TestPtrTypeToType</span><span class="op" id="6508137">(</span><span class="ident" id="6508138">t</span>&nbsp;<span class="op" id="6508140">*</span><span class="ident" id="6508141">testing</span><span class="op" id="6508148">.</span><span class="ident" id="6508149">T</span><span class="op" id="6508150">)</span>&nbsp;<span class="op" id="6508152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6508155">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508183">type</span>&nbsp;<span class="ident" id="6508188">Type1</span>&nbsp;<span class="keyword" id="6508194">struct</span>&nbsp;<span class="op" id="6508201">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508205">A</span>&nbsp;<span class="builtintype" id="6508207">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508216">t1p</span>&nbsp;<span class="op" id="6508220">:=</span>&nbsp;<span class="op" id="6508223">&amp;</span><span class="ident" id="6508224">Type1</span><span class="op" id="6508229">{</span><span class="num" id="6508230">17</span><span class="op" id="6508232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508235">var</span>&nbsp;<span class="ident" id="6508239">t1</span>&nbsp;<span class="ident" id="6508242">Type1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508249">if</span>&nbsp;<span class="ident" id="6508252">err</span>&nbsp;<span class="op" id="6508256">:=</span>&nbsp;<span class="ident" id="6508259">encAndDec</span><span class="op" id="6508268">(</span><span class="ident" id="6508269">t1</span><span class="op" id="6508271">,</span>&nbsp;<span class="ident" id="6508273">t1p</span><span class="op" id="6508276">)</span><span class="op" id="6508277">;</span>&nbsp;<span class="ident" id="6508279">err</span>&nbsp;<span class="op" id="6508283">!=</span>&nbsp;<span class="builtintype" id="6508286">nil</span>&nbsp;<span class="op" id="6508290">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508294">t</span><span class="op" id="6508295">.</span><span class="ident" id="6508296">Error</span><span class="op" id="6508301">(</span><span class="ident" id="6508302">err</span><span class="op" id="6508305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508308">}</span><br>
<span class="lineno"></span><span class="op" id="6508310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6508313">func</span>&nbsp;<span class="ident" id="6508318">TestTypeToPtrPtrPtrPtrType</span><span class="op" id="6508344">(</span><span class="ident" id="6508345">t</span>&nbsp;<span class="op" id="6508347">*</span><span class="ident" id="6508348">testing</span><span class="op" id="6508355">.</span><span class="ident" id="6508356">T</span><span class="op" id="6508357">)</span>&nbsp;<span class="op" id="6508359">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508362">type</span>&nbsp;<span class="ident" id="6508367">Type2</span>&nbsp;<span class="keyword" id="6508373">struct</span>&nbsp;<span class="op" id="6508380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508384">A</span>&nbsp;<span class="op" id="6508386">*</span><span class="op" id="6508387">*</span><span class="op" id="6508388">*</span><span class="op" id="6508389">*</span><span class="builtintype" id="6508390">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508402">t2</span>&nbsp;<span class="op" id="6508405">:=</span>&nbsp;<span class="ident" id="6508408">Type2</span><span class="op" id="6508413">{</span><span class="op" id="6508414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508417">t2</span><span class="op" id="6508419">.</span><span class="ident" id="6508420">A</span>&nbsp;<span class="op" id="6508422">=</span>&nbsp;<span class="builtinfunc" id="6508424">new</span><span class="op" id="6508427">(</span><span class="op" id="6508428">*</span><span class="op" id="6508429">*</span><span class="op" id="6508430">*</span><span class="builtintype" id="6508431">float64</span><span class="op" id="6508438">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508441">*</span><span class="ident" id="6508442">t2</span><span class="op" id="6508444">.</span><span class="ident" id="6508445">A</span>&nbsp;<span class="op" id="6508447">=</span>&nbsp;<span class="builtinfunc" id="6508449">new</span><span class="op" id="6508452">(</span><span class="op" id="6508453">*</span><span class="op" id="6508454">*</span><span class="builtintype" id="6508455">float64</span><span class="op" id="6508462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508465">*</span><span class="op" id="6508466">*</span><span class="ident" id="6508467">t2</span><span class="op" id="6508469">.</span><span class="ident" id="6508470">A</span>&nbsp;<span class="op" id="6508472">=</span>&nbsp;<span class="builtinfunc" id="6508474">new</span><span class="op" id="6508477">(</span><span class="op" id="6508478">*</span><span class="builtintype" id="6508479">float64</span><span class="op" id="6508486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508489">*</span><span class="op" id="6508490">*</span><span class="op" id="6508491">*</span><span class="ident" id="6508492">t2</span><span class="op" id="6508494">.</span><span class="ident" id="6508495">A</span>&nbsp;<span class="op" id="6508497">=</span>&nbsp;<span class="builtinfunc" id="6508499">new</span><span class="op" id="6508502">(</span><span class="builtintype" id="6508503">float64</span><span class="op" id="6508510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508513">*</span><span class="op" id="6508514">*</span><span class="op" id="6508515">*</span><span class="op" id="6508516">*</span><span class="ident" id="6508517">t2</span><span class="op" id="6508519">.</span><span class="ident" id="6508520">A</span>&nbsp;<span class="op" id="6508522">=</span>&nbsp;<span class="num" id="6508524">27.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508530">t2pppp</span>&nbsp;<span class="op" id="6508537">:=</span>&nbsp;<span class="builtinfunc" id="6508540">new</span><span class="op" id="6508543">(</span><span class="op" id="6508544">*</span><span class="op" id="6508545">*</span><span class="op" id="6508546">*</span><span class="ident" id="6508547">Type2</span><span class="op" id="6508552">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508555">if</span>&nbsp;<span class="ident" id="6508558">err</span>&nbsp;<span class="op" id="6508562">:=</span>&nbsp;<span class="ident" id="6508565">encAndDec</span><span class="op" id="6508574">(</span><span class="ident" id="6508575">t2</span><span class="op" id="6508577">,</span>&nbsp;<span class="ident" id="6508579">t2pppp</span><span class="op" id="6508585">)</span><span class="op" id="6508586">;</span>&nbsp;<span class="ident" id="6508588">err</span>&nbsp;<span class="op" id="6508592">!=</span>&nbsp;<span class="builtintype" id="6508595">nil</span>&nbsp;<span class="op" id="6508599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508603">t</span><span class="op" id="6508604">.</span><span class="ident" id="6508605">Fatal</span><span class="op" id="6508610">(</span><span class="ident" id="6508611">err</span><span class="op" id="6508614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508620">if</span>&nbsp;<span class="op" id="6508623">*</span><span class="op" id="6508624">*</span><span class="op" id="6508625">*</span><span class="op" id="6508626">*</span><span class="op" id="6508627">(</span><span class="op" id="6508628">*</span><span class="op" id="6508629">*</span><span class="op" id="6508630">*</span><span class="op" id="6508631">*</span><span class="ident" id="6508632">t2pppp</span><span class="op" id="6508638">)</span><span class="op" id="6508639">.</span><span class="ident" id="6508640">A</span>&nbsp;<span class="op" id="6508642">!=</span>&nbsp;<span class="op" id="6508645">*</span><span class="op" id="6508646">*</span><span class="op" id="6508647">*</span><span class="op" id="6508648">*</span><span class="ident" id="6508649">t2</span><span class="op" id="6508651">.</span><span class="ident" id="6508652">A</span>&nbsp;<span class="op" id="6508654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508658">t</span><span class="op" id="6508659">.</span><span class="ident" id="6508660">Errorf</span><span class="op" id="6508666">(</span><span class="string" id="6508667">&#34;wrong&nbsp;value&nbsp;after&nbsp;decode:&nbsp;%g&nbsp;not&nbsp;%g&#34;</span><span class="op" id="6508704">,</span>&nbsp;<span class="op" id="6508706">*</span><span class="op" id="6508707">*</span><span class="op" id="6508708">*</span><span class="op" id="6508709">*</span><span class="op" id="6508710">(</span><span class="op" id="6508711">*</span><span class="op" id="6508712">*</span><span class="op" id="6508713">*</span><span class="op" id="6508714">*</span><span class="ident" id="6508715">t2pppp</span><span class="op" id="6508721">)</span><span class="op" id="6508722">.</span><span class="ident" id="6508723">A</span><span class="op" id="6508724">,</span>&nbsp;<span class="op" id="6508726">*</span><span class="op" id="6508727">*</span><span class="op" id="6508728">*</span><span class="op" id="6508729">*</span><span class="ident" id="6508730">t2</span><span class="op" id="6508732">.</span><span class="ident" id="6508733">A</span><span class="op" id="6508734">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508737">}</span><br>
<span class="lineno"></span><span class="op" id="6508739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6508742">func</span>&nbsp;<span class="ident" id="6508747">TestSlice</span><span class="op" id="6508756">(</span><span class="ident" id="6508757">t</span>&nbsp;<span class="op" id="6508759">*</span><span class="ident" id="6508760">testing</span><span class="op" id="6508767">.</span><span class="ident" id="6508768">T</span><span class="op" id="6508769">)</span>&nbsp;<span class="op" id="6508771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508774">type</span>&nbsp;<span class="ident" id="6508779">Type3</span>&nbsp;<span class="keyword" id="6508785">struct</span>&nbsp;<span class="op" id="6508792">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508796">A</span>&nbsp;<span class="op" id="6508798">[</span><span class="op" id="6508799">]</span><span class="builtintype" id="6508800">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508811">t3p</span>&nbsp;<span class="op" id="6508815">:=</span>&nbsp;<span class="op" id="6508818">&amp;</span><span class="ident" id="6508819">Type3</span><span class="op" id="6508824">{</span><span class="op" id="6508825">[</span><span class="op" id="6508826">]</span><span class="builtintype" id="6508827">string</span><span class="op" id="6508833">{</span><span class="string" id="6508834">&#34;hello&#34;</span><span class="op" id="6508841">,</span>&nbsp;<span class="string" id="6508843">&#34;world&#34;</span><span class="op" id="6508850">}</span><span class="op" id="6508851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508854">var</span>&nbsp;<span class="ident" id="6508858">t3</span>&nbsp;<span class="ident" id="6508861">Type3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508868">if</span>&nbsp;<span class="ident" id="6508871">err</span>&nbsp;<span class="op" id="6508875">:=</span>&nbsp;<span class="ident" id="6508878">encAndDec</span><span class="op" id="6508887">(</span><span class="ident" id="6508888">t3</span><span class="op" id="6508890">,</span>&nbsp;<span class="ident" id="6508892">t3p</span><span class="op" id="6508895">)</span><span class="op" id="6508896">;</span>&nbsp;<span class="ident" id="6508898">err</span>&nbsp;<span class="op" id="6508902">!=</span>&nbsp;<span class="builtintype" id="6508905">nil</span>&nbsp;<span class="op" id="6508909">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508913">t</span><span class="op" id="6508914">.</span><span class="ident" id="6508915">Error</span><span class="op" id="6508920">(</span><span class="ident" id="6508921">err</span><span class="op" id="6508924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508927">}</span><br>
<span class="lineno"></span><span class="op" id="6508929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6508932">func</span>&nbsp;<span class="ident" id="6508937">TestValueError</span><span class="op" id="6508951">(</span><span class="ident" id="6508952">t</span>&nbsp;<span class="op" id="6508954">*</span><span class="ident" id="6508955">testing</span><span class="op" id="6508962">.</span><span class="ident" id="6508963">T</span><span class="op" id="6508964">)</span>&nbsp;<span class="op" id="6508966">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6508969">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508997">type</span>&nbsp;<span class="ident" id="6509002">Type4</span>&nbsp;<span class="keyword" id="6509008">struct</span>&nbsp;<span class="op" id="6509015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509019">A</span>&nbsp;<span class="builtintype" id="6509021">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509029">t4p</span>&nbsp;<span class="op" id="6509033">:=</span>&nbsp;<span class="op" id="6509036">&amp;</span><span class="ident" id="6509037">Type4</span><span class="op" id="6509042">{</span><span class="num" id="6509043">3</span><span class="op" id="6509044">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509047">var</span>&nbsp;<span class="ident" id="6509051">t4</span>&nbsp;<span class="ident" id="6509054">Type4</span>&nbsp;<span class="comment" id="6509060">//&nbsp;note:&nbsp;not&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509085">if</span>&nbsp;<span class="ident" id="6509088">err</span>&nbsp;<span class="op" id="6509092">:=</span>&nbsp;<span class="ident" id="6509095">encAndDec</span><span class="op" id="6509104">(</span><span class="ident" id="6509105">t4p</span><span class="op" id="6509108">,</span>&nbsp;<span class="ident" id="6509110">t4</span><span class="op" id="6509112">)</span><span class="op" id="6509113">;</span>&nbsp;<span class="ident" id="6509115">err</span>&nbsp;<span class="op" id="6509119">==</span>&nbsp;<span class="builtintype" id="6509122">nil</span>&nbsp;<span class="op" id="6509126">||</span>&nbsp;<span class="ident" id="6509129">strings</span><span class="op" id="6509136">.</span><span class="ident" id="6509137">Index</span><span class="op" id="6509142">(</span><span class="ident" id="6509143">err</span><span class="op" id="6509146">.</span><span class="ident" id="6509147">Error</span><span class="op" id="6509152">(</span><span class="op" id="6509153">)</span><span class="op" id="6509154">,</span>&nbsp;<span class="string" id="6509156">&#34;pointer&#34;</span><span class="op" id="6509165">)</span>&nbsp;<span class="op" id="6509167">&lt;</span>&nbsp;<span class="num" id="6509169">0</span>&nbsp;<span class="op" id="6509171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509175">t</span><span class="op" id="6509176">.</span><span class="ident" id="6509177">Error</span><span class="op" id="6509182">(</span><span class="string" id="6509183">&#34;expected&nbsp;error&nbsp;about&nbsp;pointer;&nbsp;got&#34;</span><span class="op" id="6509218">,</span>&nbsp;<span class="ident" id="6509220">err</span><span class="op" id="6509223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509226">}</span><br>
<span class="lineno"></span><span class="op" id="6509228">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="6509231">func</span>&nbsp;<span class="ident" id="6509236">TestArray</span><span class="op" id="6509245">(</span><span class="ident" id="6509246">t</span>&nbsp;<span class="op" id="6509248">*</span><span class="ident" id="6509249">testing</span><span class="op" id="6509256">.</span><span class="ident" id="6509257">T</span><span class="op" id="6509258">)</span>&nbsp;<span class="op" id="6509260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509263">type</span>&nbsp;<span class="ident" id="6509268">Type5</span>&nbsp;<span class="keyword" id="6509274">struct</span>&nbsp;<span class="op" id="6509281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509285">A</span>&nbsp;<span class="op" id="6509287">[</span><span class="num" id="6509288">3</span><span class="op" id="6509289">]</span><span class="builtintype" id="6509290">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509299">B</span>&nbsp;<span class="op" id="6509301">[</span><span class="num" id="6509302">3</span><span class="op" id="6509303">]</span><span class="builtintype" id="6509304">byte</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509313">type</span>&nbsp;<span class="ident" id="6509318">Type6</span>&nbsp;<span class="keyword" id="6509324">struct</span>&nbsp;<span class="op" id="6509331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509335">A</span>&nbsp;<span class="op" id="6509337">[</span><span class="num" id="6509338">2</span><span class="op" id="6509339">]</span><span class="builtintype" id="6509340">string</span>&nbsp;<span class="comment" id="6509347">//&nbsp;can&#39;t&nbsp;hold&nbsp;t5.a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509370">t5</span>&nbsp;<span class="op" id="6509373">:=</span>&nbsp;<span class="ident" id="6509376">Type5</span><span class="op" id="6509381">{</span><span class="op" id="6509382">[</span><span class="num" id="6509383">3</span><span class="op" id="6509384">]</span><span class="builtintype" id="6509385">string</span><span class="op" id="6509391">{</span><span class="string" id="6509392">&#34;hello&#34;</span><span class="op" id="6509399">,</span>&nbsp;<span class="string" id="6509401">&#34;,&#34;</span><span class="op" id="6509404">,</span>&nbsp;<span class="string" id="6509406">&#34;world&#34;</span><span class="op" id="6509413">}</span><span class="op" id="6509414">,</span>&nbsp;<span class="op" id="6509416">[</span><span class="num" id="6509417">3</span><span class="op" id="6509418">]</span><span class="builtintype" id="6509419">byte</span><span class="op" id="6509423">{</span><span class="num" id="6509424">1</span><span class="op" id="6509425">,</span>&nbsp;<span class="num" id="6509427">2</span><span class="op" id="6509428">,</span>&nbsp;<span class="num" id="6509430">3</span><span class="op" id="6509431">}</span><span class="op" id="6509432">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509435">var</span>&nbsp;<span class="ident" id="6509439">t5p</span>&nbsp;<span class="ident" id="6509443">Type5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509450">if</span>&nbsp;<span class="ident" id="6509453">err</span>&nbsp;<span class="op" id="6509457">:=</span>&nbsp;<span class="ident" id="6509460">encAndDec</span><span class="op" id="6509469">(</span><span class="ident" id="6509470">t5</span><span class="op" id="6509472">,</span>&nbsp;<span class="op" id="6509474">&amp;</span><span class="ident" id="6509475">t5p</span><span class="op" id="6509478">)</span><span class="op" id="6509479">;</span>&nbsp;<span class="ident" id="6509481">err</span>&nbsp;<span class="op" id="6509485">!=</span>&nbsp;<span class="builtintype" id="6509488">nil</span>&nbsp;<span class="op" id="6509492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509496">t</span><span class="op" id="6509497">.</span><span class="ident" id="6509498">Error</span><span class="op" id="6509503">(</span><span class="ident" id="6509504">err</span><span class="op" id="6509507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509513">var</span>&nbsp;<span class="ident" id="6509517">t6</span>&nbsp;<span class="ident" id="6509520">Type6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509527">if</span>&nbsp;<span class="ident" id="6509530">err</span>&nbsp;<span class="op" id="6509534">:=</span>&nbsp;<span class="ident" id="6509537">encAndDec</span><span class="op" id="6509546">(</span><span class="ident" id="6509547">t5</span><span class="op" id="6509549">,</span>&nbsp;<span class="op" id="6509551">&amp;</span><span class="ident" id="6509552">t6</span><span class="op" id="6509554">)</span><span class="op" id="6509555">;</span>&nbsp;<span class="ident" id="6509557">err</span>&nbsp;<span class="op" id="6509561">==</span>&nbsp;<span class="builtintype" id="6509564">nil</span>&nbsp;<span class="op" id="6509568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509572">t</span><span class="op" id="6509573">.</span><span class="ident" id="6509574">Error</span><span class="op" id="6509579">(</span><span class="string" id="6509580">&#34;should&nbsp;fail&nbsp;with&nbsp;mismatched&nbsp;array&nbsp;sizes&#34;</span><span class="op" id="6509621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509624">}</span><br>
<span class="lineno"></span><span class="op" id="6509626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="6509629">func</span>&nbsp;<span class="ident" id="6509634">TestRecursiveMapType</span><span class="op" id="6509654">(</span><span class="ident" id="6509655">t</span>&nbsp;<span class="op" id="6509657">*</span><span class="ident" id="6509658">testing</span><span class="op" id="6509665">.</span><span class="ident" id="6509666">T</span><span class="op" id="6509667">)</span>&nbsp;<span class="op" id="6509669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509672">type</span>&nbsp;<span class="ident" id="6509677">recursiveMap</span>&nbsp;<span class="keyword" id="6509690">map</span><span class="op" id="6509693">[</span><span class="builtintype" id="6509694">string</span><span class="op" id="6509700">]</span><span class="ident" id="6509701">recursiveMap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509715">r1</span>&nbsp;<span class="op" id="6509718">:=</span>&nbsp;<span class="ident" id="6509721">recursiveMap</span><span class="op" id="6509733">{</span><span class="string" id="6509734">&#34;A&#34;</span><span class="op" id="6509737">:</span>&nbsp;<span class="ident" id="6509739">recursiveMap</span><span class="op" id="6509751">{</span><span class="string" id="6509752">&#34;B&#34;</span><span class="op" id="6509755">:</span>&nbsp;<span class="builtintype" id="6509757">nil</span><span class="op" id="6509760">,</span>&nbsp;<span class="string" id="6509762">&#34;C&#34;</span><span class="op" id="6509765">:</span>&nbsp;<span class="builtintype" id="6509767">nil</span><span class="op" id="6509770">}</span><span class="op" id="6509771">,</span>&nbsp;<span class="string" id="6509773">&#34;D&#34;</span><span class="op" id="6509776">:</span>&nbsp;<span class="builtintype" id="6509778">nil</span><span class="op" id="6509781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509784">r2</span>&nbsp;<span class="op" id="6509787">:=</span>&nbsp;<span class="builtinfunc" id="6509790">make</span><span class="op" id="6509794">(</span><span class="ident" id="6509795">recursiveMap</span><span class="op" id="6509807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509810">if</span>&nbsp;<span class="ident" id="6509813">err</span>&nbsp;<span class="op" id="6509817">:=</span>&nbsp;<span class="ident" id="6509820">encAndDec</span><span class="op" id="6509829">(</span><span class="ident" id="6509830">r1</span><span class="op" id="6509832">,</span>&nbsp;<span class="op" id="6509834">&amp;</span><span class="ident" id="6509835">r2</span><span class="op" id="6509837">)</span><span class="op" id="6509838">;</span>&nbsp;<span class="ident" id="6509840">err</span>&nbsp;<span class="op" id="6509844">!=</span>&nbsp;<span class="builtintype" id="6509847">nil</span>&nbsp;<span class="op" id="6509851">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509855">t</span><span class="op" id="6509856">.</span><span class="ident" id="6509857">Error</span><span class="op" id="6509862">(</span><span class="ident" id="6509863">err</span><span class="op" id="6509866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509869">}</span><br>
<span class="lineno"></span><span class="op" id="6509871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6509874">func</span>&nbsp;<span class="ident" id="6509879">TestRecursiveSliceType</span><span class="op" id="6509901">(</span><span class="ident" id="6509902">t</span>&nbsp;<span class="op" id="6509904">*</span><span class="ident" id="6509905">testing</span><span class="op" id="6509912">.</span><span class="ident" id="6509913">T</span><span class="op" id="6509914">)</span>&nbsp;<span class="op" id="6509916">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509919">type</span>&nbsp;<span class="ident" id="6509924">recursiveSlice</span>&nbsp;<span class="op" id="6509939">[</span><span class="op" id="6509940">]</span><span class="ident" id="6509941">recursiveSlice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509957">r1</span>&nbsp;<span class="op" id="6509960">:=</span>&nbsp;<span class="ident" id="6509963">recursiveSlice</span><span class="op" id="6509977">{</span><span class="num" id="6509978">0</span><span class="op" id="6509979">:</span>&nbsp;<span class="ident" id="6509981">recursiveSlice</span><span class="op" id="6509995">{</span><span class="num" id="6509996">0</span><span class="op" id="6509997">:</span>&nbsp;<span class="builtintype" id="6509999">nil</span><span class="op" id="6510002">}</span><span class="op" id="6510003">,</span>&nbsp;<span class="num" id="6510005">1</span><span class="op" id="6510006">:</span>&nbsp;<span class="builtintype" id="6510008">nil</span><span class="op" id="6510011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510014">r2</span>&nbsp;<span class="op" id="6510017">:=</span>&nbsp;<span class="builtinfunc" id="6510020">make</span><span class="op" id="6510024">(</span><span class="ident" id="6510025">recursiveSlice</span><span class="op" id="6510039">,</span>&nbsp;<span class="num" id="6510041">0</span><span class="op" id="6510042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510045">if</span>&nbsp;<span class="ident" id="6510048">err</span>&nbsp;<span class="op" id="6510052">:=</span>&nbsp;<span class="ident" id="6510055">encAndDec</span><span class="op" id="6510064">(</span><span class="ident" id="6510065">r1</span><span class="op" id="6510067">,</span>&nbsp;<span class="op" id="6510069">&amp;</span><span class="ident" id="6510070">r2</span><span class="op" id="6510072">)</span><span class="op" id="6510073">;</span>&nbsp;<span class="ident" id="6510075">err</span>&nbsp;<span class="op" id="6510079">!=</span>&nbsp;<span class="builtintype" id="6510082">nil</span>&nbsp;<span class="op" id="6510086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510090">t</span><span class="op" id="6510091">.</span><span class="ident" id="6510092">Error</span><span class="op" id="6510097">(</span><span class="ident" id="6510098">err</span><span class="op" id="6510101">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510104">}</span><br>
<span class="lineno"></span><span class="op" id="6510106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6510109">//&nbsp;Regression&nbsp;test&nbsp;for&nbsp;bug:&nbsp;must&nbsp;send&nbsp;zero&nbsp;values&nbsp;inside&nbsp;arrays</span><br>
<span class="lineno"></span><span class="keyword" id="6510173">func</span>&nbsp;<span class="ident" id="6510178">TestDefaultsInArray</span><span class="op" id="6510197">(</span><span class="ident" id="6510198">t</span>&nbsp;<span class="op" id="6510200">*</span><span class="ident" id="6510201">testing</span><span class="op" id="6510208">.</span><span class="ident" id="6510209">T</span><span class="op" id="6510210">)</span>&nbsp;<span class="op" id="6510212">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510215">type</span>&nbsp;<span class="ident" id="6510220">Type7</span>&nbsp;<span class="keyword" id="6510226">struct</span>&nbsp;<span class="op" id="6510233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510237">B</span>&nbsp;<span class="op" id="6510239">[</span><span class="op" id="6510240">]</span><span class="builtintype" id="6510241">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510248">I</span>&nbsp;<span class="op" id="6510250">[</span><span class="op" id="6510251">]</span><span class="builtintype" id="6510252">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510258">S</span>&nbsp;<span class="op" id="6510260">[</span><span class="op" id="6510261">]</span><span class="builtintype" id="6510262">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510271">F</span>&nbsp;<span class="op" id="6510273">[</span><span class="op" id="6510274">]</span><span class="builtintype" id="6510275">float64</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510287">t7</span>&nbsp;<span class="op" id="6510290">:=</span>&nbsp;<span class="ident" id="6510293">Type7</span><span class="op" id="6510298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510302">[</span><span class="op" id="6510303">]</span><span class="builtintype" id="6510304">bool</span><span class="op" id="6510308">{</span><span class="builtintype" id="6510309">false</span><span class="op" id="6510314">,</span>&nbsp;<span class="builtintype" id="6510316">false</span><span class="op" id="6510321">,</span>&nbsp;<span class="builtintype" id="6510323">true</span><span class="op" id="6510327">}</span><span class="op" id="6510328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510332">[</span><span class="op" id="6510333">]</span><span class="builtintype" id="6510334">int</span><span class="op" id="6510337">{</span><span class="num" id="6510338">0</span><span class="op" id="6510339">,</span>&nbsp;<span class="num" id="6510341">0</span><span class="op" id="6510342">,</span>&nbsp;<span class="num" id="6510344">1</span><span class="op" id="6510345">}</span><span class="op" id="6510346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510350">[</span><span class="op" id="6510351">]</span><span class="builtintype" id="6510352">string</span><span class="op" id="6510358">{</span><span class="string" id="6510359">&#34;hi&#34;</span><span class="op" id="6510363">,</span>&nbsp;<span class="string" id="6510365">&#34;&#34;</span><span class="op" id="6510367">,</span>&nbsp;<span class="string" id="6510369">&#34;there&#34;</span><span class="op" id="6510376">}</span><span class="op" id="6510377">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510381">[</span><span class="op" id="6510382">]</span><span class="builtintype" id="6510383">float64</span><span class="op" id="6510390">{</span><span class="num" id="6510391">0</span><span class="op" id="6510392">,</span>&nbsp;<span class="num" id="6510394">0</span><span class="op" id="6510395">,</span>&nbsp;<span class="num" id="6510397">1</span><span class="op" id="6510398">}</span><span class="op" id="6510399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510405">var</span>&nbsp;<span class="ident" id="6510409">t7p</span>&nbsp;<span class="ident" id="6510413">Type7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510420">if</span>&nbsp;<span class="ident" id="6510423">err</span>&nbsp;<span class="op" id="6510427">:=</span>&nbsp;<span class="ident" id="6510430">encAndDec</span><span class="op" id="6510439">(</span><span class="ident" id="6510440">t7</span><span class="op" id="6510442">,</span>&nbsp;<span class="op" id="6510444">&amp;</span><span class="ident" id="6510445">t7p</span><span class="op" id="6510448">)</span><span class="op" id="6510449">;</span>&nbsp;<span class="ident" id="6510451">err</span>&nbsp;<span class="op" id="6510455">!=</span>&nbsp;<span class="builtintype" id="6510458">nil</span>&nbsp;<span class="op" id="6510462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510466">t</span><span class="op" id="6510467">.</span><span class="ident" id="6510468">Error</span><span class="op" id="6510473">(</span><span class="ident" id="6510474">err</span><span class="op" id="6510477">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510480">}</span><br>
<span class="lineno"></span><span class="op" id="6510482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6510485">var</span>&nbsp;<span class="ident" id="6510489">testInt</span>&nbsp;<span class="builtintype" id="6510497">int</span><br>
<span class="lineno"></span><span class="keyword" id="6510501">var</span>&nbsp;<span class="ident" id="6510505">testFloat32</span>&nbsp;<span class="builtintype" id="6510517">float32</span><br>
<span class="lineno">365</span><span class="keyword" id="6510525">var</span>&nbsp;<span class="ident" id="6510529">testString</span>&nbsp;<span class="builtintype" id="6510540">string</span><br>
<span class="lineno"></span><span class="keyword" id="6510547">var</span>&nbsp;<span class="ident" id="6510551">testSlice</span>&nbsp;<span class="op" id="6510561">[</span><span class="op" id="6510562">]</span><span class="builtintype" id="6510563">string</span><br>
<span class="lineno"></span><span class="keyword" id="6510570">var</span>&nbsp;<span class="ident" id="6510574">testMap</span>&nbsp;<span class="keyword" id="6510582">map</span><span class="op" id="6510585">[</span><span class="builtintype" id="6510586">string</span><span class="op" id="6510592">]</span><span class="builtintype" id="6510593">int</span><br>
<span class="lineno"></span><span class="keyword" id="6510597">var</span>&nbsp;<span class="ident" id="6510601">testArray</span>&nbsp;<span class="op" id="6510611">[</span><span class="num" id="6510612">7</span><span class="op" id="6510613">]</span><span class="builtintype" id="6510614">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="6510619">type</span>&nbsp;<span class="ident" id="6510624">SingleTest</span>&nbsp;<span class="keyword" id="6510635">struct</span>&nbsp;<span class="op" id="6510642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510645">in</span>&nbsp;&nbsp;<span class="keyword" id="6510649">interface</span><span class="op" id="6510658">{</span><span class="op" id="6510659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510662">out</span>&nbsp;<span class="keyword" id="6510666">interface</span><span class="op" id="6510675">{</span><span class="op" id="6510676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510679">err</span>&nbsp;<span class="builtintype" id="6510683">string</span><br>
<span class="lineno"></span><span class="op" id="6510690">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6510693">var</span>&nbsp;<span class="ident" id="6510697">singleTests</span>&nbsp;<span class="op" id="6510709">=</span>&nbsp;<span class="op" id="6510711">[</span><span class="op" id="6510712">]</span><span class="ident" id="6510713">SingleTest</span><span class="op" id="6510723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510726">{</span><span class="num" id="6510727">17</span><span class="op" id="6510729">,</span>&nbsp;<span class="op" id="6510731">&amp;</span><span class="ident" id="6510732">testInt</span><span class="op" id="6510739">,</span>&nbsp;<span class="string" id="6510741">&#34;&#34;</span><span class="op" id="6510743">}</span><span class="op" id="6510744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510747">{</span><span class="builtintype" id="6510748">float32</span><span class="op" id="6510755">(</span><span class="num" id="6510756">17.5</span><span class="op" id="6510760">)</span><span class="op" id="6510761">,</span>&nbsp;<span class="op" id="6510763">&amp;</span><span class="ident" id="6510764">testFloat32</span><span class="op" id="6510775">,</span>&nbsp;<span class="string" id="6510777">&#34;&#34;</span><span class="op" id="6510779">}</span><span class="op" id="6510780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510783">{</span><span class="string" id="6510784">&#34;bike&nbsp;shed&#34;</span><span class="op" id="6510795">,</span>&nbsp;<span class="op" id="6510797">&amp;</span><span class="ident" id="6510798">testString</span><span class="op" id="6510808">,</span>&nbsp;<span class="string" id="6510810">&#34;&#34;</span><span class="op" id="6510812">}</span><span class="op" id="6510813">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510816">{</span><span class="op" id="6510817">[</span><span class="op" id="6510818">]</span><span class="builtintype" id="6510819">string</span><span class="op" id="6510825">{</span><span class="string" id="6510826">&#34;bike&#34;</span><span class="op" id="6510832">,</span>&nbsp;<span class="string" id="6510834">&#34;shed&#34;</span><span class="op" id="6510840">,</span>&nbsp;<span class="string" id="6510842">&#34;paint&#34;</span><span class="op" id="6510849">,</span>&nbsp;<span class="string" id="6510851">&#34;color&#34;</span><span class="op" id="6510858">}</span><span class="op" id="6510859">,</span>&nbsp;<span class="op" id="6510861">&amp;</span><span class="ident" id="6510862">testSlice</span><span class="op" id="6510871">,</span>&nbsp;<span class="string" id="6510873">&#34;&#34;</span><span class="op" id="6510875">}</span><span class="op" id="6510876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510879">{</span><span class="keyword" id="6510880">map</span><span class="op" id="6510883">[</span><span class="builtintype" id="6510884">string</span><span class="op" id="6510890">]</span><span class="builtintype" id="6510891">int</span><span class="op" id="6510894">{</span><span class="string" id="6510895">&#34;seven&#34;</span><span class="op" id="6510902">:</span>&nbsp;<span class="num" id="6510904">7</span><span class="op" id="6510905">,</span>&nbsp;<span class="string" id="6510907">&#34;twelve&#34;</span><span class="op" id="6510915">:</span>&nbsp;<span class="num" id="6510917">12</span><span class="op" id="6510919">}</span><span class="op" id="6510920">,</span>&nbsp;<span class="op" id="6510922">&amp;</span><span class="ident" id="6510923">testMap</span><span class="op" id="6510930">,</span>&nbsp;<span class="string" id="6510932">&#34;&#34;</span><span class="op" id="6510934">}</span><span class="op" id="6510935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510938">{</span><span class="op" id="6510939">[</span><span class="num" id="6510940">7</span><span class="op" id="6510941">]</span><span class="builtintype" id="6510942">int</span><span class="op" id="6510945">{</span><span class="num" id="6510946">4</span><span class="op" id="6510947">,</span>&nbsp;<span class="num" id="6510949">55</span><span class="op" id="6510951">,</span>&nbsp;<span class="num" id="6510953">0</span><span class="op" id="6510954">,</span>&nbsp;<span class="num" id="6510956">0</span><span class="op" id="6510957">,</span>&nbsp;<span class="num" id="6510959">0</span><span class="op" id="6510960">,</span>&nbsp;<span class="num" id="6510962">0</span><span class="op" id="6510963">,</span>&nbsp;<span class="num" id="6510965">0</span><span class="op" id="6510966">}</span><span class="op" id="6510967">,</span>&nbsp;<span class="op" id="6510969">&amp;</span><span class="ident" id="6510970">testArray</span><span class="op" id="6510979">,</span>&nbsp;<span class="string" id="6510981">&#34;&#34;</span><span class="op" id="6510983">}</span><span class="op" id="6510984">,</span>&nbsp;<span class="comment" id="6510986">//&nbsp;case&nbsp;that&nbsp;once&nbsp;triggered&nbsp;a&nbsp;bug</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511021">{</span><span class="op" id="6511022">[</span><span class="num" id="6511023">7</span><span class="op" id="6511024">]</span><span class="builtintype" id="6511025">int</span><span class="op" id="6511028">{</span><span class="num" id="6511029">4</span><span class="op" id="6511030">,</span>&nbsp;<span class="num" id="6511032">55</span><span class="op" id="6511034">,</span>&nbsp;<span class="num" id="6511036">1</span><span class="op" id="6511037">,</span>&nbsp;<span class="num" id="6511039">44</span><span class="op" id="6511041">,</span>&nbsp;<span class="num" id="6511043">22</span><span class="op" id="6511045">,</span>&nbsp;<span class="num" id="6511047">66</span><span class="op" id="6511049">,</span>&nbsp;<span class="num" id="6511051">1234</span><span class="op" id="6511055">}</span><span class="op" id="6511056">,</span>&nbsp;<span class="op" id="6511058">&amp;</span><span class="ident" id="6511059">testArray</span><span class="op" id="6511068">,</span>&nbsp;<span class="string" id="6511070">&#34;&#34;</span><span class="op" id="6511072">}</span><span class="op" id="6511073">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6511077">//&nbsp;Decode&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511095">{</span><span class="num" id="6511096">172</span><span class="op" id="6511099">,</span>&nbsp;<span class="op" id="6511101">&amp;</span><span class="ident" id="6511102">testFloat32</span><span class="op" id="6511113">,</span>&nbsp;<span class="string" id="6511115">&#34;type&#34;</span><span class="op" id="6511121">}</span><span class="op" id="6511122">,</span><br>
<span class="lineno"></span><span class="op" id="6511124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6511127">func</span>&nbsp;<span class="ident" id="6511132">TestSingletons</span><span class="op" id="6511146">(</span><span class="ident" id="6511147">t</span>&nbsp;<span class="op" id="6511149">*</span><span class="ident" id="6511150">testing</span><span class="op" id="6511157">.</span><span class="ident" id="6511158">T</span><span class="op" id="6511159">)</span>&nbsp;<span class="op" id="6511161">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511164">b</span>&nbsp;<span class="op" id="6511166">:=</span>&nbsp;<span class="builtinfunc" id="6511169">new</span><span class="op" id="6511172">(</span><span class="ident" id="6511173">bytes</span><span class="op" id="6511178">.</span><span class="ident" id="6511179">Buffer</span><span class="op" id="6511185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511188">enc</span>&nbsp;<span class="op" id="6511192">:=</span>&nbsp;<span class="ident" id="6511195">NewEncoder</span><span class="op" id="6511205">(</span><span class="ident" id="6511206">b</span><span class="op" id="6511207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511210">dec</span>&nbsp;<span class="op" id="6511214">:=</span>&nbsp;<span class="ident" id="6511217">NewDecoder</span><span class="op" id="6511227">(</span><span class="ident" id="6511228">b</span><span class="op" id="6511229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511232">for</span>&nbsp;<span class="ident" id="6511236">_</span><span class="op" id="6511237">,</span>&nbsp;<span class="ident" id="6511239">test</span>&nbsp;<span class="op" id="6511244">:=</span>&nbsp;<span class="keyword" id="6511247">range</span>&nbsp;<span class="ident" id="6511253">singleTests</span>&nbsp;<span class="op" id="6511265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511269">b</span><span class="op" id="6511270">.</span><span class="ident" id="6511271">Reset</span><span class="op" id="6511276">(</span><span class="op" id="6511277">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511281">err</span>&nbsp;<span class="op" id="6511285">:=</span>&nbsp;<span class="ident" id="6511288">enc</span><span class="op" id="6511291">.</span><span class="ident" id="6511292">Encode</span><span class="op" id="6511298">(</span><span class="ident" id="6511299">test</span><span class="op" id="6511303">.</span><span class="ident" id="6511304">in</span><span class="op" id="6511306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511310">if</span>&nbsp;<span class="ident" id="6511313">err</span>&nbsp;<span class="op" id="6511317">!=</span>&nbsp;<span class="builtintype" id="6511320">nil</span>&nbsp;<span class="op" id="6511324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511329">t</span><span class="op" id="6511330">.</span><span class="ident" id="6511331">Errorf</span><span class="op" id="6511337">(</span><span class="string" id="6511338">&#34;error&nbsp;encoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="6511361">,</span>&nbsp;<span class="ident" id="6511363">test</span><span class="op" id="6511367">.</span><span class="ident" id="6511368">in</span><span class="op" id="6511370">,</span>&nbsp;<span class="ident" id="6511372">err</span><span class="op" id="6511375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511380">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511391">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511395">err</span>&nbsp;<span class="op" id="6511399">=</span>&nbsp;<span class="ident" id="6511401">dec</span><span class="op" id="6511404">.</span><span class="ident" id="6511405">Decode</span><span class="op" id="6511411">(</span><span class="ident" id="6511412">test</span><span class="op" id="6511416">.</span><span class="ident" id="6511417">out</span><span class="op" id="6511420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511424">switch</span>&nbsp;<span class="op" id="6511431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511435">case</span>&nbsp;<span class="ident" id="6511440">err</span>&nbsp;<span class="op" id="6511444">!=</span>&nbsp;<span class="builtintype" id="6511447">nil</span>&nbsp;<span class="op" id="6511451">&amp;&amp;</span>&nbsp;<span class="ident" id="6511454">test</span><span class="op" id="6511458">.</span><span class="ident" id="6511459">err</span>&nbsp;<span class="op" id="6511463">==</span>&nbsp;<span class="string" id="6511466">&#34;&#34;</span><span class="op" id="6511468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511473">t</span><span class="op" id="6511474">.</span><span class="ident" id="6511475">Errorf</span><span class="op" id="6511481">(</span><span class="string" id="6511482">&#34;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="6511505">,</span>&nbsp;<span class="ident" id="6511507">test</span><span class="op" id="6511511">.</span><span class="ident" id="6511512">in</span><span class="op" id="6511514">,</span>&nbsp;<span class="ident" id="6511516">err</span><span class="op" id="6511519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511524">continue</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511535">case</span>&nbsp;<span class="ident" id="6511540">err</span>&nbsp;<span class="op" id="6511544">==</span>&nbsp;<span class="builtintype" id="6511547">nil</span>&nbsp;<span class="op" id="6511551">&amp;&amp;</span>&nbsp;<span class="ident" id="6511554">test</span><span class="op" id="6511558">.</span><span class="ident" id="6511559">err</span>&nbsp;<span class="op" id="6511563">!=</span>&nbsp;<span class="string" id="6511566">&#34;&#34;</span><span class="op" id="6511568">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511573">t</span><span class="op" id="6511574">.</span><span class="ident" id="6511575">Errorf</span><span class="op" id="6511581">(</span><span class="string" id="6511582">&#34;expected&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="6511614">,</span>&nbsp;<span class="ident" id="6511616">test</span><span class="op" id="6511620">.</span><span class="ident" id="6511621">in</span><span class="op" id="6511623">,</span>&nbsp;<span class="ident" id="6511625">test</span><span class="op" id="6511629">.</span><span class="ident" id="6511630">err</span><span class="op" id="6511633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511638">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511649">case</span>&nbsp;<span class="ident" id="6511654">err</span>&nbsp;<span class="op" id="6511658">!=</span>&nbsp;<span class="builtintype" id="6511661">nil</span>&nbsp;<span class="op" id="6511665">&amp;&amp;</span>&nbsp;<span class="ident" id="6511668">test</span><span class="op" id="6511672">.</span><span class="ident" id="6511673">err</span>&nbsp;<span class="op" id="6511677">!=</span>&nbsp;<span class="string" id="6511680">&#34;&#34;</span><span class="op" id="6511682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511687">if</span>&nbsp;<span class="ident" id="6511690">strings</span><span class="op" id="6511697">.</span><span class="ident" id="6511698">Index</span><span class="op" id="6511703">(</span><span class="ident" id="6511704">err</span><span class="op" id="6511707">.</span><span class="ident" id="6511708">Error</span><span class="op" id="6511713">(</span><span class="op" id="6511714">)</span><span class="op" id="6511715">,</span>&nbsp;<span class="ident" id="6511717">test</span><span class="op" id="6511721">.</span><span class="ident" id="6511722">err</span><span class="op" id="6511725">)</span>&nbsp;<span class="op" id="6511727">&lt;</span>&nbsp;<span class="num" id="6511729">0</span>&nbsp;<span class="op" id="6511731">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511737">t</span><span class="op" id="6511738">.</span><span class="ident" id="6511739">Errorf</span><span class="op" id="6511745">(</span><span class="string" id="6511746">&#34;wrong&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;wanted&nbsp;%s,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6511790">,</span>&nbsp;<span class="ident" id="6511792">test</span><span class="op" id="6511796">.</span><span class="ident" id="6511797">in</span><span class="op" id="6511799">,</span>&nbsp;<span class="ident" id="6511801">test</span><span class="op" id="6511805">.</span><span class="ident" id="6511806">err</span><span class="op" id="6511809">,</span>&nbsp;<span class="ident" id="6511811">err</span><span class="op" id="6511814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511824">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6511839">//&nbsp;Get&nbsp;rid&nbsp;of&nbsp;the&nbsp;pointer&nbsp;in&nbsp;the&nbsp;rhs</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511878">val</span>&nbsp;<span class="op" id="6511882">:=</span>&nbsp;<span class="ident" id="6511885">reflect</span><span class="op" id="6511892">.</span><span class="ident" id="6511893">ValueOf</span><span class="op" id="6511900">(</span><span class="ident" id="6511901">test</span><span class="op" id="6511905">.</span><span class="ident" id="6511906">out</span><span class="op" id="6511909">)</span><span class="op" id="6511910">.</span><span class="ident" id="6511911">Elem</span><span class="op" id="6511915">(</span><span class="op" id="6511916">)</span><span class="op" id="6511917">.</span><span class="ident" id="6511918">Interface</span><span class="op" id="6511927">(</span><span class="op" id="6511928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511932">if</span>&nbsp;<span class="op" id="6511935">!</span><span class="ident" id="6511936">reflect</span><span class="op" id="6511943">.</span><span class="ident" id="6511944">DeepEqual</span><span class="op" id="6511953">(</span><span class="ident" id="6511954">test</span><span class="op" id="6511958">.</span><span class="ident" id="6511959">in</span><span class="op" id="6511961">,</span>&nbsp;<span class="ident" id="6511963">val</span><span class="op" id="6511966">)</span>&nbsp;<span class="op" id="6511968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511973">t</span><span class="op" id="6511974">.</span><span class="ident" id="6511975">Errorf</span><span class="op" id="6511981">(</span><span class="string" id="6511982">&#34;decoding&nbsp;singleton:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6512022">,</span>&nbsp;<span class="ident" id="6512024">test</span><span class="op" id="6512028">.</span><span class="ident" id="6512029">in</span><span class="op" id="6512031">,</span>&nbsp;<span class="ident" id="6512033">val</span><span class="op" id="6512036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512043">}</span><br>
<span class="lineno">420</span><span class="op" id="6512045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6512048">func</span>&nbsp;<span class="ident" id="6512053">TestStructNonStruct</span><span class="op" id="6512072">(</span><span class="ident" id="6512073">t</span>&nbsp;<span class="op" id="6512075">*</span><span class="ident" id="6512076">testing</span><span class="op" id="6512083">.</span><span class="ident" id="6512084">T</span><span class="op" id="6512085">)</span>&nbsp;<span class="op" id="6512087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512090">type</span>&nbsp;<span class="ident" id="6512095">Struct</span>&nbsp;<span class="keyword" id="6512102">struct</span>&nbsp;<span class="op" id="6512109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512113">A</span>&nbsp;<span class="builtintype" id="6512115">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512126">type</span>&nbsp;<span class="ident" id="6512131">NonStruct</span>&nbsp;<span class="builtintype" id="6512141">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512149">s</span>&nbsp;<span class="op" id="6512151">:=</span>&nbsp;<span class="ident" id="6512154">Struct</span><span class="op" id="6512160">{</span><span class="string" id="6512161">&#34;hello&#34;</span><span class="op" id="6512168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512171">var</span>&nbsp;<span class="ident" id="6512175">sp</span>&nbsp;<span class="ident" id="6512178">Struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512186">if</span>&nbsp;<span class="ident" id="6512189">err</span>&nbsp;<span class="op" id="6512193">:=</span>&nbsp;<span class="ident" id="6512196">encAndDec</span><span class="op" id="6512205">(</span><span class="ident" id="6512206">s</span><span class="op" id="6512207">,</span>&nbsp;<span class="op" id="6512209">&amp;</span><span class="ident" id="6512210">sp</span><span class="op" id="6512212">)</span><span class="op" id="6512213">;</span>&nbsp;<span class="ident" id="6512215">err</span>&nbsp;<span class="op" id="6512219">!=</span>&nbsp;<span class="builtintype" id="6512222">nil</span>&nbsp;<span class="op" id="6512226">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512230">t</span><span class="op" id="6512231">.</span><span class="ident" id="6512232">Error</span><span class="op" id="6512237">(</span><span class="ident" id="6512238">err</span><span class="op" id="6512241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512247">var</span>&nbsp;<span class="ident" id="6512251">ns</span>&nbsp;<span class="ident" id="6512254">NonStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512265">if</span>&nbsp;<span class="ident" id="6512268">err</span>&nbsp;<span class="op" id="6512272">:=</span>&nbsp;<span class="ident" id="6512275">encAndDec</span><span class="op" id="6512284">(</span><span class="ident" id="6512285">s</span><span class="op" id="6512286">,</span>&nbsp;<span class="op" id="6512288">&amp;</span><span class="ident" id="6512289">ns</span><span class="op" id="6512291">)</span><span class="op" id="6512292">;</span>&nbsp;<span class="ident" id="6512294">err</span>&nbsp;<span class="op" id="6512298">==</span>&nbsp;<span class="builtintype" id="6512301">nil</span>&nbsp;<span class="op" id="6512305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512309">t</span><span class="op" id="6512310">.</span><span class="ident" id="6512311">Error</span><span class="op" id="6512316">(</span><span class="string" id="6512317">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;struct/non-struct&#34;</span><span class="op" id="6512357">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512360">}</span>&nbsp;<span class="keyword" id="6512362">else</span>&nbsp;<span class="keyword" id="6512367">if</span>&nbsp;<span class="ident" id="6512370">strings</span><span class="op" id="6512377">.</span><span class="ident" id="6512378">Index</span><span class="op" id="6512383">(</span><span class="ident" id="6512384">err</span><span class="op" id="6512387">.</span><span class="ident" id="6512388">Error</span><span class="op" id="6512393">(</span><span class="op" id="6512394">)</span><span class="op" id="6512395">,</span>&nbsp;<span class="string" id="6512397">&#34;type&#34;</span><span class="op" id="6512403">)</span>&nbsp;<span class="op" id="6512405">&lt;</span>&nbsp;<span class="num" id="6512407">0</span>&nbsp;<span class="op" id="6512409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512413">t</span><span class="op" id="6512414">.</span><span class="ident" id="6512415">Error</span><span class="op" id="6512420">(</span><span class="string" id="6512421">&#34;for&nbsp;struct/non-struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="6512469">,</span>&nbsp;<span class="ident" id="6512471">err</span><span class="op" id="6512474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6512480">//&nbsp;Now&nbsp;try&nbsp;the&nbsp;other&nbsp;way</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512506">var</span>&nbsp;<span class="ident" id="6512510">nsp</span>&nbsp;<span class="ident" id="6512514">NonStruct</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512525">if</span>&nbsp;<span class="ident" id="6512528">err</span>&nbsp;<span class="op" id="6512532">:=</span>&nbsp;<span class="ident" id="6512535">encAndDec</span><span class="op" id="6512544">(</span><span class="ident" id="6512545">ns</span><span class="op" id="6512547">,</span>&nbsp;<span class="op" id="6512549">&amp;</span><span class="ident" id="6512550">nsp</span><span class="op" id="6512553">)</span><span class="op" id="6512554">;</span>&nbsp;<span class="ident" id="6512556">err</span>&nbsp;<span class="op" id="6512560">!=</span>&nbsp;<span class="builtintype" id="6512563">nil</span>&nbsp;<span class="op" id="6512567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512571">t</span><span class="op" id="6512572">.</span><span class="ident" id="6512573">Error</span><span class="op" id="6512578">(</span><span class="ident" id="6512579">err</span><span class="op" id="6512582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512588">if</span>&nbsp;<span class="ident" id="6512591">err</span>&nbsp;<span class="op" id="6512595">:=</span>&nbsp;<span class="ident" id="6512598">encAndDec</span><span class="op" id="6512607">(</span><span class="ident" id="6512608">ns</span><span class="op" id="6512610">,</span>&nbsp;<span class="op" id="6512612">&amp;</span><span class="ident" id="6512613">s</span><span class="op" id="6512614">)</span><span class="op" id="6512615">;</span>&nbsp;<span class="ident" id="6512617">err</span>&nbsp;<span class="op" id="6512621">==</span>&nbsp;<span class="builtintype" id="6512624">nil</span>&nbsp;<span class="op" id="6512628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512632">t</span><span class="op" id="6512633">.</span><span class="ident" id="6512634">Error</span><span class="op" id="6512639">(</span><span class="string" id="6512640">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;non-struct/struct&#34;</span><span class="op" id="6512680">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512683">}</span>&nbsp;<span class="keyword" id="6512685">else</span>&nbsp;<span class="keyword" id="6512690">if</span>&nbsp;<span class="ident" id="6512693">strings</span><span class="op" id="6512700">.</span><span class="ident" id="6512701">Index</span><span class="op" id="6512706">(</span><span class="ident" id="6512707">err</span><span class="op" id="6512710">.</span><span class="ident" id="6512711">Error</span><span class="op" id="6512716">(</span><span class="op" id="6512717">)</span><span class="op" id="6512718">,</span>&nbsp;<span class="string" id="6512720">&#34;type&#34;</span><span class="op" id="6512726">)</span>&nbsp;<span class="op" id="6512728">&lt;</span>&nbsp;<span class="num" id="6512730">0</span>&nbsp;<span class="op" id="6512732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512736">t</span><span class="op" id="6512737">.</span><span class="ident" id="6512738">Error</span><span class="op" id="6512743">(</span><span class="string" id="6512744">&#34;for&nbsp;non-struct/struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="6512792">,</span>&nbsp;<span class="ident" id="6512794">err</span><span class="op" id="6512797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512800">}</span><br>
<span class="lineno"></span><span class="op" id="6512802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span><span class="keyword" id="6512805">type</span>&nbsp;<span class="ident" id="6512810">interfaceIndirectTestI</span>&nbsp;<span class="keyword" id="6512833">interface</span>&nbsp;<span class="op" id="6512843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512846">F</span><span class="op" id="6512847">(</span><span class="op" id="6512848">)</span>&nbsp;<span class="builtintype" id="6512850">bool</span><br>
<span class="lineno"></span><span class="op" id="6512855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6512858">type</span>&nbsp;<span class="ident" id="6512863">interfaceIndirectTestT</span>&nbsp;<span class="keyword" id="6512886">struct</span><span class="op" id="6512892">{</span><span class="op" id="6512893">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="keyword" id="6512896">func</span>&nbsp;<span class="op" id="6512901">(</span><span class="ident" id="6512902">this</span>&nbsp;<span class="op" id="6512907">*</span><span class="ident" id="6512908">interfaceIndirectTestT</span><span class="op" id="6512930">)</span>&nbsp;<span class="ident" id="6512932">F</span><span class="op" id="6512933">(</span><span class="op" id="6512934">)</span>&nbsp;<span class="builtintype" id="6512936">bool</span>&nbsp;<span class="op" id="6512941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512944">return</span>&nbsp;<span class="builtintype" id="6512951">true</span><br>
<span class="lineno"></span><span class="op" id="6512956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="comment" id="6512959">//&nbsp;A&nbsp;version&nbsp;of&nbsp;a&nbsp;bug&nbsp;reported&nbsp;on&nbsp;golang-nuts.&nbsp;&nbsp;Also&nbsp;tests&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="6513028">//&nbsp;slice&nbsp;of&nbsp;interfaces.&nbsp;&nbsp;The&nbsp;issue&nbsp;was&nbsp;registering&nbsp;*T&nbsp;caused&nbsp;T&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6513097">//&nbsp;stored&nbsp;as&nbsp;the&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="6513129">func</span>&nbsp;<span class="ident" id="6513134">TestInterfaceIndirect</span><span class="op" id="6513155">(</span><span class="ident" id="6513156">t</span>&nbsp;<span class="op" id="6513158">*</span><span class="ident" id="6513159">testing</span><span class="op" id="6513166">.</span><span class="ident" id="6513167">T</span><span class="op" id="6513168">)</span>&nbsp;<span class="op" id="6513170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513173">Register</span><span class="op" id="6513181">(</span><span class="op" id="6513182">&amp;</span><span class="ident" id="6513183">interfaceIndirectTestT</span><span class="op" id="6513205">{</span><span class="op" id="6513206">}</span><span class="op" id="6513207">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513210">b</span>&nbsp;<span class="op" id="6513212">:=</span>&nbsp;<span class="builtinfunc" id="6513215">new</span><span class="op" id="6513218">(</span><span class="ident" id="6513219">bytes</span><span class="op" id="6513224">.</span><span class="ident" id="6513225">Buffer</span><span class="op" id="6513231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513234">w</span>&nbsp;<span class="op" id="6513236">:=</span>&nbsp;<span class="op" id="6513239">[</span><span class="op" id="6513240">]</span><span class="ident" id="6513241">interfaceIndirectTestI</span><span class="op" id="6513263">{</span><span class="op" id="6513264">&amp;</span><span class="ident" id="6513265">interfaceIndirectTestT</span><span class="op" id="6513287">{</span><span class="op" id="6513288">}</span><span class="op" id="6513289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513292">err</span>&nbsp;<span class="op" id="6513296">:=</span>&nbsp;<span class="ident" id="6513299">NewEncoder</span><span class="op" id="6513309">(</span><span class="ident" id="6513310">b</span><span class="op" id="6513311">)</span><span class="op" id="6513312">.</span><span class="ident" id="6513313">Encode</span><span class="op" id="6513319">(</span><span class="ident" id="6513320">w</span><span class="op" id="6513321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513324">if</span>&nbsp;<span class="ident" id="6513327">err</span>&nbsp;<span class="op" id="6513331">!=</span>&nbsp;<span class="builtintype" id="6513334">nil</span>&nbsp;<span class="op" id="6513338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513342">t</span><span class="op" id="6513343">.</span><span class="ident" id="6513344">Fatal</span><span class="op" id="6513349">(</span><span class="string" id="6513350">&#34;encode&nbsp;error:&#34;</span><span class="op" id="6513365">,</span>&nbsp;<span class="ident" id="6513367">err</span><span class="op" id="6513370">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513377">var</span>&nbsp;<span class="ident" id="6513381">r</span>&nbsp;<span class="op" id="6513383">[</span><span class="op" id="6513384">]</span><span class="ident" id="6513385">interfaceIndirectTestI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513409">err</span>&nbsp;<span class="op" id="6513413">=</span>&nbsp;<span class="ident" id="6513415">NewDecoder</span><span class="op" id="6513425">(</span><span class="ident" id="6513426">b</span><span class="op" id="6513427">)</span><span class="op" id="6513428">.</span><span class="ident" id="6513429">Decode</span><span class="op" id="6513435">(</span><span class="op" id="6513436">&amp;</span><span class="ident" id="6513437">r</span><span class="op" id="6513438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513441">if</span>&nbsp;<span class="ident" id="6513444">err</span>&nbsp;<span class="op" id="6513448">!=</span>&nbsp;<span class="builtintype" id="6513451">nil</span>&nbsp;<span class="op" id="6513455">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513459">t</span><span class="op" id="6513460">.</span><span class="ident" id="6513461">Fatal</span><span class="op" id="6513466">(</span><span class="string" id="6513467">&#34;decode&nbsp;error:&#34;</span><span class="op" id="6513482">,</span>&nbsp;<span class="ident" id="6513484">err</span><span class="op" id="6513487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513490">}</span><br>
<span class="lineno"></span><span class="op" id="6513492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6513495">//&nbsp;Now&nbsp;follow&nbsp;various&nbsp;tests&nbsp;that&nbsp;decode&nbsp;into&nbsp;things&nbsp;that&nbsp;can&#39;t&nbsp;represent&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="6513572">//&nbsp;encoded&nbsp;value,&nbsp;all&nbsp;of&nbsp;which&nbsp;should&nbsp;be&nbsp;legal.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6513621">//&nbsp;Also,&nbsp;when&nbsp;the&nbsp;ignored&nbsp;object&nbsp;contains&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;may&nbsp;define</span><br>
<span class="lineno"></span><span class="comment" id="6513697">//&nbsp;types.&nbsp;Make&nbsp;sure&nbsp;that&nbsp;skipping&nbsp;the&nbsp;value&nbsp;still&nbsp;defines&nbsp;the&nbsp;types&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="6513774">//&nbsp;the&nbsp;encoder/decoder&nbsp;pair&nbsp;to&nbsp;send&nbsp;a&nbsp;value&nbsp;afterwards.&nbsp;&nbsp;If&nbsp;an&nbsp;interface</span><br>
<span class="lineno">485</span><span class="comment" id="6513847">//&nbsp;is&nbsp;sent,&nbsp;its&nbsp;type&nbsp;in&nbsp;the&nbsp;test&nbsp;is&nbsp;always&nbsp;NewType0,&nbsp;so&nbsp;this&nbsp;checks&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6513924">//&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;don&#39;t&nbsp;skew&nbsp;with&nbsp;respect&nbsp;to&nbsp;type&nbsp;definitions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6513993">type</span>&nbsp;<span class="ident" id="6513998">Struct0</span>&nbsp;<span class="keyword" id="6514006">struct</span>&nbsp;<span class="op" id="6514013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514016">I</span>&nbsp;<span class="keyword" id="6514018">interface</span><span class="op" id="6514027">{</span><span class="op" id="6514028">}</span><br>
<span class="lineno">490</span><span class="op" id="6514030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6514033">type</span>&nbsp;<span class="ident" id="6514038">NewType0</span>&nbsp;<span class="keyword" id="6514047">struct</span>&nbsp;<span class="op" id="6514054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514057">S</span>&nbsp;<span class="builtintype" id="6514059">string</span><br>
<span class="lineno"></span><span class="op" id="6514066">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="6514069">type</span>&nbsp;<span class="ident" id="6514074">ignoreTest</span>&nbsp;<span class="keyword" id="6514085">struct</span>&nbsp;<span class="op" id="6514092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514095">in</span><span class="op" id="6514097">,</span>&nbsp;<span class="ident" id="6514099">out</span>&nbsp;<span class="keyword" id="6514103">interface</span><span class="op" id="6514112">{</span><span class="op" id="6514113">}</span><br>
<span class="lineno"></span><span class="op" id="6514115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="6514118">var</span>&nbsp;<span class="ident" id="6514122">ignoreTests</span>&nbsp;<span class="op" id="6514134">=</span>&nbsp;<span class="op" id="6514136">[</span><span class="op" id="6514137">]</span><span class="ident" id="6514138">ignoreTest</span><span class="op" id="6514148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6514151">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;an&nbsp;empty&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514197">{</span><span class="op" id="6514198">&amp;</span><span class="keyword" id="6514199">struct</span><span class="op" id="6514205">{</span>&nbsp;<span class="ident" id="6514207">A</span>&nbsp;<span class="builtintype" id="6514209">int</span>&nbsp;<span class="op" id="6514213">}</span><span class="op" id="6514214">{</span><span class="num" id="6514215">23</span><span class="op" id="6514217">}</span><span class="op" id="6514218">,</span>&nbsp;<span class="op" id="6514220">&amp;</span><span class="keyword" id="6514221">struct</span><span class="op" id="6514227">{</span><span class="op" id="6514228">}</span><span class="op" id="6514229">{</span><span class="op" id="6514230">}</span><span class="op" id="6514231">}</span><span class="op" id="6514232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6514235">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514272">{</span><span class="op" id="6514273">&amp;</span><span class="keyword" id="6514274">struct</span><span class="op" id="6514280">{</span>&nbsp;<span class="ident" id="6514282">A</span>&nbsp;<span class="builtintype" id="6514284">int</span>&nbsp;<span class="op" id="6514288">}</span><span class="op" id="6514289">{</span><span class="num" id="6514290">23</span><span class="op" id="6514292">}</span><span class="op" id="6514293">,</span>&nbsp;<span class="builtintype" id="6514295">nil</span><span class="op" id="6514298">}</span><span class="op" id="6514299">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6514302">//&nbsp;Decode&nbsp;singleton&nbsp;string&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514342">{</span><span class="string" id="6514343">&#34;hello,&nbsp;world&#34;</span><span class="op" id="6514357">,</span>&nbsp;<span class="builtintype" id="6514359">nil</span><span class="op" id="6514362">}</span><span class="op" id="6514363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6514366">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514405">{</span><span class="op" id="6514406">[</span><span class="op" id="6514407">]</span><span class="builtintype" id="6514408">int</span><span class="op" id="6514411">{</span><span class="num" id="6514412">1</span><span class="op" id="6514413">,</span>&nbsp;<span class="num" id="6514415">2</span><span class="op" id="6514416">,</span>&nbsp;<span class="num" id="6514418">3</span><span class="op" id="6514419">,</span>&nbsp;<span class="num" id="6514421">4</span><span class="op" id="6514422">}</span><span class="op" id="6514423">,</span>&nbsp;<span class="builtintype" id="6514425">nil</span><span class="op" id="6514428">}</span><span class="op" id="6514429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6514432">//&nbsp;Decode&nbsp;struct&nbsp;containing&nbsp;an&nbsp;interface&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514486">{</span><span class="op" id="6514487">&amp;</span><span class="ident" id="6514488">Struct0</span><span class="op" id="6514495">{</span><span class="op" id="6514496">&amp;</span><span class="ident" id="6514497">NewType0</span><span class="op" id="6514505">{</span><span class="string" id="6514506">&#34;value0&#34;</span><span class="op" id="6514514">}</span><span class="op" id="6514515">}</span><span class="op" id="6514516">,</span>&nbsp;<span class="builtintype" id="6514518">nil</span><span class="op" id="6514521">}</span><span class="op" id="6514522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6514525">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;of&nbsp;interfaces&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514578">{</span><span class="op" id="6514579">[</span><span class="op" id="6514580">]</span><span class="keyword" id="6514581">interface</span><span class="op" id="6514590">{</span><span class="op" id="6514591">}</span><span class="op" id="6514592">{</span><span class="string" id="6514593">&#34;hi&#34;</span><span class="op" id="6514597">,</span>&nbsp;<span class="op" id="6514599">&amp;</span><span class="ident" id="6514600">NewType0</span><span class="op" id="6514608">{</span><span class="string" id="6514609">&#34;value1&#34;</span><span class="op" id="6514617">}</span><span class="op" id="6514618">,</span>&nbsp;<span class="num" id="6514620">23</span><span class="op" id="6514622">}</span><span class="op" id="6514623">,</span>&nbsp;<span class="builtintype" id="6514625">nil</span><span class="op" id="6514628">}</span><span class="op" id="6514629">,</span><br>
<span class="lineno"></span><span class="op" id="6514631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="6514634">func</span>&nbsp;<span class="ident" id="6514639">TestDecodeIntoNothing</span><span class="op" id="6514660">(</span><span class="ident" id="6514661">t</span>&nbsp;<span class="op" id="6514663">*</span><span class="ident" id="6514664">testing</span><span class="op" id="6514671">.</span><span class="ident" id="6514672">T</span><span class="op" id="6514673">)</span>&nbsp;<span class="op" id="6514675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514678">Register</span><span class="op" id="6514686">(</span><span class="builtinfunc" id="6514687">new</span><span class="op" id="6514690">(</span><span class="ident" id="6514691">NewType0</span><span class="op" id="6514699">)</span><span class="op" id="6514700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514703">for</span>&nbsp;<span class="ident" id="6514707">i</span><span class="op" id="6514708">,</span>&nbsp;<span class="ident" id="6514710">test</span>&nbsp;<span class="op" id="6514715">:=</span>&nbsp;<span class="keyword" id="6514718">range</span>&nbsp;<span class="ident" id="6514724">ignoreTests</span>&nbsp;<span class="op" id="6514736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514740">b</span>&nbsp;<span class="op" id="6514742">:=</span>&nbsp;<span class="builtinfunc" id="6514745">new</span><span class="op" id="6514748">(</span><span class="ident" id="6514749">bytes</span><span class="op" id="6514754">.</span><span class="ident" id="6514755">Buffer</span><span class="op" id="6514761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514765">enc</span>&nbsp;<span class="op" id="6514769">:=</span>&nbsp;<span class="ident" id="6514772">NewEncoder</span><span class="op" id="6514782">(</span><span class="ident" id="6514783">b</span><span class="op" id="6514784">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514788">err</span>&nbsp;<span class="op" id="6514792">:=</span>&nbsp;<span class="ident" id="6514795">enc</span><span class="op" id="6514798">.</span><span class="ident" id="6514799">Encode</span><span class="op" id="6514805">(</span><span class="ident" id="6514806">test</span><span class="op" id="6514810">.</span><span class="ident" id="6514811">in</span><span class="op" id="6514813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514817">if</span>&nbsp;<span class="ident" id="6514820">err</span>&nbsp;<span class="op" id="6514824">!=</span>&nbsp;<span class="builtintype" id="6514827">nil</span>&nbsp;<span class="op" id="6514831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514836">t</span><span class="op" id="6514837">.</span><span class="ident" id="6514838">Errorf</span><span class="op" id="6514844">(</span><span class="string" id="6514845">&#34;%d:&nbsp;encode&nbsp;error&nbsp;%s:&#34;</span><span class="op" id="6514867">,</span>&nbsp;<span class="ident" id="6514869">i</span><span class="op" id="6514870">,</span>&nbsp;<span class="ident" id="6514872">err</span><span class="op" id="6514875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514880">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514891">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514895">dec</span>&nbsp;<span class="op" id="6514899">:=</span>&nbsp;<span class="ident" id="6514902">NewDecoder</span><span class="op" id="6514912">(</span><span class="ident" id="6514913">b</span><span class="op" id="6514914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514918">err</span>&nbsp;<span class="op" id="6514922">=</span>&nbsp;<span class="ident" id="6514924">dec</span><span class="op" id="6514927">.</span><span class="ident" id="6514928">Decode</span><span class="op" id="6514934">(</span><span class="ident" id="6514935">test</span><span class="op" id="6514939">.</span><span class="ident" id="6514940">out</span><span class="op" id="6514943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514947">if</span>&nbsp;<span class="ident" id="6514950">err</span>&nbsp;<span class="op" id="6514954">!=</span>&nbsp;<span class="builtintype" id="6514957">nil</span>&nbsp;<span class="op" id="6514961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514966">t</span><span class="op" id="6514967">.</span><span class="ident" id="6514968">Errorf</span><span class="op" id="6514974">(</span><span class="string" id="6514975">&#34;%d:&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6514997">,</span>&nbsp;<span class="ident" id="6514999">i</span><span class="op" id="6515000">,</span>&nbsp;<span class="ident" id="6515002">err</span><span class="op" id="6515005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515010">continue</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6515025">//&nbsp;Now&nbsp;see&nbsp;if&nbsp;the&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;are&nbsp;in&nbsp;a&nbsp;consistent&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515092">str</span>&nbsp;<span class="op" id="6515096">:=</span>&nbsp;<span class="ident" id="6515099">fmt</span><span class="op" id="6515102">.</span><span class="ident" id="6515103">Sprintf</span><span class="op" id="6515110">(</span><span class="string" id="6515111">&#34;Value&nbsp;%d&#34;</span><span class="op" id="6515121">,</span>&nbsp;<span class="ident" id="6515123">i</span><span class="op" id="6515124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515128">err</span>&nbsp;<span class="op" id="6515132">=</span>&nbsp;<span class="ident" id="6515134">enc</span><span class="op" id="6515137">.</span><span class="ident" id="6515138">Encode</span><span class="op" id="6515144">(</span><span class="op" id="6515145">&amp;</span><span class="ident" id="6515146">NewType0</span><span class="op" id="6515154">{</span><span class="ident" id="6515155">str</span><span class="op" id="6515158">}</span><span class="op" id="6515159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515163">if</span>&nbsp;<span class="ident" id="6515166">err</span>&nbsp;<span class="op" id="6515170">!=</span>&nbsp;<span class="builtintype" id="6515173">nil</span>&nbsp;<span class="op" id="6515177">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515182">t</span><span class="op" id="6515183">.</span><span class="ident" id="6515184">Fatalf</span><span class="op" id="6515190">(</span><span class="string" id="6515191">&#34;%d:&nbsp;NewType0&nbsp;encode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6515222">,</span>&nbsp;<span class="ident" id="6515224">i</span><span class="op" id="6515225">,</span>&nbsp;<span class="ident" id="6515227">err</span><span class="op" id="6515230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515238">ns</span>&nbsp;<span class="op" id="6515241">:=</span>&nbsp;<span class="builtinfunc" id="6515244">new</span><span class="op" id="6515247">(</span><span class="ident" id="6515248">NewType0</span><span class="op" id="6515256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515260">err</span>&nbsp;<span class="op" id="6515264">=</span>&nbsp;<span class="ident" id="6515266">dec</span><span class="op" id="6515269">.</span><span class="ident" id="6515270">Decode</span><span class="op" id="6515276">(</span><span class="ident" id="6515277">ns</span><span class="op" id="6515279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515283">if</span>&nbsp;<span class="ident" id="6515286">err</span>&nbsp;<span class="op" id="6515290">!=</span>&nbsp;<span class="builtintype" id="6515293">nil</span>&nbsp;<span class="op" id="6515297">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515302">t</span><span class="op" id="6515303">.</span><span class="ident" id="6515304">Fatalf</span><span class="op" id="6515310">(</span><span class="string" id="6515311">&#34;%d:&nbsp;NewType0&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6515342">,</span>&nbsp;<span class="ident" id="6515344">i</span><span class="op" id="6515345">,</span>&nbsp;<span class="ident" id="6515347">err</span><span class="op" id="6515350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515358">if</span>&nbsp;<span class="ident" id="6515361">ns</span><span class="op" id="6515363">.</span><span class="ident" id="6515364">S</span>&nbsp;<span class="op" id="6515366">!=</span>&nbsp;<span class="ident" id="6515369">str</span>&nbsp;<span class="op" id="6515373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515378">t</span><span class="op" id="6515379">.</span><span class="ident" id="6515380">Fatalf</span><span class="op" id="6515386">(</span><span class="string" id="6515387">&#34;%d:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6515411">,</span>&nbsp;<span class="ident" id="6515413">i</span><span class="op" id="6515414">,</span>&nbsp;<span class="ident" id="6515416">str</span><span class="op" id="6515419">,</span>&nbsp;<span class="ident" id="6515421">ns</span><span class="op" id="6515423">.</span><span class="ident" id="6515424">S</span><span class="op" id="6515425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515429">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515432">}</span><br>
<span class="lineno"></span><span class="op" id="6515434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6515437">//&nbsp;Another&nbsp;bug&nbsp;from&nbsp;golang-nuts,&nbsp;involving&nbsp;nested&nbsp;interfaces.</span><br>
<span class="lineno"></span><span class="keyword" id="6515499">type</span>&nbsp;<span class="ident" id="6515504">Bug0Outer</span>&nbsp;<span class="keyword" id="6515514">struct</span>&nbsp;<span class="op" id="6515521">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515524">Bug0Field</span>&nbsp;<span class="keyword" id="6515534">interface</span><span class="op" id="6515543">{</span><span class="op" id="6515544">}</span><br>
<span class="lineno"></span><span class="op" id="6515546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6515549">type</span>&nbsp;<span class="ident" id="6515554">Bug0Inner</span>&nbsp;<span class="keyword" id="6515564">struct</span>&nbsp;<span class="op" id="6515571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515574">A</span>&nbsp;<span class="builtintype" id="6515576">int</span><br>
<span class="lineno">555</span><span class="op" id="6515580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6515583">func</span>&nbsp;<span class="ident" id="6515588">TestNestedInterfaces</span><span class="op" id="6515608">(</span><span class="ident" id="6515609">t</span>&nbsp;<span class="op" id="6515611">*</span><span class="ident" id="6515612">testing</span><span class="op" id="6515619">.</span><span class="ident" id="6515620">T</span><span class="op" id="6515621">)</span>&nbsp;<span class="op" id="6515623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515626">var</span>&nbsp;<span class="ident" id="6515630">buf</span>&nbsp;<span class="ident" id="6515634">bytes</span><span class="op" id="6515639">.</span><span class="ident" id="6515640">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515648">e</span>&nbsp;<span class="op" id="6515650">:=</span>&nbsp;<span class="ident" id="6515653">NewEncoder</span><span class="op" id="6515663">(</span><span class="op" id="6515664">&amp;</span><span class="ident" id="6515665">buf</span><span class="op" id="6515668">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515671">d</span>&nbsp;<span class="op" id="6515673">:=</span>&nbsp;<span class="ident" id="6515676">NewDecoder</span><span class="op" id="6515686">(</span><span class="op" id="6515687">&amp;</span><span class="ident" id="6515688">buf</span><span class="op" id="6515691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515694">Register</span><span class="op" id="6515702">(</span><span class="builtinfunc" id="6515703">new</span><span class="op" id="6515706">(</span><span class="ident" id="6515707">Bug0Outer</span><span class="op" id="6515716">)</span><span class="op" id="6515717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515720">Register</span><span class="op" id="6515728">(</span><span class="builtinfunc" id="6515729">new</span><span class="op" id="6515732">(</span><span class="ident" id="6515733">Bug0Inner</span><span class="op" id="6515742">)</span><span class="op" id="6515743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515746">f</span>&nbsp;<span class="op" id="6515748">:=</span>&nbsp;<span class="op" id="6515751">&amp;</span><span class="ident" id="6515752">Bug0Outer</span><span class="op" id="6515761">{</span><span class="op" id="6515762">&amp;</span><span class="ident" id="6515763">Bug0Outer</span><span class="op" id="6515772">{</span><span class="op" id="6515773">&amp;</span><span class="ident" id="6515774">Bug0Inner</span><span class="op" id="6515783">{</span><span class="num" id="6515784">7</span><span class="op" id="6515785">}</span><span class="op" id="6515786">}</span><span class="op" id="6515787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515790">var</span>&nbsp;<span class="ident" id="6515794">v</span>&nbsp;<span class="keyword" id="6515796">interface</span><span class="op" id="6515805">{</span><span class="op" id="6515806">}</span>&nbsp;<span class="op" id="6515808">=</span>&nbsp;<span class="ident" id="6515810">f</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515813">err</span>&nbsp;<span class="op" id="6515817">:=</span>&nbsp;<span class="ident" id="6515820">e</span><span class="op" id="6515821">.</span><span class="ident" id="6515822">Encode</span><span class="op" id="6515828">(</span><span class="op" id="6515829">&amp;</span><span class="ident" id="6515830">v</span><span class="op" id="6515831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515834">if</span>&nbsp;<span class="ident" id="6515837">err</span>&nbsp;<span class="op" id="6515841">!=</span>&nbsp;<span class="builtintype" id="6515844">nil</span>&nbsp;<span class="op" id="6515848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515852">t</span><span class="op" id="6515853">.</span><span class="ident" id="6515854">Fatal</span><span class="op" id="6515859">(</span><span class="string" id="6515860">&#34;Encode:&#34;</span><span class="op" id="6515869">,</span>&nbsp;<span class="ident" id="6515871">err</span><span class="op" id="6515874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515880">err</span>&nbsp;<span class="op" id="6515884">=</span>&nbsp;<span class="ident" id="6515886">d</span><span class="op" id="6515887">.</span><span class="ident" id="6515888">Decode</span><span class="op" id="6515894">(</span><span class="op" id="6515895">&amp;</span><span class="ident" id="6515896">v</span><span class="op" id="6515897">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515900">if</span>&nbsp;<span class="ident" id="6515903">err</span>&nbsp;<span class="op" id="6515907">!=</span>&nbsp;<span class="builtintype" id="6515910">nil</span>&nbsp;<span class="op" id="6515914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515918">t</span><span class="op" id="6515919">.</span><span class="ident" id="6515920">Fatal</span><span class="op" id="6515925">(</span><span class="string" id="6515926">&#34;Decode:&#34;</span><span class="op" id="6515935">,</span>&nbsp;<span class="ident" id="6515937">err</span><span class="op" id="6515940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6515946">//&nbsp;Make&nbsp;sure&nbsp;it&nbsp;decoded&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515982">outer1</span><span class="op" id="6515988">,</span>&nbsp;<span class="ident" id="6515990">ok</span>&nbsp;<span class="op" id="6515993">:=</span>&nbsp;<span class="ident" id="6515996">v</span><span class="op" id="6515997">.</span><span class="op" id="6515998">(</span><span class="op" id="6515999">*</span><span class="ident" id="6516000">Bug0Outer</span><span class="op" id="6516009">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516012">if</span>&nbsp;<span class="op" id="6516015">!</span><span class="ident" id="6516016">ok</span>&nbsp;<span class="op" id="6516019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516023">t</span><span class="op" id="6516024">.</span><span class="ident" id="6516025">Fatalf</span><span class="op" id="6516031">(</span><span class="string" id="6516032">&#34;v&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="6516053">,</span>&nbsp;<span class="ident" id="6516055">v</span><span class="op" id="6516056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516062">outer2</span><span class="op" id="6516068">,</span>&nbsp;<span class="ident" id="6516070">ok</span>&nbsp;<span class="op" id="6516073">:=</span>&nbsp;<span class="ident" id="6516076">outer1</span><span class="op" id="6516082">.</span><span class="ident" id="6516083">Bug0Field</span><span class="op" id="6516092">.</span><span class="op" id="6516093">(</span><span class="op" id="6516094">*</span><span class="ident" id="6516095">Bug0Outer</span><span class="op" id="6516104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516107">if</span>&nbsp;<span class="op" id="6516110">!</span><span class="ident" id="6516111">ok</span>&nbsp;<span class="op" id="6516114">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516118">t</span><span class="op" id="6516119">.</span><span class="ident" id="6516120">Fatalf</span><span class="op" id="6516126">(</span><span class="string" id="6516127">&#34;v.Bug0Field&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="6516158">,</span>&nbsp;<span class="ident" id="6516160">outer1</span><span class="op" id="6516166">.</span><span class="ident" id="6516167">Bug0Field</span><span class="op" id="6516176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516182">inner</span><span class="op" id="6516187">,</span>&nbsp;<span class="ident" id="6516189">ok</span>&nbsp;<span class="op" id="6516192">:=</span>&nbsp;<span class="ident" id="6516195">outer2</span><span class="op" id="6516201">.</span><span class="ident" id="6516202">Bug0Field</span><span class="op" id="6516211">.</span><span class="op" id="6516212">(</span><span class="op" id="6516213">*</span><span class="ident" id="6516214">Bug0Inner</span><span class="op" id="6516223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516226">if</span>&nbsp;<span class="op" id="6516229">!</span><span class="ident" id="6516230">ok</span>&nbsp;<span class="op" id="6516233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516237">t</span><span class="op" id="6516238">.</span><span class="ident" id="6516239">Fatalf</span><span class="op" id="6516245">(</span><span class="string" id="6516246">&#34;v.Bug0Field.Bug0Field&nbsp;not&nbsp;Bug0Inner:&nbsp;%T&#34;</span><span class="op" id="6516287">,</span>&nbsp;<span class="ident" id="6516289">outer2</span><span class="op" id="6516295">.</span><span class="ident" id="6516296">Bug0Field</span><span class="op" id="6516305">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516311">if</span>&nbsp;<span class="ident" id="6516314">inner</span><span class="op" id="6516319">.</span><span class="ident" id="6516320">A</span>&nbsp;<span class="op" id="6516322">!=</span>&nbsp;<span class="num" id="6516325">7</span>&nbsp;<span class="op" id="6516327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516331">t</span><span class="op" id="6516332">.</span><span class="ident" id="6516333">Fatalf</span><span class="op" id="6516339">(</span><span class="string" id="6516340">&#34;final&nbsp;value&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6516369">,</span>&nbsp;<span class="ident" id="6516371">inner</span><span class="op" id="6516376">.</span><span class="ident" id="6516377">A</span><span class="op" id="6516378">,</span>&nbsp;<span class="num" id="6516380">7</span><span class="op" id="6516381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516384">}</span><br>
<span class="lineno"></span><span class="op" id="6516386">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="6516389">//&nbsp;The&nbsp;bugs&nbsp;keep&nbsp;coming.&nbsp;We&nbsp;forgot&nbsp;to&nbsp;send&nbsp;map&nbsp;subtypes&nbsp;before&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6516462">type</span>&nbsp;<span class="ident" id="6516467">Bug1Elem</span>&nbsp;<span class="keyword" id="6516476">struct</span>&nbsp;<span class="op" id="6516483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516486">Name</span>&nbsp;<span class="builtintype" id="6516491">string</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516499">Id</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6516504">int</span><br>
<span class="lineno"></span><span class="op" id="6516508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6516511">type</span>&nbsp;<span class="ident" id="6516516">Bug1StructMap</span>&nbsp;<span class="keyword" id="6516530">map</span><span class="op" id="6516533">[</span><span class="builtintype" id="6516534">string</span><span class="op" id="6516540">]</span><span class="ident" id="6516541">Bug1Elem</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span><span class="keyword" id="6516551">func</span>&nbsp;<span class="ident" id="6516556">bug1EncDec</span><span class="op" id="6516566">(</span><span class="ident" id="6516567">in</span>&nbsp;<span class="ident" id="6516570">Bug1StructMap</span><span class="op" id="6516583">,</span>&nbsp;<span class="ident" id="6516585">out</span>&nbsp;<span class="op" id="6516589">*</span><span class="ident" id="6516590">Bug1StructMap</span><span class="op" id="6516603">)</span>&nbsp;<span class="builtintype" id="6516605">error</span>&nbsp;<span class="op" id="6516611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516614">return</span>&nbsp;<span class="builtintype" id="6516621">nil</span><br>
<span class="lineno"></span><span class="op" id="6516625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6516628">func</span>&nbsp;<span class="ident" id="6516633">TestMapBug1</span><span class="op" id="6516644">(</span><span class="ident" id="6516645">t</span>&nbsp;<span class="op" id="6516647">*</span><span class="ident" id="6516648">testing</span><span class="op" id="6516655">.</span><span class="ident" id="6516656">T</span><span class="op" id="6516657">)</span>&nbsp;<span class="op" id="6516659">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516662">in</span>&nbsp;<span class="op" id="6516665">:=</span>&nbsp;<span class="builtinfunc" id="6516668">make</span><span class="op" id="6516672">(</span><span class="ident" id="6516673">Bug1StructMap</span><span class="op" id="6516686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516689">in</span><span class="op" id="6516691">[</span><span class="string" id="6516692">&#34;val1&#34;</span><span class="op" id="6516698">]</span>&nbsp;<span class="op" id="6516700">=</span>&nbsp;<span class="ident" id="6516702">Bug1Elem</span><span class="op" id="6516710">{</span><span class="string" id="6516711">&#34;elem1&#34;</span><span class="op" id="6516718">,</span>&nbsp;<span class="num" id="6516720">1</span><span class="op" id="6516721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516724">in</span><span class="op" id="6516726">[</span><span class="string" id="6516727">&#34;val2&#34;</span><span class="op" id="6516733">]</span>&nbsp;<span class="op" id="6516735">=</span>&nbsp;<span class="ident" id="6516737">Bug1Elem</span><span class="op" id="6516745">{</span><span class="string" id="6516746">&#34;elem2&#34;</span><span class="op" id="6516753">,</span>&nbsp;<span class="num" id="6516755">2</span><span class="op" id="6516756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516760">b</span>&nbsp;<span class="op" id="6516762">:=</span>&nbsp;<span class="builtinfunc" id="6516765">new</span><span class="op" id="6516768">(</span><span class="ident" id="6516769">bytes</span><span class="op" id="6516774">.</span><span class="ident" id="6516775">Buffer</span><span class="op" id="6516781">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516784">enc</span>&nbsp;<span class="op" id="6516788">:=</span>&nbsp;<span class="ident" id="6516791">NewEncoder</span><span class="op" id="6516801">(</span><span class="ident" id="6516802">b</span><span class="op" id="6516803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516806">err</span>&nbsp;<span class="op" id="6516810">:=</span>&nbsp;<span class="ident" id="6516813">enc</span><span class="op" id="6516816">.</span><span class="ident" id="6516817">Encode</span><span class="op" id="6516823">(</span><span class="ident" id="6516824">in</span><span class="op" id="6516826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516829">if</span>&nbsp;<span class="ident" id="6516832">err</span>&nbsp;<span class="op" id="6516836">!=</span>&nbsp;<span class="builtintype" id="6516839">nil</span>&nbsp;<span class="op" id="6516843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516847">t</span><span class="op" id="6516848">.</span><span class="ident" id="6516849">Fatal</span><span class="op" id="6516854">(</span><span class="string" id="6516855">&#34;encode:&#34;</span><span class="op" id="6516864">,</span>&nbsp;<span class="ident" id="6516866">err</span><span class="op" id="6516869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516872">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516875">dec</span>&nbsp;<span class="op" id="6516879">:=</span>&nbsp;<span class="ident" id="6516882">NewDecoder</span><span class="op" id="6516892">(</span><span class="ident" id="6516893">b</span><span class="op" id="6516894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516897">out</span>&nbsp;<span class="op" id="6516901">:=</span>&nbsp;<span class="builtinfunc" id="6516904">make</span><span class="op" id="6516908">(</span><span class="ident" id="6516909">Bug1StructMap</span><span class="op" id="6516922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516925">err</span>&nbsp;<span class="op" id="6516929">=</span>&nbsp;<span class="ident" id="6516931">dec</span><span class="op" id="6516934">.</span><span class="ident" id="6516935">Decode</span><span class="op" id="6516941">(</span><span class="op" id="6516942">&amp;</span><span class="ident" id="6516943">out</span><span class="op" id="6516946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516949">if</span>&nbsp;<span class="ident" id="6516952">err</span>&nbsp;<span class="op" id="6516956">!=</span>&nbsp;<span class="builtintype" id="6516959">nil</span>&nbsp;<span class="op" id="6516963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6516967">t</span><span class="op" id="6516968">.</span><span class="ident" id="6516969">Fatal</span><span class="op" id="6516974">(</span><span class="string" id="6516975">&#34;decode:&#34;</span><span class="op" id="6516984">,</span>&nbsp;<span class="ident" id="6516986">err</span><span class="op" id="6516989">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6516995">if</span>&nbsp;<span class="op" id="6516998">!</span><span class="ident" id="6516999">reflect</span><span class="op" id="6517006">.</span><span class="ident" id="6517007">DeepEqual</span><span class="op" id="6517016">(</span><span class="ident" id="6517017">in</span><span class="op" id="6517019">,</span>&nbsp;<span class="ident" id="6517021">out</span><span class="op" id="6517024">)</span>&nbsp;<span class="op" id="6517026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517030">t</span><span class="op" id="6517031">.</span><span class="ident" id="6517032">Errorf</span><span class="op" id="6517038">(</span><span class="string" id="6517039">&#34;mismatch:&nbsp;%v&nbsp;%v&#34;</span><span class="op" id="6517056">,</span>&nbsp;<span class="ident" id="6517058">in</span><span class="op" id="6517060">,</span>&nbsp;<span class="ident" id="6517062">out</span><span class="op" id="6517065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6517068">}</span><br>
<span class="lineno"></span><span class="op" id="6517070">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="6517073">func</span>&nbsp;<span class="ident" id="6517078">TestGobMapInterfaceEncode</span><span class="op" id="6517103">(</span><span class="ident" id="6517104">t</span>&nbsp;<span class="op" id="6517106">*</span><span class="ident" id="6517107">testing</span><span class="op" id="6517114">.</span><span class="ident" id="6517115">T</span><span class="op" id="6517116">)</span>&nbsp;<span class="op" id="6517118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517121">m</span>&nbsp;<span class="op" id="6517123">:=</span>&nbsp;<span class="keyword" id="6517126">map</span><span class="op" id="6517129">[</span><span class="builtintype" id="6517130">string</span><span class="op" id="6517136">]</span><span class="keyword" id="6517137">interface</span><span class="op" id="6517146">{</span><span class="op" id="6517147">}</span><span class="op" id="6517148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517152">&#34;up&#34;</span><span class="op" id="6517156">:</span>&nbsp;<span class="builtintype" id="6517158">uintptr</span><span class="op" id="6517165">(</span><span class="num" id="6517166">0</span><span class="op" id="6517167">)</span><span class="op" id="6517168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517172">&#34;i0&#34;</span><span class="op" id="6517176">:</span>&nbsp;<span class="op" id="6517178">[</span><span class="op" id="6517179">]</span><span class="builtintype" id="6517180">int</span><span class="op" id="6517183">{</span><span class="op" id="6517184">-</span><span class="num" id="6517185">1</span><span class="op" id="6517186">}</span><span class="op" id="6517187">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517191">&#34;i1&#34;</span><span class="op" id="6517195">:</span>&nbsp;<span class="op" id="6517197">[</span><span class="op" id="6517198">]</span><span class="builtintype" id="6517199">int8</span><span class="op" id="6517203">{</span><span class="op" id="6517204">-</span><span class="num" id="6517205">1</span><span class="op" id="6517206">}</span><span class="op" id="6517207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517211">&#34;i2&#34;</span><span class="op" id="6517215">:</span>&nbsp;<span class="op" id="6517217">[</span><span class="op" id="6517218">]</span><span class="builtintype" id="6517219">int16</span><span class="op" id="6517224">{</span><span class="op" id="6517225">-</span><span class="num" id="6517226">1</span><span class="op" id="6517227">}</span><span class="op" id="6517228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517232">&#34;i3&#34;</span><span class="op" id="6517236">:</span>&nbsp;<span class="op" id="6517238">[</span><span class="op" id="6517239">]</span><span class="builtintype" id="6517240">int32</span><span class="op" id="6517245">{</span><span class="op" id="6517246">-</span><span class="num" id="6517247">1</span><span class="op" id="6517248">}</span><span class="op" id="6517249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517253">&#34;i4&#34;</span><span class="op" id="6517257">:</span>&nbsp;<span class="op" id="6517259">[</span><span class="op" id="6517260">]</span><span class="ident" id="6517261">int64</span><span class="op" id="6517266">{</span><span class="op" id="6517267">-</span><span class="num" id="6517268">1</span><span class="op" id="6517269">}</span><span class="op" id="6517270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517274">&#34;u0&#34;</span><span class="op" id="6517278">:</span>&nbsp;<span class="op" id="6517280">[</span><span class="op" id="6517281">]</span><span class="builtintype" id="6517282">uint</span><span class="op" id="6517286">{</span><span class="num" id="6517287">1</span><span class="op" id="6517288">}</span><span class="op" id="6517289">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517293">&#34;u1&#34;</span><span class="op" id="6517297">:</span>&nbsp;<span class="op" id="6517299">[</span><span class="op" id="6517300">]</span><span class="builtintype" id="6517301">uint8</span><span class="op" id="6517306">{</span><span class="num" id="6517307">1</span><span class="op" id="6517308">}</span><span class="op" id="6517309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517313">&#34;u2&#34;</span><span class="op" id="6517317">:</span>&nbsp;<span class="op" id="6517319">[</span><span class="op" id="6517320">]</span><span class="builtintype" id="6517321">uint16</span><span class="op" id="6517327">{</span><span class="num" id="6517328">1</span><span class="op" id="6517329">}</span><span class="op" id="6517330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517334">&#34;u3&#34;</span><span class="op" id="6517338">:</span>&nbsp;<span class="op" id="6517340">[</span><span class="op" id="6517341">]</span><span class="builtintype" id="6517342">uint32</span><span class="op" id="6517348">{</span><span class="num" id="6517349">1</span><span class="op" id="6517350">}</span><span class="op" id="6517351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517355">&#34;u4&#34;</span><span class="op" id="6517359">:</span>&nbsp;<span class="op" id="6517361">[</span><span class="op" id="6517362">]</span><span class="ident" id="6517363">uint64</span><span class="op" id="6517369">{</span><span class="num" id="6517370">1</span><span class="op" id="6517371">}</span><span class="op" id="6517372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517376">&#34;f0&#34;</span><span class="op" id="6517380">:</span>&nbsp;<span class="op" id="6517382">[</span><span class="op" id="6517383">]</span><span class="builtintype" id="6517384">float32</span><span class="op" id="6517391">{</span><span class="num" id="6517392">1</span><span class="op" id="6517393">}</span><span class="op" id="6517394">,</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517398">&#34;f1&#34;</span><span class="op" id="6517402">:</span>&nbsp;<span class="op" id="6517404">[</span><span class="op" id="6517405">]</span><span class="builtintype" id="6517406">float64</span><span class="op" id="6517413">{</span><span class="num" id="6517414">1</span><span class="op" id="6517415">}</span><span class="op" id="6517416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517420">&#34;c0&#34;</span><span class="op" id="6517424">:</span>&nbsp;<span class="op" id="6517426">[</span><span class="op" id="6517427">]</span><span class="builtintype" id="6517428">complex64</span><span class="op" id="6517437">{</span><span class="builtinfunc" id="6517438">complex</span><span class="op" id="6517445">(</span><span class="num" id="6517446">2</span><span class="op" id="6517447">,</span>&nbsp;<span class="op" id="6517449">-</span><span class="num" id="6517450">2</span><span class="op" id="6517451">)</span><span class="op" id="6517452">}</span><span class="op" id="6517453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517457">&#34;c1&#34;</span><span class="op" id="6517461">:</span>&nbsp;<span class="op" id="6517463">[</span><span class="op" id="6517464">]</span><span class="builtintype" id="6517465">complex128</span><span class="op" id="6517475">{</span><span class="builtinfunc" id="6517476">complex</span><span class="op" id="6517483">(</span><span class="num" id="6517484">2</span><span class="op" id="6517485">,</span>&nbsp;<span class="builtintype" id="6517487">float64</span><span class="op" id="6517494">(</span><span class="op" id="6517495">-</span><span class="num" id="6517496">2</span><span class="op" id="6517497">)</span><span class="op" id="6517498">)</span><span class="op" id="6517499">}</span><span class="op" id="6517500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517504">&#34;us&#34;</span><span class="op" id="6517508">:</span>&nbsp;<span class="op" id="6517510">[</span><span class="op" id="6517511">]</span><span class="builtintype" id="6517512">uintptr</span><span class="op" id="6517519">{</span><span class="num" id="6517520">0</span><span class="op" id="6517521">}</span><span class="op" id="6517522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517526">&#34;bo&#34;</span><span class="op" id="6517530">:</span>&nbsp;<span class="op" id="6517532">[</span><span class="op" id="6517533">]</span><span class="builtintype" id="6517534">bool</span><span class="op" id="6517538">{</span><span class="builtintype" id="6517539">false</span><span class="op" id="6517544">}</span><span class="op" id="6517545">,</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6517549">&#34;st&#34;</span><span class="op" id="6517553">:</span>&nbsp;<span class="op" id="6517555">[</span><span class="op" id="6517556">]</span><span class="builtintype" id="6517557">string</span><span class="op" id="6517563">{</span><span class="string" id="6517564">&#34;s&#34;</span><span class="op" id="6517567">}</span><span class="op" id="6517568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6517571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517574">enc</span>&nbsp;<span class="op" id="6517578">:=</span>&nbsp;<span class="ident" id="6517581">NewEncoder</span><span class="op" id="6517591">(</span><span class="builtinfunc" id="6517592">new</span><span class="op" id="6517595">(</span><span class="ident" id="6517596">bytes</span><span class="op" id="6517601">.</span><span class="ident" id="6517602">Buffer</span><span class="op" id="6517608">)</span><span class="op" id="6517609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517612">err</span>&nbsp;<span class="op" id="6517616">:=</span>&nbsp;<span class="ident" id="6517619">enc</span><span class="op" id="6517622">.</span><span class="ident" id="6517623">Encode</span><span class="op" id="6517629">(</span><span class="ident" id="6517630">m</span><span class="op" id="6517631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6517634">if</span>&nbsp;<span class="ident" id="6517637">err</span>&nbsp;<span class="op" id="6517641">!=</span>&nbsp;<span class="builtintype" id="6517644">nil</span>&nbsp;<span class="op" id="6517648">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517652">t</span><span class="op" id="6517653">.</span><span class="ident" id="6517654">Errorf</span><span class="op" id="6517660">(</span><span class="string" id="6517661">&#34;encode&nbsp;map:&nbsp;%s&#34;</span><span class="op" id="6517677">,</span>&nbsp;<span class="ident" id="6517679">err</span><span class="op" id="6517682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6517685">}</span><br>
<span class="lineno"></span><span class="op" id="6517687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6517690">func</span>&nbsp;<span class="ident" id="6517695">TestSliceReusesMemory</span><span class="op" id="6517716">(</span><span class="ident" id="6517717">t</span>&nbsp;<span class="op" id="6517719">*</span><span class="ident" id="6517720">testing</span><span class="op" id="6517727">.</span><span class="ident" id="6517728">T</span><span class="op" id="6517729">)</span>&nbsp;<span class="op" id="6517731">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517734">buf</span>&nbsp;<span class="op" id="6517738">:=</span>&nbsp;<span class="builtinfunc" id="6517741">new</span><span class="op" id="6517744">(</span><span class="ident" id="6517745">bytes</span><span class="op" id="6517750">.</span><span class="ident" id="6517751">Buffer</span><span class="op" id="6517757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6517760">//&nbsp;Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6517770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517774">x</span>&nbsp;<span class="op" id="6517776">:=</span>&nbsp;<span class="op" id="6517779">[</span><span class="op" id="6517780">]</span><span class="builtintype" id="6517781">byte</span><span class="op" id="6517785">(</span><span class="string" id="6517786">&#34;abcd&#34;</span><span class="op" id="6517792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517796">enc</span>&nbsp;<span class="op" id="6517800">:=</span>&nbsp;<span class="ident" id="6517803">NewEncoder</span><span class="op" id="6517813">(</span><span class="ident" id="6517814">buf</span><span class="op" id="6517817">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517821">err</span>&nbsp;<span class="op" id="6517825">:=</span>&nbsp;<span class="ident" id="6517828">enc</span><span class="op" id="6517831">.</span><span class="ident" id="6517832">Encode</span><span class="op" id="6517838">(</span><span class="ident" id="6517839">x</span><span class="op" id="6517840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6517844">if</span>&nbsp;<span class="ident" id="6517847">err</span>&nbsp;<span class="op" id="6517851">!=</span>&nbsp;<span class="builtintype" id="6517854">nil</span>&nbsp;<span class="op" id="6517858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517863">t</span><span class="op" id="6517864">.</span><span class="ident" id="6517865">Errorf</span><span class="op" id="6517871">(</span><span class="string" id="6517872">&#34;bytes:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="6517891">,</span>&nbsp;<span class="ident" id="6517893">err</span><span class="op" id="6517896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6517900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6517904">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517945">y</span>&nbsp;<span class="op" id="6517947">:=</span>&nbsp;<span class="op" id="6517950">[</span><span class="op" id="6517951">]</span><span class="builtintype" id="6517952">byte</span><span class="op" id="6517956">(</span><span class="string" id="6517957">&#34;ABCDE&#34;</span><span class="op" id="6517964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517968">addr</span>&nbsp;<span class="op" id="6517973">:=</span>&nbsp;<span class="op" id="6517976">&amp;</span><span class="ident" id="6517977">y</span><span class="op" id="6517978">[</span><span class="num" id="6517979">0</span><span class="op" id="6517980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6517984">dec</span>&nbsp;<span class="op" id="6517988">:=</span>&nbsp;<span class="ident" id="6517991">NewDecoder</span><span class="op" id="6518001">(</span><span class="ident" id="6518002">buf</span><span class="op" id="6518005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518009">err</span>&nbsp;<span class="op" id="6518013">=</span>&nbsp;<span class="ident" id="6518015">dec</span><span class="op" id="6518018">.</span><span class="ident" id="6518019">Decode</span><span class="op" id="6518025">(</span><span class="op" id="6518026">&amp;</span><span class="ident" id="6518027">y</span><span class="op" id="6518028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518032">if</span>&nbsp;<span class="ident" id="6518035">err</span>&nbsp;<span class="op" id="6518039">!=</span>&nbsp;<span class="builtintype" id="6518042">nil</span>&nbsp;<span class="op" id="6518046">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518051">t</span><span class="op" id="6518052">.</span><span class="ident" id="6518053">Fatal</span><span class="op" id="6518058">(</span><span class="string" id="6518059">&#34;bytes:&nbsp;decode:&#34;</span><span class="op" id="6518075">,</span>&nbsp;<span class="ident" id="6518077">err</span><span class="op" id="6518080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518088">if</span>&nbsp;<span class="op" id="6518091">!</span><span class="ident" id="6518092">bytes</span><span class="op" id="6518097">.</span><span class="ident" id="6518098">Equal</span><span class="op" id="6518103">(</span><span class="ident" id="6518104">x</span><span class="op" id="6518105">,</span>&nbsp;<span class="ident" id="6518107">y</span><span class="op" id="6518108">)</span>&nbsp;<span class="op" id="6518110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518115">t</span><span class="op" id="6518116">.</span><span class="ident" id="6518117">Errorf</span><span class="op" id="6518123">(</span><span class="string" id="6518124">&#34;bytes:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="6518153">,</span>&nbsp;<span class="ident" id="6518155">x</span><span class="op" id="6518156">,</span>&nbsp;<span class="ident" id="6518158">y</span><span class="op" id="6518159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518163">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518167">if</span>&nbsp;<span class="ident" id="6518170">addr</span>&nbsp;<span class="op" id="6518175">!=</span>&nbsp;<span class="op" id="6518178">&amp;</span><span class="ident" id="6518179">y</span><span class="op" id="6518180">[</span><span class="num" id="6518181">0</span><span class="op" id="6518182">]</span>&nbsp;<span class="op" id="6518184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518189">t</span><span class="op" id="6518190">.</span><span class="ident" id="6518191">Errorf</span><span class="op" id="6518197">(</span><span class="string" id="6518198">&#34;bytes:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="6518231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6518241">//&nbsp;general&nbsp;slice</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518263">x</span>&nbsp;<span class="op" id="6518265">:=</span>&nbsp;<span class="op" id="6518268">[</span><span class="op" id="6518269">]</span><span class="builtintype" id="6518270">rune</span><span class="op" id="6518274">(</span><span class="string" id="6518275">&#34;abcd&#34;</span><span class="op" id="6518281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518285">enc</span>&nbsp;<span class="op" id="6518289">:=</span>&nbsp;<span class="ident" id="6518292">NewEncoder</span><span class="op" id="6518302">(</span><span class="ident" id="6518303">buf</span><span class="op" id="6518306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518310">err</span>&nbsp;<span class="op" id="6518314">:=</span>&nbsp;<span class="ident" id="6518317">enc</span><span class="op" id="6518320">.</span><span class="ident" id="6518321">Encode</span><span class="op" id="6518327">(</span><span class="ident" id="6518328">x</span><span class="op" id="6518329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518333">if</span>&nbsp;<span class="ident" id="6518336">err</span>&nbsp;<span class="op" id="6518340">!=</span>&nbsp;<span class="builtintype" id="6518343">nil</span>&nbsp;<span class="op" id="6518347">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518352">t</span><span class="op" id="6518353">.</span><span class="ident" id="6518354">Errorf</span><span class="op" id="6518360">(</span><span class="string" id="6518361">&#34;ints:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="6518379">,</span>&nbsp;<span class="ident" id="6518381">err</span><span class="op" id="6518384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6518392">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518433">y</span>&nbsp;<span class="op" id="6518435">:=</span>&nbsp;<span class="op" id="6518438">[</span><span class="op" id="6518439">]</span><span class="builtintype" id="6518440">rune</span><span class="op" id="6518444">(</span><span class="string" id="6518445">&#34;ABCDE&#34;</span><span class="op" id="6518452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518456">addr</span>&nbsp;<span class="op" id="6518461">:=</span>&nbsp;<span class="op" id="6518464">&amp;</span><span class="ident" id="6518465">y</span><span class="op" id="6518466">[</span><span class="num" id="6518467">0</span><span class="op" id="6518468">]</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518472">dec</span>&nbsp;<span class="op" id="6518476">:=</span>&nbsp;<span class="ident" id="6518479">NewDecoder</span><span class="op" id="6518489">(</span><span class="ident" id="6518490">buf</span><span class="op" id="6518493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518497">err</span>&nbsp;<span class="op" id="6518501">=</span>&nbsp;<span class="ident" id="6518503">dec</span><span class="op" id="6518506">.</span><span class="ident" id="6518507">Decode</span><span class="op" id="6518513">(</span><span class="op" id="6518514">&amp;</span><span class="ident" id="6518515">y</span><span class="op" id="6518516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518520">if</span>&nbsp;<span class="ident" id="6518523">err</span>&nbsp;<span class="op" id="6518527">!=</span>&nbsp;<span class="builtintype" id="6518530">nil</span>&nbsp;<span class="op" id="6518534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518539">t</span><span class="op" id="6518540">.</span><span class="ident" id="6518541">Fatal</span><span class="op" id="6518546">(</span><span class="string" id="6518547">&#34;ints:&nbsp;decode:&#34;</span><span class="op" id="6518562">,</span>&nbsp;<span class="ident" id="6518564">err</span><span class="op" id="6518567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518571">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518575">if</span>&nbsp;<span class="op" id="6518578">!</span><span class="ident" id="6518579">reflect</span><span class="op" id="6518586">.</span><span class="ident" id="6518587">DeepEqual</span><span class="op" id="6518596">(</span><span class="ident" id="6518597">x</span><span class="op" id="6518598">,</span>&nbsp;<span class="ident" id="6518600">y</span><span class="op" id="6518601">)</span>&nbsp;<span class="op" id="6518603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518608">t</span><span class="op" id="6518609">.</span><span class="ident" id="6518610">Errorf</span><span class="op" id="6518616">(</span><span class="string" id="6518617">&#34;ints:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="6518645">,</span>&nbsp;<span class="ident" id="6518647">x</span><span class="op" id="6518648">,</span>&nbsp;<span class="ident" id="6518650">y</span><span class="op" id="6518651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518659">if</span>&nbsp;<span class="ident" id="6518662">addr</span>&nbsp;<span class="op" id="6518667">!=</span>&nbsp;<span class="op" id="6518670">&amp;</span><span class="ident" id="6518671">y</span><span class="op" id="6518672">[</span><span class="num" id="6518673">0</span><span class="op" id="6518674">]</span>&nbsp;<span class="op" id="6518676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518681">t</span><span class="op" id="6518682">.</span><span class="ident" id="6518683">Errorf</span><span class="op" id="6518689">(</span><span class="string" id="6518690">&#34;ints:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="6518722">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518729">}</span><br>
<span class="lineno"></span><span class="op" id="6518731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6518734">//&nbsp;Used&nbsp;to&nbsp;crash:&nbsp;negative&nbsp;count&nbsp;in&nbsp;recvMessage.</span><br>
<span class="lineno">705</span><span class="keyword" id="6518783">func</span>&nbsp;<span class="ident" id="6518788">TestBadCount</span><span class="op" id="6518800">(</span><span class="ident" id="6518801">t</span>&nbsp;<span class="op" id="6518803">*</span><span class="ident" id="6518804">testing</span><span class="op" id="6518811">.</span><span class="ident" id="6518812">T</span><span class="op" id="6518813">)</span>&nbsp;<span class="op" id="6518815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518818">b</span>&nbsp;<span class="op" id="6518820">:=</span>&nbsp;<span class="op" id="6518823">[</span><span class="op" id="6518824">]</span><span class="builtintype" id="6518825">byte</span><span class="op" id="6518829">{</span><span class="num" id="6518830">0xfb</span><span class="op" id="6518834">,</span>&nbsp;<span class="num" id="6518836">0xa5</span><span class="op" id="6518840">,</span>&nbsp;<span class="num" id="6518842">0x82</span><span class="op" id="6518846">,</span>&nbsp;<span class="num" id="6518848">0x2f</span><span class="op" id="6518852">,</span>&nbsp;<span class="num" id="6518854">0xca</span><span class="op" id="6518858">,</span>&nbsp;<span class="num" id="6518860">0x1</span><span class="op" id="6518863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518866">if</span>&nbsp;<span class="ident" id="6518869">err</span>&nbsp;<span class="op" id="6518873">:=</span>&nbsp;<span class="ident" id="6518876">NewDecoder</span><span class="op" id="6518886">(</span><span class="ident" id="6518887">bytes</span><span class="op" id="6518892">.</span><span class="ident" id="6518893">NewReader</span><span class="op" id="6518902">(</span><span class="ident" id="6518903">b</span><span class="op" id="6518904">)</span><span class="op" id="6518905">)</span><span class="op" id="6518906">.</span><span class="ident" id="6518907">Decode</span><span class="op" id="6518913">(</span><span class="builtintype" id="6518914">nil</span><span class="op" id="6518917">)</span><span class="op" id="6518918">;</span>&nbsp;<span class="ident" id="6518920">err</span>&nbsp;<span class="op" id="6518924">==</span>&nbsp;<span class="builtintype" id="6518927">nil</span>&nbsp;<span class="op" id="6518931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518935">t</span><span class="op" id="6518936">.</span><span class="ident" id="6518937">Error</span><span class="op" id="6518942">(</span><span class="string" id="6518943">&#34;expected&nbsp;error&nbsp;from&nbsp;bad&nbsp;count&#34;</span><span class="op" id="6518974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518977">}</span>&nbsp;<span class="keyword" id="6518979">else</span>&nbsp;<span class="keyword" id="6518984">if</span>&nbsp;<span class="ident" id="6518987">err</span><span class="op" id="6518990">.</span><span class="ident" id="6518991">Error</span><span class="op" id="6518996">(</span><span class="op" id="6518997">)</span>&nbsp;<span class="op" id="6518999">!=</span>&nbsp;<span class="ident" id="6519002">errBadCount</span><span class="op" id="6519013">.</span><span class="ident" id="6519014">Error</span><span class="op" id="6519019">(</span><span class="op" id="6519020">)</span>&nbsp;<span class="op" id="6519022">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519026">t</span><span class="op" id="6519027">.</span><span class="ident" id="6519028">Error</span><span class="op" id="6519033">(</span><span class="string" id="6519034">&#34;expected&nbsp;bad&nbsp;count&nbsp;error;&nbsp;got&#34;</span><span class="op" id="6519065">,</span>&nbsp;<span class="ident" id="6519067">err</span><span class="op" id="6519070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519073">}</span><br>
<span class="lineno"></span><span class="op" id="6519075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6519078">//&nbsp;Verify&nbsp;that&nbsp;sequential&nbsp;Decoders&nbsp;built&nbsp;on&nbsp;a&nbsp;single&nbsp;input&nbsp;will</span><br>
<span class="lineno">715</span><span class="comment" id="6519142">//&nbsp;succeed&nbsp;if&nbsp;the&nbsp;input&nbsp;implements&nbsp;ReadByte&nbsp;and&nbsp;there&nbsp;is&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="6519202">//&nbsp;type&nbsp;information&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6519237">func</span>&nbsp;<span class="ident" id="6519242">TestSequentialDecoder</span><span class="op" id="6519263">(</span><span class="ident" id="6519264">t</span>&nbsp;<span class="op" id="6519266">*</span><span class="ident" id="6519267">testing</span><span class="op" id="6519274">.</span><span class="ident" id="6519275">T</span><span class="op" id="6519276">)</span>&nbsp;<span class="op" id="6519278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519281">b</span>&nbsp;<span class="op" id="6519283">:=</span>&nbsp;<span class="builtinfunc" id="6519286">new</span><span class="op" id="6519289">(</span><span class="ident" id="6519290">bytes</span><span class="op" id="6519295">.</span><span class="ident" id="6519296">Buffer</span><span class="op" id="6519302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519305">enc</span>&nbsp;<span class="op" id="6519309">:=</span>&nbsp;<span class="ident" id="6519312">NewEncoder</span><span class="op" id="6519322">(</span><span class="ident" id="6519323">b</span><span class="op" id="6519324">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519327">const</span>&nbsp;<span class="ident" id="6519333">count</span>&nbsp;<span class="op" id="6519339">=</span>&nbsp;<span class="num" id="6519341">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519345">for</span>&nbsp;<span class="ident" id="6519349">i</span>&nbsp;<span class="op" id="6519351">:=</span>&nbsp;<span class="num" id="6519354">0</span><span class="op" id="6519355">;</span>&nbsp;<span class="ident" id="6519357">i</span>&nbsp;<span class="op" id="6519359">&lt;</span>&nbsp;<span class="ident" id="6519361">count</span><span class="op" id="6519366">;</span>&nbsp;<span class="ident" id="6519368">i</span><span class="op" id="6519369">++</span>&nbsp;<span class="op" id="6519372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519376">s</span>&nbsp;<span class="op" id="6519378">:=</span>&nbsp;<span class="ident" id="6519381">fmt</span><span class="op" id="6519384">.</span><span class="ident" id="6519385">Sprintf</span><span class="op" id="6519392">(</span><span class="string" id="6519393">&#34;%d&#34;</span><span class="op" id="6519397">,</span>&nbsp;<span class="ident" id="6519399">i</span><span class="op" id="6519400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519404">if</span>&nbsp;<span class="ident" id="6519407">err</span>&nbsp;<span class="op" id="6519411">:=</span>&nbsp;<span class="ident" id="6519414">enc</span><span class="op" id="6519417">.</span><span class="ident" id="6519418">Encode</span><span class="op" id="6519424">(</span><span class="ident" id="6519425">s</span><span class="op" id="6519426">)</span><span class="op" id="6519427">;</span>&nbsp;<span class="ident" id="6519429">err</span>&nbsp;<span class="op" id="6519433">!=</span>&nbsp;<span class="builtintype" id="6519436">nil</span>&nbsp;<span class="op" id="6519440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519445">t</span><span class="op" id="6519446">.</span><span class="ident" id="6519447">Error</span><span class="op" id="6519452">(</span><span class="string" id="6519453">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="6519468">,</span>&nbsp;<span class="ident" id="6519470">err</span><span class="op" id="6519473">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519483">for</span>&nbsp;<span class="ident" id="6519487">i</span>&nbsp;<span class="op" id="6519489">:=</span>&nbsp;<span class="num" id="6519492">0</span><span class="op" id="6519493">;</span>&nbsp;<span class="ident" id="6519495">i</span>&nbsp;<span class="op" id="6519497">&lt;</span>&nbsp;<span class="ident" id="6519499">count</span><span class="op" id="6519504">;</span>&nbsp;<span class="ident" id="6519506">i</span><span class="op" id="6519507">++</span>&nbsp;<span class="op" id="6519510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519514">dec</span>&nbsp;<span class="op" id="6519518">:=</span>&nbsp;<span class="ident" id="6519521">NewDecoder</span><span class="op" id="6519531">(</span><span class="ident" id="6519532">b</span><span class="op" id="6519533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519537">var</span>&nbsp;<span class="ident" id="6519541">s</span>&nbsp;<span class="builtintype" id="6519543">string</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519552">if</span>&nbsp;<span class="ident" id="6519555">err</span>&nbsp;<span class="op" id="6519559">:=</span>&nbsp;<span class="ident" id="6519562">dec</span><span class="op" id="6519565">.</span><span class="ident" id="6519566">Decode</span><span class="op" id="6519572">(</span><span class="op" id="6519573">&amp;</span><span class="ident" id="6519574">s</span><span class="op" id="6519575">)</span><span class="op" id="6519576">;</span>&nbsp;<span class="ident" id="6519578">err</span>&nbsp;<span class="op" id="6519582">!=</span>&nbsp;<span class="builtintype" id="6519585">nil</span>&nbsp;<span class="op" id="6519589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519594">t</span><span class="op" id="6519595">.</span><span class="ident" id="6519596">Fatal</span><span class="op" id="6519601">(</span><span class="string" id="6519602">&#34;decoder&nbsp;fail:&#34;</span><span class="op" id="6519617">,</span>&nbsp;<span class="ident" id="6519619">err</span><span class="op" id="6519622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519630">if</span>&nbsp;<span class="ident" id="6519633">s</span>&nbsp;<span class="op" id="6519635">!=</span>&nbsp;<span class="ident" id="6519638">fmt</span><span class="op" id="6519641">.</span><span class="ident" id="6519642">Sprintf</span><span class="op" id="6519649">(</span><span class="string" id="6519650">&#34;%d&#34;</span><span class="op" id="6519654">,</span>&nbsp;<span class="ident" id="6519656">i</span><span class="op" id="6519657">)</span>&nbsp;<span class="op" id="6519659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519664">t</span><span class="op" id="6519665">.</span><span class="ident" id="6519666">Fatalf</span><span class="op" id="6519672">(</span><span class="string" id="6519673">&#34;decode&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%s&#34;</span><span class="op" id="6519700">,</span>&nbsp;<span class="ident" id="6519702">i</span><span class="op" id="6519703">,</span>&nbsp;<span class="ident" id="6519705">s</span><span class="op" id="6519706">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519713">}</span><br>
<span class="lineno"></span><span class="op" id="6519715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6519718">//&nbsp;Should&nbsp;be&nbsp;able&nbsp;to&nbsp;have&nbsp;unrepresentable&nbsp;fields&nbsp;(chan,&nbsp;func,&nbsp;*chan&nbsp;etc.);&nbsp;we&nbsp;just&nbsp;ignore&nbsp;them.</span><br>
<span class="lineno">740</span><span class="keyword" id="6519814">type</span>&nbsp;<span class="ident" id="6519819">Bug2</span>&nbsp;<span class="keyword" id="6519824">struct</span>&nbsp;<span class="op" id="6519831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519834">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6519838">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519843">C</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519847">chan</span>&nbsp;<span class="builtintype" id="6519852">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519857">CP</span>&nbsp;&nbsp;<span class="op" id="6519861">*</span><span class="keyword" id="6519862">chan</span>&nbsp;<span class="builtintype" id="6519867">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519872">F</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519876">func</span><span class="op" id="6519880">(</span><span class="op" id="6519881">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519884">FPP</span>&nbsp;<span class="op" id="6519888">*</span><span class="op" id="6519889">*</span><span class="keyword" id="6519890">func</span><span class="op" id="6519894">(</span><span class="op" id="6519895">)</span><br>
<span class="lineno"></span><span class="op" id="6519897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519900">func</span>&nbsp;<span class="ident" id="6519905">TestChanFuncIgnored</span><span class="op" id="6519924">(</span><span class="ident" id="6519925">t</span>&nbsp;<span class="op" id="6519927">*</span><span class="ident" id="6519928">testing</span><span class="op" id="6519935">.</span><span class="ident" id="6519936">T</span><span class="op" id="6519937">)</span>&nbsp;<span class="op" id="6519939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519942">c</span>&nbsp;<span class="op" id="6519944">:=</span>&nbsp;<span class="builtinfunc" id="6519947">make</span><span class="op" id="6519951">(</span><span class="keyword" id="6519952">chan</span>&nbsp;<span class="builtintype" id="6519957">int</span><span class="op" id="6519960">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519963">f</span>&nbsp;<span class="op" id="6519965">:=</span>&nbsp;<span class="keyword" id="6519968">func</span><span class="op" id="6519972">(</span><span class="op" id="6519973">)</span>&nbsp;<span class="op" id="6519975">{</span><span class="op" id="6519976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519979">fp</span>&nbsp;<span class="op" id="6519982">:=</span>&nbsp;<span class="op" id="6519985">&amp;</span><span class="ident" id="6519986">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519989">b0</span>&nbsp;<span class="op" id="6519992">:=</span>&nbsp;<span class="ident" id="6519995">Bug2</span><span class="op" id="6519999">{</span><span class="num" id="6520000">23</span><span class="op" id="6520002">,</span>&nbsp;<span class="ident" id="6520004">c</span><span class="op" id="6520005">,</span>&nbsp;<span class="op" id="6520007">&amp;</span><span class="ident" id="6520008">c</span><span class="op" id="6520009">,</span>&nbsp;<span class="ident" id="6520011">f</span><span class="op" id="6520012">,</span>&nbsp;<span class="op" id="6520014">&amp;</span><span class="ident" id="6520015">fp</span><span class="op" id="6520017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520020">var</span>&nbsp;<span class="ident" id="6520024">buf</span>&nbsp;<span class="ident" id="6520028">bytes</span><span class="op" id="6520033">.</span><span class="ident" id="6520034">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520042">enc</span>&nbsp;<span class="op" id="6520046">:=</span>&nbsp;<span class="ident" id="6520049">NewEncoder</span><span class="op" id="6520059">(</span><span class="op" id="6520060">&amp;</span><span class="ident" id="6520061">buf</span><span class="op" id="6520064">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520067">if</span>&nbsp;<span class="ident" id="6520070">err</span>&nbsp;<span class="op" id="6520074">:=</span>&nbsp;<span class="ident" id="6520077">enc</span><span class="op" id="6520080">.</span><span class="ident" id="6520081">Encode</span><span class="op" id="6520087">(</span><span class="ident" id="6520088">b0</span><span class="op" id="6520090">)</span><span class="op" id="6520091">;</span>&nbsp;<span class="ident" id="6520093">err</span>&nbsp;<span class="op" id="6520097">!=</span>&nbsp;<span class="builtintype" id="6520100">nil</span>&nbsp;<span class="op" id="6520104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520108">t</span><span class="op" id="6520109">.</span><span class="ident" id="6520110">Fatal</span><span class="op" id="6520115">(</span><span class="string" id="6520116">&#34;error&nbsp;encoding:&#34;</span><span class="op" id="6520133">,</span>&nbsp;<span class="ident" id="6520135">err</span><span class="op" id="6520138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520144">var</span>&nbsp;<span class="ident" id="6520148">b1</span>&nbsp;<span class="ident" id="6520151">Bug2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520157">err</span>&nbsp;<span class="op" id="6520161">:=</span>&nbsp;<span class="ident" id="6520164">NewDecoder</span><span class="op" id="6520174">(</span><span class="op" id="6520175">&amp;</span><span class="ident" id="6520176">buf</span><span class="op" id="6520179">)</span><span class="op" id="6520180">.</span><span class="ident" id="6520181">Decode</span><span class="op" id="6520187">(</span><span class="op" id="6520188">&amp;</span><span class="ident" id="6520189">b1</span><span class="op" id="6520191">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520194">if</span>&nbsp;<span class="ident" id="6520197">err</span>&nbsp;<span class="op" id="6520201">!=</span>&nbsp;<span class="builtintype" id="6520204">nil</span>&nbsp;<span class="op" id="6520208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520212">t</span><span class="op" id="6520213">.</span><span class="ident" id="6520214">Fatal</span><span class="op" id="6520219">(</span><span class="string" id="6520220">&#34;decode:&#34;</span><span class="op" id="6520229">,</span>&nbsp;<span class="ident" id="6520231">err</span><span class="op" id="6520234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520240">if</span>&nbsp;<span class="ident" id="6520243">b1</span><span class="op" id="6520245">.</span><span class="ident" id="6520246">A</span>&nbsp;<span class="op" id="6520248">!=</span>&nbsp;<span class="ident" id="6520251">b0</span><span class="op" id="6520253">.</span><span class="ident" id="6520254">A</span>&nbsp;<span class="op" id="6520256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520260">t</span><span class="op" id="6520261">.</span><span class="ident" id="6520262">Fatalf</span><span class="op" id="6520268">(</span><span class="string" id="6520269">&#34;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6520285">,</span>&nbsp;<span class="ident" id="6520287">b1</span><span class="op" id="6520289">.</span><span class="ident" id="6520290">A</span><span class="op" id="6520291">,</span>&nbsp;<span class="ident" id="6520293">b0</span><span class="op" id="6520295">.</span><span class="ident" id="6520296">A</span><span class="op" id="6520297">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520303">if</span>&nbsp;<span class="ident" id="6520306">b1</span><span class="op" id="6520308">.</span><span class="ident" id="6520309">C</span>&nbsp;<span class="op" id="6520311">!=</span>&nbsp;<span class="builtintype" id="6520314">nil</span>&nbsp;<span class="op" id="6520318">||</span>&nbsp;<span class="ident" id="6520321">b1</span><span class="op" id="6520323">.</span><span class="ident" id="6520324">CP</span>&nbsp;<span class="op" id="6520327">!=</span>&nbsp;<span class="builtintype" id="6520330">nil</span>&nbsp;<span class="op" id="6520334">||</span>&nbsp;<span class="ident" id="6520337">b1</span><span class="op" id="6520339">.</span><span class="ident" id="6520340">F</span>&nbsp;<span class="op" id="6520342">!=</span>&nbsp;<span class="builtintype" id="6520345">nil</span>&nbsp;<span class="op" id="6520349">||</span>&nbsp;<span class="ident" id="6520352">b1</span><span class="op" id="6520354">.</span><span class="ident" id="6520355">FPP</span>&nbsp;<span class="op" id="6520359">!=</span>&nbsp;<span class="builtintype" id="6520362">nil</span>&nbsp;<span class="op" id="6520366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520370">t</span><span class="op" id="6520371">.</span><span class="ident" id="6520372">Fatal</span><span class="op" id="6520377">(</span><span class="string" id="6520378">&#34;unexpected&nbsp;value&nbsp;for&nbsp;chan&nbsp;or&nbsp;func&#34;</span><span class="op" id="6520413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520416">}</span><br>
<span class="lineno"></span><span class="op" id="6520418">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="keyword" id="6520421">func</span>&nbsp;<span class="ident" id="6520426">TestSliceIncompatibility</span><span class="op" id="6520450">(</span><span class="ident" id="6520451">t</span>&nbsp;<span class="op" id="6520453">*</span><span class="ident" id="6520454">testing</span><span class="op" id="6520461">.</span><span class="ident" id="6520462">T</span><span class="op" id="6520463">)</span>&nbsp;<span class="op" id="6520465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520468">var</span>&nbsp;<span class="ident" id="6520472">in</span>&nbsp;<span class="op" id="6520475">=</span>&nbsp;<span class="op" id="6520477">[</span><span class="op" id="6520478">]</span><span class="builtintype" id="6520479">byte</span><span class="op" id="6520483">{</span><span class="num" id="6520484">1</span><span class="op" id="6520485">,</span>&nbsp;<span class="num" id="6520487">2</span><span class="op" id="6520488">,</span>&nbsp;<span class="num" id="6520490">3</span><span class="op" id="6520491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520494">var</span>&nbsp;<span class="ident" id="6520498">out</span>&nbsp;<span class="op" id="6520502">[</span><span class="op" id="6520503">]</span><span class="builtintype" id="6520504">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520509">if</span>&nbsp;<span class="ident" id="6520512">err</span>&nbsp;<span class="op" id="6520516">:=</span>&nbsp;<span class="ident" id="6520519">encAndDec</span><span class="op" id="6520528">(</span><span class="ident" id="6520529">in</span><span class="op" id="6520531">,</span>&nbsp;<span class="op" id="6520533">&amp;</span><span class="ident" id="6520534">out</span><span class="op" id="6520537">)</span><span class="op" id="6520538">;</span>&nbsp;<span class="ident" id="6520540">err</span>&nbsp;<span class="op" id="6520544">==</span>&nbsp;<span class="builtintype" id="6520547">nil</span>&nbsp;<span class="op" id="6520551">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520555">t</span><span class="op" id="6520556">.</span><span class="ident" id="6520557">Error</span><span class="op" id="6520562">(</span><span class="string" id="6520563">&#34;expected&nbsp;compatibility&nbsp;error&#34;</span><span class="op" id="6520593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520596">}</span><br>
<span class="lineno"></span><span class="op" id="6520598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6520601">//&nbsp;Mutually&nbsp;recursive&nbsp;slices&nbsp;of&nbsp;structs&nbsp;caused&nbsp;problems.</span><br>
<span class="lineno">780</span><span class="keyword" id="6520658">type</span>&nbsp;<span class="ident" id="6520663">Bug3</span>&nbsp;<span class="keyword" id="6520668">struct</span>&nbsp;<span class="op" id="6520675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520678">Num</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6520687">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520692">Children</span>&nbsp;<span class="op" id="6520701">[</span><span class="op" id="6520702">]</span><span class="op" id="6520703">*</span><span class="ident" id="6520704">Bug3</span><br>
<span class="lineno"></span><span class="op" id="6520709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">785</span><span class="keyword" id="6520712">func</span>&nbsp;<span class="ident" id="6520717">TestGobPtrSlices</span><span class="op" id="6520733">(</span><span class="ident" id="6520734">t</span>&nbsp;<span class="op" id="6520736">*</span><span class="ident" id="6520737">testing</span><span class="op" id="6520744">.</span><span class="ident" id="6520745">T</span><span class="op" id="6520746">)</span>&nbsp;<span class="op" id="6520748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520751">in</span>&nbsp;<span class="op" id="6520754">:=</span>&nbsp;<span class="op" id="6520757">[</span><span class="op" id="6520758">]</span><span class="op" id="6520759">*</span><span class="ident" id="6520760">Bug3</span><span class="op" id="6520764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520768">{</span><span class="num" id="6520769">1</span><span class="op" id="6520770">,</span>&nbsp;<span class="builtintype" id="6520772">nil</span><span class="op" id="6520775">}</span><span class="op" id="6520776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520780">{</span><span class="num" id="6520781">2</span><span class="op" id="6520782">,</span>&nbsp;<span class="builtintype" id="6520784">nil</span><span class="op" id="6520787">}</span><span class="op" id="6520788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520791">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520794">b</span>&nbsp;<span class="op" id="6520796">:=</span>&nbsp;<span class="builtinfunc" id="6520799">new</span><span class="op" id="6520802">(</span><span class="ident" id="6520803">bytes</span><span class="op" id="6520808">.</span><span class="ident" id="6520809">Buffer</span><span class="op" id="6520815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520818">err</span>&nbsp;<span class="op" id="6520822">:=</span>&nbsp;<span class="ident" id="6520825">NewEncoder</span><span class="op" id="6520835">(</span><span class="ident" id="6520836">b</span><span class="op" id="6520837">)</span><span class="op" id="6520838">.</span><span class="ident" id="6520839">Encode</span><span class="op" id="6520845">(</span><span class="op" id="6520846">&amp;</span><span class="ident" id="6520847">in</span><span class="op" id="6520849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520852">if</span>&nbsp;<span class="ident" id="6520855">err</span>&nbsp;<span class="op" id="6520859">!=</span>&nbsp;<span class="builtintype" id="6520862">nil</span>&nbsp;<span class="op" id="6520866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520870">t</span><span class="op" id="6520871">.</span><span class="ident" id="6520872">Fatal</span><span class="op" id="6520877">(</span><span class="string" id="6520878">&#34;encode:&#34;</span><span class="op" id="6520887">,</span>&nbsp;<span class="ident" id="6520889">err</span><span class="op" id="6520892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520895">}</span><br>
<span class="lineno">795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520899">var</span>&nbsp;<span class="ident" id="6520903">out</span>&nbsp;<span class="op" id="6520907">[</span><span class="op" id="6520908">]</span><span class="op" id="6520909">*</span><span class="ident" id="6520910">Bug3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520916">err</span>&nbsp;<span class="op" id="6520920">=</span>&nbsp;<span class="ident" id="6520922">NewDecoder</span><span class="op" id="6520932">(</span><span class="ident" id="6520933">b</span><span class="op" id="6520934">)</span><span class="op" id="6520935">.</span><span class="ident" id="6520936">Decode</span><span class="op" id="6520942">(</span><span class="op" id="6520943">&amp;</span><span class="ident" id="6520944">out</span><span class="op" id="6520947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520950">if</span>&nbsp;<span class="ident" id="6520953">err</span>&nbsp;<span class="op" id="6520957">!=</span>&nbsp;<span class="builtintype" id="6520960">nil</span>&nbsp;<span class="op" id="6520964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520968">t</span><span class="op" id="6520969">.</span><span class="ident" id="6520970">Fatal</span><span class="op" id="6520975">(</span><span class="string" id="6520976">&#34;decode:&#34;</span><span class="op" id="6520985">,</span>&nbsp;<span class="ident" id="6520987">err</span><span class="op" id="6520990">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520996">if</span>&nbsp;<span class="op" id="6520999">!</span><span class="ident" id="6521000">reflect</span><span class="op" id="6521007">.</span><span class="ident" id="6521008">DeepEqual</span><span class="op" id="6521017">(</span><span class="ident" id="6521018">in</span><span class="op" id="6521020">,</span>&nbsp;<span class="ident" id="6521022">out</span><span class="op" id="6521025">)</span>&nbsp;<span class="op" id="6521027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521031">t</span><span class="op" id="6521032">.</span><span class="ident" id="6521033">Fatalf</span><span class="op" id="6521039">(</span><span class="string" id="6521040">&#34;got&nbsp;%v;&nbsp;wanted&nbsp;%v&#34;</span><span class="op" id="6521059">,</span>&nbsp;<span class="ident" id="6521061">out</span><span class="op" id="6521064">,</span>&nbsp;<span class="ident" id="6521066">in</span><span class="op" id="6521068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521071">}</span><br>
<span class="lineno"></span><span class="op" id="6521073">}</span><br>
<span class="lineno">805</span><br>
<span class="lineno"></span><span class="comment" id="6521076">//&nbsp;getDecEnginePtr&nbsp;cached&nbsp;engine&nbsp;for&nbsp;ut.base&nbsp;instead&nbsp;of&nbsp;ut.user&nbsp;so&nbsp;we&nbsp;passed</span><br>
<span class="lineno"></span><span class="comment" id="6521153">//&nbsp;a&nbsp;*map&nbsp;and&nbsp;then&nbsp;tried&nbsp;to&nbsp;reuse&nbsp;its&nbsp;engine&nbsp;to&nbsp;decode&nbsp;the&nbsp;inner&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="6521223">func</span>&nbsp;<span class="ident" id="6521228">TestPtrToMapOfMap</span><span class="op" id="6521245">(</span><span class="ident" id="6521246">t</span>&nbsp;<span class="op" id="6521248">*</span><span class="ident" id="6521249">testing</span><span class="op" id="6521256">.</span><span class="ident" id="6521257">T</span><span class="op" id="6521258">)</span>&nbsp;<span class="op" id="6521260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521263">Register</span><span class="op" id="6521271">(</span><span class="builtinfunc" id="6521272">make</span><span class="op" id="6521276">(</span><span class="keyword" id="6521277">map</span><span class="op" id="6521280">[</span><span class="builtintype" id="6521281">string</span><span class="op" id="6521287">]</span><span class="keyword" id="6521288">interface</span><span class="op" id="6521297">{</span><span class="op" id="6521298">}</span><span class="op" id="6521299">)</span><span class="op" id="6521300">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521303">subdata</span>&nbsp;<span class="op" id="6521311">:=</span>&nbsp;<span class="builtinfunc" id="6521314">make</span><span class="op" id="6521318">(</span><span class="keyword" id="6521319">map</span><span class="op" id="6521322">[</span><span class="builtintype" id="6521323">string</span><span class="op" id="6521329">]</span><span class="keyword" id="6521330">interface</span><span class="op" id="6521339">{</span><span class="op" id="6521340">}</span><span class="op" id="6521341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521344">subdata</span><span class="op" id="6521351">[</span><span class="string" id="6521352">&#34;bar&#34;</span><span class="op" id="6521357">]</span>&nbsp;<span class="op" id="6521359">=</span>&nbsp;<span class="string" id="6521361">&#34;baz&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521368">data</span>&nbsp;<span class="op" id="6521373">:=</span>&nbsp;<span class="builtinfunc" id="6521376">make</span><span class="op" id="6521380">(</span><span class="keyword" id="6521381">map</span><span class="op" id="6521384">[</span><span class="builtintype" id="6521385">string</span><span class="op" id="6521391">]</span><span class="keyword" id="6521392">interface</span><span class="op" id="6521401">{</span><span class="op" id="6521402">}</span><span class="op" id="6521403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521406">data</span><span class="op" id="6521410">[</span><span class="string" id="6521411">&#34;foo&#34;</span><span class="op" id="6521416">]</span>&nbsp;<span class="op" id="6521418">=</span>&nbsp;<span class="ident" id="6521420">subdata</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521430">b</span>&nbsp;<span class="op" id="6521432">:=</span>&nbsp;<span class="builtinfunc" id="6521435">new</span><span class="op" id="6521438">(</span><span class="ident" id="6521439">bytes</span><span class="op" id="6521444">.</span><span class="ident" id="6521445">Buffer</span><span class="op" id="6521451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521454">err</span>&nbsp;<span class="op" id="6521458">:=</span>&nbsp;<span class="ident" id="6521461">NewEncoder</span><span class="op" id="6521471">(</span><span class="ident" id="6521472">b</span><span class="op" id="6521473">)</span><span class="op" id="6521474">.</span><span class="ident" id="6521475">Encode</span><span class="op" id="6521481">(</span><span class="ident" id="6521482">data</span><span class="op" id="6521486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521489">if</span>&nbsp;<span class="ident" id="6521492">err</span>&nbsp;<span class="op" id="6521496">!=</span>&nbsp;<span class="builtintype" id="6521499">nil</span>&nbsp;<span class="op" id="6521503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521507">t</span><span class="op" id="6521508">.</span><span class="ident" id="6521509">Fatal</span><span class="op" id="6521514">(</span><span class="string" id="6521515">&#34;encode:&#34;</span><span class="op" id="6521524">,</span>&nbsp;<span class="ident" id="6521526">err</span><span class="op" id="6521529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521532">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521535">var</span>&nbsp;<span class="ident" id="6521539">newData</span>&nbsp;<span class="keyword" id="6521547">map</span><span class="op" id="6521550">[</span><span class="builtintype" id="6521551">string</span><span class="op" id="6521557">]</span><span class="keyword" id="6521558">interface</span><span class="op" id="6521567">{</span><span class="op" id="6521568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521571">err</span>&nbsp;<span class="op" id="6521575">=</span>&nbsp;<span class="ident" id="6521577">NewDecoder</span><span class="op" id="6521587">(</span><span class="ident" id="6521588">b</span><span class="op" id="6521589">)</span><span class="op" id="6521590">.</span><span class="ident" id="6521591">Decode</span><span class="op" id="6521597">(</span><span class="op" id="6521598">&amp;</span><span class="ident" id="6521599">newData</span><span class="op" id="6521606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521609">if</span>&nbsp;<span class="ident" id="6521612">err</span>&nbsp;<span class="op" id="6521616">!=</span>&nbsp;<span class="builtintype" id="6521619">nil</span>&nbsp;<span class="op" id="6521623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521627">t</span><span class="op" id="6521628">.</span><span class="ident" id="6521629">Fatal</span><span class="op" id="6521634">(</span><span class="string" id="6521635">&#34;decode:&#34;</span><span class="op" id="6521644">,</span>&nbsp;<span class="ident" id="6521646">err</span><span class="op" id="6521649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521652">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521655">if</span>&nbsp;<span class="op" id="6521658">!</span><span class="ident" id="6521659">reflect</span><span class="op" id="6521666">.</span><span class="ident" id="6521667">DeepEqual</span><span class="op" id="6521676">(</span><span class="ident" id="6521677">data</span><span class="op" id="6521681">,</span>&nbsp;<span class="ident" id="6521683">newData</span><span class="op" id="6521690">)</span>&nbsp;<span class="op" id="6521692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521696">t</span><span class="op" id="6521697">.</span><span class="ident" id="6521698">Fatalf</span><span class="op" id="6521704">(</span><span class="string" id="6521705">&#34;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6521725">,</span>&nbsp;<span class="ident" id="6521727">data</span><span class="op" id="6521731">,</span>&nbsp;<span class="ident" id="6521733">newData</span><span class="op" id="6521740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521743">}</span><br>
<span class="lineno"></span><span class="op" id="6521745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="comment" id="6521748">//&nbsp;A&nbsp;top-level&nbsp;nil&nbsp;pointer&nbsp;generates&nbsp;a&nbsp;panic&nbsp;with&nbsp;a&nbsp;helpful&nbsp;string-valued&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6521831">func</span>&nbsp;<span class="ident" id="6521836">TestTopLevelNilPointer</span><span class="op" id="6521858">(</span><span class="ident" id="6521859">t</span>&nbsp;<span class="op" id="6521861">*</span><span class="ident" id="6521862">testing</span><span class="op" id="6521869">.</span><span class="ident" id="6521870">T</span><span class="op" id="6521871">)</span>&nbsp;<span class="op" id="6521873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521876">errMsg</span>&nbsp;<span class="op" id="6521883">:=</span>&nbsp;<span class="ident" id="6521886">topLevelNilPanic</span><span class="op" id="6521902">(</span><span class="ident" id="6521903">t</span><span class="op" id="6521904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521907">if</span>&nbsp;<span class="ident" id="6521910">errMsg</span>&nbsp;<span class="op" id="6521917">==</span>&nbsp;<span class="string" id="6521920">&#34;&#34;</span>&nbsp;<span class="op" id="6521923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521927">t</span><span class="op" id="6521928">.</span><span class="ident" id="6521929">Fatal</span><span class="op" id="6521934">(</span><span class="string" id="6521935">&#34;top-level&nbsp;nil&nbsp;pointer&nbsp;did&nbsp;not&nbsp;panic&#34;</span><span class="op" id="6521972">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521978">if</span>&nbsp;<span class="op" id="6521981">!</span><span class="ident" id="6521982">strings</span><span class="op" id="6521989">.</span><span class="ident" id="6521990">Contains</span><span class="op" id="6521998">(</span><span class="ident" id="6521999">errMsg</span><span class="op" id="6522005">,</span>&nbsp;<span class="string" id="6522007">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="6522020">)</span>&nbsp;<span class="op" id="6522022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522026">t</span><span class="op" id="6522027">.</span><span class="ident" id="6522028">Fatal</span><span class="op" id="6522033">(</span><span class="string" id="6522034">&#34;expected&nbsp;nil&nbsp;pointer&nbsp;error,&nbsp;got:&#34;</span><span class="op" id="6522068">,</span>&nbsp;<span class="ident" id="6522070">errMsg</span><span class="op" id="6522076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522079">}</span><br>
<span class="lineno"></span><span class="op" id="6522081">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="6522084">func</span>&nbsp;<span class="ident" id="6522089">topLevelNilPanic</span><span class="op" id="6522105">(</span><span class="ident" id="6522106">t</span>&nbsp;<span class="op" id="6522108">*</span><span class="ident" id="6522109">testing</span><span class="op" id="6522116">.</span><span class="ident" id="6522117">T</span><span class="op" id="6522118">)</span>&nbsp;<span class="op" id="6522120">(</span><span class="ident" id="6522121">panicErr</span>&nbsp;<span class="builtintype" id="6522130">string</span><span class="op" id="6522136">)</span>&nbsp;<span class="op" id="6522138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522141">defer</span>&nbsp;<span class="keyword" id="6522147">func</span><span class="op" id="6522151">(</span><span class="op" id="6522152">)</span>&nbsp;<span class="op" id="6522154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522158">e</span>&nbsp;<span class="op" id="6522160">:=</span>&nbsp;<span class="builtinfunc" id="6522163">recover</span><span class="op" id="6522170">(</span><span class="op" id="6522171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522175">if</span>&nbsp;<span class="ident" id="6522178">err</span><span class="op" id="6522181">,</span>&nbsp;<span class="ident" id="6522183">ok</span>&nbsp;<span class="op" id="6522186">:=</span>&nbsp;<span class="ident" id="6522189">e</span><span class="op" id="6522190">.</span><span class="op" id="6522191">(</span><span class="builtintype" id="6522192">string</span><span class="op" id="6522198">)</span><span class="op" id="6522199">;</span>&nbsp;<span class="ident" id="6522201">ok</span>&nbsp;<span class="op" id="6522204">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522209">panicErr</span>&nbsp;<span class="op" id="6522218">=</span>&nbsp;<span class="ident" id="6522220">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522229">}</span><span class="op" id="6522230">(</span><span class="op" id="6522231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522234">var</span>&nbsp;<span class="ident" id="6522238">ip</span>&nbsp;<span class="op" id="6522241">*</span><span class="builtintype" id="6522242">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522247">buf</span>&nbsp;<span class="op" id="6522251">:=</span>&nbsp;<span class="builtinfunc" id="6522254">new</span><span class="op" id="6522257">(</span><span class="ident" id="6522258">bytes</span><span class="op" id="6522263">.</span><span class="ident" id="6522264">Buffer</span><span class="op" id="6522270">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522273">if</span>&nbsp;<span class="ident" id="6522276">err</span>&nbsp;<span class="op" id="6522280">:=</span>&nbsp;<span class="ident" id="6522283">NewEncoder</span><span class="op" id="6522293">(</span><span class="ident" id="6522294">buf</span><span class="op" id="6522297">)</span><span class="op" id="6522298">.</span><span class="ident" id="6522299">Encode</span><span class="op" id="6522305">(</span><span class="ident" id="6522306">ip</span><span class="op" id="6522308">)</span><span class="op" id="6522309">;</span>&nbsp;<span class="ident" id="6522311">err</span>&nbsp;<span class="op" id="6522315">!=</span>&nbsp;<span class="builtintype" id="6522318">nil</span>&nbsp;<span class="op" id="6522322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522326">t</span><span class="op" id="6522327">.</span><span class="ident" id="6522328">Fatal</span><span class="op" id="6522333">(</span><span class="string" id="6522334">&#34;error&nbsp;in&nbsp;encode:&#34;</span><span class="op" id="6522352">,</span>&nbsp;<span class="ident" id="6522354">err</span><span class="op" id="6522357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522363">return</span><br>
<span class="lineno"></span><span class="op" id="6522370">}</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span><span class="keyword" id="6522373">func</span>&nbsp;<span class="ident" id="6522378">TestNilPointerInsideInterface</span><span class="op" id="6522407">(</span><span class="ident" id="6522408">t</span>&nbsp;<span class="op" id="6522410">*</span><span class="ident" id="6522411">testing</span><span class="op" id="6522418">.</span><span class="ident" id="6522419">T</span><span class="op" id="6522420">)</span>&nbsp;<span class="op" id="6522422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522425">var</span>&nbsp;<span class="ident" id="6522429">ip</span>&nbsp;<span class="op" id="6522432">*</span><span class="builtintype" id="6522433">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522438">si</span>&nbsp;<span class="op" id="6522441">:=</span>&nbsp;<span class="keyword" id="6522444">struct</span>&nbsp;<span class="op" id="6522451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522455">I</span>&nbsp;<span class="keyword" id="6522457">interface</span><span class="op" id="6522466">{</span><span class="op" id="6522467">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522470">}</span><span class="op" id="6522471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522475">I</span><span class="op" id="6522476">:</span>&nbsp;<span class="ident" id="6522478">ip</span><span class="op" id="6522480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522486">buf</span>&nbsp;<span class="op" id="6522490">:=</span>&nbsp;<span class="builtinfunc" id="6522493">new</span><span class="op" id="6522496">(</span><span class="ident" id="6522497">bytes</span><span class="op" id="6522502">.</span><span class="ident" id="6522503">Buffer</span><span class="op" id="6522509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522512">err</span>&nbsp;<span class="op" id="6522516">:=</span>&nbsp;<span class="ident" id="6522519">NewEncoder</span><span class="op" id="6522529">(</span><span class="ident" id="6522530">buf</span><span class="op" id="6522533">)</span><span class="op" id="6522534">.</span><span class="ident" id="6522535">Encode</span><span class="op" id="6522541">(</span><span class="ident" id="6522542">si</span><span class="op" id="6522544">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522547">if</span>&nbsp;<span class="ident" id="6522550">err</span>&nbsp;<span class="op" id="6522554">==</span>&nbsp;<span class="builtintype" id="6522557">nil</span>&nbsp;<span class="op" id="6522561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522565">t</span><span class="op" id="6522566">.</span><span class="ident" id="6522567">Fatal</span><span class="op" id="6522572">(</span><span class="string" id="6522573">&#34;expected&nbsp;error,&nbsp;got&nbsp;none&#34;</span><span class="op" id="6522599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522605">errMsg</span>&nbsp;<span class="op" id="6522612">:=</span>&nbsp;<span class="ident" id="6522615">err</span><span class="op" id="6522618">.</span><span class="ident" id="6522619">Error</span><span class="op" id="6522624">(</span><span class="op" id="6522625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522628">if</span>&nbsp;<span class="op" id="6522631">!</span><span class="ident" id="6522632">strings</span><span class="op" id="6522639">.</span><span class="ident" id="6522640">Contains</span><span class="op" id="6522648">(</span><span class="ident" id="6522649">errMsg</span><span class="op" id="6522655">,</span>&nbsp;<span class="string" id="6522657">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="6522670">)</span>&nbsp;<span class="op" id="6522672">||</span>&nbsp;<span class="op" id="6522675">!</span><span class="ident" id="6522676">strings</span><span class="op" id="6522683">.</span><span class="ident" id="6522684">Contains</span><span class="op" id="6522692">(</span><span class="ident" id="6522693">errMsg</span><span class="op" id="6522699">,</span>&nbsp;<span class="string" id="6522701">&#34;interface&#34;</span><span class="op" id="6522712">)</span>&nbsp;<span class="op" id="6522714">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522718">t</span><span class="op" id="6522719">.</span><span class="ident" id="6522720">Fatal</span><span class="op" id="6522725">(</span><span class="string" id="6522726">&#34;expected&nbsp;error&nbsp;about&nbsp;nil&nbsp;pointer&nbsp;and&nbsp;interface,&nbsp;got:&#34;</span><span class="op" id="6522780">,</span>&nbsp;<span class="ident" id="6522782">errMsg</span><span class="op" id="6522788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522791">}</span><br>
<span class="lineno"></span><span class="op" id="6522793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6522796">type</span>&nbsp;<span class="ident" id="6522801">Bug4Public</span>&nbsp;<span class="keyword" id="6522812">struct</span>&nbsp;<span class="op" id="6522819">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522822">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6522829">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522837">Secret</span>&nbsp;<span class="ident" id="6522844">Bug4Secret</span><br>
<span class="lineno"></span><span class="op" id="6522855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6522858">type</span>&nbsp;<span class="ident" id="6522863">Bug4Secret</span>&nbsp;<span class="keyword" id="6522874">struct</span>&nbsp;<span class="op" id="6522881">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522884">a</span>&nbsp;<span class="builtintype" id="6522886">int</span>&nbsp;<span class="comment" id="6522890">//&nbsp;error:&nbsp;no&nbsp;exported&nbsp;fields.</span><br>
<span class="lineno"></span><span class="op" id="6522920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6522923">//&nbsp;Test&nbsp;that&nbsp;a&nbsp;failed&nbsp;compilation&nbsp;doesn&#39;t&nbsp;leave&nbsp;around&nbsp;an&nbsp;executable&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="comment" id="6523001">//&nbsp;Issue&nbsp;3273.</span><br>
<span class="lineno">885</span><span class="keyword" id="6523016">func</span>&nbsp;<span class="ident" id="6523021">TestMutipleEncodingsOfBadType</span><span class="op" id="6523050">(</span><span class="ident" id="6523051">t</span>&nbsp;<span class="op" id="6523053">*</span><span class="ident" id="6523054">testing</span><span class="op" id="6523061">.</span><span class="ident" id="6523062">T</span><span class="op" id="6523063">)</span>&nbsp;<span class="op" id="6523065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523068">x</span>&nbsp;<span class="op" id="6523070">:=</span>&nbsp;<span class="ident" id="6523073">Bug4Public</span><span class="op" id="6523083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523087">Name</span><span class="op" id="6523091">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6523095">&#34;name&#34;</span><span class="op" id="6523101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523105">Secret</span><span class="op" id="6523111">:</span>&nbsp;<span class="ident" id="6523113">Bug4Secret</span><span class="op" id="6523123">{</span><span class="num" id="6523124">1</span><span class="op" id="6523125">}</span><span class="op" id="6523126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523129">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523132">buf</span>&nbsp;<span class="op" id="6523136">:=</span>&nbsp;<span class="builtinfunc" id="6523139">new</span><span class="op" id="6523142">(</span><span class="ident" id="6523143">bytes</span><span class="op" id="6523148">.</span><span class="ident" id="6523149">Buffer</span><span class="op" id="6523155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523158">enc</span>&nbsp;<span class="op" id="6523162">:=</span>&nbsp;<span class="ident" id="6523165">NewEncoder</span><span class="op" id="6523175">(</span><span class="ident" id="6523176">buf</span><span class="op" id="6523179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523182">err</span>&nbsp;<span class="op" id="6523186">:=</span>&nbsp;<span class="ident" id="6523189">enc</span><span class="op" id="6523192">.</span><span class="ident" id="6523193">Encode</span><span class="op" id="6523199">(</span><span class="ident" id="6523200">x</span><span class="op" id="6523201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523204">if</span>&nbsp;<span class="ident" id="6523207">err</span>&nbsp;<span class="op" id="6523211">==</span>&nbsp;<span class="builtintype" id="6523214">nil</span>&nbsp;<span class="op" id="6523218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523222">t</span><span class="op" id="6523223">.</span><span class="ident" id="6523224">Fatal</span><span class="op" id="6523229">(</span><span class="string" id="6523230">&#34;first&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="6523262">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523268">buf</span><span class="op" id="6523271">.</span><span class="ident" id="6523272">Reset</span><span class="op" id="6523277">(</span><span class="op" id="6523278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523281">enc</span>&nbsp;<span class="op" id="6523285">=</span>&nbsp;<span class="ident" id="6523287">NewEncoder</span><span class="op" id="6523297">(</span><span class="ident" id="6523298">buf</span><span class="op" id="6523301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523304">err</span>&nbsp;<span class="op" id="6523308">=</span>&nbsp;<span class="ident" id="6523310">enc</span><span class="op" id="6523313">.</span><span class="ident" id="6523314">Encode</span><span class="op" id="6523320">(</span><span class="ident" id="6523321">x</span><span class="op" id="6523322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523325">if</span>&nbsp;<span class="ident" id="6523328">err</span>&nbsp;<span class="op" id="6523332">==</span>&nbsp;<span class="builtintype" id="6523335">nil</span>&nbsp;<span class="op" id="6523339">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523343">t</span><span class="op" id="6523344">.</span><span class="ident" id="6523345">Fatal</span><span class="op" id="6523350">(</span><span class="string" id="6523351">&#34;second&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="6523384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523390">if</span>&nbsp;<span class="op" id="6523393">!</span><span class="ident" id="6523394">strings</span><span class="op" id="6523401">.</span><span class="ident" id="6523402">Contains</span><span class="op" id="6523410">(</span><span class="ident" id="6523411">err</span><span class="op" id="6523414">.</span><span class="ident" id="6523415">Error</span><span class="op" id="6523420">(</span><span class="op" id="6523421">)</span><span class="op" id="6523422">,</span>&nbsp;<span class="string" id="6523424">&#34;no&nbsp;exported&nbsp;fields&#34;</span><span class="op" id="6523444">)</span>&nbsp;<span class="op" id="6523446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523450">t</span><span class="op" id="6523451">.</span><span class="ident" id="6523452">Errorf</span><span class="op" id="6523458">(</span><span class="string" id="6523459">&#34;expected&nbsp;error&nbsp;about&nbsp;no&nbsp;exported&nbsp;fields;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6523508">,</span>&nbsp;<span class="ident" id="6523510">err</span><span class="op" id="6523513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523516">}</span><br>
<span class="lineno">905</span><span class="op" id="6523518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6523521">//&nbsp;There&nbsp;was&nbsp;an&nbsp;error&nbsp;check&nbsp;comparing&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;input&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6523592">//&nbsp;length&nbsp;of&nbsp;the&nbsp;slice&nbsp;being&nbsp;decoded.&nbsp;It&nbsp;was&nbsp;wrong&nbsp;because&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="6523660">//&nbsp;thing&nbsp;in&nbsp;the&nbsp;input&nbsp;might&nbsp;be&nbsp;a&nbsp;type&nbsp;definition,&nbsp;which&nbsp;would&nbsp;lead&nbsp;to</span><br>
<span class="lineno">910</span><span class="comment" id="6523730">//&nbsp;an&nbsp;incorrect&nbsp;length&nbsp;check.&nbsp;&nbsp;This&nbsp;test&nbsp;reproduces&nbsp;the&nbsp;corner&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6523800">type</span>&nbsp;<span class="ident" id="6523805">Z</span>&nbsp;<span class="keyword" id="6523807">struct</span>&nbsp;<span class="op" id="6523814">{</span><br>
<span class="lineno"></span><span class="op" id="6523816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="keyword" id="6523819">func</span>&nbsp;<span class="ident" id="6523824">Test29ElementSlice</span><span class="op" id="6523842">(</span><span class="ident" id="6523843">t</span>&nbsp;<span class="op" id="6523845">*</span><span class="ident" id="6523846">testing</span><span class="op" id="6523853">.</span><span class="ident" id="6523854">T</span><span class="op" id="6523855">)</span>&nbsp;<span class="op" id="6523857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523860">Register</span><span class="op" id="6523868">(</span><span class="ident" id="6523869">Z</span><span class="op" id="6523870">{</span><span class="op" id="6523871">}</span><span class="op" id="6523872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523875">src</span>&nbsp;<span class="op" id="6523879">:=</span>&nbsp;<span class="builtinfunc" id="6523882">make</span><span class="op" id="6523886">(</span><span class="op" id="6523887">[</span><span class="op" id="6523888">]</span><span class="keyword" id="6523889">interface</span><span class="op" id="6523898">{</span><span class="op" id="6523899">}</span><span class="op" id="6523900">,</span>&nbsp;<span class="num" id="6523902">100</span><span class="op" id="6523905">)</span>&nbsp;<span class="comment" id="6523907">//&nbsp;Size&nbsp;needs&nbsp;to&nbsp;be&nbsp;bigger&nbsp;than&nbsp;size&nbsp;of&nbsp;type&nbsp;definition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523965">for</span>&nbsp;<span class="ident" id="6523969">i</span>&nbsp;<span class="op" id="6523971">:=</span>&nbsp;<span class="keyword" id="6523974">range</span>&nbsp;<span class="ident" id="6523980">src</span>&nbsp;<span class="op" id="6523984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523988">src</span><span class="op" id="6523991">[</span><span class="ident" id="6523992">i</span><span class="op" id="6523993">]</span>&nbsp;<span class="op" id="6523995">=</span>&nbsp;<span class="ident" id="6523997">Z</span><span class="op" id="6523998">{</span><span class="op" id="6523999">}</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524005">buf</span>&nbsp;<span class="op" id="6524009">:=</span>&nbsp;<span class="builtinfunc" id="6524012">new</span><span class="op" id="6524015">(</span><span class="ident" id="6524016">bytes</span><span class="op" id="6524021">.</span><span class="ident" id="6524022">Buffer</span><span class="op" id="6524028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524031">err</span>&nbsp;<span class="op" id="6524035">:=</span>&nbsp;<span class="ident" id="6524038">NewEncoder</span><span class="op" id="6524048">(</span><span class="ident" id="6524049">buf</span><span class="op" id="6524052">)</span><span class="op" id="6524053">.</span><span class="ident" id="6524054">Encode</span><span class="op" id="6524060">(</span><span class="ident" id="6524061">src</span><span class="op" id="6524064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524067">if</span>&nbsp;<span class="ident" id="6524070">err</span>&nbsp;<span class="op" id="6524074">!=</span>&nbsp;<span class="builtintype" id="6524077">nil</span>&nbsp;<span class="op" id="6524081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524085">t</span><span class="op" id="6524086">.</span><span class="ident" id="6524087">Fatalf</span><span class="op" id="6524093">(</span><span class="string" id="6524094">&#34;encode:&nbsp;%v&#34;</span><span class="op" id="6524106">,</span>&nbsp;<span class="ident" id="6524108">err</span><span class="op" id="6524111">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524115">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524127">var</span>&nbsp;<span class="ident" id="6524131">dst</span>&nbsp;<span class="op" id="6524135">[</span><span class="op" id="6524136">]</span><span class="keyword" id="6524137">interface</span><span class="op" id="6524146">{</span><span class="op" id="6524147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524150">err</span>&nbsp;<span class="op" id="6524154">=</span>&nbsp;<span class="ident" id="6524156">NewDecoder</span><span class="op" id="6524166">(</span><span class="ident" id="6524167">buf</span><span class="op" id="6524170">)</span><span class="op" id="6524171">.</span><span class="ident" id="6524172">Decode</span><span class="op" id="6524178">(</span><span class="op" id="6524179">&amp;</span><span class="ident" id="6524180">dst</span><span class="op" id="6524183">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524186">if</span>&nbsp;<span class="ident" id="6524189">err</span>&nbsp;<span class="op" id="6524193">!=</span>&nbsp;<span class="builtintype" id="6524196">nil</span>&nbsp;<span class="op" id="6524200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524204">t</span><span class="op" id="6524205">.</span><span class="ident" id="6524206">Errorf</span><span class="op" id="6524212">(</span><span class="string" id="6524213">&#34;decode:&nbsp;%v&#34;</span><span class="op" id="6524225">,</span>&nbsp;<span class="ident" id="6524227">err</span><span class="op" id="6524230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524234">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524242">}</span><br>
<span class="lineno"></span><span class="op" id="6524244">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="6524247">//&nbsp;Don&#39;t&nbsp;crash,&nbsp;just&nbsp;give&nbsp;error&nbsp;when&nbsp;allocating&nbsp;a&nbsp;huge&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="6524309">//&nbsp;Issue&nbsp;8084.</span><br>
<span class="lineno"></span><span class="keyword" id="6524324">func</span>&nbsp;<span class="ident" id="6524329">TestErrorForHugeSlice</span><span class="op" id="6524350">(</span><span class="ident" id="6524351">t</span>&nbsp;<span class="op" id="6524353">*</span><span class="ident" id="6524354">testing</span><span class="op" id="6524361">.</span><span class="ident" id="6524362">T</span><span class="op" id="6524363">)</span>&nbsp;<span class="op" id="6524365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6524368">//&nbsp;Encode&nbsp;an&nbsp;int&nbsp;slice.</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524393">buf</span>&nbsp;<span class="op" id="6524397">:=</span>&nbsp;<span class="builtinfunc" id="6524400">new</span><span class="op" id="6524403">(</span><span class="ident" id="6524404">bytes</span><span class="op" id="6524409">.</span><span class="ident" id="6524410">Buffer</span><span class="op" id="6524416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524419">slice</span>&nbsp;<span class="op" id="6524425">:=</span>&nbsp;<span class="op" id="6524428">[</span><span class="op" id="6524429">]</span><span class="builtintype" id="6524430">int</span><span class="op" id="6524433">{</span><span class="num" id="6524434">1</span><span class="op" id="6524435">,</span>&nbsp;<span class="num" id="6524437">1</span><span class="op" id="6524438">,</span>&nbsp;<span class="num" id="6524440">1</span><span class="op" id="6524441">,</span>&nbsp;<span class="num" id="6524443">1</span><span class="op" id="6524444">,</span>&nbsp;<span class="num" id="6524446">1</span><span class="op" id="6524447">,</span>&nbsp;<span class="num" id="6524449">1</span><span class="op" id="6524450">,</span>&nbsp;<span class="num" id="6524452">1</span><span class="op" id="6524453">,</span>&nbsp;<span class="num" id="6524455">1</span><span class="op" id="6524456">,</span>&nbsp;<span class="num" id="6524458">1</span><span class="op" id="6524459">,</span>&nbsp;<span class="num" id="6524461">1</span><span class="op" id="6524462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524465">err</span>&nbsp;<span class="op" id="6524469">:=</span>&nbsp;<span class="ident" id="6524472">NewEncoder</span><span class="op" id="6524482">(</span><span class="ident" id="6524483">buf</span><span class="op" id="6524486">)</span><span class="op" id="6524487">.</span><span class="ident" id="6524488">Encode</span><span class="op" id="6524494">(</span><span class="ident" id="6524495">slice</span><span class="op" id="6524500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524503">if</span>&nbsp;<span class="ident" id="6524506">err</span>&nbsp;<span class="op" id="6524510">!=</span>&nbsp;<span class="builtintype" id="6524513">nil</span>&nbsp;<span class="op" id="6524517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524521">t</span><span class="op" id="6524522">.</span><span class="ident" id="6524523">Fatal</span><span class="op" id="6524528">(</span><span class="string" id="6524529">&#34;encode:&#34;</span><span class="op" id="6524538">,</span>&nbsp;<span class="ident" id="6524540">err</span><span class="op" id="6524543">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6524549">//&nbsp;Reach&nbsp;into&nbsp;the&nbsp;buffer&nbsp;and&nbsp;smash&nbsp;the&nbsp;count&nbsp;to&nbsp;make&nbsp;the&nbsp;encoded&nbsp;slice&nbsp;very&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524632">buf</span><span class="op" id="6524635">.</span><span class="ident" id="6524636">Bytes</span><span class="op" id="6524641">(</span><span class="op" id="6524642">)</span><span class="op" id="6524643">[</span><span class="ident" id="6524644">buf</span><span class="op" id="6524647">.</span><span class="ident" id="6524648">Len</span><span class="op" id="6524651">(</span><span class="op" id="6524652">)</span><span class="op" id="6524653">-</span><span class="builtinfunc" id="6524654">len</span><span class="op" id="6524657">(</span><span class="ident" id="6524658">slice</span><span class="op" id="6524663">)</span><span class="op" id="6524664">-</span><span class="num" id="6524665">1</span><span class="op" id="6524666">]</span>&nbsp;<span class="op" id="6524668">=</span>&nbsp;<span class="num" id="6524670">0xfa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6524676">//&nbsp;Decode&nbsp;and&nbsp;see&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524702">err</span>&nbsp;<span class="op" id="6524706">=</span>&nbsp;<span class="ident" id="6524708">NewDecoder</span><span class="op" id="6524718">(</span><span class="ident" id="6524719">buf</span><span class="op" id="6524722">)</span><span class="op" id="6524723">.</span><span class="ident" id="6524724">Decode</span><span class="op" id="6524730">(</span><span class="op" id="6524731">&amp;</span><span class="ident" id="6524732">slice</span><span class="op" id="6524737">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524740">if</span>&nbsp;<span class="ident" id="6524743">err</span>&nbsp;<span class="op" id="6524747">==</span>&nbsp;<span class="builtintype" id="6524750">nil</span>&nbsp;<span class="op" id="6524754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524758">t</span><span class="op" id="6524759">.</span><span class="ident" id="6524760">Fatal</span><span class="op" id="6524765">(</span><span class="string" id="6524766">&#34;decode:&nbsp;no&nbsp;error&#34;</span><span class="op" id="6524784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524790">if</span>&nbsp;<span class="op" id="6524793">!</span><span class="ident" id="6524794">strings</span><span class="op" id="6524801">.</span><span class="ident" id="6524802">Contains</span><span class="op" id="6524810">(</span><span class="ident" id="6524811">err</span><span class="op" id="6524814">.</span><span class="ident" id="6524815">Error</span><span class="op" id="6524820">(</span><span class="op" id="6524821">)</span><span class="op" id="6524822">,</span>&nbsp;<span class="string" id="6524824">&#34;slice&nbsp;too&nbsp;big&#34;</span><span class="op" id="6524839">)</span>&nbsp;<span class="op" id="6524841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524845">t</span><span class="op" id="6524846">.</span><span class="ident" id="6524847">Fatal</span><span class="op" id="6524852">(</span><span class="string" id="6524853">&#34;decode:&nbsp;expected&nbsp;slice&nbsp;too&nbsp;big&nbsp;error,&nbsp;got&nbsp;%s&#34;</span><span class="op" id="6524899">,</span>&nbsp;<span class="ident" id="6524901">err</span><span class="op" id="6524904">.</span><span class="ident" id="6524905">Error</span><span class="op" id="6524910">(</span><span class="op" id="6524911">)</span><span class="op" id="6524912">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524915">}</span><br>
<span class="lineno"></span><span class="op" id="6524917">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
