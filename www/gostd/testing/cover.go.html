<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5786209">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5786264">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5786318">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5786369">//&nbsp;Support&nbsp;for&nbsp;test&nbsp;coverage.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5786400">package</span>&nbsp;<span class="ident" id="5786408">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5786417">import</span>&nbsp;<span class="op" id="5786424">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5786427">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5786434">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5786440">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span><span class="op" id="5786454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5786457">//&nbsp;CoverBlock&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;for&nbsp;a&nbsp;single&nbsp;basic&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment" id="5786523">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="5786602">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5786667">type</span>&nbsp;<span class="ident" id="5786672">CoverBlock</span>&nbsp;<span class="keyword" id="5786683">struct</span>&nbsp;<span class="op" id="5786690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786693">Line0</span>&nbsp;<span class="builtintype" id="5786699">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786707">Col0</span>&nbsp;&nbsp;<span class="builtintype" id="5786713">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786721">Line1</span>&nbsp;<span class="builtintype" id="5786727">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786735">Col1</span>&nbsp;&nbsp;<span class="builtintype" id="5786741">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786749">Stmts</span>&nbsp;<span class="builtintype" id="5786755">uint16</span><br>
<span class="lineno"></span><span class="op" id="5786762">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5786765">var</span>&nbsp;<span class="ident" id="5786769">cover</span>&nbsp;<span class="ident" id="5786775">Cover</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5786782">//&nbsp;Cover&nbsp;records&nbsp;information&nbsp;about&nbsp;test&nbsp;coverage&nbsp;checking.</span><br>
<span class="lineno"></span><span class="comment" id="5786841">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno">30</span><span class="comment" id="5786920">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5786985">type</span>&nbsp;<span class="ident" id="5786990">Cover</span>&nbsp;<span class="keyword" id="5786996">struct</span>&nbsp;<span class="op" id="5787003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787006">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5787022">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787030">Counters</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787046">map</span><span class="op" id="5787049">[</span><span class="builtintype" id="5787050">string</span><span class="op" id="5787056">]</span><span class="op" id="5787057">[</span><span class="op" id="5787058">]</span><span class="builtintype" id="5787059">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787067">Blocks</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5787083">map</span><span class="op" id="5787086">[</span><span class="builtintype" id="5787087">string</span><span class="op" id="5787093">]</span><span class="op" id="5787094">[</span><span class="op" id="5787095">]</span><span class="ident" id="5787096">CoverBlock</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787108">CoveredPackages</span>&nbsp;<span class="builtintype" id="5787124">string</span><br>
<span class="lineno"></span><span class="op" id="5787131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5787134">//&nbsp;Coverage&nbsp;reports&nbsp;the&nbsp;current&nbsp;code&nbsp;coverage&nbsp;as&nbsp;a&nbsp;fraction&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;1].</span><br>
<span class="lineno"></span><span class="comment" id="5787215">//&nbsp;If&nbsp;coverage&nbsp;is&nbsp;not&nbsp;enabled,&nbsp;Coverage&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="comment" id="5787266">//</span><br>
<span class="lineno"></span><span class="comment" id="5787269">//&nbsp;When&nbsp;running&nbsp;a&nbsp;large&nbsp;set&nbsp;of&nbsp;sequential&nbsp;test&nbsp;cases,&nbsp;checking&nbsp;Coverage&nbsp;after&nbsp;each&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5787356">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;for&nbsp;identifying&nbsp;which&nbsp;test&nbsp;cases&nbsp;exercise&nbsp;new&nbsp;code&nbsp;paths.</span><br>
<span class="lineno"></span><span class="comment" id="5787431">//&nbsp;It&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;reports&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&nbsp;-cover&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5787508">//&nbsp;&#39;go&nbsp;tool&nbsp;cover&#39;.</span><br>
<span class="lineno">45</span><span class="keyword" id="5787528">func</span>&nbsp;<span class="ident" id="5787533">Coverage</span><span class="op" id="5787541">(</span><span class="op" id="5787542">)</span>&nbsp;<span class="builtintype" id="5787544">float64</span>&nbsp;<span class="op" id="5787552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787555">var</span>&nbsp;<span class="ident" id="5787559">n</span><span class="op" id="5787560">,</span>&nbsp;<span class="ident" id="5787562">d</span>&nbsp;<span class="ident" id="5787564">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787571">for</span>&nbsp;<span class="ident" id="5787575">_</span><span class="op" id="5787576">,</span>&nbsp;<span class="ident" id="5787578">counters</span>&nbsp;<span class="op" id="5787587">:=</span>&nbsp;<span class="keyword" id="5787590">range</span>&nbsp;<span class="ident" id="5787596">cover</span><span class="op" id="5787601">.</span><span class="ident" id="5787602">Counters</span>&nbsp;<span class="op" id="5787611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787615">for</span>&nbsp;<span class="ident" id="5787619">i</span>&nbsp;<span class="op" id="5787621">:=</span>&nbsp;<span class="keyword" id="5787624">range</span>&nbsp;<span class="ident" id="5787630">counters</span>&nbsp;<span class="op" id="5787639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787644">if</span>&nbsp;<span class="ident" id="5787647">atomic</span><span class="op" id="5787653">.</span><span class="ident" id="5787654">LoadUint32</span><span class="op" id="5787664">(</span><span class="op" id="5787665">&amp;</span><span class="ident" id="5787666">counters</span><span class="op" id="5787674">[</span><span class="ident" id="5787675">i</span><span class="op" id="5787676">]</span><span class="op" id="5787677">)</span>&nbsp;<span class="op" id="5787679">&gt;</span>&nbsp;<span class="num" id="5787681">0</span>&nbsp;<span class="op" id="5787683">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787689">n</span><span class="op" id="5787690">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787701">d</span><span class="op" id="5787702">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787710">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787713">if</span>&nbsp;<span class="ident" id="5787716">d</span>&nbsp;<span class="op" id="5787718">==</span>&nbsp;<span class="num" id="5787721">0</span>&nbsp;<span class="op" id="5787723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787727">return</span>&nbsp;<span class="num" id="5787734">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787740">return</span>&nbsp;<span class="builtintype" id="5787747">float64</span><span class="op" id="5787754">(</span><span class="ident" id="5787755">n</span><span class="op" id="5787756">)</span>&nbsp;<span class="op" id="5787758">/</span>&nbsp;<span class="builtintype" id="5787760">float64</span><span class="op" id="5787767">(</span><span class="ident" id="5787768">d</span><span class="op" id="5787769">)</span><br>
<span class="lineno"></span><span class="op" id="5787771">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5787774">//&nbsp;RegisterCover&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;accumulators&nbsp;for&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="5787845">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="5787926">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5787991">func</span>&nbsp;<span class="ident" id="5787996">RegisterCover</span><span class="op" id="5788009">(</span><span class="ident" id="5788010">c</span>&nbsp;<span class="ident" id="5788012">Cover</span><span class="op" id="5788017">)</span>&nbsp;<span class="op" id="5788019">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788022">cover</span>&nbsp;<span class="op" id="5788028">=</span>&nbsp;<span class="ident" id="5788030">c</span><br>
<span class="lineno"></span><span class="op" id="5788032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5788035">//&nbsp;mustBeNil&nbsp;checks&nbsp;the&nbsp;error&nbsp;and,&nbsp;if&nbsp;present,&nbsp;reports&nbsp;it&nbsp;and&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5788104">func</span>&nbsp;<span class="ident" id="5788109">mustBeNil</span><span class="op" id="5788118">(</span><span class="ident" id="5788119">err</span>&nbsp;<span class="builtintype" id="5788123">error</span><span class="op" id="5788128">)</span>&nbsp;<span class="op" id="5788130">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788133">if</span>&nbsp;<span class="ident" id="5788136">err</span>&nbsp;<span class="op" id="5788140">!=</span>&nbsp;<span class="ident" id="5788143">nil</span>&nbsp;<span class="op" id="5788147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788151">fmt</span><span class="op" id="5788154">.</span><span class="ident" id="5788155">Fprintf</span><span class="op" id="5788162">(</span><span class="ident" id="5788163">os</span><span class="op" id="5788165">.</span><span class="ident" id="5788166">Stderr</span><span class="op" id="5788172">,</span>&nbsp;<span class="string" id="5788174">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="5788189">,</span>&nbsp;<span class="ident" id="5788191">err</span><span class="op" id="5788194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788198">os</span><span class="op" id="5788200">.</span><span class="ident" id="5788201">Exit</span><span class="op" id="5788205">(</span><span class="num" id="5788206">2</span><span class="op" id="5788207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788210">}</span><br>
<span class="lineno"></span><span class="op" id="5788212">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="5788215">//&nbsp;coverReport&nbsp;reports&nbsp;the&nbsp;coverage&nbsp;percentage&nbsp;and&nbsp;writes&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="5788306">func</span>&nbsp;<span class="ident" id="5788311">coverReport</span><span class="op" id="5788322">(</span><span class="op" id="5788323">)</span>&nbsp;<span class="op" id="5788325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788328">var</span>&nbsp;<span class="ident" id="5788332">f</span>&nbsp;<span class="op" id="5788334">*</span><span class="ident" id="5788335">os</span><span class="op" id="5788337">.</span><span class="ident" id="5788338">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788344">var</span>&nbsp;<span class="ident" id="5788348">err</span>&nbsp;<span class="builtintype" id="5788352">error</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788359">if</span>&nbsp;<span class="op" id="5788362">*</span><span class="ident" id="5788363">coverProfile</span>&nbsp;<span class="op" id="5788376">!=</span>&nbsp;<span class="string" id="5788379">&#34;&#34;</span>&nbsp;<span class="op" id="5788382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788386">f</span><span class="op" id="5788387">,</span>&nbsp;<span class="ident" id="5788389">err</span>&nbsp;<span class="op" id="5788393">=</span>&nbsp;<span class="ident" id="5788395">os</span><span class="op" id="5788397">.</span><span class="ident" id="5788398">Create</span><span class="op" id="5788404">(</span><span class="ident" id="5788405">toOutputDir</span><span class="op" id="5788416">(</span><span class="op" id="5788417">*</span><span class="ident" id="5788418">coverProfile</span><span class="op" id="5788430">)</span><span class="op" id="5788431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788435">mustBeNil</span><span class="op" id="5788444">(</span><span class="ident" id="5788445">err</span><span class="op" id="5788448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788452">fmt</span><span class="op" id="5788455">.</span><span class="ident" id="5788456">Fprintf</span><span class="op" id="5788463">(</span><span class="ident" id="5788464">f</span><span class="op" id="5788465">,</span>&nbsp;<span class="string" id="5788467">&#34;mode:&nbsp;%s\n&#34;</span><span class="op" id="5788479">,</span>&nbsp;<span class="ident" id="5788481">cover</span><span class="op" id="5788486">.</span><span class="ident" id="5788487">Mode</span><span class="op" id="5788491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788495">defer</span>&nbsp;<span class="keyword" id="5788501">func</span><span class="op" id="5788505">(</span><span class="op" id="5788506">)</span>&nbsp;<span class="op" id="5788508">{</span>&nbsp;<span class="ident" id="5788510">mustBeNil</span><span class="op" id="5788519">(</span><span class="ident" id="5788520">f</span><span class="op" id="5788521">.</span><span class="ident" id="5788522">Close</span><span class="op" id="5788527">(</span><span class="op" id="5788528">)</span><span class="op" id="5788529">)</span>&nbsp;<span class="op" id="5788531">}</span><span class="op" id="5788532">(</span><span class="op" id="5788533">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788540">var</span>&nbsp;<span class="ident" id="5788544">active</span><span class="op" id="5788550">,</span>&nbsp;<span class="ident" id="5788552">total</span>&nbsp;<span class="ident" id="5788558">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788565">var</span>&nbsp;<span class="ident" id="5788569">count</span>&nbsp;<span class="builtintype" id="5788575">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788583">for</span>&nbsp;<span class="ident" id="5788587">name</span><span class="op" id="5788591">,</span>&nbsp;<span class="ident" id="5788593">counts</span>&nbsp;<span class="op" id="5788600">:=</span>&nbsp;<span class="keyword" id="5788603">range</span>&nbsp;<span class="ident" id="5788609">cover</span><span class="op" id="5788614">.</span><span class="ident" id="5788615">Counters</span>&nbsp;<span class="op" id="5788624">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788628">blocks</span>&nbsp;<span class="op" id="5788635">:=</span>&nbsp;<span class="ident" id="5788638">cover</span><span class="op" id="5788643">.</span><span class="ident" id="5788644">Blocks</span><span class="op" id="5788650">[</span><span class="ident" id="5788651">name</span><span class="op" id="5788655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788659">for</span>&nbsp;<span class="ident" id="5788663">i</span>&nbsp;<span class="op" id="5788665">:=</span>&nbsp;<span class="keyword" id="5788668">range</span>&nbsp;<span class="ident" id="5788674">counts</span>&nbsp;<span class="op" id="5788681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788686">stmts</span>&nbsp;<span class="op" id="5788692">:=</span>&nbsp;<span class="ident" id="5788695">int64</span><span class="op" id="5788700">(</span><span class="ident" id="5788701">blocks</span><span class="op" id="5788707">[</span><span class="ident" id="5788708">i</span><span class="op" id="5788709">]</span><span class="op" id="5788710">.</span><span class="ident" id="5788711">Stmts</span><span class="op" id="5788716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788721">total</span>&nbsp;<span class="op" id="5788727">+=</span>&nbsp;<span class="ident" id="5788730">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788739">count</span>&nbsp;<span class="op" id="5788745">=</span>&nbsp;<span class="ident" id="5788747">atomic</span><span class="op" id="5788753">.</span><span class="ident" id="5788754">LoadUint32</span><span class="op" id="5788764">(</span><span class="op" id="5788765">&amp;</span><span class="ident" id="5788766">counts</span><span class="op" id="5788772">[</span><span class="ident" id="5788773">i</span><span class="op" id="5788774">]</span><span class="op" id="5788775">)</span>&nbsp;<span class="comment" id="5788777">//&nbsp;For&nbsp;-mode=atomic.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788801">if</span>&nbsp;<span class="ident" id="5788804">count</span>&nbsp;<span class="op" id="5788810">&gt;</span>&nbsp;<span class="num" id="5788812">0</span>&nbsp;<span class="op" id="5788814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788820">active</span>&nbsp;<span class="op" id="5788827">+=</span>&nbsp;<span class="ident" id="5788830">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788844">if</span>&nbsp;<span class="ident" id="5788847">f</span>&nbsp;<span class="op" id="5788849">!=</span>&nbsp;<span class="ident" id="5788852">nil</span>&nbsp;<span class="op" id="5788856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788862">_</span><span class="op" id="5788863">,</span>&nbsp;<span class="ident" id="5788865">err</span>&nbsp;<span class="op" id="5788869">:=</span>&nbsp;<span class="ident" id="5788872">fmt</span><span class="op" id="5788875">.</span><span class="ident" id="5788876">Fprintf</span><span class="op" id="5788883">(</span><span class="ident" id="5788884">f</span><span class="op" id="5788885">,</span>&nbsp;<span class="string" id="5788887">&#34;%s:%d.%d,%d.%d&nbsp;%d&nbsp;%d\n&#34;</span><span class="op" id="5788911">,</span>&nbsp;<span class="ident" id="5788913">name</span><span class="op" id="5788917">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788924">blocks</span><span class="op" id="5788930">[</span><span class="ident" id="5788931">i</span><span class="op" id="5788932">]</span><span class="op" id="5788933">.</span><span class="ident" id="5788934">Line0</span><span class="op" id="5788939">,</span>&nbsp;<span class="ident" id="5788941">blocks</span><span class="op" id="5788947">[</span><span class="ident" id="5788948">i</span><span class="op" id="5788949">]</span><span class="op" id="5788950">.</span><span class="ident" id="5788951">Col0</span><span class="op" id="5788955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788962">blocks</span><span class="op" id="5788968">[</span><span class="ident" id="5788969">i</span><span class="op" id="5788970">]</span><span class="op" id="5788971">.</span><span class="ident" id="5788972">Line1</span><span class="op" id="5788977">,</span>&nbsp;<span class="ident" id="5788979">blocks</span><span class="op" id="5788985">[</span><span class="ident" id="5788986">i</span><span class="op" id="5788987">]</span><span class="op" id="5788988">.</span><span class="ident" id="5788989">Col1</span><span class="op" id="5788993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789000">stmts</span><span class="op" id="5789005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789012">count</span><span class="op" id="5789017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789023">mustBeNil</span><span class="op" id="5789032">(</span><span class="ident" id="5789033">err</span><span class="op" id="5789036">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789051">if</span>&nbsp;<span class="ident" id="5789054">total</span>&nbsp;<span class="op" id="5789060">==</span>&nbsp;<span class="num" id="5789063">0</span>&nbsp;<span class="op" id="5789065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789069">total</span>&nbsp;<span class="op" id="5789075">=</span>&nbsp;<span class="num" id="5789077">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789083">fmt</span><span class="op" id="5789086">.</span><span class="ident" id="5789087">Printf</span><span class="op" id="5789093">(</span><span class="string" id="5789094">&#34;coverage:&nbsp;%.1f%%&nbsp;of&nbsp;statements%s\n&#34;</span><span class="op" id="5789130">,</span>&nbsp;<span class="num" id="5789132">100</span><span class="op" id="5789135">*</span><span class="builtintype" id="5789136">float64</span><span class="op" id="5789143">(</span><span class="ident" id="5789144">active</span><span class="op" id="5789150">)</span><span class="op" id="5789151">/</span><span class="builtintype" id="5789152">float64</span><span class="op" id="5789159">(</span><span class="ident" id="5789160">total</span><span class="op" id="5789165">)</span><span class="op" id="5789166">,</span>&nbsp;<span class="ident" id="5789168">cover</span><span class="op" id="5789173">.</span><span class="ident" id="5789174">CoveredPackages</span><span class="op" id="5789189">)</span><br>
<span class="lineno"></span><span class="op" id="5789191">}</span>
</div>
</body>
</html>
