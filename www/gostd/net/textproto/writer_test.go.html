<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7958554">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7958610">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7958664">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7958715">package</span>&nbsp;<span class="ident" id="7958723">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7958734">import</span>&nbsp;<span class="op" id="7958741">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7958744">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7958753">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7958762">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7958772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7958775">func</span>&nbsp;<span class="ident" id="7958780">TestPrintfLine</span><span class="op" id="7958794">(</span><span class="ident" id="7958795">t</span>&nbsp;<span class="op" id="7958797">*</span><span class="ident" id="7958798">testing</span><span class="op" id="7958805">.</span><span class="ident" id="7958806">T</span><span class="op" id="7958807">)</span>&nbsp;<span class="op" id="7958809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7958812">var</span>&nbsp;<span class="ident" id="7958816">buf</span>&nbsp;<span class="ident" id="7958820">bytes</span><span class="op" id="7958825">.</span><span class="ident" id="7958826">Buffer</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7958834">w</span>&nbsp;<span class="op" id="7958836">:=</span>&nbsp;<span class="ident" id="7958839">NewWriter</span><span class="op" id="7958848">(</span><span class="ident" id="7958849">bufio</span><span class="op" id="7958854">.</span><span class="ident" id="7958855">NewWriter</span><span class="op" id="7958864">(</span><span class="op" id="7958865">&amp;</span><span class="ident" id="7958866">buf</span><span class="op" id="7958869">)</span><span class="op" id="7958870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7958873">err</span>&nbsp;<span class="op" id="7958877">:=</span>&nbsp;<span class="ident" id="7958880">w</span><span class="op" id="7958881">.</span><span class="ident" id="7958882">PrintfLine</span><span class="op" id="7958892">(</span><span class="string" id="7958893">&#34;foo&nbsp;%d&#34;</span><span class="op" id="7958901">,</span>&nbsp;<span class="num" id="7958903">123</span><span class="op" id="7958906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7958909">if</span>&nbsp;<span class="ident" id="7958912">s</span>&nbsp;<span class="op" id="7958914">:=</span>&nbsp;<span class="ident" id="7958917">buf</span><span class="op" id="7958920">.</span><span class="ident" id="7958921">String</span><span class="op" id="7958927">(</span><span class="op" id="7958928">)</span><span class="op" id="7958929">;</span>&nbsp;<span class="ident" id="7958931">s</span>&nbsp;<span class="op" id="7958933">!=</span>&nbsp;<span class="string" id="7958936">&#34;foo&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="7958950">||</span>&nbsp;<span class="ident" id="7958953">err</span>&nbsp;<span class="op" id="7958957">!=</span>&nbsp;<span class="ident" id="7958960">nil</span>&nbsp;<span class="op" id="7958964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7958968">t</span><span class="op" id="7958969">.</span><span class="ident" id="7958970">Fatalf</span><span class="op" id="7958976">(</span><span class="string" id="7958977">&#34;s=%q;&nbsp;err=%s&#34;</span><span class="op" id="7958991">,</span>&nbsp;<span class="ident" id="7958993">s</span><span class="op" id="7958994">,</span>&nbsp;<span class="ident" id="7958996">err</span><span class="op" id="7958999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7959002">}</span><br>
<span class="lineno">20</span><span class="op" id="7959004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7959007">func</span>&nbsp;<span class="ident" id="7959012">TestDotWriter</span><span class="op" id="7959025">(</span><span class="ident" id="7959026">t</span>&nbsp;<span class="op" id="7959028">*</span><span class="ident" id="7959029">testing</span><span class="op" id="7959036">.</span><span class="ident" id="7959037">T</span><span class="op" id="7959038">)</span>&nbsp;<span class="op" id="7959040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7959043">var</span>&nbsp;<span class="ident" id="7959047">buf</span>&nbsp;<span class="ident" id="7959051">bytes</span><span class="op" id="7959056">.</span><span class="ident" id="7959057">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7959065">w</span>&nbsp;<span class="op" id="7959067">:=</span>&nbsp;<span class="ident" id="7959070">NewWriter</span><span class="op" id="7959079">(</span><span class="ident" id="7959080">bufio</span><span class="op" id="7959085">.</span><span class="ident" id="7959086">NewWriter</span><span class="op" id="7959095">(</span><span class="op" id="7959096">&amp;</span><span class="ident" id="7959097">buf</span><span class="op" id="7959100">)</span><span class="op" id="7959101">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7959104">d</span>&nbsp;<span class="op" id="7959106">:=</span>&nbsp;<span class="ident" id="7959109">w</span><span class="op" id="7959110">.</span><span class="ident" id="7959111">DotWriter</span><span class="op" id="7959120">(</span><span class="op" id="7959121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7959124">n</span><span class="op" id="7959125">,</span>&nbsp;<span class="ident" id="7959127">err</span>&nbsp;<span class="op" id="7959131">:=</span>&nbsp;<span class="ident" id="7959134">d</span><span class="op" id="7959135">.</span><span class="ident" id="7959136">Write</span><span class="op" id="7959141">(</span><span class="op" id="7959142">[</span><span class="op" id="7959143">]</span><span class="builtintype" id="7959144">byte</span><span class="op" id="7959148">(</span><span class="string" id="7959149">&#34;abc\n.def\n..ghi\n.jkl\n.&#34;</span><span class="op" id="7959176">)</span><span class="op" id="7959177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7959180">if</span>&nbsp;<span class="ident" id="7959183">n</span>&nbsp;<span class="op" id="7959185">!=</span>&nbsp;<span class="num" id="7959188">21</span>&nbsp;<span class="op" id="7959191">||</span>&nbsp;<span class="ident" id="7959194">err</span>&nbsp;<span class="op" id="7959198">!=</span>&nbsp;<span class="ident" id="7959201">nil</span>&nbsp;<span class="op" id="7959205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7959209">t</span><span class="op" id="7959210">.</span><span class="ident" id="7959211">Fatalf</span><span class="op" id="7959217">(</span><span class="string" id="7959218">&#34;Write:&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="7959233">,</span>&nbsp;<span class="ident" id="7959235">n</span><span class="op" id="7959236">,</span>&nbsp;<span class="ident" id="7959238">err</span><span class="op" id="7959241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7959244">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7959247">d</span><span class="op" id="7959248">.</span><span class="ident" id="7959249">Close</span><span class="op" id="7959254">(</span><span class="op" id="7959255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7959258">want</span>&nbsp;<span class="op" id="7959263">:=</span>&nbsp;<span class="string" id="7959266">&#34;abc\r\n..def\r\n...ghi\r\n..jkl\r\n..\r\n.\r\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7959316">if</span>&nbsp;<span class="ident" id="7959319">s</span>&nbsp;<span class="op" id="7959321">:=</span>&nbsp;<span class="ident" id="7959324">buf</span><span class="op" id="7959327">.</span><span class="ident" id="7959328">String</span><span class="op" id="7959334">(</span><span class="op" id="7959335">)</span><span class="op" id="7959336">;</span>&nbsp;<span class="ident" id="7959338">s</span>&nbsp;<span class="op" id="7959340">!=</span>&nbsp;<span class="ident" id="7959343">want</span>&nbsp;<span class="op" id="7959348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7959352">t</span><span class="op" id="7959353">.</span><span class="ident" id="7959354">Fatalf</span><span class="op" id="7959360">(</span><span class="string" id="7959361">&#34;wrote&nbsp;%q&#34;</span><span class="op" id="7959371">,</span>&nbsp;<span class="ident" id="7959373">s</span><span class="op" id="7959374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7959377">}</span><br>
<span class="lineno">35</span><span class="op" id="7959379">}</span>
</div>
</body>
</html>
