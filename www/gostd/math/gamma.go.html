<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html" class="current">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2303521">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2303576">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2303630">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2303681">package</span>&nbsp;<span class="ident" id="2303689">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303695">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2303755">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2303820">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2303878">//</span><br>
<span class="lineno"></span><span class="comment" id="2303881">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2303898">//</span><br>
<span class="lineno"></span><span class="comment" id="2303901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2303924">//</span><br>
<span class="lineno">15</span><span class="comment" id="2303927">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2303940">//</span><br>
<span class="lineno"></span><span class="comment" id="2303943">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2303969">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2303992">//</span><br>
<span class="lineno">20</span><span class="comment" id="2303995">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2304015">//</span><br>
<span class="lineno"></span><span class="comment" id="2304018">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2304034">//</span><br>
<span class="lineno"></span><span class="comment" id="2304037">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2304095">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2304148">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2304205">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2304265">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2304287">//</span><br>
<span class="lineno">30</span><span class="comment" id="2304290">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2304356">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2304416">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2304478">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2304539">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2304564">//</span><br>
<span class="lineno"></span><span class="comment" id="2304567">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2304580">//</span><br>
<span class="lineno"></span><span class="comment" id="2304583">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2304623">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2304681">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2304741">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2304801">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2304861">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2304921">//</span><br>
<span class="lineno">45</span><span class="comment" id="2304924">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2304985">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2305046">//</span><br>
<span class="lineno"></span><span class="comment" id="2305049">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2305097">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2305161">//</span><br>
<span class="lineno"></span><span class="comment" id="2305164">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2305225">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2305295">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2305370">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2305437">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2305510">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2305582">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2305596">//</span><br>
<span class="lineno"></span><span class="comment" id="2305599">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2305665">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2305731">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2305744">//</span><br>
<span class="lineno"></span><span class="comment" id="2305747">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2305771">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2305801">var</span>&nbsp;<span class="ident" id="2305805">_gamP</span>&nbsp;<span class="op" id="2305811">=</span>&nbsp;<span class="op" id="2305813">[</span><span class="op" id="2305814">...</span><span class="op" id="2305817">]</span><span class="builtintype" id="2305818">float64</span><span class="op" id="2305825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2305828">1.60119522476751861407e-04</span><span class="op" id="2305854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2305857">1.19135147006586384913e-03</span><span class="op" id="2305883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2305886">1.04213797561761569935e-02</span><span class="op" id="2305912">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2305915">4.76367800457137231464e-02</span><span class="op" id="2305941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2305944">2.07448227648435975150e-01</span><span class="op" id="2305970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2305973">4.94214826801497100753e-01</span><span class="op" id="2305999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306002">9.99999999999999996796e-01</span><span class="op" id="2306028">,</span><br>
<span class="lineno"></span><span class="op" id="2306030">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2306032">var</span>&nbsp;<span class="ident" id="2306036">_gamQ</span>&nbsp;<span class="op" id="2306042">=</span>&nbsp;<span class="op" id="2306044">[</span><span class="op" id="2306045">...</span><span class="op" id="2306048">]</span><span class="builtintype" id="2306049">float64</span><span class="op" id="2306056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306059">-</span><span class="num" id="2306060">2.31581873324120129819e-05</span><span class="op" id="2306086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306089">5.39605580493303397842e-04</span><span class="op" id="2306115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306118">-</span><span class="num" id="2306119">4.45641913851797240494e-03</span><span class="op" id="2306145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306148">1.18139785222060435552e-02</span><span class="op" id="2306174">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306177">3.58236398605498653373e-02</span><span class="op" id="2306203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306206">-</span><span class="num" id="2306207">2.34591795718243348568e-01</span><span class="op" id="2306233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306236">7.14304917030273074085e-02</span><span class="op" id="2306262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306265">1.00000000000000000320e+00</span><span class="op" id="2306291">,</span><br>
<span class="lineno"></span><span class="op" id="2306293">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2306295">var</span>&nbsp;<span class="ident" id="2306299">_gamS</span>&nbsp;<span class="op" id="2306305">=</span>&nbsp;<span class="op" id="2306307">[</span><span class="op" id="2306308">...</span><span class="op" id="2306311">]</span><span class="builtintype" id="2306312">float64</span><span class="op" id="2306319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306322">7.87311395793093628397e-04</span><span class="op" id="2306348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306351">-</span><span class="num" id="2306352">2.29549961613378126380e-04</span><span class="op" id="2306378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306381">-</span><span class="num" id="2306382">2.68132617805781232825e-03</span><span class="op" id="2306408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306411">3.47222221605458667310e-03</span><span class="op" id="2306437">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2306440">8.33333333333482257126e-02</span><span class="op" id="2306466">,</span><br>
<span class="lineno"></span><span class="op" id="2306468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2306471">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2306521">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2306568">func</span>&nbsp;<span class="ident" id="2306573">stirling</span><span class="op" id="2306581">(</span><span class="ident" id="2306582">x</span>&nbsp;<span class="builtintype" id="2306584">float64</span><span class="op" id="2306591">)</span>&nbsp;<span class="builtintype" id="2306593">float64</span>&nbsp;<span class="op" id="2306601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306604">const</span>&nbsp;<span class="op" id="2306610">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306614">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2306626">=</span>&nbsp;<span class="num" id="2306628">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306654">MaxStirling</span>&nbsp;<span class="op" id="2306666">=</span>&nbsp;<span class="num" id="2306668">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306679">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306682">w</span>&nbsp;<span class="op" id="2306684">:=</span>&nbsp;<span class="num" id="2306687">1</span>&nbsp;<span class="op" id="2306689">/</span>&nbsp;<span class="ident" id="2306691">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306694">w</span>&nbsp;<span class="op" id="2306696">=</span>&nbsp;<span class="num" id="2306698">1</span>&nbsp;<span class="op" id="2306700">+</span>&nbsp;<span class="ident" id="2306702">w</span><span class="op" id="2306703">*</span><span class="op" id="2306704">(</span><span class="op" id="2306705">(</span><span class="op" id="2306706">(</span><span class="op" id="2306707">(</span><span class="ident" id="2306708">_gamS</span><span class="op" id="2306713">[</span><span class="num" id="2306714">0</span><span class="op" id="2306715">]</span><span class="op" id="2306716">*</span><span class="ident" id="2306717">w</span><span class="op" id="2306718">+</span><span class="ident" id="2306719">_gamS</span><span class="op" id="2306724">[</span><span class="num" id="2306725">1</span><span class="op" id="2306726">]</span><span class="op" id="2306727">)</span><span class="op" id="2306728">*</span><span class="ident" id="2306729">w</span><span class="op" id="2306730">+</span><span class="ident" id="2306731">_gamS</span><span class="op" id="2306736">[</span><span class="num" id="2306737">2</span><span class="op" id="2306738">]</span><span class="op" id="2306739">)</span><span class="op" id="2306740">*</span><span class="ident" id="2306741">w</span><span class="op" id="2306742">+</span><span class="ident" id="2306743">_gamS</span><span class="op" id="2306748">[</span><span class="num" id="2306749">3</span><span class="op" id="2306750">]</span><span class="op" id="2306751">)</span><span class="op" id="2306752">*</span><span class="ident" id="2306753">w</span><span class="op" id="2306754">+</span><span class="ident" id="2306755">_gamS</span><span class="op" id="2306760">[</span><span class="num" id="2306761">4</span><span class="op" id="2306762">]</span><span class="op" id="2306763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306766">y</span>&nbsp;<span class="op" id="2306768">:=</span>&nbsp;<span class="ident" id="2306771">Exp</span><span class="op" id="2306774">(</span><span class="ident" id="2306775">x</span><span class="op" id="2306776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306779">if</span>&nbsp;<span class="ident" id="2306782">x</span>&nbsp;<span class="op" id="2306784">&gt;</span>&nbsp;<span class="ident" id="2306786">MaxStirling</span>&nbsp;<span class="op" id="2306798">{</span>&nbsp;<span class="comment" id="2306800">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306826">v</span>&nbsp;<span class="op" id="2306828">:=</span>&nbsp;<span class="ident" id="2306831">Pow</span><span class="op" id="2306834">(</span><span class="ident" id="2306835">x</span><span class="op" id="2306836">,</span>&nbsp;<span class="num" id="2306838">0.5</span><span class="op" id="2306841">*</span><span class="ident" id="2306842">x</span><span class="op" id="2306843">-</span><span class="num" id="2306844">0.25</span><span class="op" id="2306848">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306852">y</span>&nbsp;<span class="op" id="2306854">=</span>&nbsp;<span class="ident" id="2306856">v</span>&nbsp;<span class="op" id="2306858">*</span>&nbsp;<span class="op" id="2306860">(</span><span class="ident" id="2306861">v</span>&nbsp;<span class="op" id="2306863">/</span>&nbsp;<span class="ident" id="2306865">y</span><span class="op" id="2306866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306869">}</span>&nbsp;<span class="keyword" id="2306871">else</span>&nbsp;<span class="op" id="2306876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306880">y</span>&nbsp;<span class="op" id="2306882">=</span>&nbsp;<span class="ident" id="2306884">Pow</span><span class="op" id="2306887">(</span><span class="ident" id="2306888">x</span><span class="op" id="2306889">,</span>&nbsp;<span class="ident" id="2306891">x</span><span class="op" id="2306892">-</span><span class="num" id="2306893">0.5</span><span class="op" id="2306896">)</span>&nbsp;<span class="op" id="2306898">/</span>&nbsp;<span class="ident" id="2306900">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306906">y</span>&nbsp;<span class="op" id="2306908">=</span>&nbsp;<span class="ident" id="2306910">SqrtTwoPi</span>&nbsp;<span class="op" id="2306920">*</span>&nbsp;<span class="ident" id="2306922">y</span>&nbsp;<span class="op" id="2306924">*</span>&nbsp;<span class="ident" id="2306926">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306929">return</span>&nbsp;<span class="ident" id="2306936">y</span><br>
<span class="lineno"></span><span class="op" id="2306938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2306941">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2306983">//</span><br>
<span class="lineno">115</span><span class="comment" id="2306986">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2307008">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2307030">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2307050">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2307070">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2307106">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2307127">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2307147">func</span>&nbsp;<span class="ident" id="2307152">Gamma</span><span class="op" id="2307157">(</span><span class="ident" id="2307158">x</span>&nbsp;<span class="builtintype" id="2307160">float64</span><span class="op" id="2307167">)</span>&nbsp;<span class="builtintype" id="2307169">float64</span>&nbsp;<span class="op" id="2307177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307180">const</span>&nbsp;<span class="ident" id="2307186">Euler</span>&nbsp;<span class="op" id="2307192">=</span>&nbsp;<span class="num" id="2307194">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2307247">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2307259">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307277">switch</span>&nbsp;<span class="op" id="2307284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307287">case</span>&nbsp;<span class="ident" id="2307292">isNegInt</span><span class="op" id="2307300">(</span><span class="ident" id="2307301">x</span><span class="op" id="2307302">)</span>&nbsp;<span class="op" id="2307304">||</span>&nbsp;<span class="ident" id="2307307">IsInf</span><span class="op" id="2307312">(</span><span class="ident" id="2307313">x</span><span class="op" id="2307314">,</span>&nbsp;<span class="op" id="2307316">-</span><span class="num" id="2307317">1</span><span class="op" id="2307318">)</span>&nbsp;<span class="op" id="2307320">||</span>&nbsp;<span class="ident" id="2307323">IsNaN</span><span class="op" id="2307328">(</span><span class="ident" id="2307329">x</span><span class="op" id="2307330">)</span><span class="op" id="2307331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307335">return</span>&nbsp;<span class="ident" id="2307342">NaN</span><span class="op" id="2307345">(</span><span class="op" id="2307346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307349">case</span>&nbsp;<span class="ident" id="2307354">x</span>&nbsp;<span class="op" id="2307356">==</span>&nbsp;<span class="num" id="2307359">0</span><span class="op" id="2307360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307364">if</span>&nbsp;<span class="ident" id="2307367">Signbit</span><span class="op" id="2307374">(</span><span class="ident" id="2307375">x</span><span class="op" id="2307376">)</span>&nbsp;<span class="op" id="2307378">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307383">return</span>&nbsp;<span class="ident" id="2307390">Inf</span><span class="op" id="2307393">(</span><span class="op" id="2307394">-</span><span class="num" id="2307395">1</span><span class="op" id="2307396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307404">return</span>&nbsp;<span class="ident" id="2307411">Inf</span><span class="op" id="2307414">(</span><span class="num" id="2307415">1</span><span class="op" id="2307416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307419">case</span>&nbsp;<span class="ident" id="2307424">x</span>&nbsp;<span class="op" id="2307426">&lt;</span>&nbsp;<span class="op" id="2307428">-</span><span class="num" id="2307429">170.5674972726612</span>&nbsp;<span class="op" id="2307447">||</span>&nbsp;<span class="ident" id="2307450">x</span>&nbsp;<span class="op" id="2307452">&gt;</span>&nbsp;<span class="num" id="2307454">171.61447887182298</span><span class="op" id="2307472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307476">return</span>&nbsp;<span class="ident" id="2307483">Inf</span><span class="op" id="2307486">(</span><span class="num" id="2307487">1</span><span class="op" id="2307488">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307494">q</span>&nbsp;<span class="op" id="2307496">:=</span>&nbsp;<span class="ident" id="2307499">Abs</span><span class="op" id="2307502">(</span><span class="ident" id="2307503">x</span><span class="op" id="2307504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307507">p</span>&nbsp;<span class="op" id="2307509">:=</span>&nbsp;<span class="ident" id="2307512">Floor</span><span class="op" id="2307517">(</span><span class="ident" id="2307518">q</span><span class="op" id="2307519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307522">if</span>&nbsp;<span class="ident" id="2307525">q</span>&nbsp;<span class="op" id="2307527">&gt;</span>&nbsp;<span class="num" id="2307529">33</span>&nbsp;<span class="op" id="2307532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307536">if</span>&nbsp;<span class="ident" id="2307539">x</span>&nbsp;<span class="op" id="2307541">&gt;=</span>&nbsp;<span class="num" id="2307544">0</span>&nbsp;<span class="op" id="2307546">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307551">return</span>&nbsp;<span class="ident" id="2307558">stirling</span><span class="op" id="2307566">(</span><span class="ident" id="2307567">x</span><span class="op" id="2307568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307576">signgam</span>&nbsp;<span class="op" id="2307584">:=</span>&nbsp;<span class="num" id="2307587">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307591">if</span>&nbsp;<span class="ident" id="2307594">ip</span>&nbsp;<span class="op" id="2307597">:=</span>&nbsp;<span class="builtintype" id="2307600">int</span><span class="op" id="2307603">(</span><span class="ident" id="2307604">p</span><span class="op" id="2307605">)</span><span class="op" id="2307606">;</span>&nbsp;<span class="ident" id="2307608">ip</span><span class="op" id="2307610">&amp;</span><span class="num" id="2307611">1</span>&nbsp;<span class="op" id="2307613">==</span>&nbsp;<span class="num" id="2307616">0</span>&nbsp;<span class="op" id="2307618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307623">signgam</span>&nbsp;<span class="op" id="2307631">=</span>&nbsp;<span class="op" id="2307633">-</span><span class="num" id="2307634">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307642">z</span>&nbsp;<span class="op" id="2307644">:=</span>&nbsp;<span class="ident" id="2307647">q</span>&nbsp;<span class="op" id="2307649">-</span>&nbsp;<span class="ident" id="2307651">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307655">if</span>&nbsp;<span class="ident" id="2307658">z</span>&nbsp;<span class="op" id="2307660">&gt;</span>&nbsp;<span class="num" id="2307662">0.5</span>&nbsp;<span class="op" id="2307666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307671">p</span>&nbsp;<span class="op" id="2307673">=</span>&nbsp;<span class="ident" id="2307675">p</span>&nbsp;<span class="op" id="2307677">+</span>&nbsp;<span class="num" id="2307679">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307684">z</span>&nbsp;<span class="op" id="2307686">=</span>&nbsp;<span class="ident" id="2307688">q</span>&nbsp;<span class="op" id="2307690">-</span>&nbsp;<span class="ident" id="2307692">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307700">z</span>&nbsp;<span class="op" id="2307702">=</span>&nbsp;<span class="ident" id="2307704">q</span>&nbsp;<span class="op" id="2307706">*</span>&nbsp;<span class="ident" id="2307708">Sin</span><span class="op" id="2307711">(</span><span class="ident" id="2307712">Pi</span><span class="op" id="2307714">*</span><span class="ident" id="2307715">z</span><span class="op" id="2307716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307720">if</span>&nbsp;<span class="ident" id="2307723">z</span>&nbsp;<span class="op" id="2307725">==</span>&nbsp;<span class="num" id="2307728">0</span>&nbsp;<span class="op" id="2307730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307735">return</span>&nbsp;<span class="ident" id="2307742">Inf</span><span class="op" id="2307745">(</span><span class="ident" id="2307746">signgam</span><span class="op" id="2307753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307757">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307761">z</span>&nbsp;<span class="op" id="2307763">=</span>&nbsp;<span class="ident" id="2307765">Pi</span>&nbsp;<span class="op" id="2307768">/</span>&nbsp;<span class="op" id="2307770">(</span><span class="ident" id="2307771">Abs</span><span class="op" id="2307774">(</span><span class="ident" id="2307775">z</span><span class="op" id="2307776">)</span>&nbsp;<span class="op" id="2307778">*</span>&nbsp;<span class="ident" id="2307780">stirling</span><span class="op" id="2307788">(</span><span class="ident" id="2307789">q</span><span class="op" id="2307790">)</span><span class="op" id="2307791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307795">return</span>&nbsp;<span class="builtintype" id="2307802">float64</span><span class="op" id="2307809">(</span><span class="ident" id="2307810">signgam</span><span class="op" id="2307817">)</span>&nbsp;<span class="op" id="2307819">*</span>&nbsp;<span class="ident" id="2307821">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2307828">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307848">z</span>&nbsp;<span class="op" id="2307850">:=</span>&nbsp;<span class="num" id="2307853">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307858">for</span>&nbsp;<span class="ident" id="2307862">x</span>&nbsp;<span class="op" id="2307864">&gt;=</span>&nbsp;<span class="num" id="2307867">3</span>&nbsp;<span class="op" id="2307869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307873">x</span>&nbsp;<span class="op" id="2307875">=</span>&nbsp;<span class="ident" id="2307877">x</span>&nbsp;<span class="op" id="2307879">-</span>&nbsp;<span class="num" id="2307881">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307885">z</span>&nbsp;<span class="op" id="2307887">=</span>&nbsp;<span class="ident" id="2307889">z</span>&nbsp;<span class="op" id="2307891">*</span>&nbsp;<span class="ident" id="2307893">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307896">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307899">for</span>&nbsp;<span class="ident" id="2307903">x</span>&nbsp;<span class="op" id="2307905">&lt;</span>&nbsp;<span class="num" id="2307907">0</span>&nbsp;<span class="op" id="2307909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307913">if</span>&nbsp;<span class="ident" id="2307916">x</span>&nbsp;<span class="op" id="2307918">&gt;</span>&nbsp;<span class="op" id="2307920">-</span><span class="num" id="2307921">1e-09</span>&nbsp;<span class="op" id="2307927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307932">goto</span>&nbsp;<span class="ident" id="2307937">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307949">z</span>&nbsp;<span class="op" id="2307951">=</span>&nbsp;<span class="ident" id="2307953">z</span>&nbsp;<span class="op" id="2307955">/</span>&nbsp;<span class="ident" id="2307957">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307961">x</span>&nbsp;<span class="op" id="2307963">=</span>&nbsp;<span class="ident" id="2307965">x</span>&nbsp;<span class="op" id="2307967">+</span>&nbsp;<span class="num" id="2307969">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307975">for</span>&nbsp;<span class="ident" id="2307979">x</span>&nbsp;<span class="op" id="2307981">&lt;</span>&nbsp;<span class="num" id="2307983">2</span>&nbsp;<span class="op" id="2307985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307989">if</span>&nbsp;<span class="ident" id="2307992">x</span>&nbsp;<span class="op" id="2307994">&lt;</span>&nbsp;<span class="num" id="2307996">1e-09</span>&nbsp;<span class="op" id="2308002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308007">goto</span>&nbsp;<span class="ident" id="2308012">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308024">z</span>&nbsp;<span class="op" id="2308026">=</span>&nbsp;<span class="ident" id="2308028">z</span>&nbsp;<span class="op" id="2308030">/</span>&nbsp;<span class="ident" id="2308032">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308036">x</span>&nbsp;<span class="op" id="2308038">=</span>&nbsp;<span class="ident" id="2308040">x</span>&nbsp;<span class="op" id="2308042">+</span>&nbsp;<span class="num" id="2308044">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308051">if</span>&nbsp;<span class="ident" id="2308054">x</span>&nbsp;<span class="op" id="2308056">==</span>&nbsp;<span class="num" id="2308059">2</span>&nbsp;<span class="op" id="2308061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308065">return</span>&nbsp;<span class="ident" id="2308072">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308079">x</span>&nbsp;<span class="op" id="2308081">=</span>&nbsp;<span class="ident" id="2308083">x</span>&nbsp;<span class="op" id="2308085">-</span>&nbsp;<span class="num" id="2308087">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308090">p</span>&nbsp;<span class="op" id="2308092">=</span>&nbsp;<span class="op" id="2308094">(</span><span class="op" id="2308095">(</span><span class="op" id="2308096">(</span><span class="op" id="2308097">(</span><span class="op" id="2308098">(</span><span class="ident" id="2308099">x</span><span class="op" id="2308100">*</span><span class="ident" id="2308101">_gamP</span><span class="op" id="2308106">[</span><span class="num" id="2308107">0</span><span class="op" id="2308108">]</span><span class="op" id="2308109">+</span><span class="ident" id="2308110">_gamP</span><span class="op" id="2308115">[</span><span class="num" id="2308116">1</span><span class="op" id="2308117">]</span><span class="op" id="2308118">)</span><span class="op" id="2308119">*</span><span class="ident" id="2308120">x</span><span class="op" id="2308121">+</span><span class="ident" id="2308122">_gamP</span><span class="op" id="2308127">[</span><span class="num" id="2308128">2</span><span class="op" id="2308129">]</span><span class="op" id="2308130">)</span><span class="op" id="2308131">*</span><span class="ident" id="2308132">x</span><span class="op" id="2308133">+</span><span class="ident" id="2308134">_gamP</span><span class="op" id="2308139">[</span><span class="num" id="2308140">3</span><span class="op" id="2308141">]</span><span class="op" id="2308142">)</span><span class="op" id="2308143">*</span><span class="ident" id="2308144">x</span><span class="op" id="2308145">+</span><span class="ident" id="2308146">_gamP</span><span class="op" id="2308151">[</span><span class="num" id="2308152">4</span><span class="op" id="2308153">]</span><span class="op" id="2308154">)</span><span class="op" id="2308155">*</span><span class="ident" id="2308156">x</span><span class="op" id="2308157">+</span><span class="ident" id="2308158">_gamP</span><span class="op" id="2308163">[</span><span class="num" id="2308164">5</span><span class="op" id="2308165">]</span><span class="op" id="2308166">)</span><span class="op" id="2308167">*</span><span class="ident" id="2308168">x</span>&nbsp;<span class="op" id="2308170">+</span>&nbsp;<span class="ident" id="2308172">_gamP</span><span class="op" id="2308177">[</span><span class="num" id="2308178">6</span><span class="op" id="2308179">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308182">q</span>&nbsp;<span class="op" id="2308184">=</span>&nbsp;<span class="op" id="2308186">(</span><span class="op" id="2308187">(</span><span class="op" id="2308188">(</span><span class="op" id="2308189">(</span><span class="op" id="2308190">(</span><span class="op" id="2308191">(</span><span class="ident" id="2308192">x</span><span class="op" id="2308193">*</span><span class="ident" id="2308194">_gamQ</span><span class="op" id="2308199">[</span><span class="num" id="2308200">0</span><span class="op" id="2308201">]</span><span class="op" id="2308202">+</span><span class="ident" id="2308203">_gamQ</span><span class="op" id="2308208">[</span><span class="num" id="2308209">1</span><span class="op" id="2308210">]</span><span class="op" id="2308211">)</span><span class="op" id="2308212">*</span><span class="ident" id="2308213">x</span><span class="op" id="2308214">+</span><span class="ident" id="2308215">_gamQ</span><span class="op" id="2308220">[</span><span class="num" id="2308221">2</span><span class="op" id="2308222">]</span><span class="op" id="2308223">)</span><span class="op" id="2308224">*</span><span class="ident" id="2308225">x</span><span class="op" id="2308226">+</span><span class="ident" id="2308227">_gamQ</span><span class="op" id="2308232">[</span><span class="num" id="2308233">3</span><span class="op" id="2308234">]</span><span class="op" id="2308235">)</span><span class="op" id="2308236">*</span><span class="ident" id="2308237">x</span><span class="op" id="2308238">+</span><span class="ident" id="2308239">_gamQ</span><span class="op" id="2308244">[</span><span class="num" id="2308245">4</span><span class="op" id="2308246">]</span><span class="op" id="2308247">)</span><span class="op" id="2308248">*</span><span class="ident" id="2308249">x</span><span class="op" id="2308250">+</span><span class="ident" id="2308251">_gamQ</span><span class="op" id="2308256">[</span><span class="num" id="2308257">5</span><span class="op" id="2308258">]</span><span class="op" id="2308259">)</span><span class="op" id="2308260">*</span><span class="ident" id="2308261">x</span><span class="op" id="2308262">+</span><span class="ident" id="2308263">_gamQ</span><span class="op" id="2308268">[</span><span class="num" id="2308269">6</span><span class="op" id="2308270">]</span><span class="op" id="2308271">)</span><span class="op" id="2308272">*</span><span class="ident" id="2308273">x</span>&nbsp;<span class="op" id="2308275">+</span>&nbsp;<span class="ident" id="2308277">_gamQ</span><span class="op" id="2308282">[</span><span class="num" id="2308283">7</span><span class="op" id="2308284">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308287">return</span>&nbsp;<span class="ident" id="2308294">z</span>&nbsp;<span class="op" id="2308296">*</span>&nbsp;<span class="ident" id="2308298">p</span>&nbsp;<span class="op" id="2308300">/</span>&nbsp;<span class="ident" id="2308302">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2308305">small</span><span class="op" id="2308310">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308313">if</span>&nbsp;<span class="ident" id="2308316">x</span>&nbsp;<span class="op" id="2308318">==</span>&nbsp;<span class="num" id="2308321">0</span>&nbsp;<span class="op" id="2308323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308327">return</span>&nbsp;<span class="ident" id="2308334">Inf</span><span class="op" id="2308337">(</span><span class="num" id="2308338">1</span><span class="op" id="2308339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308345">return</span>&nbsp;<span class="ident" id="2308352">z</span>&nbsp;<span class="op" id="2308354">/</span>&nbsp;<span class="op" id="2308356">(</span><span class="op" id="2308357">(</span><span class="num" id="2308358">1</span>&nbsp;<span class="op" id="2308360">+</span>&nbsp;<span class="ident" id="2308362">Euler</span><span class="op" id="2308367">*</span><span class="ident" id="2308368">x</span><span class="op" id="2308369">)</span>&nbsp;<span class="op" id="2308371">*</span>&nbsp;<span class="ident" id="2308373">x</span><span class="op" id="2308374">)</span><br>
<span class="lineno"></span><span class="op" id="2308376">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2308379">func</span>&nbsp;<span class="ident" id="2308384">isNegInt</span><span class="op" id="2308392">(</span><span class="ident" id="2308393">x</span>&nbsp;<span class="builtintype" id="2308395">float64</span><span class="op" id="2308402">)</span>&nbsp;<span class="builtintype" id="2308404">bool</span>&nbsp;<span class="op" id="2308409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308412">if</span>&nbsp;<span class="ident" id="2308415">x</span>&nbsp;<span class="op" id="2308417">&lt;</span>&nbsp;<span class="num" id="2308419">0</span>&nbsp;<span class="op" id="2308421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308425">_</span><span class="op" id="2308426">,</span>&nbsp;<span class="ident" id="2308428">xf</span>&nbsp;<span class="op" id="2308431">:=</span>&nbsp;<span class="ident" id="2308434">Modf</span><span class="op" id="2308438">(</span><span class="ident" id="2308439">x</span><span class="op" id="2308440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308444">return</span>&nbsp;<span class="ident" id="2308451">xf</span>&nbsp;<span class="op" id="2308454">==</span>&nbsp;<span class="num" id="2308457">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308463">return</span>&nbsp;<span class="builtintype" id="2308470">false</span><br>
<span class="lineno"></span><span class="op" id="2308476">}</span>
</div>
</body>
</html>
