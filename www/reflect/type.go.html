<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2552520">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2552575">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2552629">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2552680">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2552753">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2552833">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2552909">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2552950">//</span><br>
<span class="lineno">10</span><span class="comment" id="2552953">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2553022">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2553089">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2553107">//</span><br>
<span class="lineno"></span><span class="comment" id="2553110">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2553183">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2553241">package</span>&nbsp;<span class="ident" id="2553249">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553258">import</span>&nbsp;<span class="op" id="2553265">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2553268">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2553279">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2553290">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2553298">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2553307">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2553310">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2553354">//</span><br>
<span class="lineno"></span><span class="comment" id="2553357">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2553420">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2553479">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2553538">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2553590">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2553652">type</span>&nbsp;<span class="ident" id="2553657">Type</span>&nbsp;<span class="keyword" id="2553662">interface</span>&nbsp;<span class="op" id="2553672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553675">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553713">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553768">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553808">Align</span><span class="op" id="2553813">(</span><span class="op" id="2553814">)</span>&nbsp;<span class="builtintype" id="2553816">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553822">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553882">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553930">FieldAlign</span><span class="op" id="2553940">(</span><span class="op" id="2553941">)</span>&nbsp;<span class="builtintype" id="2553943">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2553949">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554010">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554067">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554071">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554145">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554214">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554218">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554288">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554357">Method</span><span class="op" id="2554363">(</span><span class="builtintype" id="2554364">int</span><span class="op" id="2554367">)</span>&nbsp;<span class="ident" id="2554369">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554378">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554443">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554508">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554512">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554586">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554655">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554659">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554729">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554798">MethodByName</span><span class="op" id="2554810">(</span><span class="builtintype" id="2554811">string</span><span class="op" id="2554817">)</span>&nbsp;<span class="op" id="2554819">(</span><span class="ident" id="2554820">Method</span><span class="op" id="2554826">,</span>&nbsp;<span class="builtintype" id="2554828">bool</span><span class="op" id="2554832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554836">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554906">NumMethod</span><span class="op" id="2554915">(</span><span class="op" id="2554916">)</span>&nbsp;<span class="builtintype" id="2554918">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554924">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2554977">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555027">Name</span><span class="op" id="2555031">(</span><span class="op" id="2555032">)</span>&nbsp;<span class="builtintype" id="2555034">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555043">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555117">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555186">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555268">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555315">PkgPath</span><span class="op" id="2555322">(</span><span class="op" id="2555323">)</span>&nbsp;<span class="builtintype" id="2555325">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555334">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555387">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555452">Size</span><span class="op" id="2555456">(</span><span class="op" id="2555457">)</span>&nbsp;<span class="builtintype" id="2555459">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555469">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555525">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555587">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555646">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555710">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555742">String</span><span class="op" id="2555748">(</span><span class="op" id="2555749">)</span>&nbsp;<span class="builtintype" id="2555751">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555760">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555809">Kind</span><span class="op" id="2555813">(</span><span class="op" id="2555814">)</span>&nbsp;<span class="ident" id="2555816">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555823">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555896">Implements</span><span class="op" id="2555906">(</span><span class="ident" id="2555907">u</span>&nbsp;<span class="ident" id="2555909">Type</span><span class="op" id="2555913">)</span>&nbsp;<span class="builtintype" id="2555915">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555922">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556000">AssignableTo</span><span class="op" id="2556012">(</span><span class="ident" id="2556013">u</span>&nbsp;<span class="ident" id="2556015">Type</span><span class="op" id="2556019">)</span>&nbsp;<span class="builtintype" id="2556021">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556028">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556108">ConvertibleTo</span><span class="op" id="2556121">(</span><span class="ident" id="2556122">u</span>&nbsp;<span class="ident" id="2556124">Type</span><span class="op" id="2556128">)</span>&nbsp;<span class="builtintype" id="2556130">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556137">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556204">Comparable</span><span class="op" id="2556214">(</span><span class="op" id="2556215">)</span>&nbsp;<span class="builtintype" id="2556217">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556224">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556286">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556329">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556333">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556373">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556394">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556418">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556464">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556483">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556497">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556513">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556586">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556633">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556684">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556741">Bits</span><span class="op" id="2556745">(</span><span class="op" id="2556746">)</span>&nbsp;<span class="builtintype" id="2556748">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556754">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556802">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556848">ChanDir</span><span class="op" id="2556855">(</span><span class="op" id="2556856">)</span>&nbsp;<span class="ident" id="2556858">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556868">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556939">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557017">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557047">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557051">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557122">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557126">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557145">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557187">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557235">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557262">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557266">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557320">IsVariadic</span><span class="op" id="2557330">(</span><span class="op" id="2557331">)</span>&nbsp;<span class="builtintype" id="2557333">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557340">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557380">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557453">Elem</span><span class="op" id="2557457">(</span><span class="op" id="2557458">)</span>&nbsp;<span class="ident" id="2557460">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557467">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557513">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557561">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557617">Field</span><span class="op" id="2557622">(</span><span class="ident" id="2557623">i</span>&nbsp;<span class="builtintype" id="2557625">int</span><span class="op" id="2557628">)</span>&nbsp;<span class="ident" id="2557630">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557644">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557700">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557762">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557797">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557845">FieldByIndex</span><span class="op" id="2557857">(</span><span class="ident" id="2557858">index</span>&nbsp;<span class="op" id="2557864">[</span><span class="op" id="2557865">]</span><span class="builtintype" id="2557866">int</span><span class="op" id="2557869">)</span>&nbsp;<span class="ident" id="2557871">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557885">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557946">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557999">FieldByName</span><span class="op" id="2558010">(</span><span class="ident" id="2558011">name</span>&nbsp;<span class="builtintype" id="2558016">string</span><span class="op" id="2558022">)</span>&nbsp;<span class="op" id="2558024">(</span><span class="ident" id="2558025">StructField</span><span class="op" id="2558036">,</span>&nbsp;<span class="builtintype" id="2558038">bool</span><span class="op" id="2558042">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558046">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558109">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558175">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558200">FieldByNameFunc</span><span class="op" id="2558215">(</span><span class="ident" id="2558216">match</span>&nbsp;<span class="keyword" id="2558222">func</span><span class="op" id="2558226">(</span><span class="builtintype" id="2558227">string</span><span class="op" id="2558233">)</span>&nbsp;<span class="builtintype" id="2558235">bool</span><span class="op" id="2558239">)</span>&nbsp;<span class="op" id="2558241">(</span><span class="ident" id="2558242">StructField</span><span class="op" id="2558253">,</span>&nbsp;<span class="builtintype" id="2558255">bool</span><span class="op" id="2558259">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558263">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558330">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558376">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558429">In</span><span class="op" id="2558431">(</span><span class="ident" id="2558432">i</span>&nbsp;<span class="builtintype" id="2558434">int</span><span class="op" id="2558437">)</span>&nbsp;<span class="ident" id="2558439">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558446">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558485">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558530">Key</span><span class="op" id="2558533">(</span><span class="op" id="2558534">)</span>&nbsp;<span class="ident" id="2558536">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558543">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558583">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558630">Len</span><span class="op" id="2558633">(</span><span class="op" id="2558634">)</span>&nbsp;<span class="builtintype" id="2558636">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558642">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558692">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558740">NumField</span><span class="op" id="2558748">(</span><span class="op" id="2558749">)</span>&nbsp;<span class="builtintype" id="2558751">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558757">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558816">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558862">NumIn</span><span class="op" id="2558867">(</span><span class="op" id="2558868">)</span>&nbsp;<span class="builtintype" id="2558870">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558876">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558937">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558983">NumOut</span><span class="op" id="2558989">(</span><span class="op" id="2558990">)</span>&nbsp;<span class="builtintype" id="2558992">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558998">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2559067">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2559113">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559167">Out</span><span class="op" id="2559170">(</span><span class="ident" id="2559171">i</span>&nbsp;<span class="builtintype" id="2559173">int</span><span class="op" id="2559176">)</span>&nbsp;<span class="ident" id="2559178">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559185">common</span><span class="op" id="2559191">(</span><span class="op" id="2559192">)</span>&nbsp;<span class="op" id="2559194">*</span><span class="ident" id="2559195">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559202">uncommon</span><span class="op" id="2559210">(</span><span class="op" id="2559211">)</span>&nbsp;<span class="op" id="2559213">*</span><span class="ident" id="2559214">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2559227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2559230">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2559317">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2559390">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2559467">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2559539">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2559602">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2559689">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2559737">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2559932">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2560003">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2560041">type</span>&nbsp;<span class="ident" id="2560046">Kind</span>&nbsp;<span class="builtintype" id="2560051">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2560057">const</span>&nbsp;<span class="op" id="2560063">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560066">Invalid</span>&nbsp;<span class="ident" id="2560074">Kind</span>&nbsp;<span class="op" id="2560079">=</span>&nbsp;<span class="ident" id="2560081">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560087">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560093">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560098">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560104">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560111">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560118">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560125">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560131">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560138">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560146">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560154">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560162">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560171">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560180">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560189">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560200">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560212">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560219">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560225">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560231">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560242">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560247">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560252">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560259">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560267">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560275">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2560289">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2560292">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2560346">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2560406">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2560469">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2560535">type</span>&nbsp;<span class="ident" id="2560540">rtype</span>&nbsp;<span class="keyword" id="2560546">struct</span>&nbsp;<span class="op" id="2560553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560556">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2560570">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560579">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2560593">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560611">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560663">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2560677">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560695">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560714">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2560728">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560746">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560787">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2560801">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560819">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560864">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2560878">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560896">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560918">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2560932">*</span><span class="ident" id="2560933">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2560950">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560998">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561012">[</span><span class="num" id="2561013">2</span><span class="op" id="2561014">]</span><span class="ident" id="2561015">unsafe</span><span class="op" id="2561021">.</span><span class="ident" id="2561022">Pointer</span>&nbsp;<span class="comment" id="2561030">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2561058">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561072">*</span><span class="builtintype" id="2561073">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561090">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561141">*</span><span class="ident" id="2561142">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561173">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561206">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561220">*</span><span class="ident" id="2561221">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561238">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561306">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2561320">unsafe</span><span class="op" id="2561326">.</span><span class="ident" id="2561327">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561338">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2561363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2561366">type</span>&nbsp;<span class="ident" id="2561371">typeAlg</span>&nbsp;<span class="keyword" id="2561379">struct</span>&nbsp;<span class="op" id="2561386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2561389">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2561435">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561475">hash</span>&nbsp;<span class="keyword" id="2561480">func</span><span class="op" id="2561484">(</span><span class="ident" id="2561485">unsafe</span><span class="op" id="2561491">.</span><span class="ident" id="2561492">Pointer</span><span class="op" id="2561499">,</span>&nbsp;<span class="builtintype" id="2561501">uintptr</span><span class="op" id="2561508">,</span>&nbsp;<span class="builtintype" id="2561510">uintptr</span><span class="op" id="2561517">)</span>&nbsp;<span class="builtintype" id="2561519">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2561528">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2561576">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561628">equal</span>&nbsp;<span class="keyword" id="2561634">func</span><span class="op" id="2561638">(</span><span class="ident" id="2561639">unsafe</span><span class="op" id="2561645">.</span><span class="ident" id="2561646">Pointer</span><span class="op" id="2561653">,</span>&nbsp;<span class="ident" id="2561655">unsafe</span><span class="op" id="2561661">.</span><span class="ident" id="2561662">Pointer</span><span class="op" id="2561669">,</span>&nbsp;<span class="builtintype" id="2561671">uintptr</span><span class="op" id="2561678">)</span>&nbsp;<span class="builtintype" id="2561680">bool</span><br>
<span class="lineno"></span><span class="op" id="2561685">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2561688">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2561720">type</span>&nbsp;<span class="ident" id="2561725">method</span>&nbsp;<span class="keyword" id="2561732">struct</span>&nbsp;<span class="op" id="2561739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561742">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561750">*</span><span class="builtintype" id="2561751">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561765">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561784">pkgPath</span>&nbsp;<span class="op" id="2561792">*</span><span class="builtintype" id="2561793">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561807">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561857">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561865">*</span><span class="ident" id="2561866">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561880">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561915">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2561923">*</span><span class="ident" id="2561924">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2561938">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561982">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2561990">unsafe</span><span class="op" id="2561996">.</span><span class="ident" id="2561997">Pointer</span>&nbsp;<span class="comment" id="2562005">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562055">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2562063">unsafe</span><span class="op" id="2562069">.</span><span class="ident" id="2562070">Pointer</span>&nbsp;<span class="comment" id="2562078">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2562112">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2562115">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2562179">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2562251">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2562319">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2562367">type</span>&nbsp;<span class="ident" id="2562372">uncommonType</span>&nbsp;<span class="keyword" id="2562385">struct</span>&nbsp;<span class="op" id="2562392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562395">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2562403">*</span><span class="builtintype" id="2562404">string</span>&nbsp;&nbsp;<span class="comment" id="2562412">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562429">pkgPath</span>&nbsp;<span class="op" id="2562437">*</span><span class="builtintype" id="2562438">string</span>&nbsp;&nbsp;<span class="comment" id="2562446">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562503">methods</span>&nbsp;<span class="op" id="2562511">[</span><span class="op" id="2562512">]</span><span class="ident" id="2562513">method</span>&nbsp;<span class="comment" id="2562520">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2562552">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2562555">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2562605">type</span>&nbsp;<span class="ident" id="2562610">ChanDir</span>&nbsp;<span class="builtintype" id="2562618">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2562623">const</span>&nbsp;<span class="op" id="2562629">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562632">RecvDir</span>&nbsp;<span class="ident" id="2562640">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2562660">=</span>&nbsp;<span class="num" id="2562662">1</span>&nbsp;<span class="op" id="2562664">&lt;&lt;</span>&nbsp;<span class="ident" id="2562667">iota</span>&nbsp;<span class="comment" id="2562672">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562683">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2562723">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562734">BothDir</span>&nbsp;<span class="op" id="2562742">=</span>&nbsp;<span class="ident" id="2562744">RecvDir</span>&nbsp;<span class="op" id="2562752">|</span>&nbsp;<span class="ident" id="2562754">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2562774">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2562782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2562785">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2562829">type</span>&nbsp;<span class="ident" id="2562834">arrayType</span>&nbsp;<span class="keyword" id="2562844">struct</span>&nbsp;<span class="op" id="2562851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562854">rtype</span>&nbsp;<span class="string" id="2562860">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562879">elem</span>&nbsp;&nbsp;<span class="op" id="2562885">*</span><span class="ident" id="2562886">rtype</span>&nbsp;<span class="comment" id="2562892">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562915">slice</span>&nbsp;<span class="op" id="2562921">*</span><span class="ident" id="2562922">rtype</span>&nbsp;<span class="comment" id="2562928">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2562943">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2562949">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2562957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2562960">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2562999">type</span>&nbsp;<span class="ident" id="2563004">chanType</span>&nbsp;<span class="keyword" id="2563013">struct</span>&nbsp;<span class="op" id="2563020">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563023">rtype</span>&nbsp;<span class="string" id="2563029">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563047">elem</span>&nbsp;&nbsp;<span class="op" id="2563053">*</span><span class="ident" id="2563054">rtype</span>&nbsp;&nbsp;<span class="comment" id="2563061">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563086">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2563092">uintptr</span>&nbsp;<span class="comment" id="2563100">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2563131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2563134">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2563174">type</span>&nbsp;<span class="ident" id="2563179">funcType</span>&nbsp;<span class="keyword" id="2563188">struct</span>&nbsp;<span class="op" id="2563195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563198">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2563208">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563226">dotdotdot</span>&nbsp;<span class="builtintype" id="2563236">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2563245">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563277">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563287">[</span><span class="op" id="2563288">]</span><span class="op" id="2563289">*</span><span class="ident" id="2563290">rtype</span>&nbsp;<span class="comment" id="2563296">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563322">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563332">[</span><span class="op" id="2563333">]</span><span class="op" id="2563334">*</span><span class="ident" id="2563335">rtype</span>&nbsp;<span class="comment" id="2563341">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2563367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2563370">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2563422">type</span>&nbsp;<span class="ident" id="2563427">imethod</span>&nbsp;<span class="keyword" id="2563435">struct</span>&nbsp;<span class="op" id="2563442">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563445">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563453">*</span><span class="builtintype" id="2563454">string</span>&nbsp;<span class="comment" id="2563461">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563480">pkgPath</span>&nbsp;<span class="op" id="2563488">*</span><span class="builtintype" id="2563489">string</span>&nbsp;<span class="comment" id="2563496">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563546">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563554">*</span><span class="ident" id="2563555">rtype</span>&nbsp;&nbsp;<span class="comment" id="2563562">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2563589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2563592">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2563639">type</span>&nbsp;<span class="ident" id="2563644">interfaceType</span>&nbsp;<span class="keyword" id="2563658">struct</span>&nbsp;<span class="op" id="2563665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563668">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2563676">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563699">methods</span>&nbsp;<span class="op" id="2563707">[</span><span class="op" id="2563708">]</span><span class="ident" id="2563709">imethod</span>&nbsp;<span class="comment" id="2563717">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2563735">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2563738">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2563772">type</span>&nbsp;<span class="ident" id="2563777">mapType</span>&nbsp;<span class="keyword" id="2563785">struct</span>&nbsp;<span class="op" id="2563792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563795">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2563809">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563826">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563840">*</span><span class="ident" id="2563841">rtype</span>&nbsp;<span class="comment" id="2563847">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563864">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563878">*</span><span class="ident" id="2563879">rtype</span>&nbsp;<span class="comment" id="2563885">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563914">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563928">*</span><span class="ident" id="2563929">rtype</span>&nbsp;<span class="comment" id="2563935">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2563965">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2563979">*</span><span class="ident" id="2563980">rtype</span>&nbsp;<span class="comment" id="2563986">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564010">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2564024">uint8</span>&nbsp;&nbsp;<span class="comment" id="2564031">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564052">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2564066">uint8</span>&nbsp;&nbsp;<span class="comment" id="2564073">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564116">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2564130">uint8</span>&nbsp;&nbsp;<span class="comment" id="2564137">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564160">indirectvalue</span>&nbsp;<span class="builtintype" id="2564174">uint8</span>&nbsp;&nbsp;<span class="comment" id="2564181">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564228">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2564242">uint16</span>&nbsp;<span class="comment" id="2564249">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2564267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2564270">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2564308">type</span>&nbsp;<span class="ident" id="2564313">ptrType</span>&nbsp;<span class="keyword" id="2564321">struct</span>&nbsp;<span class="op" id="2564328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564331">rtype</span>&nbsp;<span class="string" id="2564337">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564354">elem</span>&nbsp;&nbsp;<span class="op" id="2564360">*</span><span class="ident" id="2564361">rtype</span>&nbsp;<span class="comment" id="2564367">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2564404">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2564407">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2564445">type</span>&nbsp;<span class="ident" id="2564450">sliceType</span>&nbsp;<span class="keyword" id="2564460">struct</span>&nbsp;<span class="op" id="2564467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564470">rtype</span>&nbsp;<span class="string" id="2564476">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564495">elem</span>&nbsp;&nbsp;<span class="op" id="2564501">*</span><span class="ident" id="2564502">rtype</span>&nbsp;<span class="comment" id="2564508">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2564530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2564533">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2564549">type</span>&nbsp;<span class="ident" id="2564554">structField</span>&nbsp;<span class="keyword" id="2564566">struct</span>&nbsp;<span class="op" id="2564573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564576">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2564584">*</span><span class="builtintype" id="2564585">string</span>&nbsp;<span class="comment" id="2564592">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564620">pkgPath</span>&nbsp;<span class="op" id="2564628">*</span><span class="builtintype" id="2564629">string</span>&nbsp;<span class="comment" id="2564636">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564686">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2564694">*</span><span class="ident" id="2564695">rtype</span>&nbsp;&nbsp;<span class="comment" id="2564702">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564720">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2564728">*</span><span class="builtintype" id="2564729">string</span>&nbsp;<span class="comment" id="2564736">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564754">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2564762">uintptr</span>&nbsp;<span class="comment" id="2564770">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2564808">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2564811">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2564851">type</span>&nbsp;<span class="ident" id="2564856">structType</span>&nbsp;<span class="keyword" id="2564867">struct</span>&nbsp;<span class="op" id="2564874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564877">rtype</span>&nbsp;&nbsp;<span class="string" id="2564884">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2564904">fields</span>&nbsp;<span class="op" id="2564911">[</span><span class="op" id="2564912">]</span><span class="ident" id="2564913">structField</span>&nbsp;<span class="comment" id="2564925">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2564945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2564948">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2565104">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2565142">type</span>&nbsp;<span class="ident" id="2565147">Method</span>&nbsp;<span class="keyword" id="2565154">struct</span>&nbsp;<span class="op" id="2565161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565164">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565193">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565266">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565336">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565405">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2565426">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565487">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2565495">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565503">PkgPath</span>&nbsp;<span class="builtintype" id="2565511">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565520">Type</span>&nbsp;&nbsp;<span class="ident" id="2565526">Type</span>&nbsp;&nbsp;<span class="comment" id="2565532">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565548">Func</span>&nbsp;&nbsp;<span class="ident" id="2565554">Value</span>&nbsp;<span class="comment" id="2565560">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565601">Index</span>&nbsp;<span class="builtintype" id="2565607">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2565613">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2565638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2565641">const</span>&nbsp;<span class="op" id="2565647">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565650">kindDirectIface</span>&nbsp;<span class="op" id="2565666">=</span>&nbsp;<span class="num" id="2565668">1</span>&nbsp;<span class="op" id="2565670">&lt;&lt;</span>&nbsp;<span class="num" id="2565673">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565676">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2565692">=</span>&nbsp;<span class="num" id="2565694">1</span>&nbsp;<span class="op" id="2565696">&lt;&lt;</span>&nbsp;<span class="num" id="2565699">6</span>&nbsp;<span class="comment" id="2565701">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565734">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2565750">=</span>&nbsp;<span class="num" id="2565752">1</span>&nbsp;<span class="op" id="2565754">&lt;&lt;</span>&nbsp;<span class="num" id="2565757">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565760">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2565776">=</span>&nbsp;<span class="op" id="2565778">(</span><span class="num" id="2565779">1</span>&nbsp;<span class="op" id="2565781">&lt;&lt;</span>&nbsp;<span class="num" id="2565784">5</span><span class="op" id="2565785">)</span>&nbsp;<span class="op" id="2565787">-</span>&nbsp;<span class="num" id="2565789">1</span><br>
<span class="lineno"></span><span class="op" id="2565791">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2565794">func</span>&nbsp;<span class="op" id="2565799">(</span><span class="ident" id="2565800">k</span>&nbsp;<span class="ident" id="2565802">Kind</span><span class="op" id="2565806">)</span>&nbsp;<span class="ident" id="2565808">String</span><span class="op" id="2565814">(</span><span class="op" id="2565815">)</span>&nbsp;<span class="builtintype" id="2565817">string</span>&nbsp;<span class="op" id="2565824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565827">if</span>&nbsp;<span class="builtintype" id="2565830">int</span><span class="op" id="2565833">(</span><span class="ident" id="2565834">k</span><span class="op" id="2565835">)</span>&nbsp;<span class="op" id="2565837">&lt;</span>&nbsp;<span class="builtinfunc" id="2565839">len</span><span class="op" id="2565842">(</span><span class="ident" id="2565843">kindNames</span><span class="op" id="2565852">)</span>&nbsp;<span class="op" id="2565854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565858">return</span>&nbsp;<span class="ident" id="2565865">kindNames</span><span class="op" id="2565874">[</span><span class="ident" id="2565875">k</span><span class="op" id="2565876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2565879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2565882">return</span>&nbsp;<span class="string" id="2565889">&#34;kind&#34;</span>&nbsp;<span class="op" id="2565896">+</span>&nbsp;<span class="ident" id="2565898">strconv</span><span class="op" id="2565905">.</span><span class="ident" id="2565906">Itoa</span><span class="op" id="2565910">(</span><span class="builtintype" id="2565911">int</span><span class="op" id="2565914">(</span><span class="ident" id="2565915">k</span><span class="op" id="2565916">)</span><span class="op" id="2565917">)</span><br>
<span class="lineno">410</span><span class="op" id="2565919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2565922">var</span>&nbsp;<span class="ident" id="2565926">kindNames</span>&nbsp;<span class="op" id="2565936">=</span>&nbsp;<span class="op" id="2565938">[</span><span class="op" id="2565939">]</span><span class="builtintype" id="2565940">string</span><span class="op" id="2565946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565949">Invalid</span><span class="op" id="2565956">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2565964">&#34;invalid&#34;</span><span class="op" id="2565973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2565976">Bool</span><span class="op" id="2565980">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2565991">&#34;bool&#34;</span><span class="op" id="2565997">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566000">Int</span><span class="op" id="2566003">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566015">&#34;int&#34;</span><span class="op" id="2566020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566023">Int8</span><span class="op" id="2566027">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566038">&#34;int8&#34;</span><span class="op" id="2566044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566047">Int16</span><span class="op" id="2566052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566062">&#34;int16&#34;</span><span class="op" id="2566069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566072">Int32</span><span class="op" id="2566077">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566087">&#34;int32&#34;</span><span class="op" id="2566094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566097">Int64</span><span class="op" id="2566102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566112">&#34;int64&#34;</span><span class="op" id="2566119">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566122">Uint</span><span class="op" id="2566126">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566137">&#34;uint&#34;</span><span class="op" id="2566143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566146">Uint8</span><span class="op" id="2566151">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566161">&#34;uint8&#34;</span><span class="op" id="2566168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566171">Uint16</span><span class="op" id="2566177">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566186">&#34;uint16&#34;</span><span class="op" id="2566194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566197">Uint32</span><span class="op" id="2566203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566212">&#34;uint32&#34;</span><span class="op" id="2566220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566223">Uint64</span><span class="op" id="2566229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566238">&#34;uint64&#34;</span><span class="op" id="2566246">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566249">Uintptr</span><span class="op" id="2566256">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566264">&#34;uintptr&#34;</span><span class="op" id="2566273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566276">Float32</span><span class="op" id="2566283">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566291">&#34;float32&#34;</span><span class="op" id="2566300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566303">Float64</span><span class="op" id="2566310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566318">&#34;float64&#34;</span><span class="op" id="2566327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566330">Complex64</span><span class="op" id="2566339">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566345">&#34;complex64&#34;</span><span class="op" id="2566356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566359">Complex128</span><span class="op" id="2566369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566374">&#34;complex128&#34;</span><span class="op" id="2566386">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566389">Array</span><span class="op" id="2566394">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566404">&#34;array&#34;</span><span class="op" id="2566411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566414">Chan</span><span class="op" id="2566418">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566429">&#34;chan&#34;</span><span class="op" id="2566435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566438">Func</span><span class="op" id="2566442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566453">&#34;func&#34;</span><span class="op" id="2566459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566462">Interface</span><span class="op" id="2566471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566477">&#34;interface&#34;</span><span class="op" id="2566488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566491">Map</span><span class="op" id="2566494">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566506">&#34;map&#34;</span><span class="op" id="2566511">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566514">Ptr</span><span class="op" id="2566517">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566529">&#34;ptr&#34;</span><span class="op" id="2566534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566537">Slice</span><span class="op" id="2566542">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566552">&#34;slice&#34;</span><span class="op" id="2566559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566562">String</span><span class="op" id="2566568">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566577">&#34;string&#34;</span><span class="op" id="2566585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566588">Struct</span><span class="op" id="2566594">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2566603">&#34;struct&#34;</span><span class="op" id="2566611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2566614">UnsafePointer</span><span class="op" id="2566627">:</span>&nbsp;<span class="string" id="2566629">&#34;unsafe.Pointer&#34;</span><span class="op" id="2566645">,</span><br>
<span class="lineno">440</span><span class="op" id="2566647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2566650">func</span>&nbsp;<span class="op" id="2566655">(</span><span class="ident" id="2566656">t</span>&nbsp;<span class="op" id="2566658">*</span><span class="ident" id="2566659">uncommonType</span><span class="op" id="2566671">)</span>&nbsp;<span class="ident" id="2566673">uncommon</span><span class="op" id="2566681">(</span><span class="op" id="2566682">)</span>&nbsp;<span class="op" id="2566684">*</span><span class="ident" id="2566685">uncommonType</span>&nbsp;<span class="op" id="2566698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566701">return</span>&nbsp;<span class="ident" id="2566708">t</span><br>
<span class="lineno"></span><span class="op" id="2566710">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2566713">func</span>&nbsp;<span class="op" id="2566718">(</span><span class="ident" id="2566719">t</span>&nbsp;<span class="op" id="2566721">*</span><span class="ident" id="2566722">uncommonType</span><span class="op" id="2566734">)</span>&nbsp;<span class="ident" id="2566736">PkgPath</span><span class="op" id="2566743">(</span><span class="op" id="2566744">)</span>&nbsp;<span class="builtintype" id="2566746">string</span>&nbsp;<span class="op" id="2566753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566756">if</span>&nbsp;<span class="ident" id="2566759">t</span>&nbsp;<span class="op" id="2566761">==</span>&nbsp;<span class="ident" id="2566764">nil</span>&nbsp;<span class="op" id="2566768">||</span>&nbsp;<span class="ident" id="2566771">t</span><span class="op" id="2566772">.</span><span class="ident" id="2566773">pkgPath</span>&nbsp;<span class="op" id="2566781">==</span>&nbsp;<span class="ident" id="2566784">nil</span>&nbsp;<span class="op" id="2566788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566792">return</span>&nbsp;<span class="string" id="2566799">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566803">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566806">return</span>&nbsp;<span class="op" id="2566813">*</span><span class="ident" id="2566814">t</span><span class="op" id="2566815">.</span><span class="ident" id="2566816">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2566824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2566827">func</span>&nbsp;<span class="op" id="2566832">(</span><span class="ident" id="2566833">t</span>&nbsp;<span class="op" id="2566835">*</span><span class="ident" id="2566836">uncommonType</span><span class="op" id="2566848">)</span>&nbsp;<span class="ident" id="2566850">Name</span><span class="op" id="2566854">(</span><span class="op" id="2566855">)</span>&nbsp;<span class="builtintype" id="2566857">string</span>&nbsp;<span class="op" id="2566864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566867">if</span>&nbsp;<span class="ident" id="2566870">t</span>&nbsp;<span class="op" id="2566872">==</span>&nbsp;<span class="ident" id="2566875">nil</span>&nbsp;<span class="op" id="2566879">||</span>&nbsp;<span class="ident" id="2566882">t</span><span class="op" id="2566883">.</span><span class="ident" id="2566884">name</span>&nbsp;<span class="op" id="2566889">==</span>&nbsp;<span class="ident" id="2566892">nil</span>&nbsp;<span class="op" id="2566896">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566900">return</span>&nbsp;<span class="string" id="2566907">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2566911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566914">return</span>&nbsp;<span class="op" id="2566921">*</span><span class="ident" id="2566922">t</span><span class="op" id="2566923">.</span><span class="ident" id="2566924">name</span><br>
<span class="lineno"></span><span class="op" id="2566929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2566932">func</span>&nbsp;<span class="op" id="2566937">(</span><span class="ident" id="2566938">t</span>&nbsp;<span class="op" id="2566940">*</span><span class="ident" id="2566941">rtype</span><span class="op" id="2566946">)</span>&nbsp;<span class="ident" id="2566948">String</span><span class="op" id="2566954">(</span><span class="op" id="2566955">)</span>&nbsp;<span class="builtintype" id="2566957">string</span>&nbsp;<span class="op" id="2566964">{</span>&nbsp;<span class="keyword" id="2566966">return</span>&nbsp;<span class="op" id="2566973">*</span><span class="ident" id="2566974">t</span><span class="op" id="2566975">.</span><span class="builtintype" id="2566976">string</span>&nbsp;<span class="op" id="2566983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2566986">func</span>&nbsp;<span class="op" id="2566991">(</span><span class="ident" id="2566992">t</span>&nbsp;<span class="op" id="2566994">*</span><span class="ident" id="2566995">rtype</span><span class="op" id="2567000">)</span>&nbsp;<span class="ident" id="2567002">Size</span><span class="op" id="2567006">(</span><span class="op" id="2567007">)</span>&nbsp;<span class="builtintype" id="2567009">uintptr</span>&nbsp;<span class="op" id="2567017">{</span>&nbsp;<span class="keyword" id="2567019">return</span>&nbsp;<span class="ident" id="2567026">t</span><span class="op" id="2567027">.</span><span class="ident" id="2567028">size</span>&nbsp;<span class="op" id="2567033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2567036">func</span>&nbsp;<span class="op" id="2567041">(</span><span class="ident" id="2567042">t</span>&nbsp;<span class="op" id="2567044">*</span><span class="ident" id="2567045">rtype</span><span class="op" id="2567050">)</span>&nbsp;<span class="ident" id="2567052">Bits</span><span class="op" id="2567056">(</span><span class="op" id="2567057">)</span>&nbsp;<span class="builtintype" id="2567059">int</span>&nbsp;<span class="op" id="2567063">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567066">if</span>&nbsp;<span class="ident" id="2567069">t</span>&nbsp;<span class="op" id="2567071">==</span>&nbsp;<span class="ident" id="2567074">nil</span>&nbsp;<span class="op" id="2567078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2567082">panic</span><span class="op" id="2567087">(</span><span class="string" id="2567088">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2567115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567121">k</span>&nbsp;<span class="op" id="2567123">:=</span>&nbsp;<span class="ident" id="2567126">t</span><span class="op" id="2567127">.</span><span class="ident" id="2567128">Kind</span><span class="op" id="2567132">(</span><span class="op" id="2567133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567136">if</span>&nbsp;<span class="ident" id="2567139">k</span>&nbsp;<span class="op" id="2567141">&lt;</span>&nbsp;<span class="ident" id="2567143">Int</span>&nbsp;<span class="op" id="2567147">||</span>&nbsp;<span class="ident" id="2567150">k</span>&nbsp;<span class="op" id="2567152">&gt;</span>&nbsp;<span class="ident" id="2567154">Complex128</span>&nbsp;<span class="op" id="2567165">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2567169">panic</span><span class="op" id="2567174">(</span><span class="string" id="2567175">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2567215">+</span>&nbsp;<span class="ident" id="2567217">t</span><span class="op" id="2567218">.</span><span class="ident" id="2567219">String</span><span class="op" id="2567225">(</span><span class="op" id="2567226">)</span><span class="op" id="2567227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567233">return</span>&nbsp;<span class="builtintype" id="2567240">int</span><span class="op" id="2567243">(</span><span class="ident" id="2567244">t</span><span class="op" id="2567245">.</span><span class="ident" id="2567246">size</span><span class="op" id="2567250">)</span>&nbsp;<span class="op" id="2567252">*</span>&nbsp;<span class="num" id="2567254">8</span><br>
<span class="lineno"></span><span class="op" id="2567256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2567259">func</span>&nbsp;<span class="op" id="2567264">(</span><span class="ident" id="2567265">t</span>&nbsp;<span class="op" id="2567267">*</span><span class="ident" id="2567268">rtype</span><span class="op" id="2567273">)</span>&nbsp;<span class="ident" id="2567275">Align</span><span class="op" id="2567280">(</span><span class="op" id="2567281">)</span>&nbsp;<span class="builtintype" id="2567283">int</span>&nbsp;<span class="op" id="2567287">{</span>&nbsp;<span class="keyword" id="2567289">return</span>&nbsp;<span class="builtintype" id="2567296">int</span><span class="op" id="2567299">(</span><span class="ident" id="2567300">t</span><span class="op" id="2567301">.</span><span class="ident" id="2567302">align</span><span class="op" id="2567307">)</span>&nbsp;<span class="op" id="2567309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2567312">func</span>&nbsp;<span class="op" id="2567317">(</span><span class="ident" id="2567318">t</span>&nbsp;<span class="op" id="2567320">*</span><span class="ident" id="2567321">rtype</span><span class="op" id="2567326">)</span>&nbsp;<span class="ident" id="2567328">FieldAlign</span><span class="op" id="2567338">(</span><span class="op" id="2567339">)</span>&nbsp;<span class="builtintype" id="2567341">int</span>&nbsp;<span class="op" id="2567345">{</span>&nbsp;<span class="keyword" id="2567347">return</span>&nbsp;<span class="builtintype" id="2567354">int</span><span class="op" id="2567357">(</span><span class="ident" id="2567358">t</span><span class="op" id="2567359">.</span><span class="ident" id="2567360">fieldAlign</span><span class="op" id="2567370">)</span>&nbsp;<span class="op" id="2567372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2567375">func</span>&nbsp;<span class="op" id="2567380">(</span><span class="ident" id="2567381">t</span>&nbsp;<span class="op" id="2567383">*</span><span class="ident" id="2567384">rtype</span><span class="op" id="2567389">)</span>&nbsp;<span class="ident" id="2567391">Kind</span><span class="op" id="2567395">(</span><span class="op" id="2567396">)</span>&nbsp;<span class="ident" id="2567398">Kind</span>&nbsp;<span class="op" id="2567403">{</span>&nbsp;<span class="keyword" id="2567405">return</span>&nbsp;<span class="ident" id="2567412">Kind</span><span class="op" id="2567416">(</span><span class="ident" id="2567417">t</span><span class="op" id="2567418">.</span><span class="ident" id="2567419">kind</span>&nbsp;<span class="op" id="2567424">&amp;</span>&nbsp;<span class="ident" id="2567426">kindMask</span><span class="op" id="2567434">)</span>&nbsp;<span class="op" id="2567436">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2567439">func</span>&nbsp;<span class="op" id="2567444">(</span><span class="ident" id="2567445">t</span>&nbsp;<span class="op" id="2567447">*</span><span class="ident" id="2567448">rtype</span><span class="op" id="2567453">)</span>&nbsp;<span class="ident" id="2567455">pointers</span><span class="op" id="2567463">(</span><span class="op" id="2567464">)</span>&nbsp;<span class="builtintype" id="2567466">bool</span>&nbsp;<span class="op" id="2567471">{</span>&nbsp;<span class="keyword" id="2567473">return</span>&nbsp;<span class="ident" id="2567480">t</span><span class="op" id="2567481">.</span><span class="ident" id="2567482">kind</span><span class="op" id="2567486">&amp;</span><span class="ident" id="2567487">kindNoPointers</span>&nbsp;<span class="op" id="2567502">==</span>&nbsp;<span class="num" id="2567505">0</span>&nbsp;<span class="op" id="2567507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2567510">func</span>&nbsp;<span class="op" id="2567515">(</span><span class="ident" id="2567516">t</span>&nbsp;<span class="op" id="2567518">*</span><span class="ident" id="2567519">rtype</span><span class="op" id="2567524">)</span>&nbsp;<span class="ident" id="2567526">common</span><span class="op" id="2567532">(</span><span class="op" id="2567533">)</span>&nbsp;<span class="op" id="2567535">*</span><span class="ident" id="2567536">rtype</span>&nbsp;<span class="op" id="2567542">{</span>&nbsp;<span class="keyword" id="2567544">return</span>&nbsp;<span class="ident" id="2567551">t</span>&nbsp;<span class="op" id="2567553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2567556">func</span>&nbsp;<span class="op" id="2567561">(</span><span class="ident" id="2567562">t</span>&nbsp;<span class="op" id="2567564">*</span><span class="ident" id="2567565">uncommonType</span><span class="op" id="2567577">)</span>&nbsp;<span class="ident" id="2567579">Method</span><span class="op" id="2567585">(</span><span class="ident" id="2567586">i</span>&nbsp;<span class="builtintype" id="2567588">int</span><span class="op" id="2567591">)</span>&nbsp;<span class="op" id="2567593">(</span><span class="ident" id="2567594">m</span>&nbsp;<span class="ident" id="2567596">Method</span><span class="op" id="2567602">)</span>&nbsp;<span class="op" id="2567604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567607">if</span>&nbsp;<span class="ident" id="2567610">t</span>&nbsp;<span class="op" id="2567612">==</span>&nbsp;<span class="ident" id="2567615">nil</span>&nbsp;<span class="op" id="2567619">||</span>&nbsp;<span class="ident" id="2567622">i</span>&nbsp;<span class="op" id="2567624">&lt;</span>&nbsp;<span class="num" id="2567626">0</span>&nbsp;<span class="op" id="2567628">||</span>&nbsp;<span class="ident" id="2567631">i</span>&nbsp;<span class="op" id="2567633">&gt;=</span>&nbsp;<span class="builtinfunc" id="2567636">len</span><span class="op" id="2567639">(</span><span class="ident" id="2567640">t</span><span class="op" id="2567641">.</span><span class="ident" id="2567642">methods</span><span class="op" id="2567649">)</span>&nbsp;<span class="op" id="2567651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2567655">panic</span><span class="op" id="2567660">(</span><span class="string" id="2567661">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2567697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567703">p</span>&nbsp;<span class="op" id="2567705">:=</span>&nbsp;<span class="op" id="2567708">&amp;</span><span class="ident" id="2567709">t</span><span class="op" id="2567710">.</span><span class="ident" id="2567711">methods</span><span class="op" id="2567718">[</span><span class="ident" id="2567719">i</span><span class="op" id="2567720">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567723">if</span>&nbsp;<span class="ident" id="2567726">p</span><span class="op" id="2567727">.</span><span class="ident" id="2567728">name</span>&nbsp;<span class="op" id="2567733">!=</span>&nbsp;<span class="ident" id="2567736">nil</span>&nbsp;<span class="op" id="2567740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567744">m</span><span class="op" id="2567745">.</span><span class="ident" id="2567746">Name</span>&nbsp;<span class="op" id="2567751">=</span>&nbsp;<span class="op" id="2567753">*</span><span class="ident" id="2567754">p</span><span class="op" id="2567755">.</span><span class="ident" id="2567756">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567765">fl</span>&nbsp;<span class="op" id="2567768">:=</span>&nbsp;<span class="ident" id="2567771">flag</span><span class="op" id="2567775">(</span><span class="ident" id="2567776">Func</span><span class="op" id="2567780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567783">if</span>&nbsp;<span class="ident" id="2567786">p</span><span class="op" id="2567787">.</span><span class="ident" id="2567788">pkgPath</span>&nbsp;<span class="op" id="2567796">!=</span>&nbsp;<span class="ident" id="2567799">nil</span>&nbsp;<span class="op" id="2567803">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567807">m</span><span class="op" id="2567808">.</span><span class="ident" id="2567809">PkgPath</span>&nbsp;<span class="op" id="2567817">=</span>&nbsp;<span class="op" id="2567819">*</span><span class="ident" id="2567820">p</span><span class="op" id="2567821">.</span><span class="ident" id="2567822">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567832">fl</span>&nbsp;<span class="op" id="2567835">|=</span>&nbsp;<span class="ident" id="2567838">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2567846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567849">mt</span>&nbsp;<span class="op" id="2567852">:=</span>&nbsp;<span class="ident" id="2567855">p</span><span class="op" id="2567856">.</span><span class="ident" id="2567857">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567862">m</span><span class="op" id="2567863">.</span><span class="ident" id="2567864">Type</span>&nbsp;<span class="op" id="2567869">=</span>&nbsp;<span class="ident" id="2567871">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567875">fn</span>&nbsp;<span class="op" id="2567878">:=</span>&nbsp;<span class="ident" id="2567881">unsafe</span><span class="op" id="2567887">.</span><span class="ident" id="2567888">Pointer</span><span class="op" id="2567895">(</span><span class="op" id="2567896">&amp;</span><span class="ident" id="2567897">p</span><span class="op" id="2567898">.</span><span class="ident" id="2567899">tfn</span><span class="op" id="2567902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567905">m</span><span class="op" id="2567906">.</span><span class="ident" id="2567907">Func</span>&nbsp;<span class="op" id="2567912">=</span>&nbsp;<span class="ident" id="2567914">Value</span><span class="op" id="2567919">{</span><span class="ident" id="2567920">mt</span><span class="op" id="2567922">,</span>&nbsp;<span class="ident" id="2567924">fn</span><span class="op" id="2567926">,</span>&nbsp;<span class="ident" id="2567928">fl</span><span class="op" id="2567930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567933">m</span><span class="op" id="2567934">.</span><span class="ident" id="2567935">Index</span>&nbsp;<span class="op" id="2567941">=</span>&nbsp;<span class="ident" id="2567943">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567946">return</span><br>
<span class="lineno"></span><span class="op" id="2567953">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2567956">func</span>&nbsp;<span class="op" id="2567961">(</span><span class="ident" id="2567962">t</span>&nbsp;<span class="op" id="2567964">*</span><span class="ident" id="2567965">uncommonType</span><span class="op" id="2567977">)</span>&nbsp;<span class="ident" id="2567979">NumMethod</span><span class="op" id="2567988">(</span><span class="op" id="2567989">)</span>&nbsp;<span class="builtintype" id="2567991">int</span>&nbsp;<span class="op" id="2567995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567998">if</span>&nbsp;<span class="ident" id="2568001">t</span>&nbsp;<span class="op" id="2568003">==</span>&nbsp;<span class="ident" id="2568006">nil</span>&nbsp;<span class="op" id="2568010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568014">return</span>&nbsp;<span class="num" id="2568021">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568024">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568027">return</span>&nbsp;<span class="builtinfunc" id="2568034">len</span><span class="op" id="2568037">(</span><span class="ident" id="2568038">t</span><span class="op" id="2568039">.</span><span class="ident" id="2568040">methods</span><span class="op" id="2568047">)</span><br>
<span class="lineno"></span><span class="op" id="2568049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2568052">func</span>&nbsp;<span class="op" id="2568057">(</span><span class="ident" id="2568058">t</span>&nbsp;<span class="op" id="2568060">*</span><span class="ident" id="2568061">uncommonType</span><span class="op" id="2568073">)</span>&nbsp;<span class="ident" id="2568075">MethodByName</span><span class="op" id="2568087">(</span><span class="ident" id="2568088">name</span>&nbsp;<span class="builtintype" id="2568093">string</span><span class="op" id="2568099">)</span>&nbsp;<span class="op" id="2568101">(</span><span class="ident" id="2568102">m</span>&nbsp;<span class="ident" id="2568104">Method</span><span class="op" id="2568110">,</span>&nbsp;<span class="ident" id="2568112">ok</span>&nbsp;<span class="builtintype" id="2568115">bool</span><span class="op" id="2568119">)</span>&nbsp;<span class="op" id="2568121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568124">if</span>&nbsp;<span class="ident" id="2568127">t</span>&nbsp;<span class="op" id="2568129">==</span>&nbsp;<span class="ident" id="2568132">nil</span>&nbsp;<span class="op" id="2568136">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568140">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568151">var</span>&nbsp;<span class="ident" id="2568155">p</span>&nbsp;<span class="op" id="2568157">*</span><span class="ident" id="2568158">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568166">for</span>&nbsp;<span class="ident" id="2568170">i</span>&nbsp;<span class="op" id="2568172">:=</span>&nbsp;<span class="keyword" id="2568175">range</span>&nbsp;<span class="ident" id="2568181">t</span><span class="op" id="2568182">.</span><span class="ident" id="2568183">methods</span>&nbsp;<span class="op" id="2568191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568195">p</span>&nbsp;<span class="op" id="2568197">=</span>&nbsp;<span class="op" id="2568199">&amp;</span><span class="ident" id="2568200">t</span><span class="op" id="2568201">.</span><span class="ident" id="2568202">methods</span><span class="op" id="2568209">[</span><span class="ident" id="2568210">i</span><span class="op" id="2568211">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568215">if</span>&nbsp;<span class="ident" id="2568218">p</span><span class="op" id="2568219">.</span><span class="ident" id="2568220">name</span>&nbsp;<span class="op" id="2568225">!=</span>&nbsp;<span class="ident" id="2568228">nil</span>&nbsp;<span class="op" id="2568232">&amp;&amp;</span>&nbsp;<span class="op" id="2568235">*</span><span class="ident" id="2568236">p</span><span class="op" id="2568237">.</span><span class="ident" id="2568238">name</span>&nbsp;<span class="op" id="2568243">==</span>&nbsp;<span class="ident" id="2568246">name</span>&nbsp;<span class="op" id="2568251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568256">return</span>&nbsp;<span class="ident" id="2568263">t</span><span class="op" id="2568264">.</span><span class="ident" id="2568265">Method</span><span class="op" id="2568271">(</span><span class="ident" id="2568272">i</span><span class="op" id="2568273">)</span><span class="op" id="2568274">,</span>&nbsp;<span class="ident" id="2568276">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568289">return</span><br>
<span class="lineno">525</span><span class="op" id="2568296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2568299">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2568349">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2568404">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2568442">func</span>&nbsp;<span class="op" id="2568447">(</span><span class="ident" id="2568448">t</span>&nbsp;<span class="op" id="2568450">*</span><span class="ident" id="2568451">rtype</span><span class="op" id="2568456">)</span>&nbsp;<span class="ident" id="2568458">NumMethod</span><span class="op" id="2568467">(</span><span class="op" id="2568468">)</span>&nbsp;<span class="builtintype" id="2568470">int</span>&nbsp;<span class="op" id="2568474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568477">if</span>&nbsp;<span class="ident" id="2568480">t</span><span class="op" id="2568481">.</span><span class="ident" id="2568482">Kind</span><span class="op" id="2568486">(</span><span class="op" id="2568487">)</span>&nbsp;<span class="op" id="2568489">==</span>&nbsp;<span class="ident" id="2568492">Interface</span>&nbsp;<span class="op" id="2568502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568506">tt</span>&nbsp;<span class="op" id="2568509">:=</span>&nbsp;<span class="op" id="2568512">(</span><span class="op" id="2568513">*</span><span class="ident" id="2568514">interfaceType</span><span class="op" id="2568527">)</span><span class="op" id="2568528">(</span><span class="ident" id="2568529">unsafe</span><span class="op" id="2568535">.</span><span class="ident" id="2568536">Pointer</span><span class="op" id="2568543">(</span><span class="ident" id="2568544">t</span><span class="op" id="2568545">)</span><span class="op" id="2568546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568550">return</span>&nbsp;<span class="ident" id="2568557">tt</span><span class="op" id="2568559">.</span><span class="ident" id="2568560">NumMethod</span><span class="op" id="2568569">(</span><span class="op" id="2568570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568573">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568576">return</span>&nbsp;<span class="ident" id="2568583">t</span><span class="op" id="2568584">.</span><span class="ident" id="2568585">uncommonType</span><span class="op" id="2568597">.</span><span class="ident" id="2568598">NumMethod</span><span class="op" id="2568607">(</span><span class="op" id="2568608">)</span><br>
<span class="lineno"></span><span class="op" id="2568610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2568613">func</span>&nbsp;<span class="op" id="2568618">(</span><span class="ident" id="2568619">t</span>&nbsp;<span class="op" id="2568621">*</span><span class="ident" id="2568622">rtype</span><span class="op" id="2568627">)</span>&nbsp;<span class="ident" id="2568629">Method</span><span class="op" id="2568635">(</span><span class="ident" id="2568636">i</span>&nbsp;<span class="builtintype" id="2568638">int</span><span class="op" id="2568641">)</span>&nbsp;<span class="op" id="2568643">(</span><span class="ident" id="2568644">m</span>&nbsp;<span class="ident" id="2568646">Method</span><span class="op" id="2568652">)</span>&nbsp;<span class="op" id="2568654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568657">if</span>&nbsp;<span class="ident" id="2568660">t</span><span class="op" id="2568661">.</span><span class="ident" id="2568662">Kind</span><span class="op" id="2568666">(</span><span class="op" id="2568667">)</span>&nbsp;<span class="op" id="2568669">==</span>&nbsp;<span class="ident" id="2568672">Interface</span>&nbsp;<span class="op" id="2568682">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568686">tt</span>&nbsp;<span class="op" id="2568689">:=</span>&nbsp;<span class="op" id="2568692">(</span><span class="op" id="2568693">*</span><span class="ident" id="2568694">interfaceType</span><span class="op" id="2568707">)</span><span class="op" id="2568708">(</span><span class="ident" id="2568709">unsafe</span><span class="op" id="2568715">.</span><span class="ident" id="2568716">Pointer</span><span class="op" id="2568723">(</span><span class="ident" id="2568724">t</span><span class="op" id="2568725">)</span><span class="op" id="2568726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568730">return</span>&nbsp;<span class="ident" id="2568737">tt</span><span class="op" id="2568739">.</span><span class="ident" id="2568740">Method</span><span class="op" id="2568746">(</span><span class="ident" id="2568747">i</span><span class="op" id="2568748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568754">return</span>&nbsp;<span class="ident" id="2568761">t</span><span class="op" id="2568762">.</span><span class="ident" id="2568763">uncommonType</span><span class="op" id="2568775">.</span><span class="ident" id="2568776">Method</span><span class="op" id="2568782">(</span><span class="ident" id="2568783">i</span><span class="op" id="2568784">)</span><br>
<span class="lineno"></span><span class="op" id="2568786">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2568789">func</span>&nbsp;<span class="op" id="2568794">(</span><span class="ident" id="2568795">t</span>&nbsp;<span class="op" id="2568797">*</span><span class="ident" id="2568798">rtype</span><span class="op" id="2568803">)</span>&nbsp;<span class="ident" id="2568805">MethodByName</span><span class="op" id="2568817">(</span><span class="ident" id="2568818">name</span>&nbsp;<span class="builtintype" id="2568823">string</span><span class="op" id="2568829">)</span>&nbsp;<span class="op" id="2568831">(</span><span class="ident" id="2568832">m</span>&nbsp;<span class="ident" id="2568834">Method</span><span class="op" id="2568840">,</span>&nbsp;<span class="ident" id="2568842">ok</span>&nbsp;<span class="builtintype" id="2568845">bool</span><span class="op" id="2568849">)</span>&nbsp;<span class="op" id="2568851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568854">if</span>&nbsp;<span class="ident" id="2568857">t</span><span class="op" id="2568858">.</span><span class="ident" id="2568859">Kind</span><span class="op" id="2568863">(</span><span class="op" id="2568864">)</span>&nbsp;<span class="op" id="2568866">==</span>&nbsp;<span class="ident" id="2568869">Interface</span>&nbsp;<span class="op" id="2568879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2568883">tt</span>&nbsp;<span class="op" id="2568886">:=</span>&nbsp;<span class="op" id="2568889">(</span><span class="op" id="2568890">*</span><span class="ident" id="2568891">interfaceType</span><span class="op" id="2568904">)</span><span class="op" id="2568905">(</span><span class="ident" id="2568906">unsafe</span><span class="op" id="2568912">.</span><span class="ident" id="2568913">Pointer</span><span class="op" id="2568920">(</span><span class="ident" id="2568921">t</span><span class="op" id="2568922">)</span><span class="op" id="2568923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568927">return</span>&nbsp;<span class="ident" id="2568934">tt</span><span class="op" id="2568936">.</span><span class="ident" id="2568937">MethodByName</span><span class="op" id="2568949">(</span><span class="ident" id="2568950">name</span><span class="op" id="2568954">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2568957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568960">return</span>&nbsp;<span class="ident" id="2568967">t</span><span class="op" id="2568968">.</span><span class="ident" id="2568969">uncommonType</span><span class="op" id="2568981">.</span><span class="ident" id="2568982">MethodByName</span><span class="op" id="2568994">(</span><span class="ident" id="2568995">name</span><span class="op" id="2568999">)</span><br>
<span class="lineno"></span><span class="op" id="2569001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569004">func</span>&nbsp;<span class="op" id="2569009">(</span><span class="ident" id="2569010">t</span>&nbsp;<span class="op" id="2569012">*</span><span class="ident" id="2569013">rtype</span><span class="op" id="2569018">)</span>&nbsp;<span class="ident" id="2569020">PkgPath</span><span class="op" id="2569027">(</span><span class="op" id="2569028">)</span>&nbsp;<span class="builtintype" id="2569030">string</span>&nbsp;<span class="op" id="2569037">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569040">return</span>&nbsp;<span class="ident" id="2569047">t</span><span class="op" id="2569048">.</span><span class="ident" id="2569049">uncommonType</span><span class="op" id="2569061">.</span><span class="ident" id="2569062">PkgPath</span><span class="op" id="2569069">(</span><span class="op" id="2569070">)</span><br>
<span class="lineno"></span><span class="op" id="2569072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569075">func</span>&nbsp;<span class="op" id="2569080">(</span><span class="ident" id="2569081">t</span>&nbsp;<span class="op" id="2569083">*</span><span class="ident" id="2569084">rtype</span><span class="op" id="2569089">)</span>&nbsp;<span class="ident" id="2569091">Name</span><span class="op" id="2569095">(</span><span class="op" id="2569096">)</span>&nbsp;<span class="builtintype" id="2569098">string</span>&nbsp;<span class="op" id="2569105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569108">return</span>&nbsp;<span class="ident" id="2569115">t</span><span class="op" id="2569116">.</span><span class="ident" id="2569117">uncommonType</span><span class="op" id="2569129">.</span><span class="ident" id="2569130">Name</span><span class="op" id="2569134">(</span><span class="op" id="2569135">)</span><br>
<span class="lineno">560</span><span class="op" id="2569137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569140">func</span>&nbsp;<span class="op" id="2569145">(</span><span class="ident" id="2569146">t</span>&nbsp;<span class="op" id="2569148">*</span><span class="ident" id="2569149">rtype</span><span class="op" id="2569154">)</span>&nbsp;<span class="ident" id="2569156">ChanDir</span><span class="op" id="2569163">(</span><span class="op" id="2569164">)</span>&nbsp;<span class="ident" id="2569166">ChanDir</span>&nbsp;<span class="op" id="2569174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569177">if</span>&nbsp;<span class="ident" id="2569180">t</span><span class="op" id="2569181">.</span><span class="ident" id="2569182">Kind</span><span class="op" id="2569186">(</span><span class="op" id="2569187">)</span>&nbsp;<span class="op" id="2569189">!=</span>&nbsp;<span class="ident" id="2569192">Chan</span>&nbsp;<span class="op" id="2569197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2569201">panic</span><span class="op" id="2569206">(</span><span class="string" id="2569207">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2569242">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569248">tt</span>&nbsp;<span class="op" id="2569251">:=</span>&nbsp;<span class="op" id="2569254">(</span><span class="op" id="2569255">*</span><span class="ident" id="2569256">chanType</span><span class="op" id="2569264">)</span><span class="op" id="2569265">(</span><span class="ident" id="2569266">unsafe</span><span class="op" id="2569272">.</span><span class="ident" id="2569273">Pointer</span><span class="op" id="2569280">(</span><span class="ident" id="2569281">t</span><span class="op" id="2569282">)</span><span class="op" id="2569283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569286">return</span>&nbsp;<span class="ident" id="2569293">ChanDir</span><span class="op" id="2569300">(</span><span class="ident" id="2569301">tt</span><span class="op" id="2569303">.</span><span class="ident" id="2569304">dir</span><span class="op" id="2569307">)</span><br>
<span class="lineno"></span><span class="op" id="2569309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2569312">func</span>&nbsp;<span class="op" id="2569317">(</span><span class="ident" id="2569318">t</span>&nbsp;<span class="op" id="2569320">*</span><span class="ident" id="2569321">rtype</span><span class="op" id="2569326">)</span>&nbsp;<span class="ident" id="2569328">IsVariadic</span><span class="op" id="2569338">(</span><span class="op" id="2569339">)</span>&nbsp;<span class="builtintype" id="2569341">bool</span>&nbsp;<span class="op" id="2569346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569349">if</span>&nbsp;<span class="ident" id="2569352">t</span><span class="op" id="2569353">.</span><span class="ident" id="2569354">Kind</span><span class="op" id="2569358">(</span><span class="op" id="2569359">)</span>&nbsp;<span class="op" id="2569361">!=</span>&nbsp;<span class="ident" id="2569364">Func</span>&nbsp;<span class="op" id="2569369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2569373">panic</span><span class="op" id="2569378">(</span><span class="string" id="2569379">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2569417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569423">tt</span>&nbsp;<span class="op" id="2569426">:=</span>&nbsp;<span class="op" id="2569429">(</span><span class="op" id="2569430">*</span><span class="ident" id="2569431">funcType</span><span class="op" id="2569439">)</span><span class="op" id="2569440">(</span><span class="ident" id="2569441">unsafe</span><span class="op" id="2569447">.</span><span class="ident" id="2569448">Pointer</span><span class="op" id="2569455">(</span><span class="ident" id="2569456">t</span><span class="op" id="2569457">)</span><span class="op" id="2569458">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569461">return</span>&nbsp;<span class="ident" id="2569468">tt</span><span class="op" id="2569470">.</span><span class="ident" id="2569471">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2569481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569484">func</span>&nbsp;<span class="op" id="2569489">(</span><span class="ident" id="2569490">t</span>&nbsp;<span class="op" id="2569492">*</span><span class="ident" id="2569493">rtype</span><span class="op" id="2569498">)</span>&nbsp;<span class="ident" id="2569500">Elem</span><span class="op" id="2569504">(</span><span class="op" id="2569505">)</span>&nbsp;<span class="ident" id="2569507">Type</span>&nbsp;<span class="op" id="2569512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569515">switch</span>&nbsp;<span class="ident" id="2569522">t</span><span class="op" id="2569523">.</span><span class="ident" id="2569524">Kind</span><span class="op" id="2569528">(</span><span class="op" id="2569529">)</span>&nbsp;<span class="op" id="2569531">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569534">case</span>&nbsp;<span class="ident" id="2569539">Array</span><span class="op" id="2569544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569548">tt</span>&nbsp;<span class="op" id="2569551">:=</span>&nbsp;<span class="op" id="2569554">(</span><span class="op" id="2569555">*</span><span class="ident" id="2569556">arrayType</span><span class="op" id="2569565">)</span><span class="op" id="2569566">(</span><span class="ident" id="2569567">unsafe</span><span class="op" id="2569573">.</span><span class="ident" id="2569574">Pointer</span><span class="op" id="2569581">(</span><span class="ident" id="2569582">t</span><span class="op" id="2569583">)</span><span class="op" id="2569584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569588">return</span>&nbsp;<span class="ident" id="2569595">toType</span><span class="op" id="2569601">(</span><span class="ident" id="2569602">tt</span><span class="op" id="2569604">.</span><span class="ident" id="2569605">elem</span><span class="op" id="2569609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569612">case</span>&nbsp;<span class="ident" id="2569617">Chan</span><span class="op" id="2569621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569625">tt</span>&nbsp;<span class="op" id="2569628">:=</span>&nbsp;<span class="op" id="2569631">(</span><span class="op" id="2569632">*</span><span class="ident" id="2569633">chanType</span><span class="op" id="2569641">)</span><span class="op" id="2569642">(</span><span class="ident" id="2569643">unsafe</span><span class="op" id="2569649">.</span><span class="ident" id="2569650">Pointer</span><span class="op" id="2569657">(</span><span class="ident" id="2569658">t</span><span class="op" id="2569659">)</span><span class="op" id="2569660">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569664">return</span>&nbsp;<span class="ident" id="2569671">toType</span><span class="op" id="2569677">(</span><span class="ident" id="2569678">tt</span><span class="op" id="2569680">.</span><span class="ident" id="2569681">elem</span><span class="op" id="2569685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569688">case</span>&nbsp;<span class="ident" id="2569693">Map</span><span class="op" id="2569696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569700">tt</span>&nbsp;<span class="op" id="2569703">:=</span>&nbsp;<span class="op" id="2569706">(</span><span class="op" id="2569707">*</span><span class="ident" id="2569708">mapType</span><span class="op" id="2569715">)</span><span class="op" id="2569716">(</span><span class="ident" id="2569717">unsafe</span><span class="op" id="2569723">.</span><span class="ident" id="2569724">Pointer</span><span class="op" id="2569731">(</span><span class="ident" id="2569732">t</span><span class="op" id="2569733">)</span><span class="op" id="2569734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569738">return</span>&nbsp;<span class="ident" id="2569745">toType</span><span class="op" id="2569751">(</span><span class="ident" id="2569752">tt</span><span class="op" id="2569754">.</span><span class="ident" id="2569755">elem</span><span class="op" id="2569759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569762">case</span>&nbsp;<span class="ident" id="2569767">Ptr</span><span class="op" id="2569770">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569774">tt</span>&nbsp;<span class="op" id="2569777">:=</span>&nbsp;<span class="op" id="2569780">(</span><span class="op" id="2569781">*</span><span class="ident" id="2569782">ptrType</span><span class="op" id="2569789">)</span><span class="op" id="2569790">(</span><span class="ident" id="2569791">unsafe</span><span class="op" id="2569797">.</span><span class="ident" id="2569798">Pointer</span><span class="op" id="2569805">(</span><span class="ident" id="2569806">t</span><span class="op" id="2569807">)</span><span class="op" id="2569808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569812">return</span>&nbsp;<span class="ident" id="2569819">toType</span><span class="op" id="2569825">(</span><span class="ident" id="2569826">tt</span><span class="op" id="2569828">.</span><span class="ident" id="2569829">elem</span><span class="op" id="2569833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569836">case</span>&nbsp;<span class="ident" id="2569841">Slice</span><span class="op" id="2569846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2569850">tt</span>&nbsp;<span class="op" id="2569853">:=</span>&nbsp;<span class="op" id="2569856">(</span><span class="op" id="2569857">*</span><span class="ident" id="2569858">sliceType</span><span class="op" id="2569867">)</span><span class="op" id="2569868">(</span><span class="ident" id="2569869">unsafe</span><span class="op" id="2569875">.</span><span class="ident" id="2569876">Pointer</span><span class="op" id="2569883">(</span><span class="ident" id="2569884">t</span><span class="op" id="2569885">)</span><span class="op" id="2569886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2569890">return</span>&nbsp;<span class="ident" id="2569897">toType</span><span class="op" id="2569903">(</span><span class="ident" id="2569904">tt</span><span class="op" id="2569906">.</span><span class="ident" id="2569907">elem</span><span class="op" id="2569911">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2569914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2569917">panic</span><span class="op" id="2569922">(</span><span class="string" id="2569923">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2569954">)</span><br>
<span class="lineno"></span><span class="op" id="2569956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569959">func</span>&nbsp;<span class="op" id="2569964">(</span><span class="ident" id="2569965">t</span>&nbsp;<span class="op" id="2569967">*</span><span class="ident" id="2569968">rtype</span><span class="op" id="2569973">)</span>&nbsp;<span class="ident" id="2569975">Field</span><span class="op" id="2569980">(</span><span class="ident" id="2569981">i</span>&nbsp;<span class="builtintype" id="2569983">int</span><span class="op" id="2569986">)</span>&nbsp;<span class="ident" id="2569988">StructField</span>&nbsp;<span class="op" id="2570000">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570003">if</span>&nbsp;<span class="ident" id="2570006">t</span><span class="op" id="2570007">.</span><span class="ident" id="2570008">Kind</span><span class="op" id="2570012">(</span><span class="op" id="2570013">)</span>&nbsp;<span class="op" id="2570015">!=</span>&nbsp;<span class="ident" id="2570018">Struct</span>&nbsp;<span class="op" id="2570025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2570029">panic</span><span class="op" id="2570034">(</span><span class="string" id="2570035">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2570070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570076">tt</span>&nbsp;<span class="op" id="2570079">:=</span>&nbsp;<span class="op" id="2570082">(</span><span class="op" id="2570083">*</span><span class="ident" id="2570084">structType</span><span class="op" id="2570094">)</span><span class="op" id="2570095">(</span><span class="ident" id="2570096">unsafe</span><span class="op" id="2570102">.</span><span class="ident" id="2570103">Pointer</span><span class="op" id="2570110">(</span><span class="ident" id="2570111">t</span><span class="op" id="2570112">)</span><span class="op" id="2570113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570116">return</span>&nbsp;<span class="ident" id="2570123">tt</span><span class="op" id="2570125">.</span><span class="ident" id="2570126">Field</span><span class="op" id="2570131">(</span><span class="ident" id="2570132">i</span><span class="op" id="2570133">)</span><br>
<span class="lineno">605</span><span class="op" id="2570135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570138">func</span>&nbsp;<span class="op" id="2570143">(</span><span class="ident" id="2570144">t</span>&nbsp;<span class="op" id="2570146">*</span><span class="ident" id="2570147">rtype</span><span class="op" id="2570152">)</span>&nbsp;<span class="ident" id="2570154">FieldByIndex</span><span class="op" id="2570166">(</span><span class="ident" id="2570167">index</span>&nbsp;<span class="op" id="2570173">[</span><span class="op" id="2570174">]</span><span class="builtintype" id="2570175">int</span><span class="op" id="2570178">)</span>&nbsp;<span class="ident" id="2570180">StructField</span>&nbsp;<span class="op" id="2570192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570195">if</span>&nbsp;<span class="ident" id="2570198">t</span><span class="op" id="2570199">.</span><span class="ident" id="2570200">Kind</span><span class="op" id="2570204">(</span><span class="op" id="2570205">)</span>&nbsp;<span class="op" id="2570207">!=</span>&nbsp;<span class="ident" id="2570210">Struct</span>&nbsp;<span class="op" id="2570217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2570221">panic</span><span class="op" id="2570226">(</span><span class="string" id="2570227">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2570269">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570275">tt</span>&nbsp;<span class="op" id="2570278">:=</span>&nbsp;<span class="op" id="2570281">(</span><span class="op" id="2570282">*</span><span class="ident" id="2570283">structType</span><span class="op" id="2570293">)</span><span class="op" id="2570294">(</span><span class="ident" id="2570295">unsafe</span><span class="op" id="2570301">.</span><span class="ident" id="2570302">Pointer</span><span class="op" id="2570309">(</span><span class="ident" id="2570310">t</span><span class="op" id="2570311">)</span><span class="op" id="2570312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570315">return</span>&nbsp;<span class="ident" id="2570322">tt</span><span class="op" id="2570324">.</span><span class="ident" id="2570325">FieldByIndex</span><span class="op" id="2570337">(</span><span class="ident" id="2570338">index</span><span class="op" id="2570343">)</span><br>
<span class="lineno"></span><span class="op" id="2570345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2570348">func</span>&nbsp;<span class="op" id="2570353">(</span><span class="ident" id="2570354">t</span>&nbsp;<span class="op" id="2570356">*</span><span class="ident" id="2570357">rtype</span><span class="op" id="2570362">)</span>&nbsp;<span class="ident" id="2570364">FieldByName</span><span class="op" id="2570375">(</span><span class="ident" id="2570376">name</span>&nbsp;<span class="builtintype" id="2570381">string</span><span class="op" id="2570387">)</span>&nbsp;<span class="op" id="2570389">(</span><span class="ident" id="2570390">StructField</span><span class="op" id="2570401">,</span>&nbsp;<span class="builtintype" id="2570403">bool</span><span class="op" id="2570407">)</span>&nbsp;<span class="op" id="2570409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570412">if</span>&nbsp;<span class="ident" id="2570415">t</span><span class="op" id="2570416">.</span><span class="ident" id="2570417">Kind</span><span class="op" id="2570421">(</span><span class="op" id="2570422">)</span>&nbsp;<span class="op" id="2570424">!=</span>&nbsp;<span class="ident" id="2570427">Struct</span>&nbsp;<span class="op" id="2570434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2570438">panic</span><span class="op" id="2570443">(</span><span class="string" id="2570444">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2570485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570491">tt</span>&nbsp;<span class="op" id="2570494">:=</span>&nbsp;<span class="op" id="2570497">(</span><span class="op" id="2570498">*</span><span class="ident" id="2570499">structType</span><span class="op" id="2570509">)</span><span class="op" id="2570510">(</span><span class="ident" id="2570511">unsafe</span><span class="op" id="2570517">.</span><span class="ident" id="2570518">Pointer</span><span class="op" id="2570525">(</span><span class="ident" id="2570526">t</span><span class="op" id="2570527">)</span><span class="op" id="2570528">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570531">return</span>&nbsp;<span class="ident" id="2570538">tt</span><span class="op" id="2570540">.</span><span class="ident" id="2570541">FieldByName</span><span class="op" id="2570552">(</span><span class="ident" id="2570553">name</span><span class="op" id="2570557">)</span><br>
<span class="lineno"></span><span class="op" id="2570559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570562">func</span>&nbsp;<span class="op" id="2570567">(</span><span class="ident" id="2570568">t</span>&nbsp;<span class="op" id="2570570">*</span><span class="ident" id="2570571">rtype</span><span class="op" id="2570576">)</span>&nbsp;<span class="ident" id="2570578">FieldByNameFunc</span><span class="op" id="2570593">(</span><span class="ident" id="2570594">match</span>&nbsp;<span class="keyword" id="2570600">func</span><span class="op" id="2570604">(</span><span class="builtintype" id="2570605">string</span><span class="op" id="2570611">)</span>&nbsp;<span class="builtintype" id="2570613">bool</span><span class="op" id="2570617">)</span>&nbsp;<span class="op" id="2570619">(</span><span class="ident" id="2570620">StructField</span><span class="op" id="2570631">,</span>&nbsp;<span class="builtintype" id="2570633">bool</span><span class="op" id="2570637">)</span>&nbsp;<span class="op" id="2570639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570642">if</span>&nbsp;<span class="ident" id="2570645">t</span><span class="op" id="2570646">.</span><span class="ident" id="2570647">Kind</span><span class="op" id="2570651">(</span><span class="op" id="2570652">)</span>&nbsp;<span class="op" id="2570654">!=</span>&nbsp;<span class="ident" id="2570657">Struct</span>&nbsp;<span class="op" id="2570664">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2570668">panic</span><span class="op" id="2570673">(</span><span class="string" id="2570674">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2570719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570725">tt</span>&nbsp;<span class="op" id="2570728">:=</span>&nbsp;<span class="op" id="2570731">(</span><span class="op" id="2570732">*</span><span class="ident" id="2570733">structType</span><span class="op" id="2570743">)</span><span class="op" id="2570744">(</span><span class="ident" id="2570745">unsafe</span><span class="op" id="2570751">.</span><span class="ident" id="2570752">Pointer</span><span class="op" id="2570759">(</span><span class="ident" id="2570760">t</span><span class="op" id="2570761">)</span><span class="op" id="2570762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570765">return</span>&nbsp;<span class="ident" id="2570772">tt</span><span class="op" id="2570774">.</span><span class="ident" id="2570775">FieldByNameFunc</span><span class="op" id="2570790">(</span><span class="ident" id="2570791">match</span><span class="op" id="2570796">)</span><br>
<span class="lineno"></span><span class="op" id="2570798">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2570801">func</span>&nbsp;<span class="op" id="2570806">(</span><span class="ident" id="2570807">t</span>&nbsp;<span class="op" id="2570809">*</span><span class="ident" id="2570810">rtype</span><span class="op" id="2570815">)</span>&nbsp;<span class="ident" id="2570817">In</span><span class="op" id="2570819">(</span><span class="ident" id="2570820">i</span>&nbsp;<span class="builtintype" id="2570822">int</span><span class="op" id="2570825">)</span>&nbsp;<span class="ident" id="2570827">Type</span>&nbsp;<span class="op" id="2570832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570835">if</span>&nbsp;<span class="ident" id="2570838">t</span><span class="op" id="2570839">.</span><span class="ident" id="2570840">Kind</span><span class="op" id="2570844">(</span><span class="op" id="2570845">)</span>&nbsp;<span class="op" id="2570847">!=</span>&nbsp;<span class="ident" id="2570850">Func</span>&nbsp;<span class="op" id="2570855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2570859">panic</span><span class="op" id="2570864">(</span><span class="string" id="2570865">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2570895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2570898">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2570901">tt</span>&nbsp;<span class="op" id="2570904">:=</span>&nbsp;<span class="op" id="2570907">(</span><span class="op" id="2570908">*</span><span class="ident" id="2570909">funcType</span><span class="op" id="2570917">)</span><span class="op" id="2570918">(</span><span class="ident" id="2570919">unsafe</span><span class="op" id="2570925">.</span><span class="ident" id="2570926">Pointer</span><span class="op" id="2570933">(</span><span class="ident" id="2570934">t</span><span class="op" id="2570935">)</span><span class="op" id="2570936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570939">return</span>&nbsp;<span class="ident" id="2570946">toType</span><span class="op" id="2570952">(</span><span class="ident" id="2570953">tt</span><span class="op" id="2570955">.</span><span class="ident" id="2570956">in</span><span class="op" id="2570958">[</span><span class="ident" id="2570959">i</span><span class="op" id="2570960">]</span><span class="op" id="2570961">)</span><br>
<span class="lineno"></span><span class="op" id="2570963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570966">func</span>&nbsp;<span class="op" id="2570971">(</span><span class="ident" id="2570972">t</span>&nbsp;<span class="op" id="2570974">*</span><span class="ident" id="2570975">rtype</span><span class="op" id="2570980">)</span>&nbsp;<span class="ident" id="2570982">Key</span><span class="op" id="2570985">(</span><span class="op" id="2570986">)</span>&nbsp;<span class="ident" id="2570988">Type</span>&nbsp;<span class="op" id="2570993">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2570996">if</span>&nbsp;<span class="ident" id="2570999">t</span><span class="op" id="2571000">.</span><span class="ident" id="2571001">Kind</span><span class="op" id="2571005">(</span><span class="op" id="2571006">)</span>&nbsp;<span class="op" id="2571008">!=</span>&nbsp;<span class="ident" id="2571011">Map</span>&nbsp;<span class="op" id="2571015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2571019">panic</span><span class="op" id="2571024">(</span><span class="string" id="2571025">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2571055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2571058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2571061">tt</span>&nbsp;<span class="op" id="2571064">:=</span>&nbsp;<span class="op" id="2571067">(</span><span class="op" id="2571068">*</span><span class="ident" id="2571069">mapType</span><span class="op" id="2571076">)</span><span class="op" id="2571077">(</span><span class="ident" id="2571078">unsafe</span><span class="op" id="2571084">.</span><span class="ident" id="2571085">Pointer</span><span class="op" id="2571092">(</span><span class="ident" id="2571093">t</span><span class="op" id="2571094">)</span><span class="op" id="2571095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571098">return</span>&nbsp;<span class="ident" id="2571105">toType</span><span class="op" id="2571111">(</span><span class="ident" id="2571112">tt</span><span class="op" id="2571114">.</span><span class="ident" id="2571115">key</span><span class="op" id="2571118">)</span><br>
<span class="lineno">645</span><span class="op" id="2571120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571123">func</span>&nbsp;<span class="op" id="2571128">(</span><span class="ident" id="2571129">t</span>&nbsp;<span class="op" id="2571131">*</span><span class="ident" id="2571132">rtype</span><span class="op" id="2571137">)</span>&nbsp;<span class="ident" id="2571139">Len</span><span class="op" id="2571142">(</span><span class="op" id="2571143">)</span>&nbsp;<span class="builtintype" id="2571145">int</span>&nbsp;<span class="op" id="2571149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571152">if</span>&nbsp;<span class="ident" id="2571155">t</span><span class="op" id="2571156">.</span><span class="ident" id="2571157">Kind</span><span class="op" id="2571161">(</span><span class="op" id="2571162">)</span>&nbsp;<span class="op" id="2571164">!=</span>&nbsp;<span class="ident" id="2571167">Array</span>&nbsp;<span class="op" id="2571173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2571177">panic</span><span class="op" id="2571182">(</span><span class="string" id="2571183">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2571215">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2571218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2571221">tt</span>&nbsp;<span class="op" id="2571224">:=</span>&nbsp;<span class="op" id="2571227">(</span><span class="op" id="2571228">*</span><span class="ident" id="2571229">arrayType</span><span class="op" id="2571238">)</span><span class="op" id="2571239">(</span><span class="ident" id="2571240">unsafe</span><span class="op" id="2571246">.</span><span class="ident" id="2571247">Pointer</span><span class="op" id="2571254">(</span><span class="ident" id="2571255">t</span><span class="op" id="2571256">)</span><span class="op" id="2571257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571260">return</span>&nbsp;<span class="builtintype" id="2571267">int</span><span class="op" id="2571270">(</span><span class="ident" id="2571271">tt</span><span class="op" id="2571273">.</span><span class="builtinfunc" id="2571274">len</span><span class="op" id="2571277">)</span><br>
<span class="lineno"></span><span class="op" id="2571279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2571282">func</span>&nbsp;<span class="op" id="2571287">(</span><span class="ident" id="2571288">t</span>&nbsp;<span class="op" id="2571290">*</span><span class="ident" id="2571291">rtype</span><span class="op" id="2571296">)</span>&nbsp;<span class="ident" id="2571298">NumField</span><span class="op" id="2571306">(</span><span class="op" id="2571307">)</span>&nbsp;<span class="builtintype" id="2571309">int</span>&nbsp;<span class="op" id="2571313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571316">if</span>&nbsp;<span class="ident" id="2571319">t</span><span class="op" id="2571320">.</span><span class="ident" id="2571321">Kind</span><span class="op" id="2571325">(</span><span class="op" id="2571326">)</span>&nbsp;<span class="op" id="2571328">!=</span>&nbsp;<span class="ident" id="2571331">Struct</span>&nbsp;<span class="op" id="2571338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2571342">panic</span><span class="op" id="2571347">(</span><span class="string" id="2571348">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2571386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2571389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2571392">tt</span>&nbsp;<span class="op" id="2571395">:=</span>&nbsp;<span class="op" id="2571398">(</span><span class="op" id="2571399">*</span><span class="ident" id="2571400">structType</span><span class="op" id="2571410">)</span><span class="op" id="2571411">(</span><span class="ident" id="2571412">unsafe</span><span class="op" id="2571418">.</span><span class="ident" id="2571419">Pointer</span><span class="op" id="2571426">(</span><span class="ident" id="2571427">t</span><span class="op" id="2571428">)</span><span class="op" id="2571429">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571432">return</span>&nbsp;<span class="builtinfunc" id="2571439">len</span><span class="op" id="2571442">(</span><span class="ident" id="2571443">tt</span><span class="op" id="2571445">.</span><span class="ident" id="2571446">fields</span><span class="op" id="2571452">)</span><br>
<span class="lineno"></span><span class="op" id="2571454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571457">func</span>&nbsp;<span class="op" id="2571462">(</span><span class="ident" id="2571463">t</span>&nbsp;<span class="op" id="2571465">*</span><span class="ident" id="2571466">rtype</span><span class="op" id="2571471">)</span>&nbsp;<span class="ident" id="2571473">NumIn</span><span class="op" id="2571478">(</span><span class="op" id="2571479">)</span>&nbsp;<span class="builtintype" id="2571481">int</span>&nbsp;<span class="op" id="2571485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571488">if</span>&nbsp;<span class="ident" id="2571491">t</span><span class="op" id="2571492">.</span><span class="ident" id="2571493">Kind</span><span class="op" id="2571497">(</span><span class="op" id="2571498">)</span>&nbsp;<span class="op" id="2571500">!=</span>&nbsp;<span class="ident" id="2571503">Func</span>&nbsp;<span class="op" id="2571508">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2571512">panic</span><span class="op" id="2571517">(</span><span class="string" id="2571518">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2571551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2571554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2571557">tt</span>&nbsp;<span class="op" id="2571560">:=</span>&nbsp;<span class="op" id="2571563">(</span><span class="op" id="2571564">*</span><span class="ident" id="2571565">funcType</span><span class="op" id="2571573">)</span><span class="op" id="2571574">(</span><span class="ident" id="2571575">unsafe</span><span class="op" id="2571581">.</span><span class="ident" id="2571582">Pointer</span><span class="op" id="2571589">(</span><span class="ident" id="2571590">t</span><span class="op" id="2571591">)</span><span class="op" id="2571592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571595">return</span>&nbsp;<span class="builtinfunc" id="2571602">len</span><span class="op" id="2571605">(</span><span class="ident" id="2571606">tt</span><span class="op" id="2571608">.</span><span class="ident" id="2571609">in</span><span class="op" id="2571611">)</span><br>
<span class="lineno"></span><span class="op" id="2571613">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2571616">func</span>&nbsp;<span class="op" id="2571621">(</span><span class="ident" id="2571622">t</span>&nbsp;<span class="op" id="2571624">*</span><span class="ident" id="2571625">rtype</span><span class="op" id="2571630">)</span>&nbsp;<span class="ident" id="2571632">NumOut</span><span class="op" id="2571638">(</span><span class="op" id="2571639">)</span>&nbsp;<span class="builtintype" id="2571641">int</span>&nbsp;<span class="op" id="2571645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571648">if</span>&nbsp;<span class="ident" id="2571651">t</span><span class="op" id="2571652">.</span><span class="ident" id="2571653">Kind</span><span class="op" id="2571657">(</span><span class="op" id="2571658">)</span>&nbsp;<span class="op" id="2571660">!=</span>&nbsp;<span class="ident" id="2571663">Func</span>&nbsp;<span class="op" id="2571668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2571672">panic</span><span class="op" id="2571677">(</span><span class="string" id="2571678">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2571712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2571715">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2571718">tt</span>&nbsp;<span class="op" id="2571721">:=</span>&nbsp;<span class="op" id="2571724">(</span><span class="op" id="2571725">*</span><span class="ident" id="2571726">funcType</span><span class="op" id="2571734">)</span><span class="op" id="2571735">(</span><span class="ident" id="2571736">unsafe</span><span class="op" id="2571742">.</span><span class="ident" id="2571743">Pointer</span><span class="op" id="2571750">(</span><span class="ident" id="2571751">t</span><span class="op" id="2571752">)</span><span class="op" id="2571753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571756">return</span>&nbsp;<span class="builtinfunc" id="2571763">len</span><span class="op" id="2571766">(</span><span class="ident" id="2571767">tt</span><span class="op" id="2571769">.</span><span class="ident" id="2571770">out</span><span class="op" id="2571773">)</span><br>
<span class="lineno"></span><span class="op" id="2571775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571778">func</span>&nbsp;<span class="op" id="2571783">(</span><span class="ident" id="2571784">t</span>&nbsp;<span class="op" id="2571786">*</span><span class="ident" id="2571787">rtype</span><span class="op" id="2571792">)</span>&nbsp;<span class="ident" id="2571794">Out</span><span class="op" id="2571797">(</span><span class="ident" id="2571798">i</span>&nbsp;<span class="builtintype" id="2571800">int</span><span class="op" id="2571803">)</span>&nbsp;<span class="ident" id="2571805">Type</span>&nbsp;<span class="op" id="2571810">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571813">if</span>&nbsp;<span class="ident" id="2571816">t</span><span class="op" id="2571817">.</span><span class="ident" id="2571818">Kind</span><span class="op" id="2571822">(</span><span class="op" id="2571823">)</span>&nbsp;<span class="op" id="2571825">!=</span>&nbsp;<span class="ident" id="2571828">Func</span>&nbsp;<span class="op" id="2571833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2571837">panic</span><span class="op" id="2571842">(</span><span class="string" id="2571843">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2571874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2571877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2571880">tt</span>&nbsp;<span class="op" id="2571883">:=</span>&nbsp;<span class="op" id="2571886">(</span><span class="op" id="2571887">*</span><span class="ident" id="2571888">funcType</span><span class="op" id="2571896">)</span><span class="op" id="2571897">(</span><span class="ident" id="2571898">unsafe</span><span class="op" id="2571904">.</span><span class="ident" id="2571905">Pointer</span><span class="op" id="2571912">(</span><span class="ident" id="2571913">t</span><span class="op" id="2571914">)</span><span class="op" id="2571915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571918">return</span>&nbsp;<span class="ident" id="2571925">toType</span><span class="op" id="2571931">(</span><span class="ident" id="2571932">tt</span><span class="op" id="2571934">.</span><span class="ident" id="2571935">out</span><span class="op" id="2571938">[</span><span class="ident" id="2571939">i</span><span class="op" id="2571940">]</span><span class="op" id="2571941">)</span><br>
<span class="lineno">685</span><span class="op" id="2571943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571946">func</span>&nbsp;<span class="op" id="2571951">(</span><span class="ident" id="2571952">d</span>&nbsp;<span class="ident" id="2571954">ChanDir</span><span class="op" id="2571961">)</span>&nbsp;<span class="ident" id="2571963">String</span><span class="op" id="2571969">(</span><span class="op" id="2571970">)</span>&nbsp;<span class="builtintype" id="2571972">string</span>&nbsp;<span class="op" id="2571979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571982">switch</span>&nbsp;<span class="ident" id="2571989">d</span>&nbsp;<span class="op" id="2571991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2571994">case</span>&nbsp;<span class="ident" id="2571999">SendDir</span><span class="op" id="2572006">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572010">return</span>&nbsp;<span class="string" id="2572017">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572027">case</span>&nbsp;<span class="ident" id="2572032">RecvDir</span><span class="op" id="2572039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572043">return</span>&nbsp;<span class="string" id="2572050">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572060">case</span>&nbsp;<span class="ident" id="2572065">BothDir</span><span class="op" id="2572072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572076">return</span>&nbsp;<span class="string" id="2572083">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2572091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572094">return</span>&nbsp;<span class="string" id="2572101">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2572111">+</span>&nbsp;<span class="ident" id="2572113">strconv</span><span class="op" id="2572120">.</span><span class="ident" id="2572121">Itoa</span><span class="op" id="2572125">(</span><span class="builtintype" id="2572126">int</span><span class="op" id="2572129">(</span><span class="ident" id="2572130">d</span><span class="op" id="2572131">)</span><span class="op" id="2572132">)</span><br>
<span class="lineno"></span><span class="op" id="2572134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2572137">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2572197">func</span>&nbsp;<span class="op" id="2572202">(</span><span class="ident" id="2572203">t</span>&nbsp;<span class="op" id="2572205">*</span><span class="ident" id="2572206">interfaceType</span><span class="op" id="2572219">)</span>&nbsp;<span class="ident" id="2572221">Method</span><span class="op" id="2572227">(</span><span class="ident" id="2572228">i</span>&nbsp;<span class="builtintype" id="2572230">int</span><span class="op" id="2572233">)</span>&nbsp;<span class="op" id="2572235">(</span><span class="ident" id="2572236">m</span>&nbsp;<span class="ident" id="2572238">Method</span><span class="op" id="2572244">)</span>&nbsp;<span class="op" id="2572246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572249">if</span>&nbsp;<span class="ident" id="2572252">i</span>&nbsp;<span class="op" id="2572254">&lt;</span>&nbsp;<span class="num" id="2572256">0</span>&nbsp;<span class="op" id="2572258">||</span>&nbsp;<span class="ident" id="2572261">i</span>&nbsp;<span class="op" id="2572263">&gt;=</span>&nbsp;<span class="builtinfunc" id="2572266">len</span><span class="op" id="2572269">(</span><span class="ident" id="2572270">t</span><span class="op" id="2572271">.</span><span class="ident" id="2572272">methods</span><span class="op" id="2572279">)</span>&nbsp;<span class="op" id="2572281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572285">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2572293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2572296">p</span>&nbsp;<span class="op" id="2572298">:=</span>&nbsp;<span class="op" id="2572301">&amp;</span><span class="ident" id="2572302">t</span><span class="op" id="2572303">.</span><span class="ident" id="2572304">methods</span><span class="op" id="2572311">[</span><span class="ident" id="2572312">i</span><span class="op" id="2572313">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2572316">m</span><span class="op" id="2572317">.</span><span class="ident" id="2572318">Name</span>&nbsp;<span class="op" id="2572323">=</span>&nbsp;<span class="op" id="2572325">*</span><span class="ident" id="2572326">p</span><span class="op" id="2572327">.</span><span class="ident" id="2572328">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572334">if</span>&nbsp;<span class="ident" id="2572337">p</span><span class="op" id="2572338">.</span><span class="ident" id="2572339">pkgPath</span>&nbsp;<span class="op" id="2572347">!=</span>&nbsp;<span class="ident" id="2572350">nil</span>&nbsp;<span class="op" id="2572354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2572358">m</span><span class="op" id="2572359">.</span><span class="ident" id="2572360">PkgPath</span>&nbsp;<span class="op" id="2572368">=</span>&nbsp;<span class="op" id="2572370">*</span><span class="ident" id="2572371">p</span><span class="op" id="2572372">.</span><span class="ident" id="2572373">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2572382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2572385">m</span><span class="op" id="2572386">.</span><span class="ident" id="2572387">Type</span>&nbsp;<span class="op" id="2572392">=</span>&nbsp;<span class="ident" id="2572394">toType</span><span class="op" id="2572400">(</span><span class="ident" id="2572401">p</span><span class="op" id="2572402">.</span><span class="ident" id="2572403">typ</span><span class="op" id="2572406">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2572409">m</span><span class="op" id="2572410">.</span><span class="ident" id="2572411">Index</span>&nbsp;<span class="op" id="2572417">=</span>&nbsp;<span class="ident" id="2572419">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572422">return</span><br>
<span class="lineno"></span><span class="op" id="2572429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2572432">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2572511">func</span>&nbsp;<span class="op" id="2572516">(</span><span class="ident" id="2572517">t</span>&nbsp;<span class="op" id="2572519">*</span><span class="ident" id="2572520">interfaceType</span><span class="op" id="2572533">)</span>&nbsp;<span class="ident" id="2572535">NumMethod</span><span class="op" id="2572544">(</span><span class="op" id="2572545">)</span>&nbsp;<span class="builtintype" id="2572547">int</span>&nbsp;<span class="op" id="2572551">{</span>&nbsp;<span class="keyword" id="2572553">return</span>&nbsp;<span class="builtinfunc" id="2572560">len</span><span class="op" id="2572563">(</span><span class="ident" id="2572564">t</span><span class="op" id="2572565">.</span><span class="ident" id="2572566">methods</span><span class="op" id="2572573">)</span>&nbsp;<span class="op" id="2572575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2572578">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2572647">func</span>&nbsp;<span class="op" id="2572652">(</span><span class="ident" id="2572653">t</span>&nbsp;<span class="op" id="2572655">*</span><span class="ident" id="2572656">interfaceType</span><span class="op" id="2572669">)</span>&nbsp;<span class="ident" id="2572671">MethodByName</span><span class="op" id="2572683">(</span><span class="ident" id="2572684">name</span>&nbsp;<span class="builtintype" id="2572689">string</span><span class="op" id="2572695">)</span>&nbsp;<span class="op" id="2572697">(</span><span class="ident" id="2572698">m</span>&nbsp;<span class="ident" id="2572700">Method</span><span class="op" id="2572706">,</span>&nbsp;<span class="ident" id="2572708">ok</span>&nbsp;<span class="builtintype" id="2572711">bool</span><span class="op" id="2572715">)</span>&nbsp;<span class="op" id="2572717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572720">if</span>&nbsp;<span class="ident" id="2572723">t</span>&nbsp;<span class="op" id="2572725">==</span>&nbsp;<span class="ident" id="2572728">nil</span>&nbsp;<span class="op" id="2572732">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2572744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572747">var</span>&nbsp;<span class="ident" id="2572751">p</span>&nbsp;<span class="op" id="2572753">*</span><span class="ident" id="2572754">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572763">for</span>&nbsp;<span class="ident" id="2572767">i</span>&nbsp;<span class="op" id="2572769">:=</span>&nbsp;<span class="keyword" id="2572772">range</span>&nbsp;<span class="ident" id="2572778">t</span><span class="op" id="2572779">.</span><span class="ident" id="2572780">methods</span>&nbsp;<span class="op" id="2572788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2572792">p</span>&nbsp;<span class="op" id="2572794">=</span>&nbsp;<span class="op" id="2572796">&amp;</span><span class="ident" id="2572797">t</span><span class="op" id="2572798">.</span><span class="ident" id="2572799">methods</span><span class="op" id="2572806">[</span><span class="ident" id="2572807">i</span><span class="op" id="2572808">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572812">if</span>&nbsp;<span class="op" id="2572815">*</span><span class="ident" id="2572816">p</span><span class="op" id="2572817">.</span><span class="ident" id="2572818">name</span>&nbsp;<span class="op" id="2572823">==</span>&nbsp;<span class="ident" id="2572826">name</span>&nbsp;<span class="op" id="2572831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572836">return</span>&nbsp;<span class="ident" id="2572843">t</span><span class="op" id="2572844">.</span><span class="ident" id="2572845">Method</span><span class="op" id="2572851">(</span><span class="ident" id="2572852">i</span><span class="op" id="2572853">)</span><span class="op" id="2572854">,</span>&nbsp;<span class="ident" id="2572856">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2572863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2572866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2572869">return</span><br>
<span class="lineno">730</span><span class="op" id="2572876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2572879">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2572934">type</span>&nbsp;<span class="ident" id="2572939">StructField</span>&nbsp;<span class="keyword" id="2572951">struct</span>&nbsp;<span class="op" id="2572958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2572961">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2572989">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2573062">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2573130">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573191">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2573199">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573207">PkgPath</span>&nbsp;<span class="builtintype" id="2573215">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573224">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573234">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2573244">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573259">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573269">StructTag</span>&nbsp;<span class="comment" id="2573279">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573300">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2573310">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2573320">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573355">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2573365">[</span><span class="op" id="2573366">]</span><span class="builtintype" id="2573367">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2573375">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2573416">Anonymous</span>&nbsp;<span class="builtintype" id="2573426">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2573436">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2573460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2573463">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2573515">//</span><br>
<span class="lineno">750</span><span class="comment" id="2573518">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2573571">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2573620">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2573680">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2573745">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2573811">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2573855">type</span>&nbsp;<span class="ident" id="2573860">StructTag</span>&nbsp;<span class="builtintype" id="2573870">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2573878">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2573942">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2574011">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2574074">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2574109">func</span>&nbsp;<span class="op" id="2574114">(</span><span class="ident" id="2574115">tag</span>&nbsp;<span class="ident" id="2574119">StructTag</span><span class="op" id="2574128">)</span>&nbsp;<span class="ident" id="2574130">Get</span><span class="op" id="2574133">(</span><span class="ident" id="2574134">key</span>&nbsp;<span class="builtintype" id="2574138">string</span><span class="op" id="2574144">)</span>&nbsp;<span class="builtintype" id="2574146">string</span>&nbsp;<span class="op" id="2574153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574156">for</span>&nbsp;<span class="ident" id="2574160">tag</span>&nbsp;<span class="op" id="2574164">!=</span>&nbsp;<span class="string" id="2574167">&#34;&#34;</span>&nbsp;<span class="op" id="2574170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2574174">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574198">i</span>&nbsp;<span class="op" id="2574200">:=</span>&nbsp;<span class="num" id="2574203">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574207">for</span>&nbsp;<span class="ident" id="2574211">i</span>&nbsp;<span class="op" id="2574213">&lt;</span>&nbsp;<span class="builtinfunc" id="2574215">len</span><span class="op" id="2574218">(</span><span class="ident" id="2574219">tag</span><span class="op" id="2574222">)</span>&nbsp;<span class="op" id="2574224">&amp;&amp;</span>&nbsp;<span class="ident" id="2574227">tag</span><span class="op" id="2574230">[</span><span class="ident" id="2574231">i</span><span class="op" id="2574232">]</span>&nbsp;<span class="op" id="2574234">==</span>&nbsp;<span class="string" id="2574237">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2574241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574246">i</span><span class="op" id="2574247">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574256">tag</span>&nbsp;<span class="op" id="2574260">=</span>&nbsp;<span class="ident" id="2574262">tag</span><span class="op" id="2574265">[</span><span class="ident" id="2574266">i</span><span class="op" id="2574267">:</span><span class="op" id="2574268">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574272">if</span>&nbsp;<span class="ident" id="2574275">tag</span>&nbsp;<span class="op" id="2574279">==</span>&nbsp;<span class="string" id="2574282">&#34;&#34;</span>&nbsp;<span class="op" id="2574285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574290">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2574303">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2574323">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574365">i</span>&nbsp;<span class="op" id="2574367">=</span>&nbsp;<span class="num" id="2574369">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574373">for</span>&nbsp;<span class="ident" id="2574377">i</span>&nbsp;<span class="op" id="2574379">&lt;</span>&nbsp;<span class="builtinfunc" id="2574381">len</span><span class="op" id="2574384">(</span><span class="ident" id="2574385">tag</span><span class="op" id="2574388">)</span>&nbsp;<span class="op" id="2574390">&amp;&amp;</span>&nbsp;<span class="ident" id="2574393">tag</span><span class="op" id="2574396">[</span><span class="ident" id="2574397">i</span><span class="op" id="2574398">]</span>&nbsp;<span class="op" id="2574400">!=</span>&nbsp;<span class="string" id="2574403">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2574407">&amp;&amp;</span>&nbsp;<span class="ident" id="2574410">tag</span><span class="op" id="2574413">[</span><span class="ident" id="2574414">i</span><span class="op" id="2574415">]</span>&nbsp;<span class="op" id="2574417">!=</span>&nbsp;<span class="string" id="2574420">&#39;:&#39;</span>&nbsp;<span class="op" id="2574424">&amp;&amp;</span>&nbsp;<span class="ident" id="2574427">tag</span><span class="op" id="2574430">[</span><span class="ident" id="2574431">i</span><span class="op" id="2574432">]</span>&nbsp;<span class="op" id="2574434">!=</span>&nbsp;<span class="string" id="2574437">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2574441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574446">i</span><span class="op" id="2574447">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574452">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574456">if</span>&nbsp;<span class="ident" id="2574459">i</span><span class="op" id="2574460">+</span><span class="num" id="2574461">1</span>&nbsp;<span class="op" id="2574463">&gt;=</span>&nbsp;<span class="builtinfunc" id="2574466">len</span><span class="op" id="2574469">(</span><span class="ident" id="2574470">tag</span><span class="op" id="2574473">)</span>&nbsp;<span class="op" id="2574475">||</span>&nbsp;<span class="ident" id="2574478">tag</span><span class="op" id="2574481">[</span><span class="ident" id="2574482">i</span><span class="op" id="2574483">]</span>&nbsp;<span class="op" id="2574485">!=</span>&nbsp;<span class="string" id="2574488">&#39;:&#39;</span>&nbsp;<span class="op" id="2574492">||</span>&nbsp;<span class="ident" id="2574495">tag</span><span class="op" id="2574498">[</span><span class="ident" id="2574499">i</span><span class="op" id="2574500">+</span><span class="num" id="2574501">1</span><span class="op" id="2574502">]</span>&nbsp;<span class="op" id="2574504">!=</span>&nbsp;<span class="string" id="2574507">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2574511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574516">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574528">name</span>&nbsp;<span class="op" id="2574533">:=</span>&nbsp;<span class="builtintype" id="2574536">string</span><span class="op" id="2574542">(</span><span class="ident" id="2574543">tag</span><span class="op" id="2574546">[</span><span class="op" id="2574547">:</span><span class="ident" id="2574548">i</span><span class="op" id="2574549">]</span><span class="op" id="2574550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574554">tag</span>&nbsp;<span class="op" id="2574558">=</span>&nbsp;<span class="ident" id="2574560">tag</span><span class="op" id="2574563">[</span><span class="ident" id="2574564">i</span><span class="op" id="2574565">+</span><span class="num" id="2574566">1</span><span class="op" id="2574567">:</span><span class="op" id="2574568">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2574573">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574611">i</span>&nbsp;<span class="op" id="2574613">=</span>&nbsp;<span class="num" id="2574615">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574619">for</span>&nbsp;<span class="ident" id="2574623">i</span>&nbsp;<span class="op" id="2574625">&lt;</span>&nbsp;<span class="builtinfunc" id="2574627">len</span><span class="op" id="2574630">(</span><span class="ident" id="2574631">tag</span><span class="op" id="2574634">)</span>&nbsp;<span class="op" id="2574636">&amp;&amp;</span>&nbsp;<span class="ident" id="2574639">tag</span><span class="op" id="2574642">[</span><span class="ident" id="2574643">i</span><span class="op" id="2574644">]</span>&nbsp;<span class="op" id="2574646">!=</span>&nbsp;<span class="string" id="2574649">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2574653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574658">if</span>&nbsp;<span class="ident" id="2574661">tag</span><span class="op" id="2574664">[</span><span class="ident" id="2574665">i</span><span class="op" id="2574666">]</span>&nbsp;<span class="op" id="2574668">==</span>&nbsp;<span class="string" id="2574671">&#39;\\&#39;</span>&nbsp;<span class="op" id="2574676">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574682">i</span><span class="op" id="2574683">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574694">i</span><span class="op" id="2574695">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574704">if</span>&nbsp;<span class="ident" id="2574707">i</span>&nbsp;<span class="op" id="2574709">&gt;=</span>&nbsp;<span class="builtinfunc" id="2574712">len</span><span class="op" id="2574715">(</span><span class="ident" id="2574716">tag</span><span class="op" id="2574719">)</span>&nbsp;<span class="op" id="2574721">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574726">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574738">qvalue</span>&nbsp;<span class="op" id="2574745">:=</span>&nbsp;<span class="builtintype" id="2574748">string</span><span class="op" id="2574754">(</span><span class="ident" id="2574755">tag</span><span class="op" id="2574758">[</span><span class="op" id="2574759">:</span><span class="ident" id="2574760">i</span><span class="op" id="2574761">+</span><span class="num" id="2574762">1</span><span class="op" id="2574763">]</span><span class="op" id="2574764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574768">tag</span>&nbsp;<span class="op" id="2574772">=</span>&nbsp;<span class="ident" id="2574774">tag</span><span class="op" id="2574777">[</span><span class="ident" id="2574778">i</span><span class="op" id="2574779">+</span><span class="num" id="2574780">1</span><span class="op" id="2574781">:</span><span class="op" id="2574782">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574787">if</span>&nbsp;<span class="ident" id="2574790">key</span>&nbsp;<span class="op" id="2574794">==</span>&nbsp;<span class="ident" id="2574797">name</span>&nbsp;<span class="op" id="2574802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2574807">value</span><span class="op" id="2574812">,</span>&nbsp;<span class="ident" id="2574814">_</span>&nbsp;<span class="op" id="2574816">:=</span>&nbsp;<span class="ident" id="2574819">strconv</span><span class="op" id="2574826">.</span><span class="ident" id="2574827">Unquote</span><span class="op" id="2574834">(</span><span class="ident" id="2574835">qvalue</span><span class="op" id="2574841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574846">return</span>&nbsp;<span class="ident" id="2574853">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2574864">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574867">return</span>&nbsp;<span class="string" id="2574874">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2574877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2574880">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2574920">func</span>&nbsp;<span class="op" id="2574925">(</span><span class="ident" id="2574926">t</span>&nbsp;<span class="op" id="2574928">*</span><span class="ident" id="2574929">structType</span><span class="op" id="2574939">)</span>&nbsp;<span class="ident" id="2574941">Field</span><span class="op" id="2574946">(</span><span class="ident" id="2574947">i</span>&nbsp;<span class="builtintype" id="2574949">int</span><span class="op" id="2574952">)</span>&nbsp;<span class="op" id="2574954">(</span><span class="ident" id="2574955">f</span>&nbsp;<span class="ident" id="2574957">StructField</span><span class="op" id="2574968">)</span>&nbsp;<span class="op" id="2574970">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2574973">if</span>&nbsp;<span class="ident" id="2574976">i</span>&nbsp;<span class="op" id="2574978">&lt;</span>&nbsp;<span class="num" id="2574980">0</span>&nbsp;<span class="op" id="2574982">||</span>&nbsp;<span class="ident" id="2574985">i</span>&nbsp;<span class="op" id="2574987">&gt;=</span>&nbsp;<span class="builtinfunc" id="2574990">len</span><span class="op" id="2574993">(</span><span class="ident" id="2574994">t</span><span class="op" id="2574995">.</span><span class="ident" id="2574996">fields</span><span class="op" id="2575002">)</span>&nbsp;<span class="op" id="2575004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2575008">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2575016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575019">p</span>&nbsp;<span class="op" id="2575021">:=</span>&nbsp;<span class="op" id="2575024">&amp;</span><span class="ident" id="2575025">t</span><span class="op" id="2575026">.</span><span class="ident" id="2575027">fields</span><span class="op" id="2575033">[</span><span class="ident" id="2575034">i</span><span class="op" id="2575035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575038">f</span><span class="op" id="2575039">.</span><span class="ident" id="2575040">Type</span>&nbsp;<span class="op" id="2575045">=</span>&nbsp;<span class="ident" id="2575047">toType</span><span class="op" id="2575053">(</span><span class="ident" id="2575054">p</span><span class="op" id="2575055">.</span><span class="ident" id="2575056">typ</span><span class="op" id="2575059">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2575062">if</span>&nbsp;<span class="ident" id="2575065">p</span><span class="op" id="2575066">.</span><span class="ident" id="2575067">name</span>&nbsp;<span class="op" id="2575072">!=</span>&nbsp;<span class="ident" id="2575075">nil</span>&nbsp;<span class="op" id="2575079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575083">f</span><span class="op" id="2575084">.</span><span class="ident" id="2575085">Name</span>&nbsp;<span class="op" id="2575090">=</span>&nbsp;<span class="op" id="2575092">*</span><span class="ident" id="2575093">p</span><span class="op" id="2575094">.</span><span class="ident" id="2575095">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2575101">}</span>&nbsp;<span class="keyword" id="2575103">else</span>&nbsp;<span class="op" id="2575108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575112">t</span>&nbsp;<span class="op" id="2575114">:=</span>&nbsp;<span class="ident" id="2575117">f</span><span class="op" id="2575118">.</span><span class="ident" id="2575119">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2575126">if</span>&nbsp;<span class="ident" id="2575129">t</span><span class="op" id="2575130">.</span><span class="ident" id="2575131">Kind</span><span class="op" id="2575135">(</span><span class="op" id="2575136">)</span>&nbsp;<span class="op" id="2575138">==</span>&nbsp;<span class="ident" id="2575141">Ptr</span>&nbsp;<span class="op" id="2575145">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575150">t</span>&nbsp;<span class="op" id="2575152">=</span>&nbsp;<span class="ident" id="2575154">t</span><span class="op" id="2575155">.</span><span class="ident" id="2575156">Elem</span><span class="op" id="2575160">(</span><span class="op" id="2575161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2575165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575169">f</span><span class="op" id="2575170">.</span><span class="ident" id="2575171">Name</span>&nbsp;<span class="op" id="2575176">=</span>&nbsp;<span class="ident" id="2575178">t</span><span class="op" id="2575179">.</span><span class="ident" id="2575180">Name</span><span class="op" id="2575184">(</span><span class="op" id="2575185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575189">f</span><span class="op" id="2575190">.</span><span class="ident" id="2575191">Anonymous</span>&nbsp;<span class="op" id="2575201">=</span>&nbsp;<span class="ident" id="2575203">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2575209">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2575212">if</span>&nbsp;<span class="ident" id="2575215">p</span><span class="op" id="2575216">.</span><span class="ident" id="2575217">pkgPath</span>&nbsp;<span class="op" id="2575225">!=</span>&nbsp;<span class="ident" id="2575228">nil</span>&nbsp;<span class="op" id="2575232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575236">f</span><span class="op" id="2575237">.</span><span class="ident" id="2575238">PkgPath</span>&nbsp;<span class="op" id="2575246">=</span>&nbsp;<span class="op" id="2575248">*</span><span class="ident" id="2575249">p</span><span class="op" id="2575250">.</span><span class="ident" id="2575251">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2575260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2575263">if</span>&nbsp;<span class="ident" id="2575266">p</span><span class="op" id="2575267">.</span><span class="ident" id="2575268">tag</span>&nbsp;<span class="op" id="2575272">!=</span>&nbsp;<span class="ident" id="2575275">nil</span>&nbsp;<span class="op" id="2575279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575283">f</span><span class="op" id="2575284">.</span><span class="ident" id="2575285">Tag</span>&nbsp;<span class="op" id="2575289">=</span>&nbsp;<span class="ident" id="2575291">StructTag</span><span class="op" id="2575300">(</span><span class="op" id="2575301">*</span><span class="ident" id="2575302">p</span><span class="op" id="2575303">.</span><span class="ident" id="2575304">tag</span><span class="op" id="2575307">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2575310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575313">f</span><span class="op" id="2575314">.</span><span class="ident" id="2575315">Offset</span>&nbsp;<span class="op" id="2575322">=</span>&nbsp;<span class="ident" id="2575324">p</span><span class="op" id="2575325">.</span><span class="ident" id="2575326">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2575335">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2575395">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2575456">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2575515">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2575575">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2575635">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2575693">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2575744">f</span><span class="op" id="2575745">.</span><span class="ident" id="2575746">Index</span>&nbsp;<span class="op" id="2575752">=</span>&nbsp;<span class="op" id="2575754">[</span><span class="op" id="2575755">]</span><span class="builtintype" id="2575756">int</span><span class="op" id="2575759">{</span><span class="ident" id="2575760">i</span><span class="op" id="2575761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2575764">return</span><br>
<span class="lineno"></span><span class="op" id="2575771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2575774">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2575841">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2575883">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2575948">func</span>&nbsp;<span class="op" id="2575953">(</span><span class="ident" id="2575954">t</span>&nbsp;<span class="op" id="2575956">*</span><span class="ident" id="2575957">structType</span><span class="op" id="2575967">)</span>&nbsp;<span class="ident" id="2575969">FieldByIndex</span><span class="op" id="2575981">(</span><span class="ident" id="2575982">index</span>&nbsp;<span class="op" id="2575988">[</span><span class="op" id="2575989">]</span><span class="builtintype" id="2575990">int</span><span class="op" id="2575993">)</span>&nbsp;<span class="op" id="2575995">(</span><span class="ident" id="2575996">f</span>&nbsp;<span class="ident" id="2575998">StructField</span><span class="op" id="2576009">)</span>&nbsp;<span class="op" id="2576011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2576014">f</span><span class="op" id="2576015">.</span><span class="ident" id="2576016">Type</span>&nbsp;<span class="op" id="2576021">=</span>&nbsp;<span class="ident" id="2576023">toType</span><span class="op" id="2576029">(</span><span class="op" id="2576030">&amp;</span><span class="ident" id="2576031">t</span><span class="op" id="2576032">.</span><span class="ident" id="2576033">rtype</span><span class="op" id="2576038">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2576041">for</span>&nbsp;<span class="ident" id="2576045">i</span><span class="op" id="2576046">,</span>&nbsp;<span class="ident" id="2576048">x</span>&nbsp;<span class="op" id="2576050">:=</span>&nbsp;<span class="keyword" id="2576053">range</span>&nbsp;<span class="ident" id="2576059">index</span>&nbsp;<span class="op" id="2576065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2576069">if</span>&nbsp;<span class="ident" id="2576072">i</span>&nbsp;<span class="op" id="2576074">&gt;</span>&nbsp;<span class="num" id="2576076">0</span>&nbsp;<span class="op" id="2576078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2576083">ft</span>&nbsp;<span class="op" id="2576086">:=</span>&nbsp;<span class="ident" id="2576089">f</span><span class="op" id="2576090">.</span><span class="ident" id="2576091">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2576099">if</span>&nbsp;<span class="ident" id="2576102">ft</span><span class="op" id="2576104">.</span><span class="ident" id="2576105">Kind</span><span class="op" id="2576109">(</span><span class="op" id="2576110">)</span>&nbsp;<span class="op" id="2576112">==</span>&nbsp;<span class="ident" id="2576115">Ptr</span>&nbsp;<span class="op" id="2576119">&amp;&amp;</span>&nbsp;<span class="ident" id="2576122">ft</span><span class="op" id="2576124">.</span><span class="ident" id="2576125">Elem</span><span class="op" id="2576129">(</span><span class="op" id="2576130">)</span><span class="op" id="2576131">.</span><span class="ident" id="2576132">Kind</span><span class="op" id="2576136">(</span><span class="op" id="2576137">)</span>&nbsp;<span class="op" id="2576139">==</span>&nbsp;<span class="ident" id="2576142">Struct</span>&nbsp;<span class="op" id="2576149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2576155">ft</span>&nbsp;<span class="op" id="2576158">=</span>&nbsp;<span class="ident" id="2576160">ft</span><span class="op" id="2576162">.</span><span class="ident" id="2576163">Elem</span><span class="op" id="2576167">(</span><span class="op" id="2576168">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2576173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2576178">f</span><span class="op" id="2576179">.</span><span class="ident" id="2576180">Type</span>&nbsp;<span class="op" id="2576185">=</span>&nbsp;<span class="ident" id="2576187">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2576192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2576196">f</span>&nbsp;<span class="op" id="2576198">=</span>&nbsp;<span class="ident" id="2576200">f</span><span class="op" id="2576201">.</span><span class="ident" id="2576202">Type</span><span class="op" id="2576206">.</span><span class="ident" id="2576207">Field</span><span class="op" id="2576212">(</span><span class="ident" id="2576213">x</span><span class="op" id="2576214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2576217">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2576220">return</span><br>
<span class="lineno"></span><span class="op" id="2576227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2576230">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2576303">type</span>&nbsp;<span class="ident" id="2576308">fieldScan</span>&nbsp;<span class="keyword" id="2576318">struct</span>&nbsp;<span class="op" id="2576325">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2576328">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2576334">*</span><span class="ident" id="2576335">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2576347">index</span>&nbsp;<span class="op" id="2576353">[</span><span class="op" id="2576354">]</span><span class="builtintype" id="2576355">int</span><br>
<span class="lineno"></span><span class="op" id="2576359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2576362">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2576437">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2576505">func</span>&nbsp;<span class="op" id="2576510">(</span><span class="ident" id="2576511">t</span>&nbsp;<span class="op" id="2576513">*</span><span class="ident" id="2576514">structType</span><span class="op" id="2576524">)</span>&nbsp;<span class="ident" id="2576526">FieldByNameFunc</span><span class="op" id="2576541">(</span><span class="ident" id="2576542">match</span>&nbsp;<span class="keyword" id="2576548">func</span><span class="op" id="2576552">(</span><span class="builtintype" id="2576553">string</span><span class="op" id="2576559">)</span>&nbsp;<span class="builtintype" id="2576561">bool</span><span class="op" id="2576565">)</span>&nbsp;<span class="op" id="2576567">(</span><span class="ident" id="2576568">result</span>&nbsp;<span class="ident" id="2576575">StructField</span><span class="op" id="2576586">,</span>&nbsp;<span class="ident" id="2576588">ok</span>&nbsp;<span class="builtintype" id="2576591">bool</span><span class="op" id="2576595">)</span>&nbsp;<span class="op" id="2576597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2576600">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2576692">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2576783">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2576875">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2576946">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2576995">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577054">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2577109">current</span>&nbsp;<span class="op" id="2577117">:=</span>&nbsp;<span class="op" id="2577120">[</span><span class="op" id="2577121">]</span><span class="ident" id="2577122">fieldScan</span><span class="op" id="2577131">{</span><span class="op" id="2577132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2577135">next</span>&nbsp;<span class="op" id="2577140">:=</span>&nbsp;<span class="op" id="2577143">[</span><span class="op" id="2577144">]</span><span class="ident" id="2577145">fieldScan</span><span class="op" id="2577154">{</span><span class="op" id="2577155">{</span><span class="ident" id="2577156">typ</span><span class="op" id="2577159">:</span>&nbsp;<span class="ident" id="2577161">t</span><span class="op" id="2577162">}</span><span class="op" id="2577163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577167">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577235">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577300">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577369">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577446">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577519">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2577554">var</span>&nbsp;<span class="ident" id="2577558">nextCount</span>&nbsp;<span class="keyword" id="2577568">map</span><span class="op" id="2577571">[</span><span class="op" id="2577572">*</span><span class="ident" id="2577573">structType</span><span class="op" id="2577583">]</span><span class="builtintype" id="2577584">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577590">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577657">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577719">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577788">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2577860">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2577935">visited</span>&nbsp;<span class="op" id="2577943">:=</span>&nbsp;<span class="keyword" id="2577946">map</span><span class="op" id="2577949">[</span><span class="op" id="2577950">*</span><span class="ident" id="2577951">structType</span><span class="op" id="2577961">]</span><span class="builtintype" id="2577962">bool</span><span class="op" id="2577966">{</span><span class="op" id="2577967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2577971">for</span>&nbsp;<span class="builtinfunc" id="2577975">len</span><span class="op" id="2577978">(</span><span class="ident" id="2577979">next</span><span class="op" id="2577983">)</span>&nbsp;<span class="op" id="2577985">&gt;</span>&nbsp;<span class="num" id="2577987">0</span>&nbsp;<span class="op" id="2577989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2577993">current</span><span class="op" id="2578000">,</span>&nbsp;<span class="ident" id="2578002">next</span>&nbsp;<span class="op" id="2578007">=</span>&nbsp;<span class="ident" id="2578009">next</span><span class="op" id="2578013">,</span>&nbsp;<span class="ident" id="2578015">current</span><span class="op" id="2578022">[</span><span class="op" id="2578023">:</span><span class="num" id="2578024">0</span><span class="op" id="2578025">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578029">count</span>&nbsp;<span class="op" id="2578035">:=</span>&nbsp;<span class="ident" id="2578038">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578050">nextCount</span>&nbsp;<span class="op" id="2578060">=</span>&nbsp;<span class="ident" id="2578062">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578069">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578137">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578222">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578297">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578386">for</span>&nbsp;<span class="ident" id="2578390">_</span><span class="op" id="2578391">,</span>&nbsp;<span class="ident" id="2578393">scan</span>&nbsp;<span class="op" id="2578398">:=</span>&nbsp;<span class="keyword" id="2578401">range</span>&nbsp;<span class="ident" id="2578407">current</span>&nbsp;<span class="op" id="2578415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578420">t</span>&nbsp;<span class="op" id="2578422">:=</span>&nbsp;<span class="ident" id="2578425">scan</span><span class="op" id="2578429">.</span><span class="ident" id="2578430">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578437">if</span>&nbsp;<span class="ident" id="2578440">visited</span><span class="op" id="2578447">[</span><span class="ident" id="2578448">t</span><span class="op" id="2578449">]</span>&nbsp;<span class="op" id="2578451">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578457">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578522">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578590">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578643">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2578655">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578660">visited</span><span class="op" id="2578667">[</span><span class="ident" id="2578668">t</span><span class="op" id="2578669">]</span>&nbsp;<span class="op" id="2578671">=</span>&nbsp;<span class="ident" id="2578673">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578681">for</span>&nbsp;<span class="ident" id="2578685">i</span>&nbsp;<span class="op" id="2578687">:=</span>&nbsp;<span class="keyword" id="2578690">range</span>&nbsp;<span class="ident" id="2578696">t</span><span class="op" id="2578697">.</span><span class="ident" id="2578698">fields</span>&nbsp;<span class="op" id="2578705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578711">f</span>&nbsp;<span class="op" id="2578713">:=</span>&nbsp;<span class="op" id="2578716">&amp;</span><span class="ident" id="2578717">t</span><span class="op" id="2578718">.</span><span class="ident" id="2578719">fields</span><span class="op" id="2578725">[</span><span class="ident" id="2578726">i</span><span class="op" id="2578727">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578733">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578772">var</span>&nbsp;<span class="ident" id="2578776">fname</span>&nbsp;<span class="builtintype" id="2578782">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578793">var</span>&nbsp;<span class="ident" id="2578797">ntyp</span>&nbsp;<span class="op" id="2578802">*</span><span class="ident" id="2578803">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578813">if</span>&nbsp;<span class="ident" id="2578816">f</span><span class="op" id="2578817">.</span><span class="ident" id="2578818">name</span>&nbsp;<span class="op" id="2578823">!=</span>&nbsp;<span class="ident" id="2578826">nil</span>&nbsp;<span class="op" id="2578830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578837">fname</span>&nbsp;<span class="op" id="2578843">=</span>&nbsp;<span class="op" id="2578845">*</span><span class="ident" id="2578846">f</span><span class="op" id="2578847">.</span><span class="ident" id="2578848">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2578857">}</span>&nbsp;<span class="keyword" id="2578859">else</span>&nbsp;<span class="op" id="2578864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578871">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2578912">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578942">ntyp</span>&nbsp;<span class="op" id="2578947">=</span>&nbsp;<span class="ident" id="2578949">f</span><span class="op" id="2578950">.</span><span class="ident" id="2578951">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2578960">if</span>&nbsp;<span class="ident" id="2578963">ntyp</span><span class="op" id="2578967">.</span><span class="ident" id="2578968">Kind</span><span class="op" id="2578972">(</span><span class="op" id="2578973">)</span>&nbsp;<span class="op" id="2578975">==</span>&nbsp;<span class="ident" id="2578978">Ptr</span>&nbsp;<span class="op" id="2578982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2578990">ntyp</span>&nbsp;<span class="op" id="2578995">=</span>&nbsp;<span class="ident" id="2578997">ntyp</span><span class="op" id="2579001">.</span><span class="ident" id="2579002">Elem</span><span class="op" id="2579006">(</span><span class="op" id="2579007">)</span><span class="op" id="2579008">.</span><span class="ident" id="2579009">common</span><span class="op" id="2579015">(</span><span class="op" id="2579016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2579023">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579030">fname</span>&nbsp;<span class="op" id="2579036">=</span>&nbsp;<span class="ident" id="2579038">ntyp</span><span class="op" id="2579042">.</span><span class="ident" id="2579043">Name</span><span class="op" id="2579047">(</span><span class="op" id="2579048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2579054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2579061">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579083">if</span>&nbsp;<span class="ident" id="2579086">match</span><span class="op" id="2579091">(</span><span class="ident" id="2579092">fname</span><span class="op" id="2579097">)</span>&nbsp;<span class="op" id="2579099">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2579106">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579130">if</span>&nbsp;<span class="ident" id="2579133">count</span><span class="op" id="2579138">[</span><span class="ident" id="2579139">t</span><span class="op" id="2579140">]</span>&nbsp;<span class="op" id="2579142">&gt;</span>&nbsp;<span class="num" id="2579144">1</span>&nbsp;<span class="op" id="2579146">||</span>&nbsp;<span class="ident" id="2579149">ok</span>&nbsp;<span class="op" id="2579152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2579160">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579225">return</span>&nbsp;<span class="ident" id="2579232">StructField</span><span class="op" id="2579243">{</span><span class="op" id="2579244">}</span><span class="op" id="2579245">,</span>&nbsp;<span class="ident" id="2579247">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2579258">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579265">result</span>&nbsp;<span class="op" id="2579272">=</span>&nbsp;<span class="ident" id="2579274">t</span><span class="op" id="2579275">.</span><span class="ident" id="2579276">Field</span><span class="op" id="2579281">(</span><span class="ident" id="2579282">i</span><span class="op" id="2579283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579290">result</span><span class="op" id="2579296">.</span><span class="ident" id="2579297">Index</span>&nbsp;<span class="op" id="2579303">=</span>&nbsp;<span class="ident" id="2579305">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579314">result</span><span class="op" id="2579320">.</span><span class="ident" id="2579321">Index</span>&nbsp;<span class="op" id="2579327">=</span>&nbsp;<span class="builtinfunc" id="2579329">append</span><span class="op" id="2579335">(</span><span class="ident" id="2579336">result</span><span class="op" id="2579342">.</span><span class="ident" id="2579343">Index</span><span class="op" id="2579348">,</span>&nbsp;<span class="ident" id="2579350">scan</span><span class="op" id="2579354">.</span><span class="ident" id="2579355">index</span><span class="op" id="2579360">...</span><span class="op" id="2579363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579370">result</span><span class="op" id="2579376">.</span><span class="ident" id="2579377">Index</span>&nbsp;<span class="op" id="2579383">=</span>&nbsp;<span class="builtinfunc" id="2579385">append</span><span class="op" id="2579391">(</span><span class="ident" id="2579392">result</span><span class="op" id="2579398">.</span><span class="ident" id="2579399">Index</span><span class="op" id="2579404">,</span>&nbsp;<span class="ident" id="2579406">i</span><span class="op" id="2579407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579414">ok</span>&nbsp;<span class="op" id="2579417">=</span>&nbsp;<span class="ident" id="2579419">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579429">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2579442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2579449">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2579517">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2579587">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579645">if</span>&nbsp;<span class="ident" id="2579648">ok</span>&nbsp;<span class="op" id="2579651">||</span>&nbsp;<span class="ident" id="2579654">ntyp</span>&nbsp;<span class="op" id="2579659">==</span>&nbsp;<span class="ident" id="2579662">nil</span>&nbsp;<span class="op" id="2579666">||</span>&nbsp;<span class="ident" id="2579669">ntyp</span><span class="op" id="2579673">.</span><span class="ident" id="2579674">Kind</span><span class="op" id="2579678">(</span><span class="op" id="2579679">)</span>&nbsp;<span class="op" id="2579681">!=</span>&nbsp;<span class="ident" id="2579684">Struct</span>&nbsp;<span class="op" id="2579691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579698">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2579711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579717">styp</span>&nbsp;<span class="op" id="2579722">:=</span>&nbsp;<span class="op" id="2579725">(</span><span class="op" id="2579726">*</span><span class="ident" id="2579727">structType</span><span class="op" id="2579737">)</span><span class="op" id="2579738">(</span><span class="ident" id="2579739">unsafe</span><span class="op" id="2579745">.</span><span class="ident" id="2579746">Pointer</span><span class="op" id="2579753">(</span><span class="ident" id="2579754">ntyp</span><span class="op" id="2579758">)</span><span class="op" id="2579759">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579765">if</span>&nbsp;<span class="ident" id="2579768">nextCount</span><span class="op" id="2579777">[</span><span class="ident" id="2579778">styp</span><span class="op" id="2579782">]</span>&nbsp;<span class="op" id="2579784">&gt;</span>&nbsp;<span class="num" id="2579786">0</span>&nbsp;<span class="op" id="2579788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579795">nextCount</span><span class="op" id="2579804">[</span><span class="ident" id="2579805">styp</span><span class="op" id="2579809">]</span>&nbsp;<span class="op" id="2579811">=</span>&nbsp;<span class="num" id="2579813">2</span>&nbsp;<span class="comment" id="2579815">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579853">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2579866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579872">if</span>&nbsp;<span class="ident" id="2579875">nextCount</span>&nbsp;<span class="op" id="2579885">==</span>&nbsp;<span class="ident" id="2579888">nil</span>&nbsp;<span class="op" id="2579892">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579899">nextCount</span>&nbsp;<span class="op" id="2579909">=</span>&nbsp;<span class="keyword" id="2579911">map</span><span class="op" id="2579914">[</span><span class="op" id="2579915">*</span><span class="ident" id="2579916">structType</span><span class="op" id="2579926">]</span><span class="builtintype" id="2579927">int</span><span class="op" id="2579930">{</span><span class="op" id="2579931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2579937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579943">nextCount</span><span class="op" id="2579952">[</span><span class="ident" id="2579953">styp</span><span class="op" id="2579957">]</span>&nbsp;<span class="op" id="2579959">=</span>&nbsp;<span class="num" id="2579961">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2579967">if</span>&nbsp;<span class="ident" id="2579970">count</span><span class="op" id="2579975">[</span><span class="ident" id="2579976">t</span><span class="op" id="2579977">]</span>&nbsp;<span class="op" id="2579979">&gt;</span>&nbsp;<span class="num" id="2579981">1</span>&nbsp;<span class="op" id="2579983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2579990">nextCount</span><span class="op" id="2579999">[</span><span class="ident" id="2580000">styp</span><span class="op" id="2580004">]</span>&nbsp;<span class="op" id="2580006">=</span>&nbsp;<span class="num" id="2580008">2</span>&nbsp;<span class="comment" id="2580010">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580053">var</span>&nbsp;<span class="ident" id="2580057">index</span>&nbsp;<span class="op" id="2580063">[</span><span class="op" id="2580064">]</span><span class="builtintype" id="2580065">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2580073">index</span>&nbsp;<span class="op" id="2580079">=</span>&nbsp;<span class="builtinfunc" id="2580081">append</span><span class="op" id="2580087">(</span><span class="ident" id="2580088">index</span><span class="op" id="2580093">,</span>&nbsp;<span class="ident" id="2580095">scan</span><span class="op" id="2580099">.</span><span class="ident" id="2580100">index</span><span class="op" id="2580105">...</span><span class="op" id="2580108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2580114">index</span>&nbsp;<span class="op" id="2580120">=</span>&nbsp;<span class="builtinfunc" id="2580122">append</span><span class="op" id="2580128">(</span><span class="ident" id="2580129">index</span><span class="op" id="2580134">,</span>&nbsp;<span class="ident" id="2580136">i</span><span class="op" id="2580137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2580143">next</span>&nbsp;<span class="op" id="2580148">=</span>&nbsp;<span class="builtinfunc" id="2580150">append</span><span class="op" id="2580156">(</span><span class="ident" id="2580157">next</span><span class="op" id="2580161">,</span>&nbsp;<span class="ident" id="2580163">fieldScan</span><span class="op" id="2580172">{</span><span class="ident" id="2580173">styp</span><span class="op" id="2580177">,</span>&nbsp;<span class="ident" id="2580179">index</span><span class="op" id="2580184">}</span><span class="op" id="2580185">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580198">if</span>&nbsp;<span class="ident" id="2580201">ok</span>&nbsp;<span class="op" id="2580204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580209">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580217">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580223">return</span><br>
<span class="lineno"></span><span class="op" id="2580230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2580233">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2580293">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2580346">func</span>&nbsp;<span class="op" id="2580351">(</span><span class="ident" id="2580352">t</span>&nbsp;<span class="op" id="2580354">*</span><span class="ident" id="2580355">structType</span><span class="op" id="2580365">)</span>&nbsp;<span class="ident" id="2580367">FieldByName</span><span class="op" id="2580378">(</span><span class="ident" id="2580379">name</span>&nbsp;<span class="builtintype" id="2580384">string</span><span class="op" id="2580390">)</span>&nbsp;<span class="op" id="2580392">(</span><span class="ident" id="2580393">f</span>&nbsp;<span class="ident" id="2580395">StructField</span><span class="op" id="2580406">,</span>&nbsp;<span class="ident" id="2580408">present</span>&nbsp;<span class="builtintype" id="2580416">bool</span><span class="op" id="2580420">)</span>&nbsp;<span class="op" id="2580422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2580425">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2580497">hasAnon</span>&nbsp;<span class="op" id="2580505">:=</span>&nbsp;<span class="ident" id="2580508">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580515">if</span>&nbsp;<span class="ident" id="2580518">name</span>&nbsp;<span class="op" id="2580523">!=</span>&nbsp;<span class="string" id="2580526">&#34;&#34;</span>&nbsp;<span class="op" id="2580529">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580533">for</span>&nbsp;<span class="ident" id="2580537">i</span>&nbsp;<span class="op" id="2580539">:=</span>&nbsp;<span class="keyword" id="2580542">range</span>&nbsp;<span class="ident" id="2580548">t</span><span class="op" id="2580549">.</span><span class="ident" id="2580550">fields</span>&nbsp;<span class="op" id="2580557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2580562">tf</span>&nbsp;<span class="op" id="2580565">:=</span>&nbsp;<span class="op" id="2580568">&amp;</span><span class="ident" id="2580569">t</span><span class="op" id="2580570">.</span><span class="ident" id="2580571">fields</span><span class="op" id="2580577">[</span><span class="ident" id="2580578">i</span><span class="op" id="2580579">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580584">if</span>&nbsp;<span class="ident" id="2580587">tf</span><span class="op" id="2580589">.</span><span class="ident" id="2580590">name</span>&nbsp;<span class="op" id="2580595">==</span>&nbsp;<span class="ident" id="2580598">nil</span>&nbsp;<span class="op" id="2580602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2580608">hasAnon</span>&nbsp;<span class="op" id="2580616">=</span>&nbsp;<span class="ident" id="2580618">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580627">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580644">if</span>&nbsp;<span class="op" id="2580647">*</span><span class="ident" id="2580648">tf</span><span class="op" id="2580650">.</span><span class="ident" id="2580651">name</span>&nbsp;<span class="op" id="2580656">==</span>&nbsp;<span class="ident" id="2580659">name</span>&nbsp;<span class="op" id="2580664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580670">return</span>&nbsp;<span class="ident" id="2580677">t</span><span class="op" id="2580678">.</span><span class="ident" id="2580679">Field</span><span class="op" id="2580684">(</span><span class="ident" id="2580685">i</span><span class="op" id="2580686">)</span><span class="op" id="2580687">,</span>&nbsp;<span class="ident" id="2580689">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580701">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580707">if</span>&nbsp;<span class="op" id="2580710">!</span><span class="ident" id="2580711">hasAnon</span>&nbsp;<span class="op" id="2580719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580723">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2580731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580734">return</span>&nbsp;<span class="ident" id="2580741">t</span><span class="op" id="2580742">.</span><span class="ident" id="2580743">FieldByNameFunc</span><span class="op" id="2580758">(</span><span class="keyword" id="2580759">func</span><span class="op" id="2580763">(</span><span class="ident" id="2580764">s</span>&nbsp;<span class="builtintype" id="2580766">string</span><span class="op" id="2580772">)</span>&nbsp;<span class="builtintype" id="2580774">bool</span>&nbsp;<span class="op" id="2580779">{</span>&nbsp;<span class="keyword" id="2580781">return</span>&nbsp;<span class="ident" id="2580788">s</span>&nbsp;<span class="op" id="2580790">==</span>&nbsp;<span class="ident" id="2580793">name</span>&nbsp;<span class="op" id="2580798">}</span><span class="op" id="2580799">)</span><br>
<span class="lineno">1000</span><span class="op" id="2580801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2580804">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2580875">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2580903">func</span>&nbsp;<span class="ident" id="2580908">TypeOf</span><span class="op" id="2580914">(</span><span class="ident" id="2580915">i</span>&nbsp;<span class="keyword" id="2580917">interface</span><span class="op" id="2580926">{</span><span class="op" id="2580927">}</span><span class="op" id="2580928">)</span>&nbsp;<span class="ident" id="2580930">Type</span>&nbsp;<span class="op" id="2580935">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2580938">eface</span>&nbsp;<span class="op" id="2580944">:=</span>&nbsp;<span class="op" id="2580947">*</span><span class="op" id="2580948">(</span><span class="op" id="2580949">*</span><span class="ident" id="2580950">emptyInterface</span><span class="op" id="2580964">)</span><span class="op" id="2580965">(</span><span class="ident" id="2580966">unsafe</span><span class="op" id="2580972">.</span><span class="ident" id="2580973">Pointer</span><span class="op" id="2580980">(</span><span class="op" id="2580981">&amp;</span><span class="ident" id="2580982">i</span><span class="op" id="2580983">)</span><span class="op" id="2580984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2580987">return</span>&nbsp;<span class="ident" id="2580994">toType</span><span class="op" id="2581000">(</span><span class="ident" id="2581001">eface</span><span class="op" id="2581006">.</span><span class="ident" id="2581007">typ</span><span class="op" id="2581010">)</span><br>
<span class="lineno"></span><span class="op" id="2581012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2581015">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2581049">var</span>&nbsp;<span class="ident" id="2581053">ptrMap</span>&nbsp;<span class="keyword" id="2581060">struct</span>&nbsp;<span class="op" id="2581067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581070">sync</span><span class="op" id="2581074">.</span><span class="ident" id="2581075">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581084">m</span>&nbsp;<span class="keyword" id="2581086">map</span><span class="op" id="2581089">[</span><span class="op" id="2581090">*</span><span class="ident" id="2581091">rtype</span><span class="op" id="2581096">]</span><span class="op" id="2581097">*</span><span class="ident" id="2581098">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2581106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2581109">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2581159">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2581227">func</span>&nbsp;<span class="ident" id="2581232">PtrTo</span><span class="op" id="2581237">(</span><span class="ident" id="2581238">t</span>&nbsp;<span class="ident" id="2581240">Type</span><span class="op" id="2581244">)</span>&nbsp;<span class="ident" id="2581246">Type</span>&nbsp;<span class="op" id="2581251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581254">return</span>&nbsp;<span class="ident" id="2581261">t</span><span class="op" id="2581262">.</span><span class="op" id="2581263">(</span><span class="op" id="2581264">*</span><span class="ident" id="2581265">rtype</span><span class="op" id="2581270">)</span><span class="op" id="2581271">.</span><span class="ident" id="2581272">ptrTo</span><span class="op" id="2581277">(</span><span class="op" id="2581278">)</span><br>
<span class="lineno"></span><span class="op" id="2581280">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2581283">func</span>&nbsp;<span class="op" id="2581288">(</span><span class="ident" id="2581289">t</span>&nbsp;<span class="op" id="2581291">*</span><span class="ident" id="2581292">rtype</span><span class="op" id="2581297">)</span>&nbsp;<span class="ident" id="2581299">ptrTo</span><span class="op" id="2581304">(</span><span class="op" id="2581305">)</span>&nbsp;<span class="op" id="2581307">*</span><span class="ident" id="2581308">rtype</span>&nbsp;<span class="op" id="2581314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581317">if</span>&nbsp;<span class="ident" id="2581320">p</span>&nbsp;<span class="op" id="2581322">:=</span>&nbsp;<span class="ident" id="2581325">t</span><span class="op" id="2581326">.</span><span class="ident" id="2581327">ptrToThis</span><span class="op" id="2581336">;</span>&nbsp;<span class="ident" id="2581338">p</span>&nbsp;<span class="op" id="2581340">!=</span>&nbsp;<span class="ident" id="2581343">nil</span>&nbsp;<span class="op" id="2581347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581351">return</span>&nbsp;<span class="ident" id="2581358">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2581361">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2581365">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2581396">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2581448">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2581502">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2581561">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581606">ptrMap</span><span class="op" id="2581612">.</span><span class="ident" id="2581613">RLock</span><span class="op" id="2581618">(</span><span class="op" id="2581619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581622">if</span>&nbsp;<span class="ident" id="2581625">m</span>&nbsp;<span class="op" id="2581627">:=</span>&nbsp;<span class="ident" id="2581630">ptrMap</span><span class="op" id="2581636">.</span><span class="ident" id="2581637">m</span><span class="op" id="2581638">;</span>&nbsp;<span class="ident" id="2581640">m</span>&nbsp;<span class="op" id="2581642">!=</span>&nbsp;<span class="ident" id="2581645">nil</span>&nbsp;<span class="op" id="2581649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581653">if</span>&nbsp;<span class="ident" id="2581656">p</span>&nbsp;<span class="op" id="2581658">:=</span>&nbsp;<span class="ident" id="2581661">m</span><span class="op" id="2581662">[</span><span class="ident" id="2581663">t</span><span class="op" id="2581664">]</span><span class="op" id="2581665">;</span>&nbsp;<span class="ident" id="2581667">p</span>&nbsp;<span class="op" id="2581669">!=</span>&nbsp;<span class="ident" id="2581672">nil</span>&nbsp;<span class="op" id="2581676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581681">ptrMap</span><span class="op" id="2581687">.</span><span class="ident" id="2581688">RUnlock</span><span class="op" id="2581695">(</span><span class="op" id="2581696">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581701">return</span>&nbsp;<span class="op" id="2581708">&amp;</span><span class="ident" id="2581709">p</span><span class="op" id="2581710">.</span><span class="ident" id="2581711">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2581719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2581722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581725">ptrMap</span><span class="op" id="2581731">.</span><span class="ident" id="2581732">RUnlock</span><span class="op" id="2581739">(</span><span class="op" id="2581740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581743">ptrMap</span><span class="op" id="2581749">.</span><span class="ident" id="2581750">Lock</span><span class="op" id="2581754">(</span><span class="op" id="2581755">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581758">if</span>&nbsp;<span class="ident" id="2581761">ptrMap</span><span class="op" id="2581767">.</span><span class="ident" id="2581768">m</span>&nbsp;<span class="op" id="2581770">==</span>&nbsp;<span class="ident" id="2581773">nil</span>&nbsp;<span class="op" id="2581777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581781">ptrMap</span><span class="op" id="2581787">.</span><span class="ident" id="2581788">m</span>&nbsp;<span class="op" id="2581790">=</span>&nbsp;<span class="builtinfunc" id="2581792">make</span><span class="op" id="2581796">(</span><span class="keyword" id="2581797">map</span><span class="op" id="2581800">[</span><span class="op" id="2581801">*</span><span class="ident" id="2581802">rtype</span><span class="op" id="2581807">]</span><span class="op" id="2581808">*</span><span class="ident" id="2581809">ptrType</span><span class="op" id="2581816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2581819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581822">p</span>&nbsp;<span class="op" id="2581824">:=</span>&nbsp;<span class="ident" id="2581827">ptrMap</span><span class="op" id="2581833">.</span><span class="ident" id="2581834">m</span><span class="op" id="2581835">[</span><span class="ident" id="2581836">t</span><span class="op" id="2581837">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581840">if</span>&nbsp;<span class="ident" id="2581843">p</span>&nbsp;<span class="op" id="2581845">!=</span>&nbsp;<span class="ident" id="2581848">nil</span>&nbsp;<span class="op" id="2581852">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2581856">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2581910">ptrMap</span><span class="op" id="2581916">.</span><span class="ident" id="2581917">Unlock</span><span class="op" id="2581923">(</span><span class="op" id="2581924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2581928">return</span>&nbsp;<span class="op" id="2581935">&amp;</span><span class="ident" id="2581936">p</span><span class="op" id="2581937">.</span><span class="ident" id="2581938">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2581945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2581949">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2582004">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582031">p</span>&nbsp;<span class="op" id="2582033">=</span>&nbsp;<span class="builtinfunc" id="2582035">new</span><span class="op" id="2582038">(</span><span class="ident" id="2582039">ptrType</span><span class="op" id="2582046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2582049">var</span>&nbsp;<span class="ident" id="2582053">iptr</span>&nbsp;<span class="keyword" id="2582058">interface</span><span class="op" id="2582067">{</span><span class="op" id="2582068">}</span>&nbsp;<span class="op" id="2582070">=</span>&nbsp;<span class="op" id="2582072">(</span><span class="op" id="2582073">*</span><span class="ident" id="2582074">unsafe</span><span class="op" id="2582080">.</span><span class="ident" id="2582081">Pointer</span><span class="op" id="2582088">)</span><span class="op" id="2582089">(</span><span class="ident" id="2582090">nil</span><span class="op" id="2582093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582096">prototype</span>&nbsp;<span class="op" id="2582106">:=</span>&nbsp;<span class="op" id="2582109">*</span><span class="op" id="2582110">(</span><span class="op" id="2582111">*</span><span class="op" id="2582112">*</span><span class="ident" id="2582113">ptrType</span><span class="op" id="2582120">)</span><span class="op" id="2582121">(</span><span class="ident" id="2582122">unsafe</span><span class="op" id="2582128">.</span><span class="ident" id="2582129">Pointer</span><span class="op" id="2582136">(</span><span class="op" id="2582137">&amp;</span><span class="ident" id="2582138">iptr</span><span class="op" id="2582142">)</span><span class="op" id="2582143">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2582146">*</span><span class="ident" id="2582147">p</span>&nbsp;<span class="op" id="2582149">=</span>&nbsp;<span class="op" id="2582151">*</span><span class="ident" id="2582152">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582164">s</span>&nbsp;<span class="op" id="2582166">:=</span>&nbsp;<span class="string" id="2582169">&#34;*&#34;</span>&nbsp;<span class="op" id="2582173">+</span>&nbsp;<span class="op" id="2582175">*</span><span class="ident" id="2582176">t</span><span class="op" id="2582177">.</span><span class="builtintype" id="2582178">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582186">p</span><span class="op" id="2582187">.</span><span class="builtintype" id="2582188">string</span>&nbsp;<span class="op" id="2582195">=</span>&nbsp;<span class="op" id="2582197">&amp;</span><span class="ident" id="2582198">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2582202">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2582258">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2582307">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2582358">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2582410">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582440">p</span><span class="op" id="2582441">.</span><span class="ident" id="2582442">hash</span>&nbsp;<span class="op" id="2582447">=</span>&nbsp;<span class="ident" id="2582449">fnv1</span><span class="op" id="2582453">(</span><span class="ident" id="2582454">t</span><span class="op" id="2582455">.</span><span class="ident" id="2582456">hash</span><span class="op" id="2582460">,</span>&nbsp;<span class="string" id="2582462">&#39;*&#39;</span><span class="op" id="2582465">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582469">p</span><span class="op" id="2582470">.</span><span class="ident" id="2582471">uncommonType</span>&nbsp;<span class="op" id="2582484">=</span>&nbsp;<span class="ident" id="2582486">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582491">p</span><span class="op" id="2582492">.</span><span class="ident" id="2582493">ptrToThis</span>&nbsp;<span class="op" id="2582503">=</span>&nbsp;<span class="ident" id="2582505">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582510">p</span><span class="op" id="2582511">.</span><span class="ident" id="2582512">zero</span>&nbsp;<span class="op" id="2582517">=</span>&nbsp;<span class="ident" id="2582519">unsafe</span><span class="op" id="2582525">.</span><span class="ident" id="2582526">Pointer</span><span class="op" id="2582533">(</span><span class="op" id="2582534">&amp;</span><span class="builtinfunc" id="2582535">make</span><span class="op" id="2582539">(</span><span class="op" id="2582540">[</span><span class="op" id="2582541">]</span><span class="builtintype" id="2582542">byte</span><span class="op" id="2582546">,</span>&nbsp;<span class="ident" id="2582548">p</span><span class="op" id="2582549">.</span><span class="ident" id="2582550">size</span><span class="op" id="2582554">)</span><span class="op" id="2582555">[</span><span class="num" id="2582556">0</span><span class="op" id="2582557">]</span><span class="op" id="2582558">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582561">p</span><span class="op" id="2582562">.</span><span class="ident" id="2582563">elem</span>&nbsp;<span class="op" id="2582568">=</span>&nbsp;<span class="ident" id="2582570">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582574">ptrMap</span><span class="op" id="2582580">.</span><span class="ident" id="2582581">m</span><span class="op" id="2582582">[</span><span class="ident" id="2582583">t</span><span class="op" id="2582584">]</span>&nbsp;<span class="op" id="2582586">=</span>&nbsp;<span class="ident" id="2582588">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582591">ptrMap</span><span class="op" id="2582597">.</span><span class="ident" id="2582598">Unlock</span><span class="op" id="2582604">(</span><span class="op" id="2582605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2582608">return</span>&nbsp;<span class="op" id="2582615">&amp;</span><span class="ident" id="2582616">p</span><span class="op" id="2582617">.</span><span class="ident" id="2582618">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2582624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2582627">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2582713">func</span>&nbsp;<span class="ident" id="2582718">fnv1</span><span class="op" id="2582722">(</span><span class="ident" id="2582723">x</span>&nbsp;<span class="builtintype" id="2582725">uint32</span><span class="op" id="2582731">,</span>&nbsp;<span class="ident" id="2582733">list</span>&nbsp;<span class="op" id="2582738">...</span><span class="builtintype" id="2582741">byte</span><span class="op" id="2582745">)</span>&nbsp;<span class="builtintype" id="2582747">uint32</span>&nbsp;<span class="op" id="2582754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2582757">for</span>&nbsp;<span class="ident" id="2582761">_</span><span class="op" id="2582762">,</span>&nbsp;<span class="ident" id="2582764">b</span>&nbsp;<span class="op" id="2582766">:=</span>&nbsp;<span class="keyword" id="2582769">range</span>&nbsp;<span class="ident" id="2582775">list</span>&nbsp;<span class="op" id="2582780">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2582784">x</span>&nbsp;<span class="op" id="2582786">=</span>&nbsp;<span class="ident" id="2582788">x</span><span class="op" id="2582789">*</span><span class="num" id="2582790">16777619</span>&nbsp;<span class="op" id="2582799">^</span>&nbsp;<span class="builtintype" id="2582801">uint32</span><span class="op" id="2582807">(</span><span class="ident" id="2582808">b</span><span class="op" id="2582809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2582812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2582815">return</span>&nbsp;<span class="ident" id="2582822">x</span><br>
<span class="lineno"></span><span class="op" id="2582824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2582827">func</span>&nbsp;<span class="op" id="2582832">(</span><span class="ident" id="2582833">t</span>&nbsp;<span class="op" id="2582835">*</span><span class="ident" id="2582836">rtype</span><span class="op" id="2582841">)</span>&nbsp;<span class="ident" id="2582843">Implements</span><span class="op" id="2582853">(</span><span class="ident" id="2582854">u</span>&nbsp;<span class="ident" id="2582856">Type</span><span class="op" id="2582860">)</span>&nbsp;<span class="builtintype" id="2582862">bool</span>&nbsp;<span class="op" id="2582867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2582870">if</span>&nbsp;<span class="ident" id="2582873">u</span>&nbsp;<span class="op" id="2582875">==</span>&nbsp;<span class="ident" id="2582878">nil</span>&nbsp;<span class="op" id="2582882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2582886">panic</span><span class="op" id="2582891">(</span><span class="string" id="2582892">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2582937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2582940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2582943">if</span>&nbsp;<span class="ident" id="2582946">u</span><span class="op" id="2582947">.</span><span class="ident" id="2582948">Kind</span><span class="op" id="2582952">(</span><span class="op" id="2582953">)</span>&nbsp;<span class="op" id="2582955">!=</span>&nbsp;<span class="ident" id="2582958">Interface</span>&nbsp;<span class="op" id="2582968">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2582972">panic</span><span class="op" id="2582977">(</span><span class="string" id="2582978">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2583033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2583036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583039">return</span>&nbsp;<span class="ident" id="2583046">implements</span><span class="op" id="2583056">(</span><span class="ident" id="2583057">u</span><span class="op" id="2583058">.</span><span class="op" id="2583059">(</span><span class="op" id="2583060">*</span><span class="ident" id="2583061">rtype</span><span class="op" id="2583066">)</span><span class="op" id="2583067">,</span>&nbsp;<span class="ident" id="2583069">t</span><span class="op" id="2583070">)</span><br>
<span class="lineno"></span><span class="op" id="2583072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2583075">func</span>&nbsp;<span class="op" id="2583080">(</span><span class="ident" id="2583081">t</span>&nbsp;<span class="op" id="2583083">*</span><span class="ident" id="2583084">rtype</span><span class="op" id="2583089">)</span>&nbsp;<span class="ident" id="2583091">AssignableTo</span><span class="op" id="2583103">(</span><span class="ident" id="2583104">u</span>&nbsp;<span class="ident" id="2583106">Type</span><span class="op" id="2583110">)</span>&nbsp;<span class="builtintype" id="2583112">bool</span>&nbsp;<span class="op" id="2583117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583120">if</span>&nbsp;<span class="ident" id="2583123">u</span>&nbsp;<span class="op" id="2583125">==</span>&nbsp;<span class="ident" id="2583128">nil</span>&nbsp;<span class="op" id="2583132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2583136">panic</span><span class="op" id="2583141">(</span><span class="string" id="2583142">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2583189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2583192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2583195">uu</span>&nbsp;<span class="op" id="2583198">:=</span>&nbsp;<span class="ident" id="2583201">u</span><span class="op" id="2583202">.</span><span class="op" id="2583203">(</span><span class="op" id="2583204">*</span><span class="ident" id="2583205">rtype</span><span class="op" id="2583210">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583213">return</span>&nbsp;<span class="ident" id="2583220">directlyAssignable</span><span class="op" id="2583238">(</span><span class="ident" id="2583239">uu</span><span class="op" id="2583241">,</span>&nbsp;<span class="ident" id="2583243">t</span><span class="op" id="2583244">)</span>&nbsp;<span class="op" id="2583246">||</span>&nbsp;<span class="ident" id="2583249">implements</span><span class="op" id="2583259">(</span><span class="ident" id="2583260">uu</span><span class="op" id="2583262">,</span>&nbsp;<span class="ident" id="2583264">t</span><span class="op" id="2583265">)</span><br>
<span class="lineno"></span><span class="op" id="2583267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2583270">func</span>&nbsp;<span class="op" id="2583275">(</span><span class="ident" id="2583276">t</span>&nbsp;<span class="op" id="2583278">*</span><span class="ident" id="2583279">rtype</span><span class="op" id="2583284">)</span>&nbsp;<span class="ident" id="2583286">ConvertibleTo</span><span class="op" id="2583299">(</span><span class="ident" id="2583300">u</span>&nbsp;<span class="ident" id="2583302">Type</span><span class="op" id="2583306">)</span>&nbsp;<span class="builtintype" id="2583308">bool</span>&nbsp;<span class="op" id="2583313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583316">if</span>&nbsp;<span class="ident" id="2583319">u</span>&nbsp;<span class="op" id="2583321">==</span>&nbsp;<span class="ident" id="2583324">nil</span>&nbsp;<span class="op" id="2583328">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2583332">panic</span><span class="op" id="2583337">(</span><span class="string" id="2583338">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2583386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2583389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2583392">uu</span>&nbsp;<span class="op" id="2583395">:=</span>&nbsp;<span class="ident" id="2583398">u</span><span class="op" id="2583399">.</span><span class="op" id="2583400">(</span><span class="op" id="2583401">*</span><span class="ident" id="2583402">rtype</span><span class="op" id="2583407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583410">return</span>&nbsp;<span class="ident" id="2583417">convertOp</span><span class="op" id="2583426">(</span><span class="ident" id="2583427">uu</span><span class="op" id="2583429">,</span>&nbsp;<span class="ident" id="2583431">t</span><span class="op" id="2583432">)</span>&nbsp;<span class="op" id="2583434">!=</span>&nbsp;<span class="ident" id="2583437">nil</span><br>
<span class="lineno"></span><span class="op" id="2583441">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2583444">func</span>&nbsp;<span class="op" id="2583449">(</span><span class="ident" id="2583450">t</span>&nbsp;<span class="op" id="2583452">*</span><span class="ident" id="2583453">rtype</span><span class="op" id="2583458">)</span>&nbsp;<span class="ident" id="2583460">Comparable</span><span class="op" id="2583470">(</span><span class="op" id="2583471">)</span>&nbsp;<span class="builtintype" id="2583473">bool</span>&nbsp;<span class="op" id="2583478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583481">return</span>&nbsp;<span class="ident" id="2583488">t</span><span class="op" id="2583489">.</span><span class="ident" id="2583490">alg</span>&nbsp;<span class="op" id="2583494">!=</span>&nbsp;<span class="ident" id="2583497">nil</span>&nbsp;<span class="op" id="2583501">&amp;&amp;</span>&nbsp;<span class="ident" id="2583504">t</span><span class="op" id="2583505">.</span><span class="ident" id="2583506">alg</span><span class="op" id="2583509">.</span><span class="ident" id="2583510">equal</span>&nbsp;<span class="op" id="2583516">!=</span>&nbsp;<span class="ident" id="2583519">nil</span><br>
<span class="lineno"></span><span class="op" id="2583523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2583526">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2583600">func</span>&nbsp;<span class="ident" id="2583605">implements</span><span class="op" id="2583615">(</span><span class="ident" id="2583616">T</span><span class="op" id="2583617">,</span>&nbsp;<span class="ident" id="2583619">V</span>&nbsp;<span class="op" id="2583621">*</span><span class="ident" id="2583622">rtype</span><span class="op" id="2583627">)</span>&nbsp;<span class="builtintype" id="2583629">bool</span>&nbsp;<span class="op" id="2583634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583637">if</span>&nbsp;<span class="ident" id="2583640">T</span><span class="op" id="2583641">.</span><span class="ident" id="2583642">Kind</span><span class="op" id="2583646">(</span><span class="op" id="2583647">)</span>&nbsp;<span class="op" id="2583649">!=</span>&nbsp;<span class="ident" id="2583652">Interface</span>&nbsp;<span class="op" id="2583662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583666">return</span>&nbsp;<span class="ident" id="2583673">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2583680">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2583683">t</span>&nbsp;<span class="op" id="2583685">:=</span>&nbsp;<span class="op" id="2583688">(</span><span class="op" id="2583689">*</span><span class="ident" id="2583690">interfaceType</span><span class="op" id="2583703">)</span><span class="op" id="2583704">(</span><span class="ident" id="2583705">unsafe</span><span class="op" id="2583711">.</span><span class="ident" id="2583712">Pointer</span><span class="op" id="2583719">(</span><span class="ident" id="2583720">T</span><span class="op" id="2583721">)</span><span class="op" id="2583722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583725">if</span>&nbsp;<span class="builtinfunc" id="2583728">len</span><span class="op" id="2583731">(</span><span class="ident" id="2583732">t</span><span class="op" id="2583733">.</span><span class="ident" id="2583734">methods</span><span class="op" id="2583741">)</span>&nbsp;<span class="op" id="2583743">==</span>&nbsp;<span class="num" id="2583746">0</span>&nbsp;<span class="op" id="2583748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2583752">return</span>&nbsp;<span class="ident" id="2583759">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2583765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2583769">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2583823">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2583883">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2583929">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2583991">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2584049">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2584109">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2584170">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2584227">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2584286">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2584350">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2584404">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584437">if</span>&nbsp;<span class="ident" id="2584440">V</span><span class="op" id="2584441">.</span><span class="ident" id="2584442">Kind</span><span class="op" id="2584446">(</span><span class="op" id="2584447">)</span>&nbsp;<span class="op" id="2584449">==</span>&nbsp;<span class="ident" id="2584452">Interface</span>&nbsp;<span class="op" id="2584462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584466">v</span>&nbsp;<span class="op" id="2584468">:=</span>&nbsp;<span class="op" id="2584471">(</span><span class="op" id="2584472">*</span><span class="ident" id="2584473">interfaceType</span><span class="op" id="2584486">)</span><span class="op" id="2584487">(</span><span class="ident" id="2584488">unsafe</span><span class="op" id="2584494">.</span><span class="ident" id="2584495">Pointer</span><span class="op" id="2584502">(</span><span class="ident" id="2584503">V</span><span class="op" id="2584504">)</span><span class="op" id="2584505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584509">i</span>&nbsp;<span class="op" id="2584511">:=</span>&nbsp;<span class="num" id="2584514">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584518">for</span>&nbsp;<span class="ident" id="2584522">j</span>&nbsp;<span class="op" id="2584524">:=</span>&nbsp;<span class="num" id="2584527">0</span><span class="op" id="2584528">;</span>&nbsp;<span class="ident" id="2584530">j</span>&nbsp;<span class="op" id="2584532">&lt;</span>&nbsp;<span class="builtinfunc" id="2584534">len</span><span class="op" id="2584537">(</span><span class="ident" id="2584538">v</span><span class="op" id="2584539">.</span><span class="ident" id="2584540">methods</span><span class="op" id="2584547">)</span><span class="op" id="2584548">;</span>&nbsp;<span class="ident" id="2584550">j</span><span class="op" id="2584551">++</span>&nbsp;<span class="op" id="2584554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584559">tm</span>&nbsp;<span class="op" id="2584562">:=</span>&nbsp;<span class="op" id="2584565">&amp;</span><span class="ident" id="2584566">t</span><span class="op" id="2584567">.</span><span class="ident" id="2584568">methods</span><span class="op" id="2584575">[</span><span class="ident" id="2584576">i</span><span class="op" id="2584577">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584582">vm</span>&nbsp;<span class="op" id="2584585">:=</span>&nbsp;<span class="op" id="2584588">&amp;</span><span class="ident" id="2584589">v</span><span class="op" id="2584590">.</span><span class="ident" id="2584591">methods</span><span class="op" id="2584598">[</span><span class="ident" id="2584599">j</span><span class="op" id="2584600">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584605">if</span>&nbsp;<span class="ident" id="2584608">vm</span><span class="op" id="2584610">.</span><span class="ident" id="2584611">name</span>&nbsp;<span class="op" id="2584616">==</span>&nbsp;<span class="ident" id="2584619">tm</span><span class="op" id="2584621">.</span><span class="ident" id="2584622">name</span>&nbsp;<span class="op" id="2584627">&amp;&amp;</span>&nbsp;<span class="ident" id="2584630">vm</span><span class="op" id="2584632">.</span><span class="ident" id="2584633">pkgPath</span>&nbsp;<span class="op" id="2584641">==</span>&nbsp;<span class="ident" id="2584644">tm</span><span class="op" id="2584646">.</span><span class="ident" id="2584647">pkgPath</span>&nbsp;<span class="op" id="2584655">&amp;&amp;</span>&nbsp;<span class="ident" id="2584658">vm</span><span class="op" id="2584660">.</span><span class="ident" id="2584661">typ</span>&nbsp;<span class="op" id="2584665">==</span>&nbsp;<span class="ident" id="2584668">tm</span><span class="op" id="2584670">.</span><span class="ident" id="2584671">typ</span>&nbsp;<span class="op" id="2584675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584681">if</span>&nbsp;<span class="ident" id="2584684">i</span><span class="op" id="2584685">++</span><span class="op" id="2584687">;</span>&nbsp;<span class="ident" id="2584689">i</span>&nbsp;<span class="op" id="2584691">&gt;=</span>&nbsp;<span class="builtinfunc" id="2584694">len</span><span class="op" id="2584697">(</span><span class="ident" id="2584698">t</span><span class="op" id="2584699">.</span><span class="ident" id="2584700">methods</span><span class="op" id="2584707">)</span>&nbsp;<span class="op" id="2584709">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584716">return</span>&nbsp;<span class="ident" id="2584723">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2584732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2584737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2584741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584745">return</span>&nbsp;<span class="ident" id="2584752">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2584759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584763">v</span>&nbsp;<span class="op" id="2584765">:=</span>&nbsp;<span class="ident" id="2584768">V</span><span class="op" id="2584769">.</span><span class="ident" id="2584770">uncommon</span><span class="op" id="2584778">(</span><span class="op" id="2584779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584782">if</span>&nbsp;<span class="ident" id="2584785">v</span>&nbsp;<span class="op" id="2584787">==</span>&nbsp;<span class="ident" id="2584790">nil</span>&nbsp;<span class="op" id="2584794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584798">return</span>&nbsp;<span class="ident" id="2584805">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2584812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584815">i</span>&nbsp;<span class="op" id="2584817">:=</span>&nbsp;<span class="num" id="2584820">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584823">for</span>&nbsp;<span class="ident" id="2584827">j</span>&nbsp;<span class="op" id="2584829">:=</span>&nbsp;<span class="num" id="2584832">0</span><span class="op" id="2584833">;</span>&nbsp;<span class="ident" id="2584835">j</span>&nbsp;<span class="op" id="2584837">&lt;</span>&nbsp;<span class="builtinfunc" id="2584839">len</span><span class="op" id="2584842">(</span><span class="ident" id="2584843">v</span><span class="op" id="2584844">.</span><span class="ident" id="2584845">methods</span><span class="op" id="2584852">)</span><span class="op" id="2584853">;</span>&nbsp;<span class="ident" id="2584855">j</span><span class="op" id="2584856">++</span>&nbsp;<span class="op" id="2584859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584863">tm</span>&nbsp;<span class="op" id="2584866">:=</span>&nbsp;<span class="op" id="2584869">&amp;</span><span class="ident" id="2584870">t</span><span class="op" id="2584871">.</span><span class="ident" id="2584872">methods</span><span class="op" id="2584879">[</span><span class="ident" id="2584880">i</span><span class="op" id="2584881">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2584885">vm</span>&nbsp;<span class="op" id="2584888">:=</span>&nbsp;<span class="op" id="2584891">&amp;</span><span class="ident" id="2584892">v</span><span class="op" id="2584893">.</span><span class="ident" id="2584894">methods</span><span class="op" id="2584901">[</span><span class="ident" id="2584902">j</span><span class="op" id="2584903">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584907">if</span>&nbsp;<span class="ident" id="2584910">vm</span><span class="op" id="2584912">.</span><span class="ident" id="2584913">name</span>&nbsp;<span class="op" id="2584918">==</span>&nbsp;<span class="ident" id="2584921">tm</span><span class="op" id="2584923">.</span><span class="ident" id="2584924">name</span>&nbsp;<span class="op" id="2584929">&amp;&amp;</span>&nbsp;<span class="ident" id="2584932">vm</span><span class="op" id="2584934">.</span><span class="ident" id="2584935">pkgPath</span>&nbsp;<span class="op" id="2584943">==</span>&nbsp;<span class="ident" id="2584946">tm</span><span class="op" id="2584948">.</span><span class="ident" id="2584949">pkgPath</span>&nbsp;<span class="op" id="2584957">&amp;&amp;</span>&nbsp;<span class="ident" id="2584960">vm</span><span class="op" id="2584962">.</span><span class="ident" id="2584963">mtyp</span>&nbsp;<span class="op" id="2584968">==</span>&nbsp;<span class="ident" id="2584971">tm</span><span class="op" id="2584973">.</span><span class="ident" id="2584974">typ</span>&nbsp;<span class="op" id="2584978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2584983">if</span>&nbsp;<span class="ident" id="2584986">i</span><span class="op" id="2584987">++</span><span class="op" id="2584989">;</span>&nbsp;<span class="ident" id="2584991">i</span>&nbsp;<span class="op" id="2584993">&gt;=</span>&nbsp;<span class="builtinfunc" id="2584996">len</span><span class="op" id="2584999">(</span><span class="ident" id="2585000">t</span><span class="op" id="2585001">.</span><span class="ident" id="2585002">methods</span><span class="op" id="2585009">)</span>&nbsp;<span class="op" id="2585011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585017">return</span>&nbsp;<span class="ident" id="2585024">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2585032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2585036">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2585039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585042">return</span>&nbsp;<span class="ident" id="2585049">false</span><br>
<span class="lineno"></span><span class="op" id="2585055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2585058">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2585132">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2585182">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2585234">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2585290">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2585356">func</span>&nbsp;<span class="ident" id="2585361">directlyAssignable</span><span class="op" id="2585379">(</span><span class="ident" id="2585380">T</span><span class="op" id="2585381">,</span>&nbsp;<span class="ident" id="2585383">V</span>&nbsp;<span class="op" id="2585385">*</span><span class="ident" id="2585386">rtype</span><span class="op" id="2585391">)</span>&nbsp;<span class="builtintype" id="2585393">bool</span>&nbsp;<span class="op" id="2585398">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2585401">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585435">if</span>&nbsp;<span class="ident" id="2585438">T</span>&nbsp;<span class="op" id="2585440">==</span>&nbsp;<span class="ident" id="2585443">V</span>&nbsp;<span class="op" id="2585445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585449">return</span>&nbsp;<span class="ident" id="2585456">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2585462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2585466">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2585520">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585558">if</span>&nbsp;<span class="ident" id="2585561">T</span><span class="op" id="2585562">.</span><span class="ident" id="2585563">Name</span><span class="op" id="2585567">(</span><span class="op" id="2585568">)</span>&nbsp;<span class="op" id="2585570">!=</span>&nbsp;<span class="string" id="2585573">&#34;&#34;</span>&nbsp;<span class="op" id="2585576">&amp;&amp;</span>&nbsp;<span class="ident" id="2585579">V</span><span class="op" id="2585580">.</span><span class="ident" id="2585581">Name</span><span class="op" id="2585585">(</span><span class="op" id="2585586">)</span>&nbsp;<span class="op" id="2585588">!=</span>&nbsp;<span class="string" id="2585591">&#34;&#34;</span>&nbsp;<span class="op" id="2585594">||</span>&nbsp;<span class="ident" id="2585597">T</span><span class="op" id="2585598">.</span><span class="ident" id="2585599">Kind</span><span class="op" id="2585603">(</span><span class="op" id="2585604">)</span>&nbsp;<span class="op" id="2585606">!=</span>&nbsp;<span class="ident" id="2585609">V</span><span class="op" id="2585610">.</span><span class="ident" id="2585611">Kind</span><span class="op" id="2585615">(</span><span class="op" id="2585616">)</span>&nbsp;<span class="op" id="2585618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585622">return</span>&nbsp;<span class="ident" id="2585629">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2585636">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2585640">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585700">return</span>&nbsp;<span class="ident" id="2585707">haveIdenticalUnderlyingType</span><span class="op" id="2585734">(</span><span class="ident" id="2585735">T</span><span class="op" id="2585736">,</span>&nbsp;<span class="ident" id="2585738">V</span><span class="op" id="2585739">)</span><br>
<span class="lineno"></span><span class="op" id="2585741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2585744">func</span>&nbsp;<span class="ident" id="2585749">haveIdenticalUnderlyingType</span><span class="op" id="2585776">(</span><span class="ident" id="2585777">T</span><span class="op" id="2585778">,</span>&nbsp;<span class="ident" id="2585780">V</span>&nbsp;<span class="op" id="2585782">*</span><span class="ident" id="2585783">rtype</span><span class="op" id="2585788">)</span>&nbsp;<span class="builtintype" id="2585790">bool</span>&nbsp;<span class="op" id="2585795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585798">if</span>&nbsp;<span class="ident" id="2585801">T</span>&nbsp;<span class="op" id="2585803">==</span>&nbsp;<span class="ident" id="2585806">V</span>&nbsp;<span class="op" id="2585808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585812">return</span>&nbsp;<span class="ident" id="2585819">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2585825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2585829">kind</span>&nbsp;<span class="op" id="2585834">:=</span>&nbsp;<span class="ident" id="2585837">T</span><span class="op" id="2585838">.</span><span class="ident" id="2585839">Kind</span><span class="op" id="2585843">(</span><span class="op" id="2585844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585847">if</span>&nbsp;<span class="ident" id="2585850">kind</span>&nbsp;<span class="op" id="2585855">!=</span>&nbsp;<span class="ident" id="2585858">V</span><span class="op" id="2585859">.</span><span class="ident" id="2585860">Kind</span><span class="op" id="2585864">(</span><span class="op" id="2585865">)</span>&nbsp;<span class="op" id="2585867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585871">return</span>&nbsp;<span class="ident" id="2585878">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2585885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2585889">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2585953">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2585996">if</span>&nbsp;<span class="ident" id="2585999">Bool</span>&nbsp;<span class="op" id="2586004">&lt;=</span>&nbsp;<span class="ident" id="2586007">kind</span>&nbsp;<span class="op" id="2586012">&amp;&amp;</span>&nbsp;<span class="ident" id="2586015">kind</span>&nbsp;<span class="op" id="2586020">&lt;=</span>&nbsp;<span class="ident" id="2586023">Complex128</span>&nbsp;<span class="op" id="2586034">||</span>&nbsp;<span class="ident" id="2586037">kind</span>&nbsp;<span class="op" id="2586042">==</span>&nbsp;<span class="ident" id="2586045">String</span>&nbsp;<span class="op" id="2586052">||</span>&nbsp;<span class="ident" id="2586055">kind</span>&nbsp;<span class="op" id="2586060">==</span>&nbsp;<span class="ident" id="2586063">UnsafePointer</span>&nbsp;<span class="op" id="2586077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586081">return</span>&nbsp;<span class="ident" id="2586088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2586094">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2586098">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586119">switch</span>&nbsp;<span class="ident" id="2586126">kind</span>&nbsp;<span class="op" id="2586131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586134">case</span>&nbsp;<span class="ident" id="2586139">Array</span><span class="op" id="2586144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586148">return</span>&nbsp;<span class="ident" id="2586155">T</span><span class="op" id="2586156">.</span><span class="ident" id="2586157">Elem</span><span class="op" id="2586161">(</span><span class="op" id="2586162">)</span>&nbsp;<span class="op" id="2586164">==</span>&nbsp;<span class="ident" id="2586167">V</span><span class="op" id="2586168">.</span><span class="ident" id="2586169">Elem</span><span class="op" id="2586173">(</span><span class="op" id="2586174">)</span>&nbsp;<span class="op" id="2586176">&amp;&amp;</span>&nbsp;<span class="ident" id="2586179">T</span><span class="op" id="2586180">.</span><span class="ident" id="2586181">Len</span><span class="op" id="2586184">(</span><span class="op" id="2586185">)</span>&nbsp;<span class="op" id="2586187">==</span>&nbsp;<span class="ident" id="2586190">V</span><span class="op" id="2586191">.</span><span class="ident" id="2586192">Len</span><span class="op" id="2586195">(</span><span class="op" id="2586196">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586200">case</span>&nbsp;<span class="ident" id="2586205">Chan</span><span class="op" id="2586209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2586213">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2586232">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2586294">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586350">if</span>&nbsp;<span class="ident" id="2586353">V</span><span class="op" id="2586354">.</span><span class="ident" id="2586355">ChanDir</span><span class="op" id="2586362">(</span><span class="op" id="2586363">)</span>&nbsp;<span class="op" id="2586365">==</span>&nbsp;<span class="ident" id="2586368">BothDir</span>&nbsp;<span class="op" id="2586376">&amp;&amp;</span>&nbsp;<span class="ident" id="2586379">T</span><span class="op" id="2586380">.</span><span class="ident" id="2586381">Elem</span><span class="op" id="2586385">(</span><span class="op" id="2586386">)</span>&nbsp;<span class="op" id="2586388">==</span>&nbsp;<span class="ident" id="2586391">V</span><span class="op" id="2586392">.</span><span class="ident" id="2586393">Elem</span><span class="op" id="2586397">(</span><span class="op" id="2586398">)</span>&nbsp;<span class="op" id="2586400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586405">return</span>&nbsp;<span class="ident" id="2586412">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2586419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2586424">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586484">return</span>&nbsp;<span class="ident" id="2586491">V</span><span class="op" id="2586492">.</span><span class="ident" id="2586493">ChanDir</span><span class="op" id="2586500">(</span><span class="op" id="2586501">)</span>&nbsp;<span class="op" id="2586503">==</span>&nbsp;<span class="ident" id="2586506">T</span><span class="op" id="2586507">.</span><span class="ident" id="2586508">ChanDir</span><span class="op" id="2586515">(</span><span class="op" id="2586516">)</span>&nbsp;<span class="op" id="2586518">&amp;&amp;</span>&nbsp;<span class="ident" id="2586521">T</span><span class="op" id="2586522">.</span><span class="ident" id="2586523">Elem</span><span class="op" id="2586527">(</span><span class="op" id="2586528">)</span>&nbsp;<span class="op" id="2586530">==</span>&nbsp;<span class="ident" id="2586533">V</span><span class="op" id="2586534">.</span><span class="ident" id="2586535">Elem</span><span class="op" id="2586539">(</span><span class="op" id="2586540">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586544">case</span>&nbsp;<span class="ident" id="2586549">Func</span><span class="op" id="2586553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2586557">t</span>&nbsp;<span class="op" id="2586559">:=</span>&nbsp;<span class="op" id="2586562">(</span><span class="op" id="2586563">*</span><span class="ident" id="2586564">funcType</span><span class="op" id="2586572">)</span><span class="op" id="2586573">(</span><span class="ident" id="2586574">unsafe</span><span class="op" id="2586580">.</span><span class="ident" id="2586581">Pointer</span><span class="op" id="2586588">(</span><span class="ident" id="2586589">T</span><span class="op" id="2586590">)</span><span class="op" id="2586591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2586595">v</span>&nbsp;<span class="op" id="2586597">:=</span>&nbsp;<span class="op" id="2586600">(</span><span class="op" id="2586601">*</span><span class="ident" id="2586602">funcType</span><span class="op" id="2586610">)</span><span class="op" id="2586611">(</span><span class="ident" id="2586612">unsafe</span><span class="op" id="2586618">.</span><span class="ident" id="2586619">Pointer</span><span class="op" id="2586626">(</span><span class="ident" id="2586627">V</span><span class="op" id="2586628">)</span><span class="op" id="2586629">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586633">if</span>&nbsp;<span class="ident" id="2586636">t</span><span class="op" id="2586637">.</span><span class="ident" id="2586638">dotdotdot</span>&nbsp;<span class="op" id="2586648">!=</span>&nbsp;<span class="ident" id="2586651">v</span><span class="op" id="2586652">.</span><span class="ident" id="2586653">dotdotdot</span>&nbsp;<span class="op" id="2586663">||</span>&nbsp;<span class="builtinfunc" id="2586666">len</span><span class="op" id="2586669">(</span><span class="ident" id="2586670">t</span><span class="op" id="2586671">.</span><span class="ident" id="2586672">in</span><span class="op" id="2586674">)</span>&nbsp;<span class="op" id="2586676">!=</span>&nbsp;<span class="builtinfunc" id="2586679">len</span><span class="op" id="2586682">(</span><span class="ident" id="2586683">v</span><span class="op" id="2586684">.</span><span class="ident" id="2586685">in</span><span class="op" id="2586687">)</span>&nbsp;<span class="op" id="2586689">||</span>&nbsp;<span class="builtinfunc" id="2586692">len</span><span class="op" id="2586695">(</span><span class="ident" id="2586696">t</span><span class="op" id="2586697">.</span><span class="ident" id="2586698">out</span><span class="op" id="2586701">)</span>&nbsp;<span class="op" id="2586703">!=</span>&nbsp;<span class="builtinfunc" id="2586706">len</span><span class="op" id="2586709">(</span><span class="ident" id="2586710">v</span><span class="op" id="2586711">.</span><span class="ident" id="2586712">out</span><span class="op" id="2586715">)</span>&nbsp;<span class="op" id="2586717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586722">return</span>&nbsp;<span class="ident" id="2586729">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2586737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586741">for</span>&nbsp;<span class="ident" id="2586745">i</span><span class="op" id="2586746">,</span>&nbsp;<span class="ident" id="2586748">typ</span>&nbsp;<span class="op" id="2586752">:=</span>&nbsp;<span class="keyword" id="2586755">range</span>&nbsp;<span class="ident" id="2586761">t</span><span class="op" id="2586762">.</span><span class="ident" id="2586763">in</span>&nbsp;<span class="op" id="2586766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586771">if</span>&nbsp;<span class="ident" id="2586774">typ</span>&nbsp;<span class="op" id="2586778">!=</span>&nbsp;<span class="ident" id="2586781">v</span><span class="op" id="2586782">.</span><span class="ident" id="2586783">in</span><span class="op" id="2586785">[</span><span class="ident" id="2586786">i</span><span class="op" id="2586787">]</span>&nbsp;<span class="op" id="2586789">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586795">return</span>&nbsp;<span class="ident" id="2586802">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2586811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2586815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586819">for</span>&nbsp;<span class="ident" id="2586823">i</span><span class="op" id="2586824">,</span>&nbsp;<span class="ident" id="2586826">typ</span>&nbsp;<span class="op" id="2586830">:=</span>&nbsp;<span class="keyword" id="2586833">range</span>&nbsp;<span class="ident" id="2586839">t</span><span class="op" id="2586840">.</span><span class="ident" id="2586841">out</span>&nbsp;<span class="op" id="2586845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586850">if</span>&nbsp;<span class="ident" id="2586853">typ</span>&nbsp;<span class="op" id="2586857">!=</span>&nbsp;<span class="ident" id="2586860">v</span><span class="op" id="2586861">.</span><span class="ident" id="2586862">out</span><span class="op" id="2586865">[</span><span class="ident" id="2586866">i</span><span class="op" id="2586867">]</span>&nbsp;<span class="op" id="2586869">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586875">return</span>&nbsp;<span class="ident" id="2586882">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2586891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2586895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586899">return</span>&nbsp;<span class="ident" id="2586906">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2586913">case</span>&nbsp;<span class="ident" id="2586918">Interface</span><span class="op" id="2586927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2586931">t</span>&nbsp;<span class="op" id="2586933">:=</span>&nbsp;<span class="op" id="2586936">(</span><span class="op" id="2586937">*</span><span class="ident" id="2586938">interfaceType</span><span class="op" id="2586951">)</span><span class="op" id="2586952">(</span><span class="ident" id="2586953">unsafe</span><span class="op" id="2586959">.</span><span class="ident" id="2586960">Pointer</span><span class="op" id="2586967">(</span><span class="ident" id="2586968">T</span><span class="op" id="2586969">)</span><span class="op" id="2586970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2586974">v</span>&nbsp;<span class="op" id="2586976">:=</span>&nbsp;<span class="op" id="2586979">(</span><span class="op" id="2586980">*</span><span class="ident" id="2586981">interfaceType</span><span class="op" id="2586994">)</span><span class="op" id="2586995">(</span><span class="ident" id="2586996">unsafe</span><span class="op" id="2587002">.</span><span class="ident" id="2587003">Pointer</span><span class="op" id="2587010">(</span><span class="ident" id="2587011">V</span><span class="op" id="2587012">)</span><span class="op" id="2587013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587017">if</span>&nbsp;<span class="builtinfunc" id="2587020">len</span><span class="op" id="2587023">(</span><span class="ident" id="2587024">t</span><span class="op" id="2587025">.</span><span class="ident" id="2587026">methods</span><span class="op" id="2587033">)</span>&nbsp;<span class="op" id="2587035">==</span>&nbsp;<span class="num" id="2587038">0</span>&nbsp;<span class="op" id="2587040">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2587043">len</span><span class="op" id="2587046">(</span><span class="ident" id="2587047">v</span><span class="op" id="2587048">.</span><span class="ident" id="2587049">methods</span><span class="op" id="2587056">)</span>&nbsp;<span class="op" id="2587058">==</span>&nbsp;<span class="num" id="2587061">0</span>&nbsp;<span class="op" id="2587063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587068">return</span>&nbsp;<span class="ident" id="2587075">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2587086">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2587129">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587162">return</span>&nbsp;<span class="ident" id="2587169">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587177">case</span>&nbsp;<span class="ident" id="2587182">Map</span><span class="op" id="2587185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587189">return</span>&nbsp;<span class="ident" id="2587196">T</span><span class="op" id="2587197">.</span><span class="ident" id="2587198">Key</span><span class="op" id="2587201">(</span><span class="op" id="2587202">)</span>&nbsp;<span class="op" id="2587204">==</span>&nbsp;<span class="ident" id="2587207">V</span><span class="op" id="2587208">.</span><span class="ident" id="2587209">Key</span><span class="op" id="2587212">(</span><span class="op" id="2587213">)</span>&nbsp;<span class="op" id="2587215">&amp;&amp;</span>&nbsp;<span class="ident" id="2587218">T</span><span class="op" id="2587219">.</span><span class="ident" id="2587220">Elem</span><span class="op" id="2587224">(</span><span class="op" id="2587225">)</span>&nbsp;<span class="op" id="2587227">==</span>&nbsp;<span class="ident" id="2587230">V</span><span class="op" id="2587231">.</span><span class="ident" id="2587232">Elem</span><span class="op" id="2587236">(</span><span class="op" id="2587237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587241">case</span>&nbsp;<span class="ident" id="2587246">Ptr</span><span class="op" id="2587249">,</span>&nbsp;<span class="ident" id="2587251">Slice</span><span class="op" id="2587256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587260">return</span>&nbsp;<span class="ident" id="2587267">T</span><span class="op" id="2587268">.</span><span class="ident" id="2587269">Elem</span><span class="op" id="2587273">(</span><span class="op" id="2587274">)</span>&nbsp;<span class="op" id="2587276">==</span>&nbsp;<span class="ident" id="2587279">V</span><span class="op" id="2587280">.</span><span class="ident" id="2587281">Elem</span><span class="op" id="2587285">(</span><span class="op" id="2587286">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587290">case</span>&nbsp;<span class="ident" id="2587295">Struct</span><span class="op" id="2587301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2587305">t</span>&nbsp;<span class="op" id="2587307">:=</span>&nbsp;<span class="op" id="2587310">(</span><span class="op" id="2587311">*</span><span class="ident" id="2587312">structType</span><span class="op" id="2587322">)</span><span class="op" id="2587323">(</span><span class="ident" id="2587324">unsafe</span><span class="op" id="2587330">.</span><span class="ident" id="2587331">Pointer</span><span class="op" id="2587338">(</span><span class="ident" id="2587339">T</span><span class="op" id="2587340">)</span><span class="op" id="2587341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2587345">v</span>&nbsp;<span class="op" id="2587347">:=</span>&nbsp;<span class="op" id="2587350">(</span><span class="op" id="2587351">*</span><span class="ident" id="2587352">structType</span><span class="op" id="2587362">)</span><span class="op" id="2587363">(</span><span class="ident" id="2587364">unsafe</span><span class="op" id="2587370">.</span><span class="ident" id="2587371">Pointer</span><span class="op" id="2587378">(</span><span class="ident" id="2587379">V</span><span class="op" id="2587380">)</span><span class="op" id="2587381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587385">if</span>&nbsp;<span class="builtinfunc" id="2587388">len</span><span class="op" id="2587391">(</span><span class="ident" id="2587392">t</span><span class="op" id="2587393">.</span><span class="ident" id="2587394">fields</span><span class="op" id="2587400">)</span>&nbsp;<span class="op" id="2587402">!=</span>&nbsp;<span class="builtinfunc" id="2587405">len</span><span class="op" id="2587408">(</span><span class="ident" id="2587409">v</span><span class="op" id="2587410">.</span><span class="ident" id="2587411">fields</span><span class="op" id="2587417">)</span>&nbsp;<span class="op" id="2587419">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587424">return</span>&nbsp;<span class="ident" id="2587431">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587443">for</span>&nbsp;<span class="ident" id="2587447">i</span>&nbsp;<span class="op" id="2587449">:=</span>&nbsp;<span class="keyword" id="2587452">range</span>&nbsp;<span class="ident" id="2587458">t</span><span class="op" id="2587459">.</span><span class="ident" id="2587460">fields</span>&nbsp;<span class="op" id="2587467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2587472">tf</span>&nbsp;<span class="op" id="2587475">:=</span>&nbsp;<span class="op" id="2587478">&amp;</span><span class="ident" id="2587479">t</span><span class="op" id="2587480">.</span><span class="ident" id="2587481">fields</span><span class="op" id="2587487">[</span><span class="ident" id="2587488">i</span><span class="op" id="2587489">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2587494">vf</span>&nbsp;<span class="op" id="2587497">:=</span>&nbsp;<span class="op" id="2587500">&amp;</span><span class="ident" id="2587501">v</span><span class="op" id="2587502">.</span><span class="ident" id="2587503">fields</span><span class="op" id="2587509">[</span><span class="ident" id="2587510">i</span><span class="op" id="2587511">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587516">if</span>&nbsp;<span class="ident" id="2587519">tf</span><span class="op" id="2587521">.</span><span class="ident" id="2587522">name</span>&nbsp;<span class="op" id="2587527">!=</span>&nbsp;<span class="ident" id="2587530">vf</span><span class="op" id="2587532">.</span><span class="ident" id="2587533">name</span>&nbsp;<span class="op" id="2587538">&amp;&amp;</span>&nbsp;<span class="op" id="2587541">(</span><span class="ident" id="2587542">tf</span><span class="op" id="2587544">.</span><span class="ident" id="2587545">name</span>&nbsp;<span class="op" id="2587550">==</span>&nbsp;<span class="ident" id="2587553">nil</span>&nbsp;<span class="op" id="2587557">||</span>&nbsp;<span class="ident" id="2587560">vf</span><span class="op" id="2587562">.</span><span class="ident" id="2587563">name</span>&nbsp;<span class="op" id="2587568">==</span>&nbsp;<span class="ident" id="2587571">nil</span>&nbsp;<span class="op" id="2587575">||</span>&nbsp;<span class="op" id="2587578">*</span><span class="ident" id="2587579">tf</span><span class="op" id="2587581">.</span><span class="ident" id="2587582">name</span>&nbsp;<span class="op" id="2587587">!=</span>&nbsp;<span class="op" id="2587590">*</span><span class="ident" id="2587591">vf</span><span class="op" id="2587593">.</span><span class="ident" id="2587594">name</span><span class="op" id="2587598">)</span>&nbsp;<span class="op" id="2587600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587606">return</span>&nbsp;<span class="ident" id="2587613">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587627">if</span>&nbsp;<span class="ident" id="2587630">tf</span><span class="op" id="2587632">.</span><span class="ident" id="2587633">pkgPath</span>&nbsp;<span class="op" id="2587641">!=</span>&nbsp;<span class="ident" id="2587644">vf</span><span class="op" id="2587646">.</span><span class="ident" id="2587647">pkgPath</span>&nbsp;<span class="op" id="2587655">&amp;&amp;</span>&nbsp;<span class="op" id="2587658">(</span><span class="ident" id="2587659">tf</span><span class="op" id="2587661">.</span><span class="ident" id="2587662">pkgPath</span>&nbsp;<span class="op" id="2587670">==</span>&nbsp;<span class="ident" id="2587673">nil</span>&nbsp;<span class="op" id="2587677">||</span>&nbsp;<span class="ident" id="2587680">vf</span><span class="op" id="2587682">.</span><span class="ident" id="2587683">pkgPath</span>&nbsp;<span class="op" id="2587691">==</span>&nbsp;<span class="ident" id="2587694">nil</span>&nbsp;<span class="op" id="2587698">||</span>&nbsp;<span class="op" id="2587701">*</span><span class="ident" id="2587702">tf</span><span class="op" id="2587704">.</span><span class="ident" id="2587705">pkgPath</span>&nbsp;<span class="op" id="2587713">!=</span>&nbsp;<span class="op" id="2587716">*</span><span class="ident" id="2587717">vf</span><span class="op" id="2587719">.</span><span class="ident" id="2587720">pkgPath</span><span class="op" id="2587727">)</span>&nbsp;<span class="op" id="2587729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587735">return</span>&nbsp;<span class="ident" id="2587742">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587756">if</span>&nbsp;<span class="ident" id="2587759">tf</span><span class="op" id="2587761">.</span><span class="ident" id="2587762">typ</span>&nbsp;<span class="op" id="2587766">!=</span>&nbsp;<span class="ident" id="2587769">vf</span><span class="op" id="2587771">.</span><span class="ident" id="2587772">typ</span>&nbsp;<span class="op" id="2587776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587782">return</span>&nbsp;<span class="ident" id="2587789">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587803">if</span>&nbsp;<span class="ident" id="2587806">tf</span><span class="op" id="2587808">.</span><span class="ident" id="2587809">tag</span>&nbsp;<span class="op" id="2587813">!=</span>&nbsp;<span class="ident" id="2587816">vf</span><span class="op" id="2587818">.</span><span class="ident" id="2587819">tag</span>&nbsp;<span class="op" id="2587823">&amp;&amp;</span>&nbsp;<span class="op" id="2587826">(</span><span class="ident" id="2587827">tf</span><span class="op" id="2587829">.</span><span class="ident" id="2587830">tag</span>&nbsp;<span class="op" id="2587834">==</span>&nbsp;<span class="ident" id="2587837">nil</span>&nbsp;<span class="op" id="2587841">||</span>&nbsp;<span class="ident" id="2587844">vf</span><span class="op" id="2587846">.</span><span class="ident" id="2587847">tag</span>&nbsp;<span class="op" id="2587851">==</span>&nbsp;<span class="ident" id="2587854">nil</span>&nbsp;<span class="op" id="2587858">||</span>&nbsp;<span class="op" id="2587861">*</span><span class="ident" id="2587862">tf</span><span class="op" id="2587864">.</span><span class="ident" id="2587865">tag</span>&nbsp;<span class="op" id="2587869">!=</span>&nbsp;<span class="op" id="2587872">*</span><span class="ident" id="2587873">vf</span><span class="op" id="2587875">.</span><span class="ident" id="2587876">tag</span><span class="op" id="2587879">)</span>&nbsp;<span class="op" id="2587881">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587887">return</span>&nbsp;<span class="ident" id="2587894">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587908">if</span>&nbsp;<span class="ident" id="2587911">tf</span><span class="op" id="2587913">.</span><span class="ident" id="2587914">offset</span>&nbsp;<span class="op" id="2587921">!=</span>&nbsp;<span class="ident" id="2587924">vf</span><span class="op" id="2587926">.</span><span class="ident" id="2587927">offset</span>&nbsp;<span class="op" id="2587934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587940">return</span>&nbsp;<span class="ident" id="2587947">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587956">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587964">return</span>&nbsp;<span class="ident" id="2587971">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2587977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2587981">return</span>&nbsp;<span class="ident" id="2587988">false</span><br>
<span class="lineno">1285</span><span class="op" id="2587994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2587997">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2588045">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2588116">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2588177">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2588236">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2588287">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2588340">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2588379">func</span>&nbsp;<span class="ident" id="2588384">typelinks</span><span class="op" id="2588393">(</span><span class="op" id="2588394">)</span>&nbsp;<span class="op" id="2588396">[</span><span class="op" id="2588397">]</span><span class="op" id="2588398">*</span><span class="ident" id="2588399">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2588406">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2588479">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2588515">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2588580">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2588636">func</span>&nbsp;<span class="ident" id="2588641">typesByString</span><span class="op" id="2588654">(</span><span class="ident" id="2588655">s</span>&nbsp;<span class="builtintype" id="2588657">string</span><span class="op" id="2588663">)</span>&nbsp;<span class="op" id="2588665">[</span><span class="op" id="2588666">]</span><span class="op" id="2588667">*</span><span class="ident" id="2588668">rtype</span>&nbsp;<span class="op" id="2588674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2588677">typ</span>&nbsp;<span class="op" id="2588681">:=</span>&nbsp;<span class="ident" id="2588684">typelinks</span><span class="op" id="2588693">(</span><span class="op" id="2588694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2588698">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2588770">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2588850">i</span><span class="op" id="2588851">,</span>&nbsp;<span class="ident" id="2588853">j</span>&nbsp;<span class="op" id="2588855">:=</span>&nbsp;<span class="num" id="2588858">0</span><span class="op" id="2588859">,</span>&nbsp;<span class="builtinfunc" id="2588861">len</span><span class="op" id="2588864">(</span><span class="ident" id="2588865">typ</span><span class="op" id="2588868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2588871">for</span>&nbsp;<span class="ident" id="2588875">i</span>&nbsp;<span class="op" id="2588877">&lt;</span>&nbsp;<span class="ident" id="2588879">j</span>&nbsp;<span class="op" id="2588881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2588885">h</span>&nbsp;<span class="op" id="2588887">:=</span>&nbsp;<span class="ident" id="2588890">i</span>&nbsp;<span class="op" id="2588892">+</span>&nbsp;<span class="op" id="2588894">(</span><span class="ident" id="2588895">j</span><span class="op" id="2588896">-</span><span class="ident" id="2588897">i</span><span class="op" id="2588898">)</span><span class="op" id="2588899">/</span><span class="num" id="2588900">2</span>&nbsp;<span class="comment" id="2588902">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2588939">//&nbsp;i&nbsp;&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2588956">if</span>&nbsp;<span class="op" id="2588959">!</span><span class="op" id="2588960">(</span><span class="op" id="2588961">*</span><span class="ident" id="2588962">typ</span><span class="op" id="2588965">[</span><span class="ident" id="2588966">h</span><span class="op" id="2588967">]</span><span class="op" id="2588968">.</span><span class="builtintype" id="2588969">string</span>&nbsp;<span class="op" id="2588976">&gt;=</span>&nbsp;<span class="ident" id="2588979">s</span><span class="op" id="2588980">)</span>&nbsp;<span class="op" id="2588982">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2588987">i</span>&nbsp;<span class="op" id="2588989">=</span>&nbsp;<span class="ident" id="2588991">h</span>&nbsp;<span class="op" id="2588993">+</span>&nbsp;<span class="num" id="2588995">1</span>&nbsp;<span class="comment" id="2588997">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2589028">}</span>&nbsp;<span class="keyword" id="2589030">else</span>&nbsp;<span class="op" id="2589035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589040">j</span>&nbsp;<span class="op" id="2589042">=</span>&nbsp;<span class="ident" id="2589044">h</span>&nbsp;<span class="comment" id="2589046">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2589074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2589077">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2589080">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2589154">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2589220">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2589284">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589316">j</span>&nbsp;<span class="op" id="2589318">=</span>&nbsp;<span class="ident" id="2589320">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2589323">for</span>&nbsp;<span class="ident" id="2589327">j</span>&nbsp;<span class="op" id="2589329">&lt;</span>&nbsp;<span class="builtinfunc" id="2589331">len</span><span class="op" id="2589334">(</span><span class="ident" id="2589335">typ</span><span class="op" id="2589338">)</span>&nbsp;<span class="op" id="2589340">&amp;&amp;</span>&nbsp;<span class="op" id="2589343">*</span><span class="ident" id="2589344">typ</span><span class="op" id="2589347">[</span><span class="ident" id="2589348">j</span><span class="op" id="2589349">]</span><span class="op" id="2589350">.</span><span class="builtintype" id="2589351">string</span>&nbsp;<span class="op" id="2589358">==</span>&nbsp;<span class="ident" id="2589361">s</span>&nbsp;<span class="op" id="2589363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589367">j</span><span class="op" id="2589368">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2589372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2589376">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2589433">return</span>&nbsp;<span class="ident" id="2589440">typ</span><span class="op" id="2589443">[</span><span class="ident" id="2589444">i</span><span class="op" id="2589445">:</span><span class="ident" id="2589446">j</span><span class="op" id="2589447">]</span><br>
<span class="lineno"></span><span class="op" id="2589449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2589452">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2589514">var</span>&nbsp;<span class="ident" id="2589518">lookupCache</span>&nbsp;<span class="keyword" id="2589530">struct</span>&nbsp;<span class="op" id="2589537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589540">sync</span><span class="op" id="2589544">.</span><span class="ident" id="2589545">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589554">m</span>&nbsp;<span class="keyword" id="2589556">map</span><span class="op" id="2589559">[</span><span class="ident" id="2589560">cacheKey</span><span class="op" id="2589568">]</span><span class="op" id="2589569">*</span><span class="ident" id="2589570">rtype</span><br>
<span class="lineno"></span><span class="op" id="2589576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2589579">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2589632">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2589693">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2589750">type</span>&nbsp;<span class="ident" id="2589755">cacheKey</span>&nbsp;<span class="keyword" id="2589764">struct</span>&nbsp;<span class="op" id="2589771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589774">kind</span>&nbsp;&nbsp;<span class="ident" id="2589780">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589786">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2589792">*</span><span class="ident" id="2589793">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589800">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2589806">*</span><span class="ident" id="2589807">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2589814">extra</span>&nbsp;<span class="builtintype" id="2589820">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2589828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2589831">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2589896">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2589938">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2589987">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2590050">func</span>&nbsp;<span class="ident" id="2590055">cacheGet</span><span class="op" id="2590063">(</span><span class="ident" id="2590064">k</span>&nbsp;<span class="ident" id="2590066">cacheKey</span><span class="op" id="2590074">)</span>&nbsp;<span class="ident" id="2590076">Type</span>&nbsp;<span class="op" id="2590081">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590084">lookupCache</span><span class="op" id="2590095">.</span><span class="ident" id="2590096">RLock</span><span class="op" id="2590101">(</span><span class="op" id="2590102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590105">t</span>&nbsp;<span class="op" id="2590107">:=</span>&nbsp;<span class="ident" id="2590110">lookupCache</span><span class="op" id="2590121">.</span><span class="ident" id="2590122">m</span><span class="op" id="2590123">[</span><span class="ident" id="2590124">k</span><span class="op" id="2590125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590128">lookupCache</span><span class="op" id="2590139">.</span><span class="ident" id="2590140">RUnlock</span><span class="op" id="2590147">(</span><span class="op" id="2590148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2590151">if</span>&nbsp;<span class="ident" id="2590154">t</span>&nbsp;<span class="op" id="2590156">!=</span>&nbsp;<span class="ident" id="2590159">nil</span>&nbsp;<span class="op" id="2590163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2590167">return</span>&nbsp;<span class="ident" id="2590174">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2590177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590181">lookupCache</span><span class="op" id="2590192">.</span><span class="ident" id="2590193">Lock</span><span class="op" id="2590197">(</span><span class="op" id="2590198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590201">t</span>&nbsp;<span class="op" id="2590203">=</span>&nbsp;<span class="ident" id="2590205">lookupCache</span><span class="op" id="2590216">.</span><span class="ident" id="2590217">m</span><span class="op" id="2590218">[</span><span class="ident" id="2590219">k</span><span class="op" id="2590220">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2590223">if</span>&nbsp;<span class="ident" id="2590226">t</span>&nbsp;<span class="op" id="2590228">!=</span>&nbsp;<span class="ident" id="2590231">nil</span>&nbsp;<span class="op" id="2590235">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590239">lookupCache</span><span class="op" id="2590250">.</span><span class="ident" id="2590251">Unlock</span><span class="op" id="2590257">(</span><span class="op" id="2590258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2590262">return</span>&nbsp;<span class="ident" id="2590269">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2590272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2590276">if</span>&nbsp;<span class="ident" id="2590279">lookupCache</span><span class="op" id="2590290">.</span><span class="ident" id="2590291">m</span>&nbsp;<span class="op" id="2590293">==</span>&nbsp;<span class="ident" id="2590296">nil</span>&nbsp;<span class="op" id="2590300">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590304">lookupCache</span><span class="op" id="2590315">.</span><span class="ident" id="2590316">m</span>&nbsp;<span class="op" id="2590318">=</span>&nbsp;<span class="builtinfunc" id="2590320">make</span><span class="op" id="2590324">(</span><span class="keyword" id="2590325">map</span><span class="op" id="2590328">[</span><span class="ident" id="2590329">cacheKey</span><span class="op" id="2590337">]</span><span class="op" id="2590338">*</span><span class="ident" id="2590339">rtype</span><span class="op" id="2590344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2590347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2590351">return</span>&nbsp;<span class="ident" id="2590358">nil</span><br>
<span class="lineno"></span><span class="op" id="2590362">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2590365">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2590432">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2590497">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2590531">func</span>&nbsp;<span class="ident" id="2590536">cachePut</span><span class="op" id="2590544">(</span><span class="ident" id="2590545">k</span>&nbsp;<span class="ident" id="2590547">cacheKey</span><span class="op" id="2590555">,</span>&nbsp;<span class="ident" id="2590557">t</span>&nbsp;<span class="op" id="2590559">*</span><span class="ident" id="2590560">rtype</span><span class="op" id="2590565">)</span>&nbsp;<span class="ident" id="2590567">Type</span>&nbsp;<span class="op" id="2590572">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590575">lookupCache</span><span class="op" id="2590586">.</span><span class="ident" id="2590587">m</span><span class="op" id="2590588">[</span><span class="ident" id="2590589">k</span><span class="op" id="2590590">]</span>&nbsp;<span class="op" id="2590592">=</span>&nbsp;<span class="ident" id="2590594">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590597">lookupCache</span><span class="op" id="2590608">.</span><span class="ident" id="2590609">Unlock</span><span class="op" id="2590615">(</span><span class="op" id="2590616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2590619">return</span>&nbsp;<span class="ident" id="2590626">t</span><br>
<span class="lineno"></span><span class="op" id="2590628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2590631">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2590709">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2590788">//</span><br>
<span class="lineno"></span><span class="comment" id="2590791">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2590860">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2590925">func</span>&nbsp;<span class="ident" id="2590930">ChanOf</span><span class="op" id="2590936">(</span><span class="ident" id="2590937">dir</span>&nbsp;<span class="ident" id="2590941">ChanDir</span><span class="op" id="2590948">,</span>&nbsp;<span class="ident" id="2590950">t</span>&nbsp;<span class="ident" id="2590952">Type</span><span class="op" id="2590956">)</span>&nbsp;<span class="ident" id="2590958">Type</span>&nbsp;<span class="op" id="2590963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2590966">typ</span>&nbsp;<span class="op" id="2590970">:=</span>&nbsp;<span class="ident" id="2590973">t</span><span class="op" id="2590974">.</span><span class="op" id="2590975">(</span><span class="op" id="2590976">*</span><span class="ident" id="2590977">rtype</span><span class="op" id="2590982">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2590986">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591005">ckey</span>&nbsp;<span class="op" id="2591010">:=</span>&nbsp;<span class="ident" id="2591013">cacheKey</span><span class="op" id="2591021">{</span><span class="ident" id="2591022">Chan</span><span class="op" id="2591026">,</span>&nbsp;<span class="ident" id="2591028">typ</span><span class="op" id="2591031">,</span>&nbsp;<span class="ident" id="2591033">nil</span><span class="op" id="2591036">,</span>&nbsp;<span class="builtintype" id="2591038">uintptr</span><span class="op" id="2591045">(</span><span class="ident" id="2591046">dir</span><span class="op" id="2591049">)</span><span class="op" id="2591050">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591053">if</span>&nbsp;<span class="ident" id="2591056">ch</span>&nbsp;<span class="op" id="2591059">:=</span>&nbsp;<span class="ident" id="2591062">cacheGet</span><span class="op" id="2591070">(</span><span class="ident" id="2591071">ckey</span><span class="op" id="2591075">)</span><span class="op" id="2591076">;</span>&nbsp;<span class="ident" id="2591078">ch</span>&nbsp;<span class="op" id="2591081">!=</span>&nbsp;<span class="ident" id="2591084">nil</span>&nbsp;<span class="op" id="2591088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591092">return</span>&nbsp;<span class="ident" id="2591099">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2591107">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591175">if</span>&nbsp;<span class="ident" id="2591178">typ</span><span class="op" id="2591181">.</span><span class="ident" id="2591182">size</span>&nbsp;<span class="op" id="2591187">&gt;=</span>&nbsp;<span class="num" id="2591190">1</span><span class="op" id="2591191">&lt;&lt;</span><span class="num" id="2591193">16</span>&nbsp;<span class="op" id="2591196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591200">lookupCache</span><span class="op" id="2591211">.</span><span class="ident" id="2591212">Unlock</span><span class="op" id="2591218">(</span><span class="op" id="2591219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2591223">panic</span><span class="op" id="2591228">(</span><span class="string" id="2591229">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2591269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2591276">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2591301">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591348">var</span>&nbsp;<span class="ident" id="2591352">s</span>&nbsp;<span class="builtintype" id="2591354">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591362">switch</span>&nbsp;<span class="ident" id="2591369">dir</span>&nbsp;<span class="op" id="2591373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591376">default</span><span class="op" id="2591383">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591387">lookupCache</span><span class="op" id="2591398">.</span><span class="ident" id="2591399">Unlock</span><span class="op" id="2591405">(</span><span class="op" id="2591406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2591410">panic</span><span class="op" id="2591415">(</span><span class="string" id="2591416">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2591445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591448">case</span>&nbsp;<span class="ident" id="2591453">SendDir</span><span class="op" id="2591460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591464">s</span>&nbsp;<span class="op" id="2591466">=</span>&nbsp;<span class="string" id="2591468">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2591478">+</span>&nbsp;<span class="op" id="2591480">*</span><span class="ident" id="2591481">typ</span><span class="op" id="2591484">.</span><span class="builtintype" id="2591485">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591493">case</span>&nbsp;<span class="ident" id="2591498">RecvDir</span><span class="op" id="2591505">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591509">s</span>&nbsp;<span class="op" id="2591511">=</span>&nbsp;<span class="string" id="2591513">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2591523">+</span>&nbsp;<span class="op" id="2591525">*</span><span class="ident" id="2591526">typ</span><span class="op" id="2591529">.</span><span class="builtintype" id="2591530">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591538">case</span>&nbsp;<span class="ident" id="2591543">BothDir</span><span class="op" id="2591550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591554">s</span>&nbsp;<span class="op" id="2591556">=</span>&nbsp;<span class="string" id="2591558">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2591566">+</span>&nbsp;<span class="op" id="2591568">*</span><span class="ident" id="2591569">typ</span><span class="op" id="2591572">.</span><span class="builtintype" id="2591573">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591584">for</span>&nbsp;<span class="ident" id="2591588">_</span><span class="op" id="2591589">,</span>&nbsp;<span class="ident" id="2591591">tt</span>&nbsp;<span class="op" id="2591594">:=</span>&nbsp;<span class="keyword" id="2591597">range</span>&nbsp;<span class="ident" id="2591603">typesByString</span><span class="op" id="2591616">(</span><span class="ident" id="2591617">s</span><span class="op" id="2591618">)</span>&nbsp;<span class="op" id="2591620">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591624">ch</span>&nbsp;<span class="op" id="2591627">:=</span>&nbsp;<span class="op" id="2591630">(</span><span class="op" id="2591631">*</span><span class="ident" id="2591632">chanType</span><span class="op" id="2591640">)</span><span class="op" id="2591641">(</span><span class="ident" id="2591642">unsafe</span><span class="op" id="2591648">.</span><span class="ident" id="2591649">Pointer</span><span class="op" id="2591656">(</span><span class="ident" id="2591657">tt</span><span class="op" id="2591659">)</span><span class="op" id="2591660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591664">if</span>&nbsp;<span class="ident" id="2591667">ch</span><span class="op" id="2591669">.</span><span class="ident" id="2591670">elem</span>&nbsp;<span class="op" id="2591675">==</span>&nbsp;<span class="ident" id="2591678">typ</span>&nbsp;<span class="op" id="2591682">&amp;&amp;</span>&nbsp;<span class="ident" id="2591685">ch</span><span class="op" id="2591687">.</span><span class="ident" id="2591688">dir</span>&nbsp;<span class="op" id="2591692">==</span>&nbsp;<span class="builtintype" id="2591695">uintptr</span><span class="op" id="2591702">(</span><span class="ident" id="2591703">dir</span><span class="op" id="2591706">)</span>&nbsp;<span class="op" id="2591708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591713">return</span>&nbsp;<span class="ident" id="2591720">cachePut</span><span class="op" id="2591728">(</span><span class="ident" id="2591729">ckey</span><span class="op" id="2591733">,</span>&nbsp;<span class="ident" id="2591735">tt</span><span class="op" id="2591737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591744">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2591748">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591773">var</span>&nbsp;<span class="ident" id="2591777">ichan</span>&nbsp;<span class="keyword" id="2591783">interface</span><span class="op" id="2591792">{</span><span class="op" id="2591793">}</span>&nbsp;<span class="op" id="2591795">=</span>&nbsp;<span class="op" id="2591797">(</span><span class="keyword" id="2591798">chan</span>&nbsp;<span class="ident" id="2591803">unsafe</span><span class="op" id="2591809">.</span><span class="ident" id="2591810">Pointer</span><span class="op" id="2591817">)</span><span class="op" id="2591818">(</span><span class="ident" id="2591819">nil</span><span class="op" id="2591822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591825">prototype</span>&nbsp;<span class="op" id="2591835">:=</span>&nbsp;<span class="op" id="2591838">*</span><span class="op" id="2591839">(</span><span class="op" id="2591840">*</span><span class="op" id="2591841">*</span><span class="ident" id="2591842">chanType</span><span class="op" id="2591850">)</span><span class="op" id="2591851">(</span><span class="ident" id="2591852">unsafe</span><span class="op" id="2591858">.</span><span class="ident" id="2591859">Pointer</span><span class="op" id="2591866">(</span><span class="op" id="2591867">&amp;</span><span class="ident" id="2591868">ichan</span><span class="op" id="2591873">)</span><span class="op" id="2591874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591877">ch</span>&nbsp;<span class="op" id="2591880">:=</span>&nbsp;<span class="builtinfunc" id="2591883">new</span><span class="op" id="2591886">(</span><span class="ident" id="2591887">chanType</span><span class="op" id="2591895">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591898">*</span><span class="ident" id="2591899">ch</span>&nbsp;<span class="op" id="2591902">=</span>&nbsp;<span class="op" id="2591904">*</span><span class="ident" id="2591905">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591916">ch</span><span class="op" id="2591918">.</span><span class="builtintype" id="2591919">string</span>&nbsp;<span class="op" id="2591926">=</span>&nbsp;<span class="op" id="2591928">&amp;</span><span class="ident" id="2591929">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591932">ch</span><span class="op" id="2591934">.</span><span class="ident" id="2591935">hash</span>&nbsp;<span class="op" id="2591940">=</span>&nbsp;<span class="ident" id="2591942">fnv1</span><span class="op" id="2591946">(</span><span class="ident" id="2591947">typ</span><span class="op" id="2591950">.</span><span class="ident" id="2591951">hash</span><span class="op" id="2591955">,</span>&nbsp;<span class="string" id="2591957">&#39;c&#39;</span><span class="op" id="2591960">,</span>&nbsp;<span class="builtintype" id="2591962">byte</span><span class="op" id="2591966">(</span><span class="ident" id="2591967">dir</span><span class="op" id="2591970">)</span><span class="op" id="2591971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591974">ch</span><span class="op" id="2591976">.</span><span class="ident" id="2591977">elem</span>&nbsp;<span class="op" id="2591982">=</span>&nbsp;<span class="ident" id="2591984">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591989">ch</span><span class="op" id="2591991">.</span><span class="ident" id="2591992">uncommonType</span>&nbsp;<span class="op" id="2592005">=</span>&nbsp;<span class="ident" id="2592007">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592012">ch</span><span class="op" id="2592014">.</span><span class="ident" id="2592015">ptrToThis</span>&nbsp;<span class="op" id="2592025">=</span>&nbsp;<span class="ident" id="2592027">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592032">ch</span><span class="op" id="2592034">.</span><span class="ident" id="2592035">zero</span>&nbsp;<span class="op" id="2592040">=</span>&nbsp;<span class="ident" id="2592042">unsafe</span><span class="op" id="2592048">.</span><span class="ident" id="2592049">Pointer</span><span class="op" id="2592056">(</span><span class="op" id="2592057">&amp;</span><span class="builtinfunc" id="2592058">make</span><span class="op" id="2592062">(</span><span class="op" id="2592063">[</span><span class="op" id="2592064">]</span><span class="builtintype" id="2592065">byte</span><span class="op" id="2592069">,</span>&nbsp;<span class="ident" id="2592071">ch</span><span class="op" id="2592073">.</span><span class="ident" id="2592074">size</span><span class="op" id="2592078">)</span><span class="op" id="2592079">[</span><span class="num" id="2592080">0</span><span class="op" id="2592081">]</span><span class="op" id="2592082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592086">return</span>&nbsp;<span class="ident" id="2592093">cachePut</span><span class="op" id="2592101">(</span><span class="ident" id="2592102">ckey</span><span class="op" id="2592106">,</span>&nbsp;<span class="op" id="2592108">&amp;</span><span class="ident" id="2592109">ch</span><span class="op" id="2592111">.</span><span class="ident" id="2592112">rtype</span><span class="op" id="2592117">)</span><br>
<span class="lineno"></span><span class="op" id="2592119">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2592122">func</span>&nbsp;<span class="ident" id="2592127">ismapkey</span><span class="op" id="2592135">(</span><span class="op" id="2592136">*</span><span class="ident" id="2592137">rtype</span><span class="op" id="2592142">)</span>&nbsp;<span class="builtintype" id="2592144">bool</span>&nbsp;<span class="comment" id="2592149">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2592176">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2592244">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2592305">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2592347">//</span><br>
<span class="lineno"></span><span class="comment" id="2592350">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2592418">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2592468">func</span>&nbsp;<span class="ident" id="2592473">MapOf</span><span class="op" id="2592478">(</span><span class="ident" id="2592479">key</span><span class="op" id="2592482">,</span>&nbsp;<span class="ident" id="2592484">elem</span>&nbsp;<span class="ident" id="2592489">Type</span><span class="op" id="2592493">)</span>&nbsp;<span class="ident" id="2592495">Type</span>&nbsp;<span class="op" id="2592500">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592503">ktyp</span>&nbsp;<span class="op" id="2592508">:=</span>&nbsp;<span class="ident" id="2592511">key</span><span class="op" id="2592514">.</span><span class="op" id="2592515">(</span><span class="op" id="2592516">*</span><span class="ident" id="2592517">rtype</span><span class="op" id="2592522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592525">etyp</span>&nbsp;<span class="op" id="2592530">:=</span>&nbsp;<span class="ident" id="2592533">elem</span><span class="op" id="2592537">.</span><span class="op" id="2592538">(</span><span class="op" id="2592539">*</span><span class="ident" id="2592540">rtype</span><span class="op" id="2592545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592549">if</span>&nbsp;<span class="op" id="2592552">!</span><span class="ident" id="2592553">ismapkey</span><span class="op" id="2592561">(</span><span class="ident" id="2592562">ktyp</span><span class="op" id="2592566">)</span>&nbsp;<span class="op" id="2592568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2592572">panic</span><span class="op" id="2592577">(</span><span class="string" id="2592578">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2592613">+</span>&nbsp;<span class="ident" id="2592615">ktyp</span><span class="op" id="2592619">.</span><span class="ident" id="2592620">String</span><span class="op" id="2592626">(</span><span class="op" id="2592627">)</span><span class="op" id="2592628">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2592635">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592654">ckey</span>&nbsp;<span class="op" id="2592659">:=</span>&nbsp;<span class="ident" id="2592662">cacheKey</span><span class="op" id="2592670">{</span><span class="ident" id="2592671">Map</span><span class="op" id="2592674">,</span>&nbsp;<span class="ident" id="2592676">ktyp</span><span class="op" id="2592680">,</span>&nbsp;<span class="ident" id="2592682">etyp</span><span class="op" id="2592686">,</span>&nbsp;<span class="num" id="2592688">0</span><span class="op" id="2592689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592692">if</span>&nbsp;<span class="ident" id="2592695">mt</span>&nbsp;<span class="op" id="2592698">:=</span>&nbsp;<span class="ident" id="2592701">cacheGet</span><span class="op" id="2592709">(</span><span class="ident" id="2592710">ckey</span><span class="op" id="2592714">)</span><span class="op" id="2592715">;</span>&nbsp;<span class="ident" id="2592717">mt</span>&nbsp;<span class="op" id="2592720">!=</span>&nbsp;<span class="ident" id="2592723">nil</span>&nbsp;<span class="op" id="2592727">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592731">return</span>&nbsp;<span class="ident" id="2592738">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2592746">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592771">s</span>&nbsp;<span class="op" id="2592773">:=</span>&nbsp;<span class="string" id="2592776">&#34;map[&#34;</span>&nbsp;<span class="op" id="2592783">+</span>&nbsp;<span class="op" id="2592785">*</span><span class="ident" id="2592786">ktyp</span><span class="op" id="2592790">.</span><span class="builtintype" id="2592791">string</span>&nbsp;<span class="op" id="2592798">+</span>&nbsp;<span class="string" id="2592800">&#34;]&#34;</span>&nbsp;<span class="op" id="2592804">+</span>&nbsp;<span class="op" id="2592806">*</span><span class="ident" id="2592807">etyp</span><span class="op" id="2592811">.</span><span class="builtintype" id="2592812">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592820">for</span>&nbsp;<span class="ident" id="2592824">_</span><span class="op" id="2592825">,</span>&nbsp;<span class="ident" id="2592827">tt</span>&nbsp;<span class="op" id="2592830">:=</span>&nbsp;<span class="keyword" id="2592833">range</span>&nbsp;<span class="ident" id="2592839">typesByString</span><span class="op" id="2592852">(</span><span class="ident" id="2592853">s</span><span class="op" id="2592854">)</span>&nbsp;<span class="op" id="2592856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592860">mt</span>&nbsp;<span class="op" id="2592863">:=</span>&nbsp;<span class="op" id="2592866">(</span><span class="op" id="2592867">*</span><span class="ident" id="2592868">mapType</span><span class="op" id="2592875">)</span><span class="op" id="2592876">(</span><span class="ident" id="2592877">unsafe</span><span class="op" id="2592883">.</span><span class="ident" id="2592884">Pointer</span><span class="op" id="2592891">(</span><span class="ident" id="2592892">tt</span><span class="op" id="2592894">)</span><span class="op" id="2592895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592899">if</span>&nbsp;<span class="ident" id="2592902">mt</span><span class="op" id="2592904">.</span><span class="ident" id="2592905">key</span>&nbsp;<span class="op" id="2592909">==</span>&nbsp;<span class="ident" id="2592912">ktyp</span>&nbsp;<span class="op" id="2592917">&amp;&amp;</span>&nbsp;<span class="ident" id="2592920">mt</span><span class="op" id="2592922">.</span><span class="ident" id="2592923">elem</span>&nbsp;<span class="op" id="2592928">==</span>&nbsp;<span class="ident" id="2592931">etyp</span>&nbsp;<span class="op" id="2592936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592941">return</span>&nbsp;<span class="ident" id="2592948">cachePut</span><span class="op" id="2592956">(</span><span class="ident" id="2592957">ckey</span><span class="op" id="2592961">,</span>&nbsp;<span class="ident" id="2592963">tt</span><span class="op" id="2592965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592969">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2592976">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592997">var</span>&nbsp;<span class="ident" id="2593001">imap</span>&nbsp;<span class="keyword" id="2593006">interface</span><span class="op" id="2593015">{</span><span class="op" id="2593016">}</span>&nbsp;<span class="op" id="2593018">=</span>&nbsp;<span class="op" id="2593020">(</span><span class="keyword" id="2593021">map</span><span class="op" id="2593024">[</span><span class="ident" id="2593025">unsafe</span><span class="op" id="2593031">.</span><span class="ident" id="2593032">Pointer</span><span class="op" id="2593039">]</span><span class="ident" id="2593040">unsafe</span><span class="op" id="2593046">.</span><span class="ident" id="2593047">Pointer</span><span class="op" id="2593054">)</span><span class="op" id="2593055">(</span><span class="ident" id="2593056">nil</span><span class="op" id="2593059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593062">prototype</span>&nbsp;<span class="op" id="2593072">:=</span>&nbsp;<span class="op" id="2593075">*</span><span class="op" id="2593076">(</span><span class="op" id="2593077">*</span><span class="op" id="2593078">*</span><span class="ident" id="2593079">mapType</span><span class="op" id="2593086">)</span><span class="op" id="2593087">(</span><span class="ident" id="2593088">unsafe</span><span class="op" id="2593094">.</span><span class="ident" id="2593095">Pointer</span><span class="op" id="2593102">(</span><span class="op" id="2593103">&amp;</span><span class="ident" id="2593104">imap</span><span class="op" id="2593108">)</span><span class="op" id="2593109">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593112">mt</span>&nbsp;<span class="op" id="2593115">:=</span>&nbsp;<span class="builtinfunc" id="2593118">new</span><span class="op" id="2593121">(</span><span class="ident" id="2593122">mapType</span><span class="op" id="2593129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2593132">*</span><span class="ident" id="2593133">mt</span>&nbsp;<span class="op" id="2593136">=</span>&nbsp;<span class="op" id="2593138">*</span><span class="ident" id="2593139">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593150">mt</span><span class="op" id="2593152">.</span><span class="builtintype" id="2593153">string</span>&nbsp;<span class="op" id="2593160">=</span>&nbsp;<span class="op" id="2593162">&amp;</span><span class="ident" id="2593163">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593166">mt</span><span class="op" id="2593168">.</span><span class="ident" id="2593169">hash</span>&nbsp;<span class="op" id="2593174">=</span>&nbsp;<span class="ident" id="2593176">fnv1</span><span class="op" id="2593180">(</span><span class="ident" id="2593181">etyp</span><span class="op" id="2593185">.</span><span class="ident" id="2593186">hash</span><span class="op" id="2593190">,</span>&nbsp;<span class="string" id="2593192">&#39;m&#39;</span><span class="op" id="2593195">,</span>&nbsp;<span class="builtintype" id="2593197">byte</span><span class="op" id="2593201">(</span><span class="ident" id="2593202">ktyp</span><span class="op" id="2593206">.</span><span class="ident" id="2593207">hash</span><span class="op" id="2593211">&gt;&gt;</span><span class="num" id="2593213">24</span><span class="op" id="2593215">)</span><span class="op" id="2593216">,</span>&nbsp;<span class="builtintype" id="2593218">byte</span><span class="op" id="2593222">(</span><span class="ident" id="2593223">ktyp</span><span class="op" id="2593227">.</span><span class="ident" id="2593228">hash</span><span class="op" id="2593232">&gt;&gt;</span><span class="num" id="2593234">16</span><span class="op" id="2593236">)</span><span class="op" id="2593237">,</span>&nbsp;<span class="builtintype" id="2593239">byte</span><span class="op" id="2593243">(</span><span class="ident" id="2593244">ktyp</span><span class="op" id="2593248">.</span><span class="ident" id="2593249">hash</span><span class="op" id="2593253">&gt;&gt;</span><span class="num" id="2593255">8</span><span class="op" id="2593256">)</span><span class="op" id="2593257">,</span>&nbsp;<span class="builtintype" id="2593259">byte</span><span class="op" id="2593263">(</span><span class="ident" id="2593264">ktyp</span><span class="op" id="2593268">.</span><span class="ident" id="2593269">hash</span><span class="op" id="2593273">)</span><span class="op" id="2593274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593277">mt</span><span class="op" id="2593279">.</span><span class="ident" id="2593280">key</span>&nbsp;<span class="op" id="2593284">=</span>&nbsp;<span class="ident" id="2593286">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593292">mt</span><span class="op" id="2593294">.</span><span class="ident" id="2593295">elem</span>&nbsp;<span class="op" id="2593300">=</span>&nbsp;<span class="ident" id="2593302">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593308">mt</span><span class="op" id="2593310">.</span><span class="ident" id="2593311">bucket</span>&nbsp;<span class="op" id="2593318">=</span>&nbsp;<span class="ident" id="2593320">bucketOf</span><span class="op" id="2593328">(</span><span class="ident" id="2593329">ktyp</span><span class="op" id="2593333">,</span>&nbsp;<span class="ident" id="2593335">etyp</span><span class="op" id="2593339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2593342">if</span>&nbsp;<span class="ident" id="2593345">ktyp</span><span class="op" id="2593349">.</span><span class="ident" id="2593350">size</span>&nbsp;<span class="op" id="2593355">&gt;</span>&nbsp;<span class="ident" id="2593357">maxKeySize</span>&nbsp;<span class="op" id="2593368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593372">mt</span><span class="op" id="2593374">.</span><span class="ident" id="2593375">keysize</span>&nbsp;<span class="op" id="2593383">=</span>&nbsp;<span class="builtintype" id="2593385">uint8</span><span class="op" id="2593390">(</span><span class="ident" id="2593391">ptrSize</span><span class="op" id="2593398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593402">mt</span><span class="op" id="2593404">.</span><span class="ident" id="2593405">indirectkey</span>&nbsp;<span class="op" id="2593417">=</span>&nbsp;<span class="num" id="2593419">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2593422">}</span>&nbsp;<span class="keyword" id="2593424">else</span>&nbsp;<span class="op" id="2593429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593433">mt</span><span class="op" id="2593435">.</span><span class="ident" id="2593436">keysize</span>&nbsp;<span class="op" id="2593444">=</span>&nbsp;<span class="builtintype" id="2593446">uint8</span><span class="op" id="2593451">(</span><span class="ident" id="2593452">ktyp</span><span class="op" id="2593456">.</span><span class="ident" id="2593457">size</span><span class="op" id="2593461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593465">mt</span><span class="op" id="2593467">.</span><span class="ident" id="2593468">indirectkey</span>&nbsp;<span class="op" id="2593480">=</span>&nbsp;<span class="num" id="2593482">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2593485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2593488">if</span>&nbsp;<span class="ident" id="2593491">etyp</span><span class="op" id="2593495">.</span><span class="ident" id="2593496">size</span>&nbsp;<span class="op" id="2593501">&gt;</span>&nbsp;<span class="ident" id="2593503">maxValSize</span>&nbsp;<span class="op" id="2593514">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593518">mt</span><span class="op" id="2593520">.</span><span class="ident" id="2593521">valuesize</span>&nbsp;<span class="op" id="2593531">=</span>&nbsp;<span class="builtintype" id="2593533">uint8</span><span class="op" id="2593538">(</span><span class="ident" id="2593539">ptrSize</span><span class="op" id="2593546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593550">mt</span><span class="op" id="2593552">.</span><span class="ident" id="2593553">indirectvalue</span>&nbsp;<span class="op" id="2593567">=</span>&nbsp;<span class="num" id="2593569">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2593572">}</span>&nbsp;<span class="keyword" id="2593574">else</span>&nbsp;<span class="op" id="2593579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593583">mt</span><span class="op" id="2593585">.</span><span class="ident" id="2593586">valuesize</span>&nbsp;<span class="op" id="2593596">=</span>&nbsp;<span class="builtintype" id="2593598">uint8</span><span class="op" id="2593603">(</span><span class="ident" id="2593604">etyp</span><span class="op" id="2593608">.</span><span class="ident" id="2593609">size</span><span class="op" id="2593613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593617">mt</span><span class="op" id="2593619">.</span><span class="ident" id="2593620">indirectvalue</span>&nbsp;<span class="op" id="2593634">=</span>&nbsp;<span class="num" id="2593636">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2593639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593642">mt</span><span class="op" id="2593644">.</span><span class="ident" id="2593645">bucketsize</span>&nbsp;<span class="op" id="2593656">=</span>&nbsp;<span class="builtintype" id="2593658">uint16</span><span class="op" id="2593664">(</span><span class="ident" id="2593665">mt</span><span class="op" id="2593667">.</span><span class="ident" id="2593668">bucket</span><span class="op" id="2593674">.</span><span class="ident" id="2593675">size</span><span class="op" id="2593679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593682">mt</span><span class="op" id="2593684">.</span><span class="ident" id="2593685">uncommonType</span>&nbsp;<span class="op" id="2593698">=</span>&nbsp;<span class="ident" id="2593700">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593705">mt</span><span class="op" id="2593707">.</span><span class="ident" id="2593708">ptrToThis</span>&nbsp;<span class="op" id="2593718">=</span>&nbsp;<span class="ident" id="2593720">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593725">mt</span><span class="op" id="2593727">.</span><span class="ident" id="2593728">zero</span>&nbsp;<span class="op" id="2593733">=</span>&nbsp;<span class="ident" id="2593735">unsafe</span><span class="op" id="2593741">.</span><span class="ident" id="2593742">Pointer</span><span class="op" id="2593749">(</span><span class="op" id="2593750">&amp;</span><span class="builtinfunc" id="2593751">make</span><span class="op" id="2593755">(</span><span class="op" id="2593756">[</span><span class="op" id="2593757">]</span><span class="builtintype" id="2593758">byte</span><span class="op" id="2593762">,</span>&nbsp;<span class="ident" id="2593764">mt</span><span class="op" id="2593766">.</span><span class="ident" id="2593767">size</span><span class="op" id="2593771">)</span><span class="op" id="2593772">[</span><span class="num" id="2593773">0</span><span class="op" id="2593774">]</span><span class="op" id="2593775">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2593779">return</span>&nbsp;<span class="ident" id="2593786">cachePut</span><span class="op" id="2593794">(</span><span class="ident" id="2593795">ckey</span><span class="op" id="2593799">,</span>&nbsp;<span class="op" id="2593801">&amp;</span><span class="ident" id="2593802">mt</span><span class="op" id="2593804">.</span><span class="ident" id="2593805">rtype</span><span class="op" id="2593810">)</span><br>
<span class="lineno"></span><span class="op" id="2593812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2593815">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2593879">type</span>&nbsp;<span class="ident" id="2593884">gcProg</span>&nbsp;<span class="keyword" id="2593891">struct</span>&nbsp;<span class="op" id="2593898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593901">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2593906">[</span><span class="op" id="2593907">]</span><span class="builtintype" id="2593908">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593914">size</span>&nbsp;<span class="builtintype" id="2593919">uintptr</span>&nbsp;<span class="comment" id="2593927">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2593952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2593955">func</span>&nbsp;<span class="op" id="2593960">(</span><span class="ident" id="2593961">gc</span>&nbsp;<span class="op" id="2593964">*</span><span class="ident" id="2593965">gcProg</span><span class="op" id="2593971">)</span>&nbsp;<span class="builtinfunc" id="2593973">append</span><span class="op" id="2593979">(</span><span class="ident" id="2593980">v</span>&nbsp;<span class="builtintype" id="2593982">byte</span><span class="op" id="2593986">)</span>&nbsp;<span class="op" id="2593988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2593991">gc</span><span class="op" id="2593993">.</span><span class="ident" id="2593994">align</span><span class="op" id="2593999">(</span><span class="ident" id="2594000">unsafe</span><span class="op" id="2594006">.</span><span class="ident" id="2594007">Sizeof</span><span class="op" id="2594013">(</span><span class="builtintype" id="2594014">uintptr</span><span class="op" id="2594021">(</span><span class="num" id="2594022">0</span><span class="op" id="2594023">)</span><span class="op" id="2594024">)</span><span class="op" id="2594025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594028">gc</span><span class="op" id="2594030">.</span><span class="ident" id="2594031">appendWord</span><span class="op" id="2594041">(</span><span class="ident" id="2594042">v</span><span class="op" id="2594043">)</span><br>
<span class="lineno"></span><span class="op" id="2594045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2594048">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2594097">func</span>&nbsp;<span class="op" id="2594102">(</span><span class="ident" id="2594103">gc</span>&nbsp;<span class="op" id="2594106">*</span><span class="ident" id="2594107">gcProg</span><span class="op" id="2594113">)</span>&nbsp;<span class="ident" id="2594115">appendProg</span><span class="op" id="2594125">(</span><span class="ident" id="2594126">t</span>&nbsp;<span class="op" id="2594128">*</span><span class="ident" id="2594129">rtype</span><span class="op" id="2594134">)</span>&nbsp;<span class="op" id="2594136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594139">gc</span><span class="op" id="2594141">.</span><span class="ident" id="2594142">align</span><span class="op" id="2594147">(</span><span class="builtintype" id="2594148">uintptr</span><span class="op" id="2594155">(</span><span class="ident" id="2594156">t</span><span class="op" id="2594157">.</span><span class="ident" id="2594158">align</span><span class="op" id="2594163">)</span><span class="op" id="2594164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594167">if</span>&nbsp;<span class="op" id="2594170">!</span><span class="ident" id="2594171">t</span><span class="op" id="2594172">.</span><span class="ident" id="2594173">pointers</span><span class="op" id="2594181">(</span><span class="op" id="2594182">)</span>&nbsp;<span class="op" id="2594184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594188">gc</span><span class="op" id="2594190">.</span><span class="ident" id="2594191">size</span>&nbsp;<span class="op" id="2594196">+=</span>&nbsp;<span class="ident" id="2594199">t</span><span class="op" id="2594200">.</span><span class="ident" id="2594201">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594208">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2594216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594219">switch</span>&nbsp;<span class="ident" id="2594226">t</span><span class="op" id="2594227">.</span><span class="ident" id="2594228">Kind</span><span class="op" id="2594232">(</span><span class="op" id="2594233">)</span>&nbsp;<span class="op" id="2594235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594238">default</span><span class="op" id="2594245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2594249">panic</span><span class="op" id="2594254">(</span><span class="string" id="2594255">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2594308">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594311">case</span>&nbsp;<span class="ident" id="2594316">Ptr</span><span class="op" id="2594319">,</span>&nbsp;<span class="ident" id="2594321">UnsafePointer</span><span class="op" id="2594334">,</span>&nbsp;<span class="ident" id="2594336">Chan</span><span class="op" id="2594340">,</span>&nbsp;<span class="ident" id="2594342">Func</span><span class="op" id="2594346">,</span>&nbsp;<span class="ident" id="2594348">Map</span><span class="op" id="2594351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594355">gc</span><span class="op" id="2594357">.</span><span class="ident" id="2594358">appendWord</span><span class="op" id="2594368">(</span><span class="ident" id="2594369">bitsPointer</span><span class="op" id="2594380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594383">case</span>&nbsp;<span class="ident" id="2594388">Slice</span><span class="op" id="2594393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594397">gc</span><span class="op" id="2594399">.</span><span class="ident" id="2594400">appendWord</span><span class="op" id="2594410">(</span><span class="ident" id="2594411">bitsPointer</span><span class="op" id="2594422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594426">gc</span><span class="op" id="2594428">.</span><span class="ident" id="2594429">appendWord</span><span class="op" id="2594439">(</span><span class="ident" id="2594440">bitsScalar</span><span class="op" id="2594450">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594454">gc</span><span class="op" id="2594456">.</span><span class="ident" id="2594457">appendWord</span><span class="op" id="2594467">(</span><span class="ident" id="2594468">bitsScalar</span><span class="op" id="2594478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594481">case</span>&nbsp;<span class="ident" id="2594486">String</span><span class="op" id="2594492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594496">gc</span><span class="op" id="2594498">.</span><span class="ident" id="2594499">appendWord</span><span class="op" id="2594509">(</span><span class="ident" id="2594510">bitsPointer</span><span class="op" id="2594521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594525">gc</span><span class="op" id="2594527">.</span><span class="ident" id="2594528">appendWord</span><span class="op" id="2594538">(</span><span class="ident" id="2594539">bitsScalar</span><span class="op" id="2594549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594552">case</span>&nbsp;<span class="ident" id="2594557">Array</span><span class="op" id="2594562">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594566">c</span>&nbsp;<span class="op" id="2594568">:=</span>&nbsp;<span class="ident" id="2594571">t</span><span class="op" id="2594572">.</span><span class="ident" id="2594573">Len</span><span class="op" id="2594576">(</span><span class="op" id="2594577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594581">e</span>&nbsp;<span class="op" id="2594583">:=</span>&nbsp;<span class="ident" id="2594586">t</span><span class="op" id="2594587">.</span><span class="ident" id="2594588">Elem</span><span class="op" id="2594592">(</span><span class="op" id="2594593">)</span><span class="op" id="2594594">.</span><span class="ident" id="2594595">common</span><span class="op" id="2594601">(</span><span class="op" id="2594602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594606">for</span>&nbsp;<span class="ident" id="2594610">i</span>&nbsp;<span class="op" id="2594612">:=</span>&nbsp;<span class="num" id="2594615">0</span><span class="op" id="2594616">;</span>&nbsp;<span class="ident" id="2594618">i</span>&nbsp;<span class="op" id="2594620">&lt;</span>&nbsp;<span class="ident" id="2594622">c</span><span class="op" id="2594623">;</span>&nbsp;<span class="ident" id="2594625">i</span><span class="op" id="2594626">++</span>&nbsp;<span class="op" id="2594629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594634">gc</span><span class="op" id="2594636">.</span><span class="ident" id="2594637">appendProg</span><span class="op" id="2594647">(</span><span class="ident" id="2594648">e</span><span class="op" id="2594649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2594653">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594656">case</span>&nbsp;<span class="ident" id="2594661">Interface</span><span class="op" id="2594670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594674">gc</span><span class="op" id="2594676">.</span><span class="ident" id="2594677">appendWord</span><span class="op" id="2594687">(</span><span class="ident" id="2594688">bitsMultiWord</span><span class="op" id="2594701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594705">if</span>&nbsp;<span class="ident" id="2594708">t</span><span class="op" id="2594709">.</span><span class="ident" id="2594710">NumMethod</span><span class="op" id="2594719">(</span><span class="op" id="2594720">)</span>&nbsp;<span class="op" id="2594722">==</span>&nbsp;<span class="num" id="2594725">0</span>&nbsp;<span class="op" id="2594727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594732">gc</span><span class="op" id="2594734">.</span><span class="ident" id="2594735">appendWord</span><span class="op" id="2594745">(</span><span class="ident" id="2594746">bitsEface</span><span class="op" id="2594755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2594759">}</span>&nbsp;<span class="keyword" id="2594761">else</span>&nbsp;<span class="op" id="2594766">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594771">gc</span><span class="op" id="2594773">.</span><span class="ident" id="2594774">appendWord</span><span class="op" id="2594784">(</span><span class="ident" id="2594785">bitsIface</span><span class="op" id="2594794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2594798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594801">case</span>&nbsp;<span class="ident" id="2594806">Struct</span><span class="op" id="2594812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594816">c</span>&nbsp;<span class="op" id="2594818">:=</span>&nbsp;<span class="ident" id="2594821">t</span><span class="op" id="2594822">.</span><span class="ident" id="2594823">NumField</span><span class="op" id="2594831">(</span><span class="op" id="2594832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2594836">for</span>&nbsp;<span class="ident" id="2594840">i</span>&nbsp;<span class="op" id="2594842">:=</span>&nbsp;<span class="num" id="2594845">0</span><span class="op" id="2594846">;</span>&nbsp;<span class="ident" id="2594848">i</span>&nbsp;<span class="op" id="2594850">&lt;</span>&nbsp;<span class="ident" id="2594852">c</span><span class="op" id="2594853">;</span>&nbsp;<span class="ident" id="2594855">i</span><span class="op" id="2594856">++</span>&nbsp;<span class="op" id="2594859">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594864">gc</span><span class="op" id="2594866">.</span><span class="ident" id="2594867">appendProg</span><span class="op" id="2594877">(</span><span class="ident" id="2594878">t</span><span class="op" id="2594879">.</span><span class="ident" id="2594880">Field</span><span class="op" id="2594885">(</span><span class="ident" id="2594886">i</span><span class="op" id="2594887">)</span><span class="op" id="2594888">.</span><span class="ident" id="2594889">Type</span><span class="op" id="2594893">.</span><span class="ident" id="2594894">common</span><span class="op" id="2594900">(</span><span class="op" id="2594901">)</span><span class="op" id="2594902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2594906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594910">gc</span><span class="op" id="2594912">.</span><span class="ident" id="2594913">align</span><span class="op" id="2594918">(</span><span class="builtintype" id="2594919">uintptr</span><span class="op" id="2594926">(</span><span class="ident" id="2594927">t</span><span class="op" id="2594928">.</span><span class="ident" id="2594929">align</span><span class="op" id="2594934">)</span><span class="op" id="2594935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2594938">}</span><br>
<span class="lineno"></span><span class="op" id="2594940">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2594943">func</span>&nbsp;<span class="op" id="2594948">(</span><span class="ident" id="2594949">gc</span>&nbsp;<span class="op" id="2594952">*</span><span class="ident" id="2594953">gcProg</span><span class="op" id="2594959">)</span>&nbsp;<span class="ident" id="2594961">appendWord</span><span class="op" id="2594971">(</span><span class="ident" id="2594972">v</span>&nbsp;<span class="builtintype" id="2594974">byte</span><span class="op" id="2594978">)</span>&nbsp;<span class="op" id="2594980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2594983">ptrsize</span>&nbsp;<span class="op" id="2594991">:=</span>&nbsp;<span class="ident" id="2594994">unsafe</span><span class="op" id="2595000">.</span><span class="ident" id="2595001">Sizeof</span><span class="op" id="2595007">(</span><span class="builtintype" id="2595008">uintptr</span><span class="op" id="2595015">(</span><span class="num" id="2595016">0</span><span class="op" id="2595017">)</span><span class="op" id="2595018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595021">if</span>&nbsp;<span class="ident" id="2595024">gc</span><span class="op" id="2595026">.</span><span class="ident" id="2595027">size</span><span class="op" id="2595031">%</span><span class="ident" id="2595032">ptrsize</span>&nbsp;<span class="op" id="2595040">!=</span>&nbsp;<span class="num" id="2595043">0</span>&nbsp;<span class="op" id="2595045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2595049">panic</span><span class="op" id="2595054">(</span><span class="string" id="2595055">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2595086">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2595089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595092">nptr</span>&nbsp;<span class="op" id="2595097">:=</span>&nbsp;<span class="ident" id="2595100">gc</span><span class="op" id="2595102">.</span><span class="ident" id="2595103">size</span>&nbsp;<span class="op" id="2595108">/</span>&nbsp;<span class="ident" id="2595110">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595119">for</span>&nbsp;<span class="builtintype" id="2595123">uintptr</span><span class="op" id="2595130">(</span><span class="builtinfunc" id="2595131">len</span><span class="op" id="2595134">(</span><span class="ident" id="2595135">gc</span><span class="op" id="2595137">.</span><span class="ident" id="2595138">gc</span><span class="op" id="2595140">)</span><span class="op" id="2595141">)</span>&nbsp;<span class="op" id="2595143">&lt;</span>&nbsp;<span class="ident" id="2595145">nptr</span><span class="op" id="2595149">/</span><span class="num" id="2595150">2</span><span class="op" id="2595151">+</span><span class="num" id="2595152">1</span>&nbsp;<span class="op" id="2595154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595158">gc</span><span class="op" id="2595160">.</span><span class="ident" id="2595161">gc</span>&nbsp;<span class="op" id="2595164">=</span>&nbsp;<span class="builtinfunc" id="2595166">append</span><span class="op" id="2595172">(</span><span class="ident" id="2595173">gc</span><span class="op" id="2595175">.</span><span class="ident" id="2595176">gc</span><span class="op" id="2595178">,</span>&nbsp;<span class="num" id="2595180">0x44</span><span class="op" id="2595184">)</span>&nbsp;<span class="comment" id="2595186">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2595201">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595204">gc</span><span class="op" id="2595206">.</span><span class="ident" id="2595207">gc</span><span class="op" id="2595209">[</span><span class="ident" id="2595210">nptr</span><span class="op" id="2595214">/</span><span class="num" id="2595215">2</span><span class="op" id="2595216">]</span>&nbsp;<span class="op" id="2595218">&amp;=</span>&nbsp;<span class="op" id="2595221">^</span><span class="op" id="2595222">(</span><span class="num" id="2595223">3</span>&nbsp;<span class="op" id="2595225">&lt;&lt;</span>&nbsp;<span class="op" id="2595228">(</span><span class="op" id="2595229">(</span><span class="ident" id="2595230">nptr</span><span class="op" id="2595234">%</span><span class="num" id="2595235">2</span><span class="op" id="2595236">)</span><span class="op" id="2595237">*</span><span class="num" id="2595238">4</span>&nbsp;<span class="op" id="2595240">+</span>&nbsp;<span class="num" id="2595242">2</span><span class="op" id="2595243">)</span><span class="op" id="2595244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595247">gc</span><span class="op" id="2595249">.</span><span class="ident" id="2595250">gc</span><span class="op" id="2595252">[</span><span class="ident" id="2595253">nptr</span><span class="op" id="2595257">/</span><span class="num" id="2595258">2</span><span class="op" id="2595259">]</span>&nbsp;<span class="op" id="2595261">|=</span>&nbsp;<span class="ident" id="2595264">v</span>&nbsp;<span class="op" id="2595266">&lt;&lt;</span>&nbsp;<span class="op" id="2595269">(</span><span class="op" id="2595270">(</span><span class="ident" id="2595271">nptr</span><span class="op" id="2595275">%</span><span class="num" id="2595276">2</span><span class="op" id="2595277">)</span><span class="op" id="2595278">*</span><span class="num" id="2595279">4</span>&nbsp;<span class="op" id="2595281">+</span>&nbsp;<span class="num" id="2595283">2</span><span class="op" id="2595284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595287">gc</span><span class="op" id="2595289">.</span><span class="ident" id="2595290">size</span>&nbsp;<span class="op" id="2595295">+=</span>&nbsp;<span class="ident" id="2595298">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2595306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2595309">func</span>&nbsp;<span class="op" id="2595314">(</span><span class="ident" id="2595315">gc</span>&nbsp;<span class="op" id="2595318">*</span><span class="ident" id="2595319">gcProg</span><span class="op" id="2595325">)</span>&nbsp;<span class="ident" id="2595327">finalize</span><span class="op" id="2595335">(</span><span class="op" id="2595336">)</span>&nbsp;<span class="ident" id="2595338">unsafe</span><span class="op" id="2595344">.</span><span class="ident" id="2595345">Pointer</span>&nbsp;<span class="op" id="2595353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595356">if</span>&nbsp;<span class="ident" id="2595359">gc</span><span class="op" id="2595361">.</span><span class="ident" id="2595362">size</span>&nbsp;<span class="op" id="2595367">==</span>&nbsp;<span class="num" id="2595370">0</span>&nbsp;<span class="op" id="2595372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595376">return</span>&nbsp;<span class="ident" id="2595383">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2595388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595391">ptrsize</span>&nbsp;<span class="op" id="2595399">:=</span>&nbsp;<span class="ident" id="2595402">unsafe</span><span class="op" id="2595408">.</span><span class="ident" id="2595409">Sizeof</span><span class="op" id="2595415">(</span><span class="builtintype" id="2595416">uintptr</span><span class="op" id="2595423">(</span><span class="num" id="2595424">0</span><span class="op" id="2595425">)</span><span class="op" id="2595426">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595429">gc</span><span class="op" id="2595431">.</span><span class="ident" id="2595432">align</span><span class="op" id="2595437">(</span><span class="ident" id="2595438">ptrsize</span><span class="op" id="2595445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595448">nptr</span>&nbsp;<span class="op" id="2595453">:=</span>&nbsp;<span class="ident" id="2595456">gc</span><span class="op" id="2595458">.</span><span class="ident" id="2595459">size</span>&nbsp;<span class="op" id="2595464">/</span>&nbsp;<span class="ident" id="2595466">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595475">for</span>&nbsp;<span class="builtintype" id="2595479">uintptr</span><span class="op" id="2595486">(</span><span class="builtinfunc" id="2595487">len</span><span class="op" id="2595490">(</span><span class="ident" id="2595491">gc</span><span class="op" id="2595493">.</span><span class="ident" id="2595494">gc</span><span class="op" id="2595496">)</span><span class="op" id="2595497">)</span>&nbsp;<span class="op" id="2595499">&lt;</span>&nbsp;<span class="ident" id="2595501">nptr</span><span class="op" id="2595505">/</span><span class="num" id="2595506">2</span><span class="op" id="2595507">+</span><span class="num" id="2595508">1</span>&nbsp;<span class="op" id="2595510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595514">gc</span><span class="op" id="2595516">.</span><span class="ident" id="2595517">gc</span>&nbsp;<span class="op" id="2595520">=</span>&nbsp;<span class="builtinfunc" id="2595522">append</span><span class="op" id="2595528">(</span><span class="ident" id="2595529">gc</span><span class="op" id="2595531">.</span><span class="ident" id="2595532">gc</span><span class="op" id="2595534">,</span>&nbsp;<span class="num" id="2595536">0x44</span><span class="op" id="2595540">)</span>&nbsp;<span class="comment" id="2595542">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2595557">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2595560">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2595614">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595642">if</span>&nbsp;<span class="ident" id="2595645">nptr</span><span class="op" id="2595649">%</span><span class="num" id="2595650">2</span>&nbsp;<span class="op" id="2595652">!=</span>&nbsp;<span class="num" id="2595655">0</span>&nbsp;<span class="op" id="2595657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595661">for</span>&nbsp;<span class="ident" id="2595665">i</span>&nbsp;<span class="op" id="2595667">:=</span>&nbsp;<span class="builtintype" id="2595670">uintptr</span><span class="op" id="2595677">(</span><span class="num" id="2595678">0</span><span class="op" id="2595679">)</span><span class="op" id="2595680">;</span>&nbsp;<span class="ident" id="2595682">i</span>&nbsp;<span class="op" id="2595684">&lt;</span>&nbsp;<span class="ident" id="2595686">nptr</span><span class="op" id="2595690">;</span>&nbsp;<span class="ident" id="2595692">i</span><span class="op" id="2595693">++</span>&nbsp;<span class="op" id="2595696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595701">gc</span><span class="op" id="2595703">.</span><span class="ident" id="2595704">appendWord</span><span class="op" id="2595714">(</span><span class="ident" id="2595715">extractGCWord</span><span class="op" id="2595728">(</span><span class="ident" id="2595729">gc</span><span class="op" id="2595731">.</span><span class="ident" id="2595732">gc</span><span class="op" id="2595734">,</span>&nbsp;<span class="ident" id="2595736">i</span><span class="op" id="2595737">)</span><span class="op" id="2595738">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2595742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2595745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595748">return</span>&nbsp;<span class="ident" id="2595755">unsafe</span><span class="op" id="2595761">.</span><span class="ident" id="2595762">Pointer</span><span class="op" id="2595769">(</span><span class="op" id="2595770">&amp;</span><span class="ident" id="2595771">gc</span><span class="op" id="2595773">.</span><span class="ident" id="2595774">gc</span><span class="op" id="2595776">[</span><span class="num" id="2595777">0</span><span class="op" id="2595778">]</span><span class="op" id="2595779">)</span><br>
<span class="lineno"></span><span class="op" id="2595781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2595784">func</span>&nbsp;<span class="ident" id="2595789">extractGCWord</span><span class="op" id="2595802">(</span><span class="ident" id="2595803">gc</span>&nbsp;<span class="op" id="2595806">[</span><span class="op" id="2595807">]</span><span class="builtintype" id="2595808">byte</span><span class="op" id="2595812">,</span>&nbsp;<span class="ident" id="2595814">i</span>&nbsp;<span class="builtintype" id="2595816">uintptr</span><span class="op" id="2595823">)</span>&nbsp;<span class="builtintype" id="2595825">byte</span>&nbsp;<span class="op" id="2595830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2595833">return</span>&nbsp;<span class="op" id="2595840">(</span><span class="ident" id="2595841">gc</span><span class="op" id="2595843">[</span><span class="ident" id="2595844">i</span><span class="op" id="2595845">/</span><span class="num" id="2595846">2</span><span class="op" id="2595847">]</span>&nbsp;<span class="op" id="2595849">&gt;&gt;</span>&nbsp;<span class="op" id="2595852">(</span><span class="op" id="2595853">(</span><span class="ident" id="2595854">i</span><span class="op" id="2595855">%</span><span class="num" id="2595856">2</span><span class="op" id="2595857">)</span><span class="op" id="2595858">*</span><span class="num" id="2595859">4</span>&nbsp;<span class="op" id="2595861">+</span>&nbsp;<span class="num" id="2595863">2</span><span class="op" id="2595864">)</span><span class="op" id="2595865">)</span>&nbsp;<span class="op" id="2595867">&amp;</span>&nbsp;<span class="num" id="2595869">3</span><br>
<span class="lineno"></span><span class="op" id="2595871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2595874">func</span>&nbsp;<span class="op" id="2595879">(</span><span class="ident" id="2595880">gc</span>&nbsp;<span class="op" id="2595883">*</span><span class="ident" id="2595884">gcProg</span><span class="op" id="2595890">)</span>&nbsp;<span class="ident" id="2595892">align</span><span class="op" id="2595897">(</span><span class="ident" id="2595898">a</span>&nbsp;<span class="builtintype" id="2595900">uintptr</span><span class="op" id="2595907">)</span>&nbsp;<span class="op" id="2595909">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2595912">gc</span><span class="op" id="2595914">.</span><span class="ident" id="2595915">size</span>&nbsp;<span class="op" id="2595920">=</span>&nbsp;<span class="ident" id="2595922">align</span><span class="op" id="2595927">(</span><span class="ident" id="2595928">gc</span><span class="op" id="2595930">.</span><span class="ident" id="2595931">size</span><span class="op" id="2595935">,</span>&nbsp;<span class="ident" id="2595937">a</span><span class="op" id="2595938">)</span><br>
<span class="lineno"></span><span class="op" id="2595940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2595943">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2596004">const</span>&nbsp;<span class="op" id="2596010">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596013">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2596027">=</span>&nbsp;<span class="num" id="2596029">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596032">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2596046">=</span>&nbsp;<span class="num" id="2596048">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596051">bitsMultiWord</span>&nbsp;<span class="op" id="2596065">=</span>&nbsp;<span class="num" id="2596067">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596071">bitsIface</span>&nbsp;<span class="op" id="2596081">=</span>&nbsp;<span class="num" id="2596083">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596086">bitsEface</span>&nbsp;<span class="op" id="2596096">=</span>&nbsp;<span class="num" id="2596098">3</span><br>
<span class="lineno"></span><span class="op" id="2596100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2596103">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2596175">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2596247">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2596322">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2596353">const</span>&nbsp;<span class="op" id="2596359">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596362">bucketSize</span>&nbsp;<span class="op" id="2596373">=</span>&nbsp;<span class="num" id="2596375">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596378">maxKeySize</span>&nbsp;<span class="op" id="2596389">=</span>&nbsp;<span class="num" id="2596391">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596396">maxValSize</span>&nbsp;<span class="op" id="2596407">=</span>&nbsp;<span class="num" id="2596409">128</span><br>
<span class="lineno"></span><span class="op" id="2596413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2596416">func</span>&nbsp;<span class="ident" id="2596421">bucketOf</span><span class="op" id="2596429">(</span><span class="ident" id="2596430">ktyp</span><span class="op" id="2596434">,</span>&nbsp;<span class="ident" id="2596436">etyp</span>&nbsp;<span class="op" id="2596441">*</span><span class="ident" id="2596442">rtype</span><span class="op" id="2596447">)</span>&nbsp;<span class="op" id="2596449">*</span><span class="ident" id="2596450">rtype</span>&nbsp;<span class="op" id="2596456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596459">if</span>&nbsp;<span class="ident" id="2596462">ktyp</span><span class="op" id="2596466">.</span><span class="ident" id="2596467">size</span>&nbsp;<span class="op" id="2596472">&gt;</span>&nbsp;<span class="ident" id="2596474">maxKeySize</span>&nbsp;<span class="op" id="2596485">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596489">ktyp</span>&nbsp;<span class="op" id="2596494">=</span>&nbsp;<span class="ident" id="2596496">PtrTo</span><span class="op" id="2596501">(</span><span class="ident" id="2596502">ktyp</span><span class="op" id="2596506">)</span><span class="op" id="2596507">.</span><span class="op" id="2596508">(</span><span class="op" id="2596509">*</span><span class="ident" id="2596510">rtype</span><span class="op" id="2596515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596521">if</span>&nbsp;<span class="ident" id="2596524">etyp</span><span class="op" id="2596528">.</span><span class="ident" id="2596529">size</span>&nbsp;<span class="op" id="2596534">&gt;</span>&nbsp;<span class="ident" id="2596536">maxValSize</span>&nbsp;<span class="op" id="2596547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596551">etyp</span>&nbsp;<span class="op" id="2596556">=</span>&nbsp;<span class="ident" id="2596558">PtrTo</span><span class="op" id="2596563">(</span><span class="ident" id="2596564">etyp</span><span class="op" id="2596568">)</span><span class="op" id="2596569">.</span><span class="op" id="2596570">(</span><span class="op" id="2596571">*</span><span class="ident" id="2596572">rtype</span><span class="op" id="2596577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596580">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596583">ptrsize</span>&nbsp;<span class="op" id="2596591">:=</span>&nbsp;<span class="ident" id="2596594">unsafe</span><span class="op" id="2596600">.</span><span class="ident" id="2596601">Sizeof</span><span class="op" id="2596607">(</span><span class="builtintype" id="2596608">uintptr</span><span class="op" id="2596615">(</span><span class="num" id="2596616">0</span><span class="op" id="2596617">)</span><span class="op" id="2596618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596622">var</span>&nbsp;<span class="ident" id="2596626">gc</span>&nbsp;<span class="ident" id="2596629">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2596637">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596649">for</span>&nbsp;<span class="ident" id="2596653">i</span>&nbsp;<span class="op" id="2596655">:=</span>&nbsp;<span class="num" id="2596658">0</span><span class="op" id="2596659">;</span>&nbsp;<span class="ident" id="2596661">i</span>&nbsp;<span class="op" id="2596663">&lt;</span>&nbsp;<span class="builtintype" id="2596665">int</span><span class="op" id="2596668">(</span><span class="ident" id="2596669">bucketSize</span><span class="op" id="2596679">*</span><span class="ident" id="2596680">unsafe</span><span class="op" id="2596686">.</span><span class="ident" id="2596687">Sizeof</span><span class="op" id="2596693">(</span><span class="builtintype" id="2596694">uint8</span><span class="op" id="2596699">(</span><span class="num" id="2596700">0</span><span class="op" id="2596701">)</span><span class="op" id="2596702">)</span><span class="op" id="2596703">/</span><span class="ident" id="2596704">ptrsize</span><span class="op" id="2596711">)</span><span class="op" id="2596712">;</span>&nbsp;<span class="ident" id="2596714">i</span><span class="op" id="2596715">++</span>&nbsp;<span class="op" id="2596718">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596722">gc</span><span class="op" id="2596724">.</span><span class="builtinfunc" id="2596725">append</span><span class="op" id="2596731">(</span><span class="ident" id="2596732">bitsScalar</span><span class="op" id="2596742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596748">gc</span><span class="op" id="2596750">.</span><span class="builtinfunc" id="2596751">append</span><span class="op" id="2596757">(</span><span class="ident" id="2596758">bitsPointer</span><span class="op" id="2596769">)</span>&nbsp;<span class="comment" id="2596771">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596784">if</span>&nbsp;<span class="ident" id="2596787">runtime</span><span class="op" id="2596794">.</span><span class="ident" id="2596795">GOARCH</span>&nbsp;<span class="op" id="2596802">==</span>&nbsp;<span class="string" id="2596805">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2596816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596820">gc</span><span class="op" id="2596822">.</span><span class="builtinfunc" id="2596823">append</span><span class="op" id="2596829">(</span><span class="ident" id="2596830">bitsScalar</span><span class="op" id="2596840">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2596846">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596855">for</span>&nbsp;<span class="ident" id="2596859">i</span>&nbsp;<span class="op" id="2596861">:=</span>&nbsp;<span class="num" id="2596864">0</span><span class="op" id="2596865">;</span>&nbsp;<span class="ident" id="2596867">i</span>&nbsp;<span class="op" id="2596869">&lt;</span>&nbsp;<span class="ident" id="2596871">bucketSize</span><span class="op" id="2596881">;</span>&nbsp;<span class="ident" id="2596883">i</span><span class="op" id="2596884">++</span>&nbsp;<span class="op" id="2596887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596891">gc</span><span class="op" id="2596893">.</span><span class="ident" id="2596894">appendProg</span><span class="op" id="2596904">(</span><span class="ident" id="2596905">ktyp</span><span class="op" id="2596909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596912">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2596915">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596926">for</span>&nbsp;<span class="ident" id="2596930">i</span>&nbsp;<span class="op" id="2596932">:=</span>&nbsp;<span class="num" id="2596935">0</span><span class="op" id="2596936">;</span>&nbsp;<span class="ident" id="2596938">i</span>&nbsp;<span class="op" id="2596940">&lt;</span>&nbsp;<span class="ident" id="2596942">bucketSize</span><span class="op" id="2596952">;</span>&nbsp;<span class="ident" id="2596954">i</span><span class="op" id="2596955">++</span>&nbsp;<span class="op" id="2596958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596962">gc</span><span class="op" id="2596964">.</span><span class="ident" id="2596965">appendProg</span><span class="op" id="2596975">(</span><span class="ident" id="2596976">etyp</span><span class="op" id="2596980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596987">b</span>&nbsp;<span class="op" id="2596989">:=</span>&nbsp;<span class="builtinfunc" id="2596992">new</span><span class="op" id="2596995">(</span><span class="ident" id="2596996">rtype</span><span class="op" id="2597001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597004">b</span><span class="op" id="2597005">.</span><span class="ident" id="2597006">size</span>&nbsp;<span class="op" id="2597011">=</span>&nbsp;<span class="ident" id="2597013">gc</span><span class="op" id="2597015">.</span><span class="ident" id="2597016">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597022">b</span><span class="op" id="2597023">.</span><span class="ident" id="2597024">gc</span><span class="op" id="2597026">[</span><span class="num" id="2597027">0</span><span class="op" id="2597028">]</span>&nbsp;<span class="op" id="2597030">=</span>&nbsp;<span class="ident" id="2597032">gc</span><span class="op" id="2597034">.</span><span class="ident" id="2597035">finalize</span><span class="op" id="2597043">(</span><span class="op" id="2597044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597047">s</span>&nbsp;<span class="op" id="2597049">:=</span>&nbsp;<span class="string" id="2597052">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2597062">+</span>&nbsp;<span class="op" id="2597064">*</span><span class="ident" id="2597065">ktyp</span><span class="op" id="2597069">.</span><span class="builtintype" id="2597070">string</span>&nbsp;<span class="op" id="2597077">+</span>&nbsp;<span class="string" id="2597079">&#34;,&#34;</span>&nbsp;<span class="op" id="2597083">+</span>&nbsp;<span class="op" id="2597085">*</span><span class="ident" id="2597086">etyp</span><span class="op" id="2597090">.</span><span class="builtintype" id="2597091">string</span>&nbsp;<span class="op" id="2597098">+</span>&nbsp;<span class="string" id="2597100">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597105">b</span><span class="op" id="2597106">.</span><span class="builtintype" id="2597107">string</span>&nbsp;<span class="op" id="2597114">=</span>&nbsp;<span class="op" id="2597116">&amp;</span><span class="ident" id="2597117">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597120">return</span>&nbsp;<span class="ident" id="2597127">b</span><br>
<span class="lineno"></span><span class="op" id="2597129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2597132">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2597187">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2597253">func</span>&nbsp;<span class="ident" id="2597258">SliceOf</span><span class="op" id="2597265">(</span><span class="ident" id="2597266">t</span>&nbsp;<span class="ident" id="2597268">Type</span><span class="op" id="2597272">)</span>&nbsp;<span class="ident" id="2597274">Type</span>&nbsp;<span class="op" id="2597279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597282">typ</span>&nbsp;<span class="op" id="2597286">:=</span>&nbsp;<span class="ident" id="2597289">t</span><span class="op" id="2597290">.</span><span class="op" id="2597291">(</span><span class="op" id="2597292">*</span><span class="ident" id="2597293">rtype</span><span class="op" id="2597298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2597302">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597321">ckey</span>&nbsp;<span class="op" id="2597326">:=</span>&nbsp;<span class="ident" id="2597329">cacheKey</span><span class="op" id="2597337">{</span><span class="ident" id="2597338">Slice</span><span class="op" id="2597343">,</span>&nbsp;<span class="ident" id="2597345">typ</span><span class="op" id="2597348">,</span>&nbsp;<span class="ident" id="2597350">nil</span><span class="op" id="2597353">,</span>&nbsp;<span class="num" id="2597355">0</span><span class="op" id="2597356">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597359">if</span>&nbsp;<span class="ident" id="2597362">slice</span>&nbsp;<span class="op" id="2597368">:=</span>&nbsp;<span class="ident" id="2597371">cacheGet</span><span class="op" id="2597379">(</span><span class="ident" id="2597380">ckey</span><span class="op" id="2597384">)</span><span class="op" id="2597385">;</span>&nbsp;<span class="ident" id="2597387">slice</span>&nbsp;<span class="op" id="2597393">!=</span>&nbsp;<span class="ident" id="2597396">nil</span>&nbsp;<span class="op" id="2597400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597404">return</span>&nbsp;<span class="ident" id="2597411">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2597422">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597447">s</span>&nbsp;<span class="op" id="2597449">:=</span>&nbsp;<span class="string" id="2597452">&#34;[]&#34;</span>&nbsp;<span class="op" id="2597457">+</span>&nbsp;<span class="op" id="2597459">*</span><span class="ident" id="2597460">typ</span><span class="op" id="2597463">.</span><span class="builtintype" id="2597464">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597472">for</span>&nbsp;<span class="ident" id="2597476">_</span><span class="op" id="2597477">,</span>&nbsp;<span class="ident" id="2597479">tt</span>&nbsp;<span class="op" id="2597482">:=</span>&nbsp;<span class="keyword" id="2597485">range</span>&nbsp;<span class="ident" id="2597491">typesByString</span><span class="op" id="2597504">(</span><span class="ident" id="2597505">s</span><span class="op" id="2597506">)</span>&nbsp;<span class="op" id="2597508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597512">slice</span>&nbsp;<span class="op" id="2597518">:=</span>&nbsp;<span class="op" id="2597521">(</span><span class="op" id="2597522">*</span><span class="ident" id="2597523">sliceType</span><span class="op" id="2597532">)</span><span class="op" id="2597533">(</span><span class="ident" id="2597534">unsafe</span><span class="op" id="2597540">.</span><span class="ident" id="2597541">Pointer</span><span class="op" id="2597548">(</span><span class="ident" id="2597549">tt</span><span class="op" id="2597551">)</span><span class="op" id="2597552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597556">if</span>&nbsp;<span class="ident" id="2597559">slice</span><span class="op" id="2597564">.</span><span class="ident" id="2597565">elem</span>&nbsp;<span class="op" id="2597570">==</span>&nbsp;<span class="ident" id="2597573">typ</span>&nbsp;<span class="op" id="2597577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597582">return</span>&nbsp;<span class="ident" id="2597589">cachePut</span><span class="op" id="2597597">(</span><span class="ident" id="2597598">ckey</span><span class="op" id="2597602">,</span>&nbsp;<span class="ident" id="2597604">tt</span><span class="op" id="2597606">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2597617">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597640">var</span>&nbsp;<span class="ident" id="2597644">islice</span>&nbsp;<span class="keyword" id="2597651">interface</span><span class="op" id="2597660">{</span><span class="op" id="2597661">}</span>&nbsp;<span class="op" id="2597663">=</span>&nbsp;<span class="op" id="2597665">(</span><span class="op" id="2597666">[</span><span class="op" id="2597667">]</span><span class="ident" id="2597668">unsafe</span><span class="op" id="2597674">.</span><span class="ident" id="2597675">Pointer</span><span class="op" id="2597682">)</span><span class="op" id="2597683">(</span><span class="ident" id="2597684">nil</span><span class="op" id="2597687">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597690">prototype</span>&nbsp;<span class="op" id="2597700">:=</span>&nbsp;<span class="op" id="2597703">*</span><span class="op" id="2597704">(</span><span class="op" id="2597705">*</span><span class="op" id="2597706">*</span><span class="ident" id="2597707">sliceType</span><span class="op" id="2597716">)</span><span class="op" id="2597717">(</span><span class="ident" id="2597718">unsafe</span><span class="op" id="2597724">.</span><span class="ident" id="2597725">Pointer</span><span class="op" id="2597732">(</span><span class="op" id="2597733">&amp;</span><span class="ident" id="2597734">islice</span><span class="op" id="2597740">)</span><span class="op" id="2597741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597744">slice</span>&nbsp;<span class="op" id="2597750">:=</span>&nbsp;<span class="builtinfunc" id="2597753">new</span><span class="op" id="2597756">(</span><span class="ident" id="2597757">sliceType</span><span class="op" id="2597766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597769">*</span><span class="ident" id="2597770">slice</span>&nbsp;<span class="op" id="2597776">=</span>&nbsp;<span class="op" id="2597778">*</span><span class="ident" id="2597779">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597790">slice</span><span class="op" id="2597795">.</span><span class="builtintype" id="2597796">string</span>&nbsp;<span class="op" id="2597803">=</span>&nbsp;<span class="op" id="2597805">&amp;</span><span class="ident" id="2597806">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597809">slice</span><span class="op" id="2597814">.</span><span class="ident" id="2597815">hash</span>&nbsp;<span class="op" id="2597820">=</span>&nbsp;<span class="ident" id="2597822">fnv1</span><span class="op" id="2597826">(</span><span class="ident" id="2597827">typ</span><span class="op" id="2597830">.</span><span class="ident" id="2597831">hash</span><span class="op" id="2597835">,</span>&nbsp;<span class="string" id="2597837">&#39;[&#39;</span><span class="op" id="2597840">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597843">slice</span><span class="op" id="2597848">.</span><span class="ident" id="2597849">elem</span>&nbsp;<span class="op" id="2597854">=</span>&nbsp;<span class="ident" id="2597856">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597861">slice</span><span class="op" id="2597866">.</span><span class="ident" id="2597867">uncommonType</span>&nbsp;<span class="op" id="2597880">=</span>&nbsp;<span class="ident" id="2597882">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597887">slice</span><span class="op" id="2597892">.</span><span class="ident" id="2597893">ptrToThis</span>&nbsp;<span class="op" id="2597903">=</span>&nbsp;<span class="ident" id="2597905">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597910">slice</span><span class="op" id="2597915">.</span><span class="ident" id="2597916">zero</span>&nbsp;<span class="op" id="2597921">=</span>&nbsp;<span class="ident" id="2597923">unsafe</span><span class="op" id="2597929">.</span><span class="ident" id="2597930">Pointer</span><span class="op" id="2597937">(</span><span class="op" id="2597938">&amp;</span><span class="builtinfunc" id="2597939">make</span><span class="op" id="2597943">(</span><span class="op" id="2597944">[</span><span class="op" id="2597945">]</span><span class="builtintype" id="2597946">byte</span><span class="op" id="2597950">,</span>&nbsp;<span class="ident" id="2597952">slice</span><span class="op" id="2597957">.</span><span class="ident" id="2597958">size</span><span class="op" id="2597962">)</span><span class="op" id="2597963">[</span><span class="num" id="2597964">0</span><span class="op" id="2597965">]</span><span class="op" id="2597966">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597970">return</span>&nbsp;<span class="ident" id="2597977">cachePut</span><span class="op" id="2597985">(</span><span class="ident" id="2597986">ckey</span><span class="op" id="2597990">,</span>&nbsp;<span class="op" id="2597992">&amp;</span><span class="ident" id="2597993">slice</span><span class="op" id="2597998">.</span><span class="ident" id="2597999">rtype</span><span class="op" id="2598004">)</span><br>
<span class="lineno"></span><span class="op" id="2598006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2598009">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2598082">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2598152">//</span><br>
<span class="lineno"></span><span class="comment" id="2598155">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2598230">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2598249">//</span><br>
<span class="lineno"></span><span class="comment" id="2598252">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2598329">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2598381">//</span><br>
<span class="lineno"></span><span class="comment" id="2598384">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2598439">func</span>&nbsp;<span class="ident" id="2598444">arrayOf</span><span class="op" id="2598451">(</span><span class="ident" id="2598452">count</span>&nbsp;<span class="builtintype" id="2598458">int</span><span class="op" id="2598461">,</span>&nbsp;<span class="ident" id="2598463">elem</span>&nbsp;<span class="ident" id="2598468">Type</span><span class="op" id="2598472">)</span>&nbsp;<span class="ident" id="2598474">Type</span>&nbsp;<span class="op" id="2598479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598482">typ</span>&nbsp;<span class="op" id="2598486">:=</span>&nbsp;<span class="ident" id="2598489">elem</span><span class="op" id="2598493">.</span><span class="op" id="2598494">(</span><span class="op" id="2598495">*</span><span class="ident" id="2598496">rtype</span><span class="op" id="2598501">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598504">slice</span>&nbsp;<span class="op" id="2598510">:=</span>&nbsp;<span class="ident" id="2598513">SliceOf</span><span class="op" id="2598520">(</span><span class="ident" id="2598521">elem</span><span class="op" id="2598525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2598529">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598548">ckey</span>&nbsp;<span class="op" id="2598553">:=</span>&nbsp;<span class="ident" id="2598556">cacheKey</span><span class="op" id="2598564">{</span><span class="ident" id="2598565">Array</span><span class="op" id="2598570">,</span>&nbsp;<span class="ident" id="2598572">typ</span><span class="op" id="2598575">,</span>&nbsp;<span class="ident" id="2598577">nil</span><span class="op" id="2598580">,</span>&nbsp;<span class="builtintype" id="2598582">uintptr</span><span class="op" id="2598589">(</span><span class="ident" id="2598590">count</span><span class="op" id="2598595">)</span><span class="op" id="2598596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598599">if</span>&nbsp;<span class="ident" id="2598602">slice</span>&nbsp;<span class="op" id="2598608">:=</span>&nbsp;<span class="ident" id="2598611">cacheGet</span><span class="op" id="2598619">(</span><span class="ident" id="2598620">ckey</span><span class="op" id="2598624">)</span><span class="op" id="2598625">;</span>&nbsp;<span class="ident" id="2598627">slice</span>&nbsp;<span class="op" id="2598633">!=</span>&nbsp;<span class="ident" id="2598636">nil</span>&nbsp;<span class="op" id="2598640">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598644">return</span>&nbsp;<span class="ident" id="2598651">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2598662">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598687">s</span>&nbsp;<span class="op" id="2598689">:=</span>&nbsp;<span class="string" id="2598692">&#34;[&#34;</span>&nbsp;<span class="op" id="2598696">+</span>&nbsp;<span class="ident" id="2598698">strconv</span><span class="op" id="2598705">.</span><span class="ident" id="2598706">Itoa</span><span class="op" id="2598710">(</span><span class="ident" id="2598711">count</span><span class="op" id="2598716">)</span>&nbsp;<span class="op" id="2598718">+</span>&nbsp;<span class="string" id="2598720">&#34;]&#34;</span>&nbsp;<span class="op" id="2598724">+</span>&nbsp;<span class="op" id="2598726">*</span><span class="ident" id="2598727">typ</span><span class="op" id="2598730">.</span><span class="builtintype" id="2598731">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598739">for</span>&nbsp;<span class="ident" id="2598743">_</span><span class="op" id="2598744">,</span>&nbsp;<span class="ident" id="2598746">tt</span>&nbsp;<span class="op" id="2598749">:=</span>&nbsp;<span class="keyword" id="2598752">range</span>&nbsp;<span class="ident" id="2598758">typesByString</span><span class="op" id="2598771">(</span><span class="ident" id="2598772">s</span><span class="op" id="2598773">)</span>&nbsp;<span class="op" id="2598775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598779">slice</span>&nbsp;<span class="op" id="2598785">:=</span>&nbsp;<span class="op" id="2598788">(</span><span class="op" id="2598789">*</span><span class="ident" id="2598790">sliceType</span><span class="op" id="2598799">)</span><span class="op" id="2598800">(</span><span class="ident" id="2598801">unsafe</span><span class="op" id="2598807">.</span><span class="ident" id="2598808">Pointer</span><span class="op" id="2598815">(</span><span class="ident" id="2598816">tt</span><span class="op" id="2598818">)</span><span class="op" id="2598819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598823">if</span>&nbsp;<span class="ident" id="2598826">slice</span><span class="op" id="2598831">.</span><span class="ident" id="2598832">elem</span>&nbsp;<span class="op" id="2598837">==</span>&nbsp;<span class="ident" id="2598840">typ</span>&nbsp;<span class="op" id="2598844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598849">return</span>&nbsp;<span class="ident" id="2598856">cachePut</span><span class="op" id="2598864">(</span><span class="ident" id="2598865">ckey</span><span class="op" id="2598869">,</span>&nbsp;<span class="ident" id="2598871">tt</span><span class="op" id="2598873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598877">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2598884">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598908">var</span>&nbsp;<span class="ident" id="2598912">iarray</span>&nbsp;<span class="keyword" id="2598919">interface</span><span class="op" id="2598928">{</span><span class="op" id="2598929">}</span>&nbsp;<span class="op" id="2598931">=</span>&nbsp;<span class="op" id="2598933">[</span><span class="num" id="2598934">1</span><span class="op" id="2598935">]</span><span class="ident" id="2598936">unsafe</span><span class="op" id="2598942">.</span><span class="ident" id="2598943">Pointer</span><span class="op" id="2598950">{</span><span class="op" id="2598951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598954">prototype</span>&nbsp;<span class="op" id="2598964">:=</span>&nbsp;<span class="op" id="2598967">*</span><span class="op" id="2598968">(</span><span class="op" id="2598969">*</span><span class="op" id="2598970">*</span><span class="ident" id="2598971">arrayType</span><span class="op" id="2598980">)</span><span class="op" id="2598981">(</span><span class="ident" id="2598982">unsafe</span><span class="op" id="2598988">.</span><span class="ident" id="2598989">Pointer</span><span class="op" id="2598996">(</span><span class="op" id="2598997">&amp;</span><span class="ident" id="2598998">iarray</span><span class="op" id="2599004">)</span><span class="op" id="2599005">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599008">array</span>&nbsp;<span class="op" id="2599014">:=</span>&nbsp;<span class="builtinfunc" id="2599017">new</span><span class="op" id="2599020">(</span><span class="ident" id="2599021">arrayType</span><span class="op" id="2599030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599033">*</span><span class="ident" id="2599034">array</span>&nbsp;<span class="op" id="2599040">=</span>&nbsp;<span class="op" id="2599042">*</span><span class="ident" id="2599043">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599054">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599095">array</span><span class="op" id="2599100">.</span><span class="builtintype" id="2599101">string</span>&nbsp;<span class="op" id="2599108">=</span>&nbsp;<span class="op" id="2599110">&amp;</span><span class="ident" id="2599111">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599114">array</span><span class="op" id="2599119">.</span><span class="ident" id="2599120">hash</span>&nbsp;<span class="op" id="2599125">=</span>&nbsp;<span class="ident" id="2599127">fnv1</span><span class="op" id="2599131">(</span><span class="ident" id="2599132">typ</span><span class="op" id="2599135">.</span><span class="ident" id="2599136">hash</span><span class="op" id="2599140">,</span>&nbsp;<span class="string" id="2599142">&#39;[&#39;</span><span class="op" id="2599145">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599148">for</span>&nbsp;<span class="ident" id="2599152">n</span>&nbsp;<span class="op" id="2599154">:=</span>&nbsp;<span class="builtintype" id="2599157">uint32</span><span class="op" id="2599163">(</span><span class="ident" id="2599164">count</span><span class="op" id="2599169">)</span><span class="op" id="2599170">;</span>&nbsp;<span class="ident" id="2599172">n</span>&nbsp;<span class="op" id="2599174">&gt;</span>&nbsp;<span class="num" id="2599176">0</span><span class="op" id="2599177">;</span>&nbsp;<span class="ident" id="2599179">n</span>&nbsp;<span class="op" id="2599181">&gt;&gt;=</span>&nbsp;<span class="num" id="2599185">8</span>&nbsp;<span class="op" id="2599187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599191">array</span><span class="op" id="2599196">.</span><span class="ident" id="2599197">hash</span>&nbsp;<span class="op" id="2599202">=</span>&nbsp;<span class="ident" id="2599204">fnv1</span><span class="op" id="2599208">(</span><span class="ident" id="2599209">array</span><span class="op" id="2599214">.</span><span class="ident" id="2599215">hash</span><span class="op" id="2599219">,</span>&nbsp;<span class="builtintype" id="2599221">byte</span><span class="op" id="2599225">(</span><span class="ident" id="2599226">n</span><span class="op" id="2599227">)</span><span class="op" id="2599228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599234">array</span><span class="op" id="2599239">.</span><span class="ident" id="2599240">hash</span>&nbsp;<span class="op" id="2599245">=</span>&nbsp;<span class="ident" id="2599247">fnv1</span><span class="op" id="2599251">(</span><span class="ident" id="2599252">array</span><span class="op" id="2599257">.</span><span class="ident" id="2599258">hash</span><span class="op" id="2599262">,</span>&nbsp;<span class="string" id="2599264">&#39;]&#39;</span><span class="op" id="2599267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599270">array</span><span class="op" id="2599275">.</span><span class="ident" id="2599276">elem</span>&nbsp;<span class="op" id="2599281">=</span>&nbsp;<span class="ident" id="2599283">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599288">max</span>&nbsp;<span class="op" id="2599292">:=</span>&nbsp;<span class="op" id="2599295">^</span><span class="builtintype" id="2599296">uintptr</span><span class="op" id="2599303">(</span><span class="num" id="2599304">0</span><span class="op" id="2599305">)</span>&nbsp;<span class="op" id="2599307">/</span>&nbsp;<span class="ident" id="2599309">typ</span><span class="op" id="2599312">.</span><span class="ident" id="2599313">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599319">if</span>&nbsp;<span class="builtintype" id="2599322">uintptr</span><span class="op" id="2599329">(</span><span class="ident" id="2599330">count</span><span class="op" id="2599335">)</span>&nbsp;<span class="op" id="2599337">&gt;</span>&nbsp;<span class="ident" id="2599339">max</span>&nbsp;<span class="op" id="2599343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2599347">panic</span><span class="op" id="2599352">(</span><span class="string" id="2599353">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2599417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599423">array</span><span class="op" id="2599428">.</span><span class="ident" id="2599429">size</span>&nbsp;<span class="op" id="2599434">=</span>&nbsp;<span class="ident" id="2599436">typ</span><span class="op" id="2599439">.</span><span class="ident" id="2599440">size</span>&nbsp;<span class="op" id="2599445">*</span>&nbsp;<span class="builtintype" id="2599447">uintptr</span><span class="op" id="2599454">(</span><span class="ident" id="2599455">count</span><span class="op" id="2599460">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599463">array</span><span class="op" id="2599468">.</span><span class="ident" id="2599469">align</span>&nbsp;<span class="op" id="2599475">=</span>&nbsp;<span class="ident" id="2599477">typ</span><span class="op" id="2599480">.</span><span class="ident" id="2599481">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599488">array</span><span class="op" id="2599493">.</span><span class="ident" id="2599494">fieldAlign</span>&nbsp;<span class="op" id="2599505">=</span>&nbsp;<span class="ident" id="2599507">typ</span><span class="op" id="2599510">.</span><span class="ident" id="2599511">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599523">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599543">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2599562">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599572">array</span><span class="op" id="2599577">.</span><span class="ident" id="2599578">uncommonType</span>&nbsp;<span class="op" id="2599591">=</span>&nbsp;<span class="ident" id="2599593">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599598">array</span><span class="op" id="2599603">.</span><span class="ident" id="2599604">ptrToThis</span>&nbsp;<span class="op" id="2599614">=</span>&nbsp;<span class="ident" id="2599616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599621">array</span><span class="op" id="2599626">.</span><span class="ident" id="2599627">zero</span>&nbsp;<span class="op" id="2599632">=</span>&nbsp;<span class="ident" id="2599634">unsafe</span><span class="op" id="2599640">.</span><span class="ident" id="2599641">Pointer</span><span class="op" id="2599648">(</span><span class="op" id="2599649">&amp;</span><span class="builtinfunc" id="2599650">make</span><span class="op" id="2599654">(</span><span class="op" id="2599655">[</span><span class="op" id="2599656">]</span><span class="builtintype" id="2599657">byte</span><span class="op" id="2599661">,</span>&nbsp;<span class="ident" id="2599663">array</span><span class="op" id="2599668">.</span><span class="ident" id="2599669">size</span><span class="op" id="2599673">)</span><span class="op" id="2599674">[</span><span class="num" id="2599675">0</span><span class="op" id="2599676">]</span><span class="op" id="2599677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599680">array</span><span class="op" id="2599685">.</span><span class="builtinfunc" id="2599686">len</span>&nbsp;<span class="op" id="2599690">=</span>&nbsp;<span class="builtintype" id="2599692">uintptr</span><span class="op" id="2599699">(</span><span class="ident" id="2599700">count</span><span class="op" id="2599705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599708">array</span><span class="op" id="2599713">.</span><span class="ident" id="2599714">slice</span>&nbsp;<span class="op" id="2599720">=</span>&nbsp;<span class="ident" id="2599722">slice</span><span class="op" id="2599727">.</span><span class="op" id="2599728">(</span><span class="op" id="2599729">*</span><span class="ident" id="2599730">rtype</span><span class="op" id="2599735">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599739">return</span>&nbsp;<span class="ident" id="2599746">cachePut</span><span class="op" id="2599754">(</span><span class="ident" id="2599755">ckey</span><span class="op" id="2599759">,</span>&nbsp;<span class="op" id="2599761">&amp;</span><span class="ident" id="2599762">array</span><span class="op" id="2599767">.</span><span class="ident" id="2599768">rtype</span><span class="op" id="2599773">)</span><br>
<span class="lineno"></span><span class="op" id="2599775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2599778">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2599842">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2599911">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2599977">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2600046">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2600088">func</span>&nbsp;<span class="ident" id="2600093">toType</span><span class="op" id="2600099">(</span><span class="ident" id="2600100">t</span>&nbsp;<span class="op" id="2600102">*</span><span class="ident" id="2600103">rtype</span><span class="op" id="2600108">)</span>&nbsp;<span class="ident" id="2600110">Type</span>&nbsp;<span class="op" id="2600115">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600118">if</span>&nbsp;<span class="ident" id="2600121">t</span>&nbsp;<span class="op" id="2600123">==</span>&nbsp;<span class="ident" id="2600126">nil</span>&nbsp;<span class="op" id="2600130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600134">return</span>&nbsp;<span class="ident" id="2600141">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600149">return</span>&nbsp;<span class="ident" id="2600156">t</span><br>
<span class="lineno"></span><span class="op" id="2600158">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2600161">type</span>&nbsp;<span class="ident" id="2600166">layoutKey</span>&nbsp;<span class="keyword" id="2600176">struct</span>&nbsp;<span class="op" id="2600183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600186">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2600191">*</span><span class="ident" id="2600192">rtype</span>&nbsp;<span class="comment" id="2600198">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600221">rcvr</span>&nbsp;<span class="op" id="2600226">*</span><span class="ident" id="2600227">rtype</span>&nbsp;<span class="comment" id="2600233">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2600266">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2600269">type</span>&nbsp;<span class="ident" id="2600274">layoutType</span>&nbsp;<span class="keyword" id="2600285">struct</span>&nbsp;<span class="op" id="2600292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600295">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2600305">*</span><span class="ident" id="2600306">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600313">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2600323">uintptr</span>&nbsp;<span class="comment" id="2600331">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600353">retOffset</span>&nbsp;<span class="builtintype" id="2600363">uintptr</span>&nbsp;<span class="comment" id="2600371">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600400">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2600410">*</span><span class="ident" id="2600411">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2600421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2600424">var</span>&nbsp;<span class="ident" id="2600428">layoutCache</span>&nbsp;<span class="keyword" id="2600440">struct</span>&nbsp;<span class="op" id="2600447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600450">sync</span><span class="op" id="2600454">.</span><span class="ident" id="2600455">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600464">m</span>&nbsp;<span class="keyword" id="2600466">map</span><span class="op" id="2600469">[</span><span class="ident" id="2600470">layoutKey</span><span class="op" id="2600479">]</span><span class="ident" id="2600480">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2600491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2600494">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2600562">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2600627">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2600687">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2600766">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2600834">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2600874">func</span>&nbsp;<span class="ident" id="2600879">funcLayout</span><span class="op" id="2600889">(</span><span class="ident" id="2600890">t</span>&nbsp;<span class="op" id="2600892">*</span><span class="ident" id="2600893">rtype</span><span class="op" id="2600898">,</span>&nbsp;<span class="ident" id="2600900">rcvr</span>&nbsp;<span class="op" id="2600905">*</span><span class="ident" id="2600906">rtype</span><span class="op" id="2600911">)</span>&nbsp;<span class="op" id="2600913">(</span><span class="ident" id="2600914">frametype</span>&nbsp;<span class="op" id="2600924">*</span><span class="ident" id="2600925">rtype</span><span class="op" id="2600930">,</span>&nbsp;<span class="ident" id="2600932">argSize</span><span class="op" id="2600939">,</span>&nbsp;<span class="ident" id="2600941">retOffset</span>&nbsp;<span class="builtintype" id="2600951">uintptr</span><span class="op" id="2600958">,</span>&nbsp;<span class="ident" id="2600960">stack</span>&nbsp;<span class="op" id="2600966">*</span><span class="ident" id="2600967">bitVector</span><span class="op" id="2600976">)</span>&nbsp;<span class="op" id="2600978">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600981">if</span>&nbsp;<span class="ident" id="2600984">t</span><span class="op" id="2600985">.</span><span class="ident" id="2600986">Kind</span><span class="op" id="2600990">(</span><span class="op" id="2600991">)</span>&nbsp;<span class="op" id="2600993">!=</span>&nbsp;<span class="ident" id="2600996">Func</span>&nbsp;<span class="op" id="2601001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2601005">panic</span><span class="op" id="2601010">(</span><span class="string" id="2601011">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2601049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601055">if</span>&nbsp;<span class="ident" id="2601058">rcvr</span>&nbsp;<span class="op" id="2601063">!=</span>&nbsp;<span class="ident" id="2601066">nil</span>&nbsp;<span class="op" id="2601070">&amp;&amp;</span>&nbsp;<span class="ident" id="2601073">rcvr</span><span class="op" id="2601077">.</span><span class="ident" id="2601078">Kind</span><span class="op" id="2601082">(</span><span class="op" id="2601083">)</span>&nbsp;<span class="op" id="2601085">==</span>&nbsp;<span class="ident" id="2601088">Interface</span>&nbsp;<span class="op" id="2601098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2601102">panic</span><span class="op" id="2601107">(</span><span class="string" id="2601108">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2601155">+</span>&nbsp;<span class="ident" id="2601157">rcvr</span><span class="op" id="2601161">.</span><span class="ident" id="2601162">String</span><span class="op" id="2601168">(</span><span class="op" id="2601169">)</span><span class="op" id="2601170">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601176">k</span>&nbsp;<span class="op" id="2601178">:=</span>&nbsp;<span class="ident" id="2601181">layoutKey</span><span class="op" id="2601190">{</span><span class="ident" id="2601191">t</span><span class="op" id="2601192">,</span>&nbsp;<span class="ident" id="2601194">rcvr</span><span class="op" id="2601198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601201">layoutCache</span><span class="op" id="2601212">.</span><span class="ident" id="2601213">RLock</span><span class="op" id="2601218">(</span><span class="op" id="2601219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601222">if</span>&nbsp;<span class="ident" id="2601225">x</span>&nbsp;<span class="op" id="2601227">:=</span>&nbsp;<span class="ident" id="2601230">layoutCache</span><span class="op" id="2601241">.</span><span class="ident" id="2601242">m</span><span class="op" id="2601243">[</span><span class="ident" id="2601244">k</span><span class="op" id="2601245">]</span><span class="op" id="2601246">;</span>&nbsp;<span class="ident" id="2601248">x</span><span class="op" id="2601249">.</span><span class="ident" id="2601250">t</span>&nbsp;<span class="op" id="2601252">!=</span>&nbsp;<span class="ident" id="2601255">nil</span>&nbsp;<span class="op" id="2601259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601263">layoutCache</span><span class="op" id="2601274">.</span><span class="ident" id="2601275">RUnlock</span><span class="op" id="2601282">(</span><span class="op" id="2601283">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601287">return</span>&nbsp;<span class="ident" id="2601294">x</span><span class="op" id="2601295">.</span><span class="ident" id="2601296">t</span><span class="op" id="2601297">,</span>&nbsp;<span class="ident" id="2601299">x</span><span class="op" id="2601300">.</span><span class="ident" id="2601301">argSize</span><span class="op" id="2601308">,</span>&nbsp;<span class="ident" id="2601310">x</span><span class="op" id="2601311">.</span><span class="ident" id="2601312">retOffset</span><span class="op" id="2601321">,</span>&nbsp;<span class="ident" id="2601323">x</span><span class="op" id="2601324">.</span><span class="ident" id="2601325">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601335">layoutCache</span><span class="op" id="2601346">.</span><span class="ident" id="2601347">RUnlock</span><span class="op" id="2601354">(</span><span class="op" id="2601355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601358">layoutCache</span><span class="op" id="2601369">.</span><span class="ident" id="2601370">Lock</span><span class="op" id="2601374">(</span><span class="op" id="2601375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601378">if</span>&nbsp;<span class="ident" id="2601381">x</span>&nbsp;<span class="op" id="2601383">:=</span>&nbsp;<span class="ident" id="2601386">layoutCache</span><span class="op" id="2601397">.</span><span class="ident" id="2601398">m</span><span class="op" id="2601399">[</span><span class="ident" id="2601400">k</span><span class="op" id="2601401">]</span><span class="op" id="2601402">;</span>&nbsp;<span class="ident" id="2601404">x</span><span class="op" id="2601405">.</span><span class="ident" id="2601406">t</span>&nbsp;<span class="op" id="2601408">!=</span>&nbsp;<span class="ident" id="2601411">nil</span>&nbsp;<span class="op" id="2601415">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601419">layoutCache</span><span class="op" id="2601430">.</span><span class="ident" id="2601431">Unlock</span><span class="op" id="2601437">(</span><span class="op" id="2601438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601442">return</span>&nbsp;<span class="ident" id="2601449">x</span><span class="op" id="2601450">.</span><span class="ident" id="2601451">t</span><span class="op" id="2601452">,</span>&nbsp;<span class="ident" id="2601454">x</span><span class="op" id="2601455">.</span><span class="ident" id="2601456">argSize</span><span class="op" id="2601463">,</span>&nbsp;<span class="ident" id="2601465">x</span><span class="op" id="2601466">.</span><span class="ident" id="2601467">retOffset</span><span class="op" id="2601476">,</span>&nbsp;<span class="ident" id="2601478">x</span><span class="op" id="2601479">.</span><span class="ident" id="2601480">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601491">tt</span>&nbsp;<span class="op" id="2601494">:=</span>&nbsp;<span class="op" id="2601497">(</span><span class="op" id="2601498">*</span><span class="ident" id="2601499">funcType</span><span class="op" id="2601507">)</span><span class="op" id="2601508">(</span><span class="ident" id="2601509">unsafe</span><span class="op" id="2601515">.</span><span class="ident" id="2601516">Pointer</span><span class="op" id="2601523">(</span><span class="ident" id="2601524">t</span><span class="op" id="2601525">)</span><span class="op" id="2601526">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601530">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601582">stack</span>&nbsp;<span class="op" id="2601588">=</span>&nbsp;<span class="builtinfunc" id="2601590">new</span><span class="op" id="2601593">(</span><span class="ident" id="2601594">bitVector</span><span class="op" id="2601603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601606">var</span>&nbsp;<span class="ident" id="2601610">gc</span>&nbsp;<span class="ident" id="2601613">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601621">var</span>&nbsp;<span class="ident" id="2601625">offset</span>&nbsp;<span class="builtintype" id="2601632">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601641">if</span>&nbsp;<span class="ident" id="2601644">rcvr</span>&nbsp;<span class="op" id="2601649">!=</span>&nbsp;<span class="ident" id="2601652">nil</span>&nbsp;<span class="op" id="2601656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601660">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601717">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601773">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601821">if</span>&nbsp;<span class="ident" id="2601824">ifaceIndir</span><span class="op" id="2601834">(</span><span class="ident" id="2601835">rcvr</span><span class="op" id="2601839">)</span>&nbsp;<span class="op" id="2601841">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601846">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601887">gc</span><span class="op" id="2601889">.</span><span class="builtinfunc" id="2601890">append</span><span class="op" id="2601896">(</span><span class="ident" id="2601897">bitsPointer</span><span class="op" id="2601908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601913">stack</span><span class="op" id="2601918">.</span><span class="ident" id="2601919">append2</span><span class="op" id="2601926">(</span><span class="ident" id="2601927">bitsPointer</span><span class="op" id="2601938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601942">}</span>&nbsp;<span class="keyword" id="2601944">else</span>&nbsp;<span class="keyword" id="2601949">if</span>&nbsp;<span class="ident" id="2601952">rcvr</span><span class="op" id="2601956">.</span><span class="ident" id="2601957">pointers</span><span class="op" id="2601965">(</span><span class="op" id="2601966">)</span>&nbsp;<span class="op" id="2601968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2601973">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2602030">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602063">gc</span><span class="op" id="2602065">.</span><span class="builtinfunc" id="2602066">append</span><span class="op" id="2602072">(</span><span class="ident" id="2602073">bitsPointer</span><span class="op" id="2602084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602089">stack</span><span class="op" id="2602094">.</span><span class="ident" id="2602095">append2</span><span class="op" id="2602102">(</span><span class="ident" id="2602103">bitsPointer</span><span class="op" id="2602114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602118">}</span>&nbsp;<span class="keyword" id="2602120">else</span>&nbsp;<span class="op" id="2602125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602130">gc</span><span class="op" id="2602132">.</span><span class="builtinfunc" id="2602133">append</span><span class="op" id="2602139">(</span><span class="ident" id="2602140">bitsScalar</span><span class="op" id="2602150">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602155">stack</span><span class="op" id="2602160">.</span><span class="ident" id="2602161">append2</span><span class="op" id="2602168">(</span><span class="ident" id="2602169">bitsScalar</span><span class="op" id="2602179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602187">offset</span>&nbsp;<span class="op" id="2602194">+=</span>&nbsp;<span class="ident" id="2602197">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602209">for</span>&nbsp;<span class="ident" id="2602213">_</span><span class="op" id="2602214">,</span>&nbsp;<span class="ident" id="2602216">arg</span>&nbsp;<span class="op" id="2602220">:=</span>&nbsp;<span class="keyword" id="2602223">range</span>&nbsp;<span class="ident" id="2602229">tt</span><span class="op" id="2602231">.</span><span class="ident" id="2602232">in</span>&nbsp;<span class="op" id="2602235">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602239">gc</span><span class="op" id="2602241">.</span><span class="ident" id="2602242">appendProg</span><span class="op" id="2602252">(</span><span class="ident" id="2602253">arg</span><span class="op" id="2602256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602260">addTypeBits</span><span class="op" id="2602271">(</span><span class="ident" id="2602272">stack</span><span class="op" id="2602277">,</span>&nbsp;<span class="op" id="2602279">&amp;</span><span class="ident" id="2602280">offset</span><span class="op" id="2602286">,</span>&nbsp;<span class="ident" id="2602288">arg</span><span class="op" id="2602291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602297">argSize</span>&nbsp;<span class="op" id="2602305">=</span>&nbsp;<span class="ident" id="2602307">gc</span><span class="op" id="2602309">.</span><span class="ident" id="2602310">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602316">if</span>&nbsp;<span class="ident" id="2602319">runtime</span><span class="op" id="2602326">.</span><span class="ident" id="2602327">GOARCH</span>&nbsp;<span class="op" id="2602334">==</span>&nbsp;<span class="string" id="2602337">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2602348">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602352">gc</span><span class="op" id="2602354">.</span><span class="ident" id="2602355">align</span><span class="op" id="2602360">(</span><span class="num" id="2602361">8</span><span class="op" id="2602362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602368">gc</span><span class="op" id="2602370">.</span><span class="ident" id="2602371">align</span><span class="op" id="2602376">(</span><span class="ident" id="2602377">ptrSize</span><span class="op" id="2602384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602387">retOffset</span>&nbsp;<span class="op" id="2602397">=</span>&nbsp;<span class="ident" id="2602399">gc</span><span class="op" id="2602401">.</span><span class="ident" id="2602402">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602408">for</span>&nbsp;<span class="ident" id="2602412">_</span><span class="op" id="2602413">,</span>&nbsp;<span class="ident" id="2602415">res</span>&nbsp;<span class="op" id="2602419">:=</span>&nbsp;<span class="keyword" id="2602422">range</span>&nbsp;<span class="ident" id="2602428">tt</span><span class="op" id="2602430">.</span><span class="ident" id="2602431">out</span>&nbsp;<span class="op" id="2602435">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602439">gc</span><span class="op" id="2602441">.</span><span class="ident" id="2602442">appendProg</span><span class="op" id="2602452">(</span><span class="ident" id="2602453">res</span><span class="op" id="2602456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2602460">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602503">gc</span><span class="op" id="2602505">.</span><span class="ident" id="2602506">align</span><span class="op" id="2602511">(</span><span class="ident" id="2602512">ptrSize</span><span class="op" id="2602519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2602523">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602564">x</span>&nbsp;<span class="op" id="2602566">:=</span>&nbsp;<span class="builtinfunc" id="2602569">new</span><span class="op" id="2602572">(</span><span class="ident" id="2602573">rtype</span><span class="op" id="2602578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602581">x</span><span class="op" id="2602582">.</span><span class="ident" id="2602583">size</span>&nbsp;<span class="op" id="2602588">=</span>&nbsp;<span class="ident" id="2602590">gc</span><span class="op" id="2602592">.</span><span class="ident" id="2602593">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602599">x</span><span class="op" id="2602600">.</span><span class="ident" id="2602601">gc</span><span class="op" id="2602603">[</span><span class="num" id="2602604">0</span><span class="op" id="2602605">]</span>&nbsp;<span class="op" id="2602607">=</span>&nbsp;<span class="ident" id="2602609">gc</span><span class="op" id="2602611">.</span><span class="ident" id="2602612">finalize</span><span class="op" id="2602620">(</span><span class="op" id="2602621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602624">var</span>&nbsp;<span class="ident" id="2602628">s</span>&nbsp;<span class="builtintype" id="2602630">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602638">if</span>&nbsp;<span class="ident" id="2602641">rcvr</span>&nbsp;<span class="op" id="2602646">!=</span>&nbsp;<span class="ident" id="2602649">nil</span>&nbsp;<span class="op" id="2602653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602657">s</span>&nbsp;<span class="op" id="2602659">=</span>&nbsp;<span class="string" id="2602661">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2602675">+</span>&nbsp;<span class="op" id="2602677">*</span><span class="ident" id="2602678">rcvr</span><span class="op" id="2602682">.</span><span class="builtintype" id="2602683">string</span>&nbsp;<span class="op" id="2602690">+</span>&nbsp;<span class="string" id="2602692">&#34;)(&#34;</span>&nbsp;<span class="op" id="2602697">+</span>&nbsp;<span class="op" id="2602699">*</span><span class="ident" id="2602700">t</span><span class="op" id="2602701">.</span><span class="builtintype" id="2602702">string</span>&nbsp;<span class="op" id="2602709">+</span>&nbsp;<span class="string" id="2602711">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602716">}</span>&nbsp;<span class="keyword" id="2602718">else</span>&nbsp;<span class="op" id="2602723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602727">s</span>&nbsp;<span class="op" id="2602729">=</span>&nbsp;<span class="string" id="2602731">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2602743">+</span>&nbsp;<span class="op" id="2602745">*</span><span class="ident" id="2602746">t</span><span class="op" id="2602747">.</span><span class="builtintype" id="2602748">string</span>&nbsp;<span class="op" id="2602755">+</span>&nbsp;<span class="string" id="2602757">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602762">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602765">x</span><span class="op" id="2602766">.</span><span class="builtintype" id="2602767">string</span>&nbsp;<span class="op" id="2602774">=</span>&nbsp;<span class="op" id="2602776">&amp;</span><span class="ident" id="2602777">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2602781">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602817">if</span>&nbsp;<span class="ident" id="2602820">layoutCache</span><span class="op" id="2602831">.</span><span class="ident" id="2602832">m</span>&nbsp;<span class="op" id="2602834">==</span>&nbsp;<span class="ident" id="2602837">nil</span>&nbsp;<span class="op" id="2602841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602845">layoutCache</span><span class="op" id="2602856">.</span><span class="ident" id="2602857">m</span>&nbsp;<span class="op" id="2602859">=</span>&nbsp;<span class="builtinfunc" id="2602861">make</span><span class="op" id="2602865">(</span><span class="keyword" id="2602866">map</span><span class="op" id="2602869">[</span><span class="ident" id="2602870">layoutKey</span><span class="op" id="2602879">]</span><span class="ident" id="2602880">layoutType</span><span class="op" id="2602890">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602896">layoutCache</span><span class="op" id="2602907">.</span><span class="ident" id="2602908">m</span><span class="op" id="2602909">[</span><span class="ident" id="2602910">k</span><span class="op" id="2602911">]</span>&nbsp;<span class="op" id="2602913">=</span>&nbsp;<span class="ident" id="2602915">layoutType</span><span class="op" id="2602925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602929">t</span><span class="op" id="2602930">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2602940">x</span><span class="op" id="2602941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602945">argSize</span><span class="op" id="2602952">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2602956">argSize</span><span class="op" id="2602963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602967">retOffset</span><span class="op" id="2602976">:</span>&nbsp;<span class="ident" id="2602978">retOffset</span><span class="op" id="2602987">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602991">stack</span><span class="op" id="2602996">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2603002">stack</span><span class="op" id="2603007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603013">layoutCache</span><span class="op" id="2603024">.</span><span class="ident" id="2603025">Unlock</span><span class="op" id="2603031">(</span><span class="op" id="2603032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603035">return</span>&nbsp;<span class="ident" id="2603042">x</span><span class="op" id="2603043">,</span>&nbsp;<span class="ident" id="2603045">argSize</span><span class="op" id="2603052">,</span>&nbsp;<span class="ident" id="2603054">retOffset</span><span class="op" id="2603063">,</span>&nbsp;<span class="ident" id="2603065">stack</span><br>
<span class="lineno"></span><span class="op" id="2603071">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2603074">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2603150">func</span>&nbsp;<span class="ident" id="2603155">ifaceIndir</span><span class="op" id="2603165">(</span><span class="ident" id="2603166">t</span>&nbsp;<span class="op" id="2603168">*</span><span class="ident" id="2603169">rtype</span><span class="op" id="2603174">)</span>&nbsp;<span class="builtintype" id="2603176">bool</span>&nbsp;<span class="op" id="2603181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603184">return</span>&nbsp;<span class="ident" id="2603191">t</span><span class="op" id="2603192">.</span><span class="ident" id="2603193">kind</span><span class="op" id="2603197">&amp;</span><span class="ident" id="2603198">kindDirectIface</span>&nbsp;<span class="op" id="2603214">==</span>&nbsp;<span class="num" id="2603217">0</span><br>
<span class="lineno"></span><span class="op" id="2603219">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2603222">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2603273">type</span>&nbsp;<span class="ident" id="2603278">bitVector</span>&nbsp;<span class="keyword" id="2603288">struct</span>&nbsp;<span class="op" id="2603295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603298">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2603303">uint32</span>&nbsp;<span class="comment" id="2603310">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603329">data</span>&nbsp;<span class="op" id="2603334">[</span><span class="op" id="2603335">]</span><span class="builtintype" id="2603336">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2603341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2603344">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2603380">func</span>&nbsp;<span class="op" id="2603385">(</span><span class="ident" id="2603386">bv</span>&nbsp;<span class="op" id="2603389">*</span><span class="ident" id="2603390">bitVector</span><span class="op" id="2603399">)</span>&nbsp;<span class="ident" id="2603401">append2</span><span class="op" id="2603408">(</span><span class="ident" id="2603409">bits</span>&nbsp;<span class="builtintype" id="2603414">uint8</span><span class="op" id="2603419">)</span>&nbsp;<span class="op" id="2603421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2603424">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603497">if</span>&nbsp;<span class="ident" id="2603500">bv</span><span class="op" id="2603502">.</span><span class="ident" id="2603503">n</span><span class="op" id="2603504">%</span><span class="num" id="2603505">8</span>&nbsp;<span class="op" id="2603507">==</span>&nbsp;<span class="num" id="2603510">0</span>&nbsp;<span class="op" id="2603512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603516">bv</span><span class="op" id="2603518">.</span><span class="ident" id="2603519">data</span>&nbsp;<span class="op" id="2603524">=</span>&nbsp;<span class="builtinfunc" id="2603526">append</span><span class="op" id="2603532">(</span><span class="ident" id="2603533">bv</span><span class="op" id="2603535">.</span><span class="ident" id="2603536">data</span><span class="op" id="2603540">,</span>&nbsp;<span class="num" id="2603542">0</span><span class="op" id="2603543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603549">bv</span><span class="op" id="2603551">.</span><span class="ident" id="2603552">data</span><span class="op" id="2603556">[</span><span class="ident" id="2603557">bv</span><span class="op" id="2603559">.</span><span class="ident" id="2603560">n</span><span class="op" id="2603561">/</span><span class="num" id="2603562">8</span><span class="op" id="2603563">]</span>&nbsp;<span class="op" id="2603565">|=</span>&nbsp;<span class="ident" id="2603568">bits</span>&nbsp;<span class="op" id="2603573">&lt;&lt;</span>&nbsp;<span class="op" id="2603576">(</span><span class="ident" id="2603577">bv</span><span class="op" id="2603579">.</span><span class="ident" id="2603580">n</span>&nbsp;<span class="op" id="2603582">%</span>&nbsp;<span class="num" id="2603584">8</span><span class="op" id="2603585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603588">bv</span><span class="op" id="2603590">.</span><span class="ident" id="2603591">n</span>&nbsp;<span class="op" id="2603593">+=</span>&nbsp;<span class="num" id="2603596">2</span><br>
<span class="lineno">1885</span><span class="op" id="2603598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2603601">func</span>&nbsp;<span class="ident" id="2603606">addTypeBits</span><span class="op" id="2603617">(</span><span class="ident" id="2603618">bv</span>&nbsp;<span class="op" id="2603621">*</span><span class="ident" id="2603622">bitVector</span><span class="op" id="2603631">,</span>&nbsp;<span class="ident" id="2603633">offset</span>&nbsp;<span class="op" id="2603640">*</span><span class="builtintype" id="2603641">uintptr</span><span class="op" id="2603648">,</span>&nbsp;<span class="ident" id="2603650">t</span>&nbsp;<span class="op" id="2603652">*</span><span class="ident" id="2603653">rtype</span><span class="op" id="2603658">)</span>&nbsp;<span class="op" id="2603660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603663">*</span><span class="ident" id="2603664">offset</span>&nbsp;<span class="op" id="2603671">=</span>&nbsp;<span class="ident" id="2603673">align</span><span class="op" id="2603678">(</span><span class="op" id="2603679">*</span><span class="ident" id="2603680">offset</span><span class="op" id="2603686">,</span>&nbsp;<span class="builtintype" id="2603688">uintptr</span><span class="op" id="2603695">(</span><span class="ident" id="2603696">t</span><span class="op" id="2603697">.</span><span class="ident" id="2603698">align</span><span class="op" id="2603703">)</span><span class="op" id="2603704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603707">if</span>&nbsp;<span class="ident" id="2603710">t</span><span class="op" id="2603711">.</span><span class="ident" id="2603712">kind</span><span class="op" id="2603716">&amp;</span><span class="ident" id="2603717">kindNoPointers</span>&nbsp;<span class="op" id="2603732">!=</span>&nbsp;<span class="num" id="2603735">0</span>&nbsp;<span class="op" id="2603737">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603741">*</span><span class="ident" id="2603742">offset</span>&nbsp;<span class="op" id="2603749">+=</span>&nbsp;<span class="ident" id="2603752">t</span><span class="op" id="2603753">.</span><span class="ident" id="2603754">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603773">switch</span>&nbsp;<span class="ident" id="2603780">Kind</span><span class="op" id="2603784">(</span><span class="ident" id="2603785">t</span><span class="op" id="2603786">.</span><span class="ident" id="2603787">kind</span>&nbsp;<span class="op" id="2603792">&amp;</span>&nbsp;<span class="ident" id="2603794">kindMask</span><span class="op" id="2603802">)</span>&nbsp;<span class="op" id="2603804">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603807">case</span>&nbsp;<span class="ident" id="2603812">Chan</span><span class="op" id="2603816">,</span>&nbsp;<span class="ident" id="2603818">Func</span><span class="op" id="2603822">,</span>&nbsp;<span class="ident" id="2603824">Map</span><span class="op" id="2603827">,</span>&nbsp;<span class="ident" id="2603829">Ptr</span><span class="op" id="2603832">,</span>&nbsp;<span class="ident" id="2603834">Slice</span><span class="op" id="2603839">,</span>&nbsp;<span class="ident" id="2603841">String</span><span class="op" id="2603847">,</span>&nbsp;<span class="ident" id="2603849">UnsafePointer</span><span class="op" id="2603862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2603866">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603908">for</span>&nbsp;<span class="ident" id="2603912">bv</span><span class="op" id="2603914">.</span><span class="ident" id="2603915">n</span>&nbsp;<span class="op" id="2603917">&lt;</span>&nbsp;<span class="num" id="2603919">2</span><span class="op" id="2603920">*</span><span class="builtintype" id="2603921">uint32</span><span class="op" id="2603927">(</span><span class="op" id="2603928">*</span><span class="ident" id="2603929">offset</span><span class="op" id="2603935">/</span><span class="builtintype" id="2603936">uintptr</span><span class="op" id="2603943">(</span><span class="ident" id="2603944">ptrSize</span><span class="op" id="2603951">)</span><span class="op" id="2603952">)</span>&nbsp;<span class="op" id="2603954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603959">bv</span><span class="op" id="2603961">.</span><span class="ident" id="2603962">append2</span><span class="op" id="2603969">(</span><span class="ident" id="2603970">bitsScalar</span><span class="op" id="2603980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603984">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603988">bv</span><span class="op" id="2603990">.</span><span class="ident" id="2603991">append2</span><span class="op" id="2603998">(</span><span class="ident" id="2603999">bitsPointer</span><span class="op" id="2604010">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604014">case</span>&nbsp;<span class="ident" id="2604019">Interface</span><span class="op" id="2604028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2604032">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604048">for</span>&nbsp;<span class="ident" id="2604052">bv</span><span class="op" id="2604054">.</span><span class="ident" id="2604055">n</span>&nbsp;<span class="op" id="2604057">&lt;</span>&nbsp;<span class="num" id="2604059">2</span><span class="op" id="2604060">*</span><span class="builtintype" id="2604061">uint32</span><span class="op" id="2604067">(</span><span class="op" id="2604068">*</span><span class="ident" id="2604069">offset</span><span class="op" id="2604075">/</span><span class="builtintype" id="2604076">uintptr</span><span class="op" id="2604083">(</span><span class="ident" id="2604084">ptrSize</span><span class="op" id="2604091">)</span><span class="op" id="2604092">)</span>&nbsp;<span class="op" id="2604094">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604099">bv</span><span class="op" id="2604101">.</span><span class="ident" id="2604102">append2</span><span class="op" id="2604109">(</span><span class="ident" id="2604110">bitsScalar</span><span class="op" id="2604120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2604124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604128">bv</span><span class="op" id="2604130">.</span><span class="ident" id="2604131">append2</span><span class="op" id="2604138">(</span><span class="ident" id="2604139">bitsPointer</span><span class="op" id="2604150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604154">bv</span><span class="op" id="2604156">.</span><span class="ident" id="2604157">append2</span><span class="op" id="2604164">(</span><span class="ident" id="2604165">bitsPointer</span><span class="op" id="2604176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604180">case</span>&nbsp;<span class="ident" id="2604185">Array</span><span class="op" id="2604190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2604194">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604217">tt</span>&nbsp;<span class="op" id="2604220">:=</span>&nbsp;<span class="op" id="2604223">(</span><span class="op" id="2604224">*</span><span class="ident" id="2604225">arrayType</span><span class="op" id="2604234">)</span><span class="op" id="2604235">(</span><span class="ident" id="2604236">unsafe</span><span class="op" id="2604242">.</span><span class="ident" id="2604243">Pointer</span><span class="op" id="2604250">(</span><span class="ident" id="2604251">t</span><span class="op" id="2604252">)</span><span class="op" id="2604253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604257">for</span>&nbsp;<span class="ident" id="2604261">i</span>&nbsp;<span class="op" id="2604263">:=</span>&nbsp;<span class="num" id="2604266">0</span><span class="op" id="2604267">;</span>&nbsp;<span class="ident" id="2604269">i</span>&nbsp;<span class="op" id="2604271">&lt;</span>&nbsp;<span class="builtintype" id="2604273">int</span><span class="op" id="2604276">(</span><span class="ident" id="2604277">tt</span><span class="op" id="2604279">.</span><span class="builtinfunc" id="2604280">len</span><span class="op" id="2604283">)</span><span class="op" id="2604284">;</span>&nbsp;<span class="ident" id="2604286">i</span><span class="op" id="2604287">++</span>&nbsp;<span class="op" id="2604290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604295">addTypeBits</span><span class="op" id="2604306">(</span><span class="ident" id="2604307">bv</span><span class="op" id="2604309">,</span>&nbsp;<span class="ident" id="2604311">offset</span><span class="op" id="2604317">,</span>&nbsp;<span class="ident" id="2604319">tt</span><span class="op" id="2604321">.</span><span class="ident" id="2604322">elem</span><span class="op" id="2604326">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2604330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604334">case</span>&nbsp;<span class="ident" id="2604339">Struct</span><span class="op" id="2604345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2604349">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604367">tt</span>&nbsp;<span class="op" id="2604370">:=</span>&nbsp;<span class="op" id="2604373">(</span><span class="op" id="2604374">*</span><span class="ident" id="2604375">structType</span><span class="op" id="2604385">)</span><span class="op" id="2604386">(</span><span class="ident" id="2604387">unsafe</span><span class="op" id="2604393">.</span><span class="ident" id="2604394">Pointer</span><span class="op" id="2604401">(</span><span class="ident" id="2604402">t</span><span class="op" id="2604403">)</span><span class="op" id="2604404">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604408">start</span>&nbsp;<span class="op" id="2604414">:=</span>&nbsp;<span class="op" id="2604417">*</span><span class="ident" id="2604418">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604427">for</span>&nbsp;<span class="ident" id="2604431">i</span>&nbsp;<span class="op" id="2604433">:=</span>&nbsp;<span class="keyword" id="2604436">range</span>&nbsp;<span class="ident" id="2604442">tt</span><span class="op" id="2604444">.</span><span class="ident" id="2604445">fields</span>&nbsp;<span class="op" id="2604452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604457">f</span>&nbsp;<span class="op" id="2604459">:=</span>&nbsp;<span class="op" id="2604462">&amp;</span><span class="ident" id="2604463">tt</span><span class="op" id="2604465">.</span><span class="ident" id="2604466">fields</span><span class="op" id="2604472">[</span><span class="ident" id="2604473">i</span><span class="op" id="2604474">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604479">off</span>&nbsp;<span class="op" id="2604483">:=</span>&nbsp;<span class="ident" id="2604486">start</span>&nbsp;<span class="op" id="2604492">+</span>&nbsp;<span class="ident" id="2604494">f</span><span class="op" id="2604495">.</span><span class="ident" id="2604496">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604506">addTypeBits</span><span class="op" id="2604517">(</span><span class="ident" id="2604518">bv</span><span class="op" id="2604520">,</span>&nbsp;<span class="op" id="2604522">&amp;</span><span class="ident" id="2604523">off</span><span class="op" id="2604526">,</span>&nbsp;<span class="ident" id="2604528">f</span><span class="op" id="2604529">.</span><span class="ident" id="2604530">typ</span><span class="op" id="2604533">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2604537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2604540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2604544">*</span><span class="ident" id="2604545">offset</span>&nbsp;<span class="op" id="2604552">+=</span>&nbsp;<span class="ident" id="2604555">t</span><span class="op" id="2604556">.</span><span class="ident" id="2604557">size</span><br>
<span class="lineno"></span><span class="op" id="2604562">}</span>
</div>
</body>
</html>
