<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html" class="current">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3829868">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3829923">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3829977">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3830028">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="3830088">package</span>&nbsp;<span class="ident" id="3830096">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3830102">import</span>&nbsp;<span class="op" id="3830109">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830112">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830121">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830131">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830145">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830161">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830180">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830194">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830209">_</span>&nbsp;<span class="string" id="3830211">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830228">_</span>&nbsp;<span class="string" id="3830230">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830247">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830267">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830284">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830300">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830310">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830316">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830328">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830335">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830346">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3830353">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3830356">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="3830436">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="3830452">type</span>&nbsp;<span class="ident" id="3830457">pkixPublicKey</span>&nbsp;<span class="keyword" id="3830471">struct</span>&nbsp;<span class="op" id="3830478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830481">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830491">pkix</span><span class="op" id="3830495">.</span><span class="ident" id="3830496">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830517">BitString</span>&nbsp;<span class="ident" id="3830527">asn1</span><span class="op" id="3830531">.</span><span class="ident" id="3830532">BitString</span><br>
<span class="lineno"></span><span class="op" id="3830542">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3830545">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3830617">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3830675">func</span>&nbsp;<span class="ident" id="3830680">ParsePKIXPublicKey</span><span class="op" id="3830698">(</span><span class="ident" id="3830699">derBytes</span>&nbsp;<span class="op" id="3830708">[</span><span class="op" id="3830709">]</span><span class="builtintype" id="3830710">byte</span><span class="op" id="3830714">)</span>&nbsp;<span class="op" id="3830716">(</span><span class="ident" id="3830717">pub</span>&nbsp;<span class="keyword" id="3830721">interface</span><span class="op" id="3830730">{</span><span class="op" id="3830731">}</span><span class="op" id="3830732">,</span>&nbsp;<span class="ident" id="3830734">err</span>&nbsp;<span class="builtintype" id="3830738">error</span><span class="op" id="3830743">)</span>&nbsp;<span class="op" id="3830745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830748">var</span>&nbsp;<span class="ident" id="3830752">pki</span>&nbsp;<span class="ident" id="3830756">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830771">if</span>&nbsp;<span class="ident" id="3830774">_</span><span class="op" id="3830775">,</span>&nbsp;<span class="ident" id="3830777">err</span>&nbsp;<span class="op" id="3830781">=</span>&nbsp;<span class="ident" id="3830783">asn1</span><span class="op" id="3830787">.</span><span class="ident" id="3830788">Unmarshal</span><span class="op" id="3830797">(</span><span class="ident" id="3830798">derBytes</span><span class="op" id="3830806">,</span>&nbsp;<span class="op" id="3830808">&amp;</span><span class="ident" id="3830809">pki</span><span class="op" id="3830812">)</span><span class="op" id="3830813">;</span>&nbsp;<span class="ident" id="3830815">err</span>&nbsp;<span class="op" id="3830819">!=</span>&nbsp;<span class="ident" id="3830822">nil</span>&nbsp;<span class="op" id="3830826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830830">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830841">algo</span>&nbsp;<span class="op" id="3830846">:=</span>&nbsp;<span class="ident" id="3830849">getPublicKeyAlgorithmFromOID</span><span class="op" id="3830877">(</span><span class="ident" id="3830878">pki</span><span class="op" id="3830881">.</span><span class="ident" id="3830882">Algorithm</span><span class="op" id="3830891">.</span><span class="ident" id="3830892">Algorithm</span><span class="op" id="3830901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830904">if</span>&nbsp;<span class="ident" id="3830907">algo</span>&nbsp;<span class="op" id="3830912">==</span>&nbsp;<span class="ident" id="3830915">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3830941">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830945">return</span>&nbsp;<span class="ident" id="3830952">nil</span><span class="op" id="3830955">,</span>&nbsp;<span class="ident" id="3830957">errors</span><span class="op" id="3830963">.</span><span class="ident" id="3830964">New</span><span class="op" id="3830967">(</span><span class="string" id="3830968">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="3831004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831010">return</span>&nbsp;<span class="ident" id="3831017">parsePublicKey</span><span class="op" id="3831031">(</span><span class="ident" id="3831032">algo</span><span class="op" id="3831036">,</span>&nbsp;<span class="op" id="3831038">&amp;</span><span class="ident" id="3831039">pki</span><span class="op" id="3831042">)</span><br>
<span class="lineno"></span><span class="op" id="3831044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="3831047">func</span>&nbsp;<span class="ident" id="3831052">marshalPublicKey</span><span class="op" id="3831068">(</span><span class="ident" id="3831069">pub</span>&nbsp;<span class="keyword" id="3831073">interface</span><span class="op" id="3831082">{</span><span class="op" id="3831083">}</span><span class="op" id="3831084">)</span>&nbsp;<span class="op" id="3831086">(</span><span class="ident" id="3831087">publicKeyBytes</span>&nbsp;<span class="op" id="3831102">[</span><span class="op" id="3831103">]</span><span class="builtintype" id="3831104">byte</span><span class="op" id="3831108">,</span>&nbsp;<span class="ident" id="3831110">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3831129">pkix</span><span class="op" id="3831133">.</span><span class="ident" id="3831134">AlgorithmIdentifier</span><span class="op" id="3831153">,</span>&nbsp;<span class="ident" id="3831155">err</span>&nbsp;<span class="builtintype" id="3831159">error</span><span class="op" id="3831164">)</span>&nbsp;<span class="op" id="3831166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831169">switch</span>&nbsp;<span class="ident" id="3831176">pub</span>&nbsp;<span class="op" id="3831180">:=</span>&nbsp;<span class="ident" id="3831183">pub</span><span class="op" id="3831186">.</span><span class="op" id="3831187">(</span><span class="keyword" id="3831188">type</span><span class="op" id="3831192">)</span>&nbsp;<span class="op" id="3831194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831197">case</span>&nbsp;<span class="op" id="3831202">*</span><span class="ident" id="3831203">rsa</span><span class="op" id="3831206">.</span><span class="ident" id="3831207">PublicKey</span><span class="op" id="3831216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831220">publicKeyBytes</span><span class="op" id="3831234">,</span>&nbsp;<span class="ident" id="3831236">err</span>&nbsp;<span class="op" id="3831240">=</span>&nbsp;<span class="ident" id="3831242">asn1</span><span class="op" id="3831246">.</span><span class="ident" id="3831247">Marshal</span><span class="op" id="3831254">(</span><span class="ident" id="3831255">rsaPublicKey</span><span class="op" id="3831267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831272">N</span><span class="op" id="3831273">:</span>&nbsp;<span class="ident" id="3831275">pub</span><span class="op" id="3831278">.</span><span class="ident" id="3831279">N</span><span class="op" id="3831280">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831285">E</span><span class="op" id="3831286">:</span>&nbsp;<span class="ident" id="3831288">pub</span><span class="op" id="3831291">.</span><span class="ident" id="3831292">E</span><span class="op" id="3831293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831297">}</span><span class="op" id="3831298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831302">publicKeyAlgorithm</span><span class="op" id="3831320">.</span><span class="ident" id="3831321">Algorithm</span>&nbsp;<span class="op" id="3831331">=</span>&nbsp;<span class="ident" id="3831333">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831351">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831409">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831467">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831518">publicKeyAlgorithm</span><span class="op" id="3831536">.</span><span class="ident" id="3831537">Parameters</span>&nbsp;<span class="op" id="3831548">=</span>&nbsp;<span class="ident" id="3831550">asn1</span><span class="op" id="3831554">.</span><span class="ident" id="3831555">RawValue</span><span class="op" id="3831563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831568">Tag</span><span class="op" id="3831571">:</span>&nbsp;<span class="num" id="3831573">5</span><span class="op" id="3831574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831581">case</span>&nbsp;<span class="op" id="3831586">*</span><span class="ident" id="3831587">ecdsa</span><span class="op" id="3831592">.</span><span class="ident" id="3831593">PublicKey</span><span class="op" id="3831602">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831606">publicKeyBytes</span>&nbsp;<span class="op" id="3831621">=</span>&nbsp;<span class="ident" id="3831623">elliptic</span><span class="op" id="3831631">.</span><span class="ident" id="3831632">Marshal</span><span class="op" id="3831639">(</span><span class="ident" id="3831640">pub</span><span class="op" id="3831643">.</span><span class="ident" id="3831644">Curve</span><span class="op" id="3831649">,</span>&nbsp;<span class="ident" id="3831651">pub</span><span class="op" id="3831654">.</span><span class="ident" id="3831655">X</span><span class="op" id="3831656">,</span>&nbsp;<span class="ident" id="3831658">pub</span><span class="op" id="3831661">.</span><span class="ident" id="3831662">Y</span><span class="op" id="3831663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831667">oid</span><span class="op" id="3831670">,</span>&nbsp;<span class="ident" id="3831672">ok</span>&nbsp;<span class="op" id="3831675">:=</span>&nbsp;<span class="ident" id="3831678">oidFromNamedCurve</span><span class="op" id="3831695">(</span><span class="ident" id="3831696">pub</span><span class="op" id="3831699">.</span><span class="ident" id="3831700">Curve</span><span class="op" id="3831705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831709">if</span>&nbsp;<span class="op" id="3831712">!</span><span class="ident" id="3831713">ok</span>&nbsp;<span class="op" id="3831716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831721">return</span>&nbsp;<span class="ident" id="3831728">nil</span><span class="op" id="3831731">,</span>&nbsp;<span class="ident" id="3831733">pkix</span><span class="op" id="3831737">.</span><span class="ident" id="3831738">AlgorithmIdentifier</span><span class="op" id="3831757">{</span><span class="op" id="3831758">}</span><span class="op" id="3831759">,</span>&nbsp;<span class="ident" id="3831761">errors</span><span class="op" id="3831767">.</span><span class="ident" id="3831768">New</span><span class="op" id="3831771">(</span><span class="string" id="3831772">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3831806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831810">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831814">publicKeyAlgorithm</span><span class="op" id="3831832">.</span><span class="ident" id="3831833">Algorithm</span>&nbsp;<span class="op" id="3831843">=</span>&nbsp;<span class="ident" id="3831845">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831865">var</span>&nbsp;<span class="ident" id="3831869">paramBytes</span>&nbsp;<span class="op" id="3831880">[</span><span class="op" id="3831881">]</span><span class="builtintype" id="3831882">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831889">paramBytes</span><span class="op" id="3831899">,</span>&nbsp;<span class="ident" id="3831901">err</span>&nbsp;<span class="op" id="3831905">=</span>&nbsp;<span class="ident" id="3831907">asn1</span><span class="op" id="3831911">.</span><span class="ident" id="3831912">Marshal</span><span class="op" id="3831919">(</span><span class="ident" id="3831920">oid</span><span class="op" id="3831923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831927">if</span>&nbsp;<span class="ident" id="3831930">err</span>&nbsp;<span class="op" id="3831934">!=</span>&nbsp;<span class="ident" id="3831937">nil</span>&nbsp;<span class="op" id="3831941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831946">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831959">publicKeyAlgorithm</span><span class="op" id="3831977">.</span><span class="ident" id="3831978">Parameters</span><span class="op" id="3831988">.</span><span class="ident" id="3831989">FullBytes</span>&nbsp;<span class="op" id="3831999">=</span>&nbsp;<span class="ident" id="3832001">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832013">default</span><span class="op" id="3832020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832024">return</span>&nbsp;<span class="ident" id="3832031">nil</span><span class="op" id="3832034">,</span>&nbsp;<span class="ident" id="3832036">pkix</span><span class="op" id="3832040">.</span><span class="ident" id="3832041">AlgorithmIdentifier</span><span class="op" id="3832060">{</span><span class="op" id="3832061">}</span><span class="op" id="3832062">,</span>&nbsp;<span class="ident" id="3832064">errors</span><span class="op" id="3832070">.</span><span class="ident" id="3832071">New</span><span class="op" id="3832074">(</span><span class="string" id="3832075">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="3832123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832126">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832130">return</span>&nbsp;<span class="ident" id="3832137">publicKeyBytes</span><span class="op" id="3832151">,</span>&nbsp;<span class="ident" id="3832153">publicKeyAlgorithm</span><span class="op" id="3832171">,</span>&nbsp;<span class="ident" id="3832173">nil</span><br>
<span class="lineno"></span><span class="op" id="3832177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3832180">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="3832256">func</span>&nbsp;<span class="ident" id="3832261">MarshalPKIXPublicKey</span><span class="op" id="3832281">(</span><span class="ident" id="3832282">pub</span>&nbsp;<span class="keyword" id="3832286">interface</span><span class="op" id="3832295">{</span><span class="op" id="3832296">}</span><span class="op" id="3832297">)</span>&nbsp;<span class="op" id="3832299">(</span><span class="op" id="3832300">[</span><span class="op" id="3832301">]</span><span class="builtintype" id="3832302">byte</span><span class="op" id="3832306">,</span>&nbsp;<span class="builtintype" id="3832308">error</span><span class="op" id="3832313">)</span>&nbsp;<span class="op" id="3832315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832318">var</span>&nbsp;<span class="ident" id="3832322">publicKeyBytes</span>&nbsp;<span class="op" id="3832337">[</span><span class="op" id="3832338">]</span><span class="builtintype" id="3832339">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832345">var</span>&nbsp;<span class="ident" id="3832349">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3832368">pkix</span><span class="op" id="3832372">.</span><span class="ident" id="3832373">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832394">var</span>&nbsp;<span class="ident" id="3832398">err</span>&nbsp;<span class="builtintype" id="3832402">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832410">if</span>&nbsp;<span class="ident" id="3832413">publicKeyBytes</span><span class="op" id="3832427">,</span>&nbsp;<span class="ident" id="3832429">publicKeyAlgorithm</span><span class="op" id="3832447">,</span>&nbsp;<span class="ident" id="3832449">err</span>&nbsp;<span class="op" id="3832453">=</span>&nbsp;<span class="ident" id="3832455">marshalPublicKey</span><span class="op" id="3832471">(</span><span class="ident" id="3832472">pub</span><span class="op" id="3832475">)</span><span class="op" id="3832476">;</span>&nbsp;<span class="ident" id="3832478">err</span>&nbsp;<span class="op" id="3832482">!=</span>&nbsp;<span class="ident" id="3832485">nil</span>&nbsp;<span class="op" id="3832489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832493">return</span>&nbsp;<span class="ident" id="3832500">nil</span><span class="op" id="3832503">,</span>&nbsp;<span class="ident" id="3832505">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832514">pkix</span>&nbsp;<span class="op" id="3832519">:=</span>&nbsp;<span class="ident" id="3832522">pkixPublicKey</span><span class="op" id="3832535">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832539">Algo</span><span class="op" id="3832543">:</span>&nbsp;<span class="ident" id="3832545">publicKeyAlgorithm</span><span class="op" id="3832563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832567">BitString</span><span class="op" id="3832576">:</span>&nbsp;<span class="ident" id="3832578">asn1</span><span class="op" id="3832582">.</span><span class="ident" id="3832583">BitString</span><span class="op" id="3832592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832597">Bytes</span><span class="op" id="3832602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832608">publicKeyBytes</span><span class="op" id="3832622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832627">BitLength</span><span class="op" id="3832636">:</span>&nbsp;<span class="num" id="3832638">8</span>&nbsp;<span class="op" id="3832640">*</span>&nbsp;<span class="builtinfunc" id="3832642">len</span><span class="op" id="3832645">(</span><span class="ident" id="3832646">publicKeyBytes</span><span class="op" id="3832660">)</span><span class="op" id="3832661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832665">}</span><span class="op" id="3832666">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832673">ret</span><span class="op" id="3832676">,</span>&nbsp;<span class="ident" id="3832678">_</span>&nbsp;<span class="op" id="3832680">:=</span>&nbsp;<span class="ident" id="3832683">asn1</span><span class="op" id="3832687">.</span><span class="ident" id="3832688">Marshal</span><span class="op" id="3832695">(</span><span class="ident" id="3832696">pkix</span><span class="op" id="3832700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832703">return</span>&nbsp;<span class="ident" id="3832710">ret</span><span class="op" id="3832713">,</span>&nbsp;<span class="ident" id="3832715">nil</span><br>
<span class="lineno"></span><span class="op" id="3832719">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3832722">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3832795">type</span>&nbsp;<span class="ident" id="3832800">certificate</span>&nbsp;<span class="keyword" id="3832812">struct</span>&nbsp;<span class="op" id="3832819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832822">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832841">asn1</span><span class="op" id="3832845">.</span><span class="ident" id="3832846">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832858">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832877">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832893">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3832912">pkix</span><span class="op" id="3832916">.</span><span class="ident" id="3832917">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832938">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3832957">asn1</span><span class="op" id="3832961">.</span><span class="ident" id="3832962">BitString</span><br>
<span class="lineno"></span><span class="op" id="3832972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3832975">type</span>&nbsp;<span class="ident" id="3832980">tbsCertificate</span>&nbsp;<span class="keyword" id="3832995">struct</span>&nbsp;<span class="op" id="3833002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833005">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833024">asn1</span><span class="op" id="3833028">.</span><span class="ident" id="3833029">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833041">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3833060">int</span>&nbsp;<span class="string" id="3833064">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833108">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833127">*</span><span class="ident" id="3833128">big</span><span class="op" id="3833131">.</span><span class="ident" id="3833132">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833137">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3833156">pkix</span><span class="op" id="3833160">.</span><span class="ident" id="3833161">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833182">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833201">asn1</span><span class="op" id="3833205">.</span><span class="ident" id="3833206">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833216">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833235">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833245">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833264">asn1</span><span class="op" id="3833268">.</span><span class="ident" id="3833269">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833279">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833298">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833313">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833332">asn1</span><span class="op" id="3833336">.</span><span class="ident" id="3833337">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3833349">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833374">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833393">asn1</span><span class="op" id="3833397">.</span><span class="ident" id="3833398">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3833410">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833435">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3833454">[</span><span class="op" id="3833455">]</span><span class="ident" id="3833456">pkix</span><span class="op" id="3833460">.</span><span class="ident" id="3833461">Extension</span>&nbsp;<span class="string" id="3833471">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3833504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3833507">type</span>&nbsp;<span class="ident" id="3833512">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="3833535">struct</span>&nbsp;<span class="op" id="3833542">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833545">P</span><span class="op" id="3833546">,</span>&nbsp;<span class="ident" id="3833548">Q</span><span class="op" id="3833549">,</span>&nbsp;<span class="ident" id="3833551">G</span>&nbsp;<span class="op" id="3833553">*</span><span class="ident" id="3833554">big</span><span class="op" id="3833557">.</span><span class="ident" id="3833558">Int</span><br>
<span class="lineno"></span><span class="op" id="3833562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3833565">type</span>&nbsp;<span class="ident" id="3833570">dsaSignature</span>&nbsp;<span class="keyword" id="3833583">struct</span>&nbsp;<span class="op" id="3833590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833593">R</span><span class="op" id="3833594">,</span>&nbsp;<span class="ident" id="3833596">S</span>&nbsp;<span class="op" id="3833598">*</span><span class="ident" id="3833599">big</span><span class="op" id="3833602">.</span><span class="ident" id="3833603">Int</span><br>
<span class="lineno">135</span><span class="op" id="3833607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3833610">type</span>&nbsp;<span class="ident" id="3833615">ecdsaSignature</span>&nbsp;<span class="ident" id="3833630">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3833644">type</span>&nbsp;<span class="ident" id="3833649">validity</span>&nbsp;<span class="keyword" id="3833658">struct</span>&nbsp;<span class="op" id="3833665">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833668">NotBefore</span><span class="op" id="3833677">,</span>&nbsp;<span class="ident" id="3833679">NotAfter</span>&nbsp;<span class="ident" id="3833688">time</span><span class="op" id="3833692">.</span><span class="ident" id="3833693">Time</span><br>
<span class="lineno"></span><span class="op" id="3833698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3833701">type</span>&nbsp;<span class="ident" id="3833706">publicKeyInfo</span>&nbsp;<span class="keyword" id="3833720">struct</span>&nbsp;<span class="op" id="3833727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833730">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3833740">asn1</span><span class="op" id="3833744">.</span><span class="ident" id="3833745">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833757">Algorithm</span>&nbsp;<span class="ident" id="3833767">pkix</span><span class="op" id="3833771">.</span><span class="ident" id="3833772">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833793">PublicKey</span>&nbsp;<span class="ident" id="3833803">asn1</span><span class="op" id="3833807">.</span><span class="ident" id="3833808">BitString</span><br>
<span class="lineno"></span><span class="op" id="3833818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3833821">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="3833843">type</span>&nbsp;<span class="ident" id="3833848">authKeyId</span>&nbsp;<span class="keyword" id="3833858">struct</span>&nbsp;<span class="op" id="3833865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833868">Id</span>&nbsp;<span class="op" id="3833871">[</span><span class="op" id="3833872">]</span><span class="builtintype" id="3833873">byte</span>&nbsp;<span class="string" id="3833878">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3833902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3833905">type</span>&nbsp;<span class="ident" id="3833910">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="3833929">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="3833934">const</span>&nbsp;<span class="op" id="3833940">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833943">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="3833969">SignatureAlgorithm</span>&nbsp;<span class="op" id="3833988">=</span>&nbsp;<span class="ident" id="3833990">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833996">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834008">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834020">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834033">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834048">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834063">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834078">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834091">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834106">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834121">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834138">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834155">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="3834171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3834174">type</span>&nbsp;<span class="ident" id="3834179">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="3834198">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3834203">const</span>&nbsp;<span class="op" id="3834209">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834212">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3834238">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3834257">=</span>&nbsp;<span class="ident" id="3834259">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834265">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834270">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834275">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="3834281">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="3834284">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3834317">//</span><br>
<span class="lineno"></span><span class="comment" id="3834320">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3834354">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="3834417">//</span><br>
<span class="lineno"></span><span class="comment" id="3834420">//</span><br>
<span class="lineno"></span><span class="comment" id="3834423">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3834466">//</span><br>
<span class="lineno"></span><span class="comment" id="3834469">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="3834528">//</span><br>
<span class="lineno"></span><span class="comment" id="3834531">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3834590">//</span><br>
<span class="lineno"></span><span class="comment" id="3834593">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3834654">//</span><br>
<span class="lineno">195</span><span class="comment" id="3834657">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3834696">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3834757">//</span><br>
<span class="lineno"></span><span class="comment" id="3834760">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3834804">//</span><br>
<span class="lineno">200</span><span class="comment" id="3834807">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3834850">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="3834903">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="3834943">//</span><br>
<span class="lineno"></span><span class="comment" id="3834946">//</span><br>
<span class="lineno">205</span><span class="comment" id="3834949">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="3834983">//</span><br>
<span class="lineno"></span><span class="comment" id="3834986">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3835049">//</span><br>
<span class="lineno"></span><span class="comment" id="3835052">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="3835115">//</span><br>
<span class="lineno"></span><span class="comment" id="3835118">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3835181">//</span><br>
<span class="lineno"></span><span class="comment" id="3835184">//</span><br>
<span class="lineno"></span><span class="comment" id="3835187">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="3835228">//</span><br>
<span class="lineno"></span><span class="comment" id="3835231">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3835272">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="3835342">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="3835393">//</span><br>
<span class="lineno">220</span><span class="comment" id="3835396">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3835438">//</span><br>
<span class="lineno"></span><span class="comment" id="3835441">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3835508">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3835577">//</span><br>
<span class="lineno">225</span><span class="comment" id="3835580">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3835647">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3835716">//</span><br>
<span class="lineno"></span><span class="comment" id="3835719">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3835786">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3835856">var</span>&nbsp;<span class="op" id="3835860">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835863">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3835891">=</span>&nbsp;<span class="ident" id="3835893">asn1</span><span class="op" id="3835897">.</span><span class="ident" id="3835898">ObjectIdentifier</span><span class="op" id="3835914">{</span><span class="num" id="3835915">1</span><span class="op" id="3835916">,</span>&nbsp;<span class="num" id="3835918">2</span><span class="op" id="3835919">,</span>&nbsp;<span class="num" id="3835921">840</span><span class="op" id="3835924">,</span>&nbsp;<span class="num" id="3835926">113549</span><span class="op" id="3835932">,</span>&nbsp;<span class="num" id="3835934">1</span><span class="op" id="3835935">,</span>&nbsp;<span class="num" id="3835937">1</span><span class="op" id="3835938">,</span>&nbsp;<span class="num" id="3835940">2</span><span class="op" id="3835941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835944">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3835972">=</span>&nbsp;<span class="ident" id="3835974">asn1</span><span class="op" id="3835978">.</span><span class="ident" id="3835979">ObjectIdentifier</span><span class="op" id="3835995">{</span><span class="num" id="3835996">1</span><span class="op" id="3835997">,</span>&nbsp;<span class="num" id="3835999">2</span><span class="op" id="3836000">,</span>&nbsp;<span class="num" id="3836002">840</span><span class="op" id="3836005">,</span>&nbsp;<span class="num" id="3836007">113549</span><span class="op" id="3836013">,</span>&nbsp;<span class="num" id="3836015">1</span><span class="op" id="3836016">,</span>&nbsp;<span class="num" id="3836018">1</span><span class="op" id="3836019">,</span>&nbsp;<span class="num" id="3836021">4</span><span class="op" id="3836022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836025">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3836053">=</span>&nbsp;<span class="ident" id="3836055">asn1</span><span class="op" id="3836059">.</span><span class="ident" id="3836060">ObjectIdentifier</span><span class="op" id="3836076">{</span><span class="num" id="3836077">1</span><span class="op" id="3836078">,</span>&nbsp;<span class="num" id="3836080">2</span><span class="op" id="3836081">,</span>&nbsp;<span class="num" id="3836083">840</span><span class="op" id="3836086">,</span>&nbsp;<span class="num" id="3836088">113549</span><span class="op" id="3836094">,</span>&nbsp;<span class="num" id="3836096">1</span><span class="op" id="3836097">,</span>&nbsp;<span class="num" id="3836099">1</span><span class="op" id="3836100">,</span>&nbsp;<span class="num" id="3836102">5</span><span class="op" id="3836103">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836106">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3836134">=</span>&nbsp;<span class="ident" id="3836136">asn1</span><span class="op" id="3836140">.</span><span class="ident" id="3836141">ObjectIdentifier</span><span class="op" id="3836157">{</span><span class="num" id="3836158">1</span><span class="op" id="3836159">,</span>&nbsp;<span class="num" id="3836161">2</span><span class="op" id="3836162">,</span>&nbsp;<span class="num" id="3836164">840</span><span class="op" id="3836167">,</span>&nbsp;<span class="num" id="3836169">113549</span><span class="op" id="3836175">,</span>&nbsp;<span class="num" id="3836177">1</span><span class="op" id="3836178">,</span>&nbsp;<span class="num" id="3836180">1</span><span class="op" id="3836181">,</span>&nbsp;<span class="num" id="3836183">11</span><span class="op" id="3836185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836188">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3836216">=</span>&nbsp;<span class="ident" id="3836218">asn1</span><span class="op" id="3836222">.</span><span class="ident" id="3836223">ObjectIdentifier</span><span class="op" id="3836239">{</span><span class="num" id="3836240">1</span><span class="op" id="3836241">,</span>&nbsp;<span class="num" id="3836243">2</span><span class="op" id="3836244">,</span>&nbsp;<span class="num" id="3836246">840</span><span class="op" id="3836249">,</span>&nbsp;<span class="num" id="3836251">113549</span><span class="op" id="3836257">,</span>&nbsp;<span class="num" id="3836259">1</span><span class="op" id="3836260">,</span>&nbsp;<span class="num" id="3836262">1</span><span class="op" id="3836263">,</span>&nbsp;<span class="num" id="3836265">12</span><span class="op" id="3836267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836270">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3836298">=</span>&nbsp;<span class="ident" id="3836300">asn1</span><span class="op" id="3836304">.</span><span class="ident" id="3836305">ObjectIdentifier</span><span class="op" id="3836321">{</span><span class="num" id="3836322">1</span><span class="op" id="3836323">,</span>&nbsp;<span class="num" id="3836325">2</span><span class="op" id="3836326">,</span>&nbsp;<span class="num" id="3836328">840</span><span class="op" id="3836331">,</span>&nbsp;<span class="num" id="3836333">113549</span><span class="op" id="3836339">,</span>&nbsp;<span class="num" id="3836341">1</span><span class="op" id="3836342">,</span>&nbsp;<span class="num" id="3836344">1</span><span class="op" id="3836345">,</span>&nbsp;<span class="num" id="3836347">13</span><span class="op" id="3836349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836352">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3836380">=</span>&nbsp;<span class="ident" id="3836382">asn1</span><span class="op" id="3836386">.</span><span class="ident" id="3836387">ObjectIdentifier</span><span class="op" id="3836403">{</span><span class="num" id="3836404">1</span><span class="op" id="3836405">,</span>&nbsp;<span class="num" id="3836407">2</span><span class="op" id="3836408">,</span>&nbsp;<span class="num" id="3836410">840</span><span class="op" id="3836413">,</span>&nbsp;<span class="num" id="3836415">10040</span><span class="op" id="3836420">,</span>&nbsp;<span class="num" id="3836422">4</span><span class="op" id="3836423">,</span>&nbsp;<span class="num" id="3836425">3</span><span class="op" id="3836426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836429">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3836457">=</span>&nbsp;<span class="ident" id="3836459">asn1</span><span class="op" id="3836463">.</span><span class="ident" id="3836464">ObjectIdentifier</span><span class="op" id="3836480">{</span><span class="num" id="3836481">2</span><span class="op" id="3836482">,</span>&nbsp;<span class="num" id="3836484">16</span><span class="op" id="3836486">,</span>&nbsp;<span class="num" id="3836488">840</span><span class="op" id="3836491">,</span>&nbsp;<span class="num" id="3836493">1</span><span class="op" id="3836494">,</span>&nbsp;<span class="num" id="3836496">101</span><span class="op" id="3836499">,</span>&nbsp;<span class="num" id="3836501">4</span><span class="op" id="3836502">,</span>&nbsp;<span class="num" id="3836504">3</span><span class="op" id="3836505">,</span>&nbsp;<span class="num" id="3836507">2</span><span class="op" id="3836508">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836511">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3836539">=</span>&nbsp;<span class="ident" id="3836541">asn1</span><span class="op" id="3836545">.</span><span class="ident" id="3836546">ObjectIdentifier</span><span class="op" id="3836562">{</span><span class="num" id="3836563">1</span><span class="op" id="3836564">,</span>&nbsp;<span class="num" id="3836566">2</span><span class="op" id="3836567">,</span>&nbsp;<span class="num" id="3836569">840</span><span class="op" id="3836572">,</span>&nbsp;<span class="num" id="3836574">10045</span><span class="op" id="3836579">,</span>&nbsp;<span class="num" id="3836581">4</span><span class="op" id="3836582">,</span>&nbsp;<span class="num" id="3836584">1</span><span class="op" id="3836585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836588">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="3836616">=</span>&nbsp;<span class="ident" id="3836618">asn1</span><span class="op" id="3836622">.</span><span class="ident" id="3836623">ObjectIdentifier</span><span class="op" id="3836639">{</span><span class="num" id="3836640">1</span><span class="op" id="3836641">,</span>&nbsp;<span class="num" id="3836643">2</span><span class="op" id="3836644">,</span>&nbsp;<span class="num" id="3836646">840</span><span class="op" id="3836649">,</span>&nbsp;<span class="num" id="3836651">10045</span><span class="op" id="3836656">,</span>&nbsp;<span class="num" id="3836658">4</span><span class="op" id="3836659">,</span>&nbsp;<span class="num" id="3836661">3</span><span class="op" id="3836662">,</span>&nbsp;<span class="num" id="3836664">2</span><span class="op" id="3836665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836668">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="3836696">=</span>&nbsp;<span class="ident" id="3836698">asn1</span><span class="op" id="3836702">.</span><span class="ident" id="3836703">ObjectIdentifier</span><span class="op" id="3836719">{</span><span class="num" id="3836720">1</span><span class="op" id="3836721">,</span>&nbsp;<span class="num" id="3836723">2</span><span class="op" id="3836724">,</span>&nbsp;<span class="num" id="3836726">840</span><span class="op" id="3836729">,</span>&nbsp;<span class="num" id="3836731">10045</span><span class="op" id="3836736">,</span>&nbsp;<span class="num" id="3836738">4</span><span class="op" id="3836739">,</span>&nbsp;<span class="num" id="3836741">3</span><span class="op" id="3836742">,</span>&nbsp;<span class="num" id="3836744">3</span><span class="op" id="3836745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836748">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="3836776">=</span>&nbsp;<span class="ident" id="3836778">asn1</span><span class="op" id="3836782">.</span><span class="ident" id="3836783">ObjectIdentifier</span><span class="op" id="3836799">{</span><span class="num" id="3836800">1</span><span class="op" id="3836801">,</span>&nbsp;<span class="num" id="3836803">2</span><span class="op" id="3836804">,</span>&nbsp;<span class="num" id="3836806">840</span><span class="op" id="3836809">,</span>&nbsp;<span class="num" id="3836811">10045</span><span class="op" id="3836816">,</span>&nbsp;<span class="num" id="3836818">4</span><span class="op" id="3836819">,</span>&nbsp;<span class="num" id="3836821">3</span><span class="op" id="3836822">,</span>&nbsp;<span class="num" id="3836824">4</span><span class="op" id="3836825">}</span><br>
<span class="lineno"></span><span class="op" id="3836827">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="3836830">var</span>&nbsp;<span class="ident" id="3836834">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3836860">=</span>&nbsp;<span class="op" id="3836862">[</span><span class="op" id="3836863">]</span><span class="keyword" id="3836864">struct</span>&nbsp;<span class="op" id="3836871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836874">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3836885">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836905">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3836916">asn1</span><span class="op" id="3836920">.</span><span class="ident" id="3836921">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836939">pubKeyAlgo</span>&nbsp;<span class="ident" id="3836950">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836970">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3836981">crypto</span><span class="op" id="3836987">.</span><span class="ident" id="3836988">Hash</span><br>
<span class="lineno"></span><span class="op" id="3836993">}</span><span class="op" id="3836994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836997">{</span><span class="ident" id="3836998">MD2WithRSA</span><span class="op" id="3837008">,</span>&nbsp;<span class="ident" id="3837010">oidSignatureMD2WithRSA</span><span class="op" id="3837032">,</span>&nbsp;<span class="ident" id="3837034">RSA</span><span class="op" id="3837037">,</span>&nbsp;<span class="ident" id="3837039">crypto</span><span class="op" id="3837045">.</span><span class="ident" id="3837046">Hash</span><span class="op" id="3837050">(</span><span class="num" id="3837051">0</span><span class="op" id="3837052">)</span>&nbsp;<span class="comment" id="3837054">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="3837076">}</span><span class="op" id="3837077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837080">{</span><span class="ident" id="3837081">MD5WithRSA</span><span class="op" id="3837091">,</span>&nbsp;<span class="ident" id="3837093">oidSignatureMD5WithRSA</span><span class="op" id="3837115">,</span>&nbsp;<span class="ident" id="3837117">RSA</span><span class="op" id="3837120">,</span>&nbsp;<span class="ident" id="3837122">crypto</span><span class="op" id="3837128">.</span><span class="ident" id="3837129">MD5</span><span class="op" id="3837132">}</span><span class="op" id="3837133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837136">{</span><span class="ident" id="3837137">SHA1WithRSA</span><span class="op" id="3837148">,</span>&nbsp;<span class="ident" id="3837150">oidSignatureSHA1WithRSA</span><span class="op" id="3837173">,</span>&nbsp;<span class="ident" id="3837175">RSA</span><span class="op" id="3837178">,</span>&nbsp;<span class="ident" id="3837180">crypto</span><span class="op" id="3837186">.</span><span class="ident" id="3837187">SHA1</span><span class="op" id="3837191">}</span><span class="op" id="3837192">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837195">{</span><span class="ident" id="3837196">SHA256WithRSA</span><span class="op" id="3837209">,</span>&nbsp;<span class="ident" id="3837211">oidSignatureSHA256WithRSA</span><span class="op" id="3837236">,</span>&nbsp;<span class="ident" id="3837238">RSA</span><span class="op" id="3837241">,</span>&nbsp;<span class="ident" id="3837243">crypto</span><span class="op" id="3837249">.</span><span class="ident" id="3837250">SHA256</span><span class="op" id="3837256">}</span><span class="op" id="3837257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837260">{</span><span class="ident" id="3837261">SHA384WithRSA</span><span class="op" id="3837274">,</span>&nbsp;<span class="ident" id="3837276">oidSignatureSHA384WithRSA</span><span class="op" id="3837301">,</span>&nbsp;<span class="ident" id="3837303">RSA</span><span class="op" id="3837306">,</span>&nbsp;<span class="ident" id="3837308">crypto</span><span class="op" id="3837314">.</span><span class="ident" id="3837315">SHA384</span><span class="op" id="3837321">}</span><span class="op" id="3837322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837325">{</span><span class="ident" id="3837326">SHA512WithRSA</span><span class="op" id="3837339">,</span>&nbsp;<span class="ident" id="3837341">oidSignatureSHA512WithRSA</span><span class="op" id="3837366">,</span>&nbsp;<span class="ident" id="3837368">RSA</span><span class="op" id="3837371">,</span>&nbsp;<span class="ident" id="3837373">crypto</span><span class="op" id="3837379">.</span><span class="ident" id="3837380">SHA512</span><span class="op" id="3837386">}</span><span class="op" id="3837387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837390">{</span><span class="ident" id="3837391">DSAWithSHA1</span><span class="op" id="3837402">,</span>&nbsp;<span class="ident" id="3837404">oidSignatureDSAWithSHA1</span><span class="op" id="3837427">,</span>&nbsp;<span class="ident" id="3837429">DSA</span><span class="op" id="3837432">,</span>&nbsp;<span class="ident" id="3837434">crypto</span><span class="op" id="3837440">.</span><span class="ident" id="3837441">SHA1</span><span class="op" id="3837445">}</span><span class="op" id="3837446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837449">{</span><span class="ident" id="3837450">DSAWithSHA256</span><span class="op" id="3837463">,</span>&nbsp;<span class="ident" id="3837465">oidSignatureDSAWithSHA256</span><span class="op" id="3837490">,</span>&nbsp;<span class="ident" id="3837492">DSA</span><span class="op" id="3837495">,</span>&nbsp;<span class="ident" id="3837497">crypto</span><span class="op" id="3837503">.</span><span class="ident" id="3837504">SHA256</span><span class="op" id="3837510">}</span><span class="op" id="3837511">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837514">{</span><span class="ident" id="3837515">ECDSAWithSHA1</span><span class="op" id="3837528">,</span>&nbsp;<span class="ident" id="3837530">oidSignatureECDSAWithSHA1</span><span class="op" id="3837555">,</span>&nbsp;<span class="ident" id="3837557">ECDSA</span><span class="op" id="3837562">,</span>&nbsp;<span class="ident" id="3837564">crypto</span><span class="op" id="3837570">.</span><span class="ident" id="3837571">SHA1</span><span class="op" id="3837575">}</span><span class="op" id="3837576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837579">{</span><span class="ident" id="3837580">ECDSAWithSHA256</span><span class="op" id="3837595">,</span>&nbsp;<span class="ident" id="3837597">oidSignatureECDSAWithSHA256</span><span class="op" id="3837624">,</span>&nbsp;<span class="ident" id="3837626">ECDSA</span><span class="op" id="3837631">,</span>&nbsp;<span class="ident" id="3837633">crypto</span><span class="op" id="3837639">.</span><span class="ident" id="3837640">SHA256</span><span class="op" id="3837646">}</span><span class="op" id="3837647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837650">{</span><span class="ident" id="3837651">ECDSAWithSHA384</span><span class="op" id="3837666">,</span>&nbsp;<span class="ident" id="3837668">oidSignatureECDSAWithSHA384</span><span class="op" id="3837695">,</span>&nbsp;<span class="ident" id="3837697">ECDSA</span><span class="op" id="3837702">,</span>&nbsp;<span class="ident" id="3837704">crypto</span><span class="op" id="3837710">.</span><span class="ident" id="3837711">SHA384</span><span class="op" id="3837717">}</span><span class="op" id="3837718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837721">{</span><span class="ident" id="3837722">ECDSAWithSHA512</span><span class="op" id="3837737">,</span>&nbsp;<span class="ident" id="3837739">oidSignatureECDSAWithSHA512</span><span class="op" id="3837766">,</span>&nbsp;<span class="ident" id="3837768">ECDSA</span><span class="op" id="3837773">,</span>&nbsp;<span class="ident" id="3837775">crypto</span><span class="op" id="3837781">.</span><span class="ident" id="3837782">SHA512</span><span class="op" id="3837788">}</span><span class="op" id="3837789">,</span><br>
<span class="lineno"></span><span class="op" id="3837791">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="3837794">func</span>&nbsp;<span class="ident" id="3837799">getSignatureAlgorithmFromOID</span><span class="op" id="3837827">(</span><span class="ident" id="3837828">oid</span>&nbsp;<span class="ident" id="3837832">asn1</span><span class="op" id="3837836">.</span><span class="ident" id="3837837">ObjectIdentifier</span><span class="op" id="3837853">)</span>&nbsp;<span class="ident" id="3837855">SignatureAlgorithm</span>&nbsp;<span class="op" id="3837874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837877">for</span>&nbsp;<span class="ident" id="3837881">_</span><span class="op" id="3837882">,</span>&nbsp;<span class="ident" id="3837884">details</span>&nbsp;<span class="op" id="3837892">:=</span>&nbsp;<span class="keyword" id="3837895">range</span>&nbsp;<span class="ident" id="3837901">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3837927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837931">if</span>&nbsp;<span class="ident" id="3837934">oid</span><span class="op" id="3837937">.</span><span class="ident" id="3837938">Equal</span><span class="op" id="3837943">(</span><span class="ident" id="3837944">details</span><span class="op" id="3837951">.</span><span class="ident" id="3837952">oid</span><span class="op" id="3837955">)</span>&nbsp;<span class="op" id="3837957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837962">return</span>&nbsp;<span class="ident" id="3837969">details</span><span class="op" id="3837976">.</span><span class="ident" id="3837977">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837990">return</span>&nbsp;<span class="ident" id="3837997">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3838023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="3838026">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3838065">//</span><br>
<span class="lineno"></span><span class="comment" id="3838068">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3838133">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3838166">//</span><br>
<span class="lineno">280</span><span class="comment" id="3838169">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3838223">//</span><br>
<span class="lineno"></span><span class="comment" id="3838226">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3838291">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3838322">//</span><br>
<span class="lineno">285</span><span class="comment" id="3838325">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="3838393">//</span><br>
<span class="lineno"></span><span class="comment" id="3838396">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3838438">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3838510">var</span>&nbsp;<span class="op" id="3838514">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838517">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3838535">=</span>&nbsp;<span class="ident" id="3838537">asn1</span><span class="op" id="3838541">.</span><span class="ident" id="3838542">ObjectIdentifier</span><span class="op" id="3838558">{</span><span class="num" id="3838559">1</span><span class="op" id="3838560">,</span>&nbsp;<span class="num" id="3838562">2</span><span class="op" id="3838563">,</span>&nbsp;<span class="num" id="3838565">840</span><span class="op" id="3838568">,</span>&nbsp;<span class="num" id="3838570">113549</span><span class="op" id="3838576">,</span>&nbsp;<span class="num" id="3838578">1</span><span class="op" id="3838579">,</span>&nbsp;<span class="num" id="3838581">1</span><span class="op" id="3838582">,</span>&nbsp;<span class="num" id="3838584">1</span><span class="op" id="3838585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838588">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3838606">=</span>&nbsp;<span class="ident" id="3838608">asn1</span><span class="op" id="3838612">.</span><span class="ident" id="3838613">ObjectIdentifier</span><span class="op" id="3838629">{</span><span class="num" id="3838630">1</span><span class="op" id="3838631">,</span>&nbsp;<span class="num" id="3838633">2</span><span class="op" id="3838634">,</span>&nbsp;<span class="num" id="3838636">840</span><span class="op" id="3838639">,</span>&nbsp;<span class="num" id="3838641">10040</span><span class="op" id="3838646">,</span>&nbsp;<span class="num" id="3838648">4</span><span class="op" id="3838649">,</span>&nbsp;<span class="num" id="3838651">1</span><span class="op" id="3838652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838655">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="3838673">=</span>&nbsp;<span class="ident" id="3838675">asn1</span><span class="op" id="3838679">.</span><span class="ident" id="3838680">ObjectIdentifier</span><span class="op" id="3838696">{</span><span class="num" id="3838697">1</span><span class="op" id="3838698">,</span>&nbsp;<span class="num" id="3838700">2</span><span class="op" id="3838701">,</span>&nbsp;<span class="num" id="3838703">840</span><span class="op" id="3838706">,</span>&nbsp;<span class="num" id="3838708">10045</span><span class="op" id="3838713">,</span>&nbsp;<span class="num" id="3838715">2</span><span class="op" id="3838716">,</span>&nbsp;<span class="num" id="3838718">1</span><span class="op" id="3838719">}</span><br>
<span class="lineno"></span><span class="op" id="3838721">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="3838724">func</span>&nbsp;<span class="ident" id="3838729">getPublicKeyAlgorithmFromOID</span><span class="op" id="3838757">(</span><span class="ident" id="3838758">oid</span>&nbsp;<span class="ident" id="3838762">asn1</span><span class="op" id="3838766">.</span><span class="ident" id="3838767">ObjectIdentifier</span><span class="op" id="3838783">)</span>&nbsp;<span class="ident" id="3838785">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3838804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838807">switch</span>&nbsp;<span class="op" id="3838814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838817">case</span>&nbsp;<span class="ident" id="3838822">oid</span><span class="op" id="3838825">.</span><span class="ident" id="3838826">Equal</span><span class="op" id="3838831">(</span><span class="ident" id="3838832">oidPublicKeyRSA</span><span class="op" id="3838847">)</span><span class="op" id="3838848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838852">return</span>&nbsp;<span class="ident" id="3838859">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838864">case</span>&nbsp;<span class="ident" id="3838869">oid</span><span class="op" id="3838872">.</span><span class="ident" id="3838873">Equal</span><span class="op" id="3838878">(</span><span class="ident" id="3838879">oidPublicKeyDSA</span><span class="op" id="3838894">)</span><span class="op" id="3838895">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838899">return</span>&nbsp;<span class="ident" id="3838906">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838911">case</span>&nbsp;<span class="ident" id="3838916">oid</span><span class="op" id="3838919">.</span><span class="ident" id="3838920">Equal</span><span class="op" id="3838925">(</span><span class="ident" id="3838926">oidPublicKeyECDSA</span><span class="op" id="3838943">)</span><span class="op" id="3838944">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838948">return</span>&nbsp;<span class="ident" id="3838955">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838965">return</span>&nbsp;<span class="ident" id="3838972">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="3838998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3839001">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="3839035">//</span><br>
<span class="lineno"></span><span class="comment" id="3839038">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="3839075">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3839142">//</span><br>
<span class="lineno"></span><span class="comment" id="3839145">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3839182">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="3839245">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="3839263">//</span><br>
<span class="lineno"></span><span class="comment" id="3839266">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3839303">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3839370">//</span><br>
<span class="lineno"></span><span class="comment" id="3839373">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="3839410">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3839477">//</span><br>
<span class="lineno"></span><span class="comment" id="3839480">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="3839525">var</span>&nbsp;<span class="op" id="3839529">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839532">oidNamedCurveP224</span>&nbsp;<span class="op" id="3839550">=</span>&nbsp;<span class="ident" id="3839552">asn1</span><span class="op" id="3839556">.</span><span class="ident" id="3839557">ObjectIdentifier</span><span class="op" id="3839573">{</span><span class="num" id="3839574">1</span><span class="op" id="3839575">,</span>&nbsp;<span class="num" id="3839577">3</span><span class="op" id="3839578">,</span>&nbsp;<span class="num" id="3839580">132</span><span class="op" id="3839583">,</span>&nbsp;<span class="num" id="3839585">0</span><span class="op" id="3839586">,</span>&nbsp;<span class="num" id="3839588">33</span><span class="op" id="3839590">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839593">oidNamedCurveP256</span>&nbsp;<span class="op" id="3839611">=</span>&nbsp;<span class="ident" id="3839613">asn1</span><span class="op" id="3839617">.</span><span class="ident" id="3839618">ObjectIdentifier</span><span class="op" id="3839634">{</span><span class="num" id="3839635">1</span><span class="op" id="3839636">,</span>&nbsp;<span class="num" id="3839638">2</span><span class="op" id="3839639">,</span>&nbsp;<span class="num" id="3839641">840</span><span class="op" id="3839644">,</span>&nbsp;<span class="num" id="3839646">10045</span><span class="op" id="3839651">,</span>&nbsp;<span class="num" id="3839653">3</span><span class="op" id="3839654">,</span>&nbsp;<span class="num" id="3839656">1</span><span class="op" id="3839657">,</span>&nbsp;<span class="num" id="3839659">7</span><span class="op" id="3839660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839663">oidNamedCurveP384</span>&nbsp;<span class="op" id="3839681">=</span>&nbsp;<span class="ident" id="3839683">asn1</span><span class="op" id="3839687">.</span><span class="ident" id="3839688">ObjectIdentifier</span><span class="op" id="3839704">{</span><span class="num" id="3839705">1</span><span class="op" id="3839706">,</span>&nbsp;<span class="num" id="3839708">3</span><span class="op" id="3839709">,</span>&nbsp;<span class="num" id="3839711">132</span><span class="op" id="3839714">,</span>&nbsp;<span class="num" id="3839716">0</span><span class="op" id="3839717">,</span>&nbsp;<span class="num" id="3839719">34</span><span class="op" id="3839721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839724">oidNamedCurveP521</span>&nbsp;<span class="op" id="3839742">=</span>&nbsp;<span class="ident" id="3839744">asn1</span><span class="op" id="3839748">.</span><span class="ident" id="3839749">ObjectIdentifier</span><span class="op" id="3839765">{</span><span class="num" id="3839766">1</span><span class="op" id="3839767">,</span>&nbsp;<span class="num" id="3839769">3</span><span class="op" id="3839770">,</span>&nbsp;<span class="num" id="3839772">132</span><span class="op" id="3839775">,</span>&nbsp;<span class="num" id="3839777">0</span><span class="op" id="3839778">,</span>&nbsp;<span class="num" id="3839780">35</span><span class="op" id="3839782">}</span><br>
<span class="lineno"></span><span class="op" id="3839784">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="3839787">func</span>&nbsp;<span class="ident" id="3839792">namedCurveFromOID</span><span class="op" id="3839809">(</span><span class="ident" id="3839810">oid</span>&nbsp;<span class="ident" id="3839814">asn1</span><span class="op" id="3839818">.</span><span class="ident" id="3839819">ObjectIdentifier</span><span class="op" id="3839835">)</span>&nbsp;<span class="ident" id="3839837">elliptic</span><span class="op" id="3839845">.</span><span class="ident" id="3839846">Curve</span>&nbsp;<span class="op" id="3839852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839855">switch</span>&nbsp;<span class="op" id="3839862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839865">case</span>&nbsp;<span class="ident" id="3839870">oid</span><span class="op" id="3839873">.</span><span class="ident" id="3839874">Equal</span><span class="op" id="3839879">(</span><span class="ident" id="3839880">oidNamedCurveP224</span><span class="op" id="3839897">)</span><span class="op" id="3839898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839902">return</span>&nbsp;<span class="ident" id="3839909">elliptic</span><span class="op" id="3839917">.</span><span class="ident" id="3839918">P224</span><span class="op" id="3839922">(</span><span class="op" id="3839923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839926">case</span>&nbsp;<span class="ident" id="3839931">oid</span><span class="op" id="3839934">.</span><span class="ident" id="3839935">Equal</span><span class="op" id="3839940">(</span><span class="ident" id="3839941">oidNamedCurveP256</span><span class="op" id="3839958">)</span><span class="op" id="3839959">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839963">return</span>&nbsp;<span class="ident" id="3839970">elliptic</span><span class="op" id="3839978">.</span><span class="ident" id="3839979">P256</span><span class="op" id="3839983">(</span><span class="op" id="3839984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839987">case</span>&nbsp;<span class="ident" id="3839992">oid</span><span class="op" id="3839995">.</span><span class="ident" id="3839996">Equal</span><span class="op" id="3840001">(</span><span class="ident" id="3840002">oidNamedCurveP384</span><span class="op" id="3840019">)</span><span class="op" id="3840020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840024">return</span>&nbsp;<span class="ident" id="3840031">elliptic</span><span class="op" id="3840039">.</span><span class="ident" id="3840040">P384</span><span class="op" id="3840044">(</span><span class="op" id="3840045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840048">case</span>&nbsp;<span class="ident" id="3840053">oid</span><span class="op" id="3840056">.</span><span class="ident" id="3840057">Equal</span><span class="op" id="3840062">(</span><span class="ident" id="3840063">oidNamedCurveP521</span><span class="op" id="3840080">)</span><span class="op" id="3840081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840085">return</span>&nbsp;<span class="ident" id="3840092">elliptic</span><span class="op" id="3840100">.</span><span class="ident" id="3840101">P521</span><span class="op" id="3840105">(</span><span class="op" id="3840106">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840112">return</span>&nbsp;<span class="ident" id="3840119">nil</span><br>
<span class="lineno"></span><span class="op" id="3840123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3840126">func</span>&nbsp;<span class="ident" id="3840131">oidFromNamedCurve</span><span class="op" id="3840148">(</span><span class="ident" id="3840149">curve</span>&nbsp;<span class="ident" id="3840155">elliptic</span><span class="op" id="3840163">.</span><span class="ident" id="3840164">Curve</span><span class="op" id="3840169">)</span>&nbsp;<span class="op" id="3840171">(</span><span class="ident" id="3840172">asn1</span><span class="op" id="3840176">.</span><span class="ident" id="3840177">ObjectIdentifier</span><span class="op" id="3840193">,</span>&nbsp;<span class="builtintype" id="3840195">bool</span><span class="op" id="3840199">)</span>&nbsp;<span class="op" id="3840201">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840204">switch</span>&nbsp;<span class="ident" id="3840211">curve</span>&nbsp;<span class="op" id="3840217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840220">case</span>&nbsp;<span class="ident" id="3840225">elliptic</span><span class="op" id="3840233">.</span><span class="ident" id="3840234">P224</span><span class="op" id="3840238">(</span><span class="op" id="3840239">)</span><span class="op" id="3840240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840244">return</span>&nbsp;<span class="ident" id="3840251">oidNamedCurveP224</span><span class="op" id="3840268">,</span>&nbsp;<span class="builtintype" id="3840270">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840276">case</span>&nbsp;<span class="ident" id="3840281">elliptic</span><span class="op" id="3840289">.</span><span class="ident" id="3840290">P256</span><span class="op" id="3840294">(</span><span class="op" id="3840295">)</span><span class="op" id="3840296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840300">return</span>&nbsp;<span class="ident" id="3840307">oidNamedCurveP256</span><span class="op" id="3840324">,</span>&nbsp;<span class="builtintype" id="3840326">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840332">case</span>&nbsp;<span class="ident" id="3840337">elliptic</span><span class="op" id="3840345">.</span><span class="ident" id="3840346">P384</span><span class="op" id="3840350">(</span><span class="op" id="3840351">)</span><span class="op" id="3840352">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840356">return</span>&nbsp;<span class="ident" id="3840363">oidNamedCurveP384</span><span class="op" id="3840380">,</span>&nbsp;<span class="builtintype" id="3840382">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840388">case</span>&nbsp;<span class="ident" id="3840393">elliptic</span><span class="op" id="3840401">.</span><span class="ident" id="3840402">P521</span><span class="op" id="3840406">(</span><span class="op" id="3840407">)</span><span class="op" id="3840408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840412">return</span>&nbsp;<span class="ident" id="3840419">oidNamedCurveP521</span><span class="op" id="3840436">,</span>&nbsp;<span class="builtintype" id="3840438">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840444">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840448">return</span>&nbsp;<span class="ident" id="3840455">nil</span><span class="op" id="3840458">,</span>&nbsp;<span class="builtintype" id="3840460">false</span><br>
<span class="lineno"></span><span class="op" id="3840466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3840469">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="3840548">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3840588">type</span>&nbsp;<span class="ident" id="3840593">KeyUsage</span>&nbsp;<span class="builtintype" id="3840602">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3840607">const</span>&nbsp;<span class="op" id="3840613">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840616">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="3840641">KeyUsage</span>&nbsp;<span class="op" id="3840650">=</span>&nbsp;<span class="num" id="3840652">1</span>&nbsp;<span class="op" id="3840654">&lt;&lt;</span>&nbsp;<span class="ident" id="3840657">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840663">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840690">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840715">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840741">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840763">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840781">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840798">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840820">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="3840841">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="3840844">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="3840886">//</span><br>
<span class="lineno"></span><span class="comment" id="3840889">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3840958">//</span><br>
<span class="lineno"></span><span class="comment" id="3840961">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="3841006">//</span><br>
<span class="lineno"></span><span class="comment" id="3841009">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3841075">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3841141">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3841207">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="3841273">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3841339">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3841405">var</span>&nbsp;<span class="op" id="3841409">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841412">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841453">=</span>&nbsp;<span class="ident" id="3841455">asn1</span><span class="op" id="3841459">.</span><span class="ident" id="3841460">ObjectIdentifier</span><span class="op" id="3841476">{</span><span class="num" id="3841477">2</span><span class="op" id="3841478">,</span>&nbsp;<span class="num" id="3841480">5</span><span class="op" id="3841481">,</span>&nbsp;<span class="num" id="3841483">29</span><span class="op" id="3841485">,</span>&nbsp;<span class="num" id="3841487">37</span><span class="op" id="3841489">,</span>&nbsp;<span class="num" id="3841491">0</span><span class="op" id="3841492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841495">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841536">=</span>&nbsp;<span class="ident" id="3841538">asn1</span><span class="op" id="3841542">.</span><span class="ident" id="3841543">ObjectIdentifier</span><span class="op" id="3841559">{</span><span class="num" id="3841560">1</span><span class="op" id="3841561">,</span>&nbsp;<span class="num" id="3841563">3</span><span class="op" id="3841564">,</span>&nbsp;<span class="num" id="3841566">6</span><span class="op" id="3841567">,</span>&nbsp;<span class="num" id="3841569">1</span><span class="op" id="3841570">,</span>&nbsp;<span class="num" id="3841572">5</span><span class="op" id="3841573">,</span>&nbsp;<span class="num" id="3841575">5</span><span class="op" id="3841576">,</span>&nbsp;<span class="num" id="3841578">7</span><span class="op" id="3841579">,</span>&nbsp;<span class="num" id="3841581">3</span><span class="op" id="3841582">,</span>&nbsp;<span class="num" id="3841584">1</span><span class="op" id="3841585">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841588">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841629">=</span>&nbsp;<span class="ident" id="3841631">asn1</span><span class="op" id="3841635">.</span><span class="ident" id="3841636">ObjectIdentifier</span><span class="op" id="3841652">{</span><span class="num" id="3841653">1</span><span class="op" id="3841654">,</span>&nbsp;<span class="num" id="3841656">3</span><span class="op" id="3841657">,</span>&nbsp;<span class="num" id="3841659">6</span><span class="op" id="3841660">,</span>&nbsp;<span class="num" id="3841662">1</span><span class="op" id="3841663">,</span>&nbsp;<span class="num" id="3841665">5</span><span class="op" id="3841666">,</span>&nbsp;<span class="num" id="3841668">5</span><span class="op" id="3841669">,</span>&nbsp;<span class="num" id="3841671">7</span><span class="op" id="3841672">,</span>&nbsp;<span class="num" id="3841674">3</span><span class="op" id="3841675">,</span>&nbsp;<span class="num" id="3841677">2</span><span class="op" id="3841678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841681">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841722">=</span>&nbsp;<span class="ident" id="3841724">asn1</span><span class="op" id="3841728">.</span><span class="ident" id="3841729">ObjectIdentifier</span><span class="op" id="3841745">{</span><span class="num" id="3841746">1</span><span class="op" id="3841747">,</span>&nbsp;<span class="num" id="3841749">3</span><span class="op" id="3841750">,</span>&nbsp;<span class="num" id="3841752">6</span><span class="op" id="3841753">,</span>&nbsp;<span class="num" id="3841755">1</span><span class="op" id="3841756">,</span>&nbsp;<span class="num" id="3841758">5</span><span class="op" id="3841759">,</span>&nbsp;<span class="num" id="3841761">5</span><span class="op" id="3841762">,</span>&nbsp;<span class="num" id="3841764">7</span><span class="op" id="3841765">,</span>&nbsp;<span class="num" id="3841767">3</span><span class="op" id="3841768">,</span>&nbsp;<span class="num" id="3841770">3</span><span class="op" id="3841771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841774">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841815">=</span>&nbsp;<span class="ident" id="3841817">asn1</span><span class="op" id="3841821">.</span><span class="ident" id="3841822">ObjectIdentifier</span><span class="op" id="3841838">{</span><span class="num" id="3841839">1</span><span class="op" id="3841840">,</span>&nbsp;<span class="num" id="3841842">3</span><span class="op" id="3841843">,</span>&nbsp;<span class="num" id="3841845">6</span><span class="op" id="3841846">,</span>&nbsp;<span class="num" id="3841848">1</span><span class="op" id="3841849">,</span>&nbsp;<span class="num" id="3841851">5</span><span class="op" id="3841852">,</span>&nbsp;<span class="num" id="3841854">5</span><span class="op" id="3841855">,</span>&nbsp;<span class="num" id="3841857">7</span><span class="op" id="3841858">,</span>&nbsp;<span class="num" id="3841860">3</span><span class="op" id="3841861">,</span>&nbsp;<span class="num" id="3841863">4</span><span class="op" id="3841864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841867">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3841908">=</span>&nbsp;<span class="ident" id="3841910">asn1</span><span class="op" id="3841914">.</span><span class="ident" id="3841915">ObjectIdentifier</span><span class="op" id="3841931">{</span><span class="num" id="3841932">1</span><span class="op" id="3841933">,</span>&nbsp;<span class="num" id="3841935">3</span><span class="op" id="3841936">,</span>&nbsp;<span class="num" id="3841938">6</span><span class="op" id="3841939">,</span>&nbsp;<span class="num" id="3841941">1</span><span class="op" id="3841942">,</span>&nbsp;<span class="num" id="3841944">5</span><span class="op" id="3841945">,</span>&nbsp;<span class="num" id="3841947">5</span><span class="op" id="3841948">,</span>&nbsp;<span class="num" id="3841950">7</span><span class="op" id="3841951">,</span>&nbsp;<span class="num" id="3841953">3</span><span class="op" id="3841954">,</span>&nbsp;<span class="num" id="3841956">5</span><span class="op" id="3841957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841960">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842001">=</span>&nbsp;<span class="ident" id="3842003">asn1</span><span class="op" id="3842007">.</span><span class="ident" id="3842008">ObjectIdentifier</span><span class="op" id="3842024">{</span><span class="num" id="3842025">1</span><span class="op" id="3842026">,</span>&nbsp;<span class="num" id="3842028">3</span><span class="op" id="3842029">,</span>&nbsp;<span class="num" id="3842031">6</span><span class="op" id="3842032">,</span>&nbsp;<span class="num" id="3842034">1</span><span class="op" id="3842035">,</span>&nbsp;<span class="num" id="3842037">5</span><span class="op" id="3842038">,</span>&nbsp;<span class="num" id="3842040">5</span><span class="op" id="3842041">,</span>&nbsp;<span class="num" id="3842043">7</span><span class="op" id="3842044">,</span>&nbsp;<span class="num" id="3842046">3</span><span class="op" id="3842047">,</span>&nbsp;<span class="num" id="3842049">6</span><span class="op" id="3842050">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842053">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842094">=</span>&nbsp;<span class="ident" id="3842096">asn1</span><span class="op" id="3842100">.</span><span class="ident" id="3842101">ObjectIdentifier</span><span class="op" id="3842117">{</span><span class="num" id="3842118">1</span><span class="op" id="3842119">,</span>&nbsp;<span class="num" id="3842121">3</span><span class="op" id="3842122">,</span>&nbsp;<span class="num" id="3842124">6</span><span class="op" id="3842125">,</span>&nbsp;<span class="num" id="3842127">1</span><span class="op" id="3842128">,</span>&nbsp;<span class="num" id="3842130">5</span><span class="op" id="3842131">,</span>&nbsp;<span class="num" id="3842133">5</span><span class="op" id="3842134">,</span>&nbsp;<span class="num" id="3842136">7</span><span class="op" id="3842137">,</span>&nbsp;<span class="num" id="3842139">3</span><span class="op" id="3842140">,</span>&nbsp;<span class="num" id="3842142">7</span><span class="op" id="3842143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842146">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842187">=</span>&nbsp;<span class="ident" id="3842189">asn1</span><span class="op" id="3842193">.</span><span class="ident" id="3842194">ObjectIdentifier</span><span class="op" id="3842210">{</span><span class="num" id="3842211">1</span><span class="op" id="3842212">,</span>&nbsp;<span class="num" id="3842214">3</span><span class="op" id="3842215">,</span>&nbsp;<span class="num" id="3842217">6</span><span class="op" id="3842218">,</span>&nbsp;<span class="num" id="3842220">1</span><span class="op" id="3842221">,</span>&nbsp;<span class="num" id="3842223">5</span><span class="op" id="3842224">,</span>&nbsp;<span class="num" id="3842226">5</span><span class="op" id="3842227">,</span>&nbsp;<span class="num" id="3842229">7</span><span class="op" id="3842230">,</span>&nbsp;<span class="num" id="3842232">3</span><span class="op" id="3842233">,</span>&nbsp;<span class="num" id="3842235">8</span><span class="op" id="3842236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842239">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3842280">=</span>&nbsp;<span class="ident" id="3842282">asn1</span><span class="op" id="3842286">.</span><span class="ident" id="3842287">ObjectIdentifier</span><span class="op" id="3842303">{</span><span class="num" id="3842304">1</span><span class="op" id="3842305">,</span>&nbsp;<span class="num" id="3842307">3</span><span class="op" id="3842308">,</span>&nbsp;<span class="num" id="3842310">6</span><span class="op" id="3842311">,</span>&nbsp;<span class="num" id="3842313">1</span><span class="op" id="3842314">,</span>&nbsp;<span class="num" id="3842316">5</span><span class="op" id="3842317">,</span>&nbsp;<span class="num" id="3842319">5</span><span class="op" id="3842320">,</span>&nbsp;<span class="num" id="3842322">7</span><span class="op" id="3842323">,</span>&nbsp;<span class="num" id="3842325">3</span><span class="op" id="3842326">,</span>&nbsp;<span class="num" id="3842328">9</span><span class="op" id="3842329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842332">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="3842373">=</span>&nbsp;<span class="ident" id="3842375">asn1</span><span class="op" id="3842379">.</span><span class="ident" id="3842380">ObjectIdentifier</span><span class="op" id="3842396">{</span><span class="num" id="3842397">1</span><span class="op" id="3842398">,</span>&nbsp;<span class="num" id="3842400">3</span><span class="op" id="3842401">,</span>&nbsp;<span class="num" id="3842403">6</span><span class="op" id="3842404">,</span>&nbsp;<span class="num" id="3842406">1</span><span class="op" id="3842407">,</span>&nbsp;<span class="num" id="3842409">4</span><span class="op" id="3842410">,</span>&nbsp;<span class="num" id="3842412">1</span><span class="op" id="3842413">,</span>&nbsp;<span class="num" id="3842415">311</span><span class="op" id="3842418">,</span>&nbsp;<span class="num" id="3842420">10</span><span class="op" id="3842422">,</span>&nbsp;<span class="num" id="3842424">3</span><span class="op" id="3842425">,</span>&nbsp;<span class="num" id="3842427">3</span><span class="op" id="3842428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842431">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="3842472">=</span>&nbsp;<span class="ident" id="3842474">asn1</span><span class="op" id="3842478">.</span><span class="ident" id="3842479">ObjectIdentifier</span><span class="op" id="3842495">{</span><span class="num" id="3842496">2</span><span class="op" id="3842497">,</span>&nbsp;<span class="num" id="3842499">16</span><span class="op" id="3842501">,</span>&nbsp;<span class="num" id="3842503">840</span><span class="op" id="3842506">,</span>&nbsp;<span class="num" id="3842508">1</span><span class="op" id="3842509">,</span>&nbsp;<span class="num" id="3842511">113730</span><span class="op" id="3842517">,</span>&nbsp;<span class="num" id="3842519">4</span><span class="op" id="3842520">,</span>&nbsp;<span class="num" id="3842522">1</span><span class="op" id="3842523">}</span><br>
<span class="lineno">400</span><span class="op" id="3842525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3842528">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="3842613">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3842675">type</span>&nbsp;<span class="ident" id="3842680">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="3842692">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="3842697">const</span>&nbsp;<span class="op" id="3842703">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842706">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="3842721">ExtKeyUsage</span>&nbsp;<span class="op" id="3842733">=</span>&nbsp;<span class="ident" id="3842735">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842741">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842764">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842787">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842811">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842839">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842866">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842890">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842912">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842937">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842961">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843000">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="3843037">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="3843040">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="3843116">var</span>&nbsp;<span class="ident" id="3843120">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3843136">=</span>&nbsp;<span class="op" id="3843138">[</span><span class="op" id="3843139">]</span><span class="keyword" id="3843140">struct</span>&nbsp;<span class="op" id="3843147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843150">extKeyUsage</span>&nbsp;<span class="ident" id="3843162">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843175">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3843187">asn1</span><span class="op" id="3843191">.</span><span class="ident" id="3843192">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="3843209">}</span><span class="op" id="3843210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843213">{</span><span class="ident" id="3843214">ExtKeyUsageAny</span><span class="op" id="3843228">,</span>&nbsp;<span class="ident" id="3843230">oidExtKeyUsageAny</span><span class="op" id="3843247">}</span><span class="op" id="3843248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843251">{</span><span class="ident" id="3843252">ExtKeyUsageServerAuth</span><span class="op" id="3843273">,</span>&nbsp;<span class="ident" id="3843275">oidExtKeyUsageServerAuth</span><span class="op" id="3843299">}</span><span class="op" id="3843300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843303">{</span><span class="ident" id="3843304">ExtKeyUsageClientAuth</span><span class="op" id="3843325">,</span>&nbsp;<span class="ident" id="3843327">oidExtKeyUsageClientAuth</span><span class="op" id="3843351">}</span><span class="op" id="3843352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843355">{</span><span class="ident" id="3843356">ExtKeyUsageCodeSigning</span><span class="op" id="3843378">,</span>&nbsp;<span class="ident" id="3843380">oidExtKeyUsageCodeSigning</span><span class="op" id="3843405">}</span><span class="op" id="3843406">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843409">{</span><span class="ident" id="3843410">ExtKeyUsageEmailProtection</span><span class="op" id="3843436">,</span>&nbsp;<span class="ident" id="3843438">oidExtKeyUsageEmailProtection</span><span class="op" id="3843467">}</span><span class="op" id="3843468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843471">{</span><span class="ident" id="3843472">ExtKeyUsageIPSECEndSystem</span><span class="op" id="3843497">,</span>&nbsp;<span class="ident" id="3843499">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="3843527">}</span><span class="op" id="3843528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843531">{</span><span class="ident" id="3843532">ExtKeyUsageIPSECTunnel</span><span class="op" id="3843554">,</span>&nbsp;<span class="ident" id="3843556">oidExtKeyUsageIPSECTunnel</span><span class="op" id="3843581">}</span><span class="op" id="3843582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843585">{</span><span class="ident" id="3843586">ExtKeyUsageIPSECUser</span><span class="op" id="3843606">,</span>&nbsp;<span class="ident" id="3843608">oidExtKeyUsageIPSECUser</span><span class="op" id="3843631">}</span><span class="op" id="3843632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843635">{</span><span class="ident" id="3843636">ExtKeyUsageTimeStamping</span><span class="op" id="3843659">,</span>&nbsp;<span class="ident" id="3843661">oidExtKeyUsageTimeStamping</span><span class="op" id="3843687">}</span><span class="op" id="3843688">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843691">{</span><span class="ident" id="3843692">ExtKeyUsageOCSPSigning</span><span class="op" id="3843714">,</span>&nbsp;<span class="ident" id="3843716">oidExtKeyUsageOCSPSigning</span><span class="op" id="3843741">}</span><span class="op" id="3843742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843745">{</span><span class="ident" id="3843746">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3843783">,</span>&nbsp;<span class="ident" id="3843785">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3843825">}</span><span class="op" id="3843826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843829">{</span><span class="ident" id="3843830">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3843866">,</span>&nbsp;<span class="ident" id="3843868">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3843907">}</span><span class="op" id="3843908">,</span><br>
<span class="lineno"></span><span class="op" id="3843910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="3843913">func</span>&nbsp;<span class="ident" id="3843918">extKeyUsageFromOID</span><span class="op" id="3843936">(</span><span class="ident" id="3843937">oid</span>&nbsp;<span class="ident" id="3843941">asn1</span><span class="op" id="3843945">.</span><span class="ident" id="3843946">ObjectIdentifier</span><span class="op" id="3843962">)</span>&nbsp;<span class="op" id="3843964">(</span><span class="ident" id="3843965">eku</span>&nbsp;<span class="ident" id="3843969">ExtKeyUsage</span><span class="op" id="3843980">,</span>&nbsp;<span class="ident" id="3843982">ok</span>&nbsp;<span class="builtintype" id="3843985">bool</span><span class="op" id="3843989">)</span>&nbsp;<span class="op" id="3843991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843994">for</span>&nbsp;<span class="ident" id="3843998">_</span><span class="op" id="3843999">,</span>&nbsp;<span class="ident" id="3844001">pair</span>&nbsp;<span class="op" id="3844006">:=</span>&nbsp;<span class="keyword" id="3844009">range</span>&nbsp;<span class="ident" id="3844015">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3844031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844035">if</span>&nbsp;<span class="ident" id="3844038">oid</span><span class="op" id="3844041">.</span><span class="ident" id="3844042">Equal</span><span class="op" id="3844047">(</span><span class="ident" id="3844048">pair</span><span class="op" id="3844052">.</span><span class="ident" id="3844053">oid</span><span class="op" id="3844056">)</span>&nbsp;<span class="op" id="3844058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844063">return</span>&nbsp;<span class="ident" id="3844070">pair</span><span class="op" id="3844074">.</span><span class="ident" id="3844075">extKeyUsage</span><span class="op" id="3844086">,</span>&nbsp;<span class="builtintype" id="3844088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844095">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844101">return</span><br>
<span class="lineno"></span><span class="op" id="3844108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3844111">func</span>&nbsp;<span class="ident" id="3844116">oidFromExtKeyUsage</span><span class="op" id="3844134">(</span><span class="ident" id="3844135">eku</span>&nbsp;<span class="ident" id="3844139">ExtKeyUsage</span><span class="op" id="3844150">)</span>&nbsp;<span class="op" id="3844152">(</span><span class="ident" id="3844153">oid</span>&nbsp;<span class="ident" id="3844157">asn1</span><span class="op" id="3844161">.</span><span class="ident" id="3844162">ObjectIdentifier</span><span class="op" id="3844178">,</span>&nbsp;<span class="ident" id="3844180">ok</span>&nbsp;<span class="builtintype" id="3844183">bool</span><span class="op" id="3844187">)</span>&nbsp;<span class="op" id="3844189">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844192">for</span>&nbsp;<span class="ident" id="3844196">_</span><span class="op" id="3844197">,</span>&nbsp;<span class="ident" id="3844199">pair</span>&nbsp;<span class="op" id="3844204">:=</span>&nbsp;<span class="keyword" id="3844207">range</span>&nbsp;<span class="ident" id="3844213">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3844229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844233">if</span>&nbsp;<span class="ident" id="3844236">eku</span>&nbsp;<span class="op" id="3844240">==</span>&nbsp;<span class="ident" id="3844243">pair</span><span class="op" id="3844247">.</span><span class="ident" id="3844248">extKeyUsage</span>&nbsp;<span class="op" id="3844260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844265">return</span>&nbsp;<span class="ident" id="3844272">pair</span><span class="op" id="3844276">.</span><span class="ident" id="3844277">oid</span><span class="op" id="3844280">,</span>&nbsp;<span class="builtintype" id="3844282">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844292">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844295">return</span><br>
<span class="lineno"></span><span class="op" id="3844302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3844305">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="3844355">type</span>&nbsp;<span class="ident" id="3844360">Certificate</span>&nbsp;<span class="keyword" id="3844372">struct</span>&nbsp;<span class="op" id="3844379">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844382">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844406">[</span><span class="op" id="3844407">]</span><span class="builtintype" id="3844408">byte</span>&nbsp;<span class="comment" id="3844413">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844494">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844518">[</span><span class="op" id="3844519">]</span><span class="builtintype" id="3844520">byte</span>&nbsp;<span class="comment" id="3844525">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844572">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3844596">[</span><span class="op" id="3844597">]</span><span class="builtintype" id="3844598">byte</span>&nbsp;<span class="comment" id="3844603">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844641">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844665">[</span><span class="op" id="3844666">]</span><span class="builtintype" id="3844667">byte</span>&nbsp;<span class="comment" id="3844672">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844696">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844720">[</span><span class="op" id="3844721">]</span><span class="builtintype" id="3844722">byte</span>&nbsp;<span class="comment" id="3844727">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844751">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844770">[</span><span class="op" id="3844771">]</span><span class="builtintype" id="3844772">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844778">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3844797">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844818">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3844837">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844857">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3844876">interface</span><span class="op" id="3844885">{</span><span class="op" id="3844886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844890">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3844910">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844915">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3844935">*</span><span class="ident" id="3844936">big</span><span class="op" id="3844939">.</span><span class="ident" id="3844940">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844945">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844965">pkix</span><span class="op" id="3844969">.</span><span class="ident" id="3844970">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844976">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3844996">pkix</span><span class="op" id="3845000">.</span><span class="ident" id="3845001">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845007">NotBefore</span><span class="op" id="3845016">,</span>&nbsp;<span class="ident" id="3845018">NotAfter</span>&nbsp;<span class="ident" id="3845027">time</span><span class="op" id="3845031">.</span><span class="ident" id="3845032">Time</span>&nbsp;<span class="comment" id="3845037">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845058">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845078">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845089">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845162">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845231">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845304">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845347">Extensions</span>&nbsp;<span class="op" id="3845358">[</span><span class="op" id="3845359">]</span><span class="ident" id="3845360">pkix</span><span class="op" id="3845364">.</span><span class="ident" id="3845365">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845377">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845445">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845515">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3845588">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845658">ExtraExtensions</span>&nbsp;<span class="op" id="3845674">[</span><span class="op" id="3845675">]</span><span class="ident" id="3845676">pkix</span><span class="op" id="3845680">.</span><span class="ident" id="3845681">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845693">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845712">[</span><span class="op" id="3845713">]</span><span class="ident" id="3845714">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3845736">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845773">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="3845792">[</span><span class="op" id="3845793">]</span><span class="ident" id="3845794">asn1</span><span class="op" id="3845798">.</span><span class="ident" id="3845799">ObjectIdentifier</span>&nbsp;<span class="comment" id="3845816">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845878">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="3845900">bool</span>&nbsp;<span class="comment" id="3845905">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845953">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3845975">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845981">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3846003">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846008">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846074">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846147">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846217">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846236">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="3846251">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846258">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3846273">[</span><span class="op" id="3846274">]</span><span class="builtintype" id="3846275">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846281">AuthorityKeyId</span>&nbsp;<span class="op" id="3846296">[</span><span class="op" id="3846297">]</span><span class="builtintype" id="3846298">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846305">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846358">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846380">[</span><span class="op" id="3846381">]</span><span class="builtintype" id="3846382">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846390">IssuingCertificateURL</span>&nbsp;<span class="op" id="3846412">[</span><span class="op" id="3846413">]</span><span class="builtintype" id="3846414">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846423">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846457">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846472">[</span><span class="op" id="3846473">]</span><span class="builtintype" id="3846474">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846482">EmailAddresses</span>&nbsp;<span class="op" id="3846497">[</span><span class="op" id="3846498">]</span><span class="builtintype" id="3846499">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846507">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846522">[</span><span class="op" id="3846523">]</span><span class="ident" id="3846524">net</span><span class="op" id="3846527">.</span><span class="ident" id="3846528">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846533">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846554">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="3846582">bool</span>&nbsp;<span class="comment" id="3846587">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846646">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846674">[</span><span class="op" id="3846675">]</span><span class="builtintype" id="3846676">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3846685">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846713">CRLDistributionPoints</span>&nbsp;<span class="op" id="3846735">[</span><span class="op" id="3846736">]</span><span class="builtintype" id="3846737">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846746">PolicyIdentifiers</span>&nbsp;<span class="op" id="3846764">[</span><span class="op" id="3846765">]</span><span class="ident" id="3846766">asn1</span><span class="op" id="3846770">.</span><span class="ident" id="3846771">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="3846788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3846791">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3846871">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="3846930">var</span>&nbsp;<span class="ident" id="3846934">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="3846958">=</span>&nbsp;<span class="ident" id="3846960">errors</span><span class="op" id="3846966">.</span><span class="ident" id="3846967">New</span><span class="op" id="3846970">(</span><span class="string" id="3846971">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="3847027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3847030">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="3847109">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3847189">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3847217">type</span>&nbsp;<span class="ident" id="3847222">ConstraintViolationError</span>&nbsp;<span class="keyword" id="3847247">struct</span><span class="op" id="3847253">{</span><span class="op" id="3847254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847257">func</span>&nbsp;<span class="op" id="3847262">(</span><span class="ident" id="3847263">ConstraintViolationError</span><span class="op" id="3847287">)</span>&nbsp;<span class="ident" id="3847289">Error</span><span class="op" id="3847294">(</span><span class="op" id="3847295">)</span>&nbsp;<span class="builtintype" id="3847297">string</span>&nbsp;<span class="op" id="3847304">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847307">return</span>&nbsp;<span class="string" id="3847314">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="3847397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847400">func</span>&nbsp;<span class="op" id="3847405">(</span><span class="ident" id="3847406">c</span>&nbsp;<span class="op" id="3847408">*</span><span class="ident" id="3847409">Certificate</span><span class="op" id="3847420">)</span>&nbsp;<span class="ident" id="3847422">Equal</span><span class="op" id="3847427">(</span><span class="ident" id="3847428">other</span>&nbsp;<span class="op" id="3847434">*</span><span class="ident" id="3847435">Certificate</span><span class="op" id="3847446">)</span>&nbsp;<span class="builtintype" id="3847448">bool</span>&nbsp;<span class="op" id="3847453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847456">return</span>&nbsp;<span class="ident" id="3847463">bytes</span><span class="op" id="3847468">.</span><span class="ident" id="3847469">Equal</span><span class="op" id="3847474">(</span><span class="ident" id="3847475">c</span><span class="op" id="3847476">.</span><span class="ident" id="3847477">Raw</span><span class="op" id="3847480">,</span>&nbsp;<span class="ident" id="3847482">other</span><span class="op" id="3847487">.</span><span class="ident" id="3847488">Raw</span><span class="op" id="3847491">)</span><br>
<span class="lineno">540</span><span class="op" id="3847493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3847496">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="3847568">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="3847648">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="3847670">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3847745">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="3847788">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="3847854">//</span><br>
<span class="lineno"></span><span class="comment" id="3847857">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="3847929">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="3847944">var</span>&nbsp;<span class="ident" id="3847948">entrustBrokenSPKI</span>&nbsp;<span class="op" id="3847966">=</span>&nbsp;<span class="op" id="3847968">[</span><span class="op" id="3847969">]</span><span class="builtintype" id="3847970">byte</span><span class="op" id="3847974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3847977">0x30</span><span class="op" id="3847981">,</span>&nbsp;<span class="num" id="3847983">0x82</span><span class="op" id="3847987">,</span>&nbsp;<span class="num" id="3847989">0x01</span><span class="op" id="3847993">,</span>&nbsp;<span class="num" id="3847995">0x22</span><span class="op" id="3847999">,</span>&nbsp;<span class="num" id="3848001">0x30</span><span class="op" id="3848005">,</span>&nbsp;<span class="num" id="3848007">0x0d</span><span class="op" id="3848011">,</span>&nbsp;<span class="num" id="3848013">0x06</span><span class="op" id="3848017">,</span>&nbsp;<span class="num" id="3848019">0x09</span><span class="op" id="3848023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848026">0x2a</span><span class="op" id="3848030">,</span>&nbsp;<span class="num" id="3848032">0x86</span><span class="op" id="3848036">,</span>&nbsp;<span class="num" id="3848038">0x48</span><span class="op" id="3848042">,</span>&nbsp;<span class="num" id="3848044">0x86</span><span class="op" id="3848048">,</span>&nbsp;<span class="num" id="3848050">0xf7</span><span class="op" id="3848054">,</span>&nbsp;<span class="num" id="3848056">0x0d</span><span class="op" id="3848060">,</span>&nbsp;<span class="num" id="3848062">0x01</span><span class="op" id="3848066">,</span>&nbsp;<span class="num" id="3848068">0x01</span><span class="op" id="3848072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848075">0x01</span><span class="op" id="3848079">,</span>&nbsp;<span class="num" id="3848081">0x05</span><span class="op" id="3848085">,</span>&nbsp;<span class="num" id="3848087">0x00</span><span class="op" id="3848091">,</span>&nbsp;<span class="num" id="3848093">0x03</span><span class="op" id="3848097">,</span>&nbsp;<span class="num" id="3848099">0x82</span><span class="op" id="3848103">,</span>&nbsp;<span class="num" id="3848105">0x01</span><span class="op" id="3848109">,</span>&nbsp;<span class="num" id="3848111">0x0f</span><span class="op" id="3848115">,</span>&nbsp;<span class="num" id="3848117">0x00</span><span class="op" id="3848121">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848124">0x30</span><span class="op" id="3848128">,</span>&nbsp;<span class="num" id="3848130">0x82</span><span class="op" id="3848134">,</span>&nbsp;<span class="num" id="3848136">0x01</span><span class="op" id="3848140">,</span>&nbsp;<span class="num" id="3848142">0x0a</span><span class="op" id="3848146">,</span>&nbsp;<span class="num" id="3848148">0x02</span><span class="op" id="3848152">,</span>&nbsp;<span class="num" id="3848154">0x82</span><span class="op" id="3848158">,</span>&nbsp;<span class="num" id="3848160">0x01</span><span class="op" id="3848164">,</span>&nbsp;<span class="num" id="3848166">0x01</span><span class="op" id="3848170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848173">0x00</span><span class="op" id="3848177">,</span>&nbsp;<span class="num" id="3848179">0x97</span><span class="op" id="3848183">,</span>&nbsp;<span class="num" id="3848185">0xa3</span><span class="op" id="3848189">,</span>&nbsp;<span class="num" id="3848191">0x2d</span><span class="op" id="3848195">,</span>&nbsp;<span class="num" id="3848197">0x3c</span><span class="op" id="3848201">,</span>&nbsp;<span class="num" id="3848203">0x9e</span><span class="op" id="3848207">,</span>&nbsp;<span class="num" id="3848209">0xde</span><span class="op" id="3848213">,</span>&nbsp;<span class="num" id="3848215">0x05</span><span class="op" id="3848219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848222">0xda</span><span class="op" id="3848226">,</span>&nbsp;<span class="num" id="3848228">0x13</span><span class="op" id="3848232">,</span>&nbsp;<span class="num" id="3848234">0xc2</span><span class="op" id="3848238">,</span>&nbsp;<span class="num" id="3848240">0x11</span><span class="op" id="3848244">,</span>&nbsp;<span class="num" id="3848246">0x8d</span><span class="op" id="3848250">,</span>&nbsp;<span class="num" id="3848252">0x9d</span><span class="op" id="3848256">,</span>&nbsp;<span class="num" id="3848258">0x8e</span><span class="op" id="3848262">,</span>&nbsp;<span class="num" id="3848264">0xe3</span><span class="op" id="3848268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848271">0x7f</span><span class="op" id="3848275">,</span>&nbsp;<span class="num" id="3848277">0xc7</span><span class="op" id="3848281">,</span>&nbsp;<span class="num" id="3848283">0x4b</span><span class="op" id="3848287">,</span>&nbsp;<span class="num" id="3848289">0x7e</span><span class="op" id="3848293">,</span>&nbsp;<span class="num" id="3848295">0x5a</span><span class="op" id="3848299">,</span>&nbsp;<span class="num" id="3848301">0x9f</span><span class="op" id="3848305">,</span>&nbsp;<span class="num" id="3848307">0xb3</span><span class="op" id="3848311">,</span>&nbsp;<span class="num" id="3848313">0xff</span><span class="op" id="3848317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848320">0x62</span><span class="op" id="3848324">,</span>&nbsp;<span class="num" id="3848326">0xab</span><span class="op" id="3848330">,</span>&nbsp;<span class="num" id="3848332">0x73</span><span class="op" id="3848336">,</span>&nbsp;<span class="num" id="3848338">0xc8</span><span class="op" id="3848342">,</span>&nbsp;<span class="num" id="3848344">0x28</span><span class="op" id="3848348">,</span>&nbsp;<span class="num" id="3848350">0x6b</span><span class="op" id="3848354">,</span>&nbsp;<span class="num" id="3848356">0xba</span><span class="op" id="3848360">,</span>&nbsp;<span class="num" id="3848362">0x10</span><span class="op" id="3848366">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848369">0x64</span><span class="op" id="3848373">,</span>&nbsp;<span class="num" id="3848375">0x82</span><span class="op" id="3848379">,</span>&nbsp;<span class="num" id="3848381">0x87</span><span class="op" id="3848385">,</span>&nbsp;<span class="num" id="3848387">0x13</span><span class="op" id="3848391">,</span>&nbsp;<span class="num" id="3848393">0xcd</span><span class="op" id="3848397">,</span>&nbsp;<span class="num" id="3848399">0x57</span><span class="op" id="3848403">,</span>&nbsp;<span class="num" id="3848405">0x18</span><span class="op" id="3848409">,</span>&nbsp;<span class="num" id="3848411">0xff</span><span class="op" id="3848415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848418">0x28</span><span class="op" id="3848422">,</span>&nbsp;<span class="num" id="3848424">0xce</span><span class="op" id="3848428">,</span>&nbsp;<span class="num" id="3848430">0xc0</span><span class="op" id="3848434">,</span>&nbsp;<span class="num" id="3848436">0xe6</span><span class="op" id="3848440">,</span>&nbsp;<span class="num" id="3848442">0x0e</span><span class="op" id="3848446">,</span>&nbsp;<span class="num" id="3848448">0x06</span><span class="op" id="3848452">,</span>&nbsp;<span class="num" id="3848454">0x91</span><span class="op" id="3848458">,</span>&nbsp;<span class="num" id="3848460">0x50</span><span class="op" id="3848464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848467">0x29</span><span class="op" id="3848471">,</span>&nbsp;<span class="num" id="3848473">0x83</span><span class="op" id="3848477">,</span>&nbsp;<span class="num" id="3848479">0xd1</span><span class="op" id="3848483">,</span>&nbsp;<span class="num" id="3848485">0xf2</span><span class="op" id="3848489">,</span>&nbsp;<span class="num" id="3848491">0xc3</span><span class="op" id="3848495">,</span>&nbsp;<span class="num" id="3848497">0x2a</span><span class="op" id="3848501">,</span>&nbsp;<span class="num" id="3848503">0xdb</span><span class="op" id="3848507">,</span>&nbsp;<span class="num" id="3848509">0xd8</span><span class="op" id="3848513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848516">0xdb</span><span class="op" id="3848520">,</span>&nbsp;<span class="num" id="3848522">0x4e</span><span class="op" id="3848526">,</span>&nbsp;<span class="num" id="3848528">0x04</span><span class="op" id="3848532">,</span>&nbsp;<span class="num" id="3848534">0xcc</span><span class="op" id="3848538">,</span>&nbsp;<span class="num" id="3848540">0x00</span><span class="op" id="3848544">,</span>&nbsp;<span class="num" id="3848546">0xeb</span><span class="op" id="3848550">,</span>&nbsp;<span class="num" id="3848552">0x8b</span><span class="op" id="3848556">,</span>&nbsp;<span class="num" id="3848558">0xb6</span><span class="op" id="3848562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848565">0x96</span><span class="op" id="3848569">,</span>&nbsp;<span class="num" id="3848571">0xdc</span><span class="op" id="3848575">,</span>&nbsp;<span class="num" id="3848577">0xbc</span><span class="op" id="3848581">,</span>&nbsp;<span class="num" id="3848583">0xaa</span><span class="op" id="3848587">,</span>&nbsp;<span class="num" id="3848589">0xfa</span><span class="op" id="3848593">,</span>&nbsp;<span class="num" id="3848595">0x52</span><span class="op" id="3848599">,</span>&nbsp;<span class="num" id="3848601">0x77</span><span class="op" id="3848605">,</span>&nbsp;<span class="num" id="3848607">0x04</span><span class="op" id="3848611">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848614">0xc1</span><span class="op" id="3848618">,</span>&nbsp;<span class="num" id="3848620">0xdb</span><span class="op" id="3848624">,</span>&nbsp;<span class="num" id="3848626">0x19</span><span class="op" id="3848630">,</span>&nbsp;<span class="num" id="3848632">0xe4</span><span class="op" id="3848636">,</span>&nbsp;<span class="num" id="3848638">0xae</span><span class="op" id="3848642">,</span>&nbsp;<span class="num" id="3848644">0x9c</span><span class="op" id="3848648">,</span>&nbsp;<span class="num" id="3848650">0xfd</span><span class="op" id="3848654">,</span>&nbsp;<span class="num" id="3848656">0x3c</span><span class="op" id="3848660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848663">0x8b</span><span class="op" id="3848667">,</span>&nbsp;<span class="num" id="3848669">0x03</span><span class="op" id="3848673">,</span>&nbsp;<span class="num" id="3848675">0xef</span><span class="op" id="3848679">,</span>&nbsp;<span class="num" id="3848681">0x4d</span><span class="op" id="3848685">,</span>&nbsp;<span class="num" id="3848687">0xbc</span><span class="op" id="3848691">,</span>&nbsp;<span class="num" id="3848693">0x1a</span><span class="op" id="3848697">,</span>&nbsp;<span class="num" id="3848699">0x03</span><span class="op" id="3848703">,</span>&nbsp;<span class="num" id="3848705">0x65</span><span class="op" id="3848709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848712">0xf9</span><span class="op" id="3848716">,</span>&nbsp;<span class="num" id="3848718">0xc1</span><span class="op" id="3848722">,</span>&nbsp;<span class="num" id="3848724">0xb1</span><span class="op" id="3848728">,</span>&nbsp;<span class="num" id="3848730">0x3f</span><span class="op" id="3848734">,</span>&nbsp;<span class="num" id="3848736">0x72</span><span class="op" id="3848740">,</span>&nbsp;<span class="num" id="3848742">0x86</span><span class="op" id="3848746">,</span>&nbsp;<span class="num" id="3848748">0xf2</span><span class="op" id="3848752">,</span>&nbsp;<span class="num" id="3848754">0x38</span><span class="op" id="3848758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848761">0xaa</span><span class="op" id="3848765">,</span>&nbsp;<span class="num" id="3848767">0x19</span><span class="op" id="3848771">,</span>&nbsp;<span class="num" id="3848773">0xae</span><span class="op" id="3848777">,</span>&nbsp;<span class="num" id="3848779">0x10</span><span class="op" id="3848783">,</span>&nbsp;<span class="num" id="3848785">0x88</span><span class="op" id="3848789">,</span>&nbsp;<span class="num" id="3848791">0x78</span><span class="op" id="3848795">,</span>&nbsp;<span class="num" id="3848797">0x28</span><span class="op" id="3848801">,</span>&nbsp;<span class="num" id="3848803">0xda</span><span class="op" id="3848807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848810">0x75</span><span class="op" id="3848814">,</span>&nbsp;<span class="num" id="3848816">0xc3</span><span class="op" id="3848820">,</span>&nbsp;<span class="num" id="3848822">0x3d</span><span class="op" id="3848826">,</span>&nbsp;<span class="num" id="3848828">0x02</span><span class="op" id="3848832">,</span>&nbsp;<span class="num" id="3848834">0x82</span><span class="op" id="3848838">,</span>&nbsp;<span class="num" id="3848840">0x02</span><span class="op" id="3848844">,</span>&nbsp;<span class="num" id="3848846">0x9c</span><span class="op" id="3848850">,</span>&nbsp;<span class="num" id="3848852">0xb9</span><span class="op" id="3848856">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848859">0xc1</span><span class="op" id="3848863">,</span>&nbsp;<span class="num" id="3848865">0x65</span><span class="op" id="3848869">,</span>&nbsp;<span class="num" id="3848871">0x77</span><span class="op" id="3848875">,</span>&nbsp;<span class="num" id="3848877">0x76</span><span class="op" id="3848881">,</span>&nbsp;<span class="num" id="3848883">0x24</span><span class="op" id="3848887">,</span>&nbsp;<span class="num" id="3848889">0x4c</span><span class="op" id="3848893">,</span>&nbsp;<span class="num" id="3848895">0x98</span><span class="op" id="3848899">,</span>&nbsp;<span class="num" id="3848901">0xf7</span><span class="op" id="3848905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848908">0x6d</span><span class="op" id="3848912">,</span>&nbsp;<span class="num" id="3848914">0x31</span><span class="op" id="3848918">,</span>&nbsp;<span class="num" id="3848920">0x38</span><span class="op" id="3848924">,</span>&nbsp;<span class="num" id="3848926">0xfb</span><span class="op" id="3848930">,</span>&nbsp;<span class="num" id="3848932">0xdb</span><span class="op" id="3848936">,</span>&nbsp;<span class="num" id="3848938">0xfe</span><span class="op" id="3848942">,</span>&nbsp;<span class="num" id="3848944">0xdb</span><span class="op" id="3848948">,</span>&nbsp;<span class="num" id="3848950">0x37</span><span class="op" id="3848954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3848957">0x02</span><span class="op" id="3848961">,</span>&nbsp;<span class="num" id="3848963">0x76</span><span class="op" id="3848967">,</span>&nbsp;<span class="num" id="3848969">0xa1</span><span class="op" id="3848973">,</span>&nbsp;<span class="num" id="3848975">0x18</span><span class="op" id="3848979">,</span>&nbsp;<span class="num" id="3848981">0x97</span><span class="op" id="3848985">,</span>&nbsp;<span class="num" id="3848987">0xa6</span><span class="op" id="3848991">,</span>&nbsp;<span class="num" id="3848993">0xcc</span><span class="op" id="3848997">,</span>&nbsp;<span class="num" id="3848999">0xde</span><span class="op" id="3849003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849006">0x20</span><span class="op" id="3849010">,</span>&nbsp;<span class="num" id="3849012">0x09</span><span class="op" id="3849016">,</span>&nbsp;<span class="num" id="3849018">0x49</span><span class="op" id="3849022">,</span>&nbsp;<span class="num" id="3849024">0x36</span><span class="op" id="3849028">,</span>&nbsp;<span class="num" id="3849030">0x24</span><span class="op" id="3849034">,</span>&nbsp;<span class="num" id="3849036">0x69</span><span class="op" id="3849040">,</span>&nbsp;<span class="num" id="3849042">0x42</span><span class="op" id="3849046">,</span>&nbsp;<span class="num" id="3849048">0xf6</span><span class="op" id="3849052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849055">0xe4</span><span class="op" id="3849059">,</span>&nbsp;<span class="num" id="3849061">0x37</span><span class="op" id="3849065">,</span>&nbsp;<span class="num" id="3849067">0x62</span><span class="op" id="3849071">,</span>&nbsp;<span class="num" id="3849073">0xf1</span><span class="op" id="3849077">,</span>&nbsp;<span class="num" id="3849079">0x59</span><span class="op" id="3849083">,</span>&nbsp;<span class="num" id="3849085">0x6d</span><span class="op" id="3849089">,</span>&nbsp;<span class="num" id="3849091">0xa9</span><span class="op" id="3849095">,</span>&nbsp;<span class="num" id="3849097">0x3c</span><span class="op" id="3849101">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849104">0xed</span><span class="op" id="3849108">,</span>&nbsp;<span class="num" id="3849110">0x34</span><span class="op" id="3849114">,</span>&nbsp;<span class="num" id="3849116">0x9c</span><span class="op" id="3849120">,</span>&nbsp;<span class="num" id="3849122">0xa3</span><span class="op" id="3849126">,</span>&nbsp;<span class="num" id="3849128">0x8e</span><span class="op" id="3849132">,</span>&nbsp;<span class="num" id="3849134">0xdb</span><span class="op" id="3849138">,</span>&nbsp;<span class="num" id="3849140">0xdc</span><span class="op" id="3849144">,</span>&nbsp;<span class="num" id="3849146">0x3a</span><span class="op" id="3849150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849153">0xd7</span><span class="op" id="3849157">,</span>&nbsp;<span class="num" id="3849159">0xf7</span><span class="op" id="3849163">,</span>&nbsp;<span class="num" id="3849165">0x0a</span><span class="op" id="3849169">,</span>&nbsp;<span class="num" id="3849171">0x6f</span><span class="op" id="3849175">,</span>&nbsp;<span class="num" id="3849177">0xef</span><span class="op" id="3849181">,</span>&nbsp;<span class="num" id="3849183">0x2e</span><span class="op" id="3849187">,</span>&nbsp;<span class="num" id="3849189">0xd8</span><span class="op" id="3849193">,</span>&nbsp;<span class="num" id="3849195">0xd5</span><span class="op" id="3849199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849202">0x93</span><span class="op" id="3849206">,</span>&nbsp;<span class="num" id="3849208">0x5a</span><span class="op" id="3849212">,</span>&nbsp;<span class="num" id="3849214">0x7a</span><span class="op" id="3849218">,</span>&nbsp;<span class="num" id="3849220">0xed</span><span class="op" id="3849224">,</span>&nbsp;<span class="num" id="3849226">0x08</span><span class="op" id="3849230">,</span>&nbsp;<span class="num" id="3849232">0x49</span><span class="op" id="3849236">,</span>&nbsp;<span class="num" id="3849238">0x68</span><span class="op" id="3849242">,</span>&nbsp;<span class="num" id="3849244">0xe2</span><span class="op" id="3849248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849251">0x41</span><span class="op" id="3849255">,</span>&nbsp;<span class="num" id="3849257">0xe3</span><span class="op" id="3849261">,</span>&nbsp;<span class="num" id="3849263">0x5a</span><span class="op" id="3849267">,</span>&nbsp;<span class="num" id="3849269">0x90</span><span class="op" id="3849273">,</span>&nbsp;<span class="num" id="3849275">0xc1</span><span class="op" id="3849279">,</span>&nbsp;<span class="num" id="3849281">0x86</span><span class="op" id="3849285">,</span>&nbsp;<span class="num" id="3849287">0x55</span><span class="op" id="3849291">,</span>&nbsp;<span class="num" id="3849293">0xfc</span><span class="op" id="3849297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849300">0x51</span><span class="op" id="3849304">,</span>&nbsp;<span class="num" id="3849306">0x43</span><span class="op" id="3849310">,</span>&nbsp;<span class="num" id="3849312">0x9d</span><span class="op" id="3849316">,</span>&nbsp;<span class="num" id="3849318">0xe0</span><span class="op" id="3849322">,</span>&nbsp;<span class="num" id="3849324">0xb2</span><span class="op" id="3849328">,</span>&nbsp;<span class="num" id="3849330">0xc4</span><span class="op" id="3849334">,</span>&nbsp;<span class="num" id="3849336">0x67</span><span class="op" id="3849340">,</span>&nbsp;<span class="num" id="3849342">0xb4</span><span class="op" id="3849346">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849349">0xcb</span><span class="op" id="3849353">,</span>&nbsp;<span class="num" id="3849355">0x32</span><span class="op" id="3849359">,</span>&nbsp;<span class="num" id="3849361">0x31</span><span class="op" id="3849365">,</span>&nbsp;<span class="num" id="3849367">0x25</span><span class="op" id="3849371">,</span>&nbsp;<span class="num" id="3849373">0xf0</span><span class="op" id="3849377">,</span>&nbsp;<span class="num" id="3849379">0x54</span><span class="op" id="3849383">,</span>&nbsp;<span class="num" id="3849385">0x9f</span><span class="op" id="3849389">,</span>&nbsp;<span class="num" id="3849391">0x4b</span><span class="op" id="3849395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849398">0xd1</span><span class="op" id="3849402">,</span>&nbsp;<span class="num" id="3849404">0x6f</span><span class="op" id="3849408">,</span>&nbsp;<span class="num" id="3849410">0xdb</span><span class="op" id="3849414">,</span>&nbsp;<span class="num" id="3849416">0xd4</span><span class="op" id="3849420">,</span>&nbsp;<span class="num" id="3849422">0xdd</span><span class="op" id="3849426">,</span>&nbsp;<span class="num" id="3849428">0xfc</span><span class="op" id="3849432">,</span>&nbsp;<span class="num" id="3849434">0xaf</span><span class="op" id="3849438">,</span>&nbsp;<span class="num" id="3849440">0x5e</span><span class="op" id="3849444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849447">0x6c</span><span class="op" id="3849451">,</span>&nbsp;<span class="num" id="3849453">0x78</span><span class="op" id="3849457">,</span>&nbsp;<span class="num" id="3849459">0x90</span><span class="op" id="3849463">,</span>&nbsp;<span class="num" id="3849465">0x95</span><span class="op" id="3849469">,</span>&nbsp;<span class="num" id="3849471">0xde</span><span class="op" id="3849475">,</span>&nbsp;<span class="num" id="3849477">0xca</span><span class="op" id="3849481">,</span>&nbsp;<span class="num" id="3849483">0x3a</span><span class="op" id="3849487">,</span>&nbsp;<span class="num" id="3849489">0x48</span><span class="op" id="3849493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849496">0xb9</span><span class="op" id="3849500">,</span>&nbsp;<span class="num" id="3849502">0x79</span><span class="op" id="3849506">,</span>&nbsp;<span class="num" id="3849508">0x3c</span><span class="op" id="3849512">,</span>&nbsp;<span class="num" id="3849514">0x9b</span><span class="op" id="3849518">,</span>&nbsp;<span class="num" id="3849520">0x19</span><span class="op" id="3849524">,</span>&nbsp;<span class="num" id="3849526">0xd6</span><span class="op" id="3849530">,</span>&nbsp;<span class="num" id="3849532">0x75</span><span class="op" id="3849536">,</span>&nbsp;<span class="num" id="3849538">0x05</span><span class="op" id="3849542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849545">0xa0</span><span class="op" id="3849549">,</span>&nbsp;<span class="num" id="3849551">0xf9</span><span class="op" id="3849555">,</span>&nbsp;<span class="num" id="3849557">0x88</span><span class="op" id="3849561">,</span>&nbsp;<span class="num" id="3849563">0xd7</span><span class="op" id="3849567">,</span>&nbsp;<span class="num" id="3849569">0xc1</span><span class="op" id="3849573">,</span>&nbsp;<span class="num" id="3849575">0xe8</span><span class="op" id="3849579">,</span>&nbsp;<span class="num" id="3849581">0xa5</span><span class="op" id="3849585">,</span>&nbsp;<span class="num" id="3849587">0x09</span><span class="op" id="3849591">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849594">0xe4</span><span class="op" id="3849598">,</span>&nbsp;<span class="num" id="3849600">0x1a</span><span class="op" id="3849604">,</span>&nbsp;<span class="num" id="3849606">0x15</span><span class="op" id="3849610">,</span>&nbsp;<span class="num" id="3849612">0xdc</span><span class="op" id="3849616">,</span>&nbsp;<span class="num" id="3849618">0x87</span><span class="op" id="3849622">,</span>&nbsp;<span class="num" id="3849624">0x23</span><span class="op" id="3849628">,</span>&nbsp;<span class="num" id="3849630">0xaa</span><span class="op" id="3849634">,</span>&nbsp;<span class="num" id="3849636">0xb2</span><span class="op" id="3849640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849643">0x75</span><span class="op" id="3849647">,</span>&nbsp;<span class="num" id="3849649">0x8c</span><span class="op" id="3849653">,</span>&nbsp;<span class="num" id="3849655">0x63</span><span class="op" id="3849659">,</span>&nbsp;<span class="num" id="3849661">0x25</span><span class="op" id="3849665">,</span>&nbsp;<span class="num" id="3849667">0x87</span><span class="op" id="3849671">,</span>&nbsp;<span class="num" id="3849673">0xd8</span><span class="op" id="3849677">,</span>&nbsp;<span class="num" id="3849679">0xf8</span><span class="op" id="3849683">,</span>&nbsp;<span class="num" id="3849685">0x3d</span><span class="op" id="3849689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849692">0xa6</span><span class="op" id="3849696">,</span>&nbsp;<span class="num" id="3849698">0xc2</span><span class="op" id="3849702">,</span>&nbsp;<span class="num" id="3849704">0xcc</span><span class="op" id="3849708">,</span>&nbsp;<span class="num" id="3849710">0x66</span><span class="op" id="3849714">,</span>&nbsp;<span class="num" id="3849716">0xff</span><span class="op" id="3849720">,</span>&nbsp;<span class="num" id="3849722">0xa5</span><span class="op" id="3849726">,</span>&nbsp;<span class="num" id="3849728">0x66</span><span class="op" id="3849732">,</span>&nbsp;<span class="num" id="3849734">0x68</span><span class="op" id="3849738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3849741">0x55</span><span class="op" id="3849745">,</span>&nbsp;<span class="num" id="3849747">0x02</span><span class="op" id="3849751">,</span>&nbsp;<span class="num" id="3849753">0x03</span><span class="op" id="3849757">,</span>&nbsp;<span class="num" id="3849759">0x01</span><span class="op" id="3849763">,</span>&nbsp;<span class="num" id="3849765">0x00</span><span class="op" id="3849769">,</span>&nbsp;<span class="num" id="3849771">0x01</span><span class="op" id="3849775">,</span><br>
<span class="lineno"></span><span class="op" id="3849777">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="3849780">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="3849856">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="3849872">func</span>&nbsp;<span class="op" id="3849877">(</span><span class="ident" id="3849878">c</span>&nbsp;<span class="op" id="3849880">*</span><span class="ident" id="3849881">Certificate</span><span class="op" id="3849892">)</span>&nbsp;<span class="ident" id="3849894">CheckSignatureFrom</span><span class="op" id="3849912">(</span><span class="ident" id="3849913">parent</span>&nbsp;<span class="op" id="3849920">*</span><span class="ident" id="3849921">Certificate</span><span class="op" id="3849932">)</span>&nbsp;<span class="op" id="3849934">(</span><span class="ident" id="3849935">err</span>&nbsp;<span class="builtintype" id="3849939">error</span><span class="op" id="3849944">)</span>&nbsp;<span class="op" id="3849946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3849949">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3849972">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3850042">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3850113">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3850184">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3850213">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850275">if</span>&nbsp;<span class="op" id="3850278">(</span><span class="ident" id="3850279">parent</span><span class="op" id="3850285">.</span><span class="ident" id="3850286">Version</span>&nbsp;<span class="op" id="3850294">==</span>&nbsp;<span class="num" id="3850297">3</span>&nbsp;<span class="op" id="3850299">&amp;&amp;</span>&nbsp;<span class="op" id="3850302">!</span><span class="ident" id="3850303">parent</span><span class="op" id="3850309">.</span><span class="ident" id="3850310">BasicConstraintsValid</span>&nbsp;<span class="op" id="3850332">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850337">parent</span><span class="op" id="3850343">.</span><span class="ident" id="3850344">BasicConstraintsValid</span>&nbsp;<span class="op" id="3850366">&amp;&amp;</span>&nbsp;<span class="op" id="3850369">!</span><span class="ident" id="3850370">parent</span><span class="op" id="3850376">.</span><span class="ident" id="3850377">IsCA</span><span class="op" id="3850381">)</span>&nbsp;<span class="op" id="3850383">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850388">!</span><span class="ident" id="3850389">bytes</span><span class="op" id="3850394">.</span><span class="ident" id="3850395">Equal</span><span class="op" id="3850400">(</span><span class="ident" id="3850401">c</span><span class="op" id="3850402">.</span><span class="ident" id="3850403">RawSubjectPublicKeyInfo</span><span class="op" id="3850426">,</span>&nbsp;<span class="ident" id="3850428">entrustBrokenSPKI</span><span class="op" id="3850445">)</span>&nbsp;<span class="op" id="3850447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850451">return</span>&nbsp;<span class="ident" id="3850458">ConstraintViolationError</span><span class="op" id="3850482">{</span><span class="op" id="3850483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850486">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850490">if</span>&nbsp;<span class="ident" id="3850493">parent</span><span class="op" id="3850499">.</span><span class="ident" id="3850500">KeyUsage</span>&nbsp;<span class="op" id="3850509">!=</span>&nbsp;<span class="num" id="3850512">0</span>&nbsp;<span class="op" id="3850514">&amp;&amp;</span>&nbsp;<span class="ident" id="3850517">parent</span><span class="op" id="3850523">.</span><span class="ident" id="3850524">KeyUsage</span><span class="op" id="3850532">&amp;</span><span class="ident" id="3850533">KeyUsageCertSign</span>&nbsp;<span class="op" id="3850550">==</span>&nbsp;<span class="num" id="3850553">0</span>&nbsp;<span class="op" id="3850555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850559">return</span>&nbsp;<span class="ident" id="3850566">ConstraintViolationError</span><span class="op" id="3850590">{</span><span class="op" id="3850591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850598">if</span>&nbsp;<span class="ident" id="3850601">parent</span><span class="op" id="3850607">.</span><span class="ident" id="3850608">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3850627">==</span>&nbsp;<span class="ident" id="3850630">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3850656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850660">return</span>&nbsp;<span class="ident" id="3850667">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3850696">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850753">return</span>&nbsp;<span class="ident" id="3850760">parent</span><span class="op" id="3850766">.</span><span class="ident" id="3850767">CheckSignature</span><span class="op" id="3850781">(</span><span class="ident" id="3850782">c</span><span class="op" id="3850783">.</span><span class="ident" id="3850784">SignatureAlgorithm</span><span class="op" id="3850802">,</span>&nbsp;<span class="ident" id="3850804">c</span><span class="op" id="3850805">.</span><span class="ident" id="3850806">RawTBSCertificate</span><span class="op" id="3850823">,</span>&nbsp;<span class="ident" id="3850825">c</span><span class="op" id="3850826">.</span><span class="ident" id="3850827">Signature</span><span class="op" id="3850836">)</span><br>
<span class="lineno"></span><span class="op" id="3850838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3850841">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="3850921">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3850940">func</span>&nbsp;<span class="op" id="3850945">(</span><span class="ident" id="3850946">c</span>&nbsp;<span class="op" id="3850948">*</span><span class="ident" id="3850949">Certificate</span><span class="op" id="3850960">)</span>&nbsp;<span class="ident" id="3850962">CheckSignature</span><span class="op" id="3850976">(</span><span class="ident" id="3850977">algo</span>&nbsp;<span class="ident" id="3850982">SignatureAlgorithm</span><span class="op" id="3851000">,</span>&nbsp;<span class="ident" id="3851002">signed</span><span class="op" id="3851008">,</span>&nbsp;<span class="ident" id="3851010">signature</span>&nbsp;<span class="op" id="3851020">[</span><span class="op" id="3851021">]</span><span class="builtintype" id="3851022">byte</span><span class="op" id="3851026">)</span>&nbsp;<span class="op" id="3851028">(</span><span class="ident" id="3851029">err</span>&nbsp;<span class="builtintype" id="3851033">error</span><span class="op" id="3851038">)</span>&nbsp;<span class="op" id="3851040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851043">var</span>&nbsp;<span class="ident" id="3851047">hashType</span>&nbsp;<span class="ident" id="3851056">crypto</span><span class="op" id="3851062">.</span><span class="ident" id="3851063">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851070">switch</span>&nbsp;<span class="ident" id="3851077">algo</span>&nbsp;<span class="op" id="3851082">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851085">case</span>&nbsp;<span class="ident" id="3851090">SHA1WithRSA</span><span class="op" id="3851101">,</span>&nbsp;<span class="ident" id="3851103">DSAWithSHA1</span><span class="op" id="3851114">,</span>&nbsp;<span class="ident" id="3851116">ECDSAWithSHA1</span><span class="op" id="3851129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851133">hashType</span>&nbsp;<span class="op" id="3851142">=</span>&nbsp;<span class="ident" id="3851144">crypto</span><span class="op" id="3851150">.</span><span class="ident" id="3851151">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851157">case</span>&nbsp;<span class="ident" id="3851162">SHA256WithRSA</span><span class="op" id="3851175">,</span>&nbsp;<span class="ident" id="3851177">DSAWithSHA256</span><span class="op" id="3851190">,</span>&nbsp;<span class="ident" id="3851192">ECDSAWithSHA256</span><span class="op" id="3851207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851211">hashType</span>&nbsp;<span class="op" id="3851220">=</span>&nbsp;<span class="ident" id="3851222">crypto</span><span class="op" id="3851228">.</span><span class="ident" id="3851229">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851237">case</span>&nbsp;<span class="ident" id="3851242">SHA384WithRSA</span><span class="op" id="3851255">,</span>&nbsp;<span class="ident" id="3851257">ECDSAWithSHA384</span><span class="op" id="3851272">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851276">hashType</span>&nbsp;<span class="op" id="3851285">=</span>&nbsp;<span class="ident" id="3851287">crypto</span><span class="op" id="3851293">.</span><span class="ident" id="3851294">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851302">case</span>&nbsp;<span class="ident" id="3851307">SHA512WithRSA</span><span class="op" id="3851320">,</span>&nbsp;<span class="ident" id="3851322">ECDSAWithSHA512</span><span class="op" id="3851337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851341">hashType</span>&nbsp;<span class="op" id="3851350">=</span>&nbsp;<span class="ident" id="3851352">crypto</span><span class="op" id="3851358">.</span><span class="ident" id="3851359">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851367">default</span><span class="op" id="3851374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851378">return</span>&nbsp;<span class="ident" id="3851385">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851414">if</span>&nbsp;<span class="op" id="3851417">!</span><span class="ident" id="3851418">hashType</span><span class="op" id="3851426">.</span><span class="ident" id="3851427">Available</span><span class="op" id="3851436">(</span><span class="op" id="3851437">)</span>&nbsp;<span class="op" id="3851439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851443">return</span>&nbsp;<span class="ident" id="3851450">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851475">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851478">h</span>&nbsp;<span class="op" id="3851480">:=</span>&nbsp;<span class="ident" id="3851483">hashType</span><span class="op" id="3851491">.</span><span class="ident" id="3851492">New</span><span class="op" id="3851495">(</span><span class="op" id="3851496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851500">h</span><span class="op" id="3851501">.</span><span class="ident" id="3851502">Write</span><span class="op" id="3851507">(</span><span class="ident" id="3851508">signed</span><span class="op" id="3851514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851517">digest</span>&nbsp;<span class="op" id="3851524">:=</span>&nbsp;<span class="ident" id="3851527">h</span><span class="op" id="3851528">.</span><span class="ident" id="3851529">Sum</span><span class="op" id="3851532">(</span><span class="ident" id="3851533">nil</span><span class="op" id="3851536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851540">switch</span>&nbsp;<span class="ident" id="3851547">pub</span>&nbsp;<span class="op" id="3851551">:=</span>&nbsp;<span class="ident" id="3851554">c</span><span class="op" id="3851555">.</span><span class="ident" id="3851556">PublicKey</span><span class="op" id="3851565">.</span><span class="op" id="3851566">(</span><span class="keyword" id="3851567">type</span><span class="op" id="3851571">)</span>&nbsp;<span class="op" id="3851573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851576">case</span>&nbsp;<span class="op" id="3851581">*</span><span class="ident" id="3851582">rsa</span><span class="op" id="3851585">.</span><span class="ident" id="3851586">PublicKey</span><span class="op" id="3851595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851599">return</span>&nbsp;<span class="ident" id="3851606">rsa</span><span class="op" id="3851609">.</span><span class="ident" id="3851610">VerifyPKCS1v15</span><span class="op" id="3851624">(</span><span class="ident" id="3851625">pub</span><span class="op" id="3851628">,</span>&nbsp;<span class="ident" id="3851630">hashType</span><span class="op" id="3851638">,</span>&nbsp;<span class="ident" id="3851640">digest</span><span class="op" id="3851646">,</span>&nbsp;<span class="ident" id="3851648">signature</span><span class="op" id="3851657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851660">case</span>&nbsp;<span class="op" id="3851665">*</span><span class="ident" id="3851666">dsa</span><span class="op" id="3851669">.</span><span class="ident" id="3851670">PublicKey</span><span class="op" id="3851679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851683">dsaSig</span>&nbsp;<span class="op" id="3851690">:=</span>&nbsp;<span class="builtinfunc" id="3851693">new</span><span class="op" id="3851696">(</span><span class="ident" id="3851697">dsaSignature</span><span class="op" id="3851709">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851713">if</span>&nbsp;<span class="ident" id="3851716">_</span><span class="op" id="3851717">,</span>&nbsp;<span class="ident" id="3851719">err</span>&nbsp;<span class="op" id="3851723">:=</span>&nbsp;<span class="ident" id="3851726">asn1</span><span class="op" id="3851730">.</span><span class="ident" id="3851731">Unmarshal</span><span class="op" id="3851740">(</span><span class="ident" id="3851741">signature</span><span class="op" id="3851750">,</span>&nbsp;<span class="ident" id="3851752">dsaSig</span><span class="op" id="3851758">)</span><span class="op" id="3851759">;</span>&nbsp;<span class="ident" id="3851761">err</span>&nbsp;<span class="op" id="3851765">!=</span>&nbsp;<span class="ident" id="3851768">nil</span>&nbsp;<span class="op" id="3851772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851777">return</span>&nbsp;<span class="ident" id="3851784">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851794">if</span>&nbsp;<span class="ident" id="3851797">dsaSig</span><span class="op" id="3851803">.</span><span class="ident" id="3851804">R</span><span class="op" id="3851805">.</span><span class="ident" id="3851806">Sign</span><span class="op" id="3851810">(</span><span class="op" id="3851811">)</span>&nbsp;<span class="op" id="3851813">&lt;=</span>&nbsp;<span class="num" id="3851816">0</span>&nbsp;<span class="op" id="3851818">||</span>&nbsp;<span class="ident" id="3851821">dsaSig</span><span class="op" id="3851827">.</span><span class="ident" id="3851828">S</span><span class="op" id="3851829">.</span><span class="ident" id="3851830">Sign</span><span class="op" id="3851834">(</span><span class="op" id="3851835">)</span>&nbsp;<span class="op" id="3851837">&lt;=</span>&nbsp;<span class="num" id="3851840">0</span>&nbsp;<span class="op" id="3851842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851847">return</span>&nbsp;<span class="ident" id="3851854">errors</span><span class="op" id="3851860">.</span><span class="ident" id="3851861">New</span><span class="op" id="3851864">(</span><span class="string" id="3851865">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3851920">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851928">if</span>&nbsp;<span class="op" id="3851931">!</span><span class="ident" id="3851932">dsa</span><span class="op" id="3851935">.</span><span class="ident" id="3851936">Verify</span><span class="op" id="3851942">(</span><span class="ident" id="3851943">pub</span><span class="op" id="3851946">,</span>&nbsp;<span class="ident" id="3851948">digest</span><span class="op" id="3851954">,</span>&nbsp;<span class="ident" id="3851956">dsaSig</span><span class="op" id="3851962">.</span><span class="ident" id="3851963">R</span><span class="op" id="3851964">,</span>&nbsp;<span class="ident" id="3851966">dsaSig</span><span class="op" id="3851972">.</span><span class="ident" id="3851973">S</span><span class="op" id="3851974">)</span>&nbsp;<span class="op" id="3851976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851981">return</span>&nbsp;<span class="ident" id="3851988">errors</span><span class="op" id="3851994">.</span><span class="ident" id="3851995">New</span><span class="op" id="3851998">(</span><span class="string" id="3851999">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3852031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852039">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852047">case</span>&nbsp;<span class="op" id="3852052">*</span><span class="ident" id="3852053">ecdsa</span><span class="op" id="3852058">.</span><span class="ident" id="3852059">PublicKey</span><span class="op" id="3852068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852072">ecdsaSig</span>&nbsp;<span class="op" id="3852081">:=</span>&nbsp;<span class="builtinfunc" id="3852084">new</span><span class="op" id="3852087">(</span><span class="ident" id="3852088">ecdsaSignature</span><span class="op" id="3852102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852106">if</span>&nbsp;<span class="ident" id="3852109">_</span><span class="op" id="3852110">,</span>&nbsp;<span class="ident" id="3852112">err</span>&nbsp;<span class="op" id="3852116">:=</span>&nbsp;<span class="ident" id="3852119">asn1</span><span class="op" id="3852123">.</span><span class="ident" id="3852124">Unmarshal</span><span class="op" id="3852133">(</span><span class="ident" id="3852134">signature</span><span class="op" id="3852143">,</span>&nbsp;<span class="ident" id="3852145">ecdsaSig</span><span class="op" id="3852153">)</span><span class="op" id="3852154">;</span>&nbsp;<span class="ident" id="3852156">err</span>&nbsp;<span class="op" id="3852160">!=</span>&nbsp;<span class="ident" id="3852163">nil</span>&nbsp;<span class="op" id="3852167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852172">return</span>&nbsp;<span class="ident" id="3852179">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852185">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852189">if</span>&nbsp;<span class="ident" id="3852192">ecdsaSig</span><span class="op" id="3852200">.</span><span class="ident" id="3852201">R</span><span class="op" id="3852202">.</span><span class="ident" id="3852203">Sign</span><span class="op" id="3852207">(</span><span class="op" id="3852208">)</span>&nbsp;<span class="op" id="3852210">&lt;=</span>&nbsp;<span class="num" id="3852213">0</span>&nbsp;<span class="op" id="3852215">||</span>&nbsp;<span class="ident" id="3852218">ecdsaSig</span><span class="op" id="3852226">.</span><span class="ident" id="3852227">S</span><span class="op" id="3852228">.</span><span class="ident" id="3852229">Sign</span><span class="op" id="3852233">(</span><span class="op" id="3852234">)</span>&nbsp;<span class="op" id="3852236">&lt;=</span>&nbsp;<span class="num" id="3852239">0</span>&nbsp;<span class="op" id="3852241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852246">return</span>&nbsp;<span class="ident" id="3852253">errors</span><span class="op" id="3852259">.</span><span class="ident" id="3852260">New</span><span class="op" id="3852263">(</span><span class="string" id="3852264">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3852321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852329">if</span>&nbsp;<span class="op" id="3852332">!</span><span class="ident" id="3852333">ecdsa</span><span class="op" id="3852338">.</span><span class="ident" id="3852339">Verify</span><span class="op" id="3852345">(</span><span class="ident" id="3852346">pub</span><span class="op" id="3852349">,</span>&nbsp;<span class="ident" id="3852351">digest</span><span class="op" id="3852357">,</span>&nbsp;<span class="ident" id="3852359">ecdsaSig</span><span class="op" id="3852367">.</span><span class="ident" id="3852368">R</span><span class="op" id="3852369">,</span>&nbsp;<span class="ident" id="3852371">ecdsaSig</span><span class="op" id="3852379">.</span><span class="ident" id="3852380">S</span><span class="op" id="3852381">)</span>&nbsp;<span class="op" id="3852383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852388">return</span>&nbsp;<span class="ident" id="3852395">errors</span><span class="op" id="3852401">.</span><span class="ident" id="3852402">New</span><span class="op" id="3852405">(</span><span class="string" id="3852406">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3852440">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852448">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852459">return</span>&nbsp;<span class="ident" id="3852466">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3852490">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="3852493">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3852558">func</span>&nbsp;<span class="op" id="3852563">(</span><span class="ident" id="3852564">c</span>&nbsp;<span class="op" id="3852566">*</span><span class="ident" id="3852567">Certificate</span><span class="op" id="3852578">)</span>&nbsp;<span class="ident" id="3852580">CheckCRLSignature</span><span class="op" id="3852597">(</span><span class="ident" id="3852598">crl</span>&nbsp;<span class="op" id="3852602">*</span><span class="ident" id="3852603">pkix</span><span class="op" id="3852607">.</span><span class="ident" id="3852608">CertificateList</span><span class="op" id="3852623">)</span>&nbsp;<span class="op" id="3852625">(</span><span class="ident" id="3852626">err</span>&nbsp;<span class="builtintype" id="3852630">error</span><span class="op" id="3852635">)</span>&nbsp;<span class="op" id="3852637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852640">algo</span>&nbsp;<span class="op" id="3852645">:=</span>&nbsp;<span class="ident" id="3852648">getSignatureAlgorithmFromOID</span><span class="op" id="3852676">(</span><span class="ident" id="3852677">crl</span><span class="op" id="3852680">.</span><span class="ident" id="3852681">SignatureAlgorithm</span><span class="op" id="3852699">.</span><span class="ident" id="3852700">Algorithm</span><span class="op" id="3852709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852712">return</span>&nbsp;<span class="ident" id="3852719">c</span><span class="op" id="3852720">.</span><span class="ident" id="3852721">CheckSignature</span><span class="op" id="3852735">(</span><span class="ident" id="3852736">algo</span><span class="op" id="3852740">,</span>&nbsp;<span class="ident" id="3852742">crl</span><span class="op" id="3852745">.</span><span class="ident" id="3852746">TBSCertList</span><span class="op" id="3852757">.</span><span class="ident" id="3852758">Raw</span><span class="op" id="3852761">,</span>&nbsp;<span class="ident" id="3852763">crl</span><span class="op" id="3852766">.</span><span class="ident" id="3852767">SignatureValue</span><span class="op" id="3852781">.</span><span class="ident" id="3852782">RightAlign</span><span class="op" id="3852792">(</span><span class="op" id="3852793">)</span><span class="op" id="3852794">)</span><br>
<span class="lineno">680</span><span class="op" id="3852796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3852799">type</span>&nbsp;<span class="ident" id="3852804">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="3852831">struct</span><span class="op" id="3852837">{</span><span class="op" id="3852838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3852841">func</span>&nbsp;<span class="op" id="3852846">(</span><span class="ident" id="3852847">h</span>&nbsp;<span class="ident" id="3852849">UnhandledCriticalExtension</span><span class="op" id="3852875">)</span>&nbsp;<span class="ident" id="3852877">Error</span><span class="op" id="3852882">(</span><span class="op" id="3852883">)</span>&nbsp;<span class="builtintype" id="3852885">string</span>&nbsp;<span class="op" id="3852892">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852895">return</span>&nbsp;<span class="string" id="3852902">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="3852939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3852942">type</span>&nbsp;<span class="ident" id="3852947">basicConstraints</span>&nbsp;<span class="keyword" id="3852964">struct</span>&nbsp;<span class="op" id="3852971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852974">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3852985">bool</span>&nbsp;<span class="string" id="3852990">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853009">MaxPathLen</span>&nbsp;<span class="builtintype" id="3853020">int</span>&nbsp;&nbsp;<span class="string" id="3853025">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3853054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3853057">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="3853077">type</span>&nbsp;<span class="ident" id="3853082">policyInformation</span>&nbsp;<span class="keyword" id="3853100">struct</span>&nbsp;<span class="op" id="3853107">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853110">Policy</span>&nbsp;<span class="ident" id="3853117">asn1</span><span class="op" id="3853121">.</span><span class="ident" id="3853122">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3853140">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="3853168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3853171">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="3853193">type</span>&nbsp;<span class="ident" id="3853198">nameConstraints</span>&nbsp;<span class="keyword" id="3853214">struct</span>&nbsp;<span class="op" id="3853221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853224">Permitted</span>&nbsp;<span class="op" id="3853234">[</span><span class="op" id="3853235">]</span><span class="ident" id="3853236">generalSubtree</span>&nbsp;<span class="string" id="3853251">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853276">Excluded</span>&nbsp;&nbsp;<span class="op" id="3853286">[</span><span class="op" id="3853287">]</span><span class="ident" id="3853288">generalSubtree</span>&nbsp;<span class="string" id="3853303">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3853327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="3853330">type</span>&nbsp;<span class="ident" id="3853335">generalSubtree</span>&nbsp;<span class="keyword" id="3853350">struct</span>&nbsp;<span class="op" id="3853357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853360">Name</span>&nbsp;<span class="builtintype" id="3853365">string</span>&nbsp;<span class="string" id="3853372">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3853400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3853403">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="3853424">type</span>&nbsp;<span class="ident" id="3853429">authorityInfoAccess</span>&nbsp;<span class="keyword" id="3853449">struct</span>&nbsp;<span class="op" id="3853456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853459">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3853468">asn1</span><span class="op" id="3853472">.</span><span class="ident" id="3853473">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853491">Location</span>&nbsp;<span class="ident" id="3853500">asn1</span><span class="op" id="3853504">.</span><span class="ident" id="3853505">RawValue</span><br>
<span class="lineno"></span><span class="op" id="3853514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="3853517">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="3853539">type</span>&nbsp;<span class="ident" id="3853544">distributionPoint</span>&nbsp;<span class="keyword" id="3853562">struct</span>&nbsp;<span class="op" id="3853569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853572">DistributionPoint</span>&nbsp;<span class="ident" id="3853590">distributionPointName</span>&nbsp;<span class="string" id="3853612">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853637">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3853655">asn1</span><span class="op" id="3853659">.</span><span class="ident" id="3853660">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3853677">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853702">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3853720">asn1</span><span class="op" id="3853724">.</span><span class="ident" id="3853725">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3853742">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="3853766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3853769">type</span>&nbsp;<span class="ident" id="3853774">distributionPointName</span>&nbsp;<span class="keyword" id="3853796">struct</span>&nbsp;<span class="op" id="3853803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853806">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3853819">asn1</span><span class="op" id="3853823">.</span><span class="ident" id="3853824">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3853836">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853861">RelativeName</span>&nbsp;<span class="ident" id="3853874">pkix</span><span class="op" id="3853878">.</span><span class="ident" id="3853879">RDNSequence</span>&nbsp;<span class="string" id="3853891">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="3853915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3853918">func</span>&nbsp;<span class="ident" id="3853923">parsePublicKey</span><span class="op" id="3853937">(</span><span class="ident" id="3853938">algo</span>&nbsp;<span class="ident" id="3853943">PublicKeyAlgorithm</span><span class="op" id="3853961">,</span>&nbsp;<span class="ident" id="3853963">keyData</span>&nbsp;<span class="op" id="3853971">*</span><span class="ident" id="3853972">publicKeyInfo</span><span class="op" id="3853985">)</span>&nbsp;<span class="op" id="3853987">(</span><span class="keyword" id="3853988">interface</span><span class="op" id="3853997">{</span><span class="op" id="3853998">}</span><span class="op" id="3853999">,</span>&nbsp;<span class="builtintype" id="3854001">error</span><span class="op" id="3854006">)</span>&nbsp;<span class="op" id="3854008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854011">asn1Data</span>&nbsp;<span class="op" id="3854020">:=</span>&nbsp;<span class="ident" id="3854023">keyData</span><span class="op" id="3854030">.</span><span class="ident" id="3854031">PublicKey</span><span class="op" id="3854040">.</span><span class="ident" id="3854041">RightAlign</span><span class="op" id="3854051">(</span><span class="op" id="3854052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854055">switch</span>&nbsp;<span class="ident" id="3854062">algo</span>&nbsp;<span class="op" id="3854067">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854070">case</span>&nbsp;<span class="ident" id="3854075">RSA</span><span class="op" id="3854078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854082">p</span>&nbsp;<span class="op" id="3854084">:=</span>&nbsp;<span class="builtinfunc" id="3854087">new</span><span class="op" id="3854090">(</span><span class="ident" id="3854091">rsaPublicKey</span><span class="op" id="3854103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854107">_</span><span class="op" id="3854108">,</span>&nbsp;<span class="ident" id="3854110">err</span>&nbsp;<span class="op" id="3854114">:=</span>&nbsp;<span class="ident" id="3854117">asn1</span><span class="op" id="3854121">.</span><span class="ident" id="3854122">Unmarshal</span><span class="op" id="3854131">(</span><span class="ident" id="3854132">asn1Data</span><span class="op" id="3854140">,</span>&nbsp;<span class="ident" id="3854142">p</span><span class="op" id="3854143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854147">if</span>&nbsp;<span class="ident" id="3854150">err</span>&nbsp;<span class="op" id="3854154">!=</span>&nbsp;<span class="ident" id="3854157">nil</span>&nbsp;<span class="op" id="3854161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854166">return</span>&nbsp;<span class="ident" id="3854173">nil</span><span class="op" id="3854176">,</span>&nbsp;<span class="ident" id="3854178">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854189">if</span>&nbsp;<span class="ident" id="3854192">p</span><span class="op" id="3854193">.</span><span class="ident" id="3854194">N</span><span class="op" id="3854195">.</span><span class="ident" id="3854196">Sign</span><span class="op" id="3854200">(</span><span class="op" id="3854201">)</span>&nbsp;<span class="op" id="3854203">&lt;=</span>&nbsp;<span class="num" id="3854206">0</span>&nbsp;<span class="op" id="3854208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854213">return</span>&nbsp;<span class="ident" id="3854220">nil</span><span class="op" id="3854223">,</span>&nbsp;<span class="ident" id="3854225">errors</span><span class="op" id="3854231">.</span><span class="ident" id="3854232">New</span><span class="op" id="3854235">(</span><span class="string" id="3854236">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3854280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854284">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854288">if</span>&nbsp;<span class="ident" id="3854291">p</span><span class="op" id="3854292">.</span><span class="ident" id="3854293">E</span>&nbsp;<span class="op" id="3854295">&lt;=</span>&nbsp;<span class="num" id="3854298">0</span>&nbsp;<span class="op" id="3854300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854305">return</span>&nbsp;<span class="ident" id="3854312">nil</span><span class="op" id="3854315">,</span>&nbsp;<span class="ident" id="3854317">errors</span><span class="op" id="3854323">.</span><span class="ident" id="3854324">New</span><span class="op" id="3854327">(</span><span class="string" id="3854328">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3854380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854389">pub</span>&nbsp;<span class="op" id="3854393">:=</span>&nbsp;<span class="op" id="3854396">&amp;</span><span class="ident" id="3854397">rsa</span><span class="op" id="3854400">.</span><span class="ident" id="3854401">PublicKey</span><span class="op" id="3854410">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854415">E</span><span class="op" id="3854416">:</span>&nbsp;<span class="ident" id="3854418">p</span><span class="op" id="3854419">.</span><span class="ident" id="3854420">E</span><span class="op" id="3854421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854426">N</span><span class="op" id="3854427">:</span>&nbsp;<span class="ident" id="3854429">p</span><span class="op" id="3854430">.</span><span class="ident" id="3854431">N</span><span class="op" id="3854432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854440">return</span>&nbsp;<span class="ident" id="3854447">pub</span><span class="op" id="3854450">,</span>&nbsp;<span class="ident" id="3854452">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854457">case</span>&nbsp;<span class="ident" id="3854462">DSA</span><span class="op" id="3854465">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854469">var</span>&nbsp;<span class="ident" id="3854473">p</span>&nbsp;<span class="op" id="3854475">*</span><span class="ident" id="3854476">big</span><span class="op" id="3854479">.</span><span class="ident" id="3854480">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854486">_</span><span class="op" id="3854487">,</span>&nbsp;<span class="ident" id="3854489">err</span>&nbsp;<span class="op" id="3854493">:=</span>&nbsp;<span class="ident" id="3854496">asn1</span><span class="op" id="3854500">.</span><span class="ident" id="3854501">Unmarshal</span><span class="op" id="3854510">(</span><span class="ident" id="3854511">asn1Data</span><span class="op" id="3854519">,</span>&nbsp;<span class="op" id="3854521">&amp;</span><span class="ident" id="3854522">p</span><span class="op" id="3854523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854527">if</span>&nbsp;<span class="ident" id="3854530">err</span>&nbsp;<span class="op" id="3854534">!=</span>&nbsp;<span class="ident" id="3854537">nil</span>&nbsp;<span class="op" id="3854541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854546">return</span>&nbsp;<span class="ident" id="3854553">nil</span><span class="op" id="3854556">,</span>&nbsp;<span class="ident" id="3854558">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854564">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854568">paramsData</span>&nbsp;<span class="op" id="3854579">:=</span>&nbsp;<span class="ident" id="3854582">keyData</span><span class="op" id="3854589">.</span><span class="ident" id="3854590">Algorithm</span><span class="op" id="3854599">.</span><span class="ident" id="3854600">Parameters</span><span class="op" id="3854610">.</span><span class="ident" id="3854611">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854623">params</span>&nbsp;<span class="op" id="3854630">:=</span>&nbsp;<span class="builtinfunc" id="3854633">new</span><span class="op" id="3854636">(</span><span class="ident" id="3854637">dsaAlgorithmParameters</span><span class="op" id="3854659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854663">_</span><span class="op" id="3854664">,</span>&nbsp;<span class="ident" id="3854666">err</span>&nbsp;<span class="op" id="3854670">=</span>&nbsp;<span class="ident" id="3854672">asn1</span><span class="op" id="3854676">.</span><span class="ident" id="3854677">Unmarshal</span><span class="op" id="3854686">(</span><span class="ident" id="3854687">paramsData</span><span class="op" id="3854697">,</span>&nbsp;<span class="ident" id="3854699">params</span><span class="op" id="3854705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854709">if</span>&nbsp;<span class="ident" id="3854712">err</span>&nbsp;<span class="op" id="3854716">!=</span>&nbsp;<span class="ident" id="3854719">nil</span>&nbsp;<span class="op" id="3854723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854728">return</span>&nbsp;<span class="ident" id="3854735">nil</span><span class="op" id="3854738">,</span>&nbsp;<span class="ident" id="3854740">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854750">if</span>&nbsp;<span class="ident" id="3854753">p</span><span class="op" id="3854754">.</span><span class="ident" id="3854755">Sign</span><span class="op" id="3854759">(</span><span class="op" id="3854760">)</span>&nbsp;<span class="op" id="3854762">&lt;=</span>&nbsp;<span class="num" id="3854765">0</span>&nbsp;<span class="op" id="3854767">||</span>&nbsp;<span class="ident" id="3854770">params</span><span class="op" id="3854776">.</span><span class="ident" id="3854777">P</span><span class="op" id="3854778">.</span><span class="ident" id="3854779">Sign</span><span class="op" id="3854783">(</span><span class="op" id="3854784">)</span>&nbsp;<span class="op" id="3854786">&lt;=</span>&nbsp;<span class="num" id="3854789">0</span>&nbsp;<span class="op" id="3854791">||</span>&nbsp;<span class="ident" id="3854794">params</span><span class="op" id="3854800">.</span><span class="ident" id="3854801">Q</span><span class="op" id="3854802">.</span><span class="ident" id="3854803">Sign</span><span class="op" id="3854807">(</span><span class="op" id="3854808">)</span>&nbsp;<span class="op" id="3854810">&lt;=</span>&nbsp;<span class="num" id="3854813">0</span>&nbsp;<span class="op" id="3854815">||</span>&nbsp;<span class="ident" id="3854818">params</span><span class="op" id="3854824">.</span><span class="ident" id="3854825">G</span><span class="op" id="3854826">.</span><span class="ident" id="3854827">Sign</span><span class="op" id="3854831">(</span><span class="op" id="3854832">)</span>&nbsp;<span class="op" id="3854834">&lt;=</span>&nbsp;<span class="num" id="3854837">0</span>&nbsp;<span class="op" id="3854839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854844">return</span>&nbsp;<span class="ident" id="3854851">nil</span><span class="op" id="3854854">,</span>&nbsp;<span class="ident" id="3854856">errors</span><span class="op" id="3854862">.</span><span class="ident" id="3854863">New</span><span class="op" id="3854866">(</span><span class="string" id="3854867">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="3854905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854913">pub</span>&nbsp;<span class="op" id="3854917">:=</span>&nbsp;<span class="op" id="3854920">&amp;</span><span class="ident" id="3854921">dsa</span><span class="op" id="3854924">.</span><span class="ident" id="3854925">PublicKey</span><span class="op" id="3854934">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854939">Parameters</span><span class="op" id="3854949">:</span>&nbsp;<span class="ident" id="3854951">dsa</span><span class="op" id="3854954">.</span><span class="ident" id="3854955">Parameters</span><span class="op" id="3854965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854971">P</span><span class="op" id="3854972">:</span>&nbsp;<span class="ident" id="3854974">params</span><span class="op" id="3854980">.</span><span class="ident" id="3854981">P</span><span class="op" id="3854982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854988">Q</span><span class="op" id="3854989">:</span>&nbsp;<span class="ident" id="3854991">params</span><span class="op" id="3854997">.</span><span class="ident" id="3854998">Q</span><span class="op" id="3854999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855005">G</span><span class="op" id="3855006">:</span>&nbsp;<span class="ident" id="3855008">params</span><span class="op" id="3855014">.</span><span class="ident" id="3855015">G</span><span class="op" id="3855016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855021">}</span><span class="op" id="3855022">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855027">Y</span><span class="op" id="3855028">:</span>&nbsp;<span class="ident" id="3855030">p</span><span class="op" id="3855031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855039">return</span>&nbsp;<span class="ident" id="3855046">pub</span><span class="op" id="3855049">,</span>&nbsp;<span class="ident" id="3855051">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855056">case</span>&nbsp;<span class="ident" id="3855061">ECDSA</span><span class="op" id="3855066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855070">paramsData</span>&nbsp;<span class="op" id="3855081">:=</span>&nbsp;<span class="ident" id="3855084">keyData</span><span class="op" id="3855091">.</span><span class="ident" id="3855092">Algorithm</span><span class="op" id="3855101">.</span><span class="ident" id="3855102">Parameters</span><span class="op" id="3855112">.</span><span class="ident" id="3855113">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855125">namedCurveOID</span>&nbsp;<span class="op" id="3855139">:=</span>&nbsp;<span class="builtinfunc" id="3855142">new</span><span class="op" id="3855145">(</span><span class="ident" id="3855146">asn1</span><span class="op" id="3855150">.</span><span class="ident" id="3855151">ObjectIdentifier</span><span class="op" id="3855167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855171">_</span><span class="op" id="3855172">,</span>&nbsp;<span class="ident" id="3855174">err</span>&nbsp;<span class="op" id="3855178">:=</span>&nbsp;<span class="ident" id="3855181">asn1</span><span class="op" id="3855185">.</span><span class="ident" id="3855186">Unmarshal</span><span class="op" id="3855195">(</span><span class="ident" id="3855196">paramsData</span><span class="op" id="3855206">,</span>&nbsp;<span class="ident" id="3855208">namedCurveOID</span><span class="op" id="3855221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855225">if</span>&nbsp;<span class="ident" id="3855228">err</span>&nbsp;<span class="op" id="3855232">!=</span>&nbsp;<span class="ident" id="3855235">nil</span>&nbsp;<span class="op" id="3855239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855244">return</span>&nbsp;<span class="ident" id="3855251">nil</span><span class="op" id="3855254">,</span>&nbsp;<span class="ident" id="3855256">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855262">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855266">namedCurve</span>&nbsp;<span class="op" id="3855277">:=</span>&nbsp;<span class="ident" id="3855280">namedCurveFromOID</span><span class="op" id="3855297">(</span><span class="op" id="3855298">*</span><span class="ident" id="3855299">namedCurveOID</span><span class="op" id="3855312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855316">if</span>&nbsp;<span class="ident" id="3855319">namedCurve</span>&nbsp;<span class="op" id="3855330">==</span>&nbsp;<span class="ident" id="3855333">nil</span>&nbsp;<span class="op" id="3855337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855342">return</span>&nbsp;<span class="ident" id="3855349">nil</span><span class="op" id="3855352">,</span>&nbsp;<span class="ident" id="3855354">errors</span><span class="op" id="3855360">.</span><span class="ident" id="3855361">New</span><span class="op" id="3855364">(</span><span class="string" id="3855365">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3855399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855407">x</span><span class="op" id="3855408">,</span>&nbsp;<span class="ident" id="3855410">y</span>&nbsp;<span class="op" id="3855412">:=</span>&nbsp;<span class="ident" id="3855415">elliptic</span><span class="op" id="3855423">.</span><span class="ident" id="3855424">Unmarshal</span><span class="op" id="3855433">(</span><span class="ident" id="3855434">namedCurve</span><span class="op" id="3855444">,</span>&nbsp;<span class="ident" id="3855446">asn1Data</span><span class="op" id="3855454">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855458">if</span>&nbsp;<span class="ident" id="3855461">x</span>&nbsp;<span class="op" id="3855463">==</span>&nbsp;<span class="ident" id="3855466">nil</span>&nbsp;<span class="op" id="3855470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855475">return</span>&nbsp;<span class="ident" id="3855482">nil</span><span class="op" id="3855485">,</span>&nbsp;<span class="ident" id="3855487">errors</span><span class="op" id="3855493">.</span><span class="ident" id="3855494">New</span><span class="op" id="3855497">(</span><span class="string" id="3855498">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="3855546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855554">pub</span>&nbsp;<span class="op" id="3855558">:=</span>&nbsp;<span class="op" id="3855561">&amp;</span><span class="ident" id="3855562">ecdsa</span><span class="op" id="3855567">.</span><span class="ident" id="3855568">PublicKey</span><span class="op" id="3855577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855582">Curve</span><span class="op" id="3855587">:</span>&nbsp;<span class="ident" id="3855589">namedCurve</span><span class="op" id="3855599">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855604">X</span><span class="op" id="3855605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3855611">x</span><span class="op" id="3855612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855617">Y</span><span class="op" id="3855618">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3855624">y</span><span class="op" id="3855625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855633">return</span>&nbsp;<span class="ident" id="3855640">pub</span><span class="op" id="3855643">,</span>&nbsp;<span class="ident" id="3855645">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855650">default</span><span class="op" id="3855657">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855661">return</span>&nbsp;<span class="ident" id="3855668">nil</span><span class="op" id="3855671">,</span>&nbsp;<span class="ident" id="3855673">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855678">}</span><br>
<span class="lineno"></span><span class="op" id="3855680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3855683">func</span>&nbsp;<span class="ident" id="3855688">parseSANExtension</span><span class="op" id="3855705">(</span><span class="ident" id="3855706">value</span>&nbsp;<span class="op" id="3855712">[</span><span class="op" id="3855713">]</span><span class="builtintype" id="3855714">byte</span><span class="op" id="3855718">)</span>&nbsp;<span class="op" id="3855720">(</span><span class="ident" id="3855721">dnsNames</span><span class="op" id="3855729">,</span>&nbsp;<span class="ident" id="3855731">emailAddresses</span>&nbsp;<span class="op" id="3855746">[</span><span class="op" id="3855747">]</span><span class="builtintype" id="3855748">string</span><span class="op" id="3855754">,</span>&nbsp;<span class="ident" id="3855756">ipAddresses</span>&nbsp;<span class="op" id="3855768">[</span><span class="op" id="3855769">]</span><span class="ident" id="3855770">net</span><span class="op" id="3855773">.</span><span class="ident" id="3855774">IP</span><span class="op" id="3855776">,</span>&nbsp;<span class="ident" id="3855778">err</span>&nbsp;<span class="builtintype" id="3855782">error</span><span class="op" id="3855787">)</span>&nbsp;<span class="op" id="3855789">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3855792">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3855815">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3855851">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3855855">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3855914">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3855918">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3855947">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856007">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856127">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856187">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856242">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856305">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856497">var</span>&nbsp;<span class="ident" id="3856501">seq</span>&nbsp;<span class="ident" id="3856505">asn1</span><span class="op" id="3856509">.</span><span class="ident" id="3856510">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856520">if</span>&nbsp;<span class="ident" id="3856523">_</span><span class="op" id="3856524">,</span>&nbsp;<span class="ident" id="3856526">err</span>&nbsp;<span class="op" id="3856530">=</span>&nbsp;<span class="ident" id="3856532">asn1</span><span class="op" id="3856536">.</span><span class="ident" id="3856537">Unmarshal</span><span class="op" id="3856546">(</span><span class="ident" id="3856547">value</span><span class="op" id="3856552">,</span>&nbsp;<span class="op" id="3856554">&amp;</span><span class="ident" id="3856555">seq</span><span class="op" id="3856558">)</span><span class="op" id="3856559">;</span>&nbsp;<span class="ident" id="3856561">err</span>&nbsp;<span class="op" id="3856565">!=</span>&nbsp;<span class="ident" id="3856568">nil</span>&nbsp;<span class="op" id="3856572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856576">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856584">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856587">if</span>&nbsp;<span class="op" id="3856590">!</span><span class="ident" id="3856591">seq</span><span class="op" id="3856594">.</span><span class="ident" id="3856595">IsCompound</span>&nbsp;<span class="op" id="3856606">||</span>&nbsp;<span class="ident" id="3856609">seq</span><span class="op" id="3856612">.</span><span class="ident" id="3856613">Tag</span>&nbsp;<span class="op" id="3856617">!=</span>&nbsp;<span class="num" id="3856620">16</span>&nbsp;<span class="op" id="3856623">||</span>&nbsp;<span class="ident" id="3856626">seq</span><span class="op" id="3856629">.</span><span class="ident" id="3856630">Class</span>&nbsp;<span class="op" id="3856636">!=</span>&nbsp;<span class="num" id="3856639">0</span>&nbsp;<span class="op" id="3856641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856645">err</span>&nbsp;<span class="op" id="3856649">=</span>&nbsp;<span class="ident" id="3856651">asn1</span><span class="op" id="3856655">.</span><span class="ident" id="3856656">StructuralError</span><span class="op" id="3856671">{</span><span class="ident" id="3856672">Msg</span><span class="op" id="3856675">:</span>&nbsp;<span class="string" id="3856677">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="3856695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856699">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856711">rest</span>&nbsp;<span class="op" id="3856716">:=</span>&nbsp;<span class="ident" id="3856719">seq</span><span class="op" id="3856722">.</span><span class="ident" id="3856723">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856730">for</span>&nbsp;<span class="builtinfunc" id="3856734">len</span><span class="op" id="3856737">(</span><span class="ident" id="3856738">rest</span><span class="op" id="3856742">)</span>&nbsp;<span class="op" id="3856744">&gt;</span>&nbsp;<span class="num" id="3856746">0</span>&nbsp;<span class="op" id="3856748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856752">var</span>&nbsp;<span class="ident" id="3856756">v</span>&nbsp;<span class="ident" id="3856758">asn1</span><span class="op" id="3856762">.</span><span class="ident" id="3856763">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856774">rest</span><span class="op" id="3856778">,</span>&nbsp;<span class="ident" id="3856780">err</span>&nbsp;<span class="op" id="3856784">=</span>&nbsp;<span class="ident" id="3856786">asn1</span><span class="op" id="3856790">.</span><span class="ident" id="3856791">Unmarshal</span><span class="op" id="3856800">(</span><span class="ident" id="3856801">rest</span><span class="op" id="3856805">,</span>&nbsp;<span class="op" id="3856807">&amp;</span><span class="ident" id="3856808">v</span><span class="op" id="3856809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856813">if</span>&nbsp;<span class="ident" id="3856816">err</span>&nbsp;<span class="op" id="3856820">!=</span>&nbsp;<span class="ident" id="3856823">nil</span>&nbsp;<span class="op" id="3856827">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856832">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856845">switch</span>&nbsp;<span class="ident" id="3856852">v</span><span class="op" id="3856853">.</span><span class="ident" id="3856854">Tag</span>&nbsp;<span class="op" id="3856858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856862">case</span>&nbsp;<span class="num" id="3856867">1</span><span class="op" id="3856868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856873">emailAddresses</span>&nbsp;<span class="op" id="3856888">=</span>&nbsp;<span class="builtinfunc" id="3856890">append</span><span class="op" id="3856896">(</span><span class="ident" id="3856897">emailAddresses</span><span class="op" id="3856911">,</span>&nbsp;<span class="builtintype" id="3856913">string</span><span class="op" id="3856919">(</span><span class="ident" id="3856920">v</span><span class="op" id="3856921">.</span><span class="ident" id="3856922">Bytes</span><span class="op" id="3856927">)</span><span class="op" id="3856928">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856932">case</span>&nbsp;<span class="num" id="3856937">2</span><span class="op" id="3856938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856943">dnsNames</span>&nbsp;<span class="op" id="3856952">=</span>&nbsp;<span class="builtinfunc" id="3856954">append</span><span class="op" id="3856960">(</span><span class="ident" id="3856961">dnsNames</span><span class="op" id="3856969">,</span>&nbsp;<span class="builtintype" id="3856971">string</span><span class="op" id="3856977">(</span><span class="ident" id="3856978">v</span><span class="op" id="3856979">.</span><span class="ident" id="3856980">Bytes</span><span class="op" id="3856985">)</span><span class="op" id="3856986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856990">case</span>&nbsp;<span class="num" id="3856995">7</span><span class="op" id="3856996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857001">switch</span>&nbsp;<span class="builtinfunc" id="3857008">len</span><span class="op" id="3857011">(</span><span class="ident" id="3857012">v</span><span class="op" id="3857013">.</span><span class="ident" id="3857014">Bytes</span><span class="op" id="3857019">)</span>&nbsp;<span class="op" id="3857021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857026">case</span>&nbsp;<span class="ident" id="3857031">net</span><span class="op" id="3857034">.</span><span class="ident" id="3857035">IPv4len</span><span class="op" id="3857042">,</span>&nbsp;<span class="ident" id="3857044">net</span><span class="op" id="3857047">.</span><span class="ident" id="3857048">IPv6len</span><span class="op" id="3857055">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857061">ipAddresses</span>&nbsp;<span class="op" id="3857073">=</span>&nbsp;<span class="builtinfunc" id="3857075">append</span><span class="op" id="3857081">(</span><span class="ident" id="3857082">ipAddresses</span><span class="op" id="3857093">,</span>&nbsp;<span class="ident" id="3857095">v</span><span class="op" id="3857096">.</span><span class="ident" id="3857097">Bytes</span><span class="op" id="3857102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857107">default</span><span class="op" id="3857114">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857120">err</span>&nbsp;<span class="op" id="3857124">=</span>&nbsp;<span class="ident" id="3857126">errors</span><span class="op" id="3857132">.</span><span class="ident" id="3857133">New</span><span class="op" id="3857136">(</span><span class="string" id="3857137">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="3857189">+</span>&nbsp;<span class="ident" id="3857191">strconv</span><span class="op" id="3857198">.</span><span class="ident" id="3857199">Itoa</span><span class="op" id="3857203">(</span><span class="builtinfunc" id="3857204">len</span><span class="op" id="3857207">(</span><span class="ident" id="3857208">v</span><span class="op" id="3857209">.</span><span class="ident" id="3857210">Bytes</span><span class="op" id="3857215">)</span><span class="op" id="3857216">)</span><span class="op" id="3857217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857223">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857233">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857244">return</span><br>
<span class="lineno"></span><span class="op" id="3857251">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="3857254">func</span>&nbsp;<span class="ident" id="3857259">parseCertificate</span><span class="op" id="3857275">(</span><span class="ident" id="3857276">in</span>&nbsp;<span class="op" id="3857279">*</span><span class="ident" id="3857280">certificate</span><span class="op" id="3857291">)</span>&nbsp;<span class="op" id="3857293">(</span><span class="op" id="3857294">*</span><span class="ident" id="3857295">Certificate</span><span class="op" id="3857306">,</span>&nbsp;<span class="builtintype" id="3857308">error</span><span class="op" id="3857313">)</span>&nbsp;<span class="op" id="3857315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857318">out</span>&nbsp;<span class="op" id="3857322">:=</span>&nbsp;<span class="builtinfunc" id="3857325">new</span><span class="op" id="3857328">(</span><span class="ident" id="3857329">Certificate</span><span class="op" id="3857340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857343">out</span><span class="op" id="3857346">.</span><span class="ident" id="3857347">Raw</span>&nbsp;<span class="op" id="3857351">=</span>&nbsp;<span class="ident" id="3857353">in</span><span class="op" id="3857355">.</span><span class="ident" id="3857356">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857361">out</span><span class="op" id="3857364">.</span><span class="ident" id="3857365">RawTBSCertificate</span>&nbsp;<span class="op" id="3857383">=</span>&nbsp;<span class="ident" id="3857385">in</span><span class="op" id="3857387">.</span><span class="ident" id="3857388">TBSCertificate</span><span class="op" id="3857402">.</span><span class="ident" id="3857403">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857408">out</span><span class="op" id="3857411">.</span><span class="ident" id="3857412">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3857436">=</span>&nbsp;<span class="ident" id="3857438">in</span><span class="op" id="3857440">.</span><span class="ident" id="3857441">TBSCertificate</span><span class="op" id="3857455">.</span><span class="ident" id="3857456">PublicKey</span><span class="op" id="3857465">.</span><span class="ident" id="3857466">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857471">out</span><span class="op" id="3857474">.</span><span class="ident" id="3857475">RawSubject</span>&nbsp;<span class="op" id="3857486">=</span>&nbsp;<span class="ident" id="3857488">in</span><span class="op" id="3857490">.</span><span class="ident" id="3857491">TBSCertificate</span><span class="op" id="3857505">.</span><span class="ident" id="3857506">Subject</span><span class="op" id="3857513">.</span><span class="ident" id="3857514">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857525">out</span><span class="op" id="3857528">.</span><span class="ident" id="3857529">RawIssuer</span>&nbsp;<span class="op" id="3857539">=</span>&nbsp;<span class="ident" id="3857541">in</span><span class="op" id="3857543">.</span><span class="ident" id="3857544">TBSCertificate</span><span class="op" id="3857558">.</span><span class="ident" id="3857559">Issuer</span><span class="op" id="3857565">.</span><span class="ident" id="3857566">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857578">out</span><span class="op" id="3857581">.</span><span class="ident" id="3857582">Signature</span>&nbsp;<span class="op" id="3857592">=</span>&nbsp;<span class="ident" id="3857594">in</span><span class="op" id="3857596">.</span><span class="ident" id="3857597">SignatureValue</span><span class="op" id="3857611">.</span><span class="ident" id="3857612">RightAlign</span><span class="op" id="3857622">(</span><span class="op" id="3857623">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857626">out</span><span class="op" id="3857629">.</span><span class="ident" id="3857630">SignatureAlgorithm</span>&nbsp;<span class="op" id="3857649">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857653">getSignatureAlgorithmFromOID</span><span class="op" id="3857681">(</span><span class="ident" id="3857682">in</span><span class="op" id="3857684">.</span><span class="ident" id="3857685">TBSCertificate</span><span class="op" id="3857699">.</span><span class="ident" id="3857700">SignatureAlgorithm</span><span class="op" id="3857718">.</span><span class="ident" id="3857719">Algorithm</span><span class="op" id="3857728">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857732">out</span><span class="op" id="3857735">.</span><span class="ident" id="3857736">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3857755">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857759">getPublicKeyAlgorithmFromOID</span><span class="op" id="3857787">(</span><span class="ident" id="3857788">in</span><span class="op" id="3857790">.</span><span class="ident" id="3857791">TBSCertificate</span><span class="op" id="3857805">.</span><span class="ident" id="3857806">PublicKey</span><span class="op" id="3857815">.</span><span class="ident" id="3857816">Algorithm</span><span class="op" id="3857825">.</span><span class="ident" id="3857826">Algorithm</span><span class="op" id="3857835">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857838">var</span>&nbsp;<span class="ident" id="3857842">err</span>&nbsp;<span class="builtintype" id="3857846">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857853">out</span><span class="op" id="3857856">.</span><span class="ident" id="3857857">PublicKey</span><span class="op" id="3857866">,</span>&nbsp;<span class="ident" id="3857868">err</span>&nbsp;<span class="op" id="3857872">=</span>&nbsp;<span class="ident" id="3857874">parsePublicKey</span><span class="op" id="3857888">(</span><span class="ident" id="3857889">out</span><span class="op" id="3857892">.</span><span class="ident" id="3857893">PublicKeyAlgorithm</span><span class="op" id="3857911">,</span>&nbsp;<span class="op" id="3857913">&amp;</span><span class="ident" id="3857914">in</span><span class="op" id="3857916">.</span><span class="ident" id="3857917">TBSCertificate</span><span class="op" id="3857931">.</span><span class="ident" id="3857932">PublicKey</span><span class="op" id="3857941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857944">if</span>&nbsp;<span class="ident" id="3857947">err</span>&nbsp;<span class="op" id="3857951">!=</span>&nbsp;<span class="ident" id="3857954">nil</span>&nbsp;<span class="op" id="3857958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857962">return</span>&nbsp;<span class="ident" id="3857969">nil</span><span class="op" id="3857972">,</span>&nbsp;<span class="ident" id="3857974">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857979">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857983">if</span>&nbsp;<span class="ident" id="3857986">in</span><span class="op" id="3857988">.</span><span class="ident" id="3857989">TBSCertificate</span><span class="op" id="3858003">.</span><span class="ident" id="3858004">SerialNumber</span><span class="op" id="3858016">.</span><span class="ident" id="3858017">Sign</span><span class="op" id="3858021">(</span><span class="op" id="3858022">)</span>&nbsp;<span class="op" id="3858024">&lt;</span>&nbsp;<span class="num" id="3858026">0</span>&nbsp;<span class="op" id="3858028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858032">return</span>&nbsp;<span class="ident" id="3858039">nil</span><span class="op" id="3858042">,</span>&nbsp;<span class="ident" id="3858044">errors</span><span class="op" id="3858050">.</span><span class="ident" id="3858051">New</span><span class="op" id="3858054">(</span><span class="string" id="3858055">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="3858085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858092">out</span><span class="op" id="3858095">.</span><span class="ident" id="3858096">Version</span>&nbsp;<span class="op" id="3858104">=</span>&nbsp;<span class="ident" id="3858106">in</span><span class="op" id="3858108">.</span><span class="ident" id="3858109">TBSCertificate</span><span class="op" id="3858123">.</span><span class="ident" id="3858124">Version</span>&nbsp;<span class="op" id="3858132">+</span>&nbsp;<span class="num" id="3858134">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858137">out</span><span class="op" id="3858140">.</span><span class="ident" id="3858141">SerialNumber</span>&nbsp;<span class="op" id="3858154">=</span>&nbsp;<span class="ident" id="3858156">in</span><span class="op" id="3858158">.</span><span class="ident" id="3858159">TBSCertificate</span><span class="op" id="3858173">.</span><span class="ident" id="3858174">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858189">var</span>&nbsp;<span class="ident" id="3858193">issuer</span><span class="op" id="3858199">,</span>&nbsp;<span class="ident" id="3858201">subject</span>&nbsp;<span class="ident" id="3858209">pkix</span><span class="op" id="3858213">.</span><span class="ident" id="3858214">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858227">if</span>&nbsp;<span class="ident" id="3858230">_</span><span class="op" id="3858231">,</span>&nbsp;<span class="ident" id="3858233">err</span>&nbsp;<span class="op" id="3858237">:=</span>&nbsp;<span class="ident" id="3858240">asn1</span><span class="op" id="3858244">.</span><span class="ident" id="3858245">Unmarshal</span><span class="op" id="3858254">(</span><span class="ident" id="3858255">in</span><span class="op" id="3858257">.</span><span class="ident" id="3858258">TBSCertificate</span><span class="op" id="3858272">.</span><span class="ident" id="3858273">Subject</span><span class="op" id="3858280">.</span><span class="ident" id="3858281">FullBytes</span><span class="op" id="3858290">,</span>&nbsp;<span class="op" id="3858292">&amp;</span><span class="ident" id="3858293">subject</span><span class="op" id="3858300">)</span><span class="op" id="3858301">;</span>&nbsp;<span class="ident" id="3858303">err</span>&nbsp;<span class="op" id="3858307">!=</span>&nbsp;<span class="ident" id="3858310">nil</span>&nbsp;<span class="op" id="3858314">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858318">return</span>&nbsp;<span class="ident" id="3858325">nil</span><span class="op" id="3858328">,</span>&nbsp;<span class="ident" id="3858330">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858338">if</span>&nbsp;<span class="ident" id="3858341">_</span><span class="op" id="3858342">,</span>&nbsp;<span class="ident" id="3858344">err</span>&nbsp;<span class="op" id="3858348">:=</span>&nbsp;<span class="ident" id="3858351">asn1</span><span class="op" id="3858355">.</span><span class="ident" id="3858356">Unmarshal</span><span class="op" id="3858365">(</span><span class="ident" id="3858366">in</span><span class="op" id="3858368">.</span><span class="ident" id="3858369">TBSCertificate</span><span class="op" id="3858383">.</span><span class="ident" id="3858384">Issuer</span><span class="op" id="3858390">.</span><span class="ident" id="3858391">FullBytes</span><span class="op" id="3858400">,</span>&nbsp;<span class="op" id="3858402">&amp;</span><span class="ident" id="3858403">issuer</span><span class="op" id="3858409">)</span><span class="op" id="3858410">;</span>&nbsp;<span class="ident" id="3858412">err</span>&nbsp;<span class="op" id="3858416">!=</span>&nbsp;<span class="ident" id="3858419">nil</span>&nbsp;<span class="op" id="3858423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858427">return</span>&nbsp;<span class="ident" id="3858434">nil</span><span class="op" id="3858437">,</span>&nbsp;<span class="ident" id="3858439">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858444">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858448">out</span><span class="op" id="3858451">.</span><span class="ident" id="3858452">Issuer</span><span class="op" id="3858458">.</span><span class="ident" id="3858459">FillFromRDNSequence</span><span class="op" id="3858478">(</span><span class="op" id="3858479">&amp;</span><span class="ident" id="3858480">issuer</span><span class="op" id="3858486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858489">out</span><span class="op" id="3858492">.</span><span class="ident" id="3858493">Subject</span><span class="op" id="3858500">.</span><span class="ident" id="3858501">FillFromRDNSequence</span><span class="op" id="3858520">(</span><span class="op" id="3858521">&amp;</span><span class="ident" id="3858522">subject</span><span class="op" id="3858529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858533">out</span><span class="op" id="3858536">.</span><span class="ident" id="3858537">NotBefore</span>&nbsp;<span class="op" id="3858547">=</span>&nbsp;<span class="ident" id="3858549">in</span><span class="op" id="3858551">.</span><span class="ident" id="3858552">TBSCertificate</span><span class="op" id="3858566">.</span><span class="ident" id="3858567">Validity</span><span class="op" id="3858575">.</span><span class="ident" id="3858576">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858587">out</span><span class="op" id="3858590">.</span><span class="ident" id="3858591">NotAfter</span>&nbsp;<span class="op" id="3858600">=</span>&nbsp;<span class="ident" id="3858602">in</span><span class="op" id="3858604">.</span><span class="ident" id="3858605">TBSCertificate</span><span class="op" id="3858619">.</span><span class="ident" id="3858620">Validity</span><span class="op" id="3858628">.</span><span class="ident" id="3858629">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858640">for</span>&nbsp;<span class="ident" id="3858644">_</span><span class="op" id="3858645">,</span>&nbsp;<span class="ident" id="3858647">e</span>&nbsp;<span class="op" id="3858649">:=</span>&nbsp;<span class="keyword" id="3858652">range</span>&nbsp;<span class="ident" id="3858658">in</span><span class="op" id="3858660">.</span><span class="ident" id="3858661">TBSCertificate</span><span class="op" id="3858675">.</span><span class="ident" id="3858676">Extensions</span>&nbsp;<span class="op" id="3858687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858691">out</span><span class="op" id="3858694">.</span><span class="ident" id="3858695">Extensions</span>&nbsp;<span class="op" id="3858706">=</span>&nbsp;<span class="builtinfunc" id="3858708">append</span><span class="op" id="3858714">(</span><span class="ident" id="3858715">out</span><span class="op" id="3858718">.</span><span class="ident" id="3858719">Extensions</span><span class="op" id="3858729">,</span>&nbsp;<span class="ident" id="3858731">e</span><span class="op" id="3858732">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858737">if</span>&nbsp;<span class="builtinfunc" id="3858740">len</span><span class="op" id="3858743">(</span><span class="ident" id="3858744">e</span><span class="op" id="3858745">.</span><span class="ident" id="3858746">Id</span><span class="op" id="3858748">)</span>&nbsp;<span class="op" id="3858750">==</span>&nbsp;<span class="num" id="3858753">4</span>&nbsp;<span class="op" id="3858755">&amp;&amp;</span>&nbsp;<span class="ident" id="3858758">e</span><span class="op" id="3858759">.</span><span class="ident" id="3858760">Id</span><span class="op" id="3858762">[</span><span class="num" id="3858763">0</span><span class="op" id="3858764">]</span>&nbsp;<span class="op" id="3858766">==</span>&nbsp;<span class="num" id="3858769">2</span>&nbsp;<span class="op" id="3858771">&amp;&amp;</span>&nbsp;<span class="ident" id="3858774">e</span><span class="op" id="3858775">.</span><span class="ident" id="3858776">Id</span><span class="op" id="3858778">[</span><span class="num" id="3858779">1</span><span class="op" id="3858780">]</span>&nbsp;<span class="op" id="3858782">==</span>&nbsp;<span class="num" id="3858785">5</span>&nbsp;<span class="op" id="3858787">&amp;&amp;</span>&nbsp;<span class="ident" id="3858790">e</span><span class="op" id="3858791">.</span><span class="ident" id="3858792">Id</span><span class="op" id="3858794">[</span><span class="num" id="3858795">2</span><span class="op" id="3858796">]</span>&nbsp;<span class="op" id="3858798">==</span>&nbsp;<span class="num" id="3858801">29</span>&nbsp;<span class="op" id="3858804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858809">switch</span>&nbsp;<span class="ident" id="3858816">e</span><span class="op" id="3858817">.</span><span class="ident" id="3858818">Id</span><span class="op" id="3858820">[</span><span class="num" id="3858821">3</span><span class="op" id="3858822">]</span>&nbsp;<span class="op" id="3858824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858829">case</span>&nbsp;<span class="num" id="3858834">15</span><span class="op" id="3858836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3858842">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858867">var</span>&nbsp;<span class="ident" id="3858871">usageBits</span>&nbsp;<span class="ident" id="3858881">asn1</span><span class="op" id="3858885">.</span><span class="ident" id="3858886">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858900">_</span><span class="op" id="3858901">,</span>&nbsp;<span class="ident" id="3858903">err</span>&nbsp;<span class="op" id="3858907">:=</span>&nbsp;<span class="ident" id="3858910">asn1</span><span class="op" id="3858914">.</span><span class="ident" id="3858915">Unmarshal</span><span class="op" id="3858924">(</span><span class="ident" id="3858925">e</span><span class="op" id="3858926">.</span><span class="ident" id="3858927">Value</span><span class="op" id="3858932">,</span>&nbsp;<span class="op" id="3858934">&amp;</span><span class="ident" id="3858935">usageBits</span><span class="op" id="3858944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858951">if</span>&nbsp;<span class="ident" id="3858954">err</span>&nbsp;<span class="op" id="3858958">==</span>&nbsp;<span class="ident" id="3858961">nil</span>&nbsp;<span class="op" id="3858965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858972">var</span>&nbsp;<span class="ident" id="3858976">usage</span>&nbsp;<span class="builtintype" id="3858982">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858991">for</span>&nbsp;<span class="ident" id="3858995">i</span>&nbsp;<span class="op" id="3858997">:=</span>&nbsp;<span class="num" id="3859000">0</span><span class="op" id="3859001">;</span>&nbsp;<span class="ident" id="3859003">i</span>&nbsp;<span class="op" id="3859005">&lt;</span>&nbsp;<span class="num" id="3859007">9</span><span class="op" id="3859008">;</span>&nbsp;<span class="ident" id="3859010">i</span><span class="op" id="3859011">++</span>&nbsp;<span class="op" id="3859014">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859022">if</span>&nbsp;<span class="ident" id="3859025">usageBits</span><span class="op" id="3859034">.</span><span class="ident" id="3859035">At</span><span class="op" id="3859037">(</span><span class="ident" id="3859038">i</span><span class="op" id="3859039">)</span>&nbsp;<span class="op" id="3859041">!=</span>&nbsp;<span class="num" id="3859044">0</span>&nbsp;<span class="op" id="3859046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859055">usage</span>&nbsp;<span class="op" id="3859061">|=</span>&nbsp;<span class="num" id="3859064">1</span>&nbsp;<span class="op" id="3859066">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3859069">uint</span><span class="op" id="3859073">(</span><span class="ident" id="3859074">i</span><span class="op" id="3859075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859097">out</span><span class="op" id="3859100">.</span><span class="ident" id="3859101">KeyUsage</span>&nbsp;<span class="op" id="3859110">=</span>&nbsp;<span class="ident" id="3859112">KeyUsage</span><span class="op" id="3859120">(</span><span class="ident" id="3859121">usage</span><span class="op" id="3859126">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859133">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859151">case</span>&nbsp;<span class="num" id="3859156">19</span><span class="op" id="3859158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859164">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859189">var</span>&nbsp;<span class="ident" id="3859193">constraints</span>&nbsp;<span class="ident" id="3859205">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859226">_</span><span class="op" id="3859227">,</span>&nbsp;<span class="ident" id="3859229">err</span>&nbsp;<span class="op" id="3859233">:=</span>&nbsp;<span class="ident" id="3859236">asn1</span><span class="op" id="3859240">.</span><span class="ident" id="3859241">Unmarshal</span><span class="op" id="3859250">(</span><span class="ident" id="3859251">e</span><span class="op" id="3859252">.</span><span class="ident" id="3859253">Value</span><span class="op" id="3859258">,</span>&nbsp;<span class="op" id="3859260">&amp;</span><span class="ident" id="3859261">constraints</span><span class="op" id="3859272">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859279">if</span>&nbsp;<span class="ident" id="3859282">err</span>&nbsp;<span class="op" id="3859286">==</span>&nbsp;<span class="ident" id="3859289">nil</span>&nbsp;<span class="op" id="3859293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859300">out</span><span class="op" id="3859303">.</span><span class="ident" id="3859304">BasicConstraintsValid</span>&nbsp;<span class="op" id="3859326">=</span>&nbsp;<span class="builtintype" id="3859328">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859338">out</span><span class="op" id="3859341">.</span><span class="ident" id="3859342">IsCA</span>&nbsp;<span class="op" id="3859347">=</span>&nbsp;<span class="ident" id="3859349">constraints</span><span class="op" id="3859360">.</span><span class="ident" id="3859361">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859371">out</span><span class="op" id="3859374">.</span><span class="ident" id="3859375">MaxPathLen</span>&nbsp;<span class="op" id="3859386">=</span>&nbsp;<span class="ident" id="3859388">constraints</span><span class="op" id="3859399">.</span><span class="ident" id="3859400">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859416">out</span><span class="op" id="3859419">.</span><span class="ident" id="3859420">MaxPathLenZero</span>&nbsp;<span class="op" id="3859435">=</span>&nbsp;<span class="ident" id="3859437">out</span><span class="op" id="3859440">.</span><span class="ident" id="3859441">MaxPathLen</span>&nbsp;<span class="op" id="3859452">==</span>&nbsp;<span class="num" id="3859455">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859462">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859480">case</span>&nbsp;<span class="num" id="3859485">17</span><span class="op" id="3859487">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859493">out</span><span class="op" id="3859496">.</span><span class="ident" id="3859497">DNSNames</span><span class="op" id="3859505">,</span>&nbsp;<span class="ident" id="3859507">out</span><span class="op" id="3859510">.</span><span class="ident" id="3859511">EmailAddresses</span><span class="op" id="3859525">,</span>&nbsp;<span class="ident" id="3859527">out</span><span class="op" id="3859530">.</span><span class="ident" id="3859531">IPAddresses</span><span class="op" id="3859542">,</span>&nbsp;<span class="ident" id="3859544">err</span>&nbsp;<span class="op" id="3859548">=</span>&nbsp;<span class="ident" id="3859550">parseSANExtension</span><span class="op" id="3859567">(</span><span class="ident" id="3859568">e</span><span class="op" id="3859569">.</span><span class="ident" id="3859570">Value</span><span class="op" id="3859575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859581">if</span>&nbsp;<span class="ident" id="3859584">err</span>&nbsp;<span class="op" id="3859588">!=</span>&nbsp;<span class="ident" id="3859591">nil</span>&nbsp;<span class="op" id="3859595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859602">return</span>&nbsp;<span class="ident" id="3859609">nil</span><span class="op" id="3859612">,</span>&nbsp;<span class="ident" id="3859614">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859629">if</span>&nbsp;<span class="builtinfunc" id="3859632">len</span><span class="op" id="3859635">(</span><span class="ident" id="3859636">out</span><span class="op" id="3859639">.</span><span class="ident" id="3859640">DNSNames</span><span class="op" id="3859648">)</span>&nbsp;<span class="op" id="3859650">&gt;</span>&nbsp;<span class="num" id="3859652">0</span>&nbsp;<span class="op" id="3859654">||</span>&nbsp;<span class="builtinfunc" id="3859657">len</span><span class="op" id="3859660">(</span><span class="ident" id="3859661">out</span><span class="op" id="3859664">.</span><span class="ident" id="3859665">EmailAddresses</span><span class="op" id="3859679">)</span>&nbsp;<span class="op" id="3859681">&gt;</span>&nbsp;<span class="num" id="3859683">0</span>&nbsp;<span class="op" id="3859685">||</span>&nbsp;<span class="builtinfunc" id="3859688">len</span><span class="op" id="3859691">(</span><span class="ident" id="3859692">out</span><span class="op" id="3859695">.</span><span class="ident" id="3859696">IPAddresses</span><span class="op" id="3859707">)</span>&nbsp;<span class="op" id="3859709">&gt;</span>&nbsp;<span class="num" id="3859711">0</span>&nbsp;<span class="op" id="3859713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859720">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859739">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859790">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859839">case</span>&nbsp;<span class="num" id="3859844">30</span><span class="op" id="3859846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859852">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859879">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859917">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3859987">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860058">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860065">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860133">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860140">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860177">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860226">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860346">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860353">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860395">var</span>&nbsp;<span class="ident" id="3860399">constraints</span>&nbsp;<span class="ident" id="3860411">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860431">_</span><span class="op" id="3860432">,</span>&nbsp;<span class="ident" id="3860434">err</span>&nbsp;<span class="op" id="3860438">:=</span>&nbsp;<span class="ident" id="3860441">asn1</span><span class="op" id="3860445">.</span><span class="ident" id="3860446">Unmarshal</span><span class="op" id="3860455">(</span><span class="ident" id="3860456">e</span><span class="op" id="3860457">.</span><span class="ident" id="3860458">Value</span><span class="op" id="3860463">,</span>&nbsp;<span class="op" id="3860465">&amp;</span><span class="ident" id="3860466">constraints</span><span class="op" id="3860477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860483">if</span>&nbsp;<span class="ident" id="3860486">err</span>&nbsp;<span class="op" id="3860490">!=</span>&nbsp;<span class="ident" id="3860493">nil</span>&nbsp;<span class="op" id="3860497">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860504">return</span>&nbsp;<span class="ident" id="3860511">nil</span><span class="op" id="3860514">,</span>&nbsp;<span class="ident" id="3860516">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860531">if</span>&nbsp;<span class="builtinfunc" id="3860534">len</span><span class="op" id="3860537">(</span><span class="ident" id="3860538">constraints</span><span class="op" id="3860549">.</span><span class="ident" id="3860550">Excluded</span><span class="op" id="3860558">)</span>&nbsp;<span class="op" id="3860560">&gt;</span>&nbsp;<span class="num" id="3860562">0</span>&nbsp;<span class="op" id="3860564">&amp;&amp;</span>&nbsp;<span class="ident" id="3860567">e</span><span class="op" id="3860568">.</span><span class="ident" id="3860569">Critical</span>&nbsp;<span class="op" id="3860578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860585">return</span>&nbsp;<span class="ident" id="3860592">out</span><span class="op" id="3860595">,</span>&nbsp;<span class="ident" id="3860597">UnhandledCriticalExtension</span><span class="op" id="3860623">{</span><span class="op" id="3860624">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860637">for</span>&nbsp;<span class="ident" id="3860641">_</span><span class="op" id="3860642">,</span>&nbsp;<span class="ident" id="3860644">subtree</span>&nbsp;<span class="op" id="3860652">:=</span>&nbsp;<span class="keyword" id="3860655">range</span>&nbsp;<span class="ident" id="3860661">constraints</span><span class="op" id="3860672">.</span><span class="ident" id="3860673">Permitted</span>&nbsp;<span class="op" id="3860683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860690">if</span>&nbsp;<span class="builtinfunc" id="3860693">len</span><span class="op" id="3860696">(</span><span class="ident" id="3860697">subtree</span><span class="op" id="3860704">.</span><span class="ident" id="3860705">Name</span><span class="op" id="3860709">)</span>&nbsp;<span class="op" id="3860711">==</span>&nbsp;<span class="num" id="3860714">0</span>&nbsp;<span class="op" id="3860716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860724">if</span>&nbsp;<span class="ident" id="3860727">e</span><span class="op" id="3860728">.</span><span class="ident" id="3860729">Critical</span>&nbsp;<span class="op" id="3860738">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860747">return</span>&nbsp;<span class="ident" id="3860754">out</span><span class="op" id="3860757">,</span>&nbsp;<span class="ident" id="3860759">UnhandledCriticalExtension</span><span class="op" id="3860785">{</span><span class="op" id="3860786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860802">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3860823">out</span><span class="op" id="3860826">.</span><span class="ident" id="3860827">PermittedDNSDomains</span>&nbsp;<span class="op" id="3860847">=</span>&nbsp;<span class="builtinfunc" id="3860849">append</span><span class="op" id="3860855">(</span><span class="ident" id="3860856">out</span><span class="op" id="3860859">.</span><span class="ident" id="3860860">PermittedDNSDomains</span><span class="op" id="3860879">,</span>&nbsp;<span class="ident" id="3860881">subtree</span><span class="op" id="3860888">.</span><span class="ident" id="3860889">Name</span><span class="op" id="3860893">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3860899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860905">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3860918">case</span>&nbsp;<span class="num" id="3860923">31</span><span class="op" id="3860925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860931">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3860958">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861035">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861042">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861157">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861222">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861289">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861296">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861338">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861395">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861467">var</span>&nbsp;<span class="ident" id="3861471">cdp</span>&nbsp;<span class="op" id="3861475">[</span><span class="op" id="3861476">]</span><span class="ident" id="3861477">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861499">_</span><span class="op" id="3861500">,</span>&nbsp;<span class="ident" id="3861502">err</span>&nbsp;<span class="op" id="3861506">:=</span>&nbsp;<span class="ident" id="3861509">asn1</span><span class="op" id="3861513">.</span><span class="ident" id="3861514">Unmarshal</span><span class="op" id="3861523">(</span><span class="ident" id="3861524">e</span><span class="op" id="3861525">.</span><span class="ident" id="3861526">Value</span><span class="op" id="3861531">,</span>&nbsp;<span class="op" id="3861533">&amp;</span><span class="ident" id="3861534">cdp</span><span class="op" id="3861537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861543">if</span>&nbsp;<span class="ident" id="3861546">err</span>&nbsp;<span class="op" id="3861550">!=</span>&nbsp;<span class="ident" id="3861553">nil</span>&nbsp;<span class="op" id="3861557">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861564">return</span>&nbsp;<span class="ident" id="3861571">nil</span><span class="op" id="3861574">,</span>&nbsp;<span class="ident" id="3861576">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861591">for</span>&nbsp;<span class="ident" id="3861595">_</span><span class="op" id="3861596">,</span>&nbsp;<span class="ident" id="3861598">dp</span>&nbsp;<span class="op" id="3861601">:=</span>&nbsp;<span class="keyword" id="3861604">range</span>&nbsp;<span class="ident" id="3861610">cdp</span>&nbsp;<span class="op" id="3861614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861621">var</span>&nbsp;<span class="ident" id="3861625">n</span>&nbsp;<span class="ident" id="3861627">asn1</span><span class="op" id="3861631">.</span><span class="ident" id="3861632">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861646">_</span><span class="op" id="3861647">,</span>&nbsp;<span class="ident" id="3861649">err</span>&nbsp;<span class="op" id="3861653">=</span>&nbsp;<span class="ident" id="3861655">asn1</span><span class="op" id="3861659">.</span><span class="ident" id="3861660">Unmarshal</span><span class="op" id="3861669">(</span><span class="ident" id="3861670">dp</span><span class="op" id="3861672">.</span><span class="ident" id="3861673">DistributionPoint</span><span class="op" id="3861690">.</span><span class="ident" id="3861691">FullName</span><span class="op" id="3861699">.</span><span class="ident" id="3861700">Bytes</span><span class="op" id="3861705">,</span>&nbsp;<span class="op" id="3861707">&amp;</span><span class="ident" id="3861708">n</span><span class="op" id="3861709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861716">if</span>&nbsp;<span class="ident" id="3861719">err</span>&nbsp;<span class="op" id="3861723">!=</span>&nbsp;<span class="ident" id="3861726">nil</span>&nbsp;<span class="op" id="3861730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861738">return</span>&nbsp;<span class="ident" id="3861745">nil</span><span class="op" id="3861748">,</span>&nbsp;<span class="ident" id="3861750">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861767">if</span>&nbsp;<span class="ident" id="3861770">n</span><span class="op" id="3861771">.</span><span class="ident" id="3861772">Tag</span>&nbsp;<span class="op" id="3861776">==</span>&nbsp;<span class="num" id="3861779">6</span>&nbsp;<span class="op" id="3861781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861789">out</span><span class="op" id="3861792">.</span><span class="ident" id="3861793">CRLDistributionPoints</span>&nbsp;<span class="op" id="3861815">=</span>&nbsp;<span class="builtinfunc" id="3861817">append</span><span class="op" id="3861823">(</span><span class="ident" id="3861824">out</span><span class="op" id="3861827">.</span><span class="ident" id="3861828">CRLDistributionPoints</span><span class="op" id="3861849">,</span>&nbsp;<span class="builtintype" id="3861851">string</span><span class="op" id="3861857">(</span><span class="ident" id="3861858">n</span><span class="op" id="3861859">.</span><span class="ident" id="3861860">Bytes</span><span class="op" id="3861865">)</span><span class="op" id="3861866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861885">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861898">case</span>&nbsp;<span class="num" id="3861903">35</span><span class="op" id="3861905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861911">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861936">var</span>&nbsp;<span class="ident" id="3861940">a</span>&nbsp;<span class="ident" id="3861942">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861956">_</span><span class="op" id="3861957">,</span>&nbsp;<span class="ident" id="3861959">err</span>&nbsp;<span class="op" id="3861963">=</span>&nbsp;<span class="ident" id="3861965">asn1</span><span class="op" id="3861969">.</span><span class="ident" id="3861970">Unmarshal</span><span class="op" id="3861979">(</span><span class="ident" id="3861980">e</span><span class="op" id="3861981">.</span><span class="ident" id="3861982">Value</span><span class="op" id="3861987">,</span>&nbsp;<span class="op" id="3861989">&amp;</span><span class="ident" id="3861990">a</span><span class="op" id="3861991">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861997">if</span>&nbsp;<span class="ident" id="3862000">err</span>&nbsp;<span class="op" id="3862004">!=</span>&nbsp;<span class="ident" id="3862007">nil</span>&nbsp;<span class="op" id="3862011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862018">return</span>&nbsp;<span class="ident" id="3862025">nil</span><span class="op" id="3862028">,</span>&nbsp;<span class="ident" id="3862030">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862044">out</span><span class="op" id="3862047">.</span><span class="ident" id="3862048">AuthorityKeyId</span>&nbsp;<span class="op" id="3862063">=</span>&nbsp;<span class="ident" id="3862065">a</span><span class="op" id="3862066">.</span><span class="ident" id="3862067">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862074">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862087">case</span>&nbsp;<span class="num" id="3862092">37</span><span class="op" id="3862094">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862100">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862148">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862208">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862215">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862283">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862290">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862333">var</span>&nbsp;<span class="ident" id="3862337">keyUsage</span>&nbsp;<span class="op" id="3862346">[</span><span class="op" id="3862347">]</span><span class="ident" id="3862348">asn1</span><span class="op" id="3862352">.</span><span class="ident" id="3862353">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862374">_</span><span class="op" id="3862375">,</span>&nbsp;<span class="ident" id="3862377">err</span>&nbsp;<span class="op" id="3862381">=</span>&nbsp;<span class="ident" id="3862383">asn1</span><span class="op" id="3862387">.</span><span class="ident" id="3862388">Unmarshal</span><span class="op" id="3862397">(</span><span class="ident" id="3862398">e</span><span class="op" id="3862399">.</span><span class="ident" id="3862400">Value</span><span class="op" id="3862405">,</span>&nbsp;<span class="op" id="3862407">&amp;</span><span class="ident" id="3862408">keyUsage</span><span class="op" id="3862416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862422">if</span>&nbsp;<span class="ident" id="3862425">err</span>&nbsp;<span class="op" id="3862429">!=</span>&nbsp;<span class="ident" id="3862432">nil</span>&nbsp;<span class="op" id="3862436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862443">return</span>&nbsp;<span class="ident" id="3862450">nil</span><span class="op" id="3862453">,</span>&nbsp;<span class="ident" id="3862455">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862463">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862470">for</span>&nbsp;<span class="ident" id="3862474">_</span><span class="op" id="3862475">,</span>&nbsp;<span class="ident" id="3862477">u</span>&nbsp;<span class="op" id="3862479">:=</span>&nbsp;<span class="keyword" id="3862482">range</span>&nbsp;<span class="ident" id="3862488">keyUsage</span>&nbsp;<span class="op" id="3862497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862504">if</span>&nbsp;<span class="ident" id="3862507">extKeyUsage</span><span class="op" id="3862518">,</span>&nbsp;<span class="ident" id="3862520">ok</span>&nbsp;<span class="op" id="3862523">:=</span>&nbsp;<span class="ident" id="3862526">extKeyUsageFromOID</span><span class="op" id="3862544">(</span><span class="ident" id="3862545">u</span><span class="op" id="3862546">)</span><span class="op" id="3862547">;</span>&nbsp;<span class="ident" id="3862549">ok</span>&nbsp;<span class="op" id="3862552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862560">out</span><span class="op" id="3862563">.</span><span class="ident" id="3862564">ExtKeyUsage</span>&nbsp;<span class="op" id="3862576">=</span>&nbsp;<span class="builtinfunc" id="3862578">append</span><span class="op" id="3862584">(</span><span class="ident" id="3862585">out</span><span class="op" id="3862588">.</span><span class="ident" id="3862589">ExtKeyUsage</span><span class="op" id="3862600">,</span>&nbsp;<span class="ident" id="3862602">extKeyUsage</span><span class="op" id="3862613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862620">}</span>&nbsp;<span class="keyword" id="3862622">else</span>&nbsp;<span class="op" id="3862627">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862635">out</span><span class="op" id="3862638">.</span><span class="ident" id="3862639">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="3862658">=</span>&nbsp;<span class="builtinfunc" id="3862660">append</span><span class="op" id="3862666">(</span><span class="ident" id="3862667">out</span><span class="op" id="3862670">.</span><span class="ident" id="3862671">UnknownExtKeyUsage</span><span class="op" id="3862689">,</span>&nbsp;<span class="ident" id="3862691">u</span><span class="op" id="3862692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862712">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862725">case</span>&nbsp;<span class="num" id="3862730">14</span><span class="op" id="3862732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862738">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862763">var</span>&nbsp;<span class="ident" id="3862767">keyid</span>&nbsp;<span class="op" id="3862773">[</span><span class="op" id="3862774">]</span><span class="builtintype" id="3862775">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862784">_</span><span class="op" id="3862785">,</span>&nbsp;<span class="ident" id="3862787">err</span>&nbsp;<span class="op" id="3862791">=</span>&nbsp;<span class="ident" id="3862793">asn1</span><span class="op" id="3862797">.</span><span class="ident" id="3862798">Unmarshal</span><span class="op" id="3862807">(</span><span class="ident" id="3862808">e</span><span class="op" id="3862809">.</span><span class="ident" id="3862810">Value</span><span class="op" id="3862815">,</span>&nbsp;<span class="op" id="3862817">&amp;</span><span class="ident" id="3862818">keyid</span><span class="op" id="3862823">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862829">if</span>&nbsp;<span class="ident" id="3862832">err</span>&nbsp;<span class="op" id="3862836">!=</span>&nbsp;<span class="ident" id="3862839">nil</span>&nbsp;<span class="op" id="3862843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862850">return</span>&nbsp;<span class="ident" id="3862857">nil</span><span class="op" id="3862860">,</span>&nbsp;<span class="ident" id="3862862">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862876">out</span><span class="op" id="3862879">.</span><span class="ident" id="3862880">SubjectKeyId</span>&nbsp;<span class="op" id="3862893">=</span>&nbsp;<span class="ident" id="3862895">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862905">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862918">case</span>&nbsp;<span class="num" id="3862923">32</span><span class="op" id="3862925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862931">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862977">var</span>&nbsp;<span class="ident" id="3862981">policies</span>&nbsp;<span class="op" id="3862990">[</span><span class="op" id="3862991">]</span><span class="ident" id="3862992">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863014">if</span>&nbsp;<span class="ident" id="3863017">_</span><span class="op" id="3863018">,</span>&nbsp;<span class="ident" id="3863020">err</span>&nbsp;<span class="op" id="3863024">=</span>&nbsp;<span class="ident" id="3863026">asn1</span><span class="op" id="3863030">.</span><span class="ident" id="3863031">Unmarshal</span><span class="op" id="3863040">(</span><span class="ident" id="3863041">e</span><span class="op" id="3863042">.</span><span class="ident" id="3863043">Value</span><span class="op" id="3863048">,</span>&nbsp;<span class="op" id="3863050">&amp;</span><span class="ident" id="3863051">policies</span><span class="op" id="3863059">)</span><span class="op" id="3863060">;</span>&nbsp;<span class="ident" id="3863062">err</span>&nbsp;<span class="op" id="3863066">!=</span>&nbsp;<span class="ident" id="3863069">nil</span>&nbsp;<span class="op" id="3863073">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863080">return</span>&nbsp;<span class="ident" id="3863087">nil</span><span class="op" id="3863090">,</span>&nbsp;<span class="ident" id="3863092">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863106">out</span><span class="op" id="3863109">.</span><span class="ident" id="3863110">PolicyIdentifiers</span>&nbsp;<span class="op" id="3863128">=</span>&nbsp;<span class="builtinfunc" id="3863130">make</span><span class="op" id="3863134">(</span><span class="op" id="3863135">[</span><span class="op" id="3863136">]</span><span class="ident" id="3863137">asn1</span><span class="op" id="3863141">.</span><span class="ident" id="3863142">ObjectIdentifier</span><span class="op" id="3863158">,</span>&nbsp;<span class="builtinfunc" id="3863160">len</span><span class="op" id="3863163">(</span><span class="ident" id="3863164">policies</span><span class="op" id="3863172">)</span><span class="op" id="3863173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863179">for</span>&nbsp;<span class="ident" id="3863183">i</span><span class="op" id="3863184">,</span>&nbsp;<span class="ident" id="3863186">policy</span>&nbsp;<span class="op" id="3863193">:=</span>&nbsp;<span class="keyword" id="3863196">range</span>&nbsp;<span class="ident" id="3863202">policies</span>&nbsp;<span class="op" id="3863211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863218">out</span><span class="op" id="3863221">.</span><span class="ident" id="3863222">PolicyIdentifiers</span><span class="op" id="3863239">[</span><span class="ident" id="3863240">i</span><span class="op" id="3863241">]</span>&nbsp;<span class="op" id="3863243">=</span>&nbsp;<span class="ident" id="3863245">policy</span><span class="op" id="3863251">.</span><span class="ident" id="3863252">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863272">}</span>&nbsp;<span class="keyword" id="3863274">else</span>&nbsp;<span class="keyword" id="3863279">if</span>&nbsp;<span class="ident" id="3863282">e</span><span class="op" id="3863283">.</span><span class="ident" id="3863284">Id</span><span class="op" id="3863286">.</span><span class="ident" id="3863287">Equal</span><span class="op" id="3863292">(</span><span class="ident" id="3863293">oidExtensionAuthorityInfoAccess</span><span class="op" id="3863324">)</span>&nbsp;<span class="op" id="3863326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863331">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863384">var</span>&nbsp;<span class="ident" id="3863388">aia</span>&nbsp;<span class="op" id="3863392">[</span><span class="op" id="3863393">]</span><span class="ident" id="3863394">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863417">if</span>&nbsp;<span class="ident" id="3863420">_</span><span class="op" id="3863421">,</span>&nbsp;<span class="ident" id="3863423">err</span>&nbsp;<span class="op" id="3863427">=</span>&nbsp;<span class="ident" id="3863429">asn1</span><span class="op" id="3863433">.</span><span class="ident" id="3863434">Unmarshal</span><span class="op" id="3863443">(</span><span class="ident" id="3863444">e</span><span class="op" id="3863445">.</span><span class="ident" id="3863446">Value</span><span class="op" id="3863451">,</span>&nbsp;<span class="op" id="3863453">&amp;</span><span class="ident" id="3863454">aia</span><span class="op" id="3863457">)</span><span class="op" id="3863458">;</span>&nbsp;<span class="ident" id="3863460">err</span>&nbsp;<span class="op" id="3863464">!=</span>&nbsp;<span class="ident" id="3863467">nil</span>&nbsp;<span class="op" id="3863471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863477">return</span>&nbsp;<span class="ident" id="3863484">nil</span><span class="op" id="3863487">,</span>&nbsp;<span class="ident" id="3863489">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863502">for</span>&nbsp;<span class="ident" id="3863506">_</span><span class="op" id="3863507">,</span>&nbsp;<span class="ident" id="3863509">v</span>&nbsp;<span class="op" id="3863511">:=</span>&nbsp;<span class="keyword" id="3863514">range</span>&nbsp;<span class="ident" id="3863520">aia</span>&nbsp;<span class="op" id="3863524">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863530">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863590">if</span>&nbsp;<span class="ident" id="3863593">v</span><span class="op" id="3863594">.</span><span class="ident" id="3863595">Location</span><span class="op" id="3863603">.</span><span class="ident" id="3863604">Tag</span>&nbsp;<span class="op" id="3863608">!=</span>&nbsp;<span class="num" id="3863611">6</span>&nbsp;<span class="op" id="3863613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863620">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863639">if</span>&nbsp;<span class="ident" id="3863642">v</span><span class="op" id="3863643">.</span><span class="ident" id="3863644">Method</span><span class="op" id="3863650">.</span><span class="ident" id="3863651">Equal</span><span class="op" id="3863656">(</span><span class="ident" id="3863657">oidAuthorityInfoAccessOcsp</span><span class="op" id="3863683">)</span>&nbsp;<span class="op" id="3863685">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863692">out</span><span class="op" id="3863695">.</span><span class="ident" id="3863696">OCSPServer</span>&nbsp;<span class="op" id="3863707">=</span>&nbsp;<span class="builtinfunc" id="3863709">append</span><span class="op" id="3863715">(</span><span class="ident" id="3863716">out</span><span class="op" id="3863719">.</span><span class="ident" id="3863720">OCSPServer</span><span class="op" id="3863730">,</span>&nbsp;<span class="builtintype" id="3863732">string</span><span class="op" id="3863738">(</span><span class="ident" id="3863739">v</span><span class="op" id="3863740">.</span><span class="ident" id="3863741">Location</span><span class="op" id="3863749">.</span><span class="ident" id="3863750">Bytes</span><span class="op" id="3863755">)</span><span class="op" id="3863756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863762">}</span>&nbsp;<span class="keyword" id="3863764">else</span>&nbsp;<span class="keyword" id="3863769">if</span>&nbsp;<span class="ident" id="3863772">v</span><span class="op" id="3863773">.</span><span class="ident" id="3863774">Method</span><span class="op" id="3863780">.</span><span class="ident" id="3863781">Equal</span><span class="op" id="3863786">(</span><span class="ident" id="3863787">oidAuthorityInfoAccessIssuers</span><span class="op" id="3863816">)</span>&nbsp;<span class="op" id="3863818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863825">out</span><span class="op" id="3863828">.</span><span class="ident" id="3863829">IssuingCertificateURL</span>&nbsp;<span class="op" id="3863851">=</span>&nbsp;<span class="builtinfunc" id="3863853">append</span><span class="op" id="3863859">(</span><span class="ident" id="3863860">out</span><span class="op" id="3863863">.</span><span class="ident" id="3863864">IssuingCertificateURL</span><span class="op" id="3863885">,</span>&nbsp;<span class="builtintype" id="3863887">string</span><span class="op" id="3863893">(</span><span class="ident" id="3863894">v</span><span class="op" id="3863895">.</span><span class="ident" id="3863896">Location</span><span class="op" id="3863904">.</span><span class="ident" id="3863905">Bytes</span><span class="op" id="3863910">)</span><span class="op" id="3863911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863922">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863931">if</span>&nbsp;<span class="ident" id="3863934">e</span><span class="op" id="3863935">.</span><span class="ident" id="3863936">Critical</span>&nbsp;<span class="op" id="3863945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863950">return</span>&nbsp;<span class="ident" id="3863957">out</span><span class="op" id="3863960">,</span>&nbsp;<span class="ident" id="3863962">UnhandledCriticalExtension</span><span class="op" id="3863988">{</span><span class="op" id="3863989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863993">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864000">return</span>&nbsp;<span class="ident" id="3864007">out</span><span class="op" id="3864010">,</span>&nbsp;<span class="ident" id="3864012">nil</span><br>
<span class="lineno"></span><span class="op" id="3864016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="3864019">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3864098">func</span>&nbsp;<span class="ident" id="3864103">ParseCertificate</span><span class="op" id="3864119">(</span><span class="ident" id="3864120">asn1Data</span>&nbsp;<span class="op" id="3864129">[</span><span class="op" id="3864130">]</span><span class="builtintype" id="3864131">byte</span><span class="op" id="3864135">)</span>&nbsp;<span class="op" id="3864137">(</span><span class="op" id="3864138">*</span><span class="ident" id="3864139">Certificate</span><span class="op" id="3864150">,</span>&nbsp;<span class="builtintype" id="3864152">error</span><span class="op" id="3864157">)</span>&nbsp;<span class="op" id="3864159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864162">var</span>&nbsp;<span class="ident" id="3864166">cert</span>&nbsp;<span class="ident" id="3864171">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864184">rest</span><span class="op" id="3864188">,</span>&nbsp;<span class="ident" id="3864190">err</span>&nbsp;<span class="op" id="3864194">:=</span>&nbsp;<span class="ident" id="3864197">asn1</span><span class="op" id="3864201">.</span><span class="ident" id="3864202">Unmarshal</span><span class="op" id="3864211">(</span><span class="ident" id="3864212">asn1Data</span><span class="op" id="3864220">,</span>&nbsp;<span class="op" id="3864222">&amp;</span><span class="ident" id="3864223">cert</span><span class="op" id="3864227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864230">if</span>&nbsp;<span class="ident" id="3864233">err</span>&nbsp;<span class="op" id="3864237">!=</span>&nbsp;<span class="ident" id="3864240">nil</span>&nbsp;<span class="op" id="3864244">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864248">return</span>&nbsp;<span class="ident" id="3864255">nil</span><span class="op" id="3864258">,</span>&nbsp;<span class="ident" id="3864260">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864268">if</span>&nbsp;<span class="builtinfunc" id="3864271">len</span><span class="op" id="3864274">(</span><span class="ident" id="3864275">rest</span><span class="op" id="3864279">)</span>&nbsp;<span class="op" id="3864281">&gt;</span>&nbsp;<span class="num" id="3864283">0</span>&nbsp;<span class="op" id="3864285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864289">return</span>&nbsp;<span class="ident" id="3864296">nil</span><span class="op" id="3864299">,</span>&nbsp;<span class="ident" id="3864301">asn1</span><span class="op" id="3864305">.</span><span class="ident" id="3864306">SyntaxError</span><span class="op" id="3864317">{</span><span class="ident" id="3864318">Msg</span><span class="op" id="3864321">:</span>&nbsp;<span class="string" id="3864323">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3864338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864341">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864345">return</span>&nbsp;<span class="ident" id="3864352">parseCertificate</span><span class="op" id="3864368">(</span><span class="op" id="3864369">&amp;</span><span class="ident" id="3864370">cert</span><span class="op" id="3864374">)</span><br>
<span class="lineno"></span><span class="op" id="3864376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3864379">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="3864457">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="3864534">func</span>&nbsp;<span class="ident" id="3864539">ParseCertificates</span><span class="op" id="3864556">(</span><span class="ident" id="3864557">asn1Data</span>&nbsp;<span class="op" id="3864566">[</span><span class="op" id="3864567">]</span><span class="builtintype" id="3864568">byte</span><span class="op" id="3864572">)</span>&nbsp;<span class="op" id="3864574">(</span><span class="op" id="3864575">[</span><span class="op" id="3864576">]</span><span class="op" id="3864577">*</span><span class="ident" id="3864578">Certificate</span><span class="op" id="3864589">,</span>&nbsp;<span class="builtintype" id="3864591">error</span><span class="op" id="3864596">)</span>&nbsp;<span class="op" id="3864598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864601">var</span>&nbsp;<span class="ident" id="3864605">v</span>&nbsp;<span class="op" id="3864607">[</span><span class="op" id="3864608">]</span><span class="op" id="3864609">*</span><span class="ident" id="3864610">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864624">for</span>&nbsp;<span class="builtinfunc" id="3864628">len</span><span class="op" id="3864631">(</span><span class="ident" id="3864632">asn1Data</span><span class="op" id="3864640">)</span>&nbsp;<span class="op" id="3864642">&gt;</span>&nbsp;<span class="num" id="3864644">0</span>&nbsp;<span class="op" id="3864646">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864650">cert</span>&nbsp;<span class="op" id="3864655">:=</span>&nbsp;<span class="builtinfunc" id="3864658">new</span><span class="op" id="3864661">(</span><span class="ident" id="3864662">certificate</span><span class="op" id="3864673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864677">var</span>&nbsp;<span class="ident" id="3864681">err</span>&nbsp;<span class="builtintype" id="3864685">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864693">asn1Data</span><span class="op" id="3864701">,</span>&nbsp;<span class="ident" id="3864703">err</span>&nbsp;<span class="op" id="3864707">=</span>&nbsp;<span class="ident" id="3864709">asn1</span><span class="op" id="3864713">.</span><span class="ident" id="3864714">Unmarshal</span><span class="op" id="3864723">(</span><span class="ident" id="3864724">asn1Data</span><span class="op" id="3864732">,</span>&nbsp;<span class="ident" id="3864734">cert</span><span class="op" id="3864738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864742">if</span>&nbsp;<span class="ident" id="3864745">err</span>&nbsp;<span class="op" id="3864749">!=</span>&nbsp;<span class="ident" id="3864752">nil</span>&nbsp;<span class="op" id="3864756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864761">return</span>&nbsp;<span class="ident" id="3864768">nil</span><span class="op" id="3864771">,</span>&nbsp;<span class="ident" id="3864773">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864783">v</span>&nbsp;<span class="op" id="3864785">=</span>&nbsp;<span class="builtinfunc" id="3864787">append</span><span class="op" id="3864793">(</span><span class="ident" id="3864794">v</span><span class="op" id="3864795">,</span>&nbsp;<span class="ident" id="3864797">cert</span><span class="op" id="3864801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864808">ret</span>&nbsp;<span class="op" id="3864812">:=</span>&nbsp;<span class="builtinfunc" id="3864815">make</span><span class="op" id="3864819">(</span><span class="op" id="3864820">[</span><span class="op" id="3864821">]</span><span class="op" id="3864822">*</span><span class="ident" id="3864823">Certificate</span><span class="op" id="3864834">,</span>&nbsp;<span class="builtinfunc" id="3864836">len</span><span class="op" id="3864839">(</span><span class="ident" id="3864840">v</span><span class="op" id="3864841">)</span><span class="op" id="3864842">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864845">for</span>&nbsp;<span class="ident" id="3864849">i</span><span class="op" id="3864850">,</span>&nbsp;<span class="ident" id="3864852">ci</span>&nbsp;<span class="op" id="3864855">:=</span>&nbsp;<span class="keyword" id="3864858">range</span>&nbsp;<span class="ident" id="3864864">v</span>&nbsp;<span class="op" id="3864866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864870">cert</span><span class="op" id="3864874">,</span>&nbsp;<span class="ident" id="3864876">err</span>&nbsp;<span class="op" id="3864880">:=</span>&nbsp;<span class="ident" id="3864883">parseCertificate</span><span class="op" id="3864899">(</span><span class="ident" id="3864900">ci</span><span class="op" id="3864902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864906">if</span>&nbsp;<span class="ident" id="3864909">err</span>&nbsp;<span class="op" id="3864913">!=</span>&nbsp;<span class="ident" id="3864916">nil</span>&nbsp;<span class="op" id="3864920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864925">return</span>&nbsp;<span class="ident" id="3864932">nil</span><span class="op" id="3864935">,</span>&nbsp;<span class="ident" id="3864937">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864943">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864947">ret</span><span class="op" id="3864950">[</span><span class="ident" id="3864951">i</span><span class="op" id="3864952">]</span>&nbsp;<span class="op" id="3864954">=</span>&nbsp;<span class="ident" id="3864956">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864966">return</span>&nbsp;<span class="ident" id="3864973">ret</span><span class="op" id="3864976">,</span>&nbsp;<span class="ident" id="3864978">nil</span><br>
<span class="lineno"></span><span class="op" id="3864982">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="3864985">func</span>&nbsp;<span class="ident" id="3864990">reverseBitsInAByte</span><span class="op" id="3865008">(</span><span class="ident" id="3865009">in</span>&nbsp;<span class="builtintype" id="3865012">byte</span><span class="op" id="3865016">)</span>&nbsp;<span class="builtintype" id="3865018">byte</span>&nbsp;<span class="op" id="3865023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865026">b1</span>&nbsp;<span class="op" id="3865029">:=</span>&nbsp;<span class="ident" id="3865032">in</span><span class="op" id="3865034">&gt;&gt;</span><span class="num" id="3865036">4</span>&nbsp;<span class="op" id="3865038">|</span>&nbsp;<span class="ident" id="3865040">in</span><span class="op" id="3865042">&lt;&lt;</span><span class="num" id="3865044">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865047">b2</span>&nbsp;<span class="op" id="3865050">:=</span>&nbsp;<span class="ident" id="3865053">b1</span><span class="op" id="3865055">&gt;&gt;</span><span class="num" id="3865057">2</span><span class="op" id="3865058">&amp;</span><span class="num" id="3865059">0x33</span>&nbsp;<span class="op" id="3865064">|</span>&nbsp;<span class="ident" id="3865066">b1</span><span class="op" id="3865068">&lt;&lt;</span><span class="num" id="3865070">2</span><span class="op" id="3865071">&amp;</span><span class="num" id="3865072">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865078">b3</span>&nbsp;<span class="op" id="3865081">:=</span>&nbsp;<span class="ident" id="3865084">b2</span><span class="op" id="3865086">&gt;&gt;</span><span class="num" id="3865088">1</span><span class="op" id="3865089">&amp;</span><span class="num" id="3865090">0x55</span>&nbsp;<span class="op" id="3865095">|</span>&nbsp;<span class="ident" id="3865097">b2</span><span class="op" id="3865099">&lt;&lt;</span><span class="num" id="3865101">1</span><span class="op" id="3865102">&amp;</span><span class="num" id="3865103">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865109">return</span>&nbsp;<span class="ident" id="3865116">b3</span><br>
<span class="lineno"></span><span class="op" id="3865119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3865122">var</span>&nbsp;<span class="op" id="3865126">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865129">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865163">=</span>&nbsp;<span class="op" id="3865165">[</span><span class="op" id="3865166">]</span><span class="builtintype" id="3865167">int</span><span class="op" id="3865170">{</span><span class="num" id="3865171">2</span><span class="op" id="3865172">,</span>&nbsp;<span class="num" id="3865174">5</span><span class="op" id="3865175">,</span>&nbsp;<span class="num" id="3865177">29</span><span class="op" id="3865179">,</span>&nbsp;<span class="num" id="3865181">14</span><span class="op" id="3865183">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865186">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865220">=</span>&nbsp;<span class="op" id="3865222">[</span><span class="op" id="3865223">]</span><span class="builtintype" id="3865224">int</span><span class="op" id="3865227">{</span><span class="num" id="3865228">2</span><span class="op" id="3865229">,</span>&nbsp;<span class="num" id="3865231">5</span><span class="op" id="3865232">,</span>&nbsp;<span class="num" id="3865234">29</span><span class="op" id="3865236">,</span>&nbsp;<span class="num" id="3865238">15</span><span class="op" id="3865240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865243">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865277">=</span>&nbsp;<span class="op" id="3865279">[</span><span class="op" id="3865280">]</span><span class="builtintype" id="3865281">int</span><span class="op" id="3865284">{</span><span class="num" id="3865285">2</span><span class="op" id="3865286">,</span>&nbsp;<span class="num" id="3865288">5</span><span class="op" id="3865289">,</span>&nbsp;<span class="num" id="3865291">29</span><span class="op" id="3865293">,</span>&nbsp;<span class="num" id="3865295">37</span><span class="op" id="3865297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865300">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865334">=</span>&nbsp;<span class="op" id="3865336">[</span><span class="op" id="3865337">]</span><span class="builtintype" id="3865338">int</span><span class="op" id="3865341">{</span><span class="num" id="3865342">2</span><span class="op" id="3865343">,</span>&nbsp;<span class="num" id="3865345">5</span><span class="op" id="3865346">,</span>&nbsp;<span class="num" id="3865348">29</span><span class="op" id="3865350">,</span>&nbsp;<span class="num" id="3865352">35</span><span class="op" id="3865354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865357">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865391">=</span>&nbsp;<span class="op" id="3865393">[</span><span class="op" id="3865394">]</span><span class="builtintype" id="3865395">int</span><span class="op" id="3865398">{</span><span class="num" id="3865399">2</span><span class="op" id="3865400">,</span>&nbsp;<span class="num" id="3865402">5</span><span class="op" id="3865403">,</span>&nbsp;<span class="num" id="3865405">29</span><span class="op" id="3865407">,</span>&nbsp;<span class="num" id="3865409">19</span><span class="op" id="3865411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865414">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865448">=</span>&nbsp;<span class="op" id="3865450">[</span><span class="op" id="3865451">]</span><span class="builtintype" id="3865452">int</span><span class="op" id="3865455">{</span><span class="num" id="3865456">2</span><span class="op" id="3865457">,</span>&nbsp;<span class="num" id="3865459">5</span><span class="op" id="3865460">,</span>&nbsp;<span class="num" id="3865462">29</span><span class="op" id="3865464">,</span>&nbsp;<span class="num" id="3865466">17</span><span class="op" id="3865468">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865471">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3865505">=</span>&nbsp;<span class="op" id="3865507">[</span><span class="op" id="3865508">]</span><span class="builtintype" id="3865509">int</span><span class="op" id="3865512">{</span><span class="num" id="3865513">2</span><span class="op" id="3865514">,</span>&nbsp;<span class="num" id="3865516">5</span><span class="op" id="3865517">,</span>&nbsp;<span class="num" id="3865519">29</span><span class="op" id="3865521">,</span>&nbsp;<span class="num" id="3865523">32</span><span class="op" id="3865525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865528">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865562">=</span>&nbsp;<span class="op" id="3865564">[</span><span class="op" id="3865565">]</span><span class="builtintype" id="3865566">int</span><span class="op" id="3865569">{</span><span class="num" id="3865570">2</span><span class="op" id="3865571">,</span>&nbsp;<span class="num" id="3865573">5</span><span class="op" id="3865574">,</span>&nbsp;<span class="num" id="3865576">29</span><span class="op" id="3865578">,</span>&nbsp;<span class="num" id="3865580">30</span><span class="op" id="3865582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865585">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="3865619">=</span>&nbsp;<span class="op" id="3865621">[</span><span class="op" id="3865622">]</span><span class="builtintype" id="3865623">int</span><span class="op" id="3865626">{</span><span class="num" id="3865627">2</span><span class="op" id="3865628">,</span>&nbsp;<span class="num" id="3865630">5</span><span class="op" id="3865631">,</span>&nbsp;<span class="num" id="3865633">29</span><span class="op" id="3865635">,</span>&nbsp;<span class="num" id="3865637">31</span><span class="op" id="3865639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865642">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3865676">=</span>&nbsp;<span class="op" id="3865678">[</span><span class="op" id="3865679">]</span><span class="builtintype" id="3865680">int</span><span class="op" id="3865683">{</span><span class="num" id="3865684">1</span><span class="op" id="3865685">,</span>&nbsp;<span class="num" id="3865687">3</span><span class="op" id="3865688">,</span>&nbsp;<span class="num" id="3865690">6</span><span class="op" id="3865691">,</span>&nbsp;<span class="num" id="3865693">1</span><span class="op" id="3865694">,</span>&nbsp;<span class="num" id="3865696">5</span><span class="op" id="3865697">,</span>&nbsp;<span class="num" id="3865699">5</span><span class="op" id="3865700">,</span>&nbsp;<span class="num" id="3865702">7</span><span class="op" id="3865703">,</span>&nbsp;<span class="num" id="3865705">1</span><span class="op" id="3865706">,</span>&nbsp;<span class="num" id="3865708">1</span><span class="op" id="3865709">}</span><br>
<span class="lineno"></span><span class="op" id="3865711">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="3865714">var</span>&nbsp;<span class="op" id="3865718">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865721">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3865751">=</span>&nbsp;<span class="ident" id="3865753">asn1</span><span class="op" id="3865757">.</span><span class="ident" id="3865758">ObjectIdentifier</span><span class="op" id="3865774">{</span><span class="num" id="3865775">1</span><span class="op" id="3865776">,</span>&nbsp;<span class="num" id="3865778">3</span><span class="op" id="3865779">,</span>&nbsp;<span class="num" id="3865781">6</span><span class="op" id="3865782">,</span>&nbsp;<span class="num" id="3865784">1</span><span class="op" id="3865785">,</span>&nbsp;<span class="num" id="3865787">5</span><span class="op" id="3865788">,</span>&nbsp;<span class="num" id="3865790">5</span><span class="op" id="3865791">,</span>&nbsp;<span class="num" id="3865793">7</span><span class="op" id="3865794">,</span>&nbsp;<span class="num" id="3865796">48</span><span class="op" id="3865798">,</span>&nbsp;<span class="num" id="3865800">1</span><span class="op" id="3865801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865804">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="3865834">=</span>&nbsp;<span class="ident" id="3865836">asn1</span><span class="op" id="3865840">.</span><span class="ident" id="3865841">ObjectIdentifier</span><span class="op" id="3865857">{</span><span class="num" id="3865858">1</span><span class="op" id="3865859">,</span>&nbsp;<span class="num" id="3865861">3</span><span class="op" id="3865862">,</span>&nbsp;<span class="num" id="3865864">6</span><span class="op" id="3865865">,</span>&nbsp;<span class="num" id="3865867">1</span><span class="op" id="3865868">,</span>&nbsp;<span class="num" id="3865870">5</span><span class="op" id="3865871">,</span>&nbsp;<span class="num" id="3865873">5</span><span class="op" id="3865874">,</span>&nbsp;<span class="num" id="3865876">7</span><span class="op" id="3865877">,</span>&nbsp;<span class="num" id="3865879">48</span><span class="op" id="3865881">,</span>&nbsp;<span class="num" id="3865883">2</span><span class="op" id="3865884">}</span><br>
<span class="lineno"></span><span class="op" id="3865886">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="3865889">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3865969">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="3865984">func</span>&nbsp;<span class="ident" id="3865989">oidInExtensions</span><span class="op" id="3866004">(</span><span class="ident" id="3866005">oid</span>&nbsp;<span class="ident" id="3866009">asn1</span><span class="op" id="3866013">.</span><span class="ident" id="3866014">ObjectIdentifier</span><span class="op" id="3866030">,</span>&nbsp;<span class="ident" id="3866032">extensions</span>&nbsp;<span class="op" id="3866043">[</span><span class="op" id="3866044">]</span><span class="ident" id="3866045">pkix</span><span class="op" id="3866049">.</span><span class="ident" id="3866050">Extension</span><span class="op" id="3866059">)</span>&nbsp;<span class="builtintype" id="3866061">bool</span>&nbsp;<span class="op" id="3866066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866069">for</span>&nbsp;<span class="ident" id="3866073">_</span><span class="op" id="3866074">,</span>&nbsp;<span class="ident" id="3866076">e</span>&nbsp;<span class="op" id="3866078">:=</span>&nbsp;<span class="keyword" id="3866081">range</span>&nbsp;<span class="ident" id="3866087">extensions</span>&nbsp;<span class="op" id="3866098">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866102">if</span>&nbsp;<span class="ident" id="3866105">e</span><span class="op" id="3866106">.</span><span class="ident" id="3866107">Id</span><span class="op" id="3866109">.</span><span class="ident" id="3866110">Equal</span><span class="op" id="3866115">(</span><span class="ident" id="3866116">oid</span><span class="op" id="3866119">)</span>&nbsp;<span class="op" id="3866121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866126">return</span>&nbsp;<span class="builtintype" id="3866133">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866146">return</span>&nbsp;<span class="builtintype" id="3866153">false</span><br>
<span class="lineno">1165</span><span class="op" id="3866159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3866162">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="3866238">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="3866275">func</span>&nbsp;<span class="ident" id="3866280">marshalSANs</span><span class="op" id="3866291">(</span><span class="ident" id="3866292">dnsNames</span><span class="op" id="3866300">,</span>&nbsp;<span class="ident" id="3866302">emailAddresses</span>&nbsp;<span class="op" id="3866317">[</span><span class="op" id="3866318">]</span><span class="builtintype" id="3866319">string</span><span class="op" id="3866325">,</span>&nbsp;<span class="ident" id="3866327">ipAddresses</span>&nbsp;<span class="op" id="3866339">[</span><span class="op" id="3866340">]</span><span class="ident" id="3866341">net</span><span class="op" id="3866344">.</span><span class="ident" id="3866345">IP</span><span class="op" id="3866347">)</span>&nbsp;<span class="op" id="3866349">(</span><span class="ident" id="3866350">derBytes</span>&nbsp;<span class="op" id="3866359">[</span><span class="op" id="3866360">]</span><span class="builtintype" id="3866361">byte</span><span class="op" id="3866365">,</span>&nbsp;<span class="ident" id="3866367">err</span>&nbsp;<span class="builtintype" id="3866371">error</span><span class="op" id="3866376">)</span>&nbsp;<span class="op" id="3866378">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866381">var</span>&nbsp;<span class="ident" id="3866385">rawValues</span>&nbsp;<span class="op" id="3866395">[</span><span class="op" id="3866396">]</span><span class="ident" id="3866397">asn1</span><span class="op" id="3866401">.</span><span class="ident" id="3866402">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866412">for</span>&nbsp;<span class="ident" id="3866416">_</span><span class="op" id="3866417">,</span>&nbsp;<span class="ident" id="3866419">name</span>&nbsp;<span class="op" id="3866424">:=</span>&nbsp;<span class="keyword" id="3866427">range</span>&nbsp;<span class="ident" id="3866433">dnsNames</span>&nbsp;<span class="op" id="3866442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866446">rawValues</span>&nbsp;<span class="op" id="3866456">=</span>&nbsp;<span class="builtinfunc" id="3866458">append</span><span class="op" id="3866464">(</span><span class="ident" id="3866465">rawValues</span><span class="op" id="3866474">,</span>&nbsp;<span class="ident" id="3866476">asn1</span><span class="op" id="3866480">.</span><span class="ident" id="3866481">RawValue</span><span class="op" id="3866489">{</span><span class="ident" id="3866490">Tag</span><span class="op" id="3866493">:</span>&nbsp;<span class="num" id="3866495">2</span><span class="op" id="3866496">,</span>&nbsp;<span class="ident" id="3866498">Class</span><span class="op" id="3866503">:</span>&nbsp;<span class="num" id="3866505">2</span><span class="op" id="3866506">,</span>&nbsp;<span class="ident" id="3866508">Bytes</span><span class="op" id="3866513">:</span>&nbsp;<span class="op" id="3866515">[</span><span class="op" id="3866516">]</span><span class="builtintype" id="3866517">byte</span><span class="op" id="3866521">(</span><span class="ident" id="3866522">name</span><span class="op" id="3866526">)</span><span class="op" id="3866527">}</span><span class="op" id="3866528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866534">for</span>&nbsp;<span class="ident" id="3866538">_</span><span class="op" id="3866539">,</span>&nbsp;<span class="ident" id="3866541">email</span>&nbsp;<span class="op" id="3866547">:=</span>&nbsp;<span class="keyword" id="3866550">range</span>&nbsp;<span class="ident" id="3866556">emailAddresses</span>&nbsp;<span class="op" id="3866571">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866575">rawValues</span>&nbsp;<span class="op" id="3866585">=</span>&nbsp;<span class="builtinfunc" id="3866587">append</span><span class="op" id="3866593">(</span><span class="ident" id="3866594">rawValues</span><span class="op" id="3866603">,</span>&nbsp;<span class="ident" id="3866605">asn1</span><span class="op" id="3866609">.</span><span class="ident" id="3866610">RawValue</span><span class="op" id="3866618">{</span><span class="ident" id="3866619">Tag</span><span class="op" id="3866622">:</span>&nbsp;<span class="num" id="3866624">1</span><span class="op" id="3866625">,</span>&nbsp;<span class="ident" id="3866627">Class</span><span class="op" id="3866632">:</span>&nbsp;<span class="num" id="3866634">2</span><span class="op" id="3866635">,</span>&nbsp;<span class="ident" id="3866637">Bytes</span><span class="op" id="3866642">:</span>&nbsp;<span class="op" id="3866644">[</span><span class="op" id="3866645">]</span><span class="builtintype" id="3866646">byte</span><span class="op" id="3866650">(</span><span class="ident" id="3866651">email</span><span class="op" id="3866656">)</span><span class="op" id="3866657">}</span><span class="op" id="3866658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866664">for</span>&nbsp;<span class="ident" id="3866668">_</span><span class="op" id="3866669">,</span>&nbsp;<span class="ident" id="3866671">rawIP</span>&nbsp;<span class="op" id="3866677">:=</span>&nbsp;<span class="keyword" id="3866680">range</span>&nbsp;<span class="ident" id="3866686">ipAddresses</span>&nbsp;<span class="op" id="3866698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3866702">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866772">ip</span>&nbsp;<span class="op" id="3866775">:=</span>&nbsp;<span class="ident" id="3866778">rawIP</span><span class="op" id="3866783">.</span><span class="ident" id="3866784">To4</span><span class="op" id="3866787">(</span><span class="op" id="3866788">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866792">if</span>&nbsp;<span class="ident" id="3866795">ip</span>&nbsp;<span class="op" id="3866798">==</span>&nbsp;<span class="ident" id="3866801">nil</span>&nbsp;<span class="op" id="3866805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866810">ip</span>&nbsp;<span class="op" id="3866813">=</span>&nbsp;<span class="ident" id="3866815">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866827">rawValues</span>&nbsp;<span class="op" id="3866837">=</span>&nbsp;<span class="builtinfunc" id="3866839">append</span><span class="op" id="3866845">(</span><span class="ident" id="3866846">rawValues</span><span class="op" id="3866855">,</span>&nbsp;<span class="ident" id="3866857">asn1</span><span class="op" id="3866861">.</span><span class="ident" id="3866862">RawValue</span><span class="op" id="3866870">{</span><span class="ident" id="3866871">Tag</span><span class="op" id="3866874">:</span>&nbsp;<span class="num" id="3866876">7</span><span class="op" id="3866877">,</span>&nbsp;<span class="ident" id="3866879">Class</span><span class="op" id="3866884">:</span>&nbsp;<span class="num" id="3866886">2</span><span class="op" id="3866887">,</span>&nbsp;<span class="ident" id="3866889">Bytes</span><span class="op" id="3866894">:</span>&nbsp;<span class="ident" id="3866896">ip</span><span class="op" id="3866898">}</span><span class="op" id="3866899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866902">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866905">return</span>&nbsp;<span class="ident" id="3866912">asn1</span><span class="op" id="3866916">.</span><span class="ident" id="3866917">Marshal</span><span class="op" id="3866924">(</span><span class="ident" id="3866925">rawValues</span><span class="op" id="3866934">)</span><br>
<span class="lineno"></span><span class="op" id="3866936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3866939">func</span>&nbsp;<span class="ident" id="3866944">buildExtensions</span><span class="op" id="3866959">(</span><span class="ident" id="3866960">template</span>&nbsp;<span class="op" id="3866969">*</span><span class="ident" id="3866970">Certificate</span><span class="op" id="3866981">)</span>&nbsp;<span class="op" id="3866983">(</span><span class="ident" id="3866984">ret</span>&nbsp;<span class="op" id="3866988">[</span><span class="op" id="3866989">]</span><span class="ident" id="3866990">pkix</span><span class="op" id="3866994">.</span><span class="ident" id="3866995">Extension</span><span class="op" id="3867004">,</span>&nbsp;<span class="ident" id="3867006">err</span>&nbsp;<span class="builtintype" id="3867010">error</span><span class="op" id="3867015">)</span>&nbsp;<span class="op" id="3867017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867020">ret</span>&nbsp;<span class="op" id="3867024">=</span>&nbsp;<span class="builtinfunc" id="3867026">make</span><span class="op" id="3867030">(</span><span class="op" id="3867031">[</span><span class="op" id="3867032">]</span><span class="ident" id="3867033">pkix</span><span class="op" id="3867037">.</span><span class="ident" id="3867038">Extension</span><span class="op" id="3867047">,</span>&nbsp;<span class="num" id="3867049">10</span>&nbsp;<span class="comment" id="3867052">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="3867085">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867088">n</span>&nbsp;<span class="op" id="3867090">:=</span>&nbsp;<span class="num" id="3867093">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867097">if</span>&nbsp;<span class="ident" id="3867100">template</span><span class="op" id="3867108">.</span><span class="ident" id="3867109">KeyUsage</span>&nbsp;<span class="op" id="3867118">!=</span>&nbsp;<span class="num" id="3867121">0</span>&nbsp;<span class="op" id="3867123">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867128">!</span><span class="ident" id="3867129">oidInExtensions</span><span class="op" id="3867144">(</span><span class="ident" id="3867145">oidExtensionKeyUsage</span><span class="op" id="3867165">,</span>&nbsp;<span class="ident" id="3867167">template</span><span class="op" id="3867175">.</span><span class="ident" id="3867176">ExtraExtensions</span><span class="op" id="3867191">)</span>&nbsp;<span class="op" id="3867193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867197">ret</span><span class="op" id="3867200">[</span><span class="ident" id="3867201">n</span><span class="op" id="3867202">]</span><span class="op" id="3867203">.</span><span class="ident" id="3867204">Id</span>&nbsp;<span class="op" id="3867207">=</span>&nbsp;<span class="ident" id="3867209">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867232">ret</span><span class="op" id="3867235">[</span><span class="ident" id="3867236">n</span><span class="op" id="3867237">]</span><span class="op" id="3867238">.</span><span class="ident" id="3867239">Critical</span>&nbsp;<span class="op" id="3867248">=</span>&nbsp;<span class="builtintype" id="3867250">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867258">var</span>&nbsp;<span class="ident" id="3867262">a</span>&nbsp;<span class="op" id="3867264">[</span><span class="num" id="3867265">2</span><span class="op" id="3867266">]</span><span class="builtintype" id="3867267">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867274">a</span><span class="op" id="3867275">[</span><span class="num" id="3867276">0</span><span class="op" id="3867277">]</span>&nbsp;<span class="op" id="3867279">=</span>&nbsp;<span class="ident" id="3867281">reverseBitsInAByte</span><span class="op" id="3867299">(</span><span class="builtintype" id="3867300">byte</span><span class="op" id="3867304">(</span><span class="ident" id="3867305">template</span><span class="op" id="3867313">.</span><span class="ident" id="3867314">KeyUsage</span><span class="op" id="3867322">)</span><span class="op" id="3867323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867327">a</span><span class="op" id="3867328">[</span><span class="num" id="3867329">1</span><span class="op" id="3867330">]</span>&nbsp;<span class="op" id="3867332">=</span>&nbsp;<span class="ident" id="3867334">reverseBitsInAByte</span><span class="op" id="3867352">(</span><span class="builtintype" id="3867353">byte</span><span class="op" id="3867357">(</span><span class="ident" id="3867358">template</span><span class="op" id="3867366">.</span><span class="ident" id="3867367">KeyUsage</span>&nbsp;<span class="op" id="3867376">&gt;&gt;</span>&nbsp;<span class="num" id="3867379">8</span><span class="op" id="3867380">)</span><span class="op" id="3867381">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867386">l</span>&nbsp;<span class="op" id="3867388">:=</span>&nbsp;<span class="num" id="3867391">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867395">if</span>&nbsp;<span class="ident" id="3867398">a</span><span class="op" id="3867399">[</span><span class="num" id="3867400">1</span><span class="op" id="3867401">]</span>&nbsp;<span class="op" id="3867403">!=</span>&nbsp;<span class="num" id="3867406">0</span>&nbsp;<span class="op" id="3867408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867413">l</span>&nbsp;<span class="op" id="3867415">=</span>&nbsp;<span class="num" id="3867417">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867421">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867426">ret</span><span class="op" id="3867429">[</span><span class="ident" id="3867430">n</span><span class="op" id="3867431">]</span><span class="op" id="3867432">.</span><span class="ident" id="3867433">Value</span><span class="op" id="3867438">,</span>&nbsp;<span class="ident" id="3867440">err</span>&nbsp;<span class="op" id="3867444">=</span>&nbsp;<span class="ident" id="3867446">asn1</span><span class="op" id="3867450">.</span><span class="ident" id="3867451">Marshal</span><span class="op" id="3867458">(</span><span class="ident" id="3867459">asn1</span><span class="op" id="3867463">.</span><span class="ident" id="3867464">BitString</span><span class="op" id="3867473">{</span><span class="ident" id="3867474">Bytes</span><span class="op" id="3867479">:</span>&nbsp;<span class="ident" id="3867481">a</span><span class="op" id="3867482">[</span><span class="num" id="3867483">0</span><span class="op" id="3867484">:</span><span class="ident" id="3867485">l</span><span class="op" id="3867486">]</span><span class="op" id="3867487">,</span>&nbsp;<span class="ident" id="3867489">BitLength</span><span class="op" id="3867498">:</span>&nbsp;<span class="ident" id="3867500">l</span>&nbsp;<span class="op" id="3867502">*</span>&nbsp;<span class="num" id="3867504">8</span><span class="op" id="3867505">}</span><span class="op" id="3867506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867510">if</span>&nbsp;<span class="ident" id="3867513">err</span>&nbsp;<span class="op" id="3867517">!=</span>&nbsp;<span class="ident" id="3867520">nil</span>&nbsp;<span class="op" id="3867524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867529">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867538">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867542">n</span><span class="op" id="3867543">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867551">if</span>&nbsp;<span class="op" id="3867554">(</span><span class="builtinfunc" id="3867555">len</span><span class="op" id="3867558">(</span><span class="ident" id="3867559">template</span><span class="op" id="3867567">.</span><span class="ident" id="3867568">ExtKeyUsage</span><span class="op" id="3867579">)</span>&nbsp;<span class="op" id="3867581">&gt;</span>&nbsp;<span class="num" id="3867583">0</span>&nbsp;<span class="op" id="3867585">||</span>&nbsp;<span class="builtinfunc" id="3867588">len</span><span class="op" id="3867591">(</span><span class="ident" id="3867592">template</span><span class="op" id="3867600">.</span><span class="ident" id="3867601">UnknownExtKeyUsage</span><span class="op" id="3867619">)</span>&nbsp;<span class="op" id="3867621">&gt;</span>&nbsp;<span class="num" id="3867623">0</span><span class="op" id="3867624">)</span>&nbsp;<span class="op" id="3867626">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867631">!</span><span class="ident" id="3867632">oidInExtensions</span><span class="op" id="3867647">(</span><span class="ident" id="3867648">oidExtensionExtendedKeyUsage</span><span class="op" id="3867676">,</span>&nbsp;<span class="ident" id="3867678">template</span><span class="op" id="3867686">.</span><span class="ident" id="3867687">ExtraExtensions</span><span class="op" id="3867702">)</span>&nbsp;<span class="op" id="3867704">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867708">ret</span><span class="op" id="3867711">[</span><span class="ident" id="3867712">n</span><span class="op" id="3867713">]</span><span class="op" id="3867714">.</span><span class="ident" id="3867715">Id</span>&nbsp;<span class="op" id="3867718">=</span>&nbsp;<span class="ident" id="3867720">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867752">var</span>&nbsp;<span class="ident" id="3867756">oids</span>&nbsp;<span class="op" id="3867761">[</span><span class="op" id="3867762">]</span><span class="ident" id="3867763">asn1</span><span class="op" id="3867767">.</span><span class="ident" id="3867768">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867787">for</span>&nbsp;<span class="ident" id="3867791">_</span><span class="op" id="3867792">,</span>&nbsp;<span class="ident" id="3867794">u</span>&nbsp;<span class="op" id="3867796">:=</span>&nbsp;<span class="keyword" id="3867799">range</span>&nbsp;<span class="ident" id="3867805">template</span><span class="op" id="3867813">.</span><span class="ident" id="3867814">ExtKeyUsage</span>&nbsp;<span class="op" id="3867826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867831">if</span>&nbsp;<span class="ident" id="3867834">oid</span><span class="op" id="3867837">,</span>&nbsp;<span class="ident" id="3867839">ok</span>&nbsp;<span class="op" id="3867842">:=</span>&nbsp;<span class="ident" id="3867845">oidFromExtKeyUsage</span><span class="op" id="3867863">(</span><span class="ident" id="3867864">u</span><span class="op" id="3867865">)</span><span class="op" id="3867866">;</span>&nbsp;<span class="ident" id="3867868">ok</span>&nbsp;<span class="op" id="3867871">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867877">oids</span>&nbsp;<span class="op" id="3867882">=</span>&nbsp;<span class="builtinfunc" id="3867884">append</span><span class="op" id="3867890">(</span><span class="ident" id="3867891">oids</span><span class="op" id="3867895">,</span>&nbsp;<span class="ident" id="3867897">oid</span><span class="op" id="3867900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867905">}</span>&nbsp;<span class="keyword" id="3867907">else</span>&nbsp;<span class="op" id="3867912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3867918">panic</span><span class="op" id="3867923">(</span><span class="string" id="3867924">&#34;internal&nbsp;error&#34;</span><span class="op" id="3867940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867949">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867954">oids</span>&nbsp;<span class="op" id="3867959">=</span>&nbsp;<span class="builtinfunc" id="3867961">append</span><span class="op" id="3867967">(</span><span class="ident" id="3867968">oids</span><span class="op" id="3867972">,</span>&nbsp;<span class="ident" id="3867974">template</span><span class="op" id="3867982">.</span><span class="ident" id="3867983">UnknownExtKeyUsage</span><span class="op" id="3868001">...</span><span class="op" id="3868004">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868009">ret</span><span class="op" id="3868012">[</span><span class="ident" id="3868013">n</span><span class="op" id="3868014">]</span><span class="op" id="3868015">.</span><span class="ident" id="3868016">Value</span><span class="op" id="3868021">,</span>&nbsp;<span class="ident" id="3868023">err</span>&nbsp;<span class="op" id="3868027">=</span>&nbsp;<span class="ident" id="3868029">asn1</span><span class="op" id="3868033">.</span><span class="ident" id="3868034">Marshal</span><span class="op" id="3868041">(</span><span class="ident" id="3868042">oids</span><span class="op" id="3868046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868050">if</span>&nbsp;<span class="ident" id="3868053">err</span>&nbsp;<span class="op" id="3868057">!=</span>&nbsp;<span class="ident" id="3868060">nil</span>&nbsp;<span class="op" id="3868064">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868069">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868082">n</span><span class="op" id="3868083">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868091">if</span>&nbsp;<span class="ident" id="3868094">template</span><span class="op" id="3868102">.</span><span class="ident" id="3868103">BasicConstraintsValid</span>&nbsp;<span class="op" id="3868125">&amp;&amp;</span>&nbsp;<span class="op" id="3868128">!</span><span class="ident" id="3868129">oidInExtensions</span><span class="op" id="3868144">(</span><span class="ident" id="3868145">oidExtensionBasicConstraints</span><span class="op" id="3868173">,</span>&nbsp;<span class="ident" id="3868175">template</span><span class="op" id="3868183">.</span><span class="ident" id="3868184">ExtraExtensions</span><span class="op" id="3868199">)</span>&nbsp;<span class="op" id="3868201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868205">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868268">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868333">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868392">maxPathLen</span>&nbsp;<span class="op" id="3868403">:=</span>&nbsp;<span class="ident" id="3868406">template</span><span class="op" id="3868414">.</span><span class="ident" id="3868415">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868428">if</span>&nbsp;<span class="ident" id="3868431">maxPathLen</span>&nbsp;<span class="op" id="3868442">==</span>&nbsp;<span class="num" id="3868445">0</span>&nbsp;<span class="op" id="3868447">&amp;&amp;</span>&nbsp;<span class="op" id="3868450">!</span><span class="ident" id="3868451">template</span><span class="op" id="3868459">.</span><span class="ident" id="3868460">MaxPathLenZero</span>&nbsp;<span class="op" id="3868475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868480">maxPathLen</span>&nbsp;<span class="op" id="3868491">=</span>&nbsp;<span class="op" id="3868493">-</span><span class="num" id="3868494">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868502">ret</span><span class="op" id="3868505">[</span><span class="ident" id="3868506">n</span><span class="op" id="3868507">]</span><span class="op" id="3868508">.</span><span class="ident" id="3868509">Id</span>&nbsp;<span class="op" id="3868512">=</span>&nbsp;<span class="ident" id="3868514">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868545">ret</span><span class="op" id="3868548">[</span><span class="ident" id="3868549">n</span><span class="op" id="3868550">]</span><span class="op" id="3868551">.</span><span class="ident" id="3868552">Value</span><span class="op" id="3868557">,</span>&nbsp;<span class="ident" id="3868559">err</span>&nbsp;<span class="op" id="3868563">=</span>&nbsp;<span class="ident" id="3868565">asn1</span><span class="op" id="3868569">.</span><span class="ident" id="3868570">Marshal</span><span class="op" id="3868577">(</span><span class="ident" id="3868578">basicConstraints</span><span class="op" id="3868594">{</span><span class="ident" id="3868595">template</span><span class="op" id="3868603">.</span><span class="ident" id="3868604">IsCA</span><span class="op" id="3868608">,</span>&nbsp;<span class="ident" id="3868610">maxPathLen</span><span class="op" id="3868620">}</span><span class="op" id="3868621">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868625">ret</span><span class="op" id="3868628">[</span><span class="ident" id="3868629">n</span><span class="op" id="3868630">]</span><span class="op" id="3868631">.</span><span class="ident" id="3868632">Critical</span>&nbsp;<span class="op" id="3868641">=</span>&nbsp;<span class="builtintype" id="3868643">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868650">if</span>&nbsp;<span class="ident" id="3868653">err</span>&nbsp;<span class="op" id="3868657">!=</span>&nbsp;<span class="ident" id="3868660">nil</span>&nbsp;<span class="op" id="3868664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868682">n</span><span class="op" id="3868683">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868691">if</span>&nbsp;<span class="builtinfunc" id="3868694">len</span><span class="op" id="3868697">(</span><span class="ident" id="3868698">template</span><span class="op" id="3868706">.</span><span class="ident" id="3868707">SubjectKeyId</span><span class="op" id="3868719">)</span>&nbsp;<span class="op" id="3868721">&gt;</span>&nbsp;<span class="num" id="3868723">0</span>&nbsp;<span class="op" id="3868725">&amp;&amp;</span>&nbsp;<span class="op" id="3868728">!</span><span class="ident" id="3868729">oidInExtensions</span><span class="op" id="3868744">(</span><span class="ident" id="3868745">oidExtensionSubjectKeyId</span><span class="op" id="3868769">,</span>&nbsp;<span class="ident" id="3868771">template</span><span class="op" id="3868779">.</span><span class="ident" id="3868780">ExtraExtensions</span><span class="op" id="3868795">)</span>&nbsp;<span class="op" id="3868797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868801">ret</span><span class="op" id="3868804">[</span><span class="ident" id="3868805">n</span><span class="op" id="3868806">]</span><span class="op" id="3868807">.</span><span class="ident" id="3868808">Id</span>&nbsp;<span class="op" id="3868811">=</span>&nbsp;<span class="ident" id="3868813">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868840">ret</span><span class="op" id="3868843">[</span><span class="ident" id="3868844">n</span><span class="op" id="3868845">]</span><span class="op" id="3868846">.</span><span class="ident" id="3868847">Value</span><span class="op" id="3868852">,</span>&nbsp;<span class="ident" id="3868854">err</span>&nbsp;<span class="op" id="3868858">=</span>&nbsp;<span class="ident" id="3868860">asn1</span><span class="op" id="3868864">.</span><span class="ident" id="3868865">Marshal</span><span class="op" id="3868872">(</span><span class="ident" id="3868873">template</span><span class="op" id="3868881">.</span><span class="ident" id="3868882">SubjectKeyId</span><span class="op" id="3868894">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868898">if</span>&nbsp;<span class="ident" id="3868901">err</span>&nbsp;<span class="op" id="3868905">!=</span>&nbsp;<span class="ident" id="3868908">nil</span>&nbsp;<span class="op" id="3868912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868917">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868930">n</span><span class="op" id="3868931">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868935">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868939">if</span>&nbsp;<span class="builtinfunc" id="3868942">len</span><span class="op" id="3868945">(</span><span class="ident" id="3868946">template</span><span class="op" id="3868954">.</span><span class="ident" id="3868955">AuthorityKeyId</span><span class="op" id="3868969">)</span>&nbsp;<span class="op" id="3868971">&gt;</span>&nbsp;<span class="num" id="3868973">0</span>&nbsp;<span class="op" id="3868975">&amp;&amp;</span>&nbsp;<span class="op" id="3868978">!</span><span class="ident" id="3868979">oidInExtensions</span><span class="op" id="3868994">(</span><span class="ident" id="3868995">oidExtensionAuthorityKeyId</span><span class="op" id="3869021">,</span>&nbsp;<span class="ident" id="3869023">template</span><span class="op" id="3869031">.</span><span class="ident" id="3869032">ExtraExtensions</span><span class="op" id="3869047">)</span>&nbsp;<span class="op" id="3869049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869053">ret</span><span class="op" id="3869056">[</span><span class="ident" id="3869057">n</span><span class="op" id="3869058">]</span><span class="op" id="3869059">.</span><span class="ident" id="3869060">Id</span>&nbsp;<span class="op" id="3869063">=</span>&nbsp;<span class="ident" id="3869065">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869094">ret</span><span class="op" id="3869097">[</span><span class="ident" id="3869098">n</span><span class="op" id="3869099">]</span><span class="op" id="3869100">.</span><span class="ident" id="3869101">Value</span><span class="op" id="3869106">,</span>&nbsp;<span class="ident" id="3869108">err</span>&nbsp;<span class="op" id="3869112">=</span>&nbsp;<span class="ident" id="3869114">asn1</span><span class="op" id="3869118">.</span><span class="ident" id="3869119">Marshal</span><span class="op" id="3869126">(</span><span class="ident" id="3869127">authKeyId</span><span class="op" id="3869136">{</span><span class="ident" id="3869137">template</span><span class="op" id="3869145">.</span><span class="ident" id="3869146">AuthorityKeyId</span><span class="op" id="3869160">}</span><span class="op" id="3869161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869165">if</span>&nbsp;<span class="ident" id="3869168">err</span>&nbsp;<span class="op" id="3869172">!=</span>&nbsp;<span class="ident" id="3869175">nil</span>&nbsp;<span class="op" id="3869179">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869184">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869197">n</span><span class="op" id="3869198">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869206">if</span>&nbsp;<span class="op" id="3869209">(</span><span class="builtinfunc" id="3869210">len</span><span class="op" id="3869213">(</span><span class="ident" id="3869214">template</span><span class="op" id="3869222">.</span><span class="ident" id="3869223">OCSPServer</span><span class="op" id="3869233">)</span>&nbsp;<span class="op" id="3869235">&gt;</span>&nbsp;<span class="num" id="3869237">0</span>&nbsp;<span class="op" id="3869239">||</span>&nbsp;<span class="builtinfunc" id="3869242">len</span><span class="op" id="3869245">(</span><span class="ident" id="3869246">template</span><span class="op" id="3869254">.</span><span class="ident" id="3869255">IssuingCertificateURL</span><span class="op" id="3869276">)</span>&nbsp;<span class="op" id="3869278">&gt;</span>&nbsp;<span class="num" id="3869280">0</span><span class="op" id="3869281">)</span>&nbsp;<span class="op" id="3869283">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869288">!</span><span class="ident" id="3869289">oidInExtensions</span><span class="op" id="3869304">(</span><span class="ident" id="3869305">oidExtensionAuthorityInfoAccess</span><span class="op" id="3869336">,</span>&nbsp;<span class="ident" id="3869338">template</span><span class="op" id="3869346">.</span><span class="ident" id="3869347">ExtraExtensions</span><span class="op" id="3869362">)</span>&nbsp;<span class="op" id="3869364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869368">ret</span><span class="op" id="3869371">[</span><span class="ident" id="3869372">n</span><span class="op" id="3869373">]</span><span class="op" id="3869374">.</span><span class="ident" id="3869375">Id</span>&nbsp;<span class="op" id="3869378">=</span>&nbsp;<span class="ident" id="3869380">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869414">var</span>&nbsp;<span class="ident" id="3869418">aiaValues</span>&nbsp;<span class="op" id="3869428">[</span><span class="op" id="3869429">]</span><span class="ident" id="3869430">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869452">for</span>&nbsp;<span class="ident" id="3869456">_</span><span class="op" id="3869457">,</span>&nbsp;<span class="ident" id="3869459">name</span>&nbsp;<span class="op" id="3869464">:=</span>&nbsp;<span class="keyword" id="3869467">range</span>&nbsp;<span class="ident" id="3869473">template</span><span class="op" id="3869481">.</span><span class="ident" id="3869482">OCSPServer</span>&nbsp;<span class="op" id="3869493">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869498">aiaValues</span>&nbsp;<span class="op" id="3869508">=</span>&nbsp;<span class="builtinfunc" id="3869510">append</span><span class="op" id="3869516">(</span><span class="ident" id="3869517">aiaValues</span><span class="op" id="3869526">,</span>&nbsp;<span class="ident" id="3869528">authorityInfoAccess</span><span class="op" id="3869547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869553">Method</span><span class="op" id="3869559">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3869563">oidAuthorityInfoAccessOcsp</span><span class="op" id="3869589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869595">Location</span><span class="op" id="3869603">:</span>&nbsp;<span class="ident" id="3869605">asn1</span><span class="op" id="3869609">.</span><span class="ident" id="3869610">RawValue</span><span class="op" id="3869618">{</span><span class="ident" id="3869619">Tag</span><span class="op" id="3869622">:</span>&nbsp;<span class="num" id="3869624">6</span><span class="op" id="3869625">,</span>&nbsp;<span class="ident" id="3869627">Class</span><span class="op" id="3869632">:</span>&nbsp;<span class="num" id="3869634">2</span><span class="op" id="3869635">,</span>&nbsp;<span class="ident" id="3869637">Bytes</span><span class="op" id="3869642">:</span>&nbsp;<span class="op" id="3869644">[</span><span class="op" id="3869645">]</span><span class="builtintype" id="3869646">byte</span><span class="op" id="3869650">(</span><span class="ident" id="3869651">name</span><span class="op" id="3869655">)</span><span class="op" id="3869656">}</span><span class="op" id="3869657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869662">}</span><span class="op" id="3869663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869667">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869671">for</span>&nbsp;<span class="ident" id="3869675">_</span><span class="op" id="3869676">,</span>&nbsp;<span class="ident" id="3869678">name</span>&nbsp;<span class="op" id="3869683">:=</span>&nbsp;<span class="keyword" id="3869686">range</span>&nbsp;<span class="ident" id="3869692">template</span><span class="op" id="3869700">.</span><span class="ident" id="3869701">IssuingCertificateURL</span>&nbsp;<span class="op" id="3869723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869728">aiaValues</span>&nbsp;<span class="op" id="3869738">=</span>&nbsp;<span class="builtinfunc" id="3869740">append</span><span class="op" id="3869746">(</span><span class="ident" id="3869747">aiaValues</span><span class="op" id="3869756">,</span>&nbsp;<span class="ident" id="3869758">authorityInfoAccess</span><span class="op" id="3869777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869783">Method</span><span class="op" id="3869789">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3869793">oidAuthorityInfoAccessIssuers</span><span class="op" id="3869822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869828">Location</span><span class="op" id="3869836">:</span>&nbsp;<span class="ident" id="3869838">asn1</span><span class="op" id="3869842">.</span><span class="ident" id="3869843">RawValue</span><span class="op" id="3869851">{</span><span class="ident" id="3869852">Tag</span><span class="op" id="3869855">:</span>&nbsp;<span class="num" id="3869857">6</span><span class="op" id="3869858">,</span>&nbsp;<span class="ident" id="3869860">Class</span><span class="op" id="3869865">:</span>&nbsp;<span class="num" id="3869867">2</span><span class="op" id="3869868">,</span>&nbsp;<span class="ident" id="3869870">Bytes</span><span class="op" id="3869875">:</span>&nbsp;<span class="op" id="3869877">[</span><span class="op" id="3869878">]</span><span class="builtintype" id="3869879">byte</span><span class="op" id="3869883">(</span><span class="ident" id="3869884">name</span><span class="op" id="3869888">)</span><span class="op" id="3869889">}</span><span class="op" id="3869890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869895">}</span><span class="op" id="3869896">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869904">ret</span><span class="op" id="3869907">[</span><span class="ident" id="3869908">n</span><span class="op" id="3869909">]</span><span class="op" id="3869910">.</span><span class="ident" id="3869911">Value</span><span class="op" id="3869916">,</span>&nbsp;<span class="ident" id="3869918">err</span>&nbsp;<span class="op" id="3869922">=</span>&nbsp;<span class="ident" id="3869924">asn1</span><span class="op" id="3869928">.</span><span class="ident" id="3869929">Marshal</span><span class="op" id="3869936">(</span><span class="ident" id="3869937">aiaValues</span><span class="op" id="3869946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869950">if</span>&nbsp;<span class="ident" id="3869953">err</span>&nbsp;<span class="op" id="3869957">!=</span>&nbsp;<span class="ident" id="3869960">nil</span>&nbsp;<span class="op" id="3869964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869969">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869978">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869982">n</span><span class="op" id="3869983">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869991">if</span>&nbsp;<span class="op" id="3869994">(</span><span class="builtinfunc" id="3869995">len</span><span class="op" id="3869998">(</span><span class="ident" id="3869999">template</span><span class="op" id="3870007">.</span><span class="ident" id="3870008">DNSNames</span><span class="op" id="3870016">)</span>&nbsp;<span class="op" id="3870018">&gt;</span>&nbsp;<span class="num" id="3870020">0</span>&nbsp;<span class="op" id="3870022">||</span>&nbsp;<span class="builtinfunc" id="3870025">len</span><span class="op" id="3870028">(</span><span class="ident" id="3870029">template</span><span class="op" id="3870037">.</span><span class="ident" id="3870038">EmailAddresses</span><span class="op" id="3870052">)</span>&nbsp;<span class="op" id="3870054">&gt;</span>&nbsp;<span class="num" id="3870056">0</span>&nbsp;<span class="op" id="3870058">||</span>&nbsp;<span class="builtinfunc" id="3870061">len</span><span class="op" id="3870064">(</span><span class="ident" id="3870065">template</span><span class="op" id="3870073">.</span><span class="ident" id="3870074">IPAddresses</span><span class="op" id="3870085">)</span>&nbsp;<span class="op" id="3870087">&gt;</span>&nbsp;<span class="num" id="3870089">0</span><span class="op" id="3870090">)</span>&nbsp;<span class="op" id="3870092">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870097">!</span><span class="ident" id="3870098">oidInExtensions</span><span class="op" id="3870113">(</span><span class="ident" id="3870114">oidExtensionSubjectAltName</span><span class="op" id="3870140">,</span>&nbsp;<span class="ident" id="3870142">template</span><span class="op" id="3870150">.</span><span class="ident" id="3870151">ExtraExtensions</span><span class="op" id="3870166">)</span>&nbsp;<span class="op" id="3870168">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870172">ret</span><span class="op" id="3870175">[</span><span class="ident" id="3870176">n</span><span class="op" id="3870177">]</span><span class="op" id="3870178">.</span><span class="ident" id="3870179">Id</span>&nbsp;<span class="op" id="3870182">=</span>&nbsp;<span class="ident" id="3870184">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870213">ret</span><span class="op" id="3870216">[</span><span class="ident" id="3870217">n</span><span class="op" id="3870218">]</span><span class="op" id="3870219">.</span><span class="ident" id="3870220">Value</span><span class="op" id="3870225">,</span>&nbsp;<span class="ident" id="3870227">err</span>&nbsp;<span class="op" id="3870231">=</span>&nbsp;<span class="ident" id="3870233">marshalSANs</span><span class="op" id="3870244">(</span><span class="ident" id="3870245">template</span><span class="op" id="3870253">.</span><span class="ident" id="3870254">DNSNames</span><span class="op" id="3870262">,</span>&nbsp;<span class="ident" id="3870264">template</span><span class="op" id="3870272">.</span><span class="ident" id="3870273">EmailAddresses</span><span class="op" id="3870287">,</span>&nbsp;<span class="ident" id="3870289">template</span><span class="op" id="3870297">.</span><span class="ident" id="3870298">IPAddresses</span><span class="op" id="3870309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870313">if</span>&nbsp;<span class="ident" id="3870316">err</span>&nbsp;<span class="op" id="3870320">!=</span>&nbsp;<span class="ident" id="3870323">nil</span>&nbsp;<span class="op" id="3870327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870332">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870341">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870345">n</span><span class="op" id="3870346">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870354">if</span>&nbsp;<span class="builtinfunc" id="3870357">len</span><span class="op" id="3870360">(</span><span class="ident" id="3870361">template</span><span class="op" id="3870369">.</span><span class="ident" id="3870370">PolicyIdentifiers</span><span class="op" id="3870387">)</span>&nbsp;<span class="op" id="3870389">&gt;</span>&nbsp;<span class="num" id="3870391">0</span>&nbsp;<span class="op" id="3870393">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870398">!</span><span class="ident" id="3870399">oidInExtensions</span><span class="op" id="3870414">(</span><span class="ident" id="3870415">oidExtensionCertificatePolicies</span><span class="op" id="3870446">,</span>&nbsp;<span class="ident" id="3870448">template</span><span class="op" id="3870456">.</span><span class="ident" id="3870457">ExtraExtensions</span><span class="op" id="3870472">)</span>&nbsp;<span class="op" id="3870474">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870478">ret</span><span class="op" id="3870481">[</span><span class="ident" id="3870482">n</span><span class="op" id="3870483">]</span><span class="op" id="3870484">.</span><span class="ident" id="3870485">Id</span>&nbsp;<span class="op" id="3870488">=</span>&nbsp;<span class="ident" id="3870490">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870524">policies</span>&nbsp;<span class="op" id="3870533">:=</span>&nbsp;<span class="builtinfunc" id="3870536">make</span><span class="op" id="3870540">(</span><span class="op" id="3870541">[</span><span class="op" id="3870542">]</span><span class="ident" id="3870543">policyInformation</span><span class="op" id="3870560">,</span>&nbsp;<span class="builtinfunc" id="3870562">len</span><span class="op" id="3870565">(</span><span class="ident" id="3870566">template</span><span class="op" id="3870574">.</span><span class="ident" id="3870575">PolicyIdentifiers</span><span class="op" id="3870592">)</span><span class="op" id="3870593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870597">for</span>&nbsp;<span class="ident" id="3870601">i</span><span class="op" id="3870602">,</span>&nbsp;<span class="ident" id="3870604">policy</span>&nbsp;<span class="op" id="3870611">:=</span>&nbsp;<span class="keyword" id="3870614">range</span>&nbsp;<span class="ident" id="3870620">template</span><span class="op" id="3870628">.</span><span class="ident" id="3870629">PolicyIdentifiers</span>&nbsp;<span class="op" id="3870647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870652">policies</span><span class="op" id="3870660">[</span><span class="ident" id="3870661">i</span><span class="op" id="3870662">]</span><span class="op" id="3870663">.</span><span class="ident" id="3870664">Policy</span>&nbsp;<span class="op" id="3870671">=</span>&nbsp;<span class="ident" id="3870673">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870682">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870686">ret</span><span class="op" id="3870689">[</span><span class="ident" id="3870690">n</span><span class="op" id="3870691">]</span><span class="op" id="3870692">.</span><span class="ident" id="3870693">Value</span><span class="op" id="3870698">,</span>&nbsp;<span class="ident" id="3870700">err</span>&nbsp;<span class="op" id="3870704">=</span>&nbsp;<span class="ident" id="3870706">asn1</span><span class="op" id="3870710">.</span><span class="ident" id="3870711">Marshal</span><span class="op" id="3870718">(</span><span class="ident" id="3870719">policies</span><span class="op" id="3870727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870731">if</span>&nbsp;<span class="ident" id="3870734">err</span>&nbsp;<span class="op" id="3870738">!=</span>&nbsp;<span class="ident" id="3870741">nil</span>&nbsp;<span class="op" id="3870745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870750">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870763">n</span><span class="op" id="3870764">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870772">if</span>&nbsp;<span class="builtinfunc" id="3870775">len</span><span class="op" id="3870778">(</span><span class="ident" id="3870779">template</span><span class="op" id="3870787">.</span><span class="ident" id="3870788">PermittedDNSDomains</span><span class="op" id="3870807">)</span>&nbsp;<span class="op" id="3870809">&gt;</span>&nbsp;<span class="num" id="3870811">0</span>&nbsp;<span class="op" id="3870813">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870818">!</span><span class="ident" id="3870819">oidInExtensions</span><span class="op" id="3870834">(</span><span class="ident" id="3870835">oidExtensionNameConstraints</span><span class="op" id="3870862">,</span>&nbsp;<span class="ident" id="3870864">template</span><span class="op" id="3870872">.</span><span class="ident" id="3870873">ExtraExtensions</span><span class="op" id="3870888">)</span>&nbsp;<span class="op" id="3870890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870894">ret</span><span class="op" id="3870897">[</span><span class="ident" id="3870898">n</span><span class="op" id="3870899">]</span><span class="op" id="3870900">.</span><span class="ident" id="3870901">Id</span>&nbsp;<span class="op" id="3870904">=</span>&nbsp;<span class="ident" id="3870906">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870936">ret</span><span class="op" id="3870939">[</span><span class="ident" id="3870940">n</span><span class="op" id="3870941">]</span><span class="op" id="3870942">.</span><span class="ident" id="3870943">Critical</span>&nbsp;<span class="op" id="3870952">=</span>&nbsp;<span class="ident" id="3870954">template</span><span class="op" id="3870962">.</span><span class="ident" id="3870963">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870994">var</span>&nbsp;<span class="ident" id="3870998">out</span>&nbsp;<span class="ident" id="3871002">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871020">out</span><span class="op" id="3871023">.</span><span class="ident" id="3871024">Permitted</span>&nbsp;<span class="op" id="3871034">=</span>&nbsp;<span class="builtinfunc" id="3871036">make</span><span class="op" id="3871040">(</span><span class="op" id="3871041">[</span><span class="op" id="3871042">]</span><span class="ident" id="3871043">generalSubtree</span><span class="op" id="3871057">,</span>&nbsp;<span class="builtinfunc" id="3871059">len</span><span class="op" id="3871062">(</span><span class="ident" id="3871063">template</span><span class="op" id="3871071">.</span><span class="ident" id="3871072">PermittedDNSDomains</span><span class="op" id="3871091">)</span><span class="op" id="3871092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871096">for</span>&nbsp;<span class="ident" id="3871100">i</span><span class="op" id="3871101">,</span>&nbsp;<span class="ident" id="3871103">permitted</span>&nbsp;<span class="op" id="3871113">:=</span>&nbsp;<span class="keyword" id="3871116">range</span>&nbsp;<span class="ident" id="3871122">template</span><span class="op" id="3871130">.</span><span class="ident" id="3871131">PermittedDNSDomains</span>&nbsp;<span class="op" id="3871151">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871156">out</span><span class="op" id="3871159">.</span><span class="ident" id="3871160">Permitted</span><span class="op" id="3871169">[</span><span class="ident" id="3871170">i</span><span class="op" id="3871171">]</span>&nbsp;<span class="op" id="3871173">=</span>&nbsp;<span class="ident" id="3871175">generalSubtree</span><span class="op" id="3871189">{</span><span class="ident" id="3871190">Name</span><span class="op" id="3871194">:</span>&nbsp;<span class="ident" id="3871196">permitted</span><span class="op" id="3871205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871213">ret</span><span class="op" id="3871216">[</span><span class="ident" id="3871217">n</span><span class="op" id="3871218">]</span><span class="op" id="3871219">.</span><span class="ident" id="3871220">Value</span><span class="op" id="3871225">,</span>&nbsp;<span class="ident" id="3871227">err</span>&nbsp;<span class="op" id="3871231">=</span>&nbsp;<span class="ident" id="3871233">asn1</span><span class="op" id="3871237">.</span><span class="ident" id="3871238">Marshal</span><span class="op" id="3871245">(</span><span class="ident" id="3871246">out</span><span class="op" id="3871249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871253">if</span>&nbsp;<span class="ident" id="3871256">err</span>&nbsp;<span class="op" id="3871260">!=</span>&nbsp;<span class="ident" id="3871263">nil</span>&nbsp;<span class="op" id="3871267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871272">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871285">n</span><span class="op" id="3871286">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871294">if</span>&nbsp;<span class="builtinfunc" id="3871297">len</span><span class="op" id="3871300">(</span><span class="ident" id="3871301">template</span><span class="op" id="3871309">.</span><span class="ident" id="3871310">CRLDistributionPoints</span><span class="op" id="3871331">)</span>&nbsp;<span class="op" id="3871333">&gt;</span>&nbsp;<span class="num" id="3871335">0</span>&nbsp;<span class="op" id="3871337">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871342">!</span><span class="ident" id="3871343">oidInExtensions</span><span class="op" id="3871358">(</span><span class="ident" id="3871359">oidExtensionCRLDistributionPoints</span><span class="op" id="3871392">,</span>&nbsp;<span class="ident" id="3871394">template</span><span class="op" id="3871402">.</span><span class="ident" id="3871403">ExtraExtensions</span><span class="op" id="3871418">)</span>&nbsp;<span class="op" id="3871420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871424">ret</span><span class="op" id="3871427">[</span><span class="ident" id="3871428">n</span><span class="op" id="3871429">]</span><span class="op" id="3871430">.</span><span class="ident" id="3871431">Id</span>&nbsp;<span class="op" id="3871434">=</span>&nbsp;<span class="ident" id="3871436">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871473">var</span>&nbsp;<span class="ident" id="3871477">crlDp</span>&nbsp;<span class="op" id="3871483">[</span><span class="op" id="3871484">]</span><span class="ident" id="3871485">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871505">for</span>&nbsp;<span class="ident" id="3871509">_</span><span class="op" id="3871510">,</span>&nbsp;<span class="ident" id="3871512">name</span>&nbsp;<span class="op" id="3871517">:=</span>&nbsp;<span class="keyword" id="3871520">range</span>&nbsp;<span class="ident" id="3871526">template</span><span class="op" id="3871534">.</span><span class="ident" id="3871535">CRLDistributionPoints</span>&nbsp;<span class="op" id="3871557">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871562">rawFullName</span><span class="op" id="3871573">,</span>&nbsp;<span class="ident" id="3871575">_</span>&nbsp;<span class="op" id="3871577">:=</span>&nbsp;<span class="ident" id="3871580">asn1</span><span class="op" id="3871584">.</span><span class="ident" id="3871585">Marshal</span><span class="op" id="3871592">(</span><span class="ident" id="3871593">asn1</span><span class="op" id="3871597">.</span><span class="ident" id="3871598">RawValue</span><span class="op" id="3871606">{</span><span class="ident" id="3871607">Tag</span><span class="op" id="3871610">:</span>&nbsp;<span class="num" id="3871612">6</span><span class="op" id="3871613">,</span>&nbsp;<span class="ident" id="3871615">Class</span><span class="op" id="3871620">:</span>&nbsp;<span class="num" id="3871622">2</span><span class="op" id="3871623">,</span>&nbsp;<span class="ident" id="3871625">Bytes</span><span class="op" id="3871630">:</span>&nbsp;<span class="op" id="3871632">[</span><span class="op" id="3871633">]</span><span class="builtintype" id="3871634">byte</span><span class="op" id="3871638">(</span><span class="ident" id="3871639">name</span><span class="op" id="3871643">)</span><span class="op" id="3871644">}</span><span class="op" id="3871645">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871651">dp</span>&nbsp;<span class="op" id="3871654">:=</span>&nbsp;<span class="ident" id="3871657">distributionPoint</span><span class="op" id="3871674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871680">DistributionPoint</span><span class="op" id="3871697">:</span>&nbsp;<span class="ident" id="3871699">distributionPointName</span><span class="op" id="3871720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871727">FullName</span><span class="op" id="3871735">:</span>&nbsp;<span class="ident" id="3871737">asn1</span><span class="op" id="3871741">.</span><span class="ident" id="3871742">RawValue</span><span class="op" id="3871750">{</span><span class="ident" id="3871751">Tag</span><span class="op" id="3871754">:</span>&nbsp;<span class="num" id="3871756">0</span><span class="op" id="3871757">,</span>&nbsp;<span class="ident" id="3871759">Class</span><span class="op" id="3871764">:</span>&nbsp;<span class="num" id="3871766">2</span><span class="op" id="3871767">,</span>&nbsp;<span class="ident" id="3871769">IsCompound</span><span class="op" id="3871779">:</span>&nbsp;<span class="builtintype" id="3871781">true</span><span class="op" id="3871785">,</span>&nbsp;<span class="ident" id="3871787">Bytes</span><span class="op" id="3871792">:</span>&nbsp;<span class="ident" id="3871794">rawFullName</span><span class="op" id="3871805">}</span><span class="op" id="3871806">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871812">}</span><span class="op" id="3871813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871823">crlDp</span>&nbsp;<span class="op" id="3871829">=</span>&nbsp;<span class="builtinfunc" id="3871831">append</span><span class="op" id="3871837">(</span><span class="ident" id="3871838">crlDp</span><span class="op" id="3871843">,</span>&nbsp;<span class="ident" id="3871845">dp</span><span class="op" id="3871847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871856">ret</span><span class="op" id="3871859">[</span><span class="ident" id="3871860">n</span><span class="op" id="3871861">]</span><span class="op" id="3871862">.</span><span class="ident" id="3871863">Value</span><span class="op" id="3871868">,</span>&nbsp;<span class="ident" id="3871870">err</span>&nbsp;<span class="op" id="3871874">=</span>&nbsp;<span class="ident" id="3871876">asn1</span><span class="op" id="3871880">.</span><span class="ident" id="3871881">Marshal</span><span class="op" id="3871888">(</span><span class="ident" id="3871889">crlDp</span><span class="op" id="3871894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871898">if</span>&nbsp;<span class="ident" id="3871901">err</span>&nbsp;<span class="op" id="3871905">!=</span>&nbsp;<span class="ident" id="3871908">nil</span>&nbsp;<span class="op" id="3871912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871917">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871930">n</span><span class="op" id="3871931">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3871939">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3872012">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872071">return</span>&nbsp;<span class="builtinfunc" id="3872078">append</span><span class="op" id="3872084">(</span><span class="ident" id="3872085">ret</span><span class="op" id="3872088">[</span><span class="op" id="3872089">:</span><span class="ident" id="3872090">n</span><span class="op" id="3872091">]</span><span class="op" id="3872092">,</span>&nbsp;<span class="ident" id="3872094">template</span><span class="op" id="3872102">.</span><span class="ident" id="3872103">ExtraExtensions</span><span class="op" id="3872118">...</span><span class="op" id="3872121">)</span><span class="op" id="3872122">,</span>&nbsp;<span class="ident" id="3872124">nil</span><br>
<span class="lineno"></span><span class="op" id="3872128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3872131">func</span>&nbsp;<span class="ident" id="3872136">subjectBytes</span><span class="op" id="3872148">(</span><span class="ident" id="3872149">cert</span>&nbsp;<span class="op" id="3872154">*</span><span class="ident" id="3872155">Certificate</span><span class="op" id="3872166">)</span>&nbsp;<span class="op" id="3872168">(</span><span class="op" id="3872169">[</span><span class="op" id="3872170">]</span><span class="builtintype" id="3872171">byte</span><span class="op" id="3872175">,</span>&nbsp;<span class="builtintype" id="3872177">error</span><span class="op" id="3872182">)</span>&nbsp;<span class="op" id="3872184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872187">if</span>&nbsp;<span class="builtinfunc" id="3872190">len</span><span class="op" id="3872193">(</span><span class="ident" id="3872194">cert</span><span class="op" id="3872198">.</span><span class="ident" id="3872199">RawSubject</span><span class="op" id="3872209">)</span>&nbsp;<span class="op" id="3872211">&gt;</span>&nbsp;<span class="num" id="3872213">0</span>&nbsp;<span class="op" id="3872215">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872219">return</span>&nbsp;<span class="ident" id="3872226">cert</span><span class="op" id="3872230">.</span><span class="ident" id="3872231">RawSubject</span><span class="op" id="3872241">,</span>&nbsp;<span class="ident" id="3872243">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3872248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872252">return</span>&nbsp;<span class="ident" id="3872259">asn1</span><span class="op" id="3872263">.</span><span class="ident" id="3872264">Marshal</span><span class="op" id="3872271">(</span><span class="ident" id="3872272">cert</span><span class="op" id="3872276">.</span><span class="ident" id="3872277">Subject</span><span class="op" id="3872284">.</span><span class="ident" id="3872285">ToRDNSequence</span><span class="op" id="3872298">(</span><span class="op" id="3872299">)</span><span class="op" id="3872300">)</span><br>
<span class="lineno"></span><span class="op" id="3872302">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="3872305">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3872382">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="3872453">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3872477">func</span>&nbsp;<span class="ident" id="3872482">signingParamsForPrivateKey</span><span class="op" id="3872508">(</span><span class="ident" id="3872509">priv</span>&nbsp;<span class="keyword" id="3872514">interface</span><span class="op" id="3872523">{</span><span class="op" id="3872524">}</span><span class="op" id="3872525">,</span>&nbsp;<span class="ident" id="3872527">requestedSigAlgo</span>&nbsp;<span class="ident" id="3872544">SignatureAlgorithm</span><span class="op" id="3872562">)</span>&nbsp;<span class="op" id="3872564">(</span><span class="ident" id="3872565">hashFunc</span>&nbsp;<span class="ident" id="3872574">crypto</span><span class="op" id="3872580">.</span><span class="ident" id="3872581">Hash</span><span class="op" id="3872585">,</span>&nbsp;<span class="ident" id="3872587">sigAlgo</span>&nbsp;<span class="ident" id="3872595">pkix</span><span class="op" id="3872599">.</span><span class="ident" id="3872600">AlgorithmIdentifier</span><span class="op" id="3872619">,</span>&nbsp;<span class="ident" id="3872621">err</span>&nbsp;<span class="builtintype" id="3872625">error</span><span class="op" id="3872630">)</span>&nbsp;<span class="op" id="3872632">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872635">var</span>&nbsp;<span class="ident" id="3872639">pubType</span>&nbsp;<span class="ident" id="3872647">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872668">switch</span>&nbsp;<span class="ident" id="3872675">priv</span>&nbsp;<span class="op" id="3872680">:=</span>&nbsp;<span class="ident" id="3872683">priv</span><span class="op" id="3872687">.</span><span class="op" id="3872688">(</span><span class="keyword" id="3872689">type</span><span class="op" id="3872693">)</span>&nbsp;<span class="op" id="3872695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872698">case</span>&nbsp;<span class="op" id="3872703">*</span><span class="ident" id="3872704">rsa</span><span class="op" id="3872707">.</span><span class="ident" id="3872708">PrivateKey</span><span class="op" id="3872718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872722">pubType</span>&nbsp;<span class="op" id="3872730">=</span>&nbsp;<span class="ident" id="3872732">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872738">sigAlgo</span><span class="op" id="3872745">.</span><span class="ident" id="3872746">Algorithm</span>&nbsp;<span class="op" id="3872756">=</span>&nbsp;<span class="ident" id="3872758">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872786">hashFunc</span>&nbsp;<span class="op" id="3872795">=</span>&nbsp;<span class="ident" id="3872797">crypto</span><span class="op" id="3872803">.</span><span class="ident" id="3872804">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872813">case</span>&nbsp;<span class="op" id="3872818">*</span><span class="ident" id="3872819">ecdsa</span><span class="op" id="3872824">.</span><span class="ident" id="3872825">PrivateKey</span><span class="op" id="3872835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872839">pubType</span>&nbsp;<span class="op" id="3872847">=</span>&nbsp;<span class="ident" id="3872849">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872858">switch</span>&nbsp;<span class="ident" id="3872865">priv</span><span class="op" id="3872869">.</span><span class="ident" id="3872870">Curve</span>&nbsp;<span class="op" id="3872876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872880">case</span>&nbsp;<span class="ident" id="3872885">elliptic</span><span class="op" id="3872893">.</span><span class="ident" id="3872894">P224</span><span class="op" id="3872898">(</span><span class="op" id="3872899">)</span><span class="op" id="3872900">,</span>&nbsp;<span class="ident" id="3872902">elliptic</span><span class="op" id="3872910">.</span><span class="ident" id="3872911">P256</span><span class="op" id="3872915">(</span><span class="op" id="3872916">)</span><span class="op" id="3872917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872922">hashFunc</span>&nbsp;<span class="op" id="3872931">=</span>&nbsp;<span class="ident" id="3872933">crypto</span><span class="op" id="3872939">.</span><span class="ident" id="3872940">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872950">sigAlgo</span><span class="op" id="3872957">.</span><span class="ident" id="3872958">Algorithm</span>&nbsp;<span class="op" id="3872968">=</span>&nbsp;<span class="ident" id="3872970">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873000">case</span>&nbsp;<span class="ident" id="3873005">elliptic</span><span class="op" id="3873013">.</span><span class="ident" id="3873014">P384</span><span class="op" id="3873018">(</span><span class="op" id="3873019">)</span><span class="op" id="3873020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873025">hashFunc</span>&nbsp;<span class="op" id="3873034">=</span>&nbsp;<span class="ident" id="3873036">crypto</span><span class="op" id="3873042">.</span><span class="ident" id="3873043">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873053">sigAlgo</span><span class="op" id="3873060">.</span><span class="ident" id="3873061">Algorithm</span>&nbsp;<span class="op" id="3873071">=</span>&nbsp;<span class="ident" id="3873073">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873103">case</span>&nbsp;<span class="ident" id="3873108">elliptic</span><span class="op" id="3873116">.</span><span class="ident" id="3873117">P521</span><span class="op" id="3873121">(</span><span class="op" id="3873122">)</span><span class="op" id="3873123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873128">hashFunc</span>&nbsp;<span class="op" id="3873137">=</span>&nbsp;<span class="ident" id="3873139">crypto</span><span class="op" id="3873145">.</span><span class="ident" id="3873146">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873156">sigAlgo</span><span class="op" id="3873163">.</span><span class="ident" id="3873164">Algorithm</span>&nbsp;<span class="op" id="3873174">=</span>&nbsp;<span class="ident" id="3873176">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873206">default</span><span class="op" id="3873213">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873218">err</span>&nbsp;<span class="op" id="3873222">=</span>&nbsp;<span class="ident" id="3873224">errors</span><span class="op" id="3873230">.</span><span class="ident" id="3873231">New</span><span class="op" id="3873234">(</span><span class="string" id="3873235">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3873265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873273">default</span><span class="op" id="3873280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873284">err</span>&nbsp;<span class="op" id="3873288">=</span>&nbsp;<span class="ident" id="3873290">errors</span><span class="op" id="3873296">.</span><span class="ident" id="3873297">New</span><span class="op" id="3873300">(</span><span class="string" id="3873301">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="3873350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873357">if</span>&nbsp;<span class="ident" id="3873360">err</span>&nbsp;<span class="op" id="3873364">!=</span>&nbsp;<span class="ident" id="3873367">nil</span>&nbsp;<span class="op" id="3873371">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873375">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873387">if</span>&nbsp;<span class="ident" id="3873390">requestedSigAlgo</span>&nbsp;<span class="op" id="3873407">==</span>&nbsp;<span class="num" id="3873410">0</span>&nbsp;<span class="op" id="3873412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873416">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873428">found</span>&nbsp;<span class="op" id="3873434">:=</span>&nbsp;<span class="builtintype" id="3873437">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873444">for</span>&nbsp;<span class="ident" id="3873448">_</span><span class="op" id="3873449">,</span>&nbsp;<span class="ident" id="3873451">details</span>&nbsp;<span class="op" id="3873459">:=</span>&nbsp;<span class="keyword" id="3873462">range</span>&nbsp;<span class="ident" id="3873468">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3873494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873498">if</span>&nbsp;<span class="ident" id="3873501">details</span><span class="op" id="3873508">.</span><span class="ident" id="3873509">algo</span>&nbsp;<span class="op" id="3873514">==</span>&nbsp;<span class="ident" id="3873517">requestedSigAlgo</span>&nbsp;<span class="op" id="3873534">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873539">if</span>&nbsp;<span class="ident" id="3873542">details</span><span class="op" id="3873549">.</span><span class="ident" id="3873550">pubKeyAlgo</span>&nbsp;<span class="op" id="3873561">!=</span>&nbsp;<span class="ident" id="3873564">pubType</span>&nbsp;<span class="op" id="3873572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873578">err</span>&nbsp;<span class="op" id="3873582">=</span>&nbsp;<span class="ident" id="3873584">errors</span><span class="op" id="3873590">.</span><span class="ident" id="3873591">New</span><span class="op" id="3873594">(</span><span class="string" id="3873595">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="3873663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873684">sigAlgo</span><span class="op" id="3873691">.</span><span class="ident" id="3873692">Algorithm</span><span class="op" id="3873701">,</span>&nbsp;<span class="ident" id="3873703">hashFunc</span>&nbsp;<span class="op" id="3873712">=</span>&nbsp;<span class="ident" id="3873714">details</span><span class="op" id="3873721">.</span><span class="ident" id="3873722">oid</span><span class="op" id="3873725">,</span>&nbsp;<span class="ident" id="3873727">details</span><span class="op" id="3873734">.</span><span class="ident" id="3873735">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873743">if</span>&nbsp;<span class="ident" id="3873746">hashFunc</span>&nbsp;<span class="op" id="3873755">==</span>&nbsp;<span class="num" id="3873758">0</span>&nbsp;<span class="op" id="3873760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873766">err</span>&nbsp;<span class="op" id="3873770">=</span>&nbsp;<span class="ident" id="3873772">errors</span><span class="op" id="3873778">.</span><span class="ident" id="3873779">New</span><span class="op" id="3873782">(</span><span class="string" id="3873783">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="3873831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873852">found</span>&nbsp;<span class="op" id="3873858">=</span>&nbsp;<span class="builtintype" id="3873860">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873868">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873883">if</span>&nbsp;<span class="op" id="3873886">!</span><span class="ident" id="3873887">found</span>&nbsp;<span class="op" id="3873893">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873897">err</span>&nbsp;<span class="op" id="3873901">=</span>&nbsp;<span class="ident" id="3873903">errors</span><span class="op" id="3873909">.</span><span class="ident" id="3873910">New</span><span class="op" id="3873913">(</span><span class="string" id="3873914">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="3873948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873955">return</span><br>
<span class="lineno"></span><span class="op" id="3873962">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="3873965">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3874037">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="3874114">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="3874193">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="3874267">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="3874311">//</span><br>
<span class="lineno"></span><span class="comment" id="3874314">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3874394">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3874468">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="3874521">//</span><br>
<span class="lineno"></span><span class="comment" id="3874524">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="3874582">//</span><br>
<span class="lineno"></span><span class="comment" id="3874585">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3874654">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="3874731">func</span>&nbsp;<span class="ident" id="3874736">CreateCertificate</span><span class="op" id="3874753">(</span><span class="ident" id="3874754">rand</span>&nbsp;<span class="ident" id="3874759">io</span><span class="op" id="3874761">.</span><span class="ident" id="3874762">Reader</span><span class="op" id="3874768">,</span>&nbsp;<span class="ident" id="3874770">template</span><span class="op" id="3874778">,</span>&nbsp;<span class="ident" id="3874780">parent</span>&nbsp;<span class="op" id="3874787">*</span><span class="ident" id="3874788">Certificate</span><span class="op" id="3874799">,</span>&nbsp;<span class="ident" id="3874801">pub</span>&nbsp;<span class="keyword" id="3874805">interface</span><span class="op" id="3874814">{</span><span class="op" id="3874815">}</span><span class="op" id="3874816">,</span>&nbsp;<span class="ident" id="3874818">priv</span>&nbsp;<span class="keyword" id="3874823">interface</span><span class="op" id="3874832">{</span><span class="op" id="3874833">}</span><span class="op" id="3874834">)</span>&nbsp;<span class="op" id="3874836">(</span><span class="ident" id="3874837">cert</span>&nbsp;<span class="op" id="3874842">[</span><span class="op" id="3874843">]</span><span class="builtintype" id="3874844">byte</span><span class="op" id="3874848">,</span>&nbsp;<span class="ident" id="3874850">err</span>&nbsp;<span class="builtintype" id="3874854">error</span><span class="op" id="3874859">)</span>&nbsp;<span class="op" id="3874861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874864">hashFunc</span><span class="op" id="3874872">,</span>&nbsp;<span class="ident" id="3874874">signatureAlgorithm</span><span class="op" id="3874892">,</span>&nbsp;<span class="ident" id="3874894">err</span>&nbsp;<span class="op" id="3874898">:=</span>&nbsp;<span class="ident" id="3874901">signingParamsForPrivateKey</span><span class="op" id="3874927">(</span><span class="ident" id="3874928">priv</span><span class="op" id="3874932">,</span>&nbsp;<span class="ident" id="3874934">template</span><span class="op" id="3874942">.</span><span class="ident" id="3874943">SignatureAlgorithm</span><span class="op" id="3874961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874964">if</span>&nbsp;<span class="ident" id="3874967">err</span>&nbsp;<span class="op" id="3874971">!=</span>&nbsp;<span class="ident" id="3874974">nil</span>&nbsp;<span class="op" id="3874978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874982">return</span>&nbsp;<span class="ident" id="3874989">nil</span><span class="op" id="3874992">,</span>&nbsp;<span class="ident" id="3874994">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874999">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875003">publicKeyBytes</span><span class="op" id="3875017">,</span>&nbsp;<span class="ident" id="3875019">publicKeyAlgorithm</span><span class="op" id="3875037">,</span>&nbsp;<span class="ident" id="3875039">err</span>&nbsp;<span class="op" id="3875043">:=</span>&nbsp;<span class="ident" id="3875046">marshalPublicKey</span><span class="op" id="3875062">(</span><span class="ident" id="3875063">pub</span><span class="op" id="3875066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875069">if</span>&nbsp;<span class="ident" id="3875072">err</span>&nbsp;<span class="op" id="3875076">!=</span>&nbsp;<span class="ident" id="3875079">nil</span>&nbsp;<span class="op" id="3875083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875087">return</span>&nbsp;<span class="ident" id="3875094">nil</span><span class="op" id="3875097">,</span>&nbsp;<span class="ident" id="3875099">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875104">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875108">if</span>&nbsp;<span class="ident" id="3875111">err</span>&nbsp;<span class="op" id="3875115">!=</span>&nbsp;<span class="ident" id="3875118">nil</span>&nbsp;<span class="op" id="3875122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875126">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875138">if</span>&nbsp;<span class="builtinfunc" id="3875141">len</span><span class="op" id="3875144">(</span><span class="ident" id="3875145">parent</span><span class="op" id="3875151">.</span><span class="ident" id="3875152">SubjectKeyId</span><span class="op" id="3875164">)</span>&nbsp;<span class="op" id="3875166">&gt;</span>&nbsp;<span class="num" id="3875168">0</span>&nbsp;<span class="op" id="3875170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875174">template</span><span class="op" id="3875182">.</span><span class="ident" id="3875183">AuthorityKeyId</span>&nbsp;<span class="op" id="3875198">=</span>&nbsp;<span class="ident" id="3875200">parent</span><span class="op" id="3875206">.</span><span class="ident" id="3875207">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875225">extensions</span><span class="op" id="3875235">,</span>&nbsp;<span class="ident" id="3875237">err</span>&nbsp;<span class="op" id="3875241">:=</span>&nbsp;<span class="ident" id="3875244">buildExtensions</span><span class="op" id="3875259">(</span><span class="ident" id="3875260">template</span><span class="op" id="3875268">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875271">if</span>&nbsp;<span class="ident" id="3875274">err</span>&nbsp;<span class="op" id="3875278">!=</span>&nbsp;<span class="ident" id="3875281">nil</span>&nbsp;<span class="op" id="3875285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875289">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875301">asn1Issuer</span><span class="op" id="3875311">,</span>&nbsp;<span class="ident" id="3875313">err</span>&nbsp;<span class="op" id="3875317">:=</span>&nbsp;<span class="ident" id="3875320">subjectBytes</span><span class="op" id="3875332">(</span><span class="ident" id="3875333">parent</span><span class="op" id="3875339">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875342">if</span>&nbsp;<span class="ident" id="3875345">err</span>&nbsp;<span class="op" id="3875349">!=</span>&nbsp;<span class="ident" id="3875352">nil</span>&nbsp;<span class="op" id="3875356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875372">asn1Subject</span><span class="op" id="3875383">,</span>&nbsp;<span class="ident" id="3875385">err</span>&nbsp;<span class="op" id="3875389">:=</span>&nbsp;<span class="ident" id="3875392">subjectBytes</span><span class="op" id="3875404">(</span><span class="ident" id="3875405">template</span><span class="op" id="3875413">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875416">if</span>&nbsp;<span class="ident" id="3875419">err</span>&nbsp;<span class="op" id="3875423">!=</span>&nbsp;<span class="ident" id="3875426">nil</span>&nbsp;<span class="op" id="3875430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875434">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875446">encodedPublicKey</span>&nbsp;<span class="op" id="3875463">:=</span>&nbsp;<span class="ident" id="3875466">asn1</span><span class="op" id="3875470">.</span><span class="ident" id="3875471">BitString</span><span class="op" id="3875480">{</span><span class="ident" id="3875481">BitLength</span><span class="op" id="3875490">:</span>&nbsp;<span class="builtinfunc" id="3875492">len</span><span class="op" id="3875495">(</span><span class="ident" id="3875496">publicKeyBytes</span><span class="op" id="3875510">)</span>&nbsp;<span class="op" id="3875512">*</span>&nbsp;<span class="num" id="3875514">8</span><span class="op" id="3875515">,</span>&nbsp;<span class="ident" id="3875517">Bytes</span><span class="op" id="3875522">:</span>&nbsp;<span class="ident" id="3875524">publicKeyBytes</span><span class="op" id="3875538">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875541">c</span>&nbsp;<span class="op" id="3875543">:=</span>&nbsp;<span class="ident" id="3875546">tbsCertificate</span><span class="op" id="3875560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875564">Version</span><span class="op" id="3875571">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3875584">2</span><span class="op" id="3875585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875589">SerialNumber</span><span class="op" id="3875601">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875609">template</span><span class="op" id="3875617">.</span><span class="ident" id="3875618">SerialNumber</span><span class="op" id="3875630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875634">SignatureAlgorithm</span><span class="op" id="3875652">:</span>&nbsp;<span class="ident" id="3875654">signatureAlgorithm</span><span class="op" id="3875672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875676">Issuer</span><span class="op" id="3875682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875696">asn1</span><span class="op" id="3875700">.</span><span class="ident" id="3875701">RawValue</span><span class="op" id="3875709">{</span><span class="ident" id="3875710">FullBytes</span><span class="op" id="3875719">:</span>&nbsp;<span class="ident" id="3875721">asn1Issuer</span><span class="op" id="3875731">}</span><span class="op" id="3875732">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875736">Validity</span><span class="op" id="3875744">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875756">validity</span><span class="op" id="3875764">{</span><span class="ident" id="3875765">template</span><span class="op" id="3875773">.</span><span class="ident" id="3875774">NotBefore</span><span class="op" id="3875783">.</span><span class="ident" id="3875784">UTC</span><span class="op" id="3875787">(</span><span class="op" id="3875788">)</span><span class="op" id="3875789">,</span>&nbsp;<span class="ident" id="3875791">template</span><span class="op" id="3875799">.</span><span class="ident" id="3875800">NotAfter</span><span class="op" id="3875808">.</span><span class="ident" id="3875809">UTC</span><span class="op" id="3875812">(</span><span class="op" id="3875813">)</span><span class="op" id="3875814">}</span><span class="op" id="3875815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875819">Subject</span><span class="op" id="3875826">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875839">asn1</span><span class="op" id="3875843">.</span><span class="ident" id="3875844">RawValue</span><span class="op" id="3875852">{</span><span class="ident" id="3875853">FullBytes</span><span class="op" id="3875862">:</span>&nbsp;<span class="ident" id="3875864">asn1Subject</span><span class="op" id="3875875">}</span><span class="op" id="3875876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875880">PublicKey</span><span class="op" id="3875889">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875900">publicKeyInfo</span><span class="op" id="3875913">{</span><span class="ident" id="3875914">nil</span><span class="op" id="3875917">,</span>&nbsp;<span class="ident" id="3875919">publicKeyAlgorithm</span><span class="op" id="3875937">,</span>&nbsp;<span class="ident" id="3875939">encodedPublicKey</span><span class="op" id="3875955">}</span><span class="op" id="3875956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875960">Extensions</span><span class="op" id="3875970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875980">extensions</span><span class="op" id="3875990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875993">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875997">tbsCertContents</span><span class="op" id="3876012">,</span>&nbsp;<span class="ident" id="3876014">err</span>&nbsp;<span class="op" id="3876018">:=</span>&nbsp;<span class="ident" id="3876021">asn1</span><span class="op" id="3876025">.</span><span class="ident" id="3876026">Marshal</span><span class="op" id="3876033">(</span><span class="ident" id="3876034">c</span><span class="op" id="3876035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876038">if</span>&nbsp;<span class="ident" id="3876041">err</span>&nbsp;<span class="op" id="3876045">!=</span>&nbsp;<span class="ident" id="3876048">nil</span>&nbsp;<span class="op" id="3876052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876056">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876064">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876068">c</span><span class="op" id="3876069">.</span><span class="ident" id="3876070">Raw</span>&nbsp;<span class="op" id="3876074">=</span>&nbsp;<span class="ident" id="3876076">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876094">h</span>&nbsp;<span class="op" id="3876096">:=</span>&nbsp;<span class="ident" id="3876099">hashFunc</span><span class="op" id="3876107">.</span><span class="ident" id="3876108">New</span><span class="op" id="3876111">(</span><span class="op" id="3876112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876115">h</span><span class="op" id="3876116">.</span><span class="ident" id="3876117">Write</span><span class="op" id="3876122">(</span><span class="ident" id="3876123">tbsCertContents</span><span class="op" id="3876138">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876141">digest</span>&nbsp;<span class="op" id="3876148">:=</span>&nbsp;<span class="ident" id="3876151">h</span><span class="op" id="3876152">.</span><span class="ident" id="3876153">Sum</span><span class="op" id="3876156">(</span><span class="ident" id="3876157">nil</span><span class="op" id="3876160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876164">var</span>&nbsp;<span class="ident" id="3876168">signature</span>&nbsp;<span class="op" id="3876178">[</span><span class="op" id="3876179">]</span><span class="builtintype" id="3876180">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876187">switch</span>&nbsp;<span class="ident" id="3876194">priv</span>&nbsp;<span class="op" id="3876199">:=</span>&nbsp;<span class="ident" id="3876202">priv</span><span class="op" id="3876206">.</span><span class="op" id="3876207">(</span><span class="keyword" id="3876208">type</span><span class="op" id="3876212">)</span>&nbsp;<span class="op" id="3876214">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876217">case</span>&nbsp;<span class="op" id="3876222">*</span><span class="ident" id="3876223">rsa</span><span class="op" id="3876226">.</span><span class="ident" id="3876227">PrivateKey</span><span class="op" id="3876237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876241">signature</span><span class="op" id="3876250">,</span>&nbsp;<span class="ident" id="3876252">err</span>&nbsp;<span class="op" id="3876256">=</span>&nbsp;<span class="ident" id="3876258">rsa</span><span class="op" id="3876261">.</span><span class="ident" id="3876262">SignPKCS1v15</span><span class="op" id="3876274">(</span><span class="ident" id="3876275">rand</span><span class="op" id="3876279">,</span>&nbsp;<span class="ident" id="3876281">priv</span><span class="op" id="3876285">,</span>&nbsp;<span class="ident" id="3876287">hashFunc</span><span class="op" id="3876295">,</span>&nbsp;<span class="ident" id="3876297">digest</span><span class="op" id="3876303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876306">case</span>&nbsp;<span class="op" id="3876311">*</span><span class="ident" id="3876312">ecdsa</span><span class="op" id="3876317">.</span><span class="ident" id="3876318">PrivateKey</span><span class="op" id="3876328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876332">var</span>&nbsp;<span class="ident" id="3876336">r</span><span class="op" id="3876337">,</span>&nbsp;<span class="ident" id="3876339">s</span>&nbsp;<span class="op" id="3876341">*</span><span class="ident" id="3876342">big</span><span class="op" id="3876345">.</span><span class="ident" id="3876346">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876352">if</span>&nbsp;<span class="ident" id="3876355">r</span><span class="op" id="3876356">,</span>&nbsp;<span class="ident" id="3876358">s</span><span class="op" id="3876359">,</span>&nbsp;<span class="ident" id="3876361">err</span>&nbsp;<span class="op" id="3876365">=</span>&nbsp;<span class="ident" id="3876367">ecdsa</span><span class="op" id="3876372">.</span><span class="ident" id="3876373">Sign</span><span class="op" id="3876377">(</span><span class="ident" id="3876378">rand</span><span class="op" id="3876382">,</span>&nbsp;<span class="ident" id="3876384">priv</span><span class="op" id="3876388">,</span>&nbsp;<span class="ident" id="3876390">digest</span><span class="op" id="3876396">)</span><span class="op" id="3876397">;</span>&nbsp;<span class="ident" id="3876399">err</span>&nbsp;<span class="op" id="3876403">==</span>&nbsp;<span class="ident" id="3876406">nil</span>&nbsp;<span class="op" id="3876410">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876415">signature</span><span class="op" id="3876424">,</span>&nbsp;<span class="ident" id="3876426">err</span>&nbsp;<span class="op" id="3876430">=</span>&nbsp;<span class="ident" id="3876432">asn1</span><span class="op" id="3876436">.</span><span class="ident" id="3876437">Marshal</span><span class="op" id="3876444">(</span><span class="ident" id="3876445">ecdsaSignature</span><span class="op" id="3876459">{</span><span class="ident" id="3876460">r</span><span class="op" id="3876461">,</span>&nbsp;<span class="ident" id="3876463">s</span><span class="op" id="3876464">}</span><span class="op" id="3876465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876472">default</span><span class="op" id="3876479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3876483">panic</span><span class="op" id="3876488">(</span><span class="string" id="3876489">&#34;internal&nbsp;error&#34;</span><span class="op" id="3876505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876508">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876512">if</span>&nbsp;<span class="ident" id="3876515">err</span>&nbsp;<span class="op" id="3876519">!=</span>&nbsp;<span class="ident" id="3876522">nil</span>&nbsp;<span class="op" id="3876526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876530">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876542">cert</span><span class="op" id="3876546">,</span>&nbsp;<span class="ident" id="3876548">err</span>&nbsp;<span class="op" id="3876552">=</span>&nbsp;<span class="ident" id="3876554">asn1</span><span class="op" id="3876558">.</span><span class="ident" id="3876559">Marshal</span><span class="op" id="3876566">(</span><span class="ident" id="3876567">certificate</span><span class="op" id="3876578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876582">nil</span><span class="op" id="3876585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876589">c</span><span class="op" id="3876590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876594">signatureAlgorithm</span><span class="op" id="3876612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876616">asn1</span><span class="op" id="3876620">.</span><span class="ident" id="3876621">BitString</span><span class="op" id="3876630">{</span><span class="ident" id="3876631">Bytes</span><span class="op" id="3876636">:</span>&nbsp;<span class="ident" id="3876638">signature</span><span class="op" id="3876647">,</span>&nbsp;<span class="ident" id="3876649">BitLength</span><span class="op" id="3876658">:</span>&nbsp;<span class="builtinfunc" id="3876660">len</span><span class="op" id="3876663">(</span><span class="ident" id="3876664">signature</span><span class="op" id="3876673">)</span>&nbsp;<span class="op" id="3876675">*</span>&nbsp;<span class="num" id="3876677">8</span><span class="op" id="3876678">}</span><span class="op" id="3876679">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876682">}</span><span class="op" id="3876683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876686">return</span><br>
<span class="lineno"></span><span class="op" id="3876693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876696">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="3876774">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="3876782">var</span>&nbsp;<span class="ident" id="3876786">pemCRLPrefix</span>&nbsp;<span class="op" id="3876799">=</span>&nbsp;<span class="op" id="3876801">[</span><span class="op" id="3876802">]</span><span class="builtintype" id="3876803">byte</span><span class="op" id="3876807">(</span><span class="string" id="3876808">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="3876829">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876832">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="3876877">var</span>&nbsp;<span class="ident" id="3876881">pemType</span>&nbsp;<span class="op" id="3876889">=</span>&nbsp;<span class="string" id="3876891">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="3876903">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="3876979">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="3877058">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="3877135">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="3877147">func</span>&nbsp;<span class="ident" id="3877152">ParseCRL</span><span class="op" id="3877160">(</span><span class="ident" id="3877161">crlBytes</span>&nbsp;<span class="op" id="3877170">[</span><span class="op" id="3877171">]</span><span class="builtintype" id="3877172">byte</span><span class="op" id="3877176">)</span>&nbsp;<span class="op" id="3877178">(</span><span class="ident" id="3877179">certList</span>&nbsp;<span class="op" id="3877188">*</span><span class="ident" id="3877189">pkix</span><span class="op" id="3877193">.</span><span class="ident" id="3877194">CertificateList</span><span class="op" id="3877209">,</span>&nbsp;<span class="ident" id="3877211">err</span>&nbsp;<span class="builtintype" id="3877215">error</span><span class="op" id="3877220">)</span>&nbsp;<span class="op" id="3877222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877225">if</span>&nbsp;<span class="ident" id="3877228">bytes</span><span class="op" id="3877233">.</span><span class="ident" id="3877234">HasPrefix</span><span class="op" id="3877243">(</span><span class="ident" id="3877244">crlBytes</span><span class="op" id="3877252">,</span>&nbsp;<span class="ident" id="3877254">pemCRLPrefix</span><span class="op" id="3877266">)</span>&nbsp;<span class="op" id="3877268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877272">block</span><span class="op" id="3877277">,</span>&nbsp;<span class="ident" id="3877279">_</span>&nbsp;<span class="op" id="3877281">:=</span>&nbsp;<span class="ident" id="3877284">pem</span><span class="op" id="3877287">.</span><span class="ident" id="3877288">Decode</span><span class="op" id="3877294">(</span><span class="ident" id="3877295">crlBytes</span><span class="op" id="3877303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877307">if</span>&nbsp;<span class="ident" id="3877310">block</span>&nbsp;<span class="op" id="3877316">!=</span>&nbsp;<span class="ident" id="3877319">nil</span>&nbsp;<span class="op" id="3877323">&amp;&amp;</span>&nbsp;<span class="ident" id="3877326">block</span><span class="op" id="3877331">.</span><span class="ident" id="3877332">Type</span>&nbsp;<span class="op" id="3877337">==</span>&nbsp;<span class="ident" id="3877340">pemType</span>&nbsp;<span class="op" id="3877348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877353">crlBytes</span>&nbsp;<span class="op" id="3877362">=</span>&nbsp;<span class="ident" id="3877364">block</span><span class="op" id="3877369">.</span><span class="ident" id="3877370">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877384">return</span>&nbsp;<span class="ident" id="3877391">ParseDERCRL</span><span class="op" id="3877402">(</span><span class="ident" id="3877403">crlBytes</span><span class="op" id="3877411">)</span><br>
<span class="lineno"></span><span class="op" id="3877413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="3877416">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3877478">func</span>&nbsp;<span class="ident" id="3877483">ParseDERCRL</span><span class="op" id="3877494">(</span><span class="ident" id="3877495">derBytes</span>&nbsp;<span class="op" id="3877504">[</span><span class="op" id="3877505">]</span><span class="builtintype" id="3877506">byte</span><span class="op" id="3877510">)</span>&nbsp;<span class="op" id="3877512">(</span><span class="ident" id="3877513">certList</span>&nbsp;<span class="op" id="3877522">*</span><span class="ident" id="3877523">pkix</span><span class="op" id="3877527">.</span><span class="ident" id="3877528">CertificateList</span><span class="op" id="3877543">,</span>&nbsp;<span class="ident" id="3877545">err</span>&nbsp;<span class="builtintype" id="3877549">error</span><span class="op" id="3877554">)</span>&nbsp;<span class="op" id="3877556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877559">certList</span>&nbsp;<span class="op" id="3877568">=</span>&nbsp;<span class="builtinfunc" id="3877570">new</span><span class="op" id="3877573">(</span><span class="ident" id="3877574">pkix</span><span class="op" id="3877578">.</span><span class="ident" id="3877579">CertificateList</span><span class="op" id="3877594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877597">_</span><span class="op" id="3877598">,</span>&nbsp;<span class="ident" id="3877600">err</span>&nbsp;<span class="op" id="3877604">=</span>&nbsp;<span class="ident" id="3877606">asn1</span><span class="op" id="3877610">.</span><span class="ident" id="3877611">Unmarshal</span><span class="op" id="3877620">(</span><span class="ident" id="3877621">derBytes</span><span class="op" id="3877629">,</span>&nbsp;<span class="ident" id="3877631">certList</span><span class="op" id="3877639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877642">if</span>&nbsp;<span class="ident" id="3877645">err</span>&nbsp;<span class="op" id="3877649">!=</span>&nbsp;<span class="ident" id="3877652">nil</span>&nbsp;<span class="op" id="3877656">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877660">certList</span>&nbsp;<span class="op" id="3877669">=</span>&nbsp;<span class="ident" id="3877671">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877679">return</span><br>
<span class="lineno"></span><span class="op" id="3877686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="3877689">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3877762">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="3877814">//</span><br>
<span class="lineno"></span><span class="comment" id="3877817">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="3877883">func</span>&nbsp;<span class="op" id="3877888">(</span><span class="ident" id="3877889">c</span>&nbsp;<span class="op" id="3877891">*</span><span class="ident" id="3877892">Certificate</span><span class="op" id="3877903">)</span>&nbsp;<span class="ident" id="3877905">CreateCRL</span><span class="op" id="3877914">(</span><span class="ident" id="3877915">rand</span>&nbsp;<span class="ident" id="3877920">io</span><span class="op" id="3877922">.</span><span class="ident" id="3877923">Reader</span><span class="op" id="3877929">,</span>&nbsp;<span class="ident" id="3877931">priv</span>&nbsp;<span class="keyword" id="3877936">interface</span><span class="op" id="3877945">{</span><span class="op" id="3877946">}</span><span class="op" id="3877947">,</span>&nbsp;<span class="ident" id="3877949">revokedCerts</span>&nbsp;<span class="op" id="3877962">[</span><span class="op" id="3877963">]</span><span class="ident" id="3877964">pkix</span><span class="op" id="3877968">.</span><span class="ident" id="3877969">RevokedCertificate</span><span class="op" id="3877987">,</span>&nbsp;<span class="ident" id="3877989">now</span><span class="op" id="3877992">,</span>&nbsp;<span class="ident" id="3877994">expiry</span>&nbsp;<span class="ident" id="3878001">time</span><span class="op" id="3878005">.</span><span class="ident" id="3878006">Time</span><span class="op" id="3878010">)</span>&nbsp;<span class="op" id="3878012">(</span><span class="ident" id="3878013">crlBytes</span>&nbsp;<span class="op" id="3878022">[</span><span class="op" id="3878023">]</span><span class="builtintype" id="3878024">byte</span><span class="op" id="3878028">,</span>&nbsp;<span class="ident" id="3878030">err</span>&nbsp;<span class="builtintype" id="3878034">error</span><span class="op" id="3878039">)</span>&nbsp;<span class="op" id="3878041">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878044">rsaPriv</span><span class="op" id="3878051">,</span>&nbsp;<span class="ident" id="3878053">ok</span>&nbsp;<span class="op" id="3878056">:=</span>&nbsp;<span class="ident" id="3878059">priv</span><span class="op" id="3878063">.</span><span class="op" id="3878064">(</span><span class="op" id="3878065">*</span><span class="ident" id="3878066">rsa</span><span class="op" id="3878069">.</span><span class="ident" id="3878070">PrivateKey</span><span class="op" id="3878080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878083">if</span>&nbsp;<span class="op" id="3878086">!</span><span class="ident" id="3878087">ok</span>&nbsp;<span class="op" id="3878090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878094">return</span>&nbsp;<span class="ident" id="3878101">nil</span><span class="op" id="3878104">,</span>&nbsp;<span class="ident" id="3878106">errors</span><span class="op" id="3878112">.</span><span class="ident" id="3878113">New</span><span class="op" id="3878116">(</span><span class="string" id="3878117">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3878159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878165">tbsCertList</span>&nbsp;<span class="op" id="3878177">:=</span>&nbsp;<span class="ident" id="3878180">pkix</span><span class="op" id="3878184">.</span><span class="ident" id="3878185">TBSCertificateList</span><span class="op" id="3878203">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878207">Version</span><span class="op" id="3878214">:</span>&nbsp;<span class="num" id="3878216">2</span><span class="op" id="3878217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878221">Signature</span><span class="op" id="3878230">:</span>&nbsp;<span class="ident" id="3878232">pkix</span><span class="op" id="3878236">.</span><span class="ident" id="3878237">AlgorithmIdentifier</span><span class="op" id="3878256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878261">Algorithm</span><span class="op" id="3878270">:</span>&nbsp;<span class="ident" id="3878272">oidSignatureSHA1WithRSA</span><span class="op" id="3878295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878299">}</span><span class="op" id="3878300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878304">Issuer</span><span class="op" id="3878310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878325">c</span><span class="op" id="3878326">.</span><span class="ident" id="3878327">Subject</span><span class="op" id="3878334">.</span><span class="ident" id="3878335">ToRDNSequence</span><span class="op" id="3878348">(</span><span class="op" id="3878349">)</span><span class="op" id="3878350">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878354">ThisUpdate</span><span class="op" id="3878364">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878375">now</span><span class="op" id="3878378">.</span><span class="ident" id="3878379">UTC</span><span class="op" id="3878382">(</span><span class="op" id="3878383">)</span><span class="op" id="3878384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878388">NextUpdate</span><span class="op" id="3878398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878409">expiry</span><span class="op" id="3878415">.</span><span class="ident" id="3878416">UTC</span><span class="op" id="3878419">(</span><span class="op" id="3878420">)</span><span class="op" id="3878421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878425">RevokedCertificates</span><span class="op" id="3878444">:</span>&nbsp;<span class="ident" id="3878446">revokedCerts</span><span class="op" id="3878458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878465">tbsCertListContents</span><span class="op" id="3878484">,</span>&nbsp;<span class="ident" id="3878486">err</span>&nbsp;<span class="op" id="3878490">:=</span>&nbsp;<span class="ident" id="3878493">asn1</span><span class="op" id="3878497">.</span><span class="ident" id="3878498">Marshal</span><span class="op" id="3878505">(</span><span class="ident" id="3878506">tbsCertList</span><span class="op" id="3878517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878520">if</span>&nbsp;<span class="ident" id="3878523">err</span>&nbsp;<span class="op" id="3878527">!=</span>&nbsp;<span class="ident" id="3878530">nil</span>&nbsp;<span class="op" id="3878534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878538">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878550">h</span>&nbsp;<span class="op" id="3878552">:=</span>&nbsp;<span class="ident" id="3878555">sha1</span><span class="op" id="3878559">.</span><span class="ident" id="3878560">New</span><span class="op" id="3878563">(</span><span class="op" id="3878564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878567">h</span><span class="op" id="3878568">.</span><span class="ident" id="3878569">Write</span><span class="op" id="3878574">(</span><span class="ident" id="3878575">tbsCertListContents</span><span class="op" id="3878594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878597">digest</span>&nbsp;<span class="op" id="3878604">:=</span>&nbsp;<span class="ident" id="3878607">h</span><span class="op" id="3878608">.</span><span class="ident" id="3878609">Sum</span><span class="op" id="3878612">(</span><span class="ident" id="3878613">nil</span><span class="op" id="3878616">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878620">signature</span><span class="op" id="3878629">,</span>&nbsp;<span class="ident" id="3878631">err</span>&nbsp;<span class="op" id="3878635">:=</span>&nbsp;<span class="ident" id="3878638">rsa</span><span class="op" id="3878641">.</span><span class="ident" id="3878642">SignPKCS1v15</span><span class="op" id="3878654">(</span><span class="ident" id="3878655">rand</span><span class="op" id="3878659">,</span>&nbsp;<span class="ident" id="3878661">rsaPriv</span><span class="op" id="3878668">,</span>&nbsp;<span class="ident" id="3878670">crypto</span><span class="op" id="3878676">.</span><span class="ident" id="3878677">SHA1</span><span class="op" id="3878681">,</span>&nbsp;<span class="ident" id="3878683">digest</span><span class="op" id="3878689">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878692">if</span>&nbsp;<span class="ident" id="3878695">err</span>&nbsp;<span class="op" id="3878699">!=</span>&nbsp;<span class="ident" id="3878702">nil</span>&nbsp;<span class="op" id="3878706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878710">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878722">return</span>&nbsp;<span class="ident" id="3878729">asn1</span><span class="op" id="3878733">.</span><span class="ident" id="3878734">Marshal</span><span class="op" id="3878741">(</span><span class="ident" id="3878742">pkix</span><span class="op" id="3878746">.</span><span class="ident" id="3878747">CertificateList</span><span class="op" id="3878762">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878766">TBSCertList</span><span class="op" id="3878777">:</span>&nbsp;<span class="ident" id="3878779">tbsCertList</span><span class="op" id="3878790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878794">SignatureAlgorithm</span><span class="op" id="3878812">:</span>&nbsp;<span class="ident" id="3878814">pkix</span><span class="op" id="3878818">.</span><span class="ident" id="3878819">AlgorithmIdentifier</span><span class="op" id="3878838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878843">Algorithm</span><span class="op" id="3878852">:</span>&nbsp;<span class="ident" id="3878854">oidSignatureSHA1WithRSA</span><span class="op" id="3878877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878881">}</span><span class="op" id="3878882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878886">SignatureValue</span><span class="op" id="3878900">:</span>&nbsp;<span class="ident" id="3878902">asn1</span><span class="op" id="3878906">.</span><span class="ident" id="3878907">BitString</span><span class="op" id="3878916">{</span><span class="ident" id="3878917">Bytes</span><span class="op" id="3878922">:</span>&nbsp;<span class="ident" id="3878924">signature</span><span class="op" id="3878933">,</span>&nbsp;<span class="ident" id="3878935">BitLength</span><span class="op" id="3878944">:</span>&nbsp;<span class="builtinfunc" id="3878946">len</span><span class="op" id="3878949">(</span><span class="ident" id="3878950">signature</span><span class="op" id="3878959">)</span>&nbsp;<span class="op" id="3878961">*</span>&nbsp;<span class="num" id="3878963">8</span><span class="op" id="3878964">}</span><span class="op" id="3878965">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878968">}</span><span class="op" id="3878969">)</span><br>
<span class="lineno"></span><span class="op" id="3878971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3878974">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3879050">type</span>&nbsp;<span class="ident" id="3879055">CertificateRequest</span>&nbsp;<span class="keyword" id="3879074">struct</span>&nbsp;<span class="op" id="3879081">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879084">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879109">[</span><span class="op" id="3879110">]</span><span class="builtintype" id="3879111">byte</span>&nbsp;<span class="comment" id="3879116">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879189">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="3879214">[</span><span class="op" id="3879215">]</span><span class="builtintype" id="3879216">byte</span>&nbsp;<span class="comment" id="3879221">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879281">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="3879306">[</span><span class="op" id="3879307">]</span><span class="builtintype" id="3879308">byte</span>&nbsp;<span class="comment" id="3879313">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879351">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879376">[</span><span class="op" id="3879377">]</span><span class="builtintype" id="3879378">byte</span>&nbsp;<span class="comment" id="3879383">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879409">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3879428">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879433">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879452">[</span><span class="op" id="3879453">]</span><span class="builtintype" id="3879454">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879460">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3879479">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879500">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3879519">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879539">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879558">interface</span><span class="op" id="3879567">{</span><span class="op" id="3879568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879572">Subject</span>&nbsp;<span class="ident" id="3879580">pkix</span><span class="op" id="3879584">.</span><span class="ident" id="3879585">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879592">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879647">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879712">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879742">Attributes</span>&nbsp;<span class="op" id="3879753">[</span><span class="op" id="3879754">]</span><span class="ident" id="3879755">pkix</span><span class="op" id="3879759">.</span><span class="ident" id="3879760">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879787">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879857">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879923">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879936">Extensions</span>&nbsp;<span class="op" id="3879947">[</span><span class="op" id="3879948">]</span><span class="ident" id="3879949">pkix</span><span class="op" id="3879953">.</span><span class="ident" id="3879954">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879966">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880034">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880105">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880173">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880213">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880217">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880287">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880303">ExtraExtensions</span>&nbsp;<span class="op" id="3880319">[</span><span class="op" id="3880320">]</span><span class="ident" id="3880321">pkix</span><span class="op" id="3880325">.</span><span class="ident" id="3880326">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880338">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880373">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880388">[</span><span class="op" id="3880389">]</span><span class="builtintype" id="3880390">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880398">EmailAddresses</span>&nbsp;<span class="op" id="3880413">[</span><span class="op" id="3880414">]</span><span class="builtintype" id="3880415">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880423">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880438">[</span><span class="op" id="3880439">]</span><span class="ident" id="3880440">net</span><span class="op" id="3880443">.</span><span class="ident" id="3880444">IP</span><br>
<span class="lineno"></span><span class="op" id="3880447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3880450">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="3880519">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880558">type</span>&nbsp;<span class="ident" id="3880563">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="3880585">struct</span>&nbsp;<span class="op" id="3880592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880595">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880606">asn1</span><span class="op" id="3880610">.</span><span class="ident" id="3880611">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880623">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880634">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880639">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880650">asn1</span><span class="op" id="3880654">.</span><span class="ident" id="3880655">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880665">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="3880676">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880691">Attributes</span>&nbsp;<span class="op" id="3880702">[</span><span class="op" id="3880703">]</span><span class="ident" id="3880704">pkix</span><span class="op" id="3880708">.</span><span class="ident" id="3880709">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="3880734">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3880749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="3880752">type</span>&nbsp;<span class="ident" id="3880757">certificateRequest</span>&nbsp;<span class="keyword" id="3880776">struct</span>&nbsp;<span class="op" id="3880783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880786">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880805">asn1</span><span class="op" id="3880809">.</span><span class="ident" id="3880810">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880822">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880841">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880864">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3880883">pkix</span><span class="op" id="3880887">.</span><span class="ident" id="3880888">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880909">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880928">asn1</span><span class="op" id="3880932">.</span><span class="ident" id="3880933">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="3880943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3880946">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="3881024">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="3881048">var</span>&nbsp;<span class="ident" id="3881052">oidExtensionRequest</span>&nbsp;<span class="op" id="3881072">=</span>&nbsp;<span class="ident" id="3881074">asn1</span><span class="op" id="3881078">.</span><span class="ident" id="3881079">ObjectIdentifier</span><span class="op" id="3881095">{</span><span class="num" id="3881096">1</span><span class="op" id="3881097">,</span>&nbsp;<span class="num" id="3881099">2</span><span class="op" id="3881100">,</span>&nbsp;<span class="num" id="3881102">840</span><span class="op" id="3881105">,</span>&nbsp;<span class="num" id="3881107">113549</span><span class="op" id="3881113">,</span>&nbsp;<span class="num" id="3881115">1</span><span class="op" id="3881116">,</span>&nbsp;<span class="num" id="3881118">9</span><span class="op" id="3881119">,</span>&nbsp;<span class="num" id="3881121">14</span><span class="op" id="3881123">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="3881126">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3881205">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="3881269">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="3881347">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="3881400">//</span><br>
<span class="lineno"></span><span class="comment" id="3881403">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="3881469">//</span><br>
<span class="lineno"></span><span class="comment" id="3881472">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="3881540">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="3881564">func</span>&nbsp;<span class="ident" id="3881569">CreateCertificateRequest</span><span class="op" id="3881593">(</span><span class="ident" id="3881594">rand</span>&nbsp;<span class="ident" id="3881599">io</span><span class="op" id="3881601">.</span><span class="ident" id="3881602">Reader</span><span class="op" id="3881608">,</span>&nbsp;<span class="ident" id="3881610">template</span>&nbsp;<span class="op" id="3881619">*</span><span class="ident" id="3881620">CertificateRequest</span><span class="op" id="3881638">,</span>&nbsp;<span class="ident" id="3881640">priv</span>&nbsp;<span class="keyword" id="3881645">interface</span><span class="op" id="3881654">{</span><span class="op" id="3881655">}</span><span class="op" id="3881656">)</span>&nbsp;<span class="op" id="3881658">(</span><span class="ident" id="3881659">csr</span>&nbsp;<span class="op" id="3881663">[</span><span class="op" id="3881664">]</span><span class="builtintype" id="3881665">byte</span><span class="op" id="3881669">,</span>&nbsp;<span class="ident" id="3881671">err</span>&nbsp;<span class="builtintype" id="3881675">error</span><span class="op" id="3881680">)</span>&nbsp;<span class="op" id="3881682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881685">hashFunc</span><span class="op" id="3881693">,</span>&nbsp;<span class="ident" id="3881695">sigAlgo</span><span class="op" id="3881702">,</span>&nbsp;<span class="ident" id="3881704">err</span>&nbsp;<span class="op" id="3881708">:=</span>&nbsp;<span class="ident" id="3881711">signingParamsForPrivateKey</span><span class="op" id="3881737">(</span><span class="ident" id="3881738">priv</span><span class="op" id="3881742">,</span>&nbsp;<span class="ident" id="3881744">template</span><span class="op" id="3881752">.</span><span class="ident" id="3881753">SignatureAlgorithm</span><span class="op" id="3881771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881774">if</span>&nbsp;<span class="ident" id="3881777">err</span>&nbsp;<span class="op" id="3881781">!=</span>&nbsp;<span class="ident" id="3881784">nil</span>&nbsp;<span class="op" id="3881788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881792">return</span>&nbsp;<span class="ident" id="3881799">nil</span><span class="op" id="3881802">,</span>&nbsp;<span class="ident" id="3881804">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881809">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881813">var</span>&nbsp;<span class="ident" id="3881817">publicKeyBytes</span>&nbsp;<span class="op" id="3881832">[</span><span class="op" id="3881833">]</span><span class="builtintype" id="3881834">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881840">var</span>&nbsp;<span class="ident" id="3881844">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3881863">pkix</span><span class="op" id="3881867">.</span><span class="ident" id="3881868">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881890">switch</span>&nbsp;<span class="ident" id="3881897">priv</span>&nbsp;<span class="op" id="3881902">:=</span>&nbsp;<span class="ident" id="3881905">priv</span><span class="op" id="3881909">.</span><span class="op" id="3881910">(</span><span class="keyword" id="3881911">type</span><span class="op" id="3881915">)</span>&nbsp;<span class="op" id="3881917">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881920">case</span>&nbsp;<span class="op" id="3881925">*</span><span class="ident" id="3881926">rsa</span><span class="op" id="3881929">.</span><span class="ident" id="3881930">PrivateKey</span><span class="op" id="3881940">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881944">publicKeyBytes</span><span class="op" id="3881958">,</span>&nbsp;<span class="ident" id="3881960">publicKeyAlgorithm</span><span class="op" id="3881978">,</span>&nbsp;<span class="ident" id="3881980">err</span>&nbsp;<span class="op" id="3881984">=</span>&nbsp;<span class="ident" id="3881986">marshalPublicKey</span><span class="op" id="3882002">(</span><span class="op" id="3882003">&amp;</span><span class="ident" id="3882004">priv</span><span class="op" id="3882008">.</span><span class="ident" id="3882009">PublicKey</span><span class="op" id="3882018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882021">case</span>&nbsp;<span class="op" id="3882026">*</span><span class="ident" id="3882027">ecdsa</span><span class="op" id="3882032">.</span><span class="ident" id="3882033">PrivateKey</span><span class="op" id="3882043">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882047">publicKeyBytes</span><span class="op" id="3882061">,</span>&nbsp;<span class="ident" id="3882063">publicKeyAlgorithm</span><span class="op" id="3882081">,</span>&nbsp;<span class="ident" id="3882083">err</span>&nbsp;<span class="op" id="3882087">=</span>&nbsp;<span class="ident" id="3882089">marshalPublicKey</span><span class="op" id="3882105">(</span><span class="op" id="3882106">&amp;</span><span class="ident" id="3882107">priv</span><span class="op" id="3882111">.</span><span class="ident" id="3882112">PublicKey</span><span class="op" id="3882121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882124">default</span><span class="op" id="3882131">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3882135">panic</span><span class="op" id="3882140">(</span><span class="string" id="3882141">&#34;internal&nbsp;error&#34;</span><span class="op" id="3882157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882164">if</span>&nbsp;<span class="ident" id="3882167">err</span>&nbsp;<span class="op" id="3882171">!=</span>&nbsp;<span class="ident" id="3882174">nil</span>&nbsp;<span class="op" id="3882178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882182">return</span>&nbsp;<span class="ident" id="3882189">nil</span><span class="op" id="3882192">,</span>&nbsp;<span class="ident" id="3882194">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882203">var</span>&nbsp;<span class="ident" id="3882207">extensions</span>&nbsp;<span class="op" id="3882218">[</span><span class="op" id="3882219">]</span><span class="ident" id="3882220">pkix</span><span class="op" id="3882224">.</span><span class="ident" id="3882225">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882237">if</span>&nbsp;<span class="op" id="3882240">(</span><span class="builtinfunc" id="3882241">len</span><span class="op" id="3882244">(</span><span class="ident" id="3882245">template</span><span class="op" id="3882253">.</span><span class="ident" id="3882254">DNSNames</span><span class="op" id="3882262">)</span>&nbsp;<span class="op" id="3882264">&gt;</span>&nbsp;<span class="num" id="3882266">0</span>&nbsp;<span class="op" id="3882268">||</span>&nbsp;<span class="builtinfunc" id="3882271">len</span><span class="op" id="3882274">(</span><span class="ident" id="3882275">template</span><span class="op" id="3882283">.</span><span class="ident" id="3882284">EmailAddresses</span><span class="op" id="3882298">)</span>&nbsp;<span class="op" id="3882300">&gt;</span>&nbsp;<span class="num" id="3882302">0</span>&nbsp;<span class="op" id="3882304">||</span>&nbsp;<span class="builtinfunc" id="3882307">len</span><span class="op" id="3882310">(</span><span class="ident" id="3882311">template</span><span class="op" id="3882319">.</span><span class="ident" id="3882320">IPAddresses</span><span class="op" id="3882331">)</span>&nbsp;<span class="op" id="3882333">&gt;</span>&nbsp;<span class="num" id="3882335">0</span><span class="op" id="3882336">)</span>&nbsp;<span class="op" id="3882338">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882343">!</span><span class="ident" id="3882344">oidInExtensions</span><span class="op" id="3882359">(</span><span class="ident" id="3882360">oidExtensionSubjectAltName</span><span class="op" id="3882386">,</span>&nbsp;<span class="ident" id="3882388">template</span><span class="op" id="3882396">.</span><span class="ident" id="3882397">ExtraExtensions</span><span class="op" id="3882412">)</span>&nbsp;<span class="op" id="3882414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882418">sanBytes</span><span class="op" id="3882426">,</span>&nbsp;<span class="ident" id="3882428">err</span>&nbsp;<span class="op" id="3882432">:=</span>&nbsp;<span class="ident" id="3882435">marshalSANs</span><span class="op" id="3882446">(</span><span class="ident" id="3882447">template</span><span class="op" id="3882455">.</span><span class="ident" id="3882456">DNSNames</span><span class="op" id="3882464">,</span>&nbsp;<span class="ident" id="3882466">template</span><span class="op" id="3882474">.</span><span class="ident" id="3882475">EmailAddresses</span><span class="op" id="3882489">,</span>&nbsp;<span class="ident" id="3882491">template</span><span class="op" id="3882499">.</span><span class="ident" id="3882500">IPAddresses</span><span class="op" id="3882511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882515">if</span>&nbsp;<span class="ident" id="3882518">err</span>&nbsp;<span class="op" id="3882522">!=</span>&nbsp;<span class="ident" id="3882525">nil</span>&nbsp;<span class="op" id="3882529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882534">return</span>&nbsp;<span class="ident" id="3882541">nil</span><span class="op" id="3882544">,</span>&nbsp;<span class="ident" id="3882546">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882552">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882557">extensions</span>&nbsp;<span class="op" id="3882568">=</span>&nbsp;<span class="builtinfunc" id="3882570">append</span><span class="op" id="3882576">(</span><span class="ident" id="3882577">extensions</span><span class="op" id="3882587">,</span>&nbsp;<span class="ident" id="3882589">pkix</span><span class="op" id="3882593">.</span><span class="ident" id="3882594">Extension</span><span class="op" id="3882603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882608">Id</span><span class="op" id="3882610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882615">oidExtensionSubjectAltName</span><span class="op" id="3882641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882646">Value</span><span class="op" id="3882651">:</span>&nbsp;<span class="ident" id="3882653">sanBytes</span><span class="op" id="3882661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882665">}</span><span class="op" id="3882666">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882673">extensions</span>&nbsp;<span class="op" id="3882684">=</span>&nbsp;<span class="builtinfunc" id="3882686">append</span><span class="op" id="3882692">(</span><span class="ident" id="3882693">extensions</span><span class="op" id="3882703">,</span>&nbsp;<span class="ident" id="3882705">template</span><span class="op" id="3882713">.</span><span class="ident" id="3882714">ExtraExtensions</span><span class="op" id="3882729">...</span><span class="op" id="3882732">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882736">var</span>&nbsp;<span class="ident" id="3882740">attributes</span>&nbsp;<span class="op" id="3882751">[</span><span class="op" id="3882752">]</span><span class="ident" id="3882753">pkix</span><span class="op" id="3882757">.</span><span class="ident" id="3882758">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882784">attributes</span>&nbsp;<span class="op" id="3882795">=</span>&nbsp;<span class="builtinfunc" id="3882797">append</span><span class="op" id="3882803">(</span><span class="ident" id="3882804">attributes</span><span class="op" id="3882814">,</span>&nbsp;<span class="ident" id="3882816">template</span><span class="op" id="3882824">.</span><span class="ident" id="3882825">Attributes</span><span class="op" id="3882835">...</span><span class="op" id="3882838">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882842">if</span>&nbsp;<span class="builtinfunc" id="3882845">len</span><span class="op" id="3882848">(</span><span class="ident" id="3882849">extensions</span><span class="op" id="3882859">)</span>&nbsp;<span class="op" id="3882861">&gt;</span>&nbsp;<span class="num" id="3882863">0</span>&nbsp;<span class="op" id="3882865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3882869">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3882930">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882976">specifiedExtensions</span>&nbsp;<span class="op" id="3882996">:=</span>&nbsp;<span class="builtinfunc" id="3882999">make</span><span class="op" id="3883003">(</span><span class="keyword" id="3883004">map</span><span class="op" id="3883007">[</span><span class="builtintype" id="3883008">string</span><span class="op" id="3883014">]</span><span class="builtintype" id="3883015">bool</span><span class="op" id="3883019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883024">for</span>&nbsp;<span class="ident" id="3883028">_</span><span class="op" id="3883029">,</span>&nbsp;<span class="ident" id="3883031">atvSet</span>&nbsp;<span class="op" id="3883038">:=</span>&nbsp;<span class="keyword" id="3883041">range</span>&nbsp;<span class="ident" id="3883047">template</span><span class="op" id="3883055">.</span><span class="ident" id="3883056">Attributes</span>&nbsp;<span class="op" id="3883067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883072">if</span>&nbsp;<span class="op" id="3883075">!</span><span class="ident" id="3883076">atvSet</span><span class="op" id="3883082">.</span><span class="ident" id="3883083">Type</span><span class="op" id="3883087">.</span><span class="ident" id="3883088">Equal</span><span class="op" id="3883093">(</span><span class="ident" id="3883094">oidExtensionRequest</span><span class="op" id="3883113">)</span>&nbsp;<span class="op" id="3883115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883121">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883139">for</span>&nbsp;<span class="ident" id="3883143">_</span><span class="op" id="3883144">,</span>&nbsp;<span class="ident" id="3883146">atvs</span>&nbsp;<span class="op" id="3883151">:=</span>&nbsp;<span class="keyword" id="3883154">range</span>&nbsp;<span class="ident" id="3883160">atvSet</span><span class="op" id="3883166">.</span><span class="ident" id="3883167">Value</span>&nbsp;<span class="op" id="3883173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883179">for</span>&nbsp;<span class="ident" id="3883183">_</span><span class="op" id="3883184">,</span>&nbsp;<span class="ident" id="3883186">atv</span>&nbsp;<span class="op" id="3883190">:=</span>&nbsp;<span class="keyword" id="3883193">range</span>&nbsp;<span class="ident" id="3883199">atvs</span>&nbsp;<span class="op" id="3883204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883211">specifiedExtensions</span><span class="op" id="3883230">[</span><span class="ident" id="3883231">atv</span><span class="op" id="3883234">.</span><span class="ident" id="3883235">Type</span><span class="op" id="3883239">.</span><span class="ident" id="3883240">String</span><span class="op" id="3883246">(</span><span class="op" id="3883247">)</span><span class="op" id="3883248">]</span>&nbsp;<span class="op" id="3883250">=</span>&nbsp;<span class="builtintype" id="3883252">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883275">atvs</span>&nbsp;<span class="op" id="3883280">:=</span>&nbsp;<span class="builtinfunc" id="3883283">make</span><span class="op" id="3883287">(</span><span class="op" id="3883288">[</span><span class="op" id="3883289">]</span><span class="ident" id="3883290">pkix</span><span class="op" id="3883294">.</span><span class="ident" id="3883295">AttributeTypeAndValue</span><span class="op" id="3883316">,</span>&nbsp;<span class="num" id="3883318">0</span><span class="op" id="3883319">,</span>&nbsp;<span class="builtinfunc" id="3883321">len</span><span class="op" id="3883324">(</span><span class="ident" id="3883325">extensions</span><span class="op" id="3883335">)</span><span class="op" id="3883336">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883340">for</span>&nbsp;<span class="ident" id="3883344">_</span><span class="op" id="3883345">,</span>&nbsp;<span class="ident" id="3883347">e</span>&nbsp;<span class="op" id="3883349">:=</span>&nbsp;<span class="keyword" id="3883352">range</span>&nbsp;<span class="ident" id="3883358">extensions</span>&nbsp;<span class="op" id="3883369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883374">if</span>&nbsp;<span class="ident" id="3883377">specifiedExtensions</span><span class="op" id="3883396">[</span><span class="ident" id="3883397">e</span><span class="op" id="3883398">.</span><span class="ident" id="3883399">Id</span><span class="op" id="3883401">.</span><span class="ident" id="3883402">String</span><span class="op" id="3883408">(</span><span class="op" id="3883409">)</span><span class="op" id="3883410">]</span>&nbsp;<span class="op" id="3883412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883418">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883466">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883511">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883529">atvs</span>&nbsp;<span class="op" id="3883534">=</span>&nbsp;<span class="builtinfunc" id="3883536">append</span><span class="op" id="3883542">(</span><span class="ident" id="3883543">atvs</span><span class="op" id="3883547">,</span>&nbsp;<span class="ident" id="3883549">pkix</span><span class="op" id="3883553">.</span><span class="ident" id="3883554">AttributeTypeAndValue</span><span class="op" id="3883575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883581">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883638">Type</span><span class="op" id="3883642">:</span>&nbsp;&nbsp;<span class="ident" id="3883645">e</span><span class="op" id="3883646">.</span><span class="ident" id="3883647">Id</span><span class="op" id="3883649">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883655">Value</span><span class="op" id="3883660">:</span>&nbsp;<span class="ident" id="3883662">e</span><span class="op" id="3883663">.</span><span class="ident" id="3883664">Value</span><span class="op" id="3883669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883674">}</span><span class="op" id="3883675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883684">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883749">appended</span>&nbsp;<span class="op" id="3883758">:=</span>&nbsp;<span class="builtintype" id="3883761">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883769">for</span>&nbsp;<span class="ident" id="3883773">_</span><span class="op" id="3883774">,</span>&nbsp;<span class="ident" id="3883776">atvSet</span>&nbsp;<span class="op" id="3883783">:=</span>&nbsp;<span class="keyword" id="3883786">range</span>&nbsp;<span class="ident" id="3883792">attributes</span>&nbsp;<span class="op" id="3883803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883808">if</span>&nbsp;<span class="op" id="3883811">!</span><span class="ident" id="3883812">atvSet</span><span class="op" id="3883818">.</span><span class="ident" id="3883819">Type</span><span class="op" id="3883823">.</span><span class="ident" id="3883824">Equal</span><span class="op" id="3883829">(</span><span class="ident" id="3883830">oidExtensionRequest</span><span class="op" id="3883849">)</span>&nbsp;<span class="op" id="3883851">||</span>&nbsp;<span class="builtinfunc" id="3883854">len</span><span class="op" id="3883857">(</span><span class="ident" id="3883858">atvSet</span><span class="op" id="3883864">.</span><span class="ident" id="3883865">Value</span><span class="op" id="3883870">)</span>&nbsp;<span class="op" id="3883872">==</span>&nbsp;<span class="num" id="3883875">0</span>&nbsp;<span class="op" id="3883877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883883">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883895">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883901">atvSet</span><span class="op" id="3883907">.</span><span class="ident" id="3883908">Value</span><span class="op" id="3883913">[</span><span class="num" id="3883914">0</span><span class="op" id="3883915">]</span>&nbsp;<span class="op" id="3883917">=</span>&nbsp;<span class="builtinfunc" id="3883919">append</span><span class="op" id="3883925">(</span><span class="ident" id="3883926">atvSet</span><span class="op" id="3883932">.</span><span class="ident" id="3883933">Value</span><span class="op" id="3883938">[</span><span class="num" id="3883939">0</span><span class="op" id="3883940">]</span><span class="op" id="3883941">,</span>&nbsp;<span class="ident" id="3883943">atvs</span><span class="op" id="3883947">...</span><span class="op" id="3883950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883955">appended</span>&nbsp;<span class="op" id="3883964">=</span>&nbsp;<span class="builtintype" id="3883966">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883974">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883982">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883987">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884043">if</span>&nbsp;<span class="op" id="3884046">!</span><span class="ident" id="3884047">appended</span>&nbsp;<span class="op" id="3884056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884061">attributes</span>&nbsp;<span class="op" id="3884072">=</span>&nbsp;<span class="builtinfunc" id="3884074">append</span><span class="op" id="3884080">(</span><span class="ident" id="3884081">attributes</span><span class="op" id="3884091">,</span>&nbsp;<span class="ident" id="3884093">pkix</span><span class="op" id="3884097">.</span><span class="ident" id="3884098">AttributeTypeAndValueSET</span><span class="op" id="3884122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884128">Type</span><span class="op" id="3884132">:</span>&nbsp;<span class="ident" id="3884134">oidExtensionRequest</span><span class="op" id="3884153">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884159">Value</span><span class="op" id="3884164">:</span>&nbsp;<span class="op" id="3884166">[</span><span class="op" id="3884167">]</span><span class="op" id="3884168">[</span><span class="op" id="3884169">]</span><span class="ident" id="3884170">pkix</span><span class="op" id="3884174">.</span><span class="ident" id="3884175">AttributeTypeAndValue</span><span class="op" id="3884196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884203">atvs</span><span class="op" id="3884207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884213">}</span><span class="op" id="3884214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884219">}</span><span class="op" id="3884220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884224">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884231">asn1Subject</span>&nbsp;<span class="op" id="3884243">:=</span>&nbsp;<span class="ident" id="3884246">template</span><span class="op" id="3884254">.</span><span class="ident" id="3884255">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884267">if</span>&nbsp;<span class="builtinfunc" id="3884270">len</span><span class="op" id="3884273">(</span><span class="ident" id="3884274">asn1Subject</span><span class="op" id="3884285">)</span>&nbsp;<span class="op" id="3884287">==</span>&nbsp;<span class="num" id="3884290">0</span>&nbsp;<span class="op" id="3884292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884296">asn1Subject</span><span class="op" id="3884307">,</span>&nbsp;<span class="ident" id="3884309">err</span>&nbsp;<span class="op" id="3884313">=</span>&nbsp;<span class="ident" id="3884315">asn1</span><span class="op" id="3884319">.</span><span class="ident" id="3884320">Marshal</span><span class="op" id="3884327">(</span><span class="ident" id="3884328">template</span><span class="op" id="3884336">.</span><span class="ident" id="3884337">Subject</span><span class="op" id="3884344">.</span><span class="ident" id="3884345">ToRDNSequence</span><span class="op" id="3884358">(</span><span class="op" id="3884359">)</span><span class="op" id="3884360">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884364">if</span>&nbsp;<span class="ident" id="3884367">err</span>&nbsp;<span class="op" id="3884371">!=</span>&nbsp;<span class="ident" id="3884374">nil</span>&nbsp;<span class="op" id="3884378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884383">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884399">tbsCSR</span>&nbsp;<span class="op" id="3884406">:=</span>&nbsp;<span class="ident" id="3884409">tbsCertificateRequest</span><span class="op" id="3884430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884434">Version</span><span class="op" id="3884441">:</span>&nbsp;<span class="num" id="3884443">0</span><span class="op" id="3884444">,</span>&nbsp;<span class="comment" id="3884446">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884470">Subject</span><span class="op" id="3884477">:</span>&nbsp;<span class="ident" id="3884479">asn1</span><span class="op" id="3884483">.</span><span class="ident" id="3884484">RawValue</span><span class="op" id="3884492">{</span><span class="ident" id="3884493">FullBytes</span><span class="op" id="3884502">:</span>&nbsp;<span class="ident" id="3884504">asn1Subject</span><span class="op" id="3884515">}</span><span class="op" id="3884516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884520">PublicKey</span><span class="op" id="3884529">:</span>&nbsp;<span class="ident" id="3884531">publicKeyInfo</span><span class="op" id="3884544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884549">Algorithm</span><span class="op" id="3884558">:</span>&nbsp;<span class="ident" id="3884560">publicKeyAlgorithm</span><span class="op" id="3884578">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884583">PublicKey</span><span class="op" id="3884592">:</span>&nbsp;<span class="ident" id="3884594">asn1</span><span class="op" id="3884598">.</span><span class="ident" id="3884599">BitString</span><span class="op" id="3884608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884614">Bytes</span><span class="op" id="3884619">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3884625">publicKeyBytes</span><span class="op" id="3884639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884645">BitLength</span><span class="op" id="3884654">:</span>&nbsp;<span class="builtinfunc" id="3884656">len</span><span class="op" id="3884659">(</span><span class="ident" id="3884660">publicKeyBytes</span><span class="op" id="3884674">)</span>&nbsp;<span class="op" id="3884676">*</span>&nbsp;<span class="num" id="3884678">8</span><span class="op" id="3884679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884684">}</span><span class="op" id="3884685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884689">}</span><span class="op" id="3884690">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884694">Attributes</span><span class="op" id="3884704">:</span>&nbsp;<span class="ident" id="3884706">attributes</span><span class="op" id="3884716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884723">tbsCSRContents</span><span class="op" id="3884737">,</span>&nbsp;<span class="ident" id="3884739">err</span>&nbsp;<span class="op" id="3884743">:=</span>&nbsp;<span class="ident" id="3884746">asn1</span><span class="op" id="3884750">.</span><span class="ident" id="3884751">Marshal</span><span class="op" id="3884758">(</span><span class="ident" id="3884759">tbsCSR</span><span class="op" id="3884765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884768">if</span>&nbsp;<span class="ident" id="3884771">err</span>&nbsp;<span class="op" id="3884775">!=</span>&nbsp;<span class="ident" id="3884778">nil</span>&nbsp;<span class="op" id="3884782">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884786">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884797">tbsCSR</span><span class="op" id="3884803">.</span><span class="ident" id="3884804">Raw</span>&nbsp;<span class="op" id="3884808">=</span>&nbsp;<span class="ident" id="3884810">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884827">h</span>&nbsp;<span class="op" id="3884829">:=</span>&nbsp;<span class="ident" id="3884832">hashFunc</span><span class="op" id="3884840">.</span><span class="ident" id="3884841">New</span><span class="op" id="3884844">(</span><span class="op" id="3884845">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884848">h</span><span class="op" id="3884849">.</span><span class="ident" id="3884850">Write</span><span class="op" id="3884855">(</span><span class="ident" id="3884856">tbsCSRContents</span><span class="op" id="3884870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884873">digest</span>&nbsp;<span class="op" id="3884880">:=</span>&nbsp;<span class="ident" id="3884883">h</span><span class="op" id="3884884">.</span><span class="ident" id="3884885">Sum</span><span class="op" id="3884888">(</span><span class="ident" id="3884889">nil</span><span class="op" id="3884892">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884896">var</span>&nbsp;<span class="ident" id="3884900">signature</span>&nbsp;<span class="op" id="3884910">[</span><span class="op" id="3884911">]</span><span class="builtintype" id="3884912">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884918">switch</span>&nbsp;<span class="ident" id="3884925">priv</span>&nbsp;<span class="op" id="3884930">:=</span>&nbsp;<span class="ident" id="3884933">priv</span><span class="op" id="3884937">.</span><span class="op" id="3884938">(</span><span class="keyword" id="3884939">type</span><span class="op" id="3884943">)</span>&nbsp;<span class="op" id="3884945">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884948">case</span>&nbsp;<span class="op" id="3884953">*</span><span class="ident" id="3884954">rsa</span><span class="op" id="3884957">.</span><span class="ident" id="3884958">PrivateKey</span><span class="op" id="3884968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884972">signature</span><span class="op" id="3884981">,</span>&nbsp;<span class="ident" id="3884983">err</span>&nbsp;<span class="op" id="3884987">=</span>&nbsp;<span class="ident" id="3884989">rsa</span><span class="op" id="3884992">.</span><span class="ident" id="3884993">SignPKCS1v15</span><span class="op" id="3885005">(</span><span class="ident" id="3885006">rand</span><span class="op" id="3885010">,</span>&nbsp;<span class="ident" id="3885012">priv</span><span class="op" id="3885016">,</span>&nbsp;<span class="ident" id="3885018">hashFunc</span><span class="op" id="3885026">,</span>&nbsp;<span class="ident" id="3885028">digest</span><span class="op" id="3885034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885037">case</span>&nbsp;<span class="op" id="3885042">*</span><span class="ident" id="3885043">ecdsa</span><span class="op" id="3885048">.</span><span class="ident" id="3885049">PrivateKey</span><span class="op" id="3885059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885063">var</span>&nbsp;<span class="ident" id="3885067">r</span><span class="op" id="3885068">,</span>&nbsp;<span class="ident" id="3885070">s</span>&nbsp;<span class="op" id="3885072">*</span><span class="ident" id="3885073">big</span><span class="op" id="3885076">.</span><span class="ident" id="3885077">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885083">if</span>&nbsp;<span class="ident" id="3885086">r</span><span class="op" id="3885087">,</span>&nbsp;<span class="ident" id="3885089">s</span><span class="op" id="3885090">,</span>&nbsp;<span class="ident" id="3885092">err</span>&nbsp;<span class="op" id="3885096">=</span>&nbsp;<span class="ident" id="3885098">ecdsa</span><span class="op" id="3885103">.</span><span class="ident" id="3885104">Sign</span><span class="op" id="3885108">(</span><span class="ident" id="3885109">rand</span><span class="op" id="3885113">,</span>&nbsp;<span class="ident" id="3885115">priv</span><span class="op" id="3885119">,</span>&nbsp;<span class="ident" id="3885121">digest</span><span class="op" id="3885127">)</span><span class="op" id="3885128">;</span>&nbsp;<span class="ident" id="3885130">err</span>&nbsp;<span class="op" id="3885134">==</span>&nbsp;<span class="ident" id="3885137">nil</span>&nbsp;<span class="op" id="3885141">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885146">signature</span><span class="op" id="3885155">,</span>&nbsp;<span class="ident" id="3885157">err</span>&nbsp;<span class="op" id="3885161">=</span>&nbsp;<span class="ident" id="3885163">asn1</span><span class="op" id="3885167">.</span><span class="ident" id="3885168">Marshal</span><span class="op" id="3885175">(</span><span class="ident" id="3885176">ecdsaSignature</span><span class="op" id="3885190">{</span><span class="ident" id="3885191">r</span><span class="op" id="3885192">,</span>&nbsp;<span class="ident" id="3885194">s</span><span class="op" id="3885195">}</span><span class="op" id="3885196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885203">default</span><span class="op" id="3885210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3885214">panic</span><span class="op" id="3885219">(</span><span class="string" id="3885220">&#34;internal&nbsp;error&#34;</span><span class="op" id="3885236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885239">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885243">if</span>&nbsp;<span class="ident" id="3885246">err</span>&nbsp;<span class="op" id="3885250">!=</span>&nbsp;<span class="ident" id="3885253">nil</span>&nbsp;<span class="op" id="3885257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885261">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885273">return</span>&nbsp;<span class="ident" id="3885280">asn1</span><span class="op" id="3885284">.</span><span class="ident" id="3885285">Marshal</span><span class="op" id="3885292">(</span><span class="ident" id="3885293">certificateRequest</span><span class="op" id="3885311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885315">TBSCSR</span><span class="op" id="3885321">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885335">tbsCSR</span><span class="op" id="3885341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885345">SignatureAlgorithm</span><span class="op" id="3885363">:</span>&nbsp;<span class="ident" id="3885365">sigAlgo</span><span class="op" id="3885372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885376">SignatureValue</span><span class="op" id="3885390">:</span>&nbsp;<span class="ident" id="3885392">asn1</span><span class="op" id="3885396">.</span><span class="ident" id="3885397">BitString</span><span class="op" id="3885406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885411">Bytes</span><span class="op" id="3885416">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885422">signature</span><span class="op" id="3885431">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885436">BitLength</span><span class="op" id="3885445">:</span>&nbsp;<span class="builtinfunc" id="3885447">len</span><span class="op" id="3885450">(</span><span class="ident" id="3885451">signature</span><span class="op" id="3885460">)</span>&nbsp;<span class="op" id="3885462">*</span>&nbsp;<span class="num" id="3885464">8</span><span class="op" id="3885465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885469">}</span><span class="op" id="3885470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885473">}</span><span class="op" id="3885474">)</span><br>
<span class="lineno"></span><span class="op" id="3885476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="3885479">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3885551">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3885576">func</span>&nbsp;<span class="ident" id="3885581">ParseCertificateRequest</span><span class="op" id="3885604">(</span><span class="ident" id="3885605">asn1Data</span>&nbsp;<span class="op" id="3885614">[</span><span class="op" id="3885615">]</span><span class="builtintype" id="3885616">byte</span><span class="op" id="3885620">)</span>&nbsp;<span class="op" id="3885622">(</span><span class="op" id="3885623">*</span><span class="ident" id="3885624">CertificateRequest</span><span class="op" id="3885642">,</span>&nbsp;<span class="builtintype" id="3885644">error</span><span class="op" id="3885649">)</span>&nbsp;<span class="op" id="3885651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885654">var</span>&nbsp;<span class="ident" id="3885658">csr</span>&nbsp;<span class="ident" id="3885662">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885683">rest</span><span class="op" id="3885687">,</span>&nbsp;<span class="ident" id="3885689">err</span>&nbsp;<span class="op" id="3885693">:=</span>&nbsp;<span class="ident" id="3885696">asn1</span><span class="op" id="3885700">.</span><span class="ident" id="3885701">Unmarshal</span><span class="op" id="3885710">(</span><span class="ident" id="3885711">asn1Data</span><span class="op" id="3885719">,</span>&nbsp;<span class="op" id="3885721">&amp;</span><span class="ident" id="3885722">csr</span><span class="op" id="3885725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885728">if</span>&nbsp;<span class="ident" id="3885731">err</span>&nbsp;<span class="op" id="3885735">!=</span>&nbsp;<span class="ident" id="3885738">nil</span>&nbsp;<span class="op" id="3885742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885746">return</span>&nbsp;<span class="ident" id="3885753">nil</span><span class="op" id="3885756">,</span>&nbsp;<span class="ident" id="3885758">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885763">}</span>&nbsp;<span class="keyword" id="3885765">else</span>&nbsp;<span class="keyword" id="3885770">if</span>&nbsp;<span class="builtinfunc" id="3885773">len</span><span class="op" id="3885776">(</span><span class="ident" id="3885777">rest</span><span class="op" id="3885781">)</span>&nbsp;<span class="op" id="3885783">!=</span>&nbsp;<span class="num" id="3885786">0</span>&nbsp;<span class="op" id="3885788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885792">return</span>&nbsp;<span class="ident" id="3885799">nil</span><span class="op" id="3885802">,</span>&nbsp;<span class="ident" id="3885804">asn1</span><span class="op" id="3885808">.</span><span class="ident" id="3885809">SyntaxError</span><span class="op" id="3885820">{</span><span class="ident" id="3885821">Msg</span><span class="op" id="3885824">:</span>&nbsp;<span class="string" id="3885826">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3885841">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885848">return</span>&nbsp;<span class="ident" id="3885855">parseCertificateRequest</span><span class="op" id="3885878">(</span><span class="op" id="3885879">&amp;</span><span class="ident" id="3885880">csr</span><span class="op" id="3885883">)</span><br>
<span class="lineno"></span><span class="op" id="3885885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="3885888">func</span>&nbsp;<span class="ident" id="3885893">parseCertificateRequest</span><span class="op" id="3885916">(</span><span class="ident" id="3885917">in</span>&nbsp;<span class="op" id="3885920">*</span><span class="ident" id="3885921">certificateRequest</span><span class="op" id="3885939">)</span>&nbsp;<span class="op" id="3885941">(</span><span class="op" id="3885942">*</span><span class="ident" id="3885943">CertificateRequest</span><span class="op" id="3885961">,</span>&nbsp;<span class="builtintype" id="3885963">error</span><span class="op" id="3885968">)</span>&nbsp;<span class="op" id="3885970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885973">out</span>&nbsp;<span class="op" id="3885977">:=</span>&nbsp;<span class="op" id="3885980">&amp;</span><span class="ident" id="3885981">CertificateRequest</span><span class="op" id="3885999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886003">Raw</span><span class="op" id="3886006">:</span>&nbsp;<span class="ident" id="3886008">in</span><span class="op" id="3886010">.</span><span class="ident" id="3886011">Raw</span><span class="op" id="3886014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886018">RawTBSCertificateRequest</span><span class="op" id="3886042">:</span>&nbsp;<span class="ident" id="3886044">in</span><span class="op" id="3886046">.</span><span class="ident" id="3886047">TBSCSR</span><span class="op" id="3886053">.</span><span class="ident" id="3886054">Raw</span><span class="op" id="3886057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886061">RawSubjectPublicKeyInfo</span><span class="op" id="3886084">:</span>&nbsp;&nbsp;<span class="ident" id="3886087">in</span><span class="op" id="3886089">.</span><span class="ident" id="3886090">TBSCSR</span><span class="op" id="3886096">.</span><span class="ident" id="3886097">PublicKey</span><span class="op" id="3886106">.</span><span class="ident" id="3886107">Raw</span><span class="op" id="3886110">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886114">RawSubject</span><span class="op" id="3886124">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886140">in</span><span class="op" id="3886142">.</span><span class="ident" id="3886143">TBSCSR</span><span class="op" id="3886149">.</span><span class="ident" id="3886150">Subject</span><span class="op" id="3886157">.</span><span class="ident" id="3886158">FullBytes</span><span class="op" id="3886167">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886172">Signature</span><span class="op" id="3886181">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886192">in</span><span class="op" id="3886194">.</span><span class="ident" id="3886195">SignatureValue</span><span class="op" id="3886209">.</span><span class="ident" id="3886210">RightAlign</span><span class="op" id="3886220">(</span><span class="op" id="3886221">)</span><span class="op" id="3886222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886226">SignatureAlgorithm</span><span class="op" id="3886244">:</span>&nbsp;<span class="ident" id="3886246">getSignatureAlgorithmFromOID</span><span class="op" id="3886274">(</span><span class="ident" id="3886275">in</span><span class="op" id="3886277">.</span><span class="ident" id="3886278">SignatureAlgorithm</span><span class="op" id="3886296">.</span><span class="ident" id="3886297">Algorithm</span><span class="op" id="3886306">)</span><span class="op" id="3886307">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886312">PublicKeyAlgorithm</span><span class="op" id="3886330">:</span>&nbsp;<span class="ident" id="3886332">getPublicKeyAlgorithmFromOID</span><span class="op" id="3886360">(</span><span class="ident" id="3886361">in</span><span class="op" id="3886363">.</span><span class="ident" id="3886364">TBSCSR</span><span class="op" id="3886370">.</span><span class="ident" id="3886371">PublicKey</span><span class="op" id="3886380">.</span><span class="ident" id="3886381">Algorithm</span><span class="op" id="3886390">.</span><span class="ident" id="3886391">Algorithm</span><span class="op" id="3886400">)</span><span class="op" id="3886401">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886406">Version</span><span class="op" id="3886413">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886418">in</span><span class="op" id="3886420">.</span><span class="ident" id="3886421">TBSCSR</span><span class="op" id="3886427">.</span><span class="ident" id="3886428">Version</span><span class="op" id="3886435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886439">Attributes</span><span class="op" id="3886449">:</span>&nbsp;<span class="ident" id="3886451">in</span><span class="op" id="3886453">.</span><span class="ident" id="3886454">TBSCSR</span><span class="op" id="3886460">.</span><span class="ident" id="3886461">Attributes</span><span class="op" id="3886471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3886474">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886478">var</span>&nbsp;<span class="ident" id="3886482">err</span>&nbsp;<span class="builtintype" id="3886486">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886493">out</span><span class="op" id="3886496">.</span><span class="ident" id="3886497">PublicKey</span><span class="op" id="3886506">,</span>&nbsp;<span class="ident" id="3886508">err</span>&nbsp;<span class="op" id="3886512">=</span>&nbsp;<span class="ident" id="3886514">parsePublicKey</span><span class="op" id="3886528">(</span><span class="ident" id="3886529">out</span><span class="op" id="3886532">.</span><span class="ident" id="3886533">PublicKeyAlgorithm</span><span class="op" id="3886551">,</span>&nbsp;<span class="op" id="3886553">&amp;</span><span class="ident" id="3886554">in</span><span class="op" id="3886556">.</span><span class="ident" id="3886557">TBSCSR</span><span class="op" id="3886563">.</span><span class="ident" id="3886564">PublicKey</span><span class="op" id="3886573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886576">if</span>&nbsp;<span class="ident" id="3886579">err</span>&nbsp;<span class="op" id="3886583">!=</span>&nbsp;<span class="ident" id="3886586">nil</span>&nbsp;<span class="op" id="3886590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886594">return</span>&nbsp;<span class="ident" id="3886601">nil</span><span class="op" id="3886604">,</span>&nbsp;<span class="ident" id="3886606">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3886611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886615">var</span>&nbsp;<span class="ident" id="3886619">subject</span>&nbsp;<span class="ident" id="3886627">pkix</span><span class="op" id="3886631">.</span><span class="ident" id="3886632">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886645">if</span>&nbsp;<span class="ident" id="3886648">_</span><span class="op" id="3886649">,</span>&nbsp;<span class="ident" id="3886651">err</span>&nbsp;<span class="op" id="3886655">:=</span>&nbsp;<span class="ident" id="3886658">asn1</span><span class="op" id="3886662">.</span><span class="ident" id="3886663">Unmarshal</span><span class="op" id="3886672">(</span><span class="ident" id="3886673">in</span><span class="op" id="3886675">.</span><span class="ident" id="3886676">TBSCSR</span><span class="op" id="3886682">.</span><span class="ident" id="3886683">Subject</span><span class="op" id="3886690">.</span><span class="ident" id="3886691">FullBytes</span><span class="op" id="3886700">,</span>&nbsp;<span class="op" id="3886702">&amp;</span><span class="ident" id="3886703">subject</span><span class="op" id="3886710">)</span><span class="op" id="3886711">;</span>&nbsp;<span class="ident" id="3886713">err</span>&nbsp;<span class="op" id="3886717">!=</span>&nbsp;<span class="ident" id="3886720">nil</span>&nbsp;<span class="op" id="3886724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886728">return</span>&nbsp;<span class="ident" id="3886735">nil</span><span class="op" id="3886738">,</span>&nbsp;<span class="ident" id="3886740">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3886745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886749">out</span><span class="op" id="3886752">.</span><span class="ident" id="3886753">Subject</span><span class="op" id="3886760">.</span><span class="ident" id="3886761">FillFromRDNSequence</span><span class="op" id="3886780">(</span><span class="op" id="3886781">&amp;</span><span class="ident" id="3886782">subject</span><span class="op" id="3886789">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886793">var</span>&nbsp;<span class="ident" id="3886797">extensions</span>&nbsp;<span class="op" id="3886808">[</span><span class="op" id="3886809">]</span><span class="ident" id="3886810">pkix</span><span class="op" id="3886814">.</span><span class="ident" id="3886815">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886839">for</span>&nbsp;<span class="ident" id="3886843">_</span><span class="op" id="3886844">,</span>&nbsp;<span class="ident" id="3886846">atvSet</span>&nbsp;<span class="op" id="3886853">:=</span>&nbsp;<span class="keyword" id="3886856">range</span>&nbsp;<span class="ident" id="3886862">in</span><span class="op" id="3886864">.</span><span class="ident" id="3886865">TBSCSR</span><span class="op" id="3886871">.</span><span class="ident" id="3886872">Attributes</span>&nbsp;<span class="op" id="3886883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886887">if</span>&nbsp;<span class="op" id="3886890">!</span><span class="ident" id="3886891">atvSet</span><span class="op" id="3886897">.</span><span class="ident" id="3886898">Type</span><span class="op" id="3886902">.</span><span class="ident" id="3886903">Equal</span><span class="op" id="3886908">(</span><span class="ident" id="3886909">oidExtensionRequest</span><span class="op" id="3886928">)</span>&nbsp;<span class="op" id="3886930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886935">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3886946">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886951">for</span>&nbsp;<span class="ident" id="3886955">_</span><span class="op" id="3886956">,</span>&nbsp;<span class="ident" id="3886958">atvs</span>&nbsp;<span class="op" id="3886963">:=</span>&nbsp;<span class="keyword" id="3886966">range</span>&nbsp;<span class="ident" id="3886972">atvSet</span><span class="op" id="3886978">.</span><span class="ident" id="3886979">Value</span>&nbsp;<span class="op" id="3886985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886990">extensions</span>&nbsp;<span class="op" id="3887001">=</span>&nbsp;<span class="builtinfunc" id="3887003">append</span><span class="op" id="3887009">(</span><span class="ident" id="3887010">extensions</span><span class="op" id="3887020">,</span>&nbsp;<span class="ident" id="3887022">atvs</span><span class="op" id="3887026">...</span><span class="op" id="3887029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887036">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887040">out</span><span class="op" id="3887043">.</span><span class="ident" id="3887044">Extensions</span>&nbsp;<span class="op" id="3887055">=</span>&nbsp;<span class="builtinfunc" id="3887057">make</span><span class="op" id="3887061">(</span><span class="op" id="3887062">[</span><span class="op" id="3887063">]</span><span class="ident" id="3887064">pkix</span><span class="op" id="3887068">.</span><span class="ident" id="3887069">Extension</span><span class="op" id="3887078">,</span>&nbsp;<span class="num" id="3887080">0</span><span class="op" id="3887081">,</span>&nbsp;<span class="builtinfunc" id="3887083">len</span><span class="op" id="3887086">(</span><span class="ident" id="3887087">extensions</span><span class="op" id="3887097">)</span><span class="op" id="3887098">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887102">for</span>&nbsp;<span class="ident" id="3887106">_</span><span class="op" id="3887107">,</span>&nbsp;<span class="ident" id="3887109">e</span>&nbsp;<span class="op" id="3887111">:=</span>&nbsp;<span class="keyword" id="3887114">range</span>&nbsp;<span class="ident" id="3887120">extensions</span>&nbsp;<span class="op" id="3887131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887135">value</span><span class="op" id="3887140">,</span>&nbsp;<span class="ident" id="3887142">ok</span>&nbsp;<span class="op" id="3887145">:=</span>&nbsp;<span class="ident" id="3887148">e</span><span class="op" id="3887149">.</span><span class="ident" id="3887150">Value</span><span class="op" id="3887155">.</span><span class="op" id="3887156">(</span><span class="op" id="3887157">[</span><span class="op" id="3887158">]</span><span class="builtintype" id="3887159">byte</span><span class="op" id="3887163">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887167">if</span>&nbsp;<span class="op" id="3887170">!</span><span class="ident" id="3887171">ok</span>&nbsp;<span class="op" id="3887174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887179">return</span>&nbsp;<span class="ident" id="3887186">nil</span><span class="op" id="3887189">,</span>&nbsp;<span class="ident" id="3887191">errors</span><span class="op" id="3887197">.</span><span class="ident" id="3887198">New</span><span class="op" id="3887201">(</span><span class="string" id="3887202">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="3887261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887270">out</span><span class="op" id="3887273">.</span><span class="ident" id="3887274">Extensions</span>&nbsp;<span class="op" id="3887285">=</span>&nbsp;<span class="builtinfunc" id="3887287">append</span><span class="op" id="3887293">(</span><span class="ident" id="3887294">out</span><span class="op" id="3887297">.</span><span class="ident" id="3887298">Extensions</span><span class="op" id="3887308">,</span>&nbsp;<span class="ident" id="3887310">pkix</span><span class="op" id="3887314">.</span><span class="ident" id="3887315">Extension</span><span class="op" id="3887324">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887329">Id</span><span class="op" id="3887331">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3887336">e</span><span class="op" id="3887337">.</span><span class="ident" id="3887338">Type</span><span class="op" id="3887342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887347">Value</span><span class="op" id="3887352">:</span>&nbsp;<span class="ident" id="3887354">value</span><span class="op" id="3887359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887363">}</span><span class="op" id="3887364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887369">if</span>&nbsp;<span class="builtinfunc" id="3887372">len</span><span class="op" id="3887375">(</span><span class="ident" id="3887376">e</span><span class="op" id="3887377">.</span><span class="ident" id="3887378">Type</span><span class="op" id="3887382">)</span>&nbsp;<span class="op" id="3887384">==</span>&nbsp;<span class="num" id="3887387">4</span>&nbsp;<span class="op" id="3887389">&amp;&amp;</span>&nbsp;<span class="ident" id="3887392">e</span><span class="op" id="3887393">.</span><span class="ident" id="3887394">Type</span><span class="op" id="3887398">[</span><span class="num" id="3887399">0</span><span class="op" id="3887400">]</span>&nbsp;<span class="op" id="3887402">==</span>&nbsp;<span class="num" id="3887405">2</span>&nbsp;<span class="op" id="3887407">&amp;&amp;</span>&nbsp;<span class="ident" id="3887410">e</span><span class="op" id="3887411">.</span><span class="ident" id="3887412">Type</span><span class="op" id="3887416">[</span><span class="num" id="3887417">1</span><span class="op" id="3887418">]</span>&nbsp;<span class="op" id="3887420">==</span>&nbsp;<span class="num" id="3887423">5</span>&nbsp;<span class="op" id="3887425">&amp;&amp;</span>&nbsp;<span class="ident" id="3887428">e</span><span class="op" id="3887429">.</span><span class="ident" id="3887430">Type</span><span class="op" id="3887434">[</span><span class="num" id="3887435">2</span><span class="op" id="3887436">]</span>&nbsp;<span class="op" id="3887438">==</span>&nbsp;<span class="num" id="3887441">29</span>&nbsp;<span class="op" id="3887444">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887449">switch</span>&nbsp;<span class="ident" id="3887456">e</span><span class="op" id="3887457">.</span><span class="ident" id="3887458">Type</span><span class="op" id="3887462">[</span><span class="num" id="3887463">3</span><span class="op" id="3887464">]</span>&nbsp;<span class="op" id="3887466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887471">case</span>&nbsp;<span class="num" id="3887476">17</span><span class="op" id="3887478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887484">out</span><span class="op" id="3887487">.</span><span class="ident" id="3887488">DNSNames</span><span class="op" id="3887496">,</span>&nbsp;<span class="ident" id="3887498">out</span><span class="op" id="3887501">.</span><span class="ident" id="3887502">EmailAddresses</span><span class="op" id="3887516">,</span>&nbsp;<span class="ident" id="3887518">out</span><span class="op" id="3887521">.</span><span class="ident" id="3887522">IPAddresses</span><span class="op" id="3887533">,</span>&nbsp;<span class="ident" id="3887535">err</span>&nbsp;<span class="op" id="3887539">=</span>&nbsp;<span class="ident" id="3887541">parseSANExtension</span><span class="op" id="3887558">(</span><span class="ident" id="3887559">value</span><span class="op" id="3887564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887570">if</span>&nbsp;<span class="ident" id="3887573">err</span>&nbsp;<span class="op" id="3887577">!=</span>&nbsp;<span class="ident" id="3887580">nil</span>&nbsp;<span class="op" id="3887584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887591">return</span>&nbsp;<span class="ident" id="3887598">nil</span><span class="op" id="3887601">,</span>&nbsp;<span class="ident" id="3887603">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887627">return</span>&nbsp;<span class="ident" id="3887634">out</span><span class="op" id="3887637">,</span>&nbsp;<span class="ident" id="3887639">nil</span><br>
<span class="lineno"></span><span class="op" id="3887643">}</span>
</div>
</body>
</html>
