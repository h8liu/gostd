<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httputil</h2>
<ul>
<li><a href="/gostd/net/http/httputil/dump.go.html">dump.go</a></li>
<li><a href="/gostd/net/http/httputil/dump_test.go.html">dump_test.go</a></li>
<li><a href="/gostd/net/http/httputil/httputil.go.html">httputil.go</a></li>
<li><a href="/gostd/net/http/httputil/persist.go.html">persist.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy.go.html">reverseproxy.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy_test.go.html">reverseproxy_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8230902">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8230957">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8231011">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8231062">package</span>&nbsp;<span class="ident" id="8231070">httputil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8231080">import</span>&nbsp;<span class="op" id="8231087">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231090">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231099">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231106">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231112">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231125">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231137">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231148">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231159">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231170">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8231180">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8231183">type</span>&nbsp;<span class="ident" id="8231188">dumpTest</span>&nbsp;<span class="keyword" id="8231197">struct</span>&nbsp;<span class="op" id="8231204">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231207">Req</span>&nbsp;&nbsp;<span class="ident" id="8231212">http</span><span class="op" id="8231216">.</span><span class="ident" id="8231217">Request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231226">Body</span>&nbsp;<span class="keyword" id="8231231">interface</span><span class="op" id="8231240">{</span><span class="op" id="8231241">}</span>&nbsp;<span class="comment" id="8231243">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231309">WantDump</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8231321">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231329">WantDumpOut</span>&nbsp;<span class="builtintype" id="8231341">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231349">NoBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8231361">bool</span>&nbsp;<span class="comment" id="8231366">//&nbsp;if&nbsp;true,&nbsp;set&nbsp;DumpRequest{,Out}&nbsp;body&nbsp;to&nbsp;false</span><br>
<span class="lineno"></span><span class="op" id="8231414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8231417">var</span>&nbsp;<span class="ident" id="8231421">dumpTests</span>&nbsp;<span class="op" id="8231431">=</span>&nbsp;<span class="op" id="8231433">[</span><span class="op" id="8231434">]</span><span class="ident" id="8231435">dumpTest</span><span class="op" id="8231443">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8231447">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231503">Req</span><span class="op" id="8231506">:</span>&nbsp;<span class="ident" id="8231508">http</span><span class="op" id="8231512">.</span><span class="ident" id="8231513">Request</span><span class="op" id="8231520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231525">Method</span><span class="op" id="8231531">:</span>&nbsp;<span class="string" id="8231533">&#34;GET&#34;</span><span class="op" id="8231538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231543">URL</span><span class="op" id="8231546">:</span>&nbsp;<span class="op" id="8231548">&amp;</span><span class="ident" id="8231549">url</span><span class="op" id="8231552">.</span><span class="ident" id="8231553">URL</span><span class="op" id="8231556">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231562">Scheme</span><span class="op" id="8231568">:</span>&nbsp;<span class="string" id="8231570">&#34;http&#34;</span><span class="op" id="8231576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231582">Host</span><span class="op" id="8231586">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8231590">&#34;www.google.com&#34;</span><span class="op" id="8231606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231612">Path</span><span class="op" id="8231616">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8231620">&#34;/search&#34;</span><span class="op" id="8231629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231634">}</span><span class="op" id="8231635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231640">ProtoMajor</span><span class="op" id="8231650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8231658">1</span><span class="op" id="8231659">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231664">ProtoMinor</span><span class="op" id="8231674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8231682">1</span><span class="op" id="8231683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231688">TransferEncoding</span><span class="op" id="8231704">:</span>&nbsp;<span class="op" id="8231706">[</span><span class="op" id="8231707">]</span><span class="builtintype" id="8231708">string</span><span class="op" id="8231714">{</span><span class="string" id="8231715">&#34;chunked&#34;</span><span class="op" id="8231724">}</span><span class="op" id="8231725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231729">}</span><span class="op" id="8231730">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231735">Body</span><span class="op" id="8231739">:</span>&nbsp;<span class="op" id="8231741">[</span><span class="op" id="8231742">]</span><span class="builtintype" id="8231743">byte</span><span class="op" id="8231747">(</span><span class="string" id="8231748">&#34;abcdef&#34;</span><span class="op" id="8231756">)</span><span class="op" id="8231757">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231762">WantDump</span><span class="op" id="8231770">:</span>&nbsp;<span class="string" id="8231772">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8231799">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231804">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8231831">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8231836">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8231873">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8231878">chunk</span><span class="op" id="8231883">(</span><span class="string" id="8231884">&#34;abcdef&#34;</span><span class="op" id="8231892">)</span>&nbsp;<span class="op" id="8231894">+</span>&nbsp;<span class="ident" id="8231896">chunk</span><span class="op" id="8231901">(</span><span class="string" id="8231902">&#34;&#34;</span><span class="op" id="8231904">)</span><span class="op" id="8231905">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8231908">}</span><span class="op" id="8231909">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8231913">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8231996">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232030">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232034">Req</span><span class="op" id="8232037">:</span>&nbsp;<span class="ident" id="8232039">http</span><span class="op" id="8232043">.</span><span class="ident" id="8232044">Request</span><span class="op" id="8232051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232056">Method</span><span class="op" id="8232062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8232068">&#34;GET&#34;</span><span class="op" id="8232073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232078">URL</span><span class="op" id="8232081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232090">mustParseURL</span><span class="op" id="8232102">(</span><span class="string" id="8232103">&#34;/foo&#34;</span><span class="op" id="8232109">)</span><span class="op" id="8232110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232115">ProtoMajor</span><span class="op" id="8232125">:</span>&nbsp;<span class="num" id="8232127">1</span><span class="op" id="8232128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232133">ProtoMinor</span><span class="op" id="8232143">:</span>&nbsp;<span class="num" id="8232145">0</span><span class="op" id="8232146">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232151">Header</span><span class="op" id="8232157">:</span>&nbsp;<span class="ident" id="8232159">http</span><span class="op" id="8232163">.</span><span class="ident" id="8232164">Header</span><span class="op" id="8232170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232176">&#34;X-Foo&#34;</span><span class="op" id="8232183">:</span>&nbsp;<span class="op" id="8232185">[</span><span class="op" id="8232186">]</span><span class="builtintype" id="8232187">string</span><span class="op" id="8232193">{</span><span class="string" id="8232194">&#34;X-Bar&#34;</span><span class="op" id="8232201">}</span><span class="op" id="8232202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232207">}</span><span class="op" id="8232208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232212">}</span><span class="op" id="8232213">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232218">WantDump</span><span class="op" id="8232226">:</span>&nbsp;<span class="string" id="8232228">&#34;GET&nbsp;/foo&nbsp;HTTP/1.0\r\n&#34;</span>&nbsp;<span class="op" id="8232252">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232257">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="8232279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232282">}</span><span class="op" id="8232283">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232287">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232291">Req</span><span class="op" id="8232294">:</span>&nbsp;<span class="op" id="8232296">*</span><span class="ident" id="8232297">mustNewRequest</span><span class="op" id="8232311">(</span><span class="string" id="8232312">&#34;GET&#34;</span><span class="op" id="8232317">,</span>&nbsp;<span class="string" id="8232319">&#34;http://example.com/foo&#34;</span><span class="op" id="8232343">,</span>&nbsp;<span class="ident" id="8232345">nil</span><span class="op" id="8232348">)</span><span class="op" id="8232349">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232354">WantDumpOut</span><span class="op" id="8232365">:</span>&nbsp;<span class="string" id="8232367">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8232391">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232396">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8232420">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232425">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8232463">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232468">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8232499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232502">}</span><span class="op" id="8232503">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8232507">//&nbsp;Test&nbsp;that&nbsp;an&nbsp;https&nbsp;URL&nbsp;doesn&#39;t&nbsp;try&nbsp;to&nbsp;do&nbsp;an&nbsp;SSL&nbsp;negotiation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8232571">//&nbsp;with&nbsp;a&nbsp;bytes.Buffer&nbsp;and&nbsp;hang&nbsp;with&nbsp;all&nbsp;goroutines&nbsp;not</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8232628">//&nbsp;runnable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232646">Req</span><span class="op" id="8232649">:</span>&nbsp;<span class="op" id="8232651">*</span><span class="ident" id="8232652">mustNewRequest</span><span class="op" id="8232666">(</span><span class="string" id="8232667">&#34;GET&#34;</span><span class="op" id="8232672">,</span>&nbsp;<span class="string" id="8232674">&#34;https://example.com/foo&#34;</span><span class="op" id="8232699">,</span>&nbsp;<span class="ident" id="8232701">nil</span><span class="op" id="8232704">)</span><span class="op" id="8232705">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232710">WantDumpOut</span><span class="op" id="8232721">:</span>&nbsp;<span class="string" id="8232723">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8232747">+</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232752">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8232776">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232781">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8232819">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8232824">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8232855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232858">}</span><span class="op" id="8232859">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8232863">//&nbsp;Request&nbsp;with&nbsp;Body,&nbsp;but&nbsp;Dump&nbsp;requested&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8232917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232921">Req</span><span class="op" id="8232924">:</span>&nbsp;<span class="ident" id="8232926">http</span><span class="op" id="8232930">.</span><span class="ident" id="8232931">Request</span><span class="op" id="8232938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232943">Method</span><span class="op" id="8232949">:</span>&nbsp;<span class="string" id="8232951">&#34;POST&#34;</span><span class="op" id="8232957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232962">URL</span><span class="op" id="8232965">:</span>&nbsp;<span class="op" id="8232967">&amp;</span><span class="ident" id="8232968">url</span><span class="op" id="8232971">.</span><span class="ident" id="8232972">URL</span><span class="op" id="8232975">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8232981">Scheme</span><span class="op" id="8232987">:</span>&nbsp;<span class="string" id="8232989">&#34;http&#34;</span><span class="op" id="8232995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233001">Host</span><span class="op" id="8233005">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8233009">&#34;post.tld&#34;</span><span class="op" id="8233019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233025">Path</span><span class="op" id="8233029">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8233033">&#34;/&#34;</span><span class="op" id="8233036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233041">}</span><span class="op" id="8233042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233047">ContentLength</span><span class="op" id="8233060">:</span>&nbsp;<span class="num" id="8233062">6</span><span class="op" id="8233063">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233068">ProtoMajor</span><span class="op" id="8233078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8233083">1</span><span class="op" id="8233084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233089">ProtoMinor</span><span class="op" id="8233099">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8233104">1</span><span class="op" id="8233105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233109">}</span><span class="op" id="8233110">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233115">Body</span><span class="op" id="8233119">:</span>&nbsp;<span class="op" id="8233121">[</span><span class="op" id="8233122">]</span><span class="builtintype" id="8233123">byte</span><span class="op" id="8233127">(</span><span class="string" id="8233128">&#34;abcdef&#34;</span><span class="op" id="8233136">)</span><span class="op" id="8233137">,</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233142">WantDumpOut</span><span class="op" id="8233153">:</span>&nbsp;<span class="string" id="8233155">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8233177">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233182">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="8233203">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233208">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8233246">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233251">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8233275">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233280">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8233311">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233316">NoBody</span><span class="op" id="8233322">:</span>&nbsp;<span class="builtintype" id="8233324">true</span><span class="op" id="8233328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233331">}</span><span class="op" id="8233332">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8233336">//&nbsp;Request&nbsp;with&nbsp;Body&nbsp;&gt;&nbsp;8196&nbsp;(default&nbsp;buffer&nbsp;size)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233391">Req</span><span class="op" id="8233394">:</span>&nbsp;<span class="ident" id="8233396">http</span><span class="op" id="8233400">.</span><span class="ident" id="8233401">Request</span><span class="op" id="8233408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233413">Method</span><span class="op" id="8233419">:</span>&nbsp;<span class="string" id="8233421">&#34;POST&#34;</span><span class="op" id="8233427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233432">URL</span><span class="op" id="8233435">:</span>&nbsp;<span class="op" id="8233437">&amp;</span><span class="ident" id="8233438">url</span><span class="op" id="8233441">.</span><span class="ident" id="8233442">URL</span><span class="op" id="8233445">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233451">Scheme</span><span class="op" id="8233457">:</span>&nbsp;<span class="string" id="8233459">&#34;http&#34;</span><span class="op" id="8233465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233471">Host</span><span class="op" id="8233475">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8233479">&#34;post.tld&#34;</span><span class="op" id="8233489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233495">Path</span><span class="op" id="8233499">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8233503">&#34;/&#34;</span><span class="op" id="8233506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233511">}</span><span class="op" id="8233512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233517">ContentLength</span><span class="op" id="8233530">:</span>&nbsp;<span class="num" id="8233532">8193</span><span class="op" id="8233536">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233541">ProtoMajor</span><span class="op" id="8233551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8233556">1</span><span class="op" id="8233557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233562">ProtoMinor</span><span class="op" id="8233572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8233577">1</span><span class="op" id="8233578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233582">}</span><span class="op" id="8233583">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233588">Body</span><span class="op" id="8233592">:</span>&nbsp;<span class="ident" id="8233594">bytes</span><span class="op" id="8233599">.</span><span class="ident" id="8233600">Repeat</span><span class="op" id="8233606">(</span><span class="op" id="8233607">[</span><span class="op" id="8233608">]</span><span class="builtintype" id="8233609">byte</span><span class="op" id="8233613">(</span><span class="string" id="8233614">&#34;a&#34;</span><span class="op" id="8233617">)</span><span class="op" id="8233618">,</span>&nbsp;<span class="num" id="8233620">8193</span><span class="op" id="8233624">)</span><span class="op" id="8233625">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233630">WantDumpOut</span><span class="op" id="8233641">:</span>&nbsp;<span class="string" id="8233643">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8233665">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233670">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="8233691">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233696">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8233734">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233739">&#34;Content-Length:&nbsp;8193\r\n&#34;</span>&nbsp;<span class="op" id="8233766">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8233771">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8233803">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233808">strings</span><span class="op" id="8233815">.</span><span class="ident" id="8233816">Repeat</span><span class="op" id="8233822">(</span><span class="string" id="8233823">&#34;a&#34;</span><span class="op" id="8233826">,</span>&nbsp;<span class="num" id="8233828">8193</span><span class="op" id="8233832">)</span><span class="op" id="8233833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8233836">}</span><span class="op" id="8233837">,</span><br>
<span class="lineno"></span><span class="op" id="8233839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="8233842">func</span>&nbsp;<span class="ident" id="8233847">TestDumpRequest</span><span class="op" id="8233862">(</span><span class="ident" id="8233863">t</span>&nbsp;<span class="op" id="8233865">*</span><span class="ident" id="8233866">testing</span><span class="op" id="8233873">.</span><span class="ident" id="8233874">T</span><span class="op" id="8233875">)</span>&nbsp;<span class="op" id="8233877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233880">numg0</span>&nbsp;<span class="op" id="8233886">:=</span>&nbsp;<span class="ident" id="8233889">runtime</span><span class="op" id="8233896">.</span><span class="ident" id="8233897">NumGoroutine</span><span class="op" id="8233909">(</span><span class="op" id="8233910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233913">for</span>&nbsp;<span class="ident" id="8233917">i</span><span class="op" id="8233918">,</span>&nbsp;<span class="ident" id="8233920">tt</span>&nbsp;<span class="op" id="8233923">:=</span>&nbsp;<span class="keyword" id="8233926">range</span>&nbsp;<span class="ident" id="8233932">dumpTests</span>&nbsp;<span class="op" id="8233942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8233946">setBody</span>&nbsp;<span class="op" id="8233954">:=</span>&nbsp;<span class="keyword" id="8233957">func</span><span class="op" id="8233961">(</span><span class="op" id="8233962">)</span>&nbsp;<span class="op" id="8233964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233969">if</span>&nbsp;<span class="ident" id="8233972">tt</span><span class="op" id="8233974">.</span><span class="ident" id="8233975">Body</span>&nbsp;<span class="op" id="8233980">==</span>&nbsp;<span class="ident" id="8233983">nil</span>&nbsp;<span class="op" id="8233987">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8233993">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234008">switch</span>&nbsp;<span class="ident" id="8234015">b</span>&nbsp;<span class="op" id="8234017">:=</span>&nbsp;<span class="ident" id="8234020">tt</span><span class="op" id="8234022">.</span><span class="ident" id="8234023">Body</span><span class="op" id="8234027">.</span><span class="op" id="8234028">(</span><span class="keyword" id="8234029">type</span><span class="op" id="8234033">)</span>&nbsp;<span class="op" id="8234035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234040">case</span>&nbsp;<span class="op" id="8234045">[</span><span class="op" id="8234046">]</span><span class="builtintype" id="8234047">byte</span><span class="op" id="8234051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234057">tt</span><span class="op" id="8234059">.</span><span class="ident" id="8234060">Req</span><span class="op" id="8234063">.</span><span class="ident" id="8234064">Body</span>&nbsp;<span class="op" id="8234069">=</span>&nbsp;<span class="ident" id="8234071">ioutil</span><span class="op" id="8234077">.</span><span class="ident" id="8234078">NopCloser</span><span class="op" id="8234087">(</span><span class="ident" id="8234088">bytes</span><span class="op" id="8234093">.</span><span class="ident" id="8234094">NewReader</span><span class="op" id="8234103">(</span><span class="ident" id="8234104">b</span><span class="op" id="8234105">)</span><span class="op" id="8234106">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234111">case</span>&nbsp;<span class="keyword" id="8234116">func</span><span class="op" id="8234120">(</span><span class="op" id="8234121">)</span>&nbsp;<span class="ident" id="8234123">io</span><span class="op" id="8234125">.</span><span class="ident" id="8234126">ReadCloser</span><span class="op" id="8234136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234142">tt</span><span class="op" id="8234144">.</span><span class="ident" id="8234145">Req</span><span class="op" id="8234148">.</span><span class="ident" id="8234149">Body</span>&nbsp;<span class="op" id="8234154">=</span>&nbsp;<span class="ident" id="8234156">b</span><span class="op" id="8234157">(</span><span class="op" id="8234158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234163">default</span><span class="op" id="8234170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234176">t</span><span class="op" id="8234177">.</span><span class="ident" id="8234178">Fatalf</span><span class="op" id="8234184">(</span><span class="string" id="8234185">&#34;Test&nbsp;%d:&nbsp;unsupported&nbsp;Body&nbsp;of&nbsp;%T&#34;</span><span class="op" id="8234218">,</span>&nbsp;<span class="ident" id="8234220">i</span><span class="op" id="8234221">,</span>&nbsp;<span class="ident" id="8234223">tt</span><span class="op" id="8234225">.</span><span class="ident" id="8234226">Body</span><span class="op" id="8234230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234235">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234243">setBody</span><span class="op" id="8234250">(</span><span class="op" id="8234251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234255">if</span>&nbsp;<span class="ident" id="8234258">tt</span><span class="op" id="8234260">.</span><span class="ident" id="8234261">Req</span><span class="op" id="8234264">.</span><span class="ident" id="8234265">Header</span>&nbsp;<span class="op" id="8234272">==</span>&nbsp;<span class="ident" id="8234275">nil</span>&nbsp;<span class="op" id="8234279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234284">tt</span><span class="op" id="8234286">.</span><span class="ident" id="8234287">Req</span><span class="op" id="8234290">.</span><span class="ident" id="8234291">Header</span>&nbsp;<span class="op" id="8234298">=</span>&nbsp;<span class="builtinfunc" id="8234300">make</span><span class="op" id="8234304">(</span><span class="ident" id="8234305">http</span><span class="op" id="8234309">.</span><span class="ident" id="8234310">Header</span><span class="op" id="8234316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234320">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234325">if</span>&nbsp;<span class="ident" id="8234328">tt</span><span class="op" id="8234330">.</span><span class="ident" id="8234331">WantDump</span>&nbsp;<span class="op" id="8234340">!=</span>&nbsp;<span class="string" id="8234343">&#34;&#34;</span>&nbsp;<span class="op" id="8234346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234351">setBody</span><span class="op" id="8234358">(</span><span class="op" id="8234359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234364">dump</span><span class="op" id="8234368">,</span>&nbsp;<span class="ident" id="8234370">err</span>&nbsp;<span class="op" id="8234374">:=</span>&nbsp;<span class="ident" id="8234377">DumpRequest</span><span class="op" id="8234388">(</span><span class="op" id="8234389">&amp;</span><span class="ident" id="8234390">tt</span><span class="op" id="8234392">.</span><span class="ident" id="8234393">Req</span><span class="op" id="8234396">,</span>&nbsp;<span class="op" id="8234398">!</span><span class="ident" id="8234399">tt</span><span class="op" id="8234401">.</span><span class="ident" id="8234402">NoBody</span><span class="op" id="8234408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234413">if</span>&nbsp;<span class="ident" id="8234416">err</span>&nbsp;<span class="op" id="8234420">!=</span>&nbsp;<span class="ident" id="8234423">nil</span>&nbsp;<span class="op" id="8234427">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234433">t</span><span class="op" id="8234434">.</span><span class="ident" id="8234435">Errorf</span><span class="op" id="8234441">(</span><span class="string" id="8234442">&#34;DumpRequest&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8234463">,</span>&nbsp;<span class="ident" id="8234465">i</span><span class="op" id="8234466">,</span>&nbsp;<span class="ident" id="8234468">err</span><span class="op" id="8234471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234477">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234494">if</span>&nbsp;<span class="builtintype" id="8234497">string</span><span class="op" id="8234503">(</span><span class="ident" id="8234504">dump</span><span class="op" id="8234508">)</span>&nbsp;<span class="op" id="8234510">!=</span>&nbsp;<span class="ident" id="8234513">tt</span><span class="op" id="8234515">.</span><span class="ident" id="8234516">WantDump</span>&nbsp;<span class="op" id="8234525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234531">t</span><span class="op" id="8234532">.</span><span class="ident" id="8234533">Errorf</span><span class="op" id="8234539">(</span><span class="string" id="8234540">&#34;DumpRequest&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8234584">,</span>&nbsp;<span class="ident" id="8234586">i</span><span class="op" id="8234587">,</span>&nbsp;<span class="ident" id="8234589">tt</span><span class="op" id="8234591">.</span><span class="ident" id="8234592">WantDump</span><span class="op" id="8234600">,</span>&nbsp;<span class="builtintype" id="8234602">string</span><span class="op" id="8234608">(</span><span class="ident" id="8234609">dump</span><span class="op" id="8234613">)</span><span class="op" id="8234614">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234620">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234641">if</span>&nbsp;<span class="ident" id="8234644">tt</span><span class="op" id="8234646">.</span><span class="ident" id="8234647">WantDumpOut</span>&nbsp;<span class="op" id="8234659">!=</span>&nbsp;<span class="string" id="8234662">&#34;&#34;</span>&nbsp;<span class="op" id="8234665">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234670">setBody</span><span class="op" id="8234677">(</span><span class="op" id="8234678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234683">dump</span><span class="op" id="8234687">,</span>&nbsp;<span class="ident" id="8234689">err</span>&nbsp;<span class="op" id="8234693">:=</span>&nbsp;<span class="ident" id="8234696">DumpRequestOut</span><span class="op" id="8234710">(</span><span class="op" id="8234711">&amp;</span><span class="ident" id="8234712">tt</span><span class="op" id="8234714">.</span><span class="ident" id="8234715">Req</span><span class="op" id="8234718">,</span>&nbsp;<span class="op" id="8234720">!</span><span class="ident" id="8234721">tt</span><span class="op" id="8234723">.</span><span class="ident" id="8234724">NoBody</span><span class="op" id="8234730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234735">if</span>&nbsp;<span class="ident" id="8234738">err</span>&nbsp;<span class="op" id="8234742">!=</span>&nbsp;<span class="ident" id="8234745">nil</span>&nbsp;<span class="op" id="8234749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234755">t</span><span class="op" id="8234756">.</span><span class="ident" id="8234757">Errorf</span><span class="op" id="8234763">(</span><span class="string" id="8234764">&#34;DumpRequestOut&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8234788">,</span>&nbsp;<span class="ident" id="8234790">i</span><span class="op" id="8234791">,</span>&nbsp;<span class="ident" id="8234793">err</span><span class="op" id="8234796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234802">continue</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234819">if</span>&nbsp;<span class="builtintype" id="8234822">string</span><span class="op" id="8234828">(</span><span class="ident" id="8234829">dump</span><span class="op" id="8234833">)</span>&nbsp;<span class="op" id="8234835">!=</span>&nbsp;<span class="ident" id="8234838">tt</span><span class="op" id="8234840">.</span><span class="ident" id="8234841">WantDumpOut</span>&nbsp;<span class="op" id="8234853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8234859">t</span><span class="op" id="8234860">.</span><span class="ident" id="8234861">Errorf</span><span class="op" id="8234867">(</span><span class="string" id="8234868">&#34;DumpRequestOut&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8234915">,</span>&nbsp;<span class="ident" id="8234917">i</span><span class="op" id="8234918">,</span>&nbsp;<span class="ident" id="8234920">tt</span><span class="op" id="8234922">.</span><span class="ident" id="8234923">WantDumpOut</span><span class="op" id="8234934">,</span>&nbsp;<span class="builtintype" id="8234936">string</span><span class="op" id="8234942">(</span><span class="ident" id="8234943">dump</span><span class="op" id="8234947">)</span><span class="op" id="8234948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234954">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234966">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8234973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8234976">if</span>&nbsp;<span class="ident" id="8234979">dg</span>&nbsp;<span class="op" id="8234982">:=</span>&nbsp;<span class="ident" id="8234985">runtime</span><span class="op" id="8234992">.</span><span class="ident" id="8234993">NumGoroutine</span><span class="op" id="8235005">(</span><span class="op" id="8235006">)</span>&nbsp;<span class="op" id="8235008">-</span>&nbsp;<span class="ident" id="8235010">numg0</span><span class="op" id="8235015">;</span>&nbsp;<span class="ident" id="8235017">dg</span>&nbsp;<span class="op" id="8235020">&gt;</span>&nbsp;<span class="num" id="8235022">4</span>&nbsp;<span class="op" id="8235024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235028">buf</span>&nbsp;<span class="op" id="8235032">:=</span>&nbsp;<span class="builtinfunc" id="8235035">make</span><span class="op" id="8235039">(</span><span class="op" id="8235040">[</span><span class="op" id="8235041">]</span><span class="builtintype" id="8235042">byte</span><span class="op" id="8235046">,</span>&nbsp;<span class="num" id="8235048">4096</span><span class="op" id="8235052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235056">buf</span>&nbsp;<span class="op" id="8235060">=</span>&nbsp;<span class="ident" id="8235062">buf</span><span class="op" id="8235065">[</span><span class="op" id="8235066">:</span><span class="ident" id="8235067">runtime</span><span class="op" id="8235074">.</span><span class="ident" id="8235075">Stack</span><span class="op" id="8235080">(</span><span class="ident" id="8235081">buf</span><span class="op" id="8235084">,</span>&nbsp;<span class="builtintype" id="8235086">true</span><span class="op" id="8235090">)</span><span class="op" id="8235091">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235095">t</span><span class="op" id="8235096">.</span><span class="ident" id="8235097">Errorf</span><span class="op" id="8235103">(</span><span class="string" id="8235104">&#34;Unexpectedly&nbsp;large&nbsp;number&nbsp;of&nbsp;new&nbsp;goroutines:&nbsp;%d&nbsp;new:&nbsp;%s&#34;</span><span class="op" id="8235161">,</span>&nbsp;<span class="ident" id="8235163">dg</span><span class="op" id="8235165">,</span>&nbsp;<span class="ident" id="8235167">buf</span><span class="op" id="8235170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235173">}</span><br>
<span class="lineno"></span><span class="op" id="8235175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8235178">func</span>&nbsp;<span class="ident" id="8235183">chunk</span><span class="op" id="8235188">(</span><span class="ident" id="8235189">s</span>&nbsp;<span class="builtintype" id="8235191">string</span><span class="op" id="8235197">)</span>&nbsp;<span class="builtintype" id="8235199">string</span>&nbsp;<span class="op" id="8235206">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235209">return</span>&nbsp;<span class="ident" id="8235216">fmt</span><span class="op" id="8235219">.</span><span class="ident" id="8235220">Sprintf</span><span class="op" id="8235227">(</span><span class="string" id="8235228">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="8235242">,</span>&nbsp;<span class="builtinfunc" id="8235244">len</span><span class="op" id="8235247">(</span><span class="ident" id="8235248">s</span><span class="op" id="8235249">)</span><span class="op" id="8235250">,</span>&nbsp;<span class="ident" id="8235252">s</span><span class="op" id="8235253">)</span><br>
<span class="lineno"></span><span class="op" id="8235255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8235258">func</span>&nbsp;<span class="ident" id="8235263">mustParseURL</span><span class="op" id="8235275">(</span><span class="ident" id="8235276">s</span>&nbsp;<span class="builtintype" id="8235278">string</span><span class="op" id="8235284">)</span>&nbsp;<span class="op" id="8235286">*</span><span class="ident" id="8235287">url</span><span class="op" id="8235290">.</span><span class="ident" id="8235291">URL</span>&nbsp;<span class="op" id="8235295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235298">u</span><span class="op" id="8235299">,</span>&nbsp;<span class="ident" id="8235301">err</span>&nbsp;<span class="op" id="8235305">:=</span>&nbsp;<span class="ident" id="8235308">url</span><span class="op" id="8235311">.</span><span class="ident" id="8235312">Parse</span><span class="op" id="8235317">(</span><span class="ident" id="8235318">s</span><span class="op" id="8235319">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235322">if</span>&nbsp;<span class="ident" id="8235325">err</span>&nbsp;<span class="op" id="8235329">!=</span>&nbsp;<span class="ident" id="8235332">nil</span>&nbsp;<span class="op" id="8235336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8235340">panic</span><span class="op" id="8235345">(</span><span class="ident" id="8235346">fmt</span><span class="op" id="8235349">.</span><span class="ident" id="8235350">Sprintf</span><span class="op" id="8235357">(</span><span class="string" id="8235358">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8235384">,</span>&nbsp;<span class="ident" id="8235386">s</span><span class="op" id="8235387">,</span>&nbsp;<span class="ident" id="8235389">err</span><span class="op" id="8235392">)</span><span class="op" id="8235393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235399">return</span>&nbsp;<span class="ident" id="8235406">u</span><br>
<span class="lineno"></span><span class="op" id="8235408">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="8235411">func</span>&nbsp;<span class="ident" id="8235416">mustNewRequest</span><span class="op" id="8235430">(</span><span class="ident" id="8235431">method</span><span class="op" id="8235437">,</span>&nbsp;<span class="ident" id="8235439">url</span>&nbsp;<span class="builtintype" id="8235443">string</span><span class="op" id="8235449">,</span>&nbsp;<span class="ident" id="8235451">body</span>&nbsp;<span class="ident" id="8235456">io</span><span class="op" id="8235458">.</span><span class="ident" id="8235459">Reader</span><span class="op" id="8235465">)</span>&nbsp;<span class="op" id="8235467">*</span><span class="ident" id="8235468">http</span><span class="op" id="8235472">.</span><span class="ident" id="8235473">Request</span>&nbsp;<span class="op" id="8235481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235484">req</span><span class="op" id="8235487">,</span>&nbsp;<span class="ident" id="8235489">err</span>&nbsp;<span class="op" id="8235493">:=</span>&nbsp;<span class="ident" id="8235496">http</span><span class="op" id="8235500">.</span><span class="ident" id="8235501">NewRequest</span><span class="op" id="8235511">(</span><span class="ident" id="8235512">method</span><span class="op" id="8235518">,</span>&nbsp;<span class="ident" id="8235520">url</span><span class="op" id="8235523">,</span>&nbsp;<span class="ident" id="8235525">body</span><span class="op" id="8235529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235532">if</span>&nbsp;<span class="ident" id="8235535">err</span>&nbsp;<span class="op" id="8235539">!=</span>&nbsp;<span class="ident" id="8235542">nil</span>&nbsp;<span class="op" id="8235546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8235550">panic</span><span class="op" id="8235555">(</span><span class="ident" id="8235556">fmt</span><span class="op" id="8235559">.</span><span class="ident" id="8235560">Sprintf</span><span class="op" id="8235567">(</span><span class="string" id="8235568">&#34;NewRequest(%q,&nbsp;%q,&nbsp;%p)&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8235601">,</span>&nbsp;<span class="ident" id="8235603">method</span><span class="op" id="8235609">,</span>&nbsp;<span class="ident" id="8235611">url</span><span class="op" id="8235614">,</span>&nbsp;<span class="ident" id="8235616">body</span><span class="op" id="8235620">,</span>&nbsp;<span class="ident" id="8235622">err</span><span class="op" id="8235625">)</span><span class="op" id="8235626">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8235632">return</span>&nbsp;<span class="ident" id="8235639">req</span><br>
<span class="lineno"></span><span class="op" id="8235643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8235646">var</span>&nbsp;<span class="ident" id="8235650">dumpResTests</span>&nbsp;<span class="op" id="8235663">=</span>&nbsp;<span class="op" id="8235665">[</span><span class="op" id="8235666">]</span><span class="keyword" id="8235667">struct</span>&nbsp;<span class="op" id="8235674">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235677">res</span>&nbsp;&nbsp;<span class="op" id="8235682">*</span><span class="ident" id="8235683">http</span><span class="op" id="8235687">.</span><span class="ident" id="8235688">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235698">body</span>&nbsp;<span class="builtintype" id="8235703">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235709">want</span>&nbsp;<span class="builtintype" id="8235714">string</span><br>
<span class="lineno"></span><span class="op" id="8235721">}</span><span class="op" id="8235722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235725">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235729">res</span><span class="op" id="8235732">:</span>&nbsp;<span class="op" id="8235734">&amp;</span><span class="ident" id="8235735">http</span><span class="op" id="8235739">.</span><span class="ident" id="8235740">Response</span><span class="op" id="8235748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235753">Status</span><span class="op" id="8235759">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8235768">&#34;200&nbsp;OK&#34;</span><span class="op" id="8235776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235781">StatusCode</span><span class="op" id="8235791">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8235796">200</span><span class="op" id="8235799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235804">Proto</span><span class="op" id="8235809">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8235819">&#34;HTTP/1.1&#34;</span><span class="op" id="8235829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235834">ProtoMajor</span><span class="op" id="8235844">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8235849">1</span><span class="op" id="8235850">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235855">ProtoMinor</span><span class="op" id="8235865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8235870">1</span><span class="op" id="8235871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235876">ContentLength</span><span class="op" id="8235889">:</span>&nbsp;<span class="num" id="8235891">50</span><span class="op" id="8235893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235898">Header</span><span class="op" id="8235904">:</span>&nbsp;<span class="ident" id="8235906">http</span><span class="op" id="8235910">.</span><span class="ident" id="8235911">Header</span><span class="op" id="8235917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8235923">&#34;Foo&#34;</span><span class="op" id="8235928">:</span>&nbsp;<span class="op" id="8235930">[</span><span class="op" id="8235931">]</span><span class="builtintype" id="8235932">string</span><span class="op" id="8235938">{</span><span class="string" id="8235939">&#34;Bar&#34;</span><span class="op" id="8235944">}</span><span class="op" id="8235945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8235950">}</span><span class="op" id="8235951">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8235956">Body</span><span class="op" id="8235960">:</span>&nbsp;<span class="ident" id="8235962">ioutil</span><span class="op" id="8235968">.</span><span class="ident" id="8235969">NopCloser</span><span class="op" id="8235978">(</span><span class="ident" id="8235979">strings</span><span class="op" id="8235986">.</span><span class="ident" id="8235987">NewReader</span><span class="op" id="8235996">(</span><span class="string" id="8235997">&#34;foo&#34;</span><span class="op" id="8236002">)</span><span class="op" id="8236003">)</span><span class="op" id="8236004">,</span>&nbsp;<span class="comment" id="8236006">//&nbsp;shouldn&#39;t&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236029">}</span><span class="op" id="8236030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236034">body</span><span class="op" id="8236038">:</span>&nbsp;<span class="builtintype" id="8236040">false</span><span class="op" id="8236045">,</span>&nbsp;<span class="comment" id="8236047">//&nbsp;to&nbsp;verify&nbsp;we&nbsp;see&nbsp;50,&nbsp;not&nbsp;empty&nbsp;or&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236089">want</span><span class="op" id="8236093">:</span>&nbsp;<span class="string" id="8236095">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Content-Length:&nbsp;50<br>
<span class="lineno">235</span>Foo:&nbsp;Bar`</span><span class="op" id="8236140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236143">}</span><span class="op" id="8236144">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236152">res</span><span class="op" id="8236155">:</span>&nbsp;<span class="op" id="8236157">&amp;</span><span class="ident" id="8236158">http</span><span class="op" id="8236162">.</span><span class="ident" id="8236163">Response</span><span class="op" id="8236171">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236176">Status</span><span class="op" id="8236182">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8236191">&#34;200&nbsp;OK&#34;</span><span class="op" id="8236199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236204">StatusCode</span><span class="op" id="8236214">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8236219">200</span><span class="op" id="8236222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236227">Proto</span><span class="op" id="8236232">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8236242">&#34;HTTP/1.1&#34;</span><span class="op" id="8236252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236257">ProtoMajor</span><span class="op" id="8236267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8236272">1</span><span class="op" id="8236273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236278">ProtoMinor</span><span class="op" id="8236288">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8236293">1</span><span class="op" id="8236294">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236299">ContentLength</span><span class="op" id="8236312">:</span>&nbsp;<span class="num" id="8236314">3</span><span class="op" id="8236315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236320">Body</span><span class="op" id="8236324">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236335">ioutil</span><span class="op" id="8236341">.</span><span class="ident" id="8236342">NopCloser</span><span class="op" id="8236351">(</span><span class="ident" id="8236352">strings</span><span class="op" id="8236359">.</span><span class="ident" id="8236360">NewReader</span><span class="op" id="8236369">(</span><span class="string" id="8236370">&#34;foo&#34;</span><span class="op" id="8236375">)</span><span class="op" id="8236376">)</span><span class="op" id="8236377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236381">}</span><span class="op" id="8236382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236386">body</span><span class="op" id="8236390">:</span>&nbsp;<span class="builtintype" id="8236392">true</span><span class="op" id="8236396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236400">want</span><span class="op" id="8236404">:</span>&nbsp;<span class="string" id="8236406">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno">250</span>Content-Length:&nbsp;3<br>
<span class="lineno"></span><br>
<span class="lineno"></span>foo`</span><span class="op" id="8236446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236449">}</span><span class="op" id="8236450">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236458">res</span><span class="op" id="8236461">:</span>&nbsp;<span class="op" id="8236463">&amp;</span><span class="ident" id="8236464">http</span><span class="op" id="8236468">.</span><span class="ident" id="8236469">Response</span><span class="op" id="8236477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236482">Status</span><span class="op" id="8236488">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8236500">&#34;200&nbsp;OK&#34;</span><span class="op" id="8236508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236513">StatusCode</span><span class="op" id="8236523">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8236531">200</span><span class="op" id="8236534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236539">Proto</span><span class="op" id="8236544">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8236557">&#34;HTTP/1.1&#34;</span><span class="op" id="8236567">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236572">ProtoMajor</span><span class="op" id="8236582">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8236590">1</span><span class="op" id="8236591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236596">ProtoMinor</span><span class="op" id="8236606">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8236614">1</span><span class="op" id="8236615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236620">ContentLength</span><span class="op" id="8236633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236638">-</span><span class="num" id="8236639">1</span><span class="op" id="8236640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236645">Body</span><span class="op" id="8236649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236663">ioutil</span><span class="op" id="8236669">.</span><span class="ident" id="8236670">NopCloser</span><span class="op" id="8236679">(</span><span class="ident" id="8236680">strings</span><span class="op" id="8236687">.</span><span class="ident" id="8236688">NewReader</span><span class="op" id="8236697">(</span><span class="string" id="8236698">&#34;foo&#34;</span><span class="op" id="8236703">)</span><span class="op" id="8236704">)</span><span class="op" id="8236705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236710">TransferEncoding</span><span class="op" id="8236726">:</span>&nbsp;<span class="op" id="8236728">[</span><span class="op" id="8236729">]</span><span class="builtintype" id="8236730">string</span><span class="op" id="8236736">{</span><span class="string" id="8236737">&#34;chunked&#34;</span><span class="op" id="8236746">}</span><span class="op" id="8236747">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236751">}</span><span class="op" id="8236752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236756">body</span><span class="op" id="8236760">:</span>&nbsp;<span class="builtintype" id="8236762">true</span><span class="op" id="8236766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236770">want</span><span class="op" id="8236774">:</span>&nbsp;<span class="string" id="8236776">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">270</span>3<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>0`</span><span class="op" id="8236829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8236832">}</span><span class="op" id="8236833">,</span><br>
<span class="lineno"></span><span class="op" id="8236835">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="8236838">func</span>&nbsp;<span class="ident" id="8236843">TestDumpResponse</span><span class="op" id="8236859">(</span><span class="ident" id="8236860">t</span>&nbsp;<span class="op" id="8236862">*</span><span class="ident" id="8236863">testing</span><span class="op" id="8236870">.</span><span class="ident" id="8236871">T</span><span class="op" id="8236872">)</span>&nbsp;<span class="op" id="8236874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236877">for</span>&nbsp;<span class="ident" id="8236881">i</span><span class="op" id="8236882">,</span>&nbsp;<span class="ident" id="8236884">tt</span>&nbsp;<span class="op" id="8236887">:=</span>&nbsp;<span class="keyword" id="8236890">range</span>&nbsp;<span class="ident" id="8236896">dumpResTests</span>&nbsp;<span class="op" id="8236909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236913">gotb</span><span class="op" id="8236917">,</span>&nbsp;<span class="ident" id="8236919">err</span>&nbsp;<span class="op" id="8236923">:=</span>&nbsp;<span class="ident" id="8236926">DumpResponse</span><span class="op" id="8236938">(</span><span class="ident" id="8236939">tt</span><span class="op" id="8236941">.</span><span class="ident" id="8236942">res</span><span class="op" id="8236945">,</span>&nbsp;<span class="ident" id="8236947">tt</span><span class="op" id="8236949">.</span><span class="ident" id="8236950">body</span><span class="op" id="8236954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8236958">if</span>&nbsp;<span class="ident" id="8236961">err</span>&nbsp;<span class="op" id="8236965">!=</span>&nbsp;<span class="ident" id="8236968">nil</span>&nbsp;<span class="op" id="8236972">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8236977">t</span><span class="op" id="8236978">.</span><span class="ident" id="8236979">Errorf</span><span class="op" id="8236985">(</span><span class="string" id="8236986">&#34;%d.&nbsp;DumpResponse&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8237009">,</span>&nbsp;<span class="ident" id="8237011">i</span><span class="op" id="8237012">,</span>&nbsp;<span class="ident" id="8237014">err</span><span class="op" id="8237017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237022">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237037">got</span>&nbsp;<span class="op" id="8237041">:=</span>&nbsp;<span class="builtintype" id="8237044">string</span><span class="op" id="8237050">(</span><span class="ident" id="8237051">gotb</span><span class="op" id="8237055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237059">got</span>&nbsp;<span class="op" id="8237063">=</span>&nbsp;<span class="ident" id="8237065">strings</span><span class="op" id="8237072">.</span><span class="ident" id="8237073">TrimSpace</span><span class="op" id="8237082">(</span><span class="ident" id="8237083">got</span><span class="op" id="8237086">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237090">got</span>&nbsp;<span class="op" id="8237094">=</span>&nbsp;<span class="ident" id="8237096">strings</span><span class="op" id="8237103">.</span><span class="ident" id="8237104">Replace</span><span class="op" id="8237111">(</span><span class="ident" id="8237112">got</span><span class="op" id="8237115">,</span>&nbsp;<span class="string" id="8237117">&#34;\r&#34;</span><span class="op" id="8237121">,</span>&nbsp;<span class="string" id="8237123">&#34;&#34;</span><span class="op" id="8237125">,</span>&nbsp;<span class="op" id="8237127">-</span><span class="num" id="8237128">1</span><span class="op" id="8237129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8237134">if</span>&nbsp;<span class="ident" id="8237137">got</span>&nbsp;<span class="op" id="8237141">!=</span>&nbsp;<span class="ident" id="8237144">tt</span><span class="op" id="8237146">.</span><span class="ident" id="8237147">want</span>&nbsp;<span class="op" id="8237152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8237157">t</span><span class="op" id="8237158">.</span><span class="ident" id="8237159">Errorf</span><span class="op" id="8237165">(</span><span class="string" id="8237166">&#34;%d.\nDumpResponse&nbsp;got:\n%s\n\nWant:\n%s\n&#34;</span><span class="op" id="8237209">,</span>&nbsp;<span class="ident" id="8237211">i</span><span class="op" id="8237212">,</span>&nbsp;<span class="ident" id="8237214">got</span><span class="op" id="8237217">,</span>&nbsp;<span class="ident" id="8237219">tt</span><span class="op" id="8237221">.</span><span class="ident" id="8237222">want</span><span class="op" id="8237226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237230">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8237233">}</span><br>
<span class="lineno"></span><span class="op" id="8237235">}</span>
</div>
</body>
</html>
