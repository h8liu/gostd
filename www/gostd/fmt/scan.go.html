<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1487358">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1487413">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1487467">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1487518">package</span>&nbsp;<span class="ident" id="1487526">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1487531">import</span>&nbsp;<span class="op" id="1487538">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487541">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487551">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487557">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487565">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487571">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487582">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487593">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1487601">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1487616">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1487619">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="1487688">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="1487755">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="1487825">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="1487860">type</span>&nbsp;<span class="ident" id="1487865">runeUnreader</span>&nbsp;<span class="keyword" id="1487878">interface</span>&nbsp;<span class="op" id="1487888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1487891">UnreadRune</span><span class="op" id="1487901">(</span><span class="op" id="1487902">)</span>&nbsp;<span class="builtintype" id="1487904">error</span><br>
<span class="lineno"></span><span class="op" id="1487910">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1487913">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="1487982">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="1488046">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="1488093">type</span>&nbsp;<span class="ident" id="1488098">ScanState</span>&nbsp;<span class="keyword" id="1488108">interface</span>&nbsp;<span class="op" id="1488118">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488121">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488191">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488258">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488327">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1488352">ReadRune</span><span class="op" id="1488360">(</span><span class="op" id="1488361">)</span>&nbsp;<span class="op" id="1488363">(</span><span class="ident" id="1488364">r</span>&nbsp;<span class="builtintype" id="1488366">rune</span><span class="op" id="1488370">,</span>&nbsp;<span class="ident" id="1488372">size</span>&nbsp;<span class="builtintype" id="1488377">int</span><span class="op" id="1488380">,</span>&nbsp;<span class="ident" id="1488382">err</span>&nbsp;<span class="builtintype" id="1488386">error</span><span class="op" id="1488391">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488394">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1488467">UnreadRune</span><span class="op" id="1488477">(</span><span class="op" id="1488478">)</span>&nbsp;<span class="builtintype" id="1488480">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488487">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488557">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488632">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1488665">SkipSpace</span><span class="op" id="1488674">(</span><span class="op" id="1488675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488678">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488752">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488816">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488888">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1488961">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489034">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489109">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489186">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1489241">Token</span><span class="op" id="1489246">(</span><span class="ident" id="1489247">skipSpace</span>&nbsp;<span class="builtintype" id="1489257">bool</span><span class="op" id="1489261">,</span>&nbsp;<span class="ident" id="1489263">f</span>&nbsp;<span class="keyword" id="1489265">func</span><span class="op" id="1489269">(</span><span class="builtintype" id="1489270">rune</span><span class="op" id="1489274">)</span>&nbsp;<span class="builtintype" id="1489276">bool</span><span class="op" id="1489280">)</span>&nbsp;<span class="op" id="1489282">(</span><span class="ident" id="1489283">token</span>&nbsp;<span class="op" id="1489289">[</span><span class="op" id="1489290">]</span><span class="builtintype" id="1489291">byte</span><span class="op" id="1489295">,</span>&nbsp;<span class="ident" id="1489297">err</span>&nbsp;<span class="builtintype" id="1489301">error</span><span class="op" id="1489306">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489309">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489386">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1489423">Width</span><span class="op" id="1489428">(</span><span class="op" id="1489429">)</span>&nbsp;<span class="op" id="1489431">(</span><span class="ident" id="1489432">wid</span>&nbsp;<span class="builtintype" id="1489436">int</span><span class="op" id="1489439">,</span>&nbsp;<span class="ident" id="1489441">ok</span>&nbsp;<span class="builtintype" id="1489444">bool</span><span class="op" id="1489448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489451">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489526">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1489592">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1489654">Read</span><span class="op" id="1489658">(</span><span class="ident" id="1489659">buf</span>&nbsp;<span class="op" id="1489663">[</span><span class="op" id="1489664">]</span><span class="builtintype" id="1489665">byte</span><span class="op" id="1489669">)</span>&nbsp;<span class="op" id="1489671">(</span><span class="ident" id="1489672">n</span>&nbsp;<span class="builtintype" id="1489674">int</span><span class="op" id="1489677">,</span>&nbsp;<span class="ident" id="1489679">err</span>&nbsp;<span class="builtintype" id="1489683">error</span><span class="op" id="1489688">)</span><br>
<span class="lineno"></span><span class="op" id="1489690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1489693">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="1489768">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1489844">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="1489922">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1489988">type</span>&nbsp;<span class="ident" id="1489993">Scanner</span>&nbsp;<span class="keyword" id="1490001">interface</span>&nbsp;<span class="op" id="1490011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1490014">Scan</span><span class="op" id="1490018">(</span><span class="ident" id="1490019">state</span>&nbsp;<span class="ident" id="1490025">ScanState</span><span class="op" id="1490034">,</span>&nbsp;<span class="ident" id="1490036">verb</span>&nbsp;<span class="builtintype" id="1490041">rune</span><span class="op" id="1490045">)</span>&nbsp;<span class="builtintype" id="1490047">error</span><br>
<span class="lineno">65</span><span class="op" id="1490053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1490056">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="1490120">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="1490189">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="1490256">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="1490326">func</span>&nbsp;<span class="ident" id="1490331">Scan</span><span class="op" id="1490335">(</span><span class="ident" id="1490336">a</span>&nbsp;<span class="op" id="1490338">...</span><span class="keyword" id="1490341">interface</span><span class="op" id="1490350">{</span><span class="op" id="1490351">}</span><span class="op" id="1490352">)</span>&nbsp;<span class="op" id="1490354">(</span><span class="ident" id="1490355">n</span>&nbsp;<span class="builtintype" id="1490357">int</span><span class="op" id="1490360">,</span>&nbsp;<span class="ident" id="1490362">err</span>&nbsp;<span class="builtintype" id="1490366">error</span><span class="op" id="1490371">)</span>&nbsp;<span class="op" id="1490373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1490376">return</span>&nbsp;<span class="ident" id="1490383">Fscan</span><span class="op" id="1490388">(</span><span class="ident" id="1490389">os</span><span class="op" id="1490391">.</span><span class="ident" id="1490392">Stdin</span><span class="op" id="1490397">,</span>&nbsp;<span class="ident" id="1490399">a</span><span class="op" id="1490400">...</span><span class="op" id="1490403">)</span><br>
<span class="lineno"></span><span class="op" id="1490405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1490408">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1490474">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="1490530">func</span>&nbsp;<span class="ident" id="1490535">Scanln</span><span class="op" id="1490541">(</span><span class="ident" id="1490542">a</span>&nbsp;<span class="op" id="1490544">...</span><span class="keyword" id="1490547">interface</span><span class="op" id="1490556">{</span><span class="op" id="1490557">}</span><span class="op" id="1490558">)</span>&nbsp;<span class="op" id="1490560">(</span><span class="ident" id="1490561">n</span>&nbsp;<span class="builtintype" id="1490563">int</span><span class="op" id="1490566">,</span>&nbsp;<span class="ident" id="1490568">err</span>&nbsp;<span class="builtintype" id="1490572">error</span><span class="op" id="1490577">)</span>&nbsp;<span class="op" id="1490579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1490582">return</span>&nbsp;<span class="ident" id="1490589">Fscanln</span><span class="op" id="1490596">(</span><span class="ident" id="1490597">os</span><span class="op" id="1490599">.</span><span class="ident" id="1490600">Stdin</span><span class="op" id="1490605">,</span>&nbsp;<span class="ident" id="1490607">a</span><span class="op" id="1490608">...</span><span class="op" id="1490611">)</span><br>
<span class="lineno"></span><span class="op" id="1490613">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="1490616">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="1490681">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1490750">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="1490819">func</span>&nbsp;<span class="ident" id="1490824">Scanf</span><span class="op" id="1490829">(</span><span class="ident" id="1490830">format</span>&nbsp;<span class="builtintype" id="1490837">string</span><span class="op" id="1490843">,</span>&nbsp;<span class="ident" id="1490845">a</span>&nbsp;<span class="op" id="1490847">...</span><span class="keyword" id="1490850">interface</span><span class="op" id="1490859">{</span><span class="op" id="1490860">}</span><span class="op" id="1490861">)</span>&nbsp;<span class="op" id="1490863">(</span><span class="ident" id="1490864">n</span>&nbsp;<span class="builtintype" id="1490866">int</span><span class="op" id="1490869">,</span>&nbsp;<span class="ident" id="1490871">err</span>&nbsp;<span class="builtintype" id="1490875">error</span><span class="op" id="1490880">)</span>&nbsp;<span class="op" id="1490882">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1490885">return</span>&nbsp;<span class="ident" id="1490892">Fscanf</span><span class="op" id="1490898">(</span><span class="ident" id="1490899">os</span><span class="op" id="1490901">.</span><span class="ident" id="1490902">Stdin</span><span class="op" id="1490907">,</span>&nbsp;<span class="ident" id="1490909">format</span><span class="op" id="1490915">,</span>&nbsp;<span class="ident" id="1490917">a</span><span class="op" id="1490918">...</span><span class="op" id="1490921">)</span><br>
<span class="lineno"></span><span class="op" id="1490923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1490926">type</span>&nbsp;<span class="ident" id="1490931">stringReader</span>&nbsp;<span class="builtintype" id="1490944">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="1490952">func</span>&nbsp;<span class="op" id="1490957">(</span><span class="ident" id="1490958">r</span>&nbsp;<span class="op" id="1490960">*</span><span class="ident" id="1490961">stringReader</span><span class="op" id="1490973">)</span>&nbsp;<span class="ident" id="1490975">Read</span><span class="op" id="1490979">(</span><span class="ident" id="1490980">b</span>&nbsp;<span class="op" id="1490982">[</span><span class="op" id="1490983">]</span><span class="builtintype" id="1490984">byte</span><span class="op" id="1490988">)</span>&nbsp;<span class="op" id="1490990">(</span><span class="ident" id="1490991">n</span>&nbsp;<span class="builtintype" id="1490993">int</span><span class="op" id="1490996">,</span>&nbsp;<span class="ident" id="1490998">err</span>&nbsp;<span class="builtintype" id="1491002">error</span><span class="op" id="1491007">)</span>&nbsp;<span class="op" id="1491009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1491012">n</span>&nbsp;<span class="op" id="1491014">=</span>&nbsp;<span class="builtinfunc" id="1491016">copy</span><span class="op" id="1491020">(</span><span class="ident" id="1491021">b</span><span class="op" id="1491022">,</span>&nbsp;<span class="op" id="1491024">*</span><span class="ident" id="1491025">r</span><span class="op" id="1491026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1491029">*</span><span class="ident" id="1491030">r</span>&nbsp;<span class="op" id="1491032">=</span>&nbsp;<span class="op" id="1491034">(</span><span class="op" id="1491035">*</span><span class="ident" id="1491036">r</span><span class="op" id="1491037">)</span><span class="op" id="1491038">[</span><span class="ident" id="1491039">n</span><span class="op" id="1491040">:</span><span class="op" id="1491041">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1491044">if</span>&nbsp;<span class="ident" id="1491047">n</span>&nbsp;<span class="op" id="1491049">==</span>&nbsp;<span class="num" id="1491052">0</span>&nbsp;<span class="op" id="1491054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1491058">err</span>&nbsp;<span class="op" id="1491062">=</span>&nbsp;<span class="ident" id="1491064">io</span><span class="op" id="1491066">.</span><span class="ident" id="1491067">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1491072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1491075">return</span><br>
<span class="lineno"></span><span class="op" id="1491082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1491085">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="1491156">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1491223">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="1491293">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="1491347">func</span>&nbsp;<span class="ident" id="1491352">Sscan</span><span class="op" id="1491357">(</span><span class="ident" id="1491358">str</span>&nbsp;<span class="builtintype" id="1491362">string</span><span class="op" id="1491368">,</span>&nbsp;<span class="ident" id="1491370">a</span>&nbsp;<span class="op" id="1491372">...</span><span class="keyword" id="1491375">interface</span><span class="op" id="1491384">{</span><span class="op" id="1491385">}</span><span class="op" id="1491386">)</span>&nbsp;<span class="op" id="1491388">(</span><span class="ident" id="1491389">n</span>&nbsp;<span class="builtintype" id="1491391">int</span><span class="op" id="1491394">,</span>&nbsp;<span class="ident" id="1491396">err</span>&nbsp;<span class="builtintype" id="1491400">error</span><span class="op" id="1491405">)</span>&nbsp;<span class="op" id="1491407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1491410">return</span>&nbsp;<span class="ident" id="1491417">Fscan</span><span class="op" id="1491422">(</span><span class="op" id="1491423">(</span><span class="op" id="1491424">*</span><span class="ident" id="1491425">stringReader</span><span class="op" id="1491437">)</span><span class="op" id="1491438">(</span><span class="op" id="1491439">&amp;</span><span class="ident" id="1491440">str</span><span class="op" id="1491443">)</span><span class="op" id="1491444">,</span>&nbsp;<span class="ident" id="1491446">a</span><span class="op" id="1491447">...</span><span class="op" id="1491450">)</span><br>
<span class="lineno">105</span><span class="op" id="1491452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1491455">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1491523">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="1491579">func</span>&nbsp;<span class="ident" id="1491584">Sscanln</span><span class="op" id="1491591">(</span><span class="ident" id="1491592">str</span>&nbsp;<span class="builtintype" id="1491596">string</span><span class="op" id="1491602">,</span>&nbsp;<span class="ident" id="1491604">a</span>&nbsp;<span class="op" id="1491606">...</span><span class="keyword" id="1491609">interface</span><span class="op" id="1491618">{</span><span class="op" id="1491619">}</span><span class="op" id="1491620">)</span>&nbsp;<span class="op" id="1491622">(</span><span class="ident" id="1491623">n</span>&nbsp;<span class="builtintype" id="1491625">int</span><span class="op" id="1491628">,</span>&nbsp;<span class="ident" id="1491630">err</span>&nbsp;<span class="builtintype" id="1491634">error</span><span class="op" id="1491639">)</span>&nbsp;<span class="op" id="1491641">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1491644">return</span>&nbsp;<span class="ident" id="1491651">Fscanln</span><span class="op" id="1491658">(</span><span class="op" id="1491659">(</span><span class="op" id="1491660">*</span><span class="ident" id="1491661">stringReader</span><span class="op" id="1491673">)</span><span class="op" id="1491674">(</span><span class="op" id="1491675">&amp;</span><span class="ident" id="1491676">str</span><span class="op" id="1491679">)</span><span class="op" id="1491680">,</span>&nbsp;<span class="ident" id="1491682">a</span><span class="op" id="1491683">...</span><span class="op" id="1491686">)</span><br>
<span class="lineno"></span><span class="op" id="1491688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1491691">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="1491763">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="1491832">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="1491884">func</span>&nbsp;<span class="ident" id="1491889">Sscanf</span><span class="op" id="1491895">(</span><span class="ident" id="1491896">str</span>&nbsp;<span class="builtintype" id="1491900">string</span><span class="op" id="1491906">,</span>&nbsp;<span class="ident" id="1491908">format</span>&nbsp;<span class="builtintype" id="1491915">string</span><span class="op" id="1491921">,</span>&nbsp;<span class="ident" id="1491923">a</span>&nbsp;<span class="op" id="1491925">...</span><span class="keyword" id="1491928">interface</span><span class="op" id="1491937">{</span><span class="op" id="1491938">}</span><span class="op" id="1491939">)</span>&nbsp;<span class="op" id="1491941">(</span><span class="ident" id="1491942">n</span>&nbsp;<span class="builtintype" id="1491944">int</span><span class="op" id="1491947">,</span>&nbsp;<span class="ident" id="1491949">err</span>&nbsp;<span class="builtintype" id="1491953">error</span><span class="op" id="1491958">)</span>&nbsp;<span class="op" id="1491960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1491963">return</span>&nbsp;<span class="ident" id="1491970">Fscanf</span><span class="op" id="1491976">(</span><span class="op" id="1491977">(</span><span class="op" id="1491978">*</span><span class="ident" id="1491979">stringReader</span><span class="op" id="1491991">)</span><span class="op" id="1491992">(</span><span class="op" id="1491993">&amp;</span><span class="ident" id="1491994">str</span><span class="op" id="1491997">)</span><span class="op" id="1491998">,</span>&nbsp;<span class="ident" id="1492000">format</span><span class="op" id="1492006">,</span>&nbsp;<span class="ident" id="1492008">a</span><span class="op" id="1492009">...</span><span class="op" id="1492012">)</span><br>
<span class="lineno"></span><span class="op" id="1492014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="1492017">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="1492085">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1492152">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="1492222">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="1492276">func</span>&nbsp;<span class="ident" id="1492281">Fscan</span><span class="op" id="1492286">(</span><span class="ident" id="1492287">r</span>&nbsp;<span class="ident" id="1492289">io</span><span class="op" id="1492291">.</span><span class="ident" id="1492292">Reader</span><span class="op" id="1492298">,</span>&nbsp;<span class="ident" id="1492300">a</span>&nbsp;<span class="op" id="1492302">...</span><span class="keyword" id="1492305">interface</span><span class="op" id="1492314">{</span><span class="op" id="1492315">}</span><span class="op" id="1492316">)</span>&nbsp;<span class="op" id="1492318">(</span><span class="ident" id="1492319">n</span>&nbsp;<span class="builtintype" id="1492321">int</span><span class="op" id="1492324">,</span>&nbsp;<span class="ident" id="1492326">err</span>&nbsp;<span class="builtintype" id="1492330">error</span><span class="op" id="1492335">)</span>&nbsp;<span class="op" id="1492337">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492340">s</span><span class="op" id="1492341">,</span>&nbsp;<span class="ident" id="1492343">old</span>&nbsp;<span class="op" id="1492347">:=</span>&nbsp;<span class="ident" id="1492350">newScanState</span><span class="op" id="1492362">(</span><span class="ident" id="1492363">r</span><span class="op" id="1492364">,</span>&nbsp;<span class="builtintype" id="1492366">true</span><span class="op" id="1492370">,</span>&nbsp;<span class="builtintype" id="1492372">false</span><span class="op" id="1492377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492380">n</span><span class="op" id="1492381">,</span>&nbsp;<span class="ident" id="1492383">err</span>&nbsp;<span class="op" id="1492387">=</span>&nbsp;<span class="ident" id="1492389">s</span><span class="op" id="1492390">.</span><span class="ident" id="1492391">doScan</span><span class="op" id="1492397">(</span><span class="ident" id="1492398">a</span><span class="op" id="1492399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492402">s</span><span class="op" id="1492403">.</span><span class="ident" id="1492404">free</span><span class="op" id="1492408">(</span><span class="ident" id="1492409">old</span><span class="op" id="1492412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1492415">return</span><br>
<span class="lineno"></span><span class="op" id="1492422">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="1492425">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1492493">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="1492549">func</span>&nbsp;<span class="ident" id="1492554">Fscanln</span><span class="op" id="1492561">(</span><span class="ident" id="1492562">r</span>&nbsp;<span class="ident" id="1492564">io</span><span class="op" id="1492566">.</span><span class="ident" id="1492567">Reader</span><span class="op" id="1492573">,</span>&nbsp;<span class="ident" id="1492575">a</span>&nbsp;<span class="op" id="1492577">...</span><span class="keyword" id="1492580">interface</span><span class="op" id="1492589">{</span><span class="op" id="1492590">}</span><span class="op" id="1492591">)</span>&nbsp;<span class="op" id="1492593">(</span><span class="ident" id="1492594">n</span>&nbsp;<span class="builtintype" id="1492596">int</span><span class="op" id="1492599">,</span>&nbsp;<span class="ident" id="1492601">err</span>&nbsp;<span class="builtintype" id="1492605">error</span><span class="op" id="1492610">)</span>&nbsp;<span class="op" id="1492612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492615">s</span><span class="op" id="1492616">,</span>&nbsp;<span class="ident" id="1492618">old</span>&nbsp;<span class="op" id="1492622">:=</span>&nbsp;<span class="ident" id="1492625">newScanState</span><span class="op" id="1492637">(</span><span class="ident" id="1492638">r</span><span class="op" id="1492639">,</span>&nbsp;<span class="builtintype" id="1492641">false</span><span class="op" id="1492646">,</span>&nbsp;<span class="builtintype" id="1492648">true</span><span class="op" id="1492652">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492655">n</span><span class="op" id="1492656">,</span>&nbsp;<span class="ident" id="1492658">err</span>&nbsp;<span class="op" id="1492662">=</span>&nbsp;<span class="ident" id="1492664">s</span><span class="op" id="1492665">.</span><span class="ident" id="1492666">doScan</span><span class="op" id="1492672">(</span><span class="ident" id="1492673">a</span><span class="op" id="1492674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492677">s</span><span class="op" id="1492678">.</span><span class="ident" id="1492679">free</span><span class="op" id="1492683">(</span><span class="ident" id="1492684">old</span><span class="op" id="1492687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1492690">return</span><br>
<span class="lineno"></span><span class="op" id="1492697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1492700">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="1492769">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1492838">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="1492890">func</span>&nbsp;<span class="ident" id="1492895">Fscanf</span><span class="op" id="1492901">(</span><span class="ident" id="1492902">r</span>&nbsp;<span class="ident" id="1492904">io</span><span class="op" id="1492906">.</span><span class="ident" id="1492907">Reader</span><span class="op" id="1492913">,</span>&nbsp;<span class="ident" id="1492915">format</span>&nbsp;<span class="builtintype" id="1492922">string</span><span class="op" id="1492928">,</span>&nbsp;<span class="ident" id="1492930">a</span>&nbsp;<span class="op" id="1492932">...</span><span class="keyword" id="1492935">interface</span><span class="op" id="1492944">{</span><span class="op" id="1492945">}</span><span class="op" id="1492946">)</span>&nbsp;<span class="op" id="1492948">(</span><span class="ident" id="1492949">n</span>&nbsp;<span class="builtintype" id="1492951">int</span><span class="op" id="1492954">,</span>&nbsp;<span class="ident" id="1492956">err</span>&nbsp;<span class="builtintype" id="1492960">error</span><span class="op" id="1492965">)</span>&nbsp;<span class="op" id="1492967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492970">s</span><span class="op" id="1492971">,</span>&nbsp;<span class="ident" id="1492973">old</span>&nbsp;<span class="op" id="1492977">:=</span>&nbsp;<span class="ident" id="1492980">newScanState</span><span class="op" id="1492992">(</span><span class="ident" id="1492993">r</span><span class="op" id="1492994">,</span>&nbsp;<span class="builtintype" id="1492996">false</span><span class="op" id="1493001">,</span>&nbsp;<span class="builtintype" id="1493003">false</span><span class="op" id="1493008">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493011">n</span><span class="op" id="1493012">,</span>&nbsp;<span class="ident" id="1493014">err</span>&nbsp;<span class="op" id="1493018">=</span>&nbsp;<span class="ident" id="1493020">s</span><span class="op" id="1493021">.</span><span class="ident" id="1493022">doScanf</span><span class="op" id="1493029">(</span><span class="ident" id="1493030">format</span><span class="op" id="1493036">,</span>&nbsp;<span class="ident" id="1493038">a</span><span class="op" id="1493039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493042">s</span><span class="op" id="1493043">.</span><span class="ident" id="1493044">free</span><span class="op" id="1493048">(</span><span class="ident" id="1493049">old</span><span class="op" id="1493052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1493055">return</span><br>
<span class="lineno"></span><span class="op" id="1493062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="1493065">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="1493134">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="1493210">type</span>&nbsp;<span class="ident" id="1493215">scanError</span>&nbsp;<span class="keyword" id="1493225">struct</span>&nbsp;<span class="op" id="1493232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493235">err</span>&nbsp;<span class="builtintype" id="1493239">error</span><br>
<span class="lineno"></span><span class="op" id="1493245">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="1493248">const</span>&nbsp;<span class="ident" id="1493254">eof</span>&nbsp;<span class="op" id="1493258">=</span>&nbsp;<span class="op" id="1493260">-</span><span class="num" id="1493261">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1493264">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="1493315">type</span>&nbsp;<span class="ident" id="1493320">ss</span>&nbsp;<span class="keyword" id="1493323">struct</span>&nbsp;<span class="op" id="1493330">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493333">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1493342">io</span><span class="op" id="1493344">.</span><span class="ident" id="1493345">RuneReader</span>&nbsp;<span class="comment" id="1493356">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493380">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1493389">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1493403">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493425">peekRune</span>&nbsp;<span class="builtintype" id="1493434">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1493448">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493471">prevRune</span>&nbsp;<span class="builtintype" id="1493480">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1493494">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493529">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1493538">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1493552">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493579">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1493588">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1493602">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493623">ssave</span><br>
<span class="lineno"></span><span class="op" id="1493629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1493632">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="1493679">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="1493721">type</span>&nbsp;<span class="ident" id="1493726">ssave</span>&nbsp;<span class="keyword" id="1493732">struct</span>&nbsp;<span class="op" id="1493739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493742">validSave</span>&nbsp;<span class="builtintype" id="1493752">bool</span>&nbsp;<span class="comment" id="1493757">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493795">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1493805">bool</span>&nbsp;<span class="comment" id="1493810">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493846">nlIsSpace</span>&nbsp;<span class="builtintype" id="1493856">bool</span>&nbsp;<span class="comment" id="1493861">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493903">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="1493913">int</span>&nbsp;&nbsp;<span class="comment" id="1493918">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493976">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1493986">int</span>&nbsp;&nbsp;<span class="comment" id="1493991">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494018">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1494028">int</span>&nbsp;&nbsp;<span class="comment" id="1494033">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="1494055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="1494058">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="1494116">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="1494177">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="1494236">func</span>&nbsp;<span class="op" id="1494241">(</span><span class="ident" id="1494242">s</span>&nbsp;<span class="op" id="1494244">*</span><span class="ident" id="1494245">ss</span><span class="op" id="1494247">)</span>&nbsp;<span class="ident" id="1494249">Read</span><span class="op" id="1494253">(</span><span class="ident" id="1494254">buf</span>&nbsp;<span class="op" id="1494258">[</span><span class="op" id="1494259">]</span><span class="builtintype" id="1494260">byte</span><span class="op" id="1494264">)</span>&nbsp;<span class="op" id="1494266">(</span><span class="ident" id="1494267">n</span>&nbsp;<span class="builtintype" id="1494269">int</span><span class="op" id="1494272">,</span>&nbsp;<span class="ident" id="1494274">err</span>&nbsp;<span class="builtintype" id="1494278">error</span><span class="op" id="1494283">)</span>&nbsp;<span class="op" id="1494285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494288">return</span>&nbsp;<span class="num" id="1494295">0</span><span class="op" id="1494296">,</span>&nbsp;<span class="ident" id="1494298">errors</span><span class="op" id="1494304">.</span><span class="ident" id="1494305">New</span><span class="op" id="1494308">(</span><span class="string" id="1494309">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="1494362">)</span><br>
<span class="lineno">185</span><span class="op" id="1494364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1494367">func</span>&nbsp;<span class="op" id="1494372">(</span><span class="ident" id="1494373">s</span>&nbsp;<span class="op" id="1494375">*</span><span class="ident" id="1494376">ss</span><span class="op" id="1494378">)</span>&nbsp;<span class="ident" id="1494380">ReadRune</span><span class="op" id="1494388">(</span><span class="op" id="1494389">)</span>&nbsp;<span class="op" id="1494391">(</span><span class="ident" id="1494392">r</span>&nbsp;<span class="builtintype" id="1494394">rune</span><span class="op" id="1494398">,</span>&nbsp;<span class="ident" id="1494400">size</span>&nbsp;<span class="builtintype" id="1494405">int</span><span class="op" id="1494408">,</span>&nbsp;<span class="ident" id="1494410">err</span>&nbsp;<span class="builtintype" id="1494414">error</span><span class="op" id="1494419">)</span>&nbsp;<span class="op" id="1494421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494424">if</span>&nbsp;<span class="ident" id="1494427">s</span><span class="op" id="1494428">.</span><span class="ident" id="1494429">peekRune</span>&nbsp;<span class="op" id="1494438">&gt;=</span>&nbsp;<span class="num" id="1494441">0</span>&nbsp;<span class="op" id="1494443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494447">s</span><span class="op" id="1494448">.</span><span class="ident" id="1494449">count</span><span class="op" id="1494454">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494459">r</span>&nbsp;<span class="op" id="1494461">=</span>&nbsp;<span class="ident" id="1494463">s</span><span class="op" id="1494464">.</span><span class="ident" id="1494465">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494476">size</span>&nbsp;<span class="op" id="1494481">=</span>&nbsp;<span class="ident" id="1494483">utf8</span><span class="op" id="1494487">.</span><span class="ident" id="1494488">RuneLen</span><span class="op" id="1494495">(</span><span class="ident" id="1494496">r</span><span class="op" id="1494497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494501">s</span><span class="op" id="1494502">.</span><span class="ident" id="1494503">prevRune</span>&nbsp;<span class="op" id="1494512">=</span>&nbsp;<span class="ident" id="1494514">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494518">s</span><span class="op" id="1494519">.</span><span class="ident" id="1494520">peekRune</span>&nbsp;<span class="op" id="1494529">=</span>&nbsp;<span class="op" id="1494531">-</span><span class="num" id="1494532">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494536">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494547">if</span>&nbsp;<span class="ident" id="1494550">s</span><span class="op" id="1494551">.</span><span class="ident" id="1494552">atEOF</span>&nbsp;<span class="op" id="1494558">||</span>&nbsp;<span class="ident" id="1494561">s</span><span class="op" id="1494562">.</span><span class="ident" id="1494563">nlIsEnd</span>&nbsp;<span class="op" id="1494571">&amp;&amp;</span>&nbsp;<span class="ident" id="1494574">s</span><span class="op" id="1494575">.</span><span class="ident" id="1494576">prevRune</span>&nbsp;<span class="op" id="1494585">==</span>&nbsp;<span class="string" id="1494588">&#39;\n&#39;</span>&nbsp;<span class="op" id="1494593">||</span>&nbsp;<span class="ident" id="1494596">s</span><span class="op" id="1494597">.</span><span class="ident" id="1494598">count</span>&nbsp;<span class="op" id="1494604">&gt;=</span>&nbsp;<span class="ident" id="1494607">s</span><span class="op" id="1494608">.</span><span class="ident" id="1494609">argLimit</span>&nbsp;<span class="op" id="1494618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494622">err</span>&nbsp;<span class="op" id="1494626">=</span>&nbsp;<span class="ident" id="1494628">io</span><span class="op" id="1494630">.</span><span class="ident" id="1494631">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494637">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494645">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494649">r</span><span class="op" id="1494650">,</span>&nbsp;<span class="ident" id="1494652">size</span><span class="op" id="1494656">,</span>&nbsp;<span class="ident" id="1494658">err</span>&nbsp;<span class="op" id="1494662">=</span>&nbsp;<span class="ident" id="1494664">s</span><span class="op" id="1494665">.</span><span class="ident" id="1494666">rr</span><span class="op" id="1494668">.</span><span class="ident" id="1494669">ReadRune</span><span class="op" id="1494677">(</span><span class="op" id="1494678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494681">if</span>&nbsp;<span class="ident" id="1494684">err</span>&nbsp;<span class="op" id="1494688">==</span>&nbsp;<span class="ident" id="1494691">nil</span>&nbsp;<span class="op" id="1494695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494699">s</span><span class="op" id="1494700">.</span><span class="ident" id="1494701">count</span><span class="op" id="1494706">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494711">s</span><span class="op" id="1494712">.</span><span class="ident" id="1494713">prevRune</span>&nbsp;<span class="op" id="1494722">=</span>&nbsp;<span class="ident" id="1494724">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494727">}</span>&nbsp;<span class="keyword" id="1494729">else</span>&nbsp;<span class="keyword" id="1494734">if</span>&nbsp;<span class="ident" id="1494737">err</span>&nbsp;<span class="op" id="1494741">==</span>&nbsp;<span class="ident" id="1494744">io</span><span class="op" id="1494746">.</span><span class="ident" id="1494747">EOF</span>&nbsp;<span class="op" id="1494751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494755">s</span><span class="op" id="1494756">.</span><span class="ident" id="1494757">atEOF</span>&nbsp;<span class="op" id="1494763">=</span>&nbsp;<span class="builtintype" id="1494765">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494774">return</span><br>
<span class="lineno"></span><span class="op" id="1494781">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1494784">func</span>&nbsp;<span class="op" id="1494789">(</span><span class="ident" id="1494790">s</span>&nbsp;<span class="op" id="1494792">*</span><span class="ident" id="1494793">ss</span><span class="op" id="1494795">)</span>&nbsp;<span class="ident" id="1494797">Width</span><span class="op" id="1494802">(</span><span class="op" id="1494803">)</span>&nbsp;<span class="op" id="1494805">(</span><span class="ident" id="1494806">wid</span>&nbsp;<span class="builtintype" id="1494810">int</span><span class="op" id="1494813">,</span>&nbsp;<span class="ident" id="1494815">ok</span>&nbsp;<span class="builtintype" id="1494818">bool</span><span class="op" id="1494822">)</span>&nbsp;<span class="op" id="1494824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494827">if</span>&nbsp;<span class="ident" id="1494830">s</span><span class="op" id="1494831">.</span><span class="ident" id="1494832">maxWid</span>&nbsp;<span class="op" id="1494839">==</span>&nbsp;<span class="ident" id="1494842">hugeWid</span>&nbsp;<span class="op" id="1494850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494854">return</span>&nbsp;<span class="num" id="1494861">0</span><span class="op" id="1494862">,</span>&nbsp;<span class="builtintype" id="1494864">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494871">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494874">return</span>&nbsp;<span class="ident" id="1494881">s</span><span class="op" id="1494882">.</span><span class="ident" id="1494883">maxWid</span><span class="op" id="1494889">,</span>&nbsp;<span class="builtintype" id="1494891">true</span><br>
<span class="lineno"></span><span class="op" id="1494896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1494899">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="1494963">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="1495020">func</span>&nbsp;<span class="op" id="1495025">(</span><span class="ident" id="1495026">s</span>&nbsp;<span class="op" id="1495028">*</span><span class="ident" id="1495029">ss</span><span class="op" id="1495031">)</span>&nbsp;<span class="ident" id="1495033">getRune</span><span class="op" id="1495040">(</span><span class="op" id="1495041">)</span>&nbsp;<span class="op" id="1495043">(</span><span class="ident" id="1495044">r</span>&nbsp;<span class="builtintype" id="1495046">rune</span><span class="op" id="1495050">)</span>&nbsp;<span class="op" id="1495052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495055">r</span><span class="op" id="1495056">,</span>&nbsp;<span class="ident" id="1495058">_</span><span class="op" id="1495059">,</span>&nbsp;<span class="ident" id="1495061">err</span>&nbsp;<span class="op" id="1495065">:=</span>&nbsp;<span class="ident" id="1495068">s</span><span class="op" id="1495069">.</span><span class="ident" id="1495070">ReadRune</span><span class="op" id="1495078">(</span><span class="op" id="1495079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495082">if</span>&nbsp;<span class="ident" id="1495085">err</span>&nbsp;<span class="op" id="1495089">!=</span>&nbsp;<span class="ident" id="1495092">nil</span>&nbsp;<span class="op" id="1495096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495100">if</span>&nbsp;<span class="ident" id="1495103">err</span>&nbsp;<span class="op" id="1495107">==</span>&nbsp;<span class="ident" id="1495110">io</span><span class="op" id="1495112">.</span><span class="ident" id="1495113">EOF</span>&nbsp;<span class="op" id="1495117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495122">return</span>&nbsp;<span class="ident" id="1495129">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495139">s</span><span class="op" id="1495140">.</span><span class="builtintype" id="1495141">error</span><span class="op" id="1495146">(</span><span class="ident" id="1495147">err</span><span class="op" id="1495150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495156">return</span><br>
<span class="lineno"></span><span class="op" id="1495163">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="1495166">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="1495230">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1495297">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1495314">func</span>&nbsp;<span class="op" id="1495319">(</span><span class="ident" id="1495320">s</span>&nbsp;<span class="op" id="1495322">*</span><span class="ident" id="1495323">ss</span><span class="op" id="1495325">)</span>&nbsp;<span class="ident" id="1495327">mustReadRune</span><span class="op" id="1495339">(</span><span class="op" id="1495340">)</span>&nbsp;<span class="op" id="1495342">(</span><span class="ident" id="1495343">r</span>&nbsp;<span class="builtintype" id="1495345">rune</span><span class="op" id="1495349">)</span>&nbsp;<span class="op" id="1495351">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495354">r</span>&nbsp;<span class="op" id="1495356">=</span>&nbsp;<span class="ident" id="1495358">s</span><span class="op" id="1495359">.</span><span class="ident" id="1495360">getRune</span><span class="op" id="1495367">(</span><span class="op" id="1495368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495371">if</span>&nbsp;<span class="ident" id="1495374">r</span>&nbsp;<span class="op" id="1495376">==</span>&nbsp;<span class="ident" id="1495379">eof</span>&nbsp;<span class="op" id="1495383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495387">s</span><span class="op" id="1495388">.</span><span class="builtintype" id="1495389">error</span><span class="op" id="1495394">(</span><span class="ident" id="1495395">io</span><span class="op" id="1495397">.</span><span class="ident" id="1495398">ErrUnexpectedEOF</span><span class="op" id="1495414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495420">return</span><br>
<span class="lineno">240</span><span class="op" id="1495427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1495430">func</span>&nbsp;<span class="op" id="1495435">(</span><span class="ident" id="1495436">s</span>&nbsp;<span class="op" id="1495438">*</span><span class="ident" id="1495439">ss</span><span class="op" id="1495441">)</span>&nbsp;<span class="ident" id="1495443">UnreadRune</span><span class="op" id="1495453">(</span><span class="op" id="1495454">)</span>&nbsp;<span class="builtintype" id="1495456">error</span>&nbsp;<span class="op" id="1495462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495465">if</span>&nbsp;<span class="ident" id="1495468">u</span><span class="op" id="1495469">,</span>&nbsp;<span class="ident" id="1495471">ok</span>&nbsp;<span class="op" id="1495474">:=</span>&nbsp;<span class="ident" id="1495477">s</span><span class="op" id="1495478">.</span><span class="ident" id="1495479">rr</span><span class="op" id="1495481">.</span><span class="op" id="1495482">(</span><span class="ident" id="1495483">runeUnreader</span><span class="op" id="1495495">)</span><span class="op" id="1495496">;</span>&nbsp;<span class="ident" id="1495498">ok</span>&nbsp;<span class="op" id="1495501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495505">u</span><span class="op" id="1495506">.</span><span class="ident" id="1495507">UnreadRune</span><span class="op" id="1495517">(</span><span class="op" id="1495518">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495521">}</span>&nbsp;<span class="keyword" id="1495523">else</span>&nbsp;<span class="op" id="1495528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495532">s</span><span class="op" id="1495533">.</span><span class="ident" id="1495534">peekRune</span>&nbsp;<span class="op" id="1495543">=</span>&nbsp;<span class="ident" id="1495545">s</span><span class="op" id="1495546">.</span><span class="ident" id="1495547">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495560">s</span><span class="op" id="1495561">.</span><span class="ident" id="1495562">prevRune</span>&nbsp;<span class="op" id="1495571">=</span>&nbsp;<span class="op" id="1495573">-</span><span class="num" id="1495574">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495577">s</span><span class="op" id="1495578">.</span><span class="ident" id="1495579">count</span><span class="op" id="1495584">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495588">return</span>&nbsp;<span class="ident" id="1495595">nil</span><br>
<span class="lineno"></span><span class="op" id="1495599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1495602">func</span>&nbsp;<span class="op" id="1495607">(</span><span class="ident" id="1495608">s</span>&nbsp;<span class="op" id="1495610">*</span><span class="ident" id="1495611">ss</span><span class="op" id="1495613">)</span>&nbsp;<span class="builtintype" id="1495615">error</span><span class="op" id="1495620">(</span><span class="ident" id="1495621">err</span>&nbsp;<span class="builtintype" id="1495625">error</span><span class="op" id="1495630">)</span>&nbsp;<span class="op" id="1495632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1495635">panic</span><span class="op" id="1495640">(</span><span class="ident" id="1495641">scanError</span><span class="op" id="1495650">{</span><span class="ident" id="1495651">err</span><span class="op" id="1495654">}</span><span class="op" id="1495655">)</span><br>
<span class="lineno">255</span><span class="op" id="1495657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1495660">func</span>&nbsp;<span class="op" id="1495665">(</span><span class="ident" id="1495666">s</span>&nbsp;<span class="op" id="1495668">*</span><span class="ident" id="1495669">ss</span><span class="op" id="1495671">)</span>&nbsp;<span class="ident" id="1495673">errorString</span><span class="op" id="1495684">(</span><span class="ident" id="1495685">err</span>&nbsp;<span class="builtintype" id="1495689">string</span><span class="op" id="1495695">)</span>&nbsp;<span class="op" id="1495697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1495700">panic</span><span class="op" id="1495705">(</span><span class="ident" id="1495706">scanError</span><span class="op" id="1495715">{</span><span class="ident" id="1495716">errors</span><span class="op" id="1495722">.</span><span class="ident" id="1495723">New</span><span class="op" id="1495726">(</span><span class="ident" id="1495727">err</span><span class="op" id="1495730">)</span><span class="op" id="1495731">}</span><span class="op" id="1495732">)</span><br>
<span class="lineno"></span><span class="op" id="1495734">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="1495737">func</span>&nbsp;<span class="op" id="1495742">(</span><span class="ident" id="1495743">s</span>&nbsp;<span class="op" id="1495745">*</span><span class="ident" id="1495746">ss</span><span class="op" id="1495748">)</span>&nbsp;<span class="ident" id="1495750">Token</span><span class="op" id="1495755">(</span><span class="ident" id="1495756">skipSpace</span>&nbsp;<span class="builtintype" id="1495766">bool</span><span class="op" id="1495770">,</span>&nbsp;<span class="ident" id="1495772">f</span>&nbsp;<span class="keyword" id="1495774">func</span><span class="op" id="1495778">(</span><span class="builtintype" id="1495779">rune</span><span class="op" id="1495783">)</span>&nbsp;<span class="builtintype" id="1495785">bool</span><span class="op" id="1495789">)</span>&nbsp;<span class="op" id="1495791">(</span><span class="ident" id="1495792">tok</span>&nbsp;<span class="op" id="1495796">[</span><span class="op" id="1495797">]</span><span class="builtintype" id="1495798">byte</span><span class="op" id="1495802">,</span>&nbsp;<span class="ident" id="1495804">err</span>&nbsp;<span class="builtintype" id="1495808">error</span><span class="op" id="1495813">)</span>&nbsp;<span class="op" id="1495815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495818">defer</span>&nbsp;<span class="keyword" id="1495824">func</span><span class="op" id="1495828">(</span><span class="op" id="1495829">)</span>&nbsp;<span class="op" id="1495831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495835">if</span>&nbsp;<span class="ident" id="1495838">e</span>&nbsp;<span class="op" id="1495840">:=</span>&nbsp;<span class="builtinfunc" id="1495843">recover</span><span class="op" id="1495850">(</span><span class="op" id="1495851">)</span><span class="op" id="1495852">;</span>&nbsp;<span class="ident" id="1495854">e</span>&nbsp;<span class="op" id="1495856">!=</span>&nbsp;<span class="ident" id="1495859">nil</span>&nbsp;<span class="op" id="1495863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495868">if</span>&nbsp;<span class="ident" id="1495871">se</span><span class="op" id="1495873">,</span>&nbsp;<span class="ident" id="1495875">ok</span>&nbsp;<span class="op" id="1495878">:=</span>&nbsp;<span class="ident" id="1495881">e</span><span class="op" id="1495882">.</span><span class="op" id="1495883">(</span><span class="ident" id="1495884">scanError</span><span class="op" id="1495893">)</span><span class="op" id="1495894">;</span>&nbsp;<span class="ident" id="1495896">ok</span>&nbsp;<span class="op" id="1495899">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495905">err</span>&nbsp;<span class="op" id="1495909">=</span>&nbsp;<span class="ident" id="1495911">se</span><span class="op" id="1495913">.</span><span class="ident" id="1495914">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495921">}</span>&nbsp;<span class="keyword" id="1495923">else</span>&nbsp;<span class="op" id="1495928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1495934">panic</span><span class="op" id="1495939">(</span><span class="ident" id="1495940">e</span><span class="op" id="1495941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495950">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495953">}</span><span class="op" id="1495954">(</span><span class="op" id="1495955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495958">if</span>&nbsp;<span class="ident" id="1495961">f</span>&nbsp;<span class="op" id="1495963">==</span>&nbsp;<span class="ident" id="1495966">nil</span>&nbsp;<span class="op" id="1495970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495974">f</span>&nbsp;<span class="op" id="1495976">=</span>&nbsp;<span class="ident" id="1495978">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495991">s</span><span class="op" id="1495992">.</span><span class="ident" id="1495993">buf</span>&nbsp;<span class="op" id="1495997">=</span>&nbsp;<span class="ident" id="1495999">s</span><span class="op" id="1496000">.</span><span class="ident" id="1496001">buf</span><span class="op" id="1496004">[</span><span class="op" id="1496005">:</span><span class="num" id="1496006">0</span><span class="op" id="1496007">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496010">tok</span>&nbsp;<span class="op" id="1496014">=</span>&nbsp;<span class="ident" id="1496016">s</span><span class="op" id="1496017">.</span><span class="ident" id="1496018">token</span><span class="op" id="1496023">(</span><span class="ident" id="1496024">skipSpace</span><span class="op" id="1496033">,</span>&nbsp;<span class="ident" id="1496035">f</span><span class="op" id="1496036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496039">return</span><br>
<span class="lineno"></span><span class="op" id="1496046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1496049">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="1496103">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="1496145">var</span>&nbsp;<span class="ident" id="1496149">space</span>&nbsp;<span class="op" id="1496155">=</span>&nbsp;<span class="op" id="1496157">[</span><span class="op" id="1496158">]</span><span class="op" id="1496159">[</span><span class="num" id="1496160">2</span><span class="op" id="1496161">]</span><span class="builtintype" id="1496162">uint16</span><span class="op" id="1496168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496171">{</span><span class="num" id="1496172">0x0009</span><span class="op" id="1496178">,</span>&nbsp;<span class="num" id="1496180">0x000d</span><span class="op" id="1496186">}</span><span class="op" id="1496187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496190">{</span><span class="num" id="1496191">0x0020</span><span class="op" id="1496197">,</span>&nbsp;<span class="num" id="1496199">0x0020</span><span class="op" id="1496205">}</span><span class="op" id="1496206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496209">{</span><span class="num" id="1496210">0x0085</span><span class="op" id="1496216">,</span>&nbsp;<span class="num" id="1496218">0x0085</span><span class="op" id="1496224">}</span><span class="op" id="1496225">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496228">{</span><span class="num" id="1496229">0x00a0</span><span class="op" id="1496235">,</span>&nbsp;<span class="num" id="1496237">0x00a0</span><span class="op" id="1496243">}</span><span class="op" id="1496244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496247">{</span><span class="num" id="1496248">0x1680</span><span class="op" id="1496254">,</span>&nbsp;<span class="num" id="1496256">0x1680</span><span class="op" id="1496262">}</span><span class="op" id="1496263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496266">{</span><span class="num" id="1496267">0x2000</span><span class="op" id="1496273">,</span>&nbsp;<span class="num" id="1496275">0x200a</span><span class="op" id="1496281">}</span><span class="op" id="1496282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496285">{</span><span class="num" id="1496286">0x2028</span><span class="op" id="1496292">,</span>&nbsp;<span class="num" id="1496294">0x2029</span><span class="op" id="1496300">}</span><span class="op" id="1496301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496304">{</span><span class="num" id="1496305">0x202f</span><span class="op" id="1496311">,</span>&nbsp;<span class="num" id="1496313">0x202f</span><span class="op" id="1496319">}</span><span class="op" id="1496320">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496323">{</span><span class="num" id="1496324">0x205f</span><span class="op" id="1496330">,</span>&nbsp;<span class="num" id="1496332">0x205f</span><span class="op" id="1496338">}</span><span class="op" id="1496339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496342">{</span><span class="num" id="1496343">0x3000</span><span class="op" id="1496349">,</span>&nbsp;<span class="num" id="1496351">0x3000</span><span class="op" id="1496357">}</span><span class="op" id="1496358">,</span><br>
<span class="lineno"></span><span class="op" id="1496360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1496363">func</span>&nbsp;<span class="ident" id="1496368">isSpace</span><span class="op" id="1496375">(</span><span class="ident" id="1496376">r</span>&nbsp;<span class="builtintype" id="1496378">rune</span><span class="op" id="1496382">)</span>&nbsp;<span class="builtintype" id="1496384">bool</span>&nbsp;<span class="op" id="1496389">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496392">if</span>&nbsp;<span class="ident" id="1496395">r</span>&nbsp;<span class="op" id="1496397">&gt;=</span>&nbsp;<span class="num" id="1496400">1</span><span class="op" id="1496401">&lt;&lt;</span><span class="num" id="1496403">16</span>&nbsp;<span class="op" id="1496406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496410">return</span>&nbsp;<span class="builtintype" id="1496417">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496427">rx</span>&nbsp;<span class="op" id="1496430">:=</span>&nbsp;<span class="builtintype" id="1496433">uint16</span><span class="op" id="1496439">(</span><span class="ident" id="1496440">r</span><span class="op" id="1496441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496444">for</span>&nbsp;<span class="ident" id="1496448">_</span><span class="op" id="1496449">,</span>&nbsp;<span class="ident" id="1496451">rng</span>&nbsp;<span class="op" id="1496455">:=</span>&nbsp;<span class="keyword" id="1496458">range</span>&nbsp;<span class="ident" id="1496464">space</span>&nbsp;<span class="op" id="1496470">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496474">if</span>&nbsp;<span class="ident" id="1496477">rx</span>&nbsp;<span class="op" id="1496480">&lt;</span>&nbsp;<span class="ident" id="1496482">rng</span><span class="op" id="1496485">[</span><span class="num" id="1496486">0</span><span class="op" id="1496487">]</span>&nbsp;<span class="op" id="1496489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496494">return</span>&nbsp;<span class="builtintype" id="1496501">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496513">if</span>&nbsp;<span class="ident" id="1496516">rx</span>&nbsp;<span class="op" id="1496519">&lt;=</span>&nbsp;<span class="ident" id="1496522">rng</span><span class="op" id="1496525">[</span><span class="num" id="1496526">1</span><span class="op" id="1496527">]</span>&nbsp;<span class="op" id="1496529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496534">return</span>&nbsp;<span class="builtintype" id="1496541">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496554">return</span>&nbsp;<span class="builtintype" id="1496561">false</span><br>
<span class="lineno"></span><span class="op" id="1496567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1496570">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="1496630">func</span>&nbsp;<span class="ident" id="1496635">notSpace</span><span class="op" id="1496643">(</span><span class="ident" id="1496644">r</span>&nbsp;<span class="builtintype" id="1496646">rune</span><span class="op" id="1496650">)</span>&nbsp;<span class="builtintype" id="1496652">bool</span>&nbsp;<span class="op" id="1496657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496660">return</span>&nbsp;<span class="op" id="1496667">!</span><span class="ident" id="1496668">isSpace</span><span class="op" id="1496675">(</span><span class="ident" id="1496676">r</span><span class="op" id="1496677">)</span><br>
<span class="lineno"></span><span class="op" id="1496679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="1496682">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="1496755">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="1496833">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="1496853">func</span>&nbsp;<span class="op" id="1496858">(</span><span class="ident" id="1496859">s</span>&nbsp;<span class="op" id="1496861">*</span><span class="ident" id="1496862">ss</span><span class="op" id="1496864">)</span>&nbsp;<span class="ident" id="1496866">SkipSpace</span><span class="op" id="1496875">(</span><span class="op" id="1496876">)</span>&nbsp;<span class="op" id="1496878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496881">s</span><span class="op" id="1496882">.</span><span class="ident" id="1496883">skipSpace</span><span class="op" id="1496892">(</span><span class="builtintype" id="1496893">false</span><span class="op" id="1496898">)</span><br>
<span class="lineno">320</span><span class="op" id="1496900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1496903">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1496974">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1497048">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="1497088">type</span>&nbsp;<span class="ident" id="1497093">readRune</span>&nbsp;<span class="keyword" id="1497102">struct</span>&nbsp;<span class="op" id="1497109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497112">reader</span>&nbsp;&nbsp;<span class="ident" id="1497120">io</span><span class="op" id="1497122">.</span><span class="ident" id="1497123">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497131">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1497139">[</span><span class="ident" id="1497140">utf8</span><span class="op" id="1497144">.</span><span class="ident" id="1497145">UTFMax</span><span class="op" id="1497151">]</span><span class="builtintype" id="1497152">byte</span>&nbsp;<span class="comment" id="1497157">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497187">pending</span>&nbsp;<span class="builtintype" id="1497195">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1497213">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497267">pendBuf</span>&nbsp;<span class="op" id="1497275">[</span><span class="ident" id="1497276">utf8</span><span class="op" id="1497280">.</span><span class="ident" id="1497281">UTFMax</span><span class="op" id="1497287">]</span><span class="builtintype" id="1497288">byte</span>&nbsp;<span class="comment" id="1497293">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="1497312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1497315">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1497378">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="1497441">func</span>&nbsp;<span class="op" id="1497446">(</span><span class="ident" id="1497447">r</span>&nbsp;<span class="op" id="1497449">*</span><span class="ident" id="1497450">readRune</span><span class="op" id="1497458">)</span>&nbsp;<span class="ident" id="1497460">readByte</span><span class="op" id="1497468">(</span><span class="op" id="1497469">)</span>&nbsp;<span class="op" id="1497471">(</span><span class="ident" id="1497472">b</span>&nbsp;<span class="builtintype" id="1497474">byte</span><span class="op" id="1497478">,</span>&nbsp;<span class="ident" id="1497480">err</span>&nbsp;<span class="builtintype" id="1497484">error</span><span class="op" id="1497489">)</span>&nbsp;<span class="op" id="1497491">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497494">if</span>&nbsp;<span class="ident" id="1497497">r</span><span class="op" id="1497498">.</span><span class="ident" id="1497499">pending</span>&nbsp;<span class="op" id="1497507">&gt;</span>&nbsp;<span class="num" id="1497509">0</span>&nbsp;<span class="op" id="1497511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497515">b</span>&nbsp;<span class="op" id="1497517">=</span>&nbsp;<span class="ident" id="1497519">r</span><span class="op" id="1497520">.</span><span class="ident" id="1497521">pendBuf</span><span class="op" id="1497528">[</span><span class="num" id="1497529">0</span><span class="op" id="1497530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1497534">copy</span><span class="op" id="1497538">(</span><span class="ident" id="1497539">r</span><span class="op" id="1497540">.</span><span class="ident" id="1497541">pendBuf</span><span class="op" id="1497548">[</span><span class="num" id="1497549">0</span><span class="op" id="1497550">:</span><span class="op" id="1497551">]</span><span class="op" id="1497552">,</span>&nbsp;<span class="ident" id="1497554">r</span><span class="op" id="1497555">.</span><span class="ident" id="1497556">pendBuf</span><span class="op" id="1497563">[</span><span class="num" id="1497564">1</span><span class="op" id="1497565">:</span><span class="op" id="1497566">]</span><span class="op" id="1497567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497571">r</span><span class="op" id="1497572">.</span><span class="ident" id="1497573">pending</span><span class="op" id="1497580">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497585">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497596">n</span><span class="op" id="1497597">,</span>&nbsp;<span class="ident" id="1497599">err</span>&nbsp;<span class="op" id="1497603">:=</span>&nbsp;<span class="ident" id="1497606">io</span><span class="op" id="1497608">.</span><span class="ident" id="1497609">ReadFull</span><span class="op" id="1497617">(</span><span class="ident" id="1497618">r</span><span class="op" id="1497619">.</span><span class="ident" id="1497620">reader</span><span class="op" id="1497626">,</span>&nbsp;<span class="ident" id="1497628">r</span><span class="op" id="1497629">.</span><span class="ident" id="1497630">pendBuf</span><span class="op" id="1497637">[</span><span class="num" id="1497638">0</span><span class="op" id="1497639">:</span><span class="num" id="1497640">1</span><span class="op" id="1497641">]</span><span class="op" id="1497642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497645">if</span>&nbsp;<span class="ident" id="1497648">n</span>&nbsp;<span class="op" id="1497650">!=</span>&nbsp;<span class="num" id="1497653">1</span>&nbsp;<span class="op" id="1497655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497659">return</span>&nbsp;<span class="num" id="1497666">0</span><span class="op" id="1497667">,</span>&nbsp;<span class="ident" id="1497669">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497674">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497677">return</span>&nbsp;<span class="ident" id="1497684">r</span><span class="op" id="1497685">.</span><span class="ident" id="1497686">pendBuf</span><span class="op" id="1497693">[</span><span class="num" id="1497694">0</span><span class="op" id="1497695">]</span><span class="op" id="1497696">,</span>&nbsp;<span class="ident" id="1497698">err</span><br>
<span class="lineno"></span><span class="op" id="1497702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1497705">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="1497750">func</span>&nbsp;<span class="op" id="1497755">(</span><span class="ident" id="1497756">r</span>&nbsp;<span class="op" id="1497758">*</span><span class="ident" id="1497759">readRune</span><span class="op" id="1497767">)</span>&nbsp;<span class="ident" id="1497769">unread</span><span class="op" id="1497775">(</span><span class="ident" id="1497776">buf</span>&nbsp;<span class="op" id="1497780">[</span><span class="op" id="1497781">]</span><span class="builtintype" id="1497782">byte</span><span class="op" id="1497786">)</span>&nbsp;<span class="op" id="1497788">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1497791">copy</span><span class="op" id="1497795">(</span><span class="ident" id="1497796">r</span><span class="op" id="1497797">.</span><span class="ident" id="1497798">pendBuf</span><span class="op" id="1497805">[</span><span class="ident" id="1497806">r</span><span class="op" id="1497807">.</span><span class="ident" id="1497808">pending</span><span class="op" id="1497815">:</span><span class="op" id="1497816">]</span><span class="op" id="1497817">,</span>&nbsp;<span class="ident" id="1497819">buf</span><span class="op" id="1497822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497825">r</span><span class="op" id="1497826">.</span><span class="ident" id="1497827">pending</span>&nbsp;<span class="op" id="1497835">+=</span>&nbsp;<span class="builtinfunc" id="1497838">len</span><span class="op" id="1497841">(</span><span class="ident" id="1497842">buf</span><span class="op" id="1497845">)</span><br>
<span class="lineno"></span><span class="op" id="1497847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1497850">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="1497913">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="1497936">func</span>&nbsp;<span class="op" id="1497941">(</span><span class="ident" id="1497942">r</span>&nbsp;<span class="op" id="1497944">*</span><span class="ident" id="1497945">readRune</span><span class="op" id="1497953">)</span>&nbsp;<span class="ident" id="1497955">ReadRune</span><span class="op" id="1497963">(</span><span class="op" id="1497964">)</span>&nbsp;<span class="op" id="1497966">(</span><span class="ident" id="1497967">rr</span>&nbsp;<span class="builtintype" id="1497970">rune</span><span class="op" id="1497974">,</span>&nbsp;<span class="ident" id="1497976">size</span>&nbsp;<span class="builtintype" id="1497981">int</span><span class="op" id="1497984">,</span>&nbsp;<span class="ident" id="1497986">err</span>&nbsp;<span class="builtintype" id="1497990">error</span><span class="op" id="1497995">)</span>&nbsp;<span class="op" id="1497997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498000">r</span><span class="op" id="1498001">.</span><span class="ident" id="1498002">buf</span><span class="op" id="1498005">[</span><span class="num" id="1498006">0</span><span class="op" id="1498007">]</span><span class="op" id="1498008">,</span>&nbsp;<span class="ident" id="1498010">err</span>&nbsp;<span class="op" id="1498014">=</span>&nbsp;<span class="ident" id="1498016">r</span><span class="op" id="1498017">.</span><span class="ident" id="1498018">readByte</span><span class="op" id="1498026">(</span><span class="op" id="1498027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498030">if</span>&nbsp;<span class="ident" id="1498033">err</span>&nbsp;<span class="op" id="1498037">!=</span>&nbsp;<span class="ident" id="1498040">nil</span>&nbsp;<span class="op" id="1498044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498048">return</span>&nbsp;<span class="num" id="1498055">0</span><span class="op" id="1498056">,</span>&nbsp;<span class="num" id="1498058">0</span><span class="op" id="1498059">,</span>&nbsp;<span class="ident" id="1498061">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1498066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498069">if</span>&nbsp;<span class="ident" id="1498072">r</span><span class="op" id="1498073">.</span><span class="ident" id="1498074">buf</span><span class="op" id="1498077">[</span><span class="num" id="1498078">0</span><span class="op" id="1498079">]</span>&nbsp;<span class="op" id="1498081">&lt;</span>&nbsp;<span class="ident" id="1498083">utf8</span><span class="op" id="1498087">.</span><span class="ident" id="1498088">RuneSelf</span>&nbsp;<span class="op" id="1498097">{</span>&nbsp;<span class="comment" id="1498099">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498137">rr</span>&nbsp;<span class="op" id="1498140">=</span>&nbsp;<span class="builtintype" id="1498142">rune</span><span class="op" id="1498146">(</span><span class="ident" id="1498147">r</span><span class="op" id="1498148">.</span><span class="ident" id="1498149">buf</span><span class="op" id="1498152">[</span><span class="num" id="1498153">0</span><span class="op" id="1498154">]</span><span class="op" id="1498155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498159">size</span>&nbsp;<span class="op" id="1498164">=</span>&nbsp;<span class="num" id="1498166">1</span>&nbsp;<span class="comment" id="1498168">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498188">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1498196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498199">var</span>&nbsp;<span class="ident" id="1498203">n</span>&nbsp;<span class="builtintype" id="1498205">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498210">for</span>&nbsp;<span class="ident" id="1498214">n</span>&nbsp;<span class="op" id="1498216">=</span>&nbsp;<span class="num" id="1498218">1</span><span class="op" id="1498219">;</span>&nbsp;<span class="op" id="1498221">!</span><span class="ident" id="1498222">utf8</span><span class="op" id="1498226">.</span><span class="ident" id="1498227">FullRune</span><span class="op" id="1498235">(</span><span class="ident" id="1498236">r</span><span class="op" id="1498237">.</span><span class="ident" id="1498238">buf</span><span class="op" id="1498241">[</span><span class="num" id="1498242">0</span><span class="op" id="1498243">:</span><span class="ident" id="1498244">n</span><span class="op" id="1498245">]</span><span class="op" id="1498246">)</span><span class="op" id="1498247">;</span>&nbsp;<span class="ident" id="1498249">n</span><span class="op" id="1498250">++</span>&nbsp;<span class="op" id="1498253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498257">r</span><span class="op" id="1498258">.</span><span class="ident" id="1498259">buf</span><span class="op" id="1498262">[</span><span class="ident" id="1498263">n</span><span class="op" id="1498264">]</span><span class="op" id="1498265">,</span>&nbsp;<span class="ident" id="1498267">err</span>&nbsp;<span class="op" id="1498271">=</span>&nbsp;<span class="ident" id="1498273">r</span><span class="op" id="1498274">.</span><span class="ident" id="1498275">readByte</span><span class="op" id="1498283">(</span><span class="op" id="1498284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498288">if</span>&nbsp;<span class="ident" id="1498291">err</span>&nbsp;<span class="op" id="1498295">!=</span>&nbsp;<span class="ident" id="1498298">nil</span>&nbsp;<span class="op" id="1498302">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498307">if</span>&nbsp;<span class="ident" id="1498310">err</span>&nbsp;<span class="op" id="1498314">==</span>&nbsp;<span class="ident" id="1498317">io</span><span class="op" id="1498319">.</span><span class="ident" id="1498320">EOF</span>&nbsp;<span class="op" id="1498324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498330">err</span>&nbsp;<span class="op" id="1498334">=</span>&nbsp;<span class="ident" id="1498336">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498344">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1498353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498358">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1498367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1498370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498373">rr</span><span class="op" id="1498375">,</span>&nbsp;<span class="ident" id="1498377">size</span>&nbsp;<span class="op" id="1498382">=</span>&nbsp;<span class="ident" id="1498384">utf8</span><span class="op" id="1498388">.</span><span class="ident" id="1498389">DecodeRune</span><span class="op" id="1498399">(</span><span class="ident" id="1498400">r</span><span class="op" id="1498401">.</span><span class="ident" id="1498402">buf</span><span class="op" id="1498405">[</span><span class="num" id="1498406">0</span><span class="op" id="1498407">:</span><span class="ident" id="1498408">n</span><span class="op" id="1498409">]</span><span class="op" id="1498410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498413">if</span>&nbsp;<span class="ident" id="1498416">size</span>&nbsp;<span class="op" id="1498421">&lt;</span>&nbsp;<span class="ident" id="1498423">n</span>&nbsp;<span class="op" id="1498425">{</span>&nbsp;<span class="comment" id="1498427">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498441">r</span><span class="op" id="1498442">.</span><span class="ident" id="1498443">unread</span><span class="op" id="1498449">(</span><span class="ident" id="1498450">r</span><span class="op" id="1498451">.</span><span class="ident" id="1498452">buf</span><span class="op" id="1498455">[</span><span class="ident" id="1498456">size</span><span class="op" id="1498460">:</span><span class="ident" id="1498461">n</span><span class="op" id="1498462">]</span><span class="op" id="1498463">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1498466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498469">return</span><br>
<span class="lineno"></span><span class="op" id="1498476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1498479">var</span>&nbsp;<span class="ident" id="1498483">ssFree</span>&nbsp;<span class="op" id="1498490">=</span>&nbsp;<span class="ident" id="1498492">sync</span><span class="op" id="1498496">.</span><span class="ident" id="1498497">Pool</span><span class="op" id="1498501">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498504">New</span><span class="op" id="1498507">:</span>&nbsp;<span class="keyword" id="1498509">func</span><span class="op" id="1498513">(</span><span class="op" id="1498514">)</span>&nbsp;<span class="keyword" id="1498516">interface</span><span class="op" id="1498525">{</span><span class="op" id="1498526">}</span>&nbsp;<span class="op" id="1498528">{</span>&nbsp;<span class="keyword" id="1498530">return</span>&nbsp;<span class="builtinfunc" id="1498537">new</span><span class="op" id="1498540">(</span><span class="ident" id="1498541">ss</span><span class="op" id="1498543">)</span>&nbsp;<span class="op" id="1498545">}</span><span class="op" id="1498546">,</span><br>
<span class="lineno"></span><span class="op" id="1498548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1498551">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="1498615">func</span>&nbsp;<span class="ident" id="1498620">newScanState</span><span class="op" id="1498632">(</span><span class="ident" id="1498633">r</span>&nbsp;<span class="ident" id="1498635">io</span><span class="op" id="1498637">.</span><span class="ident" id="1498638">Reader</span><span class="op" id="1498644">,</span>&nbsp;<span class="ident" id="1498646">nlIsSpace</span><span class="op" id="1498655">,</span>&nbsp;<span class="ident" id="1498657">nlIsEnd</span>&nbsp;<span class="builtintype" id="1498665">bool</span><span class="op" id="1498669">)</span>&nbsp;<span class="op" id="1498671">(</span><span class="ident" id="1498672">s</span>&nbsp;<span class="op" id="1498674">*</span><span class="ident" id="1498675">ss</span><span class="op" id="1498677">,</span>&nbsp;<span class="ident" id="1498679">old</span>&nbsp;<span class="ident" id="1498683">ssave</span><span class="op" id="1498688">)</span>&nbsp;<span class="op" id="1498690">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498693">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1498748">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498792">s</span><span class="op" id="1498793">,</span>&nbsp;<span class="ident" id="1498795">ok</span>&nbsp;<span class="op" id="1498798">:=</span>&nbsp;<span class="ident" id="1498801">r</span><span class="op" id="1498802">.</span><span class="op" id="1498803">(</span><span class="op" id="1498804">*</span><span class="ident" id="1498805">ss</span><span class="op" id="1498807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498810">if</span>&nbsp;<span class="ident" id="1498813">ok</span>&nbsp;<span class="op" id="1498816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498820">old</span>&nbsp;<span class="op" id="1498824">=</span>&nbsp;<span class="ident" id="1498826">s</span><span class="op" id="1498827">.</span><span class="ident" id="1498828">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498836">s</span><span class="op" id="1498837">.</span><span class="ident" id="1498838">limit</span>&nbsp;<span class="op" id="1498844">=</span>&nbsp;<span class="ident" id="1498846">s</span><span class="op" id="1498847">.</span><span class="ident" id="1498848">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498859">s</span><span class="op" id="1498860">.</span><span class="ident" id="1498861">nlIsEnd</span>&nbsp;<span class="op" id="1498869">=</span>&nbsp;<span class="ident" id="1498871">nlIsEnd</span>&nbsp;<span class="op" id="1498879">||</span>&nbsp;<span class="ident" id="1498882">s</span><span class="op" id="1498883">.</span><span class="ident" id="1498884">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498894">s</span><span class="op" id="1498895">.</span><span class="ident" id="1498896">nlIsSpace</span>&nbsp;<span class="op" id="1498906">=</span>&nbsp;<span class="ident" id="1498908">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498920">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1498928">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498932">s</span>&nbsp;<span class="op" id="1498934">=</span>&nbsp;<span class="ident" id="1498936">ssFree</span><span class="op" id="1498942">.</span><span class="ident" id="1498943">Get</span><span class="op" id="1498946">(</span><span class="op" id="1498947">)</span><span class="op" id="1498948">.</span><span class="op" id="1498949">(</span><span class="op" id="1498950">*</span><span class="ident" id="1498951">ss</span><span class="op" id="1498953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1498956">if</span>&nbsp;<span class="ident" id="1498959">rr</span><span class="op" id="1498961">,</span>&nbsp;<span class="ident" id="1498963">ok</span>&nbsp;<span class="op" id="1498966">:=</span>&nbsp;<span class="ident" id="1498969">r</span><span class="op" id="1498970">.</span><span class="op" id="1498971">(</span><span class="ident" id="1498972">io</span><span class="op" id="1498974">.</span><span class="ident" id="1498975">RuneReader</span><span class="op" id="1498985">)</span><span class="op" id="1498986">;</span>&nbsp;<span class="ident" id="1498988">ok</span>&nbsp;<span class="op" id="1498991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1498995">s</span><span class="op" id="1498996">.</span><span class="ident" id="1498997">rr</span>&nbsp;<span class="op" id="1499000">=</span>&nbsp;<span class="ident" id="1499002">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499006">}</span>&nbsp;<span class="keyword" id="1499008">else</span>&nbsp;<span class="op" id="1499013">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499017">s</span><span class="op" id="1499018">.</span><span class="ident" id="1499019">rr</span>&nbsp;<span class="op" id="1499022">=</span>&nbsp;<span class="op" id="1499024">&amp;</span><span class="ident" id="1499025">readRune</span><span class="op" id="1499033">{</span><span class="ident" id="1499034">reader</span><span class="op" id="1499040">:</span>&nbsp;<span class="ident" id="1499042">r</span><span class="op" id="1499043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499049">s</span><span class="op" id="1499050">.</span><span class="ident" id="1499051">nlIsSpace</span>&nbsp;<span class="op" id="1499061">=</span>&nbsp;<span class="ident" id="1499063">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499074">s</span><span class="op" id="1499075">.</span><span class="ident" id="1499076">nlIsEnd</span>&nbsp;<span class="op" id="1499084">=</span>&nbsp;<span class="ident" id="1499086">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499095">s</span><span class="op" id="1499096">.</span><span class="ident" id="1499097">prevRune</span>&nbsp;<span class="op" id="1499106">=</span>&nbsp;<span class="op" id="1499108">-</span><span class="num" id="1499109">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499112">s</span><span class="op" id="1499113">.</span><span class="ident" id="1499114">peekRune</span>&nbsp;<span class="op" id="1499123">=</span>&nbsp;<span class="op" id="1499125">-</span><span class="num" id="1499126">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499129">s</span><span class="op" id="1499130">.</span><span class="ident" id="1499131">atEOF</span>&nbsp;<span class="op" id="1499137">=</span>&nbsp;<span class="builtintype" id="1499139">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499146">s</span><span class="op" id="1499147">.</span><span class="ident" id="1499148">limit</span>&nbsp;<span class="op" id="1499154">=</span>&nbsp;<span class="ident" id="1499156">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499165">s</span><span class="op" id="1499166">.</span><span class="ident" id="1499167">argLimit</span>&nbsp;<span class="op" id="1499176">=</span>&nbsp;<span class="ident" id="1499178">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499187">s</span><span class="op" id="1499188">.</span><span class="ident" id="1499189">maxWid</span>&nbsp;<span class="op" id="1499196">=</span>&nbsp;<span class="ident" id="1499198">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499207">s</span><span class="op" id="1499208">.</span><span class="ident" id="1499209">validSave</span>&nbsp;<span class="op" id="1499219">=</span>&nbsp;<span class="builtintype" id="1499221">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499227">s</span><span class="op" id="1499228">.</span><span class="ident" id="1499229">count</span>&nbsp;<span class="op" id="1499235">=</span>&nbsp;<span class="num" id="1499237">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499240">return</span><br>
<span class="lineno"></span><span class="op" id="1499247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="1499250">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="1499327">func</span>&nbsp;<span class="op" id="1499332">(</span><span class="ident" id="1499333">s</span>&nbsp;<span class="op" id="1499335">*</span><span class="ident" id="1499336">ss</span><span class="op" id="1499338">)</span>&nbsp;<span class="ident" id="1499340">free</span><span class="op" id="1499344">(</span><span class="ident" id="1499345">old</span>&nbsp;<span class="ident" id="1499349">ssave</span><span class="op" id="1499354">)</span>&nbsp;<span class="op" id="1499356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499359">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499419">if</span>&nbsp;<span class="ident" id="1499422">old</span><span class="op" id="1499425">.</span><span class="ident" id="1499426">validSave</span>&nbsp;<span class="op" id="1499436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499440">s</span><span class="op" id="1499441">.</span><span class="ident" id="1499442">ssave</span>&nbsp;<span class="op" id="1499448">=</span>&nbsp;<span class="ident" id="1499450">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499456">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1499467">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499519">if</span>&nbsp;<span class="builtinfunc" id="1499522">cap</span><span class="op" id="1499525">(</span><span class="ident" id="1499526">s</span><span class="op" id="1499527">.</span><span class="ident" id="1499528">buf</span><span class="op" id="1499531">)</span>&nbsp;<span class="op" id="1499533">&gt;</span>&nbsp;<span class="num" id="1499535">1024</span>&nbsp;<span class="op" id="1499540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499544">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499555">s</span><span class="op" id="1499556">.</span><span class="ident" id="1499557">buf</span>&nbsp;<span class="op" id="1499561">=</span>&nbsp;<span class="ident" id="1499563">s</span><span class="op" id="1499564">.</span><span class="ident" id="1499565">buf</span><span class="op" id="1499568">[</span><span class="op" id="1499569">:</span><span class="num" id="1499570">0</span><span class="op" id="1499571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499574">s</span><span class="op" id="1499575">.</span><span class="ident" id="1499576">rr</span>&nbsp;<span class="op" id="1499579">=</span>&nbsp;<span class="ident" id="1499581">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499586">ssFree</span><span class="op" id="1499592">.</span><span class="ident" id="1499593">Put</span><span class="op" id="1499596">(</span><span class="ident" id="1499597">s</span><span class="op" id="1499598">)</span><br>
<span class="lineno"></span><span class="op" id="1499600">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="1499603">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="1499649">func</span>&nbsp;<span class="op" id="1499654">(</span><span class="ident" id="1499655">s</span>&nbsp;<span class="op" id="1499657">*</span><span class="ident" id="1499658">ss</span><span class="op" id="1499660">)</span>&nbsp;<span class="ident" id="1499662">skipSpace</span><span class="op" id="1499671">(</span><span class="ident" id="1499672">stopAtNewline</span>&nbsp;<span class="builtintype" id="1499686">bool</span><span class="op" id="1499690">)</span>&nbsp;<span class="op" id="1499692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499695">for</span>&nbsp;<span class="op" id="1499699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499703">r</span>&nbsp;<span class="op" id="1499705">:=</span>&nbsp;<span class="ident" id="1499708">s</span><span class="op" id="1499709">.</span><span class="ident" id="1499710">getRune</span><span class="op" id="1499717">(</span><span class="op" id="1499718">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499722">if</span>&nbsp;<span class="ident" id="1499725">r</span>&nbsp;<span class="op" id="1499727">==</span>&nbsp;<span class="ident" id="1499730">eof</span>&nbsp;<span class="op" id="1499734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499739">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499752">if</span>&nbsp;<span class="ident" id="1499755">r</span>&nbsp;<span class="op" id="1499757">==</span>&nbsp;<span class="string" id="1499760">&#39;\r&#39;</span>&nbsp;<span class="op" id="1499765">&amp;&amp;</span>&nbsp;<span class="ident" id="1499768">s</span><span class="op" id="1499769">.</span><span class="ident" id="1499770">peek</span><span class="op" id="1499774">(</span><span class="string" id="1499775">&#34;\n&#34;</span><span class="op" id="1499779">)</span>&nbsp;<span class="op" id="1499781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499786">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499801">if</span>&nbsp;<span class="ident" id="1499804">r</span>&nbsp;<span class="op" id="1499806">==</span>&nbsp;<span class="string" id="1499809">&#39;\n&#39;</span>&nbsp;<span class="op" id="1499814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499819">if</span>&nbsp;<span class="ident" id="1499822">stopAtNewline</span>&nbsp;<span class="op" id="1499836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499842">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499851">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499856">if</span>&nbsp;<span class="ident" id="1499859">s</span><span class="op" id="1499860">.</span><span class="ident" id="1499861">nlIsSpace</span>&nbsp;<span class="op" id="1499871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499877">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499894">s</span><span class="op" id="1499895">.</span><span class="ident" id="1499896">errorString</span><span class="op" id="1499907">(</span><span class="string" id="1499908">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="1499928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499933">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499946">if</span>&nbsp;<span class="op" id="1499949">!</span><span class="ident" id="1499950">isSpace</span><span class="op" id="1499957">(</span><span class="ident" id="1499958">r</span><span class="op" id="1499959">)</span>&nbsp;<span class="op" id="1499961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1499966">s</span><span class="op" id="1499967">.</span><span class="ident" id="1499968">UnreadRune</span><span class="op" id="1499978">(</span><span class="op" id="1499979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1499984">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499992">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1499995">}</span><br>
<span class="lineno"></span><span class="op" id="1499997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1500000">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1500069">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="1500137">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="1500172">func</span>&nbsp;<span class="op" id="1500177">(</span><span class="ident" id="1500178">s</span>&nbsp;<span class="op" id="1500180">*</span><span class="ident" id="1500181">ss</span><span class="op" id="1500183">)</span>&nbsp;<span class="ident" id="1500185">token</span><span class="op" id="1500190">(</span><span class="ident" id="1500191">skipSpace</span>&nbsp;<span class="builtintype" id="1500201">bool</span><span class="op" id="1500205">,</span>&nbsp;<span class="ident" id="1500207">f</span>&nbsp;<span class="keyword" id="1500209">func</span><span class="op" id="1500213">(</span><span class="builtintype" id="1500214">rune</span><span class="op" id="1500218">)</span>&nbsp;<span class="builtintype" id="1500220">bool</span><span class="op" id="1500224">)</span>&nbsp;<span class="op" id="1500226">[</span><span class="op" id="1500227">]</span><span class="builtintype" id="1500228">byte</span>&nbsp;<span class="op" id="1500233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500236">if</span>&nbsp;<span class="ident" id="1500239">skipSpace</span>&nbsp;<span class="op" id="1500249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500253">s</span><span class="op" id="1500254">.</span><span class="ident" id="1500255">skipSpace</span><span class="op" id="1500264">(</span><span class="builtintype" id="1500265">false</span><span class="op" id="1500270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500273">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1500276">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500314">for</span>&nbsp;<span class="op" id="1500318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500322">r</span>&nbsp;<span class="op" id="1500324">:=</span>&nbsp;<span class="ident" id="1500327">s</span><span class="op" id="1500328">.</span><span class="ident" id="1500329">getRune</span><span class="op" id="1500336">(</span><span class="op" id="1500337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500341">if</span>&nbsp;<span class="ident" id="1500344">r</span>&nbsp;<span class="op" id="1500346">==</span>&nbsp;<span class="ident" id="1500349">eof</span>&nbsp;<span class="op" id="1500353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500358">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500370">if</span>&nbsp;<span class="op" id="1500373">!</span><span class="ident" id="1500374">f</span><span class="op" id="1500375">(</span><span class="ident" id="1500376">r</span><span class="op" id="1500377">)</span>&nbsp;<span class="op" id="1500379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500384">s</span><span class="op" id="1500385">.</span><span class="ident" id="1500386">UnreadRune</span><span class="op" id="1500396">(</span><span class="op" id="1500397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500402">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500410">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500414">s</span><span class="op" id="1500415">.</span><span class="ident" id="1500416">buf</span><span class="op" id="1500419">.</span><span class="ident" id="1500420">WriteRune</span><span class="op" id="1500429">(</span><span class="ident" id="1500430">r</span><span class="op" id="1500431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500437">return</span>&nbsp;<span class="ident" id="1500444">s</span><span class="op" id="1500445">.</span><span class="ident" id="1500446">buf</span><br>
<span class="lineno"></span><span class="op" id="1500450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="1500453">var</span>&nbsp;<span class="ident" id="1500457">complexError</span>&nbsp;<span class="op" id="1500470">=</span>&nbsp;<span class="ident" id="1500472">errors</span><span class="op" id="1500478">.</span><span class="ident" id="1500479">New</span><span class="op" id="1500482">(</span><span class="string" id="1500483">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="1500521">)</span><br>
<span class="lineno"></span><span class="keyword" id="1500523">var</span>&nbsp;<span class="ident" id="1500527">boolError</span>&nbsp;<span class="op" id="1500537">=</span>&nbsp;<span class="ident" id="1500539">errors</span><span class="op" id="1500545">.</span><span class="ident" id="1500546">New</span><span class="op" id="1500549">(</span><span class="string" id="1500550">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="1500581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1500584">func</span>&nbsp;<span class="ident" id="1500589">indexRune</span><span class="op" id="1500598">(</span><span class="ident" id="1500599">s</span>&nbsp;<span class="builtintype" id="1500601">string</span><span class="op" id="1500607">,</span>&nbsp;<span class="ident" id="1500609">r</span>&nbsp;<span class="builtintype" id="1500611">rune</span><span class="op" id="1500615">)</span>&nbsp;<span class="builtintype" id="1500617">int</span>&nbsp;<span class="op" id="1500621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500624">for</span>&nbsp;<span class="ident" id="1500628">i</span><span class="op" id="1500629">,</span>&nbsp;<span class="ident" id="1500631">c</span>&nbsp;<span class="op" id="1500633">:=</span>&nbsp;<span class="keyword" id="1500636">range</span>&nbsp;<span class="ident" id="1500642">s</span>&nbsp;<span class="op" id="1500644">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500648">if</span>&nbsp;<span class="ident" id="1500651">c</span>&nbsp;<span class="op" id="1500653">==</span>&nbsp;<span class="ident" id="1500656">r</span>&nbsp;<span class="op" id="1500658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500663">return</span>&nbsp;<span class="ident" id="1500670">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500680">return</span>&nbsp;<span class="op" id="1500687">-</span><span class="num" id="1500688">1</span><br>
<span class="lineno">495</span><span class="op" id="1500690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1500693">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1500781">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="1500847">func</span>&nbsp;<span class="op" id="1500852">(</span><span class="ident" id="1500853">s</span>&nbsp;<span class="op" id="1500855">*</span><span class="ident" id="1500856">ss</span><span class="op" id="1500858">)</span>&nbsp;<span class="ident" id="1500860">consume</span><span class="op" id="1500867">(</span><span class="ident" id="1500868">ok</span>&nbsp;<span class="builtintype" id="1500871">string</span><span class="op" id="1500877">,</span>&nbsp;<span class="ident" id="1500879">accept</span>&nbsp;<span class="builtintype" id="1500886">bool</span><span class="op" id="1500890">)</span>&nbsp;<span class="builtintype" id="1500892">bool</span>&nbsp;<span class="op" id="1500897">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500900">r</span>&nbsp;<span class="op" id="1500902">:=</span>&nbsp;<span class="ident" id="1500905">s</span><span class="op" id="1500906">.</span><span class="ident" id="1500907">getRune</span><span class="op" id="1500914">(</span><span class="op" id="1500915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500918">if</span>&nbsp;<span class="ident" id="1500921">r</span>&nbsp;<span class="op" id="1500923">==</span>&nbsp;<span class="ident" id="1500926">eof</span>&nbsp;<span class="op" id="1500930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500934">return</span>&nbsp;<span class="builtintype" id="1500941">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1500948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500951">if</span>&nbsp;<span class="ident" id="1500954">indexRune</span><span class="op" id="1500963">(</span><span class="ident" id="1500964">ok</span><span class="op" id="1500966">,</span>&nbsp;<span class="ident" id="1500968">r</span><span class="op" id="1500969">)</span>&nbsp;<span class="op" id="1500971">&gt;=</span>&nbsp;<span class="num" id="1500974">0</span>&nbsp;<span class="op" id="1500976">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1500980">if</span>&nbsp;<span class="ident" id="1500983">accept</span>&nbsp;<span class="op" id="1500990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1500995">s</span><span class="op" id="1500996">.</span><span class="ident" id="1500997">buf</span><span class="op" id="1501000">.</span><span class="ident" id="1501001">WriteRune</span><span class="op" id="1501010">(</span><span class="ident" id="1501011">r</span><span class="op" id="1501012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501020">return</span>&nbsp;<span class="builtintype" id="1501027">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501033">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501036">if</span>&nbsp;<span class="ident" id="1501039">r</span>&nbsp;<span class="op" id="1501041">!=</span>&nbsp;<span class="ident" id="1501044">eof</span>&nbsp;<span class="op" id="1501048">&amp;&amp;</span>&nbsp;<span class="ident" id="1501051">accept</span>&nbsp;<span class="op" id="1501058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501062">s</span><span class="op" id="1501063">.</span><span class="ident" id="1501064">UnreadRune</span><span class="op" id="1501074">(</span><span class="op" id="1501075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501081">return</span>&nbsp;<span class="builtintype" id="1501088">false</span><br>
<span class="lineno"></span><span class="op" id="1501094">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="1501097">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1501183">func</span>&nbsp;<span class="op" id="1501188">(</span><span class="ident" id="1501189">s</span>&nbsp;<span class="op" id="1501191">*</span><span class="ident" id="1501192">ss</span><span class="op" id="1501194">)</span>&nbsp;<span class="ident" id="1501196">peek</span><span class="op" id="1501200">(</span><span class="ident" id="1501201">ok</span>&nbsp;<span class="builtintype" id="1501204">string</span><span class="op" id="1501210">)</span>&nbsp;<span class="builtintype" id="1501212">bool</span>&nbsp;<span class="op" id="1501217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501220">r</span>&nbsp;<span class="op" id="1501222">:=</span>&nbsp;<span class="ident" id="1501225">s</span><span class="op" id="1501226">.</span><span class="ident" id="1501227">getRune</span><span class="op" id="1501234">(</span><span class="op" id="1501235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501238">if</span>&nbsp;<span class="ident" id="1501241">r</span>&nbsp;<span class="op" id="1501243">!=</span>&nbsp;<span class="ident" id="1501246">eof</span>&nbsp;<span class="op" id="1501250">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501254">s</span><span class="op" id="1501255">.</span><span class="ident" id="1501256">UnreadRune</span><span class="op" id="1501266">(</span><span class="op" id="1501267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501273">return</span>&nbsp;<span class="ident" id="1501280">indexRune</span><span class="op" id="1501289">(</span><span class="ident" id="1501290">ok</span><span class="op" id="1501292">,</span>&nbsp;<span class="ident" id="1501294">r</span><span class="op" id="1501295">)</span>&nbsp;<span class="op" id="1501297">&gt;=</span>&nbsp;<span class="num" id="1501300">0</span><br>
<span class="lineno"></span><span class="op" id="1501302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="1501305">func</span>&nbsp;<span class="op" id="1501310">(</span><span class="ident" id="1501311">s</span>&nbsp;<span class="op" id="1501313">*</span><span class="ident" id="1501314">ss</span><span class="op" id="1501316">)</span>&nbsp;<span class="ident" id="1501318">notEOF</span><span class="op" id="1501324">(</span><span class="op" id="1501325">)</span>&nbsp;<span class="op" id="1501327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1501330">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501370">if</span>&nbsp;<span class="ident" id="1501373">r</span>&nbsp;<span class="op" id="1501375">:=</span>&nbsp;<span class="ident" id="1501378">s</span><span class="op" id="1501379">.</span><span class="ident" id="1501380">getRune</span><span class="op" id="1501387">(</span><span class="op" id="1501388">)</span><span class="op" id="1501389">;</span>&nbsp;<span class="ident" id="1501391">r</span>&nbsp;<span class="op" id="1501393">==</span>&nbsp;<span class="ident" id="1501396">eof</span>&nbsp;<span class="op" id="1501400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1501404">panic</span><span class="op" id="1501409">(</span><span class="ident" id="1501410">io</span><span class="op" id="1501412">.</span><span class="ident" id="1501413">EOF</span><span class="op" id="1501416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501419">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501422">s</span><span class="op" id="1501423">.</span><span class="ident" id="1501424">UnreadRune</span><span class="op" id="1501434">(</span><span class="op" id="1501435">)</span><br>
<span class="lineno"></span><span class="op" id="1501437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1501440">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1501540">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="1501595">func</span>&nbsp;<span class="op" id="1501600">(</span><span class="ident" id="1501601">s</span>&nbsp;<span class="op" id="1501603">*</span><span class="ident" id="1501604">ss</span><span class="op" id="1501606">)</span>&nbsp;<span class="ident" id="1501608">accept</span><span class="op" id="1501614">(</span><span class="ident" id="1501615">ok</span>&nbsp;<span class="builtintype" id="1501618">string</span><span class="op" id="1501624">)</span>&nbsp;<span class="builtintype" id="1501626">bool</span>&nbsp;<span class="op" id="1501631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501634">return</span>&nbsp;<span class="ident" id="1501641">s</span><span class="op" id="1501642">.</span><span class="ident" id="1501643">consume</span><span class="op" id="1501650">(</span><span class="ident" id="1501651">ok</span><span class="op" id="1501653">,</span>&nbsp;<span class="builtintype" id="1501655">true</span><span class="op" id="1501659">)</span><br>
<span class="lineno"></span><span class="op" id="1501661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1501664">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="1501757">func</span>&nbsp;<span class="op" id="1501762">(</span><span class="ident" id="1501763">s</span>&nbsp;<span class="op" id="1501765">*</span><span class="ident" id="1501766">ss</span><span class="op" id="1501768">)</span>&nbsp;<span class="ident" id="1501770">okVerb</span><span class="op" id="1501776">(</span><span class="ident" id="1501777">verb</span>&nbsp;<span class="builtintype" id="1501782">rune</span><span class="op" id="1501786">,</span>&nbsp;<span class="ident" id="1501788">okVerbs</span><span class="op" id="1501795">,</span>&nbsp;<span class="ident" id="1501797">typ</span>&nbsp;<span class="builtintype" id="1501801">string</span><span class="op" id="1501807">)</span>&nbsp;<span class="builtintype" id="1501809">bool</span>&nbsp;<span class="op" id="1501814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501817">for</span>&nbsp;<span class="ident" id="1501821">_</span><span class="op" id="1501822">,</span>&nbsp;<span class="ident" id="1501824">v</span>&nbsp;<span class="op" id="1501826">:=</span>&nbsp;<span class="keyword" id="1501829">range</span>&nbsp;<span class="ident" id="1501835">okVerbs</span>&nbsp;<span class="op" id="1501843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501847">if</span>&nbsp;<span class="ident" id="1501850">v</span>&nbsp;<span class="op" id="1501852">==</span>&nbsp;<span class="ident" id="1501855">verb</span>&nbsp;<span class="op" id="1501860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501865">return</span>&nbsp;<span class="builtintype" id="1501872">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501879">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1501882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1501885">s</span><span class="op" id="1501886">.</span><span class="ident" id="1501887">errorString</span><span class="op" id="1501898">(</span><span class="string" id="1501899">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="1501912">+</span>&nbsp;<span class="builtintype" id="1501914">string</span><span class="op" id="1501920">(</span><span class="ident" id="1501921">verb</span><span class="op" id="1501925">)</span>&nbsp;<span class="op" id="1501927">+</span>&nbsp;<span class="string" id="1501929">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="1501937">+</span>&nbsp;<span class="ident" id="1501939">typ</span><span class="op" id="1501942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1501945">return</span>&nbsp;<span class="builtintype" id="1501952">false</span><br>
<span class="lineno"></span><span class="op" id="1501958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="1501961">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="1502037">func</span>&nbsp;<span class="op" id="1502042">(</span><span class="ident" id="1502043">s</span>&nbsp;<span class="op" id="1502045">*</span><span class="ident" id="1502046">ss</span><span class="op" id="1502048">)</span>&nbsp;<span class="ident" id="1502050">scanBool</span><span class="op" id="1502058">(</span><span class="ident" id="1502059">verb</span>&nbsp;<span class="builtintype" id="1502064">rune</span><span class="op" id="1502068">)</span>&nbsp;<span class="builtintype" id="1502070">bool</span>&nbsp;<span class="op" id="1502075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502078">s</span><span class="op" id="1502079">.</span><span class="ident" id="1502080">skipSpace</span><span class="op" id="1502089">(</span><span class="builtintype" id="1502090">false</span><span class="op" id="1502095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502098">s</span><span class="op" id="1502099">.</span><span class="ident" id="1502100">notEOF</span><span class="op" id="1502106">(</span><span class="op" id="1502107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502110">if</span>&nbsp;<span class="op" id="1502113">!</span><span class="ident" id="1502114">s</span><span class="op" id="1502115">.</span><span class="ident" id="1502116">okVerb</span><span class="op" id="1502122">(</span><span class="ident" id="1502123">verb</span><span class="op" id="1502127">,</span>&nbsp;<span class="string" id="1502129">&#34;tv&#34;</span><span class="op" id="1502133">,</span>&nbsp;<span class="string" id="1502135">&#34;boolean&#34;</span><span class="op" id="1502144">)</span>&nbsp;<span class="op" id="1502146">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502150">return</span>&nbsp;<span class="builtintype" id="1502157">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1502167">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502244">switch</span>&nbsp;<span class="ident" id="1502251">s</span><span class="op" id="1502252">.</span><span class="ident" id="1502253">getRune</span><span class="op" id="1502260">(</span><span class="op" id="1502261">)</span>&nbsp;<span class="op" id="1502263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502266">case</span>&nbsp;<span class="string" id="1502271">&#39;0&#39;</span><span class="op" id="1502274">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502278">return</span>&nbsp;<span class="builtintype" id="1502285">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502292">case</span>&nbsp;<span class="string" id="1502297">&#39;1&#39;</span><span class="op" id="1502300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502304">return</span>&nbsp;<span class="builtintype" id="1502311">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502317">case</span>&nbsp;<span class="string" id="1502322">&#39;t&#39;</span><span class="op" id="1502325">,</span>&nbsp;<span class="string" id="1502327">&#39;T&#39;</span><span class="op" id="1502330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502334">if</span>&nbsp;<span class="ident" id="1502337">s</span><span class="op" id="1502338">.</span><span class="ident" id="1502339">accept</span><span class="op" id="1502345">(</span><span class="string" id="1502346">&#34;rR&#34;</span><span class="op" id="1502350">)</span>&nbsp;<span class="op" id="1502352">&amp;&amp;</span>&nbsp;<span class="op" id="1502355">(</span><span class="op" id="1502356">!</span><span class="ident" id="1502357">s</span><span class="op" id="1502358">.</span><span class="ident" id="1502359">accept</span><span class="op" id="1502365">(</span><span class="string" id="1502366">&#34;uU&#34;</span><span class="op" id="1502370">)</span>&nbsp;<span class="op" id="1502372">||</span>&nbsp;<span class="op" id="1502375">!</span><span class="ident" id="1502376">s</span><span class="op" id="1502377">.</span><span class="ident" id="1502378">accept</span><span class="op" id="1502384">(</span><span class="string" id="1502385">&#34;eE&#34;</span><span class="op" id="1502389">)</span><span class="op" id="1502390">)</span>&nbsp;<span class="op" id="1502392">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502397">s</span><span class="op" id="1502398">.</span><span class="builtintype" id="1502399">error</span><span class="op" id="1502404">(</span><span class="ident" id="1502405">boolError</span><span class="op" id="1502414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502422">return</span>&nbsp;<span class="builtintype" id="1502429">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502435">case</span>&nbsp;<span class="string" id="1502440">&#39;f&#39;</span><span class="op" id="1502443">,</span>&nbsp;<span class="string" id="1502445">&#39;F&#39;</span><span class="op" id="1502448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502452">if</span>&nbsp;<span class="ident" id="1502455">s</span><span class="op" id="1502456">.</span><span class="ident" id="1502457">accept</span><span class="op" id="1502463">(</span><span class="string" id="1502464">&#34;aA&#34;</span><span class="op" id="1502468">)</span>&nbsp;<span class="op" id="1502470">&amp;&amp;</span>&nbsp;<span class="op" id="1502473">(</span><span class="op" id="1502474">!</span><span class="ident" id="1502475">s</span><span class="op" id="1502476">.</span><span class="ident" id="1502477">accept</span><span class="op" id="1502483">(</span><span class="string" id="1502484">&#34;lL&#34;</span><span class="op" id="1502488">)</span>&nbsp;<span class="op" id="1502490">||</span>&nbsp;<span class="op" id="1502493">!</span><span class="ident" id="1502494">s</span><span class="op" id="1502495">.</span><span class="ident" id="1502496">accept</span><span class="op" id="1502502">(</span><span class="string" id="1502503">&#34;sS&#34;</span><span class="op" id="1502507">)</span>&nbsp;<span class="op" id="1502509">||</span>&nbsp;<span class="op" id="1502512">!</span><span class="ident" id="1502513">s</span><span class="op" id="1502514">.</span><span class="ident" id="1502515">accept</span><span class="op" id="1502521">(</span><span class="string" id="1502522">&#34;eE&#34;</span><span class="op" id="1502526">)</span><span class="op" id="1502527">)</span>&nbsp;<span class="op" id="1502529">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502534">s</span><span class="op" id="1502535">.</span><span class="builtintype" id="1502536">error</span><span class="op" id="1502541">(</span><span class="ident" id="1502542">boolError</span><span class="op" id="1502551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502559">return</span>&nbsp;<span class="builtintype" id="1502566">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1502573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1502576">return</span>&nbsp;<span class="builtintype" id="1502583">false</span><br>
<span class="lineno">575</span><span class="op" id="1502589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1502592">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="1502614">const</span>&nbsp;<span class="op" id="1502620">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502623">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1502641">=</span>&nbsp;<span class="string" id="1502643">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502649">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1502667">=</span>&nbsp;<span class="string" id="1502669">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502681">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1502699">=</span>&nbsp;<span class="string" id="1502701">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502715">hexadecimalDigits</span>&nbsp;<span class="op" id="1502733">=</span>&nbsp;<span class="string" id="1502735">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502761">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1502779">=</span>&nbsp;<span class="string" id="1502781">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502787">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1502805">=</span>&nbsp;<span class="string" id="1502807">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502812">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1502830">=</span>&nbsp;<span class="string" id="1502832">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="1502838">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1502841">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1502923">func</span>&nbsp;<span class="op" id="1502928">(</span><span class="ident" id="1502929">s</span>&nbsp;<span class="op" id="1502931">*</span><span class="ident" id="1502932">ss</span><span class="op" id="1502934">)</span>&nbsp;<span class="ident" id="1502936">getBase</span><span class="op" id="1502943">(</span><span class="ident" id="1502944">verb</span>&nbsp;<span class="builtintype" id="1502949">rune</span><span class="op" id="1502953">)</span>&nbsp;<span class="op" id="1502955">(</span><span class="ident" id="1502956">base</span>&nbsp;<span class="builtintype" id="1502961">int</span><span class="op" id="1502964">,</span>&nbsp;<span class="ident" id="1502966">digits</span>&nbsp;<span class="builtintype" id="1502973">string</span><span class="op" id="1502979">)</span>&nbsp;<span class="op" id="1502981">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1502984">s</span><span class="op" id="1502985">.</span><span class="ident" id="1502986">okVerb</span><span class="op" id="1502992">(</span><span class="ident" id="1502993">verb</span><span class="op" id="1502997">,</span>&nbsp;<span class="string" id="1502999">&#34;bdoUxXv&#34;</span><span class="op" id="1503008">,</span>&nbsp;<span class="string" id="1503010">&#34;integer&#34;</span><span class="op" id="1503019">)</span>&nbsp;<span class="comment" id="1503021">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503036">base</span>&nbsp;<span class="op" id="1503041">=</span>&nbsp;<span class="num" id="1503043">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503047">digits</span>&nbsp;<span class="op" id="1503054">=</span>&nbsp;<span class="ident" id="1503056">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503071">switch</span>&nbsp;<span class="ident" id="1503078">verb</span>&nbsp;<span class="op" id="1503083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503086">case</span>&nbsp;<span class="string" id="1503091">&#39;b&#39;</span><span class="op" id="1503094">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503098">base</span>&nbsp;<span class="op" id="1503103">=</span>&nbsp;<span class="num" id="1503105">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503109">digits</span>&nbsp;<span class="op" id="1503116">=</span>&nbsp;<span class="ident" id="1503118">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503132">case</span>&nbsp;<span class="string" id="1503137">&#39;o&#39;</span><span class="op" id="1503140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503144">base</span>&nbsp;<span class="op" id="1503149">=</span>&nbsp;<span class="num" id="1503151">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503155">digits</span>&nbsp;<span class="op" id="1503162">=</span>&nbsp;<span class="ident" id="1503164">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503177">case</span>&nbsp;<span class="string" id="1503182">&#39;x&#39;</span><span class="op" id="1503185">,</span>&nbsp;<span class="string" id="1503187">&#39;X&#39;</span><span class="op" id="1503190">,</span>&nbsp;<span class="string" id="1503192">&#39;U&#39;</span><span class="op" id="1503195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503199">base</span>&nbsp;<span class="op" id="1503204">=</span>&nbsp;<span class="num" id="1503206">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503211">digits</span>&nbsp;<span class="op" id="1503218">=</span>&nbsp;<span class="ident" id="1503220">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1503239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503242">return</span><br>
<span class="lineno">605</span><span class="op" id="1503249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1503252">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="1503332">func</span>&nbsp;<span class="op" id="1503337">(</span><span class="ident" id="1503338">s</span>&nbsp;<span class="op" id="1503340">*</span><span class="ident" id="1503341">ss</span><span class="op" id="1503343">)</span>&nbsp;<span class="ident" id="1503345">scanNumber</span><span class="op" id="1503355">(</span><span class="ident" id="1503356">digits</span>&nbsp;<span class="builtintype" id="1503363">string</span><span class="op" id="1503369">,</span>&nbsp;<span class="ident" id="1503371">haveDigits</span>&nbsp;<span class="builtintype" id="1503382">bool</span><span class="op" id="1503386">)</span>&nbsp;<span class="builtintype" id="1503388">string</span>&nbsp;<span class="op" id="1503395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503398">if</span>&nbsp;<span class="op" id="1503401">!</span><span class="ident" id="1503402">haveDigits</span>&nbsp;<span class="op" id="1503413">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503417">s</span><span class="op" id="1503418">.</span><span class="ident" id="1503419">notEOF</span><span class="op" id="1503425">(</span><span class="op" id="1503426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503430">if</span>&nbsp;<span class="op" id="1503433">!</span><span class="ident" id="1503434">s</span><span class="op" id="1503435">.</span><span class="ident" id="1503436">accept</span><span class="op" id="1503442">(</span><span class="ident" id="1503443">digits</span><span class="op" id="1503449">)</span>&nbsp;<span class="op" id="1503451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503456">s</span><span class="op" id="1503457">.</span><span class="ident" id="1503458">errorString</span><span class="op" id="1503469">(</span><span class="string" id="1503470">&#34;expected&nbsp;integer&#34;</span><span class="op" id="1503488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1503492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1503495">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503498">for</span>&nbsp;<span class="ident" id="1503502">s</span><span class="op" id="1503503">.</span><span class="ident" id="1503504">accept</span><span class="op" id="1503510">(</span><span class="ident" id="1503511">digits</span><span class="op" id="1503517">)</span>&nbsp;<span class="op" id="1503519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1503522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503525">return</span>&nbsp;<span class="builtintype" id="1503532">string</span><span class="op" id="1503538">(</span><span class="ident" id="1503539">s</span><span class="op" id="1503540">.</span><span class="ident" id="1503541">buf</span><span class="op" id="1503544">)</span><br>
<span class="lineno"></span><span class="op" id="1503546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="1503549">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="1503603">func</span>&nbsp;<span class="op" id="1503608">(</span><span class="ident" id="1503609">s</span>&nbsp;<span class="op" id="1503611">*</span><span class="ident" id="1503612">ss</span><span class="op" id="1503614">)</span>&nbsp;<span class="ident" id="1503616">scanRune</span><span class="op" id="1503624">(</span><span class="ident" id="1503625">bitSize</span>&nbsp;<span class="builtintype" id="1503633">int</span><span class="op" id="1503636">)</span>&nbsp;<span class="ident" id="1503638">int64</span>&nbsp;<span class="op" id="1503644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503647">s</span><span class="op" id="1503648">.</span><span class="ident" id="1503649">notEOF</span><span class="op" id="1503655">(</span><span class="op" id="1503656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503659">r</span>&nbsp;<span class="op" id="1503661">:=</span>&nbsp;<span class="ident" id="1503664">int64</span><span class="op" id="1503669">(</span><span class="ident" id="1503670">s</span><span class="op" id="1503671">.</span><span class="ident" id="1503672">getRune</span><span class="op" id="1503679">(</span><span class="op" id="1503680">)</span><span class="op" id="1503681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503684">n</span>&nbsp;<span class="op" id="1503686">:=</span>&nbsp;<span class="builtintype" id="1503689">uint</span><span class="op" id="1503693">(</span><span class="ident" id="1503694">bitSize</span><span class="op" id="1503701">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503704">x</span>&nbsp;<span class="op" id="1503706">:=</span>&nbsp;<span class="op" id="1503709">(</span><span class="ident" id="1503710">r</span>&nbsp;<span class="op" id="1503712">&lt;&lt;</span>&nbsp;<span class="op" id="1503715">(</span><span class="num" id="1503716">64</span>&nbsp;<span class="op" id="1503719">-</span>&nbsp;<span class="ident" id="1503721">n</span><span class="op" id="1503722">)</span><span class="op" id="1503723">)</span>&nbsp;<span class="op" id="1503725">&gt;&gt;</span>&nbsp;<span class="op" id="1503728">(</span><span class="num" id="1503729">64</span>&nbsp;<span class="op" id="1503732">-</span>&nbsp;<span class="ident" id="1503734">n</span><span class="op" id="1503735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503738">if</span>&nbsp;<span class="ident" id="1503741">x</span>&nbsp;<span class="op" id="1503743">!=</span>&nbsp;<span class="ident" id="1503746">r</span>&nbsp;<span class="op" id="1503748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1503752">s</span><span class="op" id="1503753">.</span><span class="ident" id="1503754">errorString</span><span class="op" id="1503765">(</span><span class="string" id="1503766">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="1503797">+</span>&nbsp;<span class="builtintype" id="1503799">string</span><span class="op" id="1503805">(</span><span class="ident" id="1503806">r</span><span class="op" id="1503807">)</span><span class="op" id="1503808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1503811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1503814">return</span>&nbsp;<span class="ident" id="1503821">r</span><br>
<span class="lineno">630</span><span class="op" id="1503823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1503826">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="1503895">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="1503964">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="1504004">func</span>&nbsp;<span class="op" id="1504009">(</span><span class="ident" id="1504010">s</span>&nbsp;<span class="op" id="1504012">*</span><span class="ident" id="1504013">ss</span><span class="op" id="1504015">)</span>&nbsp;<span class="ident" id="1504017">scanBasePrefix</span><span class="op" id="1504031">(</span><span class="op" id="1504032">)</span>&nbsp;<span class="op" id="1504034">(</span><span class="ident" id="1504035">base</span>&nbsp;<span class="builtintype" id="1504040">int</span><span class="op" id="1504043">,</span>&nbsp;<span class="ident" id="1504045">digits</span>&nbsp;<span class="builtintype" id="1504052">string</span><span class="op" id="1504058">,</span>&nbsp;<span class="ident" id="1504060">found</span>&nbsp;<span class="builtintype" id="1504066">bool</span><span class="op" id="1504070">)</span>&nbsp;<span class="op" id="1504072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504075">if</span>&nbsp;<span class="op" id="1504078">!</span><span class="ident" id="1504079">s</span><span class="op" id="1504080">.</span><span class="ident" id="1504081">peek</span><span class="op" id="1504085">(</span><span class="string" id="1504086">&#34;0&#34;</span><span class="op" id="1504089">)</span>&nbsp;<span class="op" id="1504091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504095">return</span>&nbsp;<span class="num" id="1504102">10</span><span class="op" id="1504104">,</span>&nbsp;<span class="ident" id="1504106">decimalDigits</span><span class="op" id="1504119">,</span>&nbsp;<span class="builtintype" id="1504121">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1504128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504131">s</span><span class="op" id="1504132">.</span><span class="ident" id="1504133">accept</span><span class="op" id="1504139">(</span><span class="string" id="1504140">&#34;0&#34;</span><span class="op" id="1504143">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504146">found</span>&nbsp;<span class="op" id="1504152">=</span>&nbsp;<span class="builtintype" id="1504154">true</span>&nbsp;<span class="comment" id="1504159">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1504204">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504238">base</span><span class="op" id="1504242">,</span>&nbsp;<span class="ident" id="1504244">digits</span>&nbsp;<span class="op" id="1504251">=</span>&nbsp;<span class="num" id="1504253">8</span><span class="op" id="1504254">,</span>&nbsp;<span class="ident" id="1504256">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504269">if</span>&nbsp;<span class="ident" id="1504272">s</span><span class="op" id="1504273">.</span><span class="ident" id="1504274">peek</span><span class="op" id="1504278">(</span><span class="string" id="1504279">&#34;xX&#34;</span><span class="op" id="1504283">)</span>&nbsp;<span class="op" id="1504285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504289">s</span><span class="op" id="1504290">.</span><span class="ident" id="1504291">consume</span><span class="op" id="1504298">(</span><span class="string" id="1504299">&#34;xX&#34;</span><span class="op" id="1504303">,</span>&nbsp;<span class="builtintype" id="1504305">false</span><span class="op" id="1504310">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504314">base</span><span class="op" id="1504318">,</span>&nbsp;<span class="ident" id="1504320">digits</span>&nbsp;<span class="op" id="1504327">=</span>&nbsp;<span class="num" id="1504329">16</span><span class="op" id="1504331">,</span>&nbsp;<span class="ident" id="1504333">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1504352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504355">return</span><br>
<span class="lineno"></span><span class="op" id="1504362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="1504365">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="1504433">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="1504497">func</span>&nbsp;<span class="op" id="1504502">(</span><span class="ident" id="1504503">s</span>&nbsp;<span class="op" id="1504505">*</span><span class="ident" id="1504506">ss</span><span class="op" id="1504508">)</span>&nbsp;<span class="ident" id="1504510">scanInt</span><span class="op" id="1504517">(</span><span class="ident" id="1504518">verb</span>&nbsp;<span class="builtintype" id="1504523">rune</span><span class="op" id="1504527">,</span>&nbsp;<span class="ident" id="1504529">bitSize</span>&nbsp;<span class="builtintype" id="1504537">int</span><span class="op" id="1504540">)</span>&nbsp;<span class="ident" id="1504542">int64</span>&nbsp;<span class="op" id="1504548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504551">if</span>&nbsp;<span class="ident" id="1504554">verb</span>&nbsp;<span class="op" id="1504559">==</span>&nbsp;<span class="string" id="1504562">&#39;c&#39;</span>&nbsp;<span class="op" id="1504566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504570">return</span>&nbsp;<span class="ident" id="1504577">s</span><span class="op" id="1504578">.</span><span class="ident" id="1504579">scanRune</span><span class="op" id="1504587">(</span><span class="ident" id="1504588">bitSize</span><span class="op" id="1504595">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1504598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504601">s</span><span class="op" id="1504602">.</span><span class="ident" id="1504603">skipSpace</span><span class="op" id="1504612">(</span><span class="builtintype" id="1504613">false</span><span class="op" id="1504618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504621">s</span><span class="op" id="1504622">.</span><span class="ident" id="1504623">notEOF</span><span class="op" id="1504629">(</span><span class="op" id="1504630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504633">base</span><span class="op" id="1504637">,</span>&nbsp;<span class="ident" id="1504639">digits</span>&nbsp;<span class="op" id="1504646">:=</span>&nbsp;<span class="ident" id="1504649">s</span><span class="op" id="1504650">.</span><span class="ident" id="1504651">getBase</span><span class="op" id="1504658">(</span><span class="ident" id="1504659">verb</span><span class="op" id="1504663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504666">haveDigits</span>&nbsp;<span class="op" id="1504677">:=</span>&nbsp;<span class="builtintype" id="1504680">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504687">if</span>&nbsp;<span class="ident" id="1504690">verb</span>&nbsp;<span class="op" id="1504695">==</span>&nbsp;<span class="string" id="1504698">&#39;U&#39;</span>&nbsp;<span class="op" id="1504702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504706">if</span>&nbsp;<span class="op" id="1504709">!</span><span class="ident" id="1504710">s</span><span class="op" id="1504711">.</span><span class="ident" id="1504712">consume</span><span class="op" id="1504719">(</span><span class="string" id="1504720">&#34;U&#34;</span><span class="op" id="1504723">,</span>&nbsp;<span class="builtintype" id="1504725">false</span><span class="op" id="1504730">)</span>&nbsp;<span class="op" id="1504732">||</span>&nbsp;<span class="op" id="1504735">!</span><span class="ident" id="1504736">s</span><span class="op" id="1504737">.</span><span class="ident" id="1504738">consume</span><span class="op" id="1504745">(</span><span class="string" id="1504746">&#34;+&#34;</span><span class="op" id="1504749">,</span>&nbsp;<span class="builtintype" id="1504751">false</span><span class="op" id="1504756">)</span>&nbsp;<span class="op" id="1504758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504763">s</span><span class="op" id="1504764">.</span><span class="ident" id="1504765">errorString</span><span class="op" id="1504776">(</span><span class="string" id="1504777">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="1504798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1504802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1504805">}</span>&nbsp;<span class="keyword" id="1504807">else</span>&nbsp;<span class="op" id="1504812">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504816">s</span><span class="op" id="1504817">.</span><span class="ident" id="1504818">accept</span><span class="op" id="1504824">(</span><span class="ident" id="1504825">sign</span><span class="op" id="1504829">)</span>&nbsp;<span class="comment" id="1504831">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1504892">if</span>&nbsp;<span class="ident" id="1504895">verb</span>&nbsp;<span class="op" id="1504900">==</span>&nbsp;<span class="string" id="1504903">&#39;v&#39;</span>&nbsp;<span class="op" id="1504907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504912">base</span><span class="op" id="1504916">,</span>&nbsp;<span class="ident" id="1504918">digits</span><span class="op" id="1504924">,</span>&nbsp;<span class="ident" id="1504926">haveDigits</span>&nbsp;<span class="op" id="1504937">=</span>&nbsp;<span class="ident" id="1504939">s</span><span class="op" id="1504940">.</span><span class="ident" id="1504941">scanBasePrefix</span><span class="op" id="1504955">(</span><span class="op" id="1504956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1504960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1504963">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1504966">tok</span>&nbsp;<span class="op" id="1504970">:=</span>&nbsp;<span class="ident" id="1504973">s</span><span class="op" id="1504974">.</span><span class="ident" id="1504975">scanNumber</span><span class="op" id="1504985">(</span><span class="ident" id="1504986">digits</span><span class="op" id="1504992">,</span>&nbsp;<span class="ident" id="1504994">haveDigits</span><span class="op" id="1505004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505007">i</span><span class="op" id="1505008">,</span>&nbsp;<span class="ident" id="1505010">err</span>&nbsp;<span class="op" id="1505014">:=</span>&nbsp;<span class="ident" id="1505017">strconv</span><span class="op" id="1505024">.</span><span class="ident" id="1505025">ParseInt</span><span class="op" id="1505033">(</span><span class="ident" id="1505034">tok</span><span class="op" id="1505037">,</span>&nbsp;<span class="ident" id="1505039">base</span><span class="op" id="1505043">,</span>&nbsp;<span class="num" id="1505045">64</span><span class="op" id="1505047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505050">if</span>&nbsp;<span class="ident" id="1505053">err</span>&nbsp;<span class="op" id="1505057">!=</span>&nbsp;<span class="ident" id="1505060">nil</span>&nbsp;<span class="op" id="1505064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505068">s</span><span class="op" id="1505069">.</span><span class="builtintype" id="1505070">error</span><span class="op" id="1505075">(</span><span class="ident" id="1505076">err</span><span class="op" id="1505079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1505082">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505085">n</span>&nbsp;<span class="op" id="1505087">:=</span>&nbsp;<span class="builtintype" id="1505090">uint</span><span class="op" id="1505094">(</span><span class="ident" id="1505095">bitSize</span><span class="op" id="1505102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505105">x</span>&nbsp;<span class="op" id="1505107">:=</span>&nbsp;<span class="op" id="1505110">(</span><span class="ident" id="1505111">i</span>&nbsp;<span class="op" id="1505113">&lt;&lt;</span>&nbsp;<span class="op" id="1505116">(</span><span class="num" id="1505117">64</span>&nbsp;<span class="op" id="1505120">-</span>&nbsp;<span class="ident" id="1505122">n</span><span class="op" id="1505123">)</span><span class="op" id="1505124">)</span>&nbsp;<span class="op" id="1505126">&gt;&gt;</span>&nbsp;<span class="op" id="1505129">(</span><span class="num" id="1505130">64</span>&nbsp;<span class="op" id="1505133">-</span>&nbsp;<span class="ident" id="1505135">n</span><span class="op" id="1505136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505139">if</span>&nbsp;<span class="ident" id="1505142">x</span>&nbsp;<span class="op" id="1505144">!=</span>&nbsp;<span class="ident" id="1505147">i</span>&nbsp;<span class="op" id="1505149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505153">s</span><span class="op" id="1505154">.</span><span class="ident" id="1505155">errorString</span><span class="op" id="1505166">(</span><span class="string" id="1505167">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="1505196">+</span>&nbsp;<span class="ident" id="1505198">tok</span><span class="op" id="1505201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1505204">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505207">return</span>&nbsp;<span class="ident" id="1505214">i</span><br>
<span class="lineno"></span><span class="op" id="1505216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1505219">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="1505285">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="1505361">func</span>&nbsp;<span class="op" id="1505366">(</span><span class="ident" id="1505367">s</span>&nbsp;<span class="op" id="1505369">*</span><span class="ident" id="1505370">ss</span><span class="op" id="1505372">)</span>&nbsp;<span class="ident" id="1505374">scanUint</span><span class="op" id="1505382">(</span><span class="ident" id="1505383">verb</span>&nbsp;<span class="builtintype" id="1505388">rune</span><span class="op" id="1505392">,</span>&nbsp;<span class="ident" id="1505394">bitSize</span>&nbsp;<span class="builtintype" id="1505402">int</span><span class="op" id="1505405">)</span>&nbsp;<span class="ident" id="1505407">uint64</span>&nbsp;<span class="op" id="1505414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505417">if</span>&nbsp;<span class="ident" id="1505420">verb</span>&nbsp;<span class="op" id="1505425">==</span>&nbsp;<span class="string" id="1505428">&#39;c&#39;</span>&nbsp;<span class="op" id="1505432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505436">return</span>&nbsp;<span class="ident" id="1505443">uint64</span><span class="op" id="1505449">(</span><span class="ident" id="1505450">s</span><span class="op" id="1505451">.</span><span class="ident" id="1505452">scanRune</span><span class="op" id="1505460">(</span><span class="ident" id="1505461">bitSize</span><span class="op" id="1505468">)</span><span class="op" id="1505469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1505472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505475">s</span><span class="op" id="1505476">.</span><span class="ident" id="1505477">skipSpace</span><span class="op" id="1505486">(</span><span class="builtintype" id="1505487">false</span><span class="op" id="1505492">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505495">s</span><span class="op" id="1505496">.</span><span class="ident" id="1505497">notEOF</span><span class="op" id="1505503">(</span><span class="op" id="1505504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505507">base</span><span class="op" id="1505511">,</span>&nbsp;<span class="ident" id="1505513">digits</span>&nbsp;<span class="op" id="1505520">:=</span>&nbsp;<span class="ident" id="1505523">s</span><span class="op" id="1505524">.</span><span class="ident" id="1505525">getBase</span><span class="op" id="1505532">(</span><span class="ident" id="1505533">verb</span><span class="op" id="1505537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505540">haveDigits</span>&nbsp;<span class="op" id="1505551">:=</span>&nbsp;<span class="builtintype" id="1505554">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505561">if</span>&nbsp;<span class="ident" id="1505564">verb</span>&nbsp;<span class="op" id="1505569">==</span>&nbsp;<span class="string" id="1505572">&#39;U&#39;</span>&nbsp;<span class="op" id="1505576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505580">if</span>&nbsp;<span class="op" id="1505583">!</span><span class="ident" id="1505584">s</span><span class="op" id="1505585">.</span><span class="ident" id="1505586">consume</span><span class="op" id="1505593">(</span><span class="string" id="1505594">&#34;U&#34;</span><span class="op" id="1505597">,</span>&nbsp;<span class="builtintype" id="1505599">false</span><span class="op" id="1505604">)</span>&nbsp;<span class="op" id="1505606">||</span>&nbsp;<span class="op" id="1505609">!</span><span class="ident" id="1505610">s</span><span class="op" id="1505611">.</span><span class="ident" id="1505612">consume</span><span class="op" id="1505619">(</span><span class="string" id="1505620">&#34;+&#34;</span><span class="op" id="1505623">,</span>&nbsp;<span class="builtintype" id="1505625">false</span><span class="op" id="1505630">)</span>&nbsp;<span class="op" id="1505632">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505637">s</span><span class="op" id="1505638">.</span><span class="ident" id="1505639">errorString</span><span class="op" id="1505650">(</span><span class="string" id="1505651">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="1505672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1505676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1505679">}</span>&nbsp;<span class="keyword" id="1505681">else</span>&nbsp;<span class="keyword" id="1505686">if</span>&nbsp;<span class="ident" id="1505689">verb</span>&nbsp;<span class="op" id="1505694">==</span>&nbsp;<span class="string" id="1505697">&#39;v&#39;</span>&nbsp;<span class="op" id="1505701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505705">base</span><span class="op" id="1505709">,</span>&nbsp;<span class="ident" id="1505711">digits</span><span class="op" id="1505717">,</span>&nbsp;<span class="ident" id="1505719">haveDigits</span>&nbsp;<span class="op" id="1505730">=</span>&nbsp;<span class="ident" id="1505732">s</span><span class="op" id="1505733">.</span><span class="ident" id="1505734">scanBasePrefix</span><span class="op" id="1505748">(</span><span class="op" id="1505749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1505752">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505755">tok</span>&nbsp;<span class="op" id="1505759">:=</span>&nbsp;<span class="ident" id="1505762">s</span><span class="op" id="1505763">.</span><span class="ident" id="1505764">scanNumber</span><span class="op" id="1505774">(</span><span class="ident" id="1505775">digits</span><span class="op" id="1505781">,</span>&nbsp;<span class="ident" id="1505783">haveDigits</span><span class="op" id="1505793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505796">i</span><span class="op" id="1505797">,</span>&nbsp;<span class="ident" id="1505799">err</span>&nbsp;<span class="op" id="1505803">:=</span>&nbsp;<span class="ident" id="1505806">strconv</span><span class="op" id="1505813">.</span><span class="ident" id="1505814">ParseUint</span><span class="op" id="1505823">(</span><span class="ident" id="1505824">tok</span><span class="op" id="1505827">,</span>&nbsp;<span class="ident" id="1505829">base</span><span class="op" id="1505833">,</span>&nbsp;<span class="num" id="1505835">64</span><span class="op" id="1505837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505840">if</span>&nbsp;<span class="ident" id="1505843">err</span>&nbsp;<span class="op" id="1505847">!=</span>&nbsp;<span class="ident" id="1505850">nil</span>&nbsp;<span class="op" id="1505854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505858">s</span><span class="op" id="1505859">.</span><span class="builtintype" id="1505860">error</span><span class="op" id="1505865">(</span><span class="ident" id="1505866">err</span><span class="op" id="1505869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1505872">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505875">n</span>&nbsp;<span class="op" id="1505877">:=</span>&nbsp;<span class="builtintype" id="1505880">uint</span><span class="op" id="1505884">(</span><span class="ident" id="1505885">bitSize</span><span class="op" id="1505892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505895">x</span>&nbsp;<span class="op" id="1505897">:=</span>&nbsp;<span class="op" id="1505900">(</span><span class="ident" id="1505901">i</span>&nbsp;<span class="op" id="1505903">&lt;&lt;</span>&nbsp;<span class="op" id="1505906">(</span><span class="num" id="1505907">64</span>&nbsp;<span class="op" id="1505910">-</span>&nbsp;<span class="ident" id="1505912">n</span><span class="op" id="1505913">)</span><span class="op" id="1505914">)</span>&nbsp;<span class="op" id="1505916">&gt;&gt;</span>&nbsp;<span class="op" id="1505919">(</span><span class="num" id="1505920">64</span>&nbsp;<span class="op" id="1505923">-</span>&nbsp;<span class="ident" id="1505925">n</span><span class="op" id="1505926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1505929">if</span>&nbsp;<span class="ident" id="1505932">x</span>&nbsp;<span class="op" id="1505934">!=</span>&nbsp;<span class="ident" id="1505937">i</span>&nbsp;<span class="op" id="1505939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1505943">s</span><span class="op" id="1505944">.</span><span class="ident" id="1505945">errorString</span><span class="op" id="1505956">(</span><span class="string" id="1505957">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="1505995">+</span>&nbsp;<span class="ident" id="1505997">tok</span><span class="op" id="1506000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506003">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506006">return</span>&nbsp;<span class="ident" id="1506013">i</span><br>
<span class="lineno"></span><span class="op" id="1506015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1506018">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="1506101">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="1506192">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="1506248">func</span>&nbsp;<span class="op" id="1506253">(</span><span class="ident" id="1506254">s</span>&nbsp;<span class="op" id="1506256">*</span><span class="ident" id="1506257">ss</span><span class="op" id="1506259">)</span>&nbsp;<span class="ident" id="1506261">floatToken</span><span class="op" id="1506271">(</span><span class="op" id="1506272">)</span>&nbsp;<span class="builtintype" id="1506274">string</span>&nbsp;<span class="op" id="1506281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1506284">s</span><span class="op" id="1506285">.</span><span class="ident" id="1506286">buf</span>&nbsp;<span class="op" id="1506290">=</span>&nbsp;<span class="ident" id="1506292">s</span><span class="op" id="1506293">.</span><span class="ident" id="1506294">buf</span><span class="op" id="1506297">[</span><span class="op" id="1506298">:</span><span class="num" id="1506299">0</span><span class="op" id="1506300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506303">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506312">if</span>&nbsp;<span class="ident" id="1506315">s</span><span class="op" id="1506316">.</span><span class="ident" id="1506317">accept</span><span class="op" id="1506323">(</span><span class="string" id="1506324">&#34;nN&#34;</span><span class="op" id="1506328">)</span>&nbsp;<span class="op" id="1506330">&amp;&amp;</span>&nbsp;<span class="ident" id="1506333">s</span><span class="op" id="1506334">.</span><span class="ident" id="1506335">accept</span><span class="op" id="1506341">(</span><span class="string" id="1506342">&#34;aA&#34;</span><span class="op" id="1506346">)</span>&nbsp;<span class="op" id="1506348">&amp;&amp;</span>&nbsp;<span class="ident" id="1506351">s</span><span class="op" id="1506352">.</span><span class="ident" id="1506353">accept</span><span class="op" id="1506359">(</span><span class="string" id="1506360">&#34;nN&#34;</span><span class="op" id="1506364">)</span>&nbsp;<span class="op" id="1506366">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506370">return</span>&nbsp;<span class="builtintype" id="1506377">string</span><span class="op" id="1506383">(</span><span class="ident" id="1506384">s</span><span class="op" id="1506385">.</span><span class="ident" id="1506386">buf</span><span class="op" id="1506389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506395">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1506413">s</span><span class="op" id="1506414">.</span><span class="ident" id="1506415">accept</span><span class="op" id="1506421">(</span><span class="ident" id="1506422">sign</span><span class="op" id="1506426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506429">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506438">if</span>&nbsp;<span class="ident" id="1506441">s</span><span class="op" id="1506442">.</span><span class="ident" id="1506443">accept</span><span class="op" id="1506449">(</span><span class="string" id="1506450">&#34;iI&#34;</span><span class="op" id="1506454">)</span>&nbsp;<span class="op" id="1506456">&amp;&amp;</span>&nbsp;<span class="ident" id="1506459">s</span><span class="op" id="1506460">.</span><span class="ident" id="1506461">accept</span><span class="op" id="1506467">(</span><span class="string" id="1506468">&#34;nN&#34;</span><span class="op" id="1506472">)</span>&nbsp;<span class="op" id="1506474">&amp;&amp;</span>&nbsp;<span class="ident" id="1506477">s</span><span class="op" id="1506478">.</span><span class="ident" id="1506479">accept</span><span class="op" id="1506485">(</span><span class="string" id="1506486">&#34;fF&#34;</span><span class="op" id="1506490">)</span>&nbsp;<span class="op" id="1506492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506496">return</span>&nbsp;<span class="builtintype" id="1506503">string</span><span class="op" id="1506509">(</span><span class="ident" id="1506510">s</span><span class="op" id="1506511">.</span><span class="ident" id="1506512">buf</span><span class="op" id="1506515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506521">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506533">for</span>&nbsp;<span class="ident" id="1506537">s</span><span class="op" id="1506538">.</span><span class="ident" id="1506539">accept</span><span class="op" id="1506545">(</span><span class="ident" id="1506546">decimalDigits</span><span class="op" id="1506559">)</span>&nbsp;<span class="op" id="1506561">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506567">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506586">if</span>&nbsp;<span class="ident" id="1506589">s</span><span class="op" id="1506590">.</span><span class="ident" id="1506591">accept</span><span class="op" id="1506597">(</span><span class="ident" id="1506598">period</span><span class="op" id="1506604">)</span>&nbsp;<span class="op" id="1506606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506610">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506625">for</span>&nbsp;<span class="ident" id="1506629">s</span><span class="op" id="1506630">.</span><span class="ident" id="1506631">accept</span><span class="op" id="1506637">(</span><span class="ident" id="1506638">decimalDigits</span><span class="op" id="1506651">)</span>&nbsp;<span class="op" id="1506653">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506663">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506677">if</span>&nbsp;<span class="ident" id="1506680">s</span><span class="op" id="1506681">.</span><span class="ident" id="1506682">accept</span><span class="op" id="1506688">(</span><span class="ident" id="1506689">exponent</span><span class="op" id="1506697">)</span>&nbsp;<span class="op" id="1506699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506703">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1506722">s</span><span class="op" id="1506723">.</span><span class="ident" id="1506724">accept</span><span class="op" id="1506730">(</span><span class="ident" id="1506731">sign</span><span class="op" id="1506735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1506739">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506752">for</span>&nbsp;<span class="ident" id="1506756">s</span><span class="op" id="1506757">.</span><span class="ident" id="1506758">accept</span><span class="op" id="1506764">(</span><span class="ident" id="1506765">decimalDigits</span><span class="op" id="1506778">)</span>&nbsp;<span class="op" id="1506780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1506787">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1506790">return</span>&nbsp;<span class="builtintype" id="1506797">string</span><span class="op" id="1506803">(</span><span class="ident" id="1506804">s</span><span class="op" id="1506805">.</span><span class="ident" id="1506806">buf</span><span class="op" id="1506809">)</span><br>
<span class="lineno"></span><span class="op" id="1506811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1506814">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="1506905">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="1506996">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="1507038">func</span>&nbsp;<span class="op" id="1507043">(</span><span class="ident" id="1507044">s</span>&nbsp;<span class="op" id="1507046">*</span><span class="ident" id="1507047">ss</span><span class="op" id="1507049">)</span>&nbsp;<span class="ident" id="1507051">complexTokens</span><span class="op" id="1507064">(</span><span class="op" id="1507065">)</span>&nbsp;<span class="op" id="1507067">(</span><span class="builtinfunc" id="1507068">real</span><span class="op" id="1507072">,</span>&nbsp;<span class="builtinfunc" id="1507074">imag</span>&nbsp;<span class="builtintype" id="1507079">string</span><span class="op" id="1507085">)</span>&nbsp;<span class="op" id="1507087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1507090">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507131">parens</span>&nbsp;<span class="op" id="1507138">:=</span>&nbsp;<span class="ident" id="1507141">s</span><span class="op" id="1507142">.</span><span class="ident" id="1507143">accept</span><span class="op" id="1507149">(</span><span class="string" id="1507150">&#34;(&#34;</span><span class="op" id="1507153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1507156">real</span>&nbsp;<span class="op" id="1507161">=</span>&nbsp;<span class="ident" id="1507163">s</span><span class="op" id="1507164">.</span><span class="ident" id="1507165">floatToken</span><span class="op" id="1507175">(</span><span class="op" id="1507176">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507179">s</span><span class="op" id="1507180">.</span><span class="ident" id="1507181">buf</span>&nbsp;<span class="op" id="1507185">=</span>&nbsp;<span class="ident" id="1507187">s</span><span class="op" id="1507188">.</span><span class="ident" id="1507189">buf</span><span class="op" id="1507192">[</span><span class="op" id="1507193">:</span><span class="num" id="1507194">0</span><span class="op" id="1507195">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1507198">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507224">if</span>&nbsp;<span class="op" id="1507227">!</span><span class="ident" id="1507228">s</span><span class="op" id="1507229">.</span><span class="ident" id="1507230">accept</span><span class="op" id="1507236">(</span><span class="string" id="1507237">&#34;+-&#34;</span><span class="op" id="1507241">)</span>&nbsp;<span class="op" id="1507243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507247">s</span><span class="op" id="1507248">.</span><span class="builtintype" id="1507249">error</span><span class="op" id="1507254">(</span><span class="ident" id="1507255">complexError</span><span class="op" id="1507267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507270">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1507273">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507299">imagSign</span>&nbsp;<span class="op" id="1507308">:=</span>&nbsp;<span class="builtintype" id="1507311">string</span><span class="op" id="1507317">(</span><span class="ident" id="1507318">s</span><span class="op" id="1507319">.</span><span class="ident" id="1507320">buf</span><span class="op" id="1507323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1507326">imag</span>&nbsp;<span class="op" id="1507331">=</span>&nbsp;<span class="ident" id="1507333">s</span><span class="op" id="1507334">.</span><span class="ident" id="1507335">floatToken</span><span class="op" id="1507345">(</span><span class="op" id="1507346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507349">if</span>&nbsp;<span class="op" id="1507352">!</span><span class="ident" id="1507353">s</span><span class="op" id="1507354">.</span><span class="ident" id="1507355">accept</span><span class="op" id="1507361">(</span><span class="string" id="1507362">&#34;i&#34;</span><span class="op" id="1507365">)</span>&nbsp;<span class="op" id="1507367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507371">s</span><span class="op" id="1507372">.</span><span class="builtintype" id="1507373">error</span><span class="op" id="1507378">(</span><span class="ident" id="1507379">complexError</span><span class="op" id="1507391">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507397">if</span>&nbsp;<span class="ident" id="1507400">parens</span>&nbsp;<span class="op" id="1507407">&amp;&amp;</span>&nbsp;<span class="op" id="1507410">!</span><span class="ident" id="1507411">s</span><span class="op" id="1507412">.</span><span class="ident" id="1507413">accept</span><span class="op" id="1507419">(</span><span class="string" id="1507420">&#34;)&#34;</span><span class="op" id="1507423">)</span>&nbsp;<span class="op" id="1507425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507429">s</span><span class="op" id="1507430">.</span><span class="builtintype" id="1507431">error</span><span class="op" id="1507436">(</span><span class="ident" id="1507437">complexError</span><span class="op" id="1507449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507455">return</span>&nbsp;<span class="builtinfunc" id="1507462">real</span><span class="op" id="1507466">,</span>&nbsp;<span class="ident" id="1507468">imagSign</span>&nbsp;<span class="op" id="1507477">+</span>&nbsp;<span class="builtinfunc" id="1507479">imag</span><br>
<span class="lineno">770</span><span class="op" id="1507484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1507487">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="1507542">func</span>&nbsp;<span class="op" id="1507547">(</span><span class="ident" id="1507548">s</span>&nbsp;<span class="op" id="1507550">*</span><span class="ident" id="1507551">ss</span><span class="op" id="1507553">)</span>&nbsp;<span class="ident" id="1507555">convertFloat</span><span class="op" id="1507567">(</span><span class="ident" id="1507568">str</span>&nbsp;<span class="builtintype" id="1507572">string</span><span class="op" id="1507578">,</span>&nbsp;<span class="ident" id="1507580">n</span>&nbsp;<span class="builtintype" id="1507582">int</span><span class="op" id="1507585">)</span>&nbsp;<span class="builtintype" id="1507587">float64</span>&nbsp;<span class="op" id="1507595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507598">if</span>&nbsp;<span class="ident" id="1507601">p</span>&nbsp;<span class="op" id="1507603">:=</span>&nbsp;<span class="ident" id="1507606">indexRune</span><span class="op" id="1507615">(</span><span class="ident" id="1507616">str</span><span class="op" id="1507619">,</span>&nbsp;<span class="string" id="1507621">&#39;p&#39;</span><span class="op" id="1507624">)</span><span class="op" id="1507625">;</span>&nbsp;<span class="ident" id="1507627">p</span>&nbsp;<span class="op" id="1507629">&gt;=</span>&nbsp;<span class="num" id="1507632">0</span>&nbsp;<span class="op" id="1507634">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1507638">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1507685">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507720">f</span><span class="op" id="1507721">,</span>&nbsp;<span class="ident" id="1507723">err</span>&nbsp;<span class="op" id="1507727">:=</span>&nbsp;<span class="ident" id="1507730">strconv</span><span class="op" id="1507737">.</span><span class="ident" id="1507738">ParseFloat</span><span class="op" id="1507748">(</span><span class="ident" id="1507749">str</span><span class="op" id="1507752">[</span><span class="op" id="1507753">:</span><span class="ident" id="1507754">p</span><span class="op" id="1507755">]</span><span class="op" id="1507756">,</span>&nbsp;<span class="ident" id="1507758">n</span><span class="op" id="1507759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507763">if</span>&nbsp;<span class="ident" id="1507766">err</span>&nbsp;<span class="op" id="1507770">!=</span>&nbsp;<span class="ident" id="1507773">nil</span>&nbsp;<span class="op" id="1507777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1507782">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507816">if</span>&nbsp;<span class="ident" id="1507819">e</span><span class="op" id="1507820">,</span>&nbsp;<span class="ident" id="1507822">ok</span>&nbsp;<span class="op" id="1507825">:=</span>&nbsp;<span class="ident" id="1507828">err</span><span class="op" id="1507831">.</span><span class="op" id="1507832">(</span><span class="op" id="1507833">*</span><span class="ident" id="1507834">strconv</span><span class="op" id="1507841">.</span><span class="ident" id="1507842">NumError</span><span class="op" id="1507850">)</span><span class="op" id="1507851">;</span>&nbsp;<span class="ident" id="1507853">ok</span>&nbsp;<span class="op" id="1507856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507862">e</span><span class="op" id="1507863">.</span><span class="ident" id="1507864">Num</span>&nbsp;<span class="op" id="1507868">=</span>&nbsp;<span class="ident" id="1507870">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507882">s</span><span class="op" id="1507883">.</span><span class="builtintype" id="1507884">error</span><span class="op" id="1507889">(</span><span class="ident" id="1507890">err</span><span class="op" id="1507893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507897">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1507901">m</span><span class="op" id="1507902">,</span>&nbsp;<span class="ident" id="1507904">err</span>&nbsp;<span class="op" id="1507908">:=</span>&nbsp;<span class="ident" id="1507911">strconv</span><span class="op" id="1507918">.</span><span class="ident" id="1507919">Atoi</span><span class="op" id="1507923">(</span><span class="ident" id="1507924">str</span><span class="op" id="1507927">[</span><span class="ident" id="1507928">p</span><span class="op" id="1507929">+</span><span class="num" id="1507930">1</span><span class="op" id="1507931">:</span><span class="op" id="1507932">]</span><span class="op" id="1507933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507937">if</span>&nbsp;<span class="ident" id="1507940">err</span>&nbsp;<span class="op" id="1507944">!=</span>&nbsp;<span class="ident" id="1507947">nil</span>&nbsp;<span class="op" id="1507951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1507956">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1507990">if</span>&nbsp;<span class="ident" id="1507993">e</span><span class="op" id="1507994">,</span>&nbsp;<span class="ident" id="1507996">ok</span>&nbsp;<span class="op" id="1507999">:=</span>&nbsp;<span class="ident" id="1508002">err</span><span class="op" id="1508005">.</span><span class="op" id="1508006">(</span><span class="op" id="1508007">*</span><span class="ident" id="1508008">strconv</span><span class="op" id="1508015">.</span><span class="ident" id="1508016">NumError</span><span class="op" id="1508024">)</span><span class="op" id="1508025">;</span>&nbsp;<span class="ident" id="1508027">ok</span>&nbsp;<span class="op" id="1508030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508036">e</span><span class="op" id="1508037">.</span><span class="ident" id="1508038">Num</span>&nbsp;<span class="op" id="1508042">=</span>&nbsp;<span class="ident" id="1508044">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508056">s</span><span class="op" id="1508057">.</span><span class="builtintype" id="1508058">error</span><span class="op" id="1508063">(</span><span class="ident" id="1508064">err</span><span class="op" id="1508067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508075">return</span>&nbsp;<span class="ident" id="1508082">math</span><span class="op" id="1508086">.</span><span class="ident" id="1508087">Ldexp</span><span class="op" id="1508092">(</span><span class="ident" id="1508093">f</span><span class="op" id="1508094">,</span>&nbsp;<span class="ident" id="1508096">m</span><span class="op" id="1508097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508100">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508103">f</span><span class="op" id="1508104">,</span>&nbsp;<span class="ident" id="1508106">err</span>&nbsp;<span class="op" id="1508110">:=</span>&nbsp;<span class="ident" id="1508113">strconv</span><span class="op" id="1508120">.</span><span class="ident" id="1508121">ParseFloat</span><span class="op" id="1508131">(</span><span class="ident" id="1508132">str</span><span class="op" id="1508135">,</span>&nbsp;<span class="ident" id="1508137">n</span><span class="op" id="1508138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508141">if</span>&nbsp;<span class="ident" id="1508144">err</span>&nbsp;<span class="op" id="1508148">!=</span>&nbsp;<span class="ident" id="1508151">nil</span>&nbsp;<span class="op" id="1508155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508159">s</span><span class="op" id="1508160">.</span><span class="builtintype" id="1508161">error</span><span class="op" id="1508166">(</span><span class="ident" id="1508167">err</span><span class="op" id="1508170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508176">return</span>&nbsp;<span class="ident" id="1508183">f</span><br>
<span class="lineno">800</span><span class="op" id="1508185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1508188">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="1508253">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="1508325">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="1508398">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="1508468">func</span>&nbsp;<span class="op" id="1508473">(</span><span class="ident" id="1508474">s</span>&nbsp;<span class="op" id="1508476">*</span><span class="ident" id="1508477">ss</span><span class="op" id="1508479">)</span>&nbsp;<span class="ident" id="1508481">scanComplex</span><span class="op" id="1508492">(</span><span class="ident" id="1508493">verb</span>&nbsp;<span class="builtintype" id="1508498">rune</span><span class="op" id="1508502">,</span>&nbsp;<span class="ident" id="1508504">n</span>&nbsp;<span class="builtintype" id="1508506">int</span><span class="op" id="1508509">)</span>&nbsp;<span class="builtintype" id="1508511">complex128</span>&nbsp;<span class="op" id="1508522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508525">if</span>&nbsp;<span class="op" id="1508528">!</span><span class="ident" id="1508529">s</span><span class="op" id="1508530">.</span><span class="ident" id="1508531">okVerb</span><span class="op" id="1508537">(</span><span class="ident" id="1508538">verb</span><span class="op" id="1508542">,</span>&nbsp;<span class="ident" id="1508544">floatVerbs</span><span class="op" id="1508554">,</span>&nbsp;<span class="string" id="1508556">&#34;complex&#34;</span><span class="op" id="1508565">)</span>&nbsp;<span class="op" id="1508567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508571">return</span>&nbsp;<span class="num" id="1508578">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508581">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508584">s</span><span class="op" id="1508585">.</span><span class="ident" id="1508586">skipSpace</span><span class="op" id="1508595">(</span><span class="builtintype" id="1508596">false</span><span class="op" id="1508601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508604">s</span><span class="op" id="1508605">.</span><span class="ident" id="1508606">notEOF</span><span class="op" id="1508612">(</span><span class="op" id="1508613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508616">sreal</span><span class="op" id="1508621">,</span>&nbsp;<span class="ident" id="1508623">simag</span>&nbsp;<span class="op" id="1508629">:=</span>&nbsp;<span class="ident" id="1508632">s</span><span class="op" id="1508633">.</span><span class="ident" id="1508634">complexTokens</span><span class="op" id="1508647">(</span><span class="op" id="1508648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1508651">real</span>&nbsp;<span class="op" id="1508656">:=</span>&nbsp;<span class="ident" id="1508659">s</span><span class="op" id="1508660">.</span><span class="ident" id="1508661">convertFloat</span><span class="op" id="1508673">(</span><span class="ident" id="1508674">sreal</span><span class="op" id="1508679">,</span>&nbsp;<span class="ident" id="1508681">n</span><span class="op" id="1508682">/</span><span class="num" id="1508683">2</span><span class="op" id="1508684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1508687">imag</span>&nbsp;<span class="op" id="1508692">:=</span>&nbsp;<span class="ident" id="1508695">s</span><span class="op" id="1508696">.</span><span class="ident" id="1508697">convertFloat</span><span class="op" id="1508709">(</span><span class="ident" id="1508710">simag</span><span class="op" id="1508715">,</span>&nbsp;<span class="ident" id="1508717">n</span><span class="op" id="1508718">/</span><span class="num" id="1508719">2</span><span class="op" id="1508720">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508723">return</span>&nbsp;<span class="builtinfunc" id="1508730">complex</span><span class="op" id="1508737">(</span><span class="builtinfunc" id="1508738">real</span><span class="op" id="1508742">,</span>&nbsp;<span class="builtinfunc" id="1508744">imag</span><span class="op" id="1508748">)</span><br>
<span class="lineno"></span><span class="op" id="1508750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1508753">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="1508831">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="1508885">func</span>&nbsp;<span class="op" id="1508890">(</span><span class="ident" id="1508891">s</span>&nbsp;<span class="op" id="1508893">*</span><span class="ident" id="1508894">ss</span><span class="op" id="1508896">)</span>&nbsp;<span class="ident" id="1508898">convertString</span><span class="op" id="1508911">(</span><span class="ident" id="1508912">verb</span>&nbsp;<span class="builtintype" id="1508917">rune</span><span class="op" id="1508921">)</span>&nbsp;<span class="op" id="1508923">(</span><span class="ident" id="1508924">str</span>&nbsp;<span class="builtintype" id="1508928">string</span><span class="op" id="1508934">)</span>&nbsp;<span class="op" id="1508936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508939">if</span>&nbsp;<span class="op" id="1508942">!</span><span class="ident" id="1508943">s</span><span class="op" id="1508944">.</span><span class="ident" id="1508945">okVerb</span><span class="op" id="1508951">(</span><span class="ident" id="1508952">verb</span><span class="op" id="1508956">,</span>&nbsp;<span class="string" id="1508958">&#34;svqx&#34;</span><span class="op" id="1508964">,</span>&nbsp;<span class="string" id="1508966">&#34;string&#34;</span><span class="op" id="1508974">)</span>&nbsp;<span class="op" id="1508976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1508980">return</span>&nbsp;<span class="string" id="1508987">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1508994">s</span><span class="op" id="1508995">.</span><span class="ident" id="1508996">skipSpace</span><span class="op" id="1509005">(</span><span class="builtintype" id="1509006">false</span><span class="op" id="1509011">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509014">s</span><span class="op" id="1509015">.</span><span class="ident" id="1509016">notEOF</span><span class="op" id="1509022">(</span><span class="op" id="1509023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509026">switch</span>&nbsp;<span class="ident" id="1509033">verb</span>&nbsp;<span class="op" id="1509038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509041">case</span>&nbsp;<span class="string" id="1509046">&#39;q&#39;</span><span class="op" id="1509049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509053">str</span>&nbsp;<span class="op" id="1509057">=</span>&nbsp;<span class="ident" id="1509059">s</span><span class="op" id="1509060">.</span><span class="ident" id="1509061">quotedString</span><span class="op" id="1509073">(</span><span class="op" id="1509074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509077">case</span>&nbsp;<span class="string" id="1509082">&#39;x&#39;</span><span class="op" id="1509085">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509089">str</span>&nbsp;<span class="op" id="1509093">=</span>&nbsp;<span class="ident" id="1509095">s</span><span class="op" id="1509096">.</span><span class="ident" id="1509097">hexString</span><span class="op" id="1509106">(</span><span class="op" id="1509107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509110">default</span><span class="op" id="1509117">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509121">str</span>&nbsp;<span class="op" id="1509125">=</span>&nbsp;<span class="builtintype" id="1509127">string</span><span class="op" id="1509133">(</span><span class="ident" id="1509134">s</span><span class="op" id="1509135">.</span><span class="ident" id="1509136">token</span><span class="op" id="1509141">(</span><span class="builtintype" id="1509142">true</span><span class="op" id="1509146">,</span>&nbsp;<span class="ident" id="1509148">notSpace</span><span class="op" id="1509156">)</span><span class="op" id="1509157">)</span>&nbsp;<span class="comment" id="1509159">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1509199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509202">return</span><br>
<span class="lineno">835</span><span class="op" id="1509209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1509212">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="1509312">func</span>&nbsp;<span class="op" id="1509317">(</span><span class="ident" id="1509318">s</span>&nbsp;<span class="op" id="1509320">*</span><span class="ident" id="1509321">ss</span><span class="op" id="1509323">)</span>&nbsp;<span class="ident" id="1509325">quotedString</span><span class="op" id="1509337">(</span><span class="op" id="1509338">)</span>&nbsp;<span class="builtintype" id="1509340">string</span>&nbsp;<span class="op" id="1509347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509350">s</span><span class="op" id="1509351">.</span><span class="ident" id="1509352">notEOF</span><span class="op" id="1509358">(</span><span class="op" id="1509359">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509362">quote</span>&nbsp;<span class="op" id="1509368">:=</span>&nbsp;<span class="ident" id="1509371">s</span><span class="op" id="1509372">.</span><span class="ident" id="1509373">getRune</span><span class="op" id="1509380">(</span><span class="op" id="1509381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509384">switch</span>&nbsp;<span class="ident" id="1509391">quote</span>&nbsp;<span class="op" id="1509397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509400">case</span>&nbsp;<span class="string" id="1509405">&#39;`&#39;</span><span class="op" id="1509408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1509412">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509469">for</span>&nbsp;<span class="op" id="1509473">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509478">r</span>&nbsp;<span class="op" id="1509480">:=</span>&nbsp;<span class="ident" id="1509483">s</span><span class="op" id="1509484">.</span><span class="ident" id="1509485">mustReadRune</span><span class="op" id="1509497">(</span><span class="op" id="1509498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509503">if</span>&nbsp;<span class="ident" id="1509506">r</span>&nbsp;<span class="op" id="1509508">==</span>&nbsp;<span class="ident" id="1509511">quote</span>&nbsp;<span class="op" id="1509517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509523">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1509532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509537">s</span><span class="op" id="1509538">.</span><span class="ident" id="1509539">buf</span><span class="op" id="1509542">.</span><span class="ident" id="1509543">WriteRune</span><span class="op" id="1509552">(</span><span class="ident" id="1509553">r</span><span class="op" id="1509554">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1509558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509562">return</span>&nbsp;<span class="builtintype" id="1509569">string</span><span class="op" id="1509575">(</span><span class="ident" id="1509576">s</span><span class="op" id="1509577">.</span><span class="ident" id="1509578">buf</span><span class="op" id="1509581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509584">case</span>&nbsp;<span class="string" id="1509589">&#39;&#34;&#39;</span><span class="op" id="1509592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1509596">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509685">s</span><span class="op" id="1509686">.</span><span class="ident" id="1509687">buf</span><span class="op" id="1509690">.</span><span class="ident" id="1509691">WriteRune</span><span class="op" id="1509700">(</span><span class="ident" id="1509701">quote</span><span class="op" id="1509706">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509710">for</span>&nbsp;<span class="op" id="1509714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509719">r</span>&nbsp;<span class="op" id="1509721">:=</span>&nbsp;<span class="ident" id="1509724">s</span><span class="op" id="1509725">.</span><span class="ident" id="1509726">mustReadRune</span><span class="op" id="1509738">(</span><span class="op" id="1509739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509744">s</span><span class="op" id="1509745">.</span><span class="ident" id="1509746">buf</span><span class="op" id="1509749">.</span><span class="ident" id="1509750">WriteRune</span><span class="op" id="1509759">(</span><span class="ident" id="1509760">r</span><span class="op" id="1509761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509766">if</span>&nbsp;<span class="ident" id="1509769">r</span>&nbsp;<span class="op" id="1509771">==</span>&nbsp;<span class="string" id="1509774">&#39;\\&#39;</span>&nbsp;<span class="op" id="1509779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1509785">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1509860">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1509932">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510009">s</span><span class="op" id="1510010">.</span><span class="ident" id="1510011">buf</span><span class="op" id="1510014">.</span><span class="ident" id="1510015">WriteRune</span><span class="op" id="1510024">(</span><span class="ident" id="1510025">s</span><span class="op" id="1510026">.</span><span class="ident" id="1510027">mustReadRune</span><span class="op" id="1510039">(</span><span class="op" id="1510040">)</span><span class="op" id="1510041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510046">}</span>&nbsp;<span class="keyword" id="1510048">else</span>&nbsp;<span class="keyword" id="1510053">if</span>&nbsp;<span class="ident" id="1510056">r</span>&nbsp;<span class="op" id="1510058">==</span>&nbsp;<span class="string" id="1510061">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1510065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510071">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510088">result</span><span class="op" id="1510094">,</span>&nbsp;<span class="ident" id="1510096">err</span>&nbsp;<span class="op" id="1510100">:=</span>&nbsp;<span class="ident" id="1510103">strconv</span><span class="op" id="1510110">.</span><span class="ident" id="1510111">Unquote</span><span class="op" id="1510118">(</span><span class="builtintype" id="1510119">string</span><span class="op" id="1510125">(</span><span class="ident" id="1510126">s</span><span class="op" id="1510127">.</span><span class="ident" id="1510128">buf</span><span class="op" id="1510131">)</span><span class="op" id="1510132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510136">if</span>&nbsp;<span class="ident" id="1510139">err</span>&nbsp;<span class="op" id="1510143">!=</span>&nbsp;<span class="ident" id="1510146">nil</span>&nbsp;<span class="op" id="1510150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510155">s</span><span class="op" id="1510156">.</span><span class="builtintype" id="1510157">error</span><span class="op" id="1510162">(</span><span class="ident" id="1510163">err</span><span class="op" id="1510166">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510174">return</span>&nbsp;<span class="ident" id="1510181">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510189">default</span><span class="op" id="1510196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510200">s</span><span class="op" id="1510201">.</span><span class="ident" id="1510202">errorString</span><span class="op" id="1510213">(</span><span class="string" id="1510214">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="1510238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510241">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510244">return</span>&nbsp;<span class="string" id="1510251">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="1510254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1510257">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="1510312">func</span>&nbsp;<span class="op" id="1510317">(</span><span class="ident" id="1510318">s</span>&nbsp;<span class="op" id="1510320">*</span><span class="ident" id="1510321">ss</span><span class="op" id="1510323">)</span>&nbsp;<span class="ident" id="1510325">hexDigit</span><span class="op" id="1510333">(</span><span class="ident" id="1510334">d</span>&nbsp;<span class="builtintype" id="1510336">rune</span><span class="op" id="1510340">)</span>&nbsp;<span class="builtintype" id="1510342">int</span>&nbsp;<span class="op" id="1510346">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510349">digit</span>&nbsp;<span class="op" id="1510355">:=</span>&nbsp;<span class="builtintype" id="1510358">int</span><span class="op" id="1510361">(</span><span class="ident" id="1510362">d</span><span class="op" id="1510363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510366">switch</span>&nbsp;<span class="ident" id="1510373">digit</span>&nbsp;<span class="op" id="1510379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510382">case</span>&nbsp;<span class="string" id="1510387">&#39;0&#39;</span><span class="op" id="1510390">,</span>&nbsp;<span class="string" id="1510392">&#39;1&#39;</span><span class="op" id="1510395">,</span>&nbsp;<span class="string" id="1510397">&#39;2&#39;</span><span class="op" id="1510400">,</span>&nbsp;<span class="string" id="1510402">&#39;3&#39;</span><span class="op" id="1510405">,</span>&nbsp;<span class="string" id="1510407">&#39;4&#39;</span><span class="op" id="1510410">,</span>&nbsp;<span class="string" id="1510412">&#39;5&#39;</span><span class="op" id="1510415">,</span>&nbsp;<span class="string" id="1510417">&#39;6&#39;</span><span class="op" id="1510420">,</span>&nbsp;<span class="string" id="1510422">&#39;7&#39;</span><span class="op" id="1510425">,</span>&nbsp;<span class="string" id="1510427">&#39;8&#39;</span><span class="op" id="1510430">,</span>&nbsp;<span class="string" id="1510432">&#39;9&#39;</span><span class="op" id="1510435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510439">return</span>&nbsp;<span class="ident" id="1510446">digit</span>&nbsp;<span class="op" id="1510452">-</span>&nbsp;<span class="string" id="1510454">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510459">case</span>&nbsp;<span class="string" id="1510464">&#39;a&#39;</span><span class="op" id="1510467">,</span>&nbsp;<span class="string" id="1510469">&#39;b&#39;</span><span class="op" id="1510472">,</span>&nbsp;<span class="string" id="1510474">&#39;c&#39;</span><span class="op" id="1510477">,</span>&nbsp;<span class="string" id="1510479">&#39;d&#39;</span><span class="op" id="1510482">,</span>&nbsp;<span class="string" id="1510484">&#39;e&#39;</span><span class="op" id="1510487">,</span>&nbsp;<span class="string" id="1510489">&#39;f&#39;</span><span class="op" id="1510492">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510496">return</span>&nbsp;<span class="num" id="1510503">10</span>&nbsp;<span class="op" id="1510506">+</span>&nbsp;<span class="ident" id="1510508">digit</span>&nbsp;<span class="op" id="1510514">-</span>&nbsp;<span class="string" id="1510516">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510521">case</span>&nbsp;<span class="string" id="1510526">&#39;A&#39;</span><span class="op" id="1510529">,</span>&nbsp;<span class="string" id="1510531">&#39;B&#39;</span><span class="op" id="1510534">,</span>&nbsp;<span class="string" id="1510536">&#39;C&#39;</span><span class="op" id="1510539">,</span>&nbsp;<span class="string" id="1510541">&#39;D&#39;</span><span class="op" id="1510544">,</span>&nbsp;<span class="string" id="1510546">&#39;E&#39;</span><span class="op" id="1510549">,</span>&nbsp;<span class="string" id="1510551">&#39;F&#39;</span><span class="op" id="1510554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510558">return</span>&nbsp;<span class="num" id="1510565">10</span>&nbsp;<span class="op" id="1510568">+</span>&nbsp;<span class="ident" id="1510570">digit</span>&nbsp;<span class="op" id="1510576">-</span>&nbsp;<span class="string" id="1510578">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510586">s</span><span class="op" id="1510587">.</span><span class="ident" id="1510588">errorString</span><span class="op" id="1510599">(</span><span class="string" id="1510600">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="1510619">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510622">return</span>&nbsp;<span class="num" id="1510629">0</span><br>
<span class="lineno"></span><span class="op" id="1510631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1510634">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1510711">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="1510793">func</span>&nbsp;<span class="op" id="1510798">(</span><span class="ident" id="1510799">s</span>&nbsp;<span class="op" id="1510801">*</span><span class="ident" id="1510802">ss</span><span class="op" id="1510804">)</span>&nbsp;<span class="ident" id="1510806">hexByte</span><span class="op" id="1510813">(</span><span class="op" id="1510814">)</span>&nbsp;<span class="op" id="1510816">(</span><span class="ident" id="1510817">b</span>&nbsp;<span class="builtintype" id="1510819">byte</span><span class="op" id="1510823">,</span>&nbsp;<span class="ident" id="1510825">ok</span>&nbsp;<span class="builtintype" id="1510828">bool</span><span class="op" id="1510832">)</span>&nbsp;<span class="op" id="1510834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510837">rune1</span>&nbsp;<span class="op" id="1510843">:=</span>&nbsp;<span class="ident" id="1510846">s</span><span class="op" id="1510847">.</span><span class="ident" id="1510848">getRune</span><span class="op" id="1510855">(</span><span class="op" id="1510856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510859">if</span>&nbsp;<span class="ident" id="1510862">rune1</span>&nbsp;<span class="op" id="1510868">==</span>&nbsp;<span class="ident" id="1510871">eof</span>&nbsp;<span class="op" id="1510875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510879">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510887">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510890">if</span>&nbsp;<span class="ident" id="1510893">isSpace</span><span class="op" id="1510900">(</span><span class="ident" id="1510901">rune1</span><span class="op" id="1510906">)</span>&nbsp;<span class="op" id="1510908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510912">s</span><span class="op" id="1510913">.</span><span class="ident" id="1510914">UnreadRune</span><span class="op" id="1510924">(</span><span class="op" id="1510925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510929">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510940">rune2</span>&nbsp;<span class="op" id="1510946">:=</span>&nbsp;<span class="ident" id="1510949">s</span><span class="op" id="1510950">.</span><span class="ident" id="1510951">mustReadRune</span><span class="op" id="1510963">(</span><span class="op" id="1510964">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510967">return</span>&nbsp;<span class="builtintype" id="1510974">byte</span><span class="op" id="1510978">(</span><span class="ident" id="1510979">s</span><span class="op" id="1510980">.</span><span class="ident" id="1510981">hexDigit</span><span class="op" id="1510989">(</span><span class="ident" id="1510990">rune1</span><span class="op" id="1510995">)</span><span class="op" id="1510996">&lt;&lt;</span><span class="num" id="1510998">4</span>&nbsp;<span class="op" id="1511000">|</span>&nbsp;<span class="ident" id="1511002">s</span><span class="op" id="1511003">.</span><span class="ident" id="1511004">hexDigit</span><span class="op" id="1511012">(</span><span class="ident" id="1511013">rune2</span><span class="op" id="1511018">)</span><span class="op" id="1511019">)</span><span class="op" id="1511020">,</span>&nbsp;<span class="builtintype" id="1511022">true</span><br>
<span class="lineno"></span><span class="op" id="1511027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1511030">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1511095">func</span>&nbsp;<span class="op" id="1511100">(</span><span class="ident" id="1511101">s</span>&nbsp;<span class="op" id="1511103">*</span><span class="ident" id="1511104">ss</span><span class="op" id="1511106">)</span>&nbsp;<span class="ident" id="1511108">hexString</span><span class="op" id="1511117">(</span><span class="op" id="1511118">)</span>&nbsp;<span class="builtintype" id="1511120">string</span>&nbsp;<span class="op" id="1511127">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511130">s</span><span class="op" id="1511131">.</span><span class="ident" id="1511132">notEOF</span><span class="op" id="1511138">(</span><span class="op" id="1511139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511142">for</span>&nbsp;<span class="op" id="1511146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511150">b</span><span class="op" id="1511151">,</span>&nbsp;<span class="ident" id="1511153">ok</span>&nbsp;<span class="op" id="1511156">:=</span>&nbsp;<span class="ident" id="1511159">s</span><span class="op" id="1511160">.</span><span class="ident" id="1511161">hexByte</span><span class="op" id="1511168">(</span><span class="op" id="1511169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511173">if</span>&nbsp;<span class="op" id="1511176">!</span><span class="ident" id="1511177">ok</span>&nbsp;<span class="op" id="1511180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511185">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511197">s</span><span class="op" id="1511198">.</span><span class="ident" id="1511199">buf</span><span class="op" id="1511202">.</span><span class="ident" id="1511203">WriteByte</span><span class="op" id="1511212">(</span><span class="ident" id="1511213">b</span><span class="op" id="1511214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511220">if</span>&nbsp;<span class="builtinfunc" id="1511223">len</span><span class="op" id="1511226">(</span><span class="ident" id="1511227">s</span><span class="op" id="1511228">.</span><span class="ident" id="1511229">buf</span><span class="op" id="1511232">)</span>&nbsp;<span class="op" id="1511234">==</span>&nbsp;<span class="num" id="1511237">0</span>&nbsp;<span class="op" id="1511239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511243">s</span><span class="op" id="1511244">.</span><span class="ident" id="1511245">errorString</span><span class="op" id="1511256">(</span><span class="string" id="1511257">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="1511284">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511288">return</span>&nbsp;<span class="string" id="1511295">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511302">return</span>&nbsp;<span class="builtintype" id="1511309">string</span><span class="op" id="1511315">(</span><span class="ident" id="1511316">s</span><span class="op" id="1511317">.</span><span class="ident" id="1511318">buf</span><span class="op" id="1511321">)</span><br>
<span class="lineno"></span><span class="op" id="1511323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="1511326">const</span>&nbsp;<span class="ident" id="1511332">floatVerbs</span>&nbsp;<span class="op" id="1511343">=</span>&nbsp;<span class="string" id="1511345">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1511357">const</span>&nbsp;<span class="ident" id="1511363">hugeWid</span>&nbsp;<span class="op" id="1511371">=</span>&nbsp;<span class="num" id="1511373">1</span>&nbsp;<span class="op" id="1511375">&lt;&lt;</span>&nbsp;<span class="num" id="1511378">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1511382">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="1511467">func</span>&nbsp;<span class="op" id="1511472">(</span><span class="ident" id="1511473">s</span>&nbsp;<span class="op" id="1511475">*</span><span class="ident" id="1511476">ss</span><span class="op" id="1511478">)</span>&nbsp;<span class="ident" id="1511480">scanOne</span><span class="op" id="1511487">(</span><span class="ident" id="1511488">verb</span>&nbsp;<span class="builtintype" id="1511493">rune</span><span class="op" id="1511497">,</span>&nbsp;<span class="ident" id="1511499">arg</span>&nbsp;<span class="keyword" id="1511503">interface</span><span class="op" id="1511512">{</span><span class="op" id="1511513">}</span><span class="op" id="1511514">)</span>&nbsp;<span class="op" id="1511516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511519">s</span><span class="op" id="1511520">.</span><span class="ident" id="1511521">buf</span>&nbsp;<span class="op" id="1511525">=</span>&nbsp;<span class="ident" id="1511527">s</span><span class="op" id="1511528">.</span><span class="ident" id="1511529">buf</span><span class="op" id="1511532">[</span><span class="op" id="1511533">:</span><span class="num" id="1511534">0</span><span class="op" id="1511535">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511538">var</span>&nbsp;<span class="ident" id="1511542">err</span>&nbsp;<span class="builtintype" id="1511546">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1511553">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511609">if</span>&nbsp;<span class="ident" id="1511612">v</span><span class="op" id="1511613">,</span>&nbsp;<span class="ident" id="1511615">ok</span>&nbsp;<span class="op" id="1511618">:=</span>&nbsp;<span class="ident" id="1511621">arg</span><span class="op" id="1511624">.</span><span class="op" id="1511625">(</span><span class="ident" id="1511626">Scanner</span><span class="op" id="1511633">)</span><span class="op" id="1511634">;</span>&nbsp;<span class="ident" id="1511636">ok</span>&nbsp;<span class="op" id="1511639">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511643">err</span>&nbsp;<span class="op" id="1511647">=</span>&nbsp;<span class="ident" id="1511649">v</span><span class="op" id="1511650">.</span><span class="ident" id="1511651">Scan</span><span class="op" id="1511655">(</span><span class="ident" id="1511656">s</span><span class="op" id="1511657">,</span>&nbsp;<span class="ident" id="1511659">verb</span><span class="op" id="1511663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511667">if</span>&nbsp;<span class="ident" id="1511670">err</span>&nbsp;<span class="op" id="1511674">!=</span>&nbsp;<span class="ident" id="1511677">nil</span>&nbsp;<span class="op" id="1511681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511686">if</span>&nbsp;<span class="ident" id="1511689">err</span>&nbsp;<span class="op" id="1511693">==</span>&nbsp;<span class="ident" id="1511696">io</span><span class="op" id="1511698">.</span><span class="ident" id="1511699">EOF</span>&nbsp;<span class="op" id="1511703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511709">err</span>&nbsp;<span class="op" id="1511713">=</span>&nbsp;<span class="ident" id="1511715">io</span><span class="op" id="1511717">.</span><span class="ident" id="1511718">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511738">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511743">s</span><span class="op" id="1511744">.</span><span class="builtintype" id="1511745">error</span><span class="op" id="1511750">(</span><span class="ident" id="1511751">err</span><span class="op" id="1511754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511762">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511774">switch</span>&nbsp;<span class="ident" id="1511781">v</span>&nbsp;<span class="op" id="1511783">:=</span>&nbsp;<span class="ident" id="1511786">arg</span><span class="op" id="1511789">.</span><span class="op" id="1511790">(</span><span class="keyword" id="1511791">type</span><span class="op" id="1511795">)</span>&nbsp;<span class="op" id="1511797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511800">case</span>&nbsp;<span class="op" id="1511805">*</span><span class="builtintype" id="1511806">bool</span><span class="op" id="1511810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511814">*</span><span class="ident" id="1511815">v</span>&nbsp;<span class="op" id="1511817">=</span>&nbsp;<span class="ident" id="1511819">s</span><span class="op" id="1511820">.</span><span class="ident" id="1511821">scanBool</span><span class="op" id="1511829">(</span><span class="ident" id="1511830">verb</span><span class="op" id="1511834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511837">case</span>&nbsp;<span class="op" id="1511842">*</span><span class="builtintype" id="1511843">complex64</span><span class="op" id="1511852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511856">*</span><span class="ident" id="1511857">v</span>&nbsp;<span class="op" id="1511859">=</span>&nbsp;<span class="builtintype" id="1511861">complex64</span><span class="op" id="1511870">(</span><span class="ident" id="1511871">s</span><span class="op" id="1511872">.</span><span class="ident" id="1511873">scanComplex</span><span class="op" id="1511884">(</span><span class="ident" id="1511885">verb</span><span class="op" id="1511889">,</span>&nbsp;<span class="num" id="1511891">64</span><span class="op" id="1511893">)</span><span class="op" id="1511894">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511897">case</span>&nbsp;<span class="op" id="1511902">*</span><span class="builtintype" id="1511903">complex128</span><span class="op" id="1511913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511917">*</span><span class="ident" id="1511918">v</span>&nbsp;<span class="op" id="1511920">=</span>&nbsp;<span class="ident" id="1511922">s</span><span class="op" id="1511923">.</span><span class="ident" id="1511924">scanComplex</span><span class="op" id="1511935">(</span><span class="ident" id="1511936">verb</span><span class="op" id="1511940">,</span>&nbsp;<span class="num" id="1511942">128</span><span class="op" id="1511945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511948">case</span>&nbsp;<span class="op" id="1511953">*</span><span class="builtintype" id="1511954">int</span><span class="op" id="1511957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511961">*</span><span class="ident" id="1511962">v</span>&nbsp;<span class="op" id="1511964">=</span>&nbsp;<span class="builtintype" id="1511966">int</span><span class="op" id="1511969">(</span><span class="ident" id="1511970">s</span><span class="op" id="1511971">.</span><span class="ident" id="1511972">scanInt</span><span class="op" id="1511979">(</span><span class="ident" id="1511980">verb</span><span class="op" id="1511984">,</span>&nbsp;<span class="ident" id="1511986">intBits</span><span class="op" id="1511993">)</span><span class="op" id="1511994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511997">case</span>&nbsp;<span class="op" id="1512002">*</span><span class="builtintype" id="1512003">int8</span><span class="op" id="1512007">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512011">*</span><span class="ident" id="1512012">v</span>&nbsp;<span class="op" id="1512014">=</span>&nbsp;<span class="builtintype" id="1512016">int8</span><span class="op" id="1512020">(</span><span class="ident" id="1512021">s</span><span class="op" id="1512022">.</span><span class="ident" id="1512023">scanInt</span><span class="op" id="1512030">(</span><span class="ident" id="1512031">verb</span><span class="op" id="1512035">,</span>&nbsp;<span class="num" id="1512037">8</span><span class="op" id="1512038">)</span><span class="op" id="1512039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512042">case</span>&nbsp;<span class="op" id="1512047">*</span><span class="builtintype" id="1512048">int16</span><span class="op" id="1512053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512057">*</span><span class="ident" id="1512058">v</span>&nbsp;<span class="op" id="1512060">=</span>&nbsp;<span class="builtintype" id="1512062">int16</span><span class="op" id="1512067">(</span><span class="ident" id="1512068">s</span><span class="op" id="1512069">.</span><span class="ident" id="1512070">scanInt</span><span class="op" id="1512077">(</span><span class="ident" id="1512078">verb</span><span class="op" id="1512082">,</span>&nbsp;<span class="num" id="1512084">16</span><span class="op" id="1512086">)</span><span class="op" id="1512087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512090">case</span>&nbsp;<span class="op" id="1512095">*</span><span class="builtintype" id="1512096">int32</span><span class="op" id="1512101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512105">*</span><span class="ident" id="1512106">v</span>&nbsp;<span class="op" id="1512108">=</span>&nbsp;<span class="builtintype" id="1512110">int32</span><span class="op" id="1512115">(</span><span class="ident" id="1512116">s</span><span class="op" id="1512117">.</span><span class="ident" id="1512118">scanInt</span><span class="op" id="1512125">(</span><span class="ident" id="1512126">verb</span><span class="op" id="1512130">,</span>&nbsp;<span class="num" id="1512132">32</span><span class="op" id="1512134">)</span><span class="op" id="1512135">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512138">case</span>&nbsp;<span class="op" id="1512143">*</span><span class="ident" id="1512144">int64</span><span class="op" id="1512149">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512153">*</span><span class="ident" id="1512154">v</span>&nbsp;<span class="op" id="1512156">=</span>&nbsp;<span class="ident" id="1512158">s</span><span class="op" id="1512159">.</span><span class="ident" id="1512160">scanInt</span><span class="op" id="1512167">(</span><span class="ident" id="1512168">verb</span><span class="op" id="1512172">,</span>&nbsp;<span class="num" id="1512174">64</span><span class="op" id="1512176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512179">case</span>&nbsp;<span class="op" id="1512184">*</span><span class="builtintype" id="1512185">uint</span><span class="op" id="1512189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512193">*</span><span class="ident" id="1512194">v</span>&nbsp;<span class="op" id="1512196">=</span>&nbsp;<span class="builtintype" id="1512198">uint</span><span class="op" id="1512202">(</span><span class="ident" id="1512203">s</span><span class="op" id="1512204">.</span><span class="ident" id="1512205">scanUint</span><span class="op" id="1512213">(</span><span class="ident" id="1512214">verb</span><span class="op" id="1512218">,</span>&nbsp;<span class="ident" id="1512220">intBits</span><span class="op" id="1512227">)</span><span class="op" id="1512228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512231">case</span>&nbsp;<span class="op" id="1512236">*</span><span class="builtintype" id="1512237">uint8</span><span class="op" id="1512242">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512246">*</span><span class="ident" id="1512247">v</span>&nbsp;<span class="op" id="1512249">=</span>&nbsp;<span class="builtintype" id="1512251">uint8</span><span class="op" id="1512256">(</span><span class="ident" id="1512257">s</span><span class="op" id="1512258">.</span><span class="ident" id="1512259">scanUint</span><span class="op" id="1512267">(</span><span class="ident" id="1512268">verb</span><span class="op" id="1512272">,</span>&nbsp;<span class="num" id="1512274">8</span><span class="op" id="1512275">)</span><span class="op" id="1512276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512279">case</span>&nbsp;<span class="op" id="1512284">*</span><span class="builtintype" id="1512285">uint16</span><span class="op" id="1512291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512295">*</span><span class="ident" id="1512296">v</span>&nbsp;<span class="op" id="1512298">=</span>&nbsp;<span class="builtintype" id="1512300">uint16</span><span class="op" id="1512306">(</span><span class="ident" id="1512307">s</span><span class="op" id="1512308">.</span><span class="ident" id="1512309">scanUint</span><span class="op" id="1512317">(</span><span class="ident" id="1512318">verb</span><span class="op" id="1512322">,</span>&nbsp;<span class="num" id="1512324">16</span><span class="op" id="1512326">)</span><span class="op" id="1512327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512330">case</span>&nbsp;<span class="op" id="1512335">*</span><span class="builtintype" id="1512336">uint32</span><span class="op" id="1512342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512346">*</span><span class="ident" id="1512347">v</span>&nbsp;<span class="op" id="1512349">=</span>&nbsp;<span class="builtintype" id="1512351">uint32</span><span class="op" id="1512357">(</span><span class="ident" id="1512358">s</span><span class="op" id="1512359">.</span><span class="ident" id="1512360">scanUint</span><span class="op" id="1512368">(</span><span class="ident" id="1512369">verb</span><span class="op" id="1512373">,</span>&nbsp;<span class="num" id="1512375">32</span><span class="op" id="1512377">)</span><span class="op" id="1512378">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512381">case</span>&nbsp;<span class="op" id="1512386">*</span><span class="ident" id="1512387">uint64</span><span class="op" id="1512393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512397">*</span><span class="ident" id="1512398">v</span>&nbsp;<span class="op" id="1512400">=</span>&nbsp;<span class="ident" id="1512402">s</span><span class="op" id="1512403">.</span><span class="ident" id="1512404">scanUint</span><span class="op" id="1512412">(</span><span class="ident" id="1512413">verb</span><span class="op" id="1512417">,</span>&nbsp;<span class="num" id="1512419">64</span><span class="op" id="1512421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512424">case</span>&nbsp;<span class="op" id="1512429">*</span><span class="builtintype" id="1512430">uintptr</span><span class="op" id="1512437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512441">*</span><span class="ident" id="1512442">v</span>&nbsp;<span class="op" id="1512444">=</span>&nbsp;<span class="builtintype" id="1512446">uintptr</span><span class="op" id="1512453">(</span><span class="ident" id="1512454">s</span><span class="op" id="1512455">.</span><span class="ident" id="1512456">scanUint</span><span class="op" id="1512464">(</span><span class="ident" id="1512465">verb</span><span class="op" id="1512469">,</span>&nbsp;<span class="ident" id="1512471">uintptrBits</span><span class="op" id="1512482">)</span><span class="op" id="1512483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1512486">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1512569">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512659">case</span>&nbsp;<span class="op" id="1512664">*</span><span class="builtintype" id="1512665">float32</span><span class="op" id="1512672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512676">if</span>&nbsp;<span class="ident" id="1512679">s</span><span class="op" id="1512680">.</span><span class="ident" id="1512681">okVerb</span><span class="op" id="1512687">(</span><span class="ident" id="1512688">verb</span><span class="op" id="1512692">,</span>&nbsp;<span class="ident" id="1512694">floatVerbs</span><span class="op" id="1512704">,</span>&nbsp;<span class="string" id="1512706">&#34;float32&#34;</span><span class="op" id="1512715">)</span>&nbsp;<span class="op" id="1512717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512722">s</span><span class="op" id="1512723">.</span><span class="ident" id="1512724">skipSpace</span><span class="op" id="1512733">(</span><span class="builtintype" id="1512734">false</span><span class="op" id="1512739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512744">s</span><span class="op" id="1512745">.</span><span class="ident" id="1512746">notEOF</span><span class="op" id="1512752">(</span><span class="op" id="1512753">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512758">*</span><span class="ident" id="1512759">v</span>&nbsp;<span class="op" id="1512761">=</span>&nbsp;<span class="builtintype" id="1512763">float32</span><span class="op" id="1512770">(</span><span class="ident" id="1512771">s</span><span class="op" id="1512772">.</span><span class="ident" id="1512773">convertFloat</span><span class="op" id="1512785">(</span><span class="ident" id="1512786">s</span><span class="op" id="1512787">.</span><span class="ident" id="1512788">floatToken</span><span class="op" id="1512798">(</span><span class="op" id="1512799">)</span><span class="op" id="1512800">,</span>&nbsp;<span class="num" id="1512802">32</span><span class="op" id="1512804">)</span><span class="op" id="1512805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512812">case</span>&nbsp;<span class="op" id="1512817">*</span><span class="builtintype" id="1512818">float64</span><span class="op" id="1512825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512829">if</span>&nbsp;<span class="ident" id="1512832">s</span><span class="op" id="1512833">.</span><span class="ident" id="1512834">okVerb</span><span class="op" id="1512840">(</span><span class="ident" id="1512841">verb</span><span class="op" id="1512845">,</span>&nbsp;<span class="ident" id="1512847">floatVerbs</span><span class="op" id="1512857">,</span>&nbsp;<span class="string" id="1512859">&#34;float64&#34;</span><span class="op" id="1512868">)</span>&nbsp;<span class="op" id="1512870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512875">s</span><span class="op" id="1512876">.</span><span class="ident" id="1512877">skipSpace</span><span class="op" id="1512886">(</span><span class="builtintype" id="1512887">false</span><span class="op" id="1512892">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512897">s</span><span class="op" id="1512898">.</span><span class="ident" id="1512899">notEOF</span><span class="op" id="1512905">(</span><span class="op" id="1512906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512911">*</span><span class="ident" id="1512912">v</span>&nbsp;<span class="op" id="1512914">=</span>&nbsp;<span class="ident" id="1512916">s</span><span class="op" id="1512917">.</span><span class="ident" id="1512918">convertFloat</span><span class="op" id="1512930">(</span><span class="ident" id="1512931">s</span><span class="op" id="1512932">.</span><span class="ident" id="1512933">floatToken</span><span class="op" id="1512943">(</span><span class="op" id="1512944">)</span><span class="op" id="1512945">,</span>&nbsp;<span class="num" id="1512947">64</span><span class="op" id="1512949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512956">case</span>&nbsp;<span class="op" id="1512961">*</span><span class="builtintype" id="1512962">string</span><span class="op" id="1512968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512972">*</span><span class="ident" id="1512973">v</span>&nbsp;<span class="op" id="1512975">=</span>&nbsp;<span class="ident" id="1512977">s</span><span class="op" id="1512978">.</span><span class="ident" id="1512979">convertString</span><span class="op" id="1512992">(</span><span class="ident" id="1512993">verb</span><span class="op" id="1512997">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513000">case</span>&nbsp;<span class="op" id="1513005">*</span><span class="op" id="1513006">[</span><span class="op" id="1513007">]</span><span class="builtintype" id="1513008">byte</span><span class="op" id="1513012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1513016">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1513081">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513147">*</span><span class="ident" id="1513148">v</span>&nbsp;<span class="op" id="1513150">=</span>&nbsp;<span class="op" id="1513152">[</span><span class="op" id="1513153">]</span><span class="builtintype" id="1513154">byte</span><span class="op" id="1513158">(</span><span class="ident" id="1513159">s</span><span class="op" id="1513160">.</span><span class="ident" id="1513161">convertString</span><span class="op" id="1513174">(</span><span class="ident" id="1513175">verb</span><span class="op" id="1513179">)</span><span class="op" id="1513180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513183">default</span><span class="op" id="1513190">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513194">val</span>&nbsp;<span class="op" id="1513198">:=</span>&nbsp;<span class="ident" id="1513201">reflect</span><span class="op" id="1513208">.</span><span class="ident" id="1513209">ValueOf</span><span class="op" id="1513216">(</span><span class="ident" id="1513217">v</span><span class="op" id="1513218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513222">ptr</span>&nbsp;<span class="op" id="1513226">:=</span>&nbsp;<span class="ident" id="1513229">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513235">if</span>&nbsp;<span class="ident" id="1513238">ptr</span><span class="op" id="1513241">.</span><span class="ident" id="1513242">Kind</span><span class="op" id="1513246">(</span><span class="op" id="1513247">)</span>&nbsp;<span class="op" id="1513249">!=</span>&nbsp;<span class="ident" id="1513252">reflect</span><span class="op" id="1513259">.</span><span class="ident" id="1513260">Ptr</span>&nbsp;<span class="op" id="1513264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513269">s</span><span class="op" id="1513270">.</span><span class="ident" id="1513271">errorString</span><span class="op" id="1513282">(</span><span class="string" id="1513283">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="1513306">+</span>&nbsp;<span class="ident" id="1513308">val</span><span class="op" id="1513311">.</span><span class="ident" id="1513312">Type</span><span class="op" id="1513316">(</span><span class="op" id="1513317">)</span><span class="op" id="1513318">.</span><span class="ident" id="1513319">String</span><span class="op" id="1513325">(</span><span class="op" id="1513326">)</span><span class="op" id="1513327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513332">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513345">switch</span>&nbsp;<span class="ident" id="1513352">v</span>&nbsp;<span class="op" id="1513354">:=</span>&nbsp;<span class="ident" id="1513357">ptr</span><span class="op" id="1513360">.</span><span class="ident" id="1513361">Elem</span><span class="op" id="1513365">(</span><span class="op" id="1513366">)</span><span class="op" id="1513367">;</span>&nbsp;<span class="ident" id="1513369">v</span><span class="op" id="1513370">.</span><span class="ident" id="1513371">Kind</span><span class="op" id="1513375">(</span><span class="op" id="1513376">)</span>&nbsp;<span class="op" id="1513378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513382">case</span>&nbsp;<span class="ident" id="1513387">reflect</span><span class="op" id="1513394">.</span><span class="ident" id="1513395">Bool</span><span class="op" id="1513399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513404">v</span><span class="op" id="1513405">.</span><span class="ident" id="1513406">SetBool</span><span class="op" id="1513413">(</span><span class="ident" id="1513414">s</span><span class="op" id="1513415">.</span><span class="ident" id="1513416">scanBool</span><span class="op" id="1513424">(</span><span class="ident" id="1513425">verb</span><span class="op" id="1513429">)</span><span class="op" id="1513430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513434">case</span>&nbsp;<span class="ident" id="1513439">reflect</span><span class="op" id="1513446">.</span><span class="ident" id="1513447">Int</span><span class="op" id="1513450">,</span>&nbsp;<span class="ident" id="1513452">reflect</span><span class="op" id="1513459">.</span><span class="ident" id="1513460">Int8</span><span class="op" id="1513464">,</span>&nbsp;<span class="ident" id="1513466">reflect</span><span class="op" id="1513473">.</span><span class="ident" id="1513474">Int16</span><span class="op" id="1513479">,</span>&nbsp;<span class="ident" id="1513481">reflect</span><span class="op" id="1513488">.</span><span class="ident" id="1513489">Int32</span><span class="op" id="1513494">,</span>&nbsp;<span class="ident" id="1513496">reflect</span><span class="op" id="1513503">.</span><span class="ident" id="1513504">Int64</span><span class="op" id="1513509">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513514">v</span><span class="op" id="1513515">.</span><span class="ident" id="1513516">SetInt</span><span class="op" id="1513522">(</span><span class="ident" id="1513523">s</span><span class="op" id="1513524">.</span><span class="ident" id="1513525">scanInt</span><span class="op" id="1513532">(</span><span class="ident" id="1513533">verb</span><span class="op" id="1513537">,</span>&nbsp;<span class="ident" id="1513539">v</span><span class="op" id="1513540">.</span><span class="ident" id="1513541">Type</span><span class="op" id="1513545">(</span><span class="op" id="1513546">)</span><span class="op" id="1513547">.</span><span class="ident" id="1513548">Bits</span><span class="op" id="1513552">(</span><span class="op" id="1513553">)</span><span class="op" id="1513554">)</span><span class="op" id="1513555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513559">case</span>&nbsp;<span class="ident" id="1513564">reflect</span><span class="op" id="1513571">.</span><span class="ident" id="1513572">Uint</span><span class="op" id="1513576">,</span>&nbsp;<span class="ident" id="1513578">reflect</span><span class="op" id="1513585">.</span><span class="ident" id="1513586">Uint8</span><span class="op" id="1513591">,</span>&nbsp;<span class="ident" id="1513593">reflect</span><span class="op" id="1513600">.</span><span class="ident" id="1513601">Uint16</span><span class="op" id="1513607">,</span>&nbsp;<span class="ident" id="1513609">reflect</span><span class="op" id="1513616">.</span><span class="ident" id="1513617">Uint32</span><span class="op" id="1513623">,</span>&nbsp;<span class="ident" id="1513625">reflect</span><span class="op" id="1513632">.</span><span class="ident" id="1513633">Uint64</span><span class="op" id="1513639">,</span>&nbsp;<span class="ident" id="1513641">reflect</span><span class="op" id="1513648">.</span><span class="ident" id="1513649">Uintptr</span><span class="op" id="1513656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513661">v</span><span class="op" id="1513662">.</span><span class="ident" id="1513663">SetUint</span><span class="op" id="1513670">(</span><span class="ident" id="1513671">s</span><span class="op" id="1513672">.</span><span class="ident" id="1513673">scanUint</span><span class="op" id="1513681">(</span><span class="ident" id="1513682">verb</span><span class="op" id="1513686">,</span>&nbsp;<span class="ident" id="1513688">v</span><span class="op" id="1513689">.</span><span class="ident" id="1513690">Type</span><span class="op" id="1513694">(</span><span class="op" id="1513695">)</span><span class="op" id="1513696">.</span><span class="ident" id="1513697">Bits</span><span class="op" id="1513701">(</span><span class="op" id="1513702">)</span><span class="op" id="1513703">)</span><span class="op" id="1513704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513708">case</span>&nbsp;<span class="ident" id="1513713">reflect</span><span class="op" id="1513720">.</span><span class="ident" id="1513721">String</span><span class="op" id="1513727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513732">v</span><span class="op" id="1513733">.</span><span class="ident" id="1513734">SetString</span><span class="op" id="1513743">(</span><span class="ident" id="1513744">s</span><span class="op" id="1513745">.</span><span class="ident" id="1513746">convertString</span><span class="op" id="1513759">(</span><span class="ident" id="1513760">verb</span><span class="op" id="1513764">)</span><span class="op" id="1513765">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513769">case</span>&nbsp;<span class="ident" id="1513774">reflect</span><span class="op" id="1513781">.</span><span class="ident" id="1513782">Slice</span><span class="op" id="1513787">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1513792">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513841">typ</span>&nbsp;<span class="op" id="1513845">:=</span>&nbsp;<span class="ident" id="1513848">v</span><span class="op" id="1513849">.</span><span class="ident" id="1513850">Type</span><span class="op" id="1513854">(</span><span class="op" id="1513855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513860">if</span>&nbsp;<span class="ident" id="1513863">typ</span><span class="op" id="1513866">.</span><span class="ident" id="1513867">Elem</span><span class="op" id="1513871">(</span><span class="op" id="1513872">)</span><span class="op" id="1513873">.</span><span class="ident" id="1513874">Kind</span><span class="op" id="1513878">(</span><span class="op" id="1513879">)</span>&nbsp;<span class="op" id="1513881">!=</span>&nbsp;<span class="ident" id="1513884">reflect</span><span class="op" id="1513891">.</span><span class="ident" id="1513892">Uint8</span>&nbsp;<span class="op" id="1513898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513904">s</span><span class="op" id="1513905">.</span><span class="ident" id="1513906">errorString</span><span class="op" id="1513917">(</span><span class="string" id="1513918">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="1513938">+</span>&nbsp;<span class="ident" id="1513940">val</span><span class="op" id="1513943">.</span><span class="ident" id="1513944">Type</span><span class="op" id="1513948">(</span><span class="op" id="1513949">)</span><span class="op" id="1513950">.</span><span class="ident" id="1513951">String</span><span class="op" id="1513957">(</span><span class="op" id="1513958">)</span><span class="op" id="1513959">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513969">str</span>&nbsp;<span class="op" id="1513973">:=</span>&nbsp;<span class="ident" id="1513976">s</span><span class="op" id="1513977">.</span><span class="ident" id="1513978">convertString</span><span class="op" id="1513991">(</span><span class="ident" id="1513992">verb</span><span class="op" id="1513996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514001">v</span><span class="op" id="1514002">.</span><span class="ident" id="1514003">Set</span><span class="op" id="1514006">(</span><span class="ident" id="1514007">reflect</span><span class="op" id="1514014">.</span><span class="ident" id="1514015">MakeSlice</span><span class="op" id="1514024">(</span><span class="ident" id="1514025">typ</span><span class="op" id="1514028">,</span>&nbsp;<span class="builtinfunc" id="1514030">len</span><span class="op" id="1514033">(</span><span class="ident" id="1514034">str</span><span class="op" id="1514037">)</span><span class="op" id="1514038">,</span>&nbsp;<span class="builtinfunc" id="1514040">len</span><span class="op" id="1514043">(</span><span class="ident" id="1514044">str</span><span class="op" id="1514047">)</span><span class="op" id="1514048">)</span><span class="op" id="1514049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514054">for</span>&nbsp;<span class="ident" id="1514058">i</span>&nbsp;<span class="op" id="1514060">:=</span>&nbsp;<span class="num" id="1514063">0</span><span class="op" id="1514064">;</span>&nbsp;<span class="ident" id="1514066">i</span>&nbsp;<span class="op" id="1514068">&lt;</span>&nbsp;<span class="builtinfunc" id="1514070">len</span><span class="op" id="1514073">(</span><span class="ident" id="1514074">str</span><span class="op" id="1514077">)</span><span class="op" id="1514078">;</span>&nbsp;<span class="ident" id="1514080">i</span><span class="op" id="1514081">++</span>&nbsp;<span class="op" id="1514084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514090">v</span><span class="op" id="1514091">.</span><span class="ident" id="1514092">Index</span><span class="op" id="1514097">(</span><span class="ident" id="1514098">i</span><span class="op" id="1514099">)</span><span class="op" id="1514100">.</span><span class="ident" id="1514101">SetUint</span><span class="op" id="1514108">(</span><span class="ident" id="1514109">uint64</span><span class="op" id="1514115">(</span><span class="ident" id="1514116">str</span><span class="op" id="1514119">[</span><span class="ident" id="1514120">i</span><span class="op" id="1514121">]</span><span class="op" id="1514122">)</span><span class="op" id="1514123">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514132">case</span>&nbsp;<span class="ident" id="1514137">reflect</span><span class="op" id="1514144">.</span><span class="ident" id="1514145">Float32</span><span class="op" id="1514152">,</span>&nbsp;<span class="ident" id="1514154">reflect</span><span class="op" id="1514161">.</span><span class="ident" id="1514162">Float64</span><span class="op" id="1514169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514174">s</span><span class="op" id="1514175">.</span><span class="ident" id="1514176">skipSpace</span><span class="op" id="1514185">(</span><span class="builtintype" id="1514186">false</span><span class="op" id="1514191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514196">s</span><span class="op" id="1514197">.</span><span class="ident" id="1514198">notEOF</span><span class="op" id="1514204">(</span><span class="op" id="1514205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514210">v</span><span class="op" id="1514211">.</span><span class="ident" id="1514212">SetFloat</span><span class="op" id="1514220">(</span><span class="ident" id="1514221">s</span><span class="op" id="1514222">.</span><span class="ident" id="1514223">convertFloat</span><span class="op" id="1514235">(</span><span class="ident" id="1514236">s</span><span class="op" id="1514237">.</span><span class="ident" id="1514238">floatToken</span><span class="op" id="1514248">(</span><span class="op" id="1514249">)</span><span class="op" id="1514250">,</span>&nbsp;<span class="ident" id="1514252">v</span><span class="op" id="1514253">.</span><span class="ident" id="1514254">Type</span><span class="op" id="1514258">(</span><span class="op" id="1514259">)</span><span class="op" id="1514260">.</span><span class="ident" id="1514261">Bits</span><span class="op" id="1514265">(</span><span class="op" id="1514266">)</span><span class="op" id="1514267">)</span><span class="op" id="1514268">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514272">case</span>&nbsp;<span class="ident" id="1514277">reflect</span><span class="op" id="1514284">.</span><span class="ident" id="1514285">Complex64</span><span class="op" id="1514294">,</span>&nbsp;<span class="ident" id="1514296">reflect</span><span class="op" id="1514303">.</span><span class="ident" id="1514304">Complex128</span><span class="op" id="1514314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514319">v</span><span class="op" id="1514320">.</span><span class="ident" id="1514321">SetComplex</span><span class="op" id="1514331">(</span><span class="ident" id="1514332">s</span><span class="op" id="1514333">.</span><span class="ident" id="1514334">scanComplex</span><span class="op" id="1514345">(</span><span class="ident" id="1514346">verb</span><span class="op" id="1514350">,</span>&nbsp;<span class="ident" id="1514352">v</span><span class="op" id="1514353">.</span><span class="ident" id="1514354">Type</span><span class="op" id="1514358">(</span><span class="op" id="1514359">)</span><span class="op" id="1514360">.</span><span class="ident" id="1514361">Bits</span><span class="op" id="1514365">(</span><span class="op" id="1514366">)</span><span class="op" id="1514367">)</span><span class="op" id="1514368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514372">default</span><span class="op" id="1514379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514384">s</span><span class="op" id="1514385">.</span><span class="ident" id="1514386">errorString</span><span class="op" id="1514397">(</span><span class="string" id="1514398">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="1514418">+</span>&nbsp;<span class="ident" id="1514420">val</span><span class="op" id="1514423">.</span><span class="ident" id="1514424">Type</span><span class="op" id="1514428">(</span><span class="op" id="1514429">)</span><span class="op" id="1514430">.</span><span class="ident" id="1514431">String</span><span class="op" id="1514437">(</span><span class="op" id="1514438">)</span><span class="op" id="1514439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514443">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514446">}</span><br>
<span class="lineno"></span><span class="op" id="1514448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1514451">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="1514506">func</span>&nbsp;<span class="ident" id="1514511">errorHandler</span><span class="op" id="1514523">(</span><span class="ident" id="1514524">errp</span>&nbsp;<span class="op" id="1514529">*</span><span class="builtintype" id="1514530">error</span><span class="op" id="1514535">)</span>&nbsp;<span class="op" id="1514537">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514540">if</span>&nbsp;<span class="ident" id="1514543">e</span>&nbsp;<span class="op" id="1514545">:=</span>&nbsp;<span class="builtinfunc" id="1514548">recover</span><span class="op" id="1514555">(</span><span class="op" id="1514556">)</span><span class="op" id="1514557">;</span>&nbsp;<span class="ident" id="1514559">e</span>&nbsp;<span class="op" id="1514561">!=</span>&nbsp;<span class="ident" id="1514564">nil</span>&nbsp;<span class="op" id="1514568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514572">if</span>&nbsp;<span class="ident" id="1514575">se</span><span class="op" id="1514577">,</span>&nbsp;<span class="ident" id="1514579">ok</span>&nbsp;<span class="op" id="1514582">:=</span>&nbsp;<span class="ident" id="1514585">e</span><span class="op" id="1514586">.</span><span class="op" id="1514587">(</span><span class="ident" id="1514588">scanError</span><span class="op" id="1514597">)</span><span class="op" id="1514598">;</span>&nbsp;<span class="ident" id="1514600">ok</span>&nbsp;<span class="op" id="1514603">{</span>&nbsp;<span class="comment" id="1514605">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514629">*</span><span class="ident" id="1514630">errp</span>&nbsp;<span class="op" id="1514635">=</span>&nbsp;<span class="ident" id="1514637">se</span><span class="op" id="1514639">.</span><span class="ident" id="1514640">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514646">}</span>&nbsp;<span class="keyword" id="1514648">else</span>&nbsp;<span class="keyword" id="1514653">if</span>&nbsp;<span class="ident" id="1514656">eof</span><span class="op" id="1514659">,</span>&nbsp;<span class="ident" id="1514661">ok</span>&nbsp;<span class="op" id="1514664">:=</span>&nbsp;<span class="ident" id="1514667">e</span><span class="op" id="1514668">.</span><span class="op" id="1514669">(</span><span class="builtintype" id="1514670">error</span><span class="op" id="1514675">)</span><span class="op" id="1514676">;</span>&nbsp;<span class="ident" id="1514678">ok</span>&nbsp;<span class="op" id="1514681">&amp;&amp;</span>&nbsp;<span class="ident" id="1514684">eof</span>&nbsp;<span class="op" id="1514688">==</span>&nbsp;<span class="ident" id="1514691">io</span><span class="op" id="1514693">.</span><span class="ident" id="1514694">EOF</span>&nbsp;<span class="op" id="1514698">{</span>&nbsp;<span class="comment" id="1514700">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514719">*</span><span class="ident" id="1514720">errp</span>&nbsp;<span class="op" id="1514725">=</span>&nbsp;<span class="ident" id="1514727">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514733">}</span>&nbsp;<span class="keyword" id="1514735">else</span>&nbsp;<span class="op" id="1514740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1514745">panic</span><span class="op" id="1514750">(</span><span class="ident" id="1514751">e</span><span class="op" id="1514752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514759">}</span><br>
<span class="lineno"></span><span class="op" id="1514761">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="1514764">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1514831">func</span>&nbsp;<span class="op" id="1514836">(</span><span class="ident" id="1514837">s</span>&nbsp;<span class="op" id="1514839">*</span><span class="ident" id="1514840">ss</span><span class="op" id="1514842">)</span>&nbsp;<span class="ident" id="1514844">doScan</span><span class="op" id="1514850">(</span><span class="ident" id="1514851">a</span>&nbsp;<span class="op" id="1514853">[</span><span class="op" id="1514854">]</span><span class="keyword" id="1514855">interface</span><span class="op" id="1514864">{</span><span class="op" id="1514865">}</span><span class="op" id="1514866">)</span>&nbsp;<span class="op" id="1514868">(</span><span class="ident" id="1514869">numProcessed</span>&nbsp;<span class="builtintype" id="1514882">int</span><span class="op" id="1514885">,</span>&nbsp;<span class="ident" id="1514887">err</span>&nbsp;<span class="builtintype" id="1514891">error</span><span class="op" id="1514896">)</span>&nbsp;<span class="op" id="1514898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514901">defer</span>&nbsp;<span class="ident" id="1514907">errorHandler</span><span class="op" id="1514919">(</span><span class="op" id="1514920">&amp;</span><span class="ident" id="1514921">err</span><span class="op" id="1514924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1514927">for</span>&nbsp;<span class="ident" id="1514931">_</span><span class="op" id="1514932">,</span>&nbsp;<span class="ident" id="1514934">arg</span>&nbsp;<span class="op" id="1514938">:=</span>&nbsp;<span class="keyword" id="1514941">range</span>&nbsp;<span class="ident" id="1514947">a</span>&nbsp;<span class="op" id="1514949">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514953">s</span><span class="op" id="1514954">.</span><span class="ident" id="1514955">scanOne</span><span class="op" id="1514962">(</span><span class="string" id="1514963">&#39;v&#39;</span><span class="op" id="1514966">,</span>&nbsp;<span class="ident" id="1514968">arg</span><span class="op" id="1514971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1514975">numProcessed</span><span class="op" id="1514987">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1514991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1514994">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515029">if</span>&nbsp;<span class="op" id="1515032">!</span><span class="ident" id="1515033">s</span><span class="op" id="1515034">.</span><span class="ident" id="1515035">nlIsSpace</span>&nbsp;<span class="op" id="1515045">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515049">for</span>&nbsp;<span class="op" id="1515053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1515058">r</span>&nbsp;<span class="op" id="1515060">:=</span>&nbsp;<span class="ident" id="1515063">s</span><span class="op" id="1515064">.</span><span class="ident" id="1515065">getRune</span><span class="op" id="1515072">(</span><span class="op" id="1515073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515078">if</span>&nbsp;<span class="ident" id="1515081">r</span>&nbsp;<span class="op" id="1515083">==</span>&nbsp;<span class="string" id="1515086">&#39;\n&#39;</span>&nbsp;<span class="op" id="1515091">||</span>&nbsp;<span class="ident" id="1515094">r</span>&nbsp;<span class="op" id="1515096">==</span>&nbsp;<span class="ident" id="1515099">eof</span>&nbsp;<span class="op" id="1515103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515109">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1515118">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515123">if</span>&nbsp;<span class="op" id="1515126">!</span><span class="ident" id="1515127">isSpace</span><span class="op" id="1515134">(</span><span class="ident" id="1515135">r</span><span class="op" id="1515136">)</span>&nbsp;<span class="op" id="1515138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1515144">s</span><span class="op" id="1515145">.</span><span class="ident" id="1515146">errorString</span><span class="op" id="1515157">(</span><span class="string" id="1515158">&#34;expected&nbsp;newline&#34;</span><span class="op" id="1515176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515182">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1515191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1515195">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1515198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515201">return</span><br>
<span class="lineno"></span><span class="op" id="1515208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1515211">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="1515280">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="1515351">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1515420">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="1515490">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="1515558">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="1515622">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1515680">func</span>&nbsp;<span class="op" id="1515685">(</span><span class="ident" id="1515686">s</span>&nbsp;<span class="op" id="1515688">*</span><span class="ident" id="1515689">ss</span><span class="op" id="1515691">)</span>&nbsp;<span class="ident" id="1515693">advance</span><span class="op" id="1515700">(</span><span class="ident" id="1515701">format</span>&nbsp;<span class="builtintype" id="1515708">string</span><span class="op" id="1515714">)</span>&nbsp;<span class="op" id="1515716">(</span><span class="ident" id="1515717">i</span>&nbsp;<span class="builtintype" id="1515719">int</span><span class="op" id="1515722">)</span>&nbsp;<span class="op" id="1515724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515727">for</span>&nbsp;<span class="ident" id="1515731">i</span>&nbsp;<span class="op" id="1515733">&lt;</span>&nbsp;<span class="builtinfunc" id="1515735">len</span><span class="op" id="1515738">(</span><span class="ident" id="1515739">format</span><span class="op" id="1515745">)</span>&nbsp;<span class="op" id="1515747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1515751">fmtc</span><span class="op" id="1515755">,</span>&nbsp;<span class="ident" id="1515757">w</span>&nbsp;<span class="op" id="1515759">:=</span>&nbsp;<span class="ident" id="1515762">utf8</span><span class="op" id="1515766">.</span><span class="ident" id="1515767">DecodeRuneInString</span><span class="op" id="1515785">(</span><span class="ident" id="1515786">format</span><span class="op" id="1515792">[</span><span class="ident" id="1515793">i</span><span class="op" id="1515794">:</span><span class="op" id="1515795">]</span><span class="op" id="1515796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515800">if</span>&nbsp;<span class="ident" id="1515803">fmtc</span>&nbsp;<span class="op" id="1515808">==</span>&nbsp;<span class="string" id="1515811">&#39;%&#39;</span>&nbsp;<span class="op" id="1515815">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1515820">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1515854">nextc</span><span class="op" id="1515859">,</span>&nbsp;<span class="ident" id="1515861">_</span>&nbsp;<span class="op" id="1515863">:=</span>&nbsp;<span class="ident" id="1515866">utf8</span><span class="op" id="1515870">.</span><span class="ident" id="1515871">DecodeRuneInString</span><span class="op" id="1515889">(</span><span class="ident" id="1515890">format</span><span class="op" id="1515896">[</span><span class="ident" id="1515897">i</span><span class="op" id="1515898">+</span><span class="ident" id="1515899">w</span><span class="op" id="1515900">:</span><span class="op" id="1515901">]</span><span class="op" id="1515902">)</span>&nbsp;<span class="comment" id="1515904">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515946">if</span>&nbsp;<span class="ident" id="1515949">nextc</span>&nbsp;<span class="op" id="1515955">!=</span>&nbsp;<span class="string" id="1515958">&#39;%&#39;</span>&nbsp;<span class="op" id="1515962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1515968">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1515978">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1515983">i</span>&nbsp;<span class="op" id="1515985">+=</span>&nbsp;<span class="ident" id="1515988">w</span>&nbsp;<span class="comment" id="1515990">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516016">sawSpace</span>&nbsp;<span class="op" id="1516025">:=</span>&nbsp;<span class="builtintype" id="1516028">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516036">for</span>&nbsp;<span class="ident" id="1516040">isSpace</span><span class="op" id="1516047">(</span><span class="ident" id="1516048">fmtc</span><span class="op" id="1516052">)</span>&nbsp;<span class="op" id="1516054">&amp;&amp;</span>&nbsp;<span class="ident" id="1516057">i</span>&nbsp;<span class="op" id="1516059">&lt;</span>&nbsp;<span class="builtinfunc" id="1516061">len</span><span class="op" id="1516064">(</span><span class="ident" id="1516065">format</span><span class="op" id="1516071">)</span>&nbsp;<span class="op" id="1516073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516078">sawSpace</span>&nbsp;<span class="op" id="1516087">=</span>&nbsp;<span class="builtintype" id="1516089">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516097">i</span>&nbsp;<span class="op" id="1516099">+=</span>&nbsp;<span class="ident" id="1516102">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516107">fmtc</span><span class="op" id="1516111">,</span>&nbsp;<span class="ident" id="1516113">w</span>&nbsp;<span class="op" id="1516115">=</span>&nbsp;<span class="ident" id="1516117">utf8</span><span class="op" id="1516121">.</span><span class="ident" id="1516122">DecodeRuneInString</span><span class="op" id="1516140">(</span><span class="ident" id="1516141">format</span><span class="op" id="1516147">[</span><span class="ident" id="1516148">i</span><span class="op" id="1516149">:</span><span class="op" id="1516150">]</span><span class="op" id="1516151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516159">if</span>&nbsp;<span class="ident" id="1516162">sawSpace</span>&nbsp;<span class="op" id="1516171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1516176">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1516244">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516264">inputc</span>&nbsp;<span class="op" id="1516271">:=</span>&nbsp;<span class="ident" id="1516274">s</span><span class="op" id="1516275">.</span><span class="ident" id="1516276">getRune</span><span class="op" id="1516283">(</span><span class="op" id="1516284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516289">if</span>&nbsp;<span class="ident" id="1516292">inputc</span>&nbsp;<span class="op" id="1516299">==</span>&nbsp;<span class="ident" id="1516302">eof</span>&nbsp;<span class="op" id="1516306">||</span>&nbsp;<span class="ident" id="1516309">inputc</span>&nbsp;<span class="op" id="1516316">==</span>&nbsp;<span class="string" id="1516319">&#39;\n&#39;</span>&nbsp;<span class="op" id="1516324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1516330">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516393">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516408">if</span>&nbsp;<span class="op" id="1516411">!</span><span class="ident" id="1516412">isSpace</span><span class="op" id="1516419">(</span><span class="ident" id="1516420">inputc</span><span class="op" id="1516426">)</span>&nbsp;<span class="op" id="1516428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1516434">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516481">s</span><span class="op" id="1516482">.</span><span class="ident" id="1516483">errorString</span><span class="op" id="1516494">(</span><span class="string" id="1516495">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="1516536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516541">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516546">s</span><span class="op" id="1516547">.</span><span class="ident" id="1516548">skipSpace</span><span class="op" id="1516557">(</span><span class="builtintype" id="1516558">true</span><span class="op" id="1516562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516567">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516582">inputc</span>&nbsp;<span class="op" id="1516589">:=</span>&nbsp;<span class="ident" id="1516592">s</span><span class="op" id="1516593">.</span><span class="ident" id="1516594">mustReadRune</span><span class="op" id="1516606">(</span><span class="op" id="1516607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516611">if</span>&nbsp;<span class="ident" id="1516614">fmtc</span>&nbsp;<span class="op" id="1516619">!=</span>&nbsp;<span class="ident" id="1516622">inputc</span>&nbsp;<span class="op" id="1516629">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516634">s</span><span class="op" id="1516635">.</span><span class="ident" id="1516636">UnreadRune</span><span class="op" id="1516646">(</span><span class="op" id="1516647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516652">return</span>&nbsp;<span class="op" id="1516659">-</span><span class="num" id="1516660">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516668">i</span>&nbsp;<span class="op" id="1516670">+=</span>&nbsp;<span class="ident" id="1516673">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516676">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516679">return</span><br>
<span class="lineno"></span><span class="op" id="1516686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1516689">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1516755">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="1516815">func</span>&nbsp;<span class="op" id="1516820">(</span><span class="ident" id="1516821">s</span>&nbsp;<span class="op" id="1516823">*</span><span class="ident" id="1516824">ss</span><span class="op" id="1516826">)</span>&nbsp;<span class="ident" id="1516828">doScanf</span><span class="op" id="1516835">(</span><span class="ident" id="1516836">format</span>&nbsp;<span class="builtintype" id="1516843">string</span><span class="op" id="1516849">,</span>&nbsp;<span class="ident" id="1516851">a</span>&nbsp;<span class="op" id="1516853">[</span><span class="op" id="1516854">]</span><span class="keyword" id="1516855">interface</span><span class="op" id="1516864">{</span><span class="op" id="1516865">}</span><span class="op" id="1516866">)</span>&nbsp;<span class="op" id="1516868">(</span><span class="ident" id="1516869">numProcessed</span>&nbsp;<span class="builtintype" id="1516882">int</span><span class="op" id="1516885">,</span>&nbsp;<span class="ident" id="1516887">err</span>&nbsp;<span class="builtintype" id="1516891">error</span><span class="op" id="1516896">)</span>&nbsp;<span class="op" id="1516898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516901">defer</span>&nbsp;<span class="ident" id="1516907">errorHandler</span><span class="op" id="1516919">(</span><span class="op" id="1516920">&amp;</span><span class="ident" id="1516921">err</span><span class="op" id="1516924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516927">end</span>&nbsp;<span class="op" id="1516931">:=</span>&nbsp;<span class="builtinfunc" id="1516934">len</span><span class="op" id="1516937">(</span><span class="ident" id="1516938">format</span><span class="op" id="1516944">)</span>&nbsp;<span class="op" id="1516946">-</span>&nbsp;<span class="num" id="1516948">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1516951">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516998">for</span>&nbsp;<span class="ident" id="1517002">i</span>&nbsp;<span class="op" id="1517004">:=</span>&nbsp;<span class="num" id="1517007">0</span><span class="op" id="1517008">;</span>&nbsp;<span class="ident" id="1517010">i</span>&nbsp;<span class="op" id="1517012">&lt;=</span>&nbsp;<span class="ident" id="1517015">end</span><span class="op" id="1517018">;</span>&nbsp;<span class="op" id="1517020">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517024">w</span>&nbsp;<span class="op" id="1517026">:=</span>&nbsp;<span class="ident" id="1517029">s</span><span class="op" id="1517030">.</span><span class="ident" id="1517031">advance</span><span class="op" id="1517038">(</span><span class="ident" id="1517039">format</span><span class="op" id="1517045">[</span><span class="ident" id="1517046">i</span><span class="op" id="1517047">:</span><span class="op" id="1517048">]</span><span class="op" id="1517049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517053">if</span>&nbsp;<span class="ident" id="1517056">w</span>&nbsp;<span class="op" id="1517058">&gt;</span>&nbsp;<span class="num" id="1517060">0</span>&nbsp;<span class="op" id="1517062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517067">i</span>&nbsp;<span class="op" id="1517069">+=</span>&nbsp;<span class="ident" id="1517072">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517077">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517088">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1517092">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517179">if</span>&nbsp;<span class="ident" id="1517182">format</span><span class="op" id="1517188">[</span><span class="ident" id="1517189">i</span><span class="op" id="1517190">]</span>&nbsp;<span class="op" id="1517192">!=</span>&nbsp;<span class="string" id="1517195">&#39;%&#39;</span>&nbsp;<span class="op" id="1517199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1517204">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517242">if</span>&nbsp;<span class="ident" id="1517245">w</span>&nbsp;<span class="op" id="1517247">&lt;</span>&nbsp;<span class="num" id="1517249">0</span>&nbsp;<span class="op" id="1517251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517257">s</span><span class="op" id="1517258">.</span><span class="ident" id="1517259">errorString</span><span class="op" id="1517270">(</span><span class="string" id="1517271">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="1517300">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1517310">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517374">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517386">i</span><span class="op" id="1517387">++</span>&nbsp;<span class="comment" id="1517390">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1517410">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517438">var</span>&nbsp;<span class="ident" id="1517442">widPresent</span>&nbsp;<span class="builtintype" id="1517453">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517460">s</span><span class="op" id="1517461">.</span><span class="ident" id="1517462">maxWid</span><span class="op" id="1517468">,</span>&nbsp;<span class="ident" id="1517470">widPresent</span><span class="op" id="1517480">,</span>&nbsp;<span class="ident" id="1517482">i</span>&nbsp;<span class="op" id="1517484">=</span>&nbsp;<span class="ident" id="1517486">parsenum</span><span class="op" id="1517494">(</span><span class="ident" id="1517495">format</span><span class="op" id="1517501">,</span>&nbsp;<span class="ident" id="1517503">i</span><span class="op" id="1517504">,</span>&nbsp;<span class="ident" id="1517506">end</span><span class="op" id="1517509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517513">if</span>&nbsp;<span class="op" id="1517516">!</span><span class="ident" id="1517517">widPresent</span>&nbsp;<span class="op" id="1517528">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517533">s</span><span class="op" id="1517534">.</span><span class="ident" id="1517535">maxWid</span>&nbsp;<span class="op" id="1517542">=</span>&nbsp;<span class="ident" id="1517544">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517558">s</span><span class="op" id="1517559">.</span><span class="ident" id="1517560">argLimit</span>&nbsp;<span class="op" id="1517569">=</span>&nbsp;<span class="ident" id="1517571">s</span><span class="op" id="1517572">.</span><span class="ident" id="1517573">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517581">if</span>&nbsp;<span class="ident" id="1517584">f</span>&nbsp;<span class="op" id="1517586">:=</span>&nbsp;<span class="ident" id="1517589">s</span><span class="op" id="1517590">.</span><span class="ident" id="1517591">count</span>&nbsp;<span class="op" id="1517597">+</span>&nbsp;<span class="ident" id="1517599">s</span><span class="op" id="1517600">.</span><span class="ident" id="1517601">maxWid</span><span class="op" id="1517607">;</span>&nbsp;<span class="ident" id="1517609">f</span>&nbsp;<span class="op" id="1517611">&lt;</span>&nbsp;<span class="ident" id="1517613">s</span><span class="op" id="1517614">.</span><span class="ident" id="1517615">argLimit</span>&nbsp;<span class="op" id="1517624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517629">s</span><span class="op" id="1517630">.</span><span class="ident" id="1517631">argLimit</span>&nbsp;<span class="op" id="1517640">=</span>&nbsp;<span class="ident" id="1517642">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517651">c</span><span class="op" id="1517652">,</span>&nbsp;<span class="ident" id="1517654">w</span>&nbsp;<span class="op" id="1517656">:=</span>&nbsp;<span class="ident" id="1517659">utf8</span><span class="op" id="1517663">.</span><span class="ident" id="1517664">DecodeRuneInString</span><span class="op" id="1517682">(</span><span class="ident" id="1517683">format</span><span class="op" id="1517689">[</span><span class="ident" id="1517690">i</span><span class="op" id="1517691">:</span><span class="op" id="1517692">]</span><span class="op" id="1517693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517697">i</span>&nbsp;<span class="op" id="1517699">+=</span>&nbsp;<span class="ident" id="1517702">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517707">if</span>&nbsp;<span class="ident" id="1517710">numProcessed</span>&nbsp;<span class="op" id="1517723">&gt;=</span>&nbsp;<span class="builtinfunc" id="1517726">len</span><span class="op" id="1517729">(</span><span class="ident" id="1517730">a</span><span class="op" id="1517731">)</span>&nbsp;<span class="op" id="1517733">{</span>&nbsp;<span class="comment" id="1517735">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517757">s</span><span class="op" id="1517758">.</span><span class="ident" id="1517759">errorString</span><span class="op" id="1517770">(</span><span class="string" id="1517771">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="1517803">+</span>&nbsp;<span class="ident" id="1517805">format</span><span class="op" id="1517811">[</span><span class="ident" id="1517812">i</span><span class="op" id="1517813">-</span><span class="ident" id="1517814">w</span><span class="op" id="1517815">:</span><span class="op" id="1517816">]</span><span class="op" id="1517817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517822">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517834">arg</span>&nbsp;<span class="op" id="1517838">:=</span>&nbsp;<span class="ident" id="1517841">a</span><span class="op" id="1517842">[</span><span class="ident" id="1517843">numProcessed</span><span class="op" id="1517855">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517860">s</span><span class="op" id="1517861">.</span><span class="ident" id="1517862">scanOne</span><span class="op" id="1517869">(</span><span class="ident" id="1517870">c</span><span class="op" id="1517871">,</span>&nbsp;<span class="ident" id="1517873">arg</span><span class="op" id="1517876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517880">numProcessed</span><span class="op" id="1517892">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517897">s</span><span class="op" id="1517898">.</span><span class="ident" id="1517899">argLimit</span>&nbsp;<span class="op" id="1517908">=</span>&nbsp;<span class="ident" id="1517910">s</span><span class="op" id="1517911">.</span><span class="ident" id="1517912">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517919">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517922">if</span>&nbsp;<span class="ident" id="1517925">numProcessed</span>&nbsp;<span class="op" id="1517938">&lt;</span>&nbsp;<span class="builtinfunc" id="1517940">len</span><span class="op" id="1517943">(</span><span class="ident" id="1517944">a</span><span class="op" id="1517945">)</span>&nbsp;<span class="op" id="1517947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517951">s</span><span class="op" id="1517952">.</span><span class="ident" id="1517953">errorString</span><span class="op" id="1517964">(</span><span class="string" id="1517965">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="1517984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517990">return</span><br>
<span class="lineno"></span><span class="op" id="1517997">}</span>
</div>
</body>
</html>
