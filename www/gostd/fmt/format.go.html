<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html" class="current">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2405213">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2405268">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2405322">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2405373">package</span>&nbsp;<span class="ident" id="2405381">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2405386">import</span>&nbsp;<span class="op" id="2405393">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2405396">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2405404">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2405415">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2405430">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2405433">const</span>&nbsp;<span class="op" id="2405439">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2405442">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2405475">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405522">nByte</span>&nbsp;<span class="op" id="2405528">=</span>&nbsp;<span class="num" id="2405530">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405535">ldigits</span>&nbsp;<span class="op" id="2405543">=</span>&nbsp;<span class="string" id="2405545">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405565">udigits</span>&nbsp;<span class="op" id="2405573">=</span>&nbsp;<span class="string" id="2405575">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2405594">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2405597">const</span>&nbsp;<span class="op" id="2405603">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405606">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2405615">=</span>&nbsp;<span class="builtintype" id="2405617">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405623">unsigned</span>&nbsp;<span class="op" id="2405632">=</span>&nbsp;<span class="builtintype" id="2405634">false</span><br>
<span class="lineno">25</span><span class="op" id="2405640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2405643">var</span>&nbsp;<span class="ident" id="2405647">padZeroBytes</span>&nbsp;<span class="op" id="2405660">=</span>&nbsp;<span class="builtinfunc" id="2405662">make</span><span class="op" id="2405666">(</span><span class="op" id="2405667">[</span><span class="op" id="2405668">]</span><span class="builtintype" id="2405669">byte</span><span class="op" id="2405673">,</span>&nbsp;<span class="ident" id="2405675">nByte</span><span class="op" id="2405680">)</span><br>
<span class="lineno"></span><span class="keyword" id="2405682">var</span>&nbsp;<span class="ident" id="2405686">padSpaceBytes</span>&nbsp;<span class="op" id="2405700">=</span>&nbsp;<span class="builtinfunc" id="2405702">make</span><span class="op" id="2405706">(</span><span class="op" id="2405707">[</span><span class="op" id="2405708">]</span><span class="builtintype" id="2405709">byte</span><span class="op" id="2405713">,</span>&nbsp;<span class="ident" id="2405715">nByte</span><span class="op" id="2405720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2405723">func</span>&nbsp;<span class="ident" id="2405728">init</span><span class="op" id="2405732">(</span><span class="op" id="2405733">)</span>&nbsp;<span class="op" id="2405735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405738">for</span>&nbsp;<span class="ident" id="2405742">i</span>&nbsp;<span class="op" id="2405744">:=</span>&nbsp;<span class="num" id="2405747">0</span><span class="op" id="2405748">;</span>&nbsp;<span class="ident" id="2405750">i</span>&nbsp;<span class="op" id="2405752">&lt;</span>&nbsp;<span class="ident" id="2405754">nByte</span><span class="op" id="2405759">;</span>&nbsp;<span class="ident" id="2405761">i</span><span class="op" id="2405762">++</span>&nbsp;<span class="op" id="2405765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405769">padZeroBytes</span><span class="op" id="2405781">[</span><span class="ident" id="2405782">i</span><span class="op" id="2405783">]</span>&nbsp;<span class="op" id="2405785">=</span>&nbsp;<span class="string" id="2405787">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405793">padSpaceBytes</span><span class="op" id="2405806">[</span><span class="ident" id="2405807">i</span><span class="op" id="2405808">]</span>&nbsp;<span class="op" id="2405810">=</span>&nbsp;<span class="string" id="2405812">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2405817">}</span><br>
<span class="lineno">35</span><span class="op" id="2405819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2405822">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2405878">type</span>&nbsp;<span class="ident" id="2405883">fmtFlags</span>&nbsp;<span class="keyword" id="2405892">struct</span>&nbsp;<span class="op" id="2405899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405902">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2405914">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405920">precPresent</span>&nbsp;<span class="builtintype" id="2405932">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405938">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2405950">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405956">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2405968">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405974">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2405986">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405992">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2406004">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406010">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2406022">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406028">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2406040">bool</span>&nbsp;<span class="comment" id="2406045">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406086">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2406098">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2406105">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2406164">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2406231">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406285">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2406292">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406298">sharpV</span>&nbsp;<span class="builtintype" id="2406305">bool</span><br>
<span class="lineno"></span><span class="op" id="2406310">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2406313">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2406363">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2406422">type</span>&nbsp;<span class="ident" id="2406427">fmt</span>&nbsp;<span class="keyword" id="2406431">struct</span>&nbsp;<span class="op" id="2406438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406441">intbuf</span>&nbsp;<span class="op" id="2406448">[</span><span class="ident" id="2406449">nByte</span><span class="op" id="2406454">]</span><span class="builtintype" id="2406455">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406461">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406468">*</span><span class="ident" id="2406469">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2406477">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406498">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2406503">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406508">prec</span>&nbsp;<span class="builtintype" id="2406513">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406518">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2406527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406530">func</span>&nbsp;<span class="op" id="2406535">(</span><span class="ident" id="2406536">f</span>&nbsp;<span class="op" id="2406538">*</span><span class="ident" id="2406539">fmt</span><span class="op" id="2406542">)</span>&nbsp;<span class="ident" id="2406544">clearflags</span><span class="op" id="2406554">(</span><span class="op" id="2406555">)</span>&nbsp;<span class="op" id="2406557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406560">f</span><span class="op" id="2406561">.</span><span class="ident" id="2406562">fmtFlags</span>&nbsp;<span class="op" id="2406571">=</span>&nbsp;<span class="ident" id="2406573">fmtFlags</span><span class="op" id="2406581">{</span><span class="op" id="2406582">}</span><br>
<span class="lineno"></span><span class="op" id="2406584">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2406587">func</span>&nbsp;<span class="op" id="2406592">(</span><span class="ident" id="2406593">f</span>&nbsp;<span class="op" id="2406595">*</span><span class="ident" id="2406596">fmt</span><span class="op" id="2406599">)</span>&nbsp;<span class="ident" id="2406601">init</span><span class="op" id="2406605">(</span><span class="ident" id="2406606">buf</span>&nbsp;<span class="op" id="2406610">*</span><span class="ident" id="2406611">buffer</span><span class="op" id="2406617">)</span>&nbsp;<span class="op" id="2406619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406622">f</span><span class="op" id="2406623">.</span><span class="ident" id="2406624">buf</span>&nbsp;<span class="op" id="2406628">=</span>&nbsp;<span class="ident" id="2406630">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406635">f</span><span class="op" id="2406636">.</span><span class="ident" id="2406637">clearflags</span><span class="op" id="2406647">(</span><span class="op" id="2406648">)</span><br>
<span class="lineno"></span><span class="op" id="2406650">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2406653">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2406739">func</span>&nbsp;<span class="op" id="2406744">(</span><span class="ident" id="2406745">f</span>&nbsp;<span class="op" id="2406747">*</span><span class="ident" id="2406748">fmt</span><span class="op" id="2406751">)</span>&nbsp;<span class="ident" id="2406753">computePadding</span><span class="op" id="2406767">(</span><span class="ident" id="2406768">width</span>&nbsp;<span class="builtintype" id="2406774">int</span><span class="op" id="2406777">)</span>&nbsp;<span class="op" id="2406779">(</span><span class="ident" id="2406780">padding</span>&nbsp;<span class="op" id="2406788">[</span><span class="op" id="2406789">]</span><span class="builtintype" id="2406790">byte</span><span class="op" id="2406794">,</span>&nbsp;<span class="ident" id="2406796">leftWidth</span><span class="op" id="2406805">,</span>&nbsp;<span class="ident" id="2406807">rightWidth</span>&nbsp;<span class="builtintype" id="2406818">int</span><span class="op" id="2406821">)</span>&nbsp;<span class="op" id="2406823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406826">left</span>&nbsp;<span class="op" id="2406831">:=</span>&nbsp;<span class="op" id="2406834">!</span><span class="ident" id="2406835">f</span><span class="op" id="2406836">.</span><span class="ident" id="2406837">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406844">w</span>&nbsp;<span class="op" id="2406846">:=</span>&nbsp;<span class="ident" id="2406849">f</span><span class="op" id="2406850">.</span><span class="ident" id="2406851">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406856">if</span>&nbsp;<span class="ident" id="2406859">w</span>&nbsp;<span class="op" id="2406861">&lt;</span>&nbsp;<span class="num" id="2406863">0</span>&nbsp;<span class="op" id="2406865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406869">left</span>&nbsp;<span class="op" id="2406874">=</span>&nbsp;<span class="builtintype" id="2406876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406884">w</span>&nbsp;<span class="op" id="2406886">=</span>&nbsp;<span class="op" id="2406888">-</span><span class="ident" id="2406889">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406895">w</span>&nbsp;<span class="op" id="2406897">-=</span>&nbsp;<span class="ident" id="2406900">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406907">if</span>&nbsp;<span class="ident" id="2406910">w</span>&nbsp;<span class="op" id="2406912">&gt;</span>&nbsp;<span class="num" id="2406914">0</span>&nbsp;<span class="op" id="2406916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406920">if</span>&nbsp;<span class="ident" id="2406923">left</span>&nbsp;<span class="op" id="2406928">&amp;&amp;</span>&nbsp;<span class="ident" id="2406931">f</span><span class="op" id="2406932">.</span><span class="ident" id="2406933">zero</span>&nbsp;<span class="op" id="2406938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406943">return</span>&nbsp;<span class="ident" id="2406950">padZeroBytes</span><span class="op" id="2406962">,</span>&nbsp;<span class="ident" id="2406964">w</span><span class="op" id="2406965">,</span>&nbsp;<span class="num" id="2406967">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406975">if</span>&nbsp;<span class="ident" id="2406978">left</span>&nbsp;<span class="op" id="2406983">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406988">return</span>&nbsp;<span class="ident" id="2406995">padSpaceBytes</span><span class="op" id="2407008">,</span>&nbsp;<span class="ident" id="2407010">w</span><span class="op" id="2407011">,</span>&nbsp;<span class="num" id="2407013">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407017">}</span>&nbsp;<span class="keyword" id="2407019">else</span>&nbsp;<span class="op" id="2407024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2407029">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407070">return</span>&nbsp;<span class="ident" id="2407077">padSpaceBytes</span><span class="op" id="2407090">,</span>&nbsp;<span class="num" id="2407092">0</span><span class="op" id="2407093">,</span>&nbsp;<span class="ident" id="2407095">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407099">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407105">return</span><br>
<span class="lineno"></span><span class="op" id="2407112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2407115">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2407161">func</span>&nbsp;<span class="op" id="2407166">(</span><span class="ident" id="2407167">f</span>&nbsp;<span class="op" id="2407169">*</span><span class="ident" id="2407170">fmt</span><span class="op" id="2407173">)</span>&nbsp;<span class="ident" id="2407175">writePadding</span><span class="op" id="2407187">(</span><span class="ident" id="2407188">n</span>&nbsp;<span class="builtintype" id="2407190">int</span><span class="op" id="2407193">,</span>&nbsp;<span class="ident" id="2407195">padding</span>&nbsp;<span class="op" id="2407203">[</span><span class="op" id="2407204">]</span><span class="builtintype" id="2407205">byte</span><span class="op" id="2407209">)</span>&nbsp;<span class="op" id="2407211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407214">for</span>&nbsp;<span class="ident" id="2407218">n</span>&nbsp;<span class="op" id="2407220">&gt;</span>&nbsp;<span class="num" id="2407222">0</span>&nbsp;<span class="op" id="2407224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407228">m</span>&nbsp;<span class="op" id="2407230">:=</span>&nbsp;<span class="ident" id="2407233">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407237">if</span>&nbsp;<span class="ident" id="2407240">m</span>&nbsp;<span class="op" id="2407242">&gt;</span>&nbsp;<span class="ident" id="2407244">nByte</span>&nbsp;<span class="op" id="2407250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407255">m</span>&nbsp;<span class="op" id="2407257">=</span>&nbsp;<span class="ident" id="2407259">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407271">f</span><span class="op" id="2407272">.</span><span class="ident" id="2407273">buf</span><span class="op" id="2407276">.</span><span class="ident" id="2407277">Write</span><span class="op" id="2407282">(</span><span class="ident" id="2407283">padding</span><span class="op" id="2407290">[</span><span class="num" id="2407291">0</span><span class="op" id="2407292">:</span><span class="ident" id="2407293">m</span><span class="op" id="2407294">]</span><span class="op" id="2407295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407299">n</span>&nbsp;<span class="op" id="2407301">-=</span>&nbsp;<span class="ident" id="2407304">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407307">}</span><br>
<span class="lineno"></span><span class="op" id="2407309">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2407312">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2407391">func</span>&nbsp;<span class="op" id="2407396">(</span><span class="ident" id="2407397">f</span>&nbsp;<span class="op" id="2407399">*</span><span class="ident" id="2407400">fmt</span><span class="op" id="2407403">)</span>&nbsp;<span class="ident" id="2407405">pad</span><span class="op" id="2407408">(</span><span class="ident" id="2407409">b</span>&nbsp;<span class="op" id="2407411">[</span><span class="op" id="2407412">]</span><span class="builtintype" id="2407413">byte</span><span class="op" id="2407417">)</span>&nbsp;<span class="op" id="2407419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407422">if</span>&nbsp;<span class="op" id="2407425">!</span><span class="ident" id="2407426">f</span><span class="op" id="2407427">.</span><span class="ident" id="2407428">widPresent</span>&nbsp;<span class="op" id="2407439">||</span>&nbsp;<span class="ident" id="2407442">f</span><span class="op" id="2407443">.</span><span class="ident" id="2407444">wid</span>&nbsp;<span class="op" id="2407448">==</span>&nbsp;<span class="num" id="2407451">0</span>&nbsp;<span class="op" id="2407453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407457">f</span><span class="op" id="2407458">.</span><span class="ident" id="2407459">buf</span><span class="op" id="2407462">.</span><span class="ident" id="2407463">Write</span><span class="op" id="2407468">(</span><span class="ident" id="2407469">b</span><span class="op" id="2407470">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407474">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407485">padding</span><span class="op" id="2407492">,</span>&nbsp;<span class="ident" id="2407494">left</span><span class="op" id="2407498">,</span>&nbsp;<span class="ident" id="2407500">right</span>&nbsp;<span class="op" id="2407506">:=</span>&nbsp;<span class="ident" id="2407509">f</span><span class="op" id="2407510">.</span><span class="ident" id="2407511">computePadding</span><span class="op" id="2407525">(</span><span class="ident" id="2407526">utf8</span><span class="op" id="2407530">.</span><span class="ident" id="2407531">RuneCount</span><span class="op" id="2407540">(</span><span class="ident" id="2407541">b</span><span class="op" id="2407542">)</span><span class="op" id="2407543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407546">if</span>&nbsp;<span class="ident" id="2407549">left</span>&nbsp;<span class="op" id="2407554">&gt;</span>&nbsp;<span class="num" id="2407556">0</span>&nbsp;<span class="op" id="2407558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407562">f</span><span class="op" id="2407563">.</span><span class="ident" id="2407564">writePadding</span><span class="op" id="2407576">(</span><span class="ident" id="2407577">left</span><span class="op" id="2407581">,</span>&nbsp;<span class="ident" id="2407583">padding</span><span class="op" id="2407590">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407596">f</span><span class="op" id="2407597">.</span><span class="ident" id="2407598">buf</span><span class="op" id="2407601">.</span><span class="ident" id="2407602">Write</span><span class="op" id="2407607">(</span><span class="ident" id="2407608">b</span><span class="op" id="2407609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407612">if</span>&nbsp;<span class="ident" id="2407615">right</span>&nbsp;<span class="op" id="2407621">&gt;</span>&nbsp;<span class="num" id="2407623">0</span>&nbsp;<span class="op" id="2407625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407629">f</span><span class="op" id="2407630">.</span><span class="ident" id="2407631">writePadding</span><span class="op" id="2407643">(</span><span class="ident" id="2407644">right</span><span class="op" id="2407649">,</span>&nbsp;<span class="ident" id="2407651">padding</span><span class="op" id="2407658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407661">}</span><br>
<span class="lineno">125</span><span class="op" id="2407663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2407666">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2407749">func</span>&nbsp;<span class="op" id="2407754">(</span><span class="ident" id="2407755">f</span>&nbsp;<span class="op" id="2407757">*</span><span class="ident" id="2407758">fmt</span><span class="op" id="2407761">)</span>&nbsp;<span class="ident" id="2407763">padString</span><span class="op" id="2407772">(</span><span class="ident" id="2407773">s</span>&nbsp;<span class="builtintype" id="2407775">string</span><span class="op" id="2407781">)</span>&nbsp;<span class="op" id="2407783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407786">if</span>&nbsp;<span class="op" id="2407789">!</span><span class="ident" id="2407790">f</span><span class="op" id="2407791">.</span><span class="ident" id="2407792">widPresent</span>&nbsp;<span class="op" id="2407803">||</span>&nbsp;<span class="ident" id="2407806">f</span><span class="op" id="2407807">.</span><span class="ident" id="2407808">wid</span>&nbsp;<span class="op" id="2407812">==</span>&nbsp;<span class="num" id="2407815">0</span>&nbsp;<span class="op" id="2407817">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407821">f</span><span class="op" id="2407822">.</span><span class="ident" id="2407823">buf</span><span class="op" id="2407826">.</span><span class="ident" id="2407827">WriteString</span><span class="op" id="2407838">(</span><span class="ident" id="2407839">s</span><span class="op" id="2407840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407855">padding</span><span class="op" id="2407862">,</span>&nbsp;<span class="ident" id="2407864">left</span><span class="op" id="2407868">,</span>&nbsp;<span class="ident" id="2407870">right</span>&nbsp;<span class="op" id="2407876">:=</span>&nbsp;<span class="ident" id="2407879">f</span><span class="op" id="2407880">.</span><span class="ident" id="2407881">computePadding</span><span class="op" id="2407895">(</span><span class="ident" id="2407896">utf8</span><span class="op" id="2407900">.</span><span class="ident" id="2407901">RuneCountInString</span><span class="op" id="2407918">(</span><span class="ident" id="2407919">s</span><span class="op" id="2407920">)</span><span class="op" id="2407921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407924">if</span>&nbsp;<span class="ident" id="2407927">left</span>&nbsp;<span class="op" id="2407932">&gt;</span>&nbsp;<span class="num" id="2407934">0</span>&nbsp;<span class="op" id="2407936">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407940">f</span><span class="op" id="2407941">.</span><span class="ident" id="2407942">writePadding</span><span class="op" id="2407954">(</span><span class="ident" id="2407955">left</span><span class="op" id="2407959">,</span>&nbsp;<span class="ident" id="2407961">padding</span><span class="op" id="2407968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407974">f</span><span class="op" id="2407975">.</span><span class="ident" id="2407976">buf</span><span class="op" id="2407979">.</span><span class="ident" id="2407980">WriteString</span><span class="op" id="2407991">(</span><span class="ident" id="2407992">s</span><span class="op" id="2407993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407996">if</span>&nbsp;<span class="ident" id="2407999">right</span>&nbsp;<span class="op" id="2408005">&gt;</span>&nbsp;<span class="num" id="2408007">0</span>&nbsp;<span class="op" id="2408009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408013">f</span><span class="op" id="2408014">.</span><span class="ident" id="2408015">writePadding</span><span class="op" id="2408027">(</span><span class="ident" id="2408028">right</span><span class="op" id="2408033">,</span>&nbsp;<span class="ident" id="2408035">padding</span><span class="op" id="2408042">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408045">}</span><br>
<span class="lineno"></span><span class="op" id="2408047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408050">var</span>&nbsp;<span class="op" id="2408054">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408057">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2408068">=</span>&nbsp;<span class="op" id="2408070">[</span><span class="op" id="2408071">]</span><span class="builtintype" id="2408072">byte</span><span class="op" id="2408076">(</span><span class="string" id="2408077">&#34;true&#34;</span><span class="op" id="2408083">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408086">falseBytes</span>&nbsp;<span class="op" id="2408097">=</span>&nbsp;<span class="op" id="2408099">[</span><span class="op" id="2408100">]</span><span class="builtintype" id="2408101">byte</span><span class="op" id="2408105">(</span><span class="string" id="2408106">&#34;false&#34;</span><span class="op" id="2408113">)</span><br>
<span class="lineno"></span><span class="op" id="2408115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2408118">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2408152">func</span>&nbsp;<span class="op" id="2408157">(</span><span class="ident" id="2408158">f</span>&nbsp;<span class="op" id="2408160">*</span><span class="ident" id="2408161">fmt</span><span class="op" id="2408164">)</span>&nbsp;<span class="ident" id="2408166">fmt_boolean</span><span class="op" id="2408177">(</span><span class="ident" id="2408178">v</span>&nbsp;<span class="builtintype" id="2408180">bool</span><span class="op" id="2408184">)</span>&nbsp;<span class="op" id="2408186">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408189">if</span>&nbsp;<span class="ident" id="2408192">v</span>&nbsp;<span class="op" id="2408194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408198">f</span><span class="op" id="2408199">.</span><span class="ident" id="2408200">pad</span><span class="op" id="2408203">(</span><span class="ident" id="2408204">trueBytes</span><span class="op" id="2408213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408216">}</span>&nbsp;<span class="keyword" id="2408218">else</span>&nbsp;<span class="op" id="2408223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408227">f</span><span class="op" id="2408228">.</span><span class="ident" id="2408229">pad</span><span class="op" id="2408232">(</span><span class="ident" id="2408233">falseBytes</span><span class="op" id="2408243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408246">}</span><br>
<span class="lineno">155</span><span class="op" id="2408248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2408251">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2408333">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2408364">func</span>&nbsp;<span class="op" id="2408369">(</span><span class="ident" id="2408370">f</span>&nbsp;<span class="op" id="2408372">*</span><span class="ident" id="2408373">fmt</span><span class="op" id="2408376">)</span>&nbsp;<span class="ident" id="2408378">integer</span><span class="op" id="2408385">(</span><span class="ident" id="2408386">a</span>&nbsp;<span class="ident" id="2408388">int64</span><span class="op" id="2408393">,</span>&nbsp;<span class="ident" id="2408395">base</span>&nbsp;<span class="ident" id="2408400">uint64</span><span class="op" id="2408406">,</span>&nbsp;<span class="ident" id="2408408">signedness</span>&nbsp;<span class="builtintype" id="2408419">bool</span><span class="op" id="2408423">,</span>&nbsp;<span class="ident" id="2408425">digits</span>&nbsp;<span class="builtintype" id="2408432">string</span><span class="op" id="2408438">)</span>&nbsp;<span class="op" id="2408440">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408443">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408499">if</span>&nbsp;<span class="ident" id="2408502">f</span><span class="op" id="2408503">.</span><span class="ident" id="2408504">precPresent</span>&nbsp;<span class="op" id="2408516">&amp;&amp;</span>&nbsp;<span class="ident" id="2408519">f</span><span class="op" id="2408520">.</span><span class="ident" id="2408521">prec</span>&nbsp;<span class="op" id="2408526">==</span>&nbsp;<span class="num" id="2408529">0</span>&nbsp;<span class="op" id="2408531">&amp;&amp;</span>&nbsp;<span class="ident" id="2408534">a</span>&nbsp;<span class="op" id="2408536">==</span>&nbsp;<span class="num" id="2408539">0</span>&nbsp;<span class="op" id="2408541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408545">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408557">var</span>&nbsp;<span class="ident" id="2408561">buf</span>&nbsp;<span class="op" id="2408565">[</span><span class="op" id="2408566">]</span><span class="builtintype" id="2408567">byte</span>&nbsp;<span class="op" id="2408572">=</span>&nbsp;<span class="ident" id="2408574">f</span><span class="op" id="2408575">.</span><span class="ident" id="2408576">intbuf</span><span class="op" id="2408582">[</span><span class="num" id="2408583">0</span><span class="op" id="2408584">:</span><span class="op" id="2408585">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408588">if</span>&nbsp;<span class="ident" id="2408591">f</span><span class="op" id="2408592">.</span><span class="ident" id="2408593">widPresent</span>&nbsp;<span class="op" id="2408604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408608">width</span>&nbsp;<span class="op" id="2408614">:=</span>&nbsp;<span class="ident" id="2408617">f</span><span class="op" id="2408618">.</span><span class="ident" id="2408619">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408625">if</span>&nbsp;<span class="ident" id="2408628">base</span>&nbsp;<span class="op" id="2408633">==</span>&nbsp;<span class="num" id="2408636">16</span>&nbsp;<span class="op" id="2408639">&amp;&amp;</span>&nbsp;<span class="ident" id="2408642">f</span><span class="op" id="2408643">.</span><span class="ident" id="2408644">sharp</span>&nbsp;<span class="op" id="2408650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408655">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408677">width</span>&nbsp;<span class="op" id="2408683">+=</span>&nbsp;<span class="num" id="2408686">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408694">if</span>&nbsp;<span class="ident" id="2408697">width</span>&nbsp;<span class="op" id="2408703">&gt;</span>&nbsp;<span class="ident" id="2408705">nByte</span>&nbsp;<span class="op" id="2408711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408716">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408757">buf</span>&nbsp;<span class="op" id="2408761">=</span>&nbsp;<span class="builtinfunc" id="2408763">make</span><span class="op" id="2408767">(</span><span class="op" id="2408768">[</span><span class="op" id="2408769">]</span><span class="builtintype" id="2408770">byte</span><span class="op" id="2408774">,</span>&nbsp;<span class="ident" id="2408776">width</span><span class="op" id="2408781">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408792">negative</span>&nbsp;<span class="op" id="2408801">:=</span>&nbsp;<span class="ident" id="2408804">signedness</span>&nbsp;<span class="op" id="2408815">==</span>&nbsp;<span class="ident" id="2408818">signed</span>&nbsp;<span class="op" id="2408825">&amp;&amp;</span>&nbsp;<span class="ident" id="2408828">a</span>&nbsp;<span class="op" id="2408830">&lt;</span>&nbsp;<span class="num" id="2408832">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408835">if</span>&nbsp;<span class="ident" id="2408838">negative</span>&nbsp;<span class="op" id="2408847">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408851">a</span>&nbsp;<span class="op" id="2408853">=</span>&nbsp;<span class="op" id="2408855">-</span><span class="ident" id="2408856">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408863">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408928">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408973">prec</span>&nbsp;<span class="op" id="2408978">:=</span>&nbsp;<span class="num" id="2408981">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408984">if</span>&nbsp;<span class="ident" id="2408987">f</span><span class="op" id="2408988">.</span><span class="ident" id="2408989">precPresent</span>&nbsp;<span class="op" id="2409001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409005">prec</span>&nbsp;<span class="op" id="2409010">=</span>&nbsp;<span class="ident" id="2409012">f</span><span class="op" id="2409013">.</span><span class="ident" id="2409014">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409021">f</span><span class="op" id="2409022">.</span><span class="ident" id="2409023">zero</span>&nbsp;<span class="op" id="2409028">=</span>&nbsp;<span class="builtintype" id="2409030">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409037">}</span>&nbsp;<span class="keyword" id="2409039">else</span>&nbsp;<span class="keyword" id="2409044">if</span>&nbsp;<span class="ident" id="2409047">f</span><span class="op" id="2409048">.</span><span class="ident" id="2409049">zero</span>&nbsp;<span class="op" id="2409054">&amp;&amp;</span>&nbsp;<span class="ident" id="2409057">f</span><span class="op" id="2409058">.</span><span class="ident" id="2409059">widPresent</span>&nbsp;<span class="op" id="2409070">&amp;&amp;</span>&nbsp;<span class="op" id="2409073">!</span><span class="ident" id="2409074">f</span><span class="op" id="2409075">.</span><span class="ident" id="2409076">minus</span>&nbsp;<span class="op" id="2409082">&amp;&amp;</span>&nbsp;<span class="ident" id="2409085">f</span><span class="op" id="2409086">.</span><span class="ident" id="2409087">wid</span>&nbsp;<span class="op" id="2409091">&gt;</span>&nbsp;<span class="num" id="2409093">0</span>&nbsp;<span class="op" id="2409095">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409099">prec</span>&nbsp;<span class="op" id="2409104">=</span>&nbsp;<span class="ident" id="2409106">f</span><span class="op" id="2409107">.</span><span class="ident" id="2409108">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409114">if</span>&nbsp;<span class="ident" id="2409117">negative</span>&nbsp;<span class="op" id="2409126">||</span>&nbsp;<span class="ident" id="2409129">f</span><span class="op" id="2409130">.</span><span class="ident" id="2409131">plus</span>&nbsp;<span class="op" id="2409136">||</span>&nbsp;<span class="ident" id="2409139">f</span><span class="op" id="2409140">.</span><span class="ident" id="2409141">space</span>&nbsp;<span class="op" id="2409147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409152">prec</span><span class="op" id="2409156">--</span>&nbsp;<span class="comment" id="2409159">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409187">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2409191">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2409269">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2409323">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2409394">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409459">i</span>&nbsp;<span class="op" id="2409461">:=</span>&nbsp;<span class="builtinfunc" id="2409464">len</span><span class="op" id="2409467">(</span><span class="ident" id="2409468">buf</span><span class="op" id="2409471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409474">ua</span>&nbsp;<span class="op" id="2409477">:=</span>&nbsp;<span class="ident" id="2409480">uint64</span><span class="op" id="2409486">(</span><span class="ident" id="2409487">a</span><span class="op" id="2409488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2409491">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2409562">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409602">switch</span>&nbsp;<span class="ident" id="2409609">base</span>&nbsp;<span class="op" id="2409614">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409617">case</span>&nbsp;<span class="num" id="2409622">10</span><span class="op" id="2409624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409628">for</span>&nbsp;<span class="ident" id="2409632">ua</span>&nbsp;<span class="op" id="2409635">&gt;=</span>&nbsp;<span class="num" id="2409638">10</span>&nbsp;<span class="op" id="2409641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409646">i</span><span class="op" id="2409647">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409653">next</span>&nbsp;<span class="op" id="2409658">:=</span>&nbsp;<span class="ident" id="2409661">ua</span>&nbsp;<span class="op" id="2409664">/</span>&nbsp;<span class="num" id="2409666">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409672">buf</span><span class="op" id="2409675">[</span><span class="ident" id="2409676">i</span><span class="op" id="2409677">]</span>&nbsp;<span class="op" id="2409679">=</span>&nbsp;<span class="builtintype" id="2409681">byte</span><span class="op" id="2409685">(</span><span class="string" id="2409686">&#39;0&#39;</span>&nbsp;<span class="op" id="2409690">+</span>&nbsp;<span class="ident" id="2409692">ua</span>&nbsp;<span class="op" id="2409695">-</span>&nbsp;<span class="ident" id="2409697">next</span><span class="op" id="2409701">*</span><span class="num" id="2409702">10</span><span class="op" id="2409704">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409709">ua</span>&nbsp;<span class="op" id="2409712">=</span>&nbsp;<span class="ident" id="2409714">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409724">case</span>&nbsp;<span class="num" id="2409729">16</span><span class="op" id="2409731">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409735">for</span>&nbsp;<span class="ident" id="2409739">ua</span>&nbsp;<span class="op" id="2409742">&gt;=</span>&nbsp;<span class="num" id="2409745">16</span>&nbsp;<span class="op" id="2409748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409753">i</span><span class="op" id="2409754">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409760">buf</span><span class="op" id="2409763">[</span><span class="ident" id="2409764">i</span><span class="op" id="2409765">]</span>&nbsp;<span class="op" id="2409767">=</span>&nbsp;<span class="ident" id="2409769">digits</span><span class="op" id="2409775">[</span><span class="ident" id="2409776">ua</span><span class="op" id="2409778">&amp;</span><span class="num" id="2409779">0xF</span><span class="op" id="2409782">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409787">ua</span>&nbsp;<span class="op" id="2409790">&gt;&gt;=</span>&nbsp;<span class="num" id="2409794">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409801">case</span>&nbsp;<span class="num" id="2409806">8</span><span class="op" id="2409807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409811">for</span>&nbsp;<span class="ident" id="2409815">ua</span>&nbsp;<span class="op" id="2409818">&gt;=</span>&nbsp;<span class="num" id="2409821">8</span>&nbsp;<span class="op" id="2409823">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409828">i</span><span class="op" id="2409829">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409835">buf</span><span class="op" id="2409838">[</span><span class="ident" id="2409839">i</span><span class="op" id="2409840">]</span>&nbsp;<span class="op" id="2409842">=</span>&nbsp;<span class="builtintype" id="2409844">byte</span><span class="op" id="2409848">(</span><span class="string" id="2409849">&#39;0&#39;</span>&nbsp;<span class="op" id="2409853">+</span>&nbsp;<span class="ident" id="2409855">ua</span><span class="op" id="2409857">&amp;</span><span class="num" id="2409858">7</span><span class="op" id="2409859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409864">ua</span>&nbsp;<span class="op" id="2409867">&gt;&gt;=</span>&nbsp;<span class="num" id="2409871">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409878">case</span>&nbsp;<span class="num" id="2409883">2</span><span class="op" id="2409884">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409888">for</span>&nbsp;<span class="ident" id="2409892">ua</span>&nbsp;<span class="op" id="2409895">&gt;=</span>&nbsp;<span class="num" id="2409898">2</span>&nbsp;<span class="op" id="2409900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409905">i</span><span class="op" id="2409906">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409912">buf</span><span class="op" id="2409915">[</span><span class="ident" id="2409916">i</span><span class="op" id="2409917">]</span>&nbsp;<span class="op" id="2409919">=</span>&nbsp;<span class="builtintype" id="2409921">byte</span><span class="op" id="2409925">(</span><span class="string" id="2409926">&#39;0&#39;</span>&nbsp;<span class="op" id="2409930">+</span>&nbsp;<span class="ident" id="2409932">ua</span><span class="op" id="2409934">&amp;</span><span class="num" id="2409935">1</span><span class="op" id="2409936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409941">ua</span>&nbsp;<span class="op" id="2409944">&gt;&gt;=</span>&nbsp;<span class="num" id="2409948">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409952">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409955">default</span><span class="op" id="2409962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2409966">panic</span><span class="op" id="2409971">(</span><span class="string" id="2409972">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2410005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410011">i</span><span class="op" id="2410012">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410016">buf</span><span class="op" id="2410019">[</span><span class="ident" id="2410020">i</span><span class="op" id="2410021">]</span>&nbsp;<span class="op" id="2410023">=</span>&nbsp;<span class="ident" id="2410025">digits</span><span class="op" id="2410031">[</span><span class="ident" id="2410032">ua</span><span class="op" id="2410034">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410037">for</span>&nbsp;<span class="ident" id="2410041">i</span>&nbsp;<span class="op" id="2410043">&gt;</span>&nbsp;<span class="num" id="2410045">0</span>&nbsp;<span class="op" id="2410047">&amp;&amp;</span>&nbsp;<span class="ident" id="2410050">prec</span>&nbsp;<span class="op" id="2410055">&gt;</span>&nbsp;<span class="builtinfunc" id="2410057">len</span><span class="op" id="2410060">(</span><span class="ident" id="2410061">buf</span><span class="op" id="2410064">)</span><span class="op" id="2410065">-</span><span class="ident" id="2410066">i</span>&nbsp;<span class="op" id="2410068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410072">i</span><span class="op" id="2410073">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410078">buf</span><span class="op" id="2410081">[</span><span class="ident" id="2410082">i</span><span class="op" id="2410083">]</span>&nbsp;<span class="op" id="2410085">=</span>&nbsp;<span class="string" id="2410087">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410096">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410130">if</span>&nbsp;<span class="ident" id="2410133">f</span><span class="op" id="2410134">.</span><span class="ident" id="2410135">sharp</span>&nbsp;<span class="op" id="2410141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410145">switch</span>&nbsp;<span class="ident" id="2410152">base</span>&nbsp;<span class="op" id="2410157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410161">case</span>&nbsp;<span class="num" id="2410166">8</span><span class="op" id="2410167">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410172">if</span>&nbsp;<span class="ident" id="2410175">buf</span><span class="op" id="2410178">[</span><span class="ident" id="2410179">i</span><span class="op" id="2410180">]</span>&nbsp;<span class="op" id="2410182">!=</span>&nbsp;<span class="string" id="2410185">&#39;0&#39;</span>&nbsp;<span class="op" id="2410189">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410195">i</span><span class="op" id="2410196">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410203">buf</span><span class="op" id="2410206">[</span><span class="ident" id="2410207">i</span><span class="op" id="2410208">]</span>&nbsp;<span class="op" id="2410210">=</span>&nbsp;<span class="string" id="2410212">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410223">case</span>&nbsp;<span class="num" id="2410228">16</span><span class="op" id="2410230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410235">i</span><span class="op" id="2410236">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410242">buf</span><span class="op" id="2410245">[</span><span class="ident" id="2410246">i</span><span class="op" id="2410247">]</span>&nbsp;<span class="op" id="2410249">=</span>&nbsp;<span class="string" id="2410251">&#39;x&#39;</span>&nbsp;<span class="op" id="2410255">+</span>&nbsp;<span class="ident" id="2410257">digits</span><span class="op" id="2410263">[</span><span class="num" id="2410264">10</span><span class="op" id="2410266">]</span>&nbsp;<span class="op" id="2410268">-</span>&nbsp;<span class="string" id="2410270">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410277">i</span><span class="op" id="2410278">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410284">buf</span><span class="op" id="2410287">[</span><span class="ident" id="2410288">i</span><span class="op" id="2410289">]</span>&nbsp;<span class="op" id="2410291">=</span>&nbsp;<span class="string" id="2410293">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410302">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410305">if</span>&nbsp;<span class="ident" id="2410308">f</span><span class="op" id="2410309">.</span><span class="ident" id="2410310">unicode</span>&nbsp;<span class="op" id="2410318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410322">i</span><span class="op" id="2410323">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410328">buf</span><span class="op" id="2410331">[</span><span class="ident" id="2410332">i</span><span class="op" id="2410333">]</span>&nbsp;<span class="op" id="2410335">=</span>&nbsp;<span class="string" id="2410337">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410343">i</span><span class="op" id="2410344">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410349">buf</span><span class="op" id="2410352">[</span><span class="ident" id="2410353">i</span><span class="op" id="2410354">]</span>&nbsp;<span class="op" id="2410356">=</span>&nbsp;<span class="string" id="2410358">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410367">if</span>&nbsp;<span class="ident" id="2410370">negative</span>&nbsp;<span class="op" id="2410379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410383">i</span><span class="op" id="2410384">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410389">buf</span><span class="op" id="2410392">[</span><span class="ident" id="2410393">i</span><span class="op" id="2410394">]</span>&nbsp;<span class="op" id="2410396">=</span>&nbsp;<span class="string" id="2410398">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410403">}</span>&nbsp;<span class="keyword" id="2410405">else</span>&nbsp;<span class="keyword" id="2410410">if</span>&nbsp;<span class="ident" id="2410413">f</span><span class="op" id="2410414">.</span><span class="ident" id="2410415">plus</span>&nbsp;<span class="op" id="2410420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410424">i</span><span class="op" id="2410425">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410430">buf</span><span class="op" id="2410433">[</span><span class="ident" id="2410434">i</span><span class="op" id="2410435">]</span>&nbsp;<span class="op" id="2410437">=</span>&nbsp;<span class="string" id="2410439">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410444">}</span>&nbsp;<span class="keyword" id="2410446">else</span>&nbsp;<span class="keyword" id="2410451">if</span>&nbsp;<span class="ident" id="2410454">f</span><span class="op" id="2410455">.</span><span class="ident" id="2410456">space</span>&nbsp;<span class="op" id="2410462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410466">i</span><span class="op" id="2410467">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410472">buf</span><span class="op" id="2410475">[</span><span class="ident" id="2410476">i</span><span class="op" id="2410477">]</span>&nbsp;<span class="op" id="2410479">=</span>&nbsp;<span class="string" id="2410481">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410490">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410559">if</span>&nbsp;<span class="ident" id="2410562">f</span><span class="op" id="2410563">.</span><span class="ident" id="2410564">unicode</span>&nbsp;<span class="op" id="2410572">&amp;&amp;</span>&nbsp;<span class="ident" id="2410575">f</span><span class="op" id="2410576">.</span><span class="ident" id="2410577">uniQuote</span>&nbsp;<span class="op" id="2410586">&amp;&amp;</span>&nbsp;<span class="ident" id="2410589">a</span>&nbsp;<span class="op" id="2410591">&gt;=</span>&nbsp;<span class="num" id="2410594">0</span>&nbsp;<span class="op" id="2410596">&amp;&amp;</span>&nbsp;<span class="ident" id="2410599">a</span>&nbsp;<span class="op" id="2410601">&lt;=</span>&nbsp;<span class="ident" id="2410604">utf8</span><span class="op" id="2410608">.</span><span class="ident" id="2410609">MaxRune</span>&nbsp;<span class="op" id="2410617">&amp;&amp;</span>&nbsp;<span class="ident" id="2410620">strconv</span><span class="op" id="2410627">.</span><span class="ident" id="2410628">IsPrint</span><span class="op" id="2410635">(</span><span class="builtintype" id="2410636">rune</span><span class="op" id="2410640">(</span><span class="ident" id="2410641">a</span><span class="op" id="2410642">)</span><span class="op" id="2410643">)</span>&nbsp;<span class="op" id="2410645">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410649">runeWidth</span>&nbsp;<span class="op" id="2410659">:=</span>&nbsp;<span class="ident" id="2410662">utf8</span><span class="op" id="2410666">.</span><span class="ident" id="2410667">RuneLen</span><span class="op" id="2410674">(</span><span class="builtintype" id="2410675">rune</span><span class="op" id="2410679">(</span><span class="ident" id="2410680">a</span><span class="op" id="2410681">)</span><span class="op" id="2410682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410686">width</span>&nbsp;<span class="op" id="2410692">:=</span>&nbsp;<span class="num" id="2410695">1</span>&nbsp;<span class="op" id="2410697">+</span>&nbsp;<span class="num" id="2410699">1</span>&nbsp;<span class="op" id="2410701">+</span>&nbsp;<span class="ident" id="2410703">runeWidth</span>&nbsp;<span class="op" id="2410713">+</span>&nbsp;<span class="num" id="2410715">1</span>&nbsp;<span class="comment" id="2410717">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2410748">copy</span><span class="op" id="2410752">(</span><span class="ident" id="2410753">buf</span><span class="op" id="2410756">[</span><span class="ident" id="2410757">i</span><span class="op" id="2410758">-</span><span class="ident" id="2410759">width</span><span class="op" id="2410764">:</span><span class="op" id="2410765">]</span><span class="op" id="2410766">,</span>&nbsp;<span class="ident" id="2410768">buf</span><span class="op" id="2410771">[</span><span class="ident" id="2410772">i</span><span class="op" id="2410773">:</span><span class="op" id="2410774">]</span><span class="op" id="2410775">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2410779">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410816">i</span>&nbsp;<span class="op" id="2410818">-=</span>&nbsp;<span class="ident" id="2410821">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410829">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410861">j</span>&nbsp;<span class="op" id="2410863">:=</span>&nbsp;<span class="builtinfunc" id="2410866">len</span><span class="op" id="2410869">(</span><span class="ident" id="2410870">buf</span><span class="op" id="2410873">)</span>&nbsp;<span class="op" id="2410875">-</span>&nbsp;<span class="ident" id="2410877">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410885">buf</span><span class="op" id="2410888">[</span><span class="ident" id="2410889">j</span><span class="op" id="2410890">]</span>&nbsp;<span class="op" id="2410892">=</span>&nbsp;<span class="string" id="2410894">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410900">j</span><span class="op" id="2410901">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410906">buf</span><span class="op" id="2410909">[</span><span class="ident" id="2410910">j</span><span class="op" id="2410911">]</span>&nbsp;<span class="op" id="2410913">=</span>&nbsp;<span class="string" id="2410915">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410922">j</span><span class="op" id="2410923">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410928">utf8</span><span class="op" id="2410932">.</span><span class="ident" id="2410933">EncodeRune</span><span class="op" id="2410943">(</span><span class="ident" id="2410944">buf</span><span class="op" id="2410947">[</span><span class="ident" id="2410948">j</span><span class="op" id="2410949">:</span><span class="op" id="2410950">]</span><span class="op" id="2410951">,</span>&nbsp;<span class="builtintype" id="2410953">rune</span><span class="op" id="2410957">(</span><span class="ident" id="2410958">a</span><span class="op" id="2410959">)</span><span class="op" id="2410960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410964">j</span>&nbsp;<span class="op" id="2410966">+=</span>&nbsp;<span class="ident" id="2410969">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410981">buf</span><span class="op" id="2410984">[</span><span class="ident" id="2410985">j</span><span class="op" id="2410986">]</span>&nbsp;<span class="op" id="2410988">=</span>&nbsp;<span class="string" id="2410990">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411000">f</span><span class="op" id="2411001">.</span><span class="ident" id="2411002">pad</span><span class="op" id="2411005">(</span><span class="ident" id="2411006">buf</span><span class="op" id="2411009">[</span><span class="ident" id="2411010">i</span><span class="op" id="2411011">:</span><span class="op" id="2411012">]</span><span class="op" id="2411013">)</span><br>
<span class="lineno"></span><span class="op" id="2411015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2411018">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2411091">func</span>&nbsp;<span class="op" id="2411096">(</span><span class="ident" id="2411097">f</span>&nbsp;<span class="op" id="2411099">*</span><span class="ident" id="2411100">fmt</span><span class="op" id="2411103">)</span>&nbsp;<span class="ident" id="2411105">truncate</span><span class="op" id="2411113">(</span><span class="ident" id="2411114">s</span>&nbsp;<span class="builtintype" id="2411116">string</span><span class="op" id="2411122">)</span>&nbsp;<span class="builtintype" id="2411124">string</span>&nbsp;<span class="op" id="2411131">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411134">if</span>&nbsp;<span class="ident" id="2411137">f</span><span class="op" id="2411138">.</span><span class="ident" id="2411139">precPresent</span>&nbsp;<span class="op" id="2411151">&amp;&amp;</span>&nbsp;<span class="ident" id="2411154">f</span><span class="op" id="2411155">.</span><span class="ident" id="2411156">prec</span>&nbsp;<span class="op" id="2411161">&lt;</span>&nbsp;<span class="ident" id="2411163">utf8</span><span class="op" id="2411167">.</span><span class="ident" id="2411168">RuneCountInString</span><span class="op" id="2411185">(</span><span class="ident" id="2411186">s</span><span class="op" id="2411187">)</span>&nbsp;<span class="op" id="2411189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411193">n</span>&nbsp;<span class="op" id="2411195">:=</span>&nbsp;<span class="ident" id="2411198">f</span><span class="op" id="2411199">.</span><span class="ident" id="2411200">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411207">for</span>&nbsp;<span class="ident" id="2411211">i</span>&nbsp;<span class="op" id="2411213">:=</span>&nbsp;<span class="keyword" id="2411216">range</span>&nbsp;<span class="ident" id="2411222">s</span>&nbsp;<span class="op" id="2411224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411229">if</span>&nbsp;<span class="ident" id="2411232">n</span>&nbsp;<span class="op" id="2411234">==</span>&nbsp;<span class="num" id="2411237">0</span>&nbsp;<span class="op" id="2411239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411245">s</span>&nbsp;<span class="op" id="2411247">=</span>&nbsp;<span class="ident" id="2411249">s</span><span class="op" id="2411250">[</span><span class="op" id="2411251">:</span><span class="ident" id="2411252">i</span><span class="op" id="2411253">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411259">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411273">n</span><span class="op" id="2411274">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411282">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411285">return</span>&nbsp;<span class="ident" id="2411292">s</span><br>
<span class="lineno"></span><span class="op" id="2411294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2411297">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2411324">func</span>&nbsp;<span class="op" id="2411329">(</span><span class="ident" id="2411330">f</span>&nbsp;<span class="op" id="2411332">*</span><span class="ident" id="2411333">fmt</span><span class="op" id="2411336">)</span>&nbsp;<span class="ident" id="2411338">fmt_s</span><span class="op" id="2411343">(</span><span class="ident" id="2411344">s</span>&nbsp;<span class="builtintype" id="2411346">string</span><span class="op" id="2411352">)</span>&nbsp;<span class="op" id="2411354">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411357">s</span>&nbsp;<span class="op" id="2411359">=</span>&nbsp;<span class="ident" id="2411361">f</span><span class="op" id="2411362">.</span><span class="ident" id="2411363">truncate</span><span class="op" id="2411371">(</span><span class="ident" id="2411372">s</span><span class="op" id="2411373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411376">f</span><span class="op" id="2411377">.</span><span class="ident" id="2411378">padString</span><span class="op" id="2411387">(</span><span class="ident" id="2411388">s</span><span class="op" id="2411389">)</span><br>
<span class="lineno"></span><span class="op" id="2411391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2411394">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2411476">func</span>&nbsp;<span class="op" id="2411481">(</span><span class="ident" id="2411482">f</span>&nbsp;<span class="op" id="2411484">*</span><span class="ident" id="2411485">fmt</span><span class="op" id="2411488">)</span>&nbsp;<span class="ident" id="2411490">fmt_sbx</span><span class="op" id="2411497">(</span><span class="ident" id="2411498">s</span>&nbsp;<span class="builtintype" id="2411500">string</span><span class="op" id="2411506">,</span>&nbsp;<span class="ident" id="2411508">b</span>&nbsp;<span class="op" id="2411510">[</span><span class="op" id="2411511">]</span><span class="builtintype" id="2411512">byte</span><span class="op" id="2411516">,</span>&nbsp;<span class="ident" id="2411518">digits</span>&nbsp;<span class="builtintype" id="2411525">string</span><span class="op" id="2411531">)</span>&nbsp;<span class="op" id="2411533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411536">n</span>&nbsp;<span class="op" id="2411538">:=</span>&nbsp;<span class="builtinfunc" id="2411541">len</span><span class="op" id="2411544">(</span><span class="ident" id="2411545">b</span><span class="op" id="2411546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411549">if</span>&nbsp;<span class="ident" id="2411552">b</span>&nbsp;<span class="op" id="2411554">==</span>&nbsp;<span class="ident" id="2411557">nil</span>&nbsp;<span class="op" id="2411561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411565">n</span>&nbsp;<span class="op" id="2411567">=</span>&nbsp;<span class="builtinfunc" id="2411569">len</span><span class="op" id="2411572">(</span><span class="ident" id="2411573">s</span><span class="op" id="2411574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411577">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411580">x</span>&nbsp;<span class="op" id="2411582">:=</span>&nbsp;<span class="ident" id="2411585">digits</span><span class="op" id="2411591">[</span><span class="num" id="2411592">10</span><span class="op" id="2411594">]</span>&nbsp;<span class="op" id="2411596">-</span>&nbsp;<span class="string" id="2411598">&#39;a&#39;</span>&nbsp;<span class="op" id="2411602">+</span>&nbsp;<span class="string" id="2411604">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2411609">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411648">var</span>&nbsp;<span class="ident" id="2411652">buf</span>&nbsp;<span class="op" id="2411656">[</span><span class="op" id="2411657">]</span><span class="builtintype" id="2411658">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411664">for</span>&nbsp;<span class="ident" id="2411668">i</span>&nbsp;<span class="op" id="2411670">:=</span>&nbsp;<span class="num" id="2411673">0</span><span class="op" id="2411674">;</span>&nbsp;<span class="ident" id="2411676">i</span>&nbsp;<span class="op" id="2411678">&lt;</span>&nbsp;<span class="ident" id="2411680">n</span><span class="op" id="2411681">;</span>&nbsp;<span class="ident" id="2411683">i</span><span class="op" id="2411684">++</span>&nbsp;<span class="op" id="2411687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411691">if</span>&nbsp;<span class="ident" id="2411694">i</span>&nbsp;<span class="op" id="2411696">&gt;</span>&nbsp;<span class="num" id="2411698">0</span>&nbsp;<span class="op" id="2411700">&amp;&amp;</span>&nbsp;<span class="ident" id="2411703">f</span><span class="op" id="2411704">.</span><span class="ident" id="2411705">space</span>&nbsp;<span class="op" id="2411711">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411716">buf</span>&nbsp;<span class="op" id="2411720">=</span>&nbsp;<span class="builtinfunc" id="2411722">append</span><span class="op" id="2411728">(</span><span class="ident" id="2411729">buf</span><span class="op" id="2411732">,</span>&nbsp;<span class="string" id="2411734">&#39;&nbsp;&#39;</span><span class="op" id="2411737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411745">if</span>&nbsp;<span class="ident" id="2411748">f</span><span class="op" id="2411749">.</span><span class="ident" id="2411750">sharp</span>&nbsp;<span class="op" id="2411756">&amp;&amp;</span>&nbsp;<span class="op" id="2411759">(</span><span class="ident" id="2411760">f</span><span class="op" id="2411761">.</span><span class="ident" id="2411762">space</span>&nbsp;<span class="op" id="2411768">||</span>&nbsp;<span class="ident" id="2411771">i</span>&nbsp;<span class="op" id="2411773">==</span>&nbsp;<span class="num" id="2411776">0</span><span class="op" id="2411777">)</span>&nbsp;<span class="op" id="2411779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411784">buf</span>&nbsp;<span class="op" id="2411788">=</span>&nbsp;<span class="builtinfunc" id="2411790">append</span><span class="op" id="2411796">(</span><span class="ident" id="2411797">buf</span><span class="op" id="2411800">,</span>&nbsp;<span class="string" id="2411802">&#39;0&#39;</span><span class="op" id="2411805">,</span>&nbsp;<span class="ident" id="2411807">x</span><span class="op" id="2411808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411812">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411816">var</span>&nbsp;<span class="ident" id="2411820">c</span>&nbsp;<span class="builtintype" id="2411822">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411829">if</span>&nbsp;<span class="ident" id="2411832">b</span>&nbsp;<span class="op" id="2411834">==</span>&nbsp;<span class="ident" id="2411837">nil</span>&nbsp;<span class="op" id="2411841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411846">c</span>&nbsp;<span class="op" id="2411848">=</span>&nbsp;<span class="ident" id="2411850">s</span><span class="op" id="2411851">[</span><span class="ident" id="2411852">i</span><span class="op" id="2411853">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411857">}</span>&nbsp;<span class="keyword" id="2411859">else</span>&nbsp;<span class="op" id="2411864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411869">c</span>&nbsp;<span class="op" id="2411871">=</span>&nbsp;<span class="ident" id="2411873">b</span><span class="op" id="2411874">[</span><span class="ident" id="2411875">i</span><span class="op" id="2411876">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411884">buf</span>&nbsp;<span class="op" id="2411888">=</span>&nbsp;<span class="builtinfunc" id="2411890">append</span><span class="op" id="2411896">(</span><span class="ident" id="2411897">buf</span><span class="op" id="2411900">,</span>&nbsp;<span class="ident" id="2411902">digits</span><span class="op" id="2411908">[</span><span class="ident" id="2411909">c</span><span class="op" id="2411910">&gt;&gt;</span><span class="num" id="2411912">4</span><span class="op" id="2411913">]</span><span class="op" id="2411914">,</span>&nbsp;<span class="ident" id="2411916">digits</span><span class="op" id="2411922">[</span><span class="ident" id="2411923">c</span><span class="op" id="2411924">&amp;</span><span class="num" id="2411925">0xF</span><span class="op" id="2411928">]</span><span class="op" id="2411929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411935">f</span><span class="op" id="2411936">.</span><span class="ident" id="2411937">pad</span><span class="op" id="2411940">(</span><span class="ident" id="2411941">buf</span><span class="op" id="2411944">)</span><br>
<span class="lineno"></span><span class="op" id="2411946">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2411949">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2412016">func</span>&nbsp;<span class="op" id="2412021">(</span><span class="ident" id="2412022">f</span>&nbsp;<span class="op" id="2412024">*</span><span class="ident" id="2412025">fmt</span><span class="op" id="2412028">)</span>&nbsp;<span class="ident" id="2412030">fmt_sx</span><span class="op" id="2412036">(</span><span class="ident" id="2412037">s</span><span class="op" id="2412038">,</span>&nbsp;<span class="ident" id="2412040">digits</span>&nbsp;<span class="builtintype" id="2412047">string</span><span class="op" id="2412053">)</span>&nbsp;<span class="op" id="2412055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412058">if</span>&nbsp;<span class="ident" id="2412061">f</span><span class="op" id="2412062">.</span><span class="ident" id="2412063">precPresent</span>&nbsp;<span class="op" id="2412075">&amp;&amp;</span>&nbsp;<span class="ident" id="2412078">f</span><span class="op" id="2412079">.</span><span class="ident" id="2412080">prec</span>&nbsp;<span class="op" id="2412085">&lt;</span>&nbsp;<span class="builtinfunc" id="2412087">len</span><span class="op" id="2412090">(</span><span class="ident" id="2412091">s</span><span class="op" id="2412092">)</span>&nbsp;<span class="op" id="2412094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412098">s</span>&nbsp;<span class="op" id="2412100">=</span>&nbsp;<span class="ident" id="2412102">s</span><span class="op" id="2412103">[</span><span class="op" id="2412104">:</span><span class="ident" id="2412105">f</span><span class="op" id="2412106">.</span><span class="ident" id="2412107">prec</span><span class="op" id="2412111">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412117">f</span><span class="op" id="2412118">.</span><span class="ident" id="2412119">fmt_sbx</span><span class="op" id="2412126">(</span><span class="ident" id="2412127">s</span><span class="op" id="2412128">,</span>&nbsp;<span class="ident" id="2412130">nil</span><span class="op" id="2412133">,</span>&nbsp;<span class="ident" id="2412135">digits</span><span class="op" id="2412141">)</span><br>
<span class="lineno"></span><span class="op" id="2412143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2412146">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2412217">func</span>&nbsp;<span class="op" id="2412222">(</span><span class="ident" id="2412223">f</span>&nbsp;<span class="op" id="2412225">*</span><span class="ident" id="2412226">fmt</span><span class="op" id="2412229">)</span>&nbsp;<span class="ident" id="2412231">fmt_bx</span><span class="op" id="2412237">(</span><span class="ident" id="2412238">b</span>&nbsp;<span class="op" id="2412240">[</span><span class="op" id="2412241">]</span><span class="builtintype" id="2412242">byte</span><span class="op" id="2412246">,</span>&nbsp;<span class="ident" id="2412248">digits</span>&nbsp;<span class="builtintype" id="2412255">string</span><span class="op" id="2412261">)</span>&nbsp;<span class="op" id="2412263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412266">if</span>&nbsp;<span class="ident" id="2412269">f</span><span class="op" id="2412270">.</span><span class="ident" id="2412271">precPresent</span>&nbsp;<span class="op" id="2412283">&amp;&amp;</span>&nbsp;<span class="ident" id="2412286">f</span><span class="op" id="2412287">.</span><span class="ident" id="2412288">prec</span>&nbsp;<span class="op" id="2412293">&lt;</span>&nbsp;<span class="builtinfunc" id="2412295">len</span><span class="op" id="2412298">(</span><span class="ident" id="2412299">b</span><span class="op" id="2412300">)</span>&nbsp;<span class="op" id="2412302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412306">b</span>&nbsp;<span class="op" id="2412308">=</span>&nbsp;<span class="ident" id="2412310">b</span><span class="op" id="2412311">[</span><span class="op" id="2412312">:</span><span class="ident" id="2412313">f</span><span class="op" id="2412314">.</span><span class="ident" id="2412315">prec</span><span class="op" id="2412319">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412325">f</span><span class="op" id="2412326">.</span><span class="ident" id="2412327">fmt_sbx</span><span class="op" id="2412334">(</span><span class="string" id="2412335">&#34;&#34;</span><span class="op" id="2412337">,</span>&nbsp;<span class="ident" id="2412339">b</span><span class="op" id="2412340">,</span>&nbsp;<span class="ident" id="2412342">digits</span><span class="op" id="2412348">)</span><br>
<span class="lineno">355</span><span class="op" id="2412350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2412353">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2412427">func</span>&nbsp;<span class="op" id="2412432">(</span><span class="ident" id="2412433">f</span>&nbsp;<span class="op" id="2412435">*</span><span class="ident" id="2412436">fmt</span><span class="op" id="2412439">)</span>&nbsp;<span class="ident" id="2412441">fmt_q</span><span class="op" id="2412446">(</span><span class="ident" id="2412447">s</span>&nbsp;<span class="builtintype" id="2412449">string</span><span class="op" id="2412455">)</span>&nbsp;<span class="op" id="2412457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412460">s</span>&nbsp;<span class="op" id="2412462">=</span>&nbsp;<span class="ident" id="2412464">f</span><span class="op" id="2412465">.</span><span class="ident" id="2412466">truncate</span><span class="op" id="2412474">(</span><span class="ident" id="2412475">s</span><span class="op" id="2412476">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412479">var</span>&nbsp;<span class="ident" id="2412483">quoted</span>&nbsp;<span class="builtintype" id="2412490">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412498">if</span>&nbsp;<span class="ident" id="2412501">f</span><span class="op" id="2412502">.</span><span class="ident" id="2412503">sharp</span>&nbsp;<span class="op" id="2412509">&amp;&amp;</span>&nbsp;<span class="ident" id="2412512">strconv</span><span class="op" id="2412519">.</span><span class="ident" id="2412520">CanBackquote</span><span class="op" id="2412532">(</span><span class="ident" id="2412533">s</span><span class="op" id="2412534">)</span>&nbsp;<span class="op" id="2412536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412540">quoted</span>&nbsp;<span class="op" id="2412547">=</span>&nbsp;<span class="string" id="2412549">&#34;`&#34;</span>&nbsp;<span class="op" id="2412553">+</span>&nbsp;<span class="ident" id="2412555">s</span>&nbsp;<span class="op" id="2412557">+</span>&nbsp;<span class="string" id="2412559">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412564">}</span>&nbsp;<span class="keyword" id="2412566">else</span>&nbsp;<span class="op" id="2412571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412575">if</span>&nbsp;<span class="ident" id="2412578">f</span><span class="op" id="2412579">.</span><span class="ident" id="2412580">plus</span>&nbsp;<span class="op" id="2412585">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412590">quoted</span>&nbsp;<span class="op" id="2412597">=</span>&nbsp;<span class="ident" id="2412599">strconv</span><span class="op" id="2412606">.</span><span class="ident" id="2412607">QuoteToASCII</span><span class="op" id="2412619">(</span><span class="ident" id="2412620">s</span><span class="op" id="2412621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412625">}</span>&nbsp;<span class="keyword" id="2412627">else</span>&nbsp;<span class="op" id="2412632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412637">quoted</span>&nbsp;<span class="op" id="2412644">=</span>&nbsp;<span class="ident" id="2412646">strconv</span><span class="op" id="2412653">.</span><span class="ident" id="2412654">Quote</span><span class="op" id="2412659">(</span><span class="ident" id="2412660">s</span><span class="op" id="2412661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412668">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412671">f</span><span class="op" id="2412672">.</span><span class="ident" id="2412673">padString</span><span class="op" id="2412682">(</span><span class="ident" id="2412683">quoted</span><span class="op" id="2412689">)</span><br>
<span class="lineno"></span><span class="op" id="2412691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2412694">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2412775">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2412841">func</span>&nbsp;<span class="op" id="2412846">(</span><span class="ident" id="2412847">f</span>&nbsp;<span class="op" id="2412849">*</span><span class="ident" id="2412850">fmt</span><span class="op" id="2412853">)</span>&nbsp;<span class="ident" id="2412855">fmt_qc</span><span class="op" id="2412861">(</span><span class="ident" id="2412862">c</span>&nbsp;<span class="ident" id="2412864">int64</span><span class="op" id="2412869">)</span>&nbsp;<span class="op" id="2412871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412874">var</span>&nbsp;<span class="ident" id="2412878">quoted</span>&nbsp;<span class="op" id="2412885">[</span><span class="op" id="2412886">]</span><span class="builtintype" id="2412887">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412893">if</span>&nbsp;<span class="ident" id="2412896">f</span><span class="op" id="2412897">.</span><span class="ident" id="2412898">plus</span>&nbsp;<span class="op" id="2412903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412907">quoted</span>&nbsp;<span class="op" id="2412914">=</span>&nbsp;<span class="ident" id="2412916">strconv</span><span class="op" id="2412923">.</span><span class="ident" id="2412924">AppendQuoteRuneToASCII</span><span class="op" id="2412946">(</span><span class="ident" id="2412947">f</span><span class="op" id="2412948">.</span><span class="ident" id="2412949">intbuf</span><span class="op" id="2412955">[</span><span class="num" id="2412956">0</span><span class="op" id="2412957">:</span><span class="num" id="2412958">0</span><span class="op" id="2412959">]</span><span class="op" id="2412960">,</span>&nbsp;<span class="builtintype" id="2412962">rune</span><span class="op" id="2412966">(</span><span class="ident" id="2412967">c</span><span class="op" id="2412968">)</span><span class="op" id="2412969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412972">}</span>&nbsp;<span class="keyword" id="2412974">else</span>&nbsp;<span class="op" id="2412979">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412983">quoted</span>&nbsp;<span class="op" id="2412990">=</span>&nbsp;<span class="ident" id="2412992">strconv</span><span class="op" id="2412999">.</span><span class="ident" id="2413000">AppendQuoteRune</span><span class="op" id="2413015">(</span><span class="ident" id="2413016">f</span><span class="op" id="2413017">.</span><span class="ident" id="2413018">intbuf</span><span class="op" id="2413024">[</span><span class="num" id="2413025">0</span><span class="op" id="2413026">:</span><span class="num" id="2413027">0</span><span class="op" id="2413028">]</span><span class="op" id="2413029">,</span>&nbsp;<span class="builtintype" id="2413031">rune</span><span class="op" id="2413035">(</span><span class="ident" id="2413036">c</span><span class="op" id="2413037">)</span><span class="op" id="2413038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2413041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413044">f</span><span class="op" id="2413045">.</span><span class="ident" id="2413046">pad</span><span class="op" id="2413049">(</span><span class="ident" id="2413050">quoted</span><span class="op" id="2413056">)</span><br>
<span class="lineno"></span><span class="op" id="2413058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2413061">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413080">func</span>&nbsp;<span class="ident" id="2413085">doPrec</span><span class="op" id="2413091">(</span><span class="ident" id="2413092">f</span>&nbsp;<span class="op" id="2413094">*</span><span class="ident" id="2413095">fmt</span><span class="op" id="2413098">,</span>&nbsp;<span class="ident" id="2413100">def</span>&nbsp;<span class="builtintype" id="2413104">int</span><span class="op" id="2413107">)</span>&nbsp;<span class="builtintype" id="2413109">int</span>&nbsp;<span class="op" id="2413113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413116">if</span>&nbsp;<span class="ident" id="2413119">f</span><span class="op" id="2413120">.</span><span class="ident" id="2413121">precPresent</span>&nbsp;<span class="op" id="2413133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413137">return</span>&nbsp;<span class="ident" id="2413144">f</span><span class="op" id="2413145">.</span><span class="ident" id="2413146">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2413152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413155">return</span>&nbsp;<span class="ident" id="2413162">def</span><br>
<span class="lineno"></span><span class="op" id="2413166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2413169">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2413270">func</span>&nbsp;<span class="op" id="2413275">(</span><span class="ident" id="2413276">f</span>&nbsp;<span class="op" id="2413278">*</span><span class="ident" id="2413279">fmt</span><span class="op" id="2413282">)</span>&nbsp;<span class="ident" id="2413284">formatFloat</span><span class="op" id="2413295">(</span><span class="ident" id="2413296">v</span>&nbsp;<span class="builtintype" id="2413298">float64</span><span class="op" id="2413305">,</span>&nbsp;<span class="ident" id="2413307">verb</span>&nbsp;<span class="builtintype" id="2413312">byte</span><span class="op" id="2413316">,</span>&nbsp;<span class="ident" id="2413318">prec</span><span class="op" id="2413322">,</span>&nbsp;<span class="ident" id="2413324">n</span>&nbsp;<span class="builtintype" id="2413326">int</span><span class="op" id="2413329">)</span>&nbsp;<span class="op" id="2413331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2413334">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413399">num</span>&nbsp;<span class="op" id="2413403">:=</span>&nbsp;<span class="ident" id="2413406">strconv</span><span class="op" id="2413413">.</span><span class="ident" id="2413414">AppendFloat</span><span class="op" id="2413425">(</span><span class="ident" id="2413426">f</span><span class="op" id="2413427">.</span><span class="ident" id="2413428">intbuf</span><span class="op" id="2413434">[</span><span class="num" id="2413435">0</span><span class="op" id="2413436">:</span><span class="num" id="2413437">1</span><span class="op" id="2413438">]</span><span class="op" id="2413439">,</span>&nbsp;<span class="ident" id="2413441">v</span><span class="op" id="2413442">,</span>&nbsp;<span class="ident" id="2413444">verb</span><span class="op" id="2413448">,</span>&nbsp;<span class="ident" id="2413450">prec</span><span class="op" id="2413454">,</span>&nbsp;<span class="ident" id="2413456">n</span><span class="op" id="2413457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413460">if</span>&nbsp;<span class="ident" id="2413463">num</span><span class="op" id="2413466">[</span><span class="num" id="2413467">1</span><span class="op" id="2413468">]</span>&nbsp;<span class="op" id="2413470">==</span>&nbsp;<span class="string" id="2413473">&#39;-&#39;</span>&nbsp;<span class="op" id="2413477">||</span>&nbsp;<span class="ident" id="2413480">num</span><span class="op" id="2413483">[</span><span class="num" id="2413484">1</span><span class="op" id="2413485">]</span>&nbsp;<span class="op" id="2413487">==</span>&nbsp;<span class="string" id="2413490">&#39;+&#39;</span>&nbsp;<span class="op" id="2413494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413498">num</span>&nbsp;<span class="op" id="2413502">=</span>&nbsp;<span class="ident" id="2413504">num</span><span class="op" id="2413507">[</span><span class="num" id="2413508">1</span><span class="op" id="2413509">:</span><span class="op" id="2413510">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2413513">}</span>&nbsp;<span class="keyword" id="2413515">else</span>&nbsp;<span class="op" id="2413520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413524">num</span><span class="op" id="2413527">[</span><span class="num" id="2413528">0</span><span class="op" id="2413529">]</span>&nbsp;<span class="op" id="2413531">=</span>&nbsp;<span class="string" id="2413533">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2413538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2413541">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413644">if</span>&nbsp;<span class="ident" id="2413647">math</span><span class="op" id="2413651">.</span><span class="ident" id="2413652">IsInf</span><span class="op" id="2413657">(</span><span class="ident" id="2413658">v</span><span class="op" id="2413659">,</span>&nbsp;<span class="num" id="2413661">0</span><span class="op" id="2413662">)</span>&nbsp;<span class="op" id="2413664">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413668">if</span>&nbsp;<span class="ident" id="2413671">f</span><span class="op" id="2413672">.</span><span class="ident" id="2413673">zero</span>&nbsp;<span class="op" id="2413678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413683">defer</span>&nbsp;<span class="keyword" id="2413689">func</span><span class="op" id="2413693">(</span><span class="op" id="2413694">)</span>&nbsp;<span class="op" id="2413696">{</span>&nbsp;<span class="ident" id="2413698">f</span><span class="op" id="2413699">.</span><span class="ident" id="2413700">zero</span>&nbsp;<span class="op" id="2413705">=</span>&nbsp;<span class="builtintype" id="2413707">true</span>&nbsp;<span class="op" id="2413712">}</span><span class="op" id="2413713">(</span><span class="op" id="2413714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413719">f</span><span class="op" id="2413720">.</span><span class="ident" id="2413721">zero</span>&nbsp;<span class="op" id="2413726">=</span>&nbsp;<span class="builtintype" id="2413728">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2413736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2413739">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2413742">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2413789">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2413856">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413935">if</span>&nbsp;<span class="ident" id="2413938">f</span><span class="op" id="2413939">.</span><span class="ident" id="2413940">zero</span>&nbsp;<span class="op" id="2413945">&amp;&amp;</span>&nbsp;<span class="ident" id="2413948">f</span><span class="op" id="2413949">.</span><span class="ident" id="2413950">widPresent</span>&nbsp;<span class="op" id="2413961">&amp;&amp;</span>&nbsp;<span class="ident" id="2413964">f</span><span class="op" id="2413965">.</span><span class="ident" id="2413966">wid</span>&nbsp;<span class="op" id="2413970">&gt;</span>&nbsp;<span class="builtinfunc" id="2413972">len</span><span class="op" id="2413975">(</span><span class="ident" id="2413976">num</span><span class="op" id="2413979">)</span>&nbsp;<span class="op" id="2413981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413985">if</span>&nbsp;<span class="ident" id="2413988">f</span><span class="op" id="2413989">.</span><span class="ident" id="2413990">space</span>&nbsp;<span class="op" id="2413996">&amp;&amp;</span>&nbsp;<span class="ident" id="2413999">v</span>&nbsp;<span class="op" id="2414001">&gt;=</span>&nbsp;<span class="num" id="2414004">0</span>&nbsp;<span class="op" id="2414006">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414011">f</span><span class="op" id="2414012">.</span><span class="ident" id="2414013">buf</span><span class="op" id="2414016">.</span><span class="ident" id="2414017">WriteByte</span><span class="op" id="2414026">(</span><span class="string" id="2414027">&#39;&nbsp;&#39;</span><span class="op" id="2414030">)</span>&nbsp;<span class="comment" id="2414032">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414096">f</span><span class="op" id="2414097">.</span><span class="ident" id="2414098">wid</span><span class="op" id="2414101">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414106">}</span>&nbsp;<span class="keyword" id="2414108">else</span>&nbsp;<span class="keyword" id="2414113">if</span>&nbsp;<span class="ident" id="2414116">f</span><span class="op" id="2414117">.</span><span class="ident" id="2414118">plus</span>&nbsp;<span class="op" id="2414123">||</span>&nbsp;<span class="ident" id="2414126">v</span>&nbsp;<span class="op" id="2414128">&lt;</span>&nbsp;<span class="num" id="2414130">0</span>&nbsp;<span class="op" id="2414132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414137">f</span><span class="op" id="2414138">.</span><span class="ident" id="2414139">buf</span><span class="op" id="2414142">.</span><span class="ident" id="2414143">WriteByte</span><span class="op" id="2414152">(</span><span class="ident" id="2414153">num</span><span class="op" id="2414156">[</span><span class="num" id="2414157">0</span><span class="op" id="2414158">]</span><span class="op" id="2414159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414164">f</span><span class="op" id="2414165">.</span><span class="ident" id="2414166">wid</span><span class="op" id="2414169">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414178">f</span><span class="op" id="2414179">.</span><span class="ident" id="2414180">pad</span><span class="op" id="2414183">(</span><span class="ident" id="2414184">num</span><span class="op" id="2414187">[</span><span class="num" id="2414188">1</span><span class="op" id="2414189">:</span><span class="op" id="2414190">]</span><span class="op" id="2414191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414195">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414206">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414260">if</span>&nbsp;<span class="ident" id="2414263">f</span><span class="op" id="2414264">.</span><span class="ident" id="2414265">space</span>&nbsp;<span class="op" id="2414271">&amp;&amp;</span>&nbsp;<span class="ident" id="2414274">num</span><span class="op" id="2414277">[</span><span class="num" id="2414278">0</span><span class="op" id="2414279">]</span>&nbsp;<span class="op" id="2414281">==</span>&nbsp;<span class="string" id="2414284">&#39;+&#39;</span>&nbsp;<span class="op" id="2414288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414292">num</span><span class="op" id="2414295">[</span><span class="num" id="2414296">0</span><span class="op" id="2414297">]</span>&nbsp;<span class="op" id="2414299">=</span>&nbsp;<span class="string" id="2414301">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414307">f</span><span class="op" id="2414308">.</span><span class="ident" id="2414309">pad</span><span class="op" id="2414312">(</span><span class="ident" id="2414313">num</span><span class="op" id="2414316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414320">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414328">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414331">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414411">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414499">if</span>&nbsp;<span class="ident" id="2414502">f</span><span class="op" id="2414503">.</span><span class="ident" id="2414504">plus</span>&nbsp;<span class="op" id="2414509">||</span>&nbsp;<span class="ident" id="2414512">num</span><span class="op" id="2414515">[</span><span class="num" id="2414516">0</span><span class="op" id="2414517">]</span>&nbsp;<span class="op" id="2414519">==</span>&nbsp;<span class="string" id="2414522">&#39;-&#39;</span>&nbsp;<span class="op" id="2414526">||</span>&nbsp;<span class="ident" id="2414529">math</span><span class="op" id="2414533">.</span><span class="ident" id="2414534">IsInf</span><span class="op" id="2414539">(</span><span class="ident" id="2414540">v</span><span class="op" id="2414541">,</span>&nbsp;<span class="num" id="2414543">0</span><span class="op" id="2414544">)</span>&nbsp;<span class="op" id="2414546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414550">f</span><span class="op" id="2414551">.</span><span class="ident" id="2414552">pad</span><span class="op" id="2414555">(</span><span class="ident" id="2414556">num</span><span class="op" id="2414559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414563">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414574">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414654">f</span><span class="op" id="2414655">.</span><span class="ident" id="2414656">pad</span><span class="op" id="2414659">(</span><span class="ident" id="2414660">num</span><span class="op" id="2414663">[</span><span class="num" id="2414664">1</span><span class="op" id="2414665">:</span><span class="op" id="2414666">]</span><span class="op" id="2414667">)</span><br>
<span class="lineno"></span><span class="op" id="2414669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2414672">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2414724">func</span>&nbsp;<span class="op" id="2414729">(</span><span class="ident" id="2414730">f</span>&nbsp;<span class="op" id="2414732">*</span><span class="ident" id="2414733">fmt</span><span class="op" id="2414736">)</span>&nbsp;<span class="ident" id="2414738">fmt_e64</span><span class="op" id="2414745">(</span><span class="ident" id="2414746">v</span>&nbsp;<span class="builtintype" id="2414748">float64</span><span class="op" id="2414755">)</span>&nbsp;<span class="op" id="2414757">{</span>&nbsp;<span class="ident" id="2414759">f</span><span class="op" id="2414760">.</span><span class="ident" id="2414761">formatFloat</span><span class="op" id="2414772">(</span><span class="ident" id="2414773">v</span><span class="op" id="2414774">,</span>&nbsp;<span class="string" id="2414776">&#39;e&#39;</span><span class="op" id="2414779">,</span>&nbsp;<span class="ident" id="2414781">doPrec</span><span class="op" id="2414787">(</span><span class="ident" id="2414788">f</span><span class="op" id="2414789">,</span>&nbsp;<span class="num" id="2414791">6</span><span class="op" id="2414792">)</span><span class="op" id="2414793">,</span>&nbsp;<span class="num" id="2414795">64</span><span class="op" id="2414797">)</span>&nbsp;<span class="op" id="2414799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2414802">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2414854">func</span>&nbsp;<span class="op" id="2414859">(</span><span class="ident" id="2414860">f</span>&nbsp;<span class="op" id="2414862">*</span><span class="ident" id="2414863">fmt</span><span class="op" id="2414866">)</span>&nbsp;<span class="ident" id="2414868">fmt_E64</span><span class="op" id="2414875">(</span><span class="ident" id="2414876">v</span>&nbsp;<span class="builtintype" id="2414878">float64</span><span class="op" id="2414885">)</span>&nbsp;<span class="op" id="2414887">{</span>&nbsp;<span class="ident" id="2414889">f</span><span class="op" id="2414890">.</span><span class="ident" id="2414891">formatFloat</span><span class="op" id="2414902">(</span><span class="ident" id="2414903">v</span><span class="op" id="2414904">,</span>&nbsp;<span class="string" id="2414906">&#39;E&#39;</span><span class="op" id="2414909">,</span>&nbsp;<span class="ident" id="2414911">doPrec</span><span class="op" id="2414917">(</span><span class="ident" id="2414918">f</span><span class="op" id="2414919">,</span>&nbsp;<span class="num" id="2414921">6</span><span class="op" id="2414922">)</span><span class="op" id="2414923">,</span>&nbsp;<span class="num" id="2414925">64</span><span class="op" id="2414927">)</span>&nbsp;<span class="op" id="2414929">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2414932">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2414980">func</span>&nbsp;<span class="op" id="2414985">(</span><span class="ident" id="2414986">f</span>&nbsp;<span class="op" id="2414988">*</span><span class="ident" id="2414989">fmt</span><span class="op" id="2414992">)</span>&nbsp;<span class="ident" id="2414994">fmt_f64</span><span class="op" id="2415001">(</span><span class="ident" id="2415002">v</span>&nbsp;<span class="builtintype" id="2415004">float64</span><span class="op" id="2415011">)</span>&nbsp;<span class="op" id="2415013">{</span>&nbsp;<span class="ident" id="2415015">f</span><span class="op" id="2415016">.</span><span class="ident" id="2415017">formatFloat</span><span class="op" id="2415028">(</span><span class="ident" id="2415029">v</span><span class="op" id="2415030">,</span>&nbsp;<span class="string" id="2415032">&#39;f&#39;</span><span class="op" id="2415035">,</span>&nbsp;<span class="ident" id="2415037">doPrec</span><span class="op" id="2415043">(</span><span class="ident" id="2415044">f</span><span class="op" id="2415045">,</span>&nbsp;<span class="num" id="2415047">6</span><span class="op" id="2415048">)</span><span class="op" id="2415049">,</span>&nbsp;<span class="num" id="2415051">64</span><span class="op" id="2415053">)</span>&nbsp;<span class="op" id="2415055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2415058">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2415129">func</span>&nbsp;<span class="op" id="2415134">(</span><span class="ident" id="2415135">f</span>&nbsp;<span class="op" id="2415137">*</span><span class="ident" id="2415138">fmt</span><span class="op" id="2415141">)</span>&nbsp;<span class="ident" id="2415143">fmt_g64</span><span class="op" id="2415150">(</span><span class="ident" id="2415151">v</span>&nbsp;<span class="builtintype" id="2415153">float64</span><span class="op" id="2415160">)</span>&nbsp;<span class="op" id="2415162">{</span>&nbsp;<span class="ident" id="2415164">f</span><span class="op" id="2415165">.</span><span class="ident" id="2415166">formatFloat</span><span class="op" id="2415177">(</span><span class="ident" id="2415178">v</span><span class="op" id="2415179">,</span>&nbsp;<span class="string" id="2415181">&#39;g&#39;</span><span class="op" id="2415184">,</span>&nbsp;<span class="ident" id="2415186">doPrec</span><span class="op" id="2415192">(</span><span class="ident" id="2415193">f</span><span class="op" id="2415194">,</span>&nbsp;<span class="op" id="2415196">-</span><span class="num" id="2415197">1</span><span class="op" id="2415198">)</span><span class="op" id="2415199">,</span>&nbsp;<span class="num" id="2415201">64</span><span class="op" id="2415203">)</span>&nbsp;<span class="op" id="2415205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2415208">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2415279">func</span>&nbsp;<span class="op" id="2415284">(</span><span class="ident" id="2415285">f</span>&nbsp;<span class="op" id="2415287">*</span><span class="ident" id="2415288">fmt</span><span class="op" id="2415291">)</span>&nbsp;<span class="ident" id="2415293">fmt_G64</span><span class="op" id="2415300">(</span><span class="ident" id="2415301">v</span>&nbsp;<span class="builtintype" id="2415303">float64</span><span class="op" id="2415310">)</span>&nbsp;<span class="op" id="2415312">{</span>&nbsp;<span class="ident" id="2415314">f</span><span class="op" id="2415315">.</span><span class="ident" id="2415316">formatFloat</span><span class="op" id="2415327">(</span><span class="ident" id="2415328">v</span><span class="op" id="2415329">,</span>&nbsp;<span class="string" id="2415331">&#39;G&#39;</span><span class="op" id="2415334">,</span>&nbsp;<span class="ident" id="2415336">doPrec</span><span class="op" id="2415342">(</span><span class="ident" id="2415343">f</span><span class="op" id="2415344">,</span>&nbsp;<span class="op" id="2415346">-</span><span class="num" id="2415347">1</span><span class="op" id="2415348">)</span><span class="op" id="2415349">,</span>&nbsp;<span class="num" id="2415351">64</span><span class="op" id="2415353">)</span>&nbsp;<span class="op" id="2415355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2415358">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2415433">func</span>&nbsp;<span class="op" id="2415438">(</span><span class="ident" id="2415439">f</span>&nbsp;<span class="op" id="2415441">*</span><span class="ident" id="2415442">fmt</span><span class="op" id="2415445">)</span>&nbsp;<span class="ident" id="2415447">fmt_fb64</span><span class="op" id="2415455">(</span><span class="ident" id="2415456">v</span>&nbsp;<span class="builtintype" id="2415458">float64</span><span class="op" id="2415465">)</span>&nbsp;<span class="op" id="2415467">{</span>&nbsp;<span class="ident" id="2415469">f</span><span class="op" id="2415470">.</span><span class="ident" id="2415471">formatFloat</span><span class="op" id="2415482">(</span><span class="ident" id="2415483">v</span><span class="op" id="2415484">,</span>&nbsp;<span class="string" id="2415486">&#39;b&#39;</span><span class="op" id="2415489">,</span>&nbsp;<span class="num" id="2415491">0</span><span class="op" id="2415492">,</span>&nbsp;<span class="num" id="2415494">64</span><span class="op" id="2415496">)</span>&nbsp;<span class="op" id="2415498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2415501">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2415512">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2415548">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2415604">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2415656">func</span>&nbsp;<span class="op" id="2415661">(</span><span class="ident" id="2415662">f</span>&nbsp;<span class="op" id="2415664">*</span><span class="ident" id="2415665">fmt</span><span class="op" id="2415668">)</span>&nbsp;<span class="ident" id="2415670">fmt_e32</span><span class="op" id="2415677">(</span><span class="ident" id="2415678">v</span>&nbsp;<span class="builtintype" id="2415680">float32</span><span class="op" id="2415687">)</span>&nbsp;<span class="op" id="2415689">{</span>&nbsp;<span class="ident" id="2415691">f</span><span class="op" id="2415692">.</span><span class="ident" id="2415693">formatFloat</span><span class="op" id="2415704">(</span><span class="builtintype" id="2415705">float64</span><span class="op" id="2415712">(</span><span class="ident" id="2415713">v</span><span class="op" id="2415714">)</span><span class="op" id="2415715">,</span>&nbsp;<span class="string" id="2415717">&#39;e&#39;</span><span class="op" id="2415720">,</span>&nbsp;<span class="ident" id="2415722">doPrec</span><span class="op" id="2415728">(</span><span class="ident" id="2415729">f</span><span class="op" id="2415730">,</span>&nbsp;<span class="num" id="2415732">6</span><span class="op" id="2415733">)</span><span class="op" id="2415734">,</span>&nbsp;<span class="num" id="2415736">32</span><span class="op" id="2415738">)</span>&nbsp;<span class="op" id="2415740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2415743">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2415795">func</span>&nbsp;<span class="op" id="2415800">(</span><span class="ident" id="2415801">f</span>&nbsp;<span class="op" id="2415803">*</span><span class="ident" id="2415804">fmt</span><span class="op" id="2415807">)</span>&nbsp;<span class="ident" id="2415809">fmt_E32</span><span class="op" id="2415816">(</span><span class="ident" id="2415817">v</span>&nbsp;<span class="builtintype" id="2415819">float32</span><span class="op" id="2415826">)</span>&nbsp;<span class="op" id="2415828">{</span>&nbsp;<span class="ident" id="2415830">f</span><span class="op" id="2415831">.</span><span class="ident" id="2415832">formatFloat</span><span class="op" id="2415843">(</span><span class="builtintype" id="2415844">float64</span><span class="op" id="2415851">(</span><span class="ident" id="2415852">v</span><span class="op" id="2415853">)</span><span class="op" id="2415854">,</span>&nbsp;<span class="string" id="2415856">&#39;E&#39;</span><span class="op" id="2415859">,</span>&nbsp;<span class="ident" id="2415861">doPrec</span><span class="op" id="2415867">(</span><span class="ident" id="2415868">f</span><span class="op" id="2415869">,</span>&nbsp;<span class="num" id="2415871">6</span><span class="op" id="2415872">)</span><span class="op" id="2415873">,</span>&nbsp;<span class="num" id="2415875">32</span><span class="op" id="2415877">)</span>&nbsp;<span class="op" id="2415879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2415882">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2415930">func</span>&nbsp;<span class="op" id="2415935">(</span><span class="ident" id="2415936">f</span>&nbsp;<span class="op" id="2415938">*</span><span class="ident" id="2415939">fmt</span><span class="op" id="2415942">)</span>&nbsp;<span class="ident" id="2415944">fmt_f32</span><span class="op" id="2415951">(</span><span class="ident" id="2415952">v</span>&nbsp;<span class="builtintype" id="2415954">float32</span><span class="op" id="2415961">)</span>&nbsp;<span class="op" id="2415963">{</span>&nbsp;<span class="ident" id="2415965">f</span><span class="op" id="2415966">.</span><span class="ident" id="2415967">formatFloat</span><span class="op" id="2415978">(</span><span class="builtintype" id="2415979">float64</span><span class="op" id="2415986">(</span><span class="ident" id="2415987">v</span><span class="op" id="2415988">)</span><span class="op" id="2415989">,</span>&nbsp;<span class="string" id="2415991">&#39;f&#39;</span><span class="op" id="2415994">,</span>&nbsp;<span class="ident" id="2415996">doPrec</span><span class="op" id="2416002">(</span><span class="ident" id="2416003">f</span><span class="op" id="2416004">,</span>&nbsp;<span class="num" id="2416006">6</span><span class="op" id="2416007">)</span><span class="op" id="2416008">,</span>&nbsp;<span class="num" id="2416010">32</span><span class="op" id="2416012">)</span>&nbsp;<span class="op" id="2416014">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2416017">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2416088">func</span>&nbsp;<span class="op" id="2416093">(</span><span class="ident" id="2416094">f</span>&nbsp;<span class="op" id="2416096">*</span><span class="ident" id="2416097">fmt</span><span class="op" id="2416100">)</span>&nbsp;<span class="ident" id="2416102">fmt_g32</span><span class="op" id="2416109">(</span><span class="ident" id="2416110">v</span>&nbsp;<span class="builtintype" id="2416112">float32</span><span class="op" id="2416119">)</span>&nbsp;<span class="op" id="2416121">{</span>&nbsp;<span class="ident" id="2416123">f</span><span class="op" id="2416124">.</span><span class="ident" id="2416125">formatFloat</span><span class="op" id="2416136">(</span><span class="builtintype" id="2416137">float64</span><span class="op" id="2416144">(</span><span class="ident" id="2416145">v</span><span class="op" id="2416146">)</span><span class="op" id="2416147">,</span>&nbsp;<span class="string" id="2416149">&#39;g&#39;</span><span class="op" id="2416152">,</span>&nbsp;<span class="ident" id="2416154">doPrec</span><span class="op" id="2416160">(</span><span class="ident" id="2416161">f</span><span class="op" id="2416162">,</span>&nbsp;<span class="op" id="2416164">-</span><span class="num" id="2416165">1</span><span class="op" id="2416166">)</span><span class="op" id="2416167">,</span>&nbsp;<span class="num" id="2416169">32</span><span class="op" id="2416171">)</span>&nbsp;<span class="op" id="2416173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2416176">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2416247">func</span>&nbsp;<span class="op" id="2416252">(</span><span class="ident" id="2416253">f</span>&nbsp;<span class="op" id="2416255">*</span><span class="ident" id="2416256">fmt</span><span class="op" id="2416259">)</span>&nbsp;<span class="ident" id="2416261">fmt_G32</span><span class="op" id="2416268">(</span><span class="ident" id="2416269">v</span>&nbsp;<span class="builtintype" id="2416271">float32</span><span class="op" id="2416278">)</span>&nbsp;<span class="op" id="2416280">{</span>&nbsp;<span class="ident" id="2416282">f</span><span class="op" id="2416283">.</span><span class="ident" id="2416284">formatFloat</span><span class="op" id="2416295">(</span><span class="builtintype" id="2416296">float64</span><span class="op" id="2416303">(</span><span class="ident" id="2416304">v</span><span class="op" id="2416305">)</span><span class="op" id="2416306">,</span>&nbsp;<span class="string" id="2416308">&#39;G&#39;</span><span class="op" id="2416311">,</span>&nbsp;<span class="ident" id="2416313">doPrec</span><span class="op" id="2416319">(</span><span class="ident" id="2416320">f</span><span class="op" id="2416321">,</span>&nbsp;<span class="op" id="2416323">-</span><span class="num" id="2416324">1</span><span class="op" id="2416325">)</span><span class="op" id="2416326">,</span>&nbsp;<span class="num" id="2416328">32</span><span class="op" id="2416330">)</span>&nbsp;<span class="op" id="2416332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2416335">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2416410">func</span>&nbsp;<span class="op" id="2416415">(</span><span class="ident" id="2416416">f</span>&nbsp;<span class="op" id="2416418">*</span><span class="ident" id="2416419">fmt</span><span class="op" id="2416422">)</span>&nbsp;<span class="ident" id="2416424">fmt_fb32</span><span class="op" id="2416432">(</span><span class="ident" id="2416433">v</span>&nbsp;<span class="builtintype" id="2416435">float32</span><span class="op" id="2416442">)</span>&nbsp;<span class="op" id="2416444">{</span>&nbsp;<span class="ident" id="2416446">f</span><span class="op" id="2416447">.</span><span class="ident" id="2416448">formatFloat</span><span class="op" id="2416459">(</span><span class="builtintype" id="2416460">float64</span><span class="op" id="2416467">(</span><span class="ident" id="2416468">v</span><span class="op" id="2416469">)</span><span class="op" id="2416470">,</span>&nbsp;<span class="string" id="2416472">&#39;b&#39;</span><span class="op" id="2416475">,</span>&nbsp;<span class="num" id="2416477">0</span><span class="op" id="2416478">,</span>&nbsp;<span class="num" id="2416480">32</span><span class="op" id="2416482">)</span>&nbsp;<span class="op" id="2416484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2416487">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2416541">func</span>&nbsp;<span class="op" id="2416546">(</span><span class="ident" id="2416547">f</span>&nbsp;<span class="op" id="2416549">*</span><span class="ident" id="2416550">fmt</span><span class="op" id="2416553">)</span>&nbsp;<span class="ident" id="2416555">fmt_c64</span><span class="op" id="2416562">(</span><span class="ident" id="2416563">v</span>&nbsp;<span class="builtintype" id="2416565">complex64</span><span class="op" id="2416574">,</span>&nbsp;<span class="ident" id="2416576">verb</span>&nbsp;<span class="builtintype" id="2416581">rune</span><span class="op" id="2416585">)</span>&nbsp;<span class="op" id="2416587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416590">f</span><span class="op" id="2416591">.</span><span class="ident" id="2416592">fmt_complex</span><span class="op" id="2416603">(</span><span class="builtintype" id="2416604">float64</span><span class="op" id="2416611">(</span><span class="builtinfunc" id="2416612">real</span><span class="op" id="2416616">(</span><span class="ident" id="2416617">v</span><span class="op" id="2416618">)</span><span class="op" id="2416619">)</span><span class="op" id="2416620">,</span>&nbsp;<span class="builtintype" id="2416622">float64</span><span class="op" id="2416629">(</span><span class="builtinfunc" id="2416630">imag</span><span class="op" id="2416634">(</span><span class="ident" id="2416635">v</span><span class="op" id="2416636">)</span><span class="op" id="2416637">)</span><span class="op" id="2416638">,</span>&nbsp;<span class="num" id="2416640">32</span><span class="op" id="2416642">,</span>&nbsp;<span class="ident" id="2416644">verb</span><span class="op" id="2416648">)</span><br>
<span class="lineno"></span><span class="op" id="2416650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2416653">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2416709">func</span>&nbsp;<span class="op" id="2416714">(</span><span class="ident" id="2416715">f</span>&nbsp;<span class="op" id="2416717">*</span><span class="ident" id="2416718">fmt</span><span class="op" id="2416721">)</span>&nbsp;<span class="ident" id="2416723">fmt_c128</span><span class="op" id="2416731">(</span><span class="ident" id="2416732">v</span>&nbsp;<span class="builtintype" id="2416734">complex128</span><span class="op" id="2416744">,</span>&nbsp;<span class="ident" id="2416746">verb</span>&nbsp;<span class="builtintype" id="2416751">rune</span><span class="op" id="2416755">)</span>&nbsp;<span class="op" id="2416757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416760">f</span><span class="op" id="2416761">.</span><span class="ident" id="2416762">fmt_complex</span><span class="op" id="2416773">(</span><span class="builtinfunc" id="2416774">real</span><span class="op" id="2416778">(</span><span class="ident" id="2416779">v</span><span class="op" id="2416780">)</span><span class="op" id="2416781">,</span>&nbsp;<span class="builtinfunc" id="2416783">imag</span><span class="op" id="2416787">(</span><span class="ident" id="2416788">v</span><span class="op" id="2416789">)</span><span class="op" id="2416790">,</span>&nbsp;<span class="num" id="2416792">64</span><span class="op" id="2416794">,</span>&nbsp;<span class="ident" id="2416796">verb</span><span class="op" id="2416800">)</span><br>
<span class="lineno"></span><span class="op" id="2416802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2416805">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2416856">func</span>&nbsp;<span class="op" id="2416861">(</span><span class="ident" id="2416862">f</span>&nbsp;<span class="op" id="2416864">*</span><span class="ident" id="2416865">fmt</span><span class="op" id="2416868">)</span>&nbsp;<span class="ident" id="2416870">fmt_complex</span><span class="op" id="2416881">(</span><span class="ident" id="2416882">r</span><span class="op" id="2416883">,</span>&nbsp;<span class="ident" id="2416885">j</span>&nbsp;<span class="builtintype" id="2416887">float64</span><span class="op" id="2416894">,</span>&nbsp;<span class="ident" id="2416896">size</span>&nbsp;<span class="builtintype" id="2416901">int</span><span class="op" id="2416904">,</span>&nbsp;<span class="ident" id="2416906">verb</span>&nbsp;<span class="builtintype" id="2416911">rune</span><span class="op" id="2416915">)</span>&nbsp;<span class="op" id="2416917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416920">f</span><span class="op" id="2416921">.</span><span class="ident" id="2416922">buf</span><span class="op" id="2416925">.</span><span class="ident" id="2416926">WriteByte</span><span class="op" id="2416935">(</span><span class="string" id="2416936">&#39;(&#39;</span><span class="op" id="2416939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416942">oldPlus</span>&nbsp;<span class="op" id="2416950">:=</span>&nbsp;<span class="ident" id="2416953">f</span><span class="op" id="2416954">.</span><span class="ident" id="2416955">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416961">oldSpace</span>&nbsp;<span class="op" id="2416970">:=</span>&nbsp;<span class="ident" id="2416973">f</span><span class="op" id="2416974">.</span><span class="ident" id="2416975">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416982">oldWid</span>&nbsp;<span class="op" id="2416989">:=</span>&nbsp;<span class="ident" id="2416992">f</span><span class="op" id="2416993">.</span><span class="ident" id="2416994">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416999">for</span>&nbsp;<span class="ident" id="2417003">i</span>&nbsp;<span class="op" id="2417005">:=</span>&nbsp;<span class="num" id="2417008">0</span><span class="op" id="2417009">;</span>&nbsp;<span class="op" id="2417011">;</span>&nbsp;<span class="ident" id="2417013">i</span><span class="op" id="2417014">++</span>&nbsp;<span class="op" id="2417017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417021">switch</span>&nbsp;<span class="ident" id="2417028">verb</span>&nbsp;<span class="op" id="2417033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417037">case</span>&nbsp;<span class="string" id="2417042">&#39;b&#39;</span><span class="op" id="2417045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417050">f</span><span class="op" id="2417051">.</span><span class="ident" id="2417052">formatFloat</span><span class="op" id="2417063">(</span><span class="ident" id="2417064">r</span><span class="op" id="2417065">,</span>&nbsp;<span class="string" id="2417067">&#39;b&#39;</span><span class="op" id="2417070">,</span>&nbsp;<span class="num" id="2417072">0</span><span class="op" id="2417073">,</span>&nbsp;<span class="ident" id="2417075">size</span><span class="op" id="2417079">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417083">case</span>&nbsp;<span class="string" id="2417088">&#39;e&#39;</span><span class="op" id="2417091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417096">f</span><span class="op" id="2417097">.</span><span class="ident" id="2417098">formatFloat</span><span class="op" id="2417109">(</span><span class="ident" id="2417110">r</span><span class="op" id="2417111">,</span>&nbsp;<span class="string" id="2417113">&#39;e&#39;</span><span class="op" id="2417116">,</span>&nbsp;<span class="ident" id="2417118">doPrec</span><span class="op" id="2417124">(</span><span class="ident" id="2417125">f</span><span class="op" id="2417126">,</span>&nbsp;<span class="num" id="2417128">6</span><span class="op" id="2417129">)</span><span class="op" id="2417130">,</span>&nbsp;<span class="ident" id="2417132">size</span><span class="op" id="2417136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417140">case</span>&nbsp;<span class="string" id="2417145">&#39;E&#39;</span><span class="op" id="2417148">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417153">f</span><span class="op" id="2417154">.</span><span class="ident" id="2417155">formatFloat</span><span class="op" id="2417166">(</span><span class="ident" id="2417167">r</span><span class="op" id="2417168">,</span>&nbsp;<span class="string" id="2417170">&#39;E&#39;</span><span class="op" id="2417173">,</span>&nbsp;<span class="ident" id="2417175">doPrec</span><span class="op" id="2417181">(</span><span class="ident" id="2417182">f</span><span class="op" id="2417183">,</span>&nbsp;<span class="num" id="2417185">6</span><span class="op" id="2417186">)</span><span class="op" id="2417187">,</span>&nbsp;<span class="ident" id="2417189">size</span><span class="op" id="2417193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417197">case</span>&nbsp;<span class="string" id="2417202">&#39;f&#39;</span><span class="op" id="2417205">,</span>&nbsp;<span class="string" id="2417207">&#39;F&#39;</span><span class="op" id="2417210">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417215">f</span><span class="op" id="2417216">.</span><span class="ident" id="2417217">formatFloat</span><span class="op" id="2417228">(</span><span class="ident" id="2417229">r</span><span class="op" id="2417230">,</span>&nbsp;<span class="string" id="2417232">&#39;f&#39;</span><span class="op" id="2417235">,</span>&nbsp;<span class="ident" id="2417237">doPrec</span><span class="op" id="2417243">(</span><span class="ident" id="2417244">f</span><span class="op" id="2417245">,</span>&nbsp;<span class="num" id="2417247">6</span><span class="op" id="2417248">)</span><span class="op" id="2417249">,</span>&nbsp;<span class="ident" id="2417251">size</span><span class="op" id="2417255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417259">case</span>&nbsp;<span class="string" id="2417264">&#39;g&#39;</span><span class="op" id="2417267">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417272">f</span><span class="op" id="2417273">.</span><span class="ident" id="2417274">formatFloat</span><span class="op" id="2417285">(</span><span class="ident" id="2417286">r</span><span class="op" id="2417287">,</span>&nbsp;<span class="string" id="2417289">&#39;g&#39;</span><span class="op" id="2417292">,</span>&nbsp;<span class="ident" id="2417294">doPrec</span><span class="op" id="2417300">(</span><span class="ident" id="2417301">f</span><span class="op" id="2417302">,</span>&nbsp;<span class="op" id="2417304">-</span><span class="num" id="2417305">1</span><span class="op" id="2417306">)</span><span class="op" id="2417307">,</span>&nbsp;<span class="ident" id="2417309">size</span><span class="op" id="2417313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417317">case</span>&nbsp;<span class="string" id="2417322">&#39;G&#39;</span><span class="op" id="2417325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417330">f</span><span class="op" id="2417331">.</span><span class="ident" id="2417332">formatFloat</span><span class="op" id="2417343">(</span><span class="ident" id="2417344">r</span><span class="op" id="2417345">,</span>&nbsp;<span class="string" id="2417347">&#39;G&#39;</span><span class="op" id="2417350">,</span>&nbsp;<span class="ident" id="2417352">doPrec</span><span class="op" id="2417358">(</span><span class="ident" id="2417359">f</span><span class="op" id="2417360">,</span>&nbsp;<span class="op" id="2417362">-</span><span class="num" id="2417363">1</span><span class="op" id="2417364">)</span><span class="op" id="2417365">,</span>&nbsp;<span class="ident" id="2417367">size</span><span class="op" id="2417371">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2417375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417379">if</span>&nbsp;<span class="ident" id="2417382">i</span>&nbsp;<span class="op" id="2417384">!=</span>&nbsp;<span class="num" id="2417387">0</span>&nbsp;<span class="op" id="2417389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417394">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2417402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2417406">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417445">f</span><span class="op" id="2417446">.</span><span class="ident" id="2417447">plus</span>&nbsp;<span class="op" id="2417452">=</span>&nbsp;<span class="builtintype" id="2417454">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417461">f</span><span class="op" id="2417462">.</span><span class="ident" id="2417463">space</span>&nbsp;<span class="op" id="2417469">=</span>&nbsp;<span class="builtintype" id="2417471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417479">f</span><span class="op" id="2417480">.</span><span class="ident" id="2417481">wid</span>&nbsp;<span class="op" id="2417485">=</span>&nbsp;<span class="ident" id="2417487">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417496">r</span>&nbsp;<span class="op" id="2417498">=</span>&nbsp;<span class="ident" id="2417500">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2417503">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417506">f</span><span class="op" id="2417507">.</span><span class="ident" id="2417508">space</span>&nbsp;<span class="op" id="2417514">=</span>&nbsp;<span class="ident" id="2417516">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417526">f</span><span class="op" id="2417527">.</span><span class="ident" id="2417528">plus</span>&nbsp;<span class="op" id="2417533">=</span>&nbsp;<span class="ident" id="2417535">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417544">f</span><span class="op" id="2417545">.</span><span class="ident" id="2417546">wid</span>&nbsp;<span class="op" id="2417550">=</span>&nbsp;<span class="ident" id="2417552">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417560">f</span><span class="op" id="2417561">.</span><span class="ident" id="2417562">buf</span><span class="op" id="2417565">.</span><span class="ident" id="2417566">Write</span><span class="op" id="2417571">(</span><span class="ident" id="2417572">irparenBytes</span><span class="op" id="2417584">)</span><br>
<span class="lineno"></span><span class="op" id="2417586">}</span>
</div>
</body>
</html>
