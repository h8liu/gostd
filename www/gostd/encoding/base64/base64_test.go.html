<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base64</h2>
<ul>
<li><a href="/gostd/encoding/base64/base64.go.html">base64.go</a></li>
<li><a href="/gostd/encoding/base64/base64_test.go.html" class="current">base64_test.go</a></li>
<li><a href="/gostd/encoding/base64/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7161403">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7161458">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7161512">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7161563">package</span>&nbsp;<span class="ident" id="7161571">base64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7161579">import</span>&nbsp;<span class="op" id="7161586">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161589">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161598">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161608">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161614">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161627">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161638">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161649">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7161660">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7161667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7161670">type</span>&nbsp;<span class="ident" id="7161675">testpair</span>&nbsp;<span class="keyword" id="7161684">struct</span>&nbsp;<span class="op" id="7161691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7161694">decoded</span><span class="op" id="7161701">,</span>&nbsp;<span class="ident" id="7161703">encoded</span>&nbsp;<span class="builtintype" id="7161711">string</span><br>
<span class="lineno">20</span><span class="op" id="7161718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7161721">var</span>&nbsp;<span class="ident" id="7161725">pairs</span>&nbsp;<span class="op" id="7161731">=</span>&nbsp;<span class="op" id="7161733">[</span><span class="op" id="7161734">]</span><span class="ident" id="7161735">testpair</span><span class="op" id="7161743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7161746">//&nbsp;RFC&nbsp;3548&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161768">{</span><span class="string" id="7161769">&#34;\x14\xfb\x9c\x03\xd9\x7e&#34;</span><span class="op" id="7161795">,</span>&nbsp;<span class="string" id="7161797">&#34;FPucA9l+&#34;</span><span class="op" id="7161807">}</span><span class="op" id="7161808">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161811">{</span><span class="string" id="7161812">&#34;\x14\xfb\x9c\x03\xd9&#34;</span><span class="op" id="7161834">,</span>&nbsp;<span class="string" id="7161836">&#34;FPucA9k=&#34;</span><span class="op" id="7161846">}</span><span class="op" id="7161847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161850">{</span><span class="string" id="7161851">&#34;\x14\xfb\x9c\x03&#34;</span><span class="op" id="7161869">,</span>&nbsp;<span class="string" id="7161871">&#34;FPucAw==&#34;</span><span class="op" id="7161881">}</span><span class="op" id="7161882">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7161886">//&nbsp;RFC&nbsp;4648&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161908">{</span><span class="string" id="7161909">&#34;&#34;</span><span class="op" id="7161911">,</span>&nbsp;<span class="string" id="7161913">&#34;&#34;</span><span class="op" id="7161915">}</span><span class="op" id="7161916">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161919">{</span><span class="string" id="7161920">&#34;f&#34;</span><span class="op" id="7161923">,</span>&nbsp;<span class="string" id="7161925">&#34;Zg==&#34;</span><span class="op" id="7161931">}</span><span class="op" id="7161932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161935">{</span><span class="string" id="7161936">&#34;fo&#34;</span><span class="op" id="7161940">,</span>&nbsp;<span class="string" id="7161942">&#34;Zm8=&#34;</span><span class="op" id="7161948">}</span><span class="op" id="7161949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161952">{</span><span class="string" id="7161953">&#34;foo&#34;</span><span class="op" id="7161958">,</span>&nbsp;<span class="string" id="7161960">&#34;Zm9v&#34;</span><span class="op" id="7161966">}</span><span class="op" id="7161967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161970">{</span><span class="string" id="7161971">&#34;foob&#34;</span><span class="op" id="7161977">,</span>&nbsp;<span class="string" id="7161979">&#34;Zm9vYg==&#34;</span><span class="op" id="7161989">}</span><span class="op" id="7161990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7161993">{</span><span class="string" id="7161994">&#34;fooba&#34;</span><span class="op" id="7162001">,</span>&nbsp;<span class="string" id="7162003">&#34;Zm9vYmE=&#34;</span><span class="op" id="7162013">}</span><span class="op" id="7162014">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162017">{</span><span class="string" id="7162018">&#34;foobar&#34;</span><span class="op" id="7162026">,</span>&nbsp;<span class="string" id="7162028">&#34;Zm9vYmFy&#34;</span><span class="op" id="7162038">}</span><span class="op" id="7162039">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7162043">//&nbsp;Wikipedia&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162066">{</span><span class="string" id="7162067">&#34;sure.&#34;</span><span class="op" id="7162074">,</span>&nbsp;<span class="string" id="7162076">&#34;c3VyZS4=&#34;</span><span class="op" id="7162086">}</span><span class="op" id="7162087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162090">{</span><span class="string" id="7162091">&#34;sure&#34;</span><span class="op" id="7162097">,</span>&nbsp;<span class="string" id="7162099">&#34;c3VyZQ==&#34;</span><span class="op" id="7162109">}</span><span class="op" id="7162110">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162113">{</span><span class="string" id="7162114">&#34;sur&#34;</span><span class="op" id="7162119">,</span>&nbsp;<span class="string" id="7162121">&#34;c3Vy&#34;</span><span class="op" id="7162127">}</span><span class="op" id="7162128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162131">{</span><span class="string" id="7162132">&#34;su&#34;</span><span class="op" id="7162136">,</span>&nbsp;<span class="string" id="7162138">&#34;c3U=&#34;</span><span class="op" id="7162144">}</span><span class="op" id="7162145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162148">{</span><span class="string" id="7162149">&#34;leasure.&#34;</span><span class="op" id="7162159">,</span>&nbsp;<span class="string" id="7162161">&#34;bGVhc3VyZS4=&#34;</span><span class="op" id="7162175">}</span><span class="op" id="7162176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162179">{</span><span class="string" id="7162180">&#34;easure.&#34;</span><span class="op" id="7162189">,</span>&nbsp;<span class="string" id="7162191">&#34;ZWFzdXJlLg==&#34;</span><span class="op" id="7162205">}</span><span class="op" id="7162206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162209">{</span><span class="string" id="7162210">&#34;asure.&#34;</span><span class="op" id="7162218">,</span>&nbsp;<span class="string" id="7162220">&#34;YXN1cmUu&#34;</span><span class="op" id="7162230">}</span><span class="op" id="7162231">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162234">{</span><span class="string" id="7162235">&#34;sure.&#34;</span><span class="op" id="7162242">,</span>&nbsp;<span class="string" id="7162244">&#34;c3VyZS4=&#34;</span><span class="op" id="7162254">}</span><span class="op" id="7162255">,</span><br>
<span class="lineno"></span><span class="op" id="7162257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7162260">var</span>&nbsp;<span class="ident" id="7162264">bigtest</span>&nbsp;<span class="op" id="7162272">=</span>&nbsp;<span class="ident" id="7162274">testpair</span><span class="op" id="7162282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7162285">&#34;Twas&nbsp;brillig,&nbsp;and&nbsp;the&nbsp;slithy&nbsp;toves&#34;</span><span class="op" id="7162321">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7162324">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="7162374">,</span><br>
<span class="lineno"></span><span class="op" id="7162376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7162379">func</span>&nbsp;<span class="ident" id="7162384">testEqual</span><span class="op" id="7162393">(</span><span class="ident" id="7162394">t</span>&nbsp;<span class="op" id="7162396">*</span><span class="ident" id="7162397">testing</span><span class="op" id="7162404">.</span><span class="ident" id="7162405">T</span><span class="op" id="7162406">,</span>&nbsp;<span class="ident" id="7162408">msg</span>&nbsp;<span class="builtintype" id="7162412">string</span><span class="op" id="7162418">,</span>&nbsp;<span class="ident" id="7162420">args</span>&nbsp;<span class="op" id="7162425">...</span><span class="keyword" id="7162428">interface</span><span class="op" id="7162437">{</span><span class="op" id="7162438">}</span><span class="op" id="7162439">)</span>&nbsp;<span class="builtintype" id="7162441">bool</span>&nbsp;<span class="op" id="7162446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7162449">if</span>&nbsp;<span class="ident" id="7162452">args</span><span class="op" id="7162456">[</span><span class="builtinfunc" id="7162457">len</span><span class="op" id="7162460">(</span><span class="ident" id="7162461">args</span><span class="op" id="7162465">)</span><span class="op" id="7162466">-</span><span class="num" id="7162467">2</span><span class="op" id="7162468">]</span>&nbsp;<span class="op" id="7162470">!=</span>&nbsp;<span class="ident" id="7162473">args</span><span class="op" id="7162477">[</span><span class="builtinfunc" id="7162478">len</span><span class="op" id="7162481">(</span><span class="ident" id="7162482">args</span><span class="op" id="7162486">)</span><span class="op" id="7162487">-</span><span class="num" id="7162488">1</span><span class="op" id="7162489">]</span>&nbsp;<span class="op" id="7162491">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162495">t</span><span class="op" id="7162496">.</span><span class="ident" id="7162497">Errorf</span><span class="op" id="7162503">(</span><span class="ident" id="7162504">msg</span><span class="op" id="7162507">,</span>&nbsp;<span class="ident" id="7162509">args</span><span class="op" id="7162513">...</span><span class="op" id="7162516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7162520">return</span>&nbsp;<span class="builtintype" id="7162527">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7162537">return</span>&nbsp;<span class="builtintype" id="7162544">true</span><br>
<span class="lineno"></span><span class="op" id="7162549">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="7162552">func</span>&nbsp;<span class="ident" id="7162557">TestEncode</span><span class="op" id="7162567">(</span><span class="ident" id="7162568">t</span>&nbsp;<span class="op" id="7162570">*</span><span class="ident" id="7162571">testing</span><span class="op" id="7162578">.</span><span class="ident" id="7162579">T</span><span class="op" id="7162580">)</span>&nbsp;<span class="op" id="7162582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7162585">for</span>&nbsp;<span class="ident" id="7162589">_</span><span class="op" id="7162590">,</span>&nbsp;<span class="ident" id="7162592">p</span>&nbsp;<span class="op" id="7162594">:=</span>&nbsp;<span class="keyword" id="7162597">range</span>&nbsp;<span class="ident" id="7162603">pairs</span>&nbsp;<span class="op" id="7162609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162613">got</span>&nbsp;<span class="op" id="7162617">:=</span>&nbsp;<span class="ident" id="7162620">StdEncoding</span><span class="op" id="7162631">.</span><span class="ident" id="7162632">EncodeToString</span><span class="op" id="7162646">(</span><span class="op" id="7162647">[</span><span class="op" id="7162648">]</span><span class="builtintype" id="7162649">byte</span><span class="op" id="7162653">(</span><span class="ident" id="7162654">p</span><span class="op" id="7162655">.</span><span class="ident" id="7162656">decoded</span><span class="op" id="7162663">)</span><span class="op" id="7162664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162668">testEqual</span><span class="op" id="7162677">(</span><span class="ident" id="7162678">t</span><span class="op" id="7162679">,</span>&nbsp;<span class="string" id="7162681">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7162707">,</span>&nbsp;<span class="ident" id="7162709">p</span><span class="op" id="7162710">.</span><span class="ident" id="7162711">decoded</span><span class="op" id="7162718">,</span>&nbsp;<span class="ident" id="7162720">got</span><span class="op" id="7162723">,</span>&nbsp;<span class="ident" id="7162725">p</span><span class="op" id="7162726">.</span><span class="ident" id="7162727">encoded</span><span class="op" id="7162734">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162737">}</span><br>
<span class="lineno"></span><span class="op" id="7162739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7162742">func</span>&nbsp;<span class="ident" id="7162747">TestEncoder</span><span class="op" id="7162758">(</span><span class="ident" id="7162759">t</span>&nbsp;<span class="op" id="7162761">*</span><span class="ident" id="7162762">testing</span><span class="op" id="7162769">.</span><span class="ident" id="7162770">T</span><span class="op" id="7162771">)</span>&nbsp;<span class="op" id="7162773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7162776">for</span>&nbsp;<span class="ident" id="7162780">_</span><span class="op" id="7162781">,</span>&nbsp;<span class="ident" id="7162783">p</span>&nbsp;<span class="op" id="7162785">:=</span>&nbsp;<span class="keyword" id="7162788">range</span>&nbsp;<span class="ident" id="7162794">pairs</span>&nbsp;<span class="op" id="7162800">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162804">bb</span>&nbsp;<span class="op" id="7162807">:=</span>&nbsp;<span class="op" id="7162810">&amp;</span><span class="ident" id="7162811">bytes</span><span class="op" id="7162816">.</span><span class="ident" id="7162817">Buffer</span><span class="op" id="7162823">{</span><span class="op" id="7162824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162828">encoder</span>&nbsp;<span class="op" id="7162836">:=</span>&nbsp;<span class="ident" id="7162839">NewEncoder</span><span class="op" id="7162849">(</span><span class="ident" id="7162850">StdEncoding</span><span class="op" id="7162861">,</span>&nbsp;<span class="ident" id="7162863">bb</span><span class="op" id="7162865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162869">encoder</span><span class="op" id="7162876">.</span><span class="ident" id="7162877">Write</span><span class="op" id="7162882">(</span><span class="op" id="7162883">[</span><span class="op" id="7162884">]</span><span class="builtintype" id="7162885">byte</span><span class="op" id="7162889">(</span><span class="ident" id="7162890">p</span><span class="op" id="7162891">.</span><span class="ident" id="7162892">decoded</span><span class="op" id="7162899">)</span><span class="op" id="7162900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162904">encoder</span><span class="op" id="7162911">.</span><span class="ident" id="7162912">Close</span><span class="op" id="7162917">(</span><span class="op" id="7162918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7162922">testEqual</span><span class="op" id="7162931">(</span><span class="ident" id="7162932">t</span><span class="op" id="7162933">,</span>&nbsp;<span class="string" id="7162935">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7162961">,</span>&nbsp;<span class="ident" id="7162963">p</span><span class="op" id="7162964">.</span><span class="ident" id="7162965">decoded</span><span class="op" id="7162972">,</span>&nbsp;<span class="ident" id="7162974">bb</span><span class="op" id="7162976">.</span><span class="ident" id="7162977">String</span><span class="op" id="7162983">(</span><span class="op" id="7162984">)</span><span class="op" id="7162985">,</span>&nbsp;<span class="ident" id="7162987">p</span><span class="op" id="7162988">.</span><span class="ident" id="7162989">encoded</span><span class="op" id="7162996">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7162999">}</span><br>
<span class="lineno"></span><span class="op" id="7163001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7163004">func</span>&nbsp;<span class="ident" id="7163009">TestEncoderBuffering</span><span class="op" id="7163029">(</span><span class="ident" id="7163030">t</span>&nbsp;<span class="op" id="7163032">*</span><span class="ident" id="7163033">testing</span><span class="op" id="7163040">.</span><span class="ident" id="7163041">T</span><span class="op" id="7163042">)</span>&nbsp;<span class="op" id="7163044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163047">input</span>&nbsp;<span class="op" id="7163053">:=</span>&nbsp;<span class="op" id="7163056">[</span><span class="op" id="7163057">]</span><span class="builtintype" id="7163058">byte</span><span class="op" id="7163062">(</span><span class="ident" id="7163063">bigtest</span><span class="op" id="7163070">.</span><span class="ident" id="7163071">decoded</span><span class="op" id="7163078">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7163081">for</span>&nbsp;<span class="ident" id="7163085">bs</span>&nbsp;<span class="op" id="7163088">:=</span>&nbsp;<span class="num" id="7163091">1</span><span class="op" id="7163092">;</span>&nbsp;<span class="ident" id="7163094">bs</span>&nbsp;<span class="op" id="7163097">&lt;=</span>&nbsp;<span class="num" id="7163100">12</span><span class="op" id="7163102">;</span>&nbsp;<span class="ident" id="7163104">bs</span><span class="op" id="7163106">++</span>&nbsp;<span class="op" id="7163109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163113">bb</span>&nbsp;<span class="op" id="7163116">:=</span>&nbsp;<span class="op" id="7163119">&amp;</span><span class="ident" id="7163120">bytes</span><span class="op" id="7163125">.</span><span class="ident" id="7163126">Buffer</span><span class="op" id="7163132">{</span><span class="op" id="7163133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163137">encoder</span>&nbsp;<span class="op" id="7163145">:=</span>&nbsp;<span class="ident" id="7163148">NewEncoder</span><span class="op" id="7163158">(</span><span class="ident" id="7163159">StdEncoding</span><span class="op" id="7163170">,</span>&nbsp;<span class="ident" id="7163172">bb</span><span class="op" id="7163174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7163178">for</span>&nbsp;<span class="ident" id="7163182">pos</span>&nbsp;<span class="op" id="7163186">:=</span>&nbsp;<span class="num" id="7163189">0</span><span class="op" id="7163190">;</span>&nbsp;<span class="ident" id="7163192">pos</span>&nbsp;<span class="op" id="7163196">&lt;</span>&nbsp;<span class="builtinfunc" id="7163198">len</span><span class="op" id="7163201">(</span><span class="ident" id="7163202">input</span><span class="op" id="7163207">)</span><span class="op" id="7163208">;</span>&nbsp;<span class="ident" id="7163210">pos</span>&nbsp;<span class="op" id="7163214">+=</span>&nbsp;<span class="ident" id="7163217">bs</span>&nbsp;<span class="op" id="7163220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163225">end</span>&nbsp;<span class="op" id="7163229">:=</span>&nbsp;<span class="ident" id="7163232">pos</span>&nbsp;<span class="op" id="7163236">+</span>&nbsp;<span class="ident" id="7163238">bs</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7163244">if</span>&nbsp;<span class="ident" id="7163247">end</span>&nbsp;<span class="op" id="7163251">&gt;</span>&nbsp;<span class="builtinfunc" id="7163253">len</span><span class="op" id="7163256">(</span><span class="ident" id="7163257">input</span><span class="op" id="7163262">)</span>&nbsp;<span class="op" id="7163264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163270">end</span>&nbsp;<span class="op" id="7163274">=</span>&nbsp;<span class="builtinfunc" id="7163276">len</span><span class="op" id="7163279">(</span><span class="ident" id="7163280">input</span><span class="op" id="7163285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7163290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163295">n</span><span class="op" id="7163296">,</span>&nbsp;<span class="ident" id="7163298">err</span>&nbsp;<span class="op" id="7163302">:=</span>&nbsp;<span class="ident" id="7163305">encoder</span><span class="op" id="7163312">.</span><span class="ident" id="7163313">Write</span><span class="op" id="7163318">(</span><span class="ident" id="7163319">input</span><span class="op" id="7163324">[</span><span class="ident" id="7163325">pos</span><span class="op" id="7163328">:</span><span class="ident" id="7163329">end</span><span class="op" id="7163332">]</span><span class="op" id="7163333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163338">testEqual</span><span class="op" id="7163347">(</span><span class="ident" id="7163348">t</span><span class="op" id="7163349">,</span>&nbsp;<span class="string" id="7163351">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7163385">,</span>&nbsp;<span class="ident" id="7163387">input</span><span class="op" id="7163392">[</span><span class="ident" id="7163393">pos</span><span class="op" id="7163396">:</span><span class="ident" id="7163397">end</span><span class="op" id="7163400">]</span><span class="op" id="7163401">,</span>&nbsp;<span class="ident" id="7163403">err</span><span class="op" id="7163406">,</span>&nbsp;<span class="builtintype" id="7163408">error</span><span class="op" id="7163413">(</span><span class="ident" id="7163414">nil</span><span class="op" id="7163417">)</span><span class="op" id="7163418">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163423">testEqual</span><span class="op" id="7163432">(</span><span class="ident" id="7163433">t</span><span class="op" id="7163434">,</span>&nbsp;<span class="string" id="7163436">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7163471">,</span>&nbsp;<span class="ident" id="7163473">input</span><span class="op" id="7163478">[</span><span class="ident" id="7163479">pos</span><span class="op" id="7163482">:</span><span class="ident" id="7163483">end</span><span class="op" id="7163486">]</span><span class="op" id="7163487">,</span>&nbsp;<span class="ident" id="7163489">n</span><span class="op" id="7163490">,</span>&nbsp;<span class="ident" id="7163492">end</span><span class="op" id="7163495">-</span><span class="ident" id="7163496">pos</span><span class="op" id="7163499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7163503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163507">err</span>&nbsp;<span class="op" id="7163511">:=</span>&nbsp;<span class="ident" id="7163514">encoder</span><span class="op" id="7163521">.</span><span class="ident" id="7163522">Close</span><span class="op" id="7163527">(</span><span class="op" id="7163528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163532">testEqual</span><span class="op" id="7163541">(</span><span class="ident" id="7163542">t</span><span class="op" id="7163543">,</span>&nbsp;<span class="string" id="7163545">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7163575">,</span>&nbsp;<span class="ident" id="7163577">err</span><span class="op" id="7163580">,</span>&nbsp;<span class="builtintype" id="7163582">error</span><span class="op" id="7163587">(</span><span class="ident" id="7163588">nil</span><span class="op" id="7163591">)</span><span class="op" id="7163592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163596">testEqual</span><span class="op" id="7163605">(</span><span class="ident" id="7163606">t</span><span class="op" id="7163607">,</span>&nbsp;<span class="string" id="7163609">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7163642">,</span>&nbsp;<span class="ident" id="7163644">bs</span><span class="op" id="7163646">,</span>&nbsp;<span class="ident" id="7163648">bigtest</span><span class="op" id="7163655">.</span><span class="ident" id="7163656">decoded</span><span class="op" id="7163663">,</span>&nbsp;<span class="ident" id="7163665">bb</span><span class="op" id="7163667">.</span><span class="ident" id="7163668">String</span><span class="op" id="7163674">(</span><span class="op" id="7163675">)</span><span class="op" id="7163676">,</span>&nbsp;<span class="ident" id="7163678">bigtest</span><span class="op" id="7163685">.</span><span class="ident" id="7163686">encoded</span><span class="op" id="7163693">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7163696">}</span><br>
<span class="lineno"></span><span class="op" id="7163698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7163701">func</span>&nbsp;<span class="ident" id="7163706">TestDecode</span><span class="op" id="7163716">(</span><span class="ident" id="7163717">t</span>&nbsp;<span class="op" id="7163719">*</span><span class="ident" id="7163720">testing</span><span class="op" id="7163727">.</span><span class="ident" id="7163728">T</span><span class="op" id="7163729">)</span>&nbsp;<span class="op" id="7163731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7163734">for</span>&nbsp;<span class="ident" id="7163738">_</span><span class="op" id="7163739">,</span>&nbsp;<span class="ident" id="7163741">p</span>&nbsp;<span class="op" id="7163743">:=</span>&nbsp;<span class="keyword" id="7163746">range</span>&nbsp;<span class="ident" id="7163752">pairs</span>&nbsp;<span class="op" id="7163758">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163762">dbuf</span>&nbsp;<span class="op" id="7163767">:=</span>&nbsp;<span class="builtinfunc" id="7163770">make</span><span class="op" id="7163774">(</span><span class="op" id="7163775">[</span><span class="op" id="7163776">]</span><span class="builtintype" id="7163777">byte</span><span class="op" id="7163781">,</span>&nbsp;<span class="ident" id="7163783">StdEncoding</span><span class="op" id="7163794">.</span><span class="ident" id="7163795">DecodedLen</span><span class="op" id="7163805">(</span><span class="builtinfunc" id="7163806">len</span><span class="op" id="7163809">(</span><span class="ident" id="7163810">p</span><span class="op" id="7163811">.</span><span class="ident" id="7163812">encoded</span><span class="op" id="7163819">)</span><span class="op" id="7163820">)</span><span class="op" id="7163821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163825">count</span><span class="op" id="7163830">,</span>&nbsp;<span class="ident" id="7163832">end</span><span class="op" id="7163835">,</span>&nbsp;<span class="ident" id="7163837">err</span>&nbsp;<span class="op" id="7163841">:=</span>&nbsp;<span class="ident" id="7163844">StdEncoding</span><span class="op" id="7163855">.</span><span class="ident" id="7163856">decode</span><span class="op" id="7163862">(</span><span class="ident" id="7163863">dbuf</span><span class="op" id="7163867">,</span>&nbsp;<span class="op" id="7163869">[</span><span class="op" id="7163870">]</span><span class="builtintype" id="7163871">byte</span><span class="op" id="7163875">(</span><span class="ident" id="7163876">p</span><span class="op" id="7163877">.</span><span class="ident" id="7163878">encoded</span><span class="op" id="7163885">)</span><span class="op" id="7163886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163890">testEqual</span><span class="op" id="7163899">(</span><span class="ident" id="7163900">t</span><span class="op" id="7163901">,</span>&nbsp;<span class="string" id="7163903">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7163935">,</span>&nbsp;<span class="ident" id="7163937">p</span><span class="op" id="7163938">.</span><span class="ident" id="7163939">encoded</span><span class="op" id="7163946">,</span>&nbsp;<span class="ident" id="7163948">err</span><span class="op" id="7163951">,</span>&nbsp;<span class="builtintype" id="7163953">error</span><span class="op" id="7163958">(</span><span class="ident" id="7163959">nil</span><span class="op" id="7163962">)</span><span class="op" id="7163963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7163967">testEqual</span><span class="op" id="7163976">(</span><span class="ident" id="7163977">t</span><span class="op" id="7163978">,</span>&nbsp;<span class="string" id="7163980">&#34;Decode(%q)&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7164013">,</span>&nbsp;<span class="ident" id="7164015">p</span><span class="op" id="7164016">.</span><span class="ident" id="7164017">encoded</span><span class="op" id="7164024">,</span>&nbsp;<span class="ident" id="7164026">count</span><span class="op" id="7164031">,</span>&nbsp;<span class="builtinfunc" id="7164033">len</span><span class="op" id="7164036">(</span><span class="ident" id="7164037">p</span><span class="op" id="7164038">.</span><span class="ident" id="7164039">decoded</span><span class="op" id="7164046">)</span><span class="op" id="7164047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7164051">if</span>&nbsp;<span class="builtinfunc" id="7164054">len</span><span class="op" id="7164057">(</span><span class="ident" id="7164058">p</span><span class="op" id="7164059">.</span><span class="ident" id="7164060">encoded</span><span class="op" id="7164067">)</span>&nbsp;<span class="op" id="7164069">&gt;</span>&nbsp;<span class="num" id="7164071">0</span>&nbsp;<span class="op" id="7164073">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164078">testEqual</span><span class="op" id="7164087">(</span><span class="ident" id="7164088">t</span><span class="op" id="7164089">,</span>&nbsp;<span class="string" id="7164091">&#34;Decode(%q)&nbsp;=&nbsp;end&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7164121">,</span>&nbsp;<span class="ident" id="7164123">p</span><span class="op" id="7164124">.</span><span class="ident" id="7164125">encoded</span><span class="op" id="7164132">,</span>&nbsp;<span class="ident" id="7164134">end</span><span class="op" id="7164137">,</span>&nbsp;<span class="op" id="7164139">(</span><span class="ident" id="7164140">p</span><span class="op" id="7164141">.</span><span class="ident" id="7164142">encoded</span><span class="op" id="7164149">[</span><span class="builtinfunc" id="7164150">len</span><span class="op" id="7164153">(</span><span class="ident" id="7164154">p</span><span class="op" id="7164155">.</span><span class="ident" id="7164156">encoded</span><span class="op" id="7164163">)</span><span class="op" id="7164164">-</span><span class="num" id="7164165">1</span><span class="op" id="7164166">]</span>&nbsp;<span class="op" id="7164168">==</span>&nbsp;<span class="string" id="7164171">&#39;=&#39;</span><span class="op" id="7164174">)</span><span class="op" id="7164175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7164179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164183">testEqual</span><span class="op" id="7164192">(</span><span class="ident" id="7164193">t</span><span class="op" id="7164194">,</span>&nbsp;<span class="string" id="7164196">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7164222">,</span>&nbsp;<span class="ident" id="7164224">p</span><span class="op" id="7164225">.</span><span class="ident" id="7164226">encoded</span><span class="op" id="7164233">,</span>&nbsp;<span class="builtintype" id="7164235">string</span><span class="op" id="7164241">(</span><span class="ident" id="7164242">dbuf</span><span class="op" id="7164246">[</span><span class="num" id="7164247">0</span><span class="op" id="7164248">:</span><span class="ident" id="7164249">count</span><span class="op" id="7164254">]</span><span class="op" id="7164255">)</span><span class="op" id="7164256">,</span>&nbsp;<span class="ident" id="7164258">p</span><span class="op" id="7164259">.</span><span class="ident" id="7164260">decoded</span><span class="op" id="7164267">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164272">dbuf</span><span class="op" id="7164276">,</span>&nbsp;<span class="ident" id="7164278">err</span>&nbsp;<span class="op" id="7164282">=</span>&nbsp;<span class="ident" id="7164284">StdEncoding</span><span class="op" id="7164295">.</span><span class="ident" id="7164296">DecodeString</span><span class="op" id="7164308">(</span><span class="ident" id="7164309">p</span><span class="op" id="7164310">.</span><span class="ident" id="7164311">encoded</span><span class="op" id="7164318">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164322">testEqual</span><span class="op" id="7164331">(</span><span class="ident" id="7164332">t</span><span class="op" id="7164333">,</span>&nbsp;<span class="string" id="7164335">&#34;DecodeString(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7164373">,</span>&nbsp;<span class="ident" id="7164375">p</span><span class="op" id="7164376">.</span><span class="ident" id="7164377">encoded</span><span class="op" id="7164384">,</span>&nbsp;<span class="ident" id="7164386">err</span><span class="op" id="7164389">,</span>&nbsp;<span class="builtintype" id="7164391">error</span><span class="op" id="7164396">(</span><span class="ident" id="7164397">nil</span><span class="op" id="7164400">)</span><span class="op" id="7164401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164405">testEqual</span><span class="op" id="7164414">(</span><span class="ident" id="7164415">t</span><span class="op" id="7164416">,</span>&nbsp;<span class="string" id="7164418">&#34;DecodeString(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7164450">,</span>&nbsp;<span class="builtintype" id="7164452">string</span><span class="op" id="7164458">(</span><span class="ident" id="7164459">dbuf</span><span class="op" id="7164463">)</span><span class="op" id="7164464">,</span>&nbsp;<span class="ident" id="7164466">p</span><span class="op" id="7164467">.</span><span class="ident" id="7164468">decoded</span><span class="op" id="7164475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7164478">}</span><br>
<span class="lineno"></span><span class="op" id="7164480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7164483">func</span>&nbsp;<span class="ident" id="7164488">TestDecoder</span><span class="op" id="7164499">(</span><span class="ident" id="7164500">t</span>&nbsp;<span class="op" id="7164502">*</span><span class="ident" id="7164503">testing</span><span class="op" id="7164510">.</span><span class="ident" id="7164511">T</span><span class="op" id="7164512">)</span>&nbsp;<span class="op" id="7164514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7164517">for</span>&nbsp;<span class="ident" id="7164521">_</span><span class="op" id="7164522">,</span>&nbsp;<span class="ident" id="7164524">p</span>&nbsp;<span class="op" id="7164526">:=</span>&nbsp;<span class="keyword" id="7164529">range</span>&nbsp;<span class="ident" id="7164535">pairs</span>&nbsp;<span class="op" id="7164541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164545">decoder</span>&nbsp;<span class="op" id="7164553">:=</span>&nbsp;<span class="ident" id="7164556">NewDecoder</span><span class="op" id="7164566">(</span><span class="ident" id="7164567">StdEncoding</span><span class="op" id="7164578">,</span>&nbsp;<span class="ident" id="7164580">strings</span><span class="op" id="7164587">.</span><span class="ident" id="7164588">NewReader</span><span class="op" id="7164597">(</span><span class="ident" id="7164598">p</span><span class="op" id="7164599">.</span><span class="ident" id="7164600">encoded</span><span class="op" id="7164607">)</span><span class="op" id="7164608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164612">dbuf</span>&nbsp;<span class="op" id="7164617">:=</span>&nbsp;<span class="builtinfunc" id="7164620">make</span><span class="op" id="7164624">(</span><span class="op" id="7164625">[</span><span class="op" id="7164626">]</span><span class="builtintype" id="7164627">byte</span><span class="op" id="7164631">,</span>&nbsp;<span class="ident" id="7164633">StdEncoding</span><span class="op" id="7164644">.</span><span class="ident" id="7164645">DecodedLen</span><span class="op" id="7164655">(</span><span class="builtinfunc" id="7164656">len</span><span class="op" id="7164659">(</span><span class="ident" id="7164660">p</span><span class="op" id="7164661">.</span><span class="ident" id="7164662">encoded</span><span class="op" id="7164669">)</span><span class="op" id="7164670">)</span><span class="op" id="7164671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164675">count</span><span class="op" id="7164680">,</span>&nbsp;<span class="ident" id="7164682">err</span>&nbsp;<span class="op" id="7164686">:=</span>&nbsp;<span class="ident" id="7164689">decoder</span><span class="op" id="7164696">.</span><span class="ident" id="7164697">Read</span><span class="op" id="7164701">(</span><span class="ident" id="7164702">dbuf</span><span class="op" id="7164706">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7164710">if</span>&nbsp;<span class="ident" id="7164713">err</span>&nbsp;<span class="op" id="7164717">!=</span>&nbsp;<span class="ident" id="7164720">nil</span>&nbsp;<span class="op" id="7164724">&amp;&amp;</span>&nbsp;<span class="ident" id="7164727">err</span>&nbsp;<span class="op" id="7164731">!=</span>&nbsp;<span class="ident" id="7164734">io</span><span class="op" id="7164736">.</span><span class="ident" id="7164737">EOF</span>&nbsp;<span class="op" id="7164741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164746">t</span><span class="op" id="7164747">.</span><span class="ident" id="7164748">Fatal</span><span class="op" id="7164753">(</span><span class="string" id="7164754">&#34;Read&nbsp;failed&#34;</span><span class="op" id="7164767">,</span>&nbsp;<span class="ident" id="7164769">err</span><span class="op" id="7164772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7164776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164780">testEqual</span><span class="op" id="7164789">(</span><span class="ident" id="7164790">t</span><span class="op" id="7164791">,</span>&nbsp;<span class="string" id="7164793">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7164828">,</span>&nbsp;<span class="ident" id="7164830">p</span><span class="op" id="7164831">.</span><span class="ident" id="7164832">encoded</span><span class="op" id="7164839">,</span>&nbsp;<span class="ident" id="7164841">count</span><span class="op" id="7164846">,</span>&nbsp;<span class="builtinfunc" id="7164848">len</span><span class="op" id="7164851">(</span><span class="ident" id="7164852">p</span><span class="op" id="7164853">.</span><span class="ident" id="7164854">decoded</span><span class="op" id="7164861">)</span><span class="op" id="7164862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164866">testEqual</span><span class="op" id="7164875">(</span><span class="ident" id="7164876">t</span><span class="op" id="7164877">,</span>&nbsp;<span class="string" id="7164879">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7164909">,</span>&nbsp;<span class="ident" id="7164911">p</span><span class="op" id="7164912">.</span><span class="ident" id="7164913">encoded</span><span class="op" id="7164920">,</span>&nbsp;<span class="builtintype" id="7164922">string</span><span class="op" id="7164928">(</span><span class="ident" id="7164929">dbuf</span><span class="op" id="7164933">[</span><span class="num" id="7164934">0</span><span class="op" id="7164935">:</span><span class="ident" id="7164936">count</span><span class="op" id="7164941">]</span><span class="op" id="7164942">)</span><span class="op" id="7164943">,</span>&nbsp;<span class="ident" id="7164945">p</span><span class="op" id="7164946">.</span><span class="ident" id="7164947">decoded</span><span class="op" id="7164954">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7164958">if</span>&nbsp;<span class="ident" id="7164961">err</span>&nbsp;<span class="op" id="7164965">!=</span>&nbsp;<span class="ident" id="7164968">io</span><span class="op" id="7164970">.</span><span class="ident" id="7164971">EOF</span>&nbsp;<span class="op" id="7164975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7164980">count</span><span class="op" id="7164985">,</span>&nbsp;<span class="ident" id="7164987">err</span>&nbsp;<span class="op" id="7164991">=</span>&nbsp;<span class="ident" id="7164993">decoder</span><span class="op" id="7165000">.</span><span class="ident" id="7165001">Read</span><span class="op" id="7165005">(</span><span class="ident" id="7165006">dbuf</span><span class="op" id="7165010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165018">testEqual</span><span class="op" id="7165027">(</span><span class="ident" id="7165028">t</span><span class="op" id="7165029">,</span>&nbsp;<span class="string" id="7165031">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7165059">,</span>&nbsp;<span class="ident" id="7165061">p</span><span class="op" id="7165062">.</span><span class="ident" id="7165063">encoded</span><span class="op" id="7165070">,</span>&nbsp;<span class="ident" id="7165072">err</span><span class="op" id="7165075">,</span>&nbsp;<span class="ident" id="7165077">io</span><span class="op" id="7165079">.</span><span class="ident" id="7165080">EOF</span><span class="op" id="7165083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165086">}</span><br>
<span class="lineno">130</span><span class="op" id="7165088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7165091">func</span>&nbsp;<span class="ident" id="7165096">TestDecoderBuffering</span><span class="op" id="7165116">(</span><span class="ident" id="7165117">t</span>&nbsp;<span class="op" id="7165119">*</span><span class="ident" id="7165120">testing</span><span class="op" id="7165127">.</span><span class="ident" id="7165128">T</span><span class="op" id="7165129">)</span>&nbsp;<span class="op" id="7165131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7165134">for</span>&nbsp;<span class="ident" id="7165138">bs</span>&nbsp;<span class="op" id="7165141">:=</span>&nbsp;<span class="num" id="7165144">1</span><span class="op" id="7165145">;</span>&nbsp;<span class="ident" id="7165147">bs</span>&nbsp;<span class="op" id="7165150">&lt;=</span>&nbsp;<span class="num" id="7165153">12</span><span class="op" id="7165155">;</span>&nbsp;<span class="ident" id="7165157">bs</span><span class="op" id="7165159">++</span>&nbsp;<span class="op" id="7165162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165166">decoder</span>&nbsp;<span class="op" id="7165174">:=</span>&nbsp;<span class="ident" id="7165177">NewDecoder</span><span class="op" id="7165187">(</span><span class="ident" id="7165188">StdEncoding</span><span class="op" id="7165199">,</span>&nbsp;<span class="ident" id="7165201">strings</span><span class="op" id="7165208">.</span><span class="ident" id="7165209">NewReader</span><span class="op" id="7165218">(</span><span class="ident" id="7165219">bigtest</span><span class="op" id="7165226">.</span><span class="ident" id="7165227">encoded</span><span class="op" id="7165234">)</span><span class="op" id="7165235">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165239">buf</span>&nbsp;<span class="op" id="7165243">:=</span>&nbsp;<span class="builtinfunc" id="7165246">make</span><span class="op" id="7165250">(</span><span class="op" id="7165251">[</span><span class="op" id="7165252">]</span><span class="builtintype" id="7165253">byte</span><span class="op" id="7165257">,</span>&nbsp;<span class="builtinfunc" id="7165259">len</span><span class="op" id="7165262">(</span><span class="ident" id="7165263">bigtest</span><span class="op" id="7165270">.</span><span class="ident" id="7165271">decoded</span><span class="op" id="7165278">)</span><span class="op" id="7165279">+</span><span class="num" id="7165280">12</span><span class="op" id="7165282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7165286">var</span>&nbsp;<span class="ident" id="7165290">total</span>&nbsp;<span class="builtintype" id="7165296">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7165302">for</span>&nbsp;<span class="ident" id="7165306">total</span>&nbsp;<span class="op" id="7165312">=</span>&nbsp;<span class="num" id="7165314">0</span><span class="op" id="7165315">;</span>&nbsp;<span class="ident" id="7165317">total</span>&nbsp;<span class="op" id="7165323">&lt;</span>&nbsp;<span class="builtinfunc" id="7165325">len</span><span class="op" id="7165328">(</span><span class="ident" id="7165329">bigtest</span><span class="op" id="7165336">.</span><span class="ident" id="7165337">decoded</span><span class="op" id="7165344">)</span><span class="op" id="7165345">;</span>&nbsp;<span class="op" id="7165347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165352">n</span><span class="op" id="7165353">,</span>&nbsp;<span class="ident" id="7165355">err</span>&nbsp;<span class="op" id="7165359">:=</span>&nbsp;<span class="ident" id="7165362">decoder</span><span class="op" id="7165369">.</span><span class="ident" id="7165370">Read</span><span class="op" id="7165374">(</span><span class="ident" id="7165375">buf</span><span class="op" id="7165378">[</span><span class="ident" id="7165379">total</span>&nbsp;<span class="op" id="7165385">:</span>&nbsp;<span class="ident" id="7165387">total</span><span class="op" id="7165392">+</span><span class="ident" id="7165393">bs</span><span class="op" id="7165395">]</span><span class="op" id="7165396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165401">testEqual</span><span class="op" id="7165410">(</span><span class="ident" id="7165411">t</span><span class="op" id="7165412">,</span>&nbsp;<span class="string" id="7165414">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7165459">,</span>&nbsp;<span class="ident" id="7165461">bigtest</span><span class="op" id="7165468">.</span><span class="ident" id="7165469">encoded</span><span class="op" id="7165476">,</span>&nbsp;<span class="ident" id="7165478">total</span><span class="op" id="7165483">,</span>&nbsp;<span class="ident" id="7165485">n</span><span class="op" id="7165486">,</span>&nbsp;<span class="ident" id="7165488">err</span><span class="op" id="7165491">,</span>&nbsp;<span class="builtintype" id="7165493">error</span><span class="op" id="7165498">(</span><span class="ident" id="7165499">nil</span><span class="op" id="7165502">)</span><span class="op" id="7165503">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165508">total</span>&nbsp;<span class="op" id="7165514">+=</span>&nbsp;<span class="ident" id="7165517">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165525">testEqual</span><span class="op" id="7165534">(</span><span class="ident" id="7165535">t</span><span class="op" id="7165536">,</span>&nbsp;<span class="string" id="7165538">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7165571">,</span>&nbsp;<span class="ident" id="7165573">bs</span><span class="op" id="7165575">,</span>&nbsp;<span class="ident" id="7165577">bigtest</span><span class="op" id="7165584">.</span><span class="ident" id="7165585">encoded</span><span class="op" id="7165592">,</span>&nbsp;<span class="builtintype" id="7165594">string</span><span class="op" id="7165600">(</span><span class="ident" id="7165601">buf</span><span class="op" id="7165604">[</span><span class="num" id="7165605">0</span><span class="op" id="7165606">:</span><span class="ident" id="7165607">total</span><span class="op" id="7165612">]</span><span class="op" id="7165613">)</span><span class="op" id="7165614">,</span>&nbsp;<span class="ident" id="7165616">bigtest</span><span class="op" id="7165623">.</span><span class="ident" id="7165624">decoded</span><span class="op" id="7165631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165634">}</span><br>
<span class="lineno"></span><span class="op" id="7165636">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="7165639">func</span>&nbsp;<span class="ident" id="7165644">TestDecodeCorrupt</span><span class="op" id="7165661">(</span><span class="ident" id="7165662">t</span>&nbsp;<span class="op" id="7165664">*</span><span class="ident" id="7165665">testing</span><span class="op" id="7165672">.</span><span class="ident" id="7165673">T</span><span class="op" id="7165674">)</span>&nbsp;<span class="op" id="7165676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165679">testCases</span>&nbsp;<span class="op" id="7165689">:=</span>&nbsp;<span class="op" id="7165692">[</span><span class="op" id="7165693">]</span><span class="keyword" id="7165694">struct</span>&nbsp;<span class="op" id="7165701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165705">input</span>&nbsp;&nbsp;<span class="builtintype" id="7165712">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7165721">offset</span>&nbsp;<span class="builtintype" id="7165728">int</span>&nbsp;<span class="comment" id="7165732">//&nbsp;-1&nbsp;means&nbsp;no&nbsp;corruption.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165760">}</span><span class="op" id="7165761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165765">{</span><span class="string" id="7165766">&#34;&#34;</span><span class="op" id="7165768">,</span>&nbsp;<span class="op" id="7165770">-</span><span class="num" id="7165771">1</span><span class="op" id="7165772">}</span><span class="op" id="7165773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165777">{</span><span class="string" id="7165778">&#34;!!!!&#34;</span><span class="op" id="7165784">,</span>&nbsp;<span class="num" id="7165786">0</span><span class="op" id="7165787">}</span><span class="op" id="7165788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165792">{</span><span class="string" id="7165793">&#34;====&#34;</span><span class="op" id="7165799">,</span>&nbsp;<span class="num" id="7165801">0</span><span class="op" id="7165802">}</span><span class="op" id="7165803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165807">{</span><span class="string" id="7165808">&#34;x===&#34;</span><span class="op" id="7165814">,</span>&nbsp;<span class="num" id="7165816">1</span><span class="op" id="7165817">}</span><span class="op" id="7165818">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165822">{</span><span class="string" id="7165823">&#34;=AAA&#34;</span><span class="op" id="7165829">,</span>&nbsp;<span class="num" id="7165831">0</span><span class="op" id="7165832">}</span><span class="op" id="7165833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165837">{</span><span class="string" id="7165838">&#34;A=AA&#34;</span><span class="op" id="7165844">,</span>&nbsp;<span class="num" id="7165846">1</span><span class="op" id="7165847">}</span><span class="op" id="7165848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165852">{</span><span class="string" id="7165853">&#34;AA=A&#34;</span><span class="op" id="7165859">,</span>&nbsp;<span class="num" id="7165861">2</span><span class="op" id="7165862">}</span><span class="op" id="7165863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165867">{</span><span class="string" id="7165868">&#34;AA==A&#34;</span><span class="op" id="7165875">,</span>&nbsp;<span class="num" id="7165877">4</span><span class="op" id="7165878">}</span><span class="op" id="7165879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165883">{</span><span class="string" id="7165884">&#34;AAA=AAAA&#34;</span><span class="op" id="7165894">,</span>&nbsp;<span class="num" id="7165896">4</span><span class="op" id="7165897">}</span><span class="op" id="7165898">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165902">{</span><span class="string" id="7165903">&#34;AAAAA&#34;</span><span class="op" id="7165910">,</span>&nbsp;<span class="num" id="7165912">4</span><span class="op" id="7165913">}</span><span class="op" id="7165914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165918">{</span><span class="string" id="7165919">&#34;AAAAAA&#34;</span><span class="op" id="7165927">,</span>&nbsp;<span class="num" id="7165929">4</span><span class="op" id="7165930">}</span><span class="op" id="7165931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165935">{</span><span class="string" id="7165936">&#34;A=&#34;</span><span class="op" id="7165940">,</span>&nbsp;<span class="num" id="7165942">1</span><span class="op" id="7165943">}</span><span class="op" id="7165944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165948">{</span><span class="string" id="7165949">&#34;A==&#34;</span><span class="op" id="7165954">,</span>&nbsp;<span class="num" id="7165956">1</span><span class="op" id="7165957">}</span><span class="op" id="7165958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165962">{</span><span class="string" id="7165963">&#34;AA=&#34;</span><span class="op" id="7165968">,</span>&nbsp;<span class="num" id="7165970">3</span><span class="op" id="7165971">}</span><span class="op" id="7165972">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165976">{</span><span class="string" id="7165977">&#34;AA==&#34;</span><span class="op" id="7165983">,</span>&nbsp;<span class="op" id="7165985">-</span><span class="num" id="7165986">1</span><span class="op" id="7165987">}</span><span class="op" id="7165988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7165992">{</span><span class="string" id="7165993">&#34;AAA=&#34;</span><span class="op" id="7165999">,</span>&nbsp;<span class="op" id="7166001">-</span><span class="num" id="7166002">1</span><span class="op" id="7166003">}</span><span class="op" id="7166004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166008">{</span><span class="string" id="7166009">&#34;AAAA&#34;</span><span class="op" id="7166015">,</span>&nbsp;<span class="op" id="7166017">-</span><span class="num" id="7166018">1</span><span class="op" id="7166019">}</span><span class="op" id="7166020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166024">{</span><span class="string" id="7166025">&#34;AAAAAA=&#34;</span><span class="op" id="7166034">,</span>&nbsp;<span class="num" id="7166036">7</span><span class="op" id="7166037">}</span><span class="op" id="7166038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166042">{</span><span class="string" id="7166043">&#34;YWJjZA=====&#34;</span><span class="op" id="7166056">,</span>&nbsp;<span class="num" id="7166058">8</span><span class="op" id="7166059">}</span><span class="op" id="7166060">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166066">for</span>&nbsp;<span class="ident" id="7166070">_</span><span class="op" id="7166071">,</span>&nbsp;<span class="ident" id="7166073">tc</span>&nbsp;<span class="op" id="7166076">:=</span>&nbsp;<span class="keyword" id="7166079">range</span>&nbsp;<span class="ident" id="7166085">testCases</span>&nbsp;<span class="op" id="7166095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166099">dbuf</span>&nbsp;<span class="op" id="7166104">:=</span>&nbsp;<span class="builtinfunc" id="7166107">make</span><span class="op" id="7166111">(</span><span class="op" id="7166112">[</span><span class="op" id="7166113">]</span><span class="builtintype" id="7166114">byte</span><span class="op" id="7166118">,</span>&nbsp;<span class="ident" id="7166120">StdEncoding</span><span class="op" id="7166131">.</span><span class="ident" id="7166132">DecodedLen</span><span class="op" id="7166142">(</span><span class="builtinfunc" id="7166143">len</span><span class="op" id="7166146">(</span><span class="ident" id="7166147">tc</span><span class="op" id="7166149">.</span><span class="ident" id="7166150">input</span><span class="op" id="7166155">)</span><span class="op" id="7166156">)</span><span class="op" id="7166157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166161">_</span><span class="op" id="7166162">,</span>&nbsp;<span class="ident" id="7166164">err</span>&nbsp;<span class="op" id="7166168">:=</span>&nbsp;<span class="ident" id="7166171">StdEncoding</span><span class="op" id="7166182">.</span><span class="ident" id="7166183">Decode</span><span class="op" id="7166189">(</span><span class="ident" id="7166190">dbuf</span><span class="op" id="7166194">,</span>&nbsp;<span class="op" id="7166196">[</span><span class="op" id="7166197">]</span><span class="builtintype" id="7166198">byte</span><span class="op" id="7166202">(</span><span class="ident" id="7166203">tc</span><span class="op" id="7166205">.</span><span class="ident" id="7166206">input</span><span class="op" id="7166211">)</span><span class="op" id="7166212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166216">if</span>&nbsp;<span class="ident" id="7166219">tc</span><span class="op" id="7166221">.</span><span class="ident" id="7166222">offset</span>&nbsp;<span class="op" id="7166229">==</span>&nbsp;<span class="op" id="7166232">-</span><span class="num" id="7166233">1</span>&nbsp;<span class="op" id="7166235">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166240">if</span>&nbsp;<span class="ident" id="7166243">err</span>&nbsp;<span class="op" id="7166247">!=</span>&nbsp;<span class="ident" id="7166250">nil</span>&nbsp;<span class="op" id="7166254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166260">t</span><span class="op" id="7166261">.</span><span class="ident" id="7166262">Error</span><span class="op" id="7166267">(</span><span class="string" id="7166268">&#34;Decoder&nbsp;wrongly&nbsp;detected&nbsp;coruption&nbsp;in&#34;</span><span class="op" id="7166307">,</span>&nbsp;<span class="ident" id="7166309">tc</span><span class="op" id="7166311">.</span><span class="ident" id="7166312">input</span><span class="op" id="7166317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166327">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166338">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166342">switch</span>&nbsp;<span class="ident" id="7166349">err</span>&nbsp;<span class="op" id="7166353">:=</span>&nbsp;<span class="ident" id="7166356">err</span><span class="op" id="7166359">.</span><span class="op" id="7166360">(</span><span class="keyword" id="7166361">type</span><span class="op" id="7166365">)</span>&nbsp;<span class="op" id="7166367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166371">case</span>&nbsp;<span class="ident" id="7166376">CorruptInputError</span><span class="op" id="7166393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166398">testEqual</span><span class="op" id="7166407">(</span><span class="ident" id="7166408">t</span><span class="op" id="7166409">,</span>&nbsp;<span class="string" id="7166411">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7166451">,</span>&nbsp;<span class="ident" id="7166453">tc</span><span class="op" id="7166455">.</span><span class="ident" id="7166456">input</span><span class="op" id="7166461">,</span>&nbsp;<span class="builtintype" id="7166463">int</span><span class="op" id="7166466">(</span><span class="ident" id="7166467">err</span><span class="op" id="7166470">)</span><span class="op" id="7166471">,</span>&nbsp;<span class="ident" id="7166473">tc</span><span class="op" id="7166475">.</span><span class="ident" id="7166476">offset</span><span class="op" id="7166482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166486">default</span><span class="op" id="7166493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166498">t</span><span class="op" id="7166499">.</span><span class="ident" id="7166500">Error</span><span class="op" id="7166505">(</span><span class="string" id="7166506">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="7166546">,</span>&nbsp;<span class="ident" id="7166548">tc</span><span class="op" id="7166550">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166557">}</span><br>
<span class="lineno"></span><span class="op" id="7166559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7166562">func</span>&nbsp;<span class="ident" id="7166567">TestBig</span><span class="op" id="7166574">(</span><span class="ident" id="7166575">t</span>&nbsp;<span class="op" id="7166577">*</span><span class="ident" id="7166578">testing</span><span class="op" id="7166585">.</span><span class="ident" id="7166586">T</span><span class="op" id="7166587">)</span>&nbsp;<span class="op" id="7166589">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166592">n</span>&nbsp;<span class="op" id="7166594">:=</span>&nbsp;<span class="num" id="7166597">3</span><span class="op" id="7166598">*</span><span class="num" id="7166599">1000</span>&nbsp;<span class="op" id="7166604">+</span>&nbsp;<span class="num" id="7166606">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166609">raw</span>&nbsp;<span class="op" id="7166613">:=</span>&nbsp;<span class="builtinfunc" id="7166616">make</span><span class="op" id="7166620">(</span><span class="op" id="7166621">[</span><span class="op" id="7166622">]</span><span class="builtintype" id="7166623">byte</span><span class="op" id="7166627">,</span>&nbsp;<span class="ident" id="7166629">n</span><span class="op" id="7166630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166633">const</span>&nbsp;<span class="ident" id="7166639">alpha</span>&nbsp;<span class="op" id="7166645">=</span>&nbsp;<span class="string" id="7166647">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166713">for</span>&nbsp;<span class="ident" id="7166717">i</span>&nbsp;<span class="op" id="7166719">:=</span>&nbsp;<span class="num" id="7166722">0</span><span class="op" id="7166723">;</span>&nbsp;<span class="ident" id="7166725">i</span>&nbsp;<span class="op" id="7166727">&lt;</span>&nbsp;<span class="ident" id="7166729">n</span><span class="op" id="7166730">;</span>&nbsp;<span class="ident" id="7166732">i</span><span class="op" id="7166733">++</span>&nbsp;<span class="op" id="7166736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166740">raw</span><span class="op" id="7166743">[</span><span class="ident" id="7166744">i</span><span class="op" id="7166745">]</span>&nbsp;<span class="op" id="7166747">=</span>&nbsp;<span class="ident" id="7166749">alpha</span><span class="op" id="7166754">[</span><span class="ident" id="7166755">i</span><span class="op" id="7166756">%</span><span class="builtinfunc" id="7166757">len</span><span class="op" id="7166760">(</span><span class="ident" id="7166761">alpha</span><span class="op" id="7166766">)</span><span class="op" id="7166767">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166773">encoded</span>&nbsp;<span class="op" id="7166781">:=</span>&nbsp;<span class="builtinfunc" id="7166784">new</span><span class="op" id="7166787">(</span><span class="ident" id="7166788">bytes</span><span class="op" id="7166793">.</span><span class="ident" id="7166794">Buffer</span><span class="op" id="7166800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166803">w</span>&nbsp;<span class="op" id="7166805">:=</span>&nbsp;<span class="ident" id="7166808">NewEncoder</span><span class="op" id="7166818">(</span><span class="ident" id="7166819">StdEncoding</span><span class="op" id="7166830">,</span>&nbsp;<span class="ident" id="7166832">encoded</span><span class="op" id="7166839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166842">nn</span><span class="op" id="7166844">,</span>&nbsp;<span class="ident" id="7166846">err</span>&nbsp;<span class="op" id="7166850">:=</span>&nbsp;<span class="ident" id="7166853">w</span><span class="op" id="7166854">.</span><span class="ident" id="7166855">Write</span><span class="op" id="7166860">(</span><span class="ident" id="7166861">raw</span><span class="op" id="7166864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166867">if</span>&nbsp;<span class="ident" id="7166870">nn</span>&nbsp;<span class="op" id="7166873">!=</span>&nbsp;<span class="ident" id="7166876">n</span>&nbsp;<span class="op" id="7166878">||</span>&nbsp;<span class="ident" id="7166881">err</span>&nbsp;<span class="op" id="7166885">!=</span>&nbsp;<span class="ident" id="7166888">nil</span>&nbsp;<span class="op" id="7166892">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166896">t</span><span class="op" id="7166897">.</span><span class="ident" id="7166898">Fatalf</span><span class="op" id="7166904">(</span><span class="string" id="7166905">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="7166947">,</span>&nbsp;<span class="ident" id="7166949">nn</span><span class="op" id="7166951">,</span>&nbsp;<span class="ident" id="7166953">err</span><span class="op" id="7166956">,</span>&nbsp;<span class="ident" id="7166958">n</span><span class="op" id="7166959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7166962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7166965">err</span>&nbsp;<span class="op" id="7166969">=</span>&nbsp;<span class="ident" id="7166971">w</span><span class="op" id="7166972">.</span><span class="ident" id="7166973">Close</span><span class="op" id="7166978">(</span><span class="op" id="7166979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7166982">if</span>&nbsp;<span class="ident" id="7166985">err</span>&nbsp;<span class="op" id="7166989">!=</span>&nbsp;<span class="ident" id="7166992">nil</span>&nbsp;<span class="op" id="7166996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167000">t</span><span class="op" id="7167001">.</span><span class="ident" id="7167002">Fatalf</span><span class="op" id="7167008">(</span><span class="string" id="7167009">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7167040">,</span>&nbsp;<span class="ident" id="7167042">err</span><span class="op" id="7167045">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7167048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167051">decoded</span><span class="op" id="7167058">,</span>&nbsp;<span class="ident" id="7167060">err</span>&nbsp;<span class="op" id="7167064">:=</span>&nbsp;<span class="ident" id="7167067">ioutil</span><span class="op" id="7167073">.</span><span class="ident" id="7167074">ReadAll</span><span class="op" id="7167081">(</span><span class="ident" id="7167082">NewDecoder</span><span class="op" id="7167092">(</span><span class="ident" id="7167093">StdEncoding</span><span class="op" id="7167104">,</span>&nbsp;<span class="ident" id="7167106">encoded</span><span class="op" id="7167113">)</span><span class="op" id="7167114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167117">if</span>&nbsp;<span class="ident" id="7167120">err</span>&nbsp;<span class="op" id="7167124">!=</span>&nbsp;<span class="ident" id="7167127">nil</span>&nbsp;<span class="op" id="7167131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167135">t</span><span class="op" id="7167136">.</span><span class="ident" id="7167137">Fatalf</span><span class="op" id="7167143">(</span><span class="string" id="7167144">&#34;ioutil.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="7167181">,</span>&nbsp;<span class="ident" id="7167183">err</span><span class="op" id="7167186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7167189">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167193">if</span>&nbsp;<span class="op" id="7167196">!</span><span class="ident" id="7167197">bytes</span><span class="op" id="7167202">.</span><span class="ident" id="7167203">Equal</span><span class="op" id="7167208">(</span><span class="ident" id="7167209">raw</span><span class="op" id="7167212">,</span>&nbsp;<span class="ident" id="7167214">decoded</span><span class="op" id="7167221">)</span>&nbsp;<span class="op" id="7167223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167227">var</span>&nbsp;<span class="ident" id="7167231">i</span>&nbsp;<span class="builtintype" id="7167233">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167239">for</span>&nbsp;<span class="ident" id="7167243">i</span>&nbsp;<span class="op" id="7167245">=</span>&nbsp;<span class="num" id="7167247">0</span><span class="op" id="7167248">;</span>&nbsp;<span class="ident" id="7167250">i</span>&nbsp;<span class="op" id="7167252">&lt;</span>&nbsp;<span class="builtinfunc" id="7167254">len</span><span class="op" id="7167257">(</span><span class="ident" id="7167258">decoded</span><span class="op" id="7167265">)</span>&nbsp;<span class="op" id="7167267">&amp;&amp;</span>&nbsp;<span class="ident" id="7167270">i</span>&nbsp;<span class="op" id="7167272">&lt;</span>&nbsp;<span class="builtinfunc" id="7167274">len</span><span class="op" id="7167277">(</span><span class="ident" id="7167278">raw</span><span class="op" id="7167281">)</span><span class="op" id="7167282">;</span>&nbsp;<span class="ident" id="7167284">i</span><span class="op" id="7167285">++</span>&nbsp;<span class="op" id="7167288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167293">if</span>&nbsp;<span class="ident" id="7167296">decoded</span><span class="op" id="7167303">[</span><span class="ident" id="7167304">i</span><span class="op" id="7167305">]</span>&nbsp;<span class="op" id="7167307">!=</span>&nbsp;<span class="ident" id="7167310">raw</span><span class="op" id="7167313">[</span><span class="ident" id="7167314">i</span><span class="op" id="7167315">]</span>&nbsp;<span class="op" id="7167317">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167323">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7167332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7167336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167340">t</span><span class="op" id="7167341">.</span><span class="ident" id="7167342">Errorf</span><span class="op" id="7167348">(</span><span class="string" id="7167349">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="7167401">,</span>&nbsp;<span class="ident" id="7167403">n</span><span class="op" id="7167404">,</span>&nbsp;<span class="ident" id="7167406">i</span><span class="op" id="7167407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7167410">}</span><br>
<span class="lineno">220</span><span class="op" id="7167412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7167415">func</span>&nbsp;<span class="ident" id="7167420">TestNewLineCharacters</span><span class="op" id="7167441">(</span><span class="ident" id="7167442">t</span>&nbsp;<span class="op" id="7167444">*</span><span class="ident" id="7167445">testing</span><span class="op" id="7167452">.</span><span class="ident" id="7167453">T</span><span class="op" id="7167454">)</span>&nbsp;<span class="op" id="7167456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7167459">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;should&nbsp;decode&nbsp;to&nbsp;the&nbsp;string&nbsp;&#34;sure&#34;,&nbsp;without&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167529">const</span>&nbsp;<span class="ident" id="7167535">expected</span>&nbsp;<span class="op" id="7167544">=</span>&nbsp;<span class="string" id="7167546">&#34;sure&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167554">examples</span>&nbsp;<span class="op" id="7167563">:=</span>&nbsp;<span class="op" id="7167566">[</span><span class="op" id="7167567">]</span><span class="builtintype" id="7167568">string</span><span class="op" id="7167574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167578">&#34;c3VyZQ==&#34;</span><span class="op" id="7167588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167592">&#34;c3VyZQ==\r&#34;</span><span class="op" id="7167604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167608">&#34;c3VyZQ==\n&#34;</span><span class="op" id="7167620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167624">&#34;c3VyZQ==\r\n&#34;</span><span class="op" id="7167638">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167642">&#34;c3VyZ\r\nQ==&#34;</span><span class="op" id="7167656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167660">&#34;c3V\ryZ\nQ==&#34;</span><span class="op" id="7167674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167678">&#34;c3V\nyZ\rQ==&#34;</span><span class="op" id="7167692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167696">&#34;c3VyZ\nQ==&#34;</span><span class="op" id="7167708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167712">&#34;c3VyZQ\n==&#34;</span><span class="op" id="7167724">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167728">&#34;c3VyZQ=\n=&#34;</span><span class="op" id="7167740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7167744">&#34;c3VyZQ=\r\n\r\n=&#34;</span><span class="op" id="7167762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7167765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167768">for</span>&nbsp;<span class="ident" id="7167772">_</span><span class="op" id="7167773">,</span>&nbsp;<span class="ident" id="7167775">e</span>&nbsp;<span class="op" id="7167777">:=</span>&nbsp;<span class="keyword" id="7167780">range</span>&nbsp;<span class="ident" id="7167786">examples</span>&nbsp;<span class="op" id="7167795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167799">buf</span><span class="op" id="7167802">,</span>&nbsp;<span class="ident" id="7167804">err</span>&nbsp;<span class="op" id="7167808">:=</span>&nbsp;<span class="ident" id="7167811">StdEncoding</span><span class="op" id="7167822">.</span><span class="ident" id="7167823">DecodeString</span><span class="op" id="7167835">(</span><span class="ident" id="7167836">e</span><span class="op" id="7167837">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167841">if</span>&nbsp;<span class="ident" id="7167844">err</span>&nbsp;<span class="op" id="7167848">!=</span>&nbsp;<span class="ident" id="7167851">nil</span>&nbsp;<span class="op" id="7167855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167860">t</span><span class="op" id="7167861">.</span><span class="ident" id="7167862">Errorf</span><span class="op" id="7167868">(</span><span class="string" id="7167869">&#34;Decode(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7167892">,</span>&nbsp;<span class="ident" id="7167894">e</span><span class="op" id="7167895">,</span>&nbsp;<span class="ident" id="7167897">err</span><span class="op" id="7167900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167905">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7167916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7167920">if</span>&nbsp;<span class="ident" id="7167923">s</span>&nbsp;<span class="op" id="7167925">:=</span>&nbsp;<span class="builtintype" id="7167928">string</span><span class="op" id="7167934">(</span><span class="ident" id="7167935">buf</span><span class="op" id="7167938">)</span><span class="op" id="7167939">;</span>&nbsp;<span class="ident" id="7167941">s</span>&nbsp;<span class="op" id="7167943">!=</span>&nbsp;<span class="ident" id="7167946">expected</span>&nbsp;<span class="op" id="7167955">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7167960">t</span><span class="op" id="7167961">.</span><span class="ident" id="7167962">Errorf</span><span class="op" id="7167968">(</span><span class="string" id="7167969">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7167995">,</span>&nbsp;<span class="ident" id="7167997">e</span><span class="op" id="7167998">,</span>&nbsp;<span class="ident" id="7168000">s</span><span class="op" id="7168001">,</span>&nbsp;<span class="ident" id="7168003">expected</span><span class="op" id="7168011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7168015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7168018">}</span><br>
<span class="lineno"></span><span class="op" id="7168020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7168023">type</span>&nbsp;<span class="ident" id="7168028">nextRead</span>&nbsp;<span class="keyword" id="7168037">struct</span>&nbsp;<span class="op" id="7168044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168047">n</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7168051">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7168057">//&nbsp;bytes&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168077">err</span>&nbsp;<span class="builtintype" id="7168081">error</span>&nbsp;<span class="comment" id="7168087">//&nbsp;error&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="op" id="7168106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="7168109">//&nbsp;faultInjectReader&nbsp;returns&nbsp;data&nbsp;from&nbsp;source,&nbsp;rate-limited</span><br>
<span class="lineno"></span><span class="comment" id="7168169">//&nbsp;and&nbsp;with&nbsp;the&nbsp;errors&nbsp;as&nbsp;written&nbsp;to&nbsp;nextc.</span><br>
<span class="lineno"></span><span class="keyword" id="7168213">type</span>&nbsp;<span class="ident" id="7168218">faultInjectReader</span>&nbsp;<span class="keyword" id="7168236">struct</span>&nbsp;<span class="op" id="7168243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168246">source</span>&nbsp;<span class="builtintype" id="7168253">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168261">nextc</span>&nbsp;&nbsp;<span class="op" id="7168268">&lt;-</span><span class="keyword" id="7168270">chan</span>&nbsp;<span class="ident" id="7168275">nextRead</span><br>
<span class="lineno">260</span><span class="op" id="7168284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7168287">func</span>&nbsp;<span class="op" id="7168292">(</span><span class="ident" id="7168293">r</span>&nbsp;<span class="op" id="7168295">*</span><span class="ident" id="7168296">faultInjectReader</span><span class="op" id="7168313">)</span>&nbsp;<span class="ident" id="7168315">Read</span><span class="op" id="7168319">(</span><span class="ident" id="7168320">p</span>&nbsp;<span class="op" id="7168322">[</span><span class="op" id="7168323">]</span><span class="builtintype" id="7168324">byte</span><span class="op" id="7168328">)</span>&nbsp;<span class="op" id="7168330">(</span><span class="builtintype" id="7168331">int</span><span class="op" id="7168334">,</span>&nbsp;<span class="builtintype" id="7168336">error</span><span class="op" id="7168341">)</span>&nbsp;<span class="op" id="7168343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168346">nr</span>&nbsp;<span class="op" id="7168349">:=</span>&nbsp;<span class="op" id="7168352">&lt;-</span><span class="ident" id="7168354">r</span><span class="op" id="7168355">.</span><span class="ident" id="7168356">nextc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7168363">if</span>&nbsp;<span class="builtinfunc" id="7168366">len</span><span class="op" id="7168369">(</span><span class="ident" id="7168370">p</span><span class="op" id="7168371">)</span>&nbsp;<span class="op" id="7168373">&gt;</span>&nbsp;<span class="ident" id="7168375">nr</span><span class="op" id="7168377">.</span><span class="ident" id="7168378">n</span>&nbsp;<span class="op" id="7168380">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168384">p</span>&nbsp;<span class="op" id="7168386">=</span>&nbsp;<span class="ident" id="7168388">p</span><span class="op" id="7168389">[</span><span class="op" id="7168390">:</span><span class="ident" id="7168391">nr</span><span class="op" id="7168393">.</span><span class="ident" id="7168394">n</span><span class="op" id="7168395">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7168398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168401">n</span>&nbsp;<span class="op" id="7168403">:=</span>&nbsp;<span class="builtinfunc" id="7168406">copy</span><span class="op" id="7168410">(</span><span class="ident" id="7168411">p</span><span class="op" id="7168412">,</span>&nbsp;<span class="ident" id="7168414">r</span><span class="op" id="7168415">.</span><span class="ident" id="7168416">source</span><span class="op" id="7168422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168425">r</span><span class="op" id="7168426">.</span><span class="ident" id="7168427">source</span>&nbsp;<span class="op" id="7168434">=</span>&nbsp;<span class="ident" id="7168436">r</span><span class="op" id="7168437">.</span><span class="ident" id="7168438">source</span><span class="op" id="7168444">[</span><span class="ident" id="7168445">n</span><span class="op" id="7168446">:</span><span class="op" id="7168447">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7168450">return</span>&nbsp;<span class="ident" id="7168457">n</span><span class="op" id="7168458">,</span>&nbsp;<span class="ident" id="7168460">nr</span><span class="op" id="7168462">.</span><span class="ident" id="7168463">err</span><br>
<span class="lineno">270</span><span class="op" id="7168467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7168470">//&nbsp;tests&nbsp;that&nbsp;we&nbsp;don&#39;t&nbsp;ignore&nbsp;errors&nbsp;from&nbsp;our&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span><span class="keyword" id="7168534">func</span>&nbsp;<span class="ident" id="7168539">TestDecoderIssue3577</span><span class="op" id="7168559">(</span><span class="ident" id="7168560">t</span>&nbsp;<span class="op" id="7168562">*</span><span class="ident" id="7168563">testing</span><span class="op" id="7168570">.</span><span class="ident" id="7168571">T</span><span class="op" id="7168572">)</span>&nbsp;<span class="op" id="7168574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168577">next</span>&nbsp;<span class="op" id="7168582">:=</span>&nbsp;<span class="builtinfunc" id="7168585">make</span><span class="op" id="7168589">(</span><span class="keyword" id="7168590">chan</span>&nbsp;<span class="ident" id="7168595">nextRead</span><span class="op" id="7168603">,</span>&nbsp;<span class="num" id="7168605">10</span><span class="op" id="7168607">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168610">wantErr</span>&nbsp;<span class="op" id="7168618">:=</span>&nbsp;<span class="ident" id="7168621">errors</span><span class="op" id="7168627">.</span><span class="ident" id="7168628">New</span><span class="op" id="7168631">(</span><span class="string" id="7168632">&#34;my&nbsp;error&#34;</span><span class="op" id="7168642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168645">next</span>&nbsp;<span class="op" id="7168650">&lt;-</span>&nbsp;<span class="ident" id="7168653">nextRead</span><span class="op" id="7168661">{</span><span class="num" id="7168662">5</span><span class="op" id="7168663">,</span>&nbsp;<span class="ident" id="7168665">nil</span><span class="op" id="7168668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168671">next</span>&nbsp;<span class="op" id="7168676">&lt;-</span>&nbsp;<span class="ident" id="7168679">nextRead</span><span class="op" id="7168687">{</span><span class="num" id="7168688">10</span><span class="op" id="7168690">,</span>&nbsp;<span class="ident" id="7168692">wantErr</span><span class="op" id="7168699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168702">next</span>&nbsp;<span class="op" id="7168707">&lt;-</span>&nbsp;<span class="ident" id="7168710">nextRead</span><span class="op" id="7168718">{</span><span class="num" id="7168719">0</span><span class="op" id="7168720">,</span>&nbsp;<span class="ident" id="7168722">wantErr</span><span class="op" id="7168729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168732">d</span>&nbsp;<span class="op" id="7168734">:=</span>&nbsp;<span class="ident" id="7168737">NewDecoder</span><span class="op" id="7168747">(</span><span class="ident" id="7168748">StdEncoding</span><span class="op" id="7168759">,</span>&nbsp;<span class="op" id="7168761">&amp;</span><span class="ident" id="7168762">faultInjectReader</span><span class="op" id="7168779">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168783">source</span><span class="op" id="7168789">:</span>&nbsp;<span class="string" id="7168791">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="7168841">,</span>&nbsp;<span class="comment" id="7168843">//&nbsp;twas&nbsp;brillig...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168864">nextc</span><span class="op" id="7168869">:</span>&nbsp;&nbsp;<span class="ident" id="7168872">next</span><span class="op" id="7168876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7168879">}</span><span class="op" id="7168880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168883">errc</span>&nbsp;<span class="op" id="7168888">:=</span>&nbsp;<span class="builtinfunc" id="7168891">make</span><span class="op" id="7168895">(</span><span class="keyword" id="7168896">chan</span>&nbsp;<span class="builtintype" id="7168901">error</span><span class="op" id="7168906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7168909">go</span>&nbsp;<span class="keyword" id="7168912">func</span><span class="op" id="7168916">(</span><span class="op" id="7168917">)</span>&nbsp;<span class="op" id="7168919">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168923">_</span><span class="op" id="7168924">,</span>&nbsp;<span class="ident" id="7168926">err</span>&nbsp;<span class="op" id="7168930">:=</span>&nbsp;<span class="ident" id="7168933">ioutil</span><span class="op" id="7168939">.</span><span class="ident" id="7168940">ReadAll</span><span class="op" id="7168947">(</span><span class="ident" id="7168948">d</span><span class="op" id="7168949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7168953">errc</span>&nbsp;<span class="op" id="7168958">&lt;-</span>&nbsp;<span class="ident" id="7168961">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7168966">}</span><span class="op" id="7168967">(</span><span class="op" id="7168968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7168971">select</span>&nbsp;<span class="op" id="7168978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7168981">case</span>&nbsp;<span class="ident" id="7168986">err</span>&nbsp;<span class="op" id="7168990">:=</span>&nbsp;<span class="op" id="7168993">&lt;-</span><span class="ident" id="7168995">errc</span><span class="op" id="7168999">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7169003">if</span>&nbsp;<span class="ident" id="7169006">err</span>&nbsp;<span class="op" id="7169010">!=</span>&nbsp;<span class="ident" id="7169013">wantErr</span>&nbsp;<span class="op" id="7169021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7169026">t</span><span class="op" id="7169027">.</span><span class="ident" id="7169028">Errorf</span><span class="op" id="7169034">(</span><span class="string" id="7169035">&#34;got&nbsp;error&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7169058">,</span>&nbsp;<span class="ident" id="7169060">err</span><span class="op" id="7169063">,</span>&nbsp;<span class="ident" id="7169065">wantErr</span><span class="op" id="7169072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7169076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7169079">case</span>&nbsp;<span class="op" id="7169084">&lt;-</span><span class="ident" id="7169086">time</span><span class="op" id="7169090">.</span><span class="ident" id="7169091">After</span><span class="op" id="7169096">(</span><span class="num" id="7169097">5</span>&nbsp;<span class="op" id="7169099">*</span>&nbsp;<span class="ident" id="7169101">time</span><span class="op" id="7169105">.</span><span class="ident" id="7169106">Second</span><span class="op" id="7169112">)</span><span class="op" id="7169113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7169117">t</span><span class="op" id="7169118">.</span><span class="ident" id="7169119">Errorf</span><span class="op" id="7169125">(</span><span class="string" id="7169126">&#34;timeout;&nbsp;Decoder&nbsp;blocked&nbsp;without&nbsp;returning&nbsp;an&nbsp;error&#34;</span><span class="op" id="7169179">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7169182">}</span><br>
<span class="lineno"></span><span class="op" id="7169184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7169187">func</span>&nbsp;<span class="ident" id="7169192">TestDecoderIssue4779</span><span class="op" id="7169212">(</span><span class="ident" id="7169213">t</span>&nbsp;<span class="op" id="7169215">*</span><span class="ident" id="7169216">testing</span><span class="op" id="7169223">.</span><span class="ident" id="7169224">T</span><span class="op" id="7169225">)</span>&nbsp;<span class="op" id="7169227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7169230">encoded</span>&nbsp;<span class="op" id="7169238">:=</span>&nbsp;<span class="string" id="7169241">`CP/EAT8AAAEF<br>
<span class="lineno">300</span>AQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAAB<br>
<span class="lineno"></span>BAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHx<br>
<span class="lineno"></span>Y3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm<br>
<span class="lineno"></span>9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS<br>
<span class="lineno"></span>0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi8rOEw9N14/NGlKSFtJXE1OT0<br>
<span class="lineno">305</span>pbXF1eX1VmZ2hpamtsbW5vYnN0dXZ3eHl6e3x//aAAwDAQACEQMRAD8A9VSSSSUpJJJJSkkkJ+Tj<br>
<span class="lineno"></span>1kiy1jCJJDnAcCTykpKkuQ6p/jN6FgmxlNduXawwAzaGH+V6jn/R/wCt71zdn+N/qL3kVYFNYB4N<br>
<span class="lineno"></span>ji6PDVjWpKp9TSXnvTf8bFNjg3qOEa2n6VlLpj/rT/pf567DpX1i6L1hs9Py67X8mqdtg/rUWbbf<br>
<span class="lineno"></span>+gkp0kkkklKSSSSUpJJJJT//0PVUkkklKVLq3WMDpGI7KzrNjADtYNXvI/Mqr/Pd/q9W3vaxjnvM<br>
<span class="lineno"></span>NaCXE9gNSvGPrf8AWS3qmba5jjsJhoB0DAf0NDf6sevf+/lf8Hj0JJATfWT6/dV6oXU1uOLQeKKn<br>
<span class="lineno">310</span>EQP+Hubtfe/+R7Mf/g7f5xcocp++Z11JMCJPgFBxOg7/AOuqDx8I/ikpkXkmSdU8mJIJA/O8EMAy<br>
<span class="lineno"></span>j+mSARB/17pKVXYWHXjsj7yIex0PadzXMO1zT5KHoNA3HT8ietoGhgjsfA+CSnvvqh/jJtqsrwOv<br>
<span class="lineno"></span>2b6NGNzXfTYexzJ+nU7/ALkf4P8Awv6P9KvTQQ4AgyDqCF85Pho3CTB7eHwXoH+LT65uZbX9X+o2<br>
<span class="lineno"></span>bqbPb06551Y4<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170272">encodedShort</span>&nbsp;<span class="op" id="7170285">:=</span>&nbsp;<span class="ident" id="7170288">strings</span><span class="op" id="7170295">.</span><span class="ident" id="7170296">Replace</span><span class="op" id="7170303">(</span><span class="ident" id="7170304">encoded</span><span class="op" id="7170311">,</span>&nbsp;<span class="string" id="7170313">&#34;\n&#34;</span><span class="op" id="7170317">,</span>&nbsp;<span class="string" id="7170319">&#34;&#34;</span><span class="op" id="7170321">,</span>&nbsp;<span class="op" id="7170323">-</span><span class="num" id="7170324">1</span><span class="op" id="7170325">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170329">dec</span>&nbsp;<span class="op" id="7170333">:=</span>&nbsp;<span class="ident" id="7170336">NewDecoder</span><span class="op" id="7170346">(</span><span class="ident" id="7170347">StdEncoding</span><span class="op" id="7170358">,</span>&nbsp;<span class="ident" id="7170360">strings</span><span class="op" id="7170367">.</span><span class="ident" id="7170368">NewReader</span><span class="op" id="7170377">(</span><span class="ident" id="7170378">encoded</span><span class="op" id="7170385">)</span><span class="op" id="7170386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170389">res1</span><span class="op" id="7170393">,</span>&nbsp;<span class="ident" id="7170395">err</span>&nbsp;<span class="op" id="7170399">:=</span>&nbsp;<span class="ident" id="7170402">ioutil</span><span class="op" id="7170408">.</span><span class="ident" id="7170409">ReadAll</span><span class="op" id="7170416">(</span><span class="ident" id="7170417">dec</span><span class="op" id="7170420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7170423">if</span>&nbsp;<span class="ident" id="7170426">err</span>&nbsp;<span class="op" id="7170430">!=</span>&nbsp;<span class="ident" id="7170433">nil</span>&nbsp;<span class="op" id="7170437">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170441">t</span><span class="op" id="7170442">.</span><span class="ident" id="7170443">Errorf</span><span class="op" id="7170449">(</span><span class="string" id="7170450">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7170470">,</span>&nbsp;<span class="ident" id="7170472">err</span><span class="op" id="7170475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7170478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170482">dec</span>&nbsp;<span class="op" id="7170486">=</span>&nbsp;<span class="ident" id="7170488">NewDecoder</span><span class="op" id="7170498">(</span><span class="ident" id="7170499">StdEncoding</span><span class="op" id="7170510">,</span>&nbsp;<span class="ident" id="7170512">strings</span><span class="op" id="7170519">.</span><span class="ident" id="7170520">NewReader</span><span class="op" id="7170529">(</span><span class="ident" id="7170530">encodedShort</span><span class="op" id="7170542">)</span><span class="op" id="7170543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7170546">var</span>&nbsp;<span class="ident" id="7170550">res2</span>&nbsp;<span class="op" id="7170555">[</span><span class="op" id="7170556">]</span><span class="builtintype" id="7170557">byte</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170563">res2</span><span class="op" id="7170567">,</span>&nbsp;<span class="ident" id="7170569">err</span>&nbsp;<span class="op" id="7170573">=</span>&nbsp;<span class="ident" id="7170575">ioutil</span><span class="op" id="7170581">.</span><span class="ident" id="7170582">ReadAll</span><span class="op" id="7170589">(</span><span class="ident" id="7170590">dec</span><span class="op" id="7170593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7170596">if</span>&nbsp;<span class="ident" id="7170599">err</span>&nbsp;<span class="op" id="7170603">!=</span>&nbsp;<span class="ident" id="7170606">nil</span>&nbsp;<span class="op" id="7170610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170614">t</span><span class="op" id="7170615">.</span><span class="ident" id="7170616">Errorf</span><span class="op" id="7170622">(</span><span class="string" id="7170623">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7170643">,</span>&nbsp;<span class="ident" id="7170645">err</span><span class="op" id="7170648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7170651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7170655">if</span>&nbsp;<span class="op" id="7170658">!</span><span class="ident" id="7170659">bytes</span><span class="op" id="7170664">.</span><span class="ident" id="7170665">Equal</span><span class="op" id="7170670">(</span><span class="ident" id="7170671">res1</span><span class="op" id="7170675">,</span>&nbsp;<span class="ident" id="7170677">res2</span><span class="op" id="7170681">)</span>&nbsp;<span class="op" id="7170683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170687">t</span><span class="op" id="7170688">.</span><span class="ident" id="7170689">Error</span><span class="op" id="7170694">(</span><span class="string" id="7170695">&#34;Decoded&nbsp;results&nbsp;not&nbsp;equal&#34;</span><span class="op" id="7170722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7170725">}</span><br>
<span class="lineno"></span><span class="op" id="7170727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="7170730">func</span>&nbsp;<span class="ident" id="7170735">TestDecoderIssue7733</span><span class="op" id="7170755">(</span><span class="ident" id="7170756">t</span>&nbsp;<span class="op" id="7170758">*</span><span class="ident" id="7170759">testing</span><span class="op" id="7170766">.</span><span class="ident" id="7170767">T</span><span class="op" id="7170768">)</span>&nbsp;<span class="op" id="7170770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170773">s</span><span class="op" id="7170774">,</span>&nbsp;<span class="ident" id="7170776">err</span>&nbsp;<span class="op" id="7170780">:=</span>&nbsp;<span class="ident" id="7170783">StdEncoding</span><span class="op" id="7170794">.</span><span class="ident" id="7170795">DecodeString</span><span class="op" id="7170807">(</span><span class="string" id="7170808">&#34;YWJjZA=====&#34;</span><span class="op" id="7170821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170824">want</span>&nbsp;<span class="op" id="7170829">:=</span>&nbsp;<span class="ident" id="7170832">CorruptInputError</span><span class="op" id="7170849">(</span><span class="num" id="7170850">8</span><span class="op" id="7170851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7170854">if</span>&nbsp;<span class="op" id="7170857">!</span><span class="ident" id="7170858">reflect</span><span class="op" id="7170865">.</span><span class="ident" id="7170866">DeepEqual</span><span class="op" id="7170875">(</span><span class="ident" id="7170876">want</span><span class="op" id="7170880">,</span>&nbsp;<span class="ident" id="7170882">err</span><span class="op" id="7170885">)</span>&nbsp;<span class="op" id="7170887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170891">t</span><span class="op" id="7170892">.</span><span class="ident" id="7170893">Errorf</span><span class="op" id="7170899">(</span><span class="string" id="7170900">&#34;Error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;CorruptInputError(8)&#34;</span><span class="op" id="7170939">,</span>&nbsp;<span class="ident" id="7170941">err</span><span class="op" id="7170944">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7170947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7170950">if</span>&nbsp;<span class="builtintype" id="7170953">string</span><span class="op" id="7170959">(</span><span class="ident" id="7170960">s</span><span class="op" id="7170961">)</span>&nbsp;<span class="op" id="7170963">!=</span>&nbsp;<span class="string" id="7170966">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7170973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7170977">t</span><span class="op" id="7170978">.</span><span class="ident" id="7170979">Errorf</span><span class="op" id="7170985">(</span><span class="string" id="7170986">&#34;DecodeString&nbsp;=&nbsp;%q;&nbsp;want&nbsp;abcd&#34;</span><span class="op" id="7171016">,</span>&nbsp;<span class="ident" id="7171018">s</span><span class="op" id="7171019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7171022">}</span><br>
<span class="lineno"></span><span class="op" id="7171024">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="7171027">func</span>&nbsp;<span class="ident" id="7171032">BenchmarkEncodeToString</span><span class="op" id="7171055">(</span><span class="ident" id="7171056">b</span>&nbsp;<span class="op" id="7171058">*</span><span class="ident" id="7171059">testing</span><span class="op" id="7171066">.</span><span class="ident" id="7171067">B</span><span class="op" id="7171068">)</span>&nbsp;<span class="op" id="7171070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7171073">data</span>&nbsp;<span class="op" id="7171078">:=</span>&nbsp;<span class="builtinfunc" id="7171081">make</span><span class="op" id="7171085">(</span><span class="op" id="7171086">[</span><span class="op" id="7171087">]</span><span class="builtintype" id="7171088">byte</span><span class="op" id="7171092">,</span>&nbsp;<span class="num" id="7171094">8192</span><span class="op" id="7171098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7171101">b</span><span class="op" id="7171102">.</span><span class="ident" id="7171103">SetBytes</span><span class="op" id="7171111">(</span><span class="ident" id="7171112">int64</span><span class="op" id="7171117">(</span><span class="builtinfunc" id="7171118">len</span><span class="op" id="7171121">(</span><span class="ident" id="7171122">data</span><span class="op" id="7171126">)</span><span class="op" id="7171127">)</span><span class="op" id="7171128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7171131">for</span>&nbsp;<span class="ident" id="7171135">i</span>&nbsp;<span class="op" id="7171137">:=</span>&nbsp;<span class="num" id="7171140">0</span><span class="op" id="7171141">;</span>&nbsp;<span class="ident" id="7171143">i</span>&nbsp;<span class="op" id="7171145">&lt;</span>&nbsp;<span class="ident" id="7171147">b</span><span class="op" id="7171148">.</span><span class="ident" id="7171149">N</span><span class="op" id="7171150">;</span>&nbsp;<span class="ident" id="7171152">i</span><span class="op" id="7171153">++</span>&nbsp;<span class="op" id="7171156">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7171160">StdEncoding</span><span class="op" id="7171171">.</span><span class="ident" id="7171172">EncodeToString</span><span class="op" id="7171186">(</span><span class="ident" id="7171187">data</span><span class="op" id="7171191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7171194">}</span><br>
<span class="lineno"></span><span class="op" id="7171196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7171199">func</span>&nbsp;<span class="ident" id="7171204">BenchmarkDecodeString</span><span class="op" id="7171225">(</span><span class="ident" id="7171226">b</span>&nbsp;<span class="op" id="7171228">*</span><span class="ident" id="7171229">testing</span><span class="op" id="7171236">.</span><span class="ident" id="7171237">B</span><span class="op" id="7171238">)</span>&nbsp;<span class="op" id="7171240">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7171243">data</span>&nbsp;<span class="op" id="7171248">:=</span>&nbsp;<span class="ident" id="7171251">StdEncoding</span><span class="op" id="7171262">.</span><span class="ident" id="7171263">EncodeToString</span><span class="op" id="7171277">(</span><span class="builtinfunc" id="7171278">make</span><span class="op" id="7171282">(</span><span class="op" id="7171283">[</span><span class="op" id="7171284">]</span><span class="builtintype" id="7171285">byte</span><span class="op" id="7171289">,</span>&nbsp;<span class="num" id="7171291">8192</span><span class="op" id="7171295">)</span><span class="op" id="7171296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7171299">b</span><span class="op" id="7171300">.</span><span class="ident" id="7171301">SetBytes</span><span class="op" id="7171309">(</span><span class="ident" id="7171310">int64</span><span class="op" id="7171315">(</span><span class="builtinfunc" id="7171316">len</span><span class="op" id="7171319">(</span><span class="ident" id="7171320">data</span><span class="op" id="7171324">)</span><span class="op" id="7171325">)</span><span class="op" id="7171326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7171329">for</span>&nbsp;<span class="ident" id="7171333">i</span>&nbsp;<span class="op" id="7171335">:=</span>&nbsp;<span class="num" id="7171338">0</span><span class="op" id="7171339">;</span>&nbsp;<span class="ident" id="7171341">i</span>&nbsp;<span class="op" id="7171343">&lt;</span>&nbsp;<span class="ident" id="7171345">b</span><span class="op" id="7171346">.</span><span class="ident" id="7171347">N</span><span class="op" id="7171348">;</span>&nbsp;<span class="ident" id="7171350">i</span><span class="op" id="7171351">++</span>&nbsp;<span class="op" id="7171354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7171358">StdEncoding</span><span class="op" id="7171369">.</span><span class="ident" id="7171370">DecodeString</span><span class="op" id="7171382">(</span><span class="ident" id="7171383">data</span><span class="op" id="7171387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7171390">}</span><br>
<span class="lineno">360</span><span class="op" id="7171392">}</span>
</div>
</body>
</html>
