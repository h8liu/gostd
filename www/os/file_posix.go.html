<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2219947">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2220002">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2220056">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2220107">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2220185">package</span>&nbsp;<span class="ident" id="2220193">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2220197">import</span>&nbsp;<span class="op" id="2220204">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2220207">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2220218">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2220225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2220228">func</span>&nbsp;<span class="ident" id="2220233">sigpipe</span><span class="op" id="2220240">(</span><span class="op" id="2220241">)</span>&nbsp;<span class="comment" id="2220243">//&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2220278">//&nbsp;Readlink&nbsp;returns&nbsp;the&nbsp;destination&nbsp;of&nbsp;the&nbsp;named&nbsp;symbolic&nbsp;link.</span><br>
<span class="lineno"></span><span class="comment" id="2220342">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2220398">func</span>&nbsp;<span class="ident" id="2220403">Readlink</span><span class="op" id="2220411">(</span><span class="ident" id="2220412">name</span>&nbsp;<span class="builtintype" id="2220417">string</span><span class="op" id="2220423">)</span>&nbsp;<span class="op" id="2220425">(</span><span class="builtintype" id="2220426">string</span><span class="op" id="2220432">,</span>&nbsp;<span class="builtintype" id="2220434">error</span><span class="op" id="2220439">)</span>&nbsp;<span class="op" id="2220441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220444">for</span>&nbsp;<span class="builtinfunc" id="2220448">len</span>&nbsp;<span class="op" id="2220452">:=</span>&nbsp;<span class="num" id="2220455">128</span><span class="op" id="2220458">;</span>&nbsp;<span class="op" id="2220460">;</span>&nbsp;<span class="builtinfunc" id="2220462">len</span>&nbsp;<span class="op" id="2220466">*=</span>&nbsp;<span class="num" id="2220469">2</span>&nbsp;<span class="op" id="2220471">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220475">b</span>&nbsp;<span class="op" id="2220477">:=</span>&nbsp;<span class="builtinfunc" id="2220480">make</span><span class="op" id="2220484">(</span><span class="op" id="2220485">[</span><span class="op" id="2220486">]</span><span class="builtintype" id="2220487">byte</span><span class="op" id="2220491">,</span>&nbsp;<span class="builtinfunc" id="2220493">len</span><span class="op" id="2220496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220500">n</span><span class="op" id="2220501">,</span>&nbsp;<span class="ident" id="2220503">e</span>&nbsp;<span class="op" id="2220505">:=</span>&nbsp;<span class="ident" id="2220508">fixCount</span><span class="op" id="2220516">(</span><span class="ident" id="2220517">syscall</span><span class="op" id="2220524">.</span><span class="ident" id="2220525">Readlink</span><span class="op" id="2220533">(</span><span class="ident" id="2220534">name</span><span class="op" id="2220538">,</span>&nbsp;<span class="ident" id="2220540">b</span><span class="op" id="2220541">)</span><span class="op" id="2220542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220546">if</span>&nbsp;<span class="ident" id="2220549">e</span>&nbsp;<span class="op" id="2220551">!=</span>&nbsp;<span class="ident" id="2220554">nil</span>&nbsp;<span class="op" id="2220558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220563">return</span>&nbsp;<span class="string" id="2220570">&#34;&#34;</span><span class="op" id="2220572">,</span>&nbsp;<span class="op" id="2220574">&amp;</span><span class="ident" id="2220575">PathError</span><span class="op" id="2220584">{</span><span class="string" id="2220585">&#34;readlink&#34;</span><span class="op" id="2220595">,</span>&nbsp;<span class="ident" id="2220597">name</span><span class="op" id="2220601">,</span>&nbsp;<span class="ident" id="2220603">e</span><span class="op" id="2220604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220608">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220612">if</span>&nbsp;<span class="ident" id="2220615">n</span>&nbsp;<span class="op" id="2220617">&lt;</span>&nbsp;<span class="builtinfunc" id="2220619">len</span>&nbsp;<span class="op" id="2220623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220628">return</span>&nbsp;<span class="builtintype" id="2220635">string</span><span class="op" id="2220641">(</span><span class="ident" id="2220642">b</span><span class="op" id="2220643">[</span><span class="num" id="2220644">0</span><span class="op" id="2220645">:</span><span class="ident" id="2220646">n</span><span class="op" id="2220647">]</span><span class="op" id="2220648">)</span><span class="op" id="2220649">,</span>&nbsp;<span class="ident" id="2220651">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220660">}</span><br>
<span class="lineno"></span><span class="op" id="2220662">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2220665">func</span>&nbsp;<span class="ident" id="2220670">rename</span><span class="op" id="2220676">(</span><span class="ident" id="2220677">oldname</span><span class="op" id="2220684">,</span>&nbsp;<span class="ident" id="2220686">newname</span>&nbsp;<span class="builtintype" id="2220694">string</span><span class="op" id="2220700">)</span>&nbsp;<span class="builtintype" id="2220702">error</span>&nbsp;<span class="op" id="2220708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220711">e</span>&nbsp;<span class="op" id="2220713">:=</span>&nbsp;<span class="ident" id="2220716">syscall</span><span class="op" id="2220723">.</span><span class="ident" id="2220724">Rename</span><span class="op" id="2220730">(</span><span class="ident" id="2220731">oldname</span><span class="op" id="2220738">,</span>&nbsp;<span class="ident" id="2220740">newname</span><span class="op" id="2220747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220750">if</span>&nbsp;<span class="ident" id="2220753">e</span>&nbsp;<span class="op" id="2220755">!=</span>&nbsp;<span class="ident" id="2220758">nil</span>&nbsp;<span class="op" id="2220762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220766">return</span>&nbsp;<span class="op" id="2220773">&amp;</span><span class="ident" id="2220774">LinkError</span><span class="op" id="2220783">{</span><span class="string" id="2220784">&#34;rename&#34;</span><span class="op" id="2220792">,</span>&nbsp;<span class="ident" id="2220794">oldname</span><span class="op" id="2220801">,</span>&nbsp;<span class="ident" id="2220803">newname</span><span class="op" id="2220810">,</span>&nbsp;<span class="ident" id="2220812">e</span><span class="op" id="2220813">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220819">return</span>&nbsp;<span class="ident" id="2220826">nil</span><br>
<span class="lineno"></span><span class="op" id="2220830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2220833">//&nbsp;syscallMode&nbsp;returns&nbsp;the&nbsp;syscall-specific&nbsp;mode&nbsp;bits&nbsp;from&nbsp;Go&#39;s&nbsp;portable&nbsp;mode&nbsp;bits.</span><br>
<span class="lineno">40</span><span class="keyword" id="2220917">func</span>&nbsp;<span class="ident" id="2220922">syscallMode</span><span class="op" id="2220933">(</span><span class="ident" id="2220934">i</span>&nbsp;<span class="ident" id="2220936">FileMode</span><span class="op" id="2220944">)</span>&nbsp;<span class="op" id="2220946">(</span><span class="ident" id="2220947">o</span>&nbsp;<span class="builtintype" id="2220949">uint32</span><span class="op" id="2220955">)</span>&nbsp;<span class="op" id="2220957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220960">o</span>&nbsp;<span class="op" id="2220962">|=</span>&nbsp;<span class="builtintype" id="2220965">uint32</span><span class="op" id="2220971">(</span><span class="ident" id="2220972">i</span><span class="op" id="2220973">.</span><span class="ident" id="2220974">Perm</span><span class="op" id="2220978">(</span><span class="op" id="2220979">)</span><span class="op" id="2220980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220983">if</span>&nbsp;<span class="ident" id="2220986">i</span><span class="op" id="2220987">&amp;</span><span class="ident" id="2220988">ModeSetuid</span>&nbsp;<span class="op" id="2220999">!=</span>&nbsp;<span class="num" id="2221002">0</span>&nbsp;<span class="op" id="2221004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2221008">o</span>&nbsp;<span class="op" id="2221010">|=</span>&nbsp;<span class="ident" id="2221013">syscall</span><span class="op" id="2221020">.</span><span class="ident" id="2221021">S_ISUID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221030">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221033">if</span>&nbsp;<span class="ident" id="2221036">i</span><span class="op" id="2221037">&amp;</span><span class="ident" id="2221038">ModeSetgid</span>&nbsp;<span class="op" id="2221049">!=</span>&nbsp;<span class="num" id="2221052">0</span>&nbsp;<span class="op" id="2221054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2221058">o</span>&nbsp;<span class="op" id="2221060">|=</span>&nbsp;<span class="ident" id="2221063">syscall</span><span class="op" id="2221070">.</span><span class="ident" id="2221071">S_ISGID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221083">if</span>&nbsp;<span class="ident" id="2221086">i</span><span class="op" id="2221087">&amp;</span><span class="ident" id="2221088">ModeSticky</span>&nbsp;<span class="op" id="2221099">!=</span>&nbsp;<span class="num" id="2221102">0</span>&nbsp;<span class="op" id="2221104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2221108">o</span>&nbsp;<span class="op" id="2221110">|=</span>&nbsp;<span class="ident" id="2221113">syscall</span><span class="op" id="2221120">.</span><span class="ident" id="2221121">S_ISVTX</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2221133">//&nbsp;No&nbsp;mapping&nbsp;for&nbsp;Go&#39;s&nbsp;ModeTemporary&nbsp;(plan9&nbsp;only).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221185">return</span><br>
<span class="lineno"></span><span class="op" id="2221192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2221195">//&nbsp;Chmod&nbsp;changes&nbsp;the&nbsp;mode&nbsp;of&nbsp;the&nbsp;named&nbsp;file&nbsp;to&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="2221248">//&nbsp;If&nbsp;the&nbsp;file&nbsp;is&nbsp;a&nbsp;symbolic&nbsp;link,&nbsp;it&nbsp;changes&nbsp;the&nbsp;mode&nbsp;of&nbsp;the&nbsp;link&#39;s&nbsp;target.</span><br>
<span class="lineno"></span><span class="comment" id="2221325">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2221381">func</span>&nbsp;<span class="ident" id="2221386">Chmod</span><span class="op" id="2221391">(</span><span class="ident" id="2221392">name</span>&nbsp;<span class="builtintype" id="2221397">string</span><span class="op" id="2221403">,</span>&nbsp;<span class="ident" id="2221405">mode</span>&nbsp;<span class="ident" id="2221410">FileMode</span><span class="op" id="2221418">)</span>&nbsp;<span class="builtintype" id="2221420">error</span>&nbsp;<span class="op" id="2221426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221429">if</span>&nbsp;<span class="ident" id="2221432">e</span>&nbsp;<span class="op" id="2221434">:=</span>&nbsp;<span class="ident" id="2221437">syscall</span><span class="op" id="2221444">.</span><span class="ident" id="2221445">Chmod</span><span class="op" id="2221450">(</span><span class="ident" id="2221451">name</span><span class="op" id="2221455">,</span>&nbsp;<span class="ident" id="2221457">syscallMode</span><span class="op" id="2221468">(</span><span class="ident" id="2221469">mode</span><span class="op" id="2221473">)</span><span class="op" id="2221474">)</span><span class="op" id="2221475">;</span>&nbsp;<span class="ident" id="2221477">e</span>&nbsp;<span class="op" id="2221479">!=</span>&nbsp;<span class="ident" id="2221482">nil</span>&nbsp;<span class="op" id="2221486">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221490">return</span>&nbsp;<span class="op" id="2221497">&amp;</span><span class="ident" id="2221498">PathError</span><span class="op" id="2221507">{</span><span class="string" id="2221508">&#34;chmod&#34;</span><span class="op" id="2221515">,</span>&nbsp;<span class="ident" id="2221517">name</span><span class="op" id="2221521">,</span>&nbsp;<span class="ident" id="2221523">e</span><span class="op" id="2221524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221530">return</span>&nbsp;<span class="ident" id="2221537">nil</span><br>
<span class="lineno"></span><span class="op" id="2221541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="2221544">//&nbsp;Chmod&nbsp;changes&nbsp;the&nbsp;mode&nbsp;of&nbsp;the&nbsp;file&nbsp;to&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="2221591">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2221647">func</span>&nbsp;<span class="op" id="2221652">(</span><span class="ident" id="2221653">f</span>&nbsp;<span class="op" id="2221655">*</span><span class="ident" id="2221656">File</span><span class="op" id="2221660">)</span>&nbsp;<span class="ident" id="2221662">Chmod</span><span class="op" id="2221667">(</span><span class="ident" id="2221668">mode</span>&nbsp;<span class="ident" id="2221673">FileMode</span><span class="op" id="2221681">)</span>&nbsp;<span class="builtintype" id="2221683">error</span>&nbsp;<span class="op" id="2221689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221692">if</span>&nbsp;<span class="ident" id="2221695">f</span>&nbsp;<span class="op" id="2221697">==</span>&nbsp;<span class="ident" id="2221700">nil</span>&nbsp;<span class="op" id="2221704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221708">return</span>&nbsp;<span class="ident" id="2221715">ErrInvalid</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221730">if</span>&nbsp;<span class="ident" id="2221733">e</span>&nbsp;<span class="op" id="2221735">:=</span>&nbsp;<span class="ident" id="2221738">syscall</span><span class="op" id="2221745">.</span><span class="ident" id="2221746">Fchmod</span><span class="op" id="2221752">(</span><span class="ident" id="2221753">f</span><span class="op" id="2221754">.</span><span class="ident" id="2221755">fd</span><span class="op" id="2221757">,</span>&nbsp;<span class="ident" id="2221759">syscallMode</span><span class="op" id="2221770">(</span><span class="ident" id="2221771">mode</span><span class="op" id="2221775">)</span><span class="op" id="2221776">)</span><span class="op" id="2221777">;</span>&nbsp;<span class="ident" id="2221779">e</span>&nbsp;<span class="op" id="2221781">!=</span>&nbsp;<span class="ident" id="2221784">nil</span>&nbsp;<span class="op" id="2221788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221792">return</span>&nbsp;<span class="op" id="2221799">&amp;</span><span class="ident" id="2221800">PathError</span><span class="op" id="2221809">{</span><span class="string" id="2221810">&#34;chmod&#34;</span><span class="op" id="2221817">,</span>&nbsp;<span class="ident" id="2221819">f</span><span class="op" id="2221820">.</span><span class="ident" id="2221821">name</span><span class="op" id="2221825">,</span>&nbsp;<span class="ident" id="2221827">e</span><span class="op" id="2221828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221834">return</span>&nbsp;<span class="ident" id="2221841">nil</span><br>
<span class="lineno">75</span><span class="op" id="2221845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2221848">//&nbsp;Chown&nbsp;changes&nbsp;the&nbsp;numeric&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;named&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2221908">//&nbsp;If&nbsp;the&nbsp;file&nbsp;is&nbsp;a&nbsp;symbolic&nbsp;link,&nbsp;it&nbsp;changes&nbsp;the&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;link&#39;s&nbsp;target.</span><br>
<span class="lineno"></span><span class="comment" id="2221992">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno">80</span><span class="keyword" id="2222048">func</span>&nbsp;<span class="ident" id="2222053">Chown</span><span class="op" id="2222058">(</span><span class="ident" id="2222059">name</span>&nbsp;<span class="builtintype" id="2222064">string</span><span class="op" id="2222070">,</span>&nbsp;<span class="ident" id="2222072">uid</span><span class="op" id="2222075">,</span>&nbsp;<span class="ident" id="2222077">gid</span>&nbsp;<span class="builtintype" id="2222081">int</span><span class="op" id="2222084">)</span>&nbsp;<span class="builtintype" id="2222086">error</span>&nbsp;<span class="op" id="2222092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222095">if</span>&nbsp;<span class="ident" id="2222098">e</span>&nbsp;<span class="op" id="2222100">:=</span>&nbsp;<span class="ident" id="2222103">syscall</span><span class="op" id="2222110">.</span><span class="ident" id="2222111">Chown</span><span class="op" id="2222116">(</span><span class="ident" id="2222117">name</span><span class="op" id="2222121">,</span>&nbsp;<span class="ident" id="2222123">uid</span><span class="op" id="2222126">,</span>&nbsp;<span class="ident" id="2222128">gid</span><span class="op" id="2222131">)</span><span class="op" id="2222132">;</span>&nbsp;<span class="ident" id="2222134">e</span>&nbsp;<span class="op" id="2222136">!=</span>&nbsp;<span class="ident" id="2222139">nil</span>&nbsp;<span class="op" id="2222143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222147">return</span>&nbsp;<span class="op" id="2222154">&amp;</span><span class="ident" id="2222155">PathError</span><span class="op" id="2222164">{</span><span class="string" id="2222165">&#34;chown&#34;</span><span class="op" id="2222172">,</span>&nbsp;<span class="ident" id="2222174">name</span><span class="op" id="2222178">,</span>&nbsp;<span class="ident" id="2222180">e</span><span class="op" id="2222181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2222184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222187">return</span>&nbsp;<span class="ident" id="2222194">nil</span><br>
<span class="lineno">85</span><span class="op" id="2222198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2222201">//&nbsp;Lchown&nbsp;changes&nbsp;the&nbsp;numeric&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;named&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2222262">//&nbsp;If&nbsp;the&nbsp;file&nbsp;is&nbsp;a&nbsp;symbolic&nbsp;link,&nbsp;it&nbsp;changes&nbsp;the&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;link&nbsp;itself.</span><br>
<span class="lineno"></span><span class="comment" id="2222344">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno">90</span><span class="keyword" id="2222400">func</span>&nbsp;<span class="ident" id="2222405">Lchown</span><span class="op" id="2222411">(</span><span class="ident" id="2222412">name</span>&nbsp;<span class="builtintype" id="2222417">string</span><span class="op" id="2222423">,</span>&nbsp;<span class="ident" id="2222425">uid</span><span class="op" id="2222428">,</span>&nbsp;<span class="ident" id="2222430">gid</span>&nbsp;<span class="builtintype" id="2222434">int</span><span class="op" id="2222437">)</span>&nbsp;<span class="builtintype" id="2222439">error</span>&nbsp;<span class="op" id="2222445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222448">if</span>&nbsp;<span class="ident" id="2222451">e</span>&nbsp;<span class="op" id="2222453">:=</span>&nbsp;<span class="ident" id="2222456">syscall</span><span class="op" id="2222463">.</span><span class="ident" id="2222464">Lchown</span><span class="op" id="2222470">(</span><span class="ident" id="2222471">name</span><span class="op" id="2222475">,</span>&nbsp;<span class="ident" id="2222477">uid</span><span class="op" id="2222480">,</span>&nbsp;<span class="ident" id="2222482">gid</span><span class="op" id="2222485">)</span><span class="op" id="2222486">;</span>&nbsp;<span class="ident" id="2222488">e</span>&nbsp;<span class="op" id="2222490">!=</span>&nbsp;<span class="ident" id="2222493">nil</span>&nbsp;<span class="op" id="2222497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222501">return</span>&nbsp;<span class="op" id="2222508">&amp;</span><span class="ident" id="2222509">PathError</span><span class="op" id="2222518">{</span><span class="string" id="2222519">&#34;lchown&#34;</span><span class="op" id="2222527">,</span>&nbsp;<span class="ident" id="2222529">name</span><span class="op" id="2222533">,</span>&nbsp;<span class="ident" id="2222535">e</span><span class="op" id="2222536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2222539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222542">return</span>&nbsp;<span class="ident" id="2222549">nil</span><br>
<span class="lineno">95</span><span class="op" id="2222553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2222556">//&nbsp;Chown&nbsp;changes&nbsp;the&nbsp;numeric&nbsp;uid&nbsp;and&nbsp;gid&nbsp;of&nbsp;the&nbsp;named&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2222616">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2222672">func</span>&nbsp;<span class="op" id="2222677">(</span><span class="ident" id="2222678">f</span>&nbsp;<span class="op" id="2222680">*</span><span class="ident" id="2222681">File</span><span class="op" id="2222685">)</span>&nbsp;<span class="ident" id="2222687">Chown</span><span class="op" id="2222692">(</span><span class="ident" id="2222693">uid</span><span class="op" id="2222696">,</span>&nbsp;<span class="ident" id="2222698">gid</span>&nbsp;<span class="builtintype" id="2222702">int</span><span class="op" id="2222705">)</span>&nbsp;<span class="builtintype" id="2222707">error</span>&nbsp;<span class="op" id="2222713">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222716">if</span>&nbsp;<span class="ident" id="2222719">f</span>&nbsp;<span class="op" id="2222721">==</span>&nbsp;<span class="ident" id="2222724">nil</span>&nbsp;<span class="op" id="2222728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222732">return</span>&nbsp;<span class="ident" id="2222739">ErrInvalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2222751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222754">if</span>&nbsp;<span class="ident" id="2222757">e</span>&nbsp;<span class="op" id="2222759">:=</span>&nbsp;<span class="ident" id="2222762">syscall</span><span class="op" id="2222769">.</span><span class="ident" id="2222770">Fchown</span><span class="op" id="2222776">(</span><span class="ident" id="2222777">f</span><span class="op" id="2222778">.</span><span class="ident" id="2222779">fd</span><span class="op" id="2222781">,</span>&nbsp;<span class="ident" id="2222783">uid</span><span class="op" id="2222786">,</span>&nbsp;<span class="ident" id="2222788">gid</span><span class="op" id="2222791">)</span><span class="op" id="2222792">;</span>&nbsp;<span class="ident" id="2222794">e</span>&nbsp;<span class="op" id="2222796">!=</span>&nbsp;<span class="ident" id="2222799">nil</span>&nbsp;<span class="op" id="2222803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222807">return</span>&nbsp;<span class="op" id="2222814">&amp;</span><span class="ident" id="2222815">PathError</span><span class="op" id="2222824">{</span><span class="string" id="2222825">&#34;chown&#34;</span><span class="op" id="2222832">,</span>&nbsp;<span class="ident" id="2222834">f</span><span class="op" id="2222835">.</span><span class="ident" id="2222836">name</span><span class="op" id="2222840">,</span>&nbsp;<span class="ident" id="2222842">e</span><span class="op" id="2222843">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2222846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2222849">return</span>&nbsp;<span class="ident" id="2222856">nil</span><br>
<span class="lineno"></span><span class="op" id="2222860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2222863">//&nbsp;Truncate&nbsp;changes&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno">110</span><span class="comment" id="2222905">//&nbsp;It&nbsp;does&nbsp;not&nbsp;change&nbsp;the&nbsp;I/O&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2222943">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2222999">func</span>&nbsp;<span class="op" id="2223004">(</span><span class="ident" id="2223005">f</span>&nbsp;<span class="op" id="2223007">*</span><span class="ident" id="2223008">File</span><span class="op" id="2223012">)</span>&nbsp;<span class="ident" id="2223014">Truncate</span><span class="op" id="2223022">(</span><span class="ident" id="2223023">size</span>&nbsp;<span class="ident" id="2223028">int64</span><span class="op" id="2223033">)</span>&nbsp;<span class="builtintype" id="2223035">error</span>&nbsp;<span class="op" id="2223041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223044">if</span>&nbsp;<span class="ident" id="2223047">f</span>&nbsp;<span class="op" id="2223049">==</span>&nbsp;<span class="ident" id="2223052">nil</span>&nbsp;<span class="op" id="2223056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223060">return</span>&nbsp;<span class="ident" id="2223067">ErrInvalid</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2223079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223082">if</span>&nbsp;<span class="ident" id="2223085">e</span>&nbsp;<span class="op" id="2223087">:=</span>&nbsp;<span class="ident" id="2223090">syscall</span><span class="op" id="2223097">.</span><span class="ident" id="2223098">Ftruncate</span><span class="op" id="2223107">(</span><span class="ident" id="2223108">f</span><span class="op" id="2223109">.</span><span class="ident" id="2223110">fd</span><span class="op" id="2223112">,</span>&nbsp;<span class="ident" id="2223114">size</span><span class="op" id="2223118">)</span><span class="op" id="2223119">;</span>&nbsp;<span class="ident" id="2223121">e</span>&nbsp;<span class="op" id="2223123">!=</span>&nbsp;<span class="ident" id="2223126">nil</span>&nbsp;<span class="op" id="2223130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223134">return</span>&nbsp;<span class="op" id="2223141">&amp;</span><span class="ident" id="2223142">PathError</span><span class="op" id="2223151">{</span><span class="string" id="2223152">&#34;truncate&#34;</span><span class="op" id="2223162">,</span>&nbsp;<span class="ident" id="2223164">f</span><span class="op" id="2223165">.</span><span class="ident" id="2223166">name</span><span class="op" id="2223170">,</span>&nbsp;<span class="ident" id="2223172">e</span><span class="op" id="2223173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2223176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223179">return</span>&nbsp;<span class="ident" id="2223186">nil</span><br>
<span class="lineno">120</span><span class="op" id="2223190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2223193">//&nbsp;Sync&nbsp;commits&nbsp;the&nbsp;current&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;to&nbsp;stable&nbsp;storage.</span><br>
<span class="lineno"></span><span class="comment" id="2223261">//&nbsp;Typically,&nbsp;this&nbsp;means&nbsp;flushing&nbsp;the&nbsp;file&nbsp;system&#39;s&nbsp;in-memory&nbsp;copy</span><br>
<span class="lineno"></span><span class="comment" id="2223328">//&nbsp;of&nbsp;recently&nbsp;written&nbsp;data&nbsp;to&nbsp;disk.</span><br>
<span class="lineno">125</span><span class="keyword" id="2223365">func</span>&nbsp;<span class="op" id="2223370">(</span><span class="ident" id="2223371">f</span>&nbsp;<span class="op" id="2223373">*</span><span class="ident" id="2223374">File</span><span class="op" id="2223378">)</span>&nbsp;<span class="ident" id="2223380">Sync</span><span class="op" id="2223384">(</span><span class="op" id="2223385">)</span>&nbsp;<span class="op" id="2223387">(</span><span class="ident" id="2223388">err</span>&nbsp;<span class="builtintype" id="2223392">error</span><span class="op" id="2223397">)</span>&nbsp;<span class="op" id="2223399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223402">if</span>&nbsp;<span class="ident" id="2223405">f</span>&nbsp;<span class="op" id="2223407">==</span>&nbsp;<span class="ident" id="2223410">nil</span>&nbsp;<span class="op" id="2223414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223418">return</span>&nbsp;<span class="ident" id="2223425">ErrInvalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2223437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223440">if</span>&nbsp;<span class="ident" id="2223443">e</span>&nbsp;<span class="op" id="2223445">:=</span>&nbsp;<span class="ident" id="2223448">syscall</span><span class="op" id="2223455">.</span><span class="ident" id="2223456">Fsync</span><span class="op" id="2223461">(</span><span class="ident" id="2223462">f</span><span class="op" id="2223463">.</span><span class="ident" id="2223464">fd</span><span class="op" id="2223466">)</span><span class="op" id="2223467">;</span>&nbsp;<span class="ident" id="2223469">e</span>&nbsp;<span class="op" id="2223471">!=</span>&nbsp;<span class="ident" id="2223474">nil</span>&nbsp;<span class="op" id="2223478">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223482">return</span>&nbsp;<span class="ident" id="2223489">NewSyscallError</span><span class="op" id="2223504">(</span><span class="string" id="2223505">&#34;fsync&#34;</span><span class="op" id="2223512">,</span>&nbsp;<span class="ident" id="2223514">e</span><span class="op" id="2223515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2223518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223521">return</span>&nbsp;<span class="ident" id="2223528">nil</span><br>
<span class="lineno"></span><span class="op" id="2223532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2223535">//&nbsp;Chtimes&nbsp;changes&nbsp;the&nbsp;access&nbsp;and&nbsp;modification&nbsp;times&nbsp;of&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="2223601">//&nbsp;file,&nbsp;similar&nbsp;to&nbsp;the&nbsp;Unix&nbsp;utime()&nbsp;or&nbsp;utimes()&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="2223661">//</span><br>
<span class="lineno"></span><span class="comment" id="2223664">//&nbsp;The&nbsp;underlying&nbsp;filesystem&nbsp;may&nbsp;truncate&nbsp;or&nbsp;round&nbsp;the&nbsp;values&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2223731">//&nbsp;less&nbsp;precise&nbsp;time&nbsp;unit.</span><br>
<span class="lineno">140</span><span class="comment" id="2223758">//&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error,&nbsp;it&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;*PathError.</span><br>
<span class="lineno"></span><span class="keyword" id="2223814">func</span>&nbsp;<span class="ident" id="2223819">Chtimes</span><span class="op" id="2223826">(</span><span class="ident" id="2223827">name</span>&nbsp;<span class="builtintype" id="2223832">string</span><span class="op" id="2223838">,</span>&nbsp;<span class="ident" id="2223840">atime</span>&nbsp;<span class="ident" id="2223846">time</span><span class="op" id="2223850">.</span><span class="ident" id="2223851">Time</span><span class="op" id="2223855">,</span>&nbsp;<span class="ident" id="2223857">mtime</span>&nbsp;<span class="ident" id="2223863">time</span><span class="op" id="2223867">.</span><span class="ident" id="2223868">Time</span><span class="op" id="2223872">)</span>&nbsp;<span class="builtintype" id="2223874">error</span>&nbsp;<span class="op" id="2223880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2223883">var</span>&nbsp;<span class="ident" id="2223887">utimes</span>&nbsp;<span class="op" id="2223894">[</span><span class="num" id="2223895">2</span><span class="op" id="2223896">]</span><span class="ident" id="2223897">syscall</span><span class="op" id="2223904">.</span><span class="ident" id="2223905">Timespec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2223915">utimes</span><span class="op" id="2223921">[</span><span class="num" id="2223922">0</span><span class="op" id="2223923">]</span>&nbsp;<span class="op" id="2223925">=</span>&nbsp;<span class="ident" id="2223927">syscall</span><span class="op" id="2223934">.</span><span class="ident" id="2223935">NsecToTimespec</span><span class="op" id="2223949">(</span><span class="ident" id="2223950">atime</span><span class="op" id="2223955">.</span><span class="ident" id="2223956">UnixNano</span><span class="op" id="2223964">(</span><span class="op" id="2223965">)</span><span class="op" id="2223966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2223969">utimes</span><span class="op" id="2223975">[</span><span class="num" id="2223976">1</span><span class="op" id="2223977">]</span>&nbsp;<span class="op" id="2223979">=</span>&nbsp;<span class="ident" id="2223981">syscall</span><span class="op" id="2223988">.</span><span class="ident" id="2223989">NsecToTimespec</span><span class="op" id="2224003">(</span><span class="ident" id="2224004">mtime</span><span class="op" id="2224009">.</span><span class="ident" id="2224010">UnixNano</span><span class="op" id="2224018">(</span><span class="op" id="2224019">)</span><span class="op" id="2224020">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2224023">if</span>&nbsp;<span class="ident" id="2224026">e</span>&nbsp;<span class="op" id="2224028">:=</span>&nbsp;<span class="ident" id="2224031">syscall</span><span class="op" id="2224038">.</span><span class="ident" id="2224039">UtimesNano</span><span class="op" id="2224049">(</span><span class="ident" id="2224050">name</span><span class="op" id="2224054">,</span>&nbsp;<span class="ident" id="2224056">utimes</span><span class="op" id="2224062">[</span><span class="num" id="2224063">0</span><span class="op" id="2224064">:</span><span class="op" id="2224065">]</span><span class="op" id="2224066">)</span><span class="op" id="2224067">;</span>&nbsp;<span class="ident" id="2224069">e</span>&nbsp;<span class="op" id="2224071">!=</span>&nbsp;<span class="ident" id="2224074">nil</span>&nbsp;<span class="op" id="2224078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2224082">return</span>&nbsp;<span class="op" id="2224089">&amp;</span><span class="ident" id="2224090">PathError</span><span class="op" id="2224099">{</span><span class="string" id="2224100">&#34;chtimes&#34;</span><span class="op" id="2224109">,</span>&nbsp;<span class="ident" id="2224111">name</span><span class="op" id="2224115">,</span>&nbsp;<span class="ident" id="2224117">e</span><span class="op" id="2224118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2224121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2224124">return</span>&nbsp;<span class="ident" id="2224131">nil</span><br>
<span class="lineno"></span><span class="op" id="2224135">}</span>
</div>
</body>
</html>
