<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5536134">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5536189">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5536243">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5536294">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5536370">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5536444">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5536460">package</span>&nbsp;<span class="ident" id="5536468">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5536474">import</span>&nbsp;<span class="op" id="5536481">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536484">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536493">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536503">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536509">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536515">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536532">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536543">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536554">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536565">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5536573">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5536583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5536586">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5536651">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5536680">type</span>&nbsp;<span class="ident" id="5536685">Error</span>&nbsp;<span class="keyword" id="5536691">struct</span>&nbsp;<span class="op" id="5536698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5536701">Name</span>&nbsp;<span class="builtintype" id="5536706">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5536714">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5536719">error</span><br>
<span class="lineno"></span><span class="op" id="5536725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5536728">func</span>&nbsp;<span class="op" id="5536733">(</span><span class="ident" id="5536734">e</span>&nbsp;<span class="op" id="5536736">*</span><span class="ident" id="5536737">Error</span><span class="op" id="5536742">)</span>&nbsp;<span class="ident" id="5536744">Error</span><span class="op" id="5536749">(</span><span class="op" id="5536750">)</span>&nbsp;<span class="builtintype" id="5536752">string</span>&nbsp;<span class="op" id="5536759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5536762">return</span>&nbsp;<span class="string" id="5536769">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5536778">+</span>&nbsp;<span class="ident" id="5536780">strconv</span><span class="op" id="5536787">.</span><span class="ident" id="5536788">Quote</span><span class="op" id="5536793">(</span><span class="ident" id="5536794">e</span><span class="op" id="5536795">.</span><span class="ident" id="5536796">Name</span><span class="op" id="5536800">)</span>&nbsp;<span class="op" id="5536802">+</span>&nbsp;<span class="string" id="5536804">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5536809">+</span>&nbsp;<span class="ident" id="5536811">e</span><span class="op" id="5536812">.</span><span class="ident" id="5536813">Err</span><span class="op" id="5536816">.</span><span class="ident" id="5536817">Error</span><span class="op" id="5536822">(</span><span class="op" id="5536823">)</span><br>
<span class="lineno"></span><span class="op" id="5536825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5536828">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5536889">type</span>&nbsp;<span class="ident" id="5536894">Cmd</span>&nbsp;<span class="keyword" id="5536898">struct</span>&nbsp;<span class="op" id="5536905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536908">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536952">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536956">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537014">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537071">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537083">Path</span>&nbsp;<span class="builtintype" id="5537088">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537097">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537170">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537226">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537230">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537297">Args</span>&nbsp;<span class="op" id="5537302">[</span><span class="op" id="5537303">]</span><span class="builtintype" id="5537304">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537313">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537363">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537426">Env</span>&nbsp;<span class="op" id="5537430">[</span><span class="op" id="5537431">]</span><span class="builtintype" id="5537432">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537441">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537497">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537557">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537598">Dir</span>&nbsp;<span class="builtintype" id="5537602">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537611">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537661">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537735">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537806">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537833">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537895">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537964">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538038">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538104">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538180">Stdin</span>&nbsp;<span class="ident" id="5538186">io</span><span class="op" id="5538188">.</span><span class="ident" id="5538189">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538198">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538269">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538273">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538342">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538379">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538383">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538441">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538482">Stdout</span>&nbsp;<span class="ident" id="5538489">io</span><span class="op" id="5538491">.</span><span class="ident" id="5538492">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538500">Stderr</span>&nbsp;<span class="ident" id="5538507">io</span><span class="op" id="5538509">.</span><span class="ident" id="5538510">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538519">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538589">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538662">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538731">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538735">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538810">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538843">ExtraFiles</span>&nbsp;<span class="op" id="5538854">[</span><span class="op" id="5538855">]</span><span class="op" id="5538856">*</span><span class="ident" id="5538857">os</span><span class="op" id="5538859">.</span><span class="ident" id="5538860">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538867">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5538937">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539006">SysProcAttr</span>&nbsp;<span class="op" id="5539018">*</span><span class="ident" id="5539019">syscall</span><span class="op" id="5539026">.</span><span class="ident" id="5539027">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5539041">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539094">Process</span>&nbsp;<span class="op" id="5539102">*</span><span class="ident" id="5539103">os</span><span class="op" id="5539105">.</span><span class="ident" id="5539106">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5539116">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5539179">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539222">ProcessState</span>&nbsp;<span class="op" id="5539235">*</span><span class="ident" id="5539236">os</span><span class="op" id="5539238">.</span><span class="ident" id="5539239">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539254">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539270">error</span>&nbsp;<span class="comment" id="5539276">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539304">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539320">bool</span>&nbsp;&nbsp;<span class="comment" id="5539326">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539351">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5539367">[</span><span class="op" id="5539368">]</span><span class="op" id="5539369">*</span><span class="ident" id="5539370">os</span><span class="op" id="5539372">.</span><span class="ident" id="5539373">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539379">closeAfterStart</span>&nbsp;<span class="op" id="5539395">[</span><span class="op" id="5539396">]</span><span class="ident" id="5539397">io</span><span class="op" id="5539399">.</span><span class="ident" id="5539400">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539408">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5539424">[</span><span class="op" id="5539425">]</span><span class="ident" id="5539426">io</span><span class="op" id="5539428">.</span><span class="ident" id="5539429">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539437">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5539453">[</span><span class="op" id="5539454">]</span><span class="keyword" id="5539455">func</span><span class="op" id="5539459">(</span><span class="op" id="5539460">)</span>&nbsp;<span class="builtintype" id="5539462">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539469">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5539485">chan</span>&nbsp;<span class="builtintype" id="5539490">error</span>&nbsp;<span class="comment" id="5539496">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5539522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5539525">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5539593">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5539617">//</span><br>
<span class="lineno">110</span><span class="comment" id="5539620">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5539681">//</span><br>
<span class="lineno"></span><span class="comment" id="5539684">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5539749">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5539819">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5539837">//</span><br>
<span class="lineno"></span><span class="comment" id="5539840">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5539910">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5539976">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5540038">func</span>&nbsp;<span class="ident" id="5540043">Command</span><span class="op" id="5540050">(</span><span class="ident" id="5540051">name</span>&nbsp;<span class="builtintype" id="5540056">string</span><span class="op" id="5540062">,</span>&nbsp;<span class="ident" id="5540064">arg</span>&nbsp;<span class="op" id="5540068">...</span><span class="builtintype" id="5540071">string</span><span class="op" id="5540077">)</span>&nbsp;<span class="op" id="5540079">*</span><span class="ident" id="5540080">Cmd</span>&nbsp;<span class="op" id="5540084">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540087">cmd</span>&nbsp;<span class="op" id="5540091">:=</span>&nbsp;<span class="op" id="5540094">&amp;</span><span class="ident" id="5540095">Cmd</span><span class="op" id="5540098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540102">Path</span><span class="op" id="5540106">:</span>&nbsp;<span class="ident" id="5540108">name</span><span class="op" id="5540112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540116">Args</span><span class="op" id="5540120">:</span>&nbsp;<span class="builtinfunc" id="5540122">append</span><span class="op" id="5540128">(</span><span class="op" id="5540129">[</span><span class="op" id="5540130">]</span><span class="builtintype" id="5540131">string</span><span class="op" id="5540137">{</span><span class="ident" id="5540138">name</span><span class="op" id="5540142">}</span><span class="op" id="5540143">,</span>&nbsp;<span class="ident" id="5540145">arg</span><span class="op" id="5540148">...</span><span class="op" id="5540151">)</span><span class="op" id="5540152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540158">if</span>&nbsp;<span class="ident" id="5540161">filepath</span><span class="op" id="5540169">.</span><span class="ident" id="5540170">Base</span><span class="op" id="5540174">(</span><span class="ident" id="5540175">name</span><span class="op" id="5540179">)</span>&nbsp;<span class="op" id="5540181">==</span>&nbsp;<span class="ident" id="5540184">name</span>&nbsp;<span class="op" id="5540189">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540193">if</span>&nbsp;<span class="ident" id="5540196">lp</span><span class="op" id="5540198">,</span>&nbsp;<span class="ident" id="5540200">err</span>&nbsp;<span class="op" id="5540204">:=</span>&nbsp;<span class="ident" id="5540207">LookPath</span><span class="op" id="5540215">(</span><span class="ident" id="5540216">name</span><span class="op" id="5540220">)</span><span class="op" id="5540221">;</span>&nbsp;<span class="ident" id="5540223">err</span>&nbsp;<span class="op" id="5540227">!=</span>&nbsp;<span class="ident" id="5540230">nil</span>&nbsp;<span class="op" id="5540234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540239">cmd</span><span class="op" id="5540242">.</span><span class="ident" id="5540243">lookPathErr</span>&nbsp;<span class="op" id="5540255">=</span>&nbsp;<span class="ident" id="5540257">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540263">}</span>&nbsp;<span class="keyword" id="5540265">else</span>&nbsp;<span class="op" id="5540270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540275">cmd</span><span class="op" id="5540278">.</span><span class="ident" id="5540279">Path</span>&nbsp;<span class="op" id="5540284">=</span>&nbsp;<span class="ident" id="5540286">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540291">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540297">return</span>&nbsp;<span class="ident" id="5540304">cmd</span><br>
<span class="lineno"></span><span class="op" id="5540308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5540311">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5540382">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5540438">func</span>&nbsp;<span class="ident" id="5540443">interfaceEqual</span><span class="op" id="5540457">(</span><span class="ident" id="5540458">a</span><span class="op" id="5540459">,</span>&nbsp;<span class="ident" id="5540461">b</span>&nbsp;<span class="keyword" id="5540463">interface</span><span class="op" id="5540472">{</span><span class="op" id="5540473">}</span><span class="op" id="5540474">)</span>&nbsp;<span class="builtintype" id="5540476">bool</span>&nbsp;<span class="op" id="5540481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540484">defer</span>&nbsp;<span class="keyword" id="5540490">func</span><span class="op" id="5540494">(</span><span class="op" id="5540495">)</span>&nbsp;<span class="op" id="5540497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5540501">recover</span><span class="op" id="5540508">(</span><span class="op" id="5540509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540512">}</span><span class="op" id="5540513">(</span><span class="op" id="5540514">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540517">return</span>&nbsp;<span class="ident" id="5540524">a</span>&nbsp;<span class="op" id="5540526">==</span>&nbsp;<span class="ident" id="5540529">b</span><br>
<span class="lineno"></span><span class="op" id="5540531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5540534">func</span>&nbsp;<span class="op" id="5540539">(</span><span class="ident" id="5540540">c</span>&nbsp;<span class="op" id="5540542">*</span><span class="ident" id="5540543">Cmd</span><span class="op" id="5540546">)</span>&nbsp;<span class="ident" id="5540548">envv</span><span class="op" id="5540552">(</span><span class="op" id="5540553">)</span>&nbsp;<span class="op" id="5540555">[</span><span class="op" id="5540556">]</span><span class="builtintype" id="5540557">string</span>&nbsp;<span class="op" id="5540564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540567">if</span>&nbsp;<span class="ident" id="5540570">c</span><span class="op" id="5540571">.</span><span class="ident" id="5540572">Env</span>&nbsp;<span class="op" id="5540576">!=</span>&nbsp;<span class="ident" id="5540579">nil</span>&nbsp;<span class="op" id="5540583">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540587">return</span>&nbsp;<span class="ident" id="5540594">c</span><span class="op" id="5540595">.</span><span class="ident" id="5540596">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540604">return</span>&nbsp;<span class="ident" id="5540611">os</span><span class="op" id="5540613">.</span><span class="ident" id="5540614">Environ</span><span class="op" id="5540621">(</span><span class="op" id="5540622">)</span><br>
<span class="lineno"></span><span class="op" id="5540624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5540627">func</span>&nbsp;<span class="op" id="5540632">(</span><span class="ident" id="5540633">c</span>&nbsp;<span class="op" id="5540635">*</span><span class="ident" id="5540636">Cmd</span><span class="op" id="5540639">)</span>&nbsp;<span class="ident" id="5540641">argv</span><span class="op" id="5540645">(</span><span class="op" id="5540646">)</span>&nbsp;<span class="op" id="5540648">[</span><span class="op" id="5540649">]</span><span class="builtintype" id="5540650">string</span>&nbsp;<span class="op" id="5540657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540660">if</span>&nbsp;<span class="builtinfunc" id="5540663">len</span><span class="op" id="5540666">(</span><span class="ident" id="5540667">c</span><span class="op" id="5540668">.</span><span class="ident" id="5540669">Args</span><span class="op" id="5540673">)</span>&nbsp;<span class="op" id="5540675">&gt;</span>&nbsp;<span class="num" id="5540677">0</span>&nbsp;<span class="op" id="5540679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540683">return</span>&nbsp;<span class="ident" id="5540690">c</span><span class="op" id="5540691">.</span><span class="ident" id="5540692">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540701">return</span>&nbsp;<span class="op" id="5540708">[</span><span class="op" id="5540709">]</span><span class="builtintype" id="5540710">string</span><span class="op" id="5540716">{</span><span class="ident" id="5540717">c</span><span class="op" id="5540718">.</span><span class="ident" id="5540719">Path</span><span class="op" id="5540723">}</span><br>
<span class="lineno">155</span><span class="op" id="5540725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5540728">func</span>&nbsp;<span class="op" id="5540733">(</span><span class="ident" id="5540734">c</span>&nbsp;<span class="op" id="5540736">*</span><span class="ident" id="5540737">Cmd</span><span class="op" id="5540740">)</span>&nbsp;<span class="ident" id="5540742">stdin</span><span class="op" id="5540747">(</span><span class="op" id="5540748">)</span>&nbsp;<span class="op" id="5540750">(</span><span class="ident" id="5540751">f</span>&nbsp;<span class="op" id="5540753">*</span><span class="ident" id="5540754">os</span><span class="op" id="5540756">.</span><span class="ident" id="5540757">File</span><span class="op" id="5540761">,</span>&nbsp;<span class="ident" id="5540763">err</span>&nbsp;<span class="builtintype" id="5540767">error</span><span class="op" id="5540772">)</span>&nbsp;<span class="op" id="5540774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540777">if</span>&nbsp;<span class="ident" id="5540780">c</span><span class="op" id="5540781">.</span><span class="ident" id="5540782">Stdin</span>&nbsp;<span class="op" id="5540788">==</span>&nbsp;<span class="ident" id="5540791">nil</span>&nbsp;<span class="op" id="5540795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540799">f</span><span class="op" id="5540800">,</span>&nbsp;<span class="ident" id="5540802">err</span>&nbsp;<span class="op" id="5540806">=</span>&nbsp;<span class="ident" id="5540808">os</span><span class="op" id="5540810">.</span><span class="ident" id="5540811">Open</span><span class="op" id="5540815">(</span><span class="ident" id="5540816">os</span><span class="op" id="5540818">.</span><span class="ident" id="5540819">DevNull</span><span class="op" id="5540826">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540830">if</span>&nbsp;<span class="ident" id="5540833">err</span>&nbsp;<span class="op" id="5540837">!=</span>&nbsp;<span class="ident" id="5540840">nil</span>&nbsp;<span class="op" id="5540844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540849">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540862">c</span><span class="op" id="5540863">.</span><span class="ident" id="5540864">closeAfterStart</span>&nbsp;<span class="op" id="5540880">=</span>&nbsp;<span class="builtinfunc" id="5540882">append</span><span class="op" id="5540888">(</span><span class="ident" id="5540889">c</span><span class="op" id="5540890">.</span><span class="ident" id="5540891">closeAfterStart</span><span class="op" id="5540906">,</span>&nbsp;<span class="ident" id="5540908">f</span><span class="op" id="5540909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540913">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540925">if</span>&nbsp;<span class="ident" id="5540928">f</span><span class="op" id="5540929">,</span>&nbsp;<span class="ident" id="5540931">ok</span>&nbsp;<span class="op" id="5540934">:=</span>&nbsp;<span class="ident" id="5540937">c</span><span class="op" id="5540938">.</span><span class="ident" id="5540939">Stdin</span><span class="op" id="5540944">.</span><span class="op" id="5540945">(</span><span class="op" id="5540946">*</span><span class="ident" id="5540947">os</span><span class="op" id="5540949">.</span><span class="ident" id="5540950">File</span><span class="op" id="5540954">)</span><span class="op" id="5540955">;</span>&nbsp;<span class="ident" id="5540957">ok</span>&nbsp;<span class="op" id="5540960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540964">return</span>&nbsp;<span class="ident" id="5540971">f</span><span class="op" id="5540972">,</span>&nbsp;<span class="ident" id="5540974">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5540979">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540983">pr</span><span class="op" id="5540985">,</span>&nbsp;<span class="ident" id="5540987">pw</span><span class="op" id="5540989">,</span>&nbsp;<span class="ident" id="5540991">err</span>&nbsp;<span class="op" id="5540995">:=</span>&nbsp;<span class="ident" id="5540998">os</span><span class="op" id="5541000">.</span><span class="ident" id="5541001">Pipe</span><span class="op" id="5541005">(</span><span class="op" id="5541006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541009">if</span>&nbsp;<span class="ident" id="5541012">err</span>&nbsp;<span class="op" id="5541016">!=</span>&nbsp;<span class="ident" id="5541019">nil</span>&nbsp;<span class="op" id="5541023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541027">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541035">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541039">c</span><span class="op" id="5541040">.</span><span class="ident" id="5541041">closeAfterStart</span>&nbsp;<span class="op" id="5541057">=</span>&nbsp;<span class="builtinfunc" id="5541059">append</span><span class="op" id="5541065">(</span><span class="ident" id="5541066">c</span><span class="op" id="5541067">.</span><span class="ident" id="5541068">closeAfterStart</span><span class="op" id="5541083">,</span>&nbsp;<span class="ident" id="5541085">pr</span><span class="op" id="5541087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541090">c</span><span class="op" id="5541091">.</span><span class="ident" id="5541092">closeAfterWait</span>&nbsp;<span class="op" id="5541107">=</span>&nbsp;<span class="builtinfunc" id="5541109">append</span><span class="op" id="5541115">(</span><span class="ident" id="5541116">c</span><span class="op" id="5541117">.</span><span class="ident" id="5541118">closeAfterWait</span><span class="op" id="5541132">,</span>&nbsp;<span class="ident" id="5541134">pw</span><span class="op" id="5541136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541139">c</span><span class="op" id="5541140">.</span><span class="ident" id="5541141">goroutine</span>&nbsp;<span class="op" id="5541151">=</span>&nbsp;<span class="builtinfunc" id="5541153">append</span><span class="op" id="5541159">(</span><span class="ident" id="5541160">c</span><span class="op" id="5541161">.</span><span class="ident" id="5541162">goroutine</span><span class="op" id="5541171">,</span>&nbsp;<span class="keyword" id="5541173">func</span><span class="op" id="5541177">(</span><span class="op" id="5541178">)</span>&nbsp;<span class="builtintype" id="5541180">error</span>&nbsp;<span class="op" id="5541186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541190">_</span><span class="op" id="5541191">,</span>&nbsp;<span class="ident" id="5541193">err</span>&nbsp;<span class="op" id="5541197">:=</span>&nbsp;<span class="ident" id="5541200">io</span><span class="op" id="5541202">.</span><span class="ident" id="5541203">Copy</span><span class="op" id="5541207">(</span><span class="ident" id="5541208">pw</span><span class="op" id="5541210">,</span>&nbsp;<span class="ident" id="5541212">c</span><span class="op" id="5541213">.</span><span class="ident" id="5541214">Stdin</span><span class="op" id="5541219">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541223">if</span>&nbsp;<span class="ident" id="5541226">err1</span>&nbsp;<span class="op" id="5541231">:=</span>&nbsp;<span class="ident" id="5541234">pw</span><span class="op" id="5541236">.</span><span class="ident" id="5541237">Close</span><span class="op" id="5541242">(</span><span class="op" id="5541243">)</span><span class="op" id="5541244">;</span>&nbsp;<span class="ident" id="5541246">err</span>&nbsp;<span class="op" id="5541250">==</span>&nbsp;<span class="ident" id="5541253">nil</span>&nbsp;<span class="op" id="5541257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541262">err</span>&nbsp;<span class="op" id="5541266">=</span>&nbsp;<span class="ident" id="5541268">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541279">return</span>&nbsp;<span class="ident" id="5541286">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541291">}</span><span class="op" id="5541292">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541295">return</span>&nbsp;<span class="ident" id="5541302">pr</span><span class="op" id="5541304">,</span>&nbsp;<span class="ident" id="5541306">nil</span><br>
<span class="lineno"></span><span class="op" id="5541310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5541313">func</span>&nbsp;<span class="op" id="5541318">(</span><span class="ident" id="5541319">c</span>&nbsp;<span class="op" id="5541321">*</span><span class="ident" id="5541322">Cmd</span><span class="op" id="5541325">)</span>&nbsp;<span class="ident" id="5541327">stdout</span><span class="op" id="5541333">(</span><span class="op" id="5541334">)</span>&nbsp;<span class="op" id="5541336">(</span><span class="ident" id="5541337">f</span>&nbsp;<span class="op" id="5541339">*</span><span class="ident" id="5541340">os</span><span class="op" id="5541342">.</span><span class="ident" id="5541343">File</span><span class="op" id="5541347">,</span>&nbsp;<span class="ident" id="5541349">err</span>&nbsp;<span class="builtintype" id="5541353">error</span><span class="op" id="5541358">)</span>&nbsp;<span class="op" id="5541360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541363">return</span>&nbsp;<span class="ident" id="5541370">c</span><span class="op" id="5541371">.</span><span class="ident" id="5541372">writerDescriptor</span><span class="op" id="5541388">(</span><span class="ident" id="5541389">c</span><span class="op" id="5541390">.</span><span class="ident" id="5541391">Stdout</span><span class="op" id="5541397">)</span><br>
<span class="lineno">190</span><span class="op" id="5541399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5541402">func</span>&nbsp;<span class="op" id="5541407">(</span><span class="ident" id="5541408">c</span>&nbsp;<span class="op" id="5541410">*</span><span class="ident" id="5541411">Cmd</span><span class="op" id="5541414">)</span>&nbsp;<span class="ident" id="5541416">stderr</span><span class="op" id="5541422">(</span><span class="op" id="5541423">)</span>&nbsp;<span class="op" id="5541425">(</span><span class="ident" id="5541426">f</span>&nbsp;<span class="op" id="5541428">*</span><span class="ident" id="5541429">os</span><span class="op" id="5541431">.</span><span class="ident" id="5541432">File</span><span class="op" id="5541436">,</span>&nbsp;<span class="ident" id="5541438">err</span>&nbsp;<span class="builtintype" id="5541442">error</span><span class="op" id="5541447">)</span>&nbsp;<span class="op" id="5541449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541452">if</span>&nbsp;<span class="ident" id="5541455">c</span><span class="op" id="5541456">.</span><span class="ident" id="5541457">Stderr</span>&nbsp;<span class="op" id="5541464">!=</span>&nbsp;<span class="ident" id="5541467">nil</span>&nbsp;<span class="op" id="5541471">&amp;&amp;</span>&nbsp;<span class="ident" id="5541474">interfaceEqual</span><span class="op" id="5541488">(</span><span class="ident" id="5541489">c</span><span class="op" id="5541490">.</span><span class="ident" id="5541491">Stderr</span><span class="op" id="5541497">,</span>&nbsp;<span class="ident" id="5541499">c</span><span class="op" id="5541500">.</span><span class="ident" id="5541501">Stdout</span><span class="op" id="5541507">)</span>&nbsp;<span class="op" id="5541509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541513">return</span>&nbsp;<span class="ident" id="5541520">c</span><span class="op" id="5541521">.</span><span class="ident" id="5541522">childFiles</span><span class="op" id="5541532">[</span><span class="num" id="5541533">1</span><span class="op" id="5541534">]</span><span class="op" id="5541535">,</span>&nbsp;<span class="ident" id="5541537">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541545">return</span>&nbsp;<span class="ident" id="5541552">c</span><span class="op" id="5541553">.</span><span class="ident" id="5541554">writerDescriptor</span><span class="op" id="5541570">(</span><span class="ident" id="5541571">c</span><span class="op" id="5541572">.</span><span class="ident" id="5541573">Stderr</span><span class="op" id="5541579">)</span><br>
<span class="lineno"></span><span class="op" id="5541581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5541584">func</span>&nbsp;<span class="op" id="5541589">(</span><span class="ident" id="5541590">c</span>&nbsp;<span class="op" id="5541592">*</span><span class="ident" id="5541593">Cmd</span><span class="op" id="5541596">)</span>&nbsp;<span class="ident" id="5541598">writerDescriptor</span><span class="op" id="5541614">(</span><span class="ident" id="5541615">w</span>&nbsp;<span class="ident" id="5541617">io</span><span class="op" id="5541619">.</span><span class="ident" id="5541620">Writer</span><span class="op" id="5541626">)</span>&nbsp;<span class="op" id="5541628">(</span><span class="ident" id="5541629">f</span>&nbsp;<span class="op" id="5541631">*</span><span class="ident" id="5541632">os</span><span class="op" id="5541634">.</span><span class="ident" id="5541635">File</span><span class="op" id="5541639">,</span>&nbsp;<span class="ident" id="5541641">err</span>&nbsp;<span class="builtintype" id="5541645">error</span><span class="op" id="5541650">)</span>&nbsp;<span class="op" id="5541652">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541655">if</span>&nbsp;<span class="ident" id="5541658">w</span>&nbsp;<span class="op" id="5541660">==</span>&nbsp;<span class="ident" id="5541663">nil</span>&nbsp;<span class="op" id="5541667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541671">f</span><span class="op" id="5541672">,</span>&nbsp;<span class="ident" id="5541674">err</span>&nbsp;<span class="op" id="5541678">=</span>&nbsp;<span class="ident" id="5541680">os</span><span class="op" id="5541682">.</span><span class="ident" id="5541683">OpenFile</span><span class="op" id="5541691">(</span><span class="ident" id="5541692">os</span><span class="op" id="5541694">.</span><span class="ident" id="5541695">DevNull</span><span class="op" id="5541702">,</span>&nbsp;<span class="ident" id="5541704">os</span><span class="op" id="5541706">.</span><span class="ident" id="5541707">O_WRONLY</span><span class="op" id="5541715">,</span>&nbsp;<span class="num" id="5541717">0</span><span class="op" id="5541718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541722">if</span>&nbsp;<span class="ident" id="5541725">err</span>&nbsp;<span class="op" id="5541729">!=</span>&nbsp;<span class="ident" id="5541732">nil</span>&nbsp;<span class="op" id="5541736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541750">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541754">c</span><span class="op" id="5541755">.</span><span class="ident" id="5541756">closeAfterStart</span>&nbsp;<span class="op" id="5541772">=</span>&nbsp;<span class="builtinfunc" id="5541774">append</span><span class="op" id="5541780">(</span><span class="ident" id="5541781">c</span><span class="op" id="5541782">.</span><span class="ident" id="5541783">closeAfterStart</span><span class="op" id="5541798">,</span>&nbsp;<span class="ident" id="5541800">f</span><span class="op" id="5541801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541805">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541817">if</span>&nbsp;<span class="ident" id="5541820">f</span><span class="op" id="5541821">,</span>&nbsp;<span class="ident" id="5541823">ok</span>&nbsp;<span class="op" id="5541826">:=</span>&nbsp;<span class="ident" id="5541829">w</span><span class="op" id="5541830">.</span><span class="op" id="5541831">(</span><span class="op" id="5541832">*</span><span class="ident" id="5541833">os</span><span class="op" id="5541835">.</span><span class="ident" id="5541836">File</span><span class="op" id="5541840">)</span><span class="op" id="5541841">;</span>&nbsp;<span class="ident" id="5541843">ok</span>&nbsp;<span class="op" id="5541846">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541850">return</span>&nbsp;<span class="ident" id="5541857">f</span><span class="op" id="5541858">,</span>&nbsp;<span class="ident" id="5541860">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541869">pr</span><span class="op" id="5541871">,</span>&nbsp;<span class="ident" id="5541873">pw</span><span class="op" id="5541875">,</span>&nbsp;<span class="ident" id="5541877">err</span>&nbsp;<span class="op" id="5541881">:=</span>&nbsp;<span class="ident" id="5541884">os</span><span class="op" id="5541886">.</span><span class="ident" id="5541887">Pipe</span><span class="op" id="5541891">(</span><span class="op" id="5541892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541895">if</span>&nbsp;<span class="ident" id="5541898">err</span>&nbsp;<span class="op" id="5541902">!=</span>&nbsp;<span class="ident" id="5541905">nil</span>&nbsp;<span class="op" id="5541909">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541913">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541925">c</span><span class="op" id="5541926">.</span><span class="ident" id="5541927">closeAfterStart</span>&nbsp;<span class="op" id="5541943">=</span>&nbsp;<span class="builtinfunc" id="5541945">append</span><span class="op" id="5541951">(</span><span class="ident" id="5541952">c</span><span class="op" id="5541953">.</span><span class="ident" id="5541954">closeAfterStart</span><span class="op" id="5541969">,</span>&nbsp;<span class="ident" id="5541971">pw</span><span class="op" id="5541973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541976">c</span><span class="op" id="5541977">.</span><span class="ident" id="5541978">closeAfterWait</span>&nbsp;<span class="op" id="5541993">=</span>&nbsp;<span class="builtinfunc" id="5541995">append</span><span class="op" id="5542001">(</span><span class="ident" id="5542002">c</span><span class="op" id="5542003">.</span><span class="ident" id="5542004">closeAfterWait</span><span class="op" id="5542018">,</span>&nbsp;<span class="ident" id="5542020">pr</span><span class="op" id="5542022">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542025">c</span><span class="op" id="5542026">.</span><span class="ident" id="5542027">goroutine</span>&nbsp;<span class="op" id="5542037">=</span>&nbsp;<span class="builtinfunc" id="5542039">append</span><span class="op" id="5542045">(</span><span class="ident" id="5542046">c</span><span class="op" id="5542047">.</span><span class="ident" id="5542048">goroutine</span><span class="op" id="5542057">,</span>&nbsp;<span class="keyword" id="5542059">func</span><span class="op" id="5542063">(</span><span class="op" id="5542064">)</span>&nbsp;<span class="builtintype" id="5542066">error</span>&nbsp;<span class="op" id="5542072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542076">_</span><span class="op" id="5542077">,</span>&nbsp;<span class="ident" id="5542079">err</span>&nbsp;<span class="op" id="5542083">:=</span>&nbsp;<span class="ident" id="5542086">io</span><span class="op" id="5542088">.</span><span class="ident" id="5542089">Copy</span><span class="op" id="5542093">(</span><span class="ident" id="5542094">w</span><span class="op" id="5542095">,</span>&nbsp;<span class="ident" id="5542097">pr</span><span class="op" id="5542099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542103">return</span>&nbsp;<span class="ident" id="5542110">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5542115">}</span><span class="op" id="5542116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542119">return</span>&nbsp;<span class="ident" id="5542126">pw</span><span class="op" id="5542128">,</span>&nbsp;<span class="ident" id="5542130">nil</span><br>
<span class="lineno">225</span><span class="op" id="5542134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5542137">func</span>&nbsp;<span class="op" id="5542142">(</span><span class="ident" id="5542143">c</span>&nbsp;<span class="op" id="5542145">*</span><span class="ident" id="5542146">Cmd</span><span class="op" id="5542149">)</span>&nbsp;<span class="ident" id="5542151">closeDescriptors</span><span class="op" id="5542167">(</span><span class="ident" id="5542168">closers</span>&nbsp;<span class="op" id="5542176">[</span><span class="op" id="5542177">]</span><span class="ident" id="5542178">io</span><span class="op" id="5542180">.</span><span class="ident" id="5542181">Closer</span><span class="op" id="5542187">)</span>&nbsp;<span class="op" id="5542189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542192">for</span>&nbsp;<span class="ident" id="5542196">_</span><span class="op" id="5542197">,</span>&nbsp;<span class="ident" id="5542199">fd</span>&nbsp;<span class="op" id="5542202">:=</span>&nbsp;<span class="keyword" id="5542205">range</span>&nbsp;<span class="ident" id="5542211">closers</span>&nbsp;<span class="op" id="5542219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542223">fd</span><span class="op" id="5542225">.</span><span class="ident" id="5542226">Close</span><span class="op" id="5542231">(</span><span class="op" id="5542232">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5542235">}</span><br>
<span class="lineno"></span><span class="op" id="5542237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5542240">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5542306">//</span><br>
<span class="lineno">235</span><span class="comment" id="5542309">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5542375">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5542440">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5542451">//</span><br>
<span class="lineno"></span><span class="comment" id="5542454">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5542523">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5542580">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5542610">func</span>&nbsp;<span class="op" id="5542615">(</span><span class="ident" id="5542616">c</span>&nbsp;<span class="op" id="5542618">*</span><span class="ident" id="5542619">Cmd</span><span class="op" id="5542622">)</span>&nbsp;<span class="ident" id="5542624">Run</span><span class="op" id="5542627">(</span><span class="op" id="5542628">)</span>&nbsp;<span class="builtintype" id="5542630">error</span>&nbsp;<span class="op" id="5542636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542639">if</span>&nbsp;<span class="ident" id="5542642">err</span>&nbsp;<span class="op" id="5542646">:=</span>&nbsp;<span class="ident" id="5542649">c</span><span class="op" id="5542650">.</span><span class="ident" id="5542651">Start</span><span class="op" id="5542656">(</span><span class="op" id="5542657">)</span><span class="op" id="5542658">;</span>&nbsp;<span class="ident" id="5542660">err</span>&nbsp;<span class="op" id="5542664">!=</span>&nbsp;<span class="ident" id="5542667">nil</span>&nbsp;<span class="op" id="5542671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542675">return</span>&nbsp;<span class="ident" id="5542682">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5542687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542690">return</span>&nbsp;<span class="ident" id="5542697">c</span><span class="op" id="5542698">.</span><span class="ident" id="5542699">Wait</span><span class="op" id="5542703">(</span><span class="op" id="5542704">)</span><br>
<span class="lineno"></span><span class="op" id="5542706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5542709">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5542773">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5542824">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5542906">func</span>&nbsp;<span class="ident" id="5542911">lookExtensions</span><span class="op" id="5542925">(</span><span class="ident" id="5542926">path</span><span class="op" id="5542930">,</span>&nbsp;<span class="ident" id="5542932">dir</span>&nbsp;<span class="builtintype" id="5542936">string</span><span class="op" id="5542942">)</span>&nbsp;<span class="op" id="5542944">(</span><span class="builtintype" id="5542945">string</span><span class="op" id="5542951">,</span>&nbsp;<span class="builtintype" id="5542953">error</span><span class="op" id="5542958">)</span>&nbsp;<span class="op" id="5542960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542963">if</span>&nbsp;<span class="ident" id="5542966">filepath</span><span class="op" id="5542974">.</span><span class="ident" id="5542975">Base</span><span class="op" id="5542979">(</span><span class="ident" id="5542980">path</span><span class="op" id="5542984">)</span>&nbsp;<span class="op" id="5542986">==</span>&nbsp;<span class="ident" id="5542989">path</span>&nbsp;<span class="op" id="5542994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542998">path</span>&nbsp;<span class="op" id="5543003">=</span>&nbsp;<span class="ident" id="5543005">filepath</span><span class="op" id="5543013">.</span><span class="ident" id="5543014">Join</span><span class="op" id="5543018">(</span><span class="string" id="5543019">&#34;.&#34;</span><span class="op" id="5543022">,</span>&nbsp;<span class="ident" id="5543024">path</span><span class="op" id="5543028">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543034">if</span>&nbsp;<span class="ident" id="5543037">dir</span>&nbsp;<span class="op" id="5543041">==</span>&nbsp;<span class="string" id="5543044">&#34;&#34;</span>&nbsp;<span class="op" id="5543047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543051">return</span>&nbsp;<span class="ident" id="5543058">LookPath</span><span class="op" id="5543066">(</span><span class="ident" id="5543067">path</span><span class="op" id="5543071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543077">if</span>&nbsp;<span class="ident" id="5543080">filepath</span><span class="op" id="5543088">.</span><span class="ident" id="5543089">VolumeName</span><span class="op" id="5543099">(</span><span class="ident" id="5543100">path</span><span class="op" id="5543104">)</span>&nbsp;<span class="op" id="5543106">!=</span>&nbsp;<span class="string" id="5543109">&#34;&#34;</span>&nbsp;<span class="op" id="5543112">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543116">return</span>&nbsp;<span class="ident" id="5543123">LookPath</span><span class="op" id="5543131">(</span><span class="ident" id="5543132">path</span><span class="op" id="5543136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543142">if</span>&nbsp;<span class="builtinfunc" id="5543145">len</span><span class="op" id="5543148">(</span><span class="ident" id="5543149">path</span><span class="op" id="5543153">)</span>&nbsp;<span class="op" id="5543155">&gt;</span>&nbsp;<span class="num" id="5543157">1</span>&nbsp;<span class="op" id="5543159">&amp;&amp;</span>&nbsp;<span class="ident" id="5543162">os</span><span class="op" id="5543164">.</span><span class="ident" id="5543165">IsPathSeparator</span><span class="op" id="5543180">(</span><span class="ident" id="5543181">path</span><span class="op" id="5543185">[</span><span class="num" id="5543186">0</span><span class="op" id="5543187">]</span><span class="op" id="5543188">)</span>&nbsp;<span class="op" id="5543190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543194">return</span>&nbsp;<span class="ident" id="5543201">LookPath</span><span class="op" id="5543209">(</span><span class="ident" id="5543210">path</span><span class="op" id="5543214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543217">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543220">dirandpath</span>&nbsp;<span class="op" id="5543231">:=</span>&nbsp;<span class="ident" id="5543234">filepath</span><span class="op" id="5543242">.</span><span class="ident" id="5543243">Join</span><span class="op" id="5543247">(</span><span class="ident" id="5543248">dir</span><span class="op" id="5543251">,</span>&nbsp;<span class="ident" id="5543253">path</span><span class="op" id="5543257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5543260">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543318">lp</span><span class="op" id="5543320">,</span>&nbsp;<span class="ident" id="5543322">err</span>&nbsp;<span class="op" id="5543326">:=</span>&nbsp;<span class="ident" id="5543329">LookPath</span><span class="op" id="5543337">(</span><span class="ident" id="5543338">dirandpath</span><span class="op" id="5543348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543351">if</span>&nbsp;<span class="ident" id="5543354">err</span>&nbsp;<span class="op" id="5543358">!=</span>&nbsp;<span class="ident" id="5543361">nil</span>&nbsp;<span class="op" id="5543365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543369">return</span>&nbsp;<span class="string" id="5543376">&#34;&#34;</span><span class="op" id="5543378">,</span>&nbsp;<span class="ident" id="5543380">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543388">ext</span>&nbsp;<span class="op" id="5543392">:=</span>&nbsp;<span class="ident" id="5543395">strings</span><span class="op" id="5543402">.</span><span class="ident" id="5543403">TrimPrefix</span><span class="op" id="5543413">(</span><span class="ident" id="5543414">lp</span><span class="op" id="5543416">,</span>&nbsp;<span class="ident" id="5543418">dirandpath</span><span class="op" id="5543428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543431">return</span>&nbsp;<span class="ident" id="5543438">path</span>&nbsp;<span class="op" id="5543443">+</span>&nbsp;<span class="ident" id="5543445">ext</span><span class="op" id="5543448">,</span>&nbsp;<span class="ident" id="5543450">nil</span><br>
<span class="lineno"></span><span class="op" id="5543454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5543457">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5543533">//</span><br>
<span class="lineno"></span><span class="comment" id="5543536">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5543614">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5543641">func</span>&nbsp;<span class="op" id="5543646">(</span><span class="ident" id="5543647">c</span>&nbsp;<span class="op" id="5543649">*</span><span class="ident" id="5543650">Cmd</span><span class="op" id="5543653">)</span>&nbsp;<span class="ident" id="5543655">Start</span><span class="op" id="5543660">(</span><span class="op" id="5543661">)</span>&nbsp;<span class="builtintype" id="5543663">error</span>&nbsp;<span class="op" id="5543669">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543672">if</span>&nbsp;<span class="ident" id="5543675">c</span><span class="op" id="5543676">.</span><span class="ident" id="5543677">lookPathErr</span>&nbsp;<span class="op" id="5543689">!=</span>&nbsp;<span class="ident" id="5543692">nil</span>&nbsp;<span class="op" id="5543696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543700">c</span><span class="op" id="5543701">.</span><span class="ident" id="5543702">closeDescriptors</span><span class="op" id="5543718">(</span><span class="ident" id="5543719">c</span><span class="op" id="5543720">.</span><span class="ident" id="5543721">closeAfterStart</span><span class="op" id="5543736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543740">c</span><span class="op" id="5543741">.</span><span class="ident" id="5543742">closeDescriptors</span><span class="op" id="5543758">(</span><span class="ident" id="5543759">c</span><span class="op" id="5543760">.</span><span class="ident" id="5543761">closeAfterWait</span><span class="op" id="5543775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543779">return</span>&nbsp;<span class="ident" id="5543786">c</span><span class="op" id="5543787">.</span><span class="ident" id="5543788">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543801">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543804">if</span>&nbsp;<span class="ident" id="5543807">runtime</span><span class="op" id="5543814">.</span><span class="ident" id="5543815">GOOS</span>&nbsp;<span class="op" id="5543820">==</span>&nbsp;<span class="string" id="5543823">&#34;windows&#34;</span>&nbsp;<span class="op" id="5543833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543837">lp</span><span class="op" id="5543839">,</span>&nbsp;<span class="ident" id="5543841">err</span>&nbsp;<span class="op" id="5543845">:=</span>&nbsp;<span class="ident" id="5543848">lookExtensions</span><span class="op" id="5543862">(</span><span class="ident" id="5543863">c</span><span class="op" id="5543864">.</span><span class="ident" id="5543865">Path</span><span class="op" id="5543869">,</span>&nbsp;<span class="ident" id="5543871">c</span><span class="op" id="5543872">.</span><span class="ident" id="5543873">Dir</span><span class="op" id="5543876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543880">if</span>&nbsp;<span class="ident" id="5543883">err</span>&nbsp;<span class="op" id="5543887">!=</span>&nbsp;<span class="ident" id="5543890">nil</span>&nbsp;<span class="op" id="5543894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543899">c</span><span class="op" id="5543900">.</span><span class="ident" id="5543901">closeDescriptors</span><span class="op" id="5543917">(</span><span class="ident" id="5543918">c</span><span class="op" id="5543919">.</span><span class="ident" id="5543920">closeAfterStart</span><span class="op" id="5543935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543940">c</span><span class="op" id="5543941">.</span><span class="ident" id="5543942">closeDescriptors</span><span class="op" id="5543958">(</span><span class="ident" id="5543959">c</span><span class="op" id="5543960">.</span><span class="ident" id="5543961">closeAfterWait</span><span class="op" id="5543975">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543980">return</span>&nbsp;<span class="ident" id="5543987">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543997">c</span><span class="op" id="5543998">.</span><span class="ident" id="5543999">Path</span>&nbsp;<span class="op" id="5544004">=</span>&nbsp;<span class="ident" id="5544006">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544013">if</span>&nbsp;<span class="ident" id="5544016">c</span><span class="op" id="5544017">.</span><span class="ident" id="5544018">Process</span>&nbsp;<span class="op" id="5544026">!=</span>&nbsp;<span class="ident" id="5544029">nil</span>&nbsp;<span class="op" id="5544033">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544037">return</span>&nbsp;<span class="ident" id="5544044">errors</span><span class="op" id="5544050">.</span><span class="ident" id="5544051">New</span><span class="op" id="5544054">(</span><span class="string" id="5544055">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5544078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544085">type</span>&nbsp;<span class="ident" id="5544090">F</span>&nbsp;<span class="keyword" id="5544092">func</span><span class="op" id="5544096">(</span><span class="op" id="5544097">*</span><span class="ident" id="5544098">Cmd</span><span class="op" id="5544101">)</span>&nbsp;<span class="op" id="5544103">(</span><span class="op" id="5544104">*</span><span class="ident" id="5544105">os</span><span class="op" id="5544107">.</span><span class="ident" id="5544108">File</span><span class="op" id="5544112">,</span>&nbsp;<span class="builtintype" id="5544114">error</span><span class="op" id="5544119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544122">for</span>&nbsp;<span class="ident" id="5544126">_</span><span class="op" id="5544127">,</span>&nbsp;<span class="ident" id="5544129">setupFd</span>&nbsp;<span class="op" id="5544137">:=</span>&nbsp;<span class="keyword" id="5544140">range</span>&nbsp;<span class="op" id="5544146">[</span><span class="op" id="5544147">]</span><span class="ident" id="5544148">F</span><span class="op" id="5544149">{</span><span class="op" id="5544150">(</span><span class="op" id="5544151">*</span><span class="ident" id="5544152">Cmd</span><span class="op" id="5544155">)</span><span class="op" id="5544156">.</span><span class="ident" id="5544157">stdin</span><span class="op" id="5544162">,</span>&nbsp;<span class="op" id="5544164">(</span><span class="op" id="5544165">*</span><span class="ident" id="5544166">Cmd</span><span class="op" id="5544169">)</span><span class="op" id="5544170">.</span><span class="ident" id="5544171">stdout</span><span class="op" id="5544177">,</span>&nbsp;<span class="op" id="5544179">(</span><span class="op" id="5544180">*</span><span class="ident" id="5544181">Cmd</span><span class="op" id="5544184">)</span><span class="op" id="5544185">.</span><span class="ident" id="5544186">stderr</span><span class="op" id="5544192">}</span>&nbsp;<span class="op" id="5544194">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544198">fd</span><span class="op" id="5544200">,</span>&nbsp;<span class="ident" id="5544202">err</span>&nbsp;<span class="op" id="5544206">:=</span>&nbsp;<span class="ident" id="5544209">setupFd</span><span class="op" id="5544216">(</span><span class="ident" id="5544217">c</span><span class="op" id="5544218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544222">if</span>&nbsp;<span class="ident" id="5544225">err</span>&nbsp;<span class="op" id="5544229">!=</span>&nbsp;<span class="ident" id="5544232">nil</span>&nbsp;<span class="op" id="5544236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544241">c</span><span class="op" id="5544242">.</span><span class="ident" id="5544243">closeDescriptors</span><span class="op" id="5544259">(</span><span class="ident" id="5544260">c</span><span class="op" id="5544261">.</span><span class="ident" id="5544262">closeAfterStart</span><span class="op" id="5544277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544282">c</span><span class="op" id="5544283">.</span><span class="ident" id="5544284">closeDescriptors</span><span class="op" id="5544300">(</span><span class="ident" id="5544301">c</span><span class="op" id="5544302">.</span><span class="ident" id="5544303">closeAfterWait</span><span class="op" id="5544317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544322">return</span>&nbsp;<span class="ident" id="5544329">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544339">c</span><span class="op" id="5544340">.</span><span class="ident" id="5544341">childFiles</span>&nbsp;<span class="op" id="5544352">=</span>&nbsp;<span class="builtinfunc" id="5544354">append</span><span class="op" id="5544360">(</span><span class="ident" id="5544361">c</span><span class="op" id="5544362">.</span><span class="ident" id="5544363">childFiles</span><span class="op" id="5544373">,</span>&nbsp;<span class="ident" id="5544375">fd</span><span class="op" id="5544377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544383">c</span><span class="op" id="5544384">.</span><span class="ident" id="5544385">childFiles</span>&nbsp;<span class="op" id="5544396">=</span>&nbsp;<span class="builtinfunc" id="5544398">append</span><span class="op" id="5544404">(</span><span class="ident" id="5544405">c</span><span class="op" id="5544406">.</span><span class="ident" id="5544407">childFiles</span><span class="op" id="5544417">,</span>&nbsp;<span class="ident" id="5544419">c</span><span class="op" id="5544420">.</span><span class="ident" id="5544421">ExtraFiles</span><span class="op" id="5544431">...</span><span class="op" id="5544434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544438">var</span>&nbsp;<span class="ident" id="5544442">err</span>&nbsp;<span class="builtintype" id="5544446">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544453">c</span><span class="op" id="5544454">.</span><span class="ident" id="5544455">Process</span><span class="op" id="5544462">,</span>&nbsp;<span class="ident" id="5544464">err</span>&nbsp;<span class="op" id="5544468">=</span>&nbsp;<span class="ident" id="5544470">os</span><span class="op" id="5544472">.</span><span class="ident" id="5544473">StartProcess</span><span class="op" id="5544485">(</span><span class="ident" id="5544486">c</span><span class="op" id="5544487">.</span><span class="ident" id="5544488">Path</span><span class="op" id="5544492">,</span>&nbsp;<span class="ident" id="5544494">c</span><span class="op" id="5544495">.</span><span class="ident" id="5544496">argv</span><span class="op" id="5544500">(</span><span class="op" id="5544501">)</span><span class="op" id="5544502">,</span>&nbsp;<span class="op" id="5544504">&amp;</span><span class="ident" id="5544505">os</span><span class="op" id="5544507">.</span><span class="ident" id="5544508">ProcAttr</span><span class="op" id="5544516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544520">Dir</span><span class="op" id="5544523">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5544527">c</span><span class="op" id="5544528">.</span><span class="ident" id="5544529">Dir</span><span class="op" id="5544532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544536">Files</span><span class="op" id="5544541">:</span>&nbsp;<span class="ident" id="5544543">c</span><span class="op" id="5544544">.</span><span class="ident" id="5544545">childFiles</span><span class="op" id="5544555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544559">Env</span><span class="op" id="5544562">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5544566">c</span><span class="op" id="5544567">.</span><span class="ident" id="5544568">envv</span><span class="op" id="5544572">(</span><span class="op" id="5544573">)</span><span class="op" id="5544574">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544578">Sys</span><span class="op" id="5544581">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5544585">c</span><span class="op" id="5544586">.</span><span class="ident" id="5544587">SysProcAttr</span><span class="op" id="5544598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544601">}</span><span class="op" id="5544602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544605">if</span>&nbsp;<span class="ident" id="5544608">err</span>&nbsp;<span class="op" id="5544612">!=</span>&nbsp;<span class="ident" id="5544615">nil</span>&nbsp;<span class="op" id="5544619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544623">c</span><span class="op" id="5544624">.</span><span class="ident" id="5544625">closeDescriptors</span><span class="op" id="5544641">(</span><span class="ident" id="5544642">c</span><span class="op" id="5544643">.</span><span class="ident" id="5544644">closeAfterStart</span><span class="op" id="5544659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544663">c</span><span class="op" id="5544664">.</span><span class="ident" id="5544665">closeDescriptors</span><span class="op" id="5544681">(</span><span class="ident" id="5544682">c</span><span class="op" id="5544683">.</span><span class="ident" id="5544684">closeAfterWait</span><span class="op" id="5544698">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544702">return</span>&nbsp;<span class="ident" id="5544709">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544718">c</span><span class="op" id="5544719">.</span><span class="ident" id="5544720">closeDescriptors</span><span class="op" id="5544736">(</span><span class="ident" id="5544737">c</span><span class="op" id="5544738">.</span><span class="ident" id="5544739">closeAfterStart</span><span class="op" id="5544754">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544758">c</span><span class="op" id="5544759">.</span><span class="ident" id="5544760">errch</span>&nbsp;<span class="op" id="5544766">=</span>&nbsp;<span class="builtinfunc" id="5544768">make</span><span class="op" id="5544772">(</span><span class="keyword" id="5544773">chan</span>&nbsp;<span class="builtintype" id="5544778">error</span><span class="op" id="5544783">,</span>&nbsp;<span class="builtinfunc" id="5544785">len</span><span class="op" id="5544788">(</span><span class="ident" id="5544789">c</span><span class="op" id="5544790">.</span><span class="ident" id="5544791">goroutine</span><span class="op" id="5544800">)</span><span class="op" id="5544801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544804">for</span>&nbsp;<span class="ident" id="5544808">_</span><span class="op" id="5544809">,</span>&nbsp;<span class="ident" id="5544811">fn</span>&nbsp;<span class="op" id="5544814">:=</span>&nbsp;<span class="keyword" id="5544817">range</span>&nbsp;<span class="ident" id="5544823">c</span><span class="op" id="5544824">.</span><span class="ident" id="5544825">goroutine</span>&nbsp;<span class="op" id="5544835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544839">go</span>&nbsp;<span class="keyword" id="5544842">func</span><span class="op" id="5544846">(</span><span class="ident" id="5544847">fn</span>&nbsp;<span class="keyword" id="5544850">func</span><span class="op" id="5544854">(</span><span class="op" id="5544855">)</span>&nbsp;<span class="builtintype" id="5544857">error</span><span class="op" id="5544862">)</span>&nbsp;<span class="op" id="5544864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544869">c</span><span class="op" id="5544870">.</span><span class="ident" id="5544871">errch</span>&nbsp;<span class="op" id="5544877">&lt;-</span>&nbsp;<span class="ident" id="5544880">fn</span><span class="op" id="5544882">(</span><span class="op" id="5544883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544887">}</span><span class="op" id="5544888">(</span><span class="ident" id="5544889">fn</span><span class="op" id="5544891">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544898">return</span>&nbsp;<span class="ident" id="5544905">nil</span><br>
<span class="lineno"></span><span class="op" id="5544909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5544912">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5544971">type</span>&nbsp;<span class="ident" id="5544976">ExitError</span>&nbsp;<span class="keyword" id="5544986">struct</span>&nbsp;<span class="op" id="5544993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544996">*</span><span class="ident" id="5544997">os</span><span class="op" id="5544999">.</span><span class="ident" id="5545000">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5545013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5545016">func</span>&nbsp;<span class="op" id="5545021">(</span><span class="ident" id="5545022">e</span>&nbsp;<span class="op" id="5545024">*</span><span class="ident" id="5545025">ExitError</span><span class="op" id="5545034">)</span>&nbsp;<span class="ident" id="5545036">Error</span><span class="op" id="5545041">(</span><span class="op" id="5545042">)</span>&nbsp;<span class="builtintype" id="5545044">string</span>&nbsp;<span class="op" id="5545051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545054">return</span>&nbsp;<span class="ident" id="5545061">e</span><span class="op" id="5545062">.</span><span class="ident" id="5545063">ProcessState</span><span class="op" id="5545075">.</span><span class="ident" id="5545076">String</span><span class="op" id="5545082">(</span><span class="op" id="5545083">)</span><br>
<span class="lineno"></span><span class="op" id="5545085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5545088">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5545127">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5545166">//</span><br>
<span class="lineno"></span><span class="comment" id="5545169">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5545235">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5545300">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5545311">//</span><br>
<span class="lineno"></span><span class="comment" id="5545314">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5545383">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5545440">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5545470">//</span><br>
<span class="lineno">355</span><span class="comment" id="5545473">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5545529">func</span>&nbsp;<span class="op" id="5545534">(</span><span class="ident" id="5545535">c</span>&nbsp;<span class="op" id="5545537">*</span><span class="ident" id="5545538">Cmd</span><span class="op" id="5545541">)</span>&nbsp;<span class="ident" id="5545543">Wait</span><span class="op" id="5545547">(</span><span class="op" id="5545548">)</span>&nbsp;<span class="builtintype" id="5545550">error</span>&nbsp;<span class="op" id="5545556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545559">if</span>&nbsp;<span class="ident" id="5545562">c</span><span class="op" id="5545563">.</span><span class="ident" id="5545564">Process</span>&nbsp;<span class="op" id="5545572">==</span>&nbsp;<span class="ident" id="5545575">nil</span>&nbsp;<span class="op" id="5545579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545583">return</span>&nbsp;<span class="ident" id="5545590">errors</span><span class="op" id="5545596">.</span><span class="ident" id="5545597">New</span><span class="op" id="5545600">(</span><span class="string" id="5545601">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5545620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5545623">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545626">if</span>&nbsp;<span class="ident" id="5545629">c</span><span class="op" id="5545630">.</span><span class="ident" id="5545631">finished</span>&nbsp;<span class="op" id="5545640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545644">return</span>&nbsp;<span class="ident" id="5545651">errors</span><span class="op" id="5545657">.</span><span class="ident" id="5545658">New</span><span class="op" id="5545661">(</span><span class="string" id="5545662">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5545693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5545696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545699">c</span><span class="op" id="5545700">.</span><span class="ident" id="5545701">finished</span>&nbsp;<span class="op" id="5545710">=</span>&nbsp;<span class="builtintype" id="5545712">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545718">state</span><span class="op" id="5545723">,</span>&nbsp;<span class="ident" id="5545725">err</span>&nbsp;<span class="op" id="5545729">:=</span>&nbsp;<span class="ident" id="5545732">c</span><span class="op" id="5545733">.</span><span class="ident" id="5545734">Process</span><span class="op" id="5545741">.</span><span class="ident" id="5545742">Wait</span><span class="op" id="5545746">(</span><span class="op" id="5545747">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545750">c</span><span class="op" id="5545751">.</span><span class="ident" id="5545752">ProcessState</span>&nbsp;<span class="op" id="5545765">=</span>&nbsp;<span class="ident" id="5545767">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545775">var</span>&nbsp;<span class="ident" id="5545779">copyError</span>&nbsp;<span class="builtintype" id="5545789">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545796">for</span>&nbsp;<span class="keyword" id="5545800">range</span>&nbsp;<span class="ident" id="5545806">c</span><span class="op" id="5545807">.</span><span class="ident" id="5545808">goroutine</span>&nbsp;<span class="op" id="5545818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545822">if</span>&nbsp;<span class="ident" id="5545825">err</span>&nbsp;<span class="op" id="5545829">:=</span>&nbsp;<span class="op" id="5545832">&lt;-</span><span class="ident" id="5545834">c</span><span class="op" id="5545835">.</span><span class="ident" id="5545836">errch</span><span class="op" id="5545841">;</span>&nbsp;<span class="ident" id="5545843">err</span>&nbsp;<span class="op" id="5545847">!=</span>&nbsp;<span class="ident" id="5545850">nil</span>&nbsp;<span class="op" id="5545854">&amp;&amp;</span>&nbsp;<span class="ident" id="5545857">copyError</span>&nbsp;<span class="op" id="5545867">==</span>&nbsp;<span class="ident" id="5545870">nil</span>&nbsp;<span class="op" id="5545874">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545879">copyError</span>&nbsp;<span class="op" id="5545889">=</span>&nbsp;<span class="ident" id="5545891">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5545897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5545900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545904">c</span><span class="op" id="5545905">.</span><span class="ident" id="5545906">closeDescriptors</span><span class="op" id="5545922">(</span><span class="ident" id="5545923">c</span><span class="op" id="5545924">.</span><span class="ident" id="5545925">closeAfterWait</span><span class="op" id="5545939">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545943">if</span>&nbsp;<span class="ident" id="5545946">err</span>&nbsp;<span class="op" id="5545950">!=</span>&nbsp;<span class="ident" id="5545953">nil</span>&nbsp;<span class="op" id="5545957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5545961">return</span>&nbsp;<span class="ident" id="5545968">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5545973">}</span>&nbsp;<span class="keyword" id="5545975">else</span>&nbsp;<span class="keyword" id="5545980">if</span>&nbsp;<span class="op" id="5545983">!</span><span class="ident" id="5545984">state</span><span class="op" id="5545989">.</span><span class="ident" id="5545990">Success</span><span class="op" id="5545997">(</span><span class="op" id="5545998">)</span>&nbsp;<span class="op" id="5546000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546004">return</span>&nbsp;<span class="op" id="5546011">&amp;</span><span class="ident" id="5546012">ExitError</span><span class="op" id="5546021">{</span><span class="ident" id="5546022">state</span><span class="op" id="5546027">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5546030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546034">return</span>&nbsp;<span class="ident" id="5546041">copyError</span><br>
<span class="lineno"></span><span class="op" id="5546051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5546054">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5546114">func</span>&nbsp;<span class="op" id="5546119">(</span><span class="ident" id="5546120">c</span>&nbsp;<span class="op" id="5546122">*</span><span class="ident" id="5546123">Cmd</span><span class="op" id="5546126">)</span>&nbsp;<span class="ident" id="5546128">Output</span><span class="op" id="5546134">(</span><span class="op" id="5546135">)</span>&nbsp;<span class="op" id="5546137">(</span><span class="op" id="5546138">[</span><span class="op" id="5546139">]</span><span class="builtintype" id="5546140">byte</span><span class="op" id="5546144">,</span>&nbsp;<span class="builtintype" id="5546146">error</span><span class="op" id="5546151">)</span>&nbsp;<span class="op" id="5546153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546156">if</span>&nbsp;<span class="ident" id="5546159">c</span><span class="op" id="5546160">.</span><span class="ident" id="5546161">Stdout</span>&nbsp;<span class="op" id="5546168">!=</span>&nbsp;<span class="ident" id="5546171">nil</span>&nbsp;<span class="op" id="5546175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546179">return</span>&nbsp;<span class="ident" id="5546186">nil</span><span class="op" id="5546189">,</span>&nbsp;<span class="ident" id="5546191">errors</span><span class="op" id="5546197">.</span><span class="ident" id="5546198">New</span><span class="op" id="5546201">(</span><span class="string" id="5546202">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5546228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5546231">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546234">var</span>&nbsp;<span class="ident" id="5546238">b</span>&nbsp;<span class="ident" id="5546240">bytes</span><span class="op" id="5546245">.</span><span class="ident" id="5546246">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5546254">c</span><span class="op" id="5546255">.</span><span class="ident" id="5546256">Stdout</span>&nbsp;<span class="op" id="5546263">=</span>&nbsp;<span class="op" id="5546265">&amp;</span><span class="ident" id="5546266">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5546269">err</span>&nbsp;<span class="op" id="5546273">:=</span>&nbsp;<span class="ident" id="5546276">c</span><span class="op" id="5546277">.</span><span class="ident" id="5546278">Run</span><span class="op" id="5546281">(</span><span class="op" id="5546282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546285">return</span>&nbsp;<span class="ident" id="5546292">b</span><span class="op" id="5546293">.</span><span class="ident" id="5546294">Bytes</span><span class="op" id="5546299">(</span><span class="op" id="5546300">)</span><span class="op" id="5546301">,</span>&nbsp;<span class="ident" id="5546303">err</span><br>
<span class="lineno"></span><span class="op" id="5546307">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5546310">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5546379">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5546409">func</span>&nbsp;<span class="op" id="5546414">(</span><span class="ident" id="5546415">c</span>&nbsp;<span class="op" id="5546417">*</span><span class="ident" id="5546418">Cmd</span><span class="op" id="5546421">)</span>&nbsp;<span class="ident" id="5546423">CombinedOutput</span><span class="op" id="5546437">(</span><span class="op" id="5546438">)</span>&nbsp;<span class="op" id="5546440">(</span><span class="op" id="5546441">[</span><span class="op" id="5546442">]</span><span class="builtintype" id="5546443">byte</span><span class="op" id="5546447">,</span>&nbsp;<span class="builtintype" id="5546449">error</span><span class="op" id="5546454">)</span>&nbsp;<span class="op" id="5546456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546459">if</span>&nbsp;<span class="ident" id="5546462">c</span><span class="op" id="5546463">.</span><span class="ident" id="5546464">Stdout</span>&nbsp;<span class="op" id="5546471">!=</span>&nbsp;<span class="ident" id="5546474">nil</span>&nbsp;<span class="op" id="5546478">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546482">return</span>&nbsp;<span class="ident" id="5546489">nil</span><span class="op" id="5546492">,</span>&nbsp;<span class="ident" id="5546494">errors</span><span class="op" id="5546500">.</span><span class="ident" id="5546501">New</span><span class="op" id="5546504">(</span><span class="string" id="5546505">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5546531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5546534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546537">if</span>&nbsp;<span class="ident" id="5546540">c</span><span class="op" id="5546541">.</span><span class="ident" id="5546542">Stderr</span>&nbsp;<span class="op" id="5546549">!=</span>&nbsp;<span class="ident" id="5546552">nil</span>&nbsp;<span class="op" id="5546556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546560">return</span>&nbsp;<span class="ident" id="5546567">nil</span><span class="op" id="5546570">,</span>&nbsp;<span class="ident" id="5546572">errors</span><span class="op" id="5546578">.</span><span class="ident" id="5546579">New</span><span class="op" id="5546582">(</span><span class="string" id="5546583">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5546609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5546612">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546615">var</span>&nbsp;<span class="ident" id="5546619">b</span>&nbsp;<span class="ident" id="5546621">bytes</span><span class="op" id="5546626">.</span><span class="ident" id="5546627">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5546635">c</span><span class="op" id="5546636">.</span><span class="ident" id="5546637">Stdout</span>&nbsp;<span class="op" id="5546644">=</span>&nbsp;<span class="op" id="5546646">&amp;</span><span class="ident" id="5546647">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5546650">c</span><span class="op" id="5546651">.</span><span class="ident" id="5546652">Stderr</span>&nbsp;<span class="op" id="5546659">=</span>&nbsp;<span class="op" id="5546661">&amp;</span><span class="ident" id="5546662">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5546665">err</span>&nbsp;<span class="op" id="5546669">:=</span>&nbsp;<span class="ident" id="5546672">c</span><span class="op" id="5546673">.</span><span class="ident" id="5546674">Run</span><span class="op" id="5546677">(</span><span class="op" id="5546678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5546681">return</span>&nbsp;<span class="ident" id="5546688">b</span><span class="op" id="5546689">.</span><span class="ident" id="5546690">Bytes</span><span class="op" id="5546695">(</span><span class="op" id="5546696">)</span><span class="op" id="5546697">,</span>&nbsp;<span class="ident" id="5546699">err</span><br>
<span class="lineno">410</span><span class="op" id="5546703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5546706">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5546774">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5546817">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5546892">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5546960">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5547036">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5547082">func</span>&nbsp;<span class="op" id="5547087">(</span><span class="ident" id="5547088">c</span>&nbsp;<span class="op" id="5547090">*</span><span class="ident" id="5547091">Cmd</span><span class="op" id="5547094">)</span>&nbsp;<span class="ident" id="5547096">StdinPipe</span><span class="op" id="5547105">(</span><span class="op" id="5547106">)</span>&nbsp;<span class="op" id="5547108">(</span><span class="ident" id="5547109">io</span><span class="op" id="5547111">.</span><span class="ident" id="5547112">WriteCloser</span><span class="op" id="5547123">,</span>&nbsp;<span class="builtintype" id="5547125">error</span><span class="op" id="5547130">)</span>&nbsp;<span class="op" id="5547132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547135">if</span>&nbsp;<span class="ident" id="5547138">c</span><span class="op" id="5547139">.</span><span class="ident" id="5547140">Stdin</span>&nbsp;<span class="op" id="5547146">!=</span>&nbsp;<span class="ident" id="5547149">nil</span>&nbsp;<span class="op" id="5547153">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547157">return</span>&nbsp;<span class="ident" id="5547164">nil</span><span class="op" id="5547167">,</span>&nbsp;<span class="ident" id="5547169">errors</span><span class="op" id="5547175">.</span><span class="ident" id="5547176">New</span><span class="op" id="5547179">(</span><span class="string" id="5547180">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5547205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5547208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547211">if</span>&nbsp;<span class="ident" id="5547214">c</span><span class="op" id="5547215">.</span><span class="ident" id="5547216">Process</span>&nbsp;<span class="op" id="5547224">!=</span>&nbsp;<span class="ident" id="5547227">nil</span>&nbsp;<span class="op" id="5547231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547235">return</span>&nbsp;<span class="ident" id="5547242">nil</span><span class="op" id="5547245">,</span>&nbsp;<span class="ident" id="5547247">errors</span><span class="op" id="5547253">.</span><span class="ident" id="5547254">New</span><span class="op" id="5547257">(</span><span class="string" id="5547258">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5547297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5547300">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547303">pr</span><span class="op" id="5547305">,</span>&nbsp;<span class="ident" id="5547307">pw</span><span class="op" id="5547309">,</span>&nbsp;<span class="ident" id="5547311">err</span>&nbsp;<span class="op" id="5547315">:=</span>&nbsp;<span class="ident" id="5547318">os</span><span class="op" id="5547320">.</span><span class="ident" id="5547321">Pipe</span><span class="op" id="5547325">(</span><span class="op" id="5547326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547329">if</span>&nbsp;<span class="ident" id="5547332">err</span>&nbsp;<span class="op" id="5547336">!=</span>&nbsp;<span class="ident" id="5547339">nil</span>&nbsp;<span class="op" id="5547343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547347">return</span>&nbsp;<span class="ident" id="5547354">nil</span><span class="op" id="5547357">,</span>&nbsp;<span class="ident" id="5547359">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5547364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547367">c</span><span class="op" id="5547368">.</span><span class="ident" id="5547369">Stdin</span>&nbsp;<span class="op" id="5547375">=</span>&nbsp;<span class="ident" id="5547377">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547381">c</span><span class="op" id="5547382">.</span><span class="ident" id="5547383">closeAfterStart</span>&nbsp;<span class="op" id="5547399">=</span>&nbsp;<span class="builtinfunc" id="5547401">append</span><span class="op" id="5547407">(</span><span class="ident" id="5547408">c</span><span class="op" id="5547409">.</span><span class="ident" id="5547410">closeAfterStart</span><span class="op" id="5547425">,</span>&nbsp;<span class="ident" id="5547427">pr</span><span class="op" id="5547429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547432">wc</span>&nbsp;<span class="op" id="5547435">:=</span>&nbsp;<span class="op" id="5547438">&amp;</span><span class="ident" id="5547439">closeOnce</span><span class="op" id="5547448">{</span><span class="ident" id="5547449">File</span><span class="op" id="5547453">:</span>&nbsp;<span class="ident" id="5547455">pw</span><span class="op" id="5547457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547460">c</span><span class="op" id="5547461">.</span><span class="ident" id="5547462">closeAfterWait</span>&nbsp;<span class="op" id="5547477">=</span>&nbsp;<span class="builtinfunc" id="5547479">append</span><span class="op" id="5547485">(</span><span class="ident" id="5547486">c</span><span class="op" id="5547487">.</span><span class="ident" id="5547488">closeAfterWait</span><span class="op" id="5547502">,</span>&nbsp;<span class="ident" id="5547504">wc</span><span class="op" id="5547506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547509">return</span>&nbsp;<span class="ident" id="5547516">wc</span><span class="op" id="5547518">,</span>&nbsp;<span class="ident" id="5547520">nil</span><br>
<span class="lineno"></span><span class="op" id="5547524">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5547527">type</span>&nbsp;<span class="ident" id="5547532">closeOnce</span>&nbsp;<span class="keyword" id="5547542">struct</span>&nbsp;<span class="op" id="5547549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5547552">*</span><span class="ident" id="5547553">os</span><span class="op" id="5547555">.</span><span class="ident" id="5547556">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547563">once</span>&nbsp;<span class="ident" id="5547568">sync</span><span class="op" id="5547572">.</span><span class="ident" id="5547573">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547579">err</span>&nbsp;&nbsp;<span class="builtintype" id="5547584">error</span><br>
<span class="lineno"></span><span class="op" id="5547590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5547593">func</span>&nbsp;<span class="op" id="5547598">(</span><span class="ident" id="5547599">c</span>&nbsp;<span class="op" id="5547601">*</span><span class="ident" id="5547602">closeOnce</span><span class="op" id="5547611">)</span>&nbsp;<span class="ident" id="5547613">Close</span><span class="op" id="5547618">(</span><span class="op" id="5547619">)</span>&nbsp;<span class="builtintype" id="5547621">error</span>&nbsp;<span class="op" id="5547627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547630">c</span><span class="op" id="5547631">.</span><span class="ident" id="5547632">once</span><span class="op" id="5547636">.</span><span class="ident" id="5547637">Do</span><span class="op" id="5547639">(</span><span class="ident" id="5547640">c</span><span class="op" id="5547641">.</span><span class="builtinfunc" id="5547642">close</span><span class="op" id="5547647">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5547650">return</span>&nbsp;<span class="ident" id="5547657">c</span><span class="op" id="5547658">.</span><span class="ident" id="5547659">err</span><br>
<span class="lineno"></span><span class="op" id="5547663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5547666">func</span>&nbsp;<span class="op" id="5547671">(</span><span class="ident" id="5547672">c</span>&nbsp;<span class="op" id="5547674">*</span><span class="ident" id="5547675">closeOnce</span><span class="op" id="5547684">)</span>&nbsp;<span class="builtinfunc" id="5547686">close</span><span class="op" id="5547691">(</span><span class="op" id="5547692">)</span>&nbsp;<span class="op" id="5547694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5547697">c</span><span class="op" id="5547698">.</span><span class="ident" id="5547699">err</span>&nbsp;<span class="op" id="5547703">=</span>&nbsp;<span class="ident" id="5547705">c</span><span class="op" id="5547706">.</span><span class="ident" id="5547707">File</span><span class="op" id="5547711">.</span><span class="ident" id="5547712">Close</span><span class="op" id="5547717">(</span><span class="op" id="5547718">)</span><br>
<span class="lineno">450</span><span class="op" id="5547720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5547723">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5547792">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5547836">//</span><br>
<span class="lineno">455</span><span class="comment" id="5547839">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5547914">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5547985">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5548064">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5548139">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5548179">func</span>&nbsp;<span class="op" id="5548184">(</span><span class="ident" id="5548185">c</span>&nbsp;<span class="op" id="5548187">*</span><span class="ident" id="5548188">Cmd</span><span class="op" id="5548191">)</span>&nbsp;<span class="ident" id="5548193">StdoutPipe</span><span class="op" id="5548203">(</span><span class="op" id="5548204">)</span>&nbsp;<span class="op" id="5548206">(</span><span class="ident" id="5548207">io</span><span class="op" id="5548209">.</span><span class="ident" id="5548210">ReadCloser</span><span class="op" id="5548220">,</span>&nbsp;<span class="builtintype" id="5548222">error</span><span class="op" id="5548227">)</span>&nbsp;<span class="op" id="5548229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5548232">if</span>&nbsp;<span class="ident" id="5548235">c</span><span class="op" id="5548236">.</span><span class="ident" id="5548237">Stdout</span>&nbsp;<span class="op" id="5548244">!=</span>&nbsp;<span class="ident" id="5548247">nil</span>&nbsp;<span class="op" id="5548251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5548255">return</span>&nbsp;<span class="ident" id="5548262">nil</span><span class="op" id="5548265">,</span>&nbsp;<span class="ident" id="5548267">errors</span><span class="op" id="5548273">.</span><span class="ident" id="5548274">New</span><span class="op" id="5548277">(</span><span class="string" id="5548278">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5548304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5548307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5548310">if</span>&nbsp;<span class="ident" id="5548313">c</span><span class="op" id="5548314">.</span><span class="ident" id="5548315">Process</span>&nbsp;<span class="op" id="5548323">!=</span>&nbsp;<span class="ident" id="5548326">nil</span>&nbsp;<span class="op" id="5548330">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5548334">return</span>&nbsp;<span class="ident" id="5548341">nil</span><span class="op" id="5548344">,</span>&nbsp;<span class="ident" id="5548346">errors</span><span class="op" id="5548352">.</span><span class="ident" id="5548353">New</span><span class="op" id="5548356">(</span><span class="string" id="5548357">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5548397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5548400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5548403">pr</span><span class="op" id="5548405">,</span>&nbsp;<span class="ident" id="5548407">pw</span><span class="op" id="5548409">,</span>&nbsp;<span class="ident" id="5548411">err</span>&nbsp;<span class="op" id="5548415">:=</span>&nbsp;<span class="ident" id="5548418">os</span><span class="op" id="5548420">.</span><span class="ident" id="5548421">Pipe</span><span class="op" id="5548425">(</span><span class="op" id="5548426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5548429">if</span>&nbsp;<span class="ident" id="5548432">err</span>&nbsp;<span class="op" id="5548436">!=</span>&nbsp;<span class="ident" id="5548439">nil</span>&nbsp;<span class="op" id="5548443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5548447">return</span>&nbsp;<span class="ident" id="5548454">nil</span><span class="op" id="5548457">,</span>&nbsp;<span class="ident" id="5548459">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5548464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5548467">c</span><span class="op" id="5548468">.</span><span class="ident" id="5548469">Stdout</span>&nbsp;<span class="op" id="5548476">=</span>&nbsp;<span class="ident" id="5548478">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5548482">c</span><span class="op" id="5548483">.</span><span class="ident" id="5548484">closeAfterStart</span>&nbsp;<span class="op" id="5548500">=</span>&nbsp;<span class="builtinfunc" id="5548502">append</span><span class="op" id="5548508">(</span><span class="ident" id="5548509">c</span><span class="op" id="5548510">.</span><span class="ident" id="5548511">closeAfterStart</span><span class="op" id="5548526">,</span>&nbsp;<span class="ident" id="5548528">pw</span><span class="op" id="5548530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5548533">c</span><span class="op" id="5548534">.</span><span class="ident" id="5548535">closeAfterWait</span>&nbsp;<span class="op" id="5548550">=</span>&nbsp;<span class="builtinfunc" id="5548552">append</span><span class="op" id="5548558">(</span><span class="ident" id="5548559">c</span><span class="op" id="5548560">.</span><span class="ident" id="5548561">closeAfterWait</span><span class="op" id="5548575">,</span>&nbsp;<span class="ident" id="5548577">pr</span><span class="op" id="5548579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5548582">return</span>&nbsp;<span class="ident" id="5548589">pr</span><span class="op" id="5548591">,</span>&nbsp;<span class="ident" id="5548593">nil</span><br>
<span class="lineno">475</span><span class="op" id="5548597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5548600">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5548669">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5548712">//</span><br>
<span class="lineno">480</span><span class="comment" id="5548715">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5548790">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5548861">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5548940">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5549014">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5549065">func</span>&nbsp;<span class="op" id="5549070">(</span><span class="ident" id="5549071">c</span>&nbsp;<span class="op" id="5549073">*</span><span class="ident" id="5549074">Cmd</span><span class="op" id="5549077">)</span>&nbsp;<span class="ident" id="5549079">StderrPipe</span><span class="op" id="5549089">(</span><span class="op" id="5549090">)</span>&nbsp;<span class="op" id="5549092">(</span><span class="ident" id="5549093">io</span><span class="op" id="5549095">.</span><span class="ident" id="5549096">ReadCloser</span><span class="op" id="5549106">,</span>&nbsp;<span class="builtintype" id="5549108">error</span><span class="op" id="5549113">)</span>&nbsp;<span class="op" id="5549115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5549118">if</span>&nbsp;<span class="ident" id="5549121">c</span><span class="op" id="5549122">.</span><span class="ident" id="5549123">Stderr</span>&nbsp;<span class="op" id="5549130">!=</span>&nbsp;<span class="ident" id="5549133">nil</span>&nbsp;<span class="op" id="5549137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5549141">return</span>&nbsp;<span class="ident" id="5549148">nil</span><span class="op" id="5549151">,</span>&nbsp;<span class="ident" id="5549153">errors</span><span class="op" id="5549159">.</span><span class="ident" id="5549160">New</span><span class="op" id="5549163">(</span><span class="string" id="5549164">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5549190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5549193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5549196">if</span>&nbsp;<span class="ident" id="5549199">c</span><span class="op" id="5549200">.</span><span class="ident" id="5549201">Process</span>&nbsp;<span class="op" id="5549209">!=</span>&nbsp;<span class="ident" id="5549212">nil</span>&nbsp;<span class="op" id="5549216">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5549220">return</span>&nbsp;<span class="ident" id="5549227">nil</span><span class="op" id="5549230">,</span>&nbsp;<span class="ident" id="5549232">errors</span><span class="op" id="5549238">.</span><span class="ident" id="5549239">New</span><span class="op" id="5549242">(</span><span class="string" id="5549243">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5549283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5549286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5549289">pr</span><span class="op" id="5549291">,</span>&nbsp;<span class="ident" id="5549293">pw</span><span class="op" id="5549295">,</span>&nbsp;<span class="ident" id="5549297">err</span>&nbsp;<span class="op" id="5549301">:=</span>&nbsp;<span class="ident" id="5549304">os</span><span class="op" id="5549306">.</span><span class="ident" id="5549307">Pipe</span><span class="op" id="5549311">(</span><span class="op" id="5549312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5549315">if</span>&nbsp;<span class="ident" id="5549318">err</span>&nbsp;<span class="op" id="5549322">!=</span>&nbsp;<span class="ident" id="5549325">nil</span>&nbsp;<span class="op" id="5549329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5549333">return</span>&nbsp;<span class="ident" id="5549340">nil</span><span class="op" id="5549343">,</span>&nbsp;<span class="ident" id="5549345">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5549350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5549353">c</span><span class="op" id="5549354">.</span><span class="ident" id="5549355">Stderr</span>&nbsp;<span class="op" id="5549362">=</span>&nbsp;<span class="ident" id="5549364">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5549368">c</span><span class="op" id="5549369">.</span><span class="ident" id="5549370">closeAfterStart</span>&nbsp;<span class="op" id="5549386">=</span>&nbsp;<span class="builtinfunc" id="5549388">append</span><span class="op" id="5549394">(</span><span class="ident" id="5549395">c</span><span class="op" id="5549396">.</span><span class="ident" id="5549397">closeAfterStart</span><span class="op" id="5549412">,</span>&nbsp;<span class="ident" id="5549414">pw</span><span class="op" id="5549416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5549419">c</span><span class="op" id="5549420">.</span><span class="ident" id="5549421">closeAfterWait</span>&nbsp;<span class="op" id="5549436">=</span>&nbsp;<span class="builtinfunc" id="5549438">append</span><span class="op" id="5549444">(</span><span class="ident" id="5549445">c</span><span class="op" id="5549446">.</span><span class="ident" id="5549447">closeAfterWait</span><span class="op" id="5549461">,</span>&nbsp;<span class="ident" id="5549463">pr</span><span class="op" id="5549465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5549468">return</span>&nbsp;<span class="ident" id="5549475">pr</span><span class="op" id="5549477">,</span>&nbsp;<span class="ident" id="5549479">nil</span><br>
<span class="lineno">500</span><span class="op" id="5549483">}</span>
</div>
</body>
</html>
