<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5455897">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5455952">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5456006">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5456057">package</span>&nbsp;<span class="ident" id="5456065">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5456072">import</span>&nbsp;<span class="string" id="5456079">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5456087">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5456147">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5456217">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5456275">//</span><br>
<span class="lineno"></span><span class="comment" id="5456278">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5456326">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5456390">//</span><br>
<span class="lineno"></span><span class="comment" id="5456393">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5456454">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5456524">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5456599">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5456666">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5456739">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5456811">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5456825">//</span><br>
<span class="lineno"></span><span class="comment" id="5456828">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5456894">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5456960">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5456973">//</span><br>
<span class="lineno"></span><span class="comment" id="5456976">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5457000">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5457030">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5457058">//</span><br>
<span class="lineno"></span><span class="comment" id="5457061">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5457077">//</span><br>
<span class="lineno">35</span><span class="comment" id="5457080">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5457086">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="5457105">//</span><br>
<span class="lineno"></span><span class="comment" id="5457108">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5457116">//</span><br>
<span class="lineno">40</span><span class="comment" id="5457119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5457153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="5457188">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5457221">//</span><br>
<span class="lineno"></span><span class="comment" id="5457224">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="5457285">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="5457341">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5457370">//</span><br>
<span class="lineno"></span><span class="comment" id="5457373">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="5457400">//</span><br>
<span class="lineno">50</span><span class="comment" id="5457403">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5457416">//</span><br>
<span class="lineno"></span><span class="comment" id="5457419">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5457459">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5457517">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="5457577">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5457637">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5457698">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5457731">func</span>&nbsp;<span class="ident" id="5457736">Tan</span><span class="op" id="5457739">(</span><span class="ident" id="5457740">x</span>&nbsp;<span class="builtintype" id="5457742">complex128</span><span class="op" id="5457752">)</span>&nbsp;<span class="builtintype" id="5457754">complex128</span>&nbsp;<span class="op" id="5457765">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457768">d</span>&nbsp;<span class="op" id="5457770">:=</span>&nbsp;<span class="ident" id="5457773">math</span><span class="op" id="5457777">.</span><span class="ident" id="5457778">Cos</span><span class="op" id="5457781">(</span><span class="num" id="5457782">2</span><span class="op" id="5457783">*</span><span class="builtinfunc" id="5457784">real</span><span class="op" id="5457788">(</span><span class="ident" id="5457789">x</span><span class="op" id="5457790">)</span><span class="op" id="5457791">)</span>&nbsp;<span class="op" id="5457793">+</span>&nbsp;<span class="ident" id="5457795">math</span><span class="op" id="5457799">.</span><span class="ident" id="5457800">Cosh</span><span class="op" id="5457804">(</span><span class="num" id="5457805">2</span><span class="op" id="5457806">*</span><span class="builtinfunc" id="5457807">imag</span><span class="op" id="5457811">(</span><span class="ident" id="5457812">x</span><span class="op" id="5457813">)</span><span class="op" id="5457814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457817">if</span>&nbsp;<span class="ident" id="5457820">math</span><span class="op" id="5457824">.</span><span class="ident" id="5457825">Abs</span><span class="op" id="5457828">(</span><span class="ident" id="5457829">d</span><span class="op" id="5457830">)</span>&nbsp;<span class="op" id="5457832">&lt;</span>&nbsp;<span class="num" id="5457834">0.25</span>&nbsp;<span class="op" id="5457839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457843">d</span>&nbsp;<span class="op" id="5457845">=</span>&nbsp;<span class="ident" id="5457847">tanSeries</span><span class="op" id="5457856">(</span><span class="ident" id="5457857">x</span><span class="op" id="5457858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5457861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457864">if</span>&nbsp;<span class="ident" id="5457867">d</span>&nbsp;<span class="op" id="5457869">==</span>&nbsp;<span class="num" id="5457872">0</span>&nbsp;<span class="op" id="5457874">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457878">return</span>&nbsp;<span class="ident" id="5457885">Inf</span><span class="op" id="5457888">(</span><span class="op" id="5457889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5457892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457895">return</span>&nbsp;<span class="builtinfunc" id="5457902">complex</span><span class="op" id="5457909">(</span><span class="ident" id="5457910">math</span><span class="op" id="5457914">.</span><span class="ident" id="5457915">Sin</span><span class="op" id="5457918">(</span><span class="num" id="5457919">2</span><span class="op" id="5457920">*</span><span class="builtinfunc" id="5457921">real</span><span class="op" id="5457925">(</span><span class="ident" id="5457926">x</span><span class="op" id="5457927">)</span><span class="op" id="5457928">)</span><span class="op" id="5457929">/</span><span class="ident" id="5457930">d</span><span class="op" id="5457931">,</span>&nbsp;<span class="ident" id="5457933">math</span><span class="op" id="5457937">.</span><span class="ident" id="5457938">Sinh</span><span class="op" id="5457942">(</span><span class="num" id="5457943">2</span><span class="op" id="5457944">*</span><span class="builtinfunc" id="5457945">imag</span><span class="op" id="5457949">(</span><span class="ident" id="5457950">x</span><span class="op" id="5457951">)</span><span class="op" id="5457952">)</span><span class="op" id="5457953">/</span><span class="ident" id="5457954">d</span><span class="op" id="5457955">)</span><br>
<span class="lineno"></span><span class="op" id="5457957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="5457960">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5457990">//</span><br>
<span class="lineno"></span><span class="comment" id="5457993">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5458009">//</span><br>
<span class="lineno"></span><span class="comment" id="5458012">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="5458070">//</span><br>
<span class="lineno"></span><span class="comment" id="5458073">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5458086">//</span><br>
<span class="lineno"></span><span class="comment" id="5458089">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5458129">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="5458187">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5458248">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5458293">func</span>&nbsp;<span class="ident" id="5458298">Tanh</span><span class="op" id="5458302">(</span><span class="ident" id="5458303">x</span>&nbsp;<span class="builtintype" id="5458305">complex128</span><span class="op" id="5458315">)</span>&nbsp;<span class="builtintype" id="5458317">complex128</span>&nbsp;<span class="op" id="5458328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458331">d</span>&nbsp;<span class="op" id="5458333">:=</span>&nbsp;<span class="ident" id="5458336">math</span><span class="op" id="5458340">.</span><span class="ident" id="5458341">Cosh</span><span class="op" id="5458345">(</span><span class="num" id="5458346">2</span><span class="op" id="5458347">*</span><span class="builtinfunc" id="5458348">real</span><span class="op" id="5458352">(</span><span class="ident" id="5458353">x</span><span class="op" id="5458354">)</span><span class="op" id="5458355">)</span>&nbsp;<span class="op" id="5458357">+</span>&nbsp;<span class="ident" id="5458359">math</span><span class="op" id="5458363">.</span><span class="ident" id="5458364">Cos</span><span class="op" id="5458367">(</span><span class="num" id="5458368">2</span><span class="op" id="5458369">*</span><span class="builtinfunc" id="5458370">imag</span><span class="op" id="5458374">(</span><span class="ident" id="5458375">x</span><span class="op" id="5458376">)</span><span class="op" id="5458377">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458380">if</span>&nbsp;<span class="ident" id="5458383">d</span>&nbsp;<span class="op" id="5458385">==</span>&nbsp;<span class="num" id="5458388">0</span>&nbsp;<span class="op" id="5458390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458394">return</span>&nbsp;<span class="ident" id="5458401">Inf</span><span class="op" id="5458404">(</span><span class="op" id="5458405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5458408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458411">return</span>&nbsp;<span class="builtinfunc" id="5458418">complex</span><span class="op" id="5458425">(</span><span class="ident" id="5458426">math</span><span class="op" id="5458430">.</span><span class="ident" id="5458431">Sinh</span><span class="op" id="5458435">(</span><span class="num" id="5458436">2</span><span class="op" id="5458437">*</span><span class="builtinfunc" id="5458438">real</span><span class="op" id="5458442">(</span><span class="ident" id="5458443">x</span><span class="op" id="5458444">)</span><span class="op" id="5458445">)</span><span class="op" id="5458446">/</span><span class="ident" id="5458447">d</span><span class="op" id="5458448">,</span>&nbsp;<span class="ident" id="5458450">math</span><span class="op" id="5458454">.</span><span class="ident" id="5458455">Sin</span><span class="op" id="5458458">(</span><span class="num" id="5458459">2</span><span class="op" id="5458460">*</span><span class="builtinfunc" id="5458461">imag</span><span class="op" id="5458465">(</span><span class="ident" id="5458466">x</span><span class="op" id="5458467">)</span><span class="op" id="5458468">)</span><span class="op" id="5458469">/</span><span class="ident" id="5458470">d</span><span class="op" id="5458471">)</span><br>
<span class="lineno"></span><span class="op" id="5458473">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5458476">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="5458530">func</span>&nbsp;<span class="ident" id="5458535">reducePi</span><span class="op" id="5458543">(</span><span class="ident" id="5458544">x</span>&nbsp;<span class="builtintype" id="5458546">float64</span><span class="op" id="5458553">)</span>&nbsp;<span class="builtintype" id="5458555">float64</span>&nbsp;<span class="op" id="5458563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458566">const</span>&nbsp;<span class="op" id="5458572">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5458576">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458613">DP1</span>&nbsp;<span class="op" id="5458617">=</span>&nbsp;<span class="num" id="5458619">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5458646">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458673">DP2</span>&nbsp;<span class="op" id="5458677">=</span>&nbsp;<span class="num" id="5458679">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="5458706">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458733">DP3</span>&nbsp;<span class="op" id="5458737">=</span>&nbsp;<span class="num" id="5458739">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="5458766">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5458792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458795">t</span>&nbsp;<span class="op" id="5458797">:=</span>&nbsp;<span class="ident" id="5458800">x</span>&nbsp;<span class="op" id="5458802">/</span>&nbsp;<span class="ident" id="5458804">math</span><span class="op" id="5458808">.</span><span class="ident" id="5458809">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458813">if</span>&nbsp;<span class="ident" id="5458816">t</span>&nbsp;<span class="op" id="5458818">&gt;=</span>&nbsp;<span class="num" id="5458821">0</span>&nbsp;<span class="op" id="5458823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458827">t</span>&nbsp;<span class="op" id="5458829">+=</span>&nbsp;<span class="num" id="5458832">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5458837">}</span>&nbsp;<span class="keyword" id="5458839">else</span>&nbsp;<span class="op" id="5458844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458848">t</span>&nbsp;<span class="op" id="5458850">-=</span>&nbsp;<span class="num" id="5458853">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5458858">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458861">t</span>&nbsp;<span class="op" id="5458863">=</span>&nbsp;<span class="builtintype" id="5458865">float64</span><span class="op" id="5458872">(</span><span class="ident" id="5458873">int64</span><span class="op" id="5458878">(</span><span class="ident" id="5458879">t</span><span class="op" id="5458880">)</span><span class="op" id="5458881">)</span>&nbsp;<span class="comment" id="5458883">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458911">return</span>&nbsp;<span class="op" id="5458918">(</span><span class="op" id="5458919">(</span><span class="ident" id="5458920">x</span>&nbsp;<span class="op" id="5458922">-</span>&nbsp;<span class="ident" id="5458924">t</span><span class="op" id="5458925">*</span><span class="ident" id="5458926">DP1</span><span class="op" id="5458929">)</span>&nbsp;<span class="op" id="5458931">-</span>&nbsp;<span class="ident" id="5458933">t</span><span class="op" id="5458934">*</span><span class="ident" id="5458935">DP2</span><span class="op" id="5458938">)</span>&nbsp;<span class="op" id="5458940">-</span>&nbsp;<span class="ident" id="5458942">t</span><span class="op" id="5458943">*</span><span class="ident" id="5458944">DP3</span><br>
<span class="lineno"></span><span class="op" id="5458948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5458951">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="5459001">func</span>&nbsp;<span class="ident" id="5459006">tanSeries</span><span class="op" id="5459015">(</span><span class="ident" id="5459016">z</span>&nbsp;<span class="builtintype" id="5459018">complex128</span><span class="op" id="5459028">)</span>&nbsp;<span class="builtintype" id="5459030">float64</span>&nbsp;<span class="op" id="5459038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459041">const</span>&nbsp;<span class="ident" id="5459047">MACHEP</span>&nbsp;<span class="op" id="5459054">=</span>&nbsp;<span class="num" id="5459056">1.0</span>&nbsp;<span class="op" id="5459060">/</span>&nbsp;<span class="op" id="5459062">(</span><span class="num" id="5459063">1</span>&nbsp;<span class="op" id="5459065">&lt;&lt;</span>&nbsp;<span class="num" id="5459068">53</span><span class="op" id="5459070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459073">x</span>&nbsp;<span class="op" id="5459075">:=</span>&nbsp;<span class="ident" id="5459078">math</span><span class="op" id="5459082">.</span><span class="ident" id="5459083">Abs</span><span class="op" id="5459086">(</span><span class="num" id="5459087">2</span>&nbsp;<span class="op" id="5459089">*</span>&nbsp;<span class="builtinfunc" id="5459091">real</span><span class="op" id="5459095">(</span><span class="ident" id="5459096">z</span><span class="op" id="5459097">)</span><span class="op" id="5459098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459101">y</span>&nbsp;<span class="op" id="5459103">:=</span>&nbsp;<span class="ident" id="5459106">math</span><span class="op" id="5459110">.</span><span class="ident" id="5459111">Abs</span><span class="op" id="5459114">(</span><span class="num" id="5459115">2</span>&nbsp;<span class="op" id="5459117">*</span>&nbsp;<span class="builtinfunc" id="5459119">imag</span><span class="op" id="5459123">(</span><span class="ident" id="5459124">z</span><span class="op" id="5459125">)</span><span class="op" id="5459126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459129">x</span>&nbsp;<span class="op" id="5459131">=</span>&nbsp;<span class="ident" id="5459133">reducePi</span><span class="op" id="5459141">(</span><span class="ident" id="5459142">x</span><span class="op" id="5459143">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459146">x</span>&nbsp;<span class="op" id="5459148">=</span>&nbsp;<span class="ident" id="5459150">x</span>&nbsp;<span class="op" id="5459152">*</span>&nbsp;<span class="ident" id="5459154">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459157">y</span>&nbsp;<span class="op" id="5459159">=</span>&nbsp;<span class="ident" id="5459161">y</span>&nbsp;<span class="op" id="5459163">*</span>&nbsp;<span class="ident" id="5459165">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459168">x2</span>&nbsp;<span class="op" id="5459171">:=</span>&nbsp;<span class="num" id="5459174">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459179">y2</span>&nbsp;<span class="op" id="5459182">:=</span>&nbsp;<span class="num" id="5459185">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459190">f</span>&nbsp;<span class="op" id="5459192">:=</span>&nbsp;<span class="num" id="5459195">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459200">rn</span>&nbsp;<span class="op" id="5459203">:=</span>&nbsp;<span class="num" id="5459206">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459211">d</span>&nbsp;<span class="op" id="5459213">:=</span>&nbsp;<span class="num" id="5459216">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459221">for</span>&nbsp;<span class="op" id="5459225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459229">rn</span>&nbsp;<span class="op" id="5459232">+=</span>&nbsp;<span class="num" id="5459235">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459239">f</span>&nbsp;<span class="op" id="5459241">*=</span>&nbsp;<span class="ident" id="5459244">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459249">rn</span>&nbsp;<span class="op" id="5459252">+=</span>&nbsp;<span class="num" id="5459255">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459259">f</span>&nbsp;<span class="op" id="5459261">*=</span>&nbsp;<span class="ident" id="5459264">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459269">x2</span>&nbsp;<span class="op" id="5459272">*=</span>&nbsp;<span class="ident" id="5459275">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459279">y2</span>&nbsp;<span class="op" id="5459282">*=</span>&nbsp;<span class="ident" id="5459285">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459289">t</span>&nbsp;<span class="op" id="5459291">:=</span>&nbsp;<span class="ident" id="5459294">y2</span>&nbsp;<span class="op" id="5459297">+</span>&nbsp;<span class="ident" id="5459299">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459304">t</span>&nbsp;<span class="op" id="5459306">/=</span>&nbsp;<span class="ident" id="5459309">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459313">d</span>&nbsp;<span class="op" id="5459315">+=</span>&nbsp;<span class="ident" id="5459318">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459323">rn</span>&nbsp;<span class="op" id="5459326">+=</span>&nbsp;<span class="num" id="5459329">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459333">f</span>&nbsp;<span class="op" id="5459335">*=</span>&nbsp;<span class="ident" id="5459338">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459343">rn</span>&nbsp;<span class="op" id="5459346">+=</span>&nbsp;<span class="num" id="5459349">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459353">f</span>&nbsp;<span class="op" id="5459355">*=</span>&nbsp;<span class="ident" id="5459358">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459363">x2</span>&nbsp;<span class="op" id="5459366">*=</span>&nbsp;<span class="ident" id="5459369">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459373">y2</span>&nbsp;<span class="op" id="5459376">*=</span>&nbsp;<span class="ident" id="5459379">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459383">t</span>&nbsp;<span class="op" id="5459385">=</span>&nbsp;<span class="ident" id="5459387">y2</span>&nbsp;<span class="op" id="5459390">-</span>&nbsp;<span class="ident" id="5459392">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459397">t</span>&nbsp;<span class="op" id="5459399">/=</span>&nbsp;<span class="ident" id="5459402">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459406">d</span>&nbsp;<span class="op" id="5459408">+=</span>&nbsp;<span class="ident" id="5459411">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459415">if</span>&nbsp;<span class="ident" id="5459418">math</span><span class="op" id="5459422">.</span><span class="ident" id="5459423">Abs</span><span class="op" id="5459426">(</span><span class="ident" id="5459427">t</span><span class="op" id="5459428">/</span><span class="ident" id="5459429">d</span><span class="op" id="5459430">)</span>&nbsp;<span class="op" id="5459432">&lt;=</span>&nbsp;<span class="ident" id="5459435">MACHEP</span>&nbsp;<span class="op" id="5459442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459447">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459455">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459461">return</span>&nbsp;<span class="ident" id="5459468">d</span><br>
<span class="lineno"></span><span class="op" id="5459470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5459473">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="5459503">//</span><br>
<span class="lineno"></span><span class="comment" id="5459506">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5459522">//</span><br>
<span class="lineno"></span><span class="comment" id="5459525">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5459531">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="5459550">//</span><br>
<span class="lineno"></span><span class="comment" id="5459553">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5459561">//</span><br>
<span class="lineno"></span><span class="comment" id="5459564">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5459598">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="5459633">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="5459666">//</span><br>
<span class="lineno"></span><span class="comment" id="5459669">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="5459724">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="5459781">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="5459804">//</span><br>
<span class="lineno"></span><span class="comment" id="5459807">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5459820">//</span><br>
<span class="lineno"></span><span class="comment" id="5459823">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5459863">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="5459921">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="5459981">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5460041">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5460082">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="5460117">func</span>&nbsp;<span class="ident" id="5460122">Cot</span><span class="op" id="5460125">(</span><span class="ident" id="5460126">x</span>&nbsp;<span class="builtintype" id="5460128">complex128</span><span class="op" id="5460138">)</span>&nbsp;<span class="builtintype" id="5460140">complex128</span>&nbsp;<span class="op" id="5460151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460154">d</span>&nbsp;<span class="op" id="5460156">:=</span>&nbsp;<span class="ident" id="5460159">math</span><span class="op" id="5460163">.</span><span class="ident" id="5460164">Cosh</span><span class="op" id="5460168">(</span><span class="num" id="5460169">2</span><span class="op" id="5460170">*</span><span class="builtinfunc" id="5460171">imag</span><span class="op" id="5460175">(</span><span class="ident" id="5460176">x</span><span class="op" id="5460177">)</span><span class="op" id="5460178">)</span>&nbsp;<span class="op" id="5460180">-</span>&nbsp;<span class="ident" id="5460182">math</span><span class="op" id="5460186">.</span><span class="ident" id="5460187">Cos</span><span class="op" id="5460190">(</span><span class="num" id="5460191">2</span><span class="op" id="5460192">*</span><span class="builtinfunc" id="5460193">real</span><span class="op" id="5460197">(</span><span class="ident" id="5460198">x</span><span class="op" id="5460199">)</span><span class="op" id="5460200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460203">if</span>&nbsp;<span class="ident" id="5460206">math</span><span class="op" id="5460210">.</span><span class="ident" id="5460211">Abs</span><span class="op" id="5460214">(</span><span class="ident" id="5460215">d</span><span class="op" id="5460216">)</span>&nbsp;<span class="op" id="5460218">&lt;</span>&nbsp;<span class="num" id="5460220">0.25</span>&nbsp;<span class="op" id="5460225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460229">d</span>&nbsp;<span class="op" id="5460231">=</span>&nbsp;<span class="ident" id="5460233">tanSeries</span><span class="op" id="5460242">(</span><span class="ident" id="5460243">x</span><span class="op" id="5460244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5460247">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460250">if</span>&nbsp;<span class="ident" id="5460253">d</span>&nbsp;<span class="op" id="5460255">==</span>&nbsp;<span class="num" id="5460258">0</span>&nbsp;<span class="op" id="5460260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460264">return</span>&nbsp;<span class="ident" id="5460271">Inf</span><span class="op" id="5460274">(</span><span class="op" id="5460275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5460278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460281">return</span>&nbsp;<span class="builtinfunc" id="5460288">complex</span><span class="op" id="5460295">(</span><span class="ident" id="5460296">math</span><span class="op" id="5460300">.</span><span class="ident" id="5460301">Sin</span><span class="op" id="5460304">(</span><span class="num" id="5460305">2</span><span class="op" id="5460306">*</span><span class="builtinfunc" id="5460307">real</span><span class="op" id="5460311">(</span><span class="ident" id="5460312">x</span><span class="op" id="5460313">)</span><span class="op" id="5460314">)</span><span class="op" id="5460315">/</span><span class="ident" id="5460316">d</span><span class="op" id="5460317">,</span>&nbsp;<span class="op" id="5460319">-</span><span class="ident" id="5460320">math</span><span class="op" id="5460324">.</span><span class="ident" id="5460325">Sinh</span><span class="op" id="5460329">(</span><span class="num" id="5460330">2</span><span class="op" id="5460331">*</span><span class="builtinfunc" id="5460332">imag</span><span class="op" id="5460336">(</span><span class="ident" id="5460337">x</span><span class="op" id="5460338">)</span><span class="op" id="5460339">)</span><span class="op" id="5460340">/</span><span class="ident" id="5460341">d</span><span class="op" id="5460342">)</span><br>
<span class="lineno"></span><span class="op" id="5460344">}</span>
</div>
</body>
</html>
