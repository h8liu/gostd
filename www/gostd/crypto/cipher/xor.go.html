<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3830485">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3830540">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3830594">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3830645">package</span>&nbsp;<span class="ident" id="3830653">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3830661">import</span>&nbsp;<span class="op" id="3830668">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830671">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3830682">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3830691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3830694">const</span>&nbsp;<span class="ident" id="3830700">wordSize</span>&nbsp;<span class="op" id="3830709">=</span>&nbsp;<span class="builtintype" id="3830711">int</span><span class="op" id="3830714">(</span><span class="ident" id="3830715">unsafe</span><span class="op" id="3830721">.</span><span class="ident" id="3830722">Sizeof</span><span class="op" id="3830728">(</span><span class="builtintype" id="3830729">uintptr</span><span class="op" id="3830736">(</span><span class="num" id="3830737">0</span><span class="op" id="3830738">)</span><span class="op" id="3830739">)</span><span class="op" id="3830740">)</span><br>
<span class="lineno"></span><span class="keyword" id="3830742">const</span>&nbsp;<span class="ident" id="3830748">supportsUnaligned</span>&nbsp;<span class="op" id="3830766">=</span>&nbsp;<span class="ident" id="3830768">runtime</span><span class="op" id="3830775">.</span><span class="ident" id="3830776">GOARCH</span>&nbsp;<span class="op" id="3830783">==</span>&nbsp;<span class="string" id="3830786">&#34;386&#34;</span>&nbsp;<span class="op" id="3830792">||</span>&nbsp;<span class="ident" id="3830795">runtime</span><span class="op" id="3830802">.</span><span class="ident" id="3830803">GOARCH</span>&nbsp;<span class="op" id="3830810">==</span>&nbsp;<span class="string" id="3830813">&#34;amd64&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3830822">//&nbsp;fastXORBytes&nbsp;xors&nbsp;in&nbsp;bulk.&nbsp;It&nbsp;only&nbsp;works&nbsp;on&nbsp;architectures&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3830888">//&nbsp;support&nbsp;unaligned&nbsp;read/writes.</span><br>
<span class="lineno"></span><span class="keyword" id="3830922">func</span>&nbsp;<span class="ident" id="3830927">fastXORBytes</span><span class="op" id="3830939">(</span><span class="ident" id="3830940">dst</span><span class="op" id="3830943">,</span>&nbsp;<span class="ident" id="3830945">a</span><span class="op" id="3830946">,</span>&nbsp;<span class="ident" id="3830948">b</span>&nbsp;<span class="op" id="3830950">[</span><span class="op" id="3830951">]</span><span class="builtintype" id="3830952">byte</span><span class="op" id="3830956">)</span>&nbsp;<span class="builtintype" id="3830958">int</span>&nbsp;<span class="op" id="3830962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830965">n</span>&nbsp;<span class="op" id="3830967">:=</span>&nbsp;<span class="builtinfunc" id="3830970">len</span><span class="op" id="3830973">(</span><span class="ident" id="3830974">a</span><span class="op" id="3830975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830978">if</span>&nbsp;<span class="builtinfunc" id="3830981">len</span><span class="op" id="3830984">(</span><span class="ident" id="3830985">b</span><span class="op" id="3830986">)</span>&nbsp;<span class="op" id="3830988">&lt;</span>&nbsp;<span class="ident" id="3830990">n</span>&nbsp;<span class="op" id="3830992">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830996">n</span>&nbsp;<span class="op" id="3830998">=</span>&nbsp;<span class="builtinfunc" id="3831000">len</span><span class="op" id="3831003">(</span><span class="ident" id="3831004">b</span><span class="op" id="3831005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831012">w</span>&nbsp;<span class="op" id="3831014">:=</span>&nbsp;<span class="ident" id="3831017">n</span>&nbsp;<span class="op" id="3831019">/</span>&nbsp;<span class="ident" id="3831021">wordSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831031">if</span>&nbsp;<span class="ident" id="3831034">w</span>&nbsp;<span class="op" id="3831036">&gt;</span>&nbsp;<span class="num" id="3831038">0</span>&nbsp;<span class="op" id="3831040">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831044">dw</span>&nbsp;<span class="op" id="3831047">:=</span>&nbsp;<span class="op" id="3831050">*</span><span class="op" id="3831051">(</span><span class="op" id="3831052">*</span><span class="op" id="3831053">[</span><span class="op" id="3831054">]</span><span class="builtintype" id="3831055">uintptr</span><span class="op" id="3831062">)</span><span class="op" id="3831063">(</span><span class="ident" id="3831064">unsafe</span><span class="op" id="3831070">.</span><span class="ident" id="3831071">Pointer</span><span class="op" id="3831078">(</span><span class="op" id="3831079">&amp;</span><span class="ident" id="3831080">dst</span><span class="op" id="3831083">)</span><span class="op" id="3831084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831088">aw</span>&nbsp;<span class="op" id="3831091">:=</span>&nbsp;<span class="op" id="3831094">*</span><span class="op" id="3831095">(</span><span class="op" id="3831096">*</span><span class="op" id="3831097">[</span><span class="op" id="3831098">]</span><span class="builtintype" id="3831099">uintptr</span><span class="op" id="3831106">)</span><span class="op" id="3831107">(</span><span class="ident" id="3831108">unsafe</span><span class="op" id="3831114">.</span><span class="ident" id="3831115">Pointer</span><span class="op" id="3831122">(</span><span class="op" id="3831123">&amp;</span><span class="ident" id="3831124">a</span><span class="op" id="3831125">)</span><span class="op" id="3831126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831130">bw</span>&nbsp;<span class="op" id="3831133">:=</span>&nbsp;<span class="op" id="3831136">*</span><span class="op" id="3831137">(</span><span class="op" id="3831138">*</span><span class="op" id="3831139">[</span><span class="op" id="3831140">]</span><span class="builtintype" id="3831141">uintptr</span><span class="op" id="3831148">)</span><span class="op" id="3831149">(</span><span class="ident" id="3831150">unsafe</span><span class="op" id="3831156">.</span><span class="ident" id="3831157">Pointer</span><span class="op" id="3831164">(</span><span class="op" id="3831165">&amp;</span><span class="ident" id="3831166">b</span><span class="op" id="3831167">)</span><span class="op" id="3831168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831172">for</span>&nbsp;<span class="ident" id="3831176">i</span>&nbsp;<span class="op" id="3831178">:=</span>&nbsp;<span class="num" id="3831181">0</span><span class="op" id="3831182">;</span>&nbsp;<span class="ident" id="3831184">i</span>&nbsp;<span class="op" id="3831186">&lt;</span>&nbsp;<span class="ident" id="3831188">w</span><span class="op" id="3831189">;</span>&nbsp;<span class="ident" id="3831191">i</span><span class="op" id="3831192">++</span>&nbsp;<span class="op" id="3831195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831200">dw</span><span class="op" id="3831202">[</span><span class="ident" id="3831203">i</span><span class="op" id="3831204">]</span>&nbsp;<span class="op" id="3831206">=</span>&nbsp;<span class="ident" id="3831208">aw</span><span class="op" id="3831210">[</span><span class="ident" id="3831211">i</span><span class="op" id="3831212">]</span>&nbsp;<span class="op" id="3831214">^</span>&nbsp;<span class="ident" id="3831216">bw</span><span class="op" id="3831218">[</span><span class="ident" id="3831219">i</span><span class="op" id="3831220">]</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831231">for</span>&nbsp;<span class="ident" id="3831235">i</span>&nbsp;<span class="op" id="3831237">:=</span>&nbsp;<span class="op" id="3831240">(</span><span class="ident" id="3831241">n</span>&nbsp;<span class="op" id="3831243">-</span>&nbsp;<span class="ident" id="3831245">n</span><span class="op" id="3831246">%</span><span class="ident" id="3831247">wordSize</span><span class="op" id="3831255">)</span><span class="op" id="3831256">;</span>&nbsp;<span class="ident" id="3831258">i</span>&nbsp;<span class="op" id="3831260">&lt;</span>&nbsp;<span class="ident" id="3831262">n</span><span class="op" id="3831263">;</span>&nbsp;<span class="ident" id="3831265">i</span><span class="op" id="3831266">++</span>&nbsp;<span class="op" id="3831269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831273">dst</span><span class="op" id="3831276">[</span><span class="ident" id="3831277">i</span><span class="op" id="3831278">]</span>&nbsp;<span class="op" id="3831280">=</span>&nbsp;<span class="ident" id="3831282">a</span><span class="op" id="3831283">[</span><span class="ident" id="3831284">i</span><span class="op" id="3831285">]</span>&nbsp;<span class="op" id="3831287">^</span>&nbsp;<span class="ident" id="3831289">b</span><span class="op" id="3831290">[</span><span class="ident" id="3831291">i</span><span class="op" id="3831292">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831299">return</span>&nbsp;<span class="ident" id="3831306">n</span><br>
<span class="lineno"></span><span class="op" id="3831308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3831311">func</span>&nbsp;<span class="ident" id="3831316">safeXORBytes</span><span class="op" id="3831328">(</span><span class="ident" id="3831329">dst</span><span class="op" id="3831332">,</span>&nbsp;<span class="ident" id="3831334">a</span><span class="op" id="3831335">,</span>&nbsp;<span class="ident" id="3831337">b</span>&nbsp;<span class="op" id="3831339">[</span><span class="op" id="3831340">]</span><span class="builtintype" id="3831341">byte</span><span class="op" id="3831345">)</span>&nbsp;<span class="builtintype" id="3831347">int</span>&nbsp;<span class="op" id="3831351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831354">n</span>&nbsp;<span class="op" id="3831356">:=</span>&nbsp;<span class="builtinfunc" id="3831359">len</span><span class="op" id="3831362">(</span><span class="ident" id="3831363">a</span><span class="op" id="3831364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831367">if</span>&nbsp;<span class="builtinfunc" id="3831370">len</span><span class="op" id="3831373">(</span><span class="ident" id="3831374">b</span><span class="op" id="3831375">)</span>&nbsp;<span class="op" id="3831377">&lt;</span>&nbsp;<span class="ident" id="3831379">n</span>&nbsp;<span class="op" id="3831381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831385">n</span>&nbsp;<span class="op" id="3831387">=</span>&nbsp;<span class="builtinfunc" id="3831389">len</span><span class="op" id="3831392">(</span><span class="ident" id="3831393">b</span><span class="op" id="3831394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831397">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831400">for</span>&nbsp;<span class="ident" id="3831404">i</span>&nbsp;<span class="op" id="3831406">:=</span>&nbsp;<span class="num" id="3831409">0</span><span class="op" id="3831410">;</span>&nbsp;<span class="ident" id="3831412">i</span>&nbsp;<span class="op" id="3831414">&lt;</span>&nbsp;<span class="ident" id="3831416">n</span><span class="op" id="3831417">;</span>&nbsp;<span class="ident" id="3831419">i</span><span class="op" id="3831420">++</span>&nbsp;<span class="op" id="3831423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831427">dst</span><span class="op" id="3831430">[</span><span class="ident" id="3831431">i</span><span class="op" id="3831432">]</span>&nbsp;<span class="op" id="3831434">=</span>&nbsp;<span class="ident" id="3831436">a</span><span class="op" id="3831437">[</span><span class="ident" id="3831438">i</span><span class="op" id="3831439">]</span>&nbsp;<span class="op" id="3831441">^</span>&nbsp;<span class="ident" id="3831443">b</span><span class="op" id="3831444">[</span><span class="ident" id="3831445">i</span><span class="op" id="3831446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831452">return</span>&nbsp;<span class="ident" id="3831459">n</span><br>
<span class="lineno"></span><span class="op" id="3831461">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3831464">//&nbsp;xorBytes&nbsp;xors&nbsp;the&nbsp;bytes&nbsp;in&nbsp;a&nbsp;and&nbsp;b.&nbsp;The&nbsp;destination&nbsp;is&nbsp;assumed&nbsp;to&nbsp;have&nbsp;enough</span><br>
<span class="lineno"></span><span class="comment" id="3831545">//&nbsp;space.&nbsp;Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;xor&#39;d.</span><br>
<span class="lineno"></span><span class="keyword" id="3831590">func</span>&nbsp;<span class="ident" id="3831595">xorBytes</span><span class="op" id="3831603">(</span><span class="ident" id="3831604">dst</span><span class="op" id="3831607">,</span>&nbsp;<span class="ident" id="3831609">a</span><span class="op" id="3831610">,</span>&nbsp;<span class="ident" id="3831612">b</span>&nbsp;<span class="op" id="3831614">[</span><span class="op" id="3831615">]</span><span class="builtintype" id="3831616">byte</span><span class="op" id="3831620">)</span>&nbsp;<span class="builtintype" id="3831622">int</span>&nbsp;<span class="op" id="3831626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831629">if</span>&nbsp;<span class="ident" id="3831632">supportsUnaligned</span>&nbsp;<span class="op" id="3831650">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831654">return</span>&nbsp;<span class="ident" id="3831661">fastXORBytes</span><span class="op" id="3831673">(</span><span class="ident" id="3831674">dst</span><span class="op" id="3831677">,</span>&nbsp;<span class="ident" id="3831679">a</span><span class="op" id="3831680">,</span>&nbsp;<span class="ident" id="3831682">b</span><span class="op" id="3831683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831686">}</span>&nbsp;<span class="keyword" id="3831688">else</span>&nbsp;<span class="op" id="3831693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831697">//&nbsp;TODO(hanwen):&nbsp;if&nbsp;(dst,&nbsp;a,&nbsp;b)&nbsp;have&nbsp;common&nbsp;alignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831753">//&nbsp;we&nbsp;could&nbsp;still&nbsp;try&nbsp;fastXORBytes.&nbsp;It&nbsp;is&nbsp;not&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831807">//&nbsp;how&nbsp;often&nbsp;this&nbsp;happens,&nbsp;and&nbsp;it&#39;s&nbsp;only&nbsp;worth&nbsp;it&nbsp;if</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831862">//&nbsp;the&nbsp;block&nbsp;encryption&nbsp;itself&nbsp;is&nbsp;hardware</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831907">//&nbsp;accelerated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831925">return</span>&nbsp;<span class="ident" id="3831932">safeXORBytes</span><span class="op" id="3831944">(</span><span class="ident" id="3831945">dst</span><span class="op" id="3831948">,</span>&nbsp;<span class="ident" id="3831950">a</span><span class="op" id="3831951">,</span>&nbsp;<span class="ident" id="3831953">b</span><span class="op" id="3831954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831957">}</span><br>
<span class="lineno"></span><span class="op" id="3831959">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="3831962">//&nbsp;fastXORWords&nbsp;XORs&nbsp;multiples&nbsp;of&nbsp;4&nbsp;or&nbsp;8&nbsp;bytes&nbsp;(depending&nbsp;on&nbsp;architecture.)</span><br>
<span class="lineno"></span><span class="comment" id="3832038">//&nbsp;The&nbsp;arguments&nbsp;are&nbsp;assumed&nbsp;to&nbsp;be&nbsp;of&nbsp;equal&nbsp;length.</span><br>
<span class="lineno"></span><span class="keyword" id="3832090">func</span>&nbsp;<span class="ident" id="3832095">fastXORWords</span><span class="op" id="3832107">(</span><span class="ident" id="3832108">dst</span><span class="op" id="3832111">,</span>&nbsp;<span class="ident" id="3832113">a</span><span class="op" id="3832114">,</span>&nbsp;<span class="ident" id="3832116">b</span>&nbsp;<span class="op" id="3832118">[</span><span class="op" id="3832119">]</span><span class="builtintype" id="3832120">byte</span><span class="op" id="3832124">)</span>&nbsp;<span class="op" id="3832126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832129">dw</span>&nbsp;<span class="op" id="3832132">:=</span>&nbsp;<span class="op" id="3832135">*</span><span class="op" id="3832136">(</span><span class="op" id="3832137">*</span><span class="op" id="3832138">[</span><span class="op" id="3832139">]</span><span class="builtintype" id="3832140">uintptr</span><span class="op" id="3832147">)</span><span class="op" id="3832148">(</span><span class="ident" id="3832149">unsafe</span><span class="op" id="3832155">.</span><span class="ident" id="3832156">Pointer</span><span class="op" id="3832163">(</span><span class="op" id="3832164">&amp;</span><span class="ident" id="3832165">dst</span><span class="op" id="3832168">)</span><span class="op" id="3832169">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832172">aw</span>&nbsp;<span class="op" id="3832175">:=</span>&nbsp;<span class="op" id="3832178">*</span><span class="op" id="3832179">(</span><span class="op" id="3832180">*</span><span class="op" id="3832181">[</span><span class="op" id="3832182">]</span><span class="builtintype" id="3832183">uintptr</span><span class="op" id="3832190">)</span><span class="op" id="3832191">(</span><span class="ident" id="3832192">unsafe</span><span class="op" id="3832198">.</span><span class="ident" id="3832199">Pointer</span><span class="op" id="3832206">(</span><span class="op" id="3832207">&amp;</span><span class="ident" id="3832208">a</span><span class="op" id="3832209">)</span><span class="op" id="3832210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832213">bw</span>&nbsp;<span class="op" id="3832216">:=</span>&nbsp;<span class="op" id="3832219">*</span><span class="op" id="3832220">(</span><span class="op" id="3832221">*</span><span class="op" id="3832222">[</span><span class="op" id="3832223">]</span><span class="builtintype" id="3832224">uintptr</span><span class="op" id="3832231">)</span><span class="op" id="3832232">(</span><span class="ident" id="3832233">unsafe</span><span class="op" id="3832239">.</span><span class="ident" id="3832240">Pointer</span><span class="op" id="3832247">(</span><span class="op" id="3832248">&amp;</span><span class="ident" id="3832249">b</span><span class="op" id="3832250">)</span><span class="op" id="3832251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832254">n</span>&nbsp;<span class="op" id="3832256">:=</span>&nbsp;<span class="builtinfunc" id="3832259">len</span><span class="op" id="3832262">(</span><span class="ident" id="3832263">b</span><span class="op" id="3832264">)</span>&nbsp;<span class="op" id="3832266">/</span>&nbsp;<span class="ident" id="3832268">wordSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832278">for</span>&nbsp;<span class="ident" id="3832282">i</span>&nbsp;<span class="op" id="3832284">:=</span>&nbsp;<span class="num" id="3832287">0</span><span class="op" id="3832288">;</span>&nbsp;<span class="ident" id="3832290">i</span>&nbsp;<span class="op" id="3832292">&lt;</span>&nbsp;<span class="ident" id="3832294">n</span><span class="op" id="3832295">;</span>&nbsp;<span class="ident" id="3832297">i</span><span class="op" id="3832298">++</span>&nbsp;<span class="op" id="3832301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832305">dw</span><span class="op" id="3832307">[</span><span class="ident" id="3832308">i</span><span class="op" id="3832309">]</span>&nbsp;<span class="op" id="3832311">=</span>&nbsp;<span class="ident" id="3832313">aw</span><span class="op" id="3832315">[</span><span class="ident" id="3832316">i</span><span class="op" id="3832317">]</span>&nbsp;<span class="op" id="3832319">^</span>&nbsp;<span class="ident" id="3832321">bw</span><span class="op" id="3832323">[</span><span class="ident" id="3832324">i</span><span class="op" id="3832325">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832328">}</span><br>
<span class="lineno"></span><span class="op" id="3832330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3832333">func</span>&nbsp;<span class="ident" id="3832338">xorWords</span><span class="op" id="3832346">(</span><span class="ident" id="3832347">dst</span><span class="op" id="3832350">,</span>&nbsp;<span class="ident" id="3832352">a</span><span class="op" id="3832353">,</span>&nbsp;<span class="ident" id="3832355">b</span>&nbsp;<span class="op" id="3832357">[</span><span class="op" id="3832358">]</span><span class="builtintype" id="3832359">byte</span><span class="op" id="3832363">)</span>&nbsp;<span class="op" id="3832365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832368">if</span>&nbsp;<span class="ident" id="3832371">supportsUnaligned</span>&nbsp;<span class="op" id="3832389">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832393">fastXORWords</span><span class="op" id="3832405">(</span><span class="ident" id="3832406">dst</span><span class="op" id="3832409">,</span>&nbsp;<span class="ident" id="3832411">a</span><span class="op" id="3832412">,</span>&nbsp;<span class="ident" id="3832414">b</span><span class="op" id="3832415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832418">}</span>&nbsp;<span class="keyword" id="3832420">else</span>&nbsp;<span class="op" id="3832425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832429">safeXORBytes</span><span class="op" id="3832441">(</span><span class="ident" id="3832442">dst</span><span class="op" id="3832445">,</span>&nbsp;<span class="ident" id="3832447">a</span><span class="op" id="3832448">,</span>&nbsp;<span class="ident" id="3832450">b</span><span class="op" id="3832451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832454">}</span><br>
<span class="lineno"></span><span class="op" id="3832456">}</span>
</div>
</body>
</html>
