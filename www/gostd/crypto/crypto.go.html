<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html" class="current">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3009688">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3009743">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3009797">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3009848">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3009907">package</span>&nbsp;<span class="ident" id="3009915">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3009923">import</span>&nbsp;<span class="op" id="3009930">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3009933">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3009941">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3009947">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3009957">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3009960">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="3010040">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3010052">type</span>&nbsp;<span class="ident" id="3010057">Hash</span>&nbsp;<span class="builtintype" id="3010062">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3010068">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="3010146">func</span>&nbsp;<span class="op" id="3010151">(</span><span class="ident" id="3010152">h</span>&nbsp;<span class="ident" id="3010154"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="3010158">)</span>&nbsp;<span class="ident" id="3010160">HashFunc</span><span class="op" id="3010168">(</span><span class="op" id="3010169">)</span>&nbsp;<span class="ident" id="3010171"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span>&nbsp;<span class="op" id="3010176">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3010179">return</span>&nbsp;<span class="ident" id="3010186"><a href="/gostd/crypto/crypto.go.html#3010152">h</a></span><br>
<span class="lineno"></span><span class="op" id="3010188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3010191">const</span>&nbsp;<span class="op" id="3010197">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010200">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010210"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span>&nbsp;<span class="op" id="3010215">=</span>&nbsp;<span class="num" id="3010217">1</span>&nbsp;<span class="op" id="3010219">+</span>&nbsp;<span class="ident" id="3010221">iota</span>&nbsp;<span class="comment" id="3010226">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010261">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010287">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010309">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010335">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010358">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010384">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010409">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010435">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010460">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010486">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010511">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010537">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010562">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010588">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010637">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010663">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010704">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010730">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010766">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010792">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010828">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010854">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010890">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3010916">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010952">maxHash</span><br>
<span class="lineno"></span><span class="op" id="3010960">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3010963">var</span>&nbsp;<span class="ident" id="3010967">digestSizes</span>&nbsp;<span class="op" id="3010979">=</span>&nbsp;<span class="op" id="3010981">[</span><span class="op" id="3010982">]</span><span class="builtintype" id="3010983">uint8</span><span class="op" id="3010988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3010991"><a href="/gostd/crypto/crypto.go.html#3010200">MD4</a></span><span class="op" id="3010994">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3011002">16</span><span class="op" id="3011004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011007"><a href="/gostd/crypto/crypto.go.html#3010261">MD5</a></span><span class="op" id="3011010">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3011018">16</span><span class="op" id="3011020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011023"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="3011027">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3011034">20</span><span class="op" id="3011036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011039"><a href="/gostd/crypto/crypto.go.html#3010358">SHA224</a></span><span class="op" id="3011045">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3011050">28</span><span class="op" id="3011052">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011055"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><span class="op" id="3011061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3011066">32</span><span class="op" id="3011068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011071"><a href="/gostd/crypto/crypto.go.html#3010460">SHA384</a></span><span class="op" id="3011077">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3011082">48</span><span class="op" id="3011084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011087"><a href="/gostd/crypto/crypto.go.html#3010511">SHA512</a></span><span class="op" id="3011093">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3011098">64</span><span class="op" id="3011100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011103"><a href="/gostd/crypto/crypto.go.html#3010704">SHA3_224</a></span><span class="op" id="3011111">:</span>&nbsp;&nbsp;<span class="num" id="3011114">28</span><span class="op" id="3011116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011119"><a href="/gostd/crypto/crypto.go.html#3010766">SHA3_256</a></span><span class="op" id="3011127">:</span>&nbsp;&nbsp;<span class="num" id="3011130">32</span><span class="op" id="3011132">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011135"><a href="/gostd/crypto/crypto.go.html#3010828">SHA3_384</a></span><span class="op" id="3011143">:</span>&nbsp;&nbsp;<span class="num" id="3011146">48</span><span class="op" id="3011148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011151"><a href="/gostd/crypto/crypto.go.html#3010890">SHA3_512</a></span><span class="op" id="3011159">:</span>&nbsp;&nbsp;<span class="num" id="3011162">64</span><span class="op" id="3011164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011167"><a href="/gostd/crypto/crypto.go.html#3010562">MD5SHA1</a></span><span class="op" id="3011174">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3011178">36</span><span class="op" id="3011180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011183"><a href="/gostd/crypto/crypto.go.html#3010637">RIPEMD160</a></span><span class="op" id="3011192">:</span>&nbsp;<span class="num" id="3011194">20</span><span class="op" id="3011196">,</span><br>
<span class="lineno"></span><span class="op" id="3011198">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3011201">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3011281">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="3011358">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3011379">func</span>&nbsp;<span class="op" id="3011384">(</span><span class="ident" id="3011385">h</span>&nbsp;<span class="ident" id="3011387"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="3011391">)</span>&nbsp;<span class="ident" id="3011393">Size</span><span class="op" id="3011397">(</span><span class="op" id="3011398">)</span>&nbsp;<span class="builtintype" id="3011400">int</span>&nbsp;<span class="op" id="3011404">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3011407">if</span>&nbsp;<span class="ident" id="3011410"><a href="/gostd/crypto/crypto.go.html#3011385">h</a></span>&nbsp;<span class="op" id="3011412">&gt;</span>&nbsp;<span class="num" id="3011414">0</span>&nbsp;<span class="op" id="3011416">&amp;&amp;</span>&nbsp;<span class="ident" id="3011419"><a href="/gostd/crypto/crypto.go.html#3011385">h</a></span>&nbsp;<span class="op" id="3011421">&lt;</span>&nbsp;<span class="ident" id="3011423"><a href="/gostd/crypto/crypto.go.html#3010952">maxHash</a></span>&nbsp;<span class="op" id="3011431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3011435">return</span>&nbsp;<span class="builtintype" id="3011442">int</span><span class="op" id="3011445">(</span><span class="ident" id="3011446"><a href="/gostd/crypto/crypto.go.html#3010967">digestSizes</a></span><span class="op" id="3011457">[</span><span class="ident" id="3011458"><a href="/gostd/crypto/crypto.go.html#3011385">h</a></span><span class="op" id="3011459">]</span><span class="op" id="3011460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3011463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3011466">panic</span><span class="op" id="3011471">(</span><span class="string" id="3011472">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3011511">)</span><br>
<span class="lineno"></span><span class="op" id="3011513">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3011516">var</span>&nbsp;<span class="ident" id="3011520">hashes</span>&nbsp;<span class="op" id="3011527">=</span>&nbsp;<span class="builtinfunc" id="3011529">make</span><span class="op" id="3011533">(</span><span class="op" id="3011534">[</span><span class="op" id="3011535">]</span><span class="keyword" id="3011536">func</span><span class="op" id="3011540">(</span><span class="op" id="3011541">)</span>&nbsp;<span class="ident" id="3011543"><a href="/gostd/crypto/crypto.go.html#3009933">hash</a></span><span class="op" id="3011547">.</span><span class="ident" id="3011548"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="3011552">,</span>&nbsp;<span class="ident" id="3011554"><a href="/gostd/crypto/crypto.go.html#3010952">maxHash</a></span><span class="op" id="3011561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3011564">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="3011643">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="3011698">func</span>&nbsp;<span class="op" id="3011703">(</span><span class="ident" id="3011704">h</span>&nbsp;<span class="ident" id="3011706"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="3011710">)</span>&nbsp;<span class="ident" id="3011712">New</span><span class="op" id="3011715">(</span><span class="op" id="3011716">)</span>&nbsp;<span class="ident" id="3011718"><a href="/gostd/crypto/crypto.go.html#3009933">hash</a></span><span class="op" id="3011722">.</span><span class="ident" id="3011723"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span>&nbsp;<span class="op" id="3011728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3011731">if</span>&nbsp;<span class="ident" id="3011734"><a href="/gostd/crypto/crypto.go.html#3011704">h</a></span>&nbsp;<span class="op" id="3011736">&gt;</span>&nbsp;<span class="num" id="3011738">0</span>&nbsp;<span class="op" id="3011740">&amp;&amp;</span>&nbsp;<span class="ident" id="3011743"><a href="/gostd/crypto/crypto.go.html#3011704">h</a></span>&nbsp;<span class="op" id="3011745">&lt;</span>&nbsp;<span class="ident" id="3011747"><a href="/gostd/crypto/crypto.go.html#3010952">maxHash</a></span>&nbsp;<span class="op" id="3011755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3011759">f</span>&nbsp;<span class="op" id="3011761">:=</span>&nbsp;<span class="ident" id="3011764"><a href="/gostd/crypto/crypto.go.html#3011520">hashes</a></span><span class="op" id="3011770">[</span><span class="ident" id="3011771"><a href="/gostd/crypto/crypto.go.html#3011704">h</a></span><span class="op" id="3011772">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3011776">if</span>&nbsp;<span class="ident" id="3011779"><a href="/gostd/crypto/crypto.go.html#3011759">f</a></span>&nbsp;<span class="op" id="3011781">!=</span>&nbsp;<span class="builtintype" id="3011784">nil</span>&nbsp;<span class="op" id="3011788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3011793">return</span>&nbsp;<span class="ident" id="3011800"><a href="/gostd/crypto/crypto.go.html#3011759">f</a></span><span class="op" id="3011801">(</span><span class="op" id="3011802">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3011806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3011809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3011812">panic</span><span class="op" id="3011817">(</span><span class="string" id="3011818">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="3011854">+</span>&nbsp;<span class="ident" id="3011856"><a href="/gostd/crypto/crypto.go.html#3009947">strconv</a></span><span class="op" id="3011863">.</span><span class="ident" id="3011864"><a href="/gostd/strconv/itoa.go.html#2407288">Itoa</a></span><span class="op" id="3011868">(</span><span class="builtintype" id="3011869">int</span><span class="op" id="3011872">(</span><span class="ident" id="3011873"><a href="/gostd/crypto/crypto.go.html#3011704">h</a></span><span class="op" id="3011874">)</span><span class="op" id="3011875">)</span>&nbsp;<span class="op" id="3011877">+</span>&nbsp;<span class="string" id="3011879">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="3011896">)</span><br>
<span class="lineno"></span><span class="op" id="3011898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3011901">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3011981">func</span>&nbsp;<span class="op" id="3011986">(</span><span class="ident" id="3011987">h</span>&nbsp;<span class="ident" id="3011989"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="3011993">)</span>&nbsp;<span class="ident" id="3011995">Available</span><span class="op" id="3012004">(</span><span class="op" id="3012005">)</span>&nbsp;<span class="builtintype" id="3012007">bool</span>&nbsp;<span class="op" id="3012012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3012015">return</span>&nbsp;<span class="ident" id="3012022"><a href="/gostd/crypto/crypto.go.html#3011987">h</a></span>&nbsp;<span class="op" id="3012024">&lt;</span>&nbsp;<span class="ident" id="3012026"><a href="/gostd/crypto/crypto.go.html#3010952">maxHash</a></span>&nbsp;<span class="op" id="3012034">&amp;&amp;</span>&nbsp;<span class="ident" id="3012037"><a href="/gostd/crypto/crypto.go.html#3011520">hashes</a></span><span class="op" id="3012043">[</span><span class="ident" id="3012044"><a href="/gostd/crypto/crypto.go.html#3011987">h</a></span><span class="op" id="3012045">]</span>&nbsp;<span class="op" id="3012047">!=</span>&nbsp;<span class="builtintype" id="3012050">nil</span><br>
<span class="lineno"></span><span class="op" id="3012054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3012057">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3012135">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3012209">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3012252">func</span>&nbsp;<span class="ident" id="3012257">RegisterHash</span><span class="op" id="3012269">(</span><span class="ident" id="3012270">h</span>&nbsp;<span class="ident" id="3012272"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="3012276">,</span>&nbsp;<span class="ident" id="3012278">f</span>&nbsp;<span class="keyword" id="3012280">func</span><span class="op" id="3012284">(</span><span class="op" id="3012285">)</span>&nbsp;<span class="ident" id="3012287"><a href="/gostd/crypto/crypto.go.html#3009933">hash</a></span><span class="op" id="3012291">.</span><span class="ident" id="3012292"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="3012296">)</span>&nbsp;<span class="op" id="3012298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3012301">if</span>&nbsp;<span class="ident" id="3012304"><a href="/gostd/crypto/crypto.go.html#3012270">h</a></span>&nbsp;<span class="op" id="3012306">&gt;=</span>&nbsp;<span class="ident" id="3012309"><a href="/gostd/crypto/crypto.go.html#3010952">maxHash</a></span>&nbsp;<span class="op" id="3012317">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3012321">panic</span><span class="op" id="3012326">(</span><span class="string" id="3012327">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3012374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3012377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012380"><a href="/gostd/crypto/crypto.go.html#3011520">hashes</a></span><span class="op" id="3012386">[</span><span class="ident" id="3012387"><a href="/gostd/crypto/crypto.go.html#3012270">h</a></span><span class="op" id="3012388">]</span>&nbsp;<span class="op" id="3012390">=</span>&nbsp;<span class="ident" id="3012392"><a href="/gostd/crypto/crypto.go.html#3012278">f</a></span><br>
<span class="lineno"></span><span class="op" id="3012394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3012397">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3012466">type</span>&nbsp;<span class="ident" id="3012471">PublicKey</span>&nbsp;<span class="keyword" id="3012481">interface</span><span class="op" id="3012490">{</span><span class="op" id="3012491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3012494">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3012565">type</span>&nbsp;<span class="ident" id="3012570">PrivateKey</span>&nbsp;<span class="keyword" id="3012581">interface</span><span class="op" id="3012590">{</span><span class="op" id="3012591">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3012594">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3012667">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="3012741">type</span>&nbsp;<span class="ident" id="3012746">Signer</span>&nbsp;<span class="keyword" id="3012753">interface</span>&nbsp;<span class="op" id="3012763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3012766">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3012829">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3012846">Public</span><span class="op" id="3012852">(</span><span class="op" id="3012853">)</span>&nbsp;<span class="ident" id="3012855"><a href="/gostd/crypto/crypto.go.html#3012471">PublicKey</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3012867">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3012936">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013005">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013077">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013144">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013148">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013221">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013294">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013362">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3013434">Sign</span><span class="op" id="3013438">(</span><span class="ident" id="3013439">rand</span>&nbsp;<span class="ident" id="3013444"><a href="/gostd/crypto/crypto.go.html#3009941">io</a></span><span class="op" id="3013446">.</span><span class="ident" id="3013447"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="3013453">,</span>&nbsp;<span class="ident" id="3013455">msg</span>&nbsp;<span class="op" id="3013459">[</span><span class="op" id="3013460">]</span><span class="builtintype" id="3013461">byte</span><span class="op" id="3013465">,</span>&nbsp;<span class="ident" id="3013467">opts</span>&nbsp;<span class="ident" id="3013472"><a href="/gostd/crypto/crypto.go.html#3013580">SignerOpts</a></span><span class="op" id="3013482">)</span>&nbsp;<span class="op" id="3013484">(</span><span class="ident" id="3013485">signature</span>&nbsp;<span class="op" id="3013495">[</span><span class="op" id="3013496">]</span><span class="builtintype" id="3013497">byte</span><span class="op" id="3013501">,</span>&nbsp;<span class="ident" id="3013503">err</span>&nbsp;<span class="builtintype" id="3013507">error</span><span class="op" id="3013512">)</span><br>
<span class="lineno"></span><span class="op" id="3013514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3013517">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="3013575">type</span>&nbsp;<span class="ident" id="3013580">SignerOpts</span>&nbsp;<span class="keyword" id="3013591">interface</span>&nbsp;<span class="op" id="3013601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013604">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013677">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3013749">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3013771">HashFunc</span><span class="op" id="3013779">(</span><span class="op" id="3013780">)</span>&nbsp;<span class="ident" id="3013782"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><br>
<span class="lineno"></span><span class="op" id="3013787">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
