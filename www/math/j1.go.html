<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword">package</span>&nbsp;<span class="ident">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;one.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_j1.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno">25</span><span class="comment">//&nbsp;__ieee754_j1(x),&nbsp;__ieee754_y1(x)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Method&nbsp;--&nbsp;j1(x):</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;tiny&nbsp;x,&nbsp;we&nbsp;use&nbsp;j1(x)&nbsp;=&nbsp;x/2&nbsp;-&nbsp;x**3/16&nbsp;+&nbsp;x**5/384&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;|x|&nbsp;since&nbsp;j1(x)=-j1(-x),&nbsp;&nbsp;and</span><br>
<span class="lineno">30</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;in&nbsp;(0,2)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j1(x)&nbsp;=&nbsp;x/2&nbsp;+&nbsp;x*z*R0/S0,&nbsp;&nbsp;where&nbsp;z&nbsp;=&nbsp;x*x;</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(precision:&nbsp;&nbsp;|j1/x&nbsp;-&nbsp;1/2&nbsp;-&nbsp;R0/S0&nbsp;|&lt;2**-61.51&nbsp;)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;in&nbsp;(2,inf)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j1(x)&nbsp;=&nbsp;sqrt(2/(pi*x))*(p1(x)*cos(x1)-q1(x)*sin(x1))</span><br>
<span class="lineno">35</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1(x)&nbsp;=&nbsp;sqrt(2/(pi*x))*(p1(x)*sin(x1)+q1(x)*cos(x1))</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;x1&nbsp;=&nbsp;x-3*pi/4.&nbsp;It&nbsp;is&nbsp;better&nbsp;to&nbsp;compute&nbsp;sin(x1),cos(x1)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;follow:</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos(x1)&nbsp;=&nbsp;&nbsp;cos(x)cos(3pi/4)+sin(x)sin(3pi/4)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;1/sqrt(2)&nbsp;*&nbsp;(sin(x)&nbsp;-&nbsp;cos(x))</span><br>
<span class="lineno">40</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin(x1)&nbsp;=&nbsp;&nbsp;sin(x)cos(3pi/4)-cos(x)sin(3pi/4)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-1/sqrt(2)&nbsp;*&nbsp;(sin(x)&nbsp;+&nbsp;cos(x))</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(To&nbsp;avoid&nbsp;cancellation,&nbsp;use</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin(x)&nbsp;+-&nbsp;cos(x)&nbsp;=&nbsp;-cos(2x)/(sin(x)&nbsp;-+&nbsp;cos(x))</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;compute&nbsp;the&nbsp;worse&nbsp;one.)</span><br>
<span class="lineno">45</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;Special&nbsp;cases</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j1(nan)=&nbsp;nan</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j1(0)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j1(inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno">50</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Method&nbsp;--&nbsp;y1(x):</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;screen&nbsp;out&nbsp;x&lt;=0&nbsp;cases:&nbsp;y1(0)=-inf,&nbsp;y1(x&lt;0)=NaN</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;x&lt;2.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since</span><br>
<span class="lineno">55</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1(x)&nbsp;=&nbsp;2/pi*(j1(x)*(ln(x/2)+Euler)-1/x-x/2+5/64*x**3-...)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;therefore&nbsp;y1(x)-2/pi*j1(x)*ln(x)-1/x&nbsp;is&nbsp;an&nbsp;odd&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;function&nbsp;to&nbsp;approximate&nbsp;y1,</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1(x)&nbsp;=&nbsp;x*U(z)/V(z)&nbsp;+&nbsp;(2/pi)*(j1(x)*ln(x)-1/x),&nbsp;z=&nbsp;x**2</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,2]&nbsp;(abs&nbsp;err&nbsp;less&nbsp;than&nbsp;2**-65.89)</span><br>
<span class="lineno">60</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U(z)&nbsp;=&nbsp;U0[0]&nbsp;+&nbsp;U0[1]*z&nbsp;+&nbsp;...&nbsp;+&nbsp;U0[4]*z**4</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V(z)&nbsp;=&nbsp;1&nbsp;&nbsp;+&nbsp;v0[0]*z&nbsp;+&nbsp;...&nbsp;+&nbsp;v0[4]*z**5</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;For&nbsp;tiny&nbsp;x,&nbsp;1/x&nbsp;dominate&nbsp;y1&nbsp;and&nbsp;hence</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1(tiny)&nbsp;=&nbsp;-2/pi/tiny,&nbsp;(choose&nbsp;tiny&lt;2**-54)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=2.</span><br>
<span class="lineno">65</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1(x)&nbsp;=&nbsp;sqrt(2/(pi*x))*(p1(x)*sin(x1)+q1(x)*cos(x1))</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;x1&nbsp;=&nbsp;x-3*pi/4.&nbsp;It&nbsp;is&nbsp;better&nbsp;to&nbsp;compute&nbsp;sin(x1),cos(x1)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;method&nbsp;mentioned&nbsp;above.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;J1&nbsp;returns&nbsp;the&nbsp;order-one&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno">70</span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspJ1(Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspJ1(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">J1</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">float64</span><span class="op">)</span>&nbsp;<span class="builtintype">float64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">const</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">TwoM27</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.0</span>&nbsp;<span class="op">/</span>&nbsp;<span class="op">(</span><span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">27</span><span class="op">)</span>&nbsp;<span class="comment">//&nbsp;2**-27&nbsp;0x3e40000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Two129</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">129</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2**129&nbsp;0x4800000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;R0/S0&nbsp;on&nbsp;[0,&nbsp;2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">R00</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="num">6.25000000000000000000e-02</span>&nbsp;<span class="comment">//&nbsp;0xBFB0000000000000</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">R01</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.40705666955189706048e-03</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3F570D9F98472C61</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">R02</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="num">1.59955631084035597520e-05</span>&nbsp;<span class="comment">//&nbsp;0xBEF0C5C6BA169668</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">R03</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">4.96727999609584448412e-08</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3E6AAAFA46CA0BD9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">S01</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.91537599538363460805e-02</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3F939D0B12637E53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">S02</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.85946785588630915560e-04</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3F285F56B9CDF664</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">S03</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.17718464042623683263e-06</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3EB3BFF8333F8498</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">S04</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">5.04636257076217042715e-09</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3E35AC88C97DFF2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">S05</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.23542274426137913908e-11</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3DAB2ACFCFB97ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">IsNaN</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">IsInf</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sign</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">x</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="ident">x</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sign</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">c</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">Sincos</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ss</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">-</span><span class="ident">s</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">c</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">cc</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">s</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">c</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;make&nbsp;sure&nbsp;x+x&nbsp;does&nbsp;not&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">MaxFloat64</span><span class="op">/</span><span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">Cos</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">x</span><span class="op">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">s</span><span class="op">*</span><span class="ident">c</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">cc</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ss</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;j1(x)&nbsp;=&nbsp;1/sqrt(pi)&nbsp;*&nbsp;(P(1,x)*cc&nbsp;-&nbsp;Q(1,x)*ss)&nbsp;/&nbsp;sqrt(x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;y1(x)&nbsp;=&nbsp;1/sqrt(pi)&nbsp;*&nbsp;(P(1,x)*ss&nbsp;+&nbsp;Q(1,x)*cc)&nbsp;/&nbsp;sqrt(x)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="builtintype">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="ident">Two129</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="num">1</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">SqrtPi</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">cc</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">Sqrt</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">pone</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">qone</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="num">1</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">SqrtPi</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="op">(</span><span class="ident">u</span><span class="op">*</span><span class="ident">cc</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">v</span><span class="op">*</span><span class="ident">ss</span><span class="op">)</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">Sqrt</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">sign</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">-</span><span class="ident">z</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">TwoM27</span>&nbsp;<span class="op">{</span>&nbsp;<span class="comment">//&nbsp;|x|&lt;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0.5</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="comment">//&nbsp;inexact&nbsp;if&nbsp;x!=0&nbsp;necessary</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">*</span>&nbsp;<span class="op">(</span><span class="ident">R00</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">R01</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">R02</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">R03</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">1.0</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">S01</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">S02</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">S03</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">S04</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">S05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">*=</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">0.5</span><span class="op">*</span><span class="ident">x</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">r</span><span class="op">/</span><span class="ident">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">sign</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">-</span><span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno">145</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Y1&nbsp;returns&nbsp;the&nbsp;order-one&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment">//</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">150</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspY1(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspY1(0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspY1(x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbspY1(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">Y1</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">float64</span><span class="op">)</span>&nbsp;<span class="builtintype">float64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">const</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">TwoM54</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.0</span>&nbsp;<span class="op">/</span>&nbsp;<span class="op">(</span><span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">54</span><span class="op">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2**-54&nbsp;0x3c90000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">Two129</span>&nbsp;<span class="op">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">&lt;&lt;</span>&nbsp;<span class="num">129</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2**129&nbsp;0x4800000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">U00</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="num">1.96057090646238940668e-01</span>&nbsp;<span class="comment">//&nbsp;0xBFC91866143CBC8A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">U01</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">5.04438716639811282616e-02</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3FA9D3C776292CD1</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">U02</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="num">1.91256895875763547298e-03</span>&nbsp;<span class="comment">//&nbsp;0xBF5F55E54844F50F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">U03</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">2.35252600561610495928e-05</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3EF8AB038FA6B88E</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">U04</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="op">-</span><span class="num">9.19099158039878874504e-08</span>&nbsp;<span class="comment">//&nbsp;0xBE78AC00569105B8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">V00</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.99167318236649903973e-02</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3F94650D3F4DA9F0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">V01</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">2.02552581025135171496e-04</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3F2A8C896C257764</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">V02</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.35608801097516229404e-06</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3EB6C05A894E8CA6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">V03</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">6.22741452364621501295e-09</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3E3ABF1D5BA69A86</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">V04</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="num">1.66559246207992079114e-11</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x3DB25039DACA772A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">IsNaN</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">NaN</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">IsInf</span><span class="op">(</span><span class="ident">x</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">0</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">Inf</span><span class="op">(</span><span class="op">-</span><span class="num">1</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span><span class="op">,</span>&nbsp;<span class="ident">c</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">Sincos</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ss</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">-</span><span class="ident">s</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">cc</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">s</span>&nbsp;<span class="op">-</span>&nbsp;<span class="ident">c</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;make&nbsp;sure&nbsp;x+x&nbsp;does&nbsp;not&nbsp;overflow</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">MaxFloat64</span><span class="op">/</span><span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">Cos</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">s</span><span class="op">*</span><span class="ident">c</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">cc</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ss</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;y1(x)&nbsp;=&nbsp;sqrt(2/(pi*x))*(p1(x)*sin(x0)+q1(x)*cos(x0))</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;where&nbsp;x0&nbsp;=&nbsp;x-3pi/4</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Better&nbsp;formula:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos(x0)&nbsp;=&nbsp;cos(x)cos(3pi/4)+sin(x)sin(3pi/4)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;1/sqrt(2)&nbsp;*&nbsp;(sin(x)&nbsp;-&nbsp;cos(x))</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin(x0)&nbsp;=&nbsp;sin(x)cos(3pi/4)-cos(x)sin(3pi/4)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-1/sqrt(2)&nbsp;*&nbsp;(cos(x)&nbsp;+&nbsp;sin(x))</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;To&nbsp;avoid&nbsp;cancellation,&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin(x)&nbsp;+-&nbsp;cos(x)&nbsp;=&nbsp;-cos(2x)/(sin(x)&nbsp;-+&nbsp;cos(x))</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;to&nbsp;compute&nbsp;the&nbsp;worse&nbsp;one.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">z</span>&nbsp;<span class="builtintype">float64</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="ident">Two129</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="num">1</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">SqrtPi</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">ss</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">Sqrt</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">pone</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">qone</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">(</span><span class="num">1</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">SqrtPi</span><span class="op">)</span>&nbsp;<span class="op">*</span>&nbsp;<span class="op">(</span><span class="ident">u</span><span class="op">*</span><span class="ident">ss</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">v</span><span class="op">*</span><span class="ident">cc</span><span class="op">)</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">Sqrt</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&lt;=</span>&nbsp;<span class="ident">TwoM54</span>&nbsp;<span class="op">{</span>&nbsp;<span class="comment">//&nbsp;x&nbsp;&lt;&nbsp;2**-54</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">-</span><span class="op">(</span><span class="num">2</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">Pi</span><span class="op">)</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">u</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">U00</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">U01</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">U02</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">U03</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">U04</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">V00</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">V01</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">V02</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">V03</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">V04</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">x</span><span class="op">*</span><span class="op">(</span><span class="ident">u</span><span class="op">/</span><span class="ident">v</span><span class="op">)</span>&nbsp;<span class="op">+</span>&nbsp;<span class="op">(</span><span class="num">2</span><span class="op">/</span><span class="ident">Pi</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="ident">J1</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">*</span><span class="ident">Log</span><span class="op">(</span><span class="ident">x</span><span class="op">)</span><span class="op">-</span><span class="num">1</span><span class="op">/</span><span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;For&nbsp;x&nbsp;&gt;=&nbsp;8,&nbsp;the&nbsp;asymptotic&nbsp;expansions&nbsp;of&nbsp;pone&nbsp;is</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;+&nbsp;15/128&nbsp;s**2&nbsp;-&nbsp;4725/2**15&nbsp;s**4&nbsp;-&nbsp;...,&nbsp;where&nbsp;s&nbsp;=&nbsp;1/x.</span><br>
<span class="lineno">225</span><span class="comment">//&nbsp;We&nbsp;approximate&nbsp;pone&nbsp;by</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pone(x)&nbsp;=&nbsp;1&nbsp;+&nbsp;(R/S)</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;where&nbsp;R&nbsp;=&nbsp;pr0&nbsp;+&nbsp;pr1*s**2&nbsp;+&nbsp;pr2*s**4&nbsp;+&nbsp;...&nbsp;+&nbsp;pr5*s**10</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;=&nbsp;1&nbsp;+&nbsp;ps0*s**2&nbsp;+&nbsp;...&nbsp;+&nbsp;ps4*s**10</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;and</span><br>
<span class="lineno">230</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;pone(x)-1-R/S&nbsp;|&nbsp;&lt;=&nbsp;2**(-60.06)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in&nbsp;[inf,&nbsp;8]=1/[0,0.125]</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p1R8</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0.00000000000000000000e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x0000000000000000</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.17187499999988647970e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x3FBDFFFFFFFFFCCE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.32394806593073575129e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x402A7A9D357F7FCE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">4.12051854307378562225e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x4079C0D4652EA590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.87474538913960532227e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40AE457DA3A532CC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">7.91447954031891731574e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40BEEA7AC32782DD</span><br>
<span class="lineno">240</span><span class="op">}</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p1S8</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.14207370375678408436e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x405C8D458E656CAC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.65093083420853463394e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40AC85DC964D274F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.69562060269033463555e+04</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40E20B8697C5BB7F</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">9.76027935934950801311e+04</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40F7D42CB28F17BB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.08042720627888811578e+04</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40DE1511697A0B2D</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in&nbsp;[8,4.5454]&nbsp;=&nbsp;1/[0.125,0.22001]</span><br>
<span class="lineno">250</span><span class="keyword">var</span>&nbsp;<span class="ident">p1R5</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.31990519556243522749e-11</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x3DAD0667DAE1CA7D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.17187493190614097638e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x3FBDFFFFE2C10043</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">6.80275127868432871736e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x401B36046E6315E3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.08308182990189109773e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x405B13B9452602ED</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">5.17636139533199752805e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40802D16D052D649</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">5.28715201363337541807e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x408085B8BB7E0CB7</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p1S5</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">5.92805987221131331921e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x404DA3EAA8AF633D</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">9.91401418733614377743e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x408EFB361B066701</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">5.35326695291487976647e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40B4E9445706B6FB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">7.84469031749551231769e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40BEA4B0B8A5BB15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.50404688810361062679e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40978030036F5E51</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in[4.5453,2.8571]&nbsp;=&nbsp;1/[0.2199,0.35001]</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p1R3</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.02503916137373618024e-09</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x3E29FC21A7AD9EDD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.17186865567253592491e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x3FBDFFF55B21D17B</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.93297750033315640650e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x400F76BCE85EAD8A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.51194035591636932736e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40418F489DA6D129</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">9.10550110750781271918e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x4056C3854D2C1837</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">4.85590685197364919645e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x4048478F8EA83EE5</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">275</span><span class="keyword">var</span>&nbsp;<span class="ident">p1S3</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.47913095001251519989e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40416549A134069C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.36762458747825746741e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40750C3307F1A75F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.04687139975775130551e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40905B7C5037D523</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">8.90811346398256432622e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x408BD67DA32E31E9</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.03787932439639277504e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x4059F26D7C2EED53</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in&nbsp;[2.8570,2]&nbsp;=&nbsp;1/[0.3499,0.5]</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p1R2</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.07710830106873743082e-07</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x3E7CE9D4F65544F4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.17176219462683348094e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x3FBDFF42BE760D83</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">2.36851496667608785174e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x4002F2B7F98FAEC0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.22426109148261232917e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40287C377F71A964</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.76939711271687727390e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x4031B1A8177F8EE2</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">5.07352312588818499250e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40144B49A574C1FE</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">p1S2</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">2.14364859363821409488e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x40356FBD8AD5ECDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.25290227168402751090e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x405F529314F92CD5</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">2.32276469057162813669e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x406D08D8D5A2DBD9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.17679373287147100768e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x405D6B7ADA1884A9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">8.36463893371618283368e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0x4020BAB1F44E5192</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="keyword">func</span>&nbsp;<span class="ident">pone</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">float64</span><span class="op">)</span>&nbsp;<span class="builtintype">float64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">p</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">q</span>&nbsp;<span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="builtintype">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">8</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1R8</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1S8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">4.5454</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1R5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1S5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">2.8571</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1R3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1S3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1R2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">p1S2</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">/</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">p</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">p</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">1.0</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">q</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">r</span><span class="op">/</span><span class="ident">s</span><br>
<span class="lineno">320</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;For&nbsp;x&nbsp;&gt;=&nbsp;8,&nbsp;the&nbsp;asymptotic&nbsp;expansions&nbsp;of&nbsp;qone&nbsp;is</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3/8&nbsp;s&nbsp;-&nbsp;105/1024&nbsp;s**3&nbsp;-&nbsp;...,&nbsp;where&nbsp;s&nbsp;=&nbsp;1/x.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;We&nbsp;approximate&nbsp;qone&nbsp;by</span><br>
<span class="lineno">325</span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qone(x)&nbsp;=&nbsp;s*(0.375&nbsp;+&nbsp;(R/S))</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;where&nbsp;R&nbsp;=&nbsp;qr1*s**2&nbsp;+&nbsp;qr2*s**4&nbsp;+&nbsp;...&nbsp;+&nbsp;qr5*s**10</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;=&nbsp;1&nbsp;+&nbsp;qs1*s**2&nbsp;+&nbsp;...&nbsp;+&nbsp;qs6*s**12</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;and</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;qone(x)/s&nbsp;-0.375-R/S&nbsp;|&nbsp;&lt;=&nbsp;2**(-61.13)</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in&nbsp;[inf,&nbsp;8]&nbsp;=&nbsp;1/[0,0.125]</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">q1R8</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">0.00000000000000000000e+00</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x0000000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.02539062499992714161e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xBFBA3FFFFFFFFDF3</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.62717534544589987888e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC0304591A26779F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">7.59601722513950107896e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC087BCD053E4B576</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.18498066702429587167e+04</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC0C724E740F87415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">4.84385124285750353010e+04</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC0E7A6D065D09C6A</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">340</span><span class="keyword">var</span>&nbsp;<span class="ident">q1S8</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.61395369700722909556e+02</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40642CA6DE5BCDE5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">7.82538599923348465381e+03</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40BE9162D0D88419</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.33875336287249578163e+05</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x4100579AB0B75E98</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">7.19657723683240939863e+05</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x4125F65372869C19</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">6.66601232617776375264e+05</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x412457D27719AD5C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">2.94490264303834643215e+05</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC111F9690EA5AA18</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in&nbsp;[8,4.5454]&nbsp;=&nbsp;1/[0.125,0.22001]</span><br>
<span class="lineno">350</span><span class="keyword">var</span>&nbsp;<span class="ident">q1R5</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">2.08979931141764104297e-11</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xBDB6FA431AA1A098</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.02539050241375426231e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xBFBA3FFFCB597FEF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">8.05644828123936029840e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC0201CE6CA03AD4B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.83669607474888380239e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC066F56D6CA7B9B0</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.37319376065508163265e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC09574C66931734F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">2.61244440453215656817e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC0A468E388FDA79D</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">q1S5</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">8.12765501384335777857e+01</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x405451B2FF5A11B2</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.99179873460485964642e+03</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x409F1F31E77BF839</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.74684851924908907677e+04</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40D10F1F0D64CE29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">4.98514270910352279316e+04</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40E8576DAABAD197</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">2.79480751638918118260e+04</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40DB4B04CF7C364B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">4.71918354795128470869e+03</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC0B26F2EFCFFA004</span><br>
<span class="lineno">365</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in&nbsp;[4.5454,2.8571]&nbsp;=&nbsp;1/[0.2199,0.35001]&nbsp;???</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">q1R3</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">5.07831226461766561369e-09</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xBE35CFA9D38FC84F</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.02537829820837089745e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xBFBA3FEB51AEED54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">4.61011581139473403113e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC01270C23302D9FF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">5.78472216562783643212e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC04CEC71C25D16DA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">2.28244540737631695038e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC06C87D34718D55F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">2.19210128478909325622e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC06B66B95F5C1BF6</span><br>
<span class="lineno">375</span><span class="op">}</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">q1S3</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">4.76651550323729509273e+01</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x4047D523CCD367E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">6.73865112676699709482e+02</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40850EEBC031EE3E</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">3.38015286679526343505e+03</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40AA684E448E7C9A</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">5.54772909720722782367e+03</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40B5ABBAA61D54A6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.90311919338810798763e+03</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x409DBC7A0DD4DF4B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.35201191444307340817e+02</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC060E670290A311F</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment">//&nbsp;for&nbsp;x&nbsp;in&nbsp;[2.8570,2]&nbsp;=&nbsp;1/[0.3499,0.5]</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">q1R2</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.78381727510958865572e-07</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xBE87F12644C626D2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.02517042607985553460e-01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xBFBA3E8E9148B010</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">2.75220568278187460720e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC006048469BB4EDA</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">1.96636162643703720221e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC033A9E2C168907F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">4.23253133372830490089e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC04529A3DE104AAA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">2.13719211703704061733e+01</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC0355F3639CF6E52</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">q1S2</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><span class="op">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">2.95333629060523854548e+01</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x403D888A78AE64FF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">2.52981549982190529136e+02</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x406F9F68DB821CBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">7.57502834868645436472e+02</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x4087AC05CE49A0F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">7.39393205320467245656e+02</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40871B2548D4C029</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num">1.55949003336666123687e+02</span><span class="op">,</span>&nbsp;&nbsp;<span class="comment">//&nbsp;0x40637E5E3C3ED8D4</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">-</span><span class="num">4.95949898822628210127e+00</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;0xC013D686E71BE86B</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">qone</span><span class="op">(</span><span class="ident">x</span>&nbsp;<span class="builtintype">float64</span><span class="op">)</span>&nbsp;<span class="builtintype">float64</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">p</span><span class="op">,</span>&nbsp;<span class="ident">q</span>&nbsp;<span class="op">[</span><span class="num">6</span><span class="op">]</span><span class="builtintype">float64</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">8</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1R8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1S8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">4.5454</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1R5</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1S5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">2.8571</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1R3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1S3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;<span class="ident">x</span>&nbsp;<span class="op">&gt;=</span>&nbsp;<span class="num">2</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">p</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1R2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">q</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">q1S2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">z</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">/</span>&nbsp;<span class="op">(</span><span class="ident">x</span>&nbsp;<span class="op">*</span>&nbsp;<span class="ident">x</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">r</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">p</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">p</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">p</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">s</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">1</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">2</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">3</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="op">(</span><span class="ident">q</span><span class="op">[</span><span class="num">4</span><span class="op">]</span><span class="op">+</span><span class="ident">z</span><span class="op">*</span><span class="ident">q</span><span class="op">[</span><span class="num">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="op">(</span><span class="num">0.375</span>&nbsp;<span class="op">+</span>&nbsp;<span class="ident">r</span><span class="op">/</span><span class="ident">s</span><span class="op">)</span>&nbsp;<span class="op">/</span>&nbsp;<span class="ident">x</span><br>
<span class="lineno"></span><span class="op">}</span>
</div>
</body>
</html>
