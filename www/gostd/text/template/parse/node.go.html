<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3264524">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3264579">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3264633">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3264684">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3264701">package</span>&nbsp;<span class="ident" id="3264709">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3264716">import</span>&nbsp;<span class="op" id="3264723">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264726">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264735">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264742">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264753">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3264763">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3264766">var</span>&nbsp;<span class="ident" id="3264770">textFormat</span>&nbsp;<span class="op" id="3264781">=</span>&nbsp;<span class="string" id="3264783">&#34;%s&#34;</span>&nbsp;<span class="comment" id="3264788">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3264844">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="3264913">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="3264973">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3265020">type</span>&nbsp;<span class="ident" id="3265025">Node</span>&nbsp;<span class="keyword" id="3265030">interface</span>&nbsp;<span class="op" id="3265040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265043">Type</span><span class="op" id="3265047">(</span><span class="op" id="3265048">)</span>&nbsp;<span class="ident" id="3265050">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265060">String</span><span class="op" id="3265066">(</span><span class="op" id="3265067">)</span>&nbsp;<span class="builtintype" id="3265069">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3265077">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3265139">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3265205">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265247">Copy</span><span class="op" id="3265251">(</span><span class="op" id="3265252">)</span>&nbsp;<span class="ident" id="3265254">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265260">Position</span><span class="op" id="3265268">(</span><span class="op" id="3265269">)</span>&nbsp;<span class="ident" id="3265271">Pos</span>&nbsp;<span class="comment" id="3265275">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3265340">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3265379">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265452">tree</span><span class="op" id="3265456">(</span><span class="op" id="3265457">)</span>&nbsp;<span class="op" id="3265459">*</span><span class="ident" id="3265460">Tree</span><br>
<span class="lineno"></span><span class="op" id="3265465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3265468">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="3265522">type</span>&nbsp;<span class="ident" id="3265527">NodeType</span>&nbsp;<span class="builtintype" id="3265536">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3265541">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3265613">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="3265642">type</span>&nbsp;<span class="ident" id="3265647">Pos</span>&nbsp;<span class="builtintype" id="3265651">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3265656">func</span>&nbsp;<span class="op" id="3265661">(</span><span class="ident" id="3265662">p</span>&nbsp;<span class="ident" id="3265664">Pos</span><span class="op" id="3265667">)</span>&nbsp;<span class="ident" id="3265669">Position</span><span class="op" id="3265677">(</span><span class="op" id="3265678">)</span>&nbsp;<span class="ident" id="3265680">Pos</span>&nbsp;<span class="op" id="3265684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265687">return</span>&nbsp;<span class="ident" id="3265694">p</span><br>
<span class="lineno"></span><span class="op" id="3265696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3265699">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3265766">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3265829">func</span>&nbsp;<span class="op" id="3265834">(</span><span class="ident" id="3265835">t</span>&nbsp;<span class="ident" id="3265837">NodeType</span><span class="op" id="3265845">)</span>&nbsp;<span class="ident" id="3265847">Type</span><span class="op" id="3265851">(</span><span class="op" id="3265852">)</span>&nbsp;<span class="ident" id="3265854">NodeType</span>&nbsp;<span class="op" id="3265863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265866">return</span>&nbsp;<span class="ident" id="3265873">t</span><br>
<span class="lineno"></span><span class="op" id="3265875">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3265878">const</span>&nbsp;<span class="op" id="3265884">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265887">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3265902">NodeType</span>&nbsp;<span class="op" id="3265911">=</span>&nbsp;<span class="ident" id="3265913">iota</span>&nbsp;<span class="comment" id="3265918">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265934">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265965">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266018">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266049">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266073">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266104">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266138">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266169">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266199">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266230">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266251">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266282">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266321">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266352">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266390">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266421">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266449">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266480">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266523">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266554">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266572">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266603">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266624">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266655">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266684">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266715">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266741">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266772">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266800">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266831">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266851">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266882">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266905">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266936">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266970">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3267001">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267019">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3267050">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3267068">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3267071">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3267082">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3267121">type</span>&nbsp;<span class="ident" id="3267126">ListNode</span>&nbsp;<span class="keyword" id="3267135">struct</span>&nbsp;<span class="op" id="3267142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267145">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267155">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267160">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267166">*</span><span class="ident" id="3267167">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267173">Nodes</span>&nbsp;<span class="op" id="3267179">[</span><span class="op" id="3267180">]</span><span class="ident" id="3267181">Node</span>&nbsp;<span class="comment" id="3267186">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3267225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3267228">func</span>&nbsp;<span class="op" id="3267233">(</span><span class="ident" id="3267234">t</span>&nbsp;<span class="op" id="3267236">*</span><span class="ident" id="3267237">Tree</span><span class="op" id="3267241">)</span>&nbsp;<span class="ident" id="3267243">newList</span><span class="op" id="3267250">(</span><span class="ident" id="3267251">pos</span>&nbsp;<span class="ident" id="3267255">Pos</span><span class="op" id="3267258">)</span>&nbsp;<span class="op" id="3267260">*</span><span class="ident" id="3267261">ListNode</span>&nbsp;<span class="op" id="3267270">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267273">return</span>&nbsp;<span class="op" id="3267280">&amp;</span><span class="ident" id="3267281">ListNode</span><span class="op" id="3267289">{</span><span class="ident" id="3267290">tr</span><span class="op" id="3267292">:</span>&nbsp;<span class="ident" id="3267294">t</span><span class="op" id="3267295">,</span>&nbsp;<span class="ident" id="3267297">NodeType</span><span class="op" id="3267305">:</span>&nbsp;<span class="ident" id="3267307">NodeList</span><span class="op" id="3267315">,</span>&nbsp;<span class="ident" id="3267317">Pos</span><span class="op" id="3267320">:</span>&nbsp;<span class="ident" id="3267322">pos</span><span class="op" id="3267325">}</span><br>
<span class="lineno"></span><span class="op" id="3267327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3267330">func</span>&nbsp;<span class="op" id="3267335">(</span><span class="ident" id="3267336">l</span>&nbsp;<span class="op" id="3267338">*</span><span class="ident" id="3267339">ListNode</span><span class="op" id="3267347">)</span>&nbsp;<span class="builtinfunc" id="3267349">append</span><span class="op" id="3267355">(</span><span class="ident" id="3267356">n</span>&nbsp;<span class="ident" id="3267358">Node</span><span class="op" id="3267362">)</span>&nbsp;<span class="op" id="3267364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267367">l</span><span class="op" id="3267368">.</span><span class="ident" id="3267369">Nodes</span>&nbsp;<span class="op" id="3267375">=</span>&nbsp;<span class="builtinfunc" id="3267377">append</span><span class="op" id="3267383">(</span><span class="ident" id="3267384">l</span><span class="op" id="3267385">.</span><span class="ident" id="3267386">Nodes</span><span class="op" id="3267391">,</span>&nbsp;<span class="ident" id="3267393">n</span><span class="op" id="3267394">)</span><br>
<span class="lineno">90</span><span class="op" id="3267396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3267399">func</span>&nbsp;<span class="op" id="3267404">(</span><span class="ident" id="3267405">l</span>&nbsp;<span class="op" id="3267407">*</span><span class="ident" id="3267408">ListNode</span><span class="op" id="3267416">)</span>&nbsp;<span class="ident" id="3267418">tree</span><span class="op" id="3267422">(</span><span class="op" id="3267423">)</span>&nbsp;<span class="op" id="3267425">*</span><span class="ident" id="3267426">Tree</span>&nbsp;<span class="op" id="3267431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267434">return</span>&nbsp;<span class="ident" id="3267441">l</span><span class="op" id="3267442">.</span><span class="ident" id="3267443">tr</span><br>
<span class="lineno"></span><span class="op" id="3267446">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3267449">func</span>&nbsp;<span class="op" id="3267454">(</span><span class="ident" id="3267455">l</span>&nbsp;<span class="op" id="3267457">*</span><span class="ident" id="3267458">ListNode</span><span class="op" id="3267466">)</span>&nbsp;<span class="ident" id="3267468">String</span><span class="op" id="3267474">(</span><span class="op" id="3267475">)</span>&nbsp;<span class="builtintype" id="3267477">string</span>&nbsp;<span class="op" id="3267484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267487">b</span>&nbsp;<span class="op" id="3267489">:=</span>&nbsp;<span class="builtinfunc" id="3267492">new</span><span class="op" id="3267495">(</span><span class="ident" id="3267496">bytes</span><span class="op" id="3267501">.</span><span class="ident" id="3267502">Buffer</span><span class="op" id="3267508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267511">for</span>&nbsp;<span class="ident" id="3267515">_</span><span class="op" id="3267516">,</span>&nbsp;<span class="ident" id="3267518">n</span>&nbsp;<span class="op" id="3267520">:=</span>&nbsp;<span class="keyword" id="3267523">range</span>&nbsp;<span class="ident" id="3267529">l</span><span class="op" id="3267530">.</span><span class="ident" id="3267531">Nodes</span>&nbsp;<span class="op" id="3267537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267541">fmt</span><span class="op" id="3267544">.</span><span class="ident" id="3267545">Fprint</span><span class="op" id="3267551">(</span><span class="ident" id="3267552">b</span><span class="op" id="3267553">,</span>&nbsp;<span class="ident" id="3267555">n</span><span class="op" id="3267556">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267562">return</span>&nbsp;<span class="ident" id="3267569">b</span><span class="op" id="3267570">.</span><span class="ident" id="3267571">String</span><span class="op" id="3267577">(</span><span class="op" id="3267578">)</span><br>
<span class="lineno"></span><span class="op" id="3267580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3267583">func</span>&nbsp;<span class="op" id="3267588">(</span><span class="ident" id="3267589">l</span>&nbsp;<span class="op" id="3267591">*</span><span class="ident" id="3267592">ListNode</span><span class="op" id="3267600">)</span>&nbsp;<span class="ident" id="3267602">CopyList</span><span class="op" id="3267610">(</span><span class="op" id="3267611">)</span>&nbsp;<span class="op" id="3267613">*</span><span class="ident" id="3267614">ListNode</span>&nbsp;<span class="op" id="3267623">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267626">if</span>&nbsp;<span class="ident" id="3267629">l</span>&nbsp;<span class="op" id="3267631">==</span>&nbsp;<span class="ident" id="3267634">nil</span>&nbsp;<span class="op" id="3267638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267642">return</span>&nbsp;<span class="ident" id="3267649">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267655">n</span>&nbsp;<span class="op" id="3267657">:=</span>&nbsp;<span class="ident" id="3267660">l</span><span class="op" id="3267661">.</span><span class="ident" id="3267662">tr</span><span class="op" id="3267664">.</span><span class="ident" id="3267665">newList</span><span class="op" id="3267672">(</span><span class="ident" id="3267673">l</span><span class="op" id="3267674">.</span><span class="ident" id="3267675">Pos</span><span class="op" id="3267678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267681">for</span>&nbsp;<span class="ident" id="3267685">_</span><span class="op" id="3267686">,</span>&nbsp;<span class="ident" id="3267688">elem</span>&nbsp;<span class="op" id="3267693">:=</span>&nbsp;<span class="keyword" id="3267696">range</span>&nbsp;<span class="ident" id="3267702">l</span><span class="op" id="3267703">.</span><span class="ident" id="3267704">Nodes</span>&nbsp;<span class="op" id="3267710">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267714">n</span><span class="op" id="3267715">.</span><span class="builtinfunc" id="3267716">append</span><span class="op" id="3267722">(</span><span class="ident" id="3267723">elem</span><span class="op" id="3267727">.</span><span class="ident" id="3267728">Copy</span><span class="op" id="3267732">(</span><span class="op" id="3267733">)</span><span class="op" id="3267734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267740">return</span>&nbsp;<span class="ident" id="3267747">n</span><br>
<span class="lineno"></span><span class="op" id="3267749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3267752">func</span>&nbsp;<span class="op" id="3267757">(</span><span class="ident" id="3267758">l</span>&nbsp;<span class="op" id="3267760">*</span><span class="ident" id="3267761">ListNode</span><span class="op" id="3267769">)</span>&nbsp;<span class="ident" id="3267771">Copy</span><span class="op" id="3267775">(</span><span class="op" id="3267776">)</span>&nbsp;<span class="ident" id="3267778">Node</span>&nbsp;<span class="op" id="3267783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267786">return</span>&nbsp;<span class="ident" id="3267793">l</span><span class="op" id="3267794">.</span><span class="ident" id="3267795">CopyList</span><span class="op" id="3267803">(</span><span class="op" id="3267804">)</span><br>
<span class="lineno"></span><span class="op" id="3267806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3267809">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="3267839">type</span>&nbsp;<span class="ident" id="3267844">TextNode</span>&nbsp;<span class="keyword" id="3267853">struct</span>&nbsp;<span class="op" id="3267860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267863">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267873">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267878">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3267883">*</span><span class="ident" id="3267884">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267890">Text</span>&nbsp;<span class="op" id="3267895">[</span><span class="op" id="3267896">]</span><span class="builtintype" id="3267897">byte</span>&nbsp;<span class="comment" id="3267902">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="3267934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3267937">func</span>&nbsp;<span class="op" id="3267942">(</span><span class="ident" id="3267943">t</span>&nbsp;<span class="op" id="3267945">*</span><span class="ident" id="3267946">Tree</span><span class="op" id="3267950">)</span>&nbsp;<span class="ident" id="3267952">newText</span><span class="op" id="3267959">(</span><span class="ident" id="3267960">pos</span>&nbsp;<span class="ident" id="3267964">Pos</span><span class="op" id="3267967">,</span>&nbsp;<span class="ident" id="3267969">text</span>&nbsp;<span class="builtintype" id="3267974">string</span><span class="op" id="3267980">)</span>&nbsp;<span class="op" id="3267982">*</span><span class="ident" id="3267983">TextNode</span>&nbsp;<span class="op" id="3267992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267995">return</span>&nbsp;<span class="op" id="3268002">&amp;</span><span class="ident" id="3268003">TextNode</span><span class="op" id="3268011">{</span><span class="ident" id="3268012">tr</span><span class="op" id="3268014">:</span>&nbsp;<span class="ident" id="3268016">t</span><span class="op" id="3268017">,</span>&nbsp;<span class="ident" id="3268019">NodeType</span><span class="op" id="3268027">:</span>&nbsp;<span class="ident" id="3268029">NodeText</span><span class="op" id="3268037">,</span>&nbsp;<span class="ident" id="3268039">Pos</span><span class="op" id="3268042">:</span>&nbsp;<span class="ident" id="3268044">pos</span><span class="op" id="3268047">,</span>&nbsp;<span class="ident" id="3268049">Text</span><span class="op" id="3268053">:</span>&nbsp;<span class="op" id="3268055">[</span><span class="op" id="3268056">]</span><span class="builtintype" id="3268057">byte</span><span class="op" id="3268061">(</span><span class="ident" id="3268062">text</span><span class="op" id="3268066">)</span><span class="op" id="3268067">}</span><br>
<span class="lineno"></span><span class="op" id="3268069">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="3268072">func</span>&nbsp;<span class="op" id="3268077">(</span><span class="ident" id="3268078">t</span>&nbsp;<span class="op" id="3268080">*</span><span class="ident" id="3268081">TextNode</span><span class="op" id="3268089">)</span>&nbsp;<span class="ident" id="3268091">String</span><span class="op" id="3268097">(</span><span class="op" id="3268098">)</span>&nbsp;<span class="builtintype" id="3268100">string</span>&nbsp;<span class="op" id="3268107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268110">return</span>&nbsp;<span class="ident" id="3268117">fmt</span><span class="op" id="3268120">.</span><span class="ident" id="3268121">Sprintf</span><span class="op" id="3268128">(</span><span class="ident" id="3268129">textFormat</span><span class="op" id="3268139">,</span>&nbsp;<span class="ident" id="3268141">t</span><span class="op" id="3268142">.</span><span class="ident" id="3268143">Text</span><span class="op" id="3268147">)</span><br>
<span class="lineno"></span><span class="op" id="3268149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3268152">func</span>&nbsp;<span class="op" id="3268157">(</span><span class="ident" id="3268158">t</span>&nbsp;<span class="op" id="3268160">*</span><span class="ident" id="3268161">TextNode</span><span class="op" id="3268169">)</span>&nbsp;<span class="ident" id="3268171">tree</span><span class="op" id="3268175">(</span><span class="op" id="3268176">)</span>&nbsp;<span class="op" id="3268178">*</span><span class="ident" id="3268179">Tree</span>&nbsp;<span class="op" id="3268184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268187">return</span>&nbsp;<span class="ident" id="3268194">t</span><span class="op" id="3268195">.</span><span class="ident" id="3268196">tr</span><br>
<span class="lineno"></span><span class="op" id="3268199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3268202">func</span>&nbsp;<span class="op" id="3268207">(</span><span class="ident" id="3268208">t</span>&nbsp;<span class="op" id="3268210">*</span><span class="ident" id="3268211">TextNode</span><span class="op" id="3268219">)</span>&nbsp;<span class="ident" id="3268221">Copy</span><span class="op" id="3268225">(</span><span class="op" id="3268226">)</span>&nbsp;<span class="ident" id="3268228">Node</span>&nbsp;<span class="op" id="3268233">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268236">return</span>&nbsp;<span class="op" id="3268243">&amp;</span><span class="ident" id="3268244">TextNode</span><span class="op" id="3268252">{</span><span class="ident" id="3268253">tr</span><span class="op" id="3268255">:</span>&nbsp;<span class="ident" id="3268257">t</span><span class="op" id="3268258">.</span><span class="ident" id="3268259">tr</span><span class="op" id="3268261">,</span>&nbsp;<span class="ident" id="3268263">NodeType</span><span class="op" id="3268271">:</span>&nbsp;<span class="ident" id="3268273">NodeText</span><span class="op" id="3268281">,</span>&nbsp;<span class="ident" id="3268283">Pos</span><span class="op" id="3268286">:</span>&nbsp;<span class="ident" id="3268288">t</span><span class="op" id="3268289">.</span><span class="ident" id="3268290">Pos</span><span class="op" id="3268293">,</span>&nbsp;<span class="ident" id="3268295">Text</span><span class="op" id="3268299">:</span>&nbsp;<span class="builtinfunc" id="3268301">append</span><span class="op" id="3268307">(</span><span class="op" id="3268308">[</span><span class="op" id="3268309">]</span><span class="builtintype" id="3268310">byte</span><span class="op" id="3268314">{</span><span class="op" id="3268315">}</span><span class="op" id="3268316">,</span>&nbsp;<span class="ident" id="3268318">t</span><span class="op" id="3268319">.</span><span class="ident" id="3268320">Text</span><span class="op" id="3268324">...</span><span class="op" id="3268327">)</span><span class="op" id="3268328">}</span><br>
<span class="lineno"></span><span class="op" id="3268330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3268333">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="3268388">type</span>&nbsp;<span class="ident" id="3268393">PipeNode</span>&nbsp;<span class="keyword" id="3268402">struct</span>&nbsp;<span class="op" id="3268409">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268412">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268422">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268427">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3268432">*</span><span class="ident" id="3268433">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268439">Line</span>&nbsp;<span class="builtintype" id="3268444">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3268460">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268530">Decl</span>&nbsp;<span class="op" id="3268535">[</span><span class="op" id="3268536">]</span><span class="op" id="3268537">*</span><span class="ident" id="3268538">VariableNode</span>&nbsp;<span class="comment" id="3268551">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268595">Cmds</span>&nbsp;<span class="op" id="3268600">[</span><span class="op" id="3268601">]</span><span class="op" id="3268602">*</span><span class="ident" id="3268603">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="3268616">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3268650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3268653">func</span>&nbsp;<span class="op" id="3268658">(</span><span class="ident" id="3268659">t</span>&nbsp;<span class="op" id="3268661">*</span><span class="ident" id="3268662">Tree</span><span class="op" id="3268666">)</span>&nbsp;<span class="ident" id="3268668">newPipeline</span><span class="op" id="3268679">(</span><span class="ident" id="3268680">pos</span>&nbsp;<span class="ident" id="3268684">Pos</span><span class="op" id="3268687">,</span>&nbsp;<span class="ident" id="3268689">line</span>&nbsp;<span class="builtintype" id="3268694">int</span><span class="op" id="3268697">,</span>&nbsp;<span class="ident" id="3268699">decl</span>&nbsp;<span class="op" id="3268704">[</span><span class="op" id="3268705">]</span><span class="op" id="3268706">*</span><span class="ident" id="3268707">VariableNode</span><span class="op" id="3268719">)</span>&nbsp;<span class="op" id="3268721">*</span><span class="ident" id="3268722">PipeNode</span>&nbsp;<span class="op" id="3268731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268734">return</span>&nbsp;<span class="op" id="3268741">&amp;</span><span class="ident" id="3268742">PipeNode</span><span class="op" id="3268750">{</span><span class="ident" id="3268751">tr</span><span class="op" id="3268753">:</span>&nbsp;<span class="ident" id="3268755">t</span><span class="op" id="3268756">,</span>&nbsp;<span class="ident" id="3268758">NodeType</span><span class="op" id="3268766">:</span>&nbsp;<span class="ident" id="3268768">NodePipe</span><span class="op" id="3268776">,</span>&nbsp;<span class="ident" id="3268778">Pos</span><span class="op" id="3268781">:</span>&nbsp;<span class="ident" id="3268783">pos</span><span class="op" id="3268786">,</span>&nbsp;<span class="ident" id="3268788">Line</span><span class="op" id="3268792">:</span>&nbsp;<span class="ident" id="3268794">line</span><span class="op" id="3268798">,</span>&nbsp;<span class="ident" id="3268800">Decl</span><span class="op" id="3268804">:</span>&nbsp;<span class="ident" id="3268806">decl</span><span class="op" id="3268810">}</span><br>
<span class="lineno">155</span><span class="op" id="3268812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3268815">func</span>&nbsp;<span class="op" id="3268820">(</span><span class="ident" id="3268821">p</span>&nbsp;<span class="op" id="3268823">*</span><span class="ident" id="3268824">PipeNode</span><span class="op" id="3268832">)</span>&nbsp;<span class="builtinfunc" id="3268834">append</span><span class="op" id="3268840">(</span><span class="ident" id="3268841">command</span>&nbsp;<span class="op" id="3268849">*</span><span class="ident" id="3268850">CommandNode</span><span class="op" id="3268861">)</span>&nbsp;<span class="op" id="3268863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268866">p</span><span class="op" id="3268867">.</span><span class="ident" id="3268868">Cmds</span>&nbsp;<span class="op" id="3268873">=</span>&nbsp;<span class="builtinfunc" id="3268875">append</span><span class="op" id="3268881">(</span><span class="ident" id="3268882">p</span><span class="op" id="3268883">.</span><span class="ident" id="3268884">Cmds</span><span class="op" id="3268888">,</span>&nbsp;<span class="ident" id="3268890">command</span><span class="op" id="3268897">)</span><br>
<span class="lineno"></span><span class="op" id="3268899">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="3268902">func</span>&nbsp;<span class="op" id="3268907">(</span><span class="ident" id="3268908">p</span>&nbsp;<span class="op" id="3268910">*</span><span class="ident" id="3268911">PipeNode</span><span class="op" id="3268919">)</span>&nbsp;<span class="ident" id="3268921">String</span><span class="op" id="3268927">(</span><span class="op" id="3268928">)</span>&nbsp;<span class="builtintype" id="3268930">string</span>&nbsp;<span class="op" id="3268937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268940">s</span>&nbsp;<span class="op" id="3268942">:=</span>&nbsp;<span class="string" id="3268945">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268949">if</span>&nbsp;<span class="builtinfunc" id="3268952">len</span><span class="op" id="3268955">(</span><span class="ident" id="3268956">p</span><span class="op" id="3268957">.</span><span class="ident" id="3268958">Decl</span><span class="op" id="3268962">)</span>&nbsp;<span class="op" id="3268964">&gt;</span>&nbsp;<span class="num" id="3268966">0</span>&nbsp;<span class="op" id="3268968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268972">for</span>&nbsp;<span class="ident" id="3268976">i</span><span class="op" id="3268977">,</span>&nbsp;<span class="ident" id="3268979">v</span>&nbsp;<span class="op" id="3268981">:=</span>&nbsp;<span class="keyword" id="3268984">range</span>&nbsp;<span class="ident" id="3268990">p</span><span class="op" id="3268991">.</span><span class="ident" id="3268992">Decl</span>&nbsp;<span class="op" id="3268997">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269002">if</span>&nbsp;<span class="ident" id="3269005">i</span>&nbsp;<span class="op" id="3269007">&gt;</span>&nbsp;<span class="num" id="3269009">0</span>&nbsp;<span class="op" id="3269011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269017">s</span>&nbsp;<span class="op" id="3269019">+=</span>&nbsp;<span class="string" id="3269022">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269035">s</span>&nbsp;<span class="op" id="3269037">+=</span>&nbsp;<span class="ident" id="3269040">v</span><span class="op" id="3269041">.</span><span class="ident" id="3269042">String</span><span class="op" id="3269048">(</span><span class="op" id="3269049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269053">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269057">s</span>&nbsp;<span class="op" id="3269059">+=</span>&nbsp;<span class="string" id="3269062">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269073">for</span>&nbsp;<span class="ident" id="3269077">i</span><span class="op" id="3269078">,</span>&nbsp;<span class="ident" id="3269080">c</span>&nbsp;<span class="op" id="3269082">:=</span>&nbsp;<span class="keyword" id="3269085">range</span>&nbsp;<span class="ident" id="3269091">p</span><span class="op" id="3269092">.</span><span class="ident" id="3269093">Cmds</span>&nbsp;<span class="op" id="3269098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269102">if</span>&nbsp;<span class="ident" id="3269105">i</span>&nbsp;<span class="op" id="3269107">&gt;</span>&nbsp;<span class="num" id="3269109">0</span>&nbsp;<span class="op" id="3269111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269116">s</span>&nbsp;<span class="op" id="3269118">+=</span>&nbsp;<span class="string" id="3269121">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269133">s</span>&nbsp;<span class="op" id="3269135">+=</span>&nbsp;<span class="ident" id="3269138">c</span><span class="op" id="3269139">.</span><span class="ident" id="3269140">String</span><span class="op" id="3269146">(</span><span class="op" id="3269147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269153">return</span>&nbsp;<span class="ident" id="3269160">s</span><br>
<span class="lineno"></span><span class="op" id="3269162">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3269165">func</span>&nbsp;<span class="op" id="3269170">(</span><span class="ident" id="3269171">p</span>&nbsp;<span class="op" id="3269173">*</span><span class="ident" id="3269174">PipeNode</span><span class="op" id="3269182">)</span>&nbsp;<span class="ident" id="3269184">tree</span><span class="op" id="3269188">(</span><span class="op" id="3269189">)</span>&nbsp;<span class="op" id="3269191">*</span><span class="ident" id="3269192">Tree</span>&nbsp;<span class="op" id="3269197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269200">return</span>&nbsp;<span class="ident" id="3269207">p</span><span class="op" id="3269208">.</span><span class="ident" id="3269209">tr</span><br>
<span class="lineno"></span><span class="op" id="3269212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3269215">func</span>&nbsp;<span class="op" id="3269220">(</span><span class="ident" id="3269221">p</span>&nbsp;<span class="op" id="3269223">*</span><span class="ident" id="3269224">PipeNode</span><span class="op" id="3269232">)</span>&nbsp;<span class="ident" id="3269234">CopyPipe</span><span class="op" id="3269242">(</span><span class="op" id="3269243">)</span>&nbsp;<span class="op" id="3269245">*</span><span class="ident" id="3269246">PipeNode</span>&nbsp;<span class="op" id="3269255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269258">if</span>&nbsp;<span class="ident" id="3269261">p</span>&nbsp;<span class="op" id="3269263">==</span>&nbsp;<span class="ident" id="3269266">nil</span>&nbsp;<span class="op" id="3269270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269274">return</span>&nbsp;<span class="ident" id="3269281">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269287">var</span>&nbsp;<span class="ident" id="3269291">decl</span>&nbsp;<span class="op" id="3269296">[</span><span class="op" id="3269297">]</span><span class="op" id="3269298">*</span><span class="ident" id="3269299">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269313">for</span>&nbsp;<span class="ident" id="3269317">_</span><span class="op" id="3269318">,</span>&nbsp;<span class="ident" id="3269320">d</span>&nbsp;<span class="op" id="3269322">:=</span>&nbsp;<span class="keyword" id="3269325">range</span>&nbsp;<span class="ident" id="3269331">p</span><span class="op" id="3269332">.</span><span class="ident" id="3269333">Decl</span>&nbsp;<span class="op" id="3269338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269342">decl</span>&nbsp;<span class="op" id="3269347">=</span>&nbsp;<span class="builtinfunc" id="3269349">append</span><span class="op" id="3269355">(</span><span class="ident" id="3269356">decl</span><span class="op" id="3269360">,</span>&nbsp;<span class="ident" id="3269362">d</span><span class="op" id="3269363">.</span><span class="ident" id="3269364">Copy</span><span class="op" id="3269368">(</span><span class="op" id="3269369">)</span><span class="op" id="3269370">.</span><span class="op" id="3269371">(</span><span class="op" id="3269372">*</span><span class="ident" id="3269373">VariableNode</span><span class="op" id="3269385">)</span><span class="op" id="3269386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269392">n</span>&nbsp;<span class="op" id="3269394">:=</span>&nbsp;<span class="ident" id="3269397">p</span><span class="op" id="3269398">.</span><span class="ident" id="3269399">tr</span><span class="op" id="3269401">.</span><span class="ident" id="3269402">newPipeline</span><span class="op" id="3269413">(</span><span class="ident" id="3269414">p</span><span class="op" id="3269415">.</span><span class="ident" id="3269416">Pos</span><span class="op" id="3269419">,</span>&nbsp;<span class="ident" id="3269421">p</span><span class="op" id="3269422">.</span><span class="ident" id="3269423">Line</span><span class="op" id="3269427">,</span>&nbsp;<span class="ident" id="3269429">decl</span><span class="op" id="3269433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269436">for</span>&nbsp;<span class="ident" id="3269440">_</span><span class="op" id="3269441">,</span>&nbsp;<span class="ident" id="3269443">c</span>&nbsp;<span class="op" id="3269445">:=</span>&nbsp;<span class="keyword" id="3269448">range</span>&nbsp;<span class="ident" id="3269454">p</span><span class="op" id="3269455">.</span><span class="ident" id="3269456">Cmds</span>&nbsp;<span class="op" id="3269461">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269465">n</span><span class="op" id="3269466">.</span><span class="builtinfunc" id="3269467">append</span><span class="op" id="3269473">(</span><span class="ident" id="3269474">c</span><span class="op" id="3269475">.</span><span class="ident" id="3269476">Copy</span><span class="op" id="3269480">(</span><span class="op" id="3269481">)</span><span class="op" id="3269482">.</span><span class="op" id="3269483">(</span><span class="op" id="3269484">*</span><span class="ident" id="3269485">CommandNode</span><span class="op" id="3269496">)</span><span class="op" id="3269497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269503">return</span>&nbsp;<span class="ident" id="3269510">n</span><br>
<span class="lineno"></span><span class="op" id="3269512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="3269515">func</span>&nbsp;<span class="op" id="3269520">(</span><span class="ident" id="3269521">p</span>&nbsp;<span class="op" id="3269523">*</span><span class="ident" id="3269524">PipeNode</span><span class="op" id="3269532">)</span>&nbsp;<span class="ident" id="3269534">Copy</span><span class="op" id="3269538">(</span><span class="op" id="3269539">)</span>&nbsp;<span class="ident" id="3269541">Node</span>&nbsp;<span class="op" id="3269546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269549">return</span>&nbsp;<span class="ident" id="3269556">p</span><span class="op" id="3269557">.</span><span class="ident" id="3269558">CopyPipe</span><span class="op" id="3269566">(</span><span class="op" id="3269567">)</span><br>
<span class="lineno"></span><span class="op" id="3269569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3269572">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="3269637">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="3269707">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="3269770">type</span>&nbsp;<span class="ident" id="3269775">ActionNode</span>&nbsp;<span class="keyword" id="3269786">struct</span>&nbsp;<span class="op" id="3269793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269796">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269806">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269811">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3269816">*</span><span class="ident" id="3269817">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269823">Line</span>&nbsp;<span class="builtintype" id="3269828">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3269838">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269908">Pipe</span>&nbsp;<span class="op" id="3269913">*</span><span class="ident" id="3269914">PipeNode</span>&nbsp;<span class="comment" id="3269923">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3269954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3269957">func</span>&nbsp;<span class="op" id="3269962">(</span><span class="ident" id="3269963">t</span>&nbsp;<span class="op" id="3269965">*</span><span class="ident" id="3269966">Tree</span><span class="op" id="3269970">)</span>&nbsp;<span class="ident" id="3269972">newAction</span><span class="op" id="3269981">(</span><span class="ident" id="3269982">pos</span>&nbsp;<span class="ident" id="3269986">Pos</span><span class="op" id="3269989">,</span>&nbsp;<span class="ident" id="3269991">line</span>&nbsp;<span class="builtintype" id="3269996">int</span><span class="op" id="3269999">,</span>&nbsp;<span class="ident" id="3270001">pipe</span>&nbsp;<span class="op" id="3270006">*</span><span class="ident" id="3270007">PipeNode</span><span class="op" id="3270015">)</span>&nbsp;<span class="op" id="3270017">*</span><span class="ident" id="3270018">ActionNode</span>&nbsp;<span class="op" id="3270029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270032">return</span>&nbsp;<span class="op" id="3270039">&amp;</span><span class="ident" id="3270040">ActionNode</span><span class="op" id="3270050">{</span><span class="ident" id="3270051">tr</span><span class="op" id="3270053">:</span>&nbsp;<span class="ident" id="3270055">t</span><span class="op" id="3270056">,</span>&nbsp;<span class="ident" id="3270058">NodeType</span><span class="op" id="3270066">:</span>&nbsp;<span class="ident" id="3270068">NodeAction</span><span class="op" id="3270078">,</span>&nbsp;<span class="ident" id="3270080">Pos</span><span class="op" id="3270083">:</span>&nbsp;<span class="ident" id="3270085">pos</span><span class="op" id="3270088">,</span>&nbsp;<span class="ident" id="3270090">Line</span><span class="op" id="3270094">:</span>&nbsp;<span class="ident" id="3270096">line</span><span class="op" id="3270100">,</span>&nbsp;<span class="ident" id="3270102">Pipe</span><span class="op" id="3270106">:</span>&nbsp;<span class="ident" id="3270108">pipe</span><span class="op" id="3270112">}</span><br>
<span class="lineno"></span><span class="op" id="3270114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3270117">func</span>&nbsp;<span class="op" id="3270122">(</span><span class="ident" id="3270123">a</span>&nbsp;<span class="op" id="3270125">*</span><span class="ident" id="3270126">ActionNode</span><span class="op" id="3270136">)</span>&nbsp;<span class="ident" id="3270138">String</span><span class="op" id="3270144">(</span><span class="op" id="3270145">)</span>&nbsp;<span class="builtintype" id="3270147">string</span>&nbsp;<span class="op" id="3270154">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270157">return</span>&nbsp;<span class="ident" id="3270164">fmt</span><span class="op" id="3270167">.</span><span class="ident" id="3270168">Sprintf</span><span class="op" id="3270175">(</span><span class="string" id="3270176">&#34;{{%s}}&#34;</span><span class="op" id="3270184">,</span>&nbsp;<span class="ident" id="3270186">a</span><span class="op" id="3270187">.</span><span class="ident" id="3270188">Pipe</span><span class="op" id="3270192">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="3270195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3270198">func</span>&nbsp;<span class="op" id="3270203">(</span><span class="ident" id="3270204">a</span>&nbsp;<span class="op" id="3270206">*</span><span class="ident" id="3270207">ActionNode</span><span class="op" id="3270217">)</span>&nbsp;<span class="ident" id="3270219">tree</span><span class="op" id="3270223">(</span><span class="op" id="3270224">)</span>&nbsp;<span class="op" id="3270226">*</span><span class="ident" id="3270227">Tree</span>&nbsp;<span class="op" id="3270232">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270235">return</span>&nbsp;<span class="ident" id="3270242">a</span><span class="op" id="3270243">.</span><span class="ident" id="3270244">tr</span><br>
<span class="lineno"></span><span class="op" id="3270247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3270250">func</span>&nbsp;<span class="op" id="3270255">(</span><span class="ident" id="3270256">a</span>&nbsp;<span class="op" id="3270258">*</span><span class="ident" id="3270259">ActionNode</span><span class="op" id="3270269">)</span>&nbsp;<span class="ident" id="3270271">Copy</span><span class="op" id="3270275">(</span><span class="op" id="3270276">)</span>&nbsp;<span class="ident" id="3270278">Node</span>&nbsp;<span class="op" id="3270283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270286">return</span>&nbsp;<span class="ident" id="3270293">a</span><span class="op" id="3270294">.</span><span class="ident" id="3270295">tr</span><span class="op" id="3270297">.</span><span class="ident" id="3270298">newAction</span><span class="op" id="3270307">(</span><span class="ident" id="3270308">a</span><span class="op" id="3270309">.</span><span class="ident" id="3270310">Pos</span><span class="op" id="3270313">,</span>&nbsp;<span class="ident" id="3270315">a</span><span class="op" id="3270316">.</span><span class="ident" id="3270317">Line</span><span class="op" id="3270321">,</span>&nbsp;<span class="ident" id="3270323">a</span><span class="op" id="3270324">.</span><span class="ident" id="3270325">Pipe</span><span class="op" id="3270329">.</span><span class="ident" id="3270330">CopyPipe</span><span class="op" id="3270338">(</span><span class="op" id="3270339">)</span><span class="op" id="3270340">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="3270343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3270346">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="3270419">type</span>&nbsp;<span class="ident" id="3270424">CommandNode</span>&nbsp;<span class="keyword" id="3270436">struct</span>&nbsp;<span class="op" id="3270443">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270446">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270456">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270461">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3270466">*</span><span class="ident" id="3270467">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270473">Args</span>&nbsp;<span class="op" id="3270478">[</span><span class="op" id="3270479">]</span><span class="ident" id="3270480">Node</span>&nbsp;<span class="comment" id="3270485">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3270548">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="3270551">func</span>&nbsp;<span class="op" id="3270556">(</span><span class="ident" id="3270557">t</span>&nbsp;<span class="op" id="3270559">*</span><span class="ident" id="3270560">Tree</span><span class="op" id="3270564">)</span>&nbsp;<span class="ident" id="3270566">newCommand</span><span class="op" id="3270576">(</span><span class="ident" id="3270577">pos</span>&nbsp;<span class="ident" id="3270581">Pos</span><span class="op" id="3270584">)</span>&nbsp;<span class="op" id="3270586">*</span><span class="ident" id="3270587">CommandNode</span>&nbsp;<span class="op" id="3270599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270602">return</span>&nbsp;<span class="op" id="3270609">&amp;</span><span class="ident" id="3270610">CommandNode</span><span class="op" id="3270621">{</span><span class="ident" id="3270622">tr</span><span class="op" id="3270624">:</span>&nbsp;<span class="ident" id="3270626">t</span><span class="op" id="3270627">,</span>&nbsp;<span class="ident" id="3270629">NodeType</span><span class="op" id="3270637">:</span>&nbsp;<span class="ident" id="3270639">NodeCommand</span><span class="op" id="3270650">,</span>&nbsp;<span class="ident" id="3270652">Pos</span><span class="op" id="3270655">:</span>&nbsp;<span class="ident" id="3270657">pos</span><span class="op" id="3270660">}</span><br>
<span class="lineno"></span><span class="op" id="3270662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="3270665">func</span>&nbsp;<span class="op" id="3270670">(</span><span class="ident" id="3270671">c</span>&nbsp;<span class="op" id="3270673">*</span><span class="ident" id="3270674">CommandNode</span><span class="op" id="3270685">)</span>&nbsp;<span class="builtinfunc" id="3270687">append</span><span class="op" id="3270693">(</span><span class="ident" id="3270694">arg</span>&nbsp;<span class="ident" id="3270698">Node</span><span class="op" id="3270702">)</span>&nbsp;<span class="op" id="3270704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270707">c</span><span class="op" id="3270708">.</span><span class="ident" id="3270709">Args</span>&nbsp;<span class="op" id="3270714">=</span>&nbsp;<span class="builtinfunc" id="3270716">append</span><span class="op" id="3270722">(</span><span class="ident" id="3270723">c</span><span class="op" id="3270724">.</span><span class="ident" id="3270725">Args</span><span class="op" id="3270729">,</span>&nbsp;<span class="ident" id="3270731">arg</span><span class="op" id="3270734">)</span><br>
<span class="lineno"></span><span class="op" id="3270736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3270739">func</span>&nbsp;<span class="op" id="3270744">(</span><span class="ident" id="3270745">c</span>&nbsp;<span class="op" id="3270747">*</span><span class="ident" id="3270748">CommandNode</span><span class="op" id="3270759">)</span>&nbsp;<span class="ident" id="3270761">String</span><span class="op" id="3270767">(</span><span class="op" id="3270768">)</span>&nbsp;<span class="builtintype" id="3270770">string</span>&nbsp;<span class="op" id="3270777">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270780">s</span>&nbsp;<span class="op" id="3270782">:=</span>&nbsp;<span class="string" id="3270785">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270789">for</span>&nbsp;<span class="ident" id="3270793">i</span><span class="op" id="3270794">,</span>&nbsp;<span class="ident" id="3270796">arg</span>&nbsp;<span class="op" id="3270800">:=</span>&nbsp;<span class="keyword" id="3270803">range</span>&nbsp;<span class="ident" id="3270809">c</span><span class="op" id="3270810">.</span><span class="ident" id="3270811">Args</span>&nbsp;<span class="op" id="3270816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270820">if</span>&nbsp;<span class="ident" id="3270823">i</span>&nbsp;<span class="op" id="3270825">&gt;</span>&nbsp;<span class="num" id="3270827">0</span>&nbsp;<span class="op" id="3270829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270834">s</span>&nbsp;<span class="op" id="3270836">+=</span>&nbsp;<span class="string" id="3270839">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270845">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270849">if</span>&nbsp;<span class="ident" id="3270852">arg</span><span class="op" id="3270855">,</span>&nbsp;<span class="ident" id="3270857">ok</span>&nbsp;<span class="op" id="3270860">:=</span>&nbsp;<span class="ident" id="3270863">arg</span><span class="op" id="3270866">.</span><span class="op" id="3270867">(</span><span class="op" id="3270868">*</span><span class="ident" id="3270869">PipeNode</span><span class="op" id="3270877">)</span><span class="op" id="3270878">;</span>&nbsp;<span class="ident" id="3270880">ok</span>&nbsp;<span class="op" id="3270883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270888">s</span>&nbsp;<span class="op" id="3270890">+=</span>&nbsp;<span class="string" id="3270893">&#34;(&#34;</span>&nbsp;<span class="op" id="3270897">+</span>&nbsp;<span class="ident" id="3270899">arg</span><span class="op" id="3270902">.</span><span class="ident" id="3270903">String</span><span class="op" id="3270909">(</span><span class="op" id="3270910">)</span>&nbsp;<span class="op" id="3270912">+</span>&nbsp;<span class="string" id="3270914">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270921">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270936">s</span>&nbsp;<span class="op" id="3270938">+=</span>&nbsp;<span class="ident" id="3270941">arg</span><span class="op" id="3270944">.</span><span class="ident" id="3270945">String</span><span class="op" id="3270951">(</span><span class="op" id="3270952">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270958">return</span>&nbsp;<span class="ident" id="3270965">s</span><br>
<span class="lineno"></span><span class="op" id="3270967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3270970">func</span>&nbsp;<span class="op" id="3270975">(</span><span class="ident" id="3270976">c</span>&nbsp;<span class="op" id="3270978">*</span><span class="ident" id="3270979">CommandNode</span><span class="op" id="3270990">)</span>&nbsp;<span class="ident" id="3270992">tree</span><span class="op" id="3270996">(</span><span class="op" id="3270997">)</span>&nbsp;<span class="op" id="3270999">*</span><span class="ident" id="3271000">Tree</span>&nbsp;<span class="op" id="3271005">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271008">return</span>&nbsp;<span class="ident" id="3271015">c</span><span class="op" id="3271016">.</span><span class="ident" id="3271017">tr</span><br>
<span class="lineno"></span><span class="op" id="3271020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3271023">func</span>&nbsp;<span class="op" id="3271028">(</span><span class="ident" id="3271029">c</span>&nbsp;<span class="op" id="3271031">*</span><span class="ident" id="3271032">CommandNode</span><span class="op" id="3271043">)</span>&nbsp;<span class="ident" id="3271045">Copy</span><span class="op" id="3271049">(</span><span class="op" id="3271050">)</span>&nbsp;<span class="ident" id="3271052">Node</span>&nbsp;<span class="op" id="3271057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271060">if</span>&nbsp;<span class="ident" id="3271063">c</span>&nbsp;<span class="op" id="3271065">==</span>&nbsp;<span class="ident" id="3271068">nil</span>&nbsp;<span class="op" id="3271072">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271076">return</span>&nbsp;<span class="ident" id="3271083">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271089">n</span>&nbsp;<span class="op" id="3271091">:=</span>&nbsp;<span class="ident" id="3271094">c</span><span class="op" id="3271095">.</span><span class="ident" id="3271096">tr</span><span class="op" id="3271098">.</span><span class="ident" id="3271099">newCommand</span><span class="op" id="3271109">(</span><span class="ident" id="3271110">c</span><span class="op" id="3271111">.</span><span class="ident" id="3271112">Pos</span><span class="op" id="3271115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271118">for</span>&nbsp;<span class="ident" id="3271122">_</span><span class="op" id="3271123">,</span>&nbsp;<span class="ident" id="3271125">c</span>&nbsp;<span class="op" id="3271127">:=</span>&nbsp;<span class="keyword" id="3271130">range</span>&nbsp;<span class="ident" id="3271136">c</span><span class="op" id="3271137">.</span><span class="ident" id="3271138">Args</span>&nbsp;<span class="op" id="3271143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271147">n</span><span class="op" id="3271148">.</span><span class="builtinfunc" id="3271149">append</span><span class="op" id="3271155">(</span><span class="ident" id="3271156">c</span><span class="op" id="3271157">.</span><span class="ident" id="3271158">Copy</span><span class="op" id="3271162">(</span><span class="op" id="3271163">)</span><span class="op" id="3271164">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271170">return</span>&nbsp;<span class="ident" id="3271177">n</span><br>
<span class="lineno"></span><span class="op" id="3271179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3271182">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="3271221">type</span>&nbsp;<span class="ident" id="3271226">IdentifierNode</span>&nbsp;<span class="keyword" id="3271241">struct</span>&nbsp;<span class="op" id="3271248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271251">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271261">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271266">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3271272">*</span><span class="ident" id="3271273">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271279">Ident</span>&nbsp;<span class="builtintype" id="3271285">string</span>&nbsp;<span class="comment" id="3271292">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="3271318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3271321">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3271399">func</span>&nbsp;<span class="ident" id="3271404">NewIdentifier</span><span class="op" id="3271417">(</span><span class="ident" id="3271418">ident</span>&nbsp;<span class="builtintype" id="3271424">string</span><span class="op" id="3271430">)</span>&nbsp;<span class="op" id="3271432">*</span><span class="ident" id="3271433">IdentifierNode</span>&nbsp;<span class="op" id="3271448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271451">return</span>&nbsp;<span class="op" id="3271458">&amp;</span><span class="ident" id="3271459">IdentifierNode</span><span class="op" id="3271473">{</span><span class="ident" id="3271474">NodeType</span><span class="op" id="3271482">:</span>&nbsp;<span class="ident" id="3271484">NodeIdentifier</span><span class="op" id="3271498">,</span>&nbsp;<span class="ident" id="3271500">Ident</span><span class="op" id="3271505">:</span>&nbsp;<span class="ident" id="3271507">ident</span><span class="op" id="3271512">}</span><br>
<span class="lineno">290</span><span class="op" id="3271514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3271517">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3271613">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3271641">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="3271663">func</span>&nbsp;<span class="op" id="3271668">(</span><span class="ident" id="3271669">i</span>&nbsp;<span class="op" id="3271671">*</span><span class="ident" id="3271672">IdentifierNode</span><span class="op" id="3271686">)</span>&nbsp;<span class="ident" id="3271688">SetPos</span><span class="op" id="3271694">(</span><span class="ident" id="3271695">pos</span>&nbsp;<span class="ident" id="3271699">Pos</span><span class="op" id="3271702">)</span>&nbsp;<span class="op" id="3271704">*</span><span class="ident" id="3271705">IdentifierNode</span>&nbsp;<span class="op" id="3271720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271723">i</span><span class="op" id="3271724">.</span><span class="ident" id="3271725">Pos</span>&nbsp;<span class="op" id="3271729">=</span>&nbsp;<span class="ident" id="3271731">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271736">return</span>&nbsp;<span class="ident" id="3271743">i</span><br>
<span class="lineno"></span><span class="op" id="3271745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="3271748">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3271861">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3271889">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="3271911">func</span>&nbsp;<span class="op" id="3271916">(</span><span class="ident" id="3271917">i</span>&nbsp;<span class="op" id="3271919">*</span><span class="ident" id="3271920">IdentifierNode</span><span class="op" id="3271934">)</span>&nbsp;<span class="ident" id="3271936">SetTree</span><span class="op" id="3271943">(</span><span class="ident" id="3271944">t</span>&nbsp;<span class="op" id="3271946">*</span><span class="ident" id="3271947">Tree</span><span class="op" id="3271951">)</span>&nbsp;<span class="op" id="3271953">*</span><span class="ident" id="3271954">IdentifierNode</span>&nbsp;<span class="op" id="3271969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271972">i</span><span class="op" id="3271973">.</span><span class="ident" id="3271974">tr</span>&nbsp;<span class="op" id="3271977">=</span>&nbsp;<span class="ident" id="3271979">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271982">return</span>&nbsp;<span class="ident" id="3271989">i</span><br>
<span class="lineno"></span><span class="op" id="3271991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3271994">func</span>&nbsp;<span class="op" id="3271999">(</span><span class="ident" id="3272000">i</span>&nbsp;<span class="op" id="3272002">*</span><span class="ident" id="3272003">IdentifierNode</span><span class="op" id="3272017">)</span>&nbsp;<span class="ident" id="3272019">String</span><span class="op" id="3272025">(</span><span class="op" id="3272026">)</span>&nbsp;<span class="builtintype" id="3272028">string</span>&nbsp;<span class="op" id="3272035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272038">return</span>&nbsp;<span class="ident" id="3272045">i</span><span class="op" id="3272046">.</span><span class="ident" id="3272047">Ident</span><br>
<span class="lineno">310</span><span class="op" id="3272053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3272056">func</span>&nbsp;<span class="op" id="3272061">(</span><span class="ident" id="3272062">i</span>&nbsp;<span class="op" id="3272064">*</span><span class="ident" id="3272065">IdentifierNode</span><span class="op" id="3272079">)</span>&nbsp;<span class="ident" id="3272081">tree</span><span class="op" id="3272085">(</span><span class="op" id="3272086">)</span>&nbsp;<span class="op" id="3272088">*</span><span class="ident" id="3272089">Tree</span>&nbsp;<span class="op" id="3272094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272097">return</span>&nbsp;<span class="ident" id="3272104">i</span><span class="op" id="3272105">.</span><span class="ident" id="3272106">tr</span><br>
<span class="lineno"></span><span class="op" id="3272109">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3272112">func</span>&nbsp;<span class="op" id="3272117">(</span><span class="ident" id="3272118">i</span>&nbsp;<span class="op" id="3272120">*</span><span class="ident" id="3272121">IdentifierNode</span><span class="op" id="3272135">)</span>&nbsp;<span class="ident" id="3272137">Copy</span><span class="op" id="3272141">(</span><span class="op" id="3272142">)</span>&nbsp;<span class="ident" id="3272144">Node</span>&nbsp;<span class="op" id="3272149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272152">return</span>&nbsp;<span class="ident" id="3272159">NewIdentifier</span><span class="op" id="3272172">(</span><span class="ident" id="3272173">i</span><span class="op" id="3272174">.</span><span class="ident" id="3272175">Ident</span><span class="op" id="3272180">)</span><span class="op" id="3272181">.</span><span class="ident" id="3272182">SetTree</span><span class="op" id="3272189">(</span><span class="ident" id="3272190">i</span><span class="op" id="3272191">.</span><span class="ident" id="3272192">tr</span><span class="op" id="3272194">)</span><span class="op" id="3272195">.</span><span class="ident" id="3272196">SetPos</span><span class="op" id="3272202">(</span><span class="ident" id="3272203">i</span><span class="op" id="3272204">.</span><span class="ident" id="3272205">Pos</span><span class="op" id="3272208">)</span><br>
<span class="lineno"></span><span class="op" id="3272210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="3272213">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3272289">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3272347">type</span>&nbsp;<span class="ident" id="3272352">VariableNode</span>&nbsp;<span class="keyword" id="3272365">struct</span>&nbsp;<span class="op" id="3272372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272375">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272385">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272390">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272396">*</span><span class="ident" id="3272397">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272403">Ident</span>&nbsp;<span class="op" id="3272409">[</span><span class="op" id="3272410">]</span><span class="builtintype" id="3272411">string</span>&nbsp;<span class="comment" id="3272418">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3272464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3272467">func</span>&nbsp;<span class="op" id="3272472">(</span><span class="ident" id="3272473">t</span>&nbsp;<span class="op" id="3272475">*</span><span class="ident" id="3272476">Tree</span><span class="op" id="3272480">)</span>&nbsp;<span class="ident" id="3272482">newVariable</span><span class="op" id="3272493">(</span><span class="ident" id="3272494">pos</span>&nbsp;<span class="ident" id="3272498">Pos</span><span class="op" id="3272501">,</span>&nbsp;<span class="ident" id="3272503">ident</span>&nbsp;<span class="builtintype" id="3272509">string</span><span class="op" id="3272515">)</span>&nbsp;<span class="op" id="3272517">*</span><span class="ident" id="3272518">VariableNode</span>&nbsp;<span class="op" id="3272531">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272534">return</span>&nbsp;<span class="op" id="3272541">&amp;</span><span class="ident" id="3272542">VariableNode</span><span class="op" id="3272554">{</span><span class="ident" id="3272555">tr</span><span class="op" id="3272557">:</span>&nbsp;<span class="ident" id="3272559">t</span><span class="op" id="3272560">,</span>&nbsp;<span class="ident" id="3272562">NodeType</span><span class="op" id="3272570">:</span>&nbsp;<span class="ident" id="3272572">NodeVariable</span><span class="op" id="3272584">,</span>&nbsp;<span class="ident" id="3272586">Pos</span><span class="op" id="3272589">:</span>&nbsp;<span class="ident" id="3272591">pos</span><span class="op" id="3272594">,</span>&nbsp;<span class="ident" id="3272596">Ident</span><span class="op" id="3272601">:</span>&nbsp;<span class="ident" id="3272603">strings</span><span class="op" id="3272610">.</span><span class="ident" id="3272611">Split</span><span class="op" id="3272616">(</span><span class="ident" id="3272617">ident</span><span class="op" id="3272622">,</span>&nbsp;<span class="string" id="3272624">&#34;.&#34;</span><span class="op" id="3272627">)</span><span class="op" id="3272628">}</span><br>
<span class="lineno"></span><span class="op" id="3272630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3272633">func</span>&nbsp;<span class="op" id="3272638">(</span><span class="ident" id="3272639">v</span>&nbsp;<span class="op" id="3272641">*</span><span class="ident" id="3272642">VariableNode</span><span class="op" id="3272654">)</span>&nbsp;<span class="ident" id="3272656">String</span><span class="op" id="3272662">(</span><span class="op" id="3272663">)</span>&nbsp;<span class="builtintype" id="3272665">string</span>&nbsp;<span class="op" id="3272672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272675">s</span>&nbsp;<span class="op" id="3272677">:=</span>&nbsp;<span class="string" id="3272680">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272684">for</span>&nbsp;<span class="ident" id="3272688">i</span><span class="op" id="3272689">,</span>&nbsp;<span class="ident" id="3272691">id</span>&nbsp;<span class="op" id="3272694">:=</span>&nbsp;<span class="keyword" id="3272697">range</span>&nbsp;<span class="ident" id="3272703">v</span><span class="op" id="3272704">.</span><span class="ident" id="3272705">Ident</span>&nbsp;<span class="op" id="3272711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272715">if</span>&nbsp;<span class="ident" id="3272718">i</span>&nbsp;<span class="op" id="3272720">&gt;</span>&nbsp;<span class="num" id="3272722">0</span>&nbsp;<span class="op" id="3272724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272729">s</span>&nbsp;<span class="op" id="3272731">+=</span>&nbsp;<span class="string" id="3272734">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272744">s</span>&nbsp;<span class="op" id="3272746">+=</span>&nbsp;<span class="ident" id="3272749">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272756">return</span>&nbsp;<span class="ident" id="3272763">s</span><br>
<span class="lineno"></span><span class="op" id="3272765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3272768">func</span>&nbsp;<span class="op" id="3272773">(</span><span class="ident" id="3272774">v</span>&nbsp;<span class="op" id="3272776">*</span><span class="ident" id="3272777">VariableNode</span><span class="op" id="3272789">)</span>&nbsp;<span class="ident" id="3272791">tree</span><span class="op" id="3272795">(</span><span class="op" id="3272796">)</span>&nbsp;<span class="op" id="3272798">*</span><span class="ident" id="3272799">Tree</span>&nbsp;<span class="op" id="3272804">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272807">return</span>&nbsp;<span class="ident" id="3272814">v</span><span class="op" id="3272815">.</span><span class="ident" id="3272816">tr</span><br>
<span class="lineno"></span><span class="op" id="3272819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3272822">func</span>&nbsp;<span class="op" id="3272827">(</span><span class="ident" id="3272828">v</span>&nbsp;<span class="op" id="3272830">*</span><span class="ident" id="3272831">VariableNode</span><span class="op" id="3272843">)</span>&nbsp;<span class="ident" id="3272845">Copy</span><span class="op" id="3272849">(</span><span class="op" id="3272850">)</span>&nbsp;<span class="ident" id="3272852">Node</span>&nbsp;<span class="op" id="3272857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272860">return</span>&nbsp;<span class="op" id="3272867">&amp;</span><span class="ident" id="3272868">VariableNode</span><span class="op" id="3272880">{</span><span class="ident" id="3272881">tr</span><span class="op" id="3272883">:</span>&nbsp;<span class="ident" id="3272885">v</span><span class="op" id="3272886">.</span><span class="ident" id="3272887">tr</span><span class="op" id="3272889">,</span>&nbsp;<span class="ident" id="3272891">NodeType</span><span class="op" id="3272899">:</span>&nbsp;<span class="ident" id="3272901">NodeVariable</span><span class="op" id="3272913">,</span>&nbsp;<span class="ident" id="3272915">Pos</span><span class="op" id="3272918">:</span>&nbsp;<span class="ident" id="3272920">v</span><span class="op" id="3272921">.</span><span class="ident" id="3272922">Pos</span><span class="op" id="3272925">,</span>&nbsp;<span class="ident" id="3272927">Ident</span><span class="op" id="3272932">:</span>&nbsp;<span class="builtinfunc" id="3272934">append</span><span class="op" id="3272940">(</span><span class="op" id="3272941">[</span><span class="op" id="3272942">]</span><span class="builtintype" id="3272943">string</span><span class="op" id="3272949">{</span><span class="op" id="3272950">}</span><span class="op" id="3272951">,</span>&nbsp;<span class="ident" id="3272953">v</span><span class="op" id="3272954">.</span><span class="ident" id="3272955">Ident</span><span class="op" id="3272960">...</span><span class="op" id="3272963">)</span><span class="op" id="3272964">}</span><br>
<span class="lineno">350</span><span class="op" id="3272966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3272969">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="3273014">type</span>&nbsp;<span class="ident" id="3273019">DotNode</span>&nbsp;<span class="keyword" id="3273027">struct</span>&nbsp;<span class="op" id="3273034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273037">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273047">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273052">tr</span>&nbsp;<span class="op" id="3273055">*</span><span class="ident" id="3273056">Tree</span><br>
<span class="lineno"></span><span class="op" id="3273061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3273064">func</span>&nbsp;<span class="op" id="3273069">(</span><span class="ident" id="3273070">t</span>&nbsp;<span class="op" id="3273072">*</span><span class="ident" id="3273073">Tree</span><span class="op" id="3273077">)</span>&nbsp;<span class="ident" id="3273079">newDot</span><span class="op" id="3273085">(</span><span class="ident" id="3273086">pos</span>&nbsp;<span class="ident" id="3273090">Pos</span><span class="op" id="3273093">)</span>&nbsp;<span class="op" id="3273095">*</span><span class="ident" id="3273096">DotNode</span>&nbsp;<span class="op" id="3273104">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273107">return</span>&nbsp;<span class="op" id="3273114">&amp;</span><span class="ident" id="3273115">DotNode</span><span class="op" id="3273122">{</span><span class="ident" id="3273123">tr</span><span class="op" id="3273125">:</span>&nbsp;<span class="ident" id="3273127">t</span><span class="op" id="3273128">,</span>&nbsp;<span class="ident" id="3273130">NodeType</span><span class="op" id="3273138">:</span>&nbsp;<span class="ident" id="3273140">NodeDot</span><span class="op" id="3273147">,</span>&nbsp;<span class="ident" id="3273149">Pos</span><span class="op" id="3273152">:</span>&nbsp;<span class="ident" id="3273154">pos</span><span class="op" id="3273157">}</span><br>
<span class="lineno"></span><span class="op" id="3273159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3273162">func</span>&nbsp;<span class="op" id="3273167">(</span><span class="ident" id="3273168">d</span>&nbsp;<span class="op" id="3273170">*</span><span class="ident" id="3273171">DotNode</span><span class="op" id="3273178">)</span>&nbsp;<span class="ident" id="3273180">Type</span><span class="op" id="3273184">(</span><span class="op" id="3273185">)</span>&nbsp;<span class="ident" id="3273187">NodeType</span>&nbsp;<span class="op" id="3273196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273199">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273263">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273331">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273355">return</span>&nbsp;<span class="ident" id="3273362">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="3273370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="3273373">func</span>&nbsp;<span class="op" id="3273378">(</span><span class="ident" id="3273379">d</span>&nbsp;<span class="op" id="3273381">*</span><span class="ident" id="3273382">DotNode</span><span class="op" id="3273389">)</span>&nbsp;<span class="ident" id="3273391">String</span><span class="op" id="3273397">(</span><span class="op" id="3273398">)</span>&nbsp;<span class="builtintype" id="3273400">string</span>&nbsp;<span class="op" id="3273407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273410">return</span>&nbsp;<span class="string" id="3273417">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="3273421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3273424">func</span>&nbsp;<span class="op" id="3273429">(</span><span class="ident" id="3273430">d</span>&nbsp;<span class="op" id="3273432">*</span><span class="ident" id="3273433">DotNode</span><span class="op" id="3273440">)</span>&nbsp;<span class="ident" id="3273442">tree</span><span class="op" id="3273446">(</span><span class="op" id="3273447">)</span>&nbsp;<span class="op" id="3273449">*</span><span class="ident" id="3273450">Tree</span>&nbsp;<span class="op" id="3273455">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273458">return</span>&nbsp;<span class="ident" id="3273465">d</span><span class="op" id="3273466">.</span><span class="ident" id="3273467">tr</span><br>
<span class="lineno"></span><span class="op" id="3273470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3273473">func</span>&nbsp;<span class="op" id="3273478">(</span><span class="ident" id="3273479">d</span>&nbsp;<span class="op" id="3273481">*</span><span class="ident" id="3273482">DotNode</span><span class="op" id="3273489">)</span>&nbsp;<span class="ident" id="3273491">Copy</span><span class="op" id="3273495">(</span><span class="op" id="3273496">)</span>&nbsp;<span class="ident" id="3273498">Node</span>&nbsp;<span class="op" id="3273503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273506">return</span>&nbsp;<span class="ident" id="3273513">d</span><span class="op" id="3273514">.</span><span class="ident" id="3273515">tr</span><span class="op" id="3273517">.</span><span class="ident" id="3273518">newDot</span><span class="op" id="3273524">(</span><span class="ident" id="3273525">d</span><span class="op" id="3273526">.</span><span class="ident" id="3273527">Pos</span><span class="op" id="3273530">)</span><br>
<span class="lineno">380</span><span class="op" id="3273532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3273535">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3273619">type</span>&nbsp;<span class="ident" id="3273624">NilNode</span>&nbsp;<span class="keyword" id="3273632">struct</span>&nbsp;<span class="op" id="3273639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273642">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273652">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273657">tr</span>&nbsp;<span class="op" id="3273660">*</span><span class="ident" id="3273661">Tree</span><br>
<span class="lineno"></span><span class="op" id="3273666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3273669">func</span>&nbsp;<span class="op" id="3273674">(</span><span class="ident" id="3273675">t</span>&nbsp;<span class="op" id="3273677">*</span><span class="ident" id="3273678">Tree</span><span class="op" id="3273682">)</span>&nbsp;<span class="ident" id="3273684">newNil</span><span class="op" id="3273690">(</span><span class="ident" id="3273691">pos</span>&nbsp;<span class="ident" id="3273695">Pos</span><span class="op" id="3273698">)</span>&nbsp;<span class="op" id="3273700">*</span><span class="ident" id="3273701">NilNode</span>&nbsp;<span class="op" id="3273709">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273712">return</span>&nbsp;<span class="op" id="3273719">&amp;</span><span class="ident" id="3273720">NilNode</span><span class="op" id="3273727">{</span><span class="ident" id="3273728">tr</span><span class="op" id="3273730">:</span>&nbsp;<span class="ident" id="3273732">t</span><span class="op" id="3273733">,</span>&nbsp;<span class="ident" id="3273735">NodeType</span><span class="op" id="3273743">:</span>&nbsp;<span class="ident" id="3273745">NodeNil</span><span class="op" id="3273752">,</span>&nbsp;<span class="ident" id="3273754">Pos</span><span class="op" id="3273757">:</span>&nbsp;<span class="ident" id="3273759">pos</span><span class="op" id="3273762">}</span><br>
<span class="lineno"></span><span class="op" id="3273764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3273767">func</span>&nbsp;<span class="op" id="3273772">(</span><span class="ident" id="3273773">n</span>&nbsp;<span class="op" id="3273775">*</span><span class="ident" id="3273776">NilNode</span><span class="op" id="3273783">)</span>&nbsp;<span class="ident" id="3273785">Type</span><span class="op" id="3273789">(</span><span class="op" id="3273790">)</span>&nbsp;<span class="ident" id="3273792">NodeType</span>&nbsp;<span class="op" id="3273801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273804">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273868">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273936">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273960">return</span>&nbsp;<span class="ident" id="3273967">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="3273975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="3273978">func</span>&nbsp;<span class="op" id="3273983">(</span><span class="ident" id="3273984">n</span>&nbsp;<span class="op" id="3273986">*</span><span class="ident" id="3273987">NilNode</span><span class="op" id="3273994">)</span>&nbsp;<span class="ident" id="3273996">String</span><span class="op" id="3274002">(</span><span class="op" id="3274003">)</span>&nbsp;<span class="builtintype" id="3274005">string</span>&nbsp;<span class="op" id="3274012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274015">return</span>&nbsp;<span class="string" id="3274022">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="3274028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3274031">func</span>&nbsp;<span class="op" id="3274036">(</span><span class="ident" id="3274037">n</span>&nbsp;<span class="op" id="3274039">*</span><span class="ident" id="3274040">NilNode</span><span class="op" id="3274047">)</span>&nbsp;<span class="ident" id="3274049">tree</span><span class="op" id="3274053">(</span><span class="op" id="3274054">)</span>&nbsp;<span class="op" id="3274056">*</span><span class="ident" id="3274057">Tree</span>&nbsp;<span class="op" id="3274062">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274065">return</span>&nbsp;<span class="ident" id="3274072">n</span><span class="op" id="3274073">.</span><span class="ident" id="3274074">tr</span><br>
<span class="lineno"></span><span class="op" id="3274077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3274080">func</span>&nbsp;<span class="op" id="3274085">(</span><span class="ident" id="3274086">n</span>&nbsp;<span class="op" id="3274088">*</span><span class="ident" id="3274089">NilNode</span><span class="op" id="3274096">)</span>&nbsp;<span class="ident" id="3274098">Copy</span><span class="op" id="3274102">(</span><span class="op" id="3274103">)</span>&nbsp;<span class="ident" id="3274105">Node</span>&nbsp;<span class="op" id="3274110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274113">return</span>&nbsp;<span class="ident" id="3274120">n</span><span class="op" id="3274121">.</span><span class="ident" id="3274122">tr</span><span class="op" id="3274124">.</span><span class="ident" id="3274125">newNil</span><span class="op" id="3274131">(</span><span class="ident" id="3274132">n</span><span class="op" id="3274133">.</span><span class="ident" id="3274134">Pos</span><span class="op" id="3274137">)</span><br>
<span class="lineno">410</span><span class="op" id="3274139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3274142">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3274201">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3274239">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="3274281">type</span>&nbsp;<span class="ident" id="3274286">FieldNode</span>&nbsp;<span class="keyword" id="3274296">struct</span>&nbsp;<span class="op" id="3274303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274306">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274316">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274321">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3274327">*</span><span class="ident" id="3274328">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274334">Ident</span>&nbsp;<span class="op" id="3274340">[</span><span class="op" id="3274341">]</span><span class="builtintype" id="3274342">string</span>&nbsp;<span class="comment" id="3274349">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="3274386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3274389">func</span>&nbsp;<span class="op" id="3274394">(</span><span class="ident" id="3274395">t</span>&nbsp;<span class="op" id="3274397">*</span><span class="ident" id="3274398">Tree</span><span class="op" id="3274402">)</span>&nbsp;<span class="ident" id="3274404">newField</span><span class="op" id="3274412">(</span><span class="ident" id="3274413">pos</span>&nbsp;<span class="ident" id="3274417">Pos</span><span class="op" id="3274420">,</span>&nbsp;<span class="ident" id="3274422">ident</span>&nbsp;<span class="builtintype" id="3274428">string</span><span class="op" id="3274434">)</span>&nbsp;<span class="op" id="3274436">*</span><span class="ident" id="3274437">FieldNode</span>&nbsp;<span class="op" id="3274447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274450">return</span>&nbsp;<span class="op" id="3274457">&amp;</span><span class="ident" id="3274458">FieldNode</span><span class="op" id="3274467">{</span><span class="ident" id="3274468">tr</span><span class="op" id="3274470">:</span>&nbsp;<span class="ident" id="3274472">t</span><span class="op" id="3274473">,</span>&nbsp;<span class="ident" id="3274475">NodeType</span><span class="op" id="3274483">:</span>&nbsp;<span class="ident" id="3274485">NodeField</span><span class="op" id="3274494">,</span>&nbsp;<span class="ident" id="3274496">Pos</span><span class="op" id="3274499">:</span>&nbsp;<span class="ident" id="3274501">pos</span><span class="op" id="3274504">,</span>&nbsp;<span class="ident" id="3274506">Ident</span><span class="op" id="3274511">:</span>&nbsp;<span class="ident" id="3274513">strings</span><span class="op" id="3274520">.</span><span class="ident" id="3274521">Split</span><span class="op" id="3274526">(</span><span class="ident" id="3274527">ident</span><span class="op" id="3274532">[</span><span class="num" id="3274533">1</span><span class="op" id="3274534">:</span><span class="op" id="3274535">]</span><span class="op" id="3274536">,</span>&nbsp;<span class="string" id="3274538">&#34;.&#34;</span><span class="op" id="3274541">)</span><span class="op" id="3274542">}</span>&nbsp;<span class="comment" id="3274544">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="3274575">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="3274578">func</span>&nbsp;<span class="op" id="3274583">(</span><span class="ident" id="3274584">f</span>&nbsp;<span class="op" id="3274586">*</span><span class="ident" id="3274587">FieldNode</span><span class="op" id="3274596">)</span>&nbsp;<span class="ident" id="3274598">String</span><span class="op" id="3274604">(</span><span class="op" id="3274605">)</span>&nbsp;<span class="builtintype" id="3274607">string</span>&nbsp;<span class="op" id="3274614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274617">s</span>&nbsp;<span class="op" id="3274619">:=</span>&nbsp;<span class="string" id="3274622">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274626">for</span>&nbsp;<span class="ident" id="3274630">_</span><span class="op" id="3274631">,</span>&nbsp;<span class="ident" id="3274633">id</span>&nbsp;<span class="op" id="3274636">:=</span>&nbsp;<span class="keyword" id="3274639">range</span>&nbsp;<span class="ident" id="3274645">f</span><span class="op" id="3274646">.</span><span class="ident" id="3274647">Ident</span>&nbsp;<span class="op" id="3274653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274657">s</span>&nbsp;<span class="op" id="3274659">+=</span>&nbsp;<span class="string" id="3274662">&#34;.&#34;</span>&nbsp;<span class="op" id="3274666">+</span>&nbsp;<span class="ident" id="3274668">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274675">return</span>&nbsp;<span class="ident" id="3274682">s</span><br>
<span class="lineno"></span><span class="op" id="3274684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3274687">func</span>&nbsp;<span class="op" id="3274692">(</span><span class="ident" id="3274693">f</span>&nbsp;<span class="op" id="3274695">*</span><span class="ident" id="3274696">FieldNode</span><span class="op" id="3274705">)</span>&nbsp;<span class="ident" id="3274707">tree</span><span class="op" id="3274711">(</span><span class="op" id="3274712">)</span>&nbsp;<span class="op" id="3274714">*</span><span class="ident" id="3274715">Tree</span>&nbsp;<span class="op" id="3274720">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274723">return</span>&nbsp;<span class="ident" id="3274730">f</span><span class="op" id="3274731">.</span><span class="ident" id="3274732">tr</span><br>
<span class="lineno"></span><span class="op" id="3274735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3274738">func</span>&nbsp;<span class="op" id="3274743">(</span><span class="ident" id="3274744">f</span>&nbsp;<span class="op" id="3274746">*</span><span class="ident" id="3274747">FieldNode</span><span class="op" id="3274756">)</span>&nbsp;<span class="ident" id="3274758">Copy</span><span class="op" id="3274762">(</span><span class="op" id="3274763">)</span>&nbsp;<span class="ident" id="3274765">Node</span>&nbsp;<span class="op" id="3274770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274773">return</span>&nbsp;<span class="op" id="3274780">&amp;</span><span class="ident" id="3274781">FieldNode</span><span class="op" id="3274790">{</span><span class="ident" id="3274791">tr</span><span class="op" id="3274793">:</span>&nbsp;<span class="ident" id="3274795">f</span><span class="op" id="3274796">.</span><span class="ident" id="3274797">tr</span><span class="op" id="3274799">,</span>&nbsp;<span class="ident" id="3274801">NodeType</span><span class="op" id="3274809">:</span>&nbsp;<span class="ident" id="3274811">NodeField</span><span class="op" id="3274820">,</span>&nbsp;<span class="ident" id="3274822">Pos</span><span class="op" id="3274825">:</span>&nbsp;<span class="ident" id="3274827">f</span><span class="op" id="3274828">.</span><span class="ident" id="3274829">Pos</span><span class="op" id="3274832">,</span>&nbsp;<span class="ident" id="3274834">Ident</span><span class="op" id="3274839">:</span>&nbsp;<span class="builtinfunc" id="3274841">append</span><span class="op" id="3274847">(</span><span class="op" id="3274848">[</span><span class="op" id="3274849">]</span><span class="builtintype" id="3274850">string</span><span class="op" id="3274856">{</span><span class="op" id="3274857">}</span><span class="op" id="3274858">,</span>&nbsp;<span class="ident" id="3274860">f</span><span class="op" id="3274861">.</span><span class="ident" id="3274862">Ident</span><span class="op" id="3274867">...</span><span class="op" id="3274870">)</span><span class="op" id="3274871">}</span><br>
<span class="lineno">440</span><span class="op" id="3274873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3274876">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3274972">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3275010">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="3275054">type</span>&nbsp;<span class="ident" id="3275059">ChainNode</span>&nbsp;<span class="keyword" id="3275069">struct</span>&nbsp;<span class="op" id="3275076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275079">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275089">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275094">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3275100">*</span><span class="ident" id="3275101">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275107">Node</span>&nbsp;&nbsp;<span class="ident" id="3275113">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275119">Field</span>&nbsp;<span class="op" id="3275125">[</span><span class="op" id="3275126">]</span><span class="builtintype" id="3275127">string</span>&nbsp;<span class="comment" id="3275134">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3275171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3275174">func</span>&nbsp;<span class="op" id="3275179">(</span><span class="ident" id="3275180">t</span>&nbsp;<span class="op" id="3275182">*</span><span class="ident" id="3275183">Tree</span><span class="op" id="3275187">)</span>&nbsp;<span class="ident" id="3275189">newChain</span><span class="op" id="3275197">(</span><span class="ident" id="3275198">pos</span>&nbsp;<span class="ident" id="3275202">Pos</span><span class="op" id="3275205">,</span>&nbsp;<span class="ident" id="3275207">node</span>&nbsp;<span class="ident" id="3275212">Node</span><span class="op" id="3275216">)</span>&nbsp;<span class="op" id="3275218">*</span><span class="ident" id="3275219">ChainNode</span>&nbsp;<span class="op" id="3275229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275232">return</span>&nbsp;<span class="op" id="3275239">&amp;</span><span class="ident" id="3275240">ChainNode</span><span class="op" id="3275249">{</span><span class="ident" id="3275250">tr</span><span class="op" id="3275252">:</span>&nbsp;<span class="ident" id="3275254">t</span><span class="op" id="3275255">,</span>&nbsp;<span class="ident" id="3275257">NodeType</span><span class="op" id="3275265">:</span>&nbsp;<span class="ident" id="3275267">NodeChain</span><span class="op" id="3275276">,</span>&nbsp;<span class="ident" id="3275278">Pos</span><span class="op" id="3275281">:</span>&nbsp;<span class="ident" id="3275283">pos</span><span class="op" id="3275286">,</span>&nbsp;<span class="ident" id="3275288">Node</span><span class="op" id="3275292">:</span>&nbsp;<span class="ident" id="3275294">node</span><span class="op" id="3275298">}</span><br>
<span class="lineno">455</span><span class="op" id="3275300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3275303">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3275391">func</span>&nbsp;<span class="op" id="3275396">(</span><span class="ident" id="3275397">c</span>&nbsp;<span class="op" id="3275399">*</span><span class="ident" id="3275400">ChainNode</span><span class="op" id="3275409">)</span>&nbsp;<span class="ident" id="3275411">Add</span><span class="op" id="3275414">(</span><span class="ident" id="3275415">field</span>&nbsp;<span class="builtintype" id="3275421">string</span><span class="op" id="3275427">)</span>&nbsp;<span class="op" id="3275429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275432">if</span>&nbsp;<span class="builtinfunc" id="3275435">len</span><span class="op" id="3275438">(</span><span class="ident" id="3275439">field</span><span class="op" id="3275444">)</span>&nbsp;<span class="op" id="3275446">==</span>&nbsp;<span class="num" id="3275449">0</span>&nbsp;<span class="op" id="3275451">||</span>&nbsp;<span class="ident" id="3275454">field</span><span class="op" id="3275459">[</span><span class="num" id="3275460">0</span><span class="op" id="3275461">]</span>&nbsp;<span class="op" id="3275463">!=</span>&nbsp;<span class="string" id="3275466">&#39;.&#39;</span>&nbsp;<span class="op" id="3275470">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3275474">panic</span><span class="op" id="3275479">(</span><span class="string" id="3275480">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="3275497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275503">field</span>&nbsp;<span class="op" id="3275509">=</span>&nbsp;<span class="ident" id="3275511">field</span><span class="op" id="3275516">[</span><span class="num" id="3275517">1</span><span class="op" id="3275518">:</span><span class="op" id="3275519">]</span>&nbsp;<span class="comment" id="3275521">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275545">if</span>&nbsp;<span class="ident" id="3275548">field</span>&nbsp;<span class="op" id="3275554">==</span>&nbsp;<span class="string" id="3275557">&#34;&#34;</span>&nbsp;<span class="op" id="3275560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3275564">panic</span><span class="op" id="3275569">(</span><span class="string" id="3275570">&#34;empty&nbsp;field&#34;</span><span class="op" id="3275583">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275589">c</span><span class="op" id="3275590">.</span><span class="ident" id="3275591">Field</span>&nbsp;<span class="op" id="3275597">=</span>&nbsp;<span class="builtinfunc" id="3275599">append</span><span class="op" id="3275605">(</span><span class="ident" id="3275606">c</span><span class="op" id="3275607">.</span><span class="ident" id="3275608">Field</span><span class="op" id="3275613">,</span>&nbsp;<span class="ident" id="3275615">field</span><span class="op" id="3275620">)</span><br>
<span class="lineno"></span><span class="op" id="3275622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3275625">func</span>&nbsp;<span class="op" id="3275630">(</span><span class="ident" id="3275631">c</span>&nbsp;<span class="op" id="3275633">*</span><span class="ident" id="3275634">ChainNode</span><span class="op" id="3275643">)</span>&nbsp;<span class="ident" id="3275645">String</span><span class="op" id="3275651">(</span><span class="op" id="3275652">)</span>&nbsp;<span class="builtintype" id="3275654">string</span>&nbsp;<span class="op" id="3275661">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275664">s</span>&nbsp;<span class="op" id="3275666">:=</span>&nbsp;<span class="ident" id="3275669">c</span><span class="op" id="3275670">.</span><span class="ident" id="3275671">Node</span><span class="op" id="3275675">.</span><span class="ident" id="3275676">String</span><span class="op" id="3275682">(</span><span class="op" id="3275683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275686">if</span>&nbsp;<span class="ident" id="3275689">_</span><span class="op" id="3275690">,</span>&nbsp;<span class="ident" id="3275692">ok</span>&nbsp;<span class="op" id="3275695">:=</span>&nbsp;<span class="ident" id="3275698">c</span><span class="op" id="3275699">.</span><span class="ident" id="3275700">Node</span><span class="op" id="3275704">.</span><span class="op" id="3275705">(</span><span class="op" id="3275706">*</span><span class="ident" id="3275707">PipeNode</span><span class="op" id="3275715">)</span><span class="op" id="3275716">;</span>&nbsp;<span class="ident" id="3275718">ok</span>&nbsp;<span class="op" id="3275721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275725">s</span>&nbsp;<span class="op" id="3275727">=</span>&nbsp;<span class="string" id="3275729">&#34;(&#34;</span>&nbsp;<span class="op" id="3275733">+</span>&nbsp;<span class="ident" id="3275735">s</span>&nbsp;<span class="op" id="3275737">+</span>&nbsp;<span class="string" id="3275739">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275747">for</span>&nbsp;<span class="ident" id="3275751">_</span><span class="op" id="3275752">,</span>&nbsp;<span class="ident" id="3275754">field</span>&nbsp;<span class="op" id="3275760">:=</span>&nbsp;<span class="keyword" id="3275763">range</span>&nbsp;<span class="ident" id="3275769">c</span><span class="op" id="3275770">.</span><span class="ident" id="3275771">Field</span>&nbsp;<span class="op" id="3275777">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275781">s</span>&nbsp;<span class="op" id="3275783">+=</span>&nbsp;<span class="string" id="3275786">&#34;.&#34;</span>&nbsp;<span class="op" id="3275790">+</span>&nbsp;<span class="ident" id="3275792">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275802">return</span>&nbsp;<span class="ident" id="3275809">s</span><br>
<span class="lineno"></span><span class="op" id="3275811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="3275814">func</span>&nbsp;<span class="op" id="3275819">(</span><span class="ident" id="3275820">c</span>&nbsp;<span class="op" id="3275822">*</span><span class="ident" id="3275823">ChainNode</span><span class="op" id="3275832">)</span>&nbsp;<span class="ident" id="3275834">tree</span><span class="op" id="3275838">(</span><span class="op" id="3275839">)</span>&nbsp;<span class="op" id="3275841">*</span><span class="ident" id="3275842">Tree</span>&nbsp;<span class="op" id="3275847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275850">return</span>&nbsp;<span class="ident" id="3275857">c</span><span class="op" id="3275858">.</span><span class="ident" id="3275859">tr</span><br>
<span class="lineno"></span><span class="op" id="3275862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3275865">func</span>&nbsp;<span class="op" id="3275870">(</span><span class="ident" id="3275871">c</span>&nbsp;<span class="op" id="3275873">*</span><span class="ident" id="3275874">ChainNode</span><span class="op" id="3275883">)</span>&nbsp;<span class="ident" id="3275885">Copy</span><span class="op" id="3275889">(</span><span class="op" id="3275890">)</span>&nbsp;<span class="ident" id="3275892">Node</span>&nbsp;<span class="op" id="3275897">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275900">return</span>&nbsp;<span class="op" id="3275907">&amp;</span><span class="ident" id="3275908">ChainNode</span><span class="op" id="3275917">{</span><span class="ident" id="3275918">tr</span><span class="op" id="3275920">:</span>&nbsp;<span class="ident" id="3275922">c</span><span class="op" id="3275923">.</span><span class="ident" id="3275924">tr</span><span class="op" id="3275926">,</span>&nbsp;<span class="ident" id="3275928">NodeType</span><span class="op" id="3275936">:</span>&nbsp;<span class="ident" id="3275938">NodeChain</span><span class="op" id="3275947">,</span>&nbsp;<span class="ident" id="3275949">Pos</span><span class="op" id="3275952">:</span>&nbsp;<span class="ident" id="3275954">c</span><span class="op" id="3275955">.</span><span class="ident" id="3275956">Pos</span><span class="op" id="3275959">,</span>&nbsp;<span class="ident" id="3275961">Node</span><span class="op" id="3275965">:</span>&nbsp;<span class="ident" id="3275967">c</span><span class="op" id="3275968">.</span><span class="ident" id="3275969">Node</span><span class="op" id="3275973">,</span>&nbsp;<span class="ident" id="3275975">Field</span><span class="op" id="3275980">:</span>&nbsp;<span class="builtinfunc" id="3275982">append</span><span class="op" id="3275988">(</span><span class="op" id="3275989">[</span><span class="op" id="3275990">]</span><span class="builtintype" id="3275991">string</span><span class="op" id="3275997">{</span><span class="op" id="3275998">}</span><span class="op" id="3275999">,</span>&nbsp;<span class="ident" id="3276001">c</span><span class="op" id="3276002">.</span><span class="ident" id="3276003">Field</span><span class="op" id="3276008">...</span><span class="op" id="3276011">)</span><span class="op" id="3276012">}</span><br>
<span class="lineno"></span><span class="op" id="3276014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3276017">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3276055">type</span>&nbsp;<span class="ident" id="3276060">BoolNode</span>&nbsp;<span class="keyword" id="3276069">struct</span>&nbsp;<span class="op" id="3276076">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276079">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276089">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276094">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3276099">*</span><span class="ident" id="3276100">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276106">True</span>&nbsp;<span class="builtintype" id="3276111">bool</span>&nbsp;<span class="comment" id="3276116">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3276154">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="3276157">func</span>&nbsp;<span class="op" id="3276162">(</span><span class="ident" id="3276163">t</span>&nbsp;<span class="op" id="3276165">*</span><span class="ident" id="3276166">Tree</span><span class="op" id="3276170">)</span>&nbsp;<span class="ident" id="3276172">newBool</span><span class="op" id="3276179">(</span><span class="ident" id="3276180">pos</span>&nbsp;<span class="ident" id="3276184">Pos</span><span class="op" id="3276187">,</span>&nbsp;<span class="builtintype" id="3276189">true</span>&nbsp;<span class="builtintype" id="3276194">bool</span><span class="op" id="3276198">)</span>&nbsp;<span class="op" id="3276200">*</span><span class="ident" id="3276201">BoolNode</span>&nbsp;<span class="op" id="3276210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3276213">return</span>&nbsp;<span class="op" id="3276220">&amp;</span><span class="ident" id="3276221">BoolNode</span><span class="op" id="3276229">{</span><span class="ident" id="3276230">tr</span><span class="op" id="3276232">:</span>&nbsp;<span class="ident" id="3276234">t</span><span class="op" id="3276235">,</span>&nbsp;<span class="ident" id="3276237">NodeType</span><span class="op" id="3276245">:</span>&nbsp;<span class="ident" id="3276247">NodeBool</span><span class="op" id="3276255">,</span>&nbsp;<span class="ident" id="3276257">Pos</span><span class="op" id="3276260">:</span>&nbsp;<span class="ident" id="3276262">pos</span><span class="op" id="3276265">,</span>&nbsp;<span class="ident" id="3276267">True</span><span class="op" id="3276271">:</span>&nbsp;<span class="builtintype" id="3276273">true</span><span class="op" id="3276277">}</span><br>
<span class="lineno"></span><span class="op" id="3276279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="3276282">func</span>&nbsp;<span class="op" id="3276287">(</span><span class="ident" id="3276288">b</span>&nbsp;<span class="op" id="3276290">*</span><span class="ident" id="3276291">BoolNode</span><span class="op" id="3276299">)</span>&nbsp;<span class="ident" id="3276301">String</span><span class="op" id="3276307">(</span><span class="op" id="3276308">)</span>&nbsp;<span class="builtintype" id="3276310">string</span>&nbsp;<span class="op" id="3276317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3276320">if</span>&nbsp;<span class="ident" id="3276323">b</span><span class="op" id="3276324">.</span><span class="ident" id="3276325">True</span>&nbsp;<span class="op" id="3276330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3276334">return</span>&nbsp;<span class="string" id="3276341">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3276349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3276352">return</span>&nbsp;<span class="string" id="3276359">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="3276367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3276370">func</span>&nbsp;<span class="op" id="3276375">(</span><span class="ident" id="3276376">b</span>&nbsp;<span class="op" id="3276378">*</span><span class="ident" id="3276379">BoolNode</span><span class="op" id="3276387">)</span>&nbsp;<span class="ident" id="3276389">tree</span><span class="op" id="3276393">(</span><span class="op" id="3276394">)</span>&nbsp;<span class="op" id="3276396">*</span><span class="ident" id="3276397">Tree</span>&nbsp;<span class="op" id="3276402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3276405">return</span>&nbsp;<span class="ident" id="3276412">b</span><span class="op" id="3276413">.</span><span class="ident" id="3276414">tr</span><br>
<span class="lineno"></span><span class="op" id="3276417">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="3276420">func</span>&nbsp;<span class="op" id="3276425">(</span><span class="ident" id="3276426">b</span>&nbsp;<span class="op" id="3276428">*</span><span class="ident" id="3276429">BoolNode</span><span class="op" id="3276437">)</span>&nbsp;<span class="ident" id="3276439">Copy</span><span class="op" id="3276443">(</span><span class="op" id="3276444">)</span>&nbsp;<span class="ident" id="3276446">Node</span>&nbsp;<span class="op" id="3276451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3276454">return</span>&nbsp;<span class="ident" id="3276461">b</span><span class="op" id="3276462">.</span><span class="ident" id="3276463">tr</span><span class="op" id="3276465">.</span><span class="ident" id="3276466">newBool</span><span class="op" id="3276473">(</span><span class="ident" id="3276474">b</span><span class="op" id="3276475">.</span><span class="ident" id="3276476">Pos</span><span class="op" id="3276479">,</span>&nbsp;<span class="ident" id="3276481">b</span><span class="op" id="3276482">.</span><span class="ident" id="3276483">True</span><span class="op" id="3276487">)</span><br>
<span class="lineno"></span><span class="op" id="3276489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="3276492">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="3276569">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3276653">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3276735">type</span>&nbsp;<span class="ident" id="3276740">NumberNode</span>&nbsp;<span class="keyword" id="3276751">struct</span>&nbsp;<span class="op" id="3276758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276761">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276771">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276776">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3276787">*</span><span class="ident" id="3276788">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276794">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3276805">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3276816">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276850">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3276861">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3276872">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276915">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3276926">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3276937">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3276976">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="3276987">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3276998">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277021">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277032">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277043">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277073">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3277084">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277095">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277127">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3277138">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277149">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277179">Complex128</span>&nbsp;<span class="builtintype" id="3277190">complex128</span>&nbsp;<span class="comment" id="3277201">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277224">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3277235">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3277246">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="3277301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3277304">func</span>&nbsp;<span class="op" id="3277309">(</span><span class="ident" id="3277310">t</span>&nbsp;<span class="op" id="3277312">*</span><span class="ident" id="3277313">Tree</span><span class="op" id="3277317">)</span>&nbsp;<span class="ident" id="3277319">newNumber</span><span class="op" id="3277328">(</span><span class="ident" id="3277329">pos</span>&nbsp;<span class="ident" id="3277333">Pos</span><span class="op" id="3277336">,</span>&nbsp;<span class="ident" id="3277338">text</span>&nbsp;<span class="builtintype" id="3277343">string</span><span class="op" id="3277349">,</span>&nbsp;<span class="ident" id="3277351">typ</span>&nbsp;<span class="ident" id="3277355">itemType</span><span class="op" id="3277363">)</span>&nbsp;<span class="op" id="3277365">(</span><span class="op" id="3277366">*</span><span class="ident" id="3277367">NumberNode</span><span class="op" id="3277377">,</span>&nbsp;<span class="builtintype" id="3277379">error</span><span class="op" id="3277384">)</span>&nbsp;<span class="op" id="3277386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277389">n</span>&nbsp;<span class="op" id="3277391">:=</span>&nbsp;<span class="op" id="3277394">&amp;</span><span class="ident" id="3277395">NumberNode</span><span class="op" id="3277405">{</span><span class="ident" id="3277406">tr</span><span class="op" id="3277408">:</span>&nbsp;<span class="ident" id="3277410">t</span><span class="op" id="3277411">,</span>&nbsp;<span class="ident" id="3277413">NodeType</span><span class="op" id="3277421">:</span>&nbsp;<span class="ident" id="3277423">NodeNumber</span><span class="op" id="3277433">,</span>&nbsp;<span class="ident" id="3277435">Pos</span><span class="op" id="3277438">:</span>&nbsp;<span class="ident" id="3277440">pos</span><span class="op" id="3277443">,</span>&nbsp;<span class="ident" id="3277445">Text</span><span class="op" id="3277449">:</span>&nbsp;<span class="ident" id="3277451">text</span><span class="op" id="3277455">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277458">switch</span>&nbsp;<span class="ident" id="3277465">typ</span>&nbsp;<span class="op" id="3277469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277472">case</span>&nbsp;<span class="ident" id="3277477">itemCharConstant</span><span class="op" id="3277493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3277497">rune</span><span class="op" id="3277501">,</span>&nbsp;<span class="ident" id="3277503">_</span><span class="op" id="3277504">,</span>&nbsp;<span class="ident" id="3277506">tail</span><span class="op" id="3277510">,</span>&nbsp;<span class="ident" id="3277512">err</span>&nbsp;<span class="op" id="3277516">:=</span>&nbsp;<span class="ident" id="3277519">strconv</span><span class="op" id="3277526">.</span><span class="ident" id="3277527">UnquoteChar</span><span class="op" id="3277538">(</span><span class="ident" id="3277539">text</span><span class="op" id="3277543">[</span><span class="num" id="3277544">1</span><span class="op" id="3277545">:</span><span class="op" id="3277546">]</span><span class="op" id="3277547">,</span>&nbsp;<span class="ident" id="3277549">text</span><span class="op" id="3277553">[</span><span class="num" id="3277554">0</span><span class="op" id="3277555">]</span><span class="op" id="3277556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277560">if</span>&nbsp;<span class="ident" id="3277563">err</span>&nbsp;<span class="op" id="3277567">!=</span>&nbsp;<span class="ident" id="3277570">nil</span>&nbsp;<span class="op" id="3277574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277579">return</span>&nbsp;<span class="ident" id="3277586">nil</span><span class="op" id="3277589">,</span>&nbsp;<span class="ident" id="3277591">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3277597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277601">if</span>&nbsp;<span class="ident" id="3277604">tail</span>&nbsp;<span class="op" id="3277609">!=</span>&nbsp;<span class="string" id="3277612">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="3277616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277621">return</span>&nbsp;<span class="ident" id="3277628">nil</span><span class="op" id="3277631">,</span>&nbsp;<span class="ident" id="3277633">fmt</span><span class="op" id="3277636">.</span><span class="ident" id="3277637">Errorf</span><span class="op" id="3277643">(</span><span class="string" id="3277644">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="3277678">,</span>&nbsp;<span class="ident" id="3277680">text</span><span class="op" id="3277684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3277688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277692">n</span><span class="op" id="3277693">.</span><span class="ident" id="3277694">Int64</span>&nbsp;<span class="op" id="3277700">=</span>&nbsp;<span class="ident" id="3277702">int64</span><span class="op" id="3277707">(</span><span class="builtintype" id="3277708">rune</span><span class="op" id="3277712">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277716">n</span><span class="op" id="3277717">.</span><span class="ident" id="3277718">IsInt</span>&nbsp;<span class="op" id="3277724">=</span>&nbsp;<span class="builtintype" id="3277726">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277733">n</span><span class="op" id="3277734">.</span><span class="ident" id="3277735">Uint64</span>&nbsp;<span class="op" id="3277742">=</span>&nbsp;<span class="ident" id="3277744">uint64</span><span class="op" id="3277750">(</span><span class="builtintype" id="3277751">rune</span><span class="op" id="3277755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277759">n</span><span class="op" id="3277760">.</span><span class="ident" id="3277761">IsUint</span>&nbsp;<span class="op" id="3277768">=</span>&nbsp;<span class="builtintype" id="3277770">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277777">n</span><span class="op" id="3277778">.</span><span class="ident" id="3277779">Float64</span>&nbsp;<span class="op" id="3277787">=</span>&nbsp;<span class="builtintype" id="3277789">float64</span><span class="op" id="3277796">(</span><span class="builtintype" id="3277797">rune</span><span class="op" id="3277801">)</span>&nbsp;<span class="comment" id="3277803">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3277837">n</span><span class="op" id="3277838">.</span><span class="ident" id="3277839">IsFloat</span>&nbsp;<span class="op" id="3277847">=</span>&nbsp;<span class="builtintype" id="3277849">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277856">return</span>&nbsp;<span class="ident" id="3277863">n</span><span class="op" id="3277864">,</span>&nbsp;<span class="ident" id="3277866">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277871">case</span>&nbsp;<span class="ident" id="3277876">itemComplex</span><span class="op" id="3277887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3277891">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3277949">if</span>&nbsp;<span class="ident" id="3277952">_</span><span class="op" id="3277953">,</span>&nbsp;<span class="ident" id="3277955">err</span>&nbsp;<span class="op" id="3277959">:=</span>&nbsp;<span class="ident" id="3277962">fmt</span><span class="op" id="3277965">.</span><span class="ident" id="3277966">Sscan</span><span class="op" id="3277971">(</span><span class="ident" id="3277972">text</span><span class="op" id="3277976">,</span>&nbsp;<span class="op" id="3277978">&amp;</span><span class="ident" id="3277979">n</span><span class="op" id="3277980">.</span><span class="ident" id="3277981">Complex128</span><span class="op" id="3277991">)</span><span class="op" id="3277992">;</span>&nbsp;<span class="ident" id="3277994">err</span>&nbsp;<span class="op" id="3277998">!=</span>&nbsp;<span class="ident" id="3278001">nil</span>&nbsp;<span class="op" id="3278005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278010">return</span>&nbsp;<span class="ident" id="3278017">nil</span><span class="op" id="3278020">,</span>&nbsp;<span class="ident" id="3278022">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278032">n</span><span class="op" id="3278033">.</span><span class="ident" id="3278034">IsComplex</span>&nbsp;<span class="op" id="3278044">=</span>&nbsp;<span class="builtintype" id="3278046">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278053">n</span><span class="op" id="3278054">.</span><span class="ident" id="3278055">simplifyComplex</span><span class="op" id="3278070">(</span><span class="op" id="3278071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278075">return</span>&nbsp;<span class="ident" id="3278082">n</span><span class="op" id="3278083">,</span>&nbsp;<span class="ident" id="3278085">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278090">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3278093">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278159">if</span>&nbsp;<span class="builtinfunc" id="3278162">len</span><span class="op" id="3278165">(</span><span class="ident" id="3278166">text</span><span class="op" id="3278170">)</span>&nbsp;<span class="op" id="3278172">&gt;</span>&nbsp;<span class="num" id="3278174">0</span>&nbsp;<span class="op" id="3278176">&amp;&amp;</span>&nbsp;<span class="ident" id="3278179">text</span><span class="op" id="3278183">[</span><span class="builtinfunc" id="3278184">len</span><span class="op" id="3278187">(</span><span class="ident" id="3278188">text</span><span class="op" id="3278192">)</span><span class="op" id="3278193">-</span><span class="num" id="3278194">1</span><span class="op" id="3278195">]</span>&nbsp;<span class="op" id="3278197">==</span>&nbsp;<span class="string" id="3278200">&#39;i&#39;</span>&nbsp;<span class="op" id="3278204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278208">f</span><span class="op" id="3278209">,</span>&nbsp;<span class="ident" id="3278211">err</span>&nbsp;<span class="op" id="3278215">:=</span>&nbsp;<span class="ident" id="3278218">strconv</span><span class="op" id="3278225">.</span><span class="ident" id="3278226">ParseFloat</span><span class="op" id="3278236">(</span><span class="ident" id="3278237">text</span><span class="op" id="3278241">[</span><span class="op" id="3278242">:</span><span class="builtinfunc" id="3278243">len</span><span class="op" id="3278246">(</span><span class="ident" id="3278247">text</span><span class="op" id="3278251">)</span><span class="op" id="3278252">-</span><span class="num" id="3278253">1</span><span class="op" id="3278254">]</span><span class="op" id="3278255">,</span>&nbsp;<span class="num" id="3278257">64</span><span class="op" id="3278259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278263">if</span>&nbsp;<span class="ident" id="3278266">err</span>&nbsp;<span class="op" id="3278270">==</span>&nbsp;<span class="ident" id="3278273">nil</span>&nbsp;<span class="op" id="3278277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278282">n</span><span class="op" id="3278283">.</span><span class="ident" id="3278284">IsComplex</span>&nbsp;<span class="op" id="3278294">=</span>&nbsp;<span class="builtintype" id="3278296">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278304">n</span><span class="op" id="3278305">.</span><span class="ident" id="3278306">Complex128</span>&nbsp;<span class="op" id="3278317">=</span>&nbsp;<span class="builtinfunc" id="3278319">complex</span><span class="op" id="3278326">(</span><span class="num" id="3278327">0</span><span class="op" id="3278328">,</span>&nbsp;<span class="ident" id="3278330">f</span><span class="op" id="3278331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278336">n</span><span class="op" id="3278337">.</span><span class="ident" id="3278338">simplifyComplex</span><span class="op" id="3278353">(</span><span class="op" id="3278354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278359">return</span>&nbsp;<span class="ident" id="3278366">n</span><span class="op" id="3278367">,</span>&nbsp;<span class="ident" id="3278369">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278378">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3278381">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278428">u</span><span class="op" id="3278429">,</span>&nbsp;<span class="ident" id="3278431">err</span>&nbsp;<span class="op" id="3278435">:=</span>&nbsp;<span class="ident" id="3278438">strconv</span><span class="op" id="3278445">.</span><span class="ident" id="3278446">ParseUint</span><span class="op" id="3278455">(</span><span class="ident" id="3278456">text</span><span class="op" id="3278460">,</span>&nbsp;<span class="num" id="3278462">0</span><span class="op" id="3278463">,</span>&nbsp;<span class="num" id="3278465">64</span><span class="op" id="3278467">)</span>&nbsp;<span class="comment" id="3278469">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278504">if</span>&nbsp;<span class="ident" id="3278507">err</span>&nbsp;<span class="op" id="3278511">==</span>&nbsp;<span class="ident" id="3278514">nil</span>&nbsp;<span class="op" id="3278518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278522">n</span><span class="op" id="3278523">.</span><span class="ident" id="3278524">IsUint</span>&nbsp;<span class="op" id="3278531">=</span>&nbsp;<span class="builtintype" id="3278533">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278540">n</span><span class="op" id="3278541">.</span><span class="ident" id="3278542">Uint64</span>&nbsp;<span class="op" id="3278549">=</span>&nbsp;<span class="ident" id="3278551">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278557">i</span><span class="op" id="3278558">,</span>&nbsp;<span class="ident" id="3278560">err</span>&nbsp;<span class="op" id="3278564">:=</span>&nbsp;<span class="ident" id="3278567">strconv</span><span class="op" id="3278574">.</span><span class="ident" id="3278575">ParseInt</span><span class="op" id="3278583">(</span><span class="ident" id="3278584">text</span><span class="op" id="3278588">,</span>&nbsp;<span class="num" id="3278590">0</span><span class="op" id="3278591">,</span>&nbsp;<span class="num" id="3278593">64</span><span class="op" id="3278595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278598">if</span>&nbsp;<span class="ident" id="3278601">err</span>&nbsp;<span class="op" id="3278605">==</span>&nbsp;<span class="ident" id="3278608">nil</span>&nbsp;<span class="op" id="3278612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278616">n</span><span class="op" id="3278617">.</span><span class="ident" id="3278618">IsInt</span>&nbsp;<span class="op" id="3278624">=</span>&nbsp;<span class="builtintype" id="3278626">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278633">n</span><span class="op" id="3278634">.</span><span class="ident" id="3278635">Int64</span>&nbsp;<span class="op" id="3278641">=</span>&nbsp;<span class="ident" id="3278643">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278647">if</span>&nbsp;<span class="ident" id="3278650">i</span>&nbsp;<span class="op" id="3278652">==</span>&nbsp;<span class="num" id="3278655">0</span>&nbsp;<span class="op" id="3278657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278662">n</span><span class="op" id="3278663">.</span><span class="ident" id="3278664">IsUint</span>&nbsp;<span class="op" id="3278671">=</span>&nbsp;<span class="builtintype" id="3278673">true</span>&nbsp;<span class="comment" id="3278678">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278699">n</span><span class="op" id="3278700">.</span><span class="ident" id="3278701">Uint64</span>&nbsp;<span class="op" id="3278708">=</span>&nbsp;<span class="ident" id="3278710">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278717">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3278720">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278779">if</span>&nbsp;<span class="ident" id="3278782">n</span><span class="op" id="3278783">.</span><span class="ident" id="3278784">IsInt</span>&nbsp;<span class="op" id="3278790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278794">n</span><span class="op" id="3278795">.</span><span class="ident" id="3278796">IsFloat</span>&nbsp;<span class="op" id="3278804">=</span>&nbsp;<span class="builtintype" id="3278806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278813">n</span><span class="op" id="3278814">.</span><span class="ident" id="3278815">Float64</span>&nbsp;<span class="op" id="3278823">=</span>&nbsp;<span class="builtintype" id="3278825">float64</span><span class="op" id="3278832">(</span><span class="ident" id="3278833">n</span><span class="op" id="3278834">.</span><span class="ident" id="3278835">Int64</span><span class="op" id="3278840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278843">}</span>&nbsp;<span class="keyword" id="3278845">else</span>&nbsp;<span class="keyword" id="3278850">if</span>&nbsp;<span class="ident" id="3278853">n</span><span class="op" id="3278854">.</span><span class="ident" id="3278855">IsUint</span>&nbsp;<span class="op" id="3278862">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278866">n</span><span class="op" id="3278867">.</span><span class="ident" id="3278868">IsFloat</span>&nbsp;<span class="op" id="3278876">=</span>&nbsp;<span class="builtintype" id="3278878">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278885">n</span><span class="op" id="3278886">.</span><span class="ident" id="3278887">Float64</span>&nbsp;<span class="op" id="3278895">=</span>&nbsp;<span class="builtintype" id="3278897">float64</span><span class="op" id="3278904">(</span><span class="ident" id="3278905">n</span><span class="op" id="3278906">.</span><span class="ident" id="3278907">Uint64</span><span class="op" id="3278913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3278916">}</span>&nbsp;<span class="keyword" id="3278918">else</span>&nbsp;<span class="op" id="3278923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278927">f</span><span class="op" id="3278928">,</span>&nbsp;<span class="ident" id="3278930">err</span>&nbsp;<span class="op" id="3278934">:=</span>&nbsp;<span class="ident" id="3278937">strconv</span><span class="op" id="3278944">.</span><span class="ident" id="3278945">ParseFloat</span><span class="op" id="3278955">(</span><span class="ident" id="3278956">text</span><span class="op" id="3278960">,</span>&nbsp;<span class="num" id="3278962">64</span><span class="op" id="3278964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3278968">if</span>&nbsp;<span class="ident" id="3278971">err</span>&nbsp;<span class="op" id="3278975">==</span>&nbsp;<span class="ident" id="3278978">nil</span>&nbsp;<span class="op" id="3278982">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3278987">n</span><span class="op" id="3278988">.</span><span class="ident" id="3278989">IsFloat</span>&nbsp;<span class="op" id="3278997">=</span>&nbsp;<span class="builtintype" id="3278999">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279007">n</span><span class="op" id="3279008">.</span><span class="ident" id="3279009">Float64</span>&nbsp;<span class="op" id="3279017">=</span>&nbsp;<span class="ident" id="3279019">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3279024">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279099">if</span>&nbsp;<span class="op" id="3279102">!</span><span class="ident" id="3279103">n</span><span class="op" id="3279104">.</span><span class="ident" id="3279105">IsInt</span>&nbsp;<span class="op" id="3279111">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3279114">float64</span><span class="op" id="3279121">(</span><span class="ident" id="3279122">int64</span><span class="op" id="3279127">(</span><span class="ident" id="3279128">f</span><span class="op" id="3279129">)</span><span class="op" id="3279130">)</span>&nbsp;<span class="op" id="3279132">==</span>&nbsp;<span class="ident" id="3279135">f</span>&nbsp;<span class="op" id="3279137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279143">n</span><span class="op" id="3279144">.</span><span class="ident" id="3279145">IsInt</span>&nbsp;<span class="op" id="3279151">=</span>&nbsp;<span class="builtintype" id="3279153">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279162">n</span><span class="op" id="3279163">.</span><span class="ident" id="3279164">Int64</span>&nbsp;<span class="op" id="3279170">=</span>&nbsp;<span class="ident" id="3279172">int64</span><span class="op" id="3279177">(</span><span class="ident" id="3279178">f</span><span class="op" id="3279179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279189">if</span>&nbsp;<span class="op" id="3279192">!</span><span class="ident" id="3279193">n</span><span class="op" id="3279194">.</span><span class="ident" id="3279195">IsUint</span>&nbsp;<span class="op" id="3279202">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3279205">float64</span><span class="op" id="3279212">(</span><span class="ident" id="3279213">uint64</span><span class="op" id="3279219">(</span><span class="ident" id="3279220">f</span><span class="op" id="3279221">)</span><span class="op" id="3279222">)</span>&nbsp;<span class="op" id="3279224">==</span>&nbsp;<span class="ident" id="3279227">f</span>&nbsp;<span class="op" id="3279229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279235">n</span><span class="op" id="3279236">.</span><span class="ident" id="3279237">IsUint</span>&nbsp;<span class="op" id="3279244">=</span>&nbsp;<span class="builtintype" id="3279246">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279255">n</span><span class="op" id="3279256">.</span><span class="ident" id="3279257">Uint64</span>&nbsp;<span class="op" id="3279264">=</span>&nbsp;<span class="ident" id="3279266">uint64</span><span class="op" id="3279272">(</span><span class="ident" id="3279273">f</span><span class="op" id="3279274">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279289">if</span>&nbsp;<span class="op" id="3279292">!</span><span class="ident" id="3279293">n</span><span class="op" id="3279294">.</span><span class="ident" id="3279295">IsInt</span>&nbsp;<span class="op" id="3279301">&amp;&amp;</span>&nbsp;<span class="op" id="3279304">!</span><span class="ident" id="3279305">n</span><span class="op" id="3279306">.</span><span class="ident" id="3279307">IsUint</span>&nbsp;<span class="op" id="3279314">&amp;&amp;</span>&nbsp;<span class="op" id="3279317">!</span><span class="ident" id="3279318">n</span><span class="op" id="3279319">.</span><span class="ident" id="3279320">IsFloat</span>&nbsp;<span class="op" id="3279328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279332">return</span>&nbsp;<span class="ident" id="3279339">nil</span><span class="op" id="3279342">,</span>&nbsp;<span class="ident" id="3279344">fmt</span><span class="op" id="3279347">.</span><span class="ident" id="3279348">Errorf</span><span class="op" id="3279354">(</span><span class="string" id="3279355">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3279382">,</span>&nbsp;<span class="ident" id="3279384">text</span><span class="op" id="3279388">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279394">return</span>&nbsp;<span class="ident" id="3279401">n</span><span class="op" id="3279402">,</span>&nbsp;<span class="ident" id="3279404">nil</span><br>
<span class="lineno"></span><span class="op" id="3279408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3279411">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="3279500">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3279554">func</span>&nbsp;<span class="op" id="3279559">(</span><span class="ident" id="3279560">n</span>&nbsp;<span class="op" id="3279562">*</span><span class="ident" id="3279563">NumberNode</span><span class="op" id="3279573">)</span>&nbsp;<span class="ident" id="3279575">simplifyComplex</span><span class="op" id="3279590">(</span><span class="op" id="3279591">)</span>&nbsp;<span class="op" id="3279593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279596">n</span><span class="op" id="3279597">.</span><span class="ident" id="3279598">IsFloat</span>&nbsp;<span class="op" id="3279606">=</span>&nbsp;<span class="builtinfunc" id="3279608">imag</span><span class="op" id="3279612">(</span><span class="ident" id="3279613">n</span><span class="op" id="3279614">.</span><span class="ident" id="3279615">Complex128</span><span class="op" id="3279625">)</span>&nbsp;<span class="op" id="3279627">==</span>&nbsp;<span class="num" id="3279630">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279633">if</span>&nbsp;<span class="ident" id="3279636">n</span><span class="op" id="3279637">.</span><span class="ident" id="3279638">IsFloat</span>&nbsp;<span class="op" id="3279646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279650">n</span><span class="op" id="3279651">.</span><span class="ident" id="3279652">Float64</span>&nbsp;<span class="op" id="3279660">=</span>&nbsp;<span class="builtinfunc" id="3279662">real</span><span class="op" id="3279666">(</span><span class="ident" id="3279667">n</span><span class="op" id="3279668">.</span><span class="ident" id="3279669">Complex128</span><span class="op" id="3279679">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279683">n</span><span class="op" id="3279684">.</span><span class="ident" id="3279685">IsInt</span>&nbsp;<span class="op" id="3279691">=</span>&nbsp;<span class="builtintype" id="3279693">float64</span><span class="op" id="3279700">(</span><span class="ident" id="3279701">int64</span><span class="op" id="3279706">(</span><span class="ident" id="3279707">n</span><span class="op" id="3279708">.</span><span class="ident" id="3279709">Float64</span><span class="op" id="3279716">)</span><span class="op" id="3279717">)</span>&nbsp;<span class="op" id="3279719">==</span>&nbsp;<span class="ident" id="3279722">n</span><span class="op" id="3279723">.</span><span class="ident" id="3279724">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279734">if</span>&nbsp;<span class="ident" id="3279737">n</span><span class="op" id="3279738">.</span><span class="ident" id="3279739">IsInt</span>&nbsp;<span class="op" id="3279745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279750">n</span><span class="op" id="3279751">.</span><span class="ident" id="3279752">Int64</span>&nbsp;<span class="op" id="3279758">=</span>&nbsp;<span class="ident" id="3279760">int64</span><span class="op" id="3279765">(</span><span class="ident" id="3279766">n</span><span class="op" id="3279767">.</span><span class="ident" id="3279768">Float64</span><span class="op" id="3279775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279783">n</span><span class="op" id="3279784">.</span><span class="ident" id="3279785">IsUint</span>&nbsp;<span class="op" id="3279792">=</span>&nbsp;<span class="builtintype" id="3279794">float64</span><span class="op" id="3279801">(</span><span class="ident" id="3279802">uint64</span><span class="op" id="3279808">(</span><span class="ident" id="3279809">n</span><span class="op" id="3279810">.</span><span class="ident" id="3279811">Float64</span><span class="op" id="3279818">)</span><span class="op" id="3279819">)</span>&nbsp;<span class="op" id="3279821">==</span>&nbsp;<span class="ident" id="3279824">n</span><span class="op" id="3279825">.</span><span class="ident" id="3279826">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279836">if</span>&nbsp;<span class="ident" id="3279839">n</span><span class="op" id="3279840">.</span><span class="ident" id="3279841">IsUint</span>&nbsp;<span class="op" id="3279848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3279853">n</span><span class="op" id="3279854">.</span><span class="ident" id="3279855">Uint64</span>&nbsp;<span class="op" id="3279862">=</span>&nbsp;<span class="ident" id="3279864">uint64</span><span class="op" id="3279870">(</span><span class="ident" id="3279871">n</span><span class="op" id="3279872">.</span><span class="ident" id="3279873">Float64</span><span class="op" id="3279880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3279887">}</span><br>
<span class="lineno"></span><span class="op" id="3279889">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="3279892">func</span>&nbsp;<span class="op" id="3279897">(</span><span class="ident" id="3279898">n</span>&nbsp;<span class="op" id="3279900">*</span><span class="ident" id="3279901">NumberNode</span><span class="op" id="3279911">)</span>&nbsp;<span class="ident" id="3279913">String</span><span class="op" id="3279919">(</span><span class="op" id="3279920">)</span>&nbsp;<span class="builtintype" id="3279922">string</span>&nbsp;<span class="op" id="3279929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279932">return</span>&nbsp;<span class="ident" id="3279939">n</span><span class="op" id="3279940">.</span><span class="ident" id="3279941">Text</span><br>
<span class="lineno"></span><span class="op" id="3279946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="3279949">func</span>&nbsp;<span class="op" id="3279954">(</span><span class="ident" id="3279955">n</span>&nbsp;<span class="op" id="3279957">*</span><span class="ident" id="3279958">NumberNode</span><span class="op" id="3279968">)</span>&nbsp;<span class="ident" id="3279970">tree</span><span class="op" id="3279974">(</span><span class="op" id="3279975">)</span>&nbsp;<span class="op" id="3279977">*</span><span class="ident" id="3279978">Tree</span>&nbsp;<span class="op" id="3279983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3279986">return</span>&nbsp;<span class="ident" id="3279993">n</span><span class="op" id="3279994">.</span><span class="ident" id="3279995">tr</span><br>
<span class="lineno"></span><span class="op" id="3279998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280001">func</span>&nbsp;<span class="op" id="3280006">(</span><span class="ident" id="3280007">n</span>&nbsp;<span class="op" id="3280009">*</span><span class="ident" id="3280010">NumberNode</span><span class="op" id="3280020">)</span>&nbsp;<span class="ident" id="3280022">Copy</span><span class="op" id="3280026">(</span><span class="op" id="3280027">)</span>&nbsp;<span class="ident" id="3280029">Node</span>&nbsp;<span class="op" id="3280034">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280037">nn</span>&nbsp;<span class="op" id="3280040">:=</span>&nbsp;<span class="builtinfunc" id="3280043">new</span><span class="op" id="3280046">(</span><span class="ident" id="3280047">NumberNode</span><span class="op" id="3280057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3280060">*</span><span class="ident" id="3280061">nn</span>&nbsp;<span class="op" id="3280064">=</span>&nbsp;<span class="op" id="3280066">*</span><span class="ident" id="3280067">n</span>&nbsp;<span class="comment" id="3280069">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280094">return</span>&nbsp;<span class="ident" id="3280101">nn</span><br>
<span class="lineno"></span><span class="op" id="3280104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="3280107">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3280177">type</span>&nbsp;<span class="ident" id="3280182">StringNode</span>&nbsp;<span class="keyword" id="3280193">struct</span>&nbsp;<span class="op" id="3280200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280203">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280213">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280218">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3280225">*</span><span class="ident" id="3280226">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280232">Quoted</span>&nbsp;<span class="builtintype" id="3280239">string</span>&nbsp;<span class="comment" id="3280246">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280296">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3280303">string</span>&nbsp;<span class="comment" id="3280310">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="3280349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280352">func</span>&nbsp;<span class="op" id="3280357">(</span><span class="ident" id="3280358">t</span>&nbsp;<span class="op" id="3280360">*</span><span class="ident" id="3280361">Tree</span><span class="op" id="3280365">)</span>&nbsp;<span class="ident" id="3280367">newString</span><span class="op" id="3280376">(</span><span class="ident" id="3280377">pos</span>&nbsp;<span class="ident" id="3280381">Pos</span><span class="op" id="3280384">,</span>&nbsp;<span class="ident" id="3280386">orig</span><span class="op" id="3280390">,</span>&nbsp;<span class="ident" id="3280392">text</span>&nbsp;<span class="builtintype" id="3280397">string</span><span class="op" id="3280403">)</span>&nbsp;<span class="op" id="3280405">*</span><span class="ident" id="3280406">StringNode</span>&nbsp;<span class="op" id="3280417">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280420">return</span>&nbsp;<span class="op" id="3280427">&amp;</span><span class="ident" id="3280428">StringNode</span><span class="op" id="3280438">{</span><span class="ident" id="3280439">tr</span><span class="op" id="3280441">:</span>&nbsp;<span class="ident" id="3280443">t</span><span class="op" id="3280444">,</span>&nbsp;<span class="ident" id="3280446">NodeType</span><span class="op" id="3280454">:</span>&nbsp;<span class="ident" id="3280456">NodeString</span><span class="op" id="3280466">,</span>&nbsp;<span class="ident" id="3280468">Pos</span><span class="op" id="3280471">:</span>&nbsp;<span class="ident" id="3280473">pos</span><span class="op" id="3280476">,</span>&nbsp;<span class="ident" id="3280478">Quoted</span><span class="op" id="3280484">:</span>&nbsp;<span class="ident" id="3280486">orig</span><span class="op" id="3280490">,</span>&nbsp;<span class="ident" id="3280492">Text</span><span class="op" id="3280496">:</span>&nbsp;<span class="ident" id="3280498">text</span><span class="op" id="3280502">}</span><br>
<span class="lineno"></span><span class="op" id="3280504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280507">func</span>&nbsp;<span class="op" id="3280512">(</span><span class="ident" id="3280513">s</span>&nbsp;<span class="op" id="3280515">*</span><span class="ident" id="3280516">StringNode</span><span class="op" id="3280526">)</span>&nbsp;<span class="ident" id="3280528">String</span><span class="op" id="3280534">(</span><span class="op" id="3280535">)</span>&nbsp;<span class="builtintype" id="3280537">string</span>&nbsp;<span class="op" id="3280544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280547">return</span>&nbsp;<span class="ident" id="3280554">s</span><span class="op" id="3280555">.</span><span class="ident" id="3280556">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="3280563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280566">func</span>&nbsp;<span class="op" id="3280571">(</span><span class="ident" id="3280572">s</span>&nbsp;<span class="op" id="3280574">*</span><span class="ident" id="3280575">StringNode</span><span class="op" id="3280585">)</span>&nbsp;<span class="ident" id="3280587">tree</span><span class="op" id="3280591">(</span><span class="op" id="3280592">)</span>&nbsp;<span class="op" id="3280594">*</span><span class="ident" id="3280595">Tree</span>&nbsp;<span class="op" id="3280600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280603">return</span>&nbsp;<span class="ident" id="3280610">s</span><span class="op" id="3280611">.</span><span class="ident" id="3280612">tr</span><br>
<span class="lineno"></span><span class="op" id="3280615">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="3280618">func</span>&nbsp;<span class="op" id="3280623">(</span><span class="ident" id="3280624">s</span>&nbsp;<span class="op" id="3280626">*</span><span class="ident" id="3280627">StringNode</span><span class="op" id="3280637">)</span>&nbsp;<span class="ident" id="3280639">Copy</span><span class="op" id="3280643">(</span><span class="op" id="3280644">)</span>&nbsp;<span class="ident" id="3280646">Node</span>&nbsp;<span class="op" id="3280651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280654">return</span>&nbsp;<span class="ident" id="3280661">s</span><span class="op" id="3280662">.</span><span class="ident" id="3280663">tr</span><span class="op" id="3280665">.</span><span class="ident" id="3280666">newString</span><span class="op" id="3280675">(</span><span class="ident" id="3280676">s</span><span class="op" id="3280677">.</span><span class="ident" id="3280678">Pos</span><span class="op" id="3280681">,</span>&nbsp;<span class="ident" id="3280683">s</span><span class="op" id="3280684">.</span><span class="ident" id="3280685">Quoted</span><span class="op" id="3280691">,</span>&nbsp;<span class="ident" id="3280693">s</span><span class="op" id="3280694">.</span><span class="ident" id="3280695">Text</span><span class="op" id="3280699">)</span><br>
<span class="lineno"></span><span class="op" id="3280701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="3280704">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="3280745">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="3280792">type</span>&nbsp;<span class="ident" id="3280797">endNode</span>&nbsp;<span class="keyword" id="3280805">struct</span>&nbsp;<span class="op" id="3280812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280815">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280825">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3280830">tr</span>&nbsp;<span class="op" id="3280833">*</span><span class="ident" id="3280834">Tree</span><br>
<span class="lineno"></span><span class="op" id="3280839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280842">func</span>&nbsp;<span class="op" id="3280847">(</span><span class="ident" id="3280848">t</span>&nbsp;<span class="op" id="3280850">*</span><span class="ident" id="3280851">Tree</span><span class="op" id="3280855">)</span>&nbsp;<span class="ident" id="3280857">newEnd</span><span class="op" id="3280863">(</span><span class="ident" id="3280864">pos</span>&nbsp;<span class="ident" id="3280868">Pos</span><span class="op" id="3280871">)</span>&nbsp;<span class="op" id="3280873">*</span><span class="ident" id="3280874">endNode</span>&nbsp;<span class="op" id="3280882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280885">return</span>&nbsp;<span class="op" id="3280892">&amp;</span><span class="ident" id="3280893">endNode</span><span class="op" id="3280900">{</span><span class="ident" id="3280901">tr</span><span class="op" id="3280903">:</span>&nbsp;<span class="ident" id="3280905">t</span><span class="op" id="3280906">,</span>&nbsp;<span class="ident" id="3280908">NodeType</span><span class="op" id="3280916">:</span>&nbsp;<span class="ident" id="3280918">nodeEnd</span><span class="op" id="3280925">,</span>&nbsp;<span class="ident" id="3280927">Pos</span><span class="op" id="3280930">:</span>&nbsp;<span class="ident" id="3280932">pos</span><span class="op" id="3280935">}</span><br>
<span class="lineno">680</span><span class="op" id="3280937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3280940">func</span>&nbsp;<span class="op" id="3280945">(</span><span class="ident" id="3280946">e</span>&nbsp;<span class="op" id="3280948">*</span><span class="ident" id="3280949">endNode</span><span class="op" id="3280956">)</span>&nbsp;<span class="ident" id="3280958">String</span><span class="op" id="3280964">(</span><span class="op" id="3280965">)</span>&nbsp;<span class="builtintype" id="3280967">string</span>&nbsp;<span class="op" id="3280974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3280977">return</span>&nbsp;<span class="string" id="3280984">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3280994">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3280997">func</span>&nbsp;<span class="op" id="3281002">(</span><span class="ident" id="3281003">e</span>&nbsp;<span class="op" id="3281005">*</span><span class="ident" id="3281006">endNode</span><span class="op" id="3281013">)</span>&nbsp;<span class="ident" id="3281015">tree</span><span class="op" id="3281019">(</span><span class="op" id="3281020">)</span>&nbsp;<span class="op" id="3281022">*</span><span class="ident" id="3281023">Tree</span>&nbsp;<span class="op" id="3281028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281031">return</span>&nbsp;<span class="ident" id="3281038">e</span><span class="op" id="3281039">.</span><span class="ident" id="3281040">tr</span><br>
<span class="lineno"></span><span class="op" id="3281043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="3281046">func</span>&nbsp;<span class="op" id="3281051">(</span><span class="ident" id="3281052">e</span>&nbsp;<span class="op" id="3281054">*</span><span class="ident" id="3281055">endNode</span><span class="op" id="3281062">)</span>&nbsp;<span class="ident" id="3281064">Copy</span><span class="op" id="3281068">(</span><span class="op" id="3281069">)</span>&nbsp;<span class="ident" id="3281071">Node</span>&nbsp;<span class="op" id="3281076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281079">return</span>&nbsp;<span class="ident" id="3281086">e</span><span class="op" id="3281087">.</span><span class="ident" id="3281088">tr</span><span class="op" id="3281090">.</span><span class="ident" id="3281091">newEnd</span><span class="op" id="3281097">(</span><span class="ident" id="3281098">e</span><span class="op" id="3281099">.</span><span class="ident" id="3281100">Pos</span><span class="op" id="3281103">)</span><br>
<span class="lineno"></span><span class="op" id="3281105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3281108">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="3281186">type</span>&nbsp;<span class="ident" id="3281191">elseNode</span>&nbsp;<span class="keyword" id="3281200">struct</span>&nbsp;<span class="op" id="3281207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281210">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281220">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281225">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3281230">*</span><span class="ident" id="3281231">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281237">Line</span>&nbsp;<span class="builtintype" id="3281242">int</span>&nbsp;<span class="comment" id="3281246">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="3281315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281318">func</span>&nbsp;<span class="op" id="3281323">(</span><span class="ident" id="3281324">t</span>&nbsp;<span class="op" id="3281326">*</span><span class="ident" id="3281327">Tree</span><span class="op" id="3281331">)</span>&nbsp;<span class="ident" id="3281333">newElse</span><span class="op" id="3281340">(</span><span class="ident" id="3281341">pos</span>&nbsp;<span class="ident" id="3281345">Pos</span><span class="op" id="3281348">,</span>&nbsp;<span class="ident" id="3281350">line</span>&nbsp;<span class="builtintype" id="3281355">int</span><span class="op" id="3281358">)</span>&nbsp;<span class="op" id="3281360">*</span><span class="ident" id="3281361">elseNode</span>&nbsp;<span class="op" id="3281370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281373">return</span>&nbsp;<span class="op" id="3281380">&amp;</span><span class="ident" id="3281381">elseNode</span><span class="op" id="3281389">{</span><span class="ident" id="3281390">tr</span><span class="op" id="3281392">:</span>&nbsp;<span class="ident" id="3281394">t</span><span class="op" id="3281395">,</span>&nbsp;<span class="ident" id="3281397">NodeType</span><span class="op" id="3281405">:</span>&nbsp;<span class="ident" id="3281407">nodeElse</span><span class="op" id="3281415">,</span>&nbsp;<span class="ident" id="3281417">Pos</span><span class="op" id="3281420">:</span>&nbsp;<span class="ident" id="3281422">pos</span><span class="op" id="3281425">,</span>&nbsp;<span class="ident" id="3281427">Line</span><span class="op" id="3281431">:</span>&nbsp;<span class="ident" id="3281433">line</span><span class="op" id="3281437">}</span><br>
<span class="lineno"></span><span class="op" id="3281439">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="3281442">func</span>&nbsp;<span class="op" id="3281447">(</span><span class="ident" id="3281448">e</span>&nbsp;<span class="op" id="3281450">*</span><span class="ident" id="3281451">elseNode</span><span class="op" id="3281459">)</span>&nbsp;<span class="ident" id="3281461">Type</span><span class="op" id="3281465">(</span><span class="op" id="3281466">)</span>&nbsp;<span class="ident" id="3281468">NodeType</span>&nbsp;<span class="op" id="3281477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281480">return</span>&nbsp;<span class="ident" id="3281487">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="3281496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="3281499">func</span>&nbsp;<span class="op" id="3281504">(</span><span class="ident" id="3281505">e</span>&nbsp;<span class="op" id="3281507">*</span><span class="ident" id="3281508">elseNode</span><span class="op" id="3281516">)</span>&nbsp;<span class="ident" id="3281518">String</span><span class="op" id="3281524">(</span><span class="op" id="3281525">)</span>&nbsp;<span class="builtintype" id="3281527">string</span>&nbsp;<span class="op" id="3281534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281537">return</span>&nbsp;<span class="string" id="3281544">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3281555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281558">func</span>&nbsp;<span class="op" id="3281563">(</span><span class="ident" id="3281564">e</span>&nbsp;<span class="op" id="3281566">*</span><span class="ident" id="3281567">elseNode</span><span class="op" id="3281575">)</span>&nbsp;<span class="ident" id="3281577">tree</span><span class="op" id="3281581">(</span><span class="op" id="3281582">)</span>&nbsp;<span class="op" id="3281584">*</span><span class="ident" id="3281585">Tree</span>&nbsp;<span class="op" id="3281590">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281593">return</span>&nbsp;<span class="ident" id="3281600">e</span><span class="op" id="3281601">.</span><span class="ident" id="3281602">tr</span><br>
<span class="lineno"></span><span class="op" id="3281605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3281608">func</span>&nbsp;<span class="op" id="3281613">(</span><span class="ident" id="3281614">e</span>&nbsp;<span class="op" id="3281616">*</span><span class="ident" id="3281617">elseNode</span><span class="op" id="3281625">)</span>&nbsp;<span class="ident" id="3281627">Copy</span><span class="op" id="3281631">(</span><span class="op" id="3281632">)</span>&nbsp;<span class="ident" id="3281634">Node</span>&nbsp;<span class="op" id="3281639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3281642">return</span>&nbsp;<span class="ident" id="3281649">e</span><span class="op" id="3281650">.</span><span class="ident" id="3281651">tr</span><span class="op" id="3281653">.</span><span class="ident" id="3281654">newElse</span><span class="op" id="3281661">(</span><span class="ident" id="3281662">e</span><span class="op" id="3281663">.</span><span class="ident" id="3281664">Pos</span><span class="op" id="3281667">,</span>&nbsp;<span class="ident" id="3281669">e</span><span class="op" id="3281670">.</span><span class="ident" id="3281671">Line</span><span class="op" id="3281675">)</span><br>
<span class="lineno">720</span><span class="op" id="3281677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3281680">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="3281747">type</span>&nbsp;<span class="ident" id="3281752">BranchNode</span>&nbsp;<span class="keyword" id="3281763">struct</span>&nbsp;<span class="op" id="3281770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281773">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281783">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281788">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281797">*</span><span class="ident" id="3281798">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281804">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3281813">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3281823">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281893">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281902">*</span><span class="ident" id="3281903">PipeNode</span>&nbsp;<span class="comment" id="3281912">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3281946">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3281955">*</span><span class="ident" id="3281956">ListNode</span>&nbsp;<span class="comment" id="3281965">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282012">ElseList</span>&nbsp;<span class="op" id="3282021">*</span><span class="ident" id="3282022">ListNode</span>&nbsp;<span class="comment" id="3282031">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="3282089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3282092">func</span>&nbsp;<span class="op" id="3282097">(</span><span class="ident" id="3282098">b</span>&nbsp;<span class="op" id="3282100">*</span><span class="ident" id="3282101">BranchNode</span><span class="op" id="3282111">)</span>&nbsp;<span class="ident" id="3282113">String</span><span class="op" id="3282119">(</span><span class="op" id="3282120">)</span>&nbsp;<span class="builtintype" id="3282122">string</span>&nbsp;<span class="op" id="3282129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282132">name</span>&nbsp;<span class="op" id="3282137">:=</span>&nbsp;<span class="string" id="3282140">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282144">switch</span>&nbsp;<span class="ident" id="3282151">b</span><span class="op" id="3282152">.</span><span class="ident" id="3282153">NodeType</span>&nbsp;<span class="op" id="3282162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282165">case</span>&nbsp;<span class="ident" id="3282170">NodeIf</span><span class="op" id="3282176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282180">name</span>&nbsp;<span class="op" id="3282185">=</span>&nbsp;<span class="string" id="3282187">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282193">case</span>&nbsp;<span class="ident" id="3282198">NodeRange</span><span class="op" id="3282207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282211">name</span>&nbsp;<span class="op" id="3282216">=</span>&nbsp;<span class="string" id="3282218">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282227">case</span>&nbsp;<span class="ident" id="3282232">NodeWith</span><span class="op" id="3282240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282244">name</span>&nbsp;<span class="op" id="3282249">=</span>&nbsp;<span class="string" id="3282251">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282259">default</span><span class="op" id="3282266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3282270">panic</span><span class="op" id="3282275">(</span><span class="string" id="3282276">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3282297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282300">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282303">if</span>&nbsp;<span class="ident" id="3282306">b</span><span class="op" id="3282307">.</span><span class="ident" id="3282308">ElseList</span>&nbsp;<span class="op" id="3282317">!=</span>&nbsp;<span class="ident" id="3282320">nil</span>&nbsp;<span class="op" id="3282324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282328">return</span>&nbsp;<span class="ident" id="3282335">fmt</span><span class="op" id="3282338">.</span><span class="ident" id="3282339">Sprintf</span><span class="op" id="3282346">(</span><span class="string" id="3282347">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="3282377">,</span>&nbsp;<span class="ident" id="3282379">name</span><span class="op" id="3282383">,</span>&nbsp;<span class="ident" id="3282385">b</span><span class="op" id="3282386">.</span><span class="ident" id="3282387">Pipe</span><span class="op" id="3282391">,</span>&nbsp;<span class="ident" id="3282393">b</span><span class="op" id="3282394">.</span><span class="ident" id="3282395">List</span><span class="op" id="3282399">,</span>&nbsp;<span class="ident" id="3282401">b</span><span class="op" id="3282402">.</span><span class="ident" id="3282403">ElseList</span><span class="op" id="3282411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282417">return</span>&nbsp;<span class="ident" id="3282424">fmt</span><span class="op" id="3282427">.</span><span class="ident" id="3282428">Sprintf</span><span class="op" id="3282435">(</span><span class="string" id="3282436">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="3282456">,</span>&nbsp;<span class="ident" id="3282458">name</span><span class="op" id="3282462">,</span>&nbsp;<span class="ident" id="3282464">b</span><span class="op" id="3282465">.</span><span class="ident" id="3282466">Pipe</span><span class="op" id="3282470">,</span>&nbsp;<span class="ident" id="3282472">b</span><span class="op" id="3282473">.</span><span class="ident" id="3282474">List</span><span class="op" id="3282478">)</span><br>
<span class="lineno"></span><span class="op" id="3282480">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="3282483">func</span>&nbsp;<span class="op" id="3282488">(</span><span class="ident" id="3282489">b</span>&nbsp;<span class="op" id="3282491">*</span><span class="ident" id="3282492">BranchNode</span><span class="op" id="3282502">)</span>&nbsp;<span class="ident" id="3282504">tree</span><span class="op" id="3282508">(</span><span class="op" id="3282509">)</span>&nbsp;<span class="op" id="3282511">*</span><span class="ident" id="3282512">Tree</span>&nbsp;<span class="op" id="3282517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282520">return</span>&nbsp;<span class="ident" id="3282527">b</span><span class="op" id="3282528">.</span><span class="ident" id="3282529">tr</span><br>
<span class="lineno"></span><span class="op" id="3282532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="3282535">func</span>&nbsp;<span class="op" id="3282540">(</span><span class="ident" id="3282541">b</span>&nbsp;<span class="op" id="3282543">*</span><span class="ident" id="3282544">BranchNode</span><span class="op" id="3282554">)</span>&nbsp;<span class="ident" id="3282556">Copy</span><span class="op" id="3282560">(</span><span class="op" id="3282561">)</span>&nbsp;<span class="ident" id="3282563">Node</span>&nbsp;<span class="op" id="3282568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282571">switch</span>&nbsp;<span class="ident" id="3282578">b</span><span class="op" id="3282579">.</span><span class="ident" id="3282580">NodeType</span>&nbsp;<span class="op" id="3282589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282592">case</span>&nbsp;<span class="ident" id="3282597">NodeIf</span><span class="op" id="3282603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282607">return</span>&nbsp;<span class="ident" id="3282614">b</span><span class="op" id="3282615">.</span><span class="ident" id="3282616">tr</span><span class="op" id="3282618">.</span><span class="ident" id="3282619">newIf</span><span class="op" id="3282624">(</span><span class="ident" id="3282625">b</span><span class="op" id="3282626">.</span><span class="ident" id="3282627">Pos</span><span class="op" id="3282630">,</span>&nbsp;<span class="ident" id="3282632">b</span><span class="op" id="3282633">.</span><span class="ident" id="3282634">Line</span><span class="op" id="3282638">,</span>&nbsp;<span class="ident" id="3282640">b</span><span class="op" id="3282641">.</span><span class="ident" id="3282642">Pipe</span><span class="op" id="3282646">,</span>&nbsp;<span class="ident" id="3282648">b</span><span class="op" id="3282649">.</span><span class="ident" id="3282650">List</span><span class="op" id="3282654">,</span>&nbsp;<span class="ident" id="3282656">b</span><span class="op" id="3282657">.</span><span class="ident" id="3282658">ElseList</span><span class="op" id="3282666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282669">case</span>&nbsp;<span class="ident" id="3282674">NodeRange</span><span class="op" id="3282683">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282687">return</span>&nbsp;<span class="ident" id="3282694">b</span><span class="op" id="3282695">.</span><span class="ident" id="3282696">tr</span><span class="op" id="3282698">.</span><span class="ident" id="3282699">newRange</span><span class="op" id="3282707">(</span><span class="ident" id="3282708">b</span><span class="op" id="3282709">.</span><span class="ident" id="3282710">Pos</span><span class="op" id="3282713">,</span>&nbsp;<span class="ident" id="3282715">b</span><span class="op" id="3282716">.</span><span class="ident" id="3282717">Line</span><span class="op" id="3282721">,</span>&nbsp;<span class="ident" id="3282723">b</span><span class="op" id="3282724">.</span><span class="ident" id="3282725">Pipe</span><span class="op" id="3282729">,</span>&nbsp;<span class="ident" id="3282731">b</span><span class="op" id="3282732">.</span><span class="ident" id="3282733">List</span><span class="op" id="3282737">,</span>&nbsp;<span class="ident" id="3282739">b</span><span class="op" id="3282740">.</span><span class="ident" id="3282741">ElseList</span><span class="op" id="3282749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282752">case</span>&nbsp;<span class="ident" id="3282757">NodeWith</span><span class="op" id="3282765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282769">return</span>&nbsp;<span class="ident" id="3282776">b</span><span class="op" id="3282777">.</span><span class="ident" id="3282778">tr</span><span class="op" id="3282780">.</span><span class="ident" id="3282781">newWith</span><span class="op" id="3282788">(</span><span class="ident" id="3282789">b</span><span class="op" id="3282790">.</span><span class="ident" id="3282791">Pos</span><span class="op" id="3282794">,</span>&nbsp;<span class="ident" id="3282796">b</span><span class="op" id="3282797">.</span><span class="ident" id="3282798">Line</span><span class="op" id="3282802">,</span>&nbsp;<span class="ident" id="3282804">b</span><span class="op" id="3282805">.</span><span class="ident" id="3282806">Pipe</span><span class="op" id="3282810">,</span>&nbsp;<span class="ident" id="3282812">b</span><span class="op" id="3282813">.</span><span class="ident" id="3282814">List</span><span class="op" id="3282818">,</span>&nbsp;<span class="ident" id="3282820">b</span><span class="op" id="3282821">.</span><span class="ident" id="3282822">ElseList</span><span class="op" id="3282830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3282833">default</span><span class="op" id="3282840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3282844">panic</span><span class="op" id="3282849">(</span><span class="string" id="3282850">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3282871">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3282874">}</span><br>
<span class="lineno"></span><span class="op" id="3282876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3282879">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3282935">type</span>&nbsp;<span class="ident" id="3282940">IfNode</span>&nbsp;<span class="keyword" id="3282947">struct</span>&nbsp;<span class="op" id="3282954">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3282957">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3282968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3282971">func</span>&nbsp;<span class="op" id="3282976">(</span><span class="ident" id="3282977">t</span>&nbsp;<span class="op" id="3282979">*</span><span class="ident" id="3282980">Tree</span><span class="op" id="3282984">)</span>&nbsp;<span class="ident" id="3282986">newIf</span><span class="op" id="3282991">(</span><span class="ident" id="3282992">pos</span>&nbsp;<span class="ident" id="3282996">Pos</span><span class="op" id="3282999">,</span>&nbsp;<span class="ident" id="3283001">line</span>&nbsp;<span class="builtintype" id="3283006">int</span><span class="op" id="3283009">,</span>&nbsp;<span class="ident" id="3283011">pipe</span>&nbsp;<span class="op" id="3283016">*</span><span class="ident" id="3283017">PipeNode</span><span class="op" id="3283025">,</span>&nbsp;<span class="ident" id="3283027">list</span><span class="op" id="3283031">,</span>&nbsp;<span class="ident" id="3283033">elseList</span>&nbsp;<span class="op" id="3283042">*</span><span class="ident" id="3283043">ListNode</span><span class="op" id="3283051">)</span>&nbsp;<span class="op" id="3283053">*</span><span class="ident" id="3283054">IfNode</span>&nbsp;<span class="op" id="3283061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283064">return</span>&nbsp;<span class="op" id="3283071">&amp;</span><span class="ident" id="3283072">IfNode</span><span class="op" id="3283078">{</span><span class="ident" id="3283079">BranchNode</span><span class="op" id="3283089">{</span><span class="ident" id="3283090">tr</span><span class="op" id="3283092">:</span>&nbsp;<span class="ident" id="3283094">t</span><span class="op" id="3283095">,</span>&nbsp;<span class="ident" id="3283097">NodeType</span><span class="op" id="3283105">:</span>&nbsp;<span class="ident" id="3283107">NodeIf</span><span class="op" id="3283113">,</span>&nbsp;<span class="ident" id="3283115">Pos</span><span class="op" id="3283118">:</span>&nbsp;<span class="ident" id="3283120">pos</span><span class="op" id="3283123">,</span>&nbsp;<span class="ident" id="3283125">Line</span><span class="op" id="3283129">:</span>&nbsp;<span class="ident" id="3283131">line</span><span class="op" id="3283135">,</span>&nbsp;<span class="ident" id="3283137">Pipe</span><span class="op" id="3283141">:</span>&nbsp;<span class="ident" id="3283143">pipe</span><span class="op" id="3283147">,</span>&nbsp;<span class="ident" id="3283149">List</span><span class="op" id="3283153">:</span>&nbsp;<span class="ident" id="3283155">list</span><span class="op" id="3283159">,</span>&nbsp;<span class="ident" id="3283161">ElseList</span><span class="op" id="3283169">:</span>&nbsp;<span class="ident" id="3283171">elseList</span><span class="op" id="3283179">}</span><span class="op" id="3283180">}</span><br>
<span class="lineno">775</span><span class="op" id="3283182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3283185">func</span>&nbsp;<span class="op" id="3283190">(</span><span class="ident" id="3283191">i</span>&nbsp;<span class="op" id="3283193">*</span><span class="ident" id="3283194">IfNode</span><span class="op" id="3283200">)</span>&nbsp;<span class="ident" id="3283202">Copy</span><span class="op" id="3283206">(</span><span class="op" id="3283207">)</span>&nbsp;<span class="ident" id="3283209">Node</span>&nbsp;<span class="op" id="3283214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283217">return</span>&nbsp;<span class="ident" id="3283224">i</span><span class="op" id="3283225">.</span><span class="ident" id="3283226">tr</span><span class="op" id="3283228">.</span><span class="ident" id="3283229">newIf</span><span class="op" id="3283234">(</span><span class="ident" id="3283235">i</span><span class="op" id="3283236">.</span><span class="ident" id="3283237">Pos</span><span class="op" id="3283240">,</span>&nbsp;<span class="ident" id="3283242">i</span><span class="op" id="3283243">.</span><span class="ident" id="3283244">Line</span><span class="op" id="3283248">,</span>&nbsp;<span class="ident" id="3283250">i</span><span class="op" id="3283251">.</span><span class="ident" id="3283252">Pipe</span><span class="op" id="3283256">.</span><span class="ident" id="3283257">CopyPipe</span><span class="op" id="3283265">(</span><span class="op" id="3283266">)</span><span class="op" id="3283267">,</span>&nbsp;<span class="ident" id="3283269">i</span><span class="op" id="3283270">.</span><span class="ident" id="3283271">List</span><span class="op" id="3283275">.</span><span class="ident" id="3283276">CopyList</span><span class="op" id="3283284">(</span><span class="op" id="3283285">)</span><span class="op" id="3283286">,</span>&nbsp;<span class="ident" id="3283288">i</span><span class="op" id="3283289">.</span><span class="ident" id="3283290">ElseList</span><span class="op" id="3283298">.</span><span class="ident" id="3283299">CopyList</span><span class="op" id="3283307">(</span><span class="op" id="3283308">)</span><span class="op" id="3283309">)</span><br>
<span class="lineno"></span><span class="op" id="3283311">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="3283314">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3283375">type</span>&nbsp;<span class="ident" id="3283380">RangeNode</span>&nbsp;<span class="keyword" id="3283390">struct</span>&nbsp;<span class="op" id="3283397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283400">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3283411">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="3283414">func</span>&nbsp;<span class="op" id="3283419">(</span><span class="ident" id="3283420">t</span>&nbsp;<span class="op" id="3283422">*</span><span class="ident" id="3283423">Tree</span><span class="op" id="3283427">)</span>&nbsp;<span class="ident" id="3283429">newRange</span><span class="op" id="3283437">(</span><span class="ident" id="3283438">pos</span>&nbsp;<span class="ident" id="3283442">Pos</span><span class="op" id="3283445">,</span>&nbsp;<span class="ident" id="3283447">line</span>&nbsp;<span class="builtintype" id="3283452">int</span><span class="op" id="3283455">,</span>&nbsp;<span class="ident" id="3283457">pipe</span>&nbsp;<span class="op" id="3283462">*</span><span class="ident" id="3283463">PipeNode</span><span class="op" id="3283471">,</span>&nbsp;<span class="ident" id="3283473">list</span><span class="op" id="3283477">,</span>&nbsp;<span class="ident" id="3283479">elseList</span>&nbsp;<span class="op" id="3283488">*</span><span class="ident" id="3283489">ListNode</span><span class="op" id="3283497">)</span>&nbsp;<span class="op" id="3283499">*</span><span class="ident" id="3283500">RangeNode</span>&nbsp;<span class="op" id="3283510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283513">return</span>&nbsp;<span class="op" id="3283520">&amp;</span><span class="ident" id="3283521">RangeNode</span><span class="op" id="3283530">{</span><span class="ident" id="3283531">BranchNode</span><span class="op" id="3283541">{</span><span class="ident" id="3283542">tr</span><span class="op" id="3283544">:</span>&nbsp;<span class="ident" id="3283546">t</span><span class="op" id="3283547">,</span>&nbsp;<span class="ident" id="3283549">NodeType</span><span class="op" id="3283557">:</span>&nbsp;<span class="ident" id="3283559">NodeRange</span><span class="op" id="3283568">,</span>&nbsp;<span class="ident" id="3283570">Pos</span><span class="op" id="3283573">:</span>&nbsp;<span class="ident" id="3283575">pos</span><span class="op" id="3283578">,</span>&nbsp;<span class="ident" id="3283580">Line</span><span class="op" id="3283584">:</span>&nbsp;<span class="ident" id="3283586">line</span><span class="op" id="3283590">,</span>&nbsp;<span class="ident" id="3283592">Pipe</span><span class="op" id="3283596">:</span>&nbsp;<span class="ident" id="3283598">pipe</span><span class="op" id="3283602">,</span>&nbsp;<span class="ident" id="3283604">List</span><span class="op" id="3283608">:</span>&nbsp;<span class="ident" id="3283610">list</span><span class="op" id="3283614">,</span>&nbsp;<span class="ident" id="3283616">ElseList</span><span class="op" id="3283624">:</span>&nbsp;<span class="ident" id="3283626">elseList</span><span class="op" id="3283634">}</span><span class="op" id="3283635">}</span><br>
<span class="lineno"></span><span class="op" id="3283637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="3283640">func</span>&nbsp;<span class="op" id="3283645">(</span><span class="ident" id="3283646">r</span>&nbsp;<span class="op" id="3283648">*</span><span class="ident" id="3283649">RangeNode</span><span class="op" id="3283658">)</span>&nbsp;<span class="ident" id="3283660">Copy</span><span class="op" id="3283664">(</span><span class="op" id="3283665">)</span>&nbsp;<span class="ident" id="3283667">Node</span>&nbsp;<span class="op" id="3283672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283675">return</span>&nbsp;<span class="ident" id="3283682">r</span><span class="op" id="3283683">.</span><span class="ident" id="3283684">tr</span><span class="op" id="3283686">.</span><span class="ident" id="3283687">newRange</span><span class="op" id="3283695">(</span><span class="ident" id="3283696">r</span><span class="op" id="3283697">.</span><span class="ident" id="3283698">Pos</span><span class="op" id="3283701">,</span>&nbsp;<span class="ident" id="3283703">r</span><span class="op" id="3283704">.</span><span class="ident" id="3283705">Line</span><span class="op" id="3283709">,</span>&nbsp;<span class="ident" id="3283711">r</span><span class="op" id="3283712">.</span><span class="ident" id="3283713">Pipe</span><span class="op" id="3283717">.</span><span class="ident" id="3283718">CopyPipe</span><span class="op" id="3283726">(</span><span class="op" id="3283727">)</span><span class="op" id="3283728">,</span>&nbsp;<span class="ident" id="3283730">r</span><span class="op" id="3283731">.</span><span class="ident" id="3283732">List</span><span class="op" id="3283736">.</span><span class="ident" id="3283737">CopyList</span><span class="op" id="3283745">(</span><span class="op" id="3283746">)</span><span class="op" id="3283747">,</span>&nbsp;<span class="ident" id="3283749">r</span><span class="op" id="3283750">.</span><span class="ident" id="3283751">ElseList</span><span class="op" id="3283759">.</span><span class="ident" id="3283760">CopyList</span><span class="op" id="3283768">(</span><span class="op" id="3283769">)</span><span class="op" id="3283770">)</span><br>
<span class="lineno"></span><span class="op" id="3283772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3283775">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="3283834">type</span>&nbsp;<span class="ident" id="3283839">WithNode</span>&nbsp;<span class="keyword" id="3283848">struct</span>&nbsp;<span class="op" id="3283855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3283858">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3283869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3283872">func</span>&nbsp;<span class="op" id="3283877">(</span><span class="ident" id="3283878">t</span>&nbsp;<span class="op" id="3283880">*</span><span class="ident" id="3283881">Tree</span><span class="op" id="3283885">)</span>&nbsp;<span class="ident" id="3283887">newWith</span><span class="op" id="3283894">(</span><span class="ident" id="3283895">pos</span>&nbsp;<span class="ident" id="3283899">Pos</span><span class="op" id="3283902">,</span>&nbsp;<span class="ident" id="3283904">line</span>&nbsp;<span class="builtintype" id="3283909">int</span><span class="op" id="3283912">,</span>&nbsp;<span class="ident" id="3283914">pipe</span>&nbsp;<span class="op" id="3283919">*</span><span class="ident" id="3283920">PipeNode</span><span class="op" id="3283928">,</span>&nbsp;<span class="ident" id="3283930">list</span><span class="op" id="3283934">,</span>&nbsp;<span class="ident" id="3283936">elseList</span>&nbsp;<span class="op" id="3283945">*</span><span class="ident" id="3283946">ListNode</span><span class="op" id="3283954">)</span>&nbsp;<span class="op" id="3283956">*</span><span class="ident" id="3283957">WithNode</span>&nbsp;<span class="op" id="3283966">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3283969">return</span>&nbsp;<span class="op" id="3283976">&amp;</span><span class="ident" id="3283977">WithNode</span><span class="op" id="3283985">{</span><span class="ident" id="3283986">BranchNode</span><span class="op" id="3283996">{</span><span class="ident" id="3283997">tr</span><span class="op" id="3283999">:</span>&nbsp;<span class="ident" id="3284001">t</span><span class="op" id="3284002">,</span>&nbsp;<span class="ident" id="3284004">NodeType</span><span class="op" id="3284012">:</span>&nbsp;<span class="ident" id="3284014">NodeWith</span><span class="op" id="3284022">,</span>&nbsp;<span class="ident" id="3284024">Pos</span><span class="op" id="3284027">:</span>&nbsp;<span class="ident" id="3284029">pos</span><span class="op" id="3284032">,</span>&nbsp;<span class="ident" id="3284034">Line</span><span class="op" id="3284038">:</span>&nbsp;<span class="ident" id="3284040">line</span><span class="op" id="3284044">,</span>&nbsp;<span class="ident" id="3284046">Pipe</span><span class="op" id="3284050">:</span>&nbsp;<span class="ident" id="3284052">pipe</span><span class="op" id="3284056">,</span>&nbsp;<span class="ident" id="3284058">List</span><span class="op" id="3284062">:</span>&nbsp;<span class="ident" id="3284064">list</span><span class="op" id="3284068">,</span>&nbsp;<span class="ident" id="3284070">ElseList</span><span class="op" id="3284078">:</span>&nbsp;<span class="ident" id="3284080">elseList</span><span class="op" id="3284088">}</span><span class="op" id="3284089">}</span><br>
<span class="lineno"></span><span class="op" id="3284091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284094">func</span>&nbsp;<span class="op" id="3284099">(</span><span class="ident" id="3284100">w</span>&nbsp;<span class="op" id="3284102">*</span><span class="ident" id="3284103">WithNode</span><span class="op" id="3284111">)</span>&nbsp;<span class="ident" id="3284113">Copy</span><span class="op" id="3284117">(</span><span class="op" id="3284118">)</span>&nbsp;<span class="ident" id="3284120">Node</span>&nbsp;<span class="op" id="3284125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284128">return</span>&nbsp;<span class="ident" id="3284135">w</span><span class="op" id="3284136">.</span><span class="ident" id="3284137">tr</span><span class="op" id="3284139">.</span><span class="ident" id="3284140">newWith</span><span class="op" id="3284147">(</span><span class="ident" id="3284148">w</span><span class="op" id="3284149">.</span><span class="ident" id="3284150">Pos</span><span class="op" id="3284153">,</span>&nbsp;<span class="ident" id="3284155">w</span><span class="op" id="3284156">.</span><span class="ident" id="3284157">Line</span><span class="op" id="3284161">,</span>&nbsp;<span class="ident" id="3284163">w</span><span class="op" id="3284164">.</span><span class="ident" id="3284165">Pipe</span><span class="op" id="3284169">.</span><span class="ident" id="3284170">CopyPipe</span><span class="op" id="3284178">(</span><span class="op" id="3284179">)</span><span class="op" id="3284180">,</span>&nbsp;<span class="ident" id="3284182">w</span><span class="op" id="3284183">.</span><span class="ident" id="3284184">List</span><span class="op" id="3284188">.</span><span class="ident" id="3284189">CopyList</span><span class="op" id="3284197">(</span><span class="op" id="3284198">)</span><span class="op" id="3284199">,</span>&nbsp;<span class="ident" id="3284201">w</span><span class="op" id="3284202">.</span><span class="ident" id="3284203">ElseList</span><span class="op" id="3284211">.</span><span class="ident" id="3284212">CopyList</span><span class="op" id="3284220">(</span><span class="op" id="3284221">)</span><span class="op" id="3284222">)</span><br>
<span class="lineno">805</span><span class="op" id="3284224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3284227">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3284277">type</span>&nbsp;<span class="ident" id="3284282">TemplateNode</span>&nbsp;<span class="keyword" id="3284295">struct</span>&nbsp;<span class="op" id="3284302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284305">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284315">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284320">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3284325">*</span><span class="ident" id="3284326">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284332">Line</span>&nbsp;<span class="builtintype" id="3284337">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3284347">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284417">Name</span>&nbsp;<span class="builtintype" id="3284422">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3284432">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3284473">Pipe</span>&nbsp;<span class="op" id="3284478">*</span><span class="ident" id="3284479">PipeNode</span>&nbsp;<span class="comment" id="3284488">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="3284540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284543">func</span>&nbsp;<span class="op" id="3284548">(</span><span class="ident" id="3284549">t</span>&nbsp;<span class="op" id="3284551">*</span><span class="ident" id="3284552">Tree</span><span class="op" id="3284556">)</span>&nbsp;<span class="ident" id="3284558">newTemplate</span><span class="op" id="3284569">(</span><span class="ident" id="3284570">pos</span>&nbsp;<span class="ident" id="3284574">Pos</span><span class="op" id="3284577">,</span>&nbsp;<span class="ident" id="3284579">line</span>&nbsp;<span class="builtintype" id="3284584">int</span><span class="op" id="3284587">,</span>&nbsp;<span class="ident" id="3284589">name</span>&nbsp;<span class="builtintype" id="3284594">string</span><span class="op" id="3284600">,</span>&nbsp;<span class="ident" id="3284602">pipe</span>&nbsp;<span class="op" id="3284607">*</span><span class="ident" id="3284608">PipeNode</span><span class="op" id="3284616">)</span>&nbsp;<span class="op" id="3284618">*</span><span class="ident" id="3284619">TemplateNode</span>&nbsp;<span class="op" id="3284632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284635">return</span>&nbsp;<span class="op" id="3284642">&amp;</span><span class="ident" id="3284643">TemplateNode</span><span class="op" id="3284655">{</span><span class="ident" id="3284656">tr</span><span class="op" id="3284658">:</span>&nbsp;<span class="ident" id="3284660">t</span><span class="op" id="3284661">,</span>&nbsp;<span class="ident" id="3284663">NodeType</span><span class="op" id="3284671">:</span>&nbsp;<span class="ident" id="3284673">NodeTemplate</span><span class="op" id="3284685">,</span>&nbsp;<span class="ident" id="3284687">Pos</span><span class="op" id="3284690">:</span>&nbsp;<span class="ident" id="3284692">pos</span><span class="op" id="3284695">,</span>&nbsp;<span class="ident" id="3284697">Line</span><span class="op" id="3284701">:</span>&nbsp;<span class="ident" id="3284703">line</span><span class="op" id="3284707">,</span>&nbsp;<span class="ident" id="3284709">Name</span><span class="op" id="3284713">:</span>&nbsp;<span class="ident" id="3284715">name</span><span class="op" id="3284719">,</span>&nbsp;<span class="ident" id="3284721">Pipe</span><span class="op" id="3284725">:</span>&nbsp;<span class="ident" id="3284727">pipe</span><span class="op" id="3284731">}</span><br>
<span class="lineno"></span><span class="op" id="3284733">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="3284736">func</span>&nbsp;<span class="op" id="3284741">(</span><span class="ident" id="3284742">t</span>&nbsp;<span class="op" id="3284744">*</span><span class="ident" id="3284745">TemplateNode</span><span class="op" id="3284757">)</span>&nbsp;<span class="ident" id="3284759">String</span><span class="op" id="3284765">(</span><span class="op" id="3284766">)</span>&nbsp;<span class="builtintype" id="3284768">string</span>&nbsp;<span class="op" id="3284775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284778">if</span>&nbsp;<span class="ident" id="3284781">t</span><span class="op" id="3284782">.</span><span class="ident" id="3284783">Pipe</span>&nbsp;<span class="op" id="3284788">==</span>&nbsp;<span class="ident" id="3284791">nil</span>&nbsp;<span class="op" id="3284795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284799">return</span>&nbsp;<span class="ident" id="3284806">fmt</span><span class="op" id="3284809">.</span><span class="ident" id="3284810">Sprintf</span><span class="op" id="3284817">(</span><span class="string" id="3284818">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="3284835">,</span>&nbsp;<span class="ident" id="3284837">t</span><span class="op" id="3284838">.</span><span class="ident" id="3284839">Name</span><span class="op" id="3284843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3284846">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284849">return</span>&nbsp;<span class="ident" id="3284856">fmt</span><span class="op" id="3284859">.</span><span class="ident" id="3284860">Sprintf</span><span class="op" id="3284867">(</span><span class="string" id="3284868">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="3284888">,</span>&nbsp;<span class="ident" id="3284890">t</span><span class="op" id="3284891">.</span><span class="ident" id="3284892">Name</span><span class="op" id="3284896">,</span>&nbsp;<span class="ident" id="3284898">t</span><span class="op" id="3284899">.</span><span class="ident" id="3284900">Pipe</span><span class="op" id="3284904">)</span><br>
<span class="lineno"></span><span class="op" id="3284906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284909">func</span>&nbsp;<span class="op" id="3284914">(</span><span class="ident" id="3284915">t</span>&nbsp;<span class="op" id="3284917">*</span><span class="ident" id="3284918">TemplateNode</span><span class="op" id="3284930">)</span>&nbsp;<span class="ident" id="3284932">tree</span><span class="op" id="3284936">(</span><span class="op" id="3284937">)</span>&nbsp;<span class="op" id="3284939">*</span><span class="ident" id="3284940">Tree</span>&nbsp;<span class="op" id="3284945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3284948">return</span>&nbsp;<span class="ident" id="3284955">t</span><span class="op" id="3284956">.</span><span class="ident" id="3284957">tr</span><br>
<span class="lineno">830</span><span class="op" id="3284960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3284963">func</span>&nbsp;<span class="op" id="3284968">(</span><span class="ident" id="3284969">t</span>&nbsp;<span class="op" id="3284971">*</span><span class="ident" id="3284972">TemplateNode</span><span class="op" id="3284984">)</span>&nbsp;<span class="ident" id="3284986">Copy</span><span class="op" id="3284990">(</span><span class="op" id="3284991">)</span>&nbsp;<span class="ident" id="3284993">Node</span>&nbsp;<span class="op" id="3284998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3285001">return</span>&nbsp;<span class="ident" id="3285008">t</span><span class="op" id="3285009">.</span><span class="ident" id="3285010">tr</span><span class="op" id="3285012">.</span><span class="ident" id="3285013">newTemplate</span><span class="op" id="3285024">(</span><span class="ident" id="3285025">t</span><span class="op" id="3285026">.</span><span class="ident" id="3285027">Pos</span><span class="op" id="3285030">,</span>&nbsp;<span class="ident" id="3285032">t</span><span class="op" id="3285033">.</span><span class="ident" id="3285034">Line</span><span class="op" id="3285038">,</span>&nbsp;<span class="ident" id="3285040">t</span><span class="op" id="3285041">.</span><span class="ident" id="3285042">Name</span><span class="op" id="3285046">,</span>&nbsp;<span class="ident" id="3285048">t</span><span class="op" id="3285049">.</span><span class="ident" id="3285050">Pipe</span><span class="op" id="3285054">.</span><span class="ident" id="3285055">CopyPipe</span><span class="op" id="3285063">(</span><span class="op" id="3285064">)</span><span class="op" id="3285065">)</span><br>
<span class="lineno"></span><span class="op" id="3285067">}</span>
</div>
</body>
</html>
