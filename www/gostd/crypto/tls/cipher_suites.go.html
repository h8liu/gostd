<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html" class="current">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4162727">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4162782">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4162836">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4162887">package</span>&nbsp;<span class="ident" id="4162895">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4162900">import</span>&nbsp;<span class="op" id="4162907">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4162910">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4162924">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4162941">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4162955">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4162970">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4162984">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4162999">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4163014">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4163021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4163024">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4163103">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4163167">type</span>&nbsp;<span class="ident" id="4163172">keyAgreement</span>&nbsp;<span class="keyword" id="4163185">interface</span>&nbsp;<span class="op" id="4163195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4163198">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4163266">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4163328">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4163401">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4163410">generateServerKeyExchange</span><span class="op" id="4163435">(</span><span class="op" id="4163436">*</span><span class="ident" id="4163437">Config</span><span class="op" id="4163443">,</span>&nbsp;<span class="op" id="4163445">*</span><span class="ident" id="4163446">Certificate</span><span class="op" id="4163457">,</span>&nbsp;<span class="op" id="4163459">*</span><span class="ident" id="4163460">clientHelloMsg</span><span class="op" id="4163474">,</span>&nbsp;<span class="op" id="4163476">*</span><span class="ident" id="4163477">serverHelloMsg</span><span class="op" id="4163491">)</span>&nbsp;<span class="op" id="4163493">(</span><span class="op" id="4163494">*</span><span class="ident" id="4163495">serverKeyExchangeMsg</span><span class="op" id="4163515">,</span>&nbsp;<span class="builtintype" id="4163517">error</span><span class="op" id="4163522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4163525">processClientKeyExchange</span><span class="op" id="4163549">(</span><span class="op" id="4163550">*</span><span class="ident" id="4163551">Config</span><span class="op" id="4163557">,</span>&nbsp;<span class="op" id="4163559">*</span><span class="ident" id="4163560">Certificate</span><span class="op" id="4163571">,</span>&nbsp;<span class="op" id="4163573">*</span><span class="ident" id="4163574">clientKeyExchangeMsg</span><span class="op" id="4163594">,</span>&nbsp;<span class="builtintype" id="4163596">uint16</span><span class="op" id="4163602">)</span>&nbsp;<span class="op" id="4163604">(</span><span class="op" id="4163605">[</span><span class="op" id="4163606">]</span><span class="builtintype" id="4163607">byte</span><span class="op" id="4163611">,</span>&nbsp;<span class="builtintype" id="4163613">error</span><span class="op" id="4163618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4163622">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4163689">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4163752">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4163783">processServerKeyExchange</span><span class="op" id="4163807">(</span><span class="op" id="4163808">*</span><span class="ident" id="4163809">Config</span><span class="op" id="4163815">,</span>&nbsp;<span class="op" id="4163817">*</span><span class="ident" id="4163818">clientHelloMsg</span><span class="op" id="4163832">,</span>&nbsp;<span class="op" id="4163834">*</span><span class="ident" id="4163835">serverHelloMsg</span><span class="op" id="4163849">,</span>&nbsp;<span class="op" id="4163851">*</span><span class="ident" id="4163852">x509</span><span class="op" id="4163856">.</span><span class="ident" id="4163857">Certificate</span><span class="op" id="4163868">,</span>&nbsp;<span class="op" id="4163870">*</span><span class="ident" id="4163871">serverKeyExchangeMsg</span><span class="op" id="4163891">)</span>&nbsp;<span class="builtintype" id="4163893">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4163900">generateClientKeyExchange</span><span class="op" id="4163925">(</span><span class="op" id="4163926">*</span><span class="ident" id="4163927">Config</span><span class="op" id="4163933">,</span>&nbsp;<span class="op" id="4163935">*</span><span class="ident" id="4163936">clientHelloMsg</span><span class="op" id="4163950">,</span>&nbsp;<span class="op" id="4163952">*</span><span class="ident" id="4163953">x509</span><span class="op" id="4163957">.</span><span class="ident" id="4163958">Certificate</span><span class="op" id="4163969">)</span>&nbsp;<span class="op" id="4163971">(</span><span class="op" id="4163972">[</span><span class="op" id="4163973">]</span><span class="builtintype" id="4163974">byte</span><span class="op" id="4163978">,</span>&nbsp;<span class="op" id="4163980">*</span><span class="ident" id="4163981">clientKeyExchangeMsg</span><span class="op" id="4164001">,</span>&nbsp;<span class="builtintype" id="4164003">error</span><span class="op" id="4164008">)</span><br>
<span class="lineno">35</span><span class="op" id="4164010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4164013">const</span>&nbsp;<span class="op" id="4164019">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164022">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164092">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164164">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164236">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164263">suiteECDHE</span>&nbsp;<span class="op" id="4164274">=</span>&nbsp;<span class="num" id="4164276">1</span>&nbsp;<span class="op" id="4164278">&lt;&lt;</span>&nbsp;<span class="ident" id="4164281">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164287">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164352">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164419">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164489">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164504">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164516">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164589">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164626">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4164637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4164640">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4164716">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4164783">type</span>&nbsp;<span class="ident" id="4164788">cipherSuite</span>&nbsp;<span class="keyword" id="4164800">struct</span>&nbsp;<span class="op" id="4164807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164810">id</span>&nbsp;<span class="builtintype" id="4164813">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164821">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164895">keyLen</span>&nbsp;<span class="builtintype" id="4164902">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164907">macLen</span>&nbsp;<span class="builtintype" id="4164914">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164919">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4164926">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4164931">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4164938">func</span><span class="op" id="4164942">(</span><span class="ident" id="4164943">version</span>&nbsp;<span class="builtintype" id="4164951">uint16</span><span class="op" id="4164957">)</span>&nbsp;<span class="ident" id="4164959">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164973">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4165025">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4165032">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4165037">cipher</span>&nbsp;<span class="keyword" id="4165044">func</span><span class="op" id="4165048">(</span><span class="ident" id="4165049">key</span><span class="op" id="4165052">,</span>&nbsp;<span class="ident" id="4165054">iv</span>&nbsp;<span class="op" id="4165057">[</span><span class="op" id="4165058">]</span><span class="builtintype" id="4165059">byte</span><span class="op" id="4165063">,</span>&nbsp;<span class="ident" id="4165065">isRead</span>&nbsp;<span class="builtintype" id="4165072">bool</span><span class="op" id="4165076">)</span>&nbsp;<span class="keyword" id="4165078">interface</span><span class="op" id="4165087">{</span><span class="op" id="4165088">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4165091">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4165098">func</span><span class="op" id="4165102">(</span><span class="ident" id="4165103">version</span>&nbsp;<span class="builtintype" id="4165111">uint16</span><span class="op" id="4165117">,</span>&nbsp;<span class="ident" id="4165119">macKey</span>&nbsp;<span class="op" id="4165126">[</span><span class="op" id="4165127">]</span><span class="builtintype" id="4165128">byte</span><span class="op" id="4165132">)</span>&nbsp;<span class="ident" id="4165134">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4165147">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4165154">func</span><span class="op" id="4165158">(</span><span class="ident" id="4165159">key</span><span class="op" id="4165162">,</span>&nbsp;<span class="ident" id="4165164">fixedNonce</span>&nbsp;<span class="op" id="4165175">[</span><span class="op" id="4165176">]</span><span class="builtintype" id="4165177">byte</span><span class="op" id="4165181">)</span>&nbsp;<span class="ident" id="4165183">cipher</span><span class="op" id="4165189">.</span><span class="ident" id="4165190">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4165195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4165198">var</span>&nbsp;<span class="ident" id="4165202">cipherSuites</span>&nbsp;<span class="op" id="4165215">=</span>&nbsp;<span class="op" id="4165217">[</span><span class="op" id="4165218">]</span><span class="op" id="4165219">*</span><span class="ident" id="4165220">cipherSuite</span><span class="op" id="4165231">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165234">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165303">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165365">{</span><span class="ident" id="4165366">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4165403">,</span>&nbsp;<span class="num" id="4165405">16</span><span class="op" id="4165407">,</span>&nbsp;<span class="num" id="4165409">0</span><span class="op" id="4165410">,</span>&nbsp;<span class="num" id="4165412">4</span><span class="op" id="4165413">,</span>&nbsp;<span class="ident" id="4165415">ecdheRSAKA</span><span class="op" id="4165425">,</span>&nbsp;<span class="ident" id="4165427">suiteECDHE</span>&nbsp;<span class="op" id="4165438">|</span>&nbsp;<span class="ident" id="4165440">suiteTLS12</span><span class="op" id="4165450">,</span>&nbsp;<span class="builtintype" id="4165452">nil</span><span class="op" id="4165455">,</span>&nbsp;<span class="builtintype" id="4165457">nil</span><span class="op" id="4165460">,</span>&nbsp;<span class="ident" id="4165462">aeadAESGCM</span><span class="op" id="4165472">}</span><span class="op" id="4165473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165476">{</span><span class="ident" id="4165477">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4165516">,</span>&nbsp;<span class="num" id="4165518">16</span><span class="op" id="4165520">,</span>&nbsp;<span class="num" id="4165522">0</span><span class="op" id="4165523">,</span>&nbsp;<span class="num" id="4165525">4</span><span class="op" id="4165526">,</span>&nbsp;<span class="ident" id="4165528">ecdheECDSAKA</span><span class="op" id="4165540">,</span>&nbsp;<span class="ident" id="4165542">suiteECDHE</span>&nbsp;<span class="op" id="4165553">|</span>&nbsp;<span class="ident" id="4165555">suiteECDSA</span>&nbsp;<span class="op" id="4165566">|</span>&nbsp;<span class="ident" id="4165568">suiteTLS12</span><span class="op" id="4165578">,</span>&nbsp;<span class="builtintype" id="4165580">nil</span><span class="op" id="4165583">,</span>&nbsp;<span class="builtintype" id="4165585">nil</span><span class="op" id="4165588">,</span>&nbsp;<span class="ident" id="4165590">aeadAESGCM</span><span class="op" id="4165600">}</span><span class="op" id="4165601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165604">{</span><span class="ident" id="4165605">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="4165635">,</span>&nbsp;<span class="num" id="4165637">16</span><span class="op" id="4165639">,</span>&nbsp;<span class="num" id="4165641">20</span><span class="op" id="4165643">,</span>&nbsp;<span class="num" id="4165645">0</span><span class="op" id="4165646">,</span>&nbsp;<span class="ident" id="4165648">ecdheRSAKA</span><span class="op" id="4165658">,</span>&nbsp;<span class="ident" id="4165660">suiteECDHE</span><span class="op" id="4165670">,</span>&nbsp;<span class="ident" id="4165672">cipherRC4</span><span class="op" id="4165681">,</span>&nbsp;<span class="ident" id="4165683">macSHA1</span><span class="op" id="4165690">,</span>&nbsp;<span class="builtintype" id="4165692">nil</span><span class="op" id="4165695">}</span><span class="op" id="4165696">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165699">{</span><span class="ident" id="4165700">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="4165732">,</span>&nbsp;<span class="num" id="4165734">16</span><span class="op" id="4165736">,</span>&nbsp;<span class="num" id="4165738">20</span><span class="op" id="4165740">,</span>&nbsp;<span class="num" id="4165742">0</span><span class="op" id="4165743">,</span>&nbsp;<span class="ident" id="4165745">ecdheECDSAKA</span><span class="op" id="4165757">,</span>&nbsp;<span class="ident" id="4165759">suiteECDHE</span>&nbsp;<span class="op" id="4165770">|</span>&nbsp;<span class="ident" id="4165772">suiteECDSA</span><span class="op" id="4165782">,</span>&nbsp;<span class="ident" id="4165784">cipherRC4</span><span class="op" id="4165793">,</span>&nbsp;<span class="ident" id="4165795">macSHA1</span><span class="op" id="4165802">,</span>&nbsp;<span class="builtintype" id="4165804">nil</span><span class="op" id="4165807">}</span><span class="op" id="4165808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165811">{</span><span class="ident" id="4165812">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4165846">,</span>&nbsp;<span class="num" id="4165848">16</span><span class="op" id="4165850">,</span>&nbsp;<span class="num" id="4165852">20</span><span class="op" id="4165854">,</span>&nbsp;<span class="num" id="4165856">16</span><span class="op" id="4165858">,</span>&nbsp;<span class="ident" id="4165860">ecdheRSAKA</span><span class="op" id="4165870">,</span>&nbsp;<span class="ident" id="4165872">suiteECDHE</span><span class="op" id="4165882">,</span>&nbsp;<span class="ident" id="4165884">cipherAES</span><span class="op" id="4165893">,</span>&nbsp;<span class="ident" id="4165895">macSHA1</span><span class="op" id="4165902">,</span>&nbsp;<span class="builtintype" id="4165904">nil</span><span class="op" id="4165907">}</span><span class="op" id="4165908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165911">{</span><span class="ident" id="4165912">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4165948">,</span>&nbsp;<span class="num" id="4165950">16</span><span class="op" id="4165952">,</span>&nbsp;<span class="num" id="4165954">20</span><span class="op" id="4165956">,</span>&nbsp;<span class="num" id="4165958">16</span><span class="op" id="4165960">,</span>&nbsp;<span class="ident" id="4165962">ecdheECDSAKA</span><span class="op" id="4165974">,</span>&nbsp;<span class="ident" id="4165976">suiteECDHE</span>&nbsp;<span class="op" id="4165987">|</span>&nbsp;<span class="ident" id="4165989">suiteECDSA</span><span class="op" id="4165999">,</span>&nbsp;<span class="ident" id="4166001">cipherAES</span><span class="op" id="4166010">,</span>&nbsp;<span class="ident" id="4166012">macSHA1</span><span class="op" id="4166019">,</span>&nbsp;<span class="builtintype" id="4166021">nil</span><span class="op" id="4166024">}</span><span class="op" id="4166025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166028">{</span><span class="ident" id="4166029">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4166063">,</span>&nbsp;<span class="num" id="4166065">32</span><span class="op" id="4166067">,</span>&nbsp;<span class="num" id="4166069">20</span><span class="op" id="4166071">,</span>&nbsp;<span class="num" id="4166073">16</span><span class="op" id="4166075">,</span>&nbsp;<span class="ident" id="4166077">ecdheRSAKA</span><span class="op" id="4166087">,</span>&nbsp;<span class="ident" id="4166089">suiteECDHE</span><span class="op" id="4166099">,</span>&nbsp;<span class="ident" id="4166101">cipherAES</span><span class="op" id="4166110">,</span>&nbsp;<span class="ident" id="4166112">macSHA1</span><span class="op" id="4166119">,</span>&nbsp;<span class="builtintype" id="4166121">nil</span><span class="op" id="4166124">}</span><span class="op" id="4166125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166128">{</span><span class="ident" id="4166129">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4166165">,</span>&nbsp;<span class="num" id="4166167">32</span><span class="op" id="4166169">,</span>&nbsp;<span class="num" id="4166171">20</span><span class="op" id="4166173">,</span>&nbsp;<span class="num" id="4166175">16</span><span class="op" id="4166177">,</span>&nbsp;<span class="ident" id="4166179">ecdheECDSAKA</span><span class="op" id="4166191">,</span>&nbsp;<span class="ident" id="4166193">suiteECDHE</span>&nbsp;<span class="op" id="4166204">|</span>&nbsp;<span class="ident" id="4166206">suiteECDSA</span><span class="op" id="4166216">,</span>&nbsp;<span class="ident" id="4166218">cipherAES</span><span class="op" id="4166227">,</span>&nbsp;<span class="ident" id="4166229">macSHA1</span><span class="op" id="4166236">,</span>&nbsp;<span class="builtintype" id="4166238">nil</span><span class="op" id="4166241">}</span><span class="op" id="4166242">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166245">{</span><span class="ident" id="4166246">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="4166270">,</span>&nbsp;<span class="num" id="4166272">16</span><span class="op" id="4166274">,</span>&nbsp;<span class="num" id="4166276">20</span><span class="op" id="4166278">,</span>&nbsp;<span class="num" id="4166280">0</span><span class="op" id="4166281">,</span>&nbsp;<span class="ident" id="4166283">rsaKA</span><span class="op" id="4166288">,</span>&nbsp;<span class="num" id="4166290">0</span><span class="op" id="4166291">,</span>&nbsp;<span class="ident" id="4166293">cipherRC4</span><span class="op" id="4166302">,</span>&nbsp;<span class="ident" id="4166304">macSHA1</span><span class="op" id="4166311">,</span>&nbsp;<span class="builtintype" id="4166313">nil</span><span class="op" id="4166316">}</span><span class="op" id="4166317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166320">{</span><span class="ident" id="4166321">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4166349">,</span>&nbsp;<span class="num" id="4166351">16</span><span class="op" id="4166353">,</span>&nbsp;<span class="num" id="4166355">20</span><span class="op" id="4166357">,</span>&nbsp;<span class="num" id="4166359">16</span><span class="op" id="4166361">,</span>&nbsp;<span class="ident" id="4166363">rsaKA</span><span class="op" id="4166368">,</span>&nbsp;<span class="num" id="4166370">0</span><span class="op" id="4166371">,</span>&nbsp;<span class="ident" id="4166373">cipherAES</span><span class="op" id="4166382">,</span>&nbsp;<span class="ident" id="4166384">macSHA1</span><span class="op" id="4166391">,</span>&nbsp;<span class="builtintype" id="4166393">nil</span><span class="op" id="4166396">}</span><span class="op" id="4166397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166400">{</span><span class="ident" id="4166401">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4166429">,</span>&nbsp;<span class="num" id="4166431">32</span><span class="op" id="4166433">,</span>&nbsp;<span class="num" id="4166435">20</span><span class="op" id="4166437">,</span>&nbsp;<span class="num" id="4166439">16</span><span class="op" id="4166441">,</span>&nbsp;<span class="ident" id="4166443">rsaKA</span><span class="op" id="4166448">,</span>&nbsp;<span class="num" id="4166450">0</span><span class="op" id="4166451">,</span>&nbsp;<span class="ident" id="4166453">cipherAES</span><span class="op" id="4166462">,</span>&nbsp;<span class="ident" id="4166464">macSHA1</span><span class="op" id="4166471">,</span>&nbsp;<span class="builtintype" id="4166473">nil</span><span class="op" id="4166476">}</span><span class="op" id="4166477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166480">{</span><span class="ident" id="4166481">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4166516">,</span>&nbsp;<span class="num" id="4166518">24</span><span class="op" id="4166520">,</span>&nbsp;<span class="num" id="4166522">20</span><span class="op" id="4166524">,</span>&nbsp;<span class="num" id="4166526">8</span><span class="op" id="4166527">,</span>&nbsp;<span class="ident" id="4166529">ecdheRSAKA</span><span class="op" id="4166539">,</span>&nbsp;<span class="ident" id="4166541">suiteECDHE</span><span class="op" id="4166551">,</span>&nbsp;<span class="ident" id="4166553">cipher3DES</span><span class="op" id="4166563">,</span>&nbsp;<span class="ident" id="4166565">macSHA1</span><span class="op" id="4166572">,</span>&nbsp;<span class="builtintype" id="4166574">nil</span><span class="op" id="4166577">}</span><span class="op" id="4166578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166581">{</span><span class="ident" id="4166582">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4166611">,</span>&nbsp;<span class="num" id="4166613">24</span><span class="op" id="4166615">,</span>&nbsp;<span class="num" id="4166617">20</span><span class="op" id="4166619">,</span>&nbsp;<span class="num" id="4166621">8</span><span class="op" id="4166622">,</span>&nbsp;<span class="ident" id="4166624">rsaKA</span><span class="op" id="4166629">,</span>&nbsp;<span class="num" id="4166631">0</span><span class="op" id="4166632">,</span>&nbsp;<span class="ident" id="4166634">cipher3DES</span><span class="op" id="4166644">,</span>&nbsp;<span class="ident" id="4166646">macSHA1</span><span class="op" id="4166653">,</span>&nbsp;<span class="builtintype" id="4166655">nil</span><span class="op" id="4166658">}</span><span class="op" id="4166659">,</span><br>
<span class="lineno">85</span><span class="op" id="4166661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4166664">func</span>&nbsp;<span class="ident" id="4166669">cipherRC4</span><span class="op" id="4166678">(</span><span class="ident" id="4166679">key</span><span class="op" id="4166682">,</span>&nbsp;<span class="ident" id="4166684">iv</span>&nbsp;<span class="op" id="4166687">[</span><span class="op" id="4166688">]</span><span class="builtintype" id="4166689">byte</span><span class="op" id="4166693">,</span>&nbsp;<span class="ident" id="4166695">isRead</span>&nbsp;<span class="builtintype" id="4166702">bool</span><span class="op" id="4166706">)</span>&nbsp;<span class="keyword" id="4166708">interface</span><span class="op" id="4166717">{</span><span class="op" id="4166718">}</span>&nbsp;<span class="op" id="4166720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4166723">cipher</span><span class="op" id="4166729">,</span>&nbsp;<span class="ident" id="4166731">_</span>&nbsp;<span class="op" id="4166733">:=</span>&nbsp;<span class="ident" id="4166736">rc4</span><span class="op" id="4166739">.</span><span class="ident" id="4166740">NewCipher</span><span class="op" id="4166749">(</span><span class="ident" id="4166750">key</span><span class="op" id="4166753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4166756">return</span>&nbsp;<span class="ident" id="4166763">cipher</span><br>
<span class="lineno">90</span><span class="op" id="4166770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4166773">func</span>&nbsp;<span class="ident" id="4166778">cipher3DES</span><span class="op" id="4166788">(</span><span class="ident" id="4166789">key</span><span class="op" id="4166792">,</span>&nbsp;<span class="ident" id="4166794">iv</span>&nbsp;<span class="op" id="4166797">[</span><span class="op" id="4166798">]</span><span class="builtintype" id="4166799">byte</span><span class="op" id="4166803">,</span>&nbsp;<span class="ident" id="4166805">isRead</span>&nbsp;<span class="builtintype" id="4166812">bool</span><span class="op" id="4166816">)</span>&nbsp;<span class="keyword" id="4166818">interface</span><span class="op" id="4166827">{</span><span class="op" id="4166828">}</span>&nbsp;<span class="op" id="4166830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4166833">block</span><span class="op" id="4166838">,</span>&nbsp;<span class="ident" id="4166840">_</span>&nbsp;<span class="op" id="4166842">:=</span>&nbsp;<span class="ident" id="4166845">des</span><span class="op" id="4166848">.</span><span class="ident" id="4166849">NewTripleDESCipher</span><span class="op" id="4166867">(</span><span class="ident" id="4166868">key</span><span class="op" id="4166871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4166874">if</span>&nbsp;<span class="ident" id="4166877">isRead</span>&nbsp;<span class="op" id="4166884">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4166888">return</span>&nbsp;<span class="ident" id="4166895">cipher</span><span class="op" id="4166901">.</span><span class="ident" id="4166902">NewCBCDecrypter</span><span class="op" id="4166917">(</span><span class="ident" id="4166918">block</span><span class="op" id="4166923">,</span>&nbsp;<span class="ident" id="4166925">iv</span><span class="op" id="4166927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4166933">return</span>&nbsp;<span class="ident" id="4166940">cipher</span><span class="op" id="4166946">.</span><span class="ident" id="4166947">NewCBCEncrypter</span><span class="op" id="4166962">(</span><span class="ident" id="4166963">block</span><span class="op" id="4166968">,</span>&nbsp;<span class="ident" id="4166970">iv</span><span class="op" id="4166972">)</span><br>
<span class="lineno"></span><span class="op" id="4166974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4166977">func</span>&nbsp;<span class="ident" id="4166982">cipherAES</span><span class="op" id="4166991">(</span><span class="ident" id="4166992">key</span><span class="op" id="4166995">,</span>&nbsp;<span class="ident" id="4166997">iv</span>&nbsp;<span class="op" id="4167000">[</span><span class="op" id="4167001">]</span><span class="builtintype" id="4167002">byte</span><span class="op" id="4167006">,</span>&nbsp;<span class="ident" id="4167008">isRead</span>&nbsp;<span class="builtintype" id="4167015">bool</span><span class="op" id="4167019">)</span>&nbsp;<span class="keyword" id="4167021">interface</span><span class="op" id="4167030">{</span><span class="op" id="4167031">}</span>&nbsp;<span class="op" id="4167033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167036">block</span><span class="op" id="4167041">,</span>&nbsp;<span class="ident" id="4167043">_</span>&nbsp;<span class="op" id="4167045">:=</span>&nbsp;<span class="ident" id="4167048">aes</span><span class="op" id="4167051">.</span><span class="ident" id="4167052">NewCipher</span><span class="op" id="4167061">(</span><span class="ident" id="4167062">key</span><span class="op" id="4167065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4167068">if</span>&nbsp;<span class="ident" id="4167071">isRead</span>&nbsp;<span class="op" id="4167078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4167082">return</span>&nbsp;<span class="ident" id="4167089">cipher</span><span class="op" id="4167095">.</span><span class="ident" id="4167096">NewCBCDecrypter</span><span class="op" id="4167111">(</span><span class="ident" id="4167112">block</span><span class="op" id="4167117">,</span>&nbsp;<span class="ident" id="4167119">iv</span><span class="op" id="4167121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4167124">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4167127">return</span>&nbsp;<span class="ident" id="4167134">cipher</span><span class="op" id="4167140">.</span><span class="ident" id="4167141">NewCBCEncrypter</span><span class="op" id="4167156">(</span><span class="ident" id="4167157">block</span><span class="op" id="4167162">,</span>&nbsp;<span class="ident" id="4167164">iv</span><span class="op" id="4167166">)</span><br>
<span class="lineno"></span><span class="op" id="4167168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4167171">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4167236">func</span>&nbsp;<span class="ident" id="4167241">macSHA1</span><span class="op" id="4167248">(</span><span class="ident" id="4167249">version</span>&nbsp;<span class="builtintype" id="4167257">uint16</span><span class="op" id="4167263">,</span>&nbsp;<span class="ident" id="4167265">key</span>&nbsp;<span class="op" id="4167269">[</span><span class="op" id="4167270">]</span><span class="builtintype" id="4167271">byte</span><span class="op" id="4167275">)</span>&nbsp;<span class="ident" id="4167277">macFunction</span>&nbsp;<span class="op" id="4167289">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4167292">if</span>&nbsp;<span class="ident" id="4167295">version</span>&nbsp;<span class="op" id="4167303">==</span>&nbsp;<span class="ident" id="4167306">VersionSSL30</span>&nbsp;<span class="op" id="4167319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167323">mac</span>&nbsp;<span class="op" id="4167327">:=</span>&nbsp;<span class="ident" id="4167330">ssl30MAC</span><span class="op" id="4167338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167343">h</span><span class="op" id="4167344">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4167348">sha1</span><span class="op" id="4167352">.</span><span class="ident" id="4167353">New</span><span class="op" id="4167356">(</span><span class="op" id="4167357">)</span><span class="op" id="4167358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167363">key</span><span class="op" id="4167366">:</span>&nbsp;<span class="builtinfunc" id="4167368">make</span><span class="op" id="4167372">(</span><span class="op" id="4167373">[</span><span class="op" id="4167374">]</span><span class="builtintype" id="4167375">byte</span><span class="op" id="4167379">,</span>&nbsp;<span class="builtinfunc" id="4167381">len</span><span class="op" id="4167384">(</span><span class="ident" id="4167385">key</span><span class="op" id="4167388">)</span><span class="op" id="4167389">)</span><span class="op" id="4167390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4167394">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4167398">copy</span><span class="op" id="4167402">(</span><span class="ident" id="4167403">mac</span><span class="op" id="4167406">.</span><span class="ident" id="4167407">key</span><span class="op" id="4167410">,</span>&nbsp;<span class="ident" id="4167412">key</span><span class="op" id="4167415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4167419">return</span>&nbsp;<span class="ident" id="4167426">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4167431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4167434">return</span>&nbsp;<span class="ident" id="4167441">tls10MAC</span><span class="op" id="4167449">{</span><span class="ident" id="4167450">hmac</span><span class="op" id="4167454">.</span><span class="ident" id="4167455">New</span><span class="op" id="4167458">(</span><span class="ident" id="4167459">sha1</span><span class="op" id="4167463">.</span><span class="ident" id="4167464">New</span><span class="op" id="4167467">,</span>&nbsp;<span class="ident" id="4167469">key</span><span class="op" id="4167472">)</span><span class="op" id="4167473">}</span><br>
<span class="lineno"></span><span class="op" id="4167475">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4167478">type</span>&nbsp;<span class="ident" id="4167483">macFunction</span>&nbsp;<span class="keyword" id="4167495">interface</span>&nbsp;<span class="op" id="4167505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167508">Size</span><span class="op" id="4167512">(</span><span class="op" id="4167513">)</span>&nbsp;<span class="builtintype" id="4167515">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167520">MAC</span><span class="op" id="4167523">(</span><span class="ident" id="4167524">digestBuf</span><span class="op" id="4167533">,</span>&nbsp;<span class="ident" id="4167535">seq</span><span class="op" id="4167538">,</span>&nbsp;<span class="ident" id="4167540">header</span><span class="op" id="4167546">,</span>&nbsp;<span class="ident" id="4167548">data</span>&nbsp;<span class="op" id="4167553">[</span><span class="op" id="4167554">]</span><span class="builtintype" id="4167555">byte</span><span class="op" id="4167559">)</span>&nbsp;<span class="op" id="4167561">[</span><span class="op" id="4167562">]</span><span class="builtintype" id="4167563">byte</span><br>
<span class="lineno"></span><span class="op" id="4167568">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4167571">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4167648">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4167662">type</span>&nbsp;<span class="ident" id="4167667">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4167682">struct</span>&nbsp;<span class="op" id="4167689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4167692">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4167763">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4167827">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167882">sealNonce</span><span class="op" id="4167891">,</span>&nbsp;<span class="ident" id="4167893">openNonce</span>&nbsp;<span class="op" id="4167903">[</span><span class="op" id="4167904">]</span><span class="builtintype" id="4167905">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167911">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4167932">cipher</span><span class="op" id="4167938">.</span><span class="ident" id="4167939">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4167944">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4167947">func</span>&nbsp;<span class="op" id="4167952">(</span><span class="ident" id="4167953">f</span>&nbsp;<span class="op" id="4167955">*</span><span class="ident" id="4167956">fixedNonceAEAD</span><span class="op" id="4167970">)</span>&nbsp;<span class="ident" id="4167972">NonceSize</span><span class="op" id="4167981">(</span><span class="op" id="4167982">)</span>&nbsp;<span class="builtintype" id="4167984">int</span>&nbsp;<span class="op" id="4167988">{</span>&nbsp;<span class="keyword" id="4167990">return</span>&nbsp;<span class="num" id="4167997">8</span>&nbsp;<span class="op" id="4167999">}</span><br>
<span class="lineno"></span><span class="keyword" id="4168001">func</span>&nbsp;<span class="op" id="4168006">(</span><span class="ident" id="4168007">f</span>&nbsp;<span class="op" id="4168009">*</span><span class="ident" id="4168010">fixedNonceAEAD</span><span class="op" id="4168024">)</span>&nbsp;<span class="ident" id="4168026">Overhead</span><span class="op" id="4168034">(</span><span class="op" id="4168035">)</span>&nbsp;<span class="builtintype" id="4168037">int</span>&nbsp;&nbsp;<span class="op" id="4168042">{</span>&nbsp;<span class="keyword" id="4168044">return</span>&nbsp;<span class="ident" id="4168051">f</span><span class="op" id="4168052">.</span><span class="ident" id="4168053">aead</span><span class="op" id="4168057">.</span><span class="ident" id="4168058">Overhead</span><span class="op" id="4168066">(</span><span class="op" id="4168067">)</span>&nbsp;<span class="op" id="4168069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4168072">func</span>&nbsp;<span class="op" id="4168077">(</span><span class="ident" id="4168078">f</span>&nbsp;<span class="op" id="4168080">*</span><span class="ident" id="4168081">fixedNonceAEAD</span><span class="op" id="4168095">)</span>&nbsp;<span class="ident" id="4168097">Seal</span><span class="op" id="4168101">(</span><span class="ident" id="4168102">out</span><span class="op" id="4168105">,</span>&nbsp;<span class="ident" id="4168107">nonce</span><span class="op" id="4168112">,</span>&nbsp;<span class="ident" id="4168114">plaintext</span><span class="op" id="4168123">,</span>&nbsp;<span class="ident" id="4168125">additionalData</span>&nbsp;<span class="op" id="4168140">[</span><span class="op" id="4168141">]</span><span class="builtintype" id="4168142">byte</span><span class="op" id="4168146">)</span>&nbsp;<span class="op" id="4168148">[</span><span class="op" id="4168149">]</span><span class="builtintype" id="4168150">byte</span>&nbsp;<span class="op" id="4168155">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4168158">copy</span><span class="op" id="4168162">(</span><span class="ident" id="4168163">f</span><span class="op" id="4168164">.</span><span class="ident" id="4168165">sealNonce</span><span class="op" id="4168174">[</span><span class="builtinfunc" id="4168175">len</span><span class="op" id="4168178">(</span><span class="ident" id="4168179">f</span><span class="op" id="4168180">.</span><span class="ident" id="4168181">sealNonce</span><span class="op" id="4168190">)</span><span class="op" id="4168191">-</span><span class="num" id="4168192">8</span><span class="op" id="4168193">:</span><span class="op" id="4168194">]</span><span class="op" id="4168195">,</span>&nbsp;<span class="ident" id="4168197">nonce</span><span class="op" id="4168202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4168205">return</span>&nbsp;<span class="ident" id="4168212">f</span><span class="op" id="4168213">.</span><span class="ident" id="4168214">aead</span><span class="op" id="4168218">.</span><span class="ident" id="4168219">Seal</span><span class="op" id="4168223">(</span><span class="ident" id="4168224">out</span><span class="op" id="4168227">,</span>&nbsp;<span class="ident" id="4168229">f</span><span class="op" id="4168230">.</span><span class="ident" id="4168231">sealNonce</span><span class="op" id="4168240">,</span>&nbsp;<span class="ident" id="4168242">plaintext</span><span class="op" id="4168251">,</span>&nbsp;<span class="ident" id="4168253">additionalData</span><span class="op" id="4168267">)</span><br>
<span class="lineno"></span><span class="op" id="4168269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4168272">func</span>&nbsp;<span class="op" id="4168277">(</span><span class="ident" id="4168278">f</span>&nbsp;<span class="op" id="4168280">*</span><span class="ident" id="4168281">fixedNonceAEAD</span><span class="op" id="4168295">)</span>&nbsp;<span class="ident" id="4168297">Open</span><span class="op" id="4168301">(</span><span class="ident" id="4168302">out</span><span class="op" id="4168305">,</span>&nbsp;<span class="ident" id="4168307">nonce</span><span class="op" id="4168312">,</span>&nbsp;<span class="ident" id="4168314">plaintext</span><span class="op" id="4168323">,</span>&nbsp;<span class="ident" id="4168325">additionalData</span>&nbsp;<span class="op" id="4168340">[</span><span class="op" id="4168341">]</span><span class="builtintype" id="4168342">byte</span><span class="op" id="4168346">)</span>&nbsp;<span class="op" id="4168348">(</span><span class="op" id="4168349">[</span><span class="op" id="4168350">]</span><span class="builtintype" id="4168351">byte</span><span class="op" id="4168355">,</span>&nbsp;<span class="builtintype" id="4168357">error</span><span class="op" id="4168362">)</span>&nbsp;<span class="op" id="4168364">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4168367">copy</span><span class="op" id="4168371">(</span><span class="ident" id="4168372">f</span><span class="op" id="4168373">.</span><span class="ident" id="4168374">openNonce</span><span class="op" id="4168383">[</span><span class="builtinfunc" id="4168384">len</span><span class="op" id="4168387">(</span><span class="ident" id="4168388">f</span><span class="op" id="4168389">.</span><span class="ident" id="4168390">openNonce</span><span class="op" id="4168399">)</span><span class="op" id="4168400">-</span><span class="num" id="4168401">8</span><span class="op" id="4168402">:</span><span class="op" id="4168403">]</span><span class="op" id="4168404">,</span>&nbsp;<span class="ident" id="4168406">nonce</span><span class="op" id="4168411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4168414">return</span>&nbsp;<span class="ident" id="4168421">f</span><span class="op" id="4168422">.</span><span class="ident" id="4168423">aead</span><span class="op" id="4168427">.</span><span class="ident" id="4168428">Open</span><span class="op" id="4168432">(</span><span class="ident" id="4168433">out</span><span class="op" id="4168436">,</span>&nbsp;<span class="ident" id="4168438">f</span><span class="op" id="4168439">.</span><span class="ident" id="4168440">openNonce</span><span class="op" id="4168449">,</span>&nbsp;<span class="ident" id="4168451">plaintext</span><span class="op" id="4168460">,</span>&nbsp;<span class="ident" id="4168462">additionalData</span><span class="op" id="4168476">)</span><br>
<span class="lineno"></span><span class="op" id="4168478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4168481">func</span>&nbsp;<span class="ident" id="4168486">aeadAESGCM</span><span class="op" id="4168496">(</span><span class="ident" id="4168497">key</span><span class="op" id="4168500">,</span>&nbsp;<span class="ident" id="4168502">fixedNonce</span>&nbsp;<span class="op" id="4168513">[</span><span class="op" id="4168514">]</span><span class="builtintype" id="4168515">byte</span><span class="op" id="4168519">)</span>&nbsp;<span class="ident" id="4168521">cipher</span><span class="op" id="4168527">.</span><span class="ident" id="4168528">AEAD</span>&nbsp;<span class="op" id="4168533">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4168536">aes</span><span class="op" id="4168539">,</span>&nbsp;<span class="ident" id="4168541">err</span>&nbsp;<span class="op" id="4168545">:=</span>&nbsp;<span class="ident" id="4168548">aes</span><span class="op" id="4168551">.</span><span class="ident" id="4168552">NewCipher</span><span class="op" id="4168561">(</span><span class="ident" id="4168562">key</span><span class="op" id="4168565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4168568">if</span>&nbsp;<span class="ident" id="4168571">err</span>&nbsp;<span class="op" id="4168575">!=</span>&nbsp;<span class="builtintype" id="4168578">nil</span>&nbsp;<span class="op" id="4168582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4168586">panic</span><span class="op" id="4168591">(</span><span class="ident" id="4168592">err</span><span class="op" id="4168595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4168598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4168601">aead</span><span class="op" id="4168605">,</span>&nbsp;<span class="ident" id="4168607">err</span>&nbsp;<span class="op" id="4168611">:=</span>&nbsp;<span class="ident" id="4168614">cipher</span><span class="op" id="4168620">.</span><span class="ident" id="4168621">NewGCM</span><span class="op" id="4168627">(</span><span class="ident" id="4168628">aes</span><span class="op" id="4168631">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4168634">if</span>&nbsp;<span class="ident" id="4168637">err</span>&nbsp;<span class="op" id="4168641">!=</span>&nbsp;<span class="builtintype" id="4168644">nil</span>&nbsp;<span class="op" id="4168648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4168652">panic</span><span class="op" id="4168657">(</span><span class="ident" id="4168658">err</span><span class="op" id="4168661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4168664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4168668">nonce1</span><span class="op" id="4168674">,</span>&nbsp;<span class="ident" id="4168676">nonce2</span>&nbsp;<span class="op" id="4168683">:=</span>&nbsp;<span class="builtinfunc" id="4168686">make</span><span class="op" id="4168690">(</span><span class="op" id="4168691">[</span><span class="op" id="4168692">]</span><span class="builtintype" id="4168693">byte</span><span class="op" id="4168697">,</span>&nbsp;<span class="num" id="4168699">12</span><span class="op" id="4168701">)</span><span class="op" id="4168702">,</span>&nbsp;<span class="builtinfunc" id="4168704">make</span><span class="op" id="4168708">(</span><span class="op" id="4168709">[</span><span class="op" id="4168710">]</span><span class="builtintype" id="4168711">byte</span><span class="op" id="4168715">,</span>&nbsp;<span class="num" id="4168717">12</span><span class="op" id="4168719">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4168722">copy</span><span class="op" id="4168726">(</span><span class="ident" id="4168727">nonce1</span><span class="op" id="4168733">,</span>&nbsp;<span class="ident" id="4168735">fixedNonce</span><span class="op" id="4168745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4168748">copy</span><span class="op" id="4168752">(</span><span class="ident" id="4168753">nonce2</span><span class="op" id="4168759">,</span>&nbsp;<span class="ident" id="4168761">fixedNonce</span><span class="op" id="4168771">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4168775">return</span>&nbsp;<span class="op" id="4168782">&amp;</span><span class="ident" id="4168783">fixedNonceAEAD</span><span class="op" id="4168797">{</span><span class="ident" id="4168798">nonce1</span><span class="op" id="4168804">,</span>&nbsp;<span class="ident" id="4168806">nonce2</span><span class="op" id="4168812">,</span>&nbsp;<span class="ident" id="4168814">aead</span><span class="op" id="4168818">}</span><br>
<span class="lineno"></span><span class="op" id="4168820">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4168823">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4168884">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4168962">type</span>&nbsp;<span class="ident" id="4168967">ssl30MAC</span>&nbsp;<span class="keyword" id="4168976">struct</span>&nbsp;<span class="op" id="4168983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4168986">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4168990">hash</span><span class="op" id="4168994">.</span><span class="ident" id="4168995">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169001">key</span>&nbsp;<span class="op" id="4169005">[</span><span class="op" id="4169006">]</span><span class="builtintype" id="4169007">byte</span><br>
<span class="lineno"></span><span class="op" id="4169012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4169015">func</span>&nbsp;<span class="op" id="4169020">(</span><span class="ident" id="4169021">s</span>&nbsp;<span class="ident" id="4169023">ssl30MAC</span><span class="op" id="4169031">)</span>&nbsp;<span class="ident" id="4169033">Size</span><span class="op" id="4169037">(</span><span class="op" id="4169038">)</span>&nbsp;<span class="builtintype" id="4169040">int</span>&nbsp;<span class="op" id="4169044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4169047">return</span>&nbsp;<span class="ident" id="4169054">s</span><span class="op" id="4169055">.</span><span class="ident" id="4169056">h</span><span class="op" id="4169057">.</span><span class="ident" id="4169058">Size</span><span class="op" id="4169062">(</span><span class="op" id="4169063">)</span><br>
<span class="lineno">175</span><span class="op" id="4169065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4169068">var</span>&nbsp;<span class="ident" id="4169072">ssl30Pad1</span>&nbsp;<span class="op" id="4169082">=</span>&nbsp;<span class="op" id="4169084">[</span><span class="num" id="4169085">48</span><span class="op" id="4169087">]</span><span class="builtintype" id="4169088">byte</span><span class="op" id="4169092">{</span><span class="num" id="4169093">0x36</span><span class="op" id="4169097">,</span>&nbsp;<span class="num" id="4169099">0x36</span><span class="op" id="4169103">,</span>&nbsp;<span class="num" id="4169105">0x36</span><span class="op" id="4169109">,</span>&nbsp;<span class="num" id="4169111">0x36</span><span class="op" id="4169115">,</span>&nbsp;<span class="num" id="4169117">0x36</span><span class="op" id="4169121">,</span>&nbsp;<span class="num" id="4169123">0x36</span><span class="op" id="4169127">,</span>&nbsp;<span class="num" id="4169129">0x36</span><span class="op" id="4169133">,</span>&nbsp;<span class="num" id="4169135">0x36</span><span class="op" id="4169139">,</span>&nbsp;<span class="num" id="4169141">0x36</span><span class="op" id="4169145">,</span>&nbsp;<span class="num" id="4169147">0x36</span><span class="op" id="4169151">,</span>&nbsp;<span class="num" id="4169153">0x36</span><span class="op" id="4169157">,</span>&nbsp;<span class="num" id="4169159">0x36</span><span class="op" id="4169163">,</span>&nbsp;<span class="num" id="4169165">0x36</span><span class="op" id="4169169">,</span>&nbsp;<span class="num" id="4169171">0x36</span><span class="op" id="4169175">,</span>&nbsp;<span class="num" id="4169177">0x36</span><span class="op" id="4169181">,</span>&nbsp;<span class="num" id="4169183">0x36</span><span class="op" id="4169187">,</span>&nbsp;<span class="num" id="4169189">0x36</span><span class="op" id="4169193">,</span>&nbsp;<span class="num" id="4169195">0x36</span><span class="op" id="4169199">,</span>&nbsp;<span class="num" id="4169201">0x36</span><span class="op" id="4169205">,</span>&nbsp;<span class="num" id="4169207">0x36</span><span class="op" id="4169211">,</span>&nbsp;<span class="num" id="4169213">0x36</span><span class="op" id="4169217">,</span>&nbsp;<span class="num" id="4169219">0x36</span><span class="op" id="4169223">,</span>&nbsp;<span class="num" id="4169225">0x36</span><span class="op" id="4169229">,</span>&nbsp;<span class="num" id="4169231">0x36</span><span class="op" id="4169235">,</span>&nbsp;<span class="num" id="4169237">0x36</span><span class="op" id="4169241">,</span>&nbsp;<span class="num" id="4169243">0x36</span><span class="op" id="4169247">,</span>&nbsp;<span class="num" id="4169249">0x36</span><span class="op" id="4169253">,</span>&nbsp;<span class="num" id="4169255">0x36</span><span class="op" id="4169259">,</span>&nbsp;<span class="num" id="4169261">0x36</span><span class="op" id="4169265">,</span>&nbsp;<span class="num" id="4169267">0x36</span><span class="op" id="4169271">,</span>&nbsp;<span class="num" id="4169273">0x36</span><span class="op" id="4169277">,</span>&nbsp;<span class="num" id="4169279">0x36</span><span class="op" id="4169283">,</span>&nbsp;<span class="num" id="4169285">0x36</span><span class="op" id="4169289">,</span>&nbsp;<span class="num" id="4169291">0x36</span><span class="op" id="4169295">,</span>&nbsp;<span class="num" id="4169297">0x36</span><span class="op" id="4169301">,</span>&nbsp;<span class="num" id="4169303">0x36</span><span class="op" id="4169307">,</span>&nbsp;<span class="num" id="4169309">0x36</span><span class="op" id="4169313">,</span>&nbsp;<span class="num" id="4169315">0x36</span><span class="op" id="4169319">,</span>&nbsp;<span class="num" id="4169321">0x36</span><span class="op" id="4169325">,</span>&nbsp;<span class="num" id="4169327">0x36</span><span class="op" id="4169331">,</span>&nbsp;<span class="num" id="4169333">0x36</span><span class="op" id="4169337">,</span>&nbsp;<span class="num" id="4169339">0x36</span><span class="op" id="4169343">,</span>&nbsp;<span class="num" id="4169345">0x36</span><span class="op" id="4169349">,</span>&nbsp;<span class="num" id="4169351">0x36</span><span class="op" id="4169355">,</span>&nbsp;<span class="num" id="4169357">0x36</span><span class="op" id="4169361">,</span>&nbsp;<span class="num" id="4169363">0x36</span><span class="op" id="4169367">,</span>&nbsp;<span class="num" id="4169369">0x36</span><span class="op" id="4169373">,</span>&nbsp;<span class="num" id="4169375">0x36</span><span class="op" id="4169379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4169382">var</span>&nbsp;<span class="ident" id="4169386">ssl30Pad2</span>&nbsp;<span class="op" id="4169396">=</span>&nbsp;<span class="op" id="4169398">[</span><span class="num" id="4169399">48</span><span class="op" id="4169401">]</span><span class="builtintype" id="4169402">byte</span><span class="op" id="4169406">{</span><span class="num" id="4169407">0x5c</span><span class="op" id="4169411">,</span>&nbsp;<span class="num" id="4169413">0x5c</span><span class="op" id="4169417">,</span>&nbsp;<span class="num" id="4169419">0x5c</span><span class="op" id="4169423">,</span>&nbsp;<span class="num" id="4169425">0x5c</span><span class="op" id="4169429">,</span>&nbsp;<span class="num" id="4169431">0x5c</span><span class="op" id="4169435">,</span>&nbsp;<span class="num" id="4169437">0x5c</span><span class="op" id="4169441">,</span>&nbsp;<span class="num" id="4169443">0x5c</span><span class="op" id="4169447">,</span>&nbsp;<span class="num" id="4169449">0x5c</span><span class="op" id="4169453">,</span>&nbsp;<span class="num" id="4169455">0x5c</span><span class="op" id="4169459">,</span>&nbsp;<span class="num" id="4169461">0x5c</span><span class="op" id="4169465">,</span>&nbsp;<span class="num" id="4169467">0x5c</span><span class="op" id="4169471">,</span>&nbsp;<span class="num" id="4169473">0x5c</span><span class="op" id="4169477">,</span>&nbsp;<span class="num" id="4169479">0x5c</span><span class="op" id="4169483">,</span>&nbsp;<span class="num" id="4169485">0x5c</span><span class="op" id="4169489">,</span>&nbsp;<span class="num" id="4169491">0x5c</span><span class="op" id="4169495">,</span>&nbsp;<span class="num" id="4169497">0x5c</span><span class="op" id="4169501">,</span>&nbsp;<span class="num" id="4169503">0x5c</span><span class="op" id="4169507">,</span>&nbsp;<span class="num" id="4169509">0x5c</span><span class="op" id="4169513">,</span>&nbsp;<span class="num" id="4169515">0x5c</span><span class="op" id="4169519">,</span>&nbsp;<span class="num" id="4169521">0x5c</span><span class="op" id="4169525">,</span>&nbsp;<span class="num" id="4169527">0x5c</span><span class="op" id="4169531">,</span>&nbsp;<span class="num" id="4169533">0x5c</span><span class="op" id="4169537">,</span>&nbsp;<span class="num" id="4169539">0x5c</span><span class="op" id="4169543">,</span>&nbsp;<span class="num" id="4169545">0x5c</span><span class="op" id="4169549">,</span>&nbsp;<span class="num" id="4169551">0x5c</span><span class="op" id="4169555">,</span>&nbsp;<span class="num" id="4169557">0x5c</span><span class="op" id="4169561">,</span>&nbsp;<span class="num" id="4169563">0x5c</span><span class="op" id="4169567">,</span>&nbsp;<span class="num" id="4169569">0x5c</span><span class="op" id="4169573">,</span>&nbsp;<span class="num" id="4169575">0x5c</span><span class="op" id="4169579">,</span>&nbsp;<span class="num" id="4169581">0x5c</span><span class="op" id="4169585">,</span>&nbsp;<span class="num" id="4169587">0x5c</span><span class="op" id="4169591">,</span>&nbsp;<span class="num" id="4169593">0x5c</span><span class="op" id="4169597">,</span>&nbsp;<span class="num" id="4169599">0x5c</span><span class="op" id="4169603">,</span>&nbsp;<span class="num" id="4169605">0x5c</span><span class="op" id="4169609">,</span>&nbsp;<span class="num" id="4169611">0x5c</span><span class="op" id="4169615">,</span>&nbsp;<span class="num" id="4169617">0x5c</span><span class="op" id="4169621">,</span>&nbsp;<span class="num" id="4169623">0x5c</span><span class="op" id="4169627">,</span>&nbsp;<span class="num" id="4169629">0x5c</span><span class="op" id="4169633">,</span>&nbsp;<span class="num" id="4169635">0x5c</span><span class="op" id="4169639">,</span>&nbsp;<span class="num" id="4169641">0x5c</span><span class="op" id="4169645">,</span>&nbsp;<span class="num" id="4169647">0x5c</span><span class="op" id="4169651">,</span>&nbsp;<span class="num" id="4169653">0x5c</span><span class="op" id="4169657">,</span>&nbsp;<span class="num" id="4169659">0x5c</span><span class="op" id="4169663">,</span>&nbsp;<span class="num" id="4169665">0x5c</span><span class="op" id="4169669">,</span>&nbsp;<span class="num" id="4169671">0x5c</span><span class="op" id="4169675">,</span>&nbsp;<span class="num" id="4169677">0x5c</span><span class="op" id="4169681">,</span>&nbsp;<span class="num" id="4169683">0x5c</span><span class="op" id="4169687">,</span>&nbsp;<span class="num" id="4169689">0x5c</span><span class="op" id="4169693">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4169696">func</span>&nbsp;<span class="op" id="4169701">(</span><span class="ident" id="4169702">s</span>&nbsp;<span class="ident" id="4169704">ssl30MAC</span><span class="op" id="4169712">)</span>&nbsp;<span class="ident" id="4169714">MAC</span><span class="op" id="4169717">(</span><span class="ident" id="4169718">digestBuf</span><span class="op" id="4169727">,</span>&nbsp;<span class="ident" id="4169729">seq</span><span class="op" id="4169732">,</span>&nbsp;<span class="ident" id="4169734">header</span><span class="op" id="4169740">,</span>&nbsp;<span class="ident" id="4169742">data</span>&nbsp;<span class="op" id="4169747">[</span><span class="op" id="4169748">]</span><span class="builtintype" id="4169749">byte</span><span class="op" id="4169753">)</span>&nbsp;<span class="op" id="4169755">[</span><span class="op" id="4169756">]</span><span class="builtintype" id="4169757">byte</span>&nbsp;<span class="op" id="4169762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169765">padLength</span>&nbsp;<span class="op" id="4169775">:=</span>&nbsp;<span class="num" id="4169778">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4169782">if</span>&nbsp;<span class="ident" id="4169785">s</span><span class="op" id="4169786">.</span><span class="ident" id="4169787">h</span><span class="op" id="4169788">.</span><span class="ident" id="4169789">Size</span><span class="op" id="4169793">(</span><span class="op" id="4169794">)</span>&nbsp;<span class="op" id="4169796">==</span>&nbsp;<span class="num" id="4169799">20</span>&nbsp;<span class="op" id="4169802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169806">padLength</span>&nbsp;<span class="op" id="4169816">=</span>&nbsp;<span class="num" id="4169818">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169826">s</span><span class="op" id="4169827">.</span><span class="ident" id="4169828">h</span><span class="op" id="4169829">.</span><span class="ident" id="4169830">Reset</span><span class="op" id="4169835">(</span><span class="op" id="4169836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169839">s</span><span class="op" id="4169840">.</span><span class="ident" id="4169841">h</span><span class="op" id="4169842">.</span><span class="ident" id="4169843">Write</span><span class="op" id="4169848">(</span><span class="ident" id="4169849">s</span><span class="op" id="4169850">.</span><span class="ident" id="4169851">key</span><span class="op" id="4169854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169857">s</span><span class="op" id="4169858">.</span><span class="ident" id="4169859">h</span><span class="op" id="4169860">.</span><span class="ident" id="4169861">Write</span><span class="op" id="4169866">(</span><span class="ident" id="4169867">ssl30Pad1</span><span class="op" id="4169876">[</span><span class="op" id="4169877">:</span><span class="ident" id="4169878">padLength</span><span class="op" id="4169887">]</span><span class="op" id="4169888">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169891">s</span><span class="op" id="4169892">.</span><span class="ident" id="4169893">h</span><span class="op" id="4169894">.</span><span class="ident" id="4169895">Write</span><span class="op" id="4169900">(</span><span class="ident" id="4169901">seq</span><span class="op" id="4169904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169907">s</span><span class="op" id="4169908">.</span><span class="ident" id="4169909">h</span><span class="op" id="4169910">.</span><span class="ident" id="4169911">Write</span><span class="op" id="4169916">(</span><span class="ident" id="4169917">header</span><span class="op" id="4169923">[</span><span class="op" id="4169924">:</span><span class="num" id="4169925">1</span><span class="op" id="4169926">]</span><span class="op" id="4169927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169930">s</span><span class="op" id="4169931">.</span><span class="ident" id="4169932">h</span><span class="op" id="4169933">.</span><span class="ident" id="4169934">Write</span><span class="op" id="4169939">(</span><span class="ident" id="4169940">header</span><span class="op" id="4169946">[</span><span class="num" id="4169947">3</span><span class="op" id="4169948">:</span><span class="num" id="4169949">5</span><span class="op" id="4169950">]</span><span class="op" id="4169951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169954">s</span><span class="op" id="4169955">.</span><span class="ident" id="4169956">h</span><span class="op" id="4169957">.</span><span class="ident" id="4169958">Write</span><span class="op" id="4169963">(</span><span class="ident" id="4169964">data</span><span class="op" id="4169968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169971">digestBuf</span>&nbsp;<span class="op" id="4169981">=</span>&nbsp;<span class="ident" id="4169983">s</span><span class="op" id="4169984">.</span><span class="ident" id="4169985">h</span><span class="op" id="4169986">.</span><span class="ident" id="4169987">Sum</span><span class="op" id="4169990">(</span><span class="ident" id="4169991">digestBuf</span><span class="op" id="4170000">[</span><span class="op" id="4170001">:</span><span class="num" id="4170002">0</span><span class="op" id="4170003">]</span><span class="op" id="4170004">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170008">s</span><span class="op" id="4170009">.</span><span class="ident" id="4170010">h</span><span class="op" id="4170011">.</span><span class="ident" id="4170012">Reset</span><span class="op" id="4170017">(</span><span class="op" id="4170018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170021">s</span><span class="op" id="4170022">.</span><span class="ident" id="4170023">h</span><span class="op" id="4170024">.</span><span class="ident" id="4170025">Write</span><span class="op" id="4170030">(</span><span class="ident" id="4170031">s</span><span class="op" id="4170032">.</span><span class="ident" id="4170033">key</span><span class="op" id="4170036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170039">s</span><span class="op" id="4170040">.</span><span class="ident" id="4170041">h</span><span class="op" id="4170042">.</span><span class="ident" id="4170043">Write</span><span class="op" id="4170048">(</span><span class="ident" id="4170049">ssl30Pad2</span><span class="op" id="4170058">[</span><span class="op" id="4170059">:</span><span class="ident" id="4170060">padLength</span><span class="op" id="4170069">]</span><span class="op" id="4170070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170073">s</span><span class="op" id="4170074">.</span><span class="ident" id="4170075">h</span><span class="op" id="4170076">.</span><span class="ident" id="4170077">Write</span><span class="op" id="4170082">(</span><span class="ident" id="4170083">digestBuf</span><span class="op" id="4170092">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4170095">return</span>&nbsp;<span class="ident" id="4170102">s</span><span class="op" id="4170103">.</span><span class="ident" id="4170104">h</span><span class="op" id="4170105">.</span><span class="ident" id="4170106">Sum</span><span class="op" id="4170109">(</span><span class="ident" id="4170110">digestBuf</span><span class="op" id="4170119">[</span><span class="op" id="4170120">:</span><span class="num" id="4170121">0</span><span class="op" id="4170122">]</span><span class="op" id="4170123">)</span><br>
<span class="lineno"></span><span class="op" id="4170125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4170128">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4170202">type</span>&nbsp;<span class="ident" id="4170207">tls10MAC</span>&nbsp;<span class="keyword" id="4170216">struct</span>&nbsp;<span class="op" id="4170223">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170226">h</span>&nbsp;<span class="ident" id="4170228">hash</span><span class="op" id="4170232">.</span><span class="ident" id="4170233">Hash</span><br>
<span class="lineno"></span><span class="op" id="4170238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4170241">func</span>&nbsp;<span class="op" id="4170246">(</span><span class="ident" id="4170247">s</span>&nbsp;<span class="ident" id="4170249">tls10MAC</span><span class="op" id="4170257">)</span>&nbsp;<span class="ident" id="4170259">Size</span><span class="op" id="4170263">(</span><span class="op" id="4170264">)</span>&nbsp;<span class="builtintype" id="4170266">int</span>&nbsp;<span class="op" id="4170270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4170273">return</span>&nbsp;<span class="ident" id="4170280">s</span><span class="op" id="4170281">.</span><span class="ident" id="4170282">h</span><span class="op" id="4170283">.</span><span class="ident" id="4170284">Size</span><span class="op" id="4170288">(</span><span class="op" id="4170289">)</span><br>
<span class="lineno">210</span><span class="op" id="4170291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4170294">func</span>&nbsp;<span class="op" id="4170299">(</span><span class="ident" id="4170300">s</span>&nbsp;<span class="ident" id="4170302">tls10MAC</span><span class="op" id="4170310">)</span>&nbsp;<span class="ident" id="4170312">MAC</span><span class="op" id="4170315">(</span><span class="ident" id="4170316">digestBuf</span><span class="op" id="4170325">,</span>&nbsp;<span class="ident" id="4170327">seq</span><span class="op" id="4170330">,</span>&nbsp;<span class="ident" id="4170332">header</span><span class="op" id="4170338">,</span>&nbsp;<span class="ident" id="4170340">data</span>&nbsp;<span class="op" id="4170345">[</span><span class="op" id="4170346">]</span><span class="builtintype" id="4170347">byte</span><span class="op" id="4170351">)</span>&nbsp;<span class="op" id="4170353">[</span><span class="op" id="4170354">]</span><span class="builtintype" id="4170355">byte</span>&nbsp;<span class="op" id="4170360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170363">s</span><span class="op" id="4170364">.</span><span class="ident" id="4170365">h</span><span class="op" id="4170366">.</span><span class="ident" id="4170367">Reset</span><span class="op" id="4170372">(</span><span class="op" id="4170373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170376">s</span><span class="op" id="4170377">.</span><span class="ident" id="4170378">h</span><span class="op" id="4170379">.</span><span class="ident" id="4170380">Write</span><span class="op" id="4170385">(</span><span class="ident" id="4170386">seq</span><span class="op" id="4170389">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170392">s</span><span class="op" id="4170393">.</span><span class="ident" id="4170394">h</span><span class="op" id="4170395">.</span><span class="ident" id="4170396">Write</span><span class="op" id="4170401">(</span><span class="ident" id="4170402">header</span><span class="op" id="4170408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170411">s</span><span class="op" id="4170412">.</span><span class="ident" id="4170413">h</span><span class="op" id="4170414">.</span><span class="ident" id="4170415">Write</span><span class="op" id="4170420">(</span><span class="ident" id="4170421">data</span><span class="op" id="4170425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4170428">return</span>&nbsp;<span class="ident" id="4170435">s</span><span class="op" id="4170436">.</span><span class="ident" id="4170437">h</span><span class="op" id="4170438">.</span><span class="ident" id="4170439">Sum</span><span class="op" id="4170442">(</span><span class="ident" id="4170443">digestBuf</span><span class="op" id="4170452">[</span><span class="op" id="4170453">:</span><span class="num" id="4170454">0</span><span class="op" id="4170455">]</span><span class="op" id="4170456">)</span><br>
<span class="lineno"></span><span class="op" id="4170458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4170461">func</span>&nbsp;<span class="ident" id="4170466">rsaKA</span><span class="op" id="4170471">(</span><span class="ident" id="4170472">version</span>&nbsp;<span class="builtintype" id="4170480">uint16</span><span class="op" id="4170486">)</span>&nbsp;<span class="ident" id="4170488">keyAgreement</span>&nbsp;<span class="op" id="4170501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4170504">return</span>&nbsp;<span class="ident" id="4170511">rsaKeyAgreement</span><span class="op" id="4170526">{</span><span class="op" id="4170527">}</span><br>
<span class="lineno"></span><span class="op" id="4170529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4170532">func</span>&nbsp;<span class="ident" id="4170537">ecdheECDSAKA</span><span class="op" id="4170549">(</span><span class="ident" id="4170550">version</span>&nbsp;<span class="builtintype" id="4170558">uint16</span><span class="op" id="4170564">)</span>&nbsp;<span class="ident" id="4170566">keyAgreement</span>&nbsp;<span class="op" id="4170579">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4170582">return</span>&nbsp;<span class="op" id="4170589">&amp;</span><span class="ident" id="4170590">ecdheKeyAgreement</span><span class="op" id="4170607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170611">sigType</span><span class="op" id="4170618">:</span>&nbsp;<span class="ident" id="4170620">signatureECDSA</span><span class="op" id="4170634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170638">version</span><span class="op" id="4170645">:</span>&nbsp;<span class="ident" id="4170647">version</span><span class="op" id="4170654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4170657">}</span><br>
<span class="lineno"></span><span class="op" id="4170659">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4170662">func</span>&nbsp;<span class="ident" id="4170667">ecdheRSAKA</span><span class="op" id="4170677">(</span><span class="ident" id="4170678">version</span>&nbsp;<span class="builtintype" id="4170686">uint16</span><span class="op" id="4170692">)</span>&nbsp;<span class="ident" id="4170694">keyAgreement</span>&nbsp;<span class="op" id="4170707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4170710">return</span>&nbsp;<span class="op" id="4170717">&amp;</span><span class="ident" id="4170718">ecdheKeyAgreement</span><span class="op" id="4170735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170739">sigType</span><span class="op" id="4170746">:</span>&nbsp;<span class="ident" id="4170748">signatureRSA</span><span class="op" id="4170760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4170764">version</span><span class="op" id="4170771">:</span>&nbsp;<span class="ident" id="4170773">version</span><span class="op" id="4170780">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4170783">}</span><br>
<span class="lineno"></span><span class="op" id="4170785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4170788">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4170857">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4170907">func</span>&nbsp;<span class="ident" id="4170912">mutualCipherSuite</span><span class="op" id="4170929">(</span><span class="ident" id="4170930">have</span>&nbsp;<span class="op" id="4170935">[</span><span class="op" id="4170936">]</span><span class="builtintype" id="4170937">uint16</span><span class="op" id="4170943">,</span>&nbsp;<span class="ident" id="4170945">want</span>&nbsp;<span class="builtintype" id="4170950">uint16</span><span class="op" id="4170956">)</span>&nbsp;<span class="op" id="4170958">*</span><span class="ident" id="4170959">cipherSuite</span>&nbsp;<span class="op" id="4170971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4170974">for</span>&nbsp;<span class="ident" id="4170978">_</span><span class="op" id="4170979">,</span>&nbsp;<span class="ident" id="4170981">id</span>&nbsp;<span class="op" id="4170984">:=</span>&nbsp;<span class="keyword" id="4170987">range</span>&nbsp;<span class="ident" id="4170993">have</span>&nbsp;<span class="op" id="4170998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4171002">if</span>&nbsp;<span class="ident" id="4171005">id</span>&nbsp;<span class="op" id="4171008">==</span>&nbsp;<span class="ident" id="4171011">want</span>&nbsp;<span class="op" id="4171016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4171021">for</span>&nbsp;<span class="ident" id="4171025">_</span><span class="op" id="4171026">,</span>&nbsp;<span class="ident" id="4171028">suite</span>&nbsp;<span class="op" id="4171034">:=</span>&nbsp;<span class="keyword" id="4171037">range</span>&nbsp;<span class="ident" id="4171043">cipherSuites</span>&nbsp;<span class="op" id="4171056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4171062">if</span>&nbsp;<span class="ident" id="4171065">suite</span><span class="op" id="4171070">.</span><span class="ident" id="4171071">id</span>&nbsp;<span class="op" id="4171074">==</span>&nbsp;<span class="ident" id="4171077">want</span>&nbsp;<span class="op" id="4171082">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4171089">return</span>&nbsp;<span class="ident" id="4171096">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4171106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4171111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4171116">return</span>&nbsp;<span class="builtintype" id="4171123">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4171129">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4171132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4171135">return</span>&nbsp;<span class="builtintype" id="4171142">nil</span><br>
<span class="lineno"></span><span class="op" id="4171146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4171149">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4171204">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4171273">const</span>&nbsp;<span class="op" id="4171279">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171282">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171322">uint16</span>&nbsp;<span class="op" id="4171329">=</span>&nbsp;<span class="num" id="4171331">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171339">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171379">uint16</span>&nbsp;<span class="op" id="4171386">=</span>&nbsp;<span class="num" id="4171388">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171396">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171436">uint16</span>&nbsp;<span class="op" id="4171443">=</span>&nbsp;<span class="num" id="4171445">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171453">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171493">uint16</span>&nbsp;<span class="op" id="4171500">=</span>&nbsp;<span class="num" id="4171502">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171510">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171550">uint16</span>&nbsp;<span class="op" id="4171557">=</span>&nbsp;<span class="num" id="4171559">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171567">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171607">uint16</span>&nbsp;<span class="op" id="4171614">=</span>&nbsp;<span class="num" id="4171616">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171624">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171664">uint16</span>&nbsp;<span class="op" id="4171671">=</span>&nbsp;<span class="num" id="4171673">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171681">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171721">uint16</span>&nbsp;<span class="op" id="4171728">=</span>&nbsp;<span class="num" id="4171730">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171738">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171778">uint16</span>&nbsp;<span class="op" id="4171785">=</span>&nbsp;<span class="num" id="4171787">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171795">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171835">uint16</span>&nbsp;<span class="op" id="4171842">=</span>&nbsp;<span class="num" id="4171844">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171852">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171892">uint16</span>&nbsp;<span class="op" id="4171899">=</span>&nbsp;<span class="num" id="4171901">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171909">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4171949">uint16</span>&nbsp;<span class="op" id="4171956">=</span>&nbsp;<span class="num" id="4171958">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4171966">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4172006">uint16</span>&nbsp;<span class="op" id="4172013">=</span>&nbsp;<span class="num" id="4172015">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4172024">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4172093">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4172144">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4172210">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4172228">uint16</span>&nbsp;<span class="op" id="4172235">=</span>&nbsp;<span class="num" id="4172237">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4172244">)</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
