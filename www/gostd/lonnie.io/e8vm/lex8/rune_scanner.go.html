<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/lex8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/lex8/error.go.html">error.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/error_list.go.html">error_list.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/lex_scanner.go.html">lex_scanner.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/lexer.go.html">lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/pos.go.html">pos.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/rune_scanner.go.html">rune_scanner.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4899470">package</span>&nbsp;<span class="ident" id="4899478">lex8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4899484">import</span>&nbsp;<span class="op" id="4899491">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4899494">&#34;bufio&#34;</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4899503">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4899508">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4899511">//&nbsp;RuneScanner&nbsp;is&nbsp;a&nbsp;rune&nbsp;scanner&nbsp;that&nbsp;scans&nbsp;runes&nbsp;from&nbsp;a&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="4899574">//&nbsp;and&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;tracks&nbsp;the&nbsp;reading&nbsp;position.</span><br>
<span class="lineno">10</span><span class="keyword" id="4899627">type</span>&nbsp;<span class="ident" id="4899632">RuneScanner</span>&nbsp;<span class="keyword" id="4899644">struct</span>&nbsp;<span class="op" id="4899651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899654">file</span>&nbsp;<span class="builtintype" id="4899659">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899667">line</span>&nbsp;<span class="builtintype" id="4899672">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899678">rc</span>&nbsp;<span class="ident" id="4899681">io</span><span class="op" id="4899683">.</span><span class="ident" id="4899684">ReadCloser</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899696">r</span>&nbsp;&nbsp;<span class="op" id="4899699">*</span><span class="ident" id="4899700">bufio</span><span class="op" id="4899705">.</span><span class="ident" id="4899706">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899715">Err</span>&nbsp;&nbsp;<span class="builtintype" id="4899720">error</span>&nbsp;<span class="comment" id="4899726">//&nbsp;any&nbsp;error&nbsp;encountered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899752">Rune</span>&nbsp;<span class="builtintype" id="4899757">rune</span>&nbsp;&nbsp;<span class="comment" id="4899763">//&nbsp;the&nbsp;rune&nbsp;just&nbsp;read</span><br>
<span class="lineno"></span><span class="op" id="4899785">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4899788">//&nbsp;NewRuneScanner&nbsp;creates&nbsp;a&nbsp;scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="4899825">func</span>&nbsp;<span class="ident" id="4899830">NewRuneScanner</span><span class="op" id="4899844">(</span><span class="ident" id="4899845">file</span>&nbsp;<span class="builtintype" id="4899850">string</span><span class="op" id="4899856">,</span>&nbsp;<span class="ident" id="4899858">rc</span>&nbsp;<span class="ident" id="4899861">io</span><span class="op" id="4899863">.</span><span class="ident" id="4899864">ReadCloser</span><span class="op" id="4899874">)</span>&nbsp;<span class="op" id="4899876">*</span><span class="ident" id="4899877">RuneScanner</span>&nbsp;<span class="op" id="4899889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899892">ret</span>&nbsp;<span class="op" id="4899896">:=</span>&nbsp;<span class="builtinfunc" id="4899899">new</span><span class="op" id="4899902">(</span><span class="ident" id="4899903">RuneScanner</span><span class="op" id="4899914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899917">ret</span><span class="op" id="4899920">.</span><span class="ident" id="4899921">file</span>&nbsp;<span class="op" id="4899926">=</span>&nbsp;<span class="ident" id="4899928">file</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899934">ret</span><span class="op" id="4899937">.</span><span class="ident" id="4899938">rc</span>&nbsp;<span class="op" id="4899941">=</span>&nbsp;<span class="ident" id="4899943">rc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899947">ret</span><span class="op" id="4899950">.</span><span class="ident" id="4899951">r</span>&nbsp;<span class="op" id="4899953">=</span>&nbsp;<span class="ident" id="4899955">bufio</span><span class="op" id="4899960">.</span><span class="ident" id="4899961">NewReader</span><span class="op" id="4899970">(</span><span class="ident" id="4899971">rc</span><span class="op" id="4899973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899976">ret</span><span class="op" id="4899979">.</span><span class="ident" id="4899980">line</span>&nbsp;<span class="op" id="4899985">=</span>&nbsp;<span class="num" id="4899987">1</span>&nbsp;<span class="comment" id="4899989">//&nbsp;natural&nbsp;counting</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900011">return</span>&nbsp;<span class="ident" id="4900018">ret</span><br>
<span class="lineno">30</span><span class="op" id="4900022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4900025">//&nbsp;Scan&nbsp;reads&nbsp;in&nbsp;the&nbsp;next&nbsp;rune&nbsp;to&nbsp;s.Rune.</span><br>
<span class="lineno"></span><span class="comment" id="4900067">//&nbsp;It&nbsp;closes&nbsp;the&nbsp;reader&nbsp;automatically&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the&nbsp;end&nbsp;of&nbsp;file</span><br>
<span class="lineno"></span><span class="comment" id="4900137">//&nbsp;or&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno">35</span><span class="keyword" id="4900165">func</span>&nbsp;<span class="op" id="4900170">(</span><span class="ident" id="4900171">s</span>&nbsp;<span class="op" id="4900173">*</span><span class="ident" id="4900174">RuneScanner</span><span class="op" id="4900185">)</span>&nbsp;<span class="ident" id="4900187">Scan</span><span class="op" id="4900191">(</span><span class="op" id="4900192">)</span>&nbsp;<span class="builtintype" id="4900194">bool</span>&nbsp;<span class="op" id="4900199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900202">wasEndline</span>&nbsp;<span class="op" id="4900213">:=</span>&nbsp;<span class="ident" id="4900216">s</span><span class="op" id="4900217">.</span><span class="ident" id="4900218">Rune</span>&nbsp;<span class="op" id="4900223">==</span>&nbsp;<span class="string" id="4900226">&#39;\n&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900233">s</span><span class="op" id="4900234">.</span><span class="ident" id="4900235">Rune</span><span class="op" id="4900239">,</span>&nbsp;<span class="ident" id="4900241">_</span><span class="op" id="4900242">,</span>&nbsp;<span class="ident" id="4900244">s</span><span class="op" id="4900245">.</span><span class="ident" id="4900246">Err</span>&nbsp;<span class="op" id="4900250">=</span>&nbsp;<span class="ident" id="4900252">s</span><span class="op" id="4900253">.</span><span class="ident" id="4900254">r</span><span class="op" id="4900255">.</span><span class="ident" id="4900256">ReadRune</span><span class="op" id="4900264">(</span><span class="op" id="4900265">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900269">if</span>&nbsp;<span class="ident" id="4900272">s</span><span class="op" id="4900273">.</span><span class="ident" id="4900274">Err</span>&nbsp;<span class="op" id="4900278">!=</span>&nbsp;<span class="ident" id="4900281">nil</span>&nbsp;<span class="op" id="4900285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900289">closeErr</span>&nbsp;<span class="op" id="4900298">:=</span>&nbsp;<span class="ident" id="4900301">s</span><span class="op" id="4900302">.</span><span class="ident" id="4900303">rc</span><span class="op" id="4900305">.</span><span class="ident" id="4900306">Close</span><span class="op" id="4900311">(</span><span class="op" id="4900312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900316">if</span>&nbsp;<span class="ident" id="4900319">s</span><span class="op" id="4900320">.</span><span class="ident" id="4900321">Err</span>&nbsp;<span class="op" id="4900325">==</span>&nbsp;<span class="ident" id="4900328">io</span><span class="op" id="4900330">.</span><span class="ident" id="4900331">EOF</span>&nbsp;<span class="op" id="4900335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900340">s</span><span class="op" id="4900341">.</span><span class="ident" id="4900342">Err</span>&nbsp;<span class="op" id="4900346">=</span>&nbsp;<span class="ident" id="4900348">closeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900359">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900363">return</span>&nbsp;<span class="builtintype" id="4900370">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900381">if</span>&nbsp;<span class="ident" id="4900384">wasEndline</span>&nbsp;<span class="op" id="4900395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900399">s</span><span class="op" id="4900400">.</span><span class="ident" id="4900401">line</span><span class="op" id="4900405">++</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900413">return</span>&nbsp;<span class="builtintype" id="4900420">true</span><br>
<span class="lineno"></span><span class="op" id="4900425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4900428">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;current&nbsp;position&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4900477">func</span>&nbsp;<span class="op" id="4900482">(</span><span class="ident" id="4900483">s</span>&nbsp;<span class="op" id="4900485">*</span><span class="ident" id="4900486">RuneScanner</span><span class="op" id="4900497">)</span>&nbsp;<span class="ident" id="4900499">Pos</span><span class="op" id="4900502">(</span><span class="op" id="4900503">)</span>&nbsp;<span class="op" id="4900505">*</span><span class="ident" id="4900506">Pos</span>&nbsp;<span class="op" id="4900510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900513">return</span>&nbsp;<span class="op" id="4900520">&amp;</span><span class="ident" id="4900521">Pos</span><span class="op" id="4900524">{</span><span class="ident" id="4900525">s</span><span class="op" id="4900526">.</span><span class="ident" id="4900527">file</span><span class="op" id="4900531">,</span>&nbsp;<span class="ident" id="4900533">s</span><span class="op" id="4900534">.</span><span class="ident" id="4900535">line</span><span class="op" id="4900539">}</span><br>
<span class="lineno"></span><span class="op" id="4900541">}</span>
</div>
</body>
</html>
