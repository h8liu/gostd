<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html" class="current">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2086593">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2086648">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2086702">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2086753">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2086830">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2086854">package</span>&nbsp;<span class="ident" id="2086862">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2086871">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2086919">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2086933">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2086980">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2087053">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2087113">import</span>&nbsp;<span class="string" id="2087120">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2087128">var</span>&nbsp;<span class="ident" id="2087132">optimize</span>&nbsp;<span class="op" id="2087141">=</span>&nbsp;<span class="builtintype" id="2087143">true</span>&nbsp;<span class="comment" id="2087148">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2087175">func</span>&nbsp;<span class="ident" id="2087180">equalIgnoreCase</span><span class="op" id="2087195">(</span><span class="ident" id="2087196">s1</span><span class="op" id="2087198">,</span>&nbsp;<span class="ident" id="2087200">s2</span>&nbsp;<span class="builtintype" id="2087203">string</span><span class="op" id="2087209">)</span>&nbsp;<span class="builtintype" id="2087211">bool</span>&nbsp;<span class="op" id="2087216">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087219">if</span>&nbsp;<span class="builtinfunc" id="2087222">len</span><span class="op" id="2087225">(</span><span class="ident" id="2087226">s1</span><span class="op" id="2087228">)</span>&nbsp;<span class="op" id="2087230">!=</span>&nbsp;<span class="builtinfunc" id="2087233">len</span><span class="op" id="2087236">(</span><span class="ident" id="2087237">s2</span><span class="op" id="2087239">)</span>&nbsp;<span class="op" id="2087241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087245">return</span>&nbsp;<span class="builtintype" id="2087252">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087262">for</span>&nbsp;<span class="ident" id="2087266">i</span>&nbsp;<span class="op" id="2087268">:=</span>&nbsp;<span class="num" id="2087271">0</span><span class="op" id="2087272">;</span>&nbsp;<span class="ident" id="2087274">i</span>&nbsp;<span class="op" id="2087276">&lt;</span>&nbsp;<span class="builtinfunc" id="2087278">len</span><span class="op" id="2087281">(</span><span class="ident" id="2087282">s1</span><span class="op" id="2087284">)</span><span class="op" id="2087285">;</span>&nbsp;<span class="ident" id="2087287">i</span><span class="op" id="2087288">++</span>&nbsp;<span class="op" id="2087291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087295">c1</span>&nbsp;<span class="op" id="2087298">:=</span>&nbsp;<span class="ident" id="2087301">s1</span><span class="op" id="2087303">[</span><span class="ident" id="2087304">i</span><span class="op" id="2087305">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087309">if</span>&nbsp;<span class="string" id="2087312">&#39;A&#39;</span>&nbsp;<span class="op" id="2087316">&lt;=</span>&nbsp;<span class="ident" id="2087319">c1</span>&nbsp;<span class="op" id="2087322">&amp;&amp;</span>&nbsp;<span class="ident" id="2087325">c1</span>&nbsp;<span class="op" id="2087328">&lt;=</span>&nbsp;<span class="string" id="2087331">&#39;Z&#39;</span>&nbsp;<span class="op" id="2087335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087340">c1</span>&nbsp;<span class="op" id="2087343">+=</span>&nbsp;<span class="string" id="2087346">&#39;a&#39;</span>&nbsp;<span class="op" id="2087350">-</span>&nbsp;<span class="string" id="2087352">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087362">c2</span>&nbsp;<span class="op" id="2087365">:=</span>&nbsp;<span class="ident" id="2087368">s2</span><span class="op" id="2087370">[</span><span class="ident" id="2087371">i</span><span class="op" id="2087372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087376">if</span>&nbsp;<span class="string" id="2087379">&#39;A&#39;</span>&nbsp;<span class="op" id="2087383">&lt;=</span>&nbsp;<span class="ident" id="2087386">c2</span>&nbsp;<span class="op" id="2087389">&amp;&amp;</span>&nbsp;<span class="ident" id="2087392">c2</span>&nbsp;<span class="op" id="2087395">&lt;=</span>&nbsp;<span class="string" id="2087398">&#39;Z&#39;</span>&nbsp;<span class="op" id="2087402">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2087407">c2</span>&nbsp;<span class="op" id="2087410">+=</span>&nbsp;<span class="string" id="2087413">&#39;a&#39;</span>&nbsp;<span class="op" id="2087417">-</span>&nbsp;<span class="string" id="2087419">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087429">if</span>&nbsp;<span class="ident" id="2087432">c1</span>&nbsp;<span class="op" id="2087435">!=</span>&nbsp;<span class="ident" id="2087438">c2</span>&nbsp;<span class="op" id="2087441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087446">return</span>&nbsp;<span class="builtintype" id="2087453">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087461">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087467">return</span>&nbsp;<span class="builtintype" id="2087474">true</span><br>
<span class="lineno"></span><span class="op" id="2087479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2087482">func</span>&nbsp;<span class="ident" id="2087487">special</span><span class="op" id="2087494">(</span><span class="ident" id="2087495">s</span>&nbsp;<span class="builtintype" id="2087497">string</span><span class="op" id="2087503">)</span>&nbsp;<span class="op" id="2087505">(</span><span class="ident" id="2087506">f</span>&nbsp;<span class="builtintype" id="2087508">float64</span><span class="op" id="2087515">,</span>&nbsp;<span class="ident" id="2087517">ok</span>&nbsp;<span class="builtintype" id="2087520">bool</span><span class="op" id="2087524">)</span>&nbsp;<span class="op" id="2087526">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087529">if</span>&nbsp;<span class="builtinfunc" id="2087532">len</span><span class="op" id="2087535">(</span><span class="ident" id="2087536">s</span><span class="op" id="2087537">)</span>&nbsp;<span class="op" id="2087539">==</span>&nbsp;<span class="num" id="2087542">0</span>&nbsp;<span class="op" id="2087544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087548">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087559">switch</span>&nbsp;<span class="ident" id="2087566">s</span><span class="op" id="2087567">[</span><span class="num" id="2087568">0</span><span class="op" id="2087569">]</span>&nbsp;<span class="op" id="2087571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087574">default</span><span class="op" id="2087581">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087585">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087593">case</span>&nbsp;<span class="string" id="2087598">&#39;+&#39;</span><span class="op" id="2087601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087605">if</span>&nbsp;<span class="ident" id="2087608">equalIgnoreCase</span><span class="op" id="2087623">(</span><span class="ident" id="2087624">s</span><span class="op" id="2087625">,</span>&nbsp;<span class="string" id="2087627">&#34;+inf&#34;</span><span class="op" id="2087633">)</span>&nbsp;<span class="op" id="2087635">||</span>&nbsp;<span class="ident" id="2087638">equalIgnoreCase</span><span class="op" id="2087653">(</span><span class="ident" id="2087654">s</span><span class="op" id="2087655">,</span>&nbsp;<span class="string" id="2087657">&#34;+infinity&#34;</span><span class="op" id="2087668">)</span>&nbsp;<span class="op" id="2087670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087675">return</span>&nbsp;<span class="ident" id="2087682">math</span><span class="op" id="2087686">.</span><span class="ident" id="2087687">Inf</span><span class="op" id="2087690">(</span><span class="num" id="2087691">1</span><span class="op" id="2087692">)</span><span class="op" id="2087693">,</span>&nbsp;<span class="builtintype" id="2087695">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087702">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087705">case</span>&nbsp;<span class="string" id="2087710">&#39;-&#39;</span><span class="op" id="2087713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087717">if</span>&nbsp;<span class="ident" id="2087720">equalIgnoreCase</span><span class="op" id="2087735">(</span><span class="ident" id="2087736">s</span><span class="op" id="2087737">,</span>&nbsp;<span class="string" id="2087739">&#34;-inf&#34;</span><span class="op" id="2087745">)</span>&nbsp;<span class="op" id="2087747">||</span>&nbsp;<span class="ident" id="2087750">equalIgnoreCase</span><span class="op" id="2087765">(</span><span class="ident" id="2087766">s</span><span class="op" id="2087767">,</span>&nbsp;<span class="string" id="2087769">&#34;-infinity&#34;</span><span class="op" id="2087780">)</span>&nbsp;<span class="op" id="2087782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087787">return</span>&nbsp;<span class="ident" id="2087794">math</span><span class="op" id="2087798">.</span><span class="ident" id="2087799">Inf</span><span class="op" id="2087802">(</span><span class="op" id="2087803">-</span><span class="num" id="2087804">1</span><span class="op" id="2087805">)</span><span class="op" id="2087806">,</span>&nbsp;<span class="builtintype" id="2087808">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087818">case</span>&nbsp;<span class="string" id="2087823">&#39;n&#39;</span><span class="op" id="2087826">,</span>&nbsp;<span class="string" id="2087828">&#39;N&#39;</span><span class="op" id="2087831">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087835">if</span>&nbsp;<span class="ident" id="2087838">equalIgnoreCase</span><span class="op" id="2087853">(</span><span class="ident" id="2087854">s</span><span class="op" id="2087855">,</span>&nbsp;<span class="string" id="2087857">&#34;nan&#34;</span><span class="op" id="2087862">)</span>&nbsp;<span class="op" id="2087864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087869">return</span>&nbsp;<span class="ident" id="2087876">math</span><span class="op" id="2087880">.</span><span class="ident" id="2087881">NaN</span><span class="op" id="2087884">(</span><span class="op" id="2087885">)</span><span class="op" id="2087886">,</span>&nbsp;<span class="builtintype" id="2087888">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087898">case</span>&nbsp;<span class="string" id="2087903">&#39;i&#39;</span><span class="op" id="2087906">,</span>&nbsp;<span class="string" id="2087908">&#39;I&#39;</span><span class="op" id="2087911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087915">if</span>&nbsp;<span class="ident" id="2087918">equalIgnoreCase</span><span class="op" id="2087933">(</span><span class="ident" id="2087934">s</span><span class="op" id="2087935">,</span>&nbsp;<span class="string" id="2087937">&#34;inf&#34;</span><span class="op" id="2087942">)</span>&nbsp;<span class="op" id="2087944">||</span>&nbsp;<span class="ident" id="2087947">equalIgnoreCase</span><span class="op" id="2087962">(</span><span class="ident" id="2087963">s</span><span class="op" id="2087964">,</span>&nbsp;<span class="string" id="2087966">&#34;infinity&#34;</span><span class="op" id="2087976">)</span>&nbsp;<span class="op" id="2087978">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2087983">return</span>&nbsp;<span class="ident" id="2087990">math</span><span class="op" id="2087994">.</span><span class="ident" id="2087995">Inf</span><span class="op" id="2087998">(</span><span class="num" id="2087999">1</span><span class="op" id="2088000">)</span><span class="op" id="2088001">,</span>&nbsp;<span class="builtintype" id="2088003">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088016">return</span><br>
<span class="lineno"></span><span class="op" id="2088023">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2088026">func</span>&nbsp;<span class="op" id="2088031">(</span><span class="ident" id="2088032">b</span>&nbsp;<span class="op" id="2088034">*</span><span class="ident" id="2088035">decimal</span><span class="op" id="2088042">)</span>&nbsp;<span class="ident" id="2088044">set</span><span class="op" id="2088047">(</span><span class="ident" id="2088048">s</span>&nbsp;<span class="builtintype" id="2088050">string</span><span class="op" id="2088056">)</span>&nbsp;<span class="op" id="2088058">(</span><span class="ident" id="2088059">ok</span>&nbsp;<span class="builtintype" id="2088062">bool</span><span class="op" id="2088066">)</span>&nbsp;<span class="op" id="2088068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088071">i</span>&nbsp;<span class="op" id="2088073">:=</span>&nbsp;<span class="num" id="2088076">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088079">b</span><span class="op" id="2088080">.</span><span class="ident" id="2088081">neg</span>&nbsp;<span class="op" id="2088085">=</span>&nbsp;<span class="builtintype" id="2088087">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088094">b</span><span class="op" id="2088095">.</span><span class="ident" id="2088096">trunc</span>&nbsp;<span class="op" id="2088102">=</span>&nbsp;<span class="builtintype" id="2088104">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088112">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088130">if</span>&nbsp;<span class="ident" id="2088133">i</span>&nbsp;<span class="op" id="2088135">&gt;=</span>&nbsp;<span class="builtinfunc" id="2088138">len</span><span class="op" id="2088141">(</span><span class="ident" id="2088142">s</span><span class="op" id="2088143">)</span>&nbsp;<span class="op" id="2088145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088149">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088157">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088160">switch</span>&nbsp;<span class="op" id="2088167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088170">case</span>&nbsp;<span class="ident" id="2088175">s</span><span class="op" id="2088176">[</span><span class="ident" id="2088177">i</span><span class="op" id="2088178">]</span>&nbsp;<span class="op" id="2088180">==</span>&nbsp;<span class="string" id="2088183">&#39;+&#39;</span><span class="op" id="2088186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088190">i</span><span class="op" id="2088191">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088195">case</span>&nbsp;<span class="ident" id="2088200">s</span><span class="op" id="2088201">[</span><span class="ident" id="2088202">i</span><span class="op" id="2088203">]</span>&nbsp;<span class="op" id="2088205">==</span>&nbsp;<span class="string" id="2088208">&#39;-&#39;</span><span class="op" id="2088211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088215">b</span><span class="op" id="2088216">.</span><span class="ident" id="2088217">neg</span>&nbsp;<span class="op" id="2088221">=</span>&nbsp;<span class="builtintype" id="2088223">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088230">i</span><span class="op" id="2088231">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088239">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088250">sawdot</span>&nbsp;<span class="op" id="2088257">:=</span>&nbsp;<span class="builtintype" id="2088260">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088267">sawdigits</span>&nbsp;<span class="op" id="2088277">:=</span>&nbsp;<span class="builtintype" id="2088280">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088287">for</span>&nbsp;<span class="op" id="2088291">;</span>&nbsp;<span class="ident" id="2088293">i</span>&nbsp;<span class="op" id="2088295">&lt;</span>&nbsp;<span class="builtinfunc" id="2088297">len</span><span class="op" id="2088300">(</span><span class="ident" id="2088301">s</span><span class="op" id="2088302">)</span><span class="op" id="2088303">;</span>&nbsp;<span class="ident" id="2088305">i</span><span class="op" id="2088306">++</span>&nbsp;<span class="op" id="2088309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088313">switch</span>&nbsp;<span class="op" id="2088320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088324">case</span>&nbsp;<span class="ident" id="2088329">s</span><span class="op" id="2088330">[</span><span class="ident" id="2088331">i</span><span class="op" id="2088332">]</span>&nbsp;<span class="op" id="2088334">==</span>&nbsp;<span class="string" id="2088337">&#39;.&#39;</span><span class="op" id="2088340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088345">if</span>&nbsp;<span class="ident" id="2088348">sawdot</span>&nbsp;<span class="op" id="2088355">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088361">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088376">sawdot</span>&nbsp;<span class="op" id="2088383">=</span>&nbsp;<span class="builtintype" id="2088385">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088393">b</span><span class="op" id="2088394">.</span><span class="ident" id="2088395">dp</span>&nbsp;<span class="op" id="2088398">=</span>&nbsp;<span class="ident" id="2088400">b</span><span class="op" id="2088401">.</span><span class="ident" id="2088402">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088408">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088420">case</span>&nbsp;<span class="string" id="2088425">&#39;0&#39;</span>&nbsp;<span class="op" id="2088429">&lt;=</span>&nbsp;<span class="ident" id="2088432">s</span><span class="op" id="2088433">[</span><span class="ident" id="2088434">i</span><span class="op" id="2088435">]</span>&nbsp;<span class="op" id="2088437">&amp;&amp;</span>&nbsp;<span class="ident" id="2088440">s</span><span class="op" id="2088441">[</span><span class="ident" id="2088442">i</span><span class="op" id="2088443">]</span>&nbsp;<span class="op" id="2088445">&lt;=</span>&nbsp;<span class="string" id="2088448">&#39;9&#39;</span><span class="op" id="2088451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088456">sawdigits</span>&nbsp;<span class="op" id="2088466">=</span>&nbsp;<span class="builtintype" id="2088468">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088476">if</span>&nbsp;<span class="ident" id="2088479">s</span><span class="op" id="2088480">[</span><span class="ident" id="2088481">i</span><span class="op" id="2088482">]</span>&nbsp;<span class="op" id="2088484">==</span>&nbsp;<span class="string" id="2088487">&#39;0&#39;</span>&nbsp;<span class="op" id="2088491">&amp;&amp;</span>&nbsp;<span class="ident" id="2088494">b</span><span class="op" id="2088495">.</span><span class="ident" id="2088496">nd</span>&nbsp;<span class="op" id="2088499">==</span>&nbsp;<span class="num" id="2088502">0</span>&nbsp;<span class="op" id="2088504">{</span>&nbsp;<span class="comment" id="2088506">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088534">b</span><span class="op" id="2088535">.</span><span class="ident" id="2088536">dp</span><span class="op" id="2088538">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088545">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088562">if</span>&nbsp;<span class="ident" id="2088565">b</span><span class="op" id="2088566">.</span><span class="ident" id="2088567">nd</span>&nbsp;<span class="op" id="2088570">&lt;</span>&nbsp;<span class="builtinfunc" id="2088572">len</span><span class="op" id="2088575">(</span><span class="ident" id="2088576">b</span><span class="op" id="2088577">.</span><span class="ident" id="2088578">d</span><span class="op" id="2088579">)</span>&nbsp;<span class="op" id="2088581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088587">b</span><span class="op" id="2088588">.</span><span class="ident" id="2088589">d</span><span class="op" id="2088590">[</span><span class="ident" id="2088591">b</span><span class="op" id="2088592">.</span><span class="ident" id="2088593">nd</span><span class="op" id="2088595">]</span>&nbsp;<span class="op" id="2088597">=</span>&nbsp;<span class="ident" id="2088599">s</span><span class="op" id="2088600">[</span><span class="ident" id="2088601">i</span><span class="op" id="2088602">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088608">b</span><span class="op" id="2088609">.</span><span class="ident" id="2088610">nd</span><span class="op" id="2088612">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088618">}</span>&nbsp;<span class="keyword" id="2088620">else</span>&nbsp;<span class="keyword" id="2088625">if</span>&nbsp;<span class="ident" id="2088628">s</span><span class="op" id="2088629">[</span><span class="ident" id="2088630">i</span><span class="op" id="2088631">]</span>&nbsp;<span class="op" id="2088633">!=</span>&nbsp;<span class="string" id="2088636">&#39;0&#39;</span>&nbsp;<span class="op" id="2088640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088646">b</span><span class="op" id="2088647">.</span><span class="ident" id="2088648">trunc</span>&nbsp;<span class="op" id="2088654">=</span>&nbsp;<span class="builtintype" id="2088656">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088669">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088680">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088684">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088694">if</span>&nbsp;<span class="op" id="2088697">!</span><span class="ident" id="2088698">sawdigits</span>&nbsp;<span class="op" id="2088708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088712">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088720">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088723">if</span>&nbsp;<span class="op" id="2088726">!</span><span class="ident" id="2088727">sawdot</span>&nbsp;<span class="op" id="2088734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088738">b</span><span class="op" id="2088739">.</span><span class="ident" id="2088740">dp</span>&nbsp;<span class="op" id="2088743">=</span>&nbsp;<span class="ident" id="2088745">b</span><span class="op" id="2088746">.</span><span class="ident" id="2088747">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088755">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088798">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088845">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088891">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088943">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088969">if</span>&nbsp;<span class="ident" id="2088972">i</span>&nbsp;<span class="op" id="2088974">&lt;</span>&nbsp;<span class="builtinfunc" id="2088976">len</span><span class="op" id="2088979">(</span><span class="ident" id="2088980">s</span><span class="op" id="2088981">)</span>&nbsp;<span class="op" id="2088983">&amp;&amp;</span>&nbsp;<span class="op" id="2088986">(</span><span class="ident" id="2088987">s</span><span class="op" id="2088988">[</span><span class="ident" id="2088989">i</span><span class="op" id="2088990">]</span>&nbsp;<span class="op" id="2088992">==</span>&nbsp;<span class="string" id="2088995">&#39;e&#39;</span>&nbsp;<span class="op" id="2088999">||</span>&nbsp;<span class="ident" id="2089002">s</span><span class="op" id="2089003">[</span><span class="ident" id="2089004">i</span><span class="op" id="2089005">]</span>&nbsp;<span class="op" id="2089007">==</span>&nbsp;<span class="string" id="2089010">&#39;E&#39;</span><span class="op" id="2089013">)</span>&nbsp;<span class="op" id="2089015">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089019">i</span><span class="op" id="2089020">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089025">if</span>&nbsp;<span class="ident" id="2089028">i</span>&nbsp;<span class="op" id="2089030">&gt;=</span>&nbsp;<span class="builtinfunc" id="2089033">len</span><span class="op" id="2089036">(</span><span class="ident" id="2089037">s</span><span class="op" id="2089038">)</span>&nbsp;<span class="op" id="2089040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089045">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089058">esign</span>&nbsp;<span class="op" id="2089064">:=</span>&nbsp;<span class="num" id="2089067">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089071">if</span>&nbsp;<span class="ident" id="2089074">s</span><span class="op" id="2089075">[</span><span class="ident" id="2089076">i</span><span class="op" id="2089077">]</span>&nbsp;<span class="op" id="2089079">==</span>&nbsp;<span class="string" id="2089082">&#39;+&#39;</span>&nbsp;<span class="op" id="2089086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089091">i</span><span class="op" id="2089092">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089097">}</span>&nbsp;<span class="keyword" id="2089099">else</span>&nbsp;<span class="keyword" id="2089104">if</span>&nbsp;<span class="ident" id="2089107">s</span><span class="op" id="2089108">[</span><span class="ident" id="2089109">i</span><span class="op" id="2089110">]</span>&nbsp;<span class="op" id="2089112">==</span>&nbsp;<span class="string" id="2089115">&#39;-&#39;</span>&nbsp;<span class="op" id="2089119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089124">i</span><span class="op" id="2089125">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089131">esign</span>&nbsp;<span class="op" id="2089137">=</span>&nbsp;<span class="op" id="2089139">-</span><span class="num" id="2089140">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089148">if</span>&nbsp;<span class="ident" id="2089151">i</span>&nbsp;<span class="op" id="2089153">&gt;=</span>&nbsp;<span class="builtinfunc" id="2089156">len</span><span class="op" id="2089159">(</span><span class="ident" id="2089160">s</span><span class="op" id="2089161">)</span>&nbsp;<span class="op" id="2089163">||</span>&nbsp;<span class="ident" id="2089166">s</span><span class="op" id="2089167">[</span><span class="ident" id="2089168">i</span><span class="op" id="2089169">]</span>&nbsp;<span class="op" id="2089171">&lt;</span>&nbsp;<span class="string" id="2089173">&#39;0&#39;</span>&nbsp;<span class="op" id="2089177">||</span>&nbsp;<span class="ident" id="2089180">s</span><span class="op" id="2089181">[</span><span class="ident" id="2089182">i</span><span class="op" id="2089183">]</span>&nbsp;<span class="op" id="2089185">&gt;</span>&nbsp;<span class="string" id="2089187">&#39;9&#39;</span>&nbsp;<span class="op" id="2089191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089196">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089209">e</span>&nbsp;<span class="op" id="2089211">:=</span>&nbsp;<span class="num" id="2089214">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089218">for</span>&nbsp;<span class="op" id="2089222">;</span>&nbsp;<span class="ident" id="2089224">i</span>&nbsp;<span class="op" id="2089226">&lt;</span>&nbsp;<span class="builtinfunc" id="2089228">len</span><span class="op" id="2089231">(</span><span class="ident" id="2089232">s</span><span class="op" id="2089233">)</span>&nbsp;<span class="op" id="2089235">&amp;&amp;</span>&nbsp;<span class="string" id="2089238">&#39;0&#39;</span>&nbsp;<span class="op" id="2089242">&lt;=</span>&nbsp;<span class="ident" id="2089245">s</span><span class="op" id="2089246">[</span><span class="ident" id="2089247">i</span><span class="op" id="2089248">]</span>&nbsp;<span class="op" id="2089250">&amp;&amp;</span>&nbsp;<span class="ident" id="2089253">s</span><span class="op" id="2089254">[</span><span class="ident" id="2089255">i</span><span class="op" id="2089256">]</span>&nbsp;<span class="op" id="2089258">&lt;=</span>&nbsp;<span class="string" id="2089261">&#39;9&#39;</span><span class="op" id="2089264">;</span>&nbsp;<span class="ident" id="2089266">i</span><span class="op" id="2089267">++</span>&nbsp;<span class="op" id="2089270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089275">if</span>&nbsp;<span class="ident" id="2089278">e</span>&nbsp;<span class="op" id="2089280">&lt;</span>&nbsp;<span class="num" id="2089282">10000</span>&nbsp;<span class="op" id="2089288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089294">e</span>&nbsp;<span class="op" id="2089296">=</span>&nbsp;<span class="ident" id="2089298">e</span><span class="op" id="2089299">*</span><span class="num" id="2089300">10</span>&nbsp;<span class="op" id="2089303">+</span>&nbsp;<span class="builtintype" id="2089305">int</span><span class="op" id="2089308">(</span><span class="ident" id="2089309">s</span><span class="op" id="2089310">[</span><span class="ident" id="2089311">i</span><span class="op" id="2089312">]</span><span class="op" id="2089313">)</span>&nbsp;<span class="op" id="2089315">-</span>&nbsp;<span class="string" id="2089317">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089328">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089332">b</span><span class="op" id="2089333">.</span><span class="ident" id="2089334">dp</span>&nbsp;<span class="op" id="2089337">+=</span>&nbsp;<span class="ident" id="2089340">e</span>&nbsp;<span class="op" id="2089342">*</span>&nbsp;<span class="ident" id="2089344">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089355">if</span>&nbsp;<span class="ident" id="2089358">i</span>&nbsp;<span class="op" id="2089360">!=</span>&nbsp;<span class="builtinfunc" id="2089363">len</span><span class="op" id="2089366">(</span><span class="ident" id="2089367">s</span><span class="op" id="2089368">)</span>&nbsp;<span class="op" id="2089370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089374">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089386">ok</span>&nbsp;<span class="op" id="2089389">=</span>&nbsp;<span class="builtintype" id="2089391">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089397">return</span><br>
<span class="lineno"></span><span class="op" id="2089404">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2089407">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2089471">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2089537">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2089576">func</span>&nbsp;<span class="ident" id="2089581">readFloat</span><span class="op" id="2089590">(</span><span class="ident" id="2089591">s</span>&nbsp;<span class="builtintype" id="2089593">string</span><span class="op" id="2089599">)</span>&nbsp;<span class="op" id="2089601">(</span><span class="ident" id="2089602">mantissa</span>&nbsp;<span class="builtintype" id="2089611">uint64</span><span class="op" id="2089617">,</span>&nbsp;<span class="ident" id="2089619">exp</span>&nbsp;<span class="builtintype" id="2089623">int</span><span class="op" id="2089626">,</span>&nbsp;<span class="ident" id="2089628">neg</span><span class="op" id="2089631">,</span>&nbsp;<span class="ident" id="2089633">trunc</span><span class="op" id="2089638">,</span>&nbsp;<span class="ident" id="2089640">ok</span>&nbsp;<span class="builtintype" id="2089643">bool</span><span class="op" id="2089647">)</span>&nbsp;<span class="op" id="2089649">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089652">const</span>&nbsp;<span class="ident" id="2089658">uint64digits</span>&nbsp;<span class="op" id="2089671">=</span>&nbsp;<span class="num" id="2089673">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089677">i</span>&nbsp;<span class="op" id="2089679">:=</span>&nbsp;<span class="num" id="2089682">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089686">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089704">if</span>&nbsp;<span class="ident" id="2089707">i</span>&nbsp;<span class="op" id="2089709">&gt;=</span>&nbsp;<span class="builtinfunc" id="2089712">len</span><span class="op" id="2089715">(</span><span class="ident" id="2089716">s</span><span class="op" id="2089717">)</span>&nbsp;<span class="op" id="2089719">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089723">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089734">switch</span>&nbsp;<span class="op" id="2089741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089744">case</span>&nbsp;<span class="ident" id="2089749">s</span><span class="op" id="2089750">[</span><span class="ident" id="2089751">i</span><span class="op" id="2089752">]</span>&nbsp;<span class="op" id="2089754">==</span>&nbsp;<span class="string" id="2089757">&#39;+&#39;</span><span class="op" id="2089760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089764">i</span><span class="op" id="2089765">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089769">case</span>&nbsp;<span class="ident" id="2089774">s</span><span class="op" id="2089775">[</span><span class="ident" id="2089776">i</span><span class="op" id="2089777">]</span>&nbsp;<span class="op" id="2089779">==</span>&nbsp;<span class="string" id="2089782">&#39;-&#39;</span><span class="op" id="2089785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089789">neg</span>&nbsp;<span class="op" id="2089793">=</span>&nbsp;<span class="builtintype" id="2089795">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089802">i</span><span class="op" id="2089803">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089811">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089822">sawdot</span>&nbsp;<span class="op" id="2089829">:=</span>&nbsp;<span class="builtintype" id="2089832">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089839">sawdigits</span>&nbsp;<span class="op" id="2089849">:=</span>&nbsp;<span class="builtintype" id="2089852">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089859">nd</span>&nbsp;<span class="op" id="2089862">:=</span>&nbsp;<span class="num" id="2089865">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089868">ndMant</span>&nbsp;<span class="op" id="2089875">:=</span>&nbsp;<span class="num" id="2089878">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089881">dp</span>&nbsp;<span class="op" id="2089884">:=</span>&nbsp;<span class="num" id="2089887">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089890">for</span>&nbsp;<span class="op" id="2089894">;</span>&nbsp;<span class="ident" id="2089896">i</span>&nbsp;<span class="op" id="2089898">&lt;</span>&nbsp;<span class="builtinfunc" id="2089900">len</span><span class="op" id="2089903">(</span><span class="ident" id="2089904">s</span><span class="op" id="2089905">)</span><span class="op" id="2089906">;</span>&nbsp;<span class="ident" id="2089908">i</span><span class="op" id="2089909">++</span>&nbsp;<span class="op" id="2089912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089916">switch</span>&nbsp;<span class="ident" id="2089923">c</span>&nbsp;<span class="op" id="2089925">:=</span>&nbsp;<span class="ident" id="2089928">s</span><span class="op" id="2089929">[</span><span class="ident" id="2089930">i</span><span class="op" id="2089931">]</span><span class="op" id="2089932">;</span>&nbsp;<span class="builtintype" id="2089934">true</span>&nbsp;<span class="op" id="2089939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089943">case</span>&nbsp;<span class="ident" id="2089948">c</span>&nbsp;<span class="op" id="2089950">==</span>&nbsp;<span class="string" id="2089953">&#39;.&#39;</span><span class="op" id="2089956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089961">if</span>&nbsp;<span class="ident" id="2089964">sawdot</span>&nbsp;<span class="op" id="2089971">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089977">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089992">sawdot</span>&nbsp;<span class="op" id="2089999">=</span>&nbsp;<span class="builtintype" id="2090001">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090009">dp</span>&nbsp;<span class="op" id="2090012">=</span>&nbsp;<span class="ident" id="2090014">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090020">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090032">case</span>&nbsp;<span class="string" id="2090037">&#39;0&#39;</span>&nbsp;<span class="op" id="2090041">&lt;=</span>&nbsp;<span class="ident" id="2090044">c</span>&nbsp;<span class="op" id="2090046">&amp;&amp;</span>&nbsp;<span class="ident" id="2090049">c</span>&nbsp;<span class="op" id="2090051">&lt;=</span>&nbsp;<span class="string" id="2090054">&#39;9&#39;</span><span class="op" id="2090057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090062">sawdigits</span>&nbsp;<span class="op" id="2090072">=</span>&nbsp;<span class="builtintype" id="2090074">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090082">if</span>&nbsp;<span class="ident" id="2090085">c</span>&nbsp;<span class="op" id="2090087">==</span>&nbsp;<span class="string" id="2090090">&#39;0&#39;</span>&nbsp;<span class="op" id="2090094">&amp;&amp;</span>&nbsp;<span class="ident" id="2090097">nd</span>&nbsp;<span class="op" id="2090100">==</span>&nbsp;<span class="num" id="2090103">0</span>&nbsp;<span class="op" id="2090105">{</span>&nbsp;<span class="comment" id="2090107">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090135">dp</span><span class="op" id="2090137">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090144">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090161">nd</span><span class="op" id="2090163">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090169">if</span>&nbsp;<span class="ident" id="2090172">ndMant</span>&nbsp;<span class="op" id="2090179">&lt;</span>&nbsp;<span class="ident" id="2090181">uint64digits</span>&nbsp;<span class="op" id="2090194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090200">mantissa</span>&nbsp;<span class="op" id="2090209">*=</span>&nbsp;<span class="num" id="2090212">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090219">mantissa</span>&nbsp;<span class="op" id="2090228">+=</span>&nbsp;<span class="builtintype" id="2090231">uint64</span><span class="op" id="2090237">(</span><span class="ident" id="2090238">c</span>&nbsp;<span class="op" id="2090240">-</span>&nbsp;<span class="string" id="2090242">&#39;0&#39;</span><span class="op" id="2090245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090251">ndMant</span><span class="op" id="2090257">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090263">}</span>&nbsp;<span class="keyword" id="2090265">else</span>&nbsp;<span class="keyword" id="2090270">if</span>&nbsp;<span class="ident" id="2090273">s</span><span class="op" id="2090274">[</span><span class="ident" id="2090275">i</span><span class="op" id="2090276">]</span>&nbsp;<span class="op" id="2090278">!=</span>&nbsp;<span class="string" id="2090281">&#39;0&#39;</span>&nbsp;<span class="op" id="2090285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090291">trunc</span>&nbsp;<span class="op" id="2090297">=</span>&nbsp;<span class="builtintype" id="2090299">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090307">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090312">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090327">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090337">if</span>&nbsp;<span class="op" id="2090340">!</span><span class="ident" id="2090341">sawdigits</span>&nbsp;<span class="op" id="2090351">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090355">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090366">if</span>&nbsp;<span class="op" id="2090369">!</span><span class="ident" id="2090370">sawdot</span>&nbsp;<span class="op" id="2090377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090381">dp</span>&nbsp;<span class="op" id="2090384">=</span>&nbsp;<span class="ident" id="2090386">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090390">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090394">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090437">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090484">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090530">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2090582">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090608">if</span>&nbsp;<span class="ident" id="2090611">i</span>&nbsp;<span class="op" id="2090613">&lt;</span>&nbsp;<span class="builtinfunc" id="2090615">len</span><span class="op" id="2090618">(</span><span class="ident" id="2090619">s</span><span class="op" id="2090620">)</span>&nbsp;<span class="op" id="2090622">&amp;&amp;</span>&nbsp;<span class="op" id="2090625">(</span><span class="ident" id="2090626">s</span><span class="op" id="2090627">[</span><span class="ident" id="2090628">i</span><span class="op" id="2090629">]</span>&nbsp;<span class="op" id="2090631">==</span>&nbsp;<span class="string" id="2090634">&#39;e&#39;</span>&nbsp;<span class="op" id="2090638">||</span>&nbsp;<span class="ident" id="2090641">s</span><span class="op" id="2090642">[</span><span class="ident" id="2090643">i</span><span class="op" id="2090644">]</span>&nbsp;<span class="op" id="2090646">==</span>&nbsp;<span class="string" id="2090649">&#39;E&#39;</span><span class="op" id="2090652">)</span>&nbsp;<span class="op" id="2090654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090658">i</span><span class="op" id="2090659">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090664">if</span>&nbsp;<span class="ident" id="2090667">i</span>&nbsp;<span class="op" id="2090669">&gt;=</span>&nbsp;<span class="builtinfunc" id="2090672">len</span><span class="op" id="2090675">(</span><span class="ident" id="2090676">s</span><span class="op" id="2090677">)</span>&nbsp;<span class="op" id="2090679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090684">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090697">esign</span>&nbsp;<span class="op" id="2090703">:=</span>&nbsp;<span class="num" id="2090706">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090710">if</span>&nbsp;<span class="ident" id="2090713">s</span><span class="op" id="2090714">[</span><span class="ident" id="2090715">i</span><span class="op" id="2090716">]</span>&nbsp;<span class="op" id="2090718">==</span>&nbsp;<span class="string" id="2090721">&#39;+&#39;</span>&nbsp;<span class="op" id="2090725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090730">i</span><span class="op" id="2090731">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090736">}</span>&nbsp;<span class="keyword" id="2090738">else</span>&nbsp;<span class="keyword" id="2090743">if</span>&nbsp;<span class="ident" id="2090746">s</span><span class="op" id="2090747">[</span><span class="ident" id="2090748">i</span><span class="op" id="2090749">]</span>&nbsp;<span class="op" id="2090751">==</span>&nbsp;<span class="string" id="2090754">&#39;-&#39;</span>&nbsp;<span class="op" id="2090758">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090763">i</span><span class="op" id="2090764">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090770">esign</span>&nbsp;<span class="op" id="2090776">=</span>&nbsp;<span class="op" id="2090778">-</span><span class="num" id="2090779">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090787">if</span>&nbsp;<span class="ident" id="2090790">i</span>&nbsp;<span class="op" id="2090792">&gt;=</span>&nbsp;<span class="builtinfunc" id="2090795">len</span><span class="op" id="2090798">(</span><span class="ident" id="2090799">s</span><span class="op" id="2090800">)</span>&nbsp;<span class="op" id="2090802">||</span>&nbsp;<span class="ident" id="2090805">s</span><span class="op" id="2090806">[</span><span class="ident" id="2090807">i</span><span class="op" id="2090808">]</span>&nbsp;<span class="op" id="2090810">&lt;</span>&nbsp;<span class="string" id="2090812">&#39;0&#39;</span>&nbsp;<span class="op" id="2090816">||</span>&nbsp;<span class="ident" id="2090819">s</span><span class="op" id="2090820">[</span><span class="ident" id="2090821">i</span><span class="op" id="2090822">]</span>&nbsp;<span class="op" id="2090824">&gt;</span>&nbsp;<span class="string" id="2090826">&#39;9&#39;</span>&nbsp;<span class="op" id="2090830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090835">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090848">e</span>&nbsp;<span class="op" id="2090850">:=</span>&nbsp;<span class="num" id="2090853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090857">for</span>&nbsp;<span class="op" id="2090861">;</span>&nbsp;<span class="ident" id="2090863">i</span>&nbsp;<span class="op" id="2090865">&lt;</span>&nbsp;<span class="builtinfunc" id="2090867">len</span><span class="op" id="2090870">(</span><span class="ident" id="2090871">s</span><span class="op" id="2090872">)</span>&nbsp;<span class="op" id="2090874">&amp;&amp;</span>&nbsp;<span class="string" id="2090877">&#39;0&#39;</span>&nbsp;<span class="op" id="2090881">&lt;=</span>&nbsp;<span class="ident" id="2090884">s</span><span class="op" id="2090885">[</span><span class="ident" id="2090886">i</span><span class="op" id="2090887">]</span>&nbsp;<span class="op" id="2090889">&amp;&amp;</span>&nbsp;<span class="ident" id="2090892">s</span><span class="op" id="2090893">[</span><span class="ident" id="2090894">i</span><span class="op" id="2090895">]</span>&nbsp;<span class="op" id="2090897">&lt;=</span>&nbsp;<span class="string" id="2090900">&#39;9&#39;</span><span class="op" id="2090903">;</span>&nbsp;<span class="ident" id="2090905">i</span><span class="op" id="2090906">++</span>&nbsp;<span class="op" id="2090909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090914">if</span>&nbsp;<span class="ident" id="2090917">e</span>&nbsp;<span class="op" id="2090919">&lt;</span>&nbsp;<span class="num" id="2090921">10000</span>&nbsp;<span class="op" id="2090927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090933">e</span>&nbsp;<span class="op" id="2090935">=</span>&nbsp;<span class="ident" id="2090937">e</span><span class="op" id="2090938">*</span><span class="num" id="2090939">10</span>&nbsp;<span class="op" id="2090942">+</span>&nbsp;<span class="builtintype" id="2090944">int</span><span class="op" id="2090947">(</span><span class="ident" id="2090948">s</span><span class="op" id="2090949">[</span><span class="ident" id="2090950">i</span><span class="op" id="2090951">]</span><span class="op" id="2090952">)</span>&nbsp;<span class="op" id="2090954">-</span>&nbsp;<span class="string" id="2090956">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090971">dp</span>&nbsp;<span class="op" id="2090974">+=</span>&nbsp;<span class="ident" id="2090977">e</span>&nbsp;<span class="op" id="2090979">*</span>&nbsp;<span class="ident" id="2090981">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090992">if</span>&nbsp;<span class="ident" id="2090995">i</span>&nbsp;<span class="op" id="2090997">!=</span>&nbsp;<span class="builtinfunc" id="2091000">len</span><span class="op" id="2091003">(</span><span class="ident" id="2091004">s</span><span class="op" id="2091005">)</span>&nbsp;<span class="op" id="2091007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091011">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091023">exp</span>&nbsp;<span class="op" id="2091027">=</span>&nbsp;<span class="ident" id="2091029">dp</span>&nbsp;<span class="op" id="2091032">-</span>&nbsp;<span class="ident" id="2091034">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091042">ok</span>&nbsp;<span class="op" id="2091045">=</span>&nbsp;<span class="builtintype" id="2091047">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091053">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2091061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2091064">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2091112">var</span>&nbsp;<span class="ident" id="2091116">powtab</span>&nbsp;<span class="op" id="2091123">=</span>&nbsp;<span class="op" id="2091125">[</span><span class="op" id="2091126">]</span><span class="builtintype" id="2091127">int</span><span class="op" id="2091130">{</span><span class="num" id="2091131">1</span><span class="op" id="2091132">,</span>&nbsp;<span class="num" id="2091134">3</span><span class="op" id="2091135">,</span>&nbsp;<span class="num" id="2091137">6</span><span class="op" id="2091138">,</span>&nbsp;<span class="num" id="2091140">9</span><span class="op" id="2091141">,</span>&nbsp;<span class="num" id="2091143">13</span><span class="op" id="2091145">,</span>&nbsp;<span class="num" id="2091147">16</span><span class="op" id="2091149">,</span>&nbsp;<span class="num" id="2091151">19</span><span class="op" id="2091153">,</span>&nbsp;<span class="num" id="2091155">23</span><span class="op" id="2091157">,</span>&nbsp;<span class="num" id="2091159">26</span><span class="op" id="2091161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2091164">func</span>&nbsp;<span class="op" id="2091169">(</span><span class="ident" id="2091170">d</span>&nbsp;<span class="op" id="2091172">*</span><span class="ident" id="2091173">decimal</span><span class="op" id="2091180">)</span>&nbsp;<span class="ident" id="2091182">floatBits</span><span class="op" id="2091191">(</span><span class="ident" id="2091192">flt</span>&nbsp;<span class="op" id="2091196">*</span><span class="ident" id="2091197">floatInfo</span><span class="op" id="2091206">)</span>&nbsp;<span class="op" id="2091208">(</span><span class="ident" id="2091209">b</span>&nbsp;<span class="builtintype" id="2091211">uint64</span><span class="op" id="2091217">,</span>&nbsp;<span class="ident" id="2091219">overflow</span>&nbsp;<span class="builtintype" id="2091228">bool</span><span class="op" id="2091232">)</span>&nbsp;<span class="op" id="2091234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091237">var</span>&nbsp;<span class="ident" id="2091241">exp</span>&nbsp;<span class="builtintype" id="2091245">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091250">var</span>&nbsp;<span class="ident" id="2091254">mant</span>&nbsp;<span class="builtintype" id="2091259">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091268">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091303">if</span>&nbsp;<span class="ident" id="2091306">d</span><span class="op" id="2091307">.</span><span class="ident" id="2091308">nd</span>&nbsp;<span class="op" id="2091311">==</span>&nbsp;<span class="num" id="2091314">0</span>&nbsp;<span class="op" id="2091316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091320">mant</span>&nbsp;<span class="op" id="2091325">=</span>&nbsp;<span class="num" id="2091327">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091331">exp</span>&nbsp;<span class="op" id="2091335">=</span>&nbsp;<span class="ident" id="2091337">flt</span><span class="op" id="2091340">.</span><span class="ident" id="2091341">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091348">goto</span>&nbsp;<span class="ident" id="2091353">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091362">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091394">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091434">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091509">if</span>&nbsp;<span class="ident" id="2091512">d</span><span class="op" id="2091513">.</span><span class="ident" id="2091514">dp</span>&nbsp;<span class="op" id="2091517">&gt;</span>&nbsp;<span class="num" id="2091519">310</span>&nbsp;<span class="op" id="2091523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091527">goto</span>&nbsp;<span class="ident" id="2091532">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091542">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091545">if</span>&nbsp;<span class="ident" id="2091548">d</span><span class="op" id="2091549">.</span><span class="ident" id="2091550">dp</span>&nbsp;<span class="op" id="2091553">&lt;</span>&nbsp;<span class="op" id="2091555">-</span><span class="num" id="2091556">330</span>&nbsp;<span class="op" id="2091560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091564">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091574">mant</span>&nbsp;<span class="op" id="2091579">=</span>&nbsp;<span class="num" id="2091581">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091585">exp</span>&nbsp;<span class="op" id="2091589">=</span>&nbsp;<span class="ident" id="2091591">flt</span><span class="op" id="2091594">.</span><span class="ident" id="2091595">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091602">goto</span>&nbsp;<span class="ident" id="2091607">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091616">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091669">exp</span>&nbsp;<span class="op" id="2091673">=</span>&nbsp;<span class="num" id="2091675">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091678">for</span>&nbsp;<span class="ident" id="2091682">d</span><span class="op" id="2091683">.</span><span class="ident" id="2091684">dp</span>&nbsp;<span class="op" id="2091687">&gt;</span>&nbsp;<span class="num" id="2091689">0</span>&nbsp;<span class="op" id="2091691">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091695">var</span>&nbsp;<span class="ident" id="2091699">n</span>&nbsp;<span class="builtintype" id="2091701">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091707">if</span>&nbsp;<span class="ident" id="2091710">d</span><span class="op" id="2091711">.</span><span class="ident" id="2091712">dp</span>&nbsp;<span class="op" id="2091715">&gt;=</span>&nbsp;<span class="builtinfunc" id="2091718">len</span><span class="op" id="2091721">(</span><span class="ident" id="2091722">powtab</span><span class="op" id="2091728">)</span>&nbsp;<span class="op" id="2091730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091735">n</span>&nbsp;<span class="op" id="2091737">=</span>&nbsp;<span class="num" id="2091739">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091744">}</span>&nbsp;<span class="keyword" id="2091746">else</span>&nbsp;<span class="op" id="2091751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091756">n</span>&nbsp;<span class="op" id="2091758">=</span>&nbsp;<span class="ident" id="2091760">powtab</span><span class="op" id="2091766">[</span><span class="ident" id="2091767">d</span><span class="op" id="2091768">.</span><span class="ident" id="2091769">dp</span><span class="op" id="2091771">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091779">d</span><span class="op" id="2091780">.</span><span class="ident" id="2091781">Shift</span><span class="op" id="2091786">(</span><span class="op" id="2091787">-</span><span class="ident" id="2091788">n</span><span class="op" id="2091789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091793">exp</span>&nbsp;<span class="op" id="2091797">+=</span>&nbsp;<span class="ident" id="2091800">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091806">for</span>&nbsp;<span class="ident" id="2091810">d</span><span class="op" id="2091811">.</span><span class="ident" id="2091812">dp</span>&nbsp;<span class="op" id="2091815">&lt;</span>&nbsp;<span class="num" id="2091817">0</span>&nbsp;<span class="op" id="2091819">||</span>&nbsp;<span class="ident" id="2091822">d</span><span class="op" id="2091823">.</span><span class="ident" id="2091824">dp</span>&nbsp;<span class="op" id="2091827">==</span>&nbsp;<span class="num" id="2091830">0</span>&nbsp;<span class="op" id="2091832">&amp;&amp;</span>&nbsp;<span class="ident" id="2091835">d</span><span class="op" id="2091836">.</span><span class="ident" id="2091837">d</span><span class="op" id="2091838">[</span><span class="num" id="2091839">0</span><span class="op" id="2091840">]</span>&nbsp;<span class="op" id="2091842">&lt;</span>&nbsp;<span class="string" id="2091844">&#39;5&#39;</span>&nbsp;<span class="op" id="2091848">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091852">var</span>&nbsp;<span class="ident" id="2091856">n</span>&nbsp;<span class="builtintype" id="2091858">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2091864">if</span>&nbsp;<span class="op" id="2091867">-</span><span class="ident" id="2091868">d</span><span class="op" id="2091869">.</span><span class="ident" id="2091870">dp</span>&nbsp;<span class="op" id="2091873">&gt;=</span>&nbsp;<span class="builtinfunc" id="2091876">len</span><span class="op" id="2091879">(</span><span class="ident" id="2091880">powtab</span><span class="op" id="2091886">)</span>&nbsp;<span class="op" id="2091888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091893">n</span>&nbsp;<span class="op" id="2091895">=</span>&nbsp;<span class="num" id="2091897">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091902">}</span>&nbsp;<span class="keyword" id="2091904">else</span>&nbsp;<span class="op" id="2091909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091914">n</span>&nbsp;<span class="op" id="2091916">=</span>&nbsp;<span class="ident" id="2091918">powtab</span><span class="op" id="2091924">[</span><span class="op" id="2091925">-</span><span class="ident" id="2091926">d</span><span class="op" id="2091927">.</span><span class="ident" id="2091928">dp</span><span class="op" id="2091930">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091938">d</span><span class="op" id="2091939">.</span><span class="ident" id="2091940">Shift</span><span class="op" id="2091945">(</span><span class="ident" id="2091946">n</span><span class="op" id="2091947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2091951">exp</span>&nbsp;<span class="op" id="2091955">-=</span>&nbsp;<span class="ident" id="2091958">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2091961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2091965">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092025">exp</span><span class="op" id="2092028">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092033">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092083">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092130">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092156">if</span>&nbsp;<span class="ident" id="2092159">exp</span>&nbsp;<span class="op" id="2092163">&lt;</span>&nbsp;<span class="ident" id="2092165">flt</span><span class="op" id="2092168">.</span><span class="ident" id="2092169">bias</span><span class="op" id="2092173">+</span><span class="num" id="2092174">1</span>&nbsp;<span class="op" id="2092176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092180">n</span>&nbsp;<span class="op" id="2092182">:=</span>&nbsp;<span class="ident" id="2092185">flt</span><span class="op" id="2092188">.</span><span class="ident" id="2092189">bias</span>&nbsp;<span class="op" id="2092194">+</span>&nbsp;<span class="num" id="2092196">1</span>&nbsp;<span class="op" id="2092198">-</span>&nbsp;<span class="ident" id="2092200">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092206">d</span><span class="op" id="2092207">.</span><span class="ident" id="2092208">Shift</span><span class="op" id="2092213">(</span><span class="op" id="2092214">-</span><span class="ident" id="2092215">n</span><span class="op" id="2092216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092220">exp</span>&nbsp;<span class="op" id="2092224">+=</span>&nbsp;<span class="ident" id="2092227">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092234">if</span>&nbsp;<span class="ident" id="2092237">exp</span><span class="op" id="2092240">-</span><span class="ident" id="2092241">flt</span><span class="op" id="2092244">.</span><span class="ident" id="2092245">bias</span>&nbsp;<span class="op" id="2092250">&gt;=</span>&nbsp;<span class="num" id="2092253">1</span><span class="op" id="2092254">&lt;&lt;</span><span class="ident" id="2092256">flt</span><span class="op" id="2092259">.</span><span class="ident" id="2092260">expbits</span><span class="op" id="2092267">-</span><span class="num" id="2092268">1</span>&nbsp;<span class="op" id="2092270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092274">goto</span>&nbsp;<span class="ident" id="2092279">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092289">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092293">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092326">d</span><span class="op" id="2092327">.</span><span class="ident" id="2092328">Shift</span><span class="op" id="2092333">(</span><span class="builtintype" id="2092334">int</span><span class="op" id="2092337">(</span><span class="num" id="2092338">1</span>&nbsp;<span class="op" id="2092340">+</span>&nbsp;<span class="ident" id="2092342">flt</span><span class="op" id="2092345">.</span><span class="ident" id="2092346">mantbits</span><span class="op" id="2092354">)</span><span class="op" id="2092355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092358">mant</span>&nbsp;<span class="op" id="2092363">=</span>&nbsp;<span class="ident" id="2092365">d</span><span class="op" id="2092366">.</span><span class="ident" id="2092367">RoundedInteger</span><span class="op" id="2092381">(</span><span class="op" id="2092382">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092386">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092435">if</span>&nbsp;<span class="ident" id="2092438">mant</span>&nbsp;<span class="op" id="2092443">==</span>&nbsp;<span class="num" id="2092446">2</span><span class="op" id="2092447">&lt;&lt;</span><span class="ident" id="2092449">flt</span><span class="op" id="2092452">.</span><span class="ident" id="2092453">mantbits</span>&nbsp;<span class="op" id="2092462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092466">mant</span>&nbsp;<span class="op" id="2092471">&gt;&gt;=</span>&nbsp;<span class="num" id="2092475">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092479">exp</span><span class="op" id="2092482">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092487">if</span>&nbsp;<span class="ident" id="2092490">exp</span><span class="op" id="2092493">-</span><span class="ident" id="2092494">flt</span><span class="op" id="2092497">.</span><span class="ident" id="2092498">bias</span>&nbsp;<span class="op" id="2092503">&gt;=</span>&nbsp;<span class="num" id="2092506">1</span><span class="op" id="2092507">&lt;&lt;</span><span class="ident" id="2092509">flt</span><span class="op" id="2092512">.</span><span class="ident" id="2092513">expbits</span><span class="op" id="2092520">-</span><span class="num" id="2092521">1</span>&nbsp;<span class="op" id="2092523">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092528">goto</span>&nbsp;<span class="ident" id="2092533">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092551">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092569">if</span>&nbsp;<span class="ident" id="2092572">mant</span><span class="op" id="2092576">&amp;</span><span class="op" id="2092577">(</span><span class="num" id="2092578">1</span><span class="op" id="2092579">&lt;&lt;</span><span class="ident" id="2092581">flt</span><span class="op" id="2092584">.</span><span class="ident" id="2092585">mantbits</span><span class="op" id="2092593">)</span>&nbsp;<span class="op" id="2092595">==</span>&nbsp;<span class="num" id="2092598">0</span>&nbsp;<span class="op" id="2092600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092604">exp</span>&nbsp;<span class="op" id="2092608">=</span>&nbsp;<span class="ident" id="2092610">flt</span><span class="op" id="2092613">.</span><span class="ident" id="2092614">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092623">goto</span>&nbsp;<span class="ident" id="2092628">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2092633">overflow</span><span class="op" id="2092641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092644">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092654">mant</span>&nbsp;<span class="op" id="2092659">=</span>&nbsp;<span class="num" id="2092661">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092664">exp</span>&nbsp;<span class="op" id="2092668">=</span>&nbsp;<span class="num" id="2092670">1</span><span class="op" id="2092671">&lt;&lt;</span><span class="ident" id="2092673">flt</span><span class="op" id="2092676">.</span><span class="ident" id="2092677">expbits</span>&nbsp;<span class="op" id="2092685">-</span>&nbsp;<span class="num" id="2092687">1</span>&nbsp;<span class="op" id="2092689">+</span>&nbsp;<span class="ident" id="2092691">flt</span><span class="op" id="2092694">.</span><span class="ident" id="2092695">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092701">overflow</span>&nbsp;<span class="op" id="2092710">=</span>&nbsp;<span class="builtintype" id="2092712">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2092718">out</span><span class="op" id="2092721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2092724">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092743">bits</span>&nbsp;<span class="op" id="2092748">:=</span>&nbsp;<span class="ident" id="2092751">mant</span>&nbsp;<span class="op" id="2092756">&amp;</span>&nbsp;<span class="op" id="2092758">(</span><span class="builtintype" id="2092759">uint64</span><span class="op" id="2092765">(</span><span class="num" id="2092766">1</span><span class="op" id="2092767">)</span><span class="op" id="2092768">&lt;&lt;</span><span class="ident" id="2092770">flt</span><span class="op" id="2092773">.</span><span class="ident" id="2092774">mantbits</span>&nbsp;<span class="op" id="2092783">-</span>&nbsp;<span class="num" id="2092785">1</span><span class="op" id="2092786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092789">bits</span>&nbsp;<span class="op" id="2092794">|=</span>&nbsp;<span class="builtintype" id="2092797">uint64</span><span class="op" id="2092803">(</span><span class="op" id="2092804">(</span><span class="ident" id="2092805">exp</span><span class="op" id="2092808">-</span><span class="ident" id="2092809">flt</span><span class="op" id="2092812">.</span><span class="ident" id="2092813">bias</span><span class="op" id="2092817">)</span><span class="op" id="2092818">&amp;</span><span class="op" id="2092819">(</span><span class="num" id="2092820">1</span><span class="op" id="2092821">&lt;&lt;</span><span class="ident" id="2092823">flt</span><span class="op" id="2092826">.</span><span class="ident" id="2092827">expbits</span><span class="op" id="2092834">-</span><span class="num" id="2092835">1</span><span class="op" id="2092836">)</span><span class="op" id="2092837">)</span>&nbsp;<span class="op" id="2092839">&lt;&lt;</span>&nbsp;<span class="ident" id="2092842">flt</span><span class="op" id="2092845">.</span><span class="ident" id="2092846">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092856">if</span>&nbsp;<span class="ident" id="2092859">d</span><span class="op" id="2092860">.</span><span class="ident" id="2092861">neg</span>&nbsp;<span class="op" id="2092865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2092869">bits</span>&nbsp;<span class="op" id="2092874">|=</span>&nbsp;<span class="num" id="2092877">1</span>&nbsp;<span class="op" id="2092879">&lt;&lt;</span>&nbsp;<span class="ident" id="2092882">flt</span><span class="op" id="2092885">.</span><span class="ident" id="2092886">mantbits</span>&nbsp;<span class="op" id="2092895">&lt;&lt;</span>&nbsp;<span class="ident" id="2092898">flt</span><span class="op" id="2092901">.</span><span class="ident" id="2092902">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2092911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2092914">return</span>&nbsp;<span class="ident" id="2092921">bits</span><span class="op" id="2092925">,</span>&nbsp;<span class="ident" id="2092927">overflow</span><br>
<span class="lineno"></span><span class="op" id="2092936">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2092939">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2092962">var</span>&nbsp;<span class="ident" id="2092966">float64pow10</span>&nbsp;<span class="op" id="2092979">=</span>&nbsp;<span class="op" id="2092981">[</span><span class="op" id="2092982">]</span><span class="builtintype" id="2092983">float64</span><span class="op" id="2092990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2092993">1e0</span><span class="op" id="2092996">,</span>&nbsp;<span class="num" id="2092998">1e1</span><span class="op" id="2093001">,</span>&nbsp;<span class="num" id="2093003">1e2</span><span class="op" id="2093006">,</span>&nbsp;<span class="num" id="2093008">1e3</span><span class="op" id="2093011">,</span>&nbsp;<span class="num" id="2093013">1e4</span><span class="op" id="2093016">,</span>&nbsp;<span class="num" id="2093018">1e5</span><span class="op" id="2093021">,</span>&nbsp;<span class="num" id="2093023">1e6</span><span class="op" id="2093026">,</span>&nbsp;<span class="num" id="2093028">1e7</span><span class="op" id="2093031">,</span>&nbsp;<span class="num" id="2093033">1e8</span><span class="op" id="2093036">,</span>&nbsp;<span class="num" id="2093038">1e9</span><span class="op" id="2093041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2093044">1e10</span><span class="op" id="2093048">,</span>&nbsp;<span class="num" id="2093050">1e11</span><span class="op" id="2093054">,</span>&nbsp;<span class="num" id="2093056">1e12</span><span class="op" id="2093060">,</span>&nbsp;<span class="num" id="2093062">1e13</span><span class="op" id="2093066">,</span>&nbsp;<span class="num" id="2093068">1e14</span><span class="op" id="2093072">,</span>&nbsp;<span class="num" id="2093074">1e15</span><span class="op" id="2093078">,</span>&nbsp;<span class="num" id="2093080">1e16</span><span class="op" id="2093084">,</span>&nbsp;<span class="num" id="2093086">1e17</span><span class="op" id="2093090">,</span>&nbsp;<span class="num" id="2093092">1e18</span><span class="op" id="2093096">,</span>&nbsp;<span class="num" id="2093098">1e19</span><span class="op" id="2093102">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2093105">1e20</span><span class="op" id="2093109">,</span>&nbsp;<span class="num" id="2093111">1e21</span><span class="op" id="2093115">,</span>&nbsp;<span class="num" id="2093117">1e22</span><span class="op" id="2093121">,</span><br>
<span class="lineno"></span><span class="op" id="2093123">}</span><br>
<span class="lineno"></span><span class="keyword" id="2093125">var</span>&nbsp;<span class="ident" id="2093129">float32pow10</span>&nbsp;<span class="op" id="2093142">=</span>&nbsp;<span class="op" id="2093144">[</span><span class="op" id="2093145">]</span><span class="builtintype" id="2093146">float32</span><span class="op" id="2093153">{</span><span class="num" id="2093154">1e0</span><span class="op" id="2093157">,</span>&nbsp;<span class="num" id="2093159">1e1</span><span class="op" id="2093162">,</span>&nbsp;<span class="num" id="2093164">1e2</span><span class="op" id="2093167">,</span>&nbsp;<span class="num" id="2093169">1e3</span><span class="op" id="2093172">,</span>&nbsp;<span class="num" id="2093174">1e4</span><span class="op" id="2093177">,</span>&nbsp;<span class="num" id="2093179">1e5</span><span class="op" id="2093182">,</span>&nbsp;<span class="num" id="2093184">1e6</span><span class="op" id="2093187">,</span>&nbsp;<span class="num" id="2093189">1e7</span><span class="op" id="2093192">,</span>&nbsp;<span class="num" id="2093194">1e8</span><span class="op" id="2093197">,</span>&nbsp;<span class="num" id="2093199">1e9</span><span class="op" id="2093202">,</span>&nbsp;<span class="num" id="2093204">1e10</span><span class="op" id="2093208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2093211">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2093287">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2093374">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2093397">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2093423">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2093470">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2093517">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2093589">func</span>&nbsp;<span class="ident" id="2093594">atof64exact</span><span class="op" id="2093605">(</span><span class="ident" id="2093606">mantissa</span>&nbsp;<span class="builtintype" id="2093615">uint64</span><span class="op" id="2093621">,</span>&nbsp;<span class="ident" id="2093623">exp</span>&nbsp;<span class="builtintype" id="2093627">int</span><span class="op" id="2093630">,</span>&nbsp;<span class="ident" id="2093632">neg</span>&nbsp;<span class="builtintype" id="2093636">bool</span><span class="op" id="2093640">)</span>&nbsp;<span class="op" id="2093642">(</span><span class="ident" id="2093643">f</span>&nbsp;<span class="builtintype" id="2093645">float64</span><span class="op" id="2093652">,</span>&nbsp;<span class="ident" id="2093654">ok</span>&nbsp;<span class="builtintype" id="2093657">bool</span><span class="op" id="2093661">)</span>&nbsp;<span class="op" id="2093663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093666">if</span>&nbsp;<span class="ident" id="2093669">mantissa</span><span class="op" id="2093677">&gt;&gt;</span><span class="ident" id="2093679">float64info</span><span class="op" id="2093690">.</span><span class="ident" id="2093691">mantbits</span>&nbsp;<span class="op" id="2093700">!=</span>&nbsp;<span class="num" id="2093703">0</span>&nbsp;<span class="op" id="2093705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093709">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093717">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093720">f</span>&nbsp;<span class="op" id="2093722">=</span>&nbsp;<span class="builtintype" id="2093724">float64</span><span class="op" id="2093731">(</span><span class="ident" id="2093732">mantissa</span><span class="op" id="2093740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093743">if</span>&nbsp;<span class="ident" id="2093746">neg</span>&nbsp;<span class="op" id="2093750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2093754">f</span>&nbsp;<span class="op" id="2093756">=</span>&nbsp;<span class="op" id="2093758">-</span><span class="ident" id="2093759">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2093762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093765">switch</span>&nbsp;<span class="op" id="2093772">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093775">case</span>&nbsp;<span class="ident" id="2093780">exp</span>&nbsp;<span class="op" id="2093784">==</span>&nbsp;<span class="num" id="2093787">0</span><span class="op" id="2093788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093792">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093809">return</span>&nbsp;<span class="ident" id="2093816">f</span><span class="op" id="2093817">,</span>&nbsp;<span class="builtintype" id="2093819">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093825">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093858">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2093896">case</span>&nbsp;<span class="ident" id="2093901">exp</span>&nbsp;<span class="op" id="2093905">&gt;</span>&nbsp;<span class="num" id="2093907">0</span>&nbsp;<span class="op" id="2093909">&amp;&amp;</span>&nbsp;<span class="ident" id="2093912">exp</span>&nbsp;<span class="op" id="2093916">&lt;=</span>&nbsp;<span class="num" id="2093919">15</span><span class="op" id="2093921">+</span><span class="num" id="2093922">22</span><span class="op" id="2093924">:</span>&nbsp;<span class="comment" id="2093926">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093942">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2093995">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094044">if</span>&nbsp;<span class="ident" id="2094047">exp</span>&nbsp;<span class="op" id="2094051">&gt;</span>&nbsp;<span class="num" id="2094053">22</span>&nbsp;<span class="op" id="2094056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094061">f</span>&nbsp;<span class="op" id="2094063">*=</span>&nbsp;<span class="ident" id="2094066">float64pow10</span><span class="op" id="2094078">[</span><span class="ident" id="2094079">exp</span><span class="op" id="2094082">-</span><span class="num" id="2094083">22</span><span class="op" id="2094085">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094090">exp</span>&nbsp;<span class="op" id="2094094">=</span>&nbsp;<span class="num" id="2094096">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094105">if</span>&nbsp;<span class="ident" id="2094108">f</span>&nbsp;<span class="op" id="2094110">&gt;</span>&nbsp;<span class="num" id="2094112">1e15</span>&nbsp;<span class="op" id="2094117">||</span>&nbsp;<span class="ident" id="2094120">f</span>&nbsp;<span class="op" id="2094122">&lt;</span>&nbsp;<span class="op" id="2094124">-</span><span class="num" id="2094125">1e15</span>&nbsp;<span class="op" id="2094130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094135">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094176">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094189">return</span>&nbsp;<span class="ident" id="2094196">f</span>&nbsp;<span class="op" id="2094198">*</span>&nbsp;<span class="ident" id="2094200">float64pow10</span><span class="op" id="2094212">[</span><span class="ident" id="2094213">exp</span><span class="op" id="2094216">]</span><span class="op" id="2094217">,</span>&nbsp;<span class="builtintype" id="2094219">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094225">case</span>&nbsp;<span class="ident" id="2094230">exp</span>&nbsp;<span class="op" id="2094234">&lt;</span>&nbsp;<span class="num" id="2094236">0</span>&nbsp;<span class="op" id="2094238">&amp;&amp;</span>&nbsp;<span class="ident" id="2094241">exp</span>&nbsp;<span class="op" id="2094245">&gt;=</span>&nbsp;<span class="op" id="2094248">-</span><span class="num" id="2094249">22</span><span class="op" id="2094251">:</span>&nbsp;<span class="comment" id="2094253">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094269">return</span>&nbsp;<span class="ident" id="2094276">f</span>&nbsp;<span class="op" id="2094278">/</span>&nbsp;<span class="ident" id="2094280">float64pow10</span><span class="op" id="2094292">[</span><span class="op" id="2094293">-</span><span class="ident" id="2094294">exp</span><span class="op" id="2094297">]</span><span class="op" id="2094298">,</span>&nbsp;<span class="builtintype" id="2094300">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094306">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094309">return</span><br>
<span class="lineno"></span><span class="op" id="2094316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2094319">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2094388">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2094461">func</span>&nbsp;<span class="ident" id="2094466">atof32exact</span><span class="op" id="2094477">(</span><span class="ident" id="2094478">mantissa</span>&nbsp;<span class="builtintype" id="2094487">uint64</span><span class="op" id="2094493">,</span>&nbsp;<span class="ident" id="2094495">exp</span>&nbsp;<span class="builtintype" id="2094499">int</span><span class="op" id="2094502">,</span>&nbsp;<span class="ident" id="2094504">neg</span>&nbsp;<span class="builtintype" id="2094508">bool</span><span class="op" id="2094512">)</span>&nbsp;<span class="op" id="2094514">(</span><span class="ident" id="2094515">f</span>&nbsp;<span class="builtintype" id="2094517">float32</span><span class="op" id="2094524">,</span>&nbsp;<span class="ident" id="2094526">ok</span>&nbsp;<span class="builtintype" id="2094529">bool</span><span class="op" id="2094533">)</span>&nbsp;<span class="op" id="2094535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094538">if</span>&nbsp;<span class="ident" id="2094541">mantissa</span><span class="op" id="2094549">&gt;&gt;</span><span class="ident" id="2094551">float32info</span><span class="op" id="2094562">.</span><span class="ident" id="2094563">mantbits</span>&nbsp;<span class="op" id="2094572">!=</span>&nbsp;<span class="num" id="2094575">0</span>&nbsp;<span class="op" id="2094577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094581">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094592">f</span>&nbsp;<span class="op" id="2094594">=</span>&nbsp;<span class="builtintype" id="2094596">float32</span><span class="op" id="2094603">(</span><span class="ident" id="2094604">mantissa</span><span class="op" id="2094612">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094615">if</span>&nbsp;<span class="ident" id="2094618">neg</span>&nbsp;<span class="op" id="2094622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094626">f</span>&nbsp;<span class="op" id="2094628">=</span>&nbsp;<span class="op" id="2094630">-</span><span class="ident" id="2094631">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094637">switch</span>&nbsp;<span class="op" id="2094644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094647">case</span>&nbsp;<span class="ident" id="2094652">exp</span>&nbsp;<span class="op" id="2094656">==</span>&nbsp;<span class="num" id="2094659">0</span><span class="op" id="2094660">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094664">return</span>&nbsp;<span class="ident" id="2094671">f</span><span class="op" id="2094672">,</span>&nbsp;<span class="builtintype" id="2094674">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094680">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094712">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094750">case</span>&nbsp;<span class="ident" id="2094755">exp</span>&nbsp;<span class="op" id="2094759">&gt;</span>&nbsp;<span class="num" id="2094761">0</span>&nbsp;<span class="op" id="2094763">&amp;&amp;</span>&nbsp;<span class="ident" id="2094766">exp</span>&nbsp;<span class="op" id="2094770">&lt;=</span>&nbsp;<span class="num" id="2094773">7</span><span class="op" id="2094774">+</span><span class="num" id="2094775">10</span><span class="op" id="2094777">:</span>&nbsp;<span class="comment" id="2094779">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094795">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094848">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094897">if</span>&nbsp;<span class="ident" id="2094900">exp</span>&nbsp;<span class="op" id="2094904">&gt;</span>&nbsp;<span class="num" id="2094906">10</span>&nbsp;<span class="op" id="2094909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094914">f</span>&nbsp;<span class="op" id="2094916">*=</span>&nbsp;<span class="ident" id="2094919">float32pow10</span><span class="op" id="2094931">[</span><span class="ident" id="2094932">exp</span><span class="op" id="2094935">-</span><span class="num" id="2094936">10</span><span class="op" id="2094938">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2094943">exp</span>&nbsp;<span class="op" id="2094947">=</span>&nbsp;<span class="num" id="2094949">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2094954">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2094958">if</span>&nbsp;<span class="ident" id="2094961">f</span>&nbsp;<span class="op" id="2094963">&gt;</span>&nbsp;<span class="num" id="2094965">1e7</span>&nbsp;<span class="op" id="2094969">||</span>&nbsp;<span class="ident" id="2094972">f</span>&nbsp;<span class="op" id="2094974">&lt;</span>&nbsp;<span class="op" id="2094976">-</span><span class="num" id="2094977">1e7</span>&nbsp;<span class="op" id="2094981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2094986">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095027">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095040">return</span>&nbsp;<span class="ident" id="2095047">f</span>&nbsp;<span class="op" id="2095049">*</span>&nbsp;<span class="ident" id="2095051">float32pow10</span><span class="op" id="2095063">[</span><span class="ident" id="2095064">exp</span><span class="op" id="2095067">]</span><span class="op" id="2095068">,</span>&nbsp;<span class="builtintype" id="2095070">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095076">case</span>&nbsp;<span class="ident" id="2095081">exp</span>&nbsp;<span class="op" id="2095085">&lt;</span>&nbsp;<span class="num" id="2095087">0</span>&nbsp;<span class="op" id="2095089">&amp;&amp;</span>&nbsp;<span class="ident" id="2095092">exp</span>&nbsp;<span class="op" id="2095096">&gt;=</span>&nbsp;<span class="op" id="2095099">-</span><span class="num" id="2095100">10</span><span class="op" id="2095102">:</span>&nbsp;<span class="comment" id="2095104">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095120">return</span>&nbsp;<span class="ident" id="2095127">f</span>&nbsp;<span class="op" id="2095129">/</span>&nbsp;<span class="ident" id="2095131">float32pow10</span><span class="op" id="2095143">[</span><span class="op" id="2095144">-</span><span class="ident" id="2095145">exp</span><span class="op" id="2095148">]</span><span class="op" id="2095149">,</span>&nbsp;<span class="builtintype" id="2095151">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095160">return</span><br>
<span class="lineno"></span><span class="op" id="2095167">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2095170">const</span>&nbsp;<span class="ident" id="2095176">fnParseFloat</span>&nbsp;<span class="op" id="2095189">=</span>&nbsp;<span class="string" id="2095191">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2095205">func</span>&nbsp;<span class="ident" id="2095210">atof32</span><span class="op" id="2095216">(</span><span class="ident" id="2095217">s</span>&nbsp;<span class="builtintype" id="2095219">string</span><span class="op" id="2095225">)</span>&nbsp;<span class="op" id="2095227">(</span><span class="ident" id="2095228">f</span>&nbsp;<span class="builtintype" id="2095230">float32</span><span class="op" id="2095237">,</span>&nbsp;<span class="ident" id="2095239">err</span>&nbsp;<span class="builtintype" id="2095243">error</span><span class="op" id="2095248">)</span>&nbsp;<span class="op" id="2095250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095253">if</span>&nbsp;<span class="ident" id="2095256">val</span><span class="op" id="2095259">,</span>&nbsp;<span class="ident" id="2095261">ok</span>&nbsp;<span class="op" id="2095264">:=</span>&nbsp;<span class="ident" id="2095267">special</span><span class="op" id="2095274">(</span><span class="ident" id="2095275">s</span><span class="op" id="2095276">)</span><span class="op" id="2095277">;</span>&nbsp;<span class="ident" id="2095279">ok</span>&nbsp;<span class="op" id="2095282">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095286">return</span>&nbsp;<span class="builtintype" id="2095293">float32</span><span class="op" id="2095300">(</span><span class="ident" id="2095301">val</span><span class="op" id="2095304">)</span><span class="op" id="2095305">,</span>&nbsp;<span class="builtintype" id="2095307">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095316">if</span>&nbsp;<span class="ident" id="2095319">optimize</span>&nbsp;<span class="op" id="2095328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2095332">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095366">mantissa</span><span class="op" id="2095374">,</span>&nbsp;<span class="ident" id="2095376">exp</span><span class="op" id="2095379">,</span>&nbsp;<span class="ident" id="2095381">neg</span><span class="op" id="2095384">,</span>&nbsp;<span class="ident" id="2095386">trunc</span><span class="op" id="2095391">,</span>&nbsp;<span class="ident" id="2095393">ok</span>&nbsp;<span class="op" id="2095396">:=</span>&nbsp;<span class="ident" id="2095399">readFloat</span><span class="op" id="2095408">(</span><span class="ident" id="2095409">s</span><span class="op" id="2095410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095414">if</span>&nbsp;<span class="ident" id="2095417">ok</span>&nbsp;<span class="op" id="2095420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2095425">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095478">if</span>&nbsp;<span class="op" id="2095481">!</span><span class="ident" id="2095482">trunc</span>&nbsp;<span class="op" id="2095488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095494">if</span>&nbsp;<span class="ident" id="2095497">f</span><span class="op" id="2095498">,</span>&nbsp;<span class="ident" id="2095500">ok</span>&nbsp;<span class="op" id="2095503">:=</span>&nbsp;<span class="ident" id="2095506">atof32exact</span><span class="op" id="2095517">(</span><span class="ident" id="2095518">mantissa</span><span class="op" id="2095526">,</span>&nbsp;<span class="ident" id="2095528">exp</span><span class="op" id="2095531">,</span>&nbsp;<span class="ident" id="2095533">neg</span><span class="op" id="2095536">)</span><span class="op" id="2095537">;</span>&nbsp;<span class="ident" id="2095539">ok</span>&nbsp;<span class="op" id="2095542">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095549">return</span>&nbsp;<span class="ident" id="2095556">f</span><span class="op" id="2095557">,</span>&nbsp;<span class="builtintype" id="2095559">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2095577">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095606">ext</span>&nbsp;<span class="op" id="2095610">:=</span>&nbsp;<span class="builtinfunc" id="2095613">new</span><span class="op" id="2095616">(</span><span class="ident" id="2095617">extFloat</span><span class="op" id="2095625">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095630">if</span>&nbsp;<span class="ident" id="2095633">ok</span>&nbsp;<span class="op" id="2095636">:=</span>&nbsp;<span class="ident" id="2095639">ext</span><span class="op" id="2095642">.</span><span class="ident" id="2095643">AssignDecimal</span><span class="op" id="2095656">(</span><span class="ident" id="2095657">mantissa</span><span class="op" id="2095665">,</span>&nbsp;<span class="ident" id="2095667">exp</span><span class="op" id="2095670">,</span>&nbsp;<span class="ident" id="2095672">neg</span><span class="op" id="2095675">,</span>&nbsp;<span class="ident" id="2095677">trunc</span><span class="op" id="2095682">,</span>&nbsp;<span class="op" id="2095684">&amp;</span><span class="ident" id="2095685">float32info</span><span class="op" id="2095696">)</span><span class="op" id="2095697">;</span>&nbsp;<span class="ident" id="2095699">ok</span>&nbsp;<span class="op" id="2095702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095708">b</span><span class="op" id="2095709">,</span>&nbsp;<span class="ident" id="2095711">ovf</span>&nbsp;<span class="op" id="2095715">:=</span>&nbsp;<span class="ident" id="2095718">ext</span><span class="op" id="2095721">.</span><span class="ident" id="2095722">floatBits</span><span class="op" id="2095731">(</span><span class="op" id="2095732">&amp;</span><span class="ident" id="2095733">float32info</span><span class="op" id="2095744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095750">f</span>&nbsp;<span class="op" id="2095752">=</span>&nbsp;<span class="ident" id="2095754">math</span><span class="op" id="2095758">.</span><span class="ident" id="2095759">Float32frombits</span><span class="op" id="2095774">(</span><span class="builtintype" id="2095775">uint32</span><span class="op" id="2095781">(</span><span class="ident" id="2095782">b</span><span class="op" id="2095783">)</span><span class="op" id="2095784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095790">if</span>&nbsp;<span class="ident" id="2095793">ovf</span>&nbsp;<span class="op" id="2095797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095804">err</span>&nbsp;<span class="op" id="2095808">=</span>&nbsp;<span class="ident" id="2095810">rangeError</span><span class="op" id="2095820">(</span><span class="ident" id="2095821">fnParseFloat</span><span class="op" id="2095833">,</span>&nbsp;<span class="ident" id="2095835">s</span><span class="op" id="2095836">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095848">return</span>&nbsp;<span class="ident" id="2095855">f</span><span class="op" id="2095856">,</span>&nbsp;<span class="ident" id="2095858">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095872">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095875">var</span>&nbsp;<span class="ident" id="2095879">d</span>&nbsp;<span class="ident" id="2095881">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095890">if</span>&nbsp;<span class="op" id="2095893">!</span><span class="ident" id="2095894">d</span><span class="op" id="2095895">.</span><span class="ident" id="2095896">set</span><span class="op" id="2095899">(</span><span class="ident" id="2095900">s</span><span class="op" id="2095901">)</span>&nbsp;<span class="op" id="2095903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2095907">return</span>&nbsp;<span class="num" id="2095914">0</span><span class="op" id="2095915">,</span>&nbsp;<span class="ident" id="2095917">syntaxError</span><span class="op" id="2095928">(</span><span class="ident" id="2095929">fnParseFloat</span><span class="op" id="2095941">,</span>&nbsp;<span class="ident" id="2095943">s</span><span class="op" id="2095944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2095947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095950">b</span><span class="op" id="2095951">,</span>&nbsp;<span class="ident" id="2095953">ovf</span>&nbsp;<span class="op" id="2095957">:=</span>&nbsp;<span class="ident" id="2095960">d</span><span class="op" id="2095961">.</span><span class="ident" id="2095962">floatBits</span><span class="op" id="2095971">(</span><span class="op" id="2095972">&amp;</span><span class="ident" id="2095973">float32info</span><span class="op" id="2095984">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2095987">f</span>&nbsp;<span class="op" id="2095989">=</span>&nbsp;<span class="ident" id="2095991">math</span><span class="op" id="2095995">.</span><span class="ident" id="2095996">Float32frombits</span><span class="op" id="2096011">(</span><span class="builtintype" id="2096012">uint32</span><span class="op" id="2096018">(</span><span class="ident" id="2096019">b</span><span class="op" id="2096020">)</span><span class="op" id="2096021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096024">if</span>&nbsp;<span class="ident" id="2096027">ovf</span>&nbsp;<span class="op" id="2096031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096035">err</span>&nbsp;<span class="op" id="2096039">=</span>&nbsp;<span class="ident" id="2096041">rangeError</span><span class="op" id="2096051">(</span><span class="ident" id="2096052">fnParseFloat</span><span class="op" id="2096064">,</span>&nbsp;<span class="ident" id="2096066">s</span><span class="op" id="2096067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096073">return</span>&nbsp;<span class="ident" id="2096080">f</span><span class="op" id="2096081">,</span>&nbsp;<span class="ident" id="2096083">err</span><br>
<span class="lineno">475</span><span class="op" id="2096087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2096090">func</span>&nbsp;<span class="ident" id="2096095">atof64</span><span class="op" id="2096101">(</span><span class="ident" id="2096102">s</span>&nbsp;<span class="builtintype" id="2096104">string</span><span class="op" id="2096110">)</span>&nbsp;<span class="op" id="2096112">(</span><span class="ident" id="2096113">f</span>&nbsp;<span class="builtintype" id="2096115">float64</span><span class="op" id="2096122">,</span>&nbsp;<span class="ident" id="2096124">err</span>&nbsp;<span class="builtintype" id="2096128">error</span><span class="op" id="2096133">)</span>&nbsp;<span class="op" id="2096135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096138">if</span>&nbsp;<span class="ident" id="2096141">val</span><span class="op" id="2096144">,</span>&nbsp;<span class="ident" id="2096146">ok</span>&nbsp;<span class="op" id="2096149">:=</span>&nbsp;<span class="ident" id="2096152">special</span><span class="op" id="2096159">(</span><span class="ident" id="2096160">s</span><span class="op" id="2096161">)</span><span class="op" id="2096162">;</span>&nbsp;<span class="ident" id="2096164">ok</span>&nbsp;<span class="op" id="2096167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096171">return</span>&nbsp;<span class="ident" id="2096178">val</span><span class="op" id="2096181">,</span>&nbsp;<span class="builtintype" id="2096183">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096192">if</span>&nbsp;<span class="ident" id="2096195">optimize</span>&nbsp;<span class="op" id="2096204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2096208">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096242">mantissa</span><span class="op" id="2096250">,</span>&nbsp;<span class="ident" id="2096252">exp</span><span class="op" id="2096255">,</span>&nbsp;<span class="ident" id="2096257">neg</span><span class="op" id="2096260">,</span>&nbsp;<span class="ident" id="2096262">trunc</span><span class="op" id="2096267">,</span>&nbsp;<span class="ident" id="2096269">ok</span>&nbsp;<span class="op" id="2096272">:=</span>&nbsp;<span class="ident" id="2096275">readFloat</span><span class="op" id="2096284">(</span><span class="ident" id="2096285">s</span><span class="op" id="2096286">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096290">if</span>&nbsp;<span class="ident" id="2096293">ok</span>&nbsp;<span class="op" id="2096296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2096301">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096354">if</span>&nbsp;<span class="op" id="2096357">!</span><span class="ident" id="2096358">trunc</span>&nbsp;<span class="op" id="2096364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096370">if</span>&nbsp;<span class="ident" id="2096373">f</span><span class="op" id="2096374">,</span>&nbsp;<span class="ident" id="2096376">ok</span>&nbsp;<span class="op" id="2096379">:=</span>&nbsp;<span class="ident" id="2096382">atof64exact</span><span class="op" id="2096393">(</span><span class="ident" id="2096394">mantissa</span><span class="op" id="2096402">,</span>&nbsp;<span class="ident" id="2096404">exp</span><span class="op" id="2096407">,</span>&nbsp;<span class="ident" id="2096409">neg</span><span class="op" id="2096412">)</span><span class="op" id="2096413">;</span>&nbsp;<span class="ident" id="2096415">ok</span>&nbsp;<span class="op" id="2096418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096425">return</span>&nbsp;<span class="ident" id="2096432">f</span><span class="op" id="2096433">,</span>&nbsp;<span class="builtintype" id="2096435">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2096453">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096482">ext</span>&nbsp;<span class="op" id="2096486">:=</span>&nbsp;<span class="builtinfunc" id="2096489">new</span><span class="op" id="2096492">(</span><span class="ident" id="2096493">extFloat</span><span class="op" id="2096501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096506">if</span>&nbsp;<span class="ident" id="2096509">ok</span>&nbsp;<span class="op" id="2096512">:=</span>&nbsp;<span class="ident" id="2096515">ext</span><span class="op" id="2096518">.</span><span class="ident" id="2096519">AssignDecimal</span><span class="op" id="2096532">(</span><span class="ident" id="2096533">mantissa</span><span class="op" id="2096541">,</span>&nbsp;<span class="ident" id="2096543">exp</span><span class="op" id="2096546">,</span>&nbsp;<span class="ident" id="2096548">neg</span><span class="op" id="2096551">,</span>&nbsp;<span class="ident" id="2096553">trunc</span><span class="op" id="2096558">,</span>&nbsp;<span class="op" id="2096560">&amp;</span><span class="ident" id="2096561">float64info</span><span class="op" id="2096572">)</span><span class="op" id="2096573">;</span>&nbsp;<span class="ident" id="2096575">ok</span>&nbsp;<span class="op" id="2096578">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096584">b</span><span class="op" id="2096585">,</span>&nbsp;<span class="ident" id="2096587">ovf</span>&nbsp;<span class="op" id="2096591">:=</span>&nbsp;<span class="ident" id="2096594">ext</span><span class="op" id="2096597">.</span><span class="ident" id="2096598">floatBits</span><span class="op" id="2096607">(</span><span class="op" id="2096608">&amp;</span><span class="ident" id="2096609">float64info</span><span class="op" id="2096620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096626">f</span>&nbsp;<span class="op" id="2096628">=</span>&nbsp;<span class="ident" id="2096630">math</span><span class="op" id="2096634">.</span><span class="ident" id="2096635">Float64frombits</span><span class="op" id="2096650">(</span><span class="ident" id="2096651">b</span><span class="op" id="2096652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096658">if</span>&nbsp;<span class="ident" id="2096661">ovf</span>&nbsp;<span class="op" id="2096665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096672">err</span>&nbsp;<span class="op" id="2096676">=</span>&nbsp;<span class="ident" id="2096678">rangeError</span><span class="op" id="2096688">(</span><span class="ident" id="2096689">fnParseFloat</span><span class="op" id="2096701">,</span>&nbsp;<span class="ident" id="2096703">s</span><span class="op" id="2096704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096710">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096716">return</span>&nbsp;<span class="ident" id="2096723">f</span><span class="op" id="2096724">,</span>&nbsp;<span class="ident" id="2096726">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096743">var</span>&nbsp;<span class="ident" id="2096747">d</span>&nbsp;<span class="ident" id="2096749">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096758">if</span>&nbsp;<span class="op" id="2096761">!</span><span class="ident" id="2096762">d</span><span class="op" id="2096763">.</span><span class="ident" id="2096764">set</span><span class="op" id="2096767">(</span><span class="ident" id="2096768">s</span><span class="op" id="2096769">)</span>&nbsp;<span class="op" id="2096771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096775">return</span>&nbsp;<span class="num" id="2096782">0</span><span class="op" id="2096783">,</span>&nbsp;<span class="ident" id="2096785">syntaxError</span><span class="op" id="2096796">(</span><span class="ident" id="2096797">fnParseFloat</span><span class="op" id="2096809">,</span>&nbsp;<span class="ident" id="2096811">s</span><span class="op" id="2096812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096818">b</span><span class="op" id="2096819">,</span>&nbsp;<span class="ident" id="2096821">ovf</span>&nbsp;<span class="op" id="2096825">:=</span>&nbsp;<span class="ident" id="2096828">d</span><span class="op" id="2096829">.</span><span class="ident" id="2096830">floatBits</span><span class="op" id="2096839">(</span><span class="op" id="2096840">&amp;</span><span class="ident" id="2096841">float64info</span><span class="op" id="2096852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096855">f</span>&nbsp;<span class="op" id="2096857">=</span>&nbsp;<span class="ident" id="2096859">math</span><span class="op" id="2096863">.</span><span class="ident" id="2096864">Float64frombits</span><span class="op" id="2096879">(</span><span class="ident" id="2096880">b</span><span class="op" id="2096881">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096884">if</span>&nbsp;<span class="ident" id="2096887">ovf</span>&nbsp;<span class="op" id="2096891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2096895">err</span>&nbsp;<span class="op" id="2096899">=</span>&nbsp;<span class="ident" id="2096901">rangeError</span><span class="op" id="2096911">(</span><span class="ident" id="2096912">fnParseFloat</span><span class="op" id="2096924">,</span>&nbsp;<span class="ident" id="2096926">s</span><span class="op" id="2096927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2096930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2096933">return</span>&nbsp;<span class="ident" id="2096940">f</span><span class="op" id="2096941">,</span>&nbsp;<span class="ident" id="2096943">err</span><br>
<span class="lineno"></span><span class="op" id="2096947">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2096950">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2097013">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2097092">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2097162">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2097216">//</span><br>
<span class="lineno"></span><span class="comment" id="2097219">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2097282">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2097346">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2097382">//</span><br>
<span class="lineno">525</span><span class="comment" id="2097385">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2097452">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2097480">//</span><br>
<span class="lineno"></span><span class="comment" id="2097483">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2097565">//</span><br>
<span class="lineno">530</span><span class="comment" id="2097568">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2097630">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2097696">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;±Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2097749">func</span>&nbsp;<span class="ident" id="2097754">ParseFloat</span><span class="op" id="2097764">(</span><span class="ident" id="2097765">s</span>&nbsp;<span class="builtintype" id="2097767">string</span><span class="op" id="2097773">,</span>&nbsp;<span class="ident" id="2097775">bitSize</span>&nbsp;<span class="builtintype" id="2097783">int</span><span class="op" id="2097786">)</span>&nbsp;<span class="op" id="2097788">(</span><span class="ident" id="2097789">f</span>&nbsp;<span class="builtintype" id="2097791">float64</span><span class="op" id="2097798">,</span>&nbsp;<span class="ident" id="2097800">err</span>&nbsp;<span class="builtintype" id="2097804">error</span><span class="op" id="2097809">)</span>&nbsp;<span class="op" id="2097811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2097814">if</span>&nbsp;<span class="ident" id="2097817">bitSize</span>&nbsp;<span class="op" id="2097825">==</span>&nbsp;<span class="num" id="2097828">32</span>&nbsp;<span class="op" id="2097831">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097835">f1</span><span class="op" id="2097837">,</span>&nbsp;<span class="ident" id="2097839">err1</span>&nbsp;<span class="op" id="2097844">:=</span>&nbsp;<span class="ident" id="2097847">atof32</span><span class="op" id="2097853">(</span><span class="ident" id="2097854">s</span><span class="op" id="2097855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2097859">return</span>&nbsp;<span class="builtintype" id="2097866">float64</span><span class="op" id="2097873">(</span><span class="ident" id="2097874">f1</span><span class="op" id="2097876">)</span><span class="op" id="2097877">,</span>&nbsp;<span class="ident" id="2097879">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2097885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2097888">f1</span><span class="op" id="2097890">,</span>&nbsp;<span class="ident" id="2097892">err1</span>&nbsp;<span class="op" id="2097897">:=</span>&nbsp;<span class="ident" id="2097900">atof64</span><span class="op" id="2097906">(</span><span class="ident" id="2097907">s</span><span class="op" id="2097908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2097911">return</span>&nbsp;<span class="ident" id="2097918">f1</span><span class="op" id="2097920">,</span>&nbsp;<span class="ident" id="2097922">err1</span><br>
<span class="lineno">540</span><span class="op" id="2097927">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
