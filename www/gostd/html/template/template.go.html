<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5185842">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5185897">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5185951">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5186002">package</span>&nbsp;<span class="ident" id="5186010">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5186020">import</span>&nbsp;<span class="op" id="5186027">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186030">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186037">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186043">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186056">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186073">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186081">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5186098">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5186120">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5186123">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="5186203">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="5186230">type</span>&nbsp;<span class="ident" id="5186235">Template</span>&nbsp;<span class="keyword" id="5186244">struct</span>&nbsp;<span class="op" id="5186251">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186254">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186290">escapeErr</span>&nbsp;<span class="builtintype" id="5186300">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186307">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186381">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186450">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186474">text</span>&nbsp;<span class="op" id="5186479">*</span><span class="ident" id="5186480">template</span><span class="op" id="5186488">.</span><span class="ident" id="5186489">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186499">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186566">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5186577">*</span><span class="ident" id="5186578">parse</span><span class="op" id="5186583">.</span><span class="ident" id="5186584">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186590">*</span><span class="ident" id="5186591">nameSpace</span>&nbsp;<span class="comment" id="5186601">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="5186639">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5186642">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="5186707">var</span>&nbsp;<span class="ident" id="5186711">escapeOK</span>&nbsp;<span class="op" id="5186720">=</span>&nbsp;<span class="ident" id="5186722">fmt</span><span class="op" id="5186725">.</span><span class="ident" id="5186726">Errorf</span><span class="op" id="5186732">(</span><span class="string" id="5186733">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="5186761">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5186764">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="5186842">type</span>&nbsp;<span class="ident" id="5186847">nameSpace</span>&nbsp;<span class="keyword" id="5186857">struct</span>&nbsp;<span class="op" id="5186864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186867">mu</span>&nbsp;&nbsp;<span class="ident" id="5186871">sync</span><span class="op" id="5186875">.</span><span class="ident" id="5186876">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186883">set</span>&nbsp;<span class="keyword" id="5186887">map</span><span class="op" id="5186890">[</span><span class="builtintype" id="5186891">string</span><span class="op" id="5186897">]</span><span class="op" id="5186898">*</span><span class="ident" id="5186899">Template</span><br>
<span class="lineno"></span><span class="op" id="5186908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5186911">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="5186988">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5186999">func</span>&nbsp;<span class="op" id="5187004">(</span><span class="ident" id="5187005">t</span>&nbsp;<span class="op" id="5187007">*</span><span class="ident" id="5187008">Template</span><span class="op" id="5187016">)</span>&nbsp;<span class="ident" id="5187018">Templates</span><span class="op" id="5187027">(</span><span class="op" id="5187028">)</span>&nbsp;<span class="op" id="5187030">[</span><span class="op" id="5187031">]</span><span class="op" id="5187032">*</span><span class="ident" id="5187033">Template</span>&nbsp;<span class="op" id="5187042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187045">ns</span>&nbsp;<span class="op" id="5187048">:=</span>&nbsp;<span class="ident" id="5187051">t</span><span class="op" id="5187052">.</span><span class="ident" id="5187053">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187064">ns</span><span class="op" id="5187066">.</span><span class="ident" id="5187067">mu</span><span class="op" id="5187069">.</span><span class="ident" id="5187070">Lock</span><span class="op" id="5187074">(</span><span class="op" id="5187075">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187078">defer</span>&nbsp;<span class="ident" id="5187084">ns</span><span class="op" id="5187086">.</span><span class="ident" id="5187087">mu</span><span class="op" id="5187089">.</span><span class="ident" id="5187090">Unlock</span><span class="op" id="5187096">(</span><span class="op" id="5187097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5187100">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187147">m</span>&nbsp;<span class="op" id="5187149">:=</span>&nbsp;<span class="builtinfunc" id="5187152">make</span><span class="op" id="5187156">(</span><span class="op" id="5187157">[</span><span class="op" id="5187158">]</span><span class="op" id="5187159">*</span><span class="ident" id="5187160">Template</span><span class="op" id="5187168">,</span>&nbsp;<span class="num" id="5187170">0</span><span class="op" id="5187171">,</span>&nbsp;<span class="builtinfunc" id="5187173">len</span><span class="op" id="5187176">(</span><span class="ident" id="5187177">ns</span><span class="op" id="5187179">.</span><span class="ident" id="5187180">set</span><span class="op" id="5187183">)</span><span class="op" id="5187184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187187">for</span>&nbsp;<span class="ident" id="5187191">_</span><span class="op" id="5187192">,</span>&nbsp;<span class="ident" id="5187194">v</span>&nbsp;<span class="op" id="5187196">:=</span>&nbsp;<span class="keyword" id="5187199">range</span>&nbsp;<span class="ident" id="5187205">ns</span><span class="op" id="5187207">.</span><span class="ident" id="5187208">set</span>&nbsp;<span class="op" id="5187212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187216">m</span>&nbsp;<span class="op" id="5187218">=</span>&nbsp;<span class="builtinfunc" id="5187220">append</span><span class="op" id="5187226">(</span><span class="ident" id="5187227">m</span><span class="op" id="5187228">,</span>&nbsp;<span class="ident" id="5187230">v</span><span class="op" id="5187231">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187237">return</span>&nbsp;<span class="ident" id="5187244">m</span><br>
<span class="lineno"></span><span class="op" id="5187246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187249">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="5187293">func</span>&nbsp;<span class="op" id="5187298">(</span><span class="ident" id="5187299">t</span>&nbsp;<span class="op" id="5187301">*</span><span class="ident" id="5187302">Template</span><span class="op" id="5187310">)</span>&nbsp;<span class="ident" id="5187312">escape</span><span class="op" id="5187318">(</span><span class="op" id="5187319">)</span>&nbsp;<span class="builtintype" id="5187321">error</span>&nbsp;<span class="op" id="5187327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187330">t</span><span class="op" id="5187331">.</span><span class="ident" id="5187332">nameSpace</span><span class="op" id="5187341">.</span><span class="ident" id="5187342">mu</span><span class="op" id="5187344">.</span><span class="ident" id="5187345">Lock</span><span class="op" id="5187349">(</span><span class="op" id="5187350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187353">defer</span>&nbsp;<span class="ident" id="5187359">t</span><span class="op" id="5187360">.</span><span class="ident" id="5187361">nameSpace</span><span class="op" id="5187370">.</span><span class="ident" id="5187371">mu</span><span class="op" id="5187373">.</span><span class="ident" id="5187374">Unlock</span><span class="op" id="5187380">(</span><span class="op" id="5187381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187384">if</span>&nbsp;<span class="ident" id="5187387">t</span><span class="op" id="5187388">.</span><span class="ident" id="5187389">escapeErr</span>&nbsp;<span class="op" id="5187399">==</span>&nbsp;<span class="ident" id="5187402">nil</span>&nbsp;<span class="op" id="5187406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187410">if</span>&nbsp;<span class="ident" id="5187413">err</span>&nbsp;<span class="op" id="5187417">:=</span>&nbsp;<span class="ident" id="5187420">escapeTemplate</span><span class="op" id="5187434">(</span><span class="ident" id="5187435">t</span><span class="op" id="5187436">,</span>&nbsp;<span class="ident" id="5187438">t</span><span class="op" id="5187439">.</span><span class="ident" id="5187440">text</span><span class="op" id="5187444">.</span><span class="ident" id="5187445">Root</span><span class="op" id="5187449">,</span>&nbsp;<span class="ident" id="5187451">t</span><span class="op" id="5187452">.</span><span class="ident" id="5187453">Name</span><span class="op" id="5187457">(</span><span class="op" id="5187458">)</span><span class="op" id="5187459">)</span><span class="op" id="5187460">;</span>&nbsp;<span class="ident" id="5187462">err</span>&nbsp;<span class="op" id="5187466">!=</span>&nbsp;<span class="ident" id="5187469">nil</span>&nbsp;<span class="op" id="5187473">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187478">return</span>&nbsp;<span class="ident" id="5187485">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187494">}</span>&nbsp;<span class="keyword" id="5187496">else</span>&nbsp;<span class="keyword" id="5187501">if</span>&nbsp;<span class="ident" id="5187504">t</span><span class="op" id="5187505">.</span><span class="ident" id="5187506">escapeErr</span>&nbsp;<span class="op" id="5187516">!=</span>&nbsp;<span class="ident" id="5187519">escapeOK</span>&nbsp;<span class="op" id="5187528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187532">return</span>&nbsp;<span class="ident" id="5187539">t</span><span class="op" id="5187540">.</span><span class="ident" id="5187541">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187552">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187555">return</span>&nbsp;<span class="ident" id="5187562">nil</span><br>
<span class="lineno"></span><span class="op" id="5187566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187569">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5187636">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="5187665">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5187733">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5187806">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5187828">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5187878">func</span>&nbsp;<span class="op" id="5187883">(</span><span class="ident" id="5187884">t</span>&nbsp;<span class="op" id="5187886">*</span><span class="ident" id="5187887">Template</span><span class="op" id="5187895">)</span>&nbsp;<span class="ident" id="5187897">Execute</span><span class="op" id="5187904">(</span><span class="ident" id="5187905">wr</span>&nbsp;<span class="ident" id="5187908">io</span><span class="op" id="5187910">.</span><span class="ident" id="5187911">Writer</span><span class="op" id="5187917">,</span>&nbsp;<span class="ident" id="5187919">data</span>&nbsp;<span class="keyword" id="5187924">interface</span><span class="op" id="5187933">{</span><span class="op" id="5187934">}</span><span class="op" id="5187935">)</span>&nbsp;<span class="builtintype" id="5187937">error</span>&nbsp;<span class="op" id="5187943">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187946">if</span>&nbsp;<span class="ident" id="5187949">err</span>&nbsp;<span class="op" id="5187953">:=</span>&nbsp;<span class="ident" id="5187956">t</span><span class="op" id="5187957">.</span><span class="ident" id="5187958">escape</span><span class="op" id="5187964">(</span><span class="op" id="5187965">)</span><span class="op" id="5187966">;</span>&nbsp;<span class="ident" id="5187968">err</span>&nbsp;<span class="op" id="5187972">!=</span>&nbsp;<span class="ident" id="5187975">nil</span>&nbsp;<span class="op" id="5187979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187983">return</span>&nbsp;<span class="ident" id="5187990">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187998">return</span>&nbsp;<span class="ident" id="5188005">t</span><span class="op" id="5188006">.</span><span class="ident" id="5188007">text</span><span class="op" id="5188011">.</span><span class="ident" id="5188012">Execute</span><span class="op" id="5188019">(</span><span class="ident" id="5188020">wr</span><span class="op" id="5188022">,</span>&nbsp;<span class="ident" id="5188024">data</span><span class="op" id="5188028">)</span><br>
<span class="lineno"></span><span class="op" id="5188030">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5188033">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5188110">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5188176">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5188244">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="5188317">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5188339">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5188389">func</span>&nbsp;<span class="op" id="5188394">(</span><span class="ident" id="5188395">t</span>&nbsp;<span class="op" id="5188397">*</span><span class="ident" id="5188398">Template</span><span class="op" id="5188406">)</span>&nbsp;<span class="ident" id="5188408">ExecuteTemplate</span><span class="op" id="5188423">(</span><span class="ident" id="5188424">wr</span>&nbsp;<span class="ident" id="5188427">io</span><span class="op" id="5188429">.</span><span class="ident" id="5188430">Writer</span><span class="op" id="5188436">,</span>&nbsp;<span class="ident" id="5188438">name</span>&nbsp;<span class="builtintype" id="5188443">string</span><span class="op" id="5188449">,</span>&nbsp;<span class="ident" id="5188451">data</span>&nbsp;<span class="keyword" id="5188456">interface</span><span class="op" id="5188465">{</span><span class="op" id="5188466">}</span><span class="op" id="5188467">)</span>&nbsp;<span class="builtintype" id="5188469">error</span>&nbsp;<span class="op" id="5188475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188478">tmpl</span><span class="op" id="5188482">,</span>&nbsp;<span class="ident" id="5188484">err</span>&nbsp;<span class="op" id="5188488">:=</span>&nbsp;<span class="ident" id="5188491">t</span><span class="op" id="5188492">.</span><span class="ident" id="5188493">lookupAndEscapeTemplate</span><span class="op" id="5188516">(</span><span class="ident" id="5188517">name</span><span class="op" id="5188521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188524">if</span>&nbsp;<span class="ident" id="5188527">err</span>&nbsp;<span class="op" id="5188531">!=</span>&nbsp;<span class="ident" id="5188534">nil</span>&nbsp;<span class="op" id="5188538">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188542">return</span>&nbsp;<span class="ident" id="5188549">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5188554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188557">return</span>&nbsp;<span class="ident" id="5188564">tmpl</span><span class="op" id="5188568">.</span><span class="ident" id="5188569">text</span><span class="op" id="5188573">.</span><span class="ident" id="5188574">Execute</span><span class="op" id="5188581">(</span><span class="ident" id="5188582">wr</span><span class="op" id="5188584">,</span>&nbsp;<span class="ident" id="5188586">data</span><span class="op" id="5188590">)</span><br>
<span class="lineno"></span><span class="op" id="5188592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="5188595">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5188671">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="5188744">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5188757">func</span>&nbsp;<span class="op" id="5188762">(</span><span class="ident" id="5188763">t</span>&nbsp;<span class="op" id="5188765">*</span><span class="ident" id="5188766">Template</span><span class="op" id="5188774">)</span>&nbsp;<span class="ident" id="5188776">lookupAndEscapeTemplate</span><span class="op" id="5188799">(</span><span class="ident" id="5188800">name</span>&nbsp;<span class="builtintype" id="5188805">string</span><span class="op" id="5188811">)</span>&nbsp;<span class="op" id="5188813">(</span><span class="ident" id="5188814">tmpl</span>&nbsp;<span class="op" id="5188819">*</span><span class="ident" id="5188820">Template</span><span class="op" id="5188828">,</span>&nbsp;<span class="ident" id="5188830">err</span>&nbsp;<span class="builtintype" id="5188834">error</span><span class="op" id="5188839">)</span>&nbsp;<span class="op" id="5188841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188844">t</span><span class="op" id="5188845">.</span><span class="ident" id="5188846">nameSpace</span><span class="op" id="5188855">.</span><span class="ident" id="5188856">mu</span><span class="op" id="5188858">.</span><span class="ident" id="5188859">Lock</span><span class="op" id="5188863">(</span><span class="op" id="5188864">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188867">defer</span>&nbsp;<span class="ident" id="5188873">t</span><span class="op" id="5188874">.</span><span class="ident" id="5188875">nameSpace</span><span class="op" id="5188884">.</span><span class="ident" id="5188885">mu</span><span class="op" id="5188887">.</span><span class="ident" id="5188888">Unlock</span><span class="op" id="5188894">(</span><span class="op" id="5188895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188898">tmpl</span>&nbsp;<span class="op" id="5188903">=</span>&nbsp;<span class="ident" id="5188905">t</span><span class="op" id="5188906">.</span><span class="ident" id="5188907">set</span><span class="op" id="5188910">[</span><span class="ident" id="5188911">name</span><span class="op" id="5188915">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188918">if</span>&nbsp;<span class="ident" id="5188921">tmpl</span>&nbsp;<span class="op" id="5188926">==</span>&nbsp;<span class="ident" id="5188929">nil</span>&nbsp;<span class="op" id="5188933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188937">return</span>&nbsp;<span class="ident" id="5188944">nil</span><span class="op" id="5188947">,</span>&nbsp;<span class="ident" id="5188949">fmt</span><span class="op" id="5188952">.</span><span class="ident" id="5188953">Errorf</span><span class="op" id="5188959">(</span><span class="string" id="5188960">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="5188992">,</span>&nbsp;<span class="ident" id="5188994">name</span><span class="op" id="5188998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189001">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189004">if</span>&nbsp;<span class="ident" id="5189007">tmpl</span><span class="op" id="5189011">.</span><span class="ident" id="5189012">escapeErr</span>&nbsp;<span class="op" id="5189022">!=</span>&nbsp;<span class="ident" id="5189025">nil</span>&nbsp;<span class="op" id="5189029">&amp;&amp;</span>&nbsp;<span class="ident" id="5189032">tmpl</span><span class="op" id="5189036">.</span><span class="ident" id="5189037">escapeErr</span>&nbsp;<span class="op" id="5189047">!=</span>&nbsp;<span class="ident" id="5189050">escapeOK</span>&nbsp;<span class="op" id="5189059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189063">return</span>&nbsp;<span class="ident" id="5189070">nil</span><span class="op" id="5189073">,</span>&nbsp;<span class="ident" id="5189075">tmpl</span><span class="op" id="5189079">.</span><span class="ident" id="5189080">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189094">if</span>&nbsp;<span class="ident" id="5189097">tmpl</span><span class="op" id="5189101">.</span><span class="ident" id="5189102">text</span><span class="op" id="5189106">.</span><span class="ident" id="5189107">Tree</span>&nbsp;<span class="op" id="5189112">==</span>&nbsp;<span class="ident" id="5189115">nil</span>&nbsp;<span class="op" id="5189119">||</span>&nbsp;<span class="ident" id="5189122">tmpl</span><span class="op" id="5189126">.</span><span class="ident" id="5189127">text</span><span class="op" id="5189131">.</span><span class="ident" id="5189132">Root</span>&nbsp;<span class="op" id="5189137">==</span>&nbsp;<span class="ident" id="5189140">nil</span>&nbsp;<span class="op" id="5189144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189148">return</span>&nbsp;<span class="ident" id="5189155">nil</span><span class="op" id="5189158">,</span>&nbsp;<span class="ident" id="5189160">fmt</span><span class="op" id="5189163">.</span><span class="ident" id="5189164">Errorf</span><span class="op" id="5189170">(</span><span class="string" id="5189171">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="5189216">,</span>&nbsp;<span class="ident" id="5189218">name</span><span class="op" id="5189222">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189228">if</span>&nbsp;<span class="ident" id="5189231">t</span><span class="op" id="5189232">.</span><span class="ident" id="5189233">text</span><span class="op" id="5189237">.</span><span class="ident" id="5189238">Lookup</span><span class="op" id="5189244">(</span><span class="ident" id="5189245">name</span><span class="op" id="5189249">)</span>&nbsp;<span class="op" id="5189251">==</span>&nbsp;<span class="ident" id="5189254">nil</span>&nbsp;<span class="op" id="5189258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5189262">panic</span><span class="op" id="5189267">(</span><span class="string" id="5189268">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="5189329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189335">if</span>&nbsp;<span class="ident" id="5189338">tmpl</span><span class="op" id="5189342">.</span><span class="ident" id="5189343">escapeErr</span>&nbsp;<span class="op" id="5189353">==</span>&nbsp;<span class="ident" id="5189356">nil</span>&nbsp;<span class="op" id="5189360">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189364">err</span>&nbsp;<span class="op" id="5189368">=</span>&nbsp;<span class="ident" id="5189370">escapeTemplate</span><span class="op" id="5189384">(</span><span class="ident" id="5189385">tmpl</span><span class="op" id="5189389">,</span>&nbsp;<span class="ident" id="5189391">tmpl</span><span class="op" id="5189395">.</span><span class="ident" id="5189396">text</span><span class="op" id="5189400">.</span><span class="ident" id="5189401">Root</span><span class="op" id="5189405">,</span>&nbsp;<span class="ident" id="5189407">name</span><span class="op" id="5189411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189417">return</span>&nbsp;<span class="ident" id="5189424">tmpl</span><span class="op" id="5189428">,</span>&nbsp;<span class="ident" id="5189430">err</span><br>
<span class="lineno"></span><span class="op" id="5189434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5189437">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="5189507">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5189573">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="5189645">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="5189718">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="5189782">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="5189853">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5189920">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="5189978">func</span>&nbsp;<span class="op" id="5189983">(</span><span class="ident" id="5189984">t</span>&nbsp;<span class="op" id="5189986">*</span><span class="ident" id="5189987">Template</span><span class="op" id="5189995">)</span>&nbsp;<span class="ident" id="5189997">Parse</span><span class="op" id="5190002">(</span><span class="ident" id="5190003">src</span>&nbsp;<span class="builtintype" id="5190007">string</span><span class="op" id="5190013">)</span>&nbsp;<span class="op" id="5190015">(</span><span class="op" id="5190016">*</span><span class="ident" id="5190017">Template</span><span class="op" id="5190025">,</span>&nbsp;<span class="builtintype" id="5190027">error</span><span class="op" id="5190032">)</span>&nbsp;<span class="op" id="5190034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190037">t</span><span class="op" id="5190038">.</span><span class="ident" id="5190039">nameSpace</span><span class="op" id="5190048">.</span><span class="ident" id="5190049">mu</span><span class="op" id="5190051">.</span><span class="ident" id="5190052">Lock</span><span class="op" id="5190056">(</span><span class="op" id="5190057">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190060">t</span><span class="op" id="5190061">.</span><span class="ident" id="5190062">escapeErr</span>&nbsp;<span class="op" id="5190072">=</span>&nbsp;<span class="ident" id="5190074">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190079">t</span><span class="op" id="5190080">.</span><span class="ident" id="5190081">nameSpace</span><span class="op" id="5190090">.</span><span class="ident" id="5190091">mu</span><span class="op" id="5190093">.</span><span class="ident" id="5190094">Unlock</span><span class="op" id="5190100">(</span><span class="op" id="5190101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190104">ret</span><span class="op" id="5190107">,</span>&nbsp;<span class="ident" id="5190109">err</span>&nbsp;<span class="op" id="5190113">:=</span>&nbsp;<span class="ident" id="5190116">t</span><span class="op" id="5190117">.</span><span class="ident" id="5190118">text</span><span class="op" id="5190122">.</span><span class="ident" id="5190123">Parse</span><span class="op" id="5190128">(</span><span class="ident" id="5190129">src</span><span class="op" id="5190132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190135">if</span>&nbsp;<span class="ident" id="5190138">err</span>&nbsp;<span class="op" id="5190142">!=</span>&nbsp;<span class="ident" id="5190145">nil</span>&nbsp;<span class="op" id="5190149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190153">return</span>&nbsp;<span class="ident" id="5190160">nil</span><span class="op" id="5190163">,</span>&nbsp;<span class="ident" id="5190165">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190173">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190243">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190296">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190357">t</span><span class="op" id="5190358">.</span><span class="ident" id="5190359">nameSpace</span><span class="op" id="5190368">.</span><span class="ident" id="5190369">mu</span><span class="op" id="5190371">.</span><span class="ident" id="5190372">Lock</span><span class="op" id="5190376">(</span><span class="op" id="5190377">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190380">defer</span>&nbsp;<span class="ident" id="5190386">t</span><span class="op" id="5190387">.</span><span class="ident" id="5190388">nameSpace</span><span class="op" id="5190397">.</span><span class="ident" id="5190398">mu</span><span class="op" id="5190400">.</span><span class="ident" id="5190401">Unlock</span><span class="op" id="5190407">(</span><span class="op" id="5190408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190411">for</span>&nbsp;<span class="ident" id="5190415">_</span><span class="op" id="5190416">,</span>&nbsp;<span class="ident" id="5190418">v</span>&nbsp;<span class="op" id="5190420">:=</span>&nbsp;<span class="keyword" id="5190423">range</span>&nbsp;<span class="ident" id="5190429">ret</span><span class="op" id="5190432">.</span><span class="ident" id="5190433">Templates</span><span class="op" id="5190442">(</span><span class="op" id="5190443">)</span>&nbsp;<span class="op" id="5190445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190449">name</span>&nbsp;<span class="op" id="5190454">:=</span>&nbsp;<span class="ident" id="5190457">v</span><span class="op" id="5190458">.</span><span class="ident" id="5190459">Name</span><span class="op" id="5190463">(</span><span class="op" id="5190464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190468">tmpl</span>&nbsp;<span class="op" id="5190473">:=</span>&nbsp;<span class="ident" id="5190476">t</span><span class="op" id="5190477">.</span><span class="ident" id="5190478">set</span><span class="op" id="5190481">[</span><span class="ident" id="5190482">name</span><span class="op" id="5190486">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190490">if</span>&nbsp;<span class="ident" id="5190493">tmpl</span>&nbsp;<span class="op" id="5190498">==</span>&nbsp;<span class="ident" id="5190501">nil</span>&nbsp;<span class="op" id="5190505">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190510">tmpl</span>&nbsp;<span class="op" id="5190515">=</span>&nbsp;<span class="ident" id="5190517">t</span><span class="op" id="5190518">.</span><span class="builtinfunc" id="5190519">new</span><span class="op" id="5190522">(</span><span class="ident" id="5190523">name</span><span class="op" id="5190527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190535">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190614">tmpl</span><span class="op" id="5190618">.</span><span class="ident" id="5190619">escapeErr</span>&nbsp;<span class="op" id="5190629">=</span>&nbsp;<span class="ident" id="5190631">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190637">tmpl</span><span class="op" id="5190641">.</span><span class="ident" id="5190642">text</span>&nbsp;<span class="op" id="5190647">=</span>&nbsp;<span class="ident" id="5190649">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190653">tmpl</span><span class="op" id="5190657">.</span><span class="ident" id="5190658">Tree</span>&nbsp;<span class="op" id="5190663">=</span>&nbsp;<span class="ident" id="5190665">v</span><span class="op" id="5190666">.</span><span class="ident" id="5190667">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190676">return</span>&nbsp;<span class="ident" id="5190683">t</span><span class="op" id="5190684">,</span>&nbsp;<span class="ident" id="5190686">nil</span><br>
<span class="lineno"></span><span class="op" id="5190690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="5190693">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="5190761">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="5190790">//</span><br>
<span class="lineno"></span><span class="comment" id="5190793">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5190848">func</span>&nbsp;<span class="op" id="5190853">(</span><span class="ident" id="5190854">t</span>&nbsp;<span class="op" id="5190856">*</span><span class="ident" id="5190857">Template</span><span class="op" id="5190865">)</span>&nbsp;<span class="ident" id="5190867">AddParseTree</span><span class="op" id="5190879">(</span><span class="ident" id="5190880">name</span>&nbsp;<span class="builtintype" id="5190885">string</span><span class="op" id="5190891">,</span>&nbsp;<span class="ident" id="5190893">tree</span>&nbsp;<span class="op" id="5190898">*</span><span class="ident" id="5190899">parse</span><span class="op" id="5190904">.</span><span class="ident" id="5190905">Tree</span><span class="op" id="5190909">)</span>&nbsp;<span class="op" id="5190911">(</span><span class="op" id="5190912">*</span><span class="ident" id="5190913">Template</span><span class="op" id="5190921">,</span>&nbsp;<span class="builtintype" id="5190923">error</span><span class="op" id="5190928">)</span>&nbsp;<span class="op" id="5190930">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190933">t</span><span class="op" id="5190934">.</span><span class="ident" id="5190935">nameSpace</span><span class="op" id="5190944">.</span><span class="ident" id="5190945">mu</span><span class="op" id="5190947">.</span><span class="ident" id="5190948">Lock</span><span class="op" id="5190952">(</span><span class="op" id="5190953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190956">defer</span>&nbsp;<span class="ident" id="5190962">t</span><span class="op" id="5190963">.</span><span class="ident" id="5190964">nameSpace</span><span class="op" id="5190973">.</span><span class="ident" id="5190974">mu</span><span class="op" id="5190976">.</span><span class="ident" id="5190977">Unlock</span><span class="op" id="5190983">(</span><span class="op" id="5190984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190987">if</span>&nbsp;<span class="ident" id="5190990">t</span><span class="op" id="5190991">.</span><span class="ident" id="5190992">escapeErr</span>&nbsp;<span class="op" id="5191002">!=</span>&nbsp;<span class="ident" id="5191005">nil</span>&nbsp;<span class="op" id="5191009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191013">return</span>&nbsp;<span class="ident" id="5191020">nil</span><span class="op" id="5191023">,</span>&nbsp;<span class="ident" id="5191025">fmt</span><span class="op" id="5191028">.</span><span class="ident" id="5191029">Errorf</span><span class="op" id="5191035">(</span><span class="string" id="5191036">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5191100">,</span>&nbsp;<span class="ident" id="5191102">t</span><span class="op" id="5191103">.</span><span class="ident" id="5191104">Name</span><span class="op" id="5191108">(</span><span class="op" id="5191109">)</span><span class="op" id="5191110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191113">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191116">text</span><span class="op" id="5191120">,</span>&nbsp;<span class="ident" id="5191122">err</span>&nbsp;<span class="op" id="5191126">:=</span>&nbsp;<span class="ident" id="5191129">t</span><span class="op" id="5191130">.</span><span class="ident" id="5191131">text</span><span class="op" id="5191135">.</span><span class="ident" id="5191136">AddParseTree</span><span class="op" id="5191148">(</span><span class="ident" id="5191149">name</span><span class="op" id="5191153">,</span>&nbsp;<span class="ident" id="5191155">tree</span><span class="op" id="5191159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191162">if</span>&nbsp;<span class="ident" id="5191165">err</span>&nbsp;<span class="op" id="5191169">!=</span>&nbsp;<span class="ident" id="5191172">nil</span>&nbsp;<span class="op" id="5191176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191180">return</span>&nbsp;<span class="ident" id="5191187">nil</span><span class="op" id="5191190">,</span>&nbsp;<span class="ident" id="5191192">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191200">ret</span>&nbsp;<span class="op" id="5191204">:=</span>&nbsp;<span class="op" id="5191207">&amp;</span><span class="ident" id="5191208">Template</span><span class="op" id="5191216">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191220">nil</span><span class="op" id="5191223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191227">text</span><span class="op" id="5191231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191235">text</span><span class="op" id="5191239">.</span><span class="ident" id="5191240">Tree</span><span class="op" id="5191244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191248">t</span><span class="op" id="5191249">.</span><span class="ident" id="5191250">nameSpace</span><span class="op" id="5191259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191262">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191265">t</span><span class="op" id="5191266">.</span><span class="ident" id="5191267">set</span><span class="op" id="5191270">[</span><span class="ident" id="5191271">name</span><span class="op" id="5191275">]</span>&nbsp;<span class="op" id="5191277">=</span>&nbsp;<span class="ident" id="5191279">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191284">return</span>&nbsp;<span class="ident" id="5191291">ret</span><span class="op" id="5191294">,</span>&nbsp;<span class="ident" id="5191296">nil</span><br>
<span class="lineno"></span><span class="op" id="5191300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5191303">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="5191374">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5191451">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="5191526">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="5191605">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="5191683">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="5191734">//</span><br>
<span class="lineno"></span><span class="comment" id="5191737">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5191792">func</span>&nbsp;<span class="op" id="5191797">(</span><span class="ident" id="5191798">t</span>&nbsp;<span class="op" id="5191800">*</span><span class="ident" id="5191801">Template</span><span class="op" id="5191809">)</span>&nbsp;<span class="ident" id="5191811">Clone</span><span class="op" id="5191816">(</span><span class="op" id="5191817">)</span>&nbsp;<span class="op" id="5191819">(</span><span class="op" id="5191820">*</span><span class="ident" id="5191821">Template</span><span class="op" id="5191829">,</span>&nbsp;<span class="builtintype" id="5191831">error</span><span class="op" id="5191836">)</span>&nbsp;<span class="op" id="5191838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191841">t</span><span class="op" id="5191842">.</span><span class="ident" id="5191843">nameSpace</span><span class="op" id="5191852">.</span><span class="ident" id="5191853">mu</span><span class="op" id="5191855">.</span><span class="ident" id="5191856">Lock</span><span class="op" id="5191860">(</span><span class="op" id="5191861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191864">defer</span>&nbsp;<span class="ident" id="5191870">t</span><span class="op" id="5191871">.</span><span class="ident" id="5191872">nameSpace</span><span class="op" id="5191881">.</span><span class="ident" id="5191882">mu</span><span class="op" id="5191884">.</span><span class="ident" id="5191885">Unlock</span><span class="op" id="5191891">(</span><span class="op" id="5191892">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191895">if</span>&nbsp;<span class="ident" id="5191898">t</span><span class="op" id="5191899">.</span><span class="ident" id="5191900">escapeErr</span>&nbsp;<span class="op" id="5191910">!=</span>&nbsp;<span class="ident" id="5191913">nil</span>&nbsp;<span class="op" id="5191917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191921">return</span>&nbsp;<span class="ident" id="5191928">nil</span><span class="op" id="5191931">,</span>&nbsp;<span class="ident" id="5191933">fmt</span><span class="op" id="5191936">.</span><span class="ident" id="5191937">Errorf</span><span class="op" id="5191943">(</span><span class="string" id="5191944">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5191998">,</span>&nbsp;<span class="ident" id="5192000">t</span><span class="op" id="5192001">.</span><span class="ident" id="5192002">Name</span><span class="op" id="5192006">(</span><span class="op" id="5192007">)</span><span class="op" id="5192008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192014">textClone</span><span class="op" id="5192023">,</span>&nbsp;<span class="ident" id="5192025">err</span>&nbsp;<span class="op" id="5192029">:=</span>&nbsp;<span class="ident" id="5192032">t</span><span class="op" id="5192033">.</span><span class="ident" id="5192034">text</span><span class="op" id="5192038">.</span><span class="ident" id="5192039">Clone</span><span class="op" id="5192044">(</span><span class="op" id="5192045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192048">if</span>&nbsp;<span class="ident" id="5192051">err</span>&nbsp;<span class="op" id="5192055">!=</span>&nbsp;<span class="ident" id="5192058">nil</span>&nbsp;<span class="op" id="5192062">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192066">return</span>&nbsp;<span class="ident" id="5192073">nil</span><span class="op" id="5192076">,</span>&nbsp;<span class="ident" id="5192078">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192086">ret</span>&nbsp;<span class="op" id="5192090">:=</span>&nbsp;<span class="op" id="5192093">&amp;</span><span class="ident" id="5192094">Template</span><span class="op" id="5192102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192106">nil</span><span class="op" id="5192109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192113">textClone</span><span class="op" id="5192122">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192126">textClone</span><span class="op" id="5192135">.</span><span class="ident" id="5192136">Tree</span><span class="op" id="5192140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192144">&amp;</span><span class="ident" id="5192145">nameSpace</span><span class="op" id="5192154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192159">set</span><span class="op" id="5192162">:</span>&nbsp;<span class="builtinfunc" id="5192164">make</span><span class="op" id="5192168">(</span><span class="keyword" id="5192169">map</span><span class="op" id="5192172">[</span><span class="builtintype" id="5192173">string</span><span class="op" id="5192179">]</span><span class="op" id="5192180">*</span><span class="ident" id="5192181">Template</span><span class="op" id="5192189">)</span><span class="op" id="5192190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192194">}</span><span class="op" id="5192195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192198">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192201">for</span>&nbsp;<span class="ident" id="5192205">_</span><span class="op" id="5192206">,</span>&nbsp;<span class="ident" id="5192208">x</span>&nbsp;<span class="op" id="5192210">:=</span>&nbsp;<span class="keyword" id="5192213">range</span>&nbsp;<span class="ident" id="5192219">textClone</span><span class="op" id="5192228">.</span><span class="ident" id="5192229">Templates</span><span class="op" id="5192238">(</span><span class="op" id="5192239">)</span>&nbsp;<span class="op" id="5192241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192245">name</span>&nbsp;<span class="op" id="5192250">:=</span>&nbsp;<span class="ident" id="5192253">x</span><span class="op" id="5192254">.</span><span class="ident" id="5192255">Name</span><span class="op" id="5192259">(</span><span class="op" id="5192260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192264">src</span>&nbsp;<span class="op" id="5192268">:=</span>&nbsp;<span class="ident" id="5192271">t</span><span class="op" id="5192272">.</span><span class="ident" id="5192273">set</span><span class="op" id="5192276">[</span><span class="ident" id="5192277">name</span><span class="op" id="5192281">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192285">if</span>&nbsp;<span class="ident" id="5192288">src</span>&nbsp;<span class="op" id="5192292">==</span>&nbsp;<span class="ident" id="5192295">nil</span>&nbsp;<span class="op" id="5192299">||</span>&nbsp;<span class="ident" id="5192302">src</span><span class="op" id="5192305">.</span><span class="ident" id="5192306">escapeErr</span>&nbsp;<span class="op" id="5192316">!=</span>&nbsp;<span class="ident" id="5192319">nil</span>&nbsp;<span class="op" id="5192323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192328">return</span>&nbsp;<span class="ident" id="5192335">nil</span><span class="op" id="5192338">,</span>&nbsp;<span class="ident" id="5192340">fmt</span><span class="op" id="5192343">.</span><span class="ident" id="5192344">Errorf</span><span class="op" id="5192350">(</span><span class="string" id="5192351">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5192405">,</span>&nbsp;<span class="ident" id="5192407">t</span><span class="op" id="5192408">.</span><span class="ident" id="5192409">Name</span><span class="op" id="5192413">(</span><span class="op" id="5192414">)</span><span class="op" id="5192415">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192423">x</span><span class="op" id="5192424">.</span><span class="ident" id="5192425">Tree</span>&nbsp;<span class="op" id="5192430">=</span>&nbsp;<span class="ident" id="5192432">x</span><span class="op" id="5192433">.</span><span class="ident" id="5192434">Tree</span><span class="op" id="5192438">.</span><span class="ident" id="5192439">Copy</span><span class="op" id="5192443">(</span><span class="op" id="5192444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192448">ret</span><span class="op" id="5192451">.</span><span class="ident" id="5192452">set</span><span class="op" id="5192455">[</span><span class="ident" id="5192456">name</span><span class="op" id="5192460">]</span>&nbsp;<span class="op" id="5192462">=</span>&nbsp;<span class="op" id="5192464">&amp;</span><span class="ident" id="5192465">Template</span><span class="op" id="5192473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192478">nil</span><span class="op" id="5192481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192486">x</span><span class="op" id="5192487">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192492">x</span><span class="op" id="5192493">.</span><span class="ident" id="5192494">Tree</span><span class="op" id="5192498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192503">ret</span><span class="op" id="5192506">.</span><span class="ident" id="5192507">nameSpace</span><span class="op" id="5192516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192526">return</span>&nbsp;<span class="ident" id="5192533">ret</span><span class="op" id="5192536">,</span>&nbsp;<span class="ident" id="5192538">nil</span><br>
<span class="lineno">220</span><span class="op" id="5192542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5192545">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5192603">func</span>&nbsp;<span class="ident" id="5192608">New</span><span class="op" id="5192611">(</span><span class="ident" id="5192612">name</span>&nbsp;<span class="builtintype" id="5192617">string</span><span class="op" id="5192623">)</span>&nbsp;<span class="op" id="5192625">*</span><span class="ident" id="5192626">Template</span>&nbsp;<span class="op" id="5192635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192638">tmpl</span>&nbsp;<span class="op" id="5192643">:=</span>&nbsp;<span class="op" id="5192646">&amp;</span><span class="ident" id="5192647">Template</span><span class="op" id="5192655">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192659">nil</span><span class="op" id="5192662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192666">template</span><span class="op" id="5192674">.</span><span class="ident" id="5192675">New</span><span class="op" id="5192678">(</span><span class="ident" id="5192679">name</span><span class="op" id="5192683">)</span><span class="op" id="5192684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192688">nil</span><span class="op" id="5192691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192695">&amp;</span><span class="ident" id="5192696">nameSpace</span><span class="op" id="5192705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192710">set</span><span class="op" id="5192713">:</span>&nbsp;<span class="builtinfunc" id="5192715">make</span><span class="op" id="5192719">(</span><span class="keyword" id="5192720">map</span><span class="op" id="5192723">[</span><span class="builtintype" id="5192724">string</span><span class="op" id="5192730">]</span><span class="op" id="5192731">*</span><span class="ident" id="5192732">Template</span><span class="op" id="5192740">)</span><span class="op" id="5192741">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192745">}</span><span class="op" id="5192746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192752">tmpl</span><span class="op" id="5192756">.</span><span class="ident" id="5192757">set</span><span class="op" id="5192760">[</span><span class="ident" id="5192761">name</span><span class="op" id="5192765">]</span>&nbsp;<span class="op" id="5192767">=</span>&nbsp;<span class="ident" id="5192769">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192775">return</span>&nbsp;<span class="ident" id="5192782">tmpl</span><br>
<span class="lineno"></span><span class="op" id="5192787">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5192790">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5192857">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="5192928">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5192997">func</span>&nbsp;<span class="op" id="5193002">(</span><span class="ident" id="5193003">t</span>&nbsp;<span class="op" id="5193005">*</span><span class="ident" id="5193006">Template</span><span class="op" id="5193014">)</span>&nbsp;<span class="ident" id="5193016">New</span><span class="op" id="5193019">(</span><span class="ident" id="5193020">name</span>&nbsp;<span class="builtintype" id="5193025">string</span><span class="op" id="5193031">)</span>&nbsp;<span class="op" id="5193033">*</span><span class="ident" id="5193034">Template</span>&nbsp;<span class="op" id="5193043">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193046">t</span><span class="op" id="5193047">.</span><span class="ident" id="5193048">nameSpace</span><span class="op" id="5193057">.</span><span class="ident" id="5193058">mu</span><span class="op" id="5193060">.</span><span class="ident" id="5193061">Lock</span><span class="op" id="5193065">(</span><span class="op" id="5193066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193069">defer</span>&nbsp;<span class="ident" id="5193075">t</span><span class="op" id="5193076">.</span><span class="ident" id="5193077">nameSpace</span><span class="op" id="5193086">.</span><span class="ident" id="5193087">mu</span><span class="op" id="5193089">.</span><span class="ident" id="5193090">Unlock</span><span class="op" id="5193096">(</span><span class="op" id="5193097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193100">return</span>&nbsp;<span class="ident" id="5193107">t</span><span class="op" id="5193108">.</span><span class="builtinfunc" id="5193109">new</span><span class="op" id="5193112">(</span><span class="ident" id="5193113">name</span><span class="op" id="5193117">)</span><br>
<span class="lineno"></span><span class="op" id="5193119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="5193122">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="5193177">func</span>&nbsp;<span class="op" id="5193182">(</span><span class="ident" id="5193183">t</span>&nbsp;<span class="op" id="5193185">*</span><span class="ident" id="5193186">Template</span><span class="op" id="5193194">)</span>&nbsp;<span class="builtinfunc" id="5193196">new</span><span class="op" id="5193199">(</span><span class="ident" id="5193200">name</span>&nbsp;<span class="builtintype" id="5193205">string</span><span class="op" id="5193211">)</span>&nbsp;<span class="op" id="5193213">*</span><span class="ident" id="5193214">Template</span>&nbsp;<span class="op" id="5193223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193226">tmpl</span>&nbsp;<span class="op" id="5193231">:=</span>&nbsp;<span class="op" id="5193234">&amp;</span><span class="ident" id="5193235">Template</span><span class="op" id="5193243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193247">nil</span><span class="op" id="5193250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193254">t</span><span class="op" id="5193255">.</span><span class="ident" id="5193256">text</span><span class="op" id="5193260">.</span><span class="ident" id="5193261">New</span><span class="op" id="5193264">(</span><span class="ident" id="5193265">name</span><span class="op" id="5193269">)</span><span class="op" id="5193270">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193274">nil</span><span class="op" id="5193277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193281">t</span><span class="op" id="5193282">.</span><span class="ident" id="5193283">nameSpace</span><span class="op" id="5193292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193298">tmpl</span><span class="op" id="5193302">.</span><span class="ident" id="5193303">set</span><span class="op" id="5193306">[</span><span class="ident" id="5193307">name</span><span class="op" id="5193311">]</span>&nbsp;<span class="op" id="5193313">=</span>&nbsp;<span class="ident" id="5193315">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193321">return</span>&nbsp;<span class="ident" id="5193328">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="5193333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5193336">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5193378">func</span>&nbsp;<span class="op" id="5193383">(</span><span class="ident" id="5193384">t</span>&nbsp;<span class="op" id="5193386">*</span><span class="ident" id="5193387">Template</span><span class="op" id="5193395">)</span>&nbsp;<span class="ident" id="5193397">Name</span><span class="op" id="5193401">(</span><span class="op" id="5193402">)</span>&nbsp;<span class="builtintype" id="5193404">string</span>&nbsp;<span class="op" id="5193411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193414">return</span>&nbsp;<span class="ident" id="5193421">t</span><span class="op" id="5193422">.</span><span class="ident" id="5193423">text</span><span class="op" id="5193427">.</span><span class="ident" id="5193428">Name</span><span class="op" id="5193432">(</span><span class="op" id="5193433">)</span><br>
<span class="lineno">260</span><span class="op" id="5193435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5193438">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5193507">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="5193582">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="5193656">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="5193732">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5193809">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="5193882">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5193902">type</span>&nbsp;<span class="ident" id="5193907">FuncMap</span>&nbsp;<span class="keyword" id="5193915">map</span><span class="op" id="5193918">[</span><span class="builtintype" id="5193919">string</span><span class="op" id="5193925">]</span><span class="keyword" id="5193926">interface</span><span class="op" id="5193935">{</span><span class="op" id="5193936">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="5193939">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5194018">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5194095">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5194170">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="5194221">func</span>&nbsp;<span class="op" id="5194226">(</span><span class="ident" id="5194227">t</span>&nbsp;<span class="op" id="5194229">*</span><span class="ident" id="5194230">Template</span><span class="op" id="5194238">)</span>&nbsp;<span class="ident" id="5194240">Funcs</span><span class="op" id="5194245">(</span><span class="ident" id="5194246">funcMap</span>&nbsp;<span class="ident" id="5194254">FuncMap</span><span class="op" id="5194261">)</span>&nbsp;<span class="op" id="5194263">*</span><span class="ident" id="5194264">Template</span>&nbsp;<span class="op" id="5194273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194276">t</span><span class="op" id="5194277">.</span><span class="ident" id="5194278">text</span><span class="op" id="5194282">.</span><span class="ident" id="5194283">Funcs</span><span class="op" id="5194288">(</span><span class="ident" id="5194289">template</span><span class="op" id="5194297">.</span><span class="ident" id="5194298">FuncMap</span><span class="op" id="5194305">(</span><span class="ident" id="5194306">funcMap</span><span class="op" id="5194313">)</span><span class="op" id="5194314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194317">return</span>&nbsp;<span class="ident" id="5194324">t</span><br>
<span class="lineno"></span><span class="op" id="5194326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="5194329">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5194406">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5194478">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5194554">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="5194590">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="5194652">func</span>&nbsp;<span class="op" id="5194657">(</span><span class="ident" id="5194658">t</span>&nbsp;<span class="op" id="5194660">*</span><span class="ident" id="5194661">Template</span><span class="op" id="5194669">)</span>&nbsp;<span class="ident" id="5194671">Delims</span><span class="op" id="5194677">(</span><span class="ident" id="5194678">left</span><span class="op" id="5194682">,</span>&nbsp;<span class="ident" id="5194684">right</span>&nbsp;<span class="builtintype" id="5194690">string</span><span class="op" id="5194696">)</span>&nbsp;<span class="op" id="5194698">*</span><span class="ident" id="5194699">Template</span>&nbsp;<span class="op" id="5194708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194711">t</span><span class="op" id="5194712">.</span><span class="ident" id="5194713">text</span><span class="op" id="5194717">.</span><span class="ident" id="5194718">Delims</span><span class="op" id="5194724">(</span><span class="ident" id="5194725">left</span><span class="op" id="5194729">,</span>&nbsp;<span class="ident" id="5194731">right</span><span class="op" id="5194736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194739">return</span>&nbsp;<span class="ident" id="5194746">t</span><br>
<span class="lineno"></span><span class="op" id="5194748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="5194751">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="5194829">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5194869">func</span>&nbsp;<span class="op" id="5194874">(</span><span class="ident" id="5194875">t</span>&nbsp;<span class="op" id="5194877">*</span><span class="ident" id="5194878">Template</span><span class="op" id="5194886">)</span>&nbsp;<span class="ident" id="5194888">Lookup</span><span class="op" id="5194894">(</span><span class="ident" id="5194895">name</span>&nbsp;<span class="builtintype" id="5194900">string</span><span class="op" id="5194906">)</span>&nbsp;<span class="op" id="5194908">*</span><span class="ident" id="5194909">Template</span>&nbsp;<span class="op" id="5194918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5194921">t</span><span class="op" id="5194922">.</span><span class="ident" id="5194923">nameSpace</span><span class="op" id="5194932">.</span><span class="ident" id="5194933">mu</span><span class="op" id="5194935">.</span><span class="ident" id="5194936">Lock</span><span class="op" id="5194940">(</span><span class="op" id="5194941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194944">defer</span>&nbsp;<span class="ident" id="5194950">t</span><span class="op" id="5194951">.</span><span class="ident" id="5194952">nameSpace</span><span class="op" id="5194961">.</span><span class="ident" id="5194962">mu</span><span class="op" id="5194964">.</span><span class="ident" id="5194965">Unlock</span><span class="op" id="5194971">(</span><span class="op" id="5194972">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5194975">return</span>&nbsp;<span class="ident" id="5194982">t</span><span class="op" id="5194983">.</span><span class="ident" id="5194984">set</span><span class="op" id="5194987">[</span><span class="ident" id="5194988">name</span><span class="op" id="5194992">]</span><br>
<span class="lineno"></span><span class="op" id="5194994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5194997">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="5195078">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="5195168">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5195179">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="5195240">func</span>&nbsp;<span class="ident" id="5195245">Must</span><span class="op" id="5195249">(</span><span class="ident" id="5195250">t</span>&nbsp;<span class="op" id="5195252">*</span><span class="ident" id="5195253">Template</span><span class="op" id="5195261">,</span>&nbsp;<span class="ident" id="5195263">err</span>&nbsp;<span class="builtintype" id="5195267">error</span><span class="op" id="5195272">)</span>&nbsp;<span class="op" id="5195274">*</span><span class="ident" id="5195275">Template</span>&nbsp;<span class="op" id="5195284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195287">if</span>&nbsp;<span class="ident" id="5195290">err</span>&nbsp;<span class="op" id="5195294">!=</span>&nbsp;<span class="ident" id="5195297">nil</span>&nbsp;<span class="op" id="5195301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5195305">panic</span><span class="op" id="5195310">(</span><span class="ident" id="5195311">err</span><span class="op" id="5195314">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5195317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195320">return</span>&nbsp;<span class="ident" id="5195327">t</span><br>
<span class="lineno"></span><span class="op" id="5195329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195332">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="5195410">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5195489">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5195562">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5195634">func</span>&nbsp;<span class="ident" id="5195639">ParseFiles</span><span class="op" id="5195649">(</span><span class="ident" id="5195650">filenames</span>&nbsp;<span class="op" id="5195660">...</span><span class="builtintype" id="5195663">string</span><span class="op" id="5195669">)</span>&nbsp;<span class="op" id="5195671">(</span><span class="op" id="5195672">*</span><span class="ident" id="5195673">Template</span><span class="op" id="5195681">,</span>&nbsp;<span class="builtintype" id="5195683">error</span><span class="op" id="5195688">)</span>&nbsp;<span class="op" id="5195690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5195693">return</span>&nbsp;<span class="ident" id="5195700">parseFiles</span><span class="op" id="5195710">(</span><span class="ident" id="5195711">nil</span><span class="op" id="5195714">,</span>&nbsp;<span class="ident" id="5195716">filenames</span><span class="op" id="5195725">...</span><span class="op" id="5195728">)</span><br>
<span class="lineno">315</span><span class="op" id="5195730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195733">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5195814">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5195888">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="5195943">func</span>&nbsp;<span class="op" id="5195948">(</span><span class="ident" id="5195949">t</span>&nbsp;<span class="op" id="5195951">*</span><span class="ident" id="5195952">Template</span><span class="op" id="5195960">)</span>&nbsp;<span class="ident" id="5195962">ParseFiles</span><span class="op" id="5195972">(</span><span class="ident" id="5195973">filenames</span>&nbsp;<span class="op" id="5195983">...</span><span class="builtintype" id="5195986">string</span><span class="op" id="5195992">)</span>&nbsp;<span class="op" id="5195994">(</span><span class="op" id="5195995">*</span><span class="ident" id="5195996">Template</span><span class="op" id="5196004">,</span>&nbsp;<span class="builtintype" id="5196006">error</span><span class="op" id="5196011">)</span>&nbsp;<span class="op" id="5196013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196016">return</span>&nbsp;<span class="ident" id="5196023">parseFiles</span><span class="op" id="5196033">(</span><span class="ident" id="5196034">t</span><span class="op" id="5196035">,</span>&nbsp;<span class="ident" id="5196037">filenames</span><span class="op" id="5196046">...</span><span class="op" id="5196049">)</span><br>
<span class="lineno"></span><span class="op" id="5196051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5196054">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="5196127">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5196182">func</span>&nbsp;<span class="ident" id="5196187">parseFiles</span><span class="op" id="5196197">(</span><span class="ident" id="5196198">t</span>&nbsp;<span class="op" id="5196200">*</span><span class="ident" id="5196201">Template</span><span class="op" id="5196209">,</span>&nbsp;<span class="ident" id="5196211">filenames</span>&nbsp;<span class="op" id="5196221">...</span><span class="builtintype" id="5196224">string</span><span class="op" id="5196230">)</span>&nbsp;<span class="op" id="5196232">(</span><span class="op" id="5196233">*</span><span class="ident" id="5196234">Template</span><span class="op" id="5196242">,</span>&nbsp;<span class="builtintype" id="5196244">error</span><span class="op" id="5196249">)</span>&nbsp;<span class="op" id="5196251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196254">if</span>&nbsp;<span class="builtinfunc" id="5196257">len</span><span class="op" id="5196260">(</span><span class="ident" id="5196261">filenames</span><span class="op" id="5196270">)</span>&nbsp;<span class="op" id="5196272">==</span>&nbsp;<span class="num" id="5196275">0</span>&nbsp;<span class="op" id="5196277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196281">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196327">return</span>&nbsp;<span class="ident" id="5196334">nil</span><span class="op" id="5196337">,</span>&nbsp;<span class="ident" id="5196339">fmt</span><span class="op" id="5196342">.</span><span class="ident" id="5196343">Errorf</span><span class="op" id="5196349">(</span><span class="string" id="5196350">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="5196403">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5196406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196409">for</span>&nbsp;<span class="ident" id="5196413">_</span><span class="op" id="5196414">,</span>&nbsp;<span class="ident" id="5196416">filename</span>&nbsp;<span class="op" id="5196425">:=</span>&nbsp;<span class="keyword" id="5196428">range</span>&nbsp;<span class="ident" id="5196434">filenames</span>&nbsp;<span class="op" id="5196444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196448">b</span><span class="op" id="5196449">,</span>&nbsp;<span class="ident" id="5196451">err</span>&nbsp;<span class="op" id="5196455">:=</span>&nbsp;<span class="ident" id="5196458">ioutil</span><span class="op" id="5196464">.</span><span class="ident" id="5196465">ReadFile</span><span class="op" id="5196473">(</span><span class="ident" id="5196474">filename</span><span class="op" id="5196482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196486">if</span>&nbsp;<span class="ident" id="5196489">err</span>&nbsp;<span class="op" id="5196493">!=</span>&nbsp;<span class="ident" id="5196496">nil</span>&nbsp;<span class="op" id="5196500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196505">return</span>&nbsp;<span class="ident" id="5196512">nil</span><span class="op" id="5196515">,</span>&nbsp;<span class="ident" id="5196517">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5196523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196527">s</span>&nbsp;<span class="op" id="5196529">:=</span>&nbsp;<span class="builtintype" id="5196532">string</span><span class="op" id="5196538">(</span><span class="ident" id="5196539">b</span><span class="op" id="5196540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196544">name</span>&nbsp;<span class="op" id="5196549">:=</span>&nbsp;<span class="ident" id="5196552">filepath</span><span class="op" id="5196560">.</span><span class="ident" id="5196561">Base</span><span class="op" id="5196565">(</span><span class="ident" id="5196566">filename</span><span class="op" id="5196574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196578">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196643">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196706">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196776">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196827">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196881">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196947">var</span>&nbsp;<span class="ident" id="5196951">tmpl</span>&nbsp;<span class="op" id="5196956">*</span><span class="ident" id="5196957">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196968">if</span>&nbsp;<span class="ident" id="5196971">t</span>&nbsp;<span class="op" id="5196973">==</span>&nbsp;<span class="ident" id="5196976">nil</span>&nbsp;<span class="op" id="5196980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196985">t</span>&nbsp;<span class="op" id="5196987">=</span>&nbsp;<span class="ident" id="5196989">New</span><span class="op" id="5196992">(</span><span class="ident" id="5196993">name</span><span class="op" id="5196997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5197001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5197005">if</span>&nbsp;<span class="ident" id="5197008">name</span>&nbsp;<span class="op" id="5197013">==</span>&nbsp;<span class="ident" id="5197016">t</span><span class="op" id="5197017">.</span><span class="ident" id="5197018">Name</span><span class="op" id="5197022">(</span><span class="op" id="5197023">)</span>&nbsp;<span class="op" id="5197025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197030">tmpl</span>&nbsp;<span class="op" id="5197035">=</span>&nbsp;<span class="ident" id="5197037">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5197041">}</span>&nbsp;<span class="keyword" id="5197043">else</span>&nbsp;<span class="op" id="5197048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197053">tmpl</span>&nbsp;<span class="op" id="5197058">=</span>&nbsp;<span class="ident" id="5197060">t</span><span class="op" id="5197061">.</span><span class="ident" id="5197062">New</span><span class="op" id="5197065">(</span><span class="ident" id="5197066">name</span><span class="op" id="5197070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5197074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197078">_</span><span class="op" id="5197079">,</span>&nbsp;<span class="ident" id="5197081">err</span>&nbsp;<span class="op" id="5197085">=</span>&nbsp;<span class="ident" id="5197087">tmpl</span><span class="op" id="5197091">.</span><span class="ident" id="5197092">Parse</span><span class="op" id="5197097">(</span><span class="ident" id="5197098">s</span><span class="op" id="5197099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5197103">if</span>&nbsp;<span class="ident" id="5197106">err</span>&nbsp;<span class="op" id="5197110">!=</span>&nbsp;<span class="ident" id="5197113">nil</span>&nbsp;<span class="op" id="5197117">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5197122">return</span>&nbsp;<span class="ident" id="5197129">nil</span><span class="op" id="5197132">,</span>&nbsp;<span class="ident" id="5197134">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5197140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5197143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5197146">return</span>&nbsp;<span class="ident" id="5197153">t</span><span class="op" id="5197154">,</span>&nbsp;<span class="ident" id="5197156">nil</span><br>
<span class="lineno"></span><span class="op" id="5197160">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="5197163">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5197244">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="5197320">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5197396">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="5197469">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="5197530">func</span>&nbsp;<span class="ident" id="5197535">ParseGlob</span><span class="op" id="5197544">(</span><span class="ident" id="5197545">pattern</span>&nbsp;<span class="builtintype" id="5197553">string</span><span class="op" id="5197559">)</span>&nbsp;<span class="op" id="5197561">(</span><span class="op" id="5197562">*</span><span class="ident" id="5197563">Template</span><span class="op" id="5197571">,</span>&nbsp;<span class="builtintype" id="5197573">error</span><span class="op" id="5197578">)</span>&nbsp;<span class="op" id="5197580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5197583">return</span>&nbsp;<span class="ident" id="5197590">parseGlob</span><span class="op" id="5197599">(</span><span class="ident" id="5197600">nil</span><span class="op" id="5197603">,</span>&nbsp;<span class="ident" id="5197605">pattern</span><span class="op" id="5197612">)</span><br>
<span class="lineno"></span><span class="op" id="5197614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="5197617">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5197693">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5197766">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5197843">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5197919">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="5197931">func</span>&nbsp;<span class="op" id="5197936">(</span><span class="ident" id="5197937">t</span>&nbsp;<span class="op" id="5197939">*</span><span class="ident" id="5197940">Template</span><span class="op" id="5197948">)</span>&nbsp;<span class="ident" id="5197950">ParseGlob</span><span class="op" id="5197959">(</span><span class="ident" id="5197960">pattern</span>&nbsp;<span class="builtintype" id="5197968">string</span><span class="op" id="5197974">)</span>&nbsp;<span class="op" id="5197976">(</span><span class="op" id="5197977">*</span><span class="ident" id="5197978">Template</span><span class="op" id="5197986">,</span>&nbsp;<span class="builtintype" id="5197988">error</span><span class="op" id="5197993">)</span>&nbsp;<span class="op" id="5197995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5197998">return</span>&nbsp;<span class="ident" id="5198005">parseGlob</span><span class="op" id="5198014">(</span><span class="ident" id="5198015">t</span><span class="op" id="5198016">,</span>&nbsp;<span class="ident" id="5198018">pattern</span><span class="op" id="5198025">)</span><br>
<span class="lineno"></span><span class="op" id="5198027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5198030">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="5198103">func</span>&nbsp;<span class="ident" id="5198108">parseGlob</span><span class="op" id="5198117">(</span><span class="ident" id="5198118">t</span>&nbsp;<span class="op" id="5198120">*</span><span class="ident" id="5198121">Template</span><span class="op" id="5198129">,</span>&nbsp;<span class="ident" id="5198131">pattern</span>&nbsp;<span class="builtintype" id="5198139">string</span><span class="op" id="5198145">)</span>&nbsp;<span class="op" id="5198147">(</span><span class="op" id="5198148">*</span><span class="ident" id="5198149">Template</span><span class="op" id="5198157">,</span>&nbsp;<span class="builtintype" id="5198159">error</span><span class="op" id="5198164">)</span>&nbsp;<span class="op" id="5198166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5198169">filenames</span><span class="op" id="5198178">,</span>&nbsp;<span class="ident" id="5198180">err</span>&nbsp;<span class="op" id="5198184">:=</span>&nbsp;<span class="ident" id="5198187">filepath</span><span class="op" id="5198195">.</span><span class="ident" id="5198196">Glob</span><span class="op" id="5198200">(</span><span class="ident" id="5198201">pattern</span><span class="op" id="5198208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198211">if</span>&nbsp;<span class="ident" id="5198214">err</span>&nbsp;<span class="op" id="5198218">!=</span>&nbsp;<span class="ident" id="5198221">nil</span>&nbsp;<span class="op" id="5198225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198229">return</span>&nbsp;<span class="ident" id="5198236">nil</span><span class="op" id="5198239">,</span>&nbsp;<span class="ident" id="5198241">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5198246">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198249">if</span>&nbsp;<span class="builtinfunc" id="5198252">len</span><span class="op" id="5198255">(</span><span class="ident" id="5198256">filenames</span><span class="op" id="5198265">)</span>&nbsp;<span class="op" id="5198267">==</span>&nbsp;<span class="num" id="5198270">0</span>&nbsp;<span class="op" id="5198272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198276">return</span>&nbsp;<span class="ident" id="5198283">nil</span><span class="op" id="5198286">,</span>&nbsp;<span class="ident" id="5198288">fmt</span><span class="op" id="5198291">.</span><span class="ident" id="5198292">Errorf</span><span class="op" id="5198298">(</span><span class="string" id="5198299">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="5198345">,</span>&nbsp;<span class="ident" id="5198347">pattern</span><span class="op" id="5198354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5198357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198360">return</span>&nbsp;<span class="ident" id="5198367">parseFiles</span><span class="op" id="5198377">(</span><span class="ident" id="5198378">t</span><span class="op" id="5198379">,</span>&nbsp;<span class="ident" id="5198381">filenames</span><span class="op" id="5198390">...</span><span class="op" id="5198393">)</span><br>
<span class="lineno"></span><span class="op" id="5198395">}</span>
</div>
</body>
</html>
