<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4123386">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4123441">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4123495">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4123546">package</span>&nbsp;<span class="ident" id="4123554">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4123559">import</span>&nbsp;<span class="op" id="4123566">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123569">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123583">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123600">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123614">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123629">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123643">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123658">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4123673">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4123680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4123683">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4123762">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4123826">type</span>&nbsp;<span class="ident" id="4123831">keyAgreement</span>&nbsp;<span class="keyword" id="4123844">interface</span>&nbsp;<span class="op" id="4123854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123857">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123925">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123987">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124060">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124069">generateServerKeyExchange</span><span class="op" id="4124094">(</span><span class="op" id="4124095">*</span><span class="ident" id="4124096">Config</span><span class="op" id="4124102">,</span>&nbsp;<span class="op" id="4124104">*</span><span class="ident" id="4124105">Certificate</span><span class="op" id="4124116">,</span>&nbsp;<span class="op" id="4124118">*</span><span class="ident" id="4124119">clientHelloMsg</span><span class="op" id="4124133">,</span>&nbsp;<span class="op" id="4124135">*</span><span class="ident" id="4124136">serverHelloMsg</span><span class="op" id="4124150">)</span>&nbsp;<span class="op" id="4124152">(</span><span class="op" id="4124153">*</span><span class="ident" id="4124154">serverKeyExchangeMsg</span><span class="op" id="4124174">,</span>&nbsp;<span class="builtintype" id="4124176">error</span><span class="op" id="4124181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124184">processClientKeyExchange</span><span class="op" id="4124208">(</span><span class="op" id="4124209">*</span><span class="ident" id="4124210">Config</span><span class="op" id="4124216">,</span>&nbsp;<span class="op" id="4124218">*</span><span class="ident" id="4124219">Certificate</span><span class="op" id="4124230">,</span>&nbsp;<span class="op" id="4124232">*</span><span class="ident" id="4124233">clientKeyExchangeMsg</span><span class="op" id="4124253">,</span>&nbsp;<span class="builtintype" id="4124255">uint16</span><span class="op" id="4124261">)</span>&nbsp;<span class="op" id="4124263">(</span><span class="op" id="4124264">[</span><span class="op" id="4124265">]</span><span class="builtintype" id="4124266">byte</span><span class="op" id="4124270">,</span>&nbsp;<span class="builtintype" id="4124272">error</span><span class="op" id="4124277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124281">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124348">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124411">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124442">processServerKeyExchange</span><span class="op" id="4124466">(</span><span class="op" id="4124467">*</span><span class="ident" id="4124468">Config</span><span class="op" id="4124474">,</span>&nbsp;<span class="op" id="4124476">*</span><span class="ident" id="4124477">clientHelloMsg</span><span class="op" id="4124491">,</span>&nbsp;<span class="op" id="4124493">*</span><span class="ident" id="4124494">serverHelloMsg</span><span class="op" id="4124508">,</span>&nbsp;<span class="op" id="4124510">*</span><span class="ident" id="4124511">x509</span><span class="op" id="4124515">.</span><span class="ident" id="4124516">Certificate</span><span class="op" id="4124527">,</span>&nbsp;<span class="op" id="4124529">*</span><span class="ident" id="4124530">serverKeyExchangeMsg</span><span class="op" id="4124550">)</span>&nbsp;<span class="builtintype" id="4124552">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124559">generateClientKeyExchange</span><span class="op" id="4124584">(</span><span class="op" id="4124585">*</span><span class="ident" id="4124586">Config</span><span class="op" id="4124592">,</span>&nbsp;<span class="op" id="4124594">*</span><span class="ident" id="4124595">clientHelloMsg</span><span class="op" id="4124609">,</span>&nbsp;<span class="op" id="4124611">*</span><span class="ident" id="4124612">x509</span><span class="op" id="4124616">.</span><span class="ident" id="4124617">Certificate</span><span class="op" id="4124628">)</span>&nbsp;<span class="op" id="4124630">(</span><span class="op" id="4124631">[</span><span class="op" id="4124632">]</span><span class="builtintype" id="4124633">byte</span><span class="op" id="4124637">,</span>&nbsp;<span class="op" id="4124639">*</span><span class="ident" id="4124640">clientKeyExchangeMsg</span><span class="op" id="4124660">,</span>&nbsp;<span class="builtintype" id="4124662">error</span><span class="op" id="4124667">)</span><br>
<span class="lineno">35</span><span class="op" id="4124669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4124672">const</span>&nbsp;<span class="op" id="4124678">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124681">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124751">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124823">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124895">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124922">suiteECDHE</span>&nbsp;<span class="op" id="4124933">=</span>&nbsp;<span class="num" id="4124935">1</span>&nbsp;<span class="op" id="4124937">&lt;&lt;</span>&nbsp;<span class="ident" id="4124940">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124946">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125011">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125078">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125148">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125163">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125175">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125248">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125285">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4125296">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4125299">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4125375">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4125442">type</span>&nbsp;<span class="ident" id="4125447">cipherSuite</span>&nbsp;<span class="keyword" id="4125459">struct</span>&nbsp;<span class="op" id="4125466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125469">id</span>&nbsp;<span class="builtintype" id="4125472">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125480">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125554">keyLen</span>&nbsp;<span class="builtintype" id="4125561">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125566">macLen</span>&nbsp;<span class="builtintype" id="4125573">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125578">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4125585">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125590">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125597">func</span><span class="op" id="4125601">(</span><span class="ident" id="4125602">version</span>&nbsp;<span class="builtintype" id="4125610">uint16</span><span class="op" id="4125616">)</span>&nbsp;<span class="ident" id="4125618">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125632">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125684">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4125691">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125696">cipher</span>&nbsp;<span class="keyword" id="4125703">func</span><span class="op" id="4125707">(</span><span class="ident" id="4125708">key</span><span class="op" id="4125711">,</span>&nbsp;<span class="ident" id="4125713">iv</span>&nbsp;<span class="op" id="4125716">[</span><span class="op" id="4125717">]</span><span class="builtintype" id="4125718">byte</span><span class="op" id="4125722">,</span>&nbsp;<span class="ident" id="4125724">isRead</span>&nbsp;<span class="builtintype" id="4125731">bool</span><span class="op" id="4125735">)</span>&nbsp;<span class="keyword" id="4125737">interface</span><span class="op" id="4125746">{</span><span class="op" id="4125747">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125750">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125757">func</span><span class="op" id="4125761">(</span><span class="ident" id="4125762">version</span>&nbsp;<span class="builtintype" id="4125770">uint16</span><span class="op" id="4125776">,</span>&nbsp;<span class="ident" id="4125778">macKey</span>&nbsp;<span class="op" id="4125785">[</span><span class="op" id="4125786">]</span><span class="builtintype" id="4125787">byte</span><span class="op" id="4125791">)</span>&nbsp;<span class="ident" id="4125793">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125806">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125813">func</span><span class="op" id="4125817">(</span><span class="ident" id="4125818">key</span><span class="op" id="4125821">,</span>&nbsp;<span class="ident" id="4125823">fixedNonce</span>&nbsp;<span class="op" id="4125834">[</span><span class="op" id="4125835">]</span><span class="builtintype" id="4125836">byte</span><span class="op" id="4125840">)</span>&nbsp;<span class="ident" id="4125842">cipher</span><span class="op" id="4125848">.</span><span class="ident" id="4125849">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4125854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4125857">var</span>&nbsp;<span class="ident" id="4125861">cipherSuites</span>&nbsp;<span class="op" id="4125874">=</span>&nbsp;<span class="op" id="4125876">[</span><span class="op" id="4125877">]</span><span class="op" id="4125878">*</span><span class="ident" id="4125879">cipherSuite</span><span class="op" id="4125890">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125893">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125962">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126024">{</span><span class="ident" id="4126025">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4126062">,</span>&nbsp;<span class="num" id="4126064">16</span><span class="op" id="4126066">,</span>&nbsp;<span class="num" id="4126068">0</span><span class="op" id="4126069">,</span>&nbsp;<span class="num" id="4126071">4</span><span class="op" id="4126072">,</span>&nbsp;<span class="ident" id="4126074">ecdheRSAKA</span><span class="op" id="4126084">,</span>&nbsp;<span class="ident" id="4126086">suiteECDHE</span>&nbsp;<span class="op" id="4126097">|</span>&nbsp;<span class="ident" id="4126099">suiteTLS12</span><span class="op" id="4126109">,</span>&nbsp;<span class="ident" id="4126111">nil</span><span class="op" id="4126114">,</span>&nbsp;<span class="ident" id="4126116">nil</span><span class="op" id="4126119">,</span>&nbsp;<span class="ident" id="4126121">aeadAESGCM</span><span class="op" id="4126131">}</span><span class="op" id="4126132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126135">{</span><span class="ident" id="4126136">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4126175">,</span>&nbsp;<span class="num" id="4126177">16</span><span class="op" id="4126179">,</span>&nbsp;<span class="num" id="4126181">0</span><span class="op" id="4126182">,</span>&nbsp;<span class="num" id="4126184">4</span><span class="op" id="4126185">,</span>&nbsp;<span class="ident" id="4126187">ecdheECDSAKA</span><span class="op" id="4126199">,</span>&nbsp;<span class="ident" id="4126201">suiteECDHE</span>&nbsp;<span class="op" id="4126212">|</span>&nbsp;<span class="ident" id="4126214">suiteECDSA</span>&nbsp;<span class="op" id="4126225">|</span>&nbsp;<span class="ident" id="4126227">suiteTLS12</span><span class="op" id="4126237">,</span>&nbsp;<span class="ident" id="4126239">nil</span><span class="op" id="4126242">,</span>&nbsp;<span class="ident" id="4126244">nil</span><span class="op" id="4126247">,</span>&nbsp;<span class="ident" id="4126249">aeadAESGCM</span><span class="op" id="4126259">}</span><span class="op" id="4126260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126263">{</span><span class="ident" id="4126264">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="4126294">,</span>&nbsp;<span class="num" id="4126296">16</span><span class="op" id="4126298">,</span>&nbsp;<span class="num" id="4126300">20</span><span class="op" id="4126302">,</span>&nbsp;<span class="num" id="4126304">0</span><span class="op" id="4126305">,</span>&nbsp;<span class="ident" id="4126307">ecdheRSAKA</span><span class="op" id="4126317">,</span>&nbsp;<span class="ident" id="4126319">suiteECDHE</span><span class="op" id="4126329">,</span>&nbsp;<span class="ident" id="4126331">cipherRC4</span><span class="op" id="4126340">,</span>&nbsp;<span class="ident" id="4126342">macSHA1</span><span class="op" id="4126349">,</span>&nbsp;<span class="ident" id="4126351">nil</span><span class="op" id="4126354">}</span><span class="op" id="4126355">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126358">{</span><span class="ident" id="4126359">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="4126391">,</span>&nbsp;<span class="num" id="4126393">16</span><span class="op" id="4126395">,</span>&nbsp;<span class="num" id="4126397">20</span><span class="op" id="4126399">,</span>&nbsp;<span class="num" id="4126401">0</span><span class="op" id="4126402">,</span>&nbsp;<span class="ident" id="4126404">ecdheECDSAKA</span><span class="op" id="4126416">,</span>&nbsp;<span class="ident" id="4126418">suiteECDHE</span>&nbsp;<span class="op" id="4126429">|</span>&nbsp;<span class="ident" id="4126431">suiteECDSA</span><span class="op" id="4126441">,</span>&nbsp;<span class="ident" id="4126443">cipherRC4</span><span class="op" id="4126452">,</span>&nbsp;<span class="ident" id="4126454">macSHA1</span><span class="op" id="4126461">,</span>&nbsp;<span class="ident" id="4126463">nil</span><span class="op" id="4126466">}</span><span class="op" id="4126467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126470">{</span><span class="ident" id="4126471">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4126505">,</span>&nbsp;<span class="num" id="4126507">16</span><span class="op" id="4126509">,</span>&nbsp;<span class="num" id="4126511">20</span><span class="op" id="4126513">,</span>&nbsp;<span class="num" id="4126515">16</span><span class="op" id="4126517">,</span>&nbsp;<span class="ident" id="4126519">ecdheRSAKA</span><span class="op" id="4126529">,</span>&nbsp;<span class="ident" id="4126531">suiteECDHE</span><span class="op" id="4126541">,</span>&nbsp;<span class="ident" id="4126543">cipherAES</span><span class="op" id="4126552">,</span>&nbsp;<span class="ident" id="4126554">macSHA1</span><span class="op" id="4126561">,</span>&nbsp;<span class="ident" id="4126563">nil</span><span class="op" id="4126566">}</span><span class="op" id="4126567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126570">{</span><span class="ident" id="4126571">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4126607">,</span>&nbsp;<span class="num" id="4126609">16</span><span class="op" id="4126611">,</span>&nbsp;<span class="num" id="4126613">20</span><span class="op" id="4126615">,</span>&nbsp;<span class="num" id="4126617">16</span><span class="op" id="4126619">,</span>&nbsp;<span class="ident" id="4126621">ecdheECDSAKA</span><span class="op" id="4126633">,</span>&nbsp;<span class="ident" id="4126635">suiteECDHE</span>&nbsp;<span class="op" id="4126646">|</span>&nbsp;<span class="ident" id="4126648">suiteECDSA</span><span class="op" id="4126658">,</span>&nbsp;<span class="ident" id="4126660">cipherAES</span><span class="op" id="4126669">,</span>&nbsp;<span class="ident" id="4126671">macSHA1</span><span class="op" id="4126678">,</span>&nbsp;<span class="ident" id="4126680">nil</span><span class="op" id="4126683">}</span><span class="op" id="4126684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126687">{</span><span class="ident" id="4126688">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4126722">,</span>&nbsp;<span class="num" id="4126724">32</span><span class="op" id="4126726">,</span>&nbsp;<span class="num" id="4126728">20</span><span class="op" id="4126730">,</span>&nbsp;<span class="num" id="4126732">16</span><span class="op" id="4126734">,</span>&nbsp;<span class="ident" id="4126736">ecdheRSAKA</span><span class="op" id="4126746">,</span>&nbsp;<span class="ident" id="4126748">suiteECDHE</span><span class="op" id="4126758">,</span>&nbsp;<span class="ident" id="4126760">cipherAES</span><span class="op" id="4126769">,</span>&nbsp;<span class="ident" id="4126771">macSHA1</span><span class="op" id="4126778">,</span>&nbsp;<span class="ident" id="4126780">nil</span><span class="op" id="4126783">}</span><span class="op" id="4126784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126787">{</span><span class="ident" id="4126788">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4126824">,</span>&nbsp;<span class="num" id="4126826">32</span><span class="op" id="4126828">,</span>&nbsp;<span class="num" id="4126830">20</span><span class="op" id="4126832">,</span>&nbsp;<span class="num" id="4126834">16</span><span class="op" id="4126836">,</span>&nbsp;<span class="ident" id="4126838">ecdheECDSAKA</span><span class="op" id="4126850">,</span>&nbsp;<span class="ident" id="4126852">suiteECDHE</span>&nbsp;<span class="op" id="4126863">|</span>&nbsp;<span class="ident" id="4126865">suiteECDSA</span><span class="op" id="4126875">,</span>&nbsp;<span class="ident" id="4126877">cipherAES</span><span class="op" id="4126886">,</span>&nbsp;<span class="ident" id="4126888">macSHA1</span><span class="op" id="4126895">,</span>&nbsp;<span class="ident" id="4126897">nil</span><span class="op" id="4126900">}</span><span class="op" id="4126901">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126904">{</span><span class="ident" id="4126905">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="4126929">,</span>&nbsp;<span class="num" id="4126931">16</span><span class="op" id="4126933">,</span>&nbsp;<span class="num" id="4126935">20</span><span class="op" id="4126937">,</span>&nbsp;<span class="num" id="4126939">0</span><span class="op" id="4126940">,</span>&nbsp;<span class="ident" id="4126942">rsaKA</span><span class="op" id="4126947">,</span>&nbsp;<span class="num" id="4126949">0</span><span class="op" id="4126950">,</span>&nbsp;<span class="ident" id="4126952">cipherRC4</span><span class="op" id="4126961">,</span>&nbsp;<span class="ident" id="4126963">macSHA1</span><span class="op" id="4126970">,</span>&nbsp;<span class="ident" id="4126972">nil</span><span class="op" id="4126975">}</span><span class="op" id="4126976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126979">{</span><span class="ident" id="4126980">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4127008">,</span>&nbsp;<span class="num" id="4127010">16</span><span class="op" id="4127012">,</span>&nbsp;<span class="num" id="4127014">20</span><span class="op" id="4127016">,</span>&nbsp;<span class="num" id="4127018">16</span><span class="op" id="4127020">,</span>&nbsp;<span class="ident" id="4127022">rsaKA</span><span class="op" id="4127027">,</span>&nbsp;<span class="num" id="4127029">0</span><span class="op" id="4127030">,</span>&nbsp;<span class="ident" id="4127032">cipherAES</span><span class="op" id="4127041">,</span>&nbsp;<span class="ident" id="4127043">macSHA1</span><span class="op" id="4127050">,</span>&nbsp;<span class="ident" id="4127052">nil</span><span class="op" id="4127055">}</span><span class="op" id="4127056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127059">{</span><span class="ident" id="4127060">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4127088">,</span>&nbsp;<span class="num" id="4127090">32</span><span class="op" id="4127092">,</span>&nbsp;<span class="num" id="4127094">20</span><span class="op" id="4127096">,</span>&nbsp;<span class="num" id="4127098">16</span><span class="op" id="4127100">,</span>&nbsp;<span class="ident" id="4127102">rsaKA</span><span class="op" id="4127107">,</span>&nbsp;<span class="num" id="4127109">0</span><span class="op" id="4127110">,</span>&nbsp;<span class="ident" id="4127112">cipherAES</span><span class="op" id="4127121">,</span>&nbsp;<span class="ident" id="4127123">macSHA1</span><span class="op" id="4127130">,</span>&nbsp;<span class="ident" id="4127132">nil</span><span class="op" id="4127135">}</span><span class="op" id="4127136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127139">{</span><span class="ident" id="4127140">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4127175">,</span>&nbsp;<span class="num" id="4127177">24</span><span class="op" id="4127179">,</span>&nbsp;<span class="num" id="4127181">20</span><span class="op" id="4127183">,</span>&nbsp;<span class="num" id="4127185">8</span><span class="op" id="4127186">,</span>&nbsp;<span class="ident" id="4127188">ecdheRSAKA</span><span class="op" id="4127198">,</span>&nbsp;<span class="ident" id="4127200">suiteECDHE</span><span class="op" id="4127210">,</span>&nbsp;<span class="ident" id="4127212">cipher3DES</span><span class="op" id="4127222">,</span>&nbsp;<span class="ident" id="4127224">macSHA1</span><span class="op" id="4127231">,</span>&nbsp;<span class="ident" id="4127233">nil</span><span class="op" id="4127236">}</span><span class="op" id="4127237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127240">{</span><span class="ident" id="4127241">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4127270">,</span>&nbsp;<span class="num" id="4127272">24</span><span class="op" id="4127274">,</span>&nbsp;<span class="num" id="4127276">20</span><span class="op" id="4127278">,</span>&nbsp;<span class="num" id="4127280">8</span><span class="op" id="4127281">,</span>&nbsp;<span class="ident" id="4127283">rsaKA</span><span class="op" id="4127288">,</span>&nbsp;<span class="num" id="4127290">0</span><span class="op" id="4127291">,</span>&nbsp;<span class="ident" id="4127293">cipher3DES</span><span class="op" id="4127303">,</span>&nbsp;<span class="ident" id="4127305">macSHA1</span><span class="op" id="4127312">,</span>&nbsp;<span class="ident" id="4127314">nil</span><span class="op" id="4127317">}</span><span class="op" id="4127318">,</span><br>
<span class="lineno">85</span><span class="op" id="4127320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4127323">func</span>&nbsp;<span class="ident" id="4127328">cipherRC4</span><span class="op" id="4127337">(</span><span class="ident" id="4127338">key</span><span class="op" id="4127341">,</span>&nbsp;<span class="ident" id="4127343">iv</span>&nbsp;<span class="op" id="4127346">[</span><span class="op" id="4127347">]</span><span class="builtintype" id="4127348">byte</span><span class="op" id="4127352">,</span>&nbsp;<span class="ident" id="4127354">isRead</span>&nbsp;<span class="builtintype" id="4127361">bool</span><span class="op" id="4127365">)</span>&nbsp;<span class="keyword" id="4127367">interface</span><span class="op" id="4127376">{</span><span class="op" id="4127377">}</span>&nbsp;<span class="op" id="4127379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127382">cipher</span><span class="op" id="4127388">,</span>&nbsp;<span class="ident" id="4127390">_</span>&nbsp;<span class="op" id="4127392">:=</span>&nbsp;<span class="ident" id="4127395">rc4</span><span class="op" id="4127398">.</span><span class="ident" id="4127399">NewCipher</span><span class="op" id="4127408">(</span><span class="ident" id="4127409">key</span><span class="op" id="4127412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127415">return</span>&nbsp;<span class="ident" id="4127422">cipher</span><br>
<span class="lineno">90</span><span class="op" id="4127429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4127432">func</span>&nbsp;<span class="ident" id="4127437">cipher3DES</span><span class="op" id="4127447">(</span><span class="ident" id="4127448">key</span><span class="op" id="4127451">,</span>&nbsp;<span class="ident" id="4127453">iv</span>&nbsp;<span class="op" id="4127456">[</span><span class="op" id="4127457">]</span><span class="builtintype" id="4127458">byte</span><span class="op" id="4127462">,</span>&nbsp;<span class="ident" id="4127464">isRead</span>&nbsp;<span class="builtintype" id="4127471">bool</span><span class="op" id="4127475">)</span>&nbsp;<span class="keyword" id="4127477">interface</span><span class="op" id="4127486">{</span><span class="op" id="4127487">}</span>&nbsp;<span class="op" id="4127489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127492">block</span><span class="op" id="4127497">,</span>&nbsp;<span class="ident" id="4127499">_</span>&nbsp;<span class="op" id="4127501">:=</span>&nbsp;<span class="ident" id="4127504">des</span><span class="op" id="4127507">.</span><span class="ident" id="4127508">NewTripleDESCipher</span><span class="op" id="4127526">(</span><span class="ident" id="4127527">key</span><span class="op" id="4127530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127533">if</span>&nbsp;<span class="ident" id="4127536">isRead</span>&nbsp;<span class="op" id="4127543">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127547">return</span>&nbsp;<span class="ident" id="4127554">cipher</span><span class="op" id="4127560">.</span><span class="ident" id="4127561">NewCBCDecrypter</span><span class="op" id="4127576">(</span><span class="ident" id="4127577">block</span><span class="op" id="4127582">,</span>&nbsp;<span class="ident" id="4127584">iv</span><span class="op" id="4127586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127592">return</span>&nbsp;<span class="ident" id="4127599">cipher</span><span class="op" id="4127605">.</span><span class="ident" id="4127606">NewCBCEncrypter</span><span class="op" id="4127621">(</span><span class="ident" id="4127622">block</span><span class="op" id="4127627">,</span>&nbsp;<span class="ident" id="4127629">iv</span><span class="op" id="4127631">)</span><br>
<span class="lineno"></span><span class="op" id="4127633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4127636">func</span>&nbsp;<span class="ident" id="4127641">cipherAES</span><span class="op" id="4127650">(</span><span class="ident" id="4127651">key</span><span class="op" id="4127654">,</span>&nbsp;<span class="ident" id="4127656">iv</span>&nbsp;<span class="op" id="4127659">[</span><span class="op" id="4127660">]</span><span class="builtintype" id="4127661">byte</span><span class="op" id="4127665">,</span>&nbsp;<span class="ident" id="4127667">isRead</span>&nbsp;<span class="builtintype" id="4127674">bool</span><span class="op" id="4127678">)</span>&nbsp;<span class="keyword" id="4127680">interface</span><span class="op" id="4127689">{</span><span class="op" id="4127690">}</span>&nbsp;<span class="op" id="4127692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127695">block</span><span class="op" id="4127700">,</span>&nbsp;<span class="ident" id="4127702">_</span>&nbsp;<span class="op" id="4127704">:=</span>&nbsp;<span class="ident" id="4127707">aes</span><span class="op" id="4127710">.</span><span class="ident" id="4127711">NewCipher</span><span class="op" id="4127720">(</span><span class="ident" id="4127721">key</span><span class="op" id="4127724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127727">if</span>&nbsp;<span class="ident" id="4127730">isRead</span>&nbsp;<span class="op" id="4127737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127741">return</span>&nbsp;<span class="ident" id="4127748">cipher</span><span class="op" id="4127754">.</span><span class="ident" id="4127755">NewCBCDecrypter</span><span class="op" id="4127770">(</span><span class="ident" id="4127771">block</span><span class="op" id="4127776">,</span>&nbsp;<span class="ident" id="4127778">iv</span><span class="op" id="4127780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127783">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127786">return</span>&nbsp;<span class="ident" id="4127793">cipher</span><span class="op" id="4127799">.</span><span class="ident" id="4127800">NewCBCEncrypter</span><span class="op" id="4127815">(</span><span class="ident" id="4127816">block</span><span class="op" id="4127821">,</span>&nbsp;<span class="ident" id="4127823">iv</span><span class="op" id="4127825">)</span><br>
<span class="lineno"></span><span class="op" id="4127827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4127830">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4127895">func</span>&nbsp;<span class="ident" id="4127900">macSHA1</span><span class="op" id="4127907">(</span><span class="ident" id="4127908">version</span>&nbsp;<span class="builtintype" id="4127916">uint16</span><span class="op" id="4127922">,</span>&nbsp;<span class="ident" id="4127924">key</span>&nbsp;<span class="op" id="4127928">[</span><span class="op" id="4127929">]</span><span class="builtintype" id="4127930">byte</span><span class="op" id="4127934">)</span>&nbsp;<span class="ident" id="4127936">macFunction</span>&nbsp;<span class="op" id="4127948">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127951">if</span>&nbsp;<span class="ident" id="4127954">version</span>&nbsp;<span class="op" id="4127962">==</span>&nbsp;<span class="ident" id="4127965">VersionSSL30</span>&nbsp;<span class="op" id="4127978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127982">mac</span>&nbsp;<span class="op" id="4127986">:=</span>&nbsp;<span class="ident" id="4127989">ssl30MAC</span><span class="op" id="4127997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128002">h</span><span class="op" id="4128003">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4128007">sha1</span><span class="op" id="4128011">.</span><span class="ident" id="4128012">New</span><span class="op" id="4128015">(</span><span class="op" id="4128016">)</span><span class="op" id="4128017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128022">key</span><span class="op" id="4128025">:</span>&nbsp;<span class="builtinfunc" id="4128027">make</span><span class="op" id="4128031">(</span><span class="op" id="4128032">[</span><span class="op" id="4128033">]</span><span class="builtintype" id="4128034">byte</span><span class="op" id="4128038">,</span>&nbsp;<span class="builtinfunc" id="4128040">len</span><span class="op" id="4128043">(</span><span class="ident" id="4128044">key</span><span class="op" id="4128047">)</span><span class="op" id="4128048">)</span><span class="op" id="4128049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128053">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4128057">copy</span><span class="op" id="4128061">(</span><span class="ident" id="4128062">mac</span><span class="op" id="4128065">.</span><span class="ident" id="4128066">key</span><span class="op" id="4128069">,</span>&nbsp;<span class="ident" id="4128071">key</span><span class="op" id="4128074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128078">return</span>&nbsp;<span class="ident" id="4128085">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128093">return</span>&nbsp;<span class="ident" id="4128100">tls10MAC</span><span class="op" id="4128108">{</span><span class="ident" id="4128109">hmac</span><span class="op" id="4128113">.</span><span class="ident" id="4128114">New</span><span class="op" id="4128117">(</span><span class="ident" id="4128118">sha1</span><span class="op" id="4128122">.</span><span class="ident" id="4128123">New</span><span class="op" id="4128126">,</span>&nbsp;<span class="ident" id="4128128">key</span><span class="op" id="4128131">)</span><span class="op" id="4128132">}</span><br>
<span class="lineno"></span><span class="op" id="4128134">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4128137">type</span>&nbsp;<span class="ident" id="4128142">macFunction</span>&nbsp;<span class="keyword" id="4128154">interface</span>&nbsp;<span class="op" id="4128164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128167">Size</span><span class="op" id="4128171">(</span><span class="op" id="4128172">)</span>&nbsp;<span class="builtintype" id="4128174">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128179">MAC</span><span class="op" id="4128182">(</span><span class="ident" id="4128183">digestBuf</span><span class="op" id="4128192">,</span>&nbsp;<span class="ident" id="4128194">seq</span><span class="op" id="4128197">,</span>&nbsp;<span class="ident" id="4128199">header</span><span class="op" id="4128205">,</span>&nbsp;<span class="ident" id="4128207">data</span>&nbsp;<span class="op" id="4128212">[</span><span class="op" id="4128213">]</span><span class="builtintype" id="4128214">byte</span><span class="op" id="4128218">)</span>&nbsp;<span class="op" id="4128220">[</span><span class="op" id="4128221">]</span><span class="builtintype" id="4128222">byte</span><br>
<span class="lineno"></span><span class="op" id="4128227">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4128230">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4128307">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4128321">type</span>&nbsp;<span class="ident" id="4128326">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4128341">struct</span>&nbsp;<span class="op" id="4128348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4128351">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4128422">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4128486">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128541">sealNonce</span><span class="op" id="4128550">,</span>&nbsp;<span class="ident" id="4128552">openNonce</span>&nbsp;<span class="op" id="4128562">[</span><span class="op" id="4128563">]</span><span class="builtintype" id="4128564">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128570">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128591">cipher</span><span class="op" id="4128597">.</span><span class="ident" id="4128598">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4128603">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4128606">func</span>&nbsp;<span class="op" id="4128611">(</span><span class="ident" id="4128612">f</span>&nbsp;<span class="op" id="4128614">*</span><span class="ident" id="4128615">fixedNonceAEAD</span><span class="op" id="4128629">)</span>&nbsp;<span class="ident" id="4128631">NonceSize</span><span class="op" id="4128640">(</span><span class="op" id="4128641">)</span>&nbsp;<span class="builtintype" id="4128643">int</span>&nbsp;<span class="op" id="4128647">{</span>&nbsp;<span class="keyword" id="4128649">return</span>&nbsp;<span class="num" id="4128656">8</span>&nbsp;<span class="op" id="4128658">}</span><br>
<span class="lineno"></span><span class="keyword" id="4128660">func</span>&nbsp;<span class="op" id="4128665">(</span><span class="ident" id="4128666">f</span>&nbsp;<span class="op" id="4128668">*</span><span class="ident" id="4128669">fixedNonceAEAD</span><span class="op" id="4128683">)</span>&nbsp;<span class="ident" id="4128685">Overhead</span><span class="op" id="4128693">(</span><span class="op" id="4128694">)</span>&nbsp;<span class="builtintype" id="4128696">int</span>&nbsp;&nbsp;<span class="op" id="4128701">{</span>&nbsp;<span class="keyword" id="4128703">return</span>&nbsp;<span class="ident" id="4128710">f</span><span class="op" id="4128711">.</span><span class="ident" id="4128712">aead</span><span class="op" id="4128716">.</span><span class="ident" id="4128717">Overhead</span><span class="op" id="4128725">(</span><span class="op" id="4128726">)</span>&nbsp;<span class="op" id="4128728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4128731">func</span>&nbsp;<span class="op" id="4128736">(</span><span class="ident" id="4128737">f</span>&nbsp;<span class="op" id="4128739">*</span><span class="ident" id="4128740">fixedNonceAEAD</span><span class="op" id="4128754">)</span>&nbsp;<span class="ident" id="4128756">Seal</span><span class="op" id="4128760">(</span><span class="ident" id="4128761">out</span><span class="op" id="4128764">,</span>&nbsp;<span class="ident" id="4128766">nonce</span><span class="op" id="4128771">,</span>&nbsp;<span class="ident" id="4128773">plaintext</span><span class="op" id="4128782">,</span>&nbsp;<span class="ident" id="4128784">additionalData</span>&nbsp;<span class="op" id="4128799">[</span><span class="op" id="4128800">]</span><span class="builtintype" id="4128801">byte</span><span class="op" id="4128805">)</span>&nbsp;<span class="op" id="4128807">[</span><span class="op" id="4128808">]</span><span class="builtintype" id="4128809">byte</span>&nbsp;<span class="op" id="4128814">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4128817">copy</span><span class="op" id="4128821">(</span><span class="ident" id="4128822">f</span><span class="op" id="4128823">.</span><span class="ident" id="4128824">sealNonce</span><span class="op" id="4128833">[</span><span class="builtinfunc" id="4128834">len</span><span class="op" id="4128837">(</span><span class="ident" id="4128838">f</span><span class="op" id="4128839">.</span><span class="ident" id="4128840">sealNonce</span><span class="op" id="4128849">)</span><span class="op" id="4128850">-</span><span class="num" id="4128851">8</span><span class="op" id="4128852">:</span><span class="op" id="4128853">]</span><span class="op" id="4128854">,</span>&nbsp;<span class="ident" id="4128856">nonce</span><span class="op" id="4128861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128864">return</span>&nbsp;<span class="ident" id="4128871">f</span><span class="op" id="4128872">.</span><span class="ident" id="4128873">aead</span><span class="op" id="4128877">.</span><span class="ident" id="4128878">Seal</span><span class="op" id="4128882">(</span><span class="ident" id="4128883">out</span><span class="op" id="4128886">,</span>&nbsp;<span class="ident" id="4128888">f</span><span class="op" id="4128889">.</span><span class="ident" id="4128890">sealNonce</span><span class="op" id="4128899">,</span>&nbsp;<span class="ident" id="4128901">plaintext</span><span class="op" id="4128910">,</span>&nbsp;<span class="ident" id="4128912">additionalData</span><span class="op" id="4128926">)</span><br>
<span class="lineno"></span><span class="op" id="4128928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4128931">func</span>&nbsp;<span class="op" id="4128936">(</span><span class="ident" id="4128937">f</span>&nbsp;<span class="op" id="4128939">*</span><span class="ident" id="4128940">fixedNonceAEAD</span><span class="op" id="4128954">)</span>&nbsp;<span class="ident" id="4128956">Open</span><span class="op" id="4128960">(</span><span class="ident" id="4128961">out</span><span class="op" id="4128964">,</span>&nbsp;<span class="ident" id="4128966">nonce</span><span class="op" id="4128971">,</span>&nbsp;<span class="ident" id="4128973">plaintext</span><span class="op" id="4128982">,</span>&nbsp;<span class="ident" id="4128984">additionalData</span>&nbsp;<span class="op" id="4128999">[</span><span class="op" id="4129000">]</span><span class="builtintype" id="4129001">byte</span><span class="op" id="4129005">)</span>&nbsp;<span class="op" id="4129007">(</span><span class="op" id="4129008">[</span><span class="op" id="4129009">]</span><span class="builtintype" id="4129010">byte</span><span class="op" id="4129014">,</span>&nbsp;<span class="builtintype" id="4129016">error</span><span class="op" id="4129021">)</span>&nbsp;<span class="op" id="4129023">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4129026">copy</span><span class="op" id="4129030">(</span><span class="ident" id="4129031">f</span><span class="op" id="4129032">.</span><span class="ident" id="4129033">openNonce</span><span class="op" id="4129042">[</span><span class="builtinfunc" id="4129043">len</span><span class="op" id="4129046">(</span><span class="ident" id="4129047">f</span><span class="op" id="4129048">.</span><span class="ident" id="4129049">openNonce</span><span class="op" id="4129058">)</span><span class="op" id="4129059">-</span><span class="num" id="4129060">8</span><span class="op" id="4129061">:</span><span class="op" id="4129062">]</span><span class="op" id="4129063">,</span>&nbsp;<span class="ident" id="4129065">nonce</span><span class="op" id="4129070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129073">return</span>&nbsp;<span class="ident" id="4129080">f</span><span class="op" id="4129081">.</span><span class="ident" id="4129082">aead</span><span class="op" id="4129086">.</span><span class="ident" id="4129087">Open</span><span class="op" id="4129091">(</span><span class="ident" id="4129092">out</span><span class="op" id="4129095">,</span>&nbsp;<span class="ident" id="4129097">f</span><span class="op" id="4129098">.</span><span class="ident" id="4129099">openNonce</span><span class="op" id="4129108">,</span>&nbsp;<span class="ident" id="4129110">plaintext</span><span class="op" id="4129119">,</span>&nbsp;<span class="ident" id="4129121">additionalData</span><span class="op" id="4129135">)</span><br>
<span class="lineno"></span><span class="op" id="4129137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4129140">func</span>&nbsp;<span class="ident" id="4129145">aeadAESGCM</span><span class="op" id="4129155">(</span><span class="ident" id="4129156">key</span><span class="op" id="4129159">,</span>&nbsp;<span class="ident" id="4129161">fixedNonce</span>&nbsp;<span class="op" id="4129172">[</span><span class="op" id="4129173">]</span><span class="builtintype" id="4129174">byte</span><span class="op" id="4129178">)</span>&nbsp;<span class="ident" id="4129180">cipher</span><span class="op" id="4129186">.</span><span class="ident" id="4129187">AEAD</span>&nbsp;<span class="op" id="4129192">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129195">aes</span><span class="op" id="4129198">,</span>&nbsp;<span class="ident" id="4129200">err</span>&nbsp;<span class="op" id="4129204">:=</span>&nbsp;<span class="ident" id="4129207">aes</span><span class="op" id="4129210">.</span><span class="ident" id="4129211">NewCipher</span><span class="op" id="4129220">(</span><span class="ident" id="4129221">key</span><span class="op" id="4129224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129227">if</span>&nbsp;<span class="ident" id="4129230">err</span>&nbsp;<span class="op" id="4129234">!=</span>&nbsp;<span class="ident" id="4129237">nil</span>&nbsp;<span class="op" id="4129241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4129245">panic</span><span class="op" id="4129250">(</span><span class="ident" id="4129251">err</span><span class="op" id="4129254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129260">aead</span><span class="op" id="4129264">,</span>&nbsp;<span class="ident" id="4129266">err</span>&nbsp;<span class="op" id="4129270">:=</span>&nbsp;<span class="ident" id="4129273">cipher</span><span class="op" id="4129279">.</span><span class="ident" id="4129280">NewGCM</span><span class="op" id="4129286">(</span><span class="ident" id="4129287">aes</span><span class="op" id="4129290">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129293">if</span>&nbsp;<span class="ident" id="4129296">err</span>&nbsp;<span class="op" id="4129300">!=</span>&nbsp;<span class="ident" id="4129303">nil</span>&nbsp;<span class="op" id="4129307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4129311">panic</span><span class="op" id="4129316">(</span><span class="ident" id="4129317">err</span><span class="op" id="4129320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129327">nonce1</span><span class="op" id="4129333">,</span>&nbsp;<span class="ident" id="4129335">nonce2</span>&nbsp;<span class="op" id="4129342">:=</span>&nbsp;<span class="builtinfunc" id="4129345">make</span><span class="op" id="4129349">(</span><span class="op" id="4129350">[</span><span class="op" id="4129351">]</span><span class="builtintype" id="4129352">byte</span><span class="op" id="4129356">,</span>&nbsp;<span class="num" id="4129358">12</span><span class="op" id="4129360">)</span><span class="op" id="4129361">,</span>&nbsp;<span class="builtinfunc" id="4129363">make</span><span class="op" id="4129367">(</span><span class="op" id="4129368">[</span><span class="op" id="4129369">]</span><span class="builtintype" id="4129370">byte</span><span class="op" id="4129374">,</span>&nbsp;<span class="num" id="4129376">12</span><span class="op" id="4129378">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4129381">copy</span><span class="op" id="4129385">(</span><span class="ident" id="4129386">nonce1</span><span class="op" id="4129392">,</span>&nbsp;<span class="ident" id="4129394">fixedNonce</span><span class="op" id="4129404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4129407">copy</span><span class="op" id="4129411">(</span><span class="ident" id="4129412">nonce2</span><span class="op" id="4129418">,</span>&nbsp;<span class="ident" id="4129420">fixedNonce</span><span class="op" id="4129430">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129434">return</span>&nbsp;<span class="op" id="4129441">&amp;</span><span class="ident" id="4129442">fixedNonceAEAD</span><span class="op" id="4129456">{</span><span class="ident" id="4129457">nonce1</span><span class="op" id="4129463">,</span>&nbsp;<span class="ident" id="4129465">nonce2</span><span class="op" id="4129471">,</span>&nbsp;<span class="ident" id="4129473">aead</span><span class="op" id="4129477">}</span><br>
<span class="lineno"></span><span class="op" id="4129479">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4129482">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4129543">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4129621">type</span>&nbsp;<span class="ident" id="4129626">ssl30MAC</span>&nbsp;<span class="keyword" id="4129635">struct</span>&nbsp;<span class="op" id="4129642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129645">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4129649">hash</span><span class="op" id="4129653">.</span><span class="ident" id="4129654">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129660">key</span>&nbsp;<span class="op" id="4129664">[</span><span class="op" id="4129665">]</span><span class="builtintype" id="4129666">byte</span><br>
<span class="lineno"></span><span class="op" id="4129671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4129674">func</span>&nbsp;<span class="op" id="4129679">(</span><span class="ident" id="4129680">s</span>&nbsp;<span class="ident" id="4129682">ssl30MAC</span><span class="op" id="4129690">)</span>&nbsp;<span class="ident" id="4129692">Size</span><span class="op" id="4129696">(</span><span class="op" id="4129697">)</span>&nbsp;<span class="builtintype" id="4129699">int</span>&nbsp;<span class="op" id="4129703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129706">return</span>&nbsp;<span class="ident" id="4129713">s</span><span class="op" id="4129714">.</span><span class="ident" id="4129715">h</span><span class="op" id="4129716">.</span><span class="ident" id="4129717">Size</span><span class="op" id="4129721">(</span><span class="op" id="4129722">)</span><br>
<span class="lineno">175</span><span class="op" id="4129724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4129727">var</span>&nbsp;<span class="ident" id="4129731">ssl30Pad1</span>&nbsp;<span class="op" id="4129741">=</span>&nbsp;<span class="op" id="4129743">[</span><span class="num" id="4129744">48</span><span class="op" id="4129746">]</span><span class="builtintype" id="4129747">byte</span><span class="op" id="4129751">{</span><span class="num" id="4129752">0x36</span><span class="op" id="4129756">,</span>&nbsp;<span class="num" id="4129758">0x36</span><span class="op" id="4129762">,</span>&nbsp;<span class="num" id="4129764">0x36</span><span class="op" id="4129768">,</span>&nbsp;<span class="num" id="4129770">0x36</span><span class="op" id="4129774">,</span>&nbsp;<span class="num" id="4129776">0x36</span><span class="op" id="4129780">,</span>&nbsp;<span class="num" id="4129782">0x36</span><span class="op" id="4129786">,</span>&nbsp;<span class="num" id="4129788">0x36</span><span class="op" id="4129792">,</span>&nbsp;<span class="num" id="4129794">0x36</span><span class="op" id="4129798">,</span>&nbsp;<span class="num" id="4129800">0x36</span><span class="op" id="4129804">,</span>&nbsp;<span class="num" id="4129806">0x36</span><span class="op" id="4129810">,</span>&nbsp;<span class="num" id="4129812">0x36</span><span class="op" id="4129816">,</span>&nbsp;<span class="num" id="4129818">0x36</span><span class="op" id="4129822">,</span>&nbsp;<span class="num" id="4129824">0x36</span><span class="op" id="4129828">,</span>&nbsp;<span class="num" id="4129830">0x36</span><span class="op" id="4129834">,</span>&nbsp;<span class="num" id="4129836">0x36</span><span class="op" id="4129840">,</span>&nbsp;<span class="num" id="4129842">0x36</span><span class="op" id="4129846">,</span>&nbsp;<span class="num" id="4129848">0x36</span><span class="op" id="4129852">,</span>&nbsp;<span class="num" id="4129854">0x36</span><span class="op" id="4129858">,</span>&nbsp;<span class="num" id="4129860">0x36</span><span class="op" id="4129864">,</span>&nbsp;<span class="num" id="4129866">0x36</span><span class="op" id="4129870">,</span>&nbsp;<span class="num" id="4129872">0x36</span><span class="op" id="4129876">,</span>&nbsp;<span class="num" id="4129878">0x36</span><span class="op" id="4129882">,</span>&nbsp;<span class="num" id="4129884">0x36</span><span class="op" id="4129888">,</span>&nbsp;<span class="num" id="4129890">0x36</span><span class="op" id="4129894">,</span>&nbsp;<span class="num" id="4129896">0x36</span><span class="op" id="4129900">,</span>&nbsp;<span class="num" id="4129902">0x36</span><span class="op" id="4129906">,</span>&nbsp;<span class="num" id="4129908">0x36</span><span class="op" id="4129912">,</span>&nbsp;<span class="num" id="4129914">0x36</span><span class="op" id="4129918">,</span>&nbsp;<span class="num" id="4129920">0x36</span><span class="op" id="4129924">,</span>&nbsp;<span class="num" id="4129926">0x36</span><span class="op" id="4129930">,</span>&nbsp;<span class="num" id="4129932">0x36</span><span class="op" id="4129936">,</span>&nbsp;<span class="num" id="4129938">0x36</span><span class="op" id="4129942">,</span>&nbsp;<span class="num" id="4129944">0x36</span><span class="op" id="4129948">,</span>&nbsp;<span class="num" id="4129950">0x36</span><span class="op" id="4129954">,</span>&nbsp;<span class="num" id="4129956">0x36</span><span class="op" id="4129960">,</span>&nbsp;<span class="num" id="4129962">0x36</span><span class="op" id="4129966">,</span>&nbsp;<span class="num" id="4129968">0x36</span><span class="op" id="4129972">,</span>&nbsp;<span class="num" id="4129974">0x36</span><span class="op" id="4129978">,</span>&nbsp;<span class="num" id="4129980">0x36</span><span class="op" id="4129984">,</span>&nbsp;<span class="num" id="4129986">0x36</span><span class="op" id="4129990">,</span>&nbsp;<span class="num" id="4129992">0x36</span><span class="op" id="4129996">,</span>&nbsp;<span class="num" id="4129998">0x36</span><span class="op" id="4130002">,</span>&nbsp;<span class="num" id="4130004">0x36</span><span class="op" id="4130008">,</span>&nbsp;<span class="num" id="4130010">0x36</span><span class="op" id="4130014">,</span>&nbsp;<span class="num" id="4130016">0x36</span><span class="op" id="4130020">,</span>&nbsp;<span class="num" id="4130022">0x36</span><span class="op" id="4130026">,</span>&nbsp;<span class="num" id="4130028">0x36</span><span class="op" id="4130032">,</span>&nbsp;<span class="num" id="4130034">0x36</span><span class="op" id="4130038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4130041">var</span>&nbsp;<span class="ident" id="4130045">ssl30Pad2</span>&nbsp;<span class="op" id="4130055">=</span>&nbsp;<span class="op" id="4130057">[</span><span class="num" id="4130058">48</span><span class="op" id="4130060">]</span><span class="builtintype" id="4130061">byte</span><span class="op" id="4130065">{</span><span class="num" id="4130066">0x5c</span><span class="op" id="4130070">,</span>&nbsp;<span class="num" id="4130072">0x5c</span><span class="op" id="4130076">,</span>&nbsp;<span class="num" id="4130078">0x5c</span><span class="op" id="4130082">,</span>&nbsp;<span class="num" id="4130084">0x5c</span><span class="op" id="4130088">,</span>&nbsp;<span class="num" id="4130090">0x5c</span><span class="op" id="4130094">,</span>&nbsp;<span class="num" id="4130096">0x5c</span><span class="op" id="4130100">,</span>&nbsp;<span class="num" id="4130102">0x5c</span><span class="op" id="4130106">,</span>&nbsp;<span class="num" id="4130108">0x5c</span><span class="op" id="4130112">,</span>&nbsp;<span class="num" id="4130114">0x5c</span><span class="op" id="4130118">,</span>&nbsp;<span class="num" id="4130120">0x5c</span><span class="op" id="4130124">,</span>&nbsp;<span class="num" id="4130126">0x5c</span><span class="op" id="4130130">,</span>&nbsp;<span class="num" id="4130132">0x5c</span><span class="op" id="4130136">,</span>&nbsp;<span class="num" id="4130138">0x5c</span><span class="op" id="4130142">,</span>&nbsp;<span class="num" id="4130144">0x5c</span><span class="op" id="4130148">,</span>&nbsp;<span class="num" id="4130150">0x5c</span><span class="op" id="4130154">,</span>&nbsp;<span class="num" id="4130156">0x5c</span><span class="op" id="4130160">,</span>&nbsp;<span class="num" id="4130162">0x5c</span><span class="op" id="4130166">,</span>&nbsp;<span class="num" id="4130168">0x5c</span><span class="op" id="4130172">,</span>&nbsp;<span class="num" id="4130174">0x5c</span><span class="op" id="4130178">,</span>&nbsp;<span class="num" id="4130180">0x5c</span><span class="op" id="4130184">,</span>&nbsp;<span class="num" id="4130186">0x5c</span><span class="op" id="4130190">,</span>&nbsp;<span class="num" id="4130192">0x5c</span><span class="op" id="4130196">,</span>&nbsp;<span class="num" id="4130198">0x5c</span><span class="op" id="4130202">,</span>&nbsp;<span class="num" id="4130204">0x5c</span><span class="op" id="4130208">,</span>&nbsp;<span class="num" id="4130210">0x5c</span><span class="op" id="4130214">,</span>&nbsp;<span class="num" id="4130216">0x5c</span><span class="op" id="4130220">,</span>&nbsp;<span class="num" id="4130222">0x5c</span><span class="op" id="4130226">,</span>&nbsp;<span class="num" id="4130228">0x5c</span><span class="op" id="4130232">,</span>&nbsp;<span class="num" id="4130234">0x5c</span><span class="op" id="4130238">,</span>&nbsp;<span class="num" id="4130240">0x5c</span><span class="op" id="4130244">,</span>&nbsp;<span class="num" id="4130246">0x5c</span><span class="op" id="4130250">,</span>&nbsp;<span class="num" id="4130252">0x5c</span><span class="op" id="4130256">,</span>&nbsp;<span class="num" id="4130258">0x5c</span><span class="op" id="4130262">,</span>&nbsp;<span class="num" id="4130264">0x5c</span><span class="op" id="4130268">,</span>&nbsp;<span class="num" id="4130270">0x5c</span><span class="op" id="4130274">,</span>&nbsp;<span class="num" id="4130276">0x5c</span><span class="op" id="4130280">,</span>&nbsp;<span class="num" id="4130282">0x5c</span><span class="op" id="4130286">,</span>&nbsp;<span class="num" id="4130288">0x5c</span><span class="op" id="4130292">,</span>&nbsp;<span class="num" id="4130294">0x5c</span><span class="op" id="4130298">,</span>&nbsp;<span class="num" id="4130300">0x5c</span><span class="op" id="4130304">,</span>&nbsp;<span class="num" id="4130306">0x5c</span><span class="op" id="4130310">,</span>&nbsp;<span class="num" id="4130312">0x5c</span><span class="op" id="4130316">,</span>&nbsp;<span class="num" id="4130318">0x5c</span><span class="op" id="4130322">,</span>&nbsp;<span class="num" id="4130324">0x5c</span><span class="op" id="4130328">,</span>&nbsp;<span class="num" id="4130330">0x5c</span><span class="op" id="4130334">,</span>&nbsp;<span class="num" id="4130336">0x5c</span><span class="op" id="4130340">,</span>&nbsp;<span class="num" id="4130342">0x5c</span><span class="op" id="4130346">,</span>&nbsp;<span class="num" id="4130348">0x5c</span><span class="op" id="4130352">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4130355">func</span>&nbsp;<span class="op" id="4130360">(</span><span class="ident" id="4130361">s</span>&nbsp;<span class="ident" id="4130363">ssl30MAC</span><span class="op" id="4130371">)</span>&nbsp;<span class="ident" id="4130373">MAC</span><span class="op" id="4130376">(</span><span class="ident" id="4130377">digestBuf</span><span class="op" id="4130386">,</span>&nbsp;<span class="ident" id="4130388">seq</span><span class="op" id="4130391">,</span>&nbsp;<span class="ident" id="4130393">header</span><span class="op" id="4130399">,</span>&nbsp;<span class="ident" id="4130401">data</span>&nbsp;<span class="op" id="4130406">[</span><span class="op" id="4130407">]</span><span class="builtintype" id="4130408">byte</span><span class="op" id="4130412">)</span>&nbsp;<span class="op" id="4130414">[</span><span class="op" id="4130415">]</span><span class="builtintype" id="4130416">byte</span>&nbsp;<span class="op" id="4130421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130424">padLength</span>&nbsp;<span class="op" id="4130434">:=</span>&nbsp;<span class="num" id="4130437">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130441">if</span>&nbsp;<span class="ident" id="4130444">s</span><span class="op" id="4130445">.</span><span class="ident" id="4130446">h</span><span class="op" id="4130447">.</span><span class="ident" id="4130448">Size</span><span class="op" id="4130452">(</span><span class="op" id="4130453">)</span>&nbsp;<span class="op" id="4130455">==</span>&nbsp;<span class="num" id="4130458">20</span>&nbsp;<span class="op" id="4130461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130465">padLength</span>&nbsp;<span class="op" id="4130475">=</span>&nbsp;<span class="num" id="4130477">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130485">s</span><span class="op" id="4130486">.</span><span class="ident" id="4130487">h</span><span class="op" id="4130488">.</span><span class="ident" id="4130489">Reset</span><span class="op" id="4130494">(</span><span class="op" id="4130495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130498">s</span><span class="op" id="4130499">.</span><span class="ident" id="4130500">h</span><span class="op" id="4130501">.</span><span class="ident" id="4130502">Write</span><span class="op" id="4130507">(</span><span class="ident" id="4130508">s</span><span class="op" id="4130509">.</span><span class="ident" id="4130510">key</span><span class="op" id="4130513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130516">s</span><span class="op" id="4130517">.</span><span class="ident" id="4130518">h</span><span class="op" id="4130519">.</span><span class="ident" id="4130520">Write</span><span class="op" id="4130525">(</span><span class="ident" id="4130526">ssl30Pad1</span><span class="op" id="4130535">[</span><span class="op" id="4130536">:</span><span class="ident" id="4130537">padLength</span><span class="op" id="4130546">]</span><span class="op" id="4130547">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130550">s</span><span class="op" id="4130551">.</span><span class="ident" id="4130552">h</span><span class="op" id="4130553">.</span><span class="ident" id="4130554">Write</span><span class="op" id="4130559">(</span><span class="ident" id="4130560">seq</span><span class="op" id="4130563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130566">s</span><span class="op" id="4130567">.</span><span class="ident" id="4130568">h</span><span class="op" id="4130569">.</span><span class="ident" id="4130570">Write</span><span class="op" id="4130575">(</span><span class="ident" id="4130576">header</span><span class="op" id="4130582">[</span><span class="op" id="4130583">:</span><span class="num" id="4130584">1</span><span class="op" id="4130585">]</span><span class="op" id="4130586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130589">s</span><span class="op" id="4130590">.</span><span class="ident" id="4130591">h</span><span class="op" id="4130592">.</span><span class="ident" id="4130593">Write</span><span class="op" id="4130598">(</span><span class="ident" id="4130599">header</span><span class="op" id="4130605">[</span><span class="num" id="4130606">3</span><span class="op" id="4130607">:</span><span class="num" id="4130608">5</span><span class="op" id="4130609">]</span><span class="op" id="4130610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130613">s</span><span class="op" id="4130614">.</span><span class="ident" id="4130615">h</span><span class="op" id="4130616">.</span><span class="ident" id="4130617">Write</span><span class="op" id="4130622">(</span><span class="ident" id="4130623">data</span><span class="op" id="4130627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130630">digestBuf</span>&nbsp;<span class="op" id="4130640">=</span>&nbsp;<span class="ident" id="4130642">s</span><span class="op" id="4130643">.</span><span class="ident" id="4130644">h</span><span class="op" id="4130645">.</span><span class="ident" id="4130646">Sum</span><span class="op" id="4130649">(</span><span class="ident" id="4130650">digestBuf</span><span class="op" id="4130659">[</span><span class="op" id="4130660">:</span><span class="num" id="4130661">0</span><span class="op" id="4130662">]</span><span class="op" id="4130663">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130667">s</span><span class="op" id="4130668">.</span><span class="ident" id="4130669">h</span><span class="op" id="4130670">.</span><span class="ident" id="4130671">Reset</span><span class="op" id="4130676">(</span><span class="op" id="4130677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130680">s</span><span class="op" id="4130681">.</span><span class="ident" id="4130682">h</span><span class="op" id="4130683">.</span><span class="ident" id="4130684">Write</span><span class="op" id="4130689">(</span><span class="ident" id="4130690">s</span><span class="op" id="4130691">.</span><span class="ident" id="4130692">key</span><span class="op" id="4130695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130698">s</span><span class="op" id="4130699">.</span><span class="ident" id="4130700">h</span><span class="op" id="4130701">.</span><span class="ident" id="4130702">Write</span><span class="op" id="4130707">(</span><span class="ident" id="4130708">ssl30Pad2</span><span class="op" id="4130717">[</span><span class="op" id="4130718">:</span><span class="ident" id="4130719">padLength</span><span class="op" id="4130728">]</span><span class="op" id="4130729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130732">s</span><span class="op" id="4130733">.</span><span class="ident" id="4130734">h</span><span class="op" id="4130735">.</span><span class="ident" id="4130736">Write</span><span class="op" id="4130741">(</span><span class="ident" id="4130742">digestBuf</span><span class="op" id="4130751">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130754">return</span>&nbsp;<span class="ident" id="4130761">s</span><span class="op" id="4130762">.</span><span class="ident" id="4130763">h</span><span class="op" id="4130764">.</span><span class="ident" id="4130765">Sum</span><span class="op" id="4130768">(</span><span class="ident" id="4130769">digestBuf</span><span class="op" id="4130778">[</span><span class="op" id="4130779">:</span><span class="num" id="4130780">0</span><span class="op" id="4130781">]</span><span class="op" id="4130782">)</span><br>
<span class="lineno"></span><span class="op" id="4130784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4130787">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4130861">type</span>&nbsp;<span class="ident" id="4130866">tls10MAC</span>&nbsp;<span class="keyword" id="4130875">struct</span>&nbsp;<span class="op" id="4130882">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130885">h</span>&nbsp;<span class="ident" id="4130887">hash</span><span class="op" id="4130891">.</span><span class="ident" id="4130892">Hash</span><br>
<span class="lineno"></span><span class="op" id="4130897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4130900">func</span>&nbsp;<span class="op" id="4130905">(</span><span class="ident" id="4130906">s</span>&nbsp;<span class="ident" id="4130908">tls10MAC</span><span class="op" id="4130916">)</span>&nbsp;<span class="ident" id="4130918">Size</span><span class="op" id="4130922">(</span><span class="op" id="4130923">)</span>&nbsp;<span class="builtintype" id="4130925">int</span>&nbsp;<span class="op" id="4130929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130932">return</span>&nbsp;<span class="ident" id="4130939">s</span><span class="op" id="4130940">.</span><span class="ident" id="4130941">h</span><span class="op" id="4130942">.</span><span class="ident" id="4130943">Size</span><span class="op" id="4130947">(</span><span class="op" id="4130948">)</span><br>
<span class="lineno">210</span><span class="op" id="4130950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4130953">func</span>&nbsp;<span class="op" id="4130958">(</span><span class="ident" id="4130959">s</span>&nbsp;<span class="ident" id="4130961">tls10MAC</span><span class="op" id="4130969">)</span>&nbsp;<span class="ident" id="4130971">MAC</span><span class="op" id="4130974">(</span><span class="ident" id="4130975">digestBuf</span><span class="op" id="4130984">,</span>&nbsp;<span class="ident" id="4130986">seq</span><span class="op" id="4130989">,</span>&nbsp;<span class="ident" id="4130991">header</span><span class="op" id="4130997">,</span>&nbsp;<span class="ident" id="4130999">data</span>&nbsp;<span class="op" id="4131004">[</span><span class="op" id="4131005">]</span><span class="builtintype" id="4131006">byte</span><span class="op" id="4131010">)</span>&nbsp;<span class="op" id="4131012">[</span><span class="op" id="4131013">]</span><span class="builtintype" id="4131014">byte</span>&nbsp;<span class="op" id="4131019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131022">s</span><span class="op" id="4131023">.</span><span class="ident" id="4131024">h</span><span class="op" id="4131025">.</span><span class="ident" id="4131026">Reset</span><span class="op" id="4131031">(</span><span class="op" id="4131032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131035">s</span><span class="op" id="4131036">.</span><span class="ident" id="4131037">h</span><span class="op" id="4131038">.</span><span class="ident" id="4131039">Write</span><span class="op" id="4131044">(</span><span class="ident" id="4131045">seq</span><span class="op" id="4131048">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131051">s</span><span class="op" id="4131052">.</span><span class="ident" id="4131053">h</span><span class="op" id="4131054">.</span><span class="ident" id="4131055">Write</span><span class="op" id="4131060">(</span><span class="ident" id="4131061">header</span><span class="op" id="4131067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131070">s</span><span class="op" id="4131071">.</span><span class="ident" id="4131072">h</span><span class="op" id="4131073">.</span><span class="ident" id="4131074">Write</span><span class="op" id="4131079">(</span><span class="ident" id="4131080">data</span><span class="op" id="4131084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131087">return</span>&nbsp;<span class="ident" id="4131094">s</span><span class="op" id="4131095">.</span><span class="ident" id="4131096">h</span><span class="op" id="4131097">.</span><span class="ident" id="4131098">Sum</span><span class="op" id="4131101">(</span><span class="ident" id="4131102">digestBuf</span><span class="op" id="4131111">[</span><span class="op" id="4131112">:</span><span class="num" id="4131113">0</span><span class="op" id="4131114">]</span><span class="op" id="4131115">)</span><br>
<span class="lineno"></span><span class="op" id="4131117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4131120">func</span>&nbsp;<span class="ident" id="4131125">rsaKA</span><span class="op" id="4131130">(</span><span class="ident" id="4131131">version</span>&nbsp;<span class="builtintype" id="4131139">uint16</span><span class="op" id="4131145">)</span>&nbsp;<span class="ident" id="4131147">keyAgreement</span>&nbsp;<span class="op" id="4131160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131163">return</span>&nbsp;<span class="ident" id="4131170">rsaKeyAgreement</span><span class="op" id="4131185">{</span><span class="op" id="4131186">}</span><br>
<span class="lineno"></span><span class="op" id="4131188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4131191">func</span>&nbsp;<span class="ident" id="4131196">ecdheECDSAKA</span><span class="op" id="4131208">(</span><span class="ident" id="4131209">version</span>&nbsp;<span class="builtintype" id="4131217">uint16</span><span class="op" id="4131223">)</span>&nbsp;<span class="ident" id="4131225">keyAgreement</span>&nbsp;<span class="op" id="4131238">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131241">return</span>&nbsp;<span class="op" id="4131248">&amp;</span><span class="ident" id="4131249">ecdheKeyAgreement</span><span class="op" id="4131266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131270">sigType</span><span class="op" id="4131277">:</span>&nbsp;<span class="ident" id="4131279">signatureECDSA</span><span class="op" id="4131293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131297">version</span><span class="op" id="4131304">:</span>&nbsp;<span class="ident" id="4131306">version</span><span class="op" id="4131313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131316">}</span><br>
<span class="lineno"></span><span class="op" id="4131318">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4131321">func</span>&nbsp;<span class="ident" id="4131326">ecdheRSAKA</span><span class="op" id="4131336">(</span><span class="ident" id="4131337">version</span>&nbsp;<span class="builtintype" id="4131345">uint16</span><span class="op" id="4131351">)</span>&nbsp;<span class="ident" id="4131353">keyAgreement</span>&nbsp;<span class="op" id="4131366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131369">return</span>&nbsp;<span class="op" id="4131376">&amp;</span><span class="ident" id="4131377">ecdheKeyAgreement</span><span class="op" id="4131394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131398">sigType</span><span class="op" id="4131405">:</span>&nbsp;<span class="ident" id="4131407">signatureRSA</span><span class="op" id="4131419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131423">version</span><span class="op" id="4131430">:</span>&nbsp;<span class="ident" id="4131432">version</span><span class="op" id="4131439">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131442">}</span><br>
<span class="lineno"></span><span class="op" id="4131444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4131447">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4131516">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4131566">func</span>&nbsp;<span class="ident" id="4131571">mutualCipherSuite</span><span class="op" id="4131588">(</span><span class="ident" id="4131589">have</span>&nbsp;<span class="op" id="4131594">[</span><span class="op" id="4131595">]</span><span class="builtintype" id="4131596">uint16</span><span class="op" id="4131602">,</span>&nbsp;<span class="ident" id="4131604">want</span>&nbsp;<span class="builtintype" id="4131609">uint16</span><span class="op" id="4131615">)</span>&nbsp;<span class="op" id="4131617">*</span><span class="ident" id="4131618">cipherSuite</span>&nbsp;<span class="op" id="4131630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131633">for</span>&nbsp;<span class="ident" id="4131637">_</span><span class="op" id="4131638">,</span>&nbsp;<span class="ident" id="4131640">id</span>&nbsp;<span class="op" id="4131643">:=</span>&nbsp;<span class="keyword" id="4131646">range</span>&nbsp;<span class="ident" id="4131652">have</span>&nbsp;<span class="op" id="4131657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131661">if</span>&nbsp;<span class="ident" id="4131664">id</span>&nbsp;<span class="op" id="4131667">==</span>&nbsp;<span class="ident" id="4131670">want</span>&nbsp;<span class="op" id="4131675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131680">for</span>&nbsp;<span class="ident" id="4131684">_</span><span class="op" id="4131685">,</span>&nbsp;<span class="ident" id="4131687">suite</span>&nbsp;<span class="op" id="4131693">:=</span>&nbsp;<span class="keyword" id="4131696">range</span>&nbsp;<span class="ident" id="4131702">cipherSuites</span>&nbsp;<span class="op" id="4131715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131721">if</span>&nbsp;<span class="ident" id="4131724">suite</span><span class="op" id="4131729">.</span><span class="ident" id="4131730">id</span>&nbsp;<span class="op" id="4131733">==</span>&nbsp;<span class="ident" id="4131736">want</span>&nbsp;<span class="op" id="4131741">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131748">return</span>&nbsp;<span class="ident" id="4131755">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131775">return</span>&nbsp;<span class="ident" id="4131782">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131788">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131794">return</span>&nbsp;<span class="ident" id="4131801">nil</span><br>
<span class="lineno"></span><span class="op" id="4131805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4131808">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4131863">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4131932">const</span>&nbsp;<span class="op" id="4131938">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131941">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4131981">uint16</span>&nbsp;<span class="op" id="4131988">=</span>&nbsp;<span class="num" id="4131990">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131998">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132038">uint16</span>&nbsp;<span class="op" id="4132045">=</span>&nbsp;<span class="num" id="4132047">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132055">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132095">uint16</span>&nbsp;<span class="op" id="4132102">=</span>&nbsp;<span class="num" id="4132104">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132112">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132152">uint16</span>&nbsp;<span class="op" id="4132159">=</span>&nbsp;<span class="num" id="4132161">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132169">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132209">uint16</span>&nbsp;<span class="op" id="4132216">=</span>&nbsp;<span class="num" id="4132218">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132226">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132266">uint16</span>&nbsp;<span class="op" id="4132273">=</span>&nbsp;<span class="num" id="4132275">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132283">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132323">uint16</span>&nbsp;<span class="op" id="4132330">=</span>&nbsp;<span class="num" id="4132332">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132340">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132380">uint16</span>&nbsp;<span class="op" id="4132387">=</span>&nbsp;<span class="num" id="4132389">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132397">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132437">uint16</span>&nbsp;<span class="op" id="4132444">=</span>&nbsp;<span class="num" id="4132446">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132454">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132494">uint16</span>&nbsp;<span class="op" id="4132501">=</span>&nbsp;<span class="num" id="4132503">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132511">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132551">uint16</span>&nbsp;<span class="op" id="4132558">=</span>&nbsp;<span class="num" id="4132560">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132568">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132608">uint16</span>&nbsp;<span class="op" id="4132615">=</span>&nbsp;<span class="num" id="4132617">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132625">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4132665">uint16</span>&nbsp;<span class="op" id="4132672">=</span>&nbsp;<span class="num" id="4132674">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132683">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132752">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132803">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132869">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4132887">uint16</span>&nbsp;<span class="op" id="4132894">=</span>&nbsp;<span class="num" id="4132896">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4132903">)</span>
</div>
</body>
</html>
