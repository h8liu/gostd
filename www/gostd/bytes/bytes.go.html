<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bytes</h2>
<ul>
<li><a href="/gostd/bytes/buffer.go.html">buffer.go</a></li>
<li><a href="/gostd/bytes/buffer_test.go.html">buffer_test.go</a></li>
<li><a href="/gostd/bytes/bytes.go.html" class="current">bytes.go</a></li>
<li><a href="/gostd/bytes/bytes_decl.go.html">bytes_decl.go</a></li>
<li><a href="/gostd/bytes/bytes_test.go.html">bytes_test.go</a></li>
<li><a href="/gostd/bytes/compare_test.go.html">compare_test.go</a></li>
<li><a href="/gostd/bytes/equal_test.go.html">equal_test.go</a></li>
<li><a href="/gostd/bytes/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bytes/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bytes/reader.go.html">reader.go</a></li>
<li><a href="/gostd/bytes/reader_test.go.html">reader_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1342674">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1342729">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1342783">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1342834">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="1342909">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="1342970">package</span>&nbsp;<span class="ident" id="1342978">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1342985">import</span>&nbsp;<span class="op" id="1342992">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1342995">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1343006">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1343021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1343024">func</span>&nbsp;<span class="ident" id="1343029">equalPortable</span><span class="op" id="1343042">(</span><span class="ident" id="1343043">a</span><span class="op" id="1343044">,</span>&nbsp;<span class="ident" id="1343046">b</span>&nbsp;<span class="op" id="1343048">[</span><span class="op" id="1343049">]</span><span class="builtintype" id="1343050">byte</span><span class="op" id="1343054">)</span>&nbsp;<span class="builtintype" id="1343056">bool</span>&nbsp;<span class="op" id="1343061">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343064">if</span>&nbsp;<span class="builtinfunc" id="1343067">len</span><span class="op" id="1343070">(</span><span class="ident" id="1343071">a</span><span class="op" id="1343072">)</span>&nbsp;<span class="op" id="1343074">!=</span>&nbsp;<span class="builtinfunc" id="1343077">len</span><span class="op" id="1343080">(</span><span class="ident" id="1343081">b</span><span class="op" id="1343082">)</span>&nbsp;<span class="op" id="1343084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343088">return</span>&nbsp;<span class="builtintype" id="1343095">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343105">for</span>&nbsp;<span class="ident" id="1343109">i</span><span class="op" id="1343110">,</span>&nbsp;<span class="ident" id="1343112">c</span>&nbsp;<span class="op" id="1343114">:=</span>&nbsp;<span class="keyword" id="1343117">range</span>&nbsp;<span class="ident" id="1343123">a</span>&nbsp;<span class="op" id="1343125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343129">if</span>&nbsp;<span class="ident" id="1343132">c</span>&nbsp;<span class="op" id="1343134">!=</span>&nbsp;<span class="ident" id="1343137">b</span><span class="op" id="1343138">[</span><span class="ident" id="1343139">i</span><span class="op" id="1343140">]</span>&nbsp;<span class="op" id="1343142">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343147">return</span>&nbsp;<span class="builtintype" id="1343154">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343168">return</span>&nbsp;<span class="builtintype" id="1343175">true</span><br>
<span class="lineno"></span><span class="op" id="1343180">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1343183">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="1343287">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1343383">func</span>&nbsp;<span class="ident" id="1343388">explode</span><span class="op" id="1343395">(</span><span class="ident" id="1343396">s</span>&nbsp;<span class="op" id="1343398">[</span><span class="op" id="1343399">]</span><span class="builtintype" id="1343400">byte</span><span class="op" id="1343404">,</span>&nbsp;<span class="ident" id="1343406">n</span>&nbsp;<span class="builtintype" id="1343408">int</span><span class="op" id="1343411">)</span>&nbsp;<span class="op" id="1343413">[</span><span class="op" id="1343414">]</span><span class="op" id="1343415">[</span><span class="op" id="1343416">]</span><span class="builtintype" id="1343417">byte</span>&nbsp;<span class="op" id="1343422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343425">if</span>&nbsp;<span class="ident" id="1343428">n</span>&nbsp;<span class="op" id="1343430">&lt;=</span>&nbsp;<span class="num" id="1343433">0</span>&nbsp;<span class="op" id="1343435">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343439">n</span>&nbsp;<span class="op" id="1343441">=</span>&nbsp;<span class="builtinfunc" id="1343443">len</span><span class="op" id="1343446">(</span><span class="ident" id="1343447">s</span><span class="op" id="1343448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343454">a</span>&nbsp;<span class="op" id="1343456">:=</span>&nbsp;<span class="builtinfunc" id="1343459">make</span><span class="op" id="1343463">(</span><span class="op" id="1343464">[</span><span class="op" id="1343465">]</span><span class="op" id="1343466">[</span><span class="op" id="1343467">]</span><span class="builtintype" id="1343468">byte</span><span class="op" id="1343472">,</span>&nbsp;<span class="ident" id="1343474">n</span><span class="op" id="1343475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343478">var</span>&nbsp;<span class="ident" id="1343482">size</span>&nbsp;<span class="builtintype" id="1343487">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343492">na</span>&nbsp;<span class="op" id="1343495">:=</span>&nbsp;<span class="num" id="1343498">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343501">for</span>&nbsp;<span class="builtinfunc" id="1343505">len</span><span class="op" id="1343508">(</span><span class="ident" id="1343509">s</span><span class="op" id="1343510">)</span>&nbsp;<span class="op" id="1343512">&gt;</span>&nbsp;<span class="num" id="1343514">0</span>&nbsp;<span class="op" id="1343516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343520">if</span>&nbsp;<span class="ident" id="1343523">na</span><span class="op" id="1343525">+</span><span class="num" id="1343526">1</span>&nbsp;<span class="op" id="1343528">&gt;=</span>&nbsp;<span class="ident" id="1343531">n</span>&nbsp;<span class="op" id="1343533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343538">a</span><span class="op" id="1343539">[</span><span class="ident" id="1343540">na</span><span class="op" id="1343542">]</span>&nbsp;<span class="op" id="1343544">=</span>&nbsp;<span class="ident" id="1343546">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343551">na</span><span class="op" id="1343553">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343559">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343571">_</span><span class="op" id="1343572">,</span>&nbsp;<span class="ident" id="1343574">size</span>&nbsp;<span class="op" id="1343579">=</span>&nbsp;<span class="ident" id="1343581">utf8</span><span class="op" id="1343585">.</span><span class="ident" id="1343586">DecodeRune</span><span class="op" id="1343596">(</span><span class="ident" id="1343597">s</span><span class="op" id="1343598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343602">a</span><span class="op" id="1343603">[</span><span class="ident" id="1343604">na</span><span class="op" id="1343606">]</span>&nbsp;<span class="op" id="1343608">=</span>&nbsp;<span class="ident" id="1343610">s</span><span class="op" id="1343611">[</span><span class="num" id="1343612">0</span><span class="op" id="1343613">:</span><span class="ident" id="1343614">size</span><span class="op" id="1343618">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343622">s</span>&nbsp;<span class="op" id="1343624">=</span>&nbsp;<span class="ident" id="1343626">s</span><span class="op" id="1343627">[</span><span class="ident" id="1343628">size</span><span class="op" id="1343632">:</span><span class="op" id="1343633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343637">na</span><span class="op" id="1343639">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343646">return</span>&nbsp;<span class="ident" id="1343653">a</span><span class="op" id="1343654">[</span><span class="num" id="1343655">0</span><span class="op" id="1343656">:</span><span class="ident" id="1343657">na</span><span class="op" id="1343659">]</span><br>
<span class="lineno"></span><span class="op" id="1343661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343664">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="1343733">func</span>&nbsp;<span class="ident" id="1343738">Count</span><span class="op" id="1343743">(</span><span class="ident" id="1343744">s</span><span class="op" id="1343745">,</span>&nbsp;<span class="ident" id="1343747">sep</span>&nbsp;<span class="op" id="1343751">[</span><span class="op" id="1343752">]</span><span class="builtintype" id="1343753">byte</span><span class="op" id="1343757">)</span>&nbsp;<span class="builtintype" id="1343759">int</span>&nbsp;<span class="op" id="1343763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343766">n</span>&nbsp;<span class="op" id="1343768">:=</span>&nbsp;<span class="builtinfunc" id="1343771">len</span><span class="op" id="1343774">(</span><span class="ident" id="1343775">sep</span><span class="op" id="1343778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343781">if</span>&nbsp;<span class="ident" id="1343784">n</span>&nbsp;<span class="op" id="1343786">==</span>&nbsp;<span class="num" id="1343789">0</span>&nbsp;<span class="op" id="1343791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343795">return</span>&nbsp;<span class="ident" id="1343802">utf8</span><span class="op" id="1343806">.</span><span class="ident" id="1343807">RuneCount</span><span class="op" id="1343816">(</span><span class="ident" id="1343817">s</span><span class="op" id="1343818">)</span>&nbsp;<span class="op" id="1343820">+</span>&nbsp;<span class="num" id="1343822">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343825">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343828">if</span>&nbsp;<span class="ident" id="1343831">n</span>&nbsp;<span class="op" id="1343833">&gt;</span>&nbsp;<span class="builtinfunc" id="1343835">len</span><span class="op" id="1343838">(</span><span class="ident" id="1343839">s</span><span class="op" id="1343840">)</span>&nbsp;<span class="op" id="1343842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343846">return</span>&nbsp;<span class="num" id="1343853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1343856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343859">count</span>&nbsp;<span class="op" id="1343865">:=</span>&nbsp;<span class="num" id="1343868">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343871">c</span>&nbsp;<span class="op" id="1343873">:=</span>&nbsp;<span class="ident" id="1343876">sep</span><span class="op" id="1343879">[</span><span class="num" id="1343880">0</span><span class="op" id="1343881">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343884">i</span>&nbsp;<span class="op" id="1343886">:=</span>&nbsp;<span class="num" id="1343889">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343892">t</span>&nbsp;<span class="op" id="1343894">:=</span>&nbsp;<span class="ident" id="1343897">s</span><span class="op" id="1343898">[</span><span class="op" id="1343899">:</span><span class="builtinfunc" id="1343900">len</span><span class="op" id="1343903">(</span><span class="ident" id="1343904">s</span><span class="op" id="1343905">)</span><span class="op" id="1343906">-</span><span class="ident" id="1343907">n</span><span class="op" id="1343908">+</span><span class="num" id="1343909">1</span><span class="op" id="1343910">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343913">for</span>&nbsp;<span class="ident" id="1343917">i</span>&nbsp;<span class="op" id="1343919">&lt;</span>&nbsp;<span class="builtinfunc" id="1343921">len</span><span class="op" id="1343924">(</span><span class="ident" id="1343925">t</span><span class="op" id="1343926">)</span>&nbsp;<span class="op" id="1343928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343932">if</span>&nbsp;<span class="ident" id="1343935">t</span><span class="op" id="1343936">[</span><span class="ident" id="1343937">i</span><span class="op" id="1343938">]</span>&nbsp;<span class="op" id="1343940">!=</span>&nbsp;<span class="ident" id="1343943">c</span>&nbsp;<span class="op" id="1343945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1343950">o</span>&nbsp;<span class="op" id="1343952">:=</span>&nbsp;<span class="ident" id="1343955">IndexByte</span><span class="op" id="1343964">(</span><span class="ident" id="1343965">t</span><span class="op" id="1343966">[</span><span class="ident" id="1343967">i</span><span class="op" id="1343968">:</span><span class="op" id="1343969">]</span><span class="op" id="1343970">,</span>&nbsp;<span class="ident" id="1343972">c</span><span class="op" id="1343973">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343978">if</span>&nbsp;<span class="ident" id="1343981">o</span>&nbsp;<span class="op" id="1343983">&lt;</span>&nbsp;<span class="num" id="1343985">0</span>&nbsp;<span class="op" id="1343987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1343993">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344007">i</span>&nbsp;<span class="op" id="1344009">+=</span>&nbsp;<span class="ident" id="1344012">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344016">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344020">if</span>&nbsp;<span class="ident" id="1344023">n</span>&nbsp;<span class="op" id="1344025">==</span>&nbsp;<span class="num" id="1344028">1</span>&nbsp;<span class="op" id="1344030">||</span>&nbsp;<span class="ident" id="1344033">Equal</span><span class="op" id="1344038">(</span><span class="ident" id="1344039">s</span><span class="op" id="1344040">[</span><span class="ident" id="1344041">i</span><span class="op" id="1344042">:</span><span class="ident" id="1344043">i</span><span class="op" id="1344044">+</span><span class="ident" id="1344045">n</span><span class="op" id="1344046">]</span><span class="op" id="1344047">,</span>&nbsp;<span class="ident" id="1344049">sep</span><span class="op" id="1344052">)</span>&nbsp;<span class="op" id="1344054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344059">count</span><span class="op" id="1344064">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344070">i</span>&nbsp;<span class="op" id="1344072">+=</span>&nbsp;<span class="ident" id="1344075">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344080">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344091">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344095">i</span><span class="op" id="1344096">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344103">return</span>&nbsp;<span class="ident" id="1344110">count</span><br>
<span class="lineno"></span><span class="op" id="1344116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1344119">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="1344169">func</span>&nbsp;<span class="ident" id="1344174">Contains</span><span class="op" id="1344182">(</span><span class="ident" id="1344183">b</span><span class="op" id="1344184">,</span>&nbsp;<span class="ident" id="1344186">subslice</span>&nbsp;<span class="op" id="1344195">[</span><span class="op" id="1344196">]</span><span class="builtintype" id="1344197">byte</span><span class="op" id="1344201">)</span>&nbsp;<span class="builtintype" id="1344203">bool</span>&nbsp;<span class="op" id="1344208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344211">return</span>&nbsp;<span class="ident" id="1344218">Index</span><span class="op" id="1344223">(</span><span class="ident" id="1344224">b</span><span class="op" id="1344225">,</span>&nbsp;<span class="ident" id="1344227">subslice</span><span class="op" id="1344235">)</span>&nbsp;<span class="op" id="1344237">!=</span>&nbsp;<span class="op" id="1344240">-</span><span class="num" id="1344241">1</span><br>
<span class="lineno"></span><span class="op" id="1344243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1344246">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1344342">func</span>&nbsp;<span class="ident" id="1344347">Index</span><span class="op" id="1344352">(</span><span class="ident" id="1344353">s</span><span class="op" id="1344354">,</span>&nbsp;<span class="ident" id="1344356">sep</span>&nbsp;<span class="op" id="1344360">[</span><span class="op" id="1344361">]</span><span class="builtintype" id="1344362">byte</span><span class="op" id="1344366">)</span>&nbsp;<span class="builtintype" id="1344368">int</span>&nbsp;<span class="op" id="1344372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344375">n</span>&nbsp;<span class="op" id="1344377">:=</span>&nbsp;<span class="builtinfunc" id="1344380">len</span><span class="op" id="1344383">(</span><span class="ident" id="1344384">sep</span><span class="op" id="1344387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344390">if</span>&nbsp;<span class="ident" id="1344393">n</span>&nbsp;<span class="op" id="1344395">==</span>&nbsp;<span class="num" id="1344398">0</span>&nbsp;<span class="op" id="1344400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344404">return</span>&nbsp;<span class="num" id="1344411">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344417">if</span>&nbsp;<span class="ident" id="1344420">n</span>&nbsp;<span class="op" id="1344422">&gt;</span>&nbsp;<span class="builtinfunc" id="1344424">len</span><span class="op" id="1344427">(</span><span class="ident" id="1344428">s</span><span class="op" id="1344429">)</span>&nbsp;<span class="op" id="1344431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344435">return</span>&nbsp;<span class="op" id="1344442">-</span><span class="num" id="1344443">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344449">c</span>&nbsp;<span class="op" id="1344451">:=</span>&nbsp;<span class="ident" id="1344454">sep</span><span class="op" id="1344457">[</span><span class="num" id="1344458">0</span><span class="op" id="1344459">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344462">if</span>&nbsp;<span class="ident" id="1344465">n</span>&nbsp;<span class="op" id="1344467">==</span>&nbsp;<span class="num" id="1344470">1</span>&nbsp;<span class="op" id="1344472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344476">return</span>&nbsp;<span class="ident" id="1344483">IndexByte</span><span class="op" id="1344492">(</span><span class="ident" id="1344493">s</span><span class="op" id="1344494">,</span>&nbsp;<span class="ident" id="1344496">c</span><span class="op" id="1344497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344503">i</span>&nbsp;<span class="op" id="1344505">:=</span>&nbsp;<span class="num" id="1344508">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344511">t</span>&nbsp;<span class="op" id="1344513">:=</span>&nbsp;<span class="ident" id="1344516">s</span><span class="op" id="1344517">[</span><span class="op" id="1344518">:</span><span class="builtinfunc" id="1344519">len</span><span class="op" id="1344522">(</span><span class="ident" id="1344523">s</span><span class="op" id="1344524">)</span><span class="op" id="1344525">-</span><span class="ident" id="1344526">n</span><span class="op" id="1344527">+</span><span class="num" id="1344528">1</span><span class="op" id="1344529">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344532">for</span>&nbsp;<span class="ident" id="1344536">i</span>&nbsp;<span class="op" id="1344538">&lt;</span>&nbsp;<span class="builtinfunc" id="1344540">len</span><span class="op" id="1344543">(</span><span class="ident" id="1344544">t</span><span class="op" id="1344545">)</span>&nbsp;<span class="op" id="1344547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344551">if</span>&nbsp;<span class="ident" id="1344554">t</span><span class="op" id="1344555">[</span><span class="ident" id="1344556">i</span><span class="op" id="1344557">]</span>&nbsp;<span class="op" id="1344559">!=</span>&nbsp;<span class="ident" id="1344562">c</span>&nbsp;<span class="op" id="1344564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344569">o</span>&nbsp;<span class="op" id="1344571">:=</span>&nbsp;<span class="ident" id="1344574">IndexByte</span><span class="op" id="1344583">(</span><span class="ident" id="1344584">t</span><span class="op" id="1344585">[</span><span class="ident" id="1344586">i</span><span class="op" id="1344587">:</span><span class="op" id="1344588">]</span><span class="op" id="1344589">,</span>&nbsp;<span class="ident" id="1344591">c</span><span class="op" id="1344592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344597">if</span>&nbsp;<span class="ident" id="1344600">o</span>&nbsp;<span class="op" id="1344602">&lt;</span>&nbsp;<span class="num" id="1344604">0</span>&nbsp;<span class="op" id="1344606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344612">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344626">i</span>&nbsp;<span class="op" id="1344628">+=</span>&nbsp;<span class="ident" id="1344631">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344639">if</span>&nbsp;<span class="ident" id="1344642">Equal</span><span class="op" id="1344647">(</span><span class="ident" id="1344648">s</span><span class="op" id="1344649">[</span><span class="ident" id="1344650">i</span><span class="op" id="1344651">:</span><span class="ident" id="1344652">i</span><span class="op" id="1344653">+</span><span class="ident" id="1344654">n</span><span class="op" id="1344655">]</span><span class="op" id="1344656">,</span>&nbsp;<span class="ident" id="1344658">sep</span><span class="op" id="1344661">)</span>&nbsp;<span class="op" id="1344663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344668">return</span>&nbsp;<span class="ident" id="1344675">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344683">i</span><span class="op" id="1344684">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344691">return</span>&nbsp;<span class="op" id="1344698">-</span><span class="num" id="1344699">1</span><br>
<span class="lineno"></span><span class="op" id="1344701">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="1344704">func</span>&nbsp;<span class="ident" id="1344709">indexBytePortable</span><span class="op" id="1344726">(</span><span class="ident" id="1344727">s</span>&nbsp;<span class="op" id="1344729">[</span><span class="op" id="1344730">]</span><span class="builtintype" id="1344731">byte</span><span class="op" id="1344735">,</span>&nbsp;<span class="ident" id="1344737">c</span>&nbsp;<span class="builtintype" id="1344739">byte</span><span class="op" id="1344743">)</span>&nbsp;<span class="builtintype" id="1344745">int</span>&nbsp;<span class="op" id="1344749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344752">for</span>&nbsp;<span class="ident" id="1344756">i</span><span class="op" id="1344757">,</span>&nbsp;<span class="ident" id="1344759">b</span>&nbsp;<span class="op" id="1344761">:=</span>&nbsp;<span class="keyword" id="1344764">range</span>&nbsp;<span class="ident" id="1344770">s</span>&nbsp;<span class="op" id="1344772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344776">if</span>&nbsp;<span class="ident" id="1344779">b</span>&nbsp;<span class="op" id="1344781">==</span>&nbsp;<span class="ident" id="1344784">c</span>&nbsp;<span class="op" id="1344786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344791">return</span>&nbsp;<span class="ident" id="1344798">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1344805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344808">return</span>&nbsp;<span class="op" id="1344815">-</span><span class="num" id="1344816">1</span><br>
<span class="lineno"></span><span class="op" id="1344818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1344821">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1344920">func</span>&nbsp;<span class="ident" id="1344925">LastIndex</span><span class="op" id="1344934">(</span><span class="ident" id="1344935">s</span><span class="op" id="1344936">,</span>&nbsp;<span class="ident" id="1344938">sep</span>&nbsp;<span class="op" id="1344942">[</span><span class="op" id="1344943">]</span><span class="builtintype" id="1344944">byte</span><span class="op" id="1344948">)</span>&nbsp;<span class="builtintype" id="1344950">int</span>&nbsp;<span class="op" id="1344954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1344957">n</span>&nbsp;<span class="op" id="1344959">:=</span>&nbsp;<span class="builtinfunc" id="1344962">len</span><span class="op" id="1344965">(</span><span class="ident" id="1344966">sep</span><span class="op" id="1344969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344972">if</span>&nbsp;<span class="ident" id="1344975">n</span>&nbsp;<span class="op" id="1344977">==</span>&nbsp;<span class="num" id="1344980">0</span>&nbsp;<span class="op" id="1344982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1344986">return</span>&nbsp;<span class="builtinfunc" id="1344993">len</span><span class="op" id="1344996">(</span><span class="ident" id="1344997">s</span><span class="op" id="1344998">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345004">c</span>&nbsp;<span class="op" id="1345006">:=</span>&nbsp;<span class="ident" id="1345009">sep</span><span class="op" id="1345012">[</span><span class="num" id="1345013">0</span><span class="op" id="1345014">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345017">for</span>&nbsp;<span class="ident" id="1345021">i</span>&nbsp;<span class="op" id="1345023">:=</span>&nbsp;<span class="builtinfunc" id="1345026">len</span><span class="op" id="1345029">(</span><span class="ident" id="1345030">s</span><span class="op" id="1345031">)</span>&nbsp;<span class="op" id="1345033">-</span>&nbsp;<span class="ident" id="1345035">n</span><span class="op" id="1345036">;</span>&nbsp;<span class="ident" id="1345038">i</span>&nbsp;<span class="op" id="1345040">&gt;=</span>&nbsp;<span class="num" id="1345043">0</span><span class="op" id="1345044">;</span>&nbsp;<span class="ident" id="1345046">i</span><span class="op" id="1345047">--</span>&nbsp;<span class="op" id="1345050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345054">if</span>&nbsp;<span class="ident" id="1345057">s</span><span class="op" id="1345058">[</span><span class="ident" id="1345059">i</span><span class="op" id="1345060">]</span>&nbsp;<span class="op" id="1345062">==</span>&nbsp;<span class="ident" id="1345065">c</span>&nbsp;<span class="op" id="1345067">&amp;&amp;</span>&nbsp;<span class="op" id="1345070">(</span><span class="ident" id="1345071">n</span>&nbsp;<span class="op" id="1345073">==</span>&nbsp;<span class="num" id="1345076">1</span>&nbsp;<span class="op" id="1345078">||</span>&nbsp;<span class="ident" id="1345081">Equal</span><span class="op" id="1345086">(</span><span class="ident" id="1345087">s</span><span class="op" id="1345088">[</span><span class="ident" id="1345089">i</span><span class="op" id="1345090">:</span><span class="ident" id="1345091">i</span><span class="op" id="1345092">+</span><span class="ident" id="1345093">n</span><span class="op" id="1345094">]</span><span class="op" id="1345095">,</span>&nbsp;<span class="ident" id="1345097">sep</span><span class="op" id="1345100">)</span><span class="op" id="1345101">)</span>&nbsp;<span class="op" id="1345103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345108">return</span>&nbsp;<span class="ident" id="1345115">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345125">return</span>&nbsp;<span class="op" id="1345132">-</span><span class="num" id="1345133">1</span><br>
<span class="lineno"></span><span class="op" id="1345135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1345138">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1345216">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1345293">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1345339">func</span>&nbsp;<span class="ident" id="1345344">IndexRune</span><span class="op" id="1345353">(</span><span class="ident" id="1345354">s</span>&nbsp;<span class="op" id="1345356">[</span><span class="op" id="1345357">]</span><span class="builtintype" id="1345358">byte</span><span class="op" id="1345362">,</span>&nbsp;<span class="ident" id="1345364">r</span>&nbsp;<span class="builtintype" id="1345366">rune</span><span class="op" id="1345370">)</span>&nbsp;<span class="builtintype" id="1345372">int</span>&nbsp;<span class="op" id="1345376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345379">for</span>&nbsp;<span class="ident" id="1345383">i</span>&nbsp;<span class="op" id="1345385">:=</span>&nbsp;<span class="num" id="1345388">0</span><span class="op" id="1345389">;</span>&nbsp;<span class="ident" id="1345391">i</span>&nbsp;<span class="op" id="1345393">&lt;</span>&nbsp;<span class="builtinfunc" id="1345395">len</span><span class="op" id="1345398">(</span><span class="ident" id="1345399">s</span><span class="op" id="1345400">)</span><span class="op" id="1345401">;</span>&nbsp;<span class="op" id="1345403">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345407">r1</span><span class="op" id="1345409">,</span>&nbsp;<span class="ident" id="1345411">size</span>&nbsp;<span class="op" id="1345416">:=</span>&nbsp;<span class="ident" id="1345419">utf8</span><span class="op" id="1345423">.</span><span class="ident" id="1345424">DecodeRune</span><span class="op" id="1345434">(</span><span class="ident" id="1345435">s</span><span class="op" id="1345436">[</span><span class="ident" id="1345437">i</span><span class="op" id="1345438">:</span><span class="op" id="1345439">]</span><span class="op" id="1345440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345444">if</span>&nbsp;<span class="ident" id="1345447">r</span>&nbsp;<span class="op" id="1345449">==</span>&nbsp;<span class="ident" id="1345452">r1</span>&nbsp;<span class="op" id="1345455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345460">return</span>&nbsp;<span class="ident" id="1345467">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345475">i</span>&nbsp;<span class="op" id="1345477">+=</span>&nbsp;<span class="ident" id="1345480">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345489">return</span>&nbsp;<span class="op" id="1345496">-</span><span class="num" id="1345497">1</span><br>
<span class="lineno"></span><span class="op" id="1345499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1345502">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="1345579">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1345659">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="1345740">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1345760">func</span>&nbsp;<span class="ident" id="1345765">IndexAny</span><span class="op" id="1345773">(</span><span class="ident" id="1345774">s</span>&nbsp;<span class="op" id="1345776">[</span><span class="op" id="1345777">]</span><span class="builtintype" id="1345778">byte</span><span class="op" id="1345782">,</span>&nbsp;<span class="ident" id="1345784">chars</span>&nbsp;<span class="builtintype" id="1345790">string</span><span class="op" id="1345796">)</span>&nbsp;<span class="builtintype" id="1345798">int</span>&nbsp;<span class="op" id="1345802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345805">if</span>&nbsp;<span class="builtinfunc" id="1345808">len</span><span class="op" id="1345811">(</span><span class="ident" id="1345812">chars</span><span class="op" id="1345817">)</span>&nbsp;<span class="op" id="1345819">&gt;</span>&nbsp;<span class="num" id="1345821">0</span>&nbsp;<span class="op" id="1345823">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345827">var</span>&nbsp;<span class="ident" id="1345831">r</span>&nbsp;<span class="builtintype" id="1345833">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345840">var</span>&nbsp;<span class="ident" id="1345844">width</span>&nbsp;<span class="builtintype" id="1345850">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345856">for</span>&nbsp;<span class="ident" id="1345860">i</span>&nbsp;<span class="op" id="1345862">:=</span>&nbsp;<span class="num" id="1345865">0</span><span class="op" id="1345866">;</span>&nbsp;<span class="ident" id="1345868">i</span>&nbsp;<span class="op" id="1345870">&lt;</span>&nbsp;<span class="builtinfunc" id="1345872">len</span><span class="op" id="1345875">(</span><span class="ident" id="1345876">s</span><span class="op" id="1345877">)</span><span class="op" id="1345878">;</span>&nbsp;<span class="ident" id="1345880">i</span>&nbsp;<span class="op" id="1345882">+=</span>&nbsp;<span class="ident" id="1345885">width</span>&nbsp;<span class="op" id="1345891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345896">r</span>&nbsp;<span class="op" id="1345898">=</span>&nbsp;<span class="builtintype" id="1345900">rune</span><span class="op" id="1345904">(</span><span class="ident" id="1345905">s</span><span class="op" id="1345906">[</span><span class="ident" id="1345907">i</span><span class="op" id="1345908">]</span><span class="op" id="1345909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1345914">if</span>&nbsp;<span class="ident" id="1345917">r</span>&nbsp;<span class="op" id="1345919">&lt;</span>&nbsp;<span class="ident" id="1345921">utf8</span><span class="op" id="1345925">.</span><span class="ident" id="1345926">RuneSelf</span>&nbsp;<span class="op" id="1345935">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345941">width</span>&nbsp;<span class="op" id="1345947">=</span>&nbsp;<span class="num" id="1345949">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1345954">}</span>&nbsp;<span class="keyword" id="1345956">else</span>&nbsp;<span class="op" id="1345961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345967">r</span><span class="op" id="1345968">,</span>&nbsp;<span class="ident" id="1345970">width</span>&nbsp;<span class="op" id="1345976">=</span>&nbsp;<span class="ident" id="1345978">utf8</span><span class="op" id="1345982">.</span><span class="ident" id="1345983">DecodeRune</span><span class="op" id="1345993">(</span><span class="ident" id="1345994">s</span><span class="op" id="1345995">[</span><span class="ident" id="1345996">i</span><span class="op" id="1345997">:</span><span class="op" id="1345998">]</span><span class="op" id="1345999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346009">for</span>&nbsp;<span class="ident" id="1346013">_</span><span class="op" id="1346014">,</span>&nbsp;<span class="ident" id="1346016">ch</span>&nbsp;<span class="op" id="1346019">:=</span>&nbsp;<span class="keyword" id="1346022">range</span>&nbsp;<span class="ident" id="1346028">chars</span>&nbsp;<span class="op" id="1346034">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346040">if</span>&nbsp;<span class="ident" id="1346043">r</span>&nbsp;<span class="op" id="1346045">==</span>&nbsp;<span class="ident" id="1346048">ch</span>&nbsp;<span class="op" id="1346051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346058">return</span>&nbsp;<span class="ident" id="1346065">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346080">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346086">return</span>&nbsp;<span class="op" id="1346093">-</span><span class="num" id="1346094">1</span><br>
<span class="lineno"></span><span class="op" id="1346096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1346099">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="1346172">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1346248">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1346324">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1346361">func</span>&nbsp;<span class="ident" id="1346366">LastIndexAny</span><span class="op" id="1346378">(</span><span class="ident" id="1346379">s</span>&nbsp;<span class="op" id="1346381">[</span><span class="op" id="1346382">]</span><span class="builtintype" id="1346383">byte</span><span class="op" id="1346387">,</span>&nbsp;<span class="ident" id="1346389">chars</span>&nbsp;<span class="builtintype" id="1346395">string</span><span class="op" id="1346401">)</span>&nbsp;<span class="builtintype" id="1346403">int</span>&nbsp;<span class="op" id="1346407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346410">if</span>&nbsp;<span class="builtinfunc" id="1346413">len</span><span class="op" id="1346416">(</span><span class="ident" id="1346417">chars</span><span class="op" id="1346422">)</span>&nbsp;<span class="op" id="1346424">&gt;</span>&nbsp;<span class="num" id="1346426">0</span>&nbsp;<span class="op" id="1346428">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346432">for</span>&nbsp;<span class="ident" id="1346436">i</span>&nbsp;<span class="op" id="1346438">:=</span>&nbsp;<span class="builtinfunc" id="1346441">len</span><span class="op" id="1346444">(</span><span class="ident" id="1346445">s</span><span class="op" id="1346446">)</span><span class="op" id="1346447">;</span>&nbsp;<span class="ident" id="1346449">i</span>&nbsp;<span class="op" id="1346451">&gt;</span>&nbsp;<span class="num" id="1346453">0</span><span class="op" id="1346454">;</span>&nbsp;<span class="op" id="1346456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346461">r</span><span class="op" id="1346462">,</span>&nbsp;<span class="ident" id="1346464">size</span>&nbsp;<span class="op" id="1346469">:=</span>&nbsp;<span class="ident" id="1346472">utf8</span><span class="op" id="1346476">.</span><span class="ident" id="1346477">DecodeLastRune</span><span class="op" id="1346491">(</span><span class="ident" id="1346492">s</span><span class="op" id="1346493">[</span><span class="num" id="1346494">0</span><span class="op" id="1346495">:</span><span class="ident" id="1346496">i</span><span class="op" id="1346497">]</span><span class="op" id="1346498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346503">i</span>&nbsp;<span class="op" id="1346505">-=</span>&nbsp;<span class="ident" id="1346508">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346516">for</span>&nbsp;<span class="ident" id="1346520">_</span><span class="op" id="1346521">,</span>&nbsp;<span class="ident" id="1346523">ch</span>&nbsp;<span class="op" id="1346526">:=</span>&nbsp;<span class="keyword" id="1346529">range</span>&nbsp;<span class="ident" id="1346535">chars</span>&nbsp;<span class="op" id="1346541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346547">if</span>&nbsp;<span class="ident" id="1346550">r</span>&nbsp;<span class="op" id="1346552">==</span>&nbsp;<span class="ident" id="1346555">ch</span>&nbsp;<span class="op" id="1346558">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346565">return</span>&nbsp;<span class="ident" id="1346572">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346590">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346593">return</span>&nbsp;<span class="op" id="1346600">-</span><span class="num" id="1346601">1</span><br>
<span class="lineno"></span><span class="op" id="1346603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1346606">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="1346659">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="1346711">func</span>&nbsp;<span class="ident" id="1346716">genSplit</span><span class="op" id="1346724">(</span><span class="ident" id="1346725">s</span><span class="op" id="1346726">,</span>&nbsp;<span class="ident" id="1346728">sep</span>&nbsp;<span class="op" id="1346732">[</span><span class="op" id="1346733">]</span><span class="builtintype" id="1346734">byte</span><span class="op" id="1346738">,</span>&nbsp;<span class="ident" id="1346740">sepSave</span><span class="op" id="1346747">,</span>&nbsp;<span class="ident" id="1346749">n</span>&nbsp;<span class="builtintype" id="1346751">int</span><span class="op" id="1346754">)</span>&nbsp;<span class="op" id="1346756">[</span><span class="op" id="1346757">]</span><span class="op" id="1346758">[</span><span class="op" id="1346759">]</span><span class="builtintype" id="1346760">byte</span>&nbsp;<span class="op" id="1346765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346768">if</span>&nbsp;<span class="ident" id="1346771">n</span>&nbsp;<span class="op" id="1346773">==</span>&nbsp;<span class="num" id="1346776">0</span>&nbsp;<span class="op" id="1346778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346782">return</span>&nbsp;<span class="ident" id="1346789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346797">if</span>&nbsp;<span class="builtinfunc" id="1346800">len</span><span class="op" id="1346803">(</span><span class="ident" id="1346804">sep</span><span class="op" id="1346807">)</span>&nbsp;<span class="op" id="1346809">==</span>&nbsp;<span class="num" id="1346812">0</span>&nbsp;<span class="op" id="1346814">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346818">return</span>&nbsp;<span class="ident" id="1346825">explode</span><span class="op" id="1346832">(</span><span class="ident" id="1346833">s</span><span class="op" id="1346834">,</span>&nbsp;<span class="ident" id="1346836">n</span><span class="op" id="1346837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346843">if</span>&nbsp;<span class="ident" id="1346846">n</span>&nbsp;<span class="op" id="1346848">&lt;</span>&nbsp;<span class="num" id="1346850">0</span>&nbsp;<span class="op" id="1346852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346856">n</span>&nbsp;<span class="op" id="1346858">=</span>&nbsp;<span class="ident" id="1346860">Count</span><span class="op" id="1346865">(</span><span class="ident" id="1346866">s</span><span class="op" id="1346867">,</span>&nbsp;<span class="ident" id="1346869">sep</span><span class="op" id="1346872">)</span>&nbsp;<span class="op" id="1346874">+</span>&nbsp;<span class="num" id="1346876">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1346879">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346882">c</span>&nbsp;<span class="op" id="1346884">:=</span>&nbsp;<span class="ident" id="1346887">sep</span><span class="op" id="1346890">[</span><span class="num" id="1346891">0</span><span class="op" id="1346892">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346895">start</span>&nbsp;<span class="op" id="1346901">:=</span>&nbsp;<span class="num" id="1346904">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346907">a</span>&nbsp;<span class="op" id="1346909">:=</span>&nbsp;<span class="builtinfunc" id="1346912">make</span><span class="op" id="1346916">(</span><span class="op" id="1346917">[</span><span class="op" id="1346918">]</span><span class="op" id="1346919">[</span><span class="op" id="1346920">]</span><span class="builtintype" id="1346921">byte</span><span class="op" id="1346925">,</span>&nbsp;<span class="ident" id="1346927">n</span><span class="op" id="1346928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1346931">na</span>&nbsp;<span class="op" id="1346934">:=</span>&nbsp;<span class="num" id="1346937">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346940">for</span>&nbsp;<span class="ident" id="1346944">i</span>&nbsp;<span class="op" id="1346946">:=</span>&nbsp;<span class="num" id="1346949">0</span><span class="op" id="1346950">;</span>&nbsp;<span class="ident" id="1346952">i</span><span class="op" id="1346953">+</span><span class="builtinfunc" id="1346954">len</span><span class="op" id="1346957">(</span><span class="ident" id="1346958">sep</span><span class="op" id="1346961">)</span>&nbsp;<span class="op" id="1346963">&lt;=</span>&nbsp;<span class="builtinfunc" id="1346966">len</span><span class="op" id="1346969">(</span><span class="ident" id="1346970">s</span><span class="op" id="1346971">)</span>&nbsp;<span class="op" id="1346973">&amp;&amp;</span>&nbsp;<span class="ident" id="1346976">na</span><span class="op" id="1346978">+</span><span class="num" id="1346979">1</span>&nbsp;<span class="op" id="1346981">&lt;</span>&nbsp;<span class="ident" id="1346983">n</span><span class="op" id="1346984">;</span>&nbsp;<span class="ident" id="1346986">i</span><span class="op" id="1346987">++</span>&nbsp;<span class="op" id="1346990">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1346994">if</span>&nbsp;<span class="ident" id="1346997">s</span><span class="op" id="1346998">[</span><span class="ident" id="1346999">i</span><span class="op" id="1347000">]</span>&nbsp;<span class="op" id="1347002">==</span>&nbsp;<span class="ident" id="1347005">c</span>&nbsp;<span class="op" id="1347007">&amp;&amp;</span>&nbsp;<span class="op" id="1347010">(</span><span class="builtinfunc" id="1347011">len</span><span class="op" id="1347014">(</span><span class="ident" id="1347015">sep</span><span class="op" id="1347018">)</span>&nbsp;<span class="op" id="1347020">==</span>&nbsp;<span class="num" id="1347023">1</span>&nbsp;<span class="op" id="1347025">||</span>&nbsp;<span class="ident" id="1347028">Equal</span><span class="op" id="1347033">(</span><span class="ident" id="1347034">s</span><span class="op" id="1347035">[</span><span class="ident" id="1347036">i</span><span class="op" id="1347037">:</span><span class="ident" id="1347038">i</span><span class="op" id="1347039">+</span><span class="builtinfunc" id="1347040">len</span><span class="op" id="1347043">(</span><span class="ident" id="1347044">sep</span><span class="op" id="1347047">)</span><span class="op" id="1347048">]</span><span class="op" id="1347049">,</span>&nbsp;<span class="ident" id="1347051">sep</span><span class="op" id="1347054">)</span><span class="op" id="1347055">)</span>&nbsp;<span class="op" id="1347057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1347062">a</span><span class="op" id="1347063">[</span><span class="ident" id="1347064">na</span><span class="op" id="1347066">]</span>&nbsp;<span class="op" id="1347068">=</span>&nbsp;<span class="ident" id="1347070">s</span><span class="op" id="1347071">[</span><span class="ident" id="1347072">start</span>&nbsp;<span class="op" id="1347078">:</span>&nbsp;<span class="ident" id="1347080">i</span><span class="op" id="1347081">+</span><span class="ident" id="1347082">sepSave</span><span class="op" id="1347089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1347094">na</span><span class="op" id="1347096">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1347102">start</span>&nbsp;<span class="op" id="1347108">=</span>&nbsp;<span class="ident" id="1347110">i</span>&nbsp;<span class="op" id="1347112">+</span>&nbsp;<span class="builtinfunc" id="1347114">len</span><span class="op" id="1347117">(</span><span class="ident" id="1347118">sep</span><span class="op" id="1347121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1347126">i</span>&nbsp;<span class="op" id="1347128">+=</span>&nbsp;<span class="builtinfunc" id="1347131">len</span><span class="op" id="1347134">(</span><span class="ident" id="1347135">sep</span><span class="op" id="1347138">)</span>&nbsp;<span class="op" id="1347140">-</span>&nbsp;<span class="num" id="1347142">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1347146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1347149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1347152">a</span><span class="op" id="1347153">[</span><span class="ident" id="1347154">na</span><span class="op" id="1347156">]</span>&nbsp;<span class="op" id="1347158">=</span>&nbsp;<span class="ident" id="1347160">s</span><span class="op" id="1347161">[</span><span class="ident" id="1347162">start</span><span class="op" id="1347167">:</span><span class="op" id="1347168">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1347171">return</span>&nbsp;<span class="ident" id="1347178">a</span><span class="op" id="1347179">[</span><span class="num" id="1347180">0</span>&nbsp;<span class="op" id="1347182">:</span>&nbsp;<span class="ident" id="1347184">na</span><span class="op" id="1347186">+</span><span class="num" id="1347187">1</span><span class="op" id="1347188">]</span><br>
<span class="lineno"></span><span class="op" id="1347190">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="1347193">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1347267">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1347310">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1347371">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="1347430">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="1347512">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1347560">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1347586">func</span>&nbsp;<span class="ident" id="1347591">SplitN</span><span class="op" id="1347597">(</span><span class="ident" id="1347598">s</span><span class="op" id="1347599">,</span>&nbsp;<span class="ident" id="1347601">sep</span>&nbsp;<span class="op" id="1347605">[</span><span class="op" id="1347606">]</span><span class="builtintype" id="1347607">byte</span><span class="op" id="1347611">,</span>&nbsp;<span class="ident" id="1347613">n</span>&nbsp;<span class="builtintype" id="1347615">int</span><span class="op" id="1347618">)</span>&nbsp;<span class="op" id="1347620">[</span><span class="op" id="1347621">]</span><span class="op" id="1347622">[</span><span class="op" id="1347623">]</span><span class="builtintype" id="1347624">byte</span>&nbsp;<span class="op" id="1347629">{</span>&nbsp;<span class="keyword" id="1347631">return</span>&nbsp;<span class="ident" id="1347638">genSplit</span><span class="op" id="1347646">(</span><span class="ident" id="1347647">s</span><span class="op" id="1347648">,</span>&nbsp;<span class="ident" id="1347650">sep</span><span class="op" id="1347653">,</span>&nbsp;<span class="num" id="1347655">0</span><span class="op" id="1347656">,</span>&nbsp;<span class="ident" id="1347658">n</span><span class="op" id="1347659">)</span>&nbsp;<span class="op" id="1347661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="1347664">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1347734">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1347773">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1347839">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="1347898">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="1347980">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1348028">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1348054">func</span>&nbsp;<span class="ident" id="1348059">SplitAfterN</span><span class="op" id="1348070">(</span><span class="ident" id="1348071">s</span><span class="op" id="1348072">,</span>&nbsp;<span class="ident" id="1348074">sep</span>&nbsp;<span class="op" id="1348078">[</span><span class="op" id="1348079">]</span><span class="builtintype" id="1348080">byte</span><span class="op" id="1348084">,</span>&nbsp;<span class="ident" id="1348086">n</span>&nbsp;<span class="builtintype" id="1348088">int</span><span class="op" id="1348091">)</span>&nbsp;<span class="op" id="1348093">[</span><span class="op" id="1348094">]</span><span class="op" id="1348095">[</span><span class="op" id="1348096">]</span><span class="builtintype" id="1348097">byte</span>&nbsp;<span class="op" id="1348102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1348105">return</span>&nbsp;<span class="ident" id="1348112">genSplit</span><span class="op" id="1348120">(</span><span class="ident" id="1348121">s</span><span class="op" id="1348122">,</span>&nbsp;<span class="ident" id="1348124">sep</span><span class="op" id="1348127">,</span>&nbsp;<span class="builtinfunc" id="1348129">len</span><span class="op" id="1348132">(</span><span class="ident" id="1348133">sep</span><span class="op" id="1348136">)</span><span class="op" id="1348137">,</span>&nbsp;<span class="ident" id="1348139">n</span><span class="op" id="1348140">)</span><br>
<span class="lineno"></span><span class="op" id="1348142">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="1348145">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1348222">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1348265">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1348325">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="1348375">func</span>&nbsp;<span class="ident" id="1348380">Split</span><span class="op" id="1348385">(</span><span class="ident" id="1348386">s</span><span class="op" id="1348387">,</span>&nbsp;<span class="ident" id="1348389">sep</span>&nbsp;<span class="op" id="1348393">[</span><span class="op" id="1348394">]</span><span class="builtintype" id="1348395">byte</span><span class="op" id="1348399">)</span>&nbsp;<span class="op" id="1348401">[</span><span class="op" id="1348402">]</span><span class="op" id="1348403">[</span><span class="op" id="1348404">]</span><span class="builtintype" id="1348405">byte</span>&nbsp;<span class="op" id="1348410">{</span>&nbsp;<span class="keyword" id="1348412">return</span>&nbsp;<span class="ident" id="1348419">genSplit</span><span class="op" id="1348427">(</span><span class="ident" id="1348428">s</span><span class="op" id="1348429">,</span>&nbsp;<span class="ident" id="1348431">sep</span><span class="op" id="1348434">,</span>&nbsp;<span class="num" id="1348436">0</span><span class="op" id="1348437">,</span>&nbsp;<span class="op" id="1348439">-</span><span class="num" id="1348440">1</span><span class="op" id="1348441">)</span>&nbsp;<span class="op" id="1348443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1348446">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1348519">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1348558">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="1348623">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="1348678">func</span>&nbsp;<span class="ident" id="1348683">SplitAfter</span><span class="op" id="1348693">(</span><span class="ident" id="1348694">s</span><span class="op" id="1348695">,</span>&nbsp;<span class="ident" id="1348697">sep</span>&nbsp;<span class="op" id="1348701">[</span><span class="op" id="1348702">]</span><span class="builtintype" id="1348703">byte</span><span class="op" id="1348707">)</span>&nbsp;<span class="op" id="1348709">[</span><span class="op" id="1348710">]</span><span class="op" id="1348711">[</span><span class="op" id="1348712">]</span><span class="builtintype" id="1348713">byte</span>&nbsp;<span class="op" id="1348718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1348721">return</span>&nbsp;<span class="ident" id="1348728">genSplit</span><span class="op" id="1348736">(</span><span class="ident" id="1348737">s</span><span class="op" id="1348738">,</span>&nbsp;<span class="ident" id="1348740">sep</span><span class="op" id="1348743">,</span>&nbsp;<span class="builtinfunc" id="1348745">len</span><span class="op" id="1348748">(</span><span class="ident" id="1348749">sep</span><span class="op" id="1348752">)</span><span class="op" id="1348753">,</span>&nbsp;<span class="op" id="1348755">-</span><span class="num" id="1348756">1</span><span class="op" id="1348757">)</span><br>
<span class="lineno"></span><span class="op" id="1348759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="1348762">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="1348851">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1348951">func</span>&nbsp;<span class="ident" id="1348956">Fields</span><span class="op" id="1348962">(</span><span class="ident" id="1348963">s</span>&nbsp;<span class="op" id="1348965">[</span><span class="op" id="1348966">]</span><span class="builtintype" id="1348967">byte</span><span class="op" id="1348971">)</span>&nbsp;<span class="op" id="1348973">[</span><span class="op" id="1348974">]</span><span class="op" id="1348975">[</span><span class="op" id="1348976">]</span><span class="builtintype" id="1348977">byte</span>&nbsp;<span class="op" id="1348982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1348985">return</span>&nbsp;<span class="ident" id="1348992">FieldsFunc</span><span class="op" id="1349002">(</span><span class="ident" id="1349003">s</span><span class="op" id="1349004">,</span>&nbsp;<span class="ident" id="1349006">unicode</span><span class="op" id="1349013">.</span><span class="ident" id="1349014">IsSpace</span><span class="op" id="1349021">)</span><br>
<span class="lineno"></span><span class="op" id="1349023">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="1349026">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1349105">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1349179">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1349259">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="1349303">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="1349377">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="1349457">func</span>&nbsp;<span class="ident" id="1349462">FieldsFunc</span><span class="op" id="1349472">(</span><span class="ident" id="1349473">s</span>&nbsp;<span class="op" id="1349475">[</span><span class="op" id="1349476">]</span><span class="builtintype" id="1349477">byte</span><span class="op" id="1349481">,</span>&nbsp;<span class="ident" id="1349483">f</span>&nbsp;<span class="keyword" id="1349485">func</span><span class="op" id="1349489">(</span><span class="builtintype" id="1349490">rune</span><span class="op" id="1349494">)</span>&nbsp;<span class="builtintype" id="1349496">bool</span><span class="op" id="1349500">)</span>&nbsp;<span class="op" id="1349502">[</span><span class="op" id="1349503">]</span><span class="op" id="1349504">[</span><span class="op" id="1349505">]</span><span class="builtintype" id="1349506">byte</span>&nbsp;<span class="op" id="1349511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349514">n</span>&nbsp;<span class="op" id="1349516">:=</span>&nbsp;<span class="num" id="1349519">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349522">inField</span>&nbsp;<span class="op" id="1349530">:=</span>&nbsp;<span class="builtintype" id="1349533">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1349540">for</span>&nbsp;<span class="ident" id="1349544">i</span>&nbsp;<span class="op" id="1349546">:=</span>&nbsp;<span class="num" id="1349549">0</span><span class="op" id="1349550">;</span>&nbsp;<span class="ident" id="1349552">i</span>&nbsp;<span class="op" id="1349554">&lt;</span>&nbsp;<span class="builtinfunc" id="1349556">len</span><span class="op" id="1349559">(</span><span class="ident" id="1349560">s</span><span class="op" id="1349561">)</span><span class="op" id="1349562">;</span>&nbsp;<span class="op" id="1349564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349568">r</span><span class="op" id="1349569">,</span>&nbsp;<span class="ident" id="1349571">size</span>&nbsp;<span class="op" id="1349576">:=</span>&nbsp;<span class="ident" id="1349579">utf8</span><span class="op" id="1349583">.</span><span class="ident" id="1349584">DecodeRune</span><span class="op" id="1349594">(</span><span class="ident" id="1349595">s</span><span class="op" id="1349596">[</span><span class="ident" id="1349597">i</span><span class="op" id="1349598">:</span><span class="op" id="1349599">]</span><span class="op" id="1349600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349604">wasInField</span>&nbsp;<span class="op" id="1349615">:=</span>&nbsp;<span class="ident" id="1349618">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349628">inField</span>&nbsp;<span class="op" id="1349636">=</span>&nbsp;<span class="op" id="1349638">!</span><span class="ident" id="1349639">f</span><span class="op" id="1349640">(</span><span class="ident" id="1349641">r</span><span class="op" id="1349642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1349646">if</span>&nbsp;<span class="ident" id="1349649">inField</span>&nbsp;<span class="op" id="1349657">&amp;&amp;</span>&nbsp;<span class="op" id="1349660">!</span><span class="ident" id="1349661">wasInField</span>&nbsp;<span class="op" id="1349672">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349677">n</span><span class="op" id="1349678">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1349683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349687">i</span>&nbsp;<span class="op" id="1349689">+=</span>&nbsp;<span class="ident" id="1349692">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1349698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349702">a</span>&nbsp;<span class="op" id="1349704">:=</span>&nbsp;<span class="builtinfunc" id="1349707">make</span><span class="op" id="1349711">(</span><span class="op" id="1349712">[</span><span class="op" id="1349713">]</span><span class="op" id="1349714">[</span><span class="op" id="1349715">]</span><span class="builtintype" id="1349716">byte</span><span class="op" id="1349720">,</span>&nbsp;<span class="ident" id="1349722">n</span><span class="op" id="1349723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349726">na</span>&nbsp;<span class="op" id="1349729">:=</span>&nbsp;<span class="num" id="1349732">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349735">fieldStart</span>&nbsp;<span class="op" id="1349746">:=</span>&nbsp;<span class="op" id="1349749">-</span><span class="num" id="1349750">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1349753">for</span>&nbsp;<span class="ident" id="1349757">i</span>&nbsp;<span class="op" id="1349759">:=</span>&nbsp;<span class="num" id="1349762">0</span><span class="op" id="1349763">;</span>&nbsp;<span class="ident" id="1349765">i</span>&nbsp;<span class="op" id="1349767">&lt;=</span>&nbsp;<span class="builtinfunc" id="1349770">len</span><span class="op" id="1349773">(</span><span class="ident" id="1349774">s</span><span class="op" id="1349775">)</span>&nbsp;<span class="op" id="1349777">&amp;&amp;</span>&nbsp;<span class="ident" id="1349780">na</span>&nbsp;<span class="op" id="1349783">&lt;</span>&nbsp;<span class="ident" id="1349785">n</span><span class="op" id="1349786">;</span>&nbsp;<span class="op" id="1349788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349792">r</span><span class="op" id="1349793">,</span>&nbsp;<span class="ident" id="1349795">size</span>&nbsp;<span class="op" id="1349800">:=</span>&nbsp;<span class="ident" id="1349803">utf8</span><span class="op" id="1349807">.</span><span class="ident" id="1349808">DecodeRune</span><span class="op" id="1349818">(</span><span class="ident" id="1349819">s</span><span class="op" id="1349820">[</span><span class="ident" id="1349821">i</span><span class="op" id="1349822">:</span><span class="op" id="1349823">]</span><span class="op" id="1349824">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1349828">if</span>&nbsp;<span class="ident" id="1349831">fieldStart</span>&nbsp;<span class="op" id="1349842">&lt;</span>&nbsp;<span class="num" id="1349844">0</span>&nbsp;<span class="op" id="1349846">&amp;&amp;</span>&nbsp;<span class="ident" id="1349849">size</span>&nbsp;<span class="op" id="1349854">&gt;</span>&nbsp;<span class="num" id="1349856">0</span>&nbsp;<span class="op" id="1349858">&amp;&amp;</span>&nbsp;<span class="op" id="1349861">!</span><span class="ident" id="1349862">f</span><span class="op" id="1349863">(</span><span class="ident" id="1349864">r</span><span class="op" id="1349865">)</span>&nbsp;<span class="op" id="1349867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349872">fieldStart</span>&nbsp;<span class="op" id="1349883">=</span>&nbsp;<span class="ident" id="1349885">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349890">i</span>&nbsp;<span class="op" id="1349892">+=</span>&nbsp;<span class="ident" id="1349895">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1349903">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1349914">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1349918">if</span>&nbsp;<span class="ident" id="1349921">fieldStart</span>&nbsp;<span class="op" id="1349932">&gt;=</span>&nbsp;<span class="num" id="1349935">0</span>&nbsp;<span class="op" id="1349937">&amp;&amp;</span>&nbsp;<span class="op" id="1349940">(</span><span class="ident" id="1349941">size</span>&nbsp;<span class="op" id="1349946">==</span>&nbsp;<span class="num" id="1349949">0</span>&nbsp;<span class="op" id="1349951">||</span>&nbsp;<span class="ident" id="1349954">f</span><span class="op" id="1349955">(</span><span class="ident" id="1349956">r</span><span class="op" id="1349957">)</span><span class="op" id="1349958">)</span>&nbsp;<span class="op" id="1349960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349965">a</span><span class="op" id="1349966">[</span><span class="ident" id="1349967">na</span><span class="op" id="1349969">]</span>&nbsp;<span class="op" id="1349971">=</span>&nbsp;<span class="ident" id="1349973">s</span><span class="op" id="1349974">[</span><span class="ident" id="1349975">fieldStart</span><span class="op" id="1349985">:</span><span class="ident" id="1349986">i</span><span class="op" id="1349987">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1349992">na</span><span class="op" id="1349994">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350000">fieldStart</span>&nbsp;<span class="op" id="1350011">=</span>&nbsp;<span class="op" id="1350013">-</span><span class="num" id="1350014">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1350018">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350022">if</span>&nbsp;<span class="ident" id="1350025">size</span>&nbsp;<span class="op" id="1350030">==</span>&nbsp;<span class="num" id="1350033">0</span>&nbsp;<span class="op" id="1350035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350040">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1350048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350052">i</span>&nbsp;<span class="op" id="1350054">+=</span>&nbsp;<span class="ident" id="1350057">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1350063">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350066">return</span>&nbsp;<span class="ident" id="1350073">a</span><span class="op" id="1350074">[</span><span class="num" id="1350075">0</span><span class="op" id="1350076">:</span><span class="ident" id="1350077">na</span><span class="op" id="1350079">]</span><br>
<span class="lineno"></span><span class="op" id="1350081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350084">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="1350165">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="1350223">func</span>&nbsp;<span class="ident" id="1350228">Join</span><span class="op" id="1350232">(</span><span class="ident" id="1350233">s</span>&nbsp;<span class="op" id="1350235">[</span><span class="op" id="1350236">]</span><span class="op" id="1350237">[</span><span class="op" id="1350238">]</span><span class="builtintype" id="1350239">byte</span><span class="op" id="1350243">,</span>&nbsp;<span class="ident" id="1350245">sep</span>&nbsp;<span class="op" id="1350249">[</span><span class="op" id="1350250">]</span><span class="builtintype" id="1350251">byte</span><span class="op" id="1350255">)</span>&nbsp;<span class="op" id="1350257">[</span><span class="op" id="1350258">]</span><span class="builtintype" id="1350259">byte</span>&nbsp;<span class="op" id="1350264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350267">if</span>&nbsp;<span class="builtinfunc" id="1350270">len</span><span class="op" id="1350273">(</span><span class="ident" id="1350274">s</span><span class="op" id="1350275">)</span>&nbsp;<span class="op" id="1350277">==</span>&nbsp;<span class="num" id="1350280">0</span>&nbsp;<span class="op" id="1350282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350286">return</span>&nbsp;<span class="op" id="1350293">[</span><span class="op" id="1350294">]</span><span class="builtintype" id="1350295">byte</span><span class="op" id="1350299">{</span><span class="op" id="1350300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1350303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350306">if</span>&nbsp;<span class="builtinfunc" id="1350309">len</span><span class="op" id="1350312">(</span><span class="ident" id="1350313">s</span><span class="op" id="1350314">)</span>&nbsp;<span class="op" id="1350316">==</span>&nbsp;<span class="num" id="1350319">1</span>&nbsp;<span class="op" id="1350321">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1350325">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350350">return</span>&nbsp;<span class="builtinfunc" id="1350357">append</span><span class="op" id="1350363">(</span><span class="op" id="1350364">[</span><span class="op" id="1350365">]</span><span class="builtintype" id="1350366">byte</span><span class="op" id="1350370">(</span><span class="ident" id="1350371">nil</span><span class="op" id="1350374">)</span><span class="op" id="1350375">,</span>&nbsp;<span class="ident" id="1350377">s</span><span class="op" id="1350378">[</span><span class="num" id="1350379">0</span><span class="op" id="1350380">]</span><span class="op" id="1350381">...</span><span class="op" id="1350384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1350387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350390">n</span>&nbsp;<span class="op" id="1350392">:=</span>&nbsp;<span class="builtinfunc" id="1350395">len</span><span class="op" id="1350398">(</span><span class="ident" id="1350399">sep</span><span class="op" id="1350402">)</span>&nbsp;<span class="op" id="1350404">*</span>&nbsp;<span class="op" id="1350406">(</span><span class="builtinfunc" id="1350407">len</span><span class="op" id="1350410">(</span><span class="ident" id="1350411">s</span><span class="op" id="1350412">)</span>&nbsp;<span class="op" id="1350414">-</span>&nbsp;<span class="num" id="1350416">1</span><span class="op" id="1350417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350420">for</span>&nbsp;<span class="ident" id="1350424">_</span><span class="op" id="1350425">,</span>&nbsp;<span class="ident" id="1350427">v</span>&nbsp;<span class="op" id="1350429">:=</span>&nbsp;<span class="keyword" id="1350432">range</span>&nbsp;<span class="ident" id="1350438">s</span>&nbsp;<span class="op" id="1350440">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350444">n</span>&nbsp;<span class="op" id="1350446">+=</span>&nbsp;<span class="builtinfunc" id="1350449">len</span><span class="op" id="1350452">(</span><span class="ident" id="1350453">v</span><span class="op" id="1350454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1350457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350461">b</span>&nbsp;<span class="op" id="1350463">:=</span>&nbsp;<span class="builtinfunc" id="1350466">make</span><span class="op" id="1350470">(</span><span class="op" id="1350471">[</span><span class="op" id="1350472">]</span><span class="builtintype" id="1350473">byte</span><span class="op" id="1350477">,</span>&nbsp;<span class="ident" id="1350479">n</span><span class="op" id="1350480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350483">bp</span>&nbsp;<span class="op" id="1350486">:=</span>&nbsp;<span class="builtinfunc" id="1350489">copy</span><span class="op" id="1350493">(</span><span class="ident" id="1350494">b</span><span class="op" id="1350495">,</span>&nbsp;<span class="ident" id="1350497">s</span><span class="op" id="1350498">[</span><span class="num" id="1350499">0</span><span class="op" id="1350500">]</span><span class="op" id="1350501">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350504">for</span>&nbsp;<span class="ident" id="1350508">_</span><span class="op" id="1350509">,</span>&nbsp;<span class="ident" id="1350511">v</span>&nbsp;<span class="op" id="1350513">:=</span>&nbsp;<span class="keyword" id="1350516">range</span>&nbsp;<span class="ident" id="1350522">s</span><span class="op" id="1350523">[</span><span class="num" id="1350524">1</span><span class="op" id="1350525">:</span><span class="op" id="1350526">]</span>&nbsp;<span class="op" id="1350528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350532">bp</span>&nbsp;<span class="op" id="1350535">+=</span>&nbsp;<span class="builtinfunc" id="1350538">copy</span><span class="op" id="1350542">(</span><span class="ident" id="1350543">b</span><span class="op" id="1350544">[</span><span class="ident" id="1350545">bp</span><span class="op" id="1350547">:</span><span class="op" id="1350548">]</span><span class="op" id="1350549">,</span>&nbsp;<span class="ident" id="1350551">sep</span><span class="op" id="1350554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1350558">bp</span>&nbsp;<span class="op" id="1350561">+=</span>&nbsp;<span class="builtinfunc" id="1350564">copy</span><span class="op" id="1350568">(</span><span class="ident" id="1350569">b</span><span class="op" id="1350570">[</span><span class="ident" id="1350571">bp</span><span class="op" id="1350573">:</span><span class="op" id="1350574">]</span><span class="op" id="1350575">,</span>&nbsp;<span class="ident" id="1350577">v</span><span class="op" id="1350578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1350581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350584">return</span>&nbsp;<span class="ident" id="1350591">b</span><br>
<span class="lineno">330</span><span class="op" id="1350593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350596">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="1350660">func</span>&nbsp;<span class="ident" id="1350665">HasPrefix</span><span class="op" id="1350674">(</span><span class="ident" id="1350675">s</span><span class="op" id="1350676">,</span>&nbsp;<span class="ident" id="1350678">prefix</span>&nbsp;<span class="op" id="1350685">[</span><span class="op" id="1350686">]</span><span class="builtintype" id="1350687">byte</span><span class="op" id="1350691">)</span>&nbsp;<span class="builtintype" id="1350693">bool</span>&nbsp;<span class="op" id="1350698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350701">return</span>&nbsp;<span class="builtinfunc" id="1350708">len</span><span class="op" id="1350711">(</span><span class="ident" id="1350712">s</span><span class="op" id="1350713">)</span>&nbsp;<span class="op" id="1350715">&gt;=</span>&nbsp;<span class="builtinfunc" id="1350718">len</span><span class="op" id="1350721">(</span><span class="ident" id="1350722">prefix</span><span class="op" id="1350728">)</span>&nbsp;<span class="op" id="1350730">&amp;&amp;</span>&nbsp;<span class="ident" id="1350733">Equal</span><span class="op" id="1350738">(</span><span class="ident" id="1350739">s</span><span class="op" id="1350740">[</span><span class="num" id="1350741">0</span><span class="op" id="1350742">:</span><span class="builtinfunc" id="1350743">len</span><span class="op" id="1350746">(</span><span class="ident" id="1350747">prefix</span><span class="op" id="1350753">)</span><span class="op" id="1350754">]</span><span class="op" id="1350755">,</span>&nbsp;<span class="ident" id="1350757">prefix</span><span class="op" id="1350763">)</span><br>
<span class="lineno">335</span><span class="op" id="1350765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350768">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="1350830">func</span>&nbsp;<span class="ident" id="1350835">HasSuffix</span><span class="op" id="1350844">(</span><span class="ident" id="1350845">s</span><span class="op" id="1350846">,</span>&nbsp;<span class="ident" id="1350848">suffix</span>&nbsp;<span class="op" id="1350855">[</span><span class="op" id="1350856">]</span><span class="builtintype" id="1350857">byte</span><span class="op" id="1350861">)</span>&nbsp;<span class="builtintype" id="1350863">bool</span>&nbsp;<span class="op" id="1350868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1350871">return</span>&nbsp;<span class="builtinfunc" id="1350878">len</span><span class="op" id="1350881">(</span><span class="ident" id="1350882">s</span><span class="op" id="1350883">)</span>&nbsp;<span class="op" id="1350885">&gt;=</span>&nbsp;<span class="builtinfunc" id="1350888">len</span><span class="op" id="1350891">(</span><span class="ident" id="1350892">suffix</span><span class="op" id="1350898">)</span>&nbsp;<span class="op" id="1350900">&amp;&amp;</span>&nbsp;<span class="ident" id="1350903">Equal</span><span class="op" id="1350908">(</span><span class="ident" id="1350909">s</span><span class="op" id="1350910">[</span><span class="builtinfunc" id="1350911">len</span><span class="op" id="1350914">(</span><span class="ident" id="1350915">s</span><span class="op" id="1350916">)</span><span class="op" id="1350917">-</span><span class="builtinfunc" id="1350918">len</span><span class="op" id="1350921">(</span><span class="ident" id="1350922">suffix</span><span class="op" id="1350928">)</span><span class="op" id="1350929">:</span><span class="op" id="1350930">]</span><span class="op" id="1350931">,</span>&nbsp;<span class="ident" id="1350933">suffix</span><span class="op" id="1350939">)</span><br>
<span class="lineno">340</span><span class="op" id="1350941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350944">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="1351019">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1351111">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="1351188">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1351252">func</span>&nbsp;<span class="ident" id="1351257">Map</span><span class="op" id="1351260">(</span><span class="ident" id="1351261">mapping</span>&nbsp;<span class="keyword" id="1351269">func</span><span class="op" id="1351273">(</span><span class="ident" id="1351274">r</span>&nbsp;<span class="builtintype" id="1351276">rune</span><span class="op" id="1351280">)</span>&nbsp;<span class="builtintype" id="1351282">rune</span><span class="op" id="1351286">,</span>&nbsp;<span class="ident" id="1351288">s</span>&nbsp;<span class="op" id="1351290">[</span><span class="op" id="1351291">]</span><span class="builtintype" id="1351292">byte</span><span class="op" id="1351296">)</span>&nbsp;<span class="op" id="1351298">[</span><span class="op" id="1351299">]</span><span class="builtintype" id="1351300">byte</span>&nbsp;<span class="op" id="1351305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1351308">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1351370">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1351437">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351499">maxbytes</span>&nbsp;<span class="op" id="1351508">:=</span>&nbsp;<span class="builtinfunc" id="1351511">len</span><span class="op" id="1351514">(</span><span class="ident" id="1351515">s</span><span class="op" id="1351516">)</span>&nbsp;<span class="comment" id="1351518">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351534">nbytes</span>&nbsp;<span class="op" id="1351541">:=</span>&nbsp;<span class="num" id="1351544">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1351553">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351586">b</span>&nbsp;<span class="op" id="1351588">:=</span>&nbsp;<span class="builtinfunc" id="1351591">make</span><span class="op" id="1351595">(</span><span class="op" id="1351596">[</span><span class="op" id="1351597">]</span><span class="builtintype" id="1351598">byte</span><span class="op" id="1351602">,</span>&nbsp;<span class="ident" id="1351604">maxbytes</span><span class="op" id="1351612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1351615">for</span>&nbsp;<span class="ident" id="1351619">i</span>&nbsp;<span class="op" id="1351621">:=</span>&nbsp;<span class="num" id="1351624">0</span><span class="op" id="1351625">;</span>&nbsp;<span class="ident" id="1351627">i</span>&nbsp;<span class="op" id="1351629">&lt;</span>&nbsp;<span class="builtinfunc" id="1351631">len</span><span class="op" id="1351634">(</span><span class="ident" id="1351635">s</span><span class="op" id="1351636">)</span><span class="op" id="1351637">;</span>&nbsp;<span class="op" id="1351639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351643">wid</span>&nbsp;<span class="op" id="1351647">:=</span>&nbsp;<span class="num" id="1351650">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351654">r</span>&nbsp;<span class="op" id="1351656">:=</span>&nbsp;<span class="builtintype" id="1351659">rune</span><span class="op" id="1351663">(</span><span class="ident" id="1351664">s</span><span class="op" id="1351665">[</span><span class="ident" id="1351666">i</span><span class="op" id="1351667">]</span><span class="op" id="1351668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1351672">if</span>&nbsp;<span class="ident" id="1351675">r</span>&nbsp;<span class="op" id="1351677">&gt;=</span>&nbsp;<span class="ident" id="1351680">utf8</span><span class="op" id="1351684">.</span><span class="ident" id="1351685">RuneSelf</span>&nbsp;<span class="op" id="1351694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351699">r</span><span class="op" id="1351700">,</span>&nbsp;<span class="ident" id="1351702">wid</span>&nbsp;<span class="op" id="1351706">=</span>&nbsp;<span class="ident" id="1351708">utf8</span><span class="op" id="1351712">.</span><span class="ident" id="1351713">DecodeRune</span><span class="op" id="1351723">(</span><span class="ident" id="1351724">s</span><span class="op" id="1351725">[</span><span class="ident" id="1351726">i</span><span class="op" id="1351727">:</span><span class="op" id="1351728">]</span><span class="op" id="1351729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1351733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351737">r</span>&nbsp;<span class="op" id="1351739">=</span>&nbsp;<span class="ident" id="1351741">mapping</span><span class="op" id="1351748">(</span><span class="ident" id="1351749">r</span><span class="op" id="1351750">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1351754">if</span>&nbsp;<span class="ident" id="1351757">r</span>&nbsp;<span class="op" id="1351759">&gt;=</span>&nbsp;<span class="num" id="1351762">0</span>&nbsp;<span class="op" id="1351764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351769">rl</span>&nbsp;<span class="op" id="1351772">:=</span>&nbsp;<span class="ident" id="1351775">utf8</span><span class="op" id="1351779">.</span><span class="ident" id="1351780">RuneLen</span><span class="op" id="1351787">(</span><span class="ident" id="1351788">r</span><span class="op" id="1351789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1351794">if</span>&nbsp;<span class="ident" id="1351797">rl</span>&nbsp;<span class="op" id="1351800">&lt;</span>&nbsp;<span class="num" id="1351802">0</span>&nbsp;<span class="op" id="1351804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351810">rl</span>&nbsp;<span class="op" id="1351813">=</span>&nbsp;<span class="builtinfunc" id="1351815">len</span><span class="op" id="1351818">(</span><span class="builtintype" id="1351819">string</span><span class="op" id="1351825">(</span><span class="ident" id="1351826">utf8</span><span class="op" id="1351830">.</span><span class="ident" id="1351831">RuneError</span><span class="op" id="1351840">)</span><span class="op" id="1351841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1351846">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1351851">if</span>&nbsp;<span class="ident" id="1351854">nbytes</span><span class="op" id="1351860">+</span><span class="ident" id="1351861">rl</span>&nbsp;<span class="op" id="1351864">&gt;</span>&nbsp;<span class="ident" id="1351866">maxbytes</span>&nbsp;<span class="op" id="1351875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1351881">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351905">maxbytes</span>&nbsp;<span class="op" id="1351914">=</span>&nbsp;<span class="ident" id="1351916">maxbytes</span><span class="op" id="1351924">*</span><span class="num" id="1351925">2</span>&nbsp;<span class="op" id="1351927">+</span>&nbsp;<span class="ident" id="1351929">utf8</span><span class="op" id="1351933">.</span><span class="ident" id="1351934">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1351945">nb</span>&nbsp;<span class="op" id="1351948">:=</span>&nbsp;<span class="builtinfunc" id="1351951">make</span><span class="op" id="1351955">(</span><span class="op" id="1351956">[</span><span class="op" id="1351957">]</span><span class="builtintype" id="1351958">byte</span><span class="op" id="1351962">,</span>&nbsp;<span class="ident" id="1351964">maxbytes</span><span class="op" id="1351972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1351978">copy</span><span class="op" id="1351982">(</span><span class="ident" id="1351983">nb</span><span class="op" id="1351985">,</span>&nbsp;<span class="ident" id="1351987">b</span><span class="op" id="1351988">[</span><span class="num" id="1351989">0</span><span class="op" id="1351990">:</span><span class="ident" id="1351991">nbytes</span><span class="op" id="1351997">]</span><span class="op" id="1351998">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1352004">b</span>&nbsp;<span class="op" id="1352006">=</span>&nbsp;<span class="ident" id="1352008">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1352014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1352019">nbytes</span>&nbsp;<span class="op" id="1352026">+=</span>&nbsp;<span class="ident" id="1352029">utf8</span><span class="op" id="1352033">.</span><span class="ident" id="1352034">EncodeRune</span><span class="op" id="1352044">(</span><span class="ident" id="1352045">b</span><span class="op" id="1352046">[</span><span class="ident" id="1352047">nbytes</span><span class="op" id="1352053">:</span><span class="ident" id="1352054">maxbytes</span><span class="op" id="1352062">]</span><span class="op" id="1352063">,</span>&nbsp;<span class="ident" id="1352065">r</span><span class="op" id="1352066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1352070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1352074">i</span>&nbsp;<span class="op" id="1352076">+=</span>&nbsp;<span class="ident" id="1352079">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1352084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1352087">return</span>&nbsp;<span class="ident" id="1352094">b</span><span class="op" id="1352095">[</span><span class="num" id="1352096">0</span><span class="op" id="1352097">:</span><span class="ident" id="1352098">nbytes</span><span class="op" id="1352104">]</span><br>
<span class="lineno"></span><span class="op" id="1352106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1352109">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="1352177">func</span>&nbsp;<span class="ident" id="1352182">Repeat</span><span class="op" id="1352188">(</span><span class="ident" id="1352189">b</span>&nbsp;<span class="op" id="1352191">[</span><span class="op" id="1352192">]</span><span class="builtintype" id="1352193">byte</span><span class="op" id="1352197">,</span>&nbsp;<span class="ident" id="1352199">count</span>&nbsp;<span class="builtintype" id="1352205">int</span><span class="op" id="1352208">)</span>&nbsp;<span class="op" id="1352210">[</span><span class="op" id="1352211">]</span><span class="builtintype" id="1352212">byte</span>&nbsp;<span class="op" id="1352217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1352220">nb</span>&nbsp;<span class="op" id="1352223">:=</span>&nbsp;<span class="builtinfunc" id="1352226">make</span><span class="op" id="1352230">(</span><span class="op" id="1352231">[</span><span class="op" id="1352232">]</span><span class="builtintype" id="1352233">byte</span><span class="op" id="1352237">,</span>&nbsp;<span class="builtinfunc" id="1352239">len</span><span class="op" id="1352242">(</span><span class="ident" id="1352243">b</span><span class="op" id="1352244">)</span><span class="op" id="1352245">*</span><span class="ident" id="1352246">count</span><span class="op" id="1352251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1352254">bp</span>&nbsp;<span class="op" id="1352257">:=</span>&nbsp;<span class="builtinfunc" id="1352260">copy</span><span class="op" id="1352264">(</span><span class="ident" id="1352265">nb</span><span class="op" id="1352267">,</span>&nbsp;<span class="ident" id="1352269">b</span><span class="op" id="1352270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1352273">for</span>&nbsp;<span class="ident" id="1352277">bp</span>&nbsp;<span class="op" id="1352280">&lt;</span>&nbsp;<span class="builtinfunc" id="1352282">len</span><span class="op" id="1352285">(</span><span class="ident" id="1352286">nb</span><span class="op" id="1352288">)</span>&nbsp;<span class="op" id="1352290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1352294">copy</span><span class="op" id="1352298">(</span><span class="ident" id="1352299">nb</span><span class="op" id="1352301">[</span><span class="ident" id="1352302">bp</span><span class="op" id="1352304">:</span><span class="op" id="1352305">]</span><span class="op" id="1352306">,</span>&nbsp;<span class="ident" id="1352308">nb</span><span class="op" id="1352310">[</span><span class="op" id="1352311">:</span><span class="ident" id="1352312">bp</span><span class="op" id="1352314">]</span><span class="op" id="1352315">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1352319">bp</span>&nbsp;<span class="op" id="1352322">*=</span>&nbsp;<span class="num" id="1352325">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1352328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1352331">return</span>&nbsp;<span class="ident" id="1352338">nb</span><br>
<span class="lineno"></span><span class="op" id="1352341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1352344">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1352443">func</span>&nbsp;<span class="ident" id="1352448">ToUpper</span><span class="op" id="1352455">(</span><span class="ident" id="1352456">s</span>&nbsp;<span class="op" id="1352458">[</span><span class="op" id="1352459">]</span><span class="builtintype" id="1352460">byte</span><span class="op" id="1352464">)</span>&nbsp;<span class="op" id="1352466">[</span><span class="op" id="1352467">]</span><span class="builtintype" id="1352468">byte</span>&nbsp;<span class="op" id="1352473">{</span>&nbsp;<span class="keyword" id="1352475">return</span>&nbsp;<span class="ident" id="1352482">Map</span><span class="op" id="1352485">(</span><span class="ident" id="1352486">unicode</span><span class="op" id="1352493">.</span><span class="ident" id="1352494">ToUpper</span><span class="op" id="1352501">,</span>&nbsp;<span class="ident" id="1352503">s</span><span class="op" id="1352504">)</span>&nbsp;<span class="op" id="1352506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1352509">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1352608">func</span>&nbsp;<span class="ident" id="1352613">ToLower</span><span class="op" id="1352620">(</span><span class="ident" id="1352621">s</span>&nbsp;<span class="op" id="1352623">[</span><span class="op" id="1352624">]</span><span class="builtintype" id="1352625">byte</span><span class="op" id="1352629">)</span>&nbsp;<span class="op" id="1352631">[</span><span class="op" id="1352632">]</span><span class="builtintype" id="1352633">byte</span>&nbsp;<span class="op" id="1352638">{</span>&nbsp;<span class="keyword" id="1352640">return</span>&nbsp;<span class="ident" id="1352647">Map</span><span class="op" id="1352650">(</span><span class="ident" id="1352651">unicode</span><span class="op" id="1352658">.</span><span class="ident" id="1352659">ToLower</span><span class="op" id="1352666">,</span>&nbsp;<span class="ident" id="1352668">s</span><span class="op" id="1352669">)</span>&nbsp;<span class="op" id="1352671">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1352674">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1352773">func</span>&nbsp;<span class="ident" id="1352778">ToTitle</span><span class="op" id="1352785">(</span><span class="ident" id="1352786">s</span>&nbsp;<span class="op" id="1352788">[</span><span class="op" id="1352789">]</span><span class="builtintype" id="1352790">byte</span><span class="op" id="1352794">)</span>&nbsp;<span class="op" id="1352796">[</span><span class="op" id="1352797">]</span><span class="builtintype" id="1352798">byte</span>&nbsp;<span class="op" id="1352803">{</span>&nbsp;<span class="keyword" id="1352805">return</span>&nbsp;<span class="ident" id="1352812">Map</span><span class="op" id="1352815">(</span><span class="ident" id="1352816">unicode</span><span class="op" id="1352823">.</span><span class="ident" id="1352824">ToTitle</span><span class="op" id="1352831">,</span>&nbsp;<span class="ident" id="1352833">s</span><span class="op" id="1352834">)</span>&nbsp;<span class="op" id="1352836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1352839">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="1352933">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1352993">func</span>&nbsp;<span class="ident" id="1352998">ToUpperSpecial</span><span class="op" id="1353012">(</span><span class="ident" id="1353013">_case</span>&nbsp;<span class="ident" id="1353019">unicode</span><span class="op" id="1353026">.</span><span class="ident" id="1353027">SpecialCase</span><span class="op" id="1353038">,</span>&nbsp;<span class="ident" id="1353040">s</span>&nbsp;<span class="op" id="1353042">[</span><span class="op" id="1353043">]</span><span class="builtintype" id="1353044">byte</span><span class="op" id="1353048">)</span>&nbsp;<span class="op" id="1353050">[</span><span class="op" id="1353051">]</span><span class="builtintype" id="1353052">byte</span>&nbsp;<span class="op" id="1353057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353060">return</span>&nbsp;<span class="ident" id="1353067">Map</span><span class="op" id="1353070">(</span><span class="keyword" id="1353071">func</span><span class="op" id="1353075">(</span><span class="ident" id="1353076">r</span>&nbsp;<span class="builtintype" id="1353078">rune</span><span class="op" id="1353082">)</span>&nbsp;<span class="builtintype" id="1353084">rune</span>&nbsp;<span class="op" id="1353089">{</span>&nbsp;<span class="keyword" id="1353091">return</span>&nbsp;<span class="ident" id="1353098">_case</span><span class="op" id="1353103">.</span><span class="ident" id="1353104">ToUpper</span><span class="op" id="1353111">(</span><span class="ident" id="1353112">r</span><span class="op" id="1353113">)</span>&nbsp;<span class="op" id="1353115">}</span><span class="op" id="1353116">,</span>&nbsp;<span class="ident" id="1353118">s</span><span class="op" id="1353119">)</span><br>
<span class="lineno"></span><span class="op" id="1353121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1353124">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1353218">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1353278">func</span>&nbsp;<span class="ident" id="1353283">ToLowerSpecial</span><span class="op" id="1353297">(</span><span class="ident" id="1353298">_case</span>&nbsp;<span class="ident" id="1353304">unicode</span><span class="op" id="1353311">.</span><span class="ident" id="1353312">SpecialCase</span><span class="op" id="1353323">,</span>&nbsp;<span class="ident" id="1353325">s</span>&nbsp;<span class="op" id="1353327">[</span><span class="op" id="1353328">]</span><span class="builtintype" id="1353329">byte</span><span class="op" id="1353333">)</span>&nbsp;<span class="op" id="1353335">[</span><span class="op" id="1353336">]</span><span class="builtintype" id="1353337">byte</span>&nbsp;<span class="op" id="1353342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353345">return</span>&nbsp;<span class="ident" id="1353352">Map</span><span class="op" id="1353355">(</span><span class="keyword" id="1353356">func</span><span class="op" id="1353360">(</span><span class="ident" id="1353361">r</span>&nbsp;<span class="builtintype" id="1353363">rune</span><span class="op" id="1353367">)</span>&nbsp;<span class="builtintype" id="1353369">rune</span>&nbsp;<span class="op" id="1353374">{</span>&nbsp;<span class="keyword" id="1353376">return</span>&nbsp;<span class="ident" id="1353383">_case</span><span class="op" id="1353388">.</span><span class="ident" id="1353389">ToLower</span><span class="op" id="1353396">(</span><span class="ident" id="1353397">r</span><span class="op" id="1353398">)</span>&nbsp;<span class="op" id="1353400">}</span><span class="op" id="1353401">,</span>&nbsp;<span class="ident" id="1353403">s</span><span class="op" id="1353404">)</span><br>
<span class="lineno"></span><span class="op" id="1353406">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1353409">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1353503">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1353563">func</span>&nbsp;<span class="ident" id="1353568">ToTitleSpecial</span><span class="op" id="1353582">(</span><span class="ident" id="1353583">_case</span>&nbsp;<span class="ident" id="1353589">unicode</span><span class="op" id="1353596">.</span><span class="ident" id="1353597">SpecialCase</span><span class="op" id="1353608">,</span>&nbsp;<span class="ident" id="1353610">s</span>&nbsp;<span class="op" id="1353612">[</span><span class="op" id="1353613">]</span><span class="builtintype" id="1353614">byte</span><span class="op" id="1353618">)</span>&nbsp;<span class="op" id="1353620">[</span><span class="op" id="1353621">]</span><span class="builtintype" id="1353622">byte</span>&nbsp;<span class="op" id="1353627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353630">return</span>&nbsp;<span class="ident" id="1353637">Map</span><span class="op" id="1353640">(</span><span class="keyword" id="1353641">func</span><span class="op" id="1353645">(</span><span class="ident" id="1353646">r</span>&nbsp;<span class="builtintype" id="1353648">rune</span><span class="op" id="1353652">)</span>&nbsp;<span class="builtintype" id="1353654">rune</span>&nbsp;<span class="op" id="1353659">{</span>&nbsp;<span class="keyword" id="1353661">return</span>&nbsp;<span class="ident" id="1353668">_case</span><span class="op" id="1353673">.</span><span class="ident" id="1353674">ToTitle</span><span class="op" id="1353681">(</span><span class="ident" id="1353682">r</span><span class="op" id="1353683">)</span>&nbsp;<span class="op" id="1353685">}</span><span class="op" id="1353686">,</span>&nbsp;<span class="ident" id="1353688">s</span><span class="op" id="1353689">)</span><br>
<span class="lineno">415</span><span class="op" id="1353691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1353694">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="1353762">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="1353832">func</span>&nbsp;<span class="ident" id="1353837">isSeparator</span><span class="op" id="1353848">(</span><span class="ident" id="1353849">r</span>&nbsp;<span class="builtintype" id="1353851">rune</span><span class="op" id="1353855">)</span>&nbsp;<span class="builtintype" id="1353857">bool</span>&nbsp;<span class="op" id="1353862">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1353865">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353923">if</span>&nbsp;<span class="ident" id="1353926">r</span>&nbsp;<span class="op" id="1353928">&lt;=</span>&nbsp;<span class="num" id="1353931">0x7F</span>&nbsp;<span class="op" id="1353936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353940">switch</span>&nbsp;<span class="op" id="1353947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353951">case</span>&nbsp;<span class="string" id="1353956">&#39;0&#39;</span>&nbsp;<span class="op" id="1353960">&lt;=</span>&nbsp;<span class="ident" id="1353963">r</span>&nbsp;<span class="op" id="1353965">&amp;&amp;</span>&nbsp;<span class="ident" id="1353968">r</span>&nbsp;<span class="op" id="1353970">&lt;=</span>&nbsp;<span class="string" id="1353973">&#39;9&#39;</span><span class="op" id="1353976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353981">return</span>&nbsp;<span class="builtintype" id="1353988">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1353996">case</span>&nbsp;<span class="string" id="1354001">&#39;a&#39;</span>&nbsp;<span class="op" id="1354005">&lt;=</span>&nbsp;<span class="ident" id="1354008">r</span>&nbsp;<span class="op" id="1354010">&amp;&amp;</span>&nbsp;<span class="ident" id="1354013">r</span>&nbsp;<span class="op" id="1354015">&lt;=</span>&nbsp;<span class="string" id="1354018">&#39;z&#39;</span><span class="op" id="1354021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354026">return</span>&nbsp;<span class="builtintype" id="1354033">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354041">case</span>&nbsp;<span class="string" id="1354046">&#39;A&#39;</span>&nbsp;<span class="op" id="1354050">&lt;=</span>&nbsp;<span class="ident" id="1354053">r</span>&nbsp;<span class="op" id="1354055">&amp;&amp;</span>&nbsp;<span class="ident" id="1354058">r</span>&nbsp;<span class="op" id="1354060">&lt;=</span>&nbsp;<span class="string" id="1354063">&#39;Z&#39;</span><span class="op" id="1354066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354071">return</span>&nbsp;<span class="builtintype" id="1354078">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354086">case</span>&nbsp;<span class="ident" id="1354091">r</span>&nbsp;<span class="op" id="1354093">==</span>&nbsp;<span class="string" id="1354096">&#39;_&#39;</span><span class="op" id="1354099">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354104">return</span>&nbsp;<span class="builtintype" id="1354111">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1354119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354123">return</span>&nbsp;<span class="builtintype" id="1354130">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1354136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1354139">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354181">if</span>&nbsp;<span class="ident" id="1354184">unicode</span><span class="op" id="1354191">.</span><span class="ident" id="1354192">IsLetter</span><span class="op" id="1354200">(</span><span class="ident" id="1354201">r</span><span class="op" id="1354202">)</span>&nbsp;<span class="op" id="1354204">||</span>&nbsp;<span class="ident" id="1354207">unicode</span><span class="op" id="1354214">.</span><span class="ident" id="1354215">IsDigit</span><span class="op" id="1354222">(</span><span class="ident" id="1354223">r</span><span class="op" id="1354224">)</span>&nbsp;<span class="op" id="1354226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354230">return</span>&nbsp;<span class="builtintype" id="1354237">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1354244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1354247">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354315">return</span>&nbsp;<span class="ident" id="1354322">unicode</span><span class="op" id="1354329">.</span><span class="ident" id="1354330">IsSpace</span><span class="op" id="1354337">(</span><span class="ident" id="1354338">r</span><span class="op" id="1354339">)</span><br>
<span class="lineno">440</span><span class="op" id="1354341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1354344">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="1354415">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="1354446">//</span><br>
<span class="lineno">445</span><span class="comment" id="1354449">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1354543">func</span>&nbsp;<span class="ident" id="1354548">Title</span><span class="op" id="1354553">(</span><span class="ident" id="1354554">s</span>&nbsp;<span class="op" id="1354556">[</span><span class="op" id="1354557">]</span><span class="builtintype" id="1354558">byte</span><span class="op" id="1354562">)</span>&nbsp;<span class="op" id="1354564">[</span><span class="op" id="1354565">]</span><span class="builtintype" id="1354566">byte</span>&nbsp;<span class="op" id="1354571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1354574">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1354616">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1354688">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1354719">prev</span>&nbsp;<span class="op" id="1354724">:=</span>&nbsp;<span class="string" id="1354727">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354732">return</span>&nbsp;<span class="ident" id="1354739">Map</span><span class="op" id="1354742">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354746">func</span><span class="op" id="1354750">(</span><span class="ident" id="1354751">r</span>&nbsp;<span class="builtintype" id="1354753">rune</span><span class="op" id="1354757">)</span>&nbsp;<span class="builtintype" id="1354759">rune</span>&nbsp;<span class="op" id="1354764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354769">if</span>&nbsp;<span class="ident" id="1354772">isSeparator</span><span class="op" id="1354783">(</span><span class="ident" id="1354784">prev</span><span class="op" id="1354788">)</span>&nbsp;<span class="op" id="1354790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1354796">prev</span>&nbsp;<span class="op" id="1354801">=</span>&nbsp;<span class="ident" id="1354803">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354809">return</span>&nbsp;<span class="ident" id="1354816">unicode</span><span class="op" id="1354823">.</span><span class="ident" id="1354824">ToTitle</span><span class="op" id="1354831">(</span><span class="ident" id="1354832">r</span><span class="op" id="1354833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1354838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1354843">prev</span>&nbsp;<span class="op" id="1354848">=</span>&nbsp;<span class="ident" id="1354850">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1354855">return</span>&nbsp;<span class="ident" id="1354862">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1354866">}</span><span class="op" id="1354867">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1354871">s</span><span class="op" id="1354872">)</span><br>
<span class="lineno"></span><span class="op" id="1354874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1354877">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="1354958">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="1355002">func</span>&nbsp;<span class="ident" id="1355007">TrimLeftFunc</span><span class="op" id="1355019">(</span><span class="ident" id="1355020">s</span>&nbsp;<span class="op" id="1355022">[</span><span class="op" id="1355023">]</span><span class="builtintype" id="1355024">byte</span><span class="op" id="1355028">,</span>&nbsp;<span class="ident" id="1355030">f</span>&nbsp;<span class="keyword" id="1355032">func</span><span class="op" id="1355036">(</span><span class="ident" id="1355037">r</span>&nbsp;<span class="builtintype" id="1355039">rune</span><span class="op" id="1355043">)</span>&nbsp;<span class="builtintype" id="1355045">bool</span><span class="op" id="1355049">)</span>&nbsp;<span class="op" id="1355051">[</span><span class="op" id="1355052">]</span><span class="builtintype" id="1355053">byte</span>&nbsp;<span class="op" id="1355058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1355061">i</span>&nbsp;<span class="op" id="1355063">:=</span>&nbsp;<span class="ident" id="1355066">indexFunc</span><span class="op" id="1355075">(</span><span class="ident" id="1355076">s</span><span class="op" id="1355077">,</span>&nbsp;<span class="ident" id="1355079">f</span><span class="op" id="1355080">,</span>&nbsp;<span class="builtintype" id="1355082">false</span><span class="op" id="1355087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355090">if</span>&nbsp;<span class="ident" id="1355093">i</span>&nbsp;<span class="op" id="1355095">==</span>&nbsp;<span class="op" id="1355098">-</span><span class="num" id="1355099">1</span>&nbsp;<span class="op" id="1355101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355105">return</span>&nbsp;<span class="ident" id="1355112">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1355117">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355120">return</span>&nbsp;<span class="ident" id="1355127">s</span><span class="op" id="1355128">[</span><span class="ident" id="1355129">i</span><span class="op" id="1355130">:</span><span class="op" id="1355131">]</span><br>
<span class="lineno"></span><span class="op" id="1355133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1355136">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="1355211">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="1355263">func</span>&nbsp;<span class="ident" id="1355268">TrimRightFunc</span><span class="op" id="1355281">(</span><span class="ident" id="1355282">s</span>&nbsp;<span class="op" id="1355284">[</span><span class="op" id="1355285">]</span><span class="builtintype" id="1355286">byte</span><span class="op" id="1355290">,</span>&nbsp;<span class="ident" id="1355292">f</span>&nbsp;<span class="keyword" id="1355294">func</span><span class="op" id="1355298">(</span><span class="ident" id="1355299">r</span>&nbsp;<span class="builtintype" id="1355301">rune</span><span class="op" id="1355305">)</span>&nbsp;<span class="builtintype" id="1355307">bool</span><span class="op" id="1355311">)</span>&nbsp;<span class="op" id="1355313">[</span><span class="op" id="1355314">]</span><span class="builtintype" id="1355315">byte</span>&nbsp;<span class="op" id="1355320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1355323">i</span>&nbsp;<span class="op" id="1355325">:=</span>&nbsp;<span class="ident" id="1355328">lastIndexFunc</span><span class="op" id="1355341">(</span><span class="ident" id="1355342">s</span><span class="op" id="1355343">,</span>&nbsp;<span class="ident" id="1355345">f</span><span class="op" id="1355346">,</span>&nbsp;<span class="builtintype" id="1355348">false</span><span class="op" id="1355353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355356">if</span>&nbsp;<span class="ident" id="1355359">i</span>&nbsp;<span class="op" id="1355361">&gt;=</span>&nbsp;<span class="num" id="1355364">0</span>&nbsp;<span class="op" id="1355366">&amp;&amp;</span>&nbsp;<span class="ident" id="1355369">s</span><span class="op" id="1355370">[</span><span class="ident" id="1355371">i</span><span class="op" id="1355372">]</span>&nbsp;<span class="op" id="1355374">&gt;=</span>&nbsp;<span class="ident" id="1355377">utf8</span><span class="op" id="1355381">.</span><span class="ident" id="1355382">RuneSelf</span>&nbsp;<span class="op" id="1355391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1355395">_</span><span class="op" id="1355396">,</span>&nbsp;<span class="ident" id="1355398">wid</span>&nbsp;<span class="op" id="1355402">:=</span>&nbsp;<span class="ident" id="1355405">utf8</span><span class="op" id="1355409">.</span><span class="ident" id="1355410">DecodeRune</span><span class="op" id="1355420">(</span><span class="ident" id="1355421">s</span><span class="op" id="1355422">[</span><span class="ident" id="1355423">i</span><span class="op" id="1355424">:</span><span class="op" id="1355425">]</span><span class="op" id="1355426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1355430">i</span>&nbsp;<span class="op" id="1355432">+=</span>&nbsp;<span class="ident" id="1355435">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1355440">}</span>&nbsp;<span class="keyword" id="1355442">else</span>&nbsp;<span class="op" id="1355447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1355451">i</span><span class="op" id="1355452">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1355456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355459">return</span>&nbsp;<span class="ident" id="1355466">s</span><span class="op" id="1355467">[</span><span class="num" id="1355468">0</span><span class="op" id="1355469">:</span><span class="ident" id="1355470">i</span><span class="op" id="1355471">]</span><br>
<span class="lineno"></span><span class="op" id="1355473">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="1355476">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1355552">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="1355610">func</span>&nbsp;<span class="ident" id="1355615">TrimFunc</span><span class="op" id="1355623">(</span><span class="ident" id="1355624">s</span>&nbsp;<span class="op" id="1355626">[</span><span class="op" id="1355627">]</span><span class="builtintype" id="1355628">byte</span><span class="op" id="1355632">,</span>&nbsp;<span class="ident" id="1355634">f</span>&nbsp;<span class="keyword" id="1355636">func</span><span class="op" id="1355640">(</span><span class="ident" id="1355641">r</span>&nbsp;<span class="builtintype" id="1355643">rune</span><span class="op" id="1355647">)</span>&nbsp;<span class="builtintype" id="1355649">bool</span><span class="op" id="1355653">)</span>&nbsp;<span class="op" id="1355655">[</span><span class="op" id="1355656">]</span><span class="builtintype" id="1355657">byte</span>&nbsp;<span class="op" id="1355662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355665">return</span>&nbsp;<span class="ident" id="1355672">TrimRightFunc</span><span class="op" id="1355685">(</span><span class="ident" id="1355686">TrimLeftFunc</span><span class="op" id="1355698">(</span><span class="ident" id="1355699">s</span><span class="op" id="1355700">,</span>&nbsp;<span class="ident" id="1355702">f</span><span class="op" id="1355703">)</span><span class="op" id="1355704">,</span>&nbsp;<span class="ident" id="1355706">f</span><span class="op" id="1355707">)</span><br>
<span class="lineno">490</span><span class="op" id="1355709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1355712">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1355780">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1355840">func</span>&nbsp;<span class="ident" id="1355845">TrimPrefix</span><span class="op" id="1355855">(</span><span class="ident" id="1355856">s</span><span class="op" id="1355857">,</span>&nbsp;<span class="ident" id="1355859">prefix</span>&nbsp;<span class="op" id="1355866">[</span><span class="op" id="1355867">]</span><span class="builtintype" id="1355868">byte</span><span class="op" id="1355872">)</span>&nbsp;<span class="op" id="1355874">[</span><span class="op" id="1355875">]</span><span class="builtintype" id="1355876">byte</span>&nbsp;<span class="op" id="1355881">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355884">if</span>&nbsp;<span class="ident" id="1355887">HasPrefix</span><span class="op" id="1355896">(</span><span class="ident" id="1355897">s</span><span class="op" id="1355898">,</span>&nbsp;<span class="ident" id="1355900">prefix</span><span class="op" id="1355906">)</span>&nbsp;<span class="op" id="1355908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355912">return</span>&nbsp;<span class="ident" id="1355919">s</span><span class="op" id="1355920">[</span><span class="builtinfunc" id="1355921">len</span><span class="op" id="1355924">(</span><span class="ident" id="1355925">prefix</span><span class="op" id="1355931">)</span><span class="op" id="1355932">:</span><span class="op" id="1355933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1355936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1355939">return</span>&nbsp;<span class="ident" id="1355946">s</span><br>
<span class="lineno"></span><span class="op" id="1355948">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="1355951">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1356020">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1356078">func</span>&nbsp;<span class="ident" id="1356083">TrimSuffix</span><span class="op" id="1356093">(</span><span class="ident" id="1356094">s</span><span class="op" id="1356095">,</span>&nbsp;<span class="ident" id="1356097">suffix</span>&nbsp;<span class="op" id="1356104">[</span><span class="op" id="1356105">]</span><span class="builtintype" id="1356106">byte</span><span class="op" id="1356110">)</span>&nbsp;<span class="op" id="1356112">[</span><span class="op" id="1356113">]</span><span class="builtintype" id="1356114">byte</span>&nbsp;<span class="op" id="1356119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356122">if</span>&nbsp;<span class="ident" id="1356125">HasSuffix</span><span class="op" id="1356134">(</span><span class="ident" id="1356135">s</span><span class="op" id="1356136">,</span>&nbsp;<span class="ident" id="1356138">suffix</span><span class="op" id="1356144">)</span>&nbsp;<span class="op" id="1356146">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356150">return</span>&nbsp;<span class="ident" id="1356157">s</span><span class="op" id="1356158">[</span><span class="op" id="1356159">:</span><span class="builtinfunc" id="1356160">len</span><span class="op" id="1356163">(</span><span class="ident" id="1356164">s</span><span class="op" id="1356165">)</span><span class="op" id="1356166">-</span><span class="builtinfunc" id="1356167">len</span><span class="op" id="1356170">(</span><span class="ident" id="1356171">suffix</span><span class="op" id="1356177">)</span><span class="op" id="1356178">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1356181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356184">return</span>&nbsp;<span class="ident" id="1356191">s</span><br>
<span class="lineno"></span><span class="op" id="1356193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="1356196">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1356274">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1356329">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="1356378">func</span>&nbsp;<span class="ident" id="1356383">IndexFunc</span><span class="op" id="1356392">(</span><span class="ident" id="1356393">s</span>&nbsp;<span class="op" id="1356395">[</span><span class="op" id="1356396">]</span><span class="builtintype" id="1356397">byte</span><span class="op" id="1356401">,</span>&nbsp;<span class="ident" id="1356403">f</span>&nbsp;<span class="keyword" id="1356405">func</span><span class="op" id="1356409">(</span><span class="ident" id="1356410">r</span>&nbsp;<span class="builtintype" id="1356412">rune</span><span class="op" id="1356416">)</span>&nbsp;<span class="builtintype" id="1356418">bool</span><span class="op" id="1356422">)</span>&nbsp;<span class="builtintype" id="1356424">int</span>&nbsp;<span class="op" id="1356428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356431">return</span>&nbsp;<span class="ident" id="1356438">indexFunc</span><span class="op" id="1356447">(</span><span class="ident" id="1356448">s</span><span class="op" id="1356449">,</span>&nbsp;<span class="ident" id="1356451">f</span><span class="op" id="1356452">,</span>&nbsp;<span class="builtintype" id="1356454">true</span><span class="op" id="1356458">)</span><br>
<span class="lineno">515</span><span class="op" id="1356460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1356463">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1356545">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1356599">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="1356648">func</span>&nbsp;<span class="ident" id="1356653">LastIndexFunc</span><span class="op" id="1356666">(</span><span class="ident" id="1356667">s</span>&nbsp;<span class="op" id="1356669">[</span><span class="op" id="1356670">]</span><span class="builtintype" id="1356671">byte</span><span class="op" id="1356675">,</span>&nbsp;<span class="ident" id="1356677">f</span>&nbsp;<span class="keyword" id="1356679">func</span><span class="op" id="1356683">(</span><span class="ident" id="1356684">r</span>&nbsp;<span class="builtintype" id="1356686">rune</span><span class="op" id="1356690">)</span>&nbsp;<span class="builtintype" id="1356692">bool</span><span class="op" id="1356696">)</span>&nbsp;<span class="builtintype" id="1356698">int</span>&nbsp;<span class="op" id="1356702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356705">return</span>&nbsp;<span class="ident" id="1356712">lastIndexFunc</span><span class="op" id="1356725">(</span><span class="ident" id="1356726">s</span><span class="op" id="1356727">,</span>&nbsp;<span class="ident" id="1356729">f</span><span class="op" id="1356730">,</span>&nbsp;<span class="builtintype" id="1356732">true</span><span class="op" id="1356736">)</span><br>
<span class="lineno"></span><span class="op" id="1356738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1356741">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="1356794">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1356850">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1356863">func</span>&nbsp;<span class="ident" id="1356868">indexFunc</span><span class="op" id="1356877">(</span><span class="ident" id="1356878">s</span>&nbsp;<span class="op" id="1356880">[</span><span class="op" id="1356881">]</span><span class="builtintype" id="1356882">byte</span><span class="op" id="1356886">,</span>&nbsp;<span class="ident" id="1356888">f</span>&nbsp;<span class="keyword" id="1356890">func</span><span class="op" id="1356894">(</span><span class="ident" id="1356895">r</span>&nbsp;<span class="builtintype" id="1356897">rune</span><span class="op" id="1356901">)</span>&nbsp;<span class="builtintype" id="1356903">bool</span><span class="op" id="1356907">,</span>&nbsp;<span class="ident" id="1356909">truth</span>&nbsp;<span class="builtintype" id="1356915">bool</span><span class="op" id="1356919">)</span>&nbsp;<span class="builtintype" id="1356921">int</span>&nbsp;<span class="op" id="1356925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356928">start</span>&nbsp;<span class="op" id="1356934">:=</span>&nbsp;<span class="num" id="1356937">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356940">for</span>&nbsp;<span class="ident" id="1356944">start</span>&nbsp;<span class="op" id="1356950">&lt;</span>&nbsp;<span class="builtinfunc" id="1356952">len</span><span class="op" id="1356955">(</span><span class="ident" id="1356956">s</span><span class="op" id="1356957">)</span>&nbsp;<span class="op" id="1356959">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356963">wid</span>&nbsp;<span class="op" id="1356967">:=</span>&nbsp;<span class="num" id="1356970">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1356974">r</span>&nbsp;<span class="op" id="1356976">:=</span>&nbsp;<span class="builtintype" id="1356979">rune</span><span class="op" id="1356983">(</span><span class="ident" id="1356984">s</span><span class="op" id="1356985">[</span><span class="ident" id="1356986">start</span><span class="op" id="1356991">]</span><span class="op" id="1356992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1356996">if</span>&nbsp;<span class="ident" id="1356999">r</span>&nbsp;<span class="op" id="1357001">&gt;=</span>&nbsp;<span class="ident" id="1357004">utf8</span><span class="op" id="1357008">.</span><span class="ident" id="1357009">RuneSelf</span>&nbsp;<span class="op" id="1357018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357023">r</span><span class="op" id="1357024">,</span>&nbsp;<span class="ident" id="1357026">wid</span>&nbsp;<span class="op" id="1357030">=</span>&nbsp;<span class="ident" id="1357032">utf8</span><span class="op" id="1357036">.</span><span class="ident" id="1357037">DecodeRune</span><span class="op" id="1357047">(</span><span class="ident" id="1357048">s</span><span class="op" id="1357049">[</span><span class="ident" id="1357050">start</span><span class="op" id="1357055">:</span><span class="op" id="1357056">]</span><span class="op" id="1357057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357061">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357065">if</span>&nbsp;<span class="ident" id="1357068">f</span><span class="op" id="1357069">(</span><span class="ident" id="1357070">r</span><span class="op" id="1357071">)</span>&nbsp;<span class="op" id="1357073">==</span>&nbsp;<span class="ident" id="1357076">truth</span>&nbsp;<span class="op" id="1357082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357087">return</span>&nbsp;<span class="ident" id="1357094">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357106">start</span>&nbsp;<span class="op" id="1357112">+=</span>&nbsp;<span class="ident" id="1357115">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357120">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357123">return</span>&nbsp;<span class="op" id="1357130">-</span><span class="num" id="1357131">1</span><br>
<span class="lineno"></span><span class="op" id="1357133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1357136">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1357197">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="1357253">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1357266">func</span>&nbsp;<span class="ident" id="1357271">lastIndexFunc</span><span class="op" id="1357284">(</span><span class="ident" id="1357285">s</span>&nbsp;<span class="op" id="1357287">[</span><span class="op" id="1357288">]</span><span class="builtintype" id="1357289">byte</span><span class="op" id="1357293">,</span>&nbsp;<span class="ident" id="1357295">f</span>&nbsp;<span class="keyword" id="1357297">func</span><span class="op" id="1357301">(</span><span class="ident" id="1357302">r</span>&nbsp;<span class="builtintype" id="1357304">rune</span><span class="op" id="1357308">)</span>&nbsp;<span class="builtintype" id="1357310">bool</span><span class="op" id="1357314">,</span>&nbsp;<span class="ident" id="1357316">truth</span>&nbsp;<span class="builtintype" id="1357322">bool</span><span class="op" id="1357326">)</span>&nbsp;<span class="builtintype" id="1357328">int</span>&nbsp;<span class="op" id="1357332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357335">for</span>&nbsp;<span class="ident" id="1357339">i</span>&nbsp;<span class="op" id="1357341">:=</span>&nbsp;<span class="builtinfunc" id="1357344">len</span><span class="op" id="1357347">(</span><span class="ident" id="1357348">s</span><span class="op" id="1357349">)</span><span class="op" id="1357350">;</span>&nbsp;<span class="ident" id="1357352">i</span>&nbsp;<span class="op" id="1357354">&gt;</span>&nbsp;<span class="num" id="1357356">0</span><span class="op" id="1357357">;</span>&nbsp;<span class="op" id="1357359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357363">r</span><span class="op" id="1357364">,</span>&nbsp;<span class="ident" id="1357366">size</span>&nbsp;<span class="op" id="1357371">:=</span>&nbsp;<span class="builtintype" id="1357374">rune</span><span class="op" id="1357378">(</span><span class="ident" id="1357379">s</span><span class="op" id="1357380">[</span><span class="ident" id="1357381">i</span><span class="op" id="1357382">-</span><span class="num" id="1357383">1</span><span class="op" id="1357384">]</span><span class="op" id="1357385">)</span><span class="op" id="1357386">,</span>&nbsp;<span class="num" id="1357388">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357392">if</span>&nbsp;<span class="ident" id="1357395">r</span>&nbsp;<span class="op" id="1357397">&gt;=</span>&nbsp;<span class="ident" id="1357400">utf8</span><span class="op" id="1357404">.</span><span class="ident" id="1357405">RuneSelf</span>&nbsp;<span class="op" id="1357414">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357419">r</span><span class="op" id="1357420">,</span>&nbsp;<span class="ident" id="1357422">size</span>&nbsp;<span class="op" id="1357427">=</span>&nbsp;<span class="ident" id="1357429">utf8</span><span class="op" id="1357433">.</span><span class="ident" id="1357434">DecodeLastRune</span><span class="op" id="1357448">(</span><span class="ident" id="1357449">s</span><span class="op" id="1357450">[</span><span class="num" id="1357451">0</span><span class="op" id="1357452">:</span><span class="ident" id="1357453">i</span><span class="op" id="1357454">]</span><span class="op" id="1357455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1357463">i</span>&nbsp;<span class="op" id="1357465">-=</span>&nbsp;<span class="ident" id="1357468">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357475">if</span>&nbsp;<span class="ident" id="1357478">f</span><span class="op" id="1357479">(</span><span class="ident" id="1357480">r</span><span class="op" id="1357481">)</span>&nbsp;<span class="op" id="1357483">==</span>&nbsp;<span class="ident" id="1357486">truth</span>&nbsp;<span class="op" id="1357492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357497">return</span>&nbsp;<span class="ident" id="1357504">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357514">return</span>&nbsp;<span class="op" id="1357521">-</span><span class="num" id="1357522">1</span><br>
<span class="lineno"></span><span class="op" id="1357524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="1357527">func</span>&nbsp;<span class="ident" id="1357532">makeCutsetFunc</span><span class="op" id="1357546">(</span><span class="ident" id="1357547">cutset</span>&nbsp;<span class="builtintype" id="1357554">string</span><span class="op" id="1357560">)</span>&nbsp;<span class="keyword" id="1357562">func</span><span class="op" id="1357566">(</span><span class="ident" id="1357567">r</span>&nbsp;<span class="builtintype" id="1357569">rune</span><span class="op" id="1357573">)</span>&nbsp;<span class="builtintype" id="1357575">bool</span>&nbsp;<span class="op" id="1357580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357583">return</span>&nbsp;<span class="keyword" id="1357590">func</span><span class="op" id="1357594">(</span><span class="ident" id="1357595">r</span>&nbsp;<span class="builtintype" id="1357597">rune</span><span class="op" id="1357601">)</span>&nbsp;<span class="builtintype" id="1357603">bool</span>&nbsp;<span class="op" id="1357608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357612">for</span>&nbsp;<span class="ident" id="1357616">_</span><span class="op" id="1357617">,</span>&nbsp;<span class="ident" id="1357619">c</span>&nbsp;<span class="op" id="1357621">:=</span>&nbsp;<span class="keyword" id="1357624">range</span>&nbsp;<span class="ident" id="1357630">cutset</span>&nbsp;<span class="op" id="1357637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357642">if</span>&nbsp;<span class="ident" id="1357645">c</span>&nbsp;<span class="op" id="1357647">==</span>&nbsp;<span class="ident" id="1357650">r</span>&nbsp;<span class="op" id="1357652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357658">return</span>&nbsp;<span class="builtintype" id="1357665">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357681">return</span>&nbsp;<span class="builtintype" id="1357688">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1357695">}</span><br>
<span class="lineno"></span><span class="op" id="1357697">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="1357700">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1357763">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1357830">func</span>&nbsp;<span class="ident" id="1357835">Trim</span><span class="op" id="1357839">(</span><span class="ident" id="1357840">s</span>&nbsp;<span class="op" id="1357842">[</span><span class="op" id="1357843">]</span><span class="builtintype" id="1357844">byte</span><span class="op" id="1357848">,</span>&nbsp;<span class="ident" id="1357850">cutset</span>&nbsp;<span class="builtintype" id="1357857">string</span><span class="op" id="1357863">)</span>&nbsp;<span class="op" id="1357865">[</span><span class="op" id="1357866">]</span><span class="builtintype" id="1357867">byte</span>&nbsp;<span class="op" id="1357872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1357875">return</span>&nbsp;<span class="ident" id="1357882">TrimFunc</span><span class="op" id="1357890">(</span><span class="ident" id="1357891">s</span><span class="op" id="1357892">,</span>&nbsp;<span class="ident" id="1357894">makeCutsetFunc</span><span class="op" id="1357908">(</span><span class="ident" id="1357909">cutset</span><span class="op" id="1357915">)</span><span class="op" id="1357916">)</span><br>
<span class="lineno">575</span><span class="op" id="1357918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1357921">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="1357984">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1358042">func</span>&nbsp;<span class="ident" id="1358047">TrimLeft</span><span class="op" id="1358055">(</span><span class="ident" id="1358056">s</span>&nbsp;<span class="op" id="1358058">[</span><span class="op" id="1358059">]</span><span class="builtintype" id="1358060">byte</span><span class="op" id="1358064">,</span>&nbsp;<span class="ident" id="1358066">cutset</span>&nbsp;<span class="builtintype" id="1358073">string</span><span class="op" id="1358079">)</span>&nbsp;<span class="op" id="1358081">[</span><span class="op" id="1358082">]</span><span class="builtintype" id="1358083">byte</span>&nbsp;<span class="op" id="1358088">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358091">return</span>&nbsp;<span class="ident" id="1358098">TrimLeftFunc</span><span class="op" id="1358110">(</span><span class="ident" id="1358111">s</span><span class="op" id="1358112">,</span>&nbsp;<span class="ident" id="1358114">makeCutsetFunc</span><span class="op" id="1358128">(</span><span class="ident" id="1358129">cutset</span><span class="op" id="1358135">)</span><span class="op" id="1358136">)</span><br>
<span class="lineno"></span><span class="op" id="1358138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1358141">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1358206">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="1358273">func</span>&nbsp;<span class="ident" id="1358278">TrimRight</span><span class="op" id="1358287">(</span><span class="ident" id="1358288">s</span>&nbsp;<span class="op" id="1358290">[</span><span class="op" id="1358291">]</span><span class="builtintype" id="1358292">byte</span><span class="op" id="1358296">,</span>&nbsp;<span class="ident" id="1358298">cutset</span>&nbsp;<span class="builtintype" id="1358305">string</span><span class="op" id="1358311">)</span>&nbsp;<span class="op" id="1358313">[</span><span class="op" id="1358314">]</span><span class="builtintype" id="1358315">byte</span>&nbsp;<span class="op" id="1358320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358323">return</span>&nbsp;<span class="ident" id="1358330">TrimRightFunc</span><span class="op" id="1358343">(</span><span class="ident" id="1358344">s</span><span class="op" id="1358345">,</span>&nbsp;<span class="ident" id="1358347">makeCutsetFunc</span><span class="op" id="1358361">(</span><span class="ident" id="1358362">cutset</span><span class="op" id="1358368">)</span><span class="op" id="1358369">)</span><br>
<span class="lineno"></span><span class="op" id="1358371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1358374">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="1358442">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="1358490">func</span>&nbsp;<span class="ident" id="1358495">TrimSpace</span><span class="op" id="1358504">(</span><span class="ident" id="1358505">s</span>&nbsp;<span class="op" id="1358507">[</span><span class="op" id="1358508">]</span><span class="builtintype" id="1358509">byte</span><span class="op" id="1358513">)</span>&nbsp;<span class="op" id="1358515">[</span><span class="op" id="1358516">]</span><span class="builtintype" id="1358517">byte</span>&nbsp;<span class="op" id="1358522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358525">return</span>&nbsp;<span class="ident" id="1358532">TrimFunc</span><span class="op" id="1358540">(</span><span class="ident" id="1358541">s</span><span class="op" id="1358542">,</span>&nbsp;<span class="ident" id="1358544">unicode</span><span class="op" id="1358551">.</span><span class="ident" id="1358552">IsSpace</span><span class="op" id="1358559">)</span><br>
<span class="lineno"></span><span class="op" id="1358561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="1358564">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1358637">func</span>&nbsp;<span class="ident" id="1358642">Runes</span><span class="op" id="1358647">(</span><span class="ident" id="1358648">s</span>&nbsp;<span class="op" id="1358650">[</span><span class="op" id="1358651">]</span><span class="builtintype" id="1358652">byte</span><span class="op" id="1358656">)</span>&nbsp;<span class="op" id="1358658">[</span><span class="op" id="1358659">]</span><span class="builtintype" id="1358660">rune</span>&nbsp;<span class="op" id="1358665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358668">t</span>&nbsp;<span class="op" id="1358670">:=</span>&nbsp;<span class="builtinfunc" id="1358673">make</span><span class="op" id="1358677">(</span><span class="op" id="1358678">[</span><span class="op" id="1358679">]</span><span class="builtintype" id="1358680">rune</span><span class="op" id="1358684">,</span>&nbsp;<span class="ident" id="1358686">utf8</span><span class="op" id="1358690">.</span><span class="ident" id="1358691">RuneCount</span><span class="op" id="1358700">(</span><span class="ident" id="1358701">s</span><span class="op" id="1358702">)</span><span class="op" id="1358703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358706">i</span>&nbsp;<span class="op" id="1358708">:=</span>&nbsp;<span class="num" id="1358711">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358714">for</span>&nbsp;<span class="builtinfunc" id="1358718">len</span><span class="op" id="1358721">(</span><span class="ident" id="1358722">s</span><span class="op" id="1358723">)</span>&nbsp;<span class="op" id="1358725">&gt;</span>&nbsp;<span class="num" id="1358727">0</span>&nbsp;<span class="op" id="1358729">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358733">r</span><span class="op" id="1358734">,</span>&nbsp;<span class="ident" id="1358736">l</span>&nbsp;<span class="op" id="1358738">:=</span>&nbsp;<span class="ident" id="1358741">utf8</span><span class="op" id="1358745">.</span><span class="ident" id="1358746">DecodeRune</span><span class="op" id="1358756">(</span><span class="ident" id="1358757">s</span><span class="op" id="1358758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358762">t</span><span class="op" id="1358763">[</span><span class="ident" id="1358764">i</span><span class="op" id="1358765">]</span>&nbsp;<span class="op" id="1358767">=</span>&nbsp;<span class="ident" id="1358769">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358773">i</span><span class="op" id="1358774">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358779">s</span>&nbsp;<span class="op" id="1358781">=</span>&nbsp;<span class="ident" id="1358783">s</span><span class="op" id="1358784">[</span><span class="ident" id="1358785">l</span><span class="op" id="1358786">:</span><span class="op" id="1358787">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358790">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358793">return</span>&nbsp;<span class="ident" id="1358800">t</span><br>
<span class="lineno"></span><span class="op" id="1358802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1358805">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1358863">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="1358916">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="1358977">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="1359043">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="1359066">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="1359128">func</span>&nbsp;<span class="ident" id="1359133">Replace</span><span class="op" id="1359140">(</span><span class="ident" id="1359141">s</span><span class="op" id="1359142">,</span>&nbsp;<span class="ident" id="1359144">old</span><span class="op" id="1359147">,</span>&nbsp;<span class="builtinfunc" id="1359149">new</span>&nbsp;<span class="op" id="1359153">[</span><span class="op" id="1359154">]</span><span class="builtintype" id="1359155">byte</span><span class="op" id="1359159">,</span>&nbsp;<span class="ident" id="1359161">n</span>&nbsp;<span class="builtintype" id="1359163">int</span><span class="op" id="1359166">)</span>&nbsp;<span class="op" id="1359168">[</span><span class="op" id="1359169">]</span><span class="builtintype" id="1359170">byte</span>&nbsp;<span class="op" id="1359175">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359178">m</span>&nbsp;<span class="op" id="1359180">:=</span>&nbsp;<span class="num" id="1359183">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359186">if</span>&nbsp;<span class="ident" id="1359189">n</span>&nbsp;<span class="op" id="1359191">!=</span>&nbsp;<span class="num" id="1359194">0</span>&nbsp;<span class="op" id="1359196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1359200">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359237">m</span>&nbsp;<span class="op" id="1359239">=</span>&nbsp;<span class="ident" id="1359241">Count</span><span class="op" id="1359246">(</span><span class="ident" id="1359247">s</span><span class="op" id="1359248">,</span>&nbsp;<span class="ident" id="1359250">old</span><span class="op" id="1359253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359256">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359259">if</span>&nbsp;<span class="ident" id="1359262">m</span>&nbsp;<span class="op" id="1359264">==</span>&nbsp;<span class="num" id="1359267">0</span>&nbsp;<span class="op" id="1359269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1359273">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359298">return</span>&nbsp;<span class="builtinfunc" id="1359305">append</span><span class="op" id="1359311">(</span><span class="op" id="1359312">[</span><span class="op" id="1359313">]</span><span class="builtintype" id="1359314">byte</span><span class="op" id="1359318">(</span><span class="ident" id="1359319">nil</span><span class="op" id="1359322">)</span><span class="op" id="1359323">,</span>&nbsp;<span class="ident" id="1359325">s</span><span class="op" id="1359326">...</span><span class="op" id="1359329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359335">if</span>&nbsp;<span class="ident" id="1359338">n</span>&nbsp;<span class="op" id="1359340">&lt;</span>&nbsp;<span class="num" id="1359342">0</span>&nbsp;<span class="op" id="1359344">||</span>&nbsp;<span class="ident" id="1359347">m</span>&nbsp;<span class="op" id="1359349">&lt;</span>&nbsp;<span class="ident" id="1359351">n</span>&nbsp;<span class="op" id="1359353">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359357">n</span>&nbsp;<span class="op" id="1359359">=</span>&nbsp;<span class="ident" id="1359361">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1359368">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359402">t</span>&nbsp;<span class="op" id="1359404">:=</span>&nbsp;<span class="builtinfunc" id="1359407">make</span><span class="op" id="1359411">(</span><span class="op" id="1359412">[</span><span class="op" id="1359413">]</span><span class="builtintype" id="1359414">byte</span><span class="op" id="1359418">,</span>&nbsp;<span class="builtinfunc" id="1359420">len</span><span class="op" id="1359423">(</span><span class="ident" id="1359424">s</span><span class="op" id="1359425">)</span><span class="op" id="1359426">+</span><span class="ident" id="1359427">n</span><span class="op" id="1359428">*</span><span class="op" id="1359429">(</span><span class="builtinfunc" id="1359430">len</span><span class="op" id="1359433">(</span><span class="builtinfunc" id="1359434">new</span><span class="op" id="1359437">)</span><span class="op" id="1359438">-</span><span class="builtinfunc" id="1359439">len</span><span class="op" id="1359442">(</span><span class="ident" id="1359443">old</span><span class="op" id="1359446">)</span><span class="op" id="1359447">)</span><span class="op" id="1359448">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359451">w</span>&nbsp;<span class="op" id="1359453">:=</span>&nbsp;<span class="num" id="1359456">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359459">start</span>&nbsp;<span class="op" id="1359465">:=</span>&nbsp;<span class="num" id="1359468">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359471">for</span>&nbsp;<span class="ident" id="1359475">i</span>&nbsp;<span class="op" id="1359477">:=</span>&nbsp;<span class="num" id="1359480">0</span><span class="op" id="1359481">;</span>&nbsp;<span class="ident" id="1359483">i</span>&nbsp;<span class="op" id="1359485">&lt;</span>&nbsp;<span class="ident" id="1359487">n</span><span class="op" id="1359488">;</span>&nbsp;<span class="ident" id="1359490">i</span><span class="op" id="1359491">++</span>&nbsp;<span class="op" id="1359494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359498">j</span>&nbsp;<span class="op" id="1359500">:=</span>&nbsp;<span class="ident" id="1359503">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359511">if</span>&nbsp;<span class="builtinfunc" id="1359514">len</span><span class="op" id="1359517">(</span><span class="ident" id="1359518">old</span><span class="op" id="1359521">)</span>&nbsp;<span class="op" id="1359523">==</span>&nbsp;<span class="num" id="1359526">0</span>&nbsp;<span class="op" id="1359528">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359533">if</span>&nbsp;<span class="ident" id="1359536">i</span>&nbsp;<span class="op" id="1359538">&gt;</span>&nbsp;<span class="num" id="1359540">0</span>&nbsp;<span class="op" id="1359542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359548">_</span><span class="op" id="1359549">,</span>&nbsp;<span class="ident" id="1359551">wid</span>&nbsp;<span class="op" id="1359555">:=</span>&nbsp;<span class="ident" id="1359558">utf8</span><span class="op" id="1359562">.</span><span class="ident" id="1359563">DecodeRune</span><span class="op" id="1359573">(</span><span class="ident" id="1359574">s</span><span class="op" id="1359575">[</span><span class="ident" id="1359576">start</span><span class="op" id="1359581">:</span><span class="op" id="1359582">]</span><span class="op" id="1359583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359589">j</span>&nbsp;<span class="op" id="1359591">+=</span>&nbsp;<span class="ident" id="1359594">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359605">}</span>&nbsp;<span class="keyword" id="1359607">else</span>&nbsp;<span class="op" id="1359612">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359617">j</span>&nbsp;<span class="op" id="1359619">+=</span>&nbsp;<span class="ident" id="1359622">Index</span><span class="op" id="1359627">(</span><span class="ident" id="1359628">s</span><span class="op" id="1359629">[</span><span class="ident" id="1359630">start</span><span class="op" id="1359635">:</span><span class="op" id="1359636">]</span><span class="op" id="1359637">,</span>&nbsp;<span class="ident" id="1359639">old</span><span class="op" id="1359642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359650">w</span>&nbsp;<span class="op" id="1359652">+=</span>&nbsp;<span class="builtinfunc" id="1359655">copy</span><span class="op" id="1359659">(</span><span class="ident" id="1359660">t</span><span class="op" id="1359661">[</span><span class="ident" id="1359662">w</span><span class="op" id="1359663">:</span><span class="op" id="1359664">]</span><span class="op" id="1359665">,</span>&nbsp;<span class="ident" id="1359667">s</span><span class="op" id="1359668">[</span><span class="ident" id="1359669">start</span><span class="op" id="1359674">:</span><span class="ident" id="1359675">j</span><span class="op" id="1359676">]</span><span class="op" id="1359677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359681">w</span>&nbsp;<span class="op" id="1359683">+=</span>&nbsp;<span class="builtinfunc" id="1359686">copy</span><span class="op" id="1359690">(</span><span class="ident" id="1359691">t</span><span class="op" id="1359692">[</span><span class="ident" id="1359693">w</span><span class="op" id="1359694">:</span><span class="op" id="1359695">]</span><span class="op" id="1359696">,</span>&nbsp;<span class="builtinfunc" id="1359698">new</span><span class="op" id="1359701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359705">start</span>&nbsp;<span class="op" id="1359711">=</span>&nbsp;<span class="ident" id="1359713">j</span>&nbsp;<span class="op" id="1359715">+</span>&nbsp;<span class="builtinfunc" id="1359717">len</span><span class="op" id="1359720">(</span><span class="ident" id="1359721">old</span><span class="op" id="1359724">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1359730">w</span>&nbsp;<span class="op" id="1359732">+=</span>&nbsp;<span class="builtinfunc" id="1359735">copy</span><span class="op" id="1359739">(</span><span class="ident" id="1359740">t</span><span class="op" id="1359741">[</span><span class="ident" id="1359742">w</span><span class="op" id="1359743">:</span><span class="op" id="1359744">]</span><span class="op" id="1359745">,</span>&nbsp;<span class="ident" id="1359747">s</span><span class="op" id="1359748">[</span><span class="ident" id="1359749">start</span><span class="op" id="1359754">:</span><span class="op" id="1359755">]</span><span class="op" id="1359756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359759">return</span>&nbsp;<span class="ident" id="1359766">t</span><span class="op" id="1359767">[</span><span class="num" id="1359768">0</span><span class="op" id="1359769">:</span><span class="ident" id="1359770">w</span><span class="op" id="1359771">]</span><br>
<span class="lineno"></span><span class="op" id="1359773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="1359776">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="1359844">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="1359885">func</span>&nbsp;<span class="ident" id="1359890">EqualFold</span><span class="op" id="1359899">(</span><span class="ident" id="1359900">s</span><span class="op" id="1359901">,</span>&nbsp;<span class="ident" id="1359903">t</span>&nbsp;<span class="op" id="1359905">[</span><span class="op" id="1359906">]</span><span class="builtintype" id="1359907">byte</span><span class="op" id="1359911">)</span>&nbsp;<span class="builtintype" id="1359913">bool</span>&nbsp;<span class="op" id="1359918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359921">for</span>&nbsp;<span class="builtinfunc" id="1359925">len</span><span class="op" id="1359928">(</span><span class="ident" id="1359929">s</span><span class="op" id="1359930">)</span>&nbsp;<span class="op" id="1359932">!=</span>&nbsp;<span class="num" id="1359935">0</span>&nbsp;<span class="op" id="1359937">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1359940">len</span><span class="op" id="1359943">(</span><span class="ident" id="1359944">t</span><span class="op" id="1359945">)</span>&nbsp;<span class="op" id="1359947">!=</span>&nbsp;<span class="num" id="1359950">0</span>&nbsp;<span class="op" id="1359952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1359956">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1359991">var</span>&nbsp;<span class="ident" id="1359995">sr</span><span class="op" id="1359997">,</span>&nbsp;<span class="ident" id="1359999">tr</span>&nbsp;<span class="builtintype" id="1360002">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360009">if</span>&nbsp;<span class="ident" id="1360012">s</span><span class="op" id="1360013">[</span><span class="num" id="1360014">0</span><span class="op" id="1360015">]</span>&nbsp;<span class="op" id="1360017">&lt;</span>&nbsp;<span class="ident" id="1360019">utf8</span><span class="op" id="1360023">.</span><span class="ident" id="1360024">RuneSelf</span>&nbsp;<span class="op" id="1360033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360038">sr</span><span class="op" id="1360040">,</span>&nbsp;<span class="ident" id="1360042">s</span>&nbsp;<span class="op" id="1360044">=</span>&nbsp;<span class="builtintype" id="1360046">rune</span><span class="op" id="1360050">(</span><span class="ident" id="1360051">s</span><span class="op" id="1360052">[</span><span class="num" id="1360053">0</span><span class="op" id="1360054">]</span><span class="op" id="1360055">)</span><span class="op" id="1360056">,</span>&nbsp;<span class="ident" id="1360058">s</span><span class="op" id="1360059">[</span><span class="num" id="1360060">1</span><span class="op" id="1360061">:</span><span class="op" id="1360062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360066">}</span>&nbsp;<span class="keyword" id="1360068">else</span>&nbsp;<span class="op" id="1360073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360078">r</span><span class="op" id="1360079">,</span>&nbsp;<span class="ident" id="1360081">size</span>&nbsp;<span class="op" id="1360086">:=</span>&nbsp;<span class="ident" id="1360089">utf8</span><span class="op" id="1360093">.</span><span class="ident" id="1360094">DecodeRune</span><span class="op" id="1360104">(</span><span class="ident" id="1360105">s</span><span class="op" id="1360106">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360111">sr</span><span class="op" id="1360113">,</span>&nbsp;<span class="ident" id="1360115">s</span>&nbsp;<span class="op" id="1360117">=</span>&nbsp;<span class="ident" id="1360119">r</span><span class="op" id="1360120">,</span>&nbsp;<span class="ident" id="1360122">s</span><span class="op" id="1360123">[</span><span class="ident" id="1360124">size</span><span class="op" id="1360128">:</span><span class="op" id="1360129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360137">if</span>&nbsp;<span class="ident" id="1360140">t</span><span class="op" id="1360141">[</span><span class="num" id="1360142">0</span><span class="op" id="1360143">]</span>&nbsp;<span class="op" id="1360145">&lt;</span>&nbsp;<span class="ident" id="1360147">utf8</span><span class="op" id="1360151">.</span><span class="ident" id="1360152">RuneSelf</span>&nbsp;<span class="op" id="1360161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360166">tr</span><span class="op" id="1360168">,</span>&nbsp;<span class="ident" id="1360170">t</span>&nbsp;<span class="op" id="1360172">=</span>&nbsp;<span class="builtintype" id="1360174">rune</span><span class="op" id="1360178">(</span><span class="ident" id="1360179">t</span><span class="op" id="1360180">[</span><span class="num" id="1360181">0</span><span class="op" id="1360182">]</span><span class="op" id="1360183">)</span><span class="op" id="1360184">,</span>&nbsp;<span class="ident" id="1360186">t</span><span class="op" id="1360187">[</span><span class="num" id="1360188">1</span><span class="op" id="1360189">:</span><span class="op" id="1360190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360194">}</span>&nbsp;<span class="keyword" id="1360196">else</span>&nbsp;<span class="op" id="1360201">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360206">r</span><span class="op" id="1360207">,</span>&nbsp;<span class="ident" id="1360209">size</span>&nbsp;<span class="op" id="1360214">:=</span>&nbsp;<span class="ident" id="1360217">utf8</span><span class="op" id="1360221">.</span><span class="ident" id="1360222">DecodeRune</span><span class="op" id="1360232">(</span><span class="ident" id="1360233">t</span><span class="op" id="1360234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360239">tr</span><span class="op" id="1360241">,</span>&nbsp;<span class="ident" id="1360243">t</span>&nbsp;<span class="op" id="1360245">=</span>&nbsp;<span class="ident" id="1360247">r</span><span class="op" id="1360248">,</span>&nbsp;<span class="ident" id="1360250">t</span><span class="op" id="1360251">[</span><span class="ident" id="1360252">size</span><span class="op" id="1360256">:</span><span class="op" id="1360257">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360266">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360321">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360337">if</span>&nbsp;<span class="ident" id="1360340">tr</span>&nbsp;<span class="op" id="1360343">==</span>&nbsp;<span class="ident" id="1360346">sr</span>&nbsp;<span class="op" id="1360349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360354">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360365">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360370">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360414">if</span>&nbsp;<span class="ident" id="1360417">tr</span>&nbsp;<span class="op" id="1360420">&lt;</span>&nbsp;<span class="ident" id="1360422">sr</span>&nbsp;<span class="op" id="1360425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360430">tr</span><span class="op" id="1360432">,</span>&nbsp;<span class="ident" id="1360434">sr</span>&nbsp;<span class="op" id="1360437">=</span>&nbsp;<span class="ident" id="1360439">sr</span><span class="op" id="1360441">,</span>&nbsp;<span class="ident" id="1360443">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360448">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360452">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360479">if</span>&nbsp;<span class="ident" id="1360482">tr</span>&nbsp;<span class="op" id="1360485">&lt;</span>&nbsp;<span class="ident" id="1360487">utf8</span><span class="op" id="1360491">.</span><span class="ident" id="1360492">RuneSelf</span>&nbsp;<span class="op" id="1360501">&amp;&amp;</span>&nbsp;<span class="string" id="1360504">&#39;A&#39;</span>&nbsp;<span class="op" id="1360508">&lt;=</span>&nbsp;<span class="ident" id="1360511">sr</span>&nbsp;<span class="op" id="1360514">&amp;&amp;</span>&nbsp;<span class="ident" id="1360517">sr</span>&nbsp;<span class="op" id="1360520">&lt;=</span>&nbsp;<span class="string" id="1360523">&#39;Z&#39;</span>&nbsp;<span class="op" id="1360527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360532">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360591">if</span>&nbsp;<span class="ident" id="1360594">tr</span>&nbsp;<span class="op" id="1360597">==</span>&nbsp;<span class="ident" id="1360600">sr</span><span class="op" id="1360602">+</span><span class="string" id="1360603">&#39;a&#39;</span><span class="op" id="1360606">-</span><span class="string" id="1360607">&#39;A&#39;</span>&nbsp;<span class="op" id="1360611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360617">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360634">return</span>&nbsp;<span class="builtintype" id="1360641">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360654">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360725">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360765">r</span>&nbsp;<span class="op" id="1360767">:=</span>&nbsp;<span class="ident" id="1360770">unicode</span><span class="op" id="1360777">.</span><span class="ident" id="1360778">SimpleFold</span><span class="op" id="1360788">(</span><span class="ident" id="1360789">sr</span><span class="op" id="1360791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360795">for</span>&nbsp;<span class="ident" id="1360799">r</span>&nbsp;<span class="op" id="1360801">!=</span>&nbsp;<span class="ident" id="1360804">sr</span>&nbsp;<span class="op" id="1360807">&amp;&amp;</span>&nbsp;<span class="ident" id="1360810">r</span>&nbsp;<span class="op" id="1360812">&lt;</span>&nbsp;<span class="ident" id="1360814">tr</span>&nbsp;<span class="op" id="1360817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1360822">r</span>&nbsp;<span class="op" id="1360824">=</span>&nbsp;<span class="ident" id="1360826">unicode</span><span class="op" id="1360833">.</span><span class="ident" id="1360834">SimpleFold</span><span class="op" id="1360844">(</span><span class="ident" id="1360845">r</span><span class="op" id="1360846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360850">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360854">if</span>&nbsp;<span class="ident" id="1360857">r</span>&nbsp;<span class="op" id="1360859">==</span>&nbsp;<span class="ident" id="1360862">tr</span>&nbsp;<span class="op" id="1360865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360870">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360885">return</span>&nbsp;<span class="builtintype" id="1360892">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360899">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360903">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1360939">return</span>&nbsp;<span class="builtinfunc" id="1360946">len</span><span class="op" id="1360949">(</span><span class="ident" id="1360950">s</span><span class="op" id="1360951">)</span>&nbsp;<span class="op" id="1360953">==</span>&nbsp;<span class="builtinfunc" id="1360956">len</span><span class="op" id="1360959">(</span><span class="ident" id="1360960">t</span><span class="op" id="1360961">)</span><br>
<span class="lineno"></span><span class="op" id="1360963">}</span>
</div>
</body>
</html>
