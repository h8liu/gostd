<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4457691">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4457746">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4457800">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4457851">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4457926">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4457937">package</span>&nbsp;<span class="ident" id="4457945">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4457955">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4458030">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4458105">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4458185">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4458260">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4458334">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4458399">import</span>&nbsp;<span class="op" id="4458406">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4458409">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4458415">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4458427">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4458434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4458437">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4458501">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4458562">type</span>&nbsp;<span class="ident" id="4458567">Curve</span>&nbsp;<span class="keyword" id="4458573">interface</span>&nbsp;<span class="op" id="4458583">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458586">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458635">Params</span><span class="op" id="4458641">(</span><span class="op" id="4458642">)</span>&nbsp;<span class="op" id="4458644">*</span><span class="ident" id="4458645">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458658">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458723">IsOnCurve</span><span class="op" id="4458732">(</span><span class="ident" id="4458733">x</span><span class="op" id="4458734">,</span>&nbsp;<span class="ident" id="4458736">y</span>&nbsp;<span class="op" id="4458738">*</span><span class="ident" id="4458739">big</span><span class="op" id="4458742">.</span><span class="ident" id="4458743">Int</span><span class="op" id="4458746">)</span>&nbsp;<span class="builtintype" id="4458748">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458754">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458801">Add</span><span class="op" id="4458804">(</span><span class="ident" id="4458805">x1</span><span class="op" id="4458807">,</span>&nbsp;<span class="ident" id="4458809">y1</span><span class="op" id="4458811">,</span>&nbsp;<span class="ident" id="4458813">x2</span><span class="op" id="4458815">,</span>&nbsp;<span class="ident" id="4458817">y2</span>&nbsp;<span class="op" id="4458820">*</span><span class="ident" id="4458821">big</span><span class="op" id="4458824">.</span><span class="ident" id="4458825">Int</span><span class="op" id="4458828">)</span>&nbsp;<span class="op" id="4458830">(</span><span class="ident" id="4458831">x</span><span class="op" id="4458832">,</span>&nbsp;<span class="ident" id="4458834">y</span>&nbsp;<span class="op" id="4458836">*</span><span class="ident" id="4458837">big</span><span class="op" id="4458840">.</span><span class="ident" id="4458841">Int</span><span class="op" id="4458844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458847">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458874">Double</span><span class="op" id="4458880">(</span><span class="ident" id="4458881">x1</span><span class="op" id="4458883">,</span>&nbsp;<span class="ident" id="4458885">y1</span>&nbsp;<span class="op" id="4458888">*</span><span class="ident" id="4458889">big</span><span class="op" id="4458892">.</span><span class="ident" id="4458893">Int</span><span class="op" id="4458896">)</span>&nbsp;<span class="op" id="4458898">(</span><span class="ident" id="4458899">x</span><span class="op" id="4458900">,</span>&nbsp;<span class="ident" id="4458902">y</span>&nbsp;<span class="op" id="4458904">*</span><span class="ident" id="4458905">big</span><span class="op" id="4458908">.</span><span class="ident" id="4458909">Int</span><span class="op" id="4458912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458915">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458988">ScalarMult</span><span class="op" id="4458998">(</span><span class="ident" id="4458999">x1</span><span class="op" id="4459001">,</span>&nbsp;<span class="ident" id="4459003">y1</span>&nbsp;<span class="op" id="4459006">*</span><span class="ident" id="4459007">big</span><span class="op" id="4459010">.</span><span class="ident" id="4459011">Int</span><span class="op" id="4459014">,</span>&nbsp;<span class="ident" id="4459016">k</span>&nbsp;<span class="op" id="4459018">[</span><span class="op" id="4459019">]</span><span class="builtintype" id="4459020">byte</span><span class="op" id="4459024">)</span>&nbsp;<span class="op" id="4459026">(</span><span class="ident" id="4459027">x</span><span class="op" id="4459028">,</span>&nbsp;<span class="ident" id="4459030">y</span>&nbsp;<span class="op" id="4459032">*</span><span class="ident" id="4459033">big</span><span class="op" id="4459036">.</span><span class="ident" id="4459037">Int</span><span class="op" id="4459040">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459043">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459114">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459158">ScalarBaseMult</span><span class="op" id="4459172">(</span><span class="ident" id="4459173">k</span>&nbsp;<span class="op" id="4459175">[</span><span class="op" id="4459176">]</span><span class="builtintype" id="4459177">byte</span><span class="op" id="4459181">)</span>&nbsp;<span class="op" id="4459183">(</span><span class="ident" id="4459184">x</span><span class="op" id="4459185">,</span>&nbsp;<span class="ident" id="4459187">y</span>&nbsp;<span class="op" id="4459189">*</span><span class="ident" id="4459190">big</span><span class="op" id="4459193">.</span><span class="ident" id="4459194">Int</span><span class="op" id="4459197">)</span><br>
<span class="lineno"></span><span class="op" id="4459199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4459202">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4459280">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4459337">type</span>&nbsp;<span class="ident" id="4459342">CurveParams</span>&nbsp;<span class="keyword" id="4459354">struct</span>&nbsp;<span class="op" id="4459361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459364">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4459372">*</span><span class="ident" id="4459373">big</span><span class="op" id="4459376">.</span><span class="ident" id="4459377">Int</span>&nbsp;<span class="comment" id="4459381">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459419">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4459427">*</span><span class="ident" id="4459428">big</span><span class="op" id="4459431">.</span><span class="ident" id="4459432">Int</span>&nbsp;<span class="comment" id="4459436">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459468">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4459476">*</span><span class="ident" id="4459477">big</span><span class="op" id="4459480">.</span><span class="ident" id="4459481">Int</span>&nbsp;<span class="comment" id="4459485">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459524">Gx</span><span class="op" id="4459526">,</span>&nbsp;<span class="ident" id="4459528">Gy</span>&nbsp;&nbsp;<span class="op" id="4459532">*</span><span class="ident" id="4459533">big</span><span class="op" id="4459536">.</span><span class="ident" id="4459537">Int</span>&nbsp;<span class="comment" id="4459541">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459569">BitSize</span>&nbsp;<span class="builtintype" id="4459577">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4459586">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4459622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4459625">func</span>&nbsp;<span class="op" id="4459630">(</span><span class="ident" id="4459631">curve</span>&nbsp;<span class="op" id="4459637">*</span><span class="ident" id="4459638">CurveParams</span><span class="op" id="4459649">)</span>&nbsp;<span class="ident" id="4459651">Params</span><span class="op" id="4459657">(</span><span class="op" id="4459658">)</span>&nbsp;<span class="op" id="4459660">*</span><span class="ident" id="4459661">CurveParams</span>&nbsp;<span class="op" id="4459673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459676">return</span>&nbsp;<span class="ident" id="4459683">curve</span><br>
<span class="lineno"></span><span class="op" id="4459689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4459692">func</span>&nbsp;<span class="op" id="4459697">(</span><span class="ident" id="4459698">curve</span>&nbsp;<span class="op" id="4459704">*</span><span class="ident" id="4459705">CurveParams</span><span class="op" id="4459716">)</span>&nbsp;<span class="ident" id="4459718">IsOnCurve</span><span class="op" id="4459727">(</span><span class="ident" id="4459728">x</span><span class="op" id="4459729">,</span>&nbsp;<span class="ident" id="4459731">y</span>&nbsp;<span class="op" id="4459733">*</span><span class="ident" id="4459734">big</span><span class="op" id="4459737">.</span><span class="ident" id="4459738">Int</span><span class="op" id="4459741">)</span>&nbsp;<span class="builtintype" id="4459743">bool</span>&nbsp;<span class="op" id="4459748">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459751">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459774">y2</span>&nbsp;<span class="op" id="4459777">:=</span>&nbsp;<span class="builtinfunc" id="4459780">new</span><span class="op" id="4459783">(</span><span class="ident" id="4459784">big</span><span class="op" id="4459787">.</span><span class="ident" id="4459788">Int</span><span class="op" id="4459791">)</span><span class="op" id="4459792">.</span><span class="ident" id="4459793">Mul</span><span class="op" id="4459796">(</span><span class="ident" id="4459797">y</span><span class="op" id="4459798">,</span>&nbsp;<span class="ident" id="4459800">y</span><span class="op" id="4459801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459804">y2</span><span class="op" id="4459806">.</span><span class="ident" id="4459807">Mod</span><span class="op" id="4459810">(</span><span class="ident" id="4459811">y2</span><span class="op" id="4459813">,</span>&nbsp;<span class="ident" id="4459815">curve</span><span class="op" id="4459820">.</span><span class="ident" id="4459821">P</span><span class="op" id="4459822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459826">x3</span>&nbsp;<span class="op" id="4459829">:=</span>&nbsp;<span class="builtinfunc" id="4459832">new</span><span class="op" id="4459835">(</span><span class="ident" id="4459836">big</span><span class="op" id="4459839">.</span><span class="ident" id="4459840">Int</span><span class="op" id="4459843">)</span><span class="op" id="4459844">.</span><span class="ident" id="4459845">Mul</span><span class="op" id="4459848">(</span><span class="ident" id="4459849">x</span><span class="op" id="4459850">,</span>&nbsp;<span class="ident" id="4459852">x</span><span class="op" id="4459853">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459856">x3</span><span class="op" id="4459858">.</span><span class="ident" id="4459859">Mul</span><span class="op" id="4459862">(</span><span class="ident" id="4459863">x3</span><span class="op" id="4459865">,</span>&nbsp;<span class="ident" id="4459867">x</span><span class="op" id="4459868">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459872">threeX</span>&nbsp;<span class="op" id="4459879">:=</span>&nbsp;<span class="builtinfunc" id="4459882">new</span><span class="op" id="4459885">(</span><span class="ident" id="4459886">big</span><span class="op" id="4459889">.</span><span class="ident" id="4459890">Int</span><span class="op" id="4459893">)</span><span class="op" id="4459894">.</span><span class="ident" id="4459895">Lsh</span><span class="op" id="4459898">(</span><span class="ident" id="4459899">x</span><span class="op" id="4459900">,</span>&nbsp;<span class="num" id="4459902">1</span><span class="op" id="4459903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459906">threeX</span><span class="op" id="4459912">.</span><span class="ident" id="4459913">Add</span><span class="op" id="4459916">(</span><span class="ident" id="4459917">threeX</span><span class="op" id="4459923">,</span>&nbsp;<span class="ident" id="4459925">x</span><span class="op" id="4459926">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459930">x3</span><span class="op" id="4459932">.</span><span class="ident" id="4459933">Sub</span><span class="op" id="4459936">(</span><span class="ident" id="4459937">x3</span><span class="op" id="4459939">,</span>&nbsp;<span class="ident" id="4459941">threeX</span><span class="op" id="4459947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459950">x3</span><span class="op" id="4459952">.</span><span class="ident" id="4459953">Add</span><span class="op" id="4459956">(</span><span class="ident" id="4459957">x3</span><span class="op" id="4459959">,</span>&nbsp;<span class="ident" id="4459961">curve</span><span class="op" id="4459966">.</span><span class="ident" id="4459967">B</span><span class="op" id="4459968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459971">x3</span><span class="op" id="4459973">.</span><span class="ident" id="4459974">Mod</span><span class="op" id="4459977">(</span><span class="ident" id="4459978">x3</span><span class="op" id="4459980">,</span>&nbsp;<span class="ident" id="4459982">curve</span><span class="op" id="4459987">.</span><span class="ident" id="4459988">P</span><span class="op" id="4459989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459993">return</span>&nbsp;<span class="ident" id="4460000">x3</span><span class="op" id="4460002">.</span><span class="ident" id="4460003">Cmp</span><span class="op" id="4460006">(</span><span class="ident" id="4460007">y2</span><span class="op" id="4460009">)</span>&nbsp;<span class="op" id="4460011">==</span>&nbsp;<span class="num" id="4460014">0</span><br>
<span class="lineno">70</span><span class="op" id="4460016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4460019">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4460098">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4460178">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4460230">func</span>&nbsp;<span class="ident" id="4460235">zForAffine</span><span class="op" id="4460245">(</span><span class="ident" id="4460246">x</span><span class="op" id="4460247">,</span>&nbsp;<span class="ident" id="4460249">y</span>&nbsp;<span class="op" id="4460251">*</span><span class="ident" id="4460252">big</span><span class="op" id="4460255">.</span><span class="ident" id="4460256">Int</span><span class="op" id="4460259">)</span>&nbsp;<span class="op" id="4460261">*</span><span class="ident" id="4460262">big</span><span class="op" id="4460265">.</span><span class="ident" id="4460266">Int</span>&nbsp;<span class="op" id="4460270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460273">z</span>&nbsp;<span class="op" id="4460275">:=</span>&nbsp;<span class="builtinfunc" id="4460278">new</span><span class="op" id="4460281">(</span><span class="ident" id="4460282">big</span><span class="op" id="4460285">.</span><span class="ident" id="4460286">Int</span><span class="op" id="4460289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460292">if</span>&nbsp;<span class="ident" id="4460295">x</span><span class="op" id="4460296">.</span><span class="ident" id="4460297">Sign</span><span class="op" id="4460301">(</span><span class="op" id="4460302">)</span>&nbsp;<span class="op" id="4460304">!=</span>&nbsp;<span class="num" id="4460307">0</span>&nbsp;<span class="op" id="4460309">||</span>&nbsp;<span class="ident" id="4460312">y</span><span class="op" id="4460313">.</span><span class="ident" id="4460314">Sign</span><span class="op" id="4460318">(</span><span class="op" id="4460319">)</span>&nbsp;<span class="op" id="4460321">!=</span>&nbsp;<span class="num" id="4460324">0</span>&nbsp;<span class="op" id="4460326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460330">z</span><span class="op" id="4460331">.</span><span class="ident" id="4460332">SetInt64</span><span class="op" id="4460340">(</span><span class="num" id="4460341">1</span><span class="op" id="4460342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4460345">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460348">return</span>&nbsp;<span class="ident" id="4460355">z</span><br>
<span class="lineno"></span><span class="op" id="4460357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4460360">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4460438">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4460495">func</span>&nbsp;<span class="op" id="4460500">(</span><span class="ident" id="4460501">curve</span>&nbsp;<span class="op" id="4460507">*</span><span class="ident" id="4460508">CurveParams</span><span class="op" id="4460519">)</span>&nbsp;<span class="ident" id="4460521">affineFromJacobian</span><span class="op" id="4460539">(</span><span class="ident" id="4460540">x</span><span class="op" id="4460541">,</span>&nbsp;<span class="ident" id="4460543">y</span><span class="op" id="4460544">,</span>&nbsp;<span class="ident" id="4460546">z</span>&nbsp;<span class="op" id="4460548">*</span><span class="ident" id="4460549">big</span><span class="op" id="4460552">.</span><span class="ident" id="4460553">Int</span><span class="op" id="4460556">)</span>&nbsp;<span class="op" id="4460558">(</span><span class="ident" id="4460559">xOut</span><span class="op" id="4460563">,</span>&nbsp;<span class="ident" id="4460565">yOut</span>&nbsp;<span class="op" id="4460570">*</span><span class="ident" id="4460571">big</span><span class="op" id="4460574">.</span><span class="ident" id="4460575">Int</span><span class="op" id="4460578">)</span>&nbsp;<span class="op" id="4460580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460583">if</span>&nbsp;<span class="ident" id="4460586">z</span><span class="op" id="4460587">.</span><span class="ident" id="4460588">Sign</span><span class="op" id="4460592">(</span><span class="op" id="4460593">)</span>&nbsp;<span class="op" id="4460595">==</span>&nbsp;<span class="num" id="4460598">0</span>&nbsp;<span class="op" id="4460600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460604">return</span>&nbsp;<span class="builtinfunc" id="4460611">new</span><span class="op" id="4460614">(</span><span class="ident" id="4460615">big</span><span class="op" id="4460618">.</span><span class="ident" id="4460619">Int</span><span class="op" id="4460622">)</span><span class="op" id="4460623">,</span>&nbsp;<span class="builtinfunc" id="4460625">new</span><span class="op" id="4460628">(</span><span class="ident" id="4460629">big</span><span class="op" id="4460632">.</span><span class="ident" id="4460633">Int</span><span class="op" id="4460636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4460639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460643">zinv</span>&nbsp;<span class="op" id="4460648">:=</span>&nbsp;<span class="builtinfunc" id="4460651">new</span><span class="op" id="4460654">(</span><span class="ident" id="4460655">big</span><span class="op" id="4460658">.</span><span class="ident" id="4460659">Int</span><span class="op" id="4460662">)</span><span class="op" id="4460663">.</span><span class="ident" id="4460664">ModInverse</span><span class="op" id="4460674">(</span><span class="ident" id="4460675">z</span><span class="op" id="4460676">,</span>&nbsp;<span class="ident" id="4460678">curve</span><span class="op" id="4460683">.</span><span class="ident" id="4460684">P</span><span class="op" id="4460685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460688">zinvsq</span>&nbsp;<span class="op" id="4460695">:=</span>&nbsp;<span class="builtinfunc" id="4460698">new</span><span class="op" id="4460701">(</span><span class="ident" id="4460702">big</span><span class="op" id="4460705">.</span><span class="ident" id="4460706">Int</span><span class="op" id="4460709">)</span><span class="op" id="4460710">.</span><span class="ident" id="4460711">Mul</span><span class="op" id="4460714">(</span><span class="ident" id="4460715">zinv</span><span class="op" id="4460719">,</span>&nbsp;<span class="ident" id="4460721">zinv</span><span class="op" id="4460725">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460729">xOut</span>&nbsp;<span class="op" id="4460734">=</span>&nbsp;<span class="builtinfunc" id="4460736">new</span><span class="op" id="4460739">(</span><span class="ident" id="4460740">big</span><span class="op" id="4460743">.</span><span class="ident" id="4460744">Int</span><span class="op" id="4460747">)</span><span class="op" id="4460748">.</span><span class="ident" id="4460749">Mul</span><span class="op" id="4460752">(</span><span class="ident" id="4460753">x</span><span class="op" id="4460754">,</span>&nbsp;<span class="ident" id="4460756">zinvsq</span><span class="op" id="4460762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460765">xOut</span><span class="op" id="4460769">.</span><span class="ident" id="4460770">Mod</span><span class="op" id="4460773">(</span><span class="ident" id="4460774">xOut</span><span class="op" id="4460778">,</span>&nbsp;<span class="ident" id="4460780">curve</span><span class="op" id="4460785">.</span><span class="ident" id="4460786">P</span><span class="op" id="4460787">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460790">zinvsq</span><span class="op" id="4460796">.</span><span class="ident" id="4460797">Mul</span><span class="op" id="4460800">(</span><span class="ident" id="4460801">zinvsq</span><span class="op" id="4460807">,</span>&nbsp;<span class="ident" id="4460809">zinv</span><span class="op" id="4460813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460816">yOut</span>&nbsp;<span class="op" id="4460821">=</span>&nbsp;<span class="builtinfunc" id="4460823">new</span><span class="op" id="4460826">(</span><span class="ident" id="4460827">big</span><span class="op" id="4460830">.</span><span class="ident" id="4460831">Int</span><span class="op" id="4460834">)</span><span class="op" id="4460835">.</span><span class="ident" id="4460836">Mul</span><span class="op" id="4460839">(</span><span class="ident" id="4460840">y</span><span class="op" id="4460841">,</span>&nbsp;<span class="ident" id="4460843">zinvsq</span><span class="op" id="4460849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460852">yOut</span><span class="op" id="4460856">.</span><span class="ident" id="4460857">Mod</span><span class="op" id="4460860">(</span><span class="ident" id="4460861">yOut</span><span class="op" id="4460865">,</span>&nbsp;<span class="ident" id="4460867">curve</span><span class="op" id="4460872">.</span><span class="ident" id="4460873">P</span><span class="op" id="4460874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460877">return</span><br>
<span class="lineno"></span><span class="op" id="4460884">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4460887">func</span>&nbsp;<span class="op" id="4460892">(</span><span class="ident" id="4460893">curve</span>&nbsp;<span class="op" id="4460899">*</span><span class="ident" id="4460900">CurveParams</span><span class="op" id="4460911">)</span>&nbsp;<span class="ident" id="4460913">Add</span><span class="op" id="4460916">(</span><span class="ident" id="4460917">x1</span><span class="op" id="4460919">,</span>&nbsp;<span class="ident" id="4460921">y1</span><span class="op" id="4460923">,</span>&nbsp;<span class="ident" id="4460925">x2</span><span class="op" id="4460927">,</span>&nbsp;<span class="ident" id="4460929">y2</span>&nbsp;<span class="op" id="4460932">*</span><span class="ident" id="4460933">big</span><span class="op" id="4460936">.</span><span class="ident" id="4460937">Int</span><span class="op" id="4460940">)</span>&nbsp;<span class="op" id="4460942">(</span><span class="op" id="4460943">*</span><span class="ident" id="4460944">big</span><span class="op" id="4460947">.</span><span class="ident" id="4460948">Int</span><span class="op" id="4460951">,</span>&nbsp;<span class="op" id="4460953">*</span><span class="ident" id="4460954">big</span><span class="op" id="4460957">.</span><span class="ident" id="4460958">Int</span><span class="op" id="4460961">)</span>&nbsp;<span class="op" id="4460963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460966">z1</span>&nbsp;<span class="op" id="4460969">:=</span>&nbsp;<span class="ident" id="4460972">zForAffine</span><span class="op" id="4460982">(</span><span class="ident" id="4460983">x1</span><span class="op" id="4460985">,</span>&nbsp;<span class="ident" id="4460987">y1</span><span class="op" id="4460989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460992">z2</span>&nbsp;<span class="op" id="4460995">:=</span>&nbsp;<span class="ident" id="4460998">zForAffine</span><span class="op" id="4461008">(</span><span class="ident" id="4461009">x2</span><span class="op" id="4461011">,</span>&nbsp;<span class="ident" id="4461013">y2</span><span class="op" id="4461015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461018">return</span>&nbsp;<span class="ident" id="4461025">curve</span><span class="op" id="4461030">.</span><span class="ident" id="4461031">affineFromJacobian</span><span class="op" id="4461049">(</span><span class="ident" id="4461050">curve</span><span class="op" id="4461055">.</span><span class="ident" id="4461056">addJacobian</span><span class="op" id="4461067">(</span><span class="ident" id="4461068">x1</span><span class="op" id="4461070">,</span>&nbsp;<span class="ident" id="4461072">y1</span><span class="op" id="4461074">,</span>&nbsp;<span class="ident" id="4461076">z1</span><span class="op" id="4461078">,</span>&nbsp;<span class="ident" id="4461080">x2</span><span class="op" id="4461082">,</span>&nbsp;<span class="ident" id="4461084">y2</span><span class="op" id="4461086">,</span>&nbsp;<span class="ident" id="4461088">z2</span><span class="op" id="4461090">)</span><span class="op" id="4461091">)</span><br>
<span class="lineno">105</span><span class="op" id="4461093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4461096">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4461170">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4461232">func</span>&nbsp;<span class="op" id="4461237">(</span><span class="ident" id="4461238">curve</span>&nbsp;<span class="op" id="4461244">*</span><span class="ident" id="4461245">CurveParams</span><span class="op" id="4461256">)</span>&nbsp;<span class="ident" id="4461258">addJacobian</span><span class="op" id="4461269">(</span><span class="ident" id="4461270">x1</span><span class="op" id="4461272">,</span>&nbsp;<span class="ident" id="4461274">y1</span><span class="op" id="4461276">,</span>&nbsp;<span class="ident" id="4461278">z1</span><span class="op" id="4461280">,</span>&nbsp;<span class="ident" id="4461282">x2</span><span class="op" id="4461284">,</span>&nbsp;<span class="ident" id="4461286">y2</span><span class="op" id="4461288">,</span>&nbsp;<span class="ident" id="4461290">z2</span>&nbsp;<span class="op" id="4461293">*</span><span class="ident" id="4461294">big</span><span class="op" id="4461297">.</span><span class="ident" id="4461298">Int</span><span class="op" id="4461301">)</span>&nbsp;<span class="op" id="4461303">(</span><span class="op" id="4461304">*</span><span class="ident" id="4461305">big</span><span class="op" id="4461308">.</span><span class="ident" id="4461309">Int</span><span class="op" id="4461312">,</span>&nbsp;<span class="op" id="4461314">*</span><span class="ident" id="4461315">big</span><span class="op" id="4461318">.</span><span class="ident" id="4461319">Int</span><span class="op" id="4461322">,</span>&nbsp;<span class="op" id="4461324">*</span><span class="ident" id="4461325">big</span><span class="op" id="4461328">.</span><span class="ident" id="4461329">Int</span><span class="op" id="4461332">)</span>&nbsp;<span class="op" id="4461334">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461337">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461427">x3</span><span class="op" id="4461429">,</span>&nbsp;<span class="ident" id="4461431">y3</span><span class="op" id="4461433">,</span>&nbsp;<span class="ident" id="4461435">z3</span>&nbsp;<span class="op" id="4461438">:=</span>&nbsp;<span class="builtinfunc" id="4461441">new</span><span class="op" id="4461444">(</span><span class="ident" id="4461445">big</span><span class="op" id="4461448">.</span><span class="ident" id="4461449">Int</span><span class="op" id="4461452">)</span><span class="op" id="4461453">,</span>&nbsp;<span class="builtinfunc" id="4461455">new</span><span class="op" id="4461458">(</span><span class="ident" id="4461459">big</span><span class="op" id="4461462">.</span><span class="ident" id="4461463">Int</span><span class="op" id="4461466">)</span><span class="op" id="4461467">,</span>&nbsp;<span class="builtinfunc" id="4461469">new</span><span class="op" id="4461472">(</span><span class="ident" id="4461473">big</span><span class="op" id="4461476">.</span><span class="ident" id="4461477">Int</span><span class="op" id="4461480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461483">if</span>&nbsp;<span class="ident" id="4461486">z1</span><span class="op" id="4461488">.</span><span class="ident" id="4461489">Sign</span><span class="op" id="4461493">(</span><span class="op" id="4461494">)</span>&nbsp;<span class="op" id="4461496">==</span>&nbsp;<span class="num" id="4461499">0</span>&nbsp;<span class="op" id="4461501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461505">x3</span><span class="op" id="4461507">.</span><span class="ident" id="4461508">Set</span><span class="op" id="4461511">(</span><span class="ident" id="4461512">x2</span><span class="op" id="4461514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461518">y3</span><span class="op" id="4461520">.</span><span class="ident" id="4461521">Set</span><span class="op" id="4461524">(</span><span class="ident" id="4461525">y2</span><span class="op" id="4461527">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461531">z3</span><span class="op" id="4461533">.</span><span class="ident" id="4461534">Set</span><span class="op" id="4461537">(</span><span class="ident" id="4461538">z2</span><span class="op" id="4461540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461544">return</span>&nbsp;<span class="ident" id="4461551">x3</span><span class="op" id="4461553">,</span>&nbsp;<span class="ident" id="4461555">y3</span><span class="op" id="4461557">,</span>&nbsp;<span class="ident" id="4461559">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4461563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461566">if</span>&nbsp;<span class="ident" id="4461569">z2</span><span class="op" id="4461571">.</span><span class="ident" id="4461572">Sign</span><span class="op" id="4461576">(</span><span class="op" id="4461577">)</span>&nbsp;<span class="op" id="4461579">==</span>&nbsp;<span class="num" id="4461582">0</span>&nbsp;<span class="op" id="4461584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461588">x3</span><span class="op" id="4461590">.</span><span class="ident" id="4461591">Set</span><span class="op" id="4461594">(</span><span class="ident" id="4461595">x1</span><span class="op" id="4461597">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461601">y3</span><span class="op" id="4461603">.</span><span class="ident" id="4461604">Set</span><span class="op" id="4461607">(</span><span class="ident" id="4461608">y1</span><span class="op" id="4461610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461614">z3</span><span class="op" id="4461616">.</span><span class="ident" id="4461617">Set</span><span class="op" id="4461620">(</span><span class="ident" id="4461621">z1</span><span class="op" id="4461623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461627">return</span>&nbsp;<span class="ident" id="4461634">x3</span><span class="op" id="4461636">,</span>&nbsp;<span class="ident" id="4461638">y3</span><span class="op" id="4461640">,</span>&nbsp;<span class="ident" id="4461642">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4461646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461650">z1z1</span>&nbsp;<span class="op" id="4461655">:=</span>&nbsp;<span class="builtinfunc" id="4461658">new</span><span class="op" id="4461661">(</span><span class="ident" id="4461662">big</span><span class="op" id="4461665">.</span><span class="ident" id="4461666">Int</span><span class="op" id="4461669">)</span><span class="op" id="4461670">.</span><span class="ident" id="4461671">Mul</span><span class="op" id="4461674">(</span><span class="ident" id="4461675">z1</span><span class="op" id="4461677">,</span>&nbsp;<span class="ident" id="4461679">z1</span><span class="op" id="4461681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461684">z1z1</span><span class="op" id="4461688">.</span><span class="ident" id="4461689">Mod</span><span class="op" id="4461692">(</span><span class="ident" id="4461693">z1z1</span><span class="op" id="4461697">,</span>&nbsp;<span class="ident" id="4461699">curve</span><span class="op" id="4461704">.</span><span class="ident" id="4461705">P</span><span class="op" id="4461706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461709">z2z2</span>&nbsp;<span class="op" id="4461714">:=</span>&nbsp;<span class="builtinfunc" id="4461717">new</span><span class="op" id="4461720">(</span><span class="ident" id="4461721">big</span><span class="op" id="4461724">.</span><span class="ident" id="4461725">Int</span><span class="op" id="4461728">)</span><span class="op" id="4461729">.</span><span class="ident" id="4461730">Mul</span><span class="op" id="4461733">(</span><span class="ident" id="4461734">z2</span><span class="op" id="4461736">,</span>&nbsp;<span class="ident" id="4461738">z2</span><span class="op" id="4461740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461743">z2z2</span><span class="op" id="4461747">.</span><span class="ident" id="4461748">Mod</span><span class="op" id="4461751">(</span><span class="ident" id="4461752">z2z2</span><span class="op" id="4461756">,</span>&nbsp;<span class="ident" id="4461758">curve</span><span class="op" id="4461763">.</span><span class="ident" id="4461764">P</span><span class="op" id="4461765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461769">u1</span>&nbsp;<span class="op" id="4461772">:=</span>&nbsp;<span class="builtinfunc" id="4461775">new</span><span class="op" id="4461778">(</span><span class="ident" id="4461779">big</span><span class="op" id="4461782">.</span><span class="ident" id="4461783">Int</span><span class="op" id="4461786">)</span><span class="op" id="4461787">.</span><span class="ident" id="4461788">Mul</span><span class="op" id="4461791">(</span><span class="ident" id="4461792">x1</span><span class="op" id="4461794">,</span>&nbsp;<span class="ident" id="4461796">z2z2</span><span class="op" id="4461800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461803">u1</span><span class="op" id="4461805">.</span><span class="ident" id="4461806">Mod</span><span class="op" id="4461809">(</span><span class="ident" id="4461810">u1</span><span class="op" id="4461812">,</span>&nbsp;<span class="ident" id="4461814">curve</span><span class="op" id="4461819">.</span><span class="ident" id="4461820">P</span><span class="op" id="4461821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461824">u2</span>&nbsp;<span class="op" id="4461827">:=</span>&nbsp;<span class="builtinfunc" id="4461830">new</span><span class="op" id="4461833">(</span><span class="ident" id="4461834">big</span><span class="op" id="4461837">.</span><span class="ident" id="4461838">Int</span><span class="op" id="4461841">)</span><span class="op" id="4461842">.</span><span class="ident" id="4461843">Mul</span><span class="op" id="4461846">(</span><span class="ident" id="4461847">x2</span><span class="op" id="4461849">,</span>&nbsp;<span class="ident" id="4461851">z1z1</span><span class="op" id="4461855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461858">u2</span><span class="op" id="4461860">.</span><span class="ident" id="4461861">Mod</span><span class="op" id="4461864">(</span><span class="ident" id="4461865">u2</span><span class="op" id="4461867">,</span>&nbsp;<span class="ident" id="4461869">curve</span><span class="op" id="4461874">.</span><span class="ident" id="4461875">P</span><span class="op" id="4461876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461879">h</span>&nbsp;<span class="op" id="4461881">:=</span>&nbsp;<span class="builtinfunc" id="4461884">new</span><span class="op" id="4461887">(</span><span class="ident" id="4461888">big</span><span class="op" id="4461891">.</span><span class="ident" id="4461892">Int</span><span class="op" id="4461895">)</span><span class="op" id="4461896">.</span><span class="ident" id="4461897">Sub</span><span class="op" id="4461900">(</span><span class="ident" id="4461901">u2</span><span class="op" id="4461903">,</span>&nbsp;<span class="ident" id="4461905">u1</span><span class="op" id="4461907">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461910">xEqual</span>&nbsp;<span class="op" id="4461917">:=</span>&nbsp;<span class="ident" id="4461920">h</span><span class="op" id="4461921">.</span><span class="ident" id="4461922">Sign</span><span class="op" id="4461926">(</span><span class="op" id="4461927">)</span>&nbsp;<span class="op" id="4461929">==</span>&nbsp;<span class="num" id="4461932">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461935">if</span>&nbsp;<span class="ident" id="4461938">h</span><span class="op" id="4461939">.</span><span class="ident" id="4461940">Sign</span><span class="op" id="4461944">(</span><span class="op" id="4461945">)</span>&nbsp;<span class="op" id="4461947">==</span>&nbsp;<span class="op" id="4461950">-</span><span class="num" id="4461951">1</span>&nbsp;<span class="op" id="4461953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461957">h</span><span class="op" id="4461958">.</span><span class="ident" id="4461959">Add</span><span class="op" id="4461962">(</span><span class="ident" id="4461963">h</span><span class="op" id="4461964">,</span>&nbsp;<span class="ident" id="4461966">curve</span><span class="op" id="4461971">.</span><span class="ident" id="4461972">P</span><span class="op" id="4461973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4461976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461979">i</span>&nbsp;<span class="op" id="4461981">:=</span>&nbsp;<span class="builtinfunc" id="4461984">new</span><span class="op" id="4461987">(</span><span class="ident" id="4461988">big</span><span class="op" id="4461991">.</span><span class="ident" id="4461992">Int</span><span class="op" id="4461995">)</span><span class="op" id="4461996">.</span><span class="ident" id="4461997">Lsh</span><span class="op" id="4462000">(</span><span class="ident" id="4462001">h</span><span class="op" id="4462002">,</span>&nbsp;<span class="num" id="4462004">1</span><span class="op" id="4462005">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462008">i</span><span class="op" id="4462009">.</span><span class="ident" id="4462010">Mul</span><span class="op" id="4462013">(</span><span class="ident" id="4462014">i</span><span class="op" id="4462015">,</span>&nbsp;<span class="ident" id="4462017">i</span><span class="op" id="4462018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462021">j</span>&nbsp;<span class="op" id="4462023">:=</span>&nbsp;<span class="builtinfunc" id="4462026">new</span><span class="op" id="4462029">(</span><span class="ident" id="4462030">big</span><span class="op" id="4462033">.</span><span class="ident" id="4462034">Int</span><span class="op" id="4462037">)</span><span class="op" id="4462038">.</span><span class="ident" id="4462039">Mul</span><span class="op" id="4462042">(</span><span class="ident" id="4462043">h</span><span class="op" id="4462044">,</span>&nbsp;<span class="ident" id="4462046">i</span><span class="op" id="4462047">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462051">s1</span>&nbsp;<span class="op" id="4462054">:=</span>&nbsp;<span class="builtinfunc" id="4462057">new</span><span class="op" id="4462060">(</span><span class="ident" id="4462061">big</span><span class="op" id="4462064">.</span><span class="ident" id="4462065">Int</span><span class="op" id="4462068">)</span><span class="op" id="4462069">.</span><span class="ident" id="4462070">Mul</span><span class="op" id="4462073">(</span><span class="ident" id="4462074">y1</span><span class="op" id="4462076">,</span>&nbsp;<span class="ident" id="4462078">z2</span><span class="op" id="4462080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462083">s1</span><span class="op" id="4462085">.</span><span class="ident" id="4462086">Mul</span><span class="op" id="4462089">(</span><span class="ident" id="4462090">s1</span><span class="op" id="4462092">,</span>&nbsp;<span class="ident" id="4462094">z2z2</span><span class="op" id="4462098">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462101">s1</span><span class="op" id="4462103">.</span><span class="ident" id="4462104">Mod</span><span class="op" id="4462107">(</span><span class="ident" id="4462108">s1</span><span class="op" id="4462110">,</span>&nbsp;<span class="ident" id="4462112">curve</span><span class="op" id="4462117">.</span><span class="ident" id="4462118">P</span><span class="op" id="4462119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462122">s2</span>&nbsp;<span class="op" id="4462125">:=</span>&nbsp;<span class="builtinfunc" id="4462128">new</span><span class="op" id="4462131">(</span><span class="ident" id="4462132">big</span><span class="op" id="4462135">.</span><span class="ident" id="4462136">Int</span><span class="op" id="4462139">)</span><span class="op" id="4462140">.</span><span class="ident" id="4462141">Mul</span><span class="op" id="4462144">(</span><span class="ident" id="4462145">y2</span><span class="op" id="4462147">,</span>&nbsp;<span class="ident" id="4462149">z1</span><span class="op" id="4462151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462154">s2</span><span class="op" id="4462156">.</span><span class="ident" id="4462157">Mul</span><span class="op" id="4462160">(</span><span class="ident" id="4462161">s2</span><span class="op" id="4462163">,</span>&nbsp;<span class="ident" id="4462165">z1z1</span><span class="op" id="4462169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462172">s2</span><span class="op" id="4462174">.</span><span class="ident" id="4462175">Mod</span><span class="op" id="4462178">(</span><span class="ident" id="4462179">s2</span><span class="op" id="4462181">,</span>&nbsp;<span class="ident" id="4462183">curve</span><span class="op" id="4462188">.</span><span class="ident" id="4462189">P</span><span class="op" id="4462190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462193">r</span>&nbsp;<span class="op" id="4462195">:=</span>&nbsp;<span class="builtinfunc" id="4462198">new</span><span class="op" id="4462201">(</span><span class="ident" id="4462202">big</span><span class="op" id="4462205">.</span><span class="ident" id="4462206">Int</span><span class="op" id="4462209">)</span><span class="op" id="4462210">.</span><span class="ident" id="4462211">Sub</span><span class="op" id="4462214">(</span><span class="ident" id="4462215">s2</span><span class="op" id="4462217">,</span>&nbsp;<span class="ident" id="4462219">s1</span><span class="op" id="4462221">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462224">if</span>&nbsp;<span class="ident" id="4462227">r</span><span class="op" id="4462228">.</span><span class="ident" id="4462229">Sign</span><span class="op" id="4462233">(</span><span class="op" id="4462234">)</span>&nbsp;<span class="op" id="4462236">==</span>&nbsp;<span class="op" id="4462239">-</span><span class="num" id="4462240">1</span>&nbsp;<span class="op" id="4462242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462246">r</span><span class="op" id="4462247">.</span><span class="ident" id="4462248">Add</span><span class="op" id="4462251">(</span><span class="ident" id="4462252">r</span><span class="op" id="4462253">,</span>&nbsp;<span class="ident" id="4462255">curve</span><span class="op" id="4462260">.</span><span class="ident" id="4462261">P</span><span class="op" id="4462262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4462265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462268">yEqual</span>&nbsp;<span class="op" id="4462275">:=</span>&nbsp;<span class="ident" id="4462278">r</span><span class="op" id="4462279">.</span><span class="ident" id="4462280">Sign</span><span class="op" id="4462284">(</span><span class="op" id="4462285">)</span>&nbsp;<span class="op" id="4462287">==</span>&nbsp;<span class="num" id="4462290">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462293">if</span>&nbsp;<span class="ident" id="4462296">xEqual</span>&nbsp;<span class="op" id="4462303">&amp;&amp;</span>&nbsp;<span class="ident" id="4462306">yEqual</span>&nbsp;<span class="op" id="4462313">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462317">return</span>&nbsp;<span class="ident" id="4462324">curve</span><span class="op" id="4462329">.</span><span class="ident" id="4462330">doubleJacobian</span><span class="op" id="4462344">(</span><span class="ident" id="4462345">x1</span><span class="op" id="4462347">,</span>&nbsp;<span class="ident" id="4462349">y1</span><span class="op" id="4462351">,</span>&nbsp;<span class="ident" id="4462353">z1</span><span class="op" id="4462355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4462358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462361">r</span><span class="op" id="4462362">.</span><span class="ident" id="4462363">Lsh</span><span class="op" id="4462366">(</span><span class="ident" id="4462367">r</span><span class="op" id="4462368">,</span>&nbsp;<span class="num" id="4462370">1</span><span class="op" id="4462371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462374">v</span>&nbsp;<span class="op" id="4462376">:=</span>&nbsp;<span class="builtinfunc" id="4462379">new</span><span class="op" id="4462382">(</span><span class="ident" id="4462383">big</span><span class="op" id="4462386">.</span><span class="ident" id="4462387">Int</span><span class="op" id="4462390">)</span><span class="op" id="4462391">.</span><span class="ident" id="4462392">Mul</span><span class="op" id="4462395">(</span><span class="ident" id="4462396">u1</span><span class="op" id="4462398">,</span>&nbsp;<span class="ident" id="4462400">i</span><span class="op" id="4462401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462405">x3</span><span class="op" id="4462407">.</span><span class="ident" id="4462408">Set</span><span class="op" id="4462411">(</span><span class="ident" id="4462412">r</span><span class="op" id="4462413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462416">x3</span><span class="op" id="4462418">.</span><span class="ident" id="4462419">Mul</span><span class="op" id="4462422">(</span><span class="ident" id="4462423">x3</span><span class="op" id="4462425">,</span>&nbsp;<span class="ident" id="4462427">x3</span><span class="op" id="4462429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462432">x3</span><span class="op" id="4462434">.</span><span class="ident" id="4462435">Sub</span><span class="op" id="4462438">(</span><span class="ident" id="4462439">x3</span><span class="op" id="4462441">,</span>&nbsp;<span class="ident" id="4462443">j</span><span class="op" id="4462444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462447">x3</span><span class="op" id="4462449">.</span><span class="ident" id="4462450">Sub</span><span class="op" id="4462453">(</span><span class="ident" id="4462454">x3</span><span class="op" id="4462456">,</span>&nbsp;<span class="ident" id="4462458">v</span><span class="op" id="4462459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462462">x3</span><span class="op" id="4462464">.</span><span class="ident" id="4462465">Sub</span><span class="op" id="4462468">(</span><span class="ident" id="4462469">x3</span><span class="op" id="4462471">,</span>&nbsp;<span class="ident" id="4462473">v</span><span class="op" id="4462474">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462477">x3</span><span class="op" id="4462479">.</span><span class="ident" id="4462480">Mod</span><span class="op" id="4462483">(</span><span class="ident" id="4462484">x3</span><span class="op" id="4462486">,</span>&nbsp;<span class="ident" id="4462488">curve</span><span class="op" id="4462493">.</span><span class="ident" id="4462494">P</span><span class="op" id="4462495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462499">y3</span><span class="op" id="4462501">.</span><span class="ident" id="4462502">Set</span><span class="op" id="4462505">(</span><span class="ident" id="4462506">r</span><span class="op" id="4462507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462510">v</span><span class="op" id="4462511">.</span><span class="ident" id="4462512">Sub</span><span class="op" id="4462515">(</span><span class="ident" id="4462516">v</span><span class="op" id="4462517">,</span>&nbsp;<span class="ident" id="4462519">x3</span><span class="op" id="4462521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462524">y3</span><span class="op" id="4462526">.</span><span class="ident" id="4462527">Mul</span><span class="op" id="4462530">(</span><span class="ident" id="4462531">y3</span><span class="op" id="4462533">,</span>&nbsp;<span class="ident" id="4462535">v</span><span class="op" id="4462536">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462539">s1</span><span class="op" id="4462541">.</span><span class="ident" id="4462542">Mul</span><span class="op" id="4462545">(</span><span class="ident" id="4462546">s1</span><span class="op" id="4462548">,</span>&nbsp;<span class="ident" id="4462550">j</span><span class="op" id="4462551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462554">s1</span><span class="op" id="4462556">.</span><span class="ident" id="4462557">Lsh</span><span class="op" id="4462560">(</span><span class="ident" id="4462561">s1</span><span class="op" id="4462563">,</span>&nbsp;<span class="num" id="4462565">1</span><span class="op" id="4462566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462569">y3</span><span class="op" id="4462571">.</span><span class="ident" id="4462572">Sub</span><span class="op" id="4462575">(</span><span class="ident" id="4462576">y3</span><span class="op" id="4462578">,</span>&nbsp;<span class="ident" id="4462580">s1</span><span class="op" id="4462582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462585">y3</span><span class="op" id="4462587">.</span><span class="ident" id="4462588">Mod</span><span class="op" id="4462591">(</span><span class="ident" id="4462592">y3</span><span class="op" id="4462594">,</span>&nbsp;<span class="ident" id="4462596">curve</span><span class="op" id="4462601">.</span><span class="ident" id="4462602">P</span><span class="op" id="4462603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462607">z3</span><span class="op" id="4462609">.</span><span class="ident" id="4462610">Add</span><span class="op" id="4462613">(</span><span class="ident" id="4462614">z1</span><span class="op" id="4462616">,</span>&nbsp;<span class="ident" id="4462618">z2</span><span class="op" id="4462620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462623">z3</span><span class="op" id="4462625">.</span><span class="ident" id="4462626">Mul</span><span class="op" id="4462629">(</span><span class="ident" id="4462630">z3</span><span class="op" id="4462632">,</span>&nbsp;<span class="ident" id="4462634">z3</span><span class="op" id="4462636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462639">z3</span><span class="op" id="4462641">.</span><span class="ident" id="4462642">Sub</span><span class="op" id="4462645">(</span><span class="ident" id="4462646">z3</span><span class="op" id="4462648">,</span>&nbsp;<span class="ident" id="4462650">z1z1</span><span class="op" id="4462654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462657">z3</span><span class="op" id="4462659">.</span><span class="ident" id="4462660">Sub</span><span class="op" id="4462663">(</span><span class="ident" id="4462664">z3</span><span class="op" id="4462666">,</span>&nbsp;<span class="ident" id="4462668">z2z2</span><span class="op" id="4462672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462675">z3</span><span class="op" id="4462677">.</span><span class="ident" id="4462678">Mul</span><span class="op" id="4462681">(</span><span class="ident" id="4462682">z3</span><span class="op" id="4462684">,</span>&nbsp;<span class="ident" id="4462686">h</span><span class="op" id="4462687">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462690">z3</span><span class="op" id="4462692">.</span><span class="ident" id="4462693">Mod</span><span class="op" id="4462696">(</span><span class="ident" id="4462697">z3</span><span class="op" id="4462699">,</span>&nbsp;<span class="ident" id="4462701">curve</span><span class="op" id="4462706">.</span><span class="ident" id="4462707">P</span><span class="op" id="4462708">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462712">return</span>&nbsp;<span class="ident" id="4462719">x3</span><span class="op" id="4462721">,</span>&nbsp;<span class="ident" id="4462723">y3</span><span class="op" id="4462725">,</span>&nbsp;<span class="ident" id="4462727">z3</span><br>
<span class="lineno"></span><span class="op" id="4462730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4462733">func</span>&nbsp;<span class="op" id="4462738">(</span><span class="ident" id="4462739">curve</span>&nbsp;<span class="op" id="4462745">*</span><span class="ident" id="4462746">CurveParams</span><span class="op" id="4462757">)</span>&nbsp;<span class="ident" id="4462759">Double</span><span class="op" id="4462765">(</span><span class="ident" id="4462766">x1</span><span class="op" id="4462768">,</span>&nbsp;<span class="ident" id="4462770">y1</span>&nbsp;<span class="op" id="4462773">*</span><span class="ident" id="4462774">big</span><span class="op" id="4462777">.</span><span class="ident" id="4462778">Int</span><span class="op" id="4462781">)</span>&nbsp;<span class="op" id="4462783">(</span><span class="op" id="4462784">*</span><span class="ident" id="4462785">big</span><span class="op" id="4462788">.</span><span class="ident" id="4462789">Int</span><span class="op" id="4462792">,</span>&nbsp;<span class="op" id="4462794">*</span><span class="ident" id="4462795">big</span><span class="op" id="4462798">.</span><span class="ident" id="4462799">Int</span><span class="op" id="4462802">)</span>&nbsp;<span class="op" id="4462804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462807">z1</span>&nbsp;<span class="op" id="4462810">:=</span>&nbsp;<span class="ident" id="4462813">zForAffine</span><span class="op" id="4462823">(</span><span class="ident" id="4462824">x1</span><span class="op" id="4462826">,</span>&nbsp;<span class="ident" id="4462828">y1</span><span class="op" id="4462830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462833">return</span>&nbsp;<span class="ident" id="4462840">curve</span><span class="op" id="4462845">.</span><span class="ident" id="4462846">affineFromJacobian</span><span class="op" id="4462864">(</span><span class="ident" id="4462865">curve</span><span class="op" id="4462870">.</span><span class="ident" id="4462871">doubleJacobian</span><span class="op" id="4462885">(</span><span class="ident" id="4462886">x1</span><span class="op" id="4462888">,</span>&nbsp;<span class="ident" id="4462890">y1</span><span class="op" id="4462892">,</span>&nbsp;<span class="ident" id="4462894">z1</span><span class="op" id="4462896">)</span><span class="op" id="4462897">)</span><br>
<span class="lineno"></span><span class="op" id="4462899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4462902">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4462974">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4463020">func</span>&nbsp;<span class="op" id="4463025">(</span><span class="ident" id="4463026">curve</span>&nbsp;<span class="op" id="4463032">*</span><span class="ident" id="4463033">CurveParams</span><span class="op" id="4463044">)</span>&nbsp;<span class="ident" id="4463046">doubleJacobian</span><span class="op" id="4463060">(</span><span class="ident" id="4463061">x</span><span class="op" id="4463062">,</span>&nbsp;<span class="ident" id="4463064">y</span><span class="op" id="4463065">,</span>&nbsp;<span class="ident" id="4463067">z</span>&nbsp;<span class="op" id="4463069">*</span><span class="ident" id="4463070">big</span><span class="op" id="4463073">.</span><span class="ident" id="4463074">Int</span><span class="op" id="4463077">)</span>&nbsp;<span class="op" id="4463079">(</span><span class="op" id="4463080">*</span><span class="ident" id="4463081">big</span><span class="op" id="4463084">.</span><span class="ident" id="4463085">Int</span><span class="op" id="4463088">,</span>&nbsp;<span class="op" id="4463090">*</span><span class="ident" id="4463091">big</span><span class="op" id="4463094">.</span><span class="ident" id="4463095">Int</span><span class="op" id="4463098">,</span>&nbsp;<span class="op" id="4463100">*</span><span class="ident" id="4463101">big</span><span class="op" id="4463104">.</span><span class="ident" id="4463105">Int</span><span class="op" id="4463108">)</span>&nbsp;<span class="op" id="4463110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463113">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463202">delta</span>&nbsp;<span class="op" id="4463208">:=</span>&nbsp;<span class="builtinfunc" id="4463211">new</span><span class="op" id="4463214">(</span><span class="ident" id="4463215">big</span><span class="op" id="4463218">.</span><span class="ident" id="4463219">Int</span><span class="op" id="4463222">)</span><span class="op" id="4463223">.</span><span class="ident" id="4463224">Mul</span><span class="op" id="4463227">(</span><span class="ident" id="4463228">z</span><span class="op" id="4463229">,</span>&nbsp;<span class="ident" id="4463231">z</span><span class="op" id="4463232">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463235">delta</span><span class="op" id="4463240">.</span><span class="ident" id="4463241">Mod</span><span class="op" id="4463244">(</span><span class="ident" id="4463245">delta</span><span class="op" id="4463250">,</span>&nbsp;<span class="ident" id="4463252">curve</span><span class="op" id="4463257">.</span><span class="ident" id="4463258">P</span><span class="op" id="4463259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463262">gamma</span>&nbsp;<span class="op" id="4463268">:=</span>&nbsp;<span class="builtinfunc" id="4463271">new</span><span class="op" id="4463274">(</span><span class="ident" id="4463275">big</span><span class="op" id="4463278">.</span><span class="ident" id="4463279">Int</span><span class="op" id="4463282">)</span><span class="op" id="4463283">.</span><span class="ident" id="4463284">Mul</span><span class="op" id="4463287">(</span><span class="ident" id="4463288">y</span><span class="op" id="4463289">,</span>&nbsp;<span class="ident" id="4463291">y</span><span class="op" id="4463292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463295">gamma</span><span class="op" id="4463300">.</span><span class="ident" id="4463301">Mod</span><span class="op" id="4463304">(</span><span class="ident" id="4463305">gamma</span><span class="op" id="4463310">,</span>&nbsp;<span class="ident" id="4463312">curve</span><span class="op" id="4463317">.</span><span class="ident" id="4463318">P</span><span class="op" id="4463319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463322">alpha</span>&nbsp;<span class="op" id="4463328">:=</span>&nbsp;<span class="builtinfunc" id="4463331">new</span><span class="op" id="4463334">(</span><span class="ident" id="4463335">big</span><span class="op" id="4463338">.</span><span class="ident" id="4463339">Int</span><span class="op" id="4463342">)</span><span class="op" id="4463343">.</span><span class="ident" id="4463344">Sub</span><span class="op" id="4463347">(</span><span class="ident" id="4463348">x</span><span class="op" id="4463349">,</span>&nbsp;<span class="ident" id="4463351">delta</span><span class="op" id="4463356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463359">if</span>&nbsp;<span class="ident" id="4463362">alpha</span><span class="op" id="4463367">.</span><span class="ident" id="4463368">Sign</span><span class="op" id="4463372">(</span><span class="op" id="4463373">)</span>&nbsp;<span class="op" id="4463375">==</span>&nbsp;<span class="op" id="4463378">-</span><span class="num" id="4463379">1</span>&nbsp;<span class="op" id="4463381">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463385">alpha</span><span class="op" id="4463390">.</span><span class="ident" id="4463391">Add</span><span class="op" id="4463394">(</span><span class="ident" id="4463395">alpha</span><span class="op" id="4463400">,</span>&nbsp;<span class="ident" id="4463402">curve</span><span class="op" id="4463407">.</span><span class="ident" id="4463408">P</span><span class="op" id="4463409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463415">alpha2</span>&nbsp;<span class="op" id="4463422">:=</span>&nbsp;<span class="builtinfunc" id="4463425">new</span><span class="op" id="4463428">(</span><span class="ident" id="4463429">big</span><span class="op" id="4463432">.</span><span class="ident" id="4463433">Int</span><span class="op" id="4463436">)</span><span class="op" id="4463437">.</span><span class="ident" id="4463438">Add</span><span class="op" id="4463441">(</span><span class="ident" id="4463442">x</span><span class="op" id="4463443">,</span>&nbsp;<span class="ident" id="4463445">delta</span><span class="op" id="4463450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463453">alpha</span><span class="op" id="4463458">.</span><span class="ident" id="4463459">Mul</span><span class="op" id="4463462">(</span><span class="ident" id="4463463">alpha</span><span class="op" id="4463468">,</span>&nbsp;<span class="ident" id="4463470">alpha2</span><span class="op" id="4463476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463479">alpha2</span><span class="op" id="4463485">.</span><span class="ident" id="4463486">Set</span><span class="op" id="4463489">(</span><span class="ident" id="4463490">alpha</span><span class="op" id="4463495">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463498">alpha</span><span class="op" id="4463503">.</span><span class="ident" id="4463504">Lsh</span><span class="op" id="4463507">(</span><span class="ident" id="4463508">alpha</span><span class="op" id="4463513">,</span>&nbsp;<span class="num" id="4463515">1</span><span class="op" id="4463516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463519">alpha</span><span class="op" id="4463524">.</span><span class="ident" id="4463525">Add</span><span class="op" id="4463528">(</span><span class="ident" id="4463529">alpha</span><span class="op" id="4463534">,</span>&nbsp;<span class="ident" id="4463536">alpha2</span><span class="op" id="4463542">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463546">beta</span>&nbsp;<span class="op" id="4463551">:=</span>&nbsp;<span class="ident" id="4463554">alpha2</span><span class="op" id="4463560">.</span><span class="ident" id="4463561">Mul</span><span class="op" id="4463564">(</span><span class="ident" id="4463565">x</span><span class="op" id="4463566">,</span>&nbsp;<span class="ident" id="4463568">gamma</span><span class="op" id="4463573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463577">x3</span>&nbsp;<span class="op" id="4463580">:=</span>&nbsp;<span class="builtinfunc" id="4463583">new</span><span class="op" id="4463586">(</span><span class="ident" id="4463587">big</span><span class="op" id="4463590">.</span><span class="ident" id="4463591">Int</span><span class="op" id="4463594">)</span><span class="op" id="4463595">.</span><span class="ident" id="4463596">Mul</span><span class="op" id="4463599">(</span><span class="ident" id="4463600">alpha</span><span class="op" id="4463605">,</span>&nbsp;<span class="ident" id="4463607">alpha</span><span class="op" id="4463612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463615">beta8</span>&nbsp;<span class="op" id="4463621">:=</span>&nbsp;<span class="builtinfunc" id="4463624">new</span><span class="op" id="4463627">(</span><span class="ident" id="4463628">big</span><span class="op" id="4463631">.</span><span class="ident" id="4463632">Int</span><span class="op" id="4463635">)</span><span class="op" id="4463636">.</span><span class="ident" id="4463637">Lsh</span><span class="op" id="4463640">(</span><span class="ident" id="4463641">beta</span><span class="op" id="4463645">,</span>&nbsp;<span class="num" id="4463647">3</span><span class="op" id="4463648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463651">x3</span><span class="op" id="4463653">.</span><span class="ident" id="4463654">Sub</span><span class="op" id="4463657">(</span><span class="ident" id="4463658">x3</span><span class="op" id="4463660">,</span>&nbsp;<span class="ident" id="4463662">beta8</span><span class="op" id="4463667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463670">for</span>&nbsp;<span class="ident" id="4463674">x3</span><span class="op" id="4463676">.</span><span class="ident" id="4463677">Sign</span><span class="op" id="4463681">(</span><span class="op" id="4463682">)</span>&nbsp;<span class="op" id="4463684">==</span>&nbsp;<span class="op" id="4463687">-</span><span class="num" id="4463688">1</span>&nbsp;<span class="op" id="4463690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463694">x3</span><span class="op" id="4463696">.</span><span class="ident" id="4463697">Add</span><span class="op" id="4463700">(</span><span class="ident" id="4463701">x3</span><span class="op" id="4463703">,</span>&nbsp;<span class="ident" id="4463705">curve</span><span class="op" id="4463710">.</span><span class="ident" id="4463711">P</span><span class="op" id="4463712">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463718">x3</span><span class="op" id="4463720">.</span><span class="ident" id="4463721">Mod</span><span class="op" id="4463724">(</span><span class="ident" id="4463725">x3</span><span class="op" id="4463727">,</span>&nbsp;<span class="ident" id="4463729">curve</span><span class="op" id="4463734">.</span><span class="ident" id="4463735">P</span><span class="op" id="4463736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463740">z3</span>&nbsp;<span class="op" id="4463743">:=</span>&nbsp;<span class="builtinfunc" id="4463746">new</span><span class="op" id="4463749">(</span><span class="ident" id="4463750">big</span><span class="op" id="4463753">.</span><span class="ident" id="4463754">Int</span><span class="op" id="4463757">)</span><span class="op" id="4463758">.</span><span class="ident" id="4463759">Add</span><span class="op" id="4463762">(</span><span class="ident" id="4463763">y</span><span class="op" id="4463764">,</span>&nbsp;<span class="ident" id="4463766">z</span><span class="op" id="4463767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463770">z3</span><span class="op" id="4463772">.</span><span class="ident" id="4463773">Mul</span><span class="op" id="4463776">(</span><span class="ident" id="4463777">z3</span><span class="op" id="4463779">,</span>&nbsp;<span class="ident" id="4463781">z3</span><span class="op" id="4463783">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463786">z3</span><span class="op" id="4463788">.</span><span class="ident" id="4463789">Sub</span><span class="op" id="4463792">(</span><span class="ident" id="4463793">z3</span><span class="op" id="4463795">,</span>&nbsp;<span class="ident" id="4463797">gamma</span><span class="op" id="4463802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463805">if</span>&nbsp;<span class="ident" id="4463808">z3</span><span class="op" id="4463810">.</span><span class="ident" id="4463811">Sign</span><span class="op" id="4463815">(</span><span class="op" id="4463816">)</span>&nbsp;<span class="op" id="4463818">==</span>&nbsp;<span class="op" id="4463821">-</span><span class="num" id="4463822">1</span>&nbsp;<span class="op" id="4463824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463828">z3</span><span class="op" id="4463830">.</span><span class="ident" id="4463831">Add</span><span class="op" id="4463834">(</span><span class="ident" id="4463835">z3</span><span class="op" id="4463837">,</span>&nbsp;<span class="ident" id="4463839">curve</span><span class="op" id="4463844">.</span><span class="ident" id="4463845">P</span><span class="op" id="4463846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463852">z3</span><span class="op" id="4463854">.</span><span class="ident" id="4463855">Sub</span><span class="op" id="4463858">(</span><span class="ident" id="4463859">z3</span><span class="op" id="4463861">,</span>&nbsp;<span class="ident" id="4463863">delta</span><span class="op" id="4463868">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463871">if</span>&nbsp;<span class="ident" id="4463874">z3</span><span class="op" id="4463876">.</span><span class="ident" id="4463877">Sign</span><span class="op" id="4463881">(</span><span class="op" id="4463882">)</span>&nbsp;<span class="op" id="4463884">==</span>&nbsp;<span class="op" id="4463887">-</span><span class="num" id="4463888">1</span>&nbsp;<span class="op" id="4463890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463894">z3</span><span class="op" id="4463896">.</span><span class="ident" id="4463897">Add</span><span class="op" id="4463900">(</span><span class="ident" id="4463901">z3</span><span class="op" id="4463903">,</span>&nbsp;<span class="ident" id="4463905">curve</span><span class="op" id="4463910">.</span><span class="ident" id="4463911">P</span><span class="op" id="4463912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463918">z3</span><span class="op" id="4463920">.</span><span class="ident" id="4463921">Mod</span><span class="op" id="4463924">(</span><span class="ident" id="4463925">z3</span><span class="op" id="4463927">,</span>&nbsp;<span class="ident" id="4463929">curve</span><span class="op" id="4463934">.</span><span class="ident" id="4463935">P</span><span class="op" id="4463936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463940">beta</span><span class="op" id="4463944">.</span><span class="ident" id="4463945">Lsh</span><span class="op" id="4463948">(</span><span class="ident" id="4463949">beta</span><span class="op" id="4463953">,</span>&nbsp;<span class="num" id="4463955">2</span><span class="op" id="4463956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463959">beta</span><span class="op" id="4463963">.</span><span class="ident" id="4463964">Sub</span><span class="op" id="4463967">(</span><span class="ident" id="4463968">beta</span><span class="op" id="4463972">,</span>&nbsp;<span class="ident" id="4463974">x3</span><span class="op" id="4463976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463979">if</span>&nbsp;<span class="ident" id="4463982">beta</span><span class="op" id="4463986">.</span><span class="ident" id="4463987">Sign</span><span class="op" id="4463991">(</span><span class="op" id="4463992">)</span>&nbsp;<span class="op" id="4463994">==</span>&nbsp;<span class="op" id="4463997">-</span><span class="num" id="4463998">1</span>&nbsp;<span class="op" id="4464000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464004">beta</span><span class="op" id="4464008">.</span><span class="ident" id="4464009">Add</span><span class="op" id="4464012">(</span><span class="ident" id="4464013">beta</span><span class="op" id="4464017">,</span>&nbsp;<span class="ident" id="4464019">curve</span><span class="op" id="4464024">.</span><span class="ident" id="4464025">P</span><span class="op" id="4464026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464029">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464032">y3</span>&nbsp;<span class="op" id="4464035">:=</span>&nbsp;<span class="ident" id="4464038">alpha</span><span class="op" id="4464043">.</span><span class="ident" id="4464044">Mul</span><span class="op" id="4464047">(</span><span class="ident" id="4464048">alpha</span><span class="op" id="4464053">,</span>&nbsp;<span class="ident" id="4464055">beta</span><span class="op" id="4464059">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464063">gamma</span><span class="op" id="4464068">.</span><span class="ident" id="4464069">Mul</span><span class="op" id="4464072">(</span><span class="ident" id="4464073">gamma</span><span class="op" id="4464078">,</span>&nbsp;<span class="ident" id="4464080">gamma</span><span class="op" id="4464085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464088">gamma</span><span class="op" id="4464093">.</span><span class="ident" id="4464094">Lsh</span><span class="op" id="4464097">(</span><span class="ident" id="4464098">gamma</span><span class="op" id="4464103">,</span>&nbsp;<span class="num" id="4464105">3</span><span class="op" id="4464106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464109">gamma</span><span class="op" id="4464114">.</span><span class="ident" id="4464115">Mod</span><span class="op" id="4464118">(</span><span class="ident" id="4464119">gamma</span><span class="op" id="4464124">,</span>&nbsp;<span class="ident" id="4464126">curve</span><span class="op" id="4464131">.</span><span class="ident" id="4464132">P</span><span class="op" id="4464133">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464137">y3</span><span class="op" id="4464139">.</span><span class="ident" id="4464140">Sub</span><span class="op" id="4464143">(</span><span class="ident" id="4464144">y3</span><span class="op" id="4464146">,</span>&nbsp;<span class="ident" id="4464148">gamma</span><span class="op" id="4464153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464156">if</span>&nbsp;<span class="ident" id="4464159">y3</span><span class="op" id="4464161">.</span><span class="ident" id="4464162">Sign</span><span class="op" id="4464166">(</span><span class="op" id="4464167">)</span>&nbsp;<span class="op" id="4464169">==</span>&nbsp;<span class="op" id="4464172">-</span><span class="num" id="4464173">1</span>&nbsp;<span class="op" id="4464175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464179">y3</span><span class="op" id="4464181">.</span><span class="ident" id="4464182">Add</span><span class="op" id="4464185">(</span><span class="ident" id="4464186">y3</span><span class="op" id="4464188">,</span>&nbsp;<span class="ident" id="4464190">curve</span><span class="op" id="4464195">.</span><span class="ident" id="4464196">P</span><span class="op" id="4464197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464200">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464203">y3</span><span class="op" id="4464205">.</span><span class="ident" id="4464206">Mod</span><span class="op" id="4464209">(</span><span class="ident" id="4464210">y3</span><span class="op" id="4464212">,</span>&nbsp;<span class="ident" id="4464214">curve</span><span class="op" id="4464219">.</span><span class="ident" id="4464220">P</span><span class="op" id="4464221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464225">return</span>&nbsp;<span class="ident" id="4464232">x3</span><span class="op" id="4464234">,</span>&nbsp;<span class="ident" id="4464236">y3</span><span class="op" id="4464238">,</span>&nbsp;<span class="ident" id="4464240">z3</span><br>
<span class="lineno"></span><span class="op" id="4464243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4464246">func</span>&nbsp;<span class="op" id="4464251">(</span><span class="ident" id="4464252">curve</span>&nbsp;<span class="op" id="4464258">*</span><span class="ident" id="4464259">CurveParams</span><span class="op" id="4464270">)</span>&nbsp;<span class="ident" id="4464272">ScalarMult</span><span class="op" id="4464282">(</span><span class="ident" id="4464283">Bx</span><span class="op" id="4464285">,</span>&nbsp;<span class="ident" id="4464287">By</span>&nbsp;<span class="op" id="4464290">*</span><span class="ident" id="4464291">big</span><span class="op" id="4464294">.</span><span class="ident" id="4464295">Int</span><span class="op" id="4464298">,</span>&nbsp;<span class="ident" id="4464300">k</span>&nbsp;<span class="op" id="4464302">[</span><span class="op" id="4464303">]</span><span class="builtintype" id="4464304">byte</span><span class="op" id="4464308">)</span>&nbsp;<span class="op" id="4464310">(</span><span class="op" id="4464311">*</span><span class="ident" id="4464312">big</span><span class="op" id="4464315">.</span><span class="ident" id="4464316">Int</span><span class="op" id="4464319">,</span>&nbsp;<span class="op" id="4464321">*</span><span class="ident" id="4464322">big</span><span class="op" id="4464325">.</span><span class="ident" id="4464326">Int</span><span class="op" id="4464329">)</span>&nbsp;<span class="op" id="4464331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464334">Bz</span>&nbsp;<span class="op" id="4464337">:=</span>&nbsp;<span class="builtinfunc" id="4464340">new</span><span class="op" id="4464343">(</span><span class="ident" id="4464344">big</span><span class="op" id="4464347">.</span><span class="ident" id="4464348">Int</span><span class="op" id="4464351">)</span><span class="op" id="4464352">.</span><span class="ident" id="4464353">SetInt64</span><span class="op" id="4464361">(</span><span class="num" id="4464362">1</span><span class="op" id="4464363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464366">x</span><span class="op" id="4464367">,</span>&nbsp;<span class="ident" id="4464369">y</span><span class="op" id="4464370">,</span>&nbsp;<span class="ident" id="4464372">z</span>&nbsp;<span class="op" id="4464374">:=</span>&nbsp;<span class="builtinfunc" id="4464377">new</span><span class="op" id="4464380">(</span><span class="ident" id="4464381">big</span><span class="op" id="4464384">.</span><span class="ident" id="4464385">Int</span><span class="op" id="4464388">)</span><span class="op" id="4464389">,</span>&nbsp;<span class="builtinfunc" id="4464391">new</span><span class="op" id="4464394">(</span><span class="ident" id="4464395">big</span><span class="op" id="4464398">.</span><span class="ident" id="4464399">Int</span><span class="op" id="4464402">)</span><span class="op" id="4464403">,</span>&nbsp;<span class="builtinfunc" id="4464405">new</span><span class="op" id="4464408">(</span><span class="ident" id="4464409">big</span><span class="op" id="4464412">.</span><span class="ident" id="4464413">Int</span><span class="op" id="4464416">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464420">for</span>&nbsp;<span class="ident" id="4464424">_</span><span class="op" id="4464425">,</span>&nbsp;<span class="builtintype" id="4464427">byte</span>&nbsp;<span class="op" id="4464432">:=</span>&nbsp;<span class="keyword" id="4464435">range</span>&nbsp;<span class="ident" id="4464441">k</span>&nbsp;<span class="op" id="4464443">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464447">for</span>&nbsp;<span class="ident" id="4464451">bitNum</span>&nbsp;<span class="op" id="4464458">:=</span>&nbsp;<span class="num" id="4464461">0</span><span class="op" id="4464462">;</span>&nbsp;<span class="ident" id="4464464">bitNum</span>&nbsp;<span class="op" id="4464471">&lt;</span>&nbsp;<span class="num" id="4464473">8</span><span class="op" id="4464474">;</span>&nbsp;<span class="ident" id="4464476">bitNum</span><span class="op" id="4464482">++</span>&nbsp;<span class="op" id="4464485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464490">x</span><span class="op" id="4464491">,</span>&nbsp;<span class="ident" id="4464493">y</span><span class="op" id="4464494">,</span>&nbsp;<span class="ident" id="4464496">z</span>&nbsp;<span class="op" id="4464498">=</span>&nbsp;<span class="ident" id="4464500">curve</span><span class="op" id="4464505">.</span><span class="ident" id="4464506">doubleJacobian</span><span class="op" id="4464520">(</span><span class="ident" id="4464521">x</span><span class="op" id="4464522">,</span>&nbsp;<span class="ident" id="4464524">y</span><span class="op" id="4464525">,</span>&nbsp;<span class="ident" id="4464527">z</span><span class="op" id="4464528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464533">if</span>&nbsp;<span class="builtintype" id="4464536">byte</span><span class="op" id="4464540">&amp;</span><span class="num" id="4464541">0x80</span>&nbsp;<span class="op" id="4464546">==</span>&nbsp;<span class="num" id="4464549">0x80</span>&nbsp;<span class="op" id="4464554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464560">x</span><span class="op" id="4464561">,</span>&nbsp;<span class="ident" id="4464563">y</span><span class="op" id="4464564">,</span>&nbsp;<span class="ident" id="4464566">z</span>&nbsp;<span class="op" id="4464568">=</span>&nbsp;<span class="ident" id="4464570">curve</span><span class="op" id="4464575">.</span><span class="ident" id="4464576">addJacobian</span><span class="op" id="4464587">(</span><span class="ident" id="4464588">Bx</span><span class="op" id="4464590">,</span>&nbsp;<span class="ident" id="4464592">By</span><span class="op" id="4464594">,</span>&nbsp;<span class="ident" id="4464596">Bz</span><span class="op" id="4464598">,</span>&nbsp;<span class="ident" id="4464600">x</span><span class="op" id="4464601">,</span>&nbsp;<span class="ident" id="4464603">y</span><span class="op" id="4464604">,</span>&nbsp;<span class="ident" id="4464606">z</span><span class="op" id="4464607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464612">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4464617">byte</span>&nbsp;<span class="op" id="4464622">&lt;&lt;=</span>&nbsp;<span class="num" id="4464626">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464637">return</span>&nbsp;<span class="ident" id="4464644">curve</span><span class="op" id="4464649">.</span><span class="ident" id="4464650">affineFromJacobian</span><span class="op" id="4464668">(</span><span class="ident" id="4464669">x</span><span class="op" id="4464670">,</span>&nbsp;<span class="ident" id="4464672">y</span><span class="op" id="4464673">,</span>&nbsp;<span class="ident" id="4464675">z</span><span class="op" id="4464676">)</span><br>
<span class="lineno">265</span><span class="op" id="4464678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4464681">func</span>&nbsp;<span class="op" id="4464686">(</span><span class="ident" id="4464687">curve</span>&nbsp;<span class="op" id="4464693">*</span><span class="ident" id="4464694">CurveParams</span><span class="op" id="4464705">)</span>&nbsp;<span class="ident" id="4464707">ScalarBaseMult</span><span class="op" id="4464721">(</span><span class="ident" id="4464722">k</span>&nbsp;<span class="op" id="4464724">[</span><span class="op" id="4464725">]</span><span class="builtintype" id="4464726">byte</span><span class="op" id="4464730">)</span>&nbsp;<span class="op" id="4464732">(</span><span class="op" id="4464733">*</span><span class="ident" id="4464734">big</span><span class="op" id="4464737">.</span><span class="ident" id="4464738">Int</span><span class="op" id="4464741">,</span>&nbsp;<span class="op" id="4464743">*</span><span class="ident" id="4464744">big</span><span class="op" id="4464747">.</span><span class="ident" id="4464748">Int</span><span class="op" id="4464751">)</span>&nbsp;<span class="op" id="4464753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464756">return</span>&nbsp;<span class="ident" id="4464763">curve</span><span class="op" id="4464768">.</span><span class="ident" id="4464769">ScalarMult</span><span class="op" id="4464779">(</span><span class="ident" id="4464780">curve</span><span class="op" id="4464785">.</span><span class="ident" id="4464786">Gx</span><span class="op" id="4464788">,</span>&nbsp;<span class="ident" id="4464790">curve</span><span class="op" id="4464795">.</span><span class="ident" id="4464796">Gy</span><span class="op" id="4464798">,</span>&nbsp;<span class="ident" id="4464800">k</span><span class="op" id="4464801">)</span><br>
<span class="lineno"></span><span class="op" id="4464803">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4464806">var</span>&nbsp;<span class="ident" id="4464810">mask</span>&nbsp;<span class="op" id="4464815">=</span>&nbsp;<span class="op" id="4464817">[</span><span class="op" id="4464818">]</span><span class="builtintype" id="4464819">byte</span><span class="op" id="4464823">{</span><span class="num" id="4464824">0xff</span><span class="op" id="4464828">,</span>&nbsp;<span class="num" id="4464830">0x1</span><span class="op" id="4464833">,</span>&nbsp;<span class="num" id="4464835">0x3</span><span class="op" id="4464838">,</span>&nbsp;<span class="num" id="4464840">0x7</span><span class="op" id="4464843">,</span>&nbsp;<span class="num" id="4464845">0xf</span><span class="op" id="4464848">,</span>&nbsp;<span class="num" id="4464850">0x1f</span><span class="op" id="4464854">,</span>&nbsp;<span class="num" id="4464856">0x3f</span><span class="op" id="4464860">,</span>&nbsp;<span class="num" id="4464862">0x7f</span><span class="op" id="4464866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4464869">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4464938">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4465006">func</span>&nbsp;<span class="ident" id="4465011">GenerateKey</span><span class="op" id="4465022">(</span><span class="ident" id="4465023">curve</span>&nbsp;<span class="ident" id="4465029">Curve</span><span class="op" id="4465034">,</span>&nbsp;<span class="ident" id="4465036">rand</span>&nbsp;<span class="ident" id="4465041">io</span><span class="op" id="4465043">.</span><span class="ident" id="4465044">Reader</span><span class="op" id="4465050">)</span>&nbsp;<span class="op" id="4465052">(</span><span class="ident" id="4465053">priv</span>&nbsp;<span class="op" id="4465058">[</span><span class="op" id="4465059">]</span><span class="builtintype" id="4465060">byte</span><span class="op" id="4465064">,</span>&nbsp;<span class="ident" id="4465066">x</span><span class="op" id="4465067">,</span>&nbsp;<span class="ident" id="4465069">y</span>&nbsp;<span class="op" id="4465071">*</span><span class="ident" id="4465072">big</span><span class="op" id="4465075">.</span><span class="ident" id="4465076">Int</span><span class="op" id="4465079">,</span>&nbsp;<span class="ident" id="4465081">err</span>&nbsp;<span class="builtintype" id="4465085">error</span><span class="op" id="4465090">)</span>&nbsp;<span class="op" id="4465092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465095">bitSize</span>&nbsp;<span class="op" id="4465103">:=</span>&nbsp;<span class="ident" id="4465106">curve</span><span class="op" id="4465111">.</span><span class="ident" id="4465112">Params</span><span class="op" id="4465118">(</span><span class="op" id="4465119">)</span><span class="op" id="4465120">.</span><span class="ident" id="4465121">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465130">byteLen</span>&nbsp;<span class="op" id="4465138">:=</span>&nbsp;<span class="op" id="4465141">(</span><span class="ident" id="4465142">bitSize</span>&nbsp;<span class="op" id="4465150">+</span>&nbsp;<span class="num" id="4465152">7</span><span class="op" id="4465153">)</span>&nbsp;<span class="op" id="4465155">&gt;&gt;</span>&nbsp;<span class="num" id="4465158">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465161">priv</span>&nbsp;<span class="op" id="4465166">=</span>&nbsp;<span class="builtinfunc" id="4465168">make</span><span class="op" id="4465172">(</span><span class="op" id="4465173">[</span><span class="op" id="4465174">]</span><span class="builtintype" id="4465175">byte</span><span class="op" id="4465179">,</span>&nbsp;<span class="ident" id="4465181">byteLen</span><span class="op" id="4465188">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465192">for</span>&nbsp;<span class="ident" id="4465196">x</span>&nbsp;<span class="op" id="4465198">==</span>&nbsp;<span class="ident" id="4465201">nil</span>&nbsp;<span class="op" id="4465205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465209">_</span><span class="op" id="4465210">,</span>&nbsp;<span class="ident" id="4465212">err</span>&nbsp;<span class="op" id="4465216">=</span>&nbsp;<span class="ident" id="4465218">io</span><span class="op" id="4465220">.</span><span class="ident" id="4465221">ReadFull</span><span class="op" id="4465229">(</span><span class="ident" id="4465230">rand</span><span class="op" id="4465234">,</span>&nbsp;<span class="ident" id="4465236">priv</span><span class="op" id="4465240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465244">if</span>&nbsp;<span class="ident" id="4465247">err</span>&nbsp;<span class="op" id="4465251">!=</span>&nbsp;<span class="ident" id="4465254">nil</span>&nbsp;<span class="op" id="4465258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465263">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4465272">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4465276">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4465350">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465404">priv</span><span class="op" id="4465408">[</span><span class="num" id="4465409">0</span><span class="op" id="4465410">]</span>&nbsp;<span class="op" id="4465412">&amp;=</span>&nbsp;<span class="ident" id="4465415">mask</span><span class="op" id="4465419">[</span><span class="ident" id="4465420">bitSize</span><span class="op" id="4465427">%</span><span class="num" id="4465428">8</span><span class="op" id="4465429">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4465433">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4465505">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465562">priv</span><span class="op" id="4465566">[</span><span class="num" id="4465567">1</span><span class="op" id="4465568">]</span>&nbsp;<span class="op" id="4465570">^=</span>&nbsp;<span class="num" id="4465573">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465580">x</span><span class="op" id="4465581">,</span>&nbsp;<span class="ident" id="4465583">y</span>&nbsp;<span class="op" id="4465585">=</span>&nbsp;<span class="ident" id="4465587">curve</span><span class="op" id="4465592">.</span><span class="ident" id="4465593">ScalarBaseMult</span><span class="op" id="4465607">(</span><span class="ident" id="4465608">priv</span><span class="op" id="4465612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4465615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465618">return</span><br>
<span class="lineno"></span><span class="op" id="4465625">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4465628">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4465712">func</span>&nbsp;<span class="ident" id="4465717">Marshal</span><span class="op" id="4465724">(</span><span class="ident" id="4465725">curve</span>&nbsp;<span class="ident" id="4465731">Curve</span><span class="op" id="4465736">,</span>&nbsp;<span class="ident" id="4465738">x</span><span class="op" id="4465739">,</span>&nbsp;<span class="ident" id="4465741">y</span>&nbsp;<span class="op" id="4465743">*</span><span class="ident" id="4465744">big</span><span class="op" id="4465747">.</span><span class="ident" id="4465748">Int</span><span class="op" id="4465751">)</span>&nbsp;<span class="op" id="4465753">[</span><span class="op" id="4465754">]</span><span class="builtintype" id="4465755">byte</span>&nbsp;<span class="op" id="4465760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465763">byteLen</span>&nbsp;<span class="op" id="4465771">:=</span>&nbsp;<span class="op" id="4465774">(</span><span class="ident" id="4465775">curve</span><span class="op" id="4465780">.</span><span class="ident" id="4465781">Params</span><span class="op" id="4465787">(</span><span class="op" id="4465788">)</span><span class="op" id="4465789">.</span><span class="ident" id="4465790">BitSize</span>&nbsp;<span class="op" id="4465798">+</span>&nbsp;<span class="num" id="4465800">7</span><span class="op" id="4465801">)</span>&nbsp;<span class="op" id="4465803">&gt;&gt;</span>&nbsp;<span class="num" id="4465806">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465810">ret</span>&nbsp;<span class="op" id="4465814">:=</span>&nbsp;<span class="builtinfunc" id="4465817">make</span><span class="op" id="4465821">(</span><span class="op" id="4465822">[</span><span class="op" id="4465823">]</span><span class="builtintype" id="4465824">byte</span><span class="op" id="4465828">,</span>&nbsp;<span class="num" id="4465830">1</span><span class="op" id="4465831">+</span><span class="num" id="4465832">2</span><span class="op" id="4465833">*</span><span class="ident" id="4465834">byteLen</span><span class="op" id="4465841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465844">ret</span><span class="op" id="4465847">[</span><span class="num" id="4465848">0</span><span class="op" id="4465849">]</span>&nbsp;<span class="op" id="4465851">=</span>&nbsp;<span class="num" id="4465853">4</span>&nbsp;<span class="comment" id="4465855">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465879">xBytes</span>&nbsp;<span class="op" id="4465886">:=</span>&nbsp;<span class="ident" id="4465889">x</span><span class="op" id="4465890">.</span><span class="ident" id="4465891">Bytes</span><span class="op" id="4465896">(</span><span class="op" id="4465897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4465900">copy</span><span class="op" id="4465904">(</span><span class="ident" id="4465905">ret</span><span class="op" id="4465908">[</span><span class="num" id="4465909">1</span><span class="op" id="4465910">+</span><span class="ident" id="4465911">byteLen</span><span class="op" id="4465918">-</span><span class="builtinfunc" id="4465919">len</span><span class="op" id="4465922">(</span><span class="ident" id="4465923">xBytes</span><span class="op" id="4465929">)</span><span class="op" id="4465930">:</span><span class="op" id="4465931">]</span><span class="op" id="4465932">,</span>&nbsp;<span class="ident" id="4465934">xBytes</span><span class="op" id="4465940">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465943">yBytes</span>&nbsp;<span class="op" id="4465950">:=</span>&nbsp;<span class="ident" id="4465953">y</span><span class="op" id="4465954">.</span><span class="ident" id="4465955">Bytes</span><span class="op" id="4465960">(</span><span class="op" id="4465961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4465964">copy</span><span class="op" id="4465968">(</span><span class="ident" id="4465969">ret</span><span class="op" id="4465972">[</span><span class="num" id="4465973">1</span><span class="op" id="4465974">+</span><span class="num" id="4465975">2</span><span class="op" id="4465976">*</span><span class="ident" id="4465977">byteLen</span><span class="op" id="4465984">-</span><span class="builtinfunc" id="4465985">len</span><span class="op" id="4465988">(</span><span class="ident" id="4465989">yBytes</span><span class="op" id="4465995">)</span><span class="op" id="4465996">:</span><span class="op" id="4465997">]</span><span class="op" id="4465998">,</span>&nbsp;<span class="ident" id="4466000">yBytes</span><span class="op" id="4466006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4466009">return</span>&nbsp;<span class="ident" id="4466016">ret</span><br>
<span class="lineno"></span><span class="op" id="4466020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4466023">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4466115">func</span>&nbsp;<span class="ident" id="4466120">Unmarshal</span><span class="op" id="4466129">(</span><span class="ident" id="4466130">curve</span>&nbsp;<span class="ident" id="4466136">Curve</span><span class="op" id="4466141">,</span>&nbsp;<span class="ident" id="4466143">data</span>&nbsp;<span class="op" id="4466148">[</span><span class="op" id="4466149">]</span><span class="builtintype" id="4466150">byte</span><span class="op" id="4466154">)</span>&nbsp;<span class="op" id="4466156">(</span><span class="ident" id="4466157">x</span><span class="op" id="4466158">,</span>&nbsp;<span class="ident" id="4466160">y</span>&nbsp;<span class="op" id="4466162">*</span><span class="ident" id="4466163">big</span><span class="op" id="4466166">.</span><span class="ident" id="4466167">Int</span><span class="op" id="4466170">)</span>&nbsp;<span class="op" id="4466172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466175">byteLen</span>&nbsp;<span class="op" id="4466183">:=</span>&nbsp;<span class="op" id="4466186">(</span><span class="ident" id="4466187">curve</span><span class="op" id="4466192">.</span><span class="ident" id="4466193">Params</span><span class="op" id="4466199">(</span><span class="op" id="4466200">)</span><span class="op" id="4466201">.</span><span class="ident" id="4466202">BitSize</span>&nbsp;<span class="op" id="4466210">+</span>&nbsp;<span class="num" id="4466212">7</span><span class="op" id="4466213">)</span>&nbsp;<span class="op" id="4466215">&gt;&gt;</span>&nbsp;<span class="num" id="4466218">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4466221">if</span>&nbsp;<span class="builtinfunc" id="4466224">len</span><span class="op" id="4466227">(</span><span class="ident" id="4466228">data</span><span class="op" id="4466232">)</span>&nbsp;<span class="op" id="4466234">!=</span>&nbsp;<span class="num" id="4466237">1</span><span class="op" id="4466238">+</span><span class="num" id="4466239">2</span><span class="op" id="4466240">*</span><span class="ident" id="4466241">byteLen</span>&nbsp;<span class="op" id="4466249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4466253">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4466261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4466264">if</span>&nbsp;<span class="ident" id="4466267">data</span><span class="op" id="4466271">[</span><span class="num" id="4466272">0</span><span class="op" id="4466273">]</span>&nbsp;<span class="op" id="4466275">!=</span>&nbsp;<span class="num" id="4466278">4</span>&nbsp;<span class="op" id="4466280">{</span>&nbsp;<span class="comment" id="4466282">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4466305">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4466313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466316">x</span>&nbsp;<span class="op" id="4466318">=</span>&nbsp;<span class="builtinfunc" id="4466320">new</span><span class="op" id="4466323">(</span><span class="ident" id="4466324">big</span><span class="op" id="4466327">.</span><span class="ident" id="4466328">Int</span><span class="op" id="4466331">)</span><span class="op" id="4466332">.</span><span class="ident" id="4466333">SetBytes</span><span class="op" id="4466341">(</span><span class="ident" id="4466342">data</span><span class="op" id="4466346">[</span><span class="num" id="4466347">1</span>&nbsp;<span class="op" id="4466349">:</span>&nbsp;<span class="num" id="4466351">1</span><span class="op" id="4466352">+</span><span class="ident" id="4466353">byteLen</span><span class="op" id="4466360">]</span><span class="op" id="4466361">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466364">y</span>&nbsp;<span class="op" id="4466366">=</span>&nbsp;<span class="builtinfunc" id="4466368">new</span><span class="op" id="4466371">(</span><span class="ident" id="4466372">big</span><span class="op" id="4466375">.</span><span class="ident" id="4466376">Int</span><span class="op" id="4466379">)</span><span class="op" id="4466380">.</span><span class="ident" id="4466381">SetBytes</span><span class="op" id="4466389">(</span><span class="ident" id="4466390">data</span><span class="op" id="4466394">[</span><span class="num" id="4466395">1</span><span class="op" id="4466396">+</span><span class="ident" id="4466397">byteLen</span><span class="op" id="4466404">:</span><span class="op" id="4466405">]</span><span class="op" id="4466406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4466409">return</span><br>
<span class="lineno"></span><span class="op" id="4466416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4466419">var</span>&nbsp;<span class="ident" id="4466423">initonce</span>&nbsp;<span class="ident" id="4466432">sync</span><span class="op" id="4466436">.</span><span class="ident" id="4466437">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4466442">var</span>&nbsp;<span class="ident" id="4466446">p384</span>&nbsp;<span class="op" id="4466451">*</span><span class="ident" id="4466452">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4466464">var</span>&nbsp;<span class="ident" id="4466468">p521</span>&nbsp;<span class="op" id="4466473">*</span><span class="ident" id="4466474">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4466487">func</span>&nbsp;<span class="ident" id="4466492">initAll</span><span class="op" id="4466499">(</span><span class="op" id="4466500">)</span>&nbsp;<span class="op" id="4466502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466505">initP224</span><span class="op" id="4466513">(</span><span class="op" id="4466514">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466517">initP256</span><span class="op" id="4466525">(</span><span class="op" id="4466526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466529">initP384</span><span class="op" id="4466537">(</span><span class="op" id="4466538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466541">initP521</span><span class="op" id="4466549">(</span><span class="op" id="4466550">)</span><br>
<span class="lineno"></span><span class="op" id="4466552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4466555">func</span>&nbsp;<span class="ident" id="4466560">initP384</span><span class="op" id="4466568">(</span><span class="op" id="4466569">)</span>&nbsp;<span class="op" id="4466571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4466574">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466608">p384</span>&nbsp;<span class="op" id="4466613">=</span>&nbsp;<span class="builtinfunc" id="4466615">new</span><span class="op" id="4466618">(</span><span class="ident" id="4466619">CurveParams</span><span class="op" id="4466630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466633">p384</span><span class="op" id="4466637">.</span><span class="ident" id="4466638">P</span><span class="op" id="4466639">,</span>&nbsp;<span class="ident" id="4466641">_</span>&nbsp;<span class="op" id="4466643">=</span>&nbsp;<span class="builtinfunc" id="4466645">new</span><span class="op" id="4466648">(</span><span class="ident" id="4466649">big</span><span class="op" id="4466652">.</span><span class="ident" id="4466653">Int</span><span class="op" id="4466656">)</span><span class="op" id="4466657">.</span><span class="ident" id="4466658">SetString</span><span class="op" id="4466667">(</span><span class="string" id="4466668">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4466786">,</span>&nbsp;<span class="num" id="4466788">10</span><span class="op" id="4466790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466793">p384</span><span class="op" id="4466797">.</span><span class="ident" id="4466798">N</span><span class="op" id="4466799">,</span>&nbsp;<span class="ident" id="4466801">_</span>&nbsp;<span class="op" id="4466803">=</span>&nbsp;<span class="builtinfunc" id="4466805">new</span><span class="op" id="4466808">(</span><span class="ident" id="4466809">big</span><span class="op" id="4466812">.</span><span class="ident" id="4466813">Int</span><span class="op" id="4466816">)</span><span class="op" id="4466817">.</span><span class="ident" id="4466818">SetString</span><span class="op" id="4466827">(</span><span class="string" id="4466828">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4466946">,</span>&nbsp;<span class="num" id="4466948">10</span><span class="op" id="4466950">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466953">p384</span><span class="op" id="4466957">.</span><span class="ident" id="4466958">B</span><span class="op" id="4466959">,</span>&nbsp;<span class="ident" id="4466961">_</span>&nbsp;<span class="op" id="4466963">=</span>&nbsp;<span class="builtinfunc" id="4466965">new</span><span class="op" id="4466968">(</span><span class="ident" id="4466969">big</span><span class="op" id="4466972">.</span><span class="ident" id="4466973">Int</span><span class="op" id="4466976">)</span><span class="op" id="4466977">.</span><span class="ident" id="4466978">SetString</span><span class="op" id="4466987">(</span><span class="string" id="4466988">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4467086">,</span>&nbsp;<span class="num" id="4467088">16</span><span class="op" id="4467090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467093">p384</span><span class="op" id="4467097">.</span><span class="ident" id="4467098">Gx</span><span class="op" id="4467100">,</span>&nbsp;<span class="ident" id="4467102">_</span>&nbsp;<span class="op" id="4467104">=</span>&nbsp;<span class="builtinfunc" id="4467106">new</span><span class="op" id="4467109">(</span><span class="ident" id="4467110">big</span><span class="op" id="4467113">.</span><span class="ident" id="4467114">Int</span><span class="op" id="4467117">)</span><span class="op" id="4467118">.</span><span class="ident" id="4467119">SetString</span><span class="op" id="4467128">(</span><span class="string" id="4467129">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4467227">,</span>&nbsp;<span class="num" id="4467229">16</span><span class="op" id="4467231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467234">p384</span><span class="op" id="4467238">.</span><span class="ident" id="4467239">Gy</span><span class="op" id="4467241">,</span>&nbsp;<span class="ident" id="4467243">_</span>&nbsp;<span class="op" id="4467245">=</span>&nbsp;<span class="builtinfunc" id="4467247">new</span><span class="op" id="4467250">(</span><span class="ident" id="4467251">big</span><span class="op" id="4467254">.</span><span class="ident" id="4467255">Int</span><span class="op" id="4467258">)</span><span class="op" id="4467259">.</span><span class="ident" id="4467260">SetString</span><span class="op" id="4467269">(</span><span class="string" id="4467270">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4467368">,</span>&nbsp;<span class="num" id="4467370">16</span><span class="op" id="4467372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467375">p384</span><span class="op" id="4467379">.</span><span class="ident" id="4467380">BitSize</span>&nbsp;<span class="op" id="4467388">=</span>&nbsp;<span class="num" id="4467390">384</span><br>
<span class="lineno"></span><span class="op" id="4467394">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4467397">func</span>&nbsp;<span class="ident" id="4467402">initP521</span><span class="op" id="4467410">(</span><span class="op" id="4467411">)</span>&nbsp;<span class="op" id="4467413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4467416">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467450">p521</span>&nbsp;<span class="op" id="4467455">=</span>&nbsp;<span class="builtinfunc" id="4467457">new</span><span class="op" id="4467460">(</span><span class="ident" id="4467461">CurveParams</span><span class="op" id="4467472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467475">p521</span><span class="op" id="4467479">.</span><span class="ident" id="4467480">P</span><span class="op" id="4467481">,</span>&nbsp;<span class="ident" id="4467483">_</span>&nbsp;<span class="op" id="4467485">=</span>&nbsp;<span class="builtinfunc" id="4467487">new</span><span class="op" id="4467490">(</span><span class="ident" id="4467491">big</span><span class="op" id="4467494">.</span><span class="ident" id="4467495">Int</span><span class="op" id="4467498">)</span><span class="op" id="4467499">.</span><span class="ident" id="4467500">SetString</span><span class="op" id="4467509">(</span><span class="string" id="4467510">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4467669">,</span>&nbsp;<span class="num" id="4467671">10</span><span class="op" id="4467673">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467676">p521</span><span class="op" id="4467680">.</span><span class="ident" id="4467681">N</span><span class="op" id="4467682">,</span>&nbsp;<span class="ident" id="4467684">_</span>&nbsp;<span class="op" id="4467686">=</span>&nbsp;<span class="builtinfunc" id="4467688">new</span><span class="op" id="4467691">(</span><span class="ident" id="4467692">big</span><span class="op" id="4467695">.</span><span class="ident" id="4467696">Int</span><span class="op" id="4467699">)</span><span class="op" id="4467700">.</span><span class="ident" id="4467701">SetString</span><span class="op" id="4467710">(</span><span class="string" id="4467711">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4467870">,</span>&nbsp;<span class="num" id="4467872">10</span><span class="op" id="4467874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467877">p521</span><span class="op" id="4467881">.</span><span class="ident" id="4467882">B</span><span class="op" id="4467883">,</span>&nbsp;<span class="ident" id="4467885">_</span>&nbsp;<span class="op" id="4467887">=</span>&nbsp;<span class="builtinfunc" id="4467889">new</span><span class="op" id="4467892">(</span><span class="ident" id="4467893">big</span><span class="op" id="4467896">.</span><span class="ident" id="4467897">Int</span><span class="op" id="4467900">)</span><span class="op" id="4467901">.</span><span class="ident" id="4467902">SetString</span><span class="op" id="4467911">(</span><span class="string" id="4467912">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4468045">,</span>&nbsp;<span class="num" id="4468047">16</span><span class="op" id="4468049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4468052">p521</span><span class="op" id="4468056">.</span><span class="ident" id="4468057">Gx</span><span class="op" id="4468059">,</span>&nbsp;<span class="ident" id="4468061">_</span>&nbsp;<span class="op" id="4468063">=</span>&nbsp;<span class="builtinfunc" id="4468065">new</span><span class="op" id="4468068">(</span><span class="ident" id="4468069">big</span><span class="op" id="4468072">.</span><span class="ident" id="4468073">Int</span><span class="op" id="4468076">)</span><span class="op" id="4468077">.</span><span class="ident" id="4468078">SetString</span><span class="op" id="4468087">(</span><span class="string" id="4468088">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4468220">,</span>&nbsp;<span class="num" id="4468222">16</span><span class="op" id="4468224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4468227">p521</span><span class="op" id="4468231">.</span><span class="ident" id="4468232">Gy</span><span class="op" id="4468234">,</span>&nbsp;<span class="ident" id="4468236">_</span>&nbsp;<span class="op" id="4468238">=</span>&nbsp;<span class="builtinfunc" id="4468240">new</span><span class="op" id="4468243">(</span><span class="ident" id="4468244">big</span><span class="op" id="4468247">.</span><span class="ident" id="4468248">Int</span><span class="op" id="4468251">)</span><span class="op" id="4468252">.</span><span class="ident" id="4468253">SetString</span><span class="op" id="4468262">(</span><span class="string" id="4468263">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4468396">,</span>&nbsp;<span class="num" id="4468398">16</span><span class="op" id="4468400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4468403">p521</span><span class="op" id="4468407">.</span><span class="ident" id="4468408">BitSize</span>&nbsp;<span class="op" id="4468416">=</span>&nbsp;<span class="num" id="4468418">521</span><br>
<span class="lineno">355</span><span class="op" id="4468422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4468425">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4468504">func</span>&nbsp;<span class="ident" id="4468509">P256</span><span class="op" id="4468513">(</span><span class="op" id="4468514">)</span>&nbsp;<span class="ident" id="4468516">Curve</span>&nbsp;<span class="op" id="4468522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4468525">initonce</span><span class="op" id="4468533">.</span><span class="ident" id="4468534">Do</span><span class="op" id="4468536">(</span><span class="ident" id="4468537">initAll</span><span class="op" id="4468544">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4468547">return</span>&nbsp;<span class="ident" id="4468554">p256</span><br>
<span class="lineno"></span><span class="op" id="4468559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4468562">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4468641">func</span>&nbsp;<span class="ident" id="4468646">P384</span><span class="op" id="4468650">(</span><span class="op" id="4468651">)</span>&nbsp;<span class="ident" id="4468653">Curve</span>&nbsp;<span class="op" id="4468659">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4468662">initonce</span><span class="op" id="4468670">.</span><span class="ident" id="4468671">Do</span><span class="op" id="4468673">(</span><span class="ident" id="4468674">initAll</span><span class="op" id="4468681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4468684">return</span>&nbsp;<span class="ident" id="4468691">p384</span><br>
<span class="lineno"></span><span class="op" id="4468696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4468699">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4468778">func</span>&nbsp;<span class="ident" id="4468783">P521</span><span class="op" id="4468787">(</span><span class="op" id="4468788">)</span>&nbsp;<span class="ident" id="4468790">Curve</span>&nbsp;<span class="op" id="4468796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4468799">initonce</span><span class="op" id="4468807">.</span><span class="ident" id="4468808">Do</span><span class="op" id="4468810">(</span><span class="ident" id="4468811">initAll</span><span class="op" id="4468818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4468821">return</span>&nbsp;<span class="ident" id="4468828">p521</span><br>
<span class="lineno"></span><span class="op" id="4468833">}</span>
</div>
</body>
</html>
