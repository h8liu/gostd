<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html" class="current">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4034517">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4034572">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4034626">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4034677">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4034736">package</span>&nbsp;<span class="ident" id="4034744">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4034752">import</span>&nbsp;<span class="op" id="4034759">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4034762">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4034770">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4034776">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="4034786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4034789">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="4034869">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4034881">type</span>&nbsp;<span class="ident" id="4034886">Hash</span>&nbsp;<span class="builtintype" id="4034891">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4034897">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4034975">func</span>&nbsp;<span class="op" id="4034980">(</span><span class="ident" id="4034981">h</span>&nbsp;<span class="ident" id="4034983">Hash</span><span class="op" id="4034987">)</span>&nbsp;<span class="ident" id="4034989">HashFunc</span><span class="op" id="4034997">(</span><span class="op" id="4034998">)</span>&nbsp;<span class="ident" id="4035000">Hash</span>&nbsp;<span class="op" id="4035005">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4035008">return</span>&nbsp;<span class="ident" id="4035015">h</span><br>
<span class="lineno"></span><span class="op" id="4035017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4035020">const</span>&nbsp;<span class="op" id="4035026">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035029">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035039">Hash</span>&nbsp;<span class="op" id="4035044">=</span>&nbsp;<span class="num" id="4035046">1</span>&nbsp;<span class="op" id="4035048">+</span>&nbsp;<span class="ident" id="4035050">iota</span>&nbsp;<span class="comment" id="4035055">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035090">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035116">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035138">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035164">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035187">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035213">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035238">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035264">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035289">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035315">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035340">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035366">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035391">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035417">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035466">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035492">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035533">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035559">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035595">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035621">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035657">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035683">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035719">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4035745">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035781">maxHash</span><br>
<span class="lineno"></span><span class="op" id="4035789">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4035792">var</span>&nbsp;<span class="ident" id="4035796">digestSizes</span>&nbsp;<span class="op" id="4035808">=</span>&nbsp;<span class="op" id="4035810">[</span><span class="op" id="4035811">]</span><span class="builtintype" id="4035812">uint8</span><span class="op" id="4035817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035820">MD4</span><span class="op" id="4035823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4035831">16</span><span class="op" id="4035833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035836">MD5</span><span class="op" id="4035839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4035847">16</span><span class="op" id="4035849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035852">SHA1</span><span class="op" id="4035856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4035863">20</span><span class="op" id="4035865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035868">SHA224</span><span class="op" id="4035874">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4035879">28</span><span class="op" id="4035881">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035884">SHA256</span><span class="op" id="4035890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4035895">32</span><span class="op" id="4035897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035900">SHA384</span><span class="op" id="4035906">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4035911">48</span><span class="op" id="4035913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035916">SHA512</span><span class="op" id="4035922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4035927">64</span><span class="op" id="4035929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035932">SHA3_224</span><span class="op" id="4035940">:</span>&nbsp;&nbsp;<span class="num" id="4035943">28</span><span class="op" id="4035945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035948">SHA3_256</span><span class="op" id="4035956">:</span>&nbsp;&nbsp;<span class="num" id="4035959">32</span><span class="op" id="4035961">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035964">SHA3_384</span><span class="op" id="4035972">:</span>&nbsp;&nbsp;<span class="num" id="4035975">48</span><span class="op" id="4035977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035980">SHA3_512</span><span class="op" id="4035988">:</span>&nbsp;&nbsp;<span class="num" id="4035991">64</span><span class="op" id="4035993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4035996">MD5SHA1</span><span class="op" id="4036003">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4036007">36</span><span class="op" id="4036009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4036012">RIPEMD160</span><span class="op" id="4036021">:</span>&nbsp;<span class="num" id="4036023">20</span><span class="op" id="4036025">,</span><br>
<span class="lineno"></span><span class="op" id="4036027">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4036030">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4036110">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="4036187">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="4036208">func</span>&nbsp;<span class="op" id="4036213">(</span><span class="ident" id="4036214">h</span>&nbsp;<span class="ident" id="4036216">Hash</span><span class="op" id="4036220">)</span>&nbsp;<span class="ident" id="4036222">Size</span><span class="op" id="4036226">(</span><span class="op" id="4036227">)</span>&nbsp;<span class="builtintype" id="4036229">int</span>&nbsp;<span class="op" id="4036233">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4036236">if</span>&nbsp;<span class="ident" id="4036239">h</span>&nbsp;<span class="op" id="4036241">&gt;</span>&nbsp;<span class="num" id="4036243">0</span>&nbsp;<span class="op" id="4036245">&amp;&amp;</span>&nbsp;<span class="ident" id="4036248">h</span>&nbsp;<span class="op" id="4036250">&lt;</span>&nbsp;<span class="ident" id="4036252">maxHash</span>&nbsp;<span class="op" id="4036260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4036264">return</span>&nbsp;<span class="builtintype" id="4036271">int</span><span class="op" id="4036274">(</span><span class="ident" id="4036275">digestSizes</span><span class="op" id="4036286">[</span><span class="ident" id="4036287">h</span><span class="op" id="4036288">]</span><span class="op" id="4036289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4036292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4036295">panic</span><span class="op" id="4036300">(</span><span class="string" id="4036301">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4036340">)</span><br>
<span class="lineno"></span><span class="op" id="4036342">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4036345">var</span>&nbsp;<span class="ident" id="4036349">hashes</span>&nbsp;<span class="op" id="4036356">=</span>&nbsp;<span class="builtinfunc" id="4036358">make</span><span class="op" id="4036362">(</span><span class="op" id="4036363">[</span><span class="op" id="4036364">]</span><span class="keyword" id="4036365">func</span><span class="op" id="4036369">(</span><span class="op" id="4036370">)</span>&nbsp;<span class="ident" id="4036372">hash</span><span class="op" id="4036376">.</span><span class="ident" id="4036377">Hash</span><span class="op" id="4036381">,</span>&nbsp;<span class="ident" id="4036383">maxHash</span><span class="op" id="4036390">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4036393">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="4036472">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="4036527">func</span>&nbsp;<span class="op" id="4036532">(</span><span class="ident" id="4036533">h</span>&nbsp;<span class="ident" id="4036535">Hash</span><span class="op" id="4036539">)</span>&nbsp;<span class="ident" id="4036541">New</span><span class="op" id="4036544">(</span><span class="op" id="4036545">)</span>&nbsp;<span class="ident" id="4036547">hash</span><span class="op" id="4036551">.</span><span class="ident" id="4036552">Hash</span>&nbsp;<span class="op" id="4036557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4036560">if</span>&nbsp;<span class="ident" id="4036563">h</span>&nbsp;<span class="op" id="4036565">&gt;</span>&nbsp;<span class="num" id="4036567">0</span>&nbsp;<span class="op" id="4036569">&amp;&amp;</span>&nbsp;<span class="ident" id="4036572">h</span>&nbsp;<span class="op" id="4036574">&lt;</span>&nbsp;<span class="ident" id="4036576">maxHash</span>&nbsp;<span class="op" id="4036584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4036588">f</span>&nbsp;<span class="op" id="4036590">:=</span>&nbsp;<span class="ident" id="4036593">hashes</span><span class="op" id="4036599">[</span><span class="ident" id="4036600">h</span><span class="op" id="4036601">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4036605">if</span>&nbsp;<span class="ident" id="4036608">f</span>&nbsp;<span class="op" id="4036610">!=</span>&nbsp;<span class="ident" id="4036613">nil</span>&nbsp;<span class="op" id="4036617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4036622">return</span>&nbsp;<span class="ident" id="4036629">f</span><span class="op" id="4036630">(</span><span class="op" id="4036631">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4036635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4036638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4036641">panic</span><span class="op" id="4036646">(</span><span class="string" id="4036647">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="4036683">+</span>&nbsp;<span class="ident" id="4036685">strconv</span><span class="op" id="4036692">.</span><span class="ident" id="4036693">Itoa</span><span class="op" id="4036697">(</span><span class="builtintype" id="4036698">int</span><span class="op" id="4036701">(</span><span class="ident" id="4036702">h</span><span class="op" id="4036703">)</span><span class="op" id="4036704">)</span>&nbsp;<span class="op" id="4036706">+</span>&nbsp;<span class="string" id="4036708">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="4036725">)</span><br>
<span class="lineno"></span><span class="op" id="4036727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4036730">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4036810">func</span>&nbsp;<span class="op" id="4036815">(</span><span class="ident" id="4036816">h</span>&nbsp;<span class="ident" id="4036818">Hash</span><span class="op" id="4036822">)</span>&nbsp;<span class="ident" id="4036824">Available</span><span class="op" id="4036833">(</span><span class="op" id="4036834">)</span>&nbsp;<span class="builtintype" id="4036836">bool</span>&nbsp;<span class="op" id="4036841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4036844">return</span>&nbsp;<span class="ident" id="4036851">h</span>&nbsp;<span class="op" id="4036853">&lt;</span>&nbsp;<span class="ident" id="4036855">maxHash</span>&nbsp;<span class="op" id="4036863">&amp;&amp;</span>&nbsp;<span class="ident" id="4036866">hashes</span><span class="op" id="4036872">[</span><span class="ident" id="4036873">h</span><span class="op" id="4036874">]</span>&nbsp;<span class="op" id="4036876">!=</span>&nbsp;<span class="ident" id="4036879">nil</span><br>
<span class="lineno"></span><span class="op" id="4036883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4036886">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4036964">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4037038">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="4037081">func</span>&nbsp;<span class="ident" id="4037086">RegisterHash</span><span class="op" id="4037098">(</span><span class="ident" id="4037099">h</span>&nbsp;<span class="ident" id="4037101">Hash</span><span class="op" id="4037105">,</span>&nbsp;<span class="ident" id="4037107">f</span>&nbsp;<span class="keyword" id="4037109">func</span><span class="op" id="4037113">(</span><span class="op" id="4037114">)</span>&nbsp;<span class="ident" id="4037116">hash</span><span class="op" id="4037120">.</span><span class="ident" id="4037121">Hash</span><span class="op" id="4037125">)</span>&nbsp;<span class="op" id="4037127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4037130">if</span>&nbsp;<span class="ident" id="4037133">h</span>&nbsp;<span class="op" id="4037135">&gt;=</span>&nbsp;<span class="ident" id="4037138">maxHash</span>&nbsp;<span class="op" id="4037146">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4037150">panic</span><span class="op" id="4037155">(</span><span class="string" id="4037156">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4037203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4037206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4037209">hashes</span><span class="op" id="4037215">[</span><span class="ident" id="4037216">h</span><span class="op" id="4037217">]</span>&nbsp;<span class="op" id="4037219">=</span>&nbsp;<span class="ident" id="4037221">f</span><br>
<span class="lineno"></span><span class="op" id="4037223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4037226">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4037295">type</span>&nbsp;<span class="ident" id="4037300">PublicKey</span>&nbsp;<span class="keyword" id="4037310">interface</span><span class="op" id="4037319">{</span><span class="op" id="4037320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4037323">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4037394">type</span>&nbsp;<span class="ident" id="4037399">PrivateKey</span>&nbsp;<span class="keyword" id="4037410">interface</span><span class="op" id="4037419">{</span><span class="op" id="4037420">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4037423">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4037496">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="4037570">type</span>&nbsp;<span class="ident" id="4037575">Signer</span>&nbsp;<span class="keyword" id="4037582">interface</span>&nbsp;<span class="op" id="4037592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037595">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037658">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4037675">Public</span><span class="op" id="4037681">(</span><span class="op" id="4037682">)</span>&nbsp;<span class="ident" id="4037684">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037696">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037765">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037834">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037906">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037973">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4037977">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4038050">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4038123">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4038191">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4038263">Sign</span><span class="op" id="4038267">(</span><span class="ident" id="4038268">rand</span>&nbsp;<span class="ident" id="4038273">io</span><span class="op" id="4038275">.</span><span class="ident" id="4038276">Reader</span><span class="op" id="4038282">,</span>&nbsp;<span class="ident" id="4038284">msg</span>&nbsp;<span class="op" id="4038288">[</span><span class="op" id="4038289">]</span><span class="builtintype" id="4038290">byte</span><span class="op" id="4038294">,</span>&nbsp;<span class="ident" id="4038296">opts</span>&nbsp;<span class="ident" id="4038301">SignerOpts</span><span class="op" id="4038311">)</span>&nbsp;<span class="op" id="4038313">(</span><span class="ident" id="4038314">signature</span>&nbsp;<span class="op" id="4038324">[</span><span class="op" id="4038325">]</span><span class="builtintype" id="4038326">byte</span><span class="op" id="4038330">,</span>&nbsp;<span class="ident" id="4038332">err</span>&nbsp;<span class="builtintype" id="4038336">error</span><span class="op" id="4038341">)</span><br>
<span class="lineno"></span><span class="op" id="4038343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4038346">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="4038404">type</span>&nbsp;<span class="ident" id="4038409">SignerOpts</span>&nbsp;<span class="keyword" id="4038420">interface</span>&nbsp;<span class="op" id="4038430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4038433">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4038506">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4038578">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4038600">HashFunc</span><span class="op" id="4038608">(</span><span class="op" id="4038609">)</span>&nbsp;<span class="ident" id="4038611">Hash</span><br>
<span class="lineno"></span><span class="op" id="4038616">}</span>
</div>
</body>
</html>
