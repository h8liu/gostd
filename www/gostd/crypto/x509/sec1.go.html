<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html" class="current">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4054434">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4054489">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4054543">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4054594">package</span>&nbsp;<span class="ident" id="4054602">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4054608">import</span>&nbsp;<span class="op" id="4054615">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4054618">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4054634">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4054653">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4054670">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4054680">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4054687">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4054698">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4054701">const</span>&nbsp;<span class="ident" id="4054707">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4054724">=</span>&nbsp;<span class="num" id="4054726">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4054729">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4054801">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4054816">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4054829">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4054890">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4054963">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4054988">type</span>&nbsp;<span class="ident" id="4054993">ecPrivateKey</span>&nbsp;<span class="keyword" id="4055006">struct</span>&nbsp;<span class="op" id="4055013">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055016">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4055030">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055035">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4055049">[</span><span class="op" id="4055050">]</span><span class="builtintype" id="4055051">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055057">NamedCurveOID</span>&nbsp;<span class="ident" id="4055071">asn1</span><span class="op" id="4055075">.</span><span class="ident" id="4055076">ObjectIdentifier</span>&nbsp;<span class="string" id="4055093">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055127">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055141">asn1</span><span class="op" id="4055145">.</span><span class="ident" id="4055146">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4055163">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4055196">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4055199">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4055274">func</span>&nbsp;<span class="ident" id="4055279">ParseECPrivateKey</span><span class="op" id="4055296">(</span><span class="ident" id="4055297">der</span>&nbsp;<span class="op" id="4055301">[</span><span class="op" id="4055302">]</span><span class="builtintype" id="4055303">byte</span><span class="op" id="4055307">)</span>&nbsp;<span class="op" id="4055309">(</span><span class="ident" id="4055310">key</span>&nbsp;<span class="op" id="4055314">*</span><span class="ident" id="4055315">ecdsa</span><span class="op" id="4055320">.</span><span class="ident" id="4055321">PrivateKey</span><span class="op" id="4055331">,</span>&nbsp;<span class="ident" id="4055333">err</span>&nbsp;<span class="builtintype" id="4055337">error</span><span class="op" id="4055342">)</span>&nbsp;<span class="op" id="4055344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055347">return</span>&nbsp;<span class="ident" id="4055354">parseECPrivateKey</span><span class="op" id="4055371">(</span><span class="ident" id="4055372">nil</span><span class="op" id="4055375">,</span>&nbsp;<span class="ident" id="4055377">der</span><span class="op" id="4055380">)</span><br>
<span class="lineno"></span><span class="op" id="4055382">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4055385">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4055459">func</span>&nbsp;<span class="ident" id="4055464">MarshalECPrivateKey</span><span class="op" id="4055483">(</span><span class="ident" id="4055484">key</span>&nbsp;<span class="op" id="4055488">*</span><span class="ident" id="4055489">ecdsa</span><span class="op" id="4055494">.</span><span class="ident" id="4055495">PrivateKey</span><span class="op" id="4055505">)</span>&nbsp;<span class="op" id="4055507">(</span><span class="op" id="4055508">[</span><span class="op" id="4055509">]</span><span class="builtintype" id="4055510">byte</span><span class="op" id="4055514">,</span>&nbsp;<span class="builtintype" id="4055516">error</span><span class="op" id="4055521">)</span>&nbsp;<span class="op" id="4055523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055526">oid</span><span class="op" id="4055529">,</span>&nbsp;<span class="ident" id="4055531">ok</span>&nbsp;<span class="op" id="4055534">:=</span>&nbsp;<span class="ident" id="4055537">oidFromNamedCurve</span><span class="op" id="4055554">(</span><span class="ident" id="4055555">key</span><span class="op" id="4055558">.</span><span class="ident" id="4055559">Curve</span><span class="op" id="4055564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055567">if</span>&nbsp;<span class="op" id="4055570">!</span><span class="ident" id="4055571">ok</span>&nbsp;<span class="op" id="4055574">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055578">return</span>&nbsp;<span class="ident" id="4055585">nil</span><span class="op" id="4055588">,</span>&nbsp;<span class="ident" id="4055590">errors</span><span class="op" id="4055596">.</span><span class="ident" id="4055597">New</span><span class="op" id="4055600">(</span><span class="string" id="4055601">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4055631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4055634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055637">return</span>&nbsp;<span class="ident" id="4055644">asn1</span><span class="op" id="4055648">.</span><span class="ident" id="4055649">Marshal</span><span class="op" id="4055656">(</span><span class="ident" id="4055657">ecPrivateKey</span><span class="op" id="4055669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055673">Version</span><span class="op" id="4055680">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4055688">1</span><span class="op" id="4055689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055693">PrivateKey</span><span class="op" id="4055703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055708">key</span><span class="op" id="4055711">.</span><span class="ident" id="4055712">D</span><span class="op" id="4055713">.</span><span class="ident" id="4055714">Bytes</span><span class="op" id="4055719">(</span><span class="op" id="4055720">)</span><span class="op" id="4055721">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055725">NamedCurveOID</span><span class="op" id="4055738">:</span>&nbsp;<span class="ident" id="4055740">oid</span><span class="op" id="4055743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055747">PublicKey</span><span class="op" id="4055756">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055762">asn1</span><span class="op" id="4055766">.</span><span class="ident" id="4055767">BitString</span><span class="op" id="4055776">{</span><span class="ident" id="4055777">Bytes</span><span class="op" id="4055782">:</span>&nbsp;<span class="ident" id="4055784">elliptic</span><span class="op" id="4055792">.</span><span class="ident" id="4055793">Marshal</span><span class="op" id="4055800">(</span><span class="ident" id="4055801">key</span><span class="op" id="4055804">.</span><span class="ident" id="4055805">Curve</span><span class="op" id="4055810">,</span>&nbsp;<span class="ident" id="4055812">key</span><span class="op" id="4055815">.</span><span class="ident" id="4055816">X</span><span class="op" id="4055817">,</span>&nbsp;<span class="ident" id="4055819">key</span><span class="op" id="4055822">.</span><span class="ident" id="4055823">Y</span><span class="op" id="4055824">)</span><span class="op" id="4055825">}</span><span class="op" id="4055826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4055829">}</span><span class="op" id="4055830">)</span><br>
<span class="lineno"></span><span class="op" id="4055832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4055835">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4055910">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4055986">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4056063">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4056114">func</span>&nbsp;<span class="ident" id="4056119">parseECPrivateKey</span><span class="op" id="4056136">(</span><span class="ident" id="4056137">namedCurveOID</span>&nbsp;<span class="op" id="4056151">*</span><span class="ident" id="4056152">asn1</span><span class="op" id="4056156">.</span><span class="ident" id="4056157">ObjectIdentifier</span><span class="op" id="4056173">,</span>&nbsp;<span class="ident" id="4056175">der</span>&nbsp;<span class="op" id="4056179">[</span><span class="op" id="4056180">]</span><span class="builtintype" id="4056181">byte</span><span class="op" id="4056185">)</span>&nbsp;<span class="op" id="4056187">(</span><span class="ident" id="4056188">key</span>&nbsp;<span class="op" id="4056192">*</span><span class="ident" id="4056193">ecdsa</span><span class="op" id="4056198">.</span><span class="ident" id="4056199">PrivateKey</span><span class="op" id="4056209">,</span>&nbsp;<span class="ident" id="4056211">err</span>&nbsp;<span class="builtintype" id="4056215">error</span><span class="op" id="4056220">)</span>&nbsp;<span class="op" id="4056222">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056225">var</span>&nbsp;<span class="ident" id="4056229">privKey</span>&nbsp;<span class="ident" id="4056237">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056251">if</span>&nbsp;<span class="ident" id="4056254">_</span><span class="op" id="4056255">,</span>&nbsp;<span class="ident" id="4056257">err</span>&nbsp;<span class="op" id="4056261">:=</span>&nbsp;<span class="ident" id="4056264">asn1</span><span class="op" id="4056268">.</span><span class="ident" id="4056269">Unmarshal</span><span class="op" id="4056278">(</span><span class="ident" id="4056279">der</span><span class="op" id="4056282">,</span>&nbsp;<span class="op" id="4056284">&amp;</span><span class="ident" id="4056285">privKey</span><span class="op" id="4056292">)</span><span class="op" id="4056293">;</span>&nbsp;<span class="ident" id="4056295">err</span>&nbsp;<span class="op" id="4056299">!=</span>&nbsp;<span class="ident" id="4056302">nil</span>&nbsp;<span class="op" id="4056306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056310">return</span>&nbsp;<span class="ident" id="4056317">nil</span><span class="op" id="4056320">,</span>&nbsp;<span class="ident" id="4056322">errors</span><span class="op" id="4056328">.</span><span class="ident" id="4056329">New</span><span class="op" id="4056332">(</span><span class="string" id="4056333">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4056374">+</span>&nbsp;<span class="ident" id="4056376">err</span><span class="op" id="4056379">.</span><span class="ident" id="4056380">Error</span><span class="op" id="4056385">(</span><span class="op" id="4056386">)</span><span class="op" id="4056387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4056390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056393">if</span>&nbsp;<span class="ident" id="4056396">privKey</span><span class="op" id="4056403">.</span><span class="ident" id="4056404">Version</span>&nbsp;<span class="op" id="4056412">!=</span>&nbsp;<span class="ident" id="4056415">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4056432">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056436">return</span>&nbsp;<span class="ident" id="4056443">nil</span><span class="op" id="4056446">,</span>&nbsp;<span class="ident" id="4056448">fmt</span><span class="op" id="4056451">.</span><span class="ident" id="4056452">Errorf</span><span class="op" id="4056458">(</span><span class="string" id="4056459">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4056500">,</span>&nbsp;<span class="ident" id="4056502">privKey</span><span class="op" id="4056509">.</span><span class="ident" id="4056510">Version</span><span class="op" id="4056517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4056520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056524">var</span>&nbsp;<span class="ident" id="4056528">curve</span>&nbsp;<span class="ident" id="4056534">elliptic</span><span class="op" id="4056542">.</span><span class="ident" id="4056543">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056550">if</span>&nbsp;<span class="ident" id="4056553">namedCurveOID</span>&nbsp;<span class="op" id="4056567">!=</span>&nbsp;<span class="ident" id="4056570">nil</span>&nbsp;<span class="op" id="4056574">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056578">curve</span>&nbsp;<span class="op" id="4056584">=</span>&nbsp;<span class="ident" id="4056586">namedCurveFromOID</span><span class="op" id="4056603">(</span><span class="op" id="4056604">*</span><span class="ident" id="4056605">namedCurveOID</span><span class="op" id="4056618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4056621">}</span>&nbsp;<span class="keyword" id="4056623">else</span>&nbsp;<span class="op" id="4056628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056632">curve</span>&nbsp;<span class="op" id="4056638">=</span>&nbsp;<span class="ident" id="4056640">namedCurveFromOID</span><span class="op" id="4056657">(</span><span class="ident" id="4056658">privKey</span><span class="op" id="4056665">.</span><span class="ident" id="4056666">NamedCurveOID</span><span class="op" id="4056679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4056682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056685">if</span>&nbsp;<span class="ident" id="4056688">curve</span>&nbsp;<span class="op" id="4056694">==</span>&nbsp;<span class="ident" id="4056697">nil</span>&nbsp;<span class="op" id="4056701">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056705">return</span>&nbsp;<span class="ident" id="4056712">nil</span><span class="op" id="4056715">,</span>&nbsp;<span class="ident" id="4056717">errors</span><span class="op" id="4056723">.</span><span class="ident" id="4056724">New</span><span class="op" id="4056727">(</span><span class="string" id="4056728">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4056758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4056761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056765">k</span>&nbsp;<span class="op" id="4056767">:=</span>&nbsp;<span class="builtinfunc" id="4056770">new</span><span class="op" id="4056773">(</span><span class="ident" id="4056774">big</span><span class="op" id="4056777">.</span><span class="ident" id="4056778">Int</span><span class="op" id="4056781">)</span><span class="op" id="4056782">.</span><span class="ident" id="4056783">SetBytes</span><span class="op" id="4056791">(</span><span class="ident" id="4056792">privKey</span><span class="op" id="4056799">.</span><span class="ident" id="4056800">PrivateKey</span><span class="op" id="4056810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056813">if</span>&nbsp;<span class="ident" id="4056816">k</span><span class="op" id="4056817">.</span><span class="ident" id="4056818">Cmp</span><span class="op" id="4056821">(</span><span class="ident" id="4056822">curve</span><span class="op" id="4056827">.</span><span class="ident" id="4056828">Params</span><span class="op" id="4056834">(</span><span class="op" id="4056835">)</span><span class="op" id="4056836">.</span><span class="ident" id="4056837">N</span><span class="op" id="4056838">)</span>&nbsp;<span class="op" id="4056840">&gt;=</span>&nbsp;<span class="num" id="4056843">0</span>&nbsp;<span class="op" id="4056845">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056849">return</span>&nbsp;<span class="ident" id="4056856">nil</span><span class="op" id="4056859">,</span>&nbsp;<span class="ident" id="4056861">errors</span><span class="op" id="4056867">.</span><span class="ident" id="4056868">New</span><span class="op" id="4056871">(</span><span class="string" id="4056872">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4056920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4056923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056926">priv</span>&nbsp;<span class="op" id="4056931">:=</span>&nbsp;<span class="builtinfunc" id="4056934">new</span><span class="op" id="4056937">(</span><span class="ident" id="4056938">ecdsa</span><span class="op" id="4056943">.</span><span class="ident" id="4056944">PrivateKey</span><span class="op" id="4056954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056957">priv</span><span class="op" id="4056961">.</span><span class="ident" id="4056962">Curve</span>&nbsp;<span class="op" id="4056968">=</span>&nbsp;<span class="ident" id="4056970">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056977">priv</span><span class="op" id="4056981">.</span><span class="ident" id="4056982">D</span>&nbsp;<span class="op" id="4056984">=</span>&nbsp;<span class="ident" id="4056986">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056989">priv</span><span class="op" id="4056993">.</span><span class="ident" id="4056994">X</span><span class="op" id="4056995">,</span>&nbsp;<span class="ident" id="4056997">priv</span><span class="op" id="4057001">.</span><span class="ident" id="4057002">Y</span>&nbsp;<span class="op" id="4057004">=</span>&nbsp;<span class="ident" id="4057006">curve</span><span class="op" id="4057011">.</span><span class="ident" id="4057012">ScalarBaseMult</span><span class="op" id="4057026">(</span><span class="ident" id="4057027">privKey</span><span class="op" id="4057034">.</span><span class="ident" id="4057035">PrivateKey</span><span class="op" id="4057045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057049">return</span>&nbsp;<span class="ident" id="4057056">priv</span><span class="op" id="4057060">,</span>&nbsp;<span class="ident" id="4057062">nil</span><br>
<span class="lineno"></span><span class="op" id="4057066">}</span>
</div>
</body>
</html>
