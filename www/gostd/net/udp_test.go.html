<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html" class="current">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6792310">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6792366">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6792420">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6792471">package</span>&nbsp;<span class="ident" id="6792479">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6792484">import</span>&nbsp;<span class="op" id="6792491">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6792494">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6792505">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6792516">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6792527">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6792538">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6792545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6792548">func</span>&nbsp;<span class="ident" id="6792553">TestResolveUDPAddr</span><span class="op" id="6792571">(</span><span class="ident" id="6792572">t</span>&nbsp;<span class="op" id="6792574">*</span><span class="ident" id="6792575">testing</span><span class="op" id="6792582">.</span><span class="ident" id="6792583">T</span><span class="op" id="6792584">)</span>&nbsp;<span class="op" id="6792586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792589">for</span>&nbsp;<span class="ident" id="6792593">_</span><span class="op" id="6792594">,</span>&nbsp;<span class="ident" id="6792596">tt</span>&nbsp;<span class="op" id="6792599">:=</span>&nbsp;<span class="keyword" id="6792602">range</span>&nbsp;<span class="ident" id="6792608">resolveTCPAddrTests</span>&nbsp;<span class="op" id="6792628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792632">net</span>&nbsp;<span class="op" id="6792636">:=</span>&nbsp;<span class="ident" id="6792639">strings</span><span class="op" id="6792646">.</span><span class="ident" id="6792647">Replace</span><span class="op" id="6792654">(</span><span class="ident" id="6792655">tt</span><span class="op" id="6792657">.</span><span class="ident" id="6792658">net</span><span class="op" id="6792661">,</span>&nbsp;<span class="string" id="6792663">&#34;tcp&#34;</span><span class="op" id="6792668">,</span>&nbsp;<span class="string" id="6792670">&#34;udp&#34;</span><span class="op" id="6792675">,</span>&nbsp;<span class="op" id="6792677">-</span><span class="num" id="6792678">1</span><span class="op" id="6792679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792683">addr</span><span class="op" id="6792687">,</span>&nbsp;<span class="ident" id="6792689">err</span>&nbsp;<span class="op" id="6792693">:=</span>&nbsp;<span class="ident" id="6792696">ResolveUDPAddr</span><span class="op" id="6792710">(</span><span class="ident" id="6792711">net</span><span class="op" id="6792714">,</span>&nbsp;<span class="ident" id="6792716">tt</span><span class="op" id="6792718">.</span><span class="ident" id="6792719">litAddrOrName</span><span class="op" id="6792732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792736">if</span>&nbsp;<span class="ident" id="6792739">err</span>&nbsp;<span class="op" id="6792743">!=</span>&nbsp;<span class="ident" id="6792746">tt</span><span class="op" id="6792748">.</span><span class="ident" id="6792749">err</span>&nbsp;<span class="op" id="6792753">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792758">t</span><span class="op" id="6792759">.</span><span class="ident" id="6792760">Fatalf</span><span class="op" id="6792766">(</span><span class="string" id="6792767">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6792802">,</span>&nbsp;<span class="ident" id="6792804">net</span><span class="op" id="6792807">,</span>&nbsp;<span class="ident" id="6792809">tt</span><span class="op" id="6792811">.</span><span class="ident" id="6792812">litAddrOrName</span><span class="op" id="6792825">,</span>&nbsp;<span class="ident" id="6792827">err</span><span class="op" id="6792830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792838">if</span>&nbsp;<span class="op" id="6792841">!</span><span class="ident" id="6792842">reflect</span><span class="op" id="6792849">.</span><span class="ident" id="6792850">DeepEqual</span><span class="op" id="6792859">(</span><span class="ident" id="6792860">addr</span><span class="op" id="6792864">,</span>&nbsp;<span class="op" id="6792866">(</span><span class="op" id="6792867">*</span><span class="ident" id="6792868">UDPAddr</span><span class="op" id="6792875">)</span><span class="op" id="6792876">(</span><span class="ident" id="6792877">tt</span><span class="op" id="6792879">.</span><span class="ident" id="6792880">addr</span><span class="op" id="6792884">)</span><span class="op" id="6792885">)</span>&nbsp;<span class="op" id="6792887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6792892">t</span><span class="op" id="6792893">.</span><span class="ident" id="6792894">Fatalf</span><span class="op" id="6792900">(</span><span class="string" id="6792901">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6792941">,</span>&nbsp;<span class="ident" id="6792943">net</span><span class="op" id="6792946">,</span>&nbsp;<span class="ident" id="6792948">tt</span><span class="op" id="6792950">.</span><span class="ident" id="6792951">litAddrOrName</span><span class="op" id="6792964">,</span>&nbsp;<span class="ident" id="6792966">addr</span><span class="op" id="6792970">,</span>&nbsp;<span class="ident" id="6792972">tt</span><span class="op" id="6792974">.</span><span class="ident" id="6792975">addr</span><span class="op" id="6792979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6792983">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6792987">if</span>&nbsp;<span class="ident" id="6792990">err</span>&nbsp;<span class="op" id="6792994">==</span>&nbsp;<span class="builtintype" id="6792997">nil</span>&nbsp;<span class="op" id="6793001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793006">str</span>&nbsp;<span class="op" id="6793010">:=</span>&nbsp;<span class="ident" id="6793013">addr</span><span class="op" id="6793017">.</span><span class="ident" id="6793018">String</span><span class="op" id="6793024">(</span><span class="op" id="6793025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793030">addr1</span><span class="op" id="6793035">,</span>&nbsp;<span class="ident" id="6793037">err</span>&nbsp;<span class="op" id="6793041">:=</span>&nbsp;<span class="ident" id="6793044">ResolveUDPAddr</span><span class="op" id="6793058">(</span><span class="ident" id="6793059">net</span><span class="op" id="6793062">,</span>&nbsp;<span class="ident" id="6793064">str</span><span class="op" id="6793067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793072">if</span>&nbsp;<span class="ident" id="6793075">err</span>&nbsp;<span class="op" id="6793079">!=</span>&nbsp;<span class="builtintype" id="6793082">nil</span>&nbsp;<span class="op" id="6793086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793092">t</span><span class="op" id="6793093">.</span><span class="ident" id="6793094">Fatalf</span><span class="op" id="6793100">(</span><span class="string" id="6793101">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="6793139">,</span>&nbsp;<span class="ident" id="6793141">net</span><span class="op" id="6793144">,</span>&nbsp;<span class="ident" id="6793146">str</span><span class="op" id="6793149">,</span>&nbsp;<span class="ident" id="6793151">tt</span><span class="op" id="6793153">.</span><span class="ident" id="6793154">litAddrOrName</span><span class="op" id="6793167">,</span>&nbsp;<span class="ident" id="6793169">err</span><span class="op" id="6793172">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793182">if</span>&nbsp;<span class="op" id="6793185">!</span><span class="ident" id="6793186">reflect</span><span class="op" id="6793193">.</span><span class="ident" id="6793194">DeepEqual</span><span class="op" id="6793203">(</span><span class="ident" id="6793204">addr1</span><span class="op" id="6793209">,</span>&nbsp;<span class="ident" id="6793211">addr</span><span class="op" id="6793215">)</span>&nbsp;<span class="op" id="6793217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793223">t</span><span class="op" id="6793224">.</span><span class="ident" id="6793225">Fatalf</span><span class="op" id="6793231">(</span><span class="string" id="6793232">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6793282">,</span>&nbsp;<span class="ident" id="6793284">net</span><span class="op" id="6793287">,</span>&nbsp;<span class="ident" id="6793289">str</span><span class="op" id="6793292">,</span>&nbsp;<span class="ident" id="6793294">tt</span><span class="op" id="6793296">.</span><span class="ident" id="6793297">litAddrOrName</span><span class="op" id="6793310">,</span>&nbsp;<span class="ident" id="6793312">addr1</span><span class="op" id="6793317">,</span>&nbsp;<span class="ident" id="6793319">addr</span><span class="op" id="6793323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793332">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793335">}</span><br>
<span class="lineno"></span><span class="op" id="6793337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6793340">func</span>&nbsp;<span class="ident" id="6793345">TestReadFromUDP</span><span class="op" id="6793360">(</span><span class="ident" id="6793361">t</span>&nbsp;<span class="op" id="6793363">*</span><span class="ident" id="6793364">testing</span><span class="op" id="6793371">.</span><span class="ident" id="6793372">T</span><span class="op" id="6793373">)</span>&nbsp;<span class="op" id="6793375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793378">switch</span>&nbsp;<span class="ident" id="6793385">runtime</span><span class="op" id="6793392">.</span><span class="ident" id="6793393">GOOS</span>&nbsp;<span class="op" id="6793398">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793401">case</span>&nbsp;<span class="string" id="6793406">&#34;nacl&#34;</span><span class="op" id="6793412">,</span>&nbsp;<span class="string" id="6793414">&#34;plan9&#34;</span><span class="op" id="6793421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793425">t</span><span class="op" id="6793426">.</span><span class="ident" id="6793427">Skipf</span><span class="op" id="6793432">(</span><span class="string" id="6793433">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="6793470">,</span>&nbsp;<span class="ident" id="6793472">runtime</span><span class="op" id="6793479">.</span><span class="ident" id="6793480">GOOS</span><span class="op" id="6793484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793491">ra</span><span class="op" id="6793493">,</span>&nbsp;<span class="ident" id="6793495">err</span>&nbsp;<span class="op" id="6793499">:=</span>&nbsp;<span class="ident" id="6793502">ResolveUDPAddr</span><span class="op" id="6793516">(</span><span class="string" id="6793517">&#34;udp&#34;</span><span class="op" id="6793522">,</span>&nbsp;<span class="string" id="6793524">&#34;127.0.0.1:7&#34;</span><span class="op" id="6793537">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793540">if</span>&nbsp;<span class="ident" id="6793543">err</span>&nbsp;<span class="op" id="6793547">!=</span>&nbsp;<span class="builtintype" id="6793550">nil</span>&nbsp;<span class="op" id="6793554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793558">t</span><span class="op" id="6793559">.</span><span class="ident" id="6793560">Fatal</span><span class="op" id="6793565">(</span><span class="ident" id="6793566">err</span><span class="op" id="6793569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793576">la</span><span class="op" id="6793578">,</span>&nbsp;<span class="ident" id="6793580">err</span>&nbsp;<span class="op" id="6793584">:=</span>&nbsp;<span class="ident" id="6793587">ResolveUDPAddr</span><span class="op" id="6793601">(</span><span class="string" id="6793602">&#34;udp&#34;</span><span class="op" id="6793607">,</span>&nbsp;<span class="string" id="6793609">&#34;127.0.0.1:0&#34;</span><span class="op" id="6793622">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793625">if</span>&nbsp;<span class="ident" id="6793628">err</span>&nbsp;<span class="op" id="6793632">!=</span>&nbsp;<span class="builtintype" id="6793635">nil</span>&nbsp;<span class="op" id="6793639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793643">t</span><span class="op" id="6793644">.</span><span class="ident" id="6793645">Fatal</span><span class="op" id="6793650">(</span><span class="ident" id="6793651">err</span><span class="op" id="6793654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793661">c</span><span class="op" id="6793662">,</span>&nbsp;<span class="ident" id="6793664">err</span>&nbsp;<span class="op" id="6793668">:=</span>&nbsp;<span class="ident" id="6793671">ListenUDP</span><span class="op" id="6793680">(</span><span class="string" id="6793681">&#34;udp&#34;</span><span class="op" id="6793686">,</span>&nbsp;<span class="ident" id="6793688">la</span><span class="op" id="6793690">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793693">if</span>&nbsp;<span class="ident" id="6793696">err</span>&nbsp;<span class="op" id="6793700">!=</span>&nbsp;<span class="builtintype" id="6793703">nil</span>&nbsp;<span class="op" id="6793707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793711">t</span><span class="op" id="6793712">.</span><span class="ident" id="6793713">Fatal</span><span class="op" id="6793718">(</span><span class="ident" id="6793719">err</span><span class="op" id="6793722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793728">defer</span>&nbsp;<span class="ident" id="6793734">c</span><span class="op" id="6793735">.</span><span class="ident" id="6793736">Close</span><span class="op" id="6793741">(</span><span class="op" id="6793742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793746">_</span><span class="op" id="6793747">,</span>&nbsp;<span class="ident" id="6793749">err</span>&nbsp;<span class="op" id="6793753">=</span>&nbsp;<span class="ident" id="6793755">c</span><span class="op" id="6793756">.</span><span class="ident" id="6793757">WriteToUDP</span><span class="op" id="6793767">(</span><span class="op" id="6793768">[</span><span class="op" id="6793769">]</span><span class="builtintype" id="6793770">byte</span><span class="op" id="6793774">(</span><span class="string" id="6793775">&#34;a&#34;</span><span class="op" id="6793778">)</span><span class="op" id="6793779">,</span>&nbsp;<span class="ident" id="6793781">ra</span><span class="op" id="6793783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793786">if</span>&nbsp;<span class="ident" id="6793789">err</span>&nbsp;<span class="op" id="6793793">!=</span>&nbsp;<span class="builtintype" id="6793796">nil</span>&nbsp;<span class="op" id="6793800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793804">t</span><span class="op" id="6793805">.</span><span class="ident" id="6793806">Fatal</span><span class="op" id="6793811">(</span><span class="ident" id="6793812">err</span><span class="op" id="6793815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793822">err</span>&nbsp;<span class="op" id="6793826">=</span>&nbsp;<span class="ident" id="6793828">c</span><span class="op" id="6793829">.</span><span class="ident" id="6793830">SetDeadline</span><span class="op" id="6793841">(</span><span class="ident" id="6793842">time</span><span class="op" id="6793846">.</span><span class="ident" id="6793847">Now</span><span class="op" id="6793850">(</span><span class="op" id="6793851">)</span><span class="op" id="6793852">.</span><span class="ident" id="6793853">Add</span><span class="op" id="6793856">(</span><span class="num" id="6793857">100</span>&nbsp;<span class="op" id="6793861">*</span>&nbsp;<span class="ident" id="6793863">time</span><span class="op" id="6793867">.</span><span class="ident" id="6793868">Millisecond</span><span class="op" id="6793879">)</span><span class="op" id="6793880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793883">if</span>&nbsp;<span class="ident" id="6793886">err</span>&nbsp;<span class="op" id="6793890">!=</span>&nbsp;<span class="builtintype" id="6793893">nil</span>&nbsp;<span class="op" id="6793897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793901">t</span><span class="op" id="6793902">.</span><span class="ident" id="6793903">Fatal</span><span class="op" id="6793908">(</span><span class="ident" id="6793909">err</span><span class="op" id="6793912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6793915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793918">b</span>&nbsp;<span class="op" id="6793920">:=</span>&nbsp;<span class="builtinfunc" id="6793923">make</span><span class="op" id="6793927">(</span><span class="op" id="6793928">[</span><span class="op" id="6793929">]</span><span class="builtintype" id="6793930">byte</span><span class="op" id="6793934">,</span>&nbsp;<span class="num" id="6793936">1</span><span class="op" id="6793937">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793940">_</span><span class="op" id="6793941">,</span>&nbsp;<span class="ident" id="6793943">_</span><span class="op" id="6793944">,</span>&nbsp;<span class="ident" id="6793946">err</span>&nbsp;<span class="op" id="6793950">=</span>&nbsp;<span class="ident" id="6793952">c</span><span class="op" id="6793953">.</span><span class="ident" id="6793954">ReadFromUDP</span><span class="op" id="6793965">(</span><span class="ident" id="6793966">b</span><span class="op" id="6793967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6793970">if</span>&nbsp;<span class="ident" id="6793973">err</span>&nbsp;<span class="op" id="6793977">==</span>&nbsp;<span class="builtintype" id="6793980">nil</span>&nbsp;<span class="op" id="6793984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6793988">t</span><span class="op" id="6793989">.</span><span class="ident" id="6793990">Fatal</span><span class="op" id="6793995">(</span><span class="string" id="6793996">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6794021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794024">}</span>&nbsp;<span class="keyword" id="6794026">else</span>&nbsp;<span class="keyword" id="6794031">if</span>&nbsp;<span class="op" id="6794034">!</span><span class="ident" id="6794035">isTimeout</span><span class="op" id="6794044">(</span><span class="ident" id="6794045">err</span><span class="op" id="6794048">)</span>&nbsp;<span class="op" id="6794050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794054">t</span><span class="op" id="6794055">.</span><span class="ident" id="6794056">Fatal</span><span class="op" id="6794061">(</span><span class="ident" id="6794062">err</span><span class="op" id="6794065">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794068">}</span><br>
<span class="lineno"></span><span class="op" id="6794070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6794073">func</span>&nbsp;<span class="ident" id="6794078">TestWriteToUDP</span><span class="op" id="6794092">(</span><span class="ident" id="6794093">t</span>&nbsp;<span class="op" id="6794095">*</span><span class="ident" id="6794096">testing</span><span class="op" id="6794103">.</span><span class="ident" id="6794104">T</span><span class="op" id="6794105">)</span>&nbsp;<span class="op" id="6794107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794110">switch</span>&nbsp;<span class="ident" id="6794117">runtime</span><span class="op" id="6794124">.</span><span class="ident" id="6794125">GOOS</span>&nbsp;<span class="op" id="6794130">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794133">case</span>&nbsp;<span class="string" id="6794138">&#34;plan9&#34;</span><span class="op" id="6794145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794149">t</span><span class="op" id="6794150">.</span><span class="ident" id="6794151">Skipf</span><span class="op" id="6794156">(</span><span class="string" id="6794157">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6794178">,</span>&nbsp;<span class="ident" id="6794180">runtime</span><span class="op" id="6794187">.</span><span class="ident" id="6794188">GOOS</span><span class="op" id="6794192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794199">l</span><span class="op" id="6794200">,</span>&nbsp;<span class="ident" id="6794202">err</span>&nbsp;<span class="op" id="6794206">:=</span>&nbsp;<span class="ident" id="6794209">ListenPacket</span><span class="op" id="6794221">(</span><span class="string" id="6794222">&#34;udp&#34;</span><span class="op" id="6794227">,</span>&nbsp;<span class="string" id="6794229">&#34;127.0.0.1:0&#34;</span><span class="op" id="6794242">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794245">if</span>&nbsp;<span class="ident" id="6794248">err</span>&nbsp;<span class="op" id="6794252">!=</span>&nbsp;<span class="builtintype" id="6794255">nil</span>&nbsp;<span class="op" id="6794259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794263">t</span><span class="op" id="6794264">.</span><span class="ident" id="6794265">Fatalf</span><span class="op" id="6794271">(</span><span class="string" id="6794272">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6794291">,</span>&nbsp;<span class="ident" id="6794293">err</span><span class="op" id="6794296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794302">defer</span>&nbsp;<span class="ident" id="6794308">l</span><span class="op" id="6794309">.</span><span class="ident" id="6794310">Close</span><span class="op" id="6794315">(</span><span class="op" id="6794316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794320">testWriteToConn</span><span class="op" id="6794335">(</span><span class="ident" id="6794336">t</span><span class="op" id="6794337">,</span>&nbsp;<span class="ident" id="6794339">l</span><span class="op" id="6794340">.</span><span class="ident" id="6794341">LocalAddr</span><span class="op" id="6794350">(</span><span class="op" id="6794351">)</span><span class="op" id="6794352">.</span><span class="ident" id="6794353">String</span><span class="op" id="6794359">(</span><span class="op" id="6794360">)</span><span class="op" id="6794361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794364">testWriteToPacketConn</span><span class="op" id="6794385">(</span><span class="ident" id="6794386">t</span><span class="op" id="6794387">,</span>&nbsp;<span class="ident" id="6794389">l</span><span class="op" id="6794390">.</span><span class="ident" id="6794391">LocalAddr</span><span class="op" id="6794400">(</span><span class="op" id="6794401">)</span><span class="op" id="6794402">.</span><span class="ident" id="6794403">String</span><span class="op" id="6794409">(</span><span class="op" id="6794410">)</span><span class="op" id="6794411">)</span><br>
<span class="lineno"></span><span class="op" id="6794413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6794416">func</span>&nbsp;<span class="ident" id="6794421">testWriteToConn</span><span class="op" id="6794436">(</span><span class="ident" id="6794437">t</span>&nbsp;<span class="op" id="6794439">*</span><span class="ident" id="6794440">testing</span><span class="op" id="6794447">.</span><span class="ident" id="6794448">T</span><span class="op" id="6794449">,</span>&nbsp;<span class="ident" id="6794451">raddr</span>&nbsp;<span class="builtintype" id="6794457">string</span><span class="op" id="6794463">)</span>&nbsp;<span class="op" id="6794465">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794468">c</span><span class="op" id="6794469">,</span>&nbsp;<span class="ident" id="6794471">err</span>&nbsp;<span class="op" id="6794475">:=</span>&nbsp;<span class="ident" id="6794478">Dial</span><span class="op" id="6794482">(</span><span class="string" id="6794483">&#34;udp&#34;</span><span class="op" id="6794488">,</span>&nbsp;<span class="ident" id="6794490">raddr</span><span class="op" id="6794495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794498">if</span>&nbsp;<span class="ident" id="6794501">err</span>&nbsp;<span class="op" id="6794505">!=</span>&nbsp;<span class="builtintype" id="6794508">nil</span>&nbsp;<span class="op" id="6794512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794516">t</span><span class="op" id="6794517">.</span><span class="ident" id="6794518">Fatalf</span><span class="op" id="6794524">(</span><span class="string" id="6794525">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6794542">,</span>&nbsp;<span class="ident" id="6794544">err</span><span class="op" id="6794547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794553">defer</span>&nbsp;<span class="ident" id="6794559">c</span><span class="op" id="6794560">.</span><span class="ident" id="6794561">Close</span><span class="op" id="6794566">(</span><span class="op" id="6794567">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794571">ra</span><span class="op" id="6794573">,</span>&nbsp;<span class="ident" id="6794575">err</span>&nbsp;<span class="op" id="6794579">:=</span>&nbsp;<span class="ident" id="6794582">ResolveUDPAddr</span><span class="op" id="6794596">(</span><span class="string" id="6794597">&#34;udp&#34;</span><span class="op" id="6794602">,</span>&nbsp;<span class="ident" id="6794604">raddr</span><span class="op" id="6794609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794612">if</span>&nbsp;<span class="ident" id="6794615">err</span>&nbsp;<span class="op" id="6794619">!=</span>&nbsp;<span class="builtintype" id="6794622">nil</span>&nbsp;<span class="op" id="6794626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794630">t</span><span class="op" id="6794631">.</span><span class="ident" id="6794632">Fatalf</span><span class="op" id="6794638">(</span><span class="string" id="6794639">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6794666">,</span>&nbsp;<span class="ident" id="6794668">err</span><span class="op" id="6794671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794674">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794678">_</span><span class="op" id="6794679">,</span>&nbsp;<span class="ident" id="6794681">err</span>&nbsp;<span class="op" id="6794685">=</span>&nbsp;<span class="ident" id="6794687">c</span><span class="op" id="6794688">.</span><span class="op" id="6794689">(</span><span class="op" id="6794690">*</span><span class="ident" id="6794691">UDPConn</span><span class="op" id="6794698">)</span><span class="op" id="6794699">.</span><span class="ident" id="6794700">WriteToUDP</span><span class="op" id="6794710">(</span><span class="op" id="6794711">[</span><span class="op" id="6794712">]</span><span class="builtintype" id="6794713">byte</span><span class="op" id="6794717">(</span><span class="string" id="6794718">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6794751">)</span><span class="op" id="6794752">,</span>&nbsp;<span class="ident" id="6794754">ra</span><span class="op" id="6794756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794759">if</span>&nbsp;<span class="ident" id="6794762">err</span>&nbsp;<span class="op" id="6794766">==</span>&nbsp;<span class="builtintype" id="6794769">nil</span>&nbsp;<span class="op" id="6794773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794777">t</span><span class="op" id="6794778">.</span><span class="ident" id="6794779">Fatal</span><span class="op" id="6794784">(</span><span class="string" id="6794785">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6794809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794812">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6794815">if</span>&nbsp;<span class="ident" id="6794818">err</span>&nbsp;<span class="op" id="6794822">!=</span>&nbsp;<span class="builtintype" id="6794825">nil</span>&nbsp;<span class="op" id="6794829">&amp;&amp;</span>&nbsp;<span class="ident" id="6794832">err</span><span class="op" id="6794835">.</span><span class="op" id="6794836">(</span><span class="op" id="6794837">*</span><span class="ident" id="6794838">OpError</span><span class="op" id="6794845">)</span><span class="op" id="6794846">.</span><span class="ident" id="6794847">Err</span>&nbsp;<span class="op" id="6794851">!=</span>&nbsp;<span class="ident" id="6794854">ErrWriteToConnected</span>&nbsp;<span class="op" id="6794874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794878">t</span><span class="op" id="6794879">.</span><span class="ident" id="6794880">Fatalf</span><span class="op" id="6794886">(</span><span class="string" id="6794887">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6794938">,</span>&nbsp;<span class="ident" id="6794940">err</span><span class="op" id="6794943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6794946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794950">_</span><span class="op" id="6794951">,</span>&nbsp;<span class="ident" id="6794953">err</span>&nbsp;<span class="op" id="6794957">=</span>&nbsp;<span class="ident" id="6794959">c</span><span class="op" id="6794960">.</span><span class="op" id="6794961">(</span><span class="op" id="6794962">*</span><span class="ident" id="6794963">UDPConn</span><span class="op" id="6794970">)</span><span class="op" id="6794971">.</span><span class="ident" id="6794972">WriteTo</span><span class="op" id="6794979">(</span><span class="op" id="6794980">[</span><span class="op" id="6794981">]</span><span class="builtintype" id="6794982">byte</span><span class="op" id="6794986">(</span><span class="string" id="6794987">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6795020">)</span><span class="op" id="6795021">,</span>&nbsp;<span class="ident" id="6795023">ra</span><span class="op" id="6795025">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795028">if</span>&nbsp;<span class="ident" id="6795031">err</span>&nbsp;<span class="op" id="6795035">==</span>&nbsp;<span class="builtintype" id="6795038">nil</span>&nbsp;<span class="op" id="6795042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795046">t</span><span class="op" id="6795047">.</span><span class="ident" id="6795048">Fatal</span><span class="op" id="6795053">(</span><span class="string" id="6795054">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6795075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795081">if</span>&nbsp;<span class="ident" id="6795084">err</span>&nbsp;<span class="op" id="6795088">!=</span>&nbsp;<span class="builtintype" id="6795091">nil</span>&nbsp;<span class="op" id="6795095">&amp;&amp;</span>&nbsp;<span class="ident" id="6795098">err</span><span class="op" id="6795101">.</span><span class="op" id="6795102">(</span><span class="op" id="6795103">*</span><span class="ident" id="6795104">OpError</span><span class="op" id="6795111">)</span><span class="op" id="6795112">.</span><span class="ident" id="6795113">Err</span>&nbsp;<span class="op" id="6795117">!=</span>&nbsp;<span class="ident" id="6795120">ErrWriteToConnected</span>&nbsp;<span class="op" id="6795140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795144">t</span><span class="op" id="6795145">.</span><span class="ident" id="6795146">Fatalf</span><span class="op" id="6795152">(</span><span class="string" id="6795153">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6795201">,</span>&nbsp;<span class="ident" id="6795203">err</span><span class="op" id="6795206">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795213">_</span><span class="op" id="6795214">,</span>&nbsp;<span class="ident" id="6795216">err</span>&nbsp;<span class="op" id="6795220">=</span>&nbsp;<span class="ident" id="6795222">c</span><span class="op" id="6795223">.</span><span class="ident" id="6795224">Write</span><span class="op" id="6795229">(</span><span class="op" id="6795230">[</span><span class="op" id="6795231">]</span><span class="builtintype" id="6795232">byte</span><span class="op" id="6795236">(</span><span class="string" id="6795237">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6795270">)</span><span class="op" id="6795271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795274">if</span>&nbsp;<span class="ident" id="6795277">err</span>&nbsp;<span class="op" id="6795281">!=</span>&nbsp;<span class="builtintype" id="6795284">nil</span>&nbsp;<span class="op" id="6795288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795292">t</span><span class="op" id="6795293">.</span><span class="ident" id="6795294">Fatalf</span><span class="op" id="6795300">(</span><span class="string" id="6795301">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6795319">,</span>&nbsp;<span class="ident" id="6795321">err</span><span class="op" id="6795324">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795327">}</span><br>
<span class="lineno"></span><span class="op" id="6795329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6795332">func</span>&nbsp;<span class="ident" id="6795337">testWriteToPacketConn</span><span class="op" id="6795358">(</span><span class="ident" id="6795359">t</span>&nbsp;<span class="op" id="6795361">*</span><span class="ident" id="6795362">testing</span><span class="op" id="6795369">.</span><span class="ident" id="6795370">T</span><span class="op" id="6795371">,</span>&nbsp;<span class="ident" id="6795373">raddr</span>&nbsp;<span class="builtintype" id="6795379">string</span><span class="op" id="6795385">)</span>&nbsp;<span class="op" id="6795387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795390">c</span><span class="op" id="6795391">,</span>&nbsp;<span class="ident" id="6795393">err</span>&nbsp;<span class="op" id="6795397">:=</span>&nbsp;<span class="ident" id="6795400">ListenPacket</span><span class="op" id="6795412">(</span><span class="string" id="6795413">&#34;udp&#34;</span><span class="op" id="6795418">,</span>&nbsp;<span class="string" id="6795420">&#34;127.0.0.1:0&#34;</span><span class="op" id="6795433">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795436">if</span>&nbsp;<span class="ident" id="6795439">err</span>&nbsp;<span class="op" id="6795443">!=</span>&nbsp;<span class="builtintype" id="6795446">nil</span>&nbsp;<span class="op" id="6795450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795454">t</span><span class="op" id="6795455">.</span><span class="ident" id="6795456">Fatalf</span><span class="op" id="6795462">(</span><span class="string" id="6795463">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6795488">,</span>&nbsp;<span class="ident" id="6795490">err</span><span class="op" id="6795493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795499">defer</span>&nbsp;<span class="ident" id="6795505">c</span><span class="op" id="6795506">.</span><span class="ident" id="6795507">Close</span><span class="op" id="6795512">(</span><span class="op" id="6795513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795517">ra</span><span class="op" id="6795519">,</span>&nbsp;<span class="ident" id="6795521">err</span>&nbsp;<span class="op" id="6795525">:=</span>&nbsp;<span class="ident" id="6795528">ResolveUDPAddr</span><span class="op" id="6795542">(</span><span class="string" id="6795543">&#34;udp&#34;</span><span class="op" id="6795548">,</span>&nbsp;<span class="ident" id="6795550">raddr</span><span class="op" id="6795555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795558">if</span>&nbsp;<span class="ident" id="6795561">err</span>&nbsp;<span class="op" id="6795565">!=</span>&nbsp;<span class="builtintype" id="6795568">nil</span>&nbsp;<span class="op" id="6795572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795576">t</span><span class="op" id="6795577">.</span><span class="ident" id="6795578">Fatalf</span><span class="op" id="6795584">(</span><span class="string" id="6795585">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6795612">,</span>&nbsp;<span class="ident" id="6795614">err</span><span class="op" id="6795617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795624">_</span><span class="op" id="6795625">,</span>&nbsp;<span class="ident" id="6795627">err</span>&nbsp;<span class="op" id="6795631">=</span>&nbsp;<span class="ident" id="6795633">c</span><span class="op" id="6795634">.</span><span class="op" id="6795635">(</span><span class="op" id="6795636">*</span><span class="ident" id="6795637">UDPConn</span><span class="op" id="6795644">)</span><span class="op" id="6795645">.</span><span class="ident" id="6795646">WriteToUDP</span><span class="op" id="6795656">(</span><span class="op" id="6795657">[</span><span class="op" id="6795658">]</span><span class="builtintype" id="6795659">byte</span><span class="op" id="6795663">(</span><span class="string" id="6795664">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6795693">)</span><span class="op" id="6795694">,</span>&nbsp;<span class="ident" id="6795696">ra</span><span class="op" id="6795698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795701">if</span>&nbsp;<span class="ident" id="6795704">err</span>&nbsp;<span class="op" id="6795708">!=</span>&nbsp;<span class="builtintype" id="6795711">nil</span>&nbsp;<span class="op" id="6795715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795719">t</span><span class="op" id="6795720">.</span><span class="ident" id="6795721">Fatalf</span><span class="op" id="6795727">(</span><span class="string" id="6795728">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6795751">,</span>&nbsp;<span class="ident" id="6795753">err</span><span class="op" id="6795756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795763">_</span><span class="op" id="6795764">,</span>&nbsp;<span class="ident" id="6795766">err</span>&nbsp;<span class="op" id="6795770">=</span>&nbsp;<span class="ident" id="6795772">c</span><span class="op" id="6795773">.</span><span class="ident" id="6795774">WriteTo</span><span class="op" id="6795781">(</span><span class="op" id="6795782">[</span><span class="op" id="6795783">]</span><span class="builtintype" id="6795784">byte</span><span class="op" id="6795788">(</span><span class="string" id="6795789">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6795818">)</span><span class="op" id="6795819">,</span>&nbsp;<span class="ident" id="6795821">ra</span><span class="op" id="6795823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795826">if</span>&nbsp;<span class="ident" id="6795829">err</span>&nbsp;<span class="op" id="6795833">!=</span>&nbsp;<span class="builtintype" id="6795836">nil</span>&nbsp;<span class="op" id="6795840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795844">t</span><span class="op" id="6795845">.</span><span class="ident" id="6795846">Fatalf</span><span class="op" id="6795852">(</span><span class="string" id="6795853">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6795873">,</span>&nbsp;<span class="ident" id="6795875">err</span><span class="op" id="6795878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795885">_</span><span class="op" id="6795886">,</span>&nbsp;<span class="ident" id="6795888">err</span>&nbsp;<span class="op" id="6795892">=</span>&nbsp;<span class="ident" id="6795894">c</span><span class="op" id="6795895">.</span><span class="op" id="6795896">(</span><span class="op" id="6795897">*</span><span class="ident" id="6795898">UDPConn</span><span class="op" id="6795905">)</span><span class="op" id="6795906">.</span><span class="ident" id="6795907">Write</span><span class="op" id="6795912">(</span><span class="op" id="6795913">[</span><span class="op" id="6795914">]</span><span class="builtintype" id="6795915">byte</span><span class="op" id="6795919">(</span><span class="string" id="6795920">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6795949">)</span><span class="op" id="6795950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795953">if</span>&nbsp;<span class="ident" id="6795956">err</span>&nbsp;<span class="op" id="6795960">==</span>&nbsp;<span class="builtintype" id="6795963">nil</span>&nbsp;<span class="op" id="6795967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795971">t</span><span class="op" id="6795972">.</span><span class="ident" id="6795973">Fatal</span><span class="op" id="6795978">(</span><span class="string" id="6795979">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6795998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796001">}</span><br>
<span class="lineno"></span><span class="op" id="6796003">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="6796006">var</span>&nbsp;<span class="ident" id="6796010">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6796032">=</span>&nbsp;<span class="op" id="6796034">[</span><span class="op" id="6796035">]</span><span class="keyword" id="6796036">struct</span>&nbsp;<span class="op" id="6796043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796046">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6796052">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796060">laddr</span>&nbsp;<span class="op" id="6796066">*</span><span class="ident" id="6796067">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="6796075">}</span><span class="op" id="6796076">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796079">{</span><span class="string" id="6796080">&#34;udp4&#34;</span><span class="op" id="6796086">,</span>&nbsp;<span class="op" id="6796088">&amp;</span><span class="ident" id="6796089">UDPAddr</span><span class="op" id="6796096">{</span><span class="ident" id="6796097">IP</span><span class="op" id="6796099">:</span>&nbsp;<span class="ident" id="6796101">IPv4</span><span class="op" id="6796105">(</span><span class="num" id="6796106">127</span><span class="op" id="6796109">,</span>&nbsp;<span class="num" id="6796111">0</span><span class="op" id="6796112">,</span>&nbsp;<span class="num" id="6796114">0</span><span class="op" id="6796115">,</span>&nbsp;<span class="num" id="6796117">1</span><span class="op" id="6796118">)</span><span class="op" id="6796119">}</span><span class="op" id="6796120">}</span><span class="op" id="6796121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796124">{</span><span class="string" id="6796125">&#34;udp4&#34;</span><span class="op" id="6796131">,</span>&nbsp;<span class="op" id="6796133">&amp;</span><span class="ident" id="6796134">UDPAddr</span><span class="op" id="6796141">{</span><span class="op" id="6796142">}</span><span class="op" id="6796143">}</span><span class="op" id="6796144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796147">{</span><span class="string" id="6796148">&#34;udp4&#34;</span><span class="op" id="6796154">,</span>&nbsp;<span class="builtintype" id="6796156">nil</span><span class="op" id="6796159">}</span><span class="op" id="6796160">,</span><br>
<span class="lineno"></span><span class="op" id="6796162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6796165">func</span>&nbsp;<span class="ident" id="6796170">TestUDPConnLocalName</span><span class="op" id="6796190">(</span><span class="ident" id="6796191">t</span>&nbsp;<span class="op" id="6796193">*</span><span class="ident" id="6796194">testing</span><span class="op" id="6796201">.</span><span class="ident" id="6796202">T</span><span class="op" id="6796203">)</span>&nbsp;<span class="op" id="6796205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796208">if</span>&nbsp;<span class="ident" id="6796211">testing</span><span class="op" id="6796218">.</span><span class="ident" id="6796219">Short</span><span class="op" id="6796224">(</span><span class="op" id="6796225">)</span>&nbsp;<span class="op" id="6796227">||</span>&nbsp;<span class="op" id="6796230">!</span><span class="op" id="6796231">*</span><span class="ident" id="6796232">testExternal</span>&nbsp;<span class="op" id="6796245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796249">t</span><span class="op" id="6796250">.</span><span class="ident" id="6796251">Skip</span><span class="op" id="6796255">(</span><span class="string" id="6796256">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6796297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796304">for</span>&nbsp;<span class="ident" id="6796308">_</span><span class="op" id="6796309">,</span>&nbsp;<span class="ident" id="6796311">tt</span>&nbsp;<span class="op" id="6796314">:=</span>&nbsp;<span class="keyword" id="6796317">range</span>&nbsp;<span class="ident" id="6796323">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6796345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796349">c</span><span class="op" id="6796350">,</span>&nbsp;<span class="ident" id="6796352">err</span>&nbsp;<span class="op" id="6796356">:=</span>&nbsp;<span class="ident" id="6796359">ListenUDP</span><span class="op" id="6796368">(</span><span class="ident" id="6796369">tt</span><span class="op" id="6796371">.</span><span class="ident" id="6796372">net</span><span class="op" id="6796375">,</span>&nbsp;<span class="ident" id="6796377">tt</span><span class="op" id="6796379">.</span><span class="ident" id="6796380">laddr</span><span class="op" id="6796385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796389">if</span>&nbsp;<span class="ident" id="6796392">err</span>&nbsp;<span class="op" id="6796396">!=</span>&nbsp;<span class="builtintype" id="6796399">nil</span>&nbsp;<span class="op" id="6796403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796408">t</span><span class="op" id="6796409">.</span><span class="ident" id="6796410">Fatalf</span><span class="op" id="6796416">(</span><span class="string" id="6796417">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6796439">,</span>&nbsp;<span class="ident" id="6796441">err</span><span class="op" id="6796444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796448">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796452">defer</span>&nbsp;<span class="ident" id="6796458">c</span><span class="op" id="6796459">.</span><span class="ident" id="6796460">Close</span><span class="op" id="6796465">(</span><span class="op" id="6796466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796470">la</span>&nbsp;<span class="op" id="6796473">:=</span>&nbsp;<span class="ident" id="6796476">c</span><span class="op" id="6796477">.</span><span class="ident" id="6796478">LocalAddr</span><span class="op" id="6796487">(</span><span class="op" id="6796488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796492">if</span>&nbsp;<span class="ident" id="6796495">a</span><span class="op" id="6796496">,</span>&nbsp;<span class="ident" id="6796498">ok</span>&nbsp;<span class="op" id="6796501">:=</span>&nbsp;<span class="ident" id="6796504">la</span><span class="op" id="6796506">.</span><span class="op" id="6796507">(</span><span class="op" id="6796508">*</span><span class="ident" id="6796509">UDPAddr</span><span class="op" id="6796516">)</span><span class="op" id="6796517">;</span>&nbsp;<span class="op" id="6796519">!</span><span class="ident" id="6796520">ok</span>&nbsp;<span class="op" id="6796523">||</span>&nbsp;<span class="ident" id="6796526">a</span><span class="op" id="6796527">.</span><span class="ident" id="6796528">Port</span>&nbsp;<span class="op" id="6796533">==</span>&nbsp;<span class="num" id="6796536">0</span>&nbsp;<span class="op" id="6796538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796543">t</span><span class="op" id="6796544">.</span><span class="ident" id="6796545">Fatalf</span><span class="op" id="6796551">(</span><span class="string" id="6796552">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6796613">,</span>&nbsp;<span class="ident" id="6796615">la</span><span class="op" id="6796617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796621">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796624">}</span><br>
<span class="lineno"></span><span class="op" id="6796626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6796629">func</span>&nbsp;<span class="ident" id="6796634">TestUDPConnLocalAndRemoteNames</span><span class="op" id="6796664">(</span><span class="ident" id="6796665">t</span>&nbsp;<span class="op" id="6796667">*</span><span class="ident" id="6796668">testing</span><span class="op" id="6796675">.</span><span class="ident" id="6796676">T</span><span class="op" id="6796677">)</span>&nbsp;<span class="op" id="6796679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796682">for</span>&nbsp;<span class="ident" id="6796686">_</span><span class="op" id="6796687">,</span>&nbsp;<span class="ident" id="6796689">laddr</span>&nbsp;<span class="op" id="6796695">:=</span>&nbsp;<span class="keyword" id="6796698">range</span>&nbsp;<span class="op" id="6796704">[</span><span class="op" id="6796705">]</span><span class="builtintype" id="6796706">string</span><span class="op" id="6796712">{</span><span class="string" id="6796713">&#34;&#34;</span><span class="op" id="6796715">,</span>&nbsp;<span class="string" id="6796717">&#34;127.0.0.1:0&#34;</span><span class="op" id="6796730">}</span>&nbsp;<span class="op" id="6796732">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796736">c1</span><span class="op" id="6796738">,</span>&nbsp;<span class="ident" id="6796740">err</span>&nbsp;<span class="op" id="6796744">:=</span>&nbsp;<span class="ident" id="6796747">ListenPacket</span><span class="op" id="6796759">(</span><span class="string" id="6796760">&#34;udp&#34;</span><span class="op" id="6796765">,</span>&nbsp;<span class="string" id="6796767">&#34;127.0.0.1:0&#34;</span><span class="op" id="6796780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796784">if</span>&nbsp;<span class="ident" id="6796787">err</span>&nbsp;<span class="op" id="6796791">!=</span>&nbsp;<span class="builtintype" id="6796794">nil</span>&nbsp;<span class="op" id="6796798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796803">t</span><span class="op" id="6796804">.</span><span class="ident" id="6796805">Fatalf</span><span class="op" id="6796811">(</span><span class="string" id="6796812">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6796834">,</span>&nbsp;<span class="ident" id="6796836">err</span><span class="op" id="6796839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796847">defer</span>&nbsp;<span class="ident" id="6796853">c1</span><span class="op" id="6796855">.</span><span class="ident" id="6796856">Close</span><span class="op" id="6796861">(</span><span class="op" id="6796862">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796867">var</span>&nbsp;<span class="ident" id="6796871">la</span>&nbsp;<span class="op" id="6796874">*</span><span class="ident" id="6796875">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796885">if</span>&nbsp;<span class="ident" id="6796888">laddr</span>&nbsp;<span class="op" id="6796894">!=</span>&nbsp;<span class="string" id="6796897">&#34;&#34;</span>&nbsp;<span class="op" id="6796900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796905">var</span>&nbsp;<span class="ident" id="6796909">err</span>&nbsp;<span class="builtintype" id="6796913">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796922">if</span>&nbsp;<span class="ident" id="6796925">la</span><span class="op" id="6796927">,</span>&nbsp;<span class="ident" id="6796929">err</span>&nbsp;<span class="op" id="6796933">=</span>&nbsp;<span class="ident" id="6796935">ResolveUDPAddr</span><span class="op" id="6796949">(</span><span class="string" id="6796950">&#34;udp&#34;</span><span class="op" id="6796955">,</span>&nbsp;<span class="ident" id="6796957">laddr</span><span class="op" id="6796962">)</span><span class="op" id="6796963">;</span>&nbsp;<span class="ident" id="6796965">err</span>&nbsp;<span class="op" id="6796969">!=</span>&nbsp;<span class="builtintype" id="6796972">nil</span>&nbsp;<span class="op" id="6796976">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796982">t</span><span class="op" id="6796983">.</span><span class="ident" id="6796984">Fatalf</span><span class="op" id="6796990">(</span><span class="string" id="6796991">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6797018">,</span>&nbsp;<span class="ident" id="6797020">err</span><span class="op" id="6797023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797036">c2</span><span class="op" id="6797038">,</span>&nbsp;<span class="ident" id="6797040">err</span>&nbsp;<span class="op" id="6797044">:=</span>&nbsp;<span class="ident" id="6797047">DialUDP</span><span class="op" id="6797054">(</span><span class="string" id="6797055">&#34;udp&#34;</span><span class="op" id="6797060">,</span>&nbsp;<span class="ident" id="6797062">la</span><span class="op" id="6797064">,</span>&nbsp;<span class="ident" id="6797066">c1</span><span class="op" id="6797068">.</span><span class="ident" id="6797069">LocalAddr</span><span class="op" id="6797078">(</span><span class="op" id="6797079">)</span><span class="op" id="6797080">.</span><span class="op" id="6797081">(</span><span class="op" id="6797082">*</span><span class="ident" id="6797083">UDPAddr</span><span class="op" id="6797090">)</span><span class="op" id="6797091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797095">if</span>&nbsp;<span class="ident" id="6797098">err</span>&nbsp;<span class="op" id="6797102">!=</span>&nbsp;<span class="builtintype" id="6797105">nil</span>&nbsp;<span class="op" id="6797109">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797114">t</span><span class="op" id="6797115">.</span><span class="ident" id="6797116">Fatalf</span><span class="op" id="6797122">(</span><span class="string" id="6797123">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6797143">,</span>&nbsp;<span class="ident" id="6797145">err</span><span class="op" id="6797148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797156">defer</span>&nbsp;<span class="ident" id="6797162">c2</span><span class="op" id="6797164">.</span><span class="ident" id="6797165">Close</span><span class="op" id="6797170">(</span><span class="op" id="6797171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797176">var</span>&nbsp;<span class="ident" id="6797180">connAddrs</span>&nbsp;<span class="op" id="6797190">=</span>&nbsp;<span class="op" id="6797192">[</span><span class="num" id="6797193">4</span><span class="op" id="6797194">]</span><span class="keyword" id="6797195">struct</span>&nbsp;<span class="op" id="6797202">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797207">got</span>&nbsp;<span class="ident" id="6797211">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797219">ok</span>&nbsp;&nbsp;<span class="builtintype" id="6797223">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797230">}</span><span class="op" id="6797231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797236">{</span><span class="ident" id="6797237">c1</span><span class="op" id="6797239">.</span><span class="ident" id="6797240">LocalAddr</span><span class="op" id="6797249">(</span><span class="op" id="6797250">)</span><span class="op" id="6797251">,</span>&nbsp;<span class="builtintype" id="6797253">true</span><span class="op" id="6797257">}</span><span class="op" id="6797258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797263">{</span><span class="ident" id="6797264">c1</span><span class="op" id="6797266">.</span><span class="op" id="6797267">(</span><span class="op" id="6797268">*</span><span class="ident" id="6797269">UDPConn</span><span class="op" id="6797276">)</span><span class="op" id="6797277">.</span><span class="ident" id="6797278">RemoteAddr</span><span class="op" id="6797288">(</span><span class="op" id="6797289">)</span><span class="op" id="6797290">,</span>&nbsp;<span class="builtintype" id="6797292">false</span><span class="op" id="6797297">}</span><span class="op" id="6797298">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797303">{</span><span class="ident" id="6797304">c2</span><span class="op" id="6797306">.</span><span class="ident" id="6797307">LocalAddr</span><span class="op" id="6797316">(</span><span class="op" id="6797317">)</span><span class="op" id="6797318">,</span>&nbsp;<span class="builtintype" id="6797320">true</span><span class="op" id="6797324">}</span><span class="op" id="6797325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797330">{</span><span class="ident" id="6797331">c2</span><span class="op" id="6797333">.</span><span class="ident" id="6797334">RemoteAddr</span><span class="op" id="6797344">(</span><span class="op" id="6797345">)</span><span class="op" id="6797346">,</span>&nbsp;<span class="builtintype" id="6797348">true</span><span class="op" id="6797352">}</span><span class="op" id="6797353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797361">for</span>&nbsp;<span class="ident" id="6797365">_</span><span class="op" id="6797366">,</span>&nbsp;<span class="ident" id="6797368">ca</span>&nbsp;<span class="op" id="6797371">:=</span>&nbsp;<span class="keyword" id="6797374">range</span>&nbsp;<span class="ident" id="6797380">connAddrs</span>&nbsp;<span class="op" id="6797390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797395">if</span>&nbsp;<span class="ident" id="6797398">a</span><span class="op" id="6797399">,</span>&nbsp;<span class="ident" id="6797401">ok</span>&nbsp;<span class="op" id="6797404">:=</span>&nbsp;<span class="ident" id="6797407">ca</span><span class="op" id="6797409">.</span><span class="ident" id="6797410">got</span><span class="op" id="6797413">.</span><span class="op" id="6797414">(</span><span class="op" id="6797415">*</span><span class="ident" id="6797416">UDPAddr</span><span class="op" id="6797423">)</span><span class="op" id="6797424">;</span>&nbsp;<span class="ident" id="6797426">ok</span>&nbsp;<span class="op" id="6797429">!=</span>&nbsp;<span class="ident" id="6797432">ca</span><span class="op" id="6797434">.</span><span class="ident" id="6797435">ok</span>&nbsp;<span class="op" id="6797438">||</span>&nbsp;<span class="ident" id="6797441">ok</span>&nbsp;<span class="op" id="6797444">&amp;&amp;</span>&nbsp;<span class="ident" id="6797447">a</span><span class="op" id="6797448">.</span><span class="ident" id="6797449">Port</span>&nbsp;<span class="op" id="6797454">==</span>&nbsp;<span class="num" id="6797457">0</span>&nbsp;<span class="op" id="6797459">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797465">t</span><span class="op" id="6797466">.</span><span class="ident" id="6797467">Fatalf</span><span class="op" id="6797473">(</span><span class="string" id="6797474">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6797535">,</span>&nbsp;<span class="ident" id="6797537">ca</span><span class="op" id="6797539">.</span><span class="ident" id="6797540">got</span><span class="op" id="6797543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797555">}</span><br>
<span class="lineno"></span><span class="op" id="6797557">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="6797560">func</span>&nbsp;<span class="ident" id="6797565">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="6797592">(</span><span class="ident" id="6797593">t</span>&nbsp;<span class="op" id="6797595">*</span><span class="ident" id="6797596">testing</span><span class="op" id="6797603">.</span><span class="ident" id="6797604">T</span><span class="op" id="6797605">)</span>&nbsp;<span class="op" id="6797607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797610">if</span>&nbsp;<span class="ident" id="6797613">testing</span><span class="op" id="6797620">.</span><span class="ident" id="6797621">Short</span><span class="op" id="6797626">(</span><span class="op" id="6797627">)</span>&nbsp;<span class="op" id="6797629">||</span>&nbsp;<span class="op" id="6797632">!</span><span class="op" id="6797633">*</span><span class="ident" id="6797634">testExternal</span>&nbsp;<span class="op" id="6797647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797651">t</span><span class="op" id="6797652">.</span><span class="ident" id="6797653">Skip</span><span class="op" id="6797657">(</span><span class="string" id="6797658">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6797699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797702">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797705">if</span>&nbsp;<span class="op" id="6797708">!</span><span class="ident" id="6797709">supportsIPv6</span>&nbsp;<span class="op" id="6797722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797726">t</span><span class="op" id="6797727">.</span><span class="ident" id="6797728">Skip</span><span class="op" id="6797732">(</span><span class="string" id="6797733">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6797756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797762">ifi</span>&nbsp;<span class="op" id="6797766">:=</span>&nbsp;<span class="ident" id="6797769">loopbackInterface</span><span class="op" id="6797786">(</span><span class="op" id="6797787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797790">if</span>&nbsp;<span class="ident" id="6797793">ifi</span>&nbsp;<span class="op" id="6797797">==</span>&nbsp;<span class="builtintype" id="6797800">nil</span>&nbsp;<span class="op" id="6797804">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797808">t</span><span class="op" id="6797809">.</span><span class="ident" id="6797810">Skip</span><span class="op" id="6797814">(</span><span class="string" id="6797815">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="6797845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797851">laddr</span>&nbsp;<span class="op" id="6797857">:=</span>&nbsp;<span class="ident" id="6797860">ipv6LinkLocalUnicastAddr</span><span class="op" id="6797884">(</span><span class="ident" id="6797885">ifi</span><span class="op" id="6797888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797891">if</span>&nbsp;<span class="ident" id="6797894">laddr</span>&nbsp;<span class="op" id="6797900">==</span>&nbsp;<span class="string" id="6797903">&#34;&#34;</span>&nbsp;<span class="op" id="6797906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797910">t</span><span class="op" id="6797911">.</span><span class="ident" id="6797912">Skip</span><span class="op" id="6797916">(</span><span class="string" id="6797917">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="6797961">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797968">type</span>&nbsp;<span class="ident" id="6797973">test</span>&nbsp;<span class="keyword" id="6797978">struct</span>&nbsp;<span class="op" id="6797985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797989">net</span><span class="op" id="6797992">,</span>&nbsp;<span class="ident" id="6797994">addr</span>&nbsp;&nbsp;<span class="builtintype" id="6798000">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798009">nameLookup</span>&nbsp;<span class="builtintype" id="6798020">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798029">var</span>&nbsp;<span class="ident" id="6798033">tests</span>&nbsp;<span class="op" id="6798039">=</span>&nbsp;<span class="op" id="6798041">[</span><span class="op" id="6798042">]</span><span class="ident" id="6798043">test</span><span class="op" id="6798047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798051">{</span><span class="string" id="6798052">&#34;udp&#34;</span><span class="op" id="6798057">,</span>&nbsp;<span class="string" id="6798059">&#34;[&#34;</span>&nbsp;<span class="op" id="6798063">+</span>&nbsp;<span class="ident" id="6798065">laddr</span>&nbsp;<span class="op" id="6798071">+</span>&nbsp;<span class="string" id="6798073">&#34;%&#34;</span>&nbsp;<span class="op" id="6798077">+</span>&nbsp;<span class="ident" id="6798079">ifi</span><span class="op" id="6798082">.</span><span class="ident" id="6798083">Name</span>&nbsp;<span class="op" id="6798088">+</span>&nbsp;<span class="string" id="6798090">&#34;]:0&#34;</span><span class="op" id="6798095">,</span>&nbsp;<span class="builtintype" id="6798097">false</span><span class="op" id="6798102">}</span><span class="op" id="6798103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798107">{</span><span class="string" id="6798108">&#34;udp6&#34;</span><span class="op" id="6798114">,</span>&nbsp;<span class="string" id="6798116">&#34;[&#34;</span>&nbsp;<span class="op" id="6798120">+</span>&nbsp;<span class="ident" id="6798122">laddr</span>&nbsp;<span class="op" id="6798128">+</span>&nbsp;<span class="string" id="6798130">&#34;%&#34;</span>&nbsp;<span class="op" id="6798134">+</span>&nbsp;<span class="ident" id="6798136">ifi</span><span class="op" id="6798139">.</span><span class="ident" id="6798140">Name</span>&nbsp;<span class="op" id="6798145">+</span>&nbsp;<span class="string" id="6798147">&#34;]:0&#34;</span><span class="op" id="6798152">,</span>&nbsp;<span class="builtintype" id="6798154">false</span><span class="op" id="6798159">}</span><span class="op" id="6798160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798163">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6798166">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798226">if</span>&nbsp;<span class="ident" id="6798229">runtime</span><span class="op" id="6798236">.</span><span class="ident" id="6798237">GOOS</span>&nbsp;<span class="op" id="6798242">==</span>&nbsp;<span class="string" id="6798245">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="6798257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798261">tests</span>&nbsp;<span class="op" id="6798267">=</span>&nbsp;<span class="ident" id="6798269">tests</span><span class="op" id="6798274">[</span><span class="num" id="6798275">1</span><span class="op" id="6798276">:</span><span class="op" id="6798277">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798283">switch</span>&nbsp;<span class="ident" id="6798290">runtime</span><span class="op" id="6798297">.</span><span class="ident" id="6798298">GOOS</span>&nbsp;<span class="op" id="6798303">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798306">case</span>&nbsp;<span class="string" id="6798311">&#34;darwin&#34;</span><span class="op" id="6798319">,</span>&nbsp;<span class="string" id="6798321">&#34;dragonfly&#34;</span><span class="op" id="6798332">,</span>&nbsp;<span class="string" id="6798334">&#34;freebsd&#34;</span><span class="op" id="6798343">,</span>&nbsp;<span class="string" id="6798345">&#34;openbsd&#34;</span><span class="op" id="6798354">,</span>&nbsp;<span class="string" id="6798356">&#34;netbsd&#34;</span><span class="op" id="6798364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798368">tests</span>&nbsp;<span class="op" id="6798374">=</span>&nbsp;<span class="builtinfunc" id="6798376">append</span><span class="op" id="6798382">(</span><span class="ident" id="6798383">tests</span><span class="op" id="6798388">,</span>&nbsp;<span class="op" id="6798390">[</span><span class="op" id="6798391">]</span><span class="ident" id="6798392">test</span><span class="op" id="6798396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798401">{</span><span class="string" id="6798402">&#34;udp&#34;</span><span class="op" id="6798407">,</span>&nbsp;<span class="string" id="6798409">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6798423">+</span>&nbsp;<span class="ident" id="6798425">ifi</span><span class="op" id="6798428">.</span><span class="ident" id="6798429">Name</span>&nbsp;<span class="op" id="6798434">+</span>&nbsp;<span class="string" id="6798436">&#34;]:0&#34;</span><span class="op" id="6798441">,</span>&nbsp;<span class="builtintype" id="6798443">true</span><span class="op" id="6798447">}</span><span class="op" id="6798448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798453">{</span><span class="string" id="6798454">&#34;udp6&#34;</span><span class="op" id="6798460">,</span>&nbsp;<span class="string" id="6798462">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6798476">+</span>&nbsp;<span class="ident" id="6798478">ifi</span><span class="op" id="6798481">.</span><span class="ident" id="6798482">Name</span>&nbsp;<span class="op" id="6798487">+</span>&nbsp;<span class="string" id="6798489">&#34;]:0&#34;</span><span class="op" id="6798494">,</span>&nbsp;<span class="builtintype" id="6798496">true</span><span class="op" id="6798500">}</span><span class="op" id="6798501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798505">}</span><span class="op" id="6798506">...</span><span class="op" id="6798509">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798512">case</span>&nbsp;<span class="string" id="6798517">&#34;linux&#34;</span><span class="op" id="6798524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798528">tests</span>&nbsp;<span class="op" id="6798534">=</span>&nbsp;<span class="builtinfunc" id="6798536">append</span><span class="op" id="6798542">(</span><span class="ident" id="6798543">tests</span><span class="op" id="6798548">,</span>&nbsp;<span class="op" id="6798550">[</span><span class="op" id="6798551">]</span><span class="ident" id="6798552">test</span><span class="op" id="6798556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798561">{</span><span class="string" id="6798562">&#34;udp&#34;</span><span class="op" id="6798567">,</span>&nbsp;<span class="string" id="6798569">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6798587">+</span>&nbsp;<span class="ident" id="6798589">ifi</span><span class="op" id="6798592">.</span><span class="ident" id="6798593">Name</span>&nbsp;<span class="op" id="6798598">+</span>&nbsp;<span class="string" id="6798600">&#34;]:0&#34;</span><span class="op" id="6798605">,</span>&nbsp;<span class="builtintype" id="6798607">true</span><span class="op" id="6798611">}</span><span class="op" id="6798612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798617">{</span><span class="string" id="6798618">&#34;udp6&#34;</span><span class="op" id="6798624">,</span>&nbsp;<span class="string" id="6798626">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6798644">+</span>&nbsp;<span class="ident" id="6798646">ifi</span><span class="op" id="6798649">.</span><span class="ident" id="6798650">Name</span>&nbsp;<span class="op" id="6798655">+</span>&nbsp;<span class="string" id="6798657">&#34;]:0&#34;</span><span class="op" id="6798662">,</span>&nbsp;<span class="builtintype" id="6798664">true</span><span class="op" id="6798668">}</span><span class="op" id="6798669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798673">}</span><span class="op" id="6798674">...</span><span class="op" id="6798677">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798683">for</span>&nbsp;<span class="ident" id="6798687">_</span><span class="op" id="6798688">,</span>&nbsp;<span class="ident" id="6798690">tt</span>&nbsp;<span class="op" id="6798693">:=</span>&nbsp;<span class="keyword" id="6798696">range</span>&nbsp;<span class="ident" id="6798702">tests</span>&nbsp;<span class="op" id="6798708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798712">c1</span><span class="op" id="6798714">,</span>&nbsp;<span class="ident" id="6798716">err</span>&nbsp;<span class="op" id="6798720">:=</span>&nbsp;<span class="ident" id="6798723">ListenPacket</span><span class="op" id="6798735">(</span><span class="ident" id="6798736">tt</span><span class="op" id="6798738">.</span><span class="ident" id="6798739">net</span><span class="op" id="6798742">,</span>&nbsp;<span class="ident" id="6798744">tt</span><span class="op" id="6798746">.</span><span class="ident" id="6798747">addr</span><span class="op" id="6798751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798755">if</span>&nbsp;<span class="ident" id="6798758">err</span>&nbsp;<span class="op" id="6798762">!=</span>&nbsp;<span class="builtintype" id="6798765">nil</span>&nbsp;<span class="op" id="6798769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6798774">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6798820">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798869">t</span><span class="op" id="6798870">.</span><span class="ident" id="6798871">Logf</span><span class="op" id="6798875">(</span><span class="string" id="6798876">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6798901">,</span>&nbsp;<span class="ident" id="6798903">err</span><span class="op" id="6798906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798911">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798926">defer</span>&nbsp;<span class="ident" id="6798932">c1</span><span class="op" id="6798934">.</span><span class="ident" id="6798935">Close</span><span class="op" id="6798940">(</span><span class="op" id="6798941">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798945">if</span>&nbsp;<span class="ident" id="6798948">la</span><span class="op" id="6798950">,</span>&nbsp;<span class="ident" id="6798952">ok</span>&nbsp;<span class="op" id="6798955">:=</span>&nbsp;<span class="ident" id="6798958">c1</span><span class="op" id="6798960">.</span><span class="ident" id="6798961">LocalAddr</span><span class="op" id="6798970">(</span><span class="op" id="6798971">)</span><span class="op" id="6798972">.</span><span class="op" id="6798973">(</span><span class="op" id="6798974">*</span><span class="ident" id="6798975">UDPAddr</span><span class="op" id="6798982">)</span><span class="op" id="6798983">;</span>&nbsp;<span class="op" id="6798985">!</span><span class="ident" id="6798986">ok</span>&nbsp;<span class="op" id="6798989">||</span>&nbsp;<span class="op" id="6798992">!</span><span class="ident" id="6798993">tt</span><span class="op" id="6798995">.</span><span class="ident" id="6798996">nameLookup</span>&nbsp;<span class="op" id="6799007">&amp;&amp;</span>&nbsp;<span class="ident" id="6799010">la</span><span class="op" id="6799012">.</span><span class="ident" id="6799013">Zone</span>&nbsp;<span class="op" id="6799018">==</span>&nbsp;<span class="string" id="6799021">&#34;&#34;</span>&nbsp;<span class="op" id="6799024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799029">t</span><span class="op" id="6799030">.</span><span class="ident" id="6799031">Fatalf</span><span class="op" id="6799037">(</span><span class="string" id="6799038">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6799094">,</span>&nbsp;<span class="ident" id="6799096">la</span><span class="op" id="6799098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799107">c2</span><span class="op" id="6799109">,</span>&nbsp;<span class="ident" id="6799111">err</span>&nbsp;<span class="op" id="6799115">:=</span>&nbsp;<span class="ident" id="6799118">Dial</span><span class="op" id="6799122">(</span><span class="ident" id="6799123">tt</span><span class="op" id="6799125">.</span><span class="ident" id="6799126">net</span><span class="op" id="6799129">,</span>&nbsp;<span class="ident" id="6799131">c1</span><span class="op" id="6799133">.</span><span class="ident" id="6799134">LocalAddr</span><span class="op" id="6799143">(</span><span class="op" id="6799144">)</span><span class="op" id="6799145">.</span><span class="ident" id="6799146">String</span><span class="op" id="6799152">(</span><span class="op" id="6799153">)</span><span class="op" id="6799154">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799158">if</span>&nbsp;<span class="ident" id="6799161">err</span>&nbsp;<span class="op" id="6799165">!=</span>&nbsp;<span class="builtintype" id="6799168">nil</span>&nbsp;<span class="op" id="6799172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799177">t</span><span class="op" id="6799178">.</span><span class="ident" id="6799179">Fatalf</span><span class="op" id="6799185">(</span><span class="string" id="6799186">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6799203">,</span>&nbsp;<span class="ident" id="6799205">err</span><span class="op" id="6799208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799216">defer</span>&nbsp;<span class="ident" id="6799222">c2</span><span class="op" id="6799224">.</span><span class="ident" id="6799225">Close</span><span class="op" id="6799230">(</span><span class="op" id="6799231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799235">if</span>&nbsp;<span class="ident" id="6799238">la</span><span class="op" id="6799240">,</span>&nbsp;<span class="ident" id="6799242">ok</span>&nbsp;<span class="op" id="6799245">:=</span>&nbsp;<span class="ident" id="6799248">c2</span><span class="op" id="6799250">.</span><span class="ident" id="6799251">LocalAddr</span><span class="op" id="6799260">(</span><span class="op" id="6799261">)</span><span class="op" id="6799262">.</span><span class="op" id="6799263">(</span><span class="op" id="6799264">*</span><span class="ident" id="6799265">UDPAddr</span><span class="op" id="6799272">)</span><span class="op" id="6799273">;</span>&nbsp;<span class="op" id="6799275">!</span><span class="ident" id="6799276">ok</span>&nbsp;<span class="op" id="6799279">||</span>&nbsp;<span class="op" id="6799282">!</span><span class="ident" id="6799283">tt</span><span class="op" id="6799285">.</span><span class="ident" id="6799286">nameLookup</span>&nbsp;<span class="op" id="6799297">&amp;&amp;</span>&nbsp;<span class="ident" id="6799300">la</span><span class="op" id="6799302">.</span><span class="ident" id="6799303">Zone</span>&nbsp;<span class="op" id="6799308">==</span>&nbsp;<span class="string" id="6799311">&#34;&#34;</span>&nbsp;<span class="op" id="6799314">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799319">t</span><span class="op" id="6799320">.</span><span class="ident" id="6799321">Fatalf</span><span class="op" id="6799327">(</span><span class="string" id="6799328">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6799384">,</span>&nbsp;<span class="ident" id="6799386">la</span><span class="op" id="6799388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799396">if</span>&nbsp;<span class="ident" id="6799399">ra</span><span class="op" id="6799401">,</span>&nbsp;<span class="ident" id="6799403">ok</span>&nbsp;<span class="op" id="6799406">:=</span>&nbsp;<span class="ident" id="6799409">c2</span><span class="op" id="6799411">.</span><span class="ident" id="6799412">RemoteAddr</span><span class="op" id="6799422">(</span><span class="op" id="6799423">)</span><span class="op" id="6799424">.</span><span class="op" id="6799425">(</span><span class="op" id="6799426">*</span><span class="ident" id="6799427">UDPAddr</span><span class="op" id="6799434">)</span><span class="op" id="6799435">;</span>&nbsp;<span class="op" id="6799437">!</span><span class="ident" id="6799438">ok</span>&nbsp;<span class="op" id="6799441">||</span>&nbsp;<span class="op" id="6799444">!</span><span class="ident" id="6799445">tt</span><span class="op" id="6799447">.</span><span class="ident" id="6799448">nameLookup</span>&nbsp;<span class="op" id="6799459">&amp;&amp;</span>&nbsp;<span class="ident" id="6799462">ra</span><span class="op" id="6799464">.</span><span class="ident" id="6799465">Zone</span>&nbsp;<span class="op" id="6799470">==</span>&nbsp;<span class="string" id="6799473">&#34;&#34;</span>&nbsp;<span class="op" id="6799476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799481">t</span><span class="op" id="6799482">.</span><span class="ident" id="6799483">Fatalf</span><span class="op" id="6799489">(</span><span class="string" id="6799490">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6799546">,</span>&nbsp;<span class="ident" id="6799548">ra</span><span class="op" id="6799550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799554">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799559">if</span>&nbsp;<span class="ident" id="6799562">_</span><span class="op" id="6799563">,</span>&nbsp;<span class="ident" id="6799565">err</span>&nbsp;<span class="op" id="6799569">:=</span>&nbsp;<span class="ident" id="6799572">c2</span><span class="op" id="6799574">.</span><span class="ident" id="6799575">Write</span><span class="op" id="6799580">(</span><span class="op" id="6799581">[</span><span class="op" id="6799582">]</span><span class="builtintype" id="6799583">byte</span><span class="op" id="6799587">(</span><span class="string" id="6799588">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="6799618">)</span><span class="op" id="6799619">)</span><span class="op" id="6799620">;</span>&nbsp;<span class="ident" id="6799622">err</span>&nbsp;<span class="op" id="6799626">!=</span>&nbsp;<span class="builtintype" id="6799629">nil</span>&nbsp;<span class="op" id="6799633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799638">t</span><span class="op" id="6799639">.</span><span class="ident" id="6799640">Fatalf</span><span class="op" id="6799646">(</span><span class="string" id="6799647">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6799670">,</span>&nbsp;<span class="ident" id="6799672">err</span><span class="op" id="6799675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799683">b</span>&nbsp;<span class="op" id="6799685">:=</span>&nbsp;<span class="builtinfunc" id="6799688">make</span><span class="op" id="6799692">(</span><span class="op" id="6799693">[</span><span class="op" id="6799694">]</span><span class="builtintype" id="6799695">byte</span><span class="op" id="6799699">,</span>&nbsp;<span class="num" id="6799701">32</span><span class="op" id="6799703">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799707">if</span>&nbsp;<span class="ident" id="6799710">_</span><span class="op" id="6799711">,</span>&nbsp;<span class="ident" id="6799713">from</span><span class="op" id="6799717">,</span>&nbsp;<span class="ident" id="6799719">err</span>&nbsp;<span class="op" id="6799723">:=</span>&nbsp;<span class="ident" id="6799726">c1</span><span class="op" id="6799728">.</span><span class="ident" id="6799729">ReadFrom</span><span class="op" id="6799737">(</span><span class="ident" id="6799738">b</span><span class="op" id="6799739">)</span><span class="op" id="6799740">;</span>&nbsp;<span class="ident" id="6799742">err</span>&nbsp;<span class="op" id="6799746">!=</span>&nbsp;<span class="builtintype" id="6799749">nil</span>&nbsp;<span class="op" id="6799753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799758">t</span><span class="op" id="6799759">.</span><span class="ident" id="6799760">Fatalf</span><span class="op" id="6799766">(</span><span class="string" id="6799767">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6799799">,</span>&nbsp;<span class="ident" id="6799801">err</span><span class="op" id="6799804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799808">}</span>&nbsp;<span class="keyword" id="6799810">else</span>&nbsp;<span class="op" id="6799815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799820">if</span>&nbsp;<span class="ident" id="6799823">ra</span><span class="op" id="6799825">,</span>&nbsp;<span class="ident" id="6799827">ok</span>&nbsp;<span class="op" id="6799830">:=</span>&nbsp;<span class="ident" id="6799833">from</span><span class="op" id="6799837">.</span><span class="op" id="6799838">(</span><span class="op" id="6799839">*</span><span class="ident" id="6799840">UDPAddr</span><span class="op" id="6799847">)</span><span class="op" id="6799848">;</span>&nbsp;<span class="op" id="6799850">!</span><span class="ident" id="6799851">ok</span>&nbsp;<span class="op" id="6799854">||</span>&nbsp;<span class="op" id="6799857">!</span><span class="ident" id="6799858">tt</span><span class="op" id="6799860">.</span><span class="ident" id="6799861">nameLookup</span>&nbsp;<span class="op" id="6799872">&amp;&amp;</span>&nbsp;<span class="ident" id="6799875">ra</span><span class="op" id="6799877">.</span><span class="ident" id="6799878">Zone</span>&nbsp;<span class="op" id="6799883">==</span>&nbsp;<span class="string" id="6799886">&#34;&#34;</span>&nbsp;<span class="op" id="6799889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799895">t</span><span class="op" id="6799896">.</span><span class="ident" id="6799897">Fatalf</span><span class="op" id="6799903">(</span><span class="string" id="6799904">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6799960">,</span>&nbsp;<span class="ident" id="6799962">ra</span><span class="op" id="6799964">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799976">}</span><br>
<span class="lineno"></span><span class="op" id="6799978">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
