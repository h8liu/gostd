<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7855040">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7855096">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7855150">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7855201">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="7855280">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7855289">package</span>&nbsp;<span class="ident" id="7855297">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7855302">import</span>&nbsp;<span class="op" id="7855309">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7855312">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7855318">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7855329">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7855340">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7855351">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7855358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7855361">func</span>&nbsp;<span class="ident" id="7855366">packetConnTestData</span><span class="op" id="7855384">(</span><span class="ident" id="7855385">t</span>&nbsp;<span class="op" id="7855387">*</span><span class="ident" id="7855388">testing</span><span class="op" id="7855395">.</span><span class="ident" id="7855396">T</span><span class="op" id="7855397">,</span>&nbsp;<span class="ident" id="7855399">net</span>&nbsp;<span class="builtintype" id="7855403">string</span><span class="op" id="7855409">,</span>&nbsp;<span class="ident" id="7855411">i</span>&nbsp;<span class="builtintype" id="7855413">int</span><span class="op" id="7855416">)</span>&nbsp;<span class="op" id="7855418">(</span><span class="op" id="7855419">[</span><span class="op" id="7855420">]</span><span class="builtintype" id="7855421">byte</span><span class="op" id="7855425">,</span>&nbsp;<span class="keyword" id="7855427">func</span><span class="op" id="7855431">(</span><span class="op" id="7855432">)</span><span class="op" id="7855433">)</span>&nbsp;<span class="op" id="7855435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855438">switch</span>&nbsp;<span class="ident" id="7855445">net</span>&nbsp;<span class="op" id="7855449">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855452">case</span>&nbsp;<span class="string" id="7855457">&#34;udp&#34;</span><span class="op" id="7855462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855466">return</span>&nbsp;<span class="op" id="7855473">[</span><span class="op" id="7855474">]</span><span class="builtintype" id="7855475">byte</span><span class="op" id="7855479">(</span><span class="string" id="7855480">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="7855501">)</span><span class="op" id="7855502">,</span>&nbsp;<span class="ident" id="7855504">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855509">case</span>&nbsp;<span class="string" id="7855514">&#34;ip&#34;</span><span class="op" id="7855518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855522">if</span>&nbsp;<span class="ident" id="7855525">skip</span><span class="op" id="7855529">,</span>&nbsp;<span class="ident" id="7855531">skipmsg</span>&nbsp;<span class="op" id="7855539">:=</span>&nbsp;<span class="ident" id="7855542">skipRawSocketTest</span><span class="op" id="7855559">(</span><span class="ident" id="7855560">t</span><span class="op" id="7855561">)</span><span class="op" id="7855562">;</span>&nbsp;<span class="ident" id="7855564">skip</span>&nbsp;<span class="op" id="7855569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855574">return</span>&nbsp;<span class="ident" id="7855581">nil</span><span class="op" id="7855584">,</span>&nbsp;<span class="keyword" id="7855586">func</span><span class="op" id="7855590">(</span><span class="op" id="7855591">)</span>&nbsp;<span class="op" id="7855593">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855599">t</span><span class="op" id="7855600">.</span><span class="ident" id="7855601">Logf</span><span class="op" id="7855605">(</span><span class="ident" id="7855606">skipmsg</span><span class="op" id="7855613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855626">b</span><span class="op" id="7855627">,</span>&nbsp;<span class="ident" id="7855629">err</span>&nbsp;<span class="op" id="7855633">:=</span>&nbsp;<span class="op" id="7855636">(</span><span class="op" id="7855637">&amp;</span><span class="ident" id="7855638">icmpMessage</span><span class="op" id="7855649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855654">Type</span><span class="op" id="7855658">:</span>&nbsp;<span class="ident" id="7855660">icmpv4EchoRequest</span><span class="op" id="7855677">,</span>&nbsp;<span class="ident" id="7855679">Code</span><span class="op" id="7855683">:</span>&nbsp;<span class="num" id="7855685">0</span><span class="op" id="7855686">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855691">Body</span><span class="op" id="7855695">:</span>&nbsp;<span class="op" id="7855697">&amp;</span><span class="ident" id="7855698">icmpEcho</span><span class="op" id="7855706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855712">ID</span><span class="op" id="7855714">:</span>&nbsp;<span class="ident" id="7855716">os</span><span class="op" id="7855718">.</span><span class="ident" id="7855719">Getpid</span><span class="op" id="7855725">(</span><span class="op" id="7855726">)</span>&nbsp;<span class="op" id="7855728">&amp;</span>&nbsp;<span class="num" id="7855730">0xffff</span><span class="op" id="7855736">,</span>&nbsp;<span class="ident" id="7855738">Seq</span><span class="op" id="7855741">:</span>&nbsp;<span class="ident" id="7855743">i</span>&nbsp;<span class="op" id="7855745">+</span>&nbsp;<span class="num" id="7855747">1</span><span class="op" id="7855748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855754">Data</span><span class="op" id="7855758">:</span>&nbsp;<span class="op" id="7855760">[</span><span class="op" id="7855761">]</span><span class="builtintype" id="7855762">byte</span><span class="op" id="7855766">(</span><span class="string" id="7855767">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="7855787">)</span><span class="op" id="7855788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855793">}</span><span class="op" id="7855794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855798">}</span><span class="op" id="7855799">)</span><span class="op" id="7855800">.</span><span class="ident" id="7855801">Marshal</span><span class="op" id="7855808">(</span><span class="op" id="7855809">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855813">if</span>&nbsp;<span class="ident" id="7855816">err</span>&nbsp;<span class="op" id="7855820">!=</span>&nbsp;<span class="ident" id="7855823">nil</span>&nbsp;<span class="op" id="7855827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855832">return</span>&nbsp;<span class="ident" id="7855839">nil</span><span class="op" id="7855842">,</span>&nbsp;<span class="keyword" id="7855844">func</span><span class="op" id="7855848">(</span><span class="op" id="7855849">)</span>&nbsp;<span class="op" id="7855851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855857">t</span><span class="op" id="7855858">.</span><span class="ident" id="7855859">Fatalf</span><span class="op" id="7855865">(</span><span class="string" id="7855866">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7855898">,</span>&nbsp;<span class="ident" id="7855900">err</span><span class="op" id="7855903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855912">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855916">return</span>&nbsp;<span class="ident" id="7855923">b</span><span class="op" id="7855924">,</span>&nbsp;<span class="ident" id="7855926">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855931">case</span>&nbsp;<span class="string" id="7855936">&#34;unixgram&#34;</span><span class="op" id="7855946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855950">switch</span>&nbsp;<span class="ident" id="7855957">runtime</span><span class="op" id="7855964">.</span><span class="ident" id="7855965">GOOS</span>&nbsp;<span class="op" id="7855970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855974">case</span>&nbsp;<span class="string" id="7855979">&#34;nacl&#34;</span><span class="op" id="7855985">,</span>&nbsp;<span class="string" id="7855987">&#34;plan9&#34;</span><span class="op" id="7855994">,</span>&nbsp;<span class="string" id="7855996">&#34;windows&#34;</span><span class="op" id="7856005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856010">return</span>&nbsp;<span class="ident" id="7856017">nil</span><span class="op" id="7856020">,</span>&nbsp;<span class="keyword" id="7856022">func</span><span class="op" id="7856026">(</span><span class="op" id="7856027">)</span>&nbsp;<span class="op" id="7856029">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856035">t</span><span class="op" id="7856036">.</span><span class="ident" id="7856037">Logf</span><span class="op" id="7856041">(</span><span class="string" id="7856042">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7856066">,</span>&nbsp;<span class="ident" id="7856068">net</span><span class="op" id="7856071">,</span>&nbsp;<span class="ident" id="7856073">runtime</span><span class="op" id="7856080">.</span><span class="ident" id="7856081">GOOS</span><span class="op" id="7856085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856094">default</span><span class="op" id="7856101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856106">return</span>&nbsp;<span class="op" id="7856113">[</span><span class="op" id="7856114">]</span><span class="builtintype" id="7856115">byte</span><span class="op" id="7856119">(</span><span class="string" id="7856120">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="7856146">)</span><span class="op" id="7856147">,</span>&nbsp;<span class="ident" id="7856149">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856155">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856158">default</span><span class="op" id="7856165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856169">return</span>&nbsp;<span class="ident" id="7856176">nil</span><span class="op" id="7856179">,</span>&nbsp;<span class="keyword" id="7856181">func</span><span class="op" id="7856185">(</span><span class="op" id="7856186">)</span>&nbsp;<span class="op" id="7856188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856193">t</span><span class="op" id="7856194">.</span><span class="ident" id="7856195">Logf</span><span class="op" id="7856199">(</span><span class="string" id="7856200">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="7856218">,</span>&nbsp;<span class="ident" id="7856220">net</span><span class="op" id="7856223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856230">}</span><br>
<span class="lineno">55</span><span class="op" id="7856232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7856235">var</span>&nbsp;<span class="ident" id="7856239">packetConnTests</span>&nbsp;<span class="op" id="7856255">=</span>&nbsp;<span class="op" id="7856257">[</span><span class="op" id="7856258">]</span><span class="keyword" id="7856259">struct</span>&nbsp;<span class="op" id="7856266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856269">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7856275">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856283">addr1</span>&nbsp;<span class="builtintype" id="7856289">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856297">addr2</span>&nbsp;<span class="builtintype" id="7856303">string</span><br>
<span class="lineno"></span><span class="op" id="7856310">}</span><span class="op" id="7856311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856314">{</span><span class="string" id="7856315">&#34;udp&#34;</span><span class="op" id="7856320">,</span>&nbsp;<span class="string" id="7856322">&#34;127.0.0.1:0&#34;</span><span class="op" id="7856335">,</span>&nbsp;<span class="string" id="7856337">&#34;127.0.0.1:0&#34;</span><span class="op" id="7856350">}</span><span class="op" id="7856351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856354">{</span><span class="string" id="7856355">&#34;ip:icmp&#34;</span><span class="op" id="7856364">,</span>&nbsp;<span class="string" id="7856366">&#34;127.0.0.1&#34;</span><span class="op" id="7856377">,</span>&nbsp;<span class="string" id="7856379">&#34;127.0.0.1&#34;</span><span class="op" id="7856390">}</span><span class="op" id="7856391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856394">{</span><span class="string" id="7856395">&#34;unixgram&#34;</span><span class="op" id="7856405">,</span>&nbsp;<span class="ident" id="7856407">testUnixAddr</span><span class="op" id="7856419">(</span><span class="op" id="7856420">)</span><span class="op" id="7856421">,</span>&nbsp;<span class="ident" id="7856423">testUnixAddr</span><span class="op" id="7856435">(</span><span class="op" id="7856436">)</span><span class="op" id="7856437">}</span><span class="op" id="7856438">,</span><br>
<span class="lineno">65</span><span class="op" id="7856440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7856443">func</span>&nbsp;<span class="ident" id="7856448">TestPacketConn</span><span class="op" id="7856462">(</span><span class="ident" id="7856463">t</span>&nbsp;<span class="op" id="7856465">*</span><span class="ident" id="7856466">testing</span><span class="op" id="7856473">.</span><span class="ident" id="7856474">T</span><span class="op" id="7856475">)</span>&nbsp;<span class="op" id="7856477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856480">closer</span>&nbsp;<span class="op" id="7856487">:=</span>&nbsp;<span class="keyword" id="7856490">func</span><span class="op" id="7856494">(</span><span class="ident" id="7856495">c</span>&nbsp;<span class="ident" id="7856497">PacketConn</span><span class="op" id="7856507">,</span>&nbsp;<span class="ident" id="7856509">net</span><span class="op" id="7856512">,</span>&nbsp;<span class="ident" id="7856514">addr1</span><span class="op" id="7856519">,</span>&nbsp;<span class="ident" id="7856521">addr2</span>&nbsp;<span class="builtintype" id="7856527">string</span><span class="op" id="7856533">)</span>&nbsp;<span class="op" id="7856535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856539">c</span><span class="op" id="7856540">.</span><span class="ident" id="7856541">Close</span><span class="op" id="7856546">(</span><span class="op" id="7856547">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856551">switch</span>&nbsp;<span class="ident" id="7856558">net</span>&nbsp;<span class="op" id="7856562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856566">case</span>&nbsp;<span class="string" id="7856571">&#34;unixgram&#34;</span><span class="op" id="7856581">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856586">os</span><span class="op" id="7856588">.</span><span class="ident" id="7856589">Remove</span><span class="op" id="7856595">(</span><span class="ident" id="7856596">addr1</span><span class="op" id="7856601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856606">os</span><span class="op" id="7856608">.</span><span class="ident" id="7856609">Remove</span><span class="op" id="7856615">(</span><span class="ident" id="7856616">addr2</span><span class="op" id="7856621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856625">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856632">for</span>&nbsp;<span class="ident" id="7856636">i</span><span class="op" id="7856637">,</span>&nbsp;<span class="ident" id="7856639">tt</span>&nbsp;<span class="op" id="7856642">:=</span>&nbsp;<span class="keyword" id="7856645">range</span>&nbsp;<span class="ident" id="7856651">packetConnTests</span>&nbsp;<span class="op" id="7856667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856671">netstr</span>&nbsp;<span class="op" id="7856678">:=</span>&nbsp;<span class="ident" id="7856681">strings</span><span class="op" id="7856688">.</span><span class="ident" id="7856689">Split</span><span class="op" id="7856694">(</span><span class="ident" id="7856695">tt</span><span class="op" id="7856697">.</span><span class="ident" id="7856698">net</span><span class="op" id="7856701">,</span>&nbsp;<span class="string" id="7856703">&#34;:&#34;</span><span class="op" id="7856706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856710">wb</span><span class="op" id="7856712">,</span>&nbsp;<span class="ident" id="7856714">skipOrFatalFn</span>&nbsp;<span class="op" id="7856728">:=</span>&nbsp;<span class="ident" id="7856731">packetConnTestData</span><span class="op" id="7856749">(</span><span class="ident" id="7856750">t</span><span class="op" id="7856751">,</span>&nbsp;<span class="ident" id="7856753">netstr</span><span class="op" id="7856759">[</span><span class="num" id="7856760">0</span><span class="op" id="7856761">]</span><span class="op" id="7856762">,</span>&nbsp;<span class="ident" id="7856764">i</span><span class="op" id="7856765">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856769">if</span>&nbsp;<span class="ident" id="7856772">skipOrFatalFn</span>&nbsp;<span class="op" id="7856786">!=</span>&nbsp;<span class="ident" id="7856789">nil</span>&nbsp;<span class="op" id="7856793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856798">skipOrFatalFn</span><span class="op" id="7856811">(</span><span class="op" id="7856812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856817">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856833">c1</span><span class="op" id="7856835">,</span>&nbsp;<span class="ident" id="7856837">err</span>&nbsp;<span class="op" id="7856841">:=</span>&nbsp;<span class="ident" id="7856844">ListenPacket</span><span class="op" id="7856856">(</span><span class="ident" id="7856857">tt</span><span class="op" id="7856859">.</span><span class="ident" id="7856860">net</span><span class="op" id="7856863">,</span>&nbsp;<span class="ident" id="7856865">tt</span><span class="op" id="7856867">.</span><span class="ident" id="7856868">addr1</span><span class="op" id="7856873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856877">if</span>&nbsp;<span class="ident" id="7856880">err</span>&nbsp;<span class="op" id="7856884">!=</span>&nbsp;<span class="ident" id="7856887">nil</span>&nbsp;<span class="op" id="7856891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856896">t</span><span class="op" id="7856897">.</span><span class="ident" id="7856898">Fatalf</span><span class="op" id="7856904">(</span><span class="string" id="7856905">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7856930">,</span>&nbsp;<span class="ident" id="7856932">err</span><span class="op" id="7856935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7856939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7856943">defer</span>&nbsp;<span class="ident" id="7856949">closer</span><span class="op" id="7856955">(</span><span class="ident" id="7856956">c1</span><span class="op" id="7856958">,</span>&nbsp;<span class="ident" id="7856960">netstr</span><span class="op" id="7856966">[</span><span class="num" id="7856967">0</span><span class="op" id="7856968">]</span><span class="op" id="7856969">,</span>&nbsp;<span class="ident" id="7856971">tt</span><span class="op" id="7856973">.</span><span class="ident" id="7856974">addr1</span><span class="op" id="7856979">,</span>&nbsp;<span class="ident" id="7856981">tt</span><span class="op" id="7856983">.</span><span class="ident" id="7856984">addr2</span><span class="op" id="7856989">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7856993">c1</span><span class="op" id="7856995">.</span><span class="ident" id="7856996">LocalAddr</span><span class="op" id="7857005">(</span><span class="op" id="7857006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857010">c1</span><span class="op" id="7857012">.</span><span class="ident" id="7857013">SetDeadline</span><span class="op" id="7857024">(</span><span class="ident" id="7857025">time</span><span class="op" id="7857029">.</span><span class="ident" id="7857030">Now</span><span class="op" id="7857033">(</span><span class="op" id="7857034">)</span><span class="op" id="7857035">.</span><span class="ident" id="7857036">Add</span><span class="op" id="7857039">(</span><span class="num" id="7857040">100</span>&nbsp;<span class="op" id="7857044">*</span>&nbsp;<span class="ident" id="7857046">time</span><span class="op" id="7857050">.</span><span class="ident" id="7857051">Millisecond</span><span class="op" id="7857062">)</span><span class="op" id="7857063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857067">c1</span><span class="op" id="7857069">.</span><span class="ident" id="7857070">SetReadDeadline</span><span class="op" id="7857085">(</span><span class="ident" id="7857086">time</span><span class="op" id="7857090">.</span><span class="ident" id="7857091">Now</span><span class="op" id="7857094">(</span><span class="op" id="7857095">)</span><span class="op" id="7857096">.</span><span class="ident" id="7857097">Add</span><span class="op" id="7857100">(</span><span class="num" id="7857101">100</span>&nbsp;<span class="op" id="7857105">*</span>&nbsp;<span class="ident" id="7857107">time</span><span class="op" id="7857111">.</span><span class="ident" id="7857112">Millisecond</span><span class="op" id="7857123">)</span><span class="op" id="7857124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857128">c1</span><span class="op" id="7857130">.</span><span class="ident" id="7857131">SetWriteDeadline</span><span class="op" id="7857147">(</span><span class="ident" id="7857148">time</span><span class="op" id="7857152">.</span><span class="ident" id="7857153">Now</span><span class="op" id="7857156">(</span><span class="op" id="7857157">)</span><span class="op" id="7857158">.</span><span class="ident" id="7857159">Add</span><span class="op" id="7857162">(</span><span class="num" id="7857163">100</span>&nbsp;<span class="op" id="7857167">*</span>&nbsp;<span class="ident" id="7857169">time</span><span class="op" id="7857173">.</span><span class="ident" id="7857174">Millisecond</span><span class="op" id="7857185">)</span><span class="op" id="7857186">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857191">c2</span><span class="op" id="7857193">,</span>&nbsp;<span class="ident" id="7857195">err</span>&nbsp;<span class="op" id="7857199">:=</span>&nbsp;<span class="ident" id="7857202">ListenPacket</span><span class="op" id="7857214">(</span><span class="ident" id="7857215">tt</span><span class="op" id="7857217">.</span><span class="ident" id="7857218">net</span><span class="op" id="7857221">,</span>&nbsp;<span class="ident" id="7857223">tt</span><span class="op" id="7857225">.</span><span class="ident" id="7857226">addr2</span><span class="op" id="7857231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7857235">if</span>&nbsp;<span class="ident" id="7857238">err</span>&nbsp;<span class="op" id="7857242">!=</span>&nbsp;<span class="ident" id="7857245">nil</span>&nbsp;<span class="op" id="7857249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857254">t</span><span class="op" id="7857255">.</span><span class="ident" id="7857256">Fatalf</span><span class="op" id="7857262">(</span><span class="string" id="7857263">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7857288">,</span>&nbsp;<span class="ident" id="7857290">err</span><span class="op" id="7857293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7857297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7857301">defer</span>&nbsp;<span class="ident" id="7857307">closer</span><span class="op" id="7857313">(</span><span class="ident" id="7857314">c2</span><span class="op" id="7857316">,</span>&nbsp;<span class="ident" id="7857318">netstr</span><span class="op" id="7857324">[</span><span class="num" id="7857325">0</span><span class="op" id="7857326">]</span><span class="op" id="7857327">,</span>&nbsp;<span class="ident" id="7857329">tt</span><span class="op" id="7857331">.</span><span class="ident" id="7857332">addr1</span><span class="op" id="7857337">,</span>&nbsp;<span class="ident" id="7857339">tt</span><span class="op" id="7857341">.</span><span class="ident" id="7857342">addr2</span><span class="op" id="7857347">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857351">c2</span><span class="op" id="7857353">.</span><span class="ident" id="7857354">LocalAddr</span><span class="op" id="7857363">(</span><span class="op" id="7857364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857368">c2</span><span class="op" id="7857370">.</span><span class="ident" id="7857371">SetDeadline</span><span class="op" id="7857382">(</span><span class="ident" id="7857383">time</span><span class="op" id="7857387">.</span><span class="ident" id="7857388">Now</span><span class="op" id="7857391">(</span><span class="op" id="7857392">)</span><span class="op" id="7857393">.</span><span class="ident" id="7857394">Add</span><span class="op" id="7857397">(</span><span class="num" id="7857398">100</span>&nbsp;<span class="op" id="7857402">*</span>&nbsp;<span class="ident" id="7857404">time</span><span class="op" id="7857408">.</span><span class="ident" id="7857409">Millisecond</span><span class="op" id="7857420">)</span><span class="op" id="7857421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857425">c2</span><span class="op" id="7857427">.</span><span class="ident" id="7857428">SetReadDeadline</span><span class="op" id="7857443">(</span><span class="ident" id="7857444">time</span><span class="op" id="7857448">.</span><span class="ident" id="7857449">Now</span><span class="op" id="7857452">(</span><span class="op" id="7857453">)</span><span class="op" id="7857454">.</span><span class="ident" id="7857455">Add</span><span class="op" id="7857458">(</span><span class="num" id="7857459">100</span>&nbsp;<span class="op" id="7857463">*</span>&nbsp;<span class="ident" id="7857465">time</span><span class="op" id="7857469">.</span><span class="ident" id="7857470">Millisecond</span><span class="op" id="7857481">)</span><span class="op" id="7857482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857486">c2</span><span class="op" id="7857488">.</span><span class="ident" id="7857489">SetWriteDeadline</span><span class="op" id="7857505">(</span><span class="ident" id="7857506">time</span><span class="op" id="7857510">.</span><span class="ident" id="7857511">Now</span><span class="op" id="7857514">(</span><span class="op" id="7857515">)</span><span class="op" id="7857516">.</span><span class="ident" id="7857517">Add</span><span class="op" id="7857520">(</span><span class="num" id="7857521">100</span>&nbsp;<span class="op" id="7857525">*</span>&nbsp;<span class="ident" id="7857527">time</span><span class="op" id="7857531">.</span><span class="ident" id="7857532">Millisecond</span><span class="op" id="7857543">)</span><span class="op" id="7857544">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7857549">if</span>&nbsp;<span class="ident" id="7857552">_</span><span class="op" id="7857553">,</span>&nbsp;<span class="ident" id="7857555">err</span>&nbsp;<span class="op" id="7857559">:=</span>&nbsp;<span class="ident" id="7857562">c1</span><span class="op" id="7857564">.</span><span class="ident" id="7857565">WriteTo</span><span class="op" id="7857572">(</span><span class="ident" id="7857573">wb</span><span class="op" id="7857575">,</span>&nbsp;<span class="ident" id="7857577">c2</span><span class="op" id="7857579">.</span><span class="ident" id="7857580">LocalAddr</span><span class="op" id="7857589">(</span><span class="op" id="7857590">)</span><span class="op" id="7857591">)</span><span class="op" id="7857592">;</span>&nbsp;<span class="ident" id="7857594">err</span>&nbsp;<span class="op" id="7857598">!=</span>&nbsp;<span class="ident" id="7857601">nil</span>&nbsp;<span class="op" id="7857605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857610">t</span><span class="op" id="7857611">.</span><span class="ident" id="7857612">Fatalf</span><span class="op" id="7857618">(</span><span class="string" id="7857619">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7857650">,</span>&nbsp;<span class="ident" id="7857652">err</span><span class="op" id="7857655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7857659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857663">rb2</span>&nbsp;<span class="op" id="7857667">:=</span>&nbsp;<span class="builtinfunc" id="7857670">make</span><span class="op" id="7857674">(</span><span class="op" id="7857675">[</span><span class="op" id="7857676">]</span><span class="builtintype" id="7857677">byte</span><span class="op" id="7857681">,</span>&nbsp;<span class="num" id="7857683">128</span><span class="op" id="7857686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7857690">if</span>&nbsp;<span class="ident" id="7857693">_</span><span class="op" id="7857694">,</span>&nbsp;<span class="ident" id="7857696">_</span><span class="op" id="7857697">,</span>&nbsp;<span class="ident" id="7857699">err</span>&nbsp;<span class="op" id="7857703">:=</span>&nbsp;<span class="ident" id="7857706">c2</span><span class="op" id="7857708">.</span><span class="ident" id="7857709">ReadFrom</span><span class="op" id="7857717">(</span><span class="ident" id="7857718">rb2</span><span class="op" id="7857721">)</span><span class="op" id="7857722">;</span>&nbsp;<span class="ident" id="7857724">err</span>&nbsp;<span class="op" id="7857728">!=</span>&nbsp;<span class="ident" id="7857731">nil</span>&nbsp;<span class="op" id="7857735">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857740">t</span><span class="op" id="7857741">.</span><span class="ident" id="7857742">Fatalf</span><span class="op" id="7857748">(</span><span class="string" id="7857749">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7857781">,</span>&nbsp;<span class="ident" id="7857783">err</span><span class="op" id="7857786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7857790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7857794">if</span>&nbsp;<span class="ident" id="7857797">_</span><span class="op" id="7857798">,</span>&nbsp;<span class="ident" id="7857800">err</span>&nbsp;<span class="op" id="7857804">:=</span>&nbsp;<span class="ident" id="7857807">c2</span><span class="op" id="7857809">.</span><span class="ident" id="7857810">WriteTo</span><span class="op" id="7857817">(</span><span class="ident" id="7857818">wb</span><span class="op" id="7857820">,</span>&nbsp;<span class="ident" id="7857822">c1</span><span class="op" id="7857824">.</span><span class="ident" id="7857825">LocalAddr</span><span class="op" id="7857834">(</span><span class="op" id="7857835">)</span><span class="op" id="7857836">)</span><span class="op" id="7857837">;</span>&nbsp;<span class="ident" id="7857839">err</span>&nbsp;<span class="op" id="7857843">!=</span>&nbsp;<span class="ident" id="7857846">nil</span>&nbsp;<span class="op" id="7857850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857855">t</span><span class="op" id="7857856">.</span><span class="ident" id="7857857">Fatalf</span><span class="op" id="7857863">(</span><span class="string" id="7857864">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7857895">,</span>&nbsp;<span class="ident" id="7857897">err</span><span class="op" id="7857900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7857904">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857908">rb1</span>&nbsp;<span class="op" id="7857912">:=</span>&nbsp;<span class="builtinfunc" id="7857915">make</span><span class="op" id="7857919">(</span><span class="op" id="7857920">[</span><span class="op" id="7857921">]</span><span class="builtintype" id="7857922">byte</span><span class="op" id="7857926">,</span>&nbsp;<span class="num" id="7857928">128</span><span class="op" id="7857931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7857935">if</span>&nbsp;<span class="ident" id="7857938">_</span><span class="op" id="7857939">,</span>&nbsp;<span class="ident" id="7857941">_</span><span class="op" id="7857942">,</span>&nbsp;<span class="ident" id="7857944">err</span>&nbsp;<span class="op" id="7857948">:=</span>&nbsp;<span class="ident" id="7857951">c1</span><span class="op" id="7857953">.</span><span class="ident" id="7857954">ReadFrom</span><span class="op" id="7857962">(</span><span class="ident" id="7857963">rb1</span><span class="op" id="7857966">)</span><span class="op" id="7857967">;</span>&nbsp;<span class="ident" id="7857969">err</span>&nbsp;<span class="op" id="7857973">!=</span>&nbsp;<span class="ident" id="7857976">nil</span>&nbsp;<span class="op" id="7857980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7857985">t</span><span class="op" id="7857986">.</span><span class="ident" id="7857987">Fatalf</span><span class="op" id="7857993">(</span><span class="string" id="7857994">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7858026">,</span>&nbsp;<span class="ident" id="7858028">err</span><span class="op" id="7858031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7858035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7858038">}</span><br>
<span class="lineno">120</span><span class="op" id="7858040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7858043">func</span>&nbsp;<span class="ident" id="7858048">TestConnAndPacketConn</span><span class="op" id="7858069">(</span><span class="ident" id="7858070">t</span>&nbsp;<span class="op" id="7858072">*</span><span class="ident" id="7858073">testing</span><span class="op" id="7858080">.</span><span class="ident" id="7858081">T</span><span class="op" id="7858082">)</span>&nbsp;<span class="op" id="7858084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858087">closer</span>&nbsp;<span class="op" id="7858094">:=</span>&nbsp;<span class="keyword" id="7858097">func</span><span class="op" id="7858101">(</span><span class="ident" id="7858102">c</span>&nbsp;<span class="ident" id="7858104">PacketConn</span><span class="op" id="7858114">,</span>&nbsp;<span class="ident" id="7858116">net</span><span class="op" id="7858119">,</span>&nbsp;<span class="ident" id="7858121">addr1</span><span class="op" id="7858126">,</span>&nbsp;<span class="ident" id="7858128">addr2</span>&nbsp;<span class="builtintype" id="7858134">string</span><span class="op" id="7858140">)</span>&nbsp;<span class="op" id="7858142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858146">c</span><span class="op" id="7858147">.</span><span class="ident" id="7858148">Close</span><span class="op" id="7858153">(</span><span class="op" id="7858154">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858158">switch</span>&nbsp;<span class="ident" id="7858165">net</span>&nbsp;<span class="op" id="7858169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858173">case</span>&nbsp;<span class="string" id="7858178">&#34;unixgram&#34;</span><span class="op" id="7858188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858193">os</span><span class="op" id="7858195">.</span><span class="ident" id="7858196">Remove</span><span class="op" id="7858202">(</span><span class="ident" id="7858203">addr1</span><span class="op" id="7858208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858213">os</span><span class="op" id="7858215">.</span><span class="ident" id="7858216">Remove</span><span class="op" id="7858222">(</span><span class="ident" id="7858223">addr2</span><span class="op" id="7858228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7858232">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7858235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858239">for</span>&nbsp;<span class="ident" id="7858243">i</span><span class="op" id="7858244">,</span>&nbsp;<span class="ident" id="7858246">tt</span>&nbsp;<span class="op" id="7858249">:=</span>&nbsp;<span class="keyword" id="7858252">range</span>&nbsp;<span class="ident" id="7858258">packetConnTests</span>&nbsp;<span class="op" id="7858274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858278">var</span>&nbsp;<span class="ident" id="7858282">wb</span>&nbsp;<span class="op" id="7858285">[</span><span class="op" id="7858286">]</span><span class="builtintype" id="7858287">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858294">netstr</span>&nbsp;<span class="op" id="7858301">:=</span>&nbsp;<span class="ident" id="7858304">strings</span><span class="op" id="7858311">.</span><span class="ident" id="7858312">Split</span><span class="op" id="7858317">(</span><span class="ident" id="7858318">tt</span><span class="op" id="7858320">.</span><span class="ident" id="7858321">net</span><span class="op" id="7858324">,</span>&nbsp;<span class="string" id="7858326">&#34;:&#34;</span><span class="op" id="7858329">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858333">wb</span><span class="op" id="7858335">,</span>&nbsp;<span class="ident" id="7858337">skipOrFatalFn</span>&nbsp;<span class="op" id="7858351">:=</span>&nbsp;<span class="ident" id="7858354">packetConnTestData</span><span class="op" id="7858372">(</span><span class="ident" id="7858373">t</span><span class="op" id="7858374">,</span>&nbsp;<span class="ident" id="7858376">netstr</span><span class="op" id="7858382">[</span><span class="num" id="7858383">0</span><span class="op" id="7858384">]</span><span class="op" id="7858385">,</span>&nbsp;<span class="ident" id="7858387">i</span><span class="op" id="7858388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858392">if</span>&nbsp;<span class="ident" id="7858395">skipOrFatalFn</span>&nbsp;<span class="op" id="7858409">!=</span>&nbsp;<span class="ident" id="7858412">nil</span>&nbsp;<span class="op" id="7858416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858421">skipOrFatalFn</span><span class="op" id="7858434">(</span><span class="op" id="7858435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858440">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7858451">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858456">c1</span><span class="op" id="7858458">,</span>&nbsp;<span class="ident" id="7858460">err</span>&nbsp;<span class="op" id="7858464">:=</span>&nbsp;<span class="ident" id="7858467">ListenPacket</span><span class="op" id="7858479">(</span><span class="ident" id="7858480">tt</span><span class="op" id="7858482">.</span><span class="ident" id="7858483">net</span><span class="op" id="7858486">,</span>&nbsp;<span class="ident" id="7858488">tt</span><span class="op" id="7858490">.</span><span class="ident" id="7858491">addr1</span><span class="op" id="7858496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858500">if</span>&nbsp;<span class="ident" id="7858503">err</span>&nbsp;<span class="op" id="7858507">!=</span>&nbsp;<span class="ident" id="7858510">nil</span>&nbsp;<span class="op" id="7858514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858519">t</span><span class="op" id="7858520">.</span><span class="ident" id="7858521">Fatalf</span><span class="op" id="7858527">(</span><span class="string" id="7858528">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7858553">,</span>&nbsp;<span class="ident" id="7858555">err</span><span class="op" id="7858558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7858562">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858566">defer</span>&nbsp;<span class="ident" id="7858572">closer</span><span class="op" id="7858578">(</span><span class="ident" id="7858579">c1</span><span class="op" id="7858581">,</span>&nbsp;<span class="ident" id="7858583">netstr</span><span class="op" id="7858589">[</span><span class="num" id="7858590">0</span><span class="op" id="7858591">]</span><span class="op" id="7858592">,</span>&nbsp;<span class="ident" id="7858594">tt</span><span class="op" id="7858596">.</span><span class="ident" id="7858597">addr1</span><span class="op" id="7858602">,</span>&nbsp;<span class="ident" id="7858604">tt</span><span class="op" id="7858606">.</span><span class="ident" id="7858607">addr2</span><span class="op" id="7858612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858616">c1</span><span class="op" id="7858618">.</span><span class="ident" id="7858619">LocalAddr</span><span class="op" id="7858628">(</span><span class="op" id="7858629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858633">c1</span><span class="op" id="7858635">.</span><span class="ident" id="7858636">SetDeadline</span><span class="op" id="7858647">(</span><span class="ident" id="7858648">time</span><span class="op" id="7858652">.</span><span class="ident" id="7858653">Now</span><span class="op" id="7858656">(</span><span class="op" id="7858657">)</span><span class="op" id="7858658">.</span><span class="ident" id="7858659">Add</span><span class="op" id="7858662">(</span><span class="num" id="7858663">100</span>&nbsp;<span class="op" id="7858667">*</span>&nbsp;<span class="ident" id="7858669">time</span><span class="op" id="7858673">.</span><span class="ident" id="7858674">Millisecond</span><span class="op" id="7858685">)</span><span class="op" id="7858686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858690">c1</span><span class="op" id="7858692">.</span><span class="ident" id="7858693">SetReadDeadline</span><span class="op" id="7858708">(</span><span class="ident" id="7858709">time</span><span class="op" id="7858713">.</span><span class="ident" id="7858714">Now</span><span class="op" id="7858717">(</span><span class="op" id="7858718">)</span><span class="op" id="7858719">.</span><span class="ident" id="7858720">Add</span><span class="op" id="7858723">(</span><span class="num" id="7858724">100</span>&nbsp;<span class="op" id="7858728">*</span>&nbsp;<span class="ident" id="7858730">time</span><span class="op" id="7858734">.</span><span class="ident" id="7858735">Millisecond</span><span class="op" id="7858746">)</span><span class="op" id="7858747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858751">c1</span><span class="op" id="7858753">.</span><span class="ident" id="7858754">SetWriteDeadline</span><span class="op" id="7858770">(</span><span class="ident" id="7858771">time</span><span class="op" id="7858775">.</span><span class="ident" id="7858776">Now</span><span class="op" id="7858779">(</span><span class="op" id="7858780">)</span><span class="op" id="7858781">.</span><span class="ident" id="7858782">Add</span><span class="op" id="7858785">(</span><span class="num" id="7858786">100</span>&nbsp;<span class="op" id="7858790">*</span>&nbsp;<span class="ident" id="7858792">time</span><span class="op" id="7858796">.</span><span class="ident" id="7858797">Millisecond</span><span class="op" id="7858808">)</span><span class="op" id="7858809">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858814">c2</span><span class="op" id="7858816">,</span>&nbsp;<span class="ident" id="7858818">err</span>&nbsp;<span class="op" id="7858822">:=</span>&nbsp;<span class="ident" id="7858825">Dial</span><span class="op" id="7858829">(</span><span class="ident" id="7858830">tt</span><span class="op" id="7858832">.</span><span class="ident" id="7858833">net</span><span class="op" id="7858836">,</span>&nbsp;<span class="ident" id="7858838">c1</span><span class="op" id="7858840">.</span><span class="ident" id="7858841">LocalAddr</span><span class="op" id="7858850">(</span><span class="op" id="7858851">)</span><span class="op" id="7858852">.</span><span class="ident" id="7858853">String</span><span class="op" id="7858859">(</span><span class="op" id="7858860">)</span><span class="op" id="7858861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858865">if</span>&nbsp;<span class="ident" id="7858868">err</span>&nbsp;<span class="op" id="7858872">!=</span>&nbsp;<span class="ident" id="7858875">nil</span>&nbsp;<span class="op" id="7858879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858884">t</span><span class="op" id="7858885">.</span><span class="ident" id="7858886">Fatalf</span><span class="op" id="7858892">(</span><span class="string" id="7858893">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7858910">,</span>&nbsp;<span class="ident" id="7858912">err</span><span class="op" id="7858915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7858919">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7858923">defer</span>&nbsp;<span class="ident" id="7858929">c2</span><span class="op" id="7858931">.</span><span class="ident" id="7858932">Close</span><span class="op" id="7858937">(</span><span class="op" id="7858938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858942">c2</span><span class="op" id="7858944">.</span><span class="ident" id="7858945">LocalAddr</span><span class="op" id="7858954">(</span><span class="op" id="7858955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858959">c2</span><span class="op" id="7858961">.</span><span class="ident" id="7858962">RemoteAddr</span><span class="op" id="7858972">(</span><span class="op" id="7858973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7858977">c2</span><span class="op" id="7858979">.</span><span class="ident" id="7858980">SetDeadline</span><span class="op" id="7858991">(</span><span class="ident" id="7858992">time</span><span class="op" id="7858996">.</span><span class="ident" id="7858997">Now</span><span class="op" id="7859000">(</span><span class="op" id="7859001">)</span><span class="op" id="7859002">.</span><span class="ident" id="7859003">Add</span><span class="op" id="7859006">(</span><span class="num" id="7859007">100</span>&nbsp;<span class="op" id="7859011">*</span>&nbsp;<span class="ident" id="7859013">time</span><span class="op" id="7859017">.</span><span class="ident" id="7859018">Millisecond</span><span class="op" id="7859029">)</span><span class="op" id="7859030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859034">c2</span><span class="op" id="7859036">.</span><span class="ident" id="7859037">SetReadDeadline</span><span class="op" id="7859052">(</span><span class="ident" id="7859053">time</span><span class="op" id="7859057">.</span><span class="ident" id="7859058">Now</span><span class="op" id="7859061">(</span><span class="op" id="7859062">)</span><span class="op" id="7859063">.</span><span class="ident" id="7859064">Add</span><span class="op" id="7859067">(</span><span class="num" id="7859068">100</span>&nbsp;<span class="op" id="7859072">*</span>&nbsp;<span class="ident" id="7859074">time</span><span class="op" id="7859078">.</span><span class="ident" id="7859079">Millisecond</span><span class="op" id="7859090">)</span><span class="op" id="7859091">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859095">c2</span><span class="op" id="7859097">.</span><span class="ident" id="7859098">SetWriteDeadline</span><span class="op" id="7859114">(</span><span class="ident" id="7859115">time</span><span class="op" id="7859119">.</span><span class="ident" id="7859120">Now</span><span class="op" id="7859123">(</span><span class="op" id="7859124">)</span><span class="op" id="7859125">.</span><span class="ident" id="7859126">Add</span><span class="op" id="7859129">(</span><span class="num" id="7859130">100</span>&nbsp;<span class="op" id="7859134">*</span>&nbsp;<span class="ident" id="7859136">time</span><span class="op" id="7859140">.</span><span class="ident" id="7859141">Millisecond</span><span class="op" id="7859152">)</span><span class="op" id="7859153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859158">if</span>&nbsp;<span class="ident" id="7859161">_</span><span class="op" id="7859162">,</span>&nbsp;<span class="ident" id="7859164">err</span>&nbsp;<span class="op" id="7859168">:=</span>&nbsp;<span class="ident" id="7859171">c2</span><span class="op" id="7859173">.</span><span class="ident" id="7859174">Write</span><span class="op" id="7859179">(</span><span class="ident" id="7859180">wb</span><span class="op" id="7859182">)</span><span class="op" id="7859183">;</span>&nbsp;<span class="ident" id="7859185">err</span>&nbsp;<span class="op" id="7859189">!=</span>&nbsp;<span class="ident" id="7859192">nil</span>&nbsp;<span class="op" id="7859196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859201">t</span><span class="op" id="7859202">.</span><span class="ident" id="7859203">Fatalf</span><span class="op" id="7859209">(</span><span class="string" id="7859210">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7859233">,</span>&nbsp;<span class="ident" id="7859235">err</span><span class="op" id="7859238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7859242">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859246">rb1</span>&nbsp;<span class="op" id="7859250">:=</span>&nbsp;<span class="builtinfunc" id="7859253">make</span><span class="op" id="7859257">(</span><span class="op" id="7859258">[</span><span class="op" id="7859259">]</span><span class="builtintype" id="7859260">byte</span><span class="op" id="7859264">,</span>&nbsp;<span class="num" id="7859266">128</span><span class="op" id="7859269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859273">if</span>&nbsp;<span class="ident" id="7859276">_</span><span class="op" id="7859277">,</span>&nbsp;<span class="ident" id="7859279">_</span><span class="op" id="7859280">,</span>&nbsp;<span class="ident" id="7859282">err</span>&nbsp;<span class="op" id="7859286">:=</span>&nbsp;<span class="ident" id="7859289">c1</span><span class="op" id="7859291">.</span><span class="ident" id="7859292">ReadFrom</span><span class="op" id="7859300">(</span><span class="ident" id="7859301">rb1</span><span class="op" id="7859304">)</span><span class="op" id="7859305">;</span>&nbsp;<span class="ident" id="7859307">err</span>&nbsp;<span class="op" id="7859311">!=</span>&nbsp;<span class="ident" id="7859314">nil</span>&nbsp;<span class="op" id="7859318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859323">t</span><span class="op" id="7859324">.</span><span class="ident" id="7859325">Fatalf</span><span class="op" id="7859331">(</span><span class="string" id="7859332">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7859364">,</span>&nbsp;<span class="ident" id="7859366">err</span><span class="op" id="7859369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7859373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859377">var</span>&nbsp;<span class="ident" id="7859381">dst</span>&nbsp;<span class="ident" id="7859385">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859392">switch</span>&nbsp;<span class="ident" id="7859399">netstr</span><span class="op" id="7859405">[</span><span class="num" id="7859406">0</span><span class="op" id="7859407">]</span>&nbsp;<span class="op" id="7859409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859413">case</span>&nbsp;<span class="string" id="7859418">&#34;ip&#34;</span><span class="op" id="7859422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859427">dst</span>&nbsp;<span class="op" id="7859431">=</span>&nbsp;<span class="op" id="7859433">&amp;</span><span class="ident" id="7859434">IPAddr</span><span class="op" id="7859440">{</span><span class="ident" id="7859441">IP</span><span class="op" id="7859443">:</span>&nbsp;<span class="ident" id="7859445">IPv4</span><span class="op" id="7859449">(</span><span class="num" id="7859450">127</span><span class="op" id="7859453">,</span>&nbsp;<span class="num" id="7859455">0</span><span class="op" id="7859456">,</span>&nbsp;<span class="num" id="7859458">0</span><span class="op" id="7859459">,</span>&nbsp;<span class="num" id="7859461">1</span><span class="op" id="7859462">)</span><span class="op" id="7859463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859467">case</span>&nbsp;<span class="string" id="7859472">&#34;unixgram&#34;</span><span class="op" id="7859482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859487">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859498">default</span><span class="op" id="7859505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859510">dst</span>&nbsp;<span class="op" id="7859514">=</span>&nbsp;<span class="ident" id="7859516">c2</span><span class="op" id="7859518">.</span><span class="ident" id="7859519">LocalAddr</span><span class="op" id="7859528">(</span><span class="op" id="7859529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7859533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859537">if</span>&nbsp;<span class="ident" id="7859540">_</span><span class="op" id="7859541">,</span>&nbsp;<span class="ident" id="7859543">err</span>&nbsp;<span class="op" id="7859547">:=</span>&nbsp;<span class="ident" id="7859550">c1</span><span class="op" id="7859552">.</span><span class="ident" id="7859553">WriteTo</span><span class="op" id="7859560">(</span><span class="ident" id="7859561">wb</span><span class="op" id="7859563">,</span>&nbsp;<span class="ident" id="7859565">dst</span><span class="op" id="7859568">)</span><span class="op" id="7859569">;</span>&nbsp;<span class="ident" id="7859571">err</span>&nbsp;<span class="op" id="7859575">!=</span>&nbsp;<span class="ident" id="7859578">nil</span>&nbsp;<span class="op" id="7859582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859587">t</span><span class="op" id="7859588">.</span><span class="ident" id="7859589">Fatalf</span><span class="op" id="7859595">(</span><span class="string" id="7859596">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7859627">,</span>&nbsp;<span class="ident" id="7859629">err</span><span class="op" id="7859632">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7859636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859640">rb2</span>&nbsp;<span class="op" id="7859644">:=</span>&nbsp;<span class="builtinfunc" id="7859647">make</span><span class="op" id="7859651">(</span><span class="op" id="7859652">[</span><span class="op" id="7859653">]</span><span class="builtintype" id="7859654">byte</span><span class="op" id="7859658">,</span>&nbsp;<span class="num" id="7859660">128</span><span class="op" id="7859663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7859667">if</span>&nbsp;<span class="ident" id="7859670">_</span><span class="op" id="7859671">,</span>&nbsp;<span class="ident" id="7859673">err</span>&nbsp;<span class="op" id="7859677">:=</span>&nbsp;<span class="ident" id="7859680">c2</span><span class="op" id="7859682">.</span><span class="ident" id="7859683">Read</span><span class="op" id="7859687">(</span><span class="ident" id="7859688">rb2</span><span class="op" id="7859691">)</span><span class="op" id="7859692">;</span>&nbsp;<span class="ident" id="7859694">err</span>&nbsp;<span class="op" id="7859698">!=</span>&nbsp;<span class="ident" id="7859701">nil</span>&nbsp;<span class="op" id="7859705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7859710">t</span><span class="op" id="7859711">.</span><span class="ident" id="7859712">Fatalf</span><span class="op" id="7859718">(</span><span class="string" id="7859719">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7859741">,</span>&nbsp;<span class="ident" id="7859743">err</span><span class="op" id="7859746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7859750">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7859753">}</span><br>
<span class="lineno"></span><span class="op" id="7859755">}</span>
</div>
</body>
</html>
