<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4708933">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4708988">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4709042">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4709093">//&nbsp;Represents&nbsp;JSON&nbsp;data&nbsp;structure&nbsp;using&nbsp;native&nbsp;Go&nbsp;types:&nbsp;booleans,&nbsp;floats,</span><br>
<span class="lineno"></span><span class="comment" id="4709168">//&nbsp;strings,&nbsp;arrays,&nbsp;and&nbsp;maps.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4709199">package</span>&nbsp;<span class="ident" id="4709207">json</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4709213">import</span>&nbsp;<span class="op" id="4709220">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709223">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709232">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709244">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709263">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709273">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709280">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709291">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709302">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709313">&#34;unicode&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709324">&#34;unicode/utf16&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4709341">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4709356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4709359">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;JSON-encoded&nbsp;data&nbsp;and&nbsp;stores&nbsp;the&nbsp;result</span><br>
<span class="lineno">25</span><span class="comment" id="4709423">//&nbsp;in&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to&nbsp;by&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4709456">//</span><br>
<span class="lineno"></span><span class="comment" id="4709459">//&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;encodings&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4709511">//&nbsp;Marshal&nbsp;uses,&nbsp;allocating&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;pointers&nbsp;as&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4709580">//&nbsp;with&nbsp;the&nbsp;following&nbsp;additional&nbsp;rules:</span><br>
<span class="lineno">30</span><span class="comment" id="4709620">//</span><br>
<span class="lineno"></span><span class="comment" id="4709623">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;pointer,&nbsp;Unmarshal&nbsp;first&nbsp;handles&nbsp;the&nbsp;case&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4709696">//&nbsp;the&nbsp;JSON&nbsp;being&nbsp;the&nbsp;JSON&nbsp;literal&nbsp;null.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;Unmarshal&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="4709767">//&nbsp;the&nbsp;pointer&nbsp;to&nbsp;nil.&nbsp;&nbsp;Otherwise,&nbsp;Unmarshal&nbsp;unmarshals&nbsp;the&nbsp;JSON&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4709837">//&nbsp;the&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;the&nbsp;pointer.&nbsp;&nbsp;If&nbsp;the&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;Unmarshal</span><br>
<span class="lineno">35</span><span class="comment" id="4709911">//&nbsp;allocates&nbsp;a&nbsp;new&nbsp;value&nbsp;for&nbsp;it&nbsp;to&nbsp;point&nbsp;to.</span><br>
<span class="lineno"></span><span class="comment" id="4709956">//</span><br>
<span class="lineno"></span><span class="comment" id="4709959">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;a&nbsp;struct,&nbsp;Unmarshal&nbsp;matches&nbsp;incoming&nbsp;object</span><br>
<span class="lineno"></span><span class="comment" id="4710029">//&nbsp;keys&nbsp;to&nbsp;the&nbsp;keys&nbsp;used&nbsp;by&nbsp;Marshal&nbsp;(either&nbsp;the&nbsp;struct&nbsp;field&nbsp;name&nbsp;or&nbsp;its&nbsp;tag),</span><br>
<span class="lineno"></span><span class="comment" id="4710108">//&nbsp;preferring&nbsp;an&nbsp;exact&nbsp;match&nbsp;but&nbsp;also&nbsp;accepting&nbsp;a&nbsp;case-insensitive&nbsp;match.</span><br>
<span class="lineno">40</span><span class="comment" id="4710182">//</span><br>
<span class="lineno"></span><span class="comment" id="4710185">//&nbsp;To&nbsp;unmarshal&nbsp;JSON&nbsp;into&nbsp;an&nbsp;interface&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="4710231">//&nbsp;Unmarshal&nbsp;stores&nbsp;one&nbsp;of&nbsp;these&nbsp;in&nbsp;the&nbsp;interface&nbsp;value:</span><br>
<span class="lineno"></span><span class="comment" id="4710288">//</span><br>
<span class="lineno"></span><span class="comment" id="4710291">//&nbsp;&nbsp;&nbsp;&nbspbool,&nbsp;for&nbsp;JSON&nbsp;booleans</span><br>
<span class="lineno">45</span><span class="comment" id="4710318">//&nbsp;&nbsp;&nbsp;&nbspfloat64,&nbsp;for&nbsp;JSON&nbsp;numbers</span><br>
<span class="lineno"></span><span class="comment" id="4710347">//&nbsp;&nbsp;&nbsp;&nbspstring,&nbsp;for&nbsp;JSON&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="4710375">//&nbsp;&nbsp;&nbsp;&nbsp[]interface{},&nbsp;for&nbsp;JSON&nbsp;arrays</span><br>
<span class="lineno"></span><span class="comment" id="4710409">//&nbsp;&nbsp;&nbsp;&nbspmap[string]interface{},&nbsp;for&nbsp;JSON&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="4710453">//&nbsp;&nbsp;&nbsp;&nbspnil&nbsp;for&nbsp;JSON&nbsp;null</span><br>
<span class="lineno">50</span><span class="comment" id="4710474">//</span><br>
<span class="lineno"></span><span class="comment" id="4710477">//&nbsp;If&nbsp;a&nbsp;JSON&nbsp;value&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;given&nbsp;target&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="4710540">//&nbsp;or&nbsp;if&nbsp;a&nbsp;JSON&nbsp;number&nbsp;overflows&nbsp;the&nbsp;target&nbsp;type,&nbsp;Unmarshal</span><br>
<span class="lineno"></span><span class="comment" id="4710600">//&nbsp;skips&nbsp;that&nbsp;field&nbsp;and&nbsp;completes&nbsp;the&nbsp;unmarshalling&nbsp;as&nbsp;best&nbsp;it&nbsp;can.</span><br>
<span class="lineno"></span><span class="comment" id="4710668">//&nbsp;If&nbsp;no&nbsp;more&nbsp;serious&nbsp;errors&nbsp;are&nbsp;encountered,&nbsp;Unmarshal&nbsp;returns</span><br>
<span class="lineno">55</span><span class="comment" id="4710732">//&nbsp;an&nbsp;UnmarshalTypeError&nbsp;describing&nbsp;the&nbsp;earliest&nbsp;such&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4710793">//</span><br>
<span class="lineno"></span><span class="comment" id="4710796">//&nbsp;The&nbsp;JSON&nbsp;null&nbsp;value&nbsp;unmarshals&nbsp;into&nbsp;an&nbsp;interface,&nbsp;map,&nbsp;pointer,&nbsp;or&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4710872">//&nbsp;by&nbsp;setting&nbsp;that&nbsp;Go&nbsp;value&nbsp;to&nbsp;nil.&nbsp;Because&nbsp;null&nbsp;is&nbsp;often&nbsp;used&nbsp;in&nbsp;JSON&nbsp;to&nbsp;mean</span><br>
<span class="lineno"></span><span class="comment" id="4710951">//&nbsp;``not&nbsp;present,&#39;&#39;&nbsp;unmarshaling&nbsp;a&nbsp;JSON&nbsp;null&nbsp;into&nbsp;any&nbsp;other&nbsp;Go&nbsp;type&nbsp;has&nbsp;no&nbsp;effect</span><br>
<span class="lineno">60</span><span class="comment" id="4711033">//&nbsp;on&nbsp;the&nbsp;value&nbsp;and&nbsp;produces&nbsp;no&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4711072">//</span><br>
<span class="lineno"></span><span class="comment" id="4711075">//&nbsp;When&nbsp;unmarshaling&nbsp;quoted&nbsp;strings,&nbsp;invalid&nbsp;UTF-8&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4711129">//&nbsp;invalid&nbsp;UTF-16&nbsp;surrogate&nbsp;pairs&nbsp;are&nbsp;not&nbsp;treated&nbsp;as&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4711192">//&nbsp;Instead,&nbsp;they&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;Unicode&nbsp;replacement</span><br>
<span class="lineno">65</span><span class="comment" id="4711249">//&nbsp;character&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="comment" id="4711270">//</span><br>
<span class="lineno"></span><span class="keyword" id="4711273">func</span>&nbsp;<span class="ident" id="4711278">Unmarshal</span><span class="op" id="4711287">(</span><span class="ident" id="4711288">data</span>&nbsp;<span class="op" id="4711293">[</span><span class="op" id="4711294">]</span><span class="builtintype" id="4711295">byte</span><span class="op" id="4711299">,</span>&nbsp;<span class="ident" id="4711301">v</span>&nbsp;<span class="keyword" id="4711303">interface</span><span class="op" id="4711312">{</span><span class="op" id="4711313">}</span><span class="op" id="4711314">)</span>&nbsp;<span class="builtintype" id="4711316">error</span>&nbsp;<span class="op" id="4711322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4711325">//&nbsp;Check&nbsp;for&nbsp;well-formedness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4711356">//&nbsp;Avoids&nbsp;filling&nbsp;out&nbsp;half&nbsp;a&nbsp;data&nbsp;structure</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4711401">//&nbsp;before&nbsp;discovering&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711445">var</span>&nbsp;<span class="ident" id="4711449">d</span>&nbsp;<span class="ident" id="4711451">decodeState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711464">err</span>&nbsp;<span class="op" id="4711468">:=</span>&nbsp;<span class="ident" id="4711471">checkValid</span><span class="op" id="4711481">(</span><span class="ident" id="4711482">data</span><span class="op" id="4711486">,</span>&nbsp;<span class="op" id="4711488">&amp;</span><span class="ident" id="4711489">d</span><span class="op" id="4711490">.</span><span class="ident" id="4711491">scan</span><span class="op" id="4711495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711498">if</span>&nbsp;<span class="ident" id="4711501">err</span>&nbsp;<span class="op" id="4711505">!=</span>&nbsp;<span class="ident" id="4711508">nil</span>&nbsp;<span class="op" id="4711512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711516">return</span>&nbsp;<span class="ident" id="4711523">err</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4711528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711532">d</span><span class="op" id="4711533">.</span><span class="ident" id="4711534">init</span><span class="op" id="4711538">(</span><span class="ident" id="4711539">data</span><span class="op" id="4711543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4711546">return</span>&nbsp;<span class="ident" id="4711553">d</span><span class="op" id="4711554">.</span><span class="ident" id="4711555">unmarshal</span><span class="op" id="4711564">(</span><span class="ident" id="4711565">v</span><span class="op" id="4711566">)</span><br>
<span class="lineno"></span><span class="op" id="4711568">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4711571">//&nbsp;Unmarshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects</span><br>
<span class="lineno"></span><span class="comment" id="4711626">//&nbsp;that&nbsp;can&nbsp;unmarshal&nbsp;a&nbsp;JSON&nbsp;description&nbsp;of&nbsp;themselves.</span><br>
<span class="lineno"></span><span class="comment" id="4711682">//&nbsp;The&nbsp;input&nbsp;can&nbsp;be&nbsp;assumed&nbsp;to&nbsp;be&nbsp;a&nbsp;valid&nbsp;encoding&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4711736">//&nbsp;a&nbsp;JSON&nbsp;value.&nbsp;UnmarshalJSON&nbsp;must&nbsp;copy&nbsp;the&nbsp;JSON&nbsp;data</span><br>
<span class="lineno">85</span><span class="comment" id="4711791">//&nbsp;if&nbsp;it&nbsp;wishes&nbsp;to&nbsp;retain&nbsp;the&nbsp;data&nbsp;after&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="4711843">type</span>&nbsp;<span class="ident" id="4711848">Unmarshaler</span>&nbsp;<span class="keyword" id="4711860">interface</span>&nbsp;<span class="op" id="4711870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4711873">UnmarshalJSON</span><span class="op" id="4711886">(</span><span class="op" id="4711887">[</span><span class="op" id="4711888">]</span><span class="builtintype" id="4711889">byte</span><span class="op" id="4711893">)</span>&nbsp;<span class="builtintype" id="4711895">error</span><br>
<span class="lineno"></span><span class="op" id="4711901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="4711904">//&nbsp;An&nbsp;UnmarshalTypeError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;that&nbsp;was</span><br>
<span class="lineno"></span><span class="comment" id="4711961">//&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;a&nbsp;value&nbsp;of&nbsp;a&nbsp;specific&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4712015">type</span>&nbsp;<span class="ident" id="4712020">UnmarshalTypeError</span>&nbsp;<span class="keyword" id="4712039">struct</span>&nbsp;<span class="op" id="4712046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712049">Value</span>&nbsp;<span class="builtintype" id="4712055">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4712068">//&nbsp;description&nbsp;of&nbsp;JSON&nbsp;value&nbsp;-&nbsp;&#34;bool&#34;,&nbsp;&#34;array&#34;,&nbsp;&#34;number&nbsp;-5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712129">Type</span>&nbsp;&nbsp;<span class="ident" id="4712135">reflect</span><span class="op" id="4712142">.</span><span class="ident" id="4712143">Type</span>&nbsp;<span class="comment" id="4712148">//&nbsp;type&nbsp;of&nbsp;Go&nbsp;value&nbsp;it&nbsp;could&nbsp;not&nbsp;be&nbsp;assigned&nbsp;to</span><br>
<span class="lineno">95</span><span class="op" id="4712196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4712199">func</span>&nbsp;<span class="op" id="4712204">(</span><span class="ident" id="4712205">e</span>&nbsp;<span class="op" id="4712207">*</span><span class="ident" id="4712208">UnmarshalTypeError</span><span class="op" id="4712226">)</span>&nbsp;<span class="ident" id="4712228">Error</span><span class="op" id="4712233">(</span><span class="op" id="4712234">)</span>&nbsp;<span class="builtintype" id="4712236">string</span>&nbsp;<span class="op" id="4712243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712246">return</span>&nbsp;<span class="string" id="4712253">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;&#34;</span>&nbsp;<span class="op" id="4712279">+</span>&nbsp;<span class="ident" id="4712281">e</span><span class="op" id="4712282">.</span><span class="ident" id="4712283">Value</span>&nbsp;<span class="op" id="4712289">+</span>&nbsp;<span class="string" id="4712291">&#34;&nbsp;into&nbsp;Go&nbsp;value&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="4712317">+</span>&nbsp;<span class="ident" id="4712319">e</span><span class="op" id="4712320">.</span><span class="ident" id="4712321">Type</span><span class="op" id="4712325">.</span><span class="ident" id="4712326">String</span><span class="op" id="4712332">(</span><span class="op" id="4712333">)</span><br>
<span class="lineno"></span><span class="op" id="4712335">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4712338">//&nbsp;An&nbsp;UnmarshalFieldError&nbsp;describes&nbsp;a&nbsp;JSON&nbsp;object&nbsp;key&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4712397">//&nbsp;led&nbsp;to&nbsp;an&nbsp;unexported&nbsp;(and&nbsp;therefore&nbsp;unwritable)&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="4712462">//&nbsp;(No&nbsp;longer&nbsp;used;&nbsp;kept&nbsp;for&nbsp;compatibility.)</span><br>
<span class="lineno"></span><span class="keyword" id="4712507">type</span>&nbsp;<span class="ident" id="4712512">UnmarshalFieldError</span>&nbsp;<span class="keyword" id="4712532">struct</span>&nbsp;<span class="op" id="4712539">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712542">Key</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4712548">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712556">Type</span>&nbsp;&nbsp;<span class="ident" id="4712562">reflect</span><span class="op" id="4712569">.</span><span class="ident" id="4712570">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712576">Field</span>&nbsp;<span class="ident" id="4712582">reflect</span><span class="op" id="4712589">.</span><span class="ident" id="4712590">StructField</span><br>
<span class="lineno"></span><span class="op" id="4712602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="4712605">func</span>&nbsp;<span class="op" id="4712610">(</span><span class="ident" id="4712611">e</span>&nbsp;<span class="op" id="4712613">*</span><span class="ident" id="4712614">UnmarshalFieldError</span><span class="op" id="4712633">)</span>&nbsp;<span class="ident" id="4712635">Error</span><span class="op" id="4712640">(</span><span class="op" id="4712641">)</span>&nbsp;<span class="builtintype" id="4712643">string</span>&nbsp;<span class="op" id="4712650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4712653">return</span>&nbsp;<span class="string" id="4712660">&#34;json:&nbsp;cannot&nbsp;unmarshal&nbsp;object&nbsp;key&nbsp;&#34;</span>&nbsp;<span class="op" id="4712697">+</span>&nbsp;<span class="ident" id="4712699">strconv</span><span class="op" id="4712706">.</span><span class="ident" id="4712707">Quote</span><span class="op" id="4712712">(</span><span class="ident" id="4712713">e</span><span class="op" id="4712714">.</span><span class="ident" id="4712715">Key</span><span class="op" id="4712718">)</span>&nbsp;<span class="op" id="4712720">+</span>&nbsp;<span class="string" id="4712722">&#34;&nbsp;into&nbsp;unexported&nbsp;field&nbsp;&#34;</span>&nbsp;<span class="op" id="4712748">+</span>&nbsp;<span class="ident" id="4712750">e</span><span class="op" id="4712751">.</span><span class="ident" id="4712752">Field</span><span class="op" id="4712757">.</span><span class="ident" id="4712758">Name</span>&nbsp;<span class="op" id="4712763">+</span>&nbsp;<span class="string" id="4712765">&#34;&nbsp;of&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="4712777">+</span>&nbsp;<span class="ident" id="4712779">e</span><span class="op" id="4712780">.</span><span class="ident" id="4712781">Type</span><span class="op" id="4712785">.</span><span class="ident" id="4712786">String</span><span class="op" id="4712792">(</span><span class="op" id="4712793">)</span><br>
<span class="lineno"></span><span class="op" id="4712795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4712798">//&nbsp;An&nbsp;InvalidUnmarshalError&nbsp;describes&nbsp;an&nbsp;invalid&nbsp;argument&nbsp;passed&nbsp;to&nbsp;Unmarshal.</span><br>
<span class="lineno">115</span><span class="comment" id="4712877">//&nbsp;(The&nbsp;argument&nbsp;to&nbsp;Unmarshal&nbsp;must&nbsp;be&nbsp;a&nbsp;non-nil&nbsp;pointer.)</span><br>
<span class="lineno"></span><span class="keyword" id="4712935">type</span>&nbsp;<span class="ident" id="4712940">InvalidUnmarshalError</span>&nbsp;<span class="keyword" id="4712962">struct</span>&nbsp;<span class="op" id="4712969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4712972">Type</span>&nbsp;<span class="ident" id="4712977">reflect</span><span class="op" id="4712984">.</span><span class="ident" id="4712985">Type</span><br>
<span class="lineno"></span><span class="op" id="4712990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="4712993">func</span>&nbsp;<span class="op" id="4712998">(</span><span class="ident" id="4712999">e</span>&nbsp;<span class="op" id="4713001">*</span><span class="ident" id="4713002">InvalidUnmarshalError</span><span class="op" id="4713023">)</span>&nbsp;<span class="ident" id="4713025">Error</span><span class="op" id="4713030">(</span><span class="op" id="4713031">)</span>&nbsp;<span class="builtintype" id="4713033">string</span>&nbsp;<span class="op" id="4713040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713043">if</span>&nbsp;<span class="ident" id="4713046">e</span><span class="op" id="4713047">.</span><span class="ident" id="4713048">Type</span>&nbsp;<span class="op" id="4713053">==</span>&nbsp;<span class="ident" id="4713056">nil</span>&nbsp;<span class="op" id="4713060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713064">return</span>&nbsp;<span class="string" id="4713071">&#34;json:&nbsp;Unmarshal(nil)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713099">if</span>&nbsp;<span class="ident" id="4713102">e</span><span class="op" id="4713103">.</span><span class="ident" id="4713104">Type</span><span class="op" id="4713108">.</span><span class="ident" id="4713109">Kind</span><span class="op" id="4713113">(</span><span class="op" id="4713114">)</span>&nbsp;<span class="op" id="4713116">!=</span>&nbsp;<span class="ident" id="4713119">reflect</span><span class="op" id="4713126">.</span><span class="ident" id="4713127">Ptr</span>&nbsp;<span class="op" id="4713131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713135">return</span>&nbsp;<span class="string" id="4713142">&#34;json:&nbsp;Unmarshal(non-pointer&nbsp;&#34;</span>&nbsp;<span class="op" id="4713173">+</span>&nbsp;<span class="ident" id="4713175">e</span><span class="op" id="4713176">.</span><span class="ident" id="4713177">Type</span><span class="op" id="4713181">.</span><span class="ident" id="4713182">String</span><span class="op" id="4713188">(</span><span class="op" id="4713189">)</span>&nbsp;<span class="op" id="4713191">+</span>&nbsp;<span class="string" id="4713193">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713201">return</span>&nbsp;<span class="string" id="4713208">&#34;json:&nbsp;Unmarshal(nil&nbsp;&#34;</span>&nbsp;<span class="op" id="4713231">+</span>&nbsp;<span class="ident" id="4713233">e</span><span class="op" id="4713234">.</span><span class="ident" id="4713235">Type</span><span class="op" id="4713239">.</span><span class="ident" id="4713240">String</span><span class="op" id="4713246">(</span><span class="op" id="4713247">)</span>&nbsp;<span class="op" id="4713249">+</span>&nbsp;<span class="string" id="4713251">&#34;)&#34;</span><br>
<span class="lineno"></span><span class="op" id="4713255">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="4713258">func</span>&nbsp;<span class="op" id="4713263">(</span><span class="ident" id="4713264">d</span>&nbsp;<span class="op" id="4713266">*</span><span class="ident" id="4713267">decodeState</span><span class="op" id="4713278">)</span>&nbsp;<span class="ident" id="4713280">unmarshal</span><span class="op" id="4713289">(</span><span class="ident" id="4713290">v</span>&nbsp;<span class="keyword" id="4713292">interface</span><span class="op" id="4713301">{</span><span class="op" id="4713302">}</span><span class="op" id="4713303">)</span>&nbsp;<span class="op" id="4713305">(</span><span class="ident" id="4713306">err</span>&nbsp;<span class="builtintype" id="4713310">error</span><span class="op" id="4713315">)</span>&nbsp;<span class="op" id="4713317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713320">defer</span>&nbsp;<span class="keyword" id="4713326">func</span><span class="op" id="4713330">(</span><span class="op" id="4713331">)</span>&nbsp;<span class="op" id="4713333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713337">if</span>&nbsp;<span class="ident" id="4713340">r</span>&nbsp;<span class="op" id="4713342">:=</span>&nbsp;<span class="builtinfunc" id="4713345">recover</span><span class="op" id="4713352">(</span><span class="op" id="4713353">)</span><span class="op" id="4713354">;</span>&nbsp;<span class="ident" id="4713356">r</span>&nbsp;<span class="op" id="4713358">!=</span>&nbsp;<span class="ident" id="4713361">nil</span>&nbsp;<span class="op" id="4713365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713370">if</span>&nbsp;<span class="ident" id="4713373">_</span><span class="op" id="4713374">,</span>&nbsp;<span class="ident" id="4713376">ok</span>&nbsp;<span class="op" id="4713379">:=</span>&nbsp;<span class="ident" id="4713382">r</span><span class="op" id="4713383">.</span><span class="op" id="4713384">(</span><span class="ident" id="4713385">runtime</span><span class="op" id="4713392">.</span><span class="ident" id="4713393">Error</span><span class="op" id="4713398">)</span><span class="op" id="4713399">;</span>&nbsp;<span class="ident" id="4713401">ok</span>&nbsp;<span class="op" id="4713404">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4713410">panic</span><span class="op" id="4713415">(</span><span class="ident" id="4713416">r</span><span class="op" id="4713417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713427">err</span>&nbsp;<span class="op" id="4713431">=</span>&nbsp;<span class="ident" id="4713433">r</span><span class="op" id="4713434">.</span><span class="op" id="4713435">(</span><span class="builtintype" id="4713436">error</span><span class="op" id="4713441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713448">}</span><span class="op" id="4713449">(</span><span class="op" id="4713450">)</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713454">rv</span>&nbsp;<span class="op" id="4713457">:=</span>&nbsp;<span class="ident" id="4713460">reflect</span><span class="op" id="4713467">.</span><span class="ident" id="4713468">ValueOf</span><span class="op" id="4713475">(</span><span class="ident" id="4713476">v</span><span class="op" id="4713477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713480">if</span>&nbsp;<span class="ident" id="4713483">rv</span><span class="op" id="4713485">.</span><span class="ident" id="4713486">Kind</span><span class="op" id="4713490">(</span><span class="op" id="4713491">)</span>&nbsp;<span class="op" id="4713493">!=</span>&nbsp;<span class="ident" id="4713496">reflect</span><span class="op" id="4713503">.</span><span class="ident" id="4713504">Ptr</span>&nbsp;<span class="op" id="4713508">||</span>&nbsp;<span class="ident" id="4713511">rv</span><span class="op" id="4713513">.</span><span class="ident" id="4713514">IsNil</span><span class="op" id="4713519">(</span><span class="op" id="4713520">)</span>&nbsp;<span class="op" id="4713522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713526">return</span>&nbsp;<span class="op" id="4713533">&amp;</span><span class="ident" id="4713534">InvalidUnmarshalError</span><span class="op" id="4713555">{</span><span class="ident" id="4713556">reflect</span><span class="op" id="4713563">.</span><span class="ident" id="4713564">TypeOf</span><span class="op" id="4713570">(</span><span class="ident" id="4713571">v</span><span class="op" id="4713572">)</span><span class="op" id="4713573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4713576">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713580">d</span><span class="op" id="4713581">.</span><span class="ident" id="4713582">scan</span><span class="op" id="4713586">.</span><span class="ident" id="4713587">reset</span><span class="op" id="4713592">(</span><span class="op" id="4713593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4713596">//&nbsp;We&nbsp;decode&nbsp;rv&nbsp;not&nbsp;rv.Elem&nbsp;because&nbsp;the&nbsp;Unmarshaler&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4713659">//&nbsp;test&nbsp;must&nbsp;be&nbsp;applied&nbsp;at&nbsp;the&nbsp;top&nbsp;level&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4713715">d</span><span class="op" id="4713716">.</span><span class="ident" id="4713717">value</span><span class="op" id="4713722">(</span><span class="ident" id="4713723">rv</span><span class="op" id="4713725">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4713728">return</span>&nbsp;<span class="ident" id="4713735">d</span><span class="op" id="4713736">.</span><span class="ident" id="4713737">savedError</span><br>
<span class="lineno"></span><span class="op" id="4713748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4713751">//&nbsp;A&nbsp;Number&nbsp;represents&nbsp;a&nbsp;JSON&nbsp;number&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="4713797">type</span>&nbsp;<span class="ident" id="4713802">Number</span>&nbsp;<span class="builtintype" id="4713809">string</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4713817">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;literal&nbsp;text&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4713867">func</span>&nbsp;<span class="op" id="4713872">(</span><span class="ident" id="4713873">n</span>&nbsp;<span class="ident" id="4713875">Number</span><span class="op" id="4713881">)</span>&nbsp;<span class="ident" id="4713883">String</span><span class="op" id="4713889">(</span><span class="op" id="4713890">)</span>&nbsp;<span class="builtintype" id="4713892">string</span>&nbsp;<span class="op" id="4713899">{</span>&nbsp;<span class="keyword" id="4713901">return</span>&nbsp;<span class="builtintype" id="4713908">string</span><span class="op" id="4713914">(</span><span class="ident" id="4713915">n</span><span class="op" id="4713916">)</span>&nbsp;<span class="op" id="4713918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4713921">//&nbsp;Float64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;a&nbsp;float64.</span><br>
<span class="lineno">160</span><span class="keyword" id="4713965">func</span>&nbsp;<span class="op" id="4713970">(</span><span class="ident" id="4713971">n</span>&nbsp;<span class="ident" id="4713973">Number</span><span class="op" id="4713979">)</span>&nbsp;<span class="ident" id="4713981">Float64</span><span class="op" id="4713988">(</span><span class="op" id="4713989">)</span>&nbsp;<span class="op" id="4713991">(</span><span class="builtintype" id="4713992">float64</span><span class="op" id="4713999">,</span>&nbsp;<span class="builtintype" id="4714001">error</span><span class="op" id="4714006">)</span>&nbsp;<span class="op" id="4714008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714011">return</span>&nbsp;<span class="ident" id="4714018">strconv</span><span class="op" id="4714025">.</span><span class="ident" id="4714026">ParseFloat</span><span class="op" id="4714036">(</span><span class="builtintype" id="4714037">string</span><span class="op" id="4714043">(</span><span class="ident" id="4714044">n</span><span class="op" id="4714045">)</span><span class="op" id="4714046">,</span>&nbsp;<span class="num" id="4714048">64</span><span class="op" id="4714050">)</span><br>
<span class="lineno"></span><span class="op" id="4714052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4714055">//&nbsp;Int64&nbsp;returns&nbsp;the&nbsp;number&nbsp;as&nbsp;an&nbsp;int64.</span><br>
<span class="lineno">165</span><span class="keyword" id="4714096">func</span>&nbsp;<span class="op" id="4714101">(</span><span class="ident" id="4714102">n</span>&nbsp;<span class="ident" id="4714104">Number</span><span class="op" id="4714110">)</span>&nbsp;<span class="ident" id="4714112">Int64</span><span class="op" id="4714117">(</span><span class="op" id="4714118">)</span>&nbsp;<span class="op" id="4714120">(</span><span class="ident" id="4714121">int64</span><span class="op" id="4714126">,</span>&nbsp;<span class="builtintype" id="4714128">error</span><span class="op" id="4714133">)</span>&nbsp;<span class="op" id="4714135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714138">return</span>&nbsp;<span class="ident" id="4714145">strconv</span><span class="op" id="4714152">.</span><span class="ident" id="4714153">ParseInt</span><span class="op" id="4714161">(</span><span class="builtintype" id="4714162">string</span><span class="op" id="4714168">(</span><span class="ident" id="4714169">n</span><span class="op" id="4714170">)</span><span class="op" id="4714171">,</span>&nbsp;<span class="num" id="4714173">10</span><span class="op" id="4714175">,</span>&nbsp;<span class="num" id="4714177">64</span><span class="op" id="4714179">)</span><br>
<span class="lineno"></span><span class="op" id="4714181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4714184">//&nbsp;decodeState&nbsp;represents&nbsp;the&nbsp;state&nbsp;while&nbsp;decoding&nbsp;a&nbsp;JSON&nbsp;value.</span><br>
<span class="lineno">170</span><span class="keyword" id="4714249">type</span>&nbsp;<span class="ident" id="4714254">decodeState</span>&nbsp;<span class="keyword" id="4714266">struct</span>&nbsp;<span class="op" id="4714273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714276">data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714287">[</span><span class="op" id="4714288">]</span><span class="builtintype" id="4714289">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714295">off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4714306">int</span>&nbsp;<span class="comment" id="4714310">//&nbsp;read&nbsp;offset&nbsp;in&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714334">scan</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714345">scanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714354">nextscan</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4714365">scanner</span>&nbsp;<span class="comment" id="4714373">//&nbsp;for&nbsp;calls&nbsp;to&nbsp;nextValue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714400">savedError</span>&nbsp;<span class="builtintype" id="4714411">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714418">useNumber</span>&nbsp;&nbsp;<span class="builtintype" id="4714429">bool</span><br>
<span class="lineno"></span><span class="op" id="4714434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4714437">//&nbsp;errPhase&nbsp;is&nbsp;used&nbsp;for&nbsp;errors&nbsp;that&nbsp;should&nbsp;not&nbsp;happen&nbsp;unless</span><br>
<span class="lineno">180</span><span class="comment" id="4714498">//&nbsp;there&nbsp;is&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;JSON&nbsp;decoder&nbsp;or&nbsp;something&nbsp;is&nbsp;editing</span><br>
<span class="lineno"></span><span class="comment" id="4714560">//&nbsp;the&nbsp;data&nbsp;slice&nbsp;while&nbsp;the&nbsp;decoder&nbsp;executes.</span><br>
<span class="lineno"></span><span class="keyword" id="4714606">var</span>&nbsp;<span class="ident" id="4714610">errPhase</span>&nbsp;<span class="op" id="4714619">=</span>&nbsp;<span class="ident" id="4714621">errors</span><span class="op" id="4714627">.</span><span class="ident" id="4714628">New</span><span class="op" id="4714631">(</span><span class="string" id="4714632">&#34;JSON&nbsp;decoder&nbsp;out&nbsp;of&nbsp;sync&nbsp;-&nbsp;data&nbsp;changing&nbsp;underfoot?&#34;</span><span class="op" id="4714685">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4714688">func</span>&nbsp;<span class="op" id="4714693">(</span><span class="ident" id="4714694">d</span>&nbsp;<span class="op" id="4714696">*</span><span class="ident" id="4714697">decodeState</span><span class="op" id="4714708">)</span>&nbsp;<span class="ident" id="4714710">init</span><span class="op" id="4714714">(</span><span class="ident" id="4714715">data</span>&nbsp;<span class="op" id="4714720">[</span><span class="op" id="4714721">]</span><span class="builtintype" id="4714722">byte</span><span class="op" id="4714726">)</span>&nbsp;<span class="op" id="4714728">*</span><span class="ident" id="4714729">decodeState</span>&nbsp;<span class="op" id="4714741">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714744">d</span><span class="op" id="4714745">.</span><span class="ident" id="4714746">data</span>&nbsp;<span class="op" id="4714751">=</span>&nbsp;<span class="ident" id="4714753">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714759">d</span><span class="op" id="4714760">.</span><span class="ident" id="4714761">off</span>&nbsp;<span class="op" id="4714765">=</span>&nbsp;<span class="num" id="4714767">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4714770">d</span><span class="op" id="4714771">.</span><span class="ident" id="4714772">savedError</span>&nbsp;<span class="op" id="4714783">=</span>&nbsp;<span class="ident" id="4714785">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4714790">return</span>&nbsp;<span class="ident" id="4714797">d</span><br>
<span class="lineno"></span><span class="op" id="4714799">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4714802">//&nbsp;error&nbsp;aborts&nbsp;the&nbsp;decoding&nbsp;by&nbsp;panicking&nbsp;with&nbsp;err.</span><br>
<span class="lineno"></span><span class="keyword" id="4714854">func</span>&nbsp;<span class="op" id="4714859">(</span><span class="ident" id="4714860">d</span>&nbsp;<span class="op" id="4714862">*</span><span class="ident" id="4714863">decodeState</span><span class="op" id="4714874">)</span>&nbsp;<span class="builtintype" id="4714876">error</span><span class="op" id="4714881">(</span><span class="ident" id="4714882">err</span>&nbsp;<span class="builtintype" id="4714886">error</span><span class="op" id="4714891">)</span>&nbsp;<span class="op" id="4714893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4714896">panic</span><span class="op" id="4714901">(</span><span class="ident" id="4714902">err</span><span class="op" id="4714905">)</span><br>
<span class="lineno"></span><span class="op" id="4714907">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="4714910">//&nbsp;saveError&nbsp;saves&nbsp;the&nbsp;first&nbsp;err&nbsp;it&nbsp;is&nbsp;called&nbsp;with,</span><br>
<span class="lineno"></span><span class="comment" id="4714962">//&nbsp;for&nbsp;reporting&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;unmarshal.</span><br>
<span class="lineno"></span><span class="keyword" id="4715008">func</span>&nbsp;<span class="op" id="4715013">(</span><span class="ident" id="4715014">d</span>&nbsp;<span class="op" id="4715016">*</span><span class="ident" id="4715017">decodeState</span><span class="op" id="4715028">)</span>&nbsp;<span class="ident" id="4715030">saveError</span><span class="op" id="4715039">(</span><span class="ident" id="4715040">err</span>&nbsp;<span class="builtintype" id="4715044">error</span><span class="op" id="4715049">)</span>&nbsp;<span class="op" id="4715051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715054">if</span>&nbsp;<span class="ident" id="4715057">d</span><span class="op" id="4715058">.</span><span class="ident" id="4715059">savedError</span>&nbsp;<span class="op" id="4715070">==</span>&nbsp;<span class="ident" id="4715073">nil</span>&nbsp;<span class="op" id="4715077">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715081">d</span><span class="op" id="4715082">.</span><span class="ident" id="4715083">savedError</span>&nbsp;<span class="op" id="4715094">=</span>&nbsp;<span class="ident" id="4715096">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715101">}</span><br>
<span class="lineno"></span><span class="op" id="4715103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4715106">//&nbsp;next&nbsp;cuts&nbsp;off&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;full&nbsp;JSON&nbsp;value&nbsp;in&nbsp;d.data[d.off:].</span><br>
<span class="lineno">205</span><span class="comment" id="4715179">//&nbsp;The&nbsp;next&nbsp;value&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;an&nbsp;object&nbsp;or&nbsp;array,&nbsp;not&nbsp;a&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="4715247">func</span>&nbsp;<span class="op" id="4715252">(</span><span class="ident" id="4715253">d</span>&nbsp;<span class="op" id="4715255">*</span><span class="ident" id="4715256">decodeState</span><span class="op" id="4715267">)</span>&nbsp;<span class="ident" id="4715269">next</span><span class="op" id="4715273">(</span><span class="op" id="4715274">)</span>&nbsp;<span class="op" id="4715276">[</span><span class="op" id="4715277">]</span><span class="builtintype" id="4715278">byte</span>&nbsp;<span class="op" id="4715283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715286">c</span>&nbsp;<span class="op" id="4715288">:=</span>&nbsp;<span class="ident" id="4715291">d</span><span class="op" id="4715292">.</span><span class="ident" id="4715293">data</span><span class="op" id="4715297">[</span><span class="ident" id="4715298">d</span><span class="op" id="4715299">.</span><span class="ident" id="4715300">off</span><span class="op" id="4715303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715306">item</span><span class="op" id="4715310">,</span>&nbsp;<span class="ident" id="4715312">rest</span><span class="op" id="4715316">,</span>&nbsp;<span class="ident" id="4715318">err</span>&nbsp;<span class="op" id="4715322">:=</span>&nbsp;<span class="ident" id="4715325">nextValue</span><span class="op" id="4715334">(</span><span class="ident" id="4715335">d</span><span class="op" id="4715336">.</span><span class="ident" id="4715337">data</span><span class="op" id="4715341">[</span><span class="ident" id="4715342">d</span><span class="op" id="4715343">.</span><span class="ident" id="4715344">off</span><span class="op" id="4715347">:</span><span class="op" id="4715348">]</span><span class="op" id="4715349">,</span>&nbsp;<span class="op" id="4715351">&amp;</span><span class="ident" id="4715352">d</span><span class="op" id="4715353">.</span><span class="ident" id="4715354">nextscan</span><span class="op" id="4715362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715365">if</span>&nbsp;<span class="ident" id="4715368">err</span>&nbsp;<span class="op" id="4715372">!=</span>&nbsp;<span class="ident" id="4715375">nil</span>&nbsp;<span class="op" id="4715379">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715383">d</span><span class="op" id="4715384">.</span><span class="builtintype" id="4715385">error</span><span class="op" id="4715390">(</span><span class="ident" id="4715391">err</span><span class="op" id="4715394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715400">d</span><span class="op" id="4715401">.</span><span class="ident" id="4715402">off</span>&nbsp;<span class="op" id="4715406">=</span>&nbsp;<span class="builtinfunc" id="4715408">len</span><span class="op" id="4715411">(</span><span class="ident" id="4715412">d</span><span class="op" id="4715413">.</span><span class="ident" id="4715414">data</span><span class="op" id="4715418">)</span>&nbsp;<span class="op" id="4715420">-</span>&nbsp;<span class="builtinfunc" id="4715422">len</span><span class="op" id="4715425">(</span><span class="ident" id="4715426">rest</span><span class="op" id="4715430">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4715434">//&nbsp;Our&nbsp;scanner&nbsp;has&nbsp;seen&nbsp;the&nbsp;opening&nbsp;brace/bracket</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4715485">//&nbsp;and&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;the&nbsp;object.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4715541">//&nbsp;invent&nbsp;a&nbsp;closing&nbsp;brace/bracket&nbsp;to&nbsp;get&nbsp;it&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715591">if</span>&nbsp;<span class="ident" id="4715594">c</span>&nbsp;<span class="op" id="4715596">==</span>&nbsp;<span class="string" id="4715599">&#39;{&#39;</span>&nbsp;<span class="op" id="4715603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715607">d</span><span class="op" id="4715608">.</span><span class="ident" id="4715609">scan</span><span class="op" id="4715613">.</span><span class="ident" id="4715614">step</span><span class="op" id="4715618">(</span><span class="op" id="4715619">&amp;</span><span class="ident" id="4715620">d</span><span class="op" id="4715621">.</span><span class="ident" id="4715622">scan</span><span class="op" id="4715626">,</span>&nbsp;<span class="string" id="4715628">&#39;}&#39;</span><span class="op" id="4715631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715634">}</span>&nbsp;<span class="keyword" id="4715636">else</span>&nbsp;<span class="op" id="4715641">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715645">d</span><span class="op" id="4715646">.</span><span class="ident" id="4715647">scan</span><span class="op" id="4715651">.</span><span class="ident" id="4715652">step</span><span class="op" id="4715656">(</span><span class="op" id="4715657">&amp;</span><span class="ident" id="4715658">d</span><span class="op" id="4715659">.</span><span class="ident" id="4715660">scan</span><span class="op" id="4715664">,</span>&nbsp;<span class="string" id="4715666">&#39;]&#39;</span><span class="op" id="4715669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4715672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715676">return</span>&nbsp;<span class="ident" id="4715683">item</span><br>
<span class="lineno"></span><span class="op" id="4715688">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="4715691">//&nbsp;scanWhile&nbsp;processes&nbsp;bytes&nbsp;in&nbsp;d.data[d.off:]&nbsp;until&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4715747">//&nbsp;receives&nbsp;a&nbsp;scan&nbsp;code&nbsp;not&nbsp;equal&nbsp;to&nbsp;op.</span><br>
<span class="lineno"></span><span class="comment" id="4715788">//&nbsp;It&nbsp;updates&nbsp;d.off&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;scan&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword" id="4715839">func</span>&nbsp;<span class="op" id="4715844">(</span><span class="ident" id="4715845">d</span>&nbsp;<span class="op" id="4715847">*</span><span class="ident" id="4715848">decodeState</span><span class="op" id="4715859">)</span>&nbsp;<span class="ident" id="4715861">scanWhile</span><span class="op" id="4715870">(</span><span class="ident" id="4715871">op</span>&nbsp;<span class="builtintype" id="4715874">int</span><span class="op" id="4715877">)</span>&nbsp;<span class="builtintype" id="4715879">int</span>&nbsp;<span class="op" id="4715883">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715886">var</span>&nbsp;<span class="ident" id="4715890">newOp</span>&nbsp;<span class="builtintype" id="4715896">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715901">for</span>&nbsp;<span class="op" id="4715905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4715909">if</span>&nbsp;<span class="ident" id="4715912">d</span><span class="op" id="4715913">.</span><span class="ident" id="4715914">off</span>&nbsp;<span class="op" id="4715918">&gt;=</span>&nbsp;<span class="builtinfunc" id="4715921">len</span><span class="op" id="4715924">(</span><span class="ident" id="4715925">d</span><span class="op" id="4715926">.</span><span class="ident" id="4715927">data</span><span class="op" id="4715931">)</span>&nbsp;<span class="op" id="4715933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715938">newOp</span>&nbsp;<span class="op" id="4715944">=</span>&nbsp;<span class="ident" id="4715946">d</span><span class="op" id="4715947">.</span><span class="ident" id="4715948">scan</span><span class="op" id="4715952">.</span><span class="ident" id="4715953">eof</span><span class="op" id="4715956">(</span><span class="op" id="4715957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4715962">d</span><span class="op" id="4715963">.</span><span class="ident" id="4715964">off</span>&nbsp;<span class="op" id="4715968">=</span>&nbsp;<span class="builtinfunc" id="4715970">len</span><span class="op" id="4715973">(</span><span class="ident" id="4715974">d</span><span class="op" id="4715975">.</span><span class="ident" id="4715976">data</span><span class="op" id="4715980">)</span>&nbsp;<span class="op" id="4715982">+</span>&nbsp;<span class="num" id="4715984">1</span>&nbsp;<span class="comment" id="4715986">//&nbsp;mark&nbsp;processed&nbsp;EOF&nbsp;with&nbsp;len+1</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716021">}</span>&nbsp;<span class="keyword" id="4716023">else</span>&nbsp;<span class="op" id="4716028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716033">c</span>&nbsp;<span class="op" id="4716035">:=</span>&nbsp;<span class="builtintype" id="4716038">int</span><span class="op" id="4716041">(</span><span class="ident" id="4716042">d</span><span class="op" id="4716043">.</span><span class="ident" id="4716044">data</span><span class="op" id="4716048">[</span><span class="ident" id="4716049">d</span><span class="op" id="4716050">.</span><span class="ident" id="4716051">off</span><span class="op" id="4716054">]</span><span class="op" id="4716055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716060">d</span><span class="op" id="4716061">.</span><span class="ident" id="4716062">off</span><span class="op" id="4716065">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716071">newOp</span>&nbsp;<span class="op" id="4716077">=</span>&nbsp;<span class="ident" id="4716079">d</span><span class="op" id="4716080">.</span><span class="ident" id="4716081">scan</span><span class="op" id="4716085">.</span><span class="ident" id="4716086">step</span><span class="op" id="4716090">(</span><span class="op" id="4716091">&amp;</span><span class="ident" id="4716092">d</span><span class="op" id="4716093">.</span><span class="ident" id="4716094">scan</span><span class="op" id="4716098">,</span>&nbsp;<span class="ident" id="4716100">c</span><span class="op" id="4716101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716105">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716109">if</span>&nbsp;<span class="ident" id="4716112">newOp</span>&nbsp;<span class="op" id="4716118">!=</span>&nbsp;<span class="ident" id="4716121">op</span>&nbsp;<span class="op" id="4716124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716129">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716143">return</span>&nbsp;<span class="ident" id="4716150">newOp</span><br>
<span class="lineno">245</span><span class="op" id="4716156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4716159">//&nbsp;value&nbsp;decodes&nbsp;a&nbsp;JSON&nbsp;value&nbsp;from&nbsp;d.data[d.off:]&nbsp;into&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4716225">//&nbsp;it&nbsp;updates&nbsp;d.off&nbsp;to&nbsp;point&nbsp;past&nbsp;the&nbsp;decoded&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4716278">func</span>&nbsp;<span class="op" id="4716283">(</span><span class="ident" id="4716284">d</span>&nbsp;<span class="op" id="4716286">*</span><span class="ident" id="4716287">decodeState</span><span class="op" id="4716298">)</span>&nbsp;<span class="ident" id="4716300">value</span><span class="op" id="4716305">(</span><span class="ident" id="4716306">v</span>&nbsp;<span class="ident" id="4716308">reflect</span><span class="op" id="4716315">.</span><span class="ident" id="4716316">Value</span><span class="op" id="4716321">)</span>&nbsp;<span class="op" id="4716323">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716326">if</span>&nbsp;<span class="op" id="4716329">!</span><span class="ident" id="4716330">v</span><span class="op" id="4716331">.</span><span class="ident" id="4716332">IsValid</span><span class="op" id="4716339">(</span><span class="op" id="4716340">)</span>&nbsp;<span class="op" id="4716342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716346">_</span><span class="op" id="4716347">,</span>&nbsp;<span class="ident" id="4716349">rest</span><span class="op" id="4716353">,</span>&nbsp;<span class="ident" id="4716355">err</span>&nbsp;<span class="op" id="4716359">:=</span>&nbsp;<span class="ident" id="4716362">nextValue</span><span class="op" id="4716371">(</span><span class="ident" id="4716372">d</span><span class="op" id="4716373">.</span><span class="ident" id="4716374">data</span><span class="op" id="4716378">[</span><span class="ident" id="4716379">d</span><span class="op" id="4716380">.</span><span class="ident" id="4716381">off</span><span class="op" id="4716384">:</span><span class="op" id="4716385">]</span><span class="op" id="4716386">,</span>&nbsp;<span class="op" id="4716388">&amp;</span><span class="ident" id="4716389">d</span><span class="op" id="4716390">.</span><span class="ident" id="4716391">nextscan</span><span class="op" id="4716399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716403">if</span>&nbsp;<span class="ident" id="4716406">err</span>&nbsp;<span class="op" id="4716410">!=</span>&nbsp;<span class="ident" id="4716413">nil</span>&nbsp;<span class="op" id="4716417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716422">d</span><span class="op" id="4716423">.</span><span class="builtintype" id="4716424">error</span><span class="op" id="4716429">(</span><span class="ident" id="4716430">err</span><span class="op" id="4716433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716437">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716441">d</span><span class="op" id="4716442">.</span><span class="ident" id="4716443">off</span>&nbsp;<span class="op" id="4716447">=</span>&nbsp;<span class="builtinfunc" id="4716449">len</span><span class="op" id="4716452">(</span><span class="ident" id="4716453">d</span><span class="op" id="4716454">.</span><span class="ident" id="4716455">data</span><span class="op" id="4716459">)</span>&nbsp;<span class="op" id="4716461">-</span>&nbsp;<span class="builtinfunc" id="4716463">len</span><span class="op" id="4716466">(</span><span class="ident" id="4716467">rest</span><span class="op" id="4716471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4716476">//&nbsp;d.scan&nbsp;thinks&nbsp;we&#39;re&nbsp;still&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4716537">//&nbsp;Feed&nbsp;in&nbsp;an&nbsp;empty&nbsp;string&nbsp;-&nbsp;the&nbsp;shortest,&nbsp;simplest&nbsp;value&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4716599">//&nbsp;so&nbsp;that&nbsp;it&nbsp;knows&nbsp;we&nbsp;got&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;value.</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716653">if</span>&nbsp;<span class="ident" id="4716656">d</span><span class="op" id="4716657">.</span><span class="ident" id="4716658">scan</span><span class="op" id="4716662">.</span><span class="ident" id="4716663">redo</span>&nbsp;<span class="op" id="4716668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4716673">//&nbsp;rewind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716687">d</span><span class="op" id="4716688">.</span><span class="ident" id="4716689">scan</span><span class="op" id="4716693">.</span><span class="ident" id="4716694">redo</span>&nbsp;<span class="op" id="4716699">=</span>&nbsp;<span class="ident" id="4716701">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716710">d</span><span class="op" id="4716711">.</span><span class="ident" id="4716712">scan</span><span class="op" id="4716716">.</span><span class="ident" id="4716717">step</span>&nbsp;<span class="op" id="4716722">=</span>&nbsp;<span class="ident" id="4716724">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4716742">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716746">d</span><span class="op" id="4716747">.</span><span class="ident" id="4716748">scan</span><span class="op" id="4716752">.</span><span class="ident" id="4716753">step</span><span class="op" id="4716757">(</span><span class="op" id="4716758">&amp;</span><span class="ident" id="4716759">d</span><span class="op" id="4716760">.</span><span class="ident" id="4716761">scan</span><span class="op" id="4716765">,</span>&nbsp;<span class="string" id="4716767">&#39;&#34;&#39;</span><span class="op" id="4716770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716774">d</span><span class="op" id="4716775">.</span><span class="ident" id="4716776">scan</span><span class="op" id="4716780">.</span><span class="ident" id="4716781">step</span><span class="op" id="4716785">(</span><span class="op" id="4716786">&amp;</span><span class="ident" id="4716787">d</span><span class="op" id="4716788">.</span><span class="ident" id="4716789">scan</span><span class="op" id="4716793">,</span>&nbsp;<span class="string" id="4716795">&#39;&#34;&#39;</span><span class="op" id="4716798">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716803">n</span>&nbsp;<span class="op" id="4716805">:=</span>&nbsp;<span class="builtinfunc" id="4716808">len</span><span class="op" id="4716811">(</span><span class="ident" id="4716812">d</span><span class="op" id="4716813">.</span><span class="ident" id="4716814">scan</span><span class="op" id="4716818">.</span><span class="ident" id="4716819">parseState</span><span class="op" id="4716829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4716833">if</span>&nbsp;<span class="ident" id="4716836">n</span>&nbsp;<span class="op" id="4716838">&gt;</span>&nbsp;<span class="num" id="4716840">0</span>&nbsp;<span class="op" id="4716842">&amp;&amp;</span>&nbsp;<span class="ident" id="4716845">d</span><span class="op" id="4716846">.</span><span class="ident" id="4716847">scan</span><span class="op" id="4716851">.</span><span class="ident" id="4716852">parseState</span><span class="op" id="4716862">[</span><span class="ident" id="4716863">n</span><span class="op" id="4716864">-</span><span class="num" id="4716865">1</span><span class="op" id="4716866">]</span>&nbsp;<span class="op" id="4716868">==</span>&nbsp;<span class="ident" id="4716871">parseObjectKey</span>&nbsp;<span class="op" id="4716886">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4716891">//&nbsp;d.scan&nbsp;thinks&nbsp;we&nbsp;just&nbsp;read&nbsp;an&nbsp;object&nbsp;key;&nbsp;finish&nbsp;the&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716957">d</span><span class="op" id="4716958">.</span><span class="ident" id="4716959">scan</span><span class="op" id="4716963">.</span><span class="ident" id="4716964">step</span><span class="op" id="4716968">(</span><span class="op" id="4716969">&amp;</span><span class="ident" id="4716970">d</span><span class="op" id="4716971">.</span><span class="ident" id="4716972">scan</span><span class="op" id="4716976">,</span>&nbsp;<span class="string" id="4716978">&#39;:&#39;</span><span class="op" id="4716981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4716986">d</span><span class="op" id="4716987">.</span><span class="ident" id="4716988">scan</span><span class="op" id="4716992">.</span><span class="ident" id="4716993">step</span><span class="op" id="4716997">(</span><span class="op" id="4716998">&amp;</span><span class="ident" id="4716999">d</span><span class="op" id="4717000">.</span><span class="ident" id="4717001">scan</span><span class="op" id="4717005">,</span>&nbsp;<span class="string" id="4717007">&#39;&#34;&#39;</span><span class="op" id="4717010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717015">d</span><span class="op" id="4717016">.</span><span class="ident" id="4717017">scan</span><span class="op" id="4717021">.</span><span class="ident" id="4717022">step</span><span class="op" id="4717026">(</span><span class="op" id="4717027">&amp;</span><span class="ident" id="4717028">d</span><span class="op" id="4717029">.</span><span class="ident" id="4717030">scan</span><span class="op" id="4717034">,</span>&nbsp;<span class="string" id="4717036">&#39;&#34;&#39;</span><span class="op" id="4717039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717044">d</span><span class="op" id="4717045">.</span><span class="ident" id="4717046">scan</span><span class="op" id="4717050">.</span><span class="ident" id="4717051">step</span><span class="op" id="4717055">(</span><span class="op" id="4717056">&amp;</span><span class="ident" id="4717057">d</span><span class="op" id="4717058">.</span><span class="ident" id="4717059">scan</span><span class="op" id="4717063">,</span>&nbsp;<span class="string" id="4717065">&#39;}&#39;</span><span class="op" id="4717068">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717077">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717089">switch</span>&nbsp;<span class="ident" id="4717096">op</span>&nbsp;<span class="op" id="4717099">:=</span>&nbsp;<span class="ident" id="4717102">d</span><span class="op" id="4717103">.</span><span class="ident" id="4717104">scanWhile</span><span class="op" id="4717113">(</span><span class="ident" id="4717114">scanSkipSpace</span><span class="op" id="4717127">)</span><span class="op" id="4717128">;</span>&nbsp;<span class="ident" id="4717130">op</span>&nbsp;<span class="op" id="4717133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717136">default</span><span class="op" id="4717143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717147">d</span><span class="op" id="4717148">.</span><span class="builtintype" id="4717149">error</span><span class="op" id="4717154">(</span><span class="ident" id="4717155">errPhase</span><span class="op" id="4717163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717167">case</span>&nbsp;<span class="ident" id="4717172">scanBeginArray</span><span class="op" id="4717186">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717190">d</span><span class="op" id="4717191">.</span><span class="ident" id="4717192">array</span><span class="op" id="4717197">(</span><span class="ident" id="4717198">v</span><span class="op" id="4717199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717203">case</span>&nbsp;<span class="ident" id="4717208">scanBeginObject</span><span class="op" id="4717223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717227">d</span><span class="op" id="4717228">.</span><span class="ident" id="4717229">object</span><span class="op" id="4717235">(</span><span class="ident" id="4717236">v</span><span class="op" id="4717237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717241">case</span>&nbsp;<span class="ident" id="4717246">scanBeginLiteral</span><span class="op" id="4717262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717266">d</span><span class="op" id="4717267">.</span><span class="ident" id="4717268">literal</span><span class="op" id="4717275">(</span><span class="ident" id="4717276">v</span><span class="op" id="4717277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717280">}</span><br>
<span class="lineno"></span><span class="op" id="4717282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4717285">type</span>&nbsp;<span class="ident" id="4717290">unquotedValue</span>&nbsp;<span class="keyword" id="4717304">struct</span><span class="op" id="4717310">{</span><span class="op" id="4717311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4717314">//&nbsp;valueQuoted&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;decodes&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4717357">//&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;literal&nbsp;null&nbsp;into&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4717423">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;anything&nbsp;other&nbsp;than&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;or&nbsp;null,</span><br>
<span class="lineno">300</span><span class="comment" id="4717491">//&nbsp;valueQuoted&nbsp;returns&nbsp;unquotedValue{}.</span><br>
<span class="lineno"></span><span class="keyword" id="4717531">func</span>&nbsp;<span class="op" id="4717536">(</span><span class="ident" id="4717537">d</span>&nbsp;<span class="op" id="4717539">*</span><span class="ident" id="4717540">decodeState</span><span class="op" id="4717551">)</span>&nbsp;<span class="ident" id="4717553">valueQuoted</span><span class="op" id="4717564">(</span><span class="op" id="4717565">)</span>&nbsp;<span class="keyword" id="4717567">interface</span><span class="op" id="4717576">{</span><span class="op" id="4717577">}</span>&nbsp;<span class="op" id="4717579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717582">switch</span>&nbsp;<span class="ident" id="4717589">op</span>&nbsp;<span class="op" id="4717592">:=</span>&nbsp;<span class="ident" id="4717595">d</span><span class="op" id="4717596">.</span><span class="ident" id="4717597">scanWhile</span><span class="op" id="4717606">(</span><span class="ident" id="4717607">scanSkipSpace</span><span class="op" id="4717620">)</span><span class="op" id="4717621">;</span>&nbsp;<span class="ident" id="4717623">op</span>&nbsp;<span class="op" id="4717626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717629">default</span><span class="op" id="4717636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717640">d</span><span class="op" id="4717641">.</span><span class="builtintype" id="4717642">error</span><span class="op" id="4717647">(</span><span class="ident" id="4717648">errPhase</span><span class="op" id="4717656">)</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717660">case</span>&nbsp;<span class="ident" id="4717665">scanBeginArray</span><span class="op" id="4717679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717683">d</span><span class="op" id="4717684">.</span><span class="ident" id="4717685">array</span><span class="op" id="4717690">(</span><span class="ident" id="4717691">reflect</span><span class="op" id="4717698">.</span><span class="ident" id="4717699">Value</span><span class="op" id="4717704">{</span><span class="op" id="4717705">}</span><span class="op" id="4717706">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717710">case</span>&nbsp;<span class="ident" id="4717715">scanBeginObject</span><span class="op" id="4717730">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4717734">d</span><span class="op" id="4717735">.</span><span class="ident" id="4717736">object</span><span class="op" id="4717742">(</span><span class="ident" id="4717743">reflect</span><span class="op" id="4717750">.</span><span class="ident" id="4717751">Value</span><span class="op" id="4717756">{</span><span class="op" id="4717757">}</span><span class="op" id="4717758">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717762">case</span>&nbsp;<span class="ident" id="4717767">scanBeginLiteral</span><span class="op" id="4717783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717787">switch</span>&nbsp;<span class="ident" id="4717794">v</span>&nbsp;<span class="op" id="4717796">:=</span>&nbsp;<span class="ident" id="4717799">d</span><span class="op" id="4717800">.</span><span class="ident" id="4717801">literalInterface</span><span class="op" id="4717817">(</span><span class="op" id="4717818">)</span><span class="op" id="4717819">.</span><span class="op" id="4717820">(</span><span class="keyword" id="4717821">type</span><span class="op" id="4717825">)</span>&nbsp;<span class="op" id="4717827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717831">case</span>&nbsp;<span class="ident" id="4717836">nil</span><span class="op" id="4717839">,</span>&nbsp;<span class="builtintype" id="4717841">string</span><span class="op" id="4717847">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717852">return</span>&nbsp;<span class="ident" id="4717859">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4717866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4717869">return</span>&nbsp;<span class="ident" id="4717876">unquotedValue</span><span class="op" id="4717889">{</span><span class="op" id="4717890">}</span><br>
<span class="lineno"></span><span class="op" id="4717892">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="4717895">//&nbsp;indirect&nbsp;walks&nbsp;down&nbsp;v&nbsp;allocating&nbsp;pointers&nbsp;as&nbsp;needed,</span><br>
<span class="lineno"></span><span class="comment" id="4717951">//&nbsp;until&nbsp;it&nbsp;gets&nbsp;to&nbsp;a&nbsp;non-pointer.</span><br>
<span class="lineno"></span><span class="comment" id="4717986">//&nbsp;if&nbsp;it&nbsp;encounters&nbsp;an&nbsp;Unmarshaler,&nbsp;indirect&nbsp;stops&nbsp;and&nbsp;returns&nbsp;that.</span><br>
<span class="lineno"></span><span class="comment" id="4718055">//&nbsp;if&nbsp;decodingNull&nbsp;is&nbsp;true,&nbsp;indirect&nbsp;stops&nbsp;at&nbsp;the&nbsp;last&nbsp;pointer&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;set&nbsp;to&nbsp;nil.</span><br>
<span class="lineno">325</span><span class="keyword" id="4718143">func</span>&nbsp;<span class="op" id="4718148">(</span><span class="ident" id="4718149">d</span>&nbsp;<span class="op" id="4718151">*</span><span class="ident" id="4718152">decodeState</span><span class="op" id="4718163">)</span>&nbsp;<span class="ident" id="4718165">indirect</span><span class="op" id="4718173">(</span><span class="ident" id="4718174">v</span>&nbsp;<span class="ident" id="4718176">reflect</span><span class="op" id="4718183">.</span><span class="ident" id="4718184">Value</span><span class="op" id="4718189">,</span>&nbsp;<span class="ident" id="4718191">decodingNull</span>&nbsp;<span class="builtintype" id="4718204">bool</span><span class="op" id="4718208">)</span>&nbsp;<span class="op" id="4718210">(</span><span class="ident" id="4718211">Unmarshaler</span><span class="op" id="4718222">,</span>&nbsp;<span class="ident" id="4718224">encoding</span><span class="op" id="4718232">.</span><span class="ident" id="4718233">TextUnmarshaler</span><span class="op" id="4718248">,</span>&nbsp;<span class="ident" id="4718250">reflect</span><span class="op" id="4718257">.</span><span class="ident" id="4718258">Value</span><span class="op" id="4718263">)</span>&nbsp;<span class="op" id="4718265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718268">//&nbsp;If&nbsp;v&nbsp;is&nbsp;a&nbsp;named&nbsp;type&nbsp;and&nbsp;is&nbsp;addressable,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718313">//&nbsp;start&nbsp;with&nbsp;its&nbsp;address,&nbsp;so&nbsp;that&nbsp;if&nbsp;the&nbsp;type&nbsp;has&nbsp;pointer&nbsp;methods,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718382">//&nbsp;we&nbsp;find&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718400">if</span>&nbsp;<span class="ident" id="4718403">v</span><span class="op" id="4718404">.</span><span class="ident" id="4718405">Kind</span><span class="op" id="4718409">(</span><span class="op" id="4718410">)</span>&nbsp;<span class="op" id="4718412">!=</span>&nbsp;<span class="ident" id="4718415">reflect</span><span class="op" id="4718422">.</span><span class="ident" id="4718423">Ptr</span>&nbsp;<span class="op" id="4718427">&amp;&amp;</span>&nbsp;<span class="ident" id="4718430">v</span><span class="op" id="4718431">.</span><span class="ident" id="4718432">Type</span><span class="op" id="4718436">(</span><span class="op" id="4718437">)</span><span class="op" id="4718438">.</span><span class="ident" id="4718439">Name</span><span class="op" id="4718443">(</span><span class="op" id="4718444">)</span>&nbsp;<span class="op" id="4718446">!=</span>&nbsp;<span class="string" id="4718449">&#34;&#34;</span>&nbsp;<span class="op" id="4718452">&amp;&amp;</span>&nbsp;<span class="ident" id="4718455">v</span><span class="op" id="4718456">.</span><span class="ident" id="4718457">CanAddr</span><span class="op" id="4718464">(</span><span class="op" id="4718465">)</span>&nbsp;<span class="op" id="4718467">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718471">v</span>&nbsp;<span class="op" id="4718473">=</span>&nbsp;<span class="ident" id="4718475">v</span><span class="op" id="4718476">.</span><span class="ident" id="4718477">Addr</span><span class="op" id="4718481">(</span><span class="op" id="4718482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718488">for</span>&nbsp;<span class="op" id="4718492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718496">//&nbsp;Load&nbsp;value&nbsp;from&nbsp;interface,&nbsp;but&nbsp;only&nbsp;if&nbsp;the&nbsp;result&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4718559">//&nbsp;usefully&nbsp;addressable.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718586">if</span>&nbsp;<span class="ident" id="4718589">v</span><span class="op" id="4718590">.</span><span class="ident" id="4718591">Kind</span><span class="op" id="4718595">(</span><span class="op" id="4718596">)</span>&nbsp;<span class="op" id="4718598">==</span>&nbsp;<span class="ident" id="4718601">reflect</span><span class="op" id="4718608">.</span><span class="ident" id="4718609">Interface</span>&nbsp;<span class="op" id="4718619">&amp;&amp;</span>&nbsp;<span class="op" id="4718622">!</span><span class="ident" id="4718623">v</span><span class="op" id="4718624">.</span><span class="ident" id="4718625">IsNil</span><span class="op" id="4718630">(</span><span class="op" id="4718631">)</span>&nbsp;<span class="op" id="4718633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718638">e</span>&nbsp;<span class="op" id="4718640">:=</span>&nbsp;<span class="ident" id="4718643">v</span><span class="op" id="4718644">.</span><span class="ident" id="4718645">Elem</span><span class="op" id="4718649">(</span><span class="op" id="4718650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718655">if</span>&nbsp;<span class="ident" id="4718658">e</span><span class="op" id="4718659">.</span><span class="ident" id="4718660">Kind</span><span class="op" id="4718664">(</span><span class="op" id="4718665">)</span>&nbsp;<span class="op" id="4718667">==</span>&nbsp;<span class="ident" id="4718670">reflect</span><span class="op" id="4718677">.</span><span class="ident" id="4718678">Ptr</span>&nbsp;<span class="op" id="4718682">&amp;&amp;</span>&nbsp;<span class="op" id="4718685">!</span><span class="ident" id="4718686">e</span><span class="op" id="4718687">.</span><span class="ident" id="4718688">IsNil</span><span class="op" id="4718693">(</span><span class="op" id="4718694">)</span>&nbsp;<span class="op" id="4718696">&amp;&amp;</span>&nbsp;<span class="op" id="4718699">(</span><span class="op" id="4718700">!</span><span class="ident" id="4718701">decodingNull</span>&nbsp;<span class="op" id="4718714">||</span>&nbsp;<span class="ident" id="4718717">e</span><span class="op" id="4718718">.</span><span class="ident" id="4718719">Elem</span><span class="op" id="4718723">(</span><span class="op" id="4718724">)</span><span class="op" id="4718725">.</span><span class="ident" id="4718726">Kind</span><span class="op" id="4718730">(</span><span class="op" id="4718731">)</span>&nbsp;<span class="op" id="4718733">==</span>&nbsp;<span class="ident" id="4718736">reflect</span><span class="op" id="4718743">.</span><span class="ident" id="4718744">Ptr</span><span class="op" id="4718747">)</span>&nbsp;<span class="op" id="4718749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718755">v</span>&nbsp;<span class="op" id="4718757">=</span>&nbsp;<span class="ident" id="4718759">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718765">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718786">if</span>&nbsp;<span class="ident" id="4718789">v</span><span class="op" id="4718790">.</span><span class="ident" id="4718791">Kind</span><span class="op" id="4718795">(</span><span class="op" id="4718796">)</span>&nbsp;<span class="op" id="4718798">!=</span>&nbsp;<span class="ident" id="4718801">reflect</span><span class="op" id="4718808">.</span><span class="ident" id="4718809">Ptr</span>&nbsp;<span class="op" id="4718813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718818">break</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718831">if</span>&nbsp;<span class="ident" id="4718834">v</span><span class="op" id="4718835">.</span><span class="ident" id="4718836">Elem</span><span class="op" id="4718840">(</span><span class="op" id="4718841">)</span><span class="op" id="4718842">.</span><span class="ident" id="4718843">Kind</span><span class="op" id="4718847">(</span><span class="op" id="4718848">)</span>&nbsp;<span class="op" id="4718850">!=</span>&nbsp;<span class="ident" id="4718853">reflect</span><span class="op" id="4718860">.</span><span class="ident" id="4718861">Ptr</span>&nbsp;<span class="op" id="4718865">&amp;&amp;</span>&nbsp;<span class="ident" id="4718868">decodingNull</span>&nbsp;<span class="op" id="4718881">&amp;&amp;</span>&nbsp;<span class="ident" id="4718884">v</span><span class="op" id="4718885">.</span><span class="ident" id="4718886">CanSet</span><span class="op" id="4718892">(</span><span class="op" id="4718893">)</span>&nbsp;<span class="op" id="4718895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718900">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718908">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718912">if</span>&nbsp;<span class="ident" id="4718915">v</span><span class="op" id="4718916">.</span><span class="ident" id="4718917">IsNil</span><span class="op" id="4718922">(</span><span class="op" id="4718923">)</span>&nbsp;<span class="op" id="4718925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4718930">v</span><span class="op" id="4718931">.</span><span class="ident" id="4718932">Set</span><span class="op" id="4718935">(</span><span class="ident" id="4718936">reflect</span><span class="op" id="4718943">.</span><span class="ident" id="4718944">New</span><span class="op" id="4718947">(</span><span class="ident" id="4718948">v</span><span class="op" id="4718949">.</span><span class="ident" id="4718950">Type</span><span class="op" id="4718954">(</span><span class="op" id="4718955">)</span><span class="op" id="4718956">.</span><span class="ident" id="4718957">Elem</span><span class="op" id="4718961">(</span><span class="op" id="4718962">)</span><span class="op" id="4718963">)</span><span class="op" id="4718964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4718968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4718972">if</span>&nbsp;<span class="ident" id="4718975">v</span><span class="op" id="4718976">.</span><span class="ident" id="4718977">Type</span><span class="op" id="4718981">(</span><span class="op" id="4718982">)</span><span class="op" id="4718983">.</span><span class="ident" id="4718984">NumMethod</span><span class="op" id="4718993">(</span><span class="op" id="4718994">)</span>&nbsp;<span class="op" id="4718996">&gt;</span>&nbsp;<span class="num" id="4718998">0</span>&nbsp;<span class="op" id="4719000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719005">if</span>&nbsp;<span class="ident" id="4719008">u</span><span class="op" id="4719009">,</span>&nbsp;<span class="ident" id="4719011">ok</span>&nbsp;<span class="op" id="4719014">:=</span>&nbsp;<span class="ident" id="4719017">v</span><span class="op" id="4719018">.</span><span class="ident" id="4719019">Interface</span><span class="op" id="4719028">(</span><span class="op" id="4719029">)</span><span class="op" id="4719030">.</span><span class="op" id="4719031">(</span><span class="ident" id="4719032">Unmarshaler</span><span class="op" id="4719043">)</span><span class="op" id="4719044">;</span>&nbsp;<span class="ident" id="4719046">ok</span>&nbsp;<span class="op" id="4719049">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719055">return</span>&nbsp;<span class="ident" id="4719062">u</span><span class="op" id="4719063">,</span>&nbsp;<span class="ident" id="4719065">nil</span><span class="op" id="4719068">,</span>&nbsp;<span class="ident" id="4719070">reflect</span><span class="op" id="4719077">.</span><span class="ident" id="4719078">Value</span><span class="op" id="4719083">{</span><span class="op" id="4719084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719094">if</span>&nbsp;<span class="ident" id="4719097">u</span><span class="op" id="4719098">,</span>&nbsp;<span class="ident" id="4719100">ok</span>&nbsp;<span class="op" id="4719103">:=</span>&nbsp;<span class="ident" id="4719106">v</span><span class="op" id="4719107">.</span><span class="ident" id="4719108">Interface</span><span class="op" id="4719117">(</span><span class="op" id="4719118">)</span><span class="op" id="4719119">.</span><span class="op" id="4719120">(</span><span class="ident" id="4719121">encoding</span><span class="op" id="4719129">.</span><span class="ident" id="4719130">TextUnmarshaler</span><span class="op" id="4719145">)</span><span class="op" id="4719146">;</span>&nbsp;<span class="ident" id="4719148">ok</span>&nbsp;<span class="op" id="4719151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719157">return</span>&nbsp;<span class="ident" id="4719164">nil</span><span class="op" id="4719167">,</span>&nbsp;<span class="ident" id="4719169">u</span><span class="op" id="4719170">,</span>&nbsp;<span class="ident" id="4719172">reflect</span><span class="op" id="4719179">.</span><span class="ident" id="4719180">Value</span><span class="op" id="4719185">{</span><span class="op" id="4719186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719191">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719199">v</span>&nbsp;<span class="op" id="4719201">=</span>&nbsp;<span class="ident" id="4719203">v</span><span class="op" id="4719204">.</span><span class="ident" id="4719205">Elem</span><span class="op" id="4719209">(</span><span class="op" id="4719210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719216">return</span>&nbsp;<span class="ident" id="4719223">nil</span><span class="op" id="4719226">,</span>&nbsp;<span class="ident" id="4719228">nil</span><span class="op" id="4719231">,</span>&nbsp;<span class="ident" id="4719233">v</span><br>
<span class="lineno"></span><span class="op" id="4719235">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="4719238">//&nbsp;array&nbsp;consumes&nbsp;an&nbsp;array&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4719315">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;array&nbsp;(&#39;[&#39;)&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="4719375">func</span>&nbsp;<span class="op" id="4719380">(</span><span class="ident" id="4719381">d</span>&nbsp;<span class="op" id="4719383">*</span><span class="ident" id="4719384">decodeState</span><span class="op" id="4719395">)</span>&nbsp;<span class="ident" id="4719397">array</span><span class="op" id="4719402">(</span><span class="ident" id="4719403">v</span>&nbsp;<span class="ident" id="4719405">reflect</span><span class="op" id="4719412">.</span><span class="ident" id="4719413">Value</span><span class="op" id="4719418">)</span>&nbsp;<span class="op" id="4719420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4719423">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719450">u</span><span class="op" id="4719451">,</span>&nbsp;<span class="ident" id="4719453">ut</span><span class="op" id="4719455">,</span>&nbsp;<span class="ident" id="4719457">pv</span>&nbsp;<span class="op" id="4719460">:=</span>&nbsp;<span class="ident" id="4719463">d</span><span class="op" id="4719464">.</span><span class="ident" id="4719465">indirect</span><span class="op" id="4719473">(</span><span class="ident" id="4719474">v</span><span class="op" id="4719475">,</span>&nbsp;<span class="ident" id="4719477">false</span><span class="op" id="4719482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719485">if</span>&nbsp;<span class="ident" id="4719488">u</span>&nbsp;<span class="op" id="4719490">!=</span>&nbsp;<span class="ident" id="4719493">nil</span>&nbsp;<span class="op" id="4719497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719501">d</span><span class="op" id="4719502">.</span><span class="ident" id="4719503">off</span><span class="op" id="4719506">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719511">err</span>&nbsp;<span class="op" id="4719515">:=</span>&nbsp;<span class="ident" id="4719518">u</span><span class="op" id="4719519">.</span><span class="ident" id="4719520">UnmarshalJSON</span><span class="op" id="4719533">(</span><span class="ident" id="4719534">d</span><span class="op" id="4719535">.</span><span class="ident" id="4719536">next</span><span class="op" id="4719540">(</span><span class="op" id="4719541">)</span><span class="op" id="4719542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719546">if</span>&nbsp;<span class="ident" id="4719549">err</span>&nbsp;<span class="op" id="4719553">!=</span>&nbsp;<span class="ident" id="4719556">nil</span>&nbsp;<span class="op" id="4719560">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719565">d</span><span class="op" id="4719566">.</span><span class="builtintype" id="4719567">error</span><span class="op" id="4719572">(</span><span class="ident" id="4719573">err</span><span class="op" id="4719576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719584">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719595">if</span>&nbsp;<span class="ident" id="4719598">ut</span>&nbsp;<span class="op" id="4719601">!=</span>&nbsp;<span class="ident" id="4719604">nil</span>&nbsp;<span class="op" id="4719608">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719612">d</span><span class="op" id="4719613">.</span><span class="ident" id="4719614">saveError</span><span class="op" id="4719623">(</span><span class="op" id="4719624">&amp;</span><span class="ident" id="4719625">UnmarshalTypeError</span><span class="op" id="4719643">{</span><span class="string" id="4719644">&#34;array&#34;</span><span class="op" id="4719651">,</span>&nbsp;<span class="ident" id="4719653">v</span><span class="op" id="4719654">.</span><span class="ident" id="4719655">Type</span><span class="op" id="4719659">(</span><span class="op" id="4719660">)</span><span class="op" id="4719661">}</span><span class="op" id="4719662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719666">d</span><span class="op" id="4719667">.</span><span class="ident" id="4719668">off</span><span class="op" id="4719671">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719676">d</span><span class="op" id="4719677">.</span><span class="ident" id="4719678">next</span><span class="op" id="4719682">(</span><span class="op" id="4719683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719687">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719695">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719699">v</span>&nbsp;<span class="op" id="4719701">=</span>&nbsp;<span class="ident" id="4719703">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4719708">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719734">switch</span>&nbsp;<span class="ident" id="4719741">v</span><span class="op" id="4719742">.</span><span class="ident" id="4719743">Kind</span><span class="op" id="4719747">(</span><span class="op" id="4719748">)</span>&nbsp;<span class="op" id="4719750">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719753">case</span>&nbsp;<span class="ident" id="4719758">reflect</span><span class="op" id="4719765">.</span><span class="ident" id="4719766">Interface</span><span class="op" id="4719775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719779">if</span>&nbsp;<span class="ident" id="4719782">v</span><span class="op" id="4719783">.</span><span class="ident" id="4719784">NumMethod</span><span class="op" id="4719793">(</span><span class="op" id="4719794">)</span>&nbsp;<span class="op" id="4719796">==</span>&nbsp;<span class="num" id="4719799">0</span>&nbsp;<span class="op" id="4719801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4719806">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719870">v</span><span class="op" id="4719871">.</span><span class="ident" id="4719872">Set</span><span class="op" id="4719875">(</span><span class="ident" id="4719876">reflect</span><span class="op" id="4719883">.</span><span class="ident" id="4719884">ValueOf</span><span class="op" id="4719891">(</span><span class="ident" id="4719892">d</span><span class="op" id="4719893">.</span><span class="ident" id="4719894">arrayInterface</span><span class="op" id="4719908">(</span><span class="op" id="4719909">)</span><span class="op" id="4719910">)</span><span class="op" id="4719911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719916">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4719925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4719929">//&nbsp;Otherwise&nbsp;it&#39;s&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719958">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4719971">default</span><span class="op" id="4719978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4719982">d</span><span class="op" id="4719983">.</span><span class="ident" id="4719984">saveError</span><span class="op" id="4719993">(</span><span class="op" id="4719994">&amp;</span><span class="ident" id="4719995">UnmarshalTypeError</span><span class="op" id="4720013">{</span><span class="string" id="4720014">&#34;array&#34;</span><span class="op" id="4720021">,</span>&nbsp;<span class="ident" id="4720023">v</span><span class="op" id="4720024">.</span><span class="ident" id="4720025">Type</span><span class="op" id="4720029">(</span><span class="op" id="4720030">)</span><span class="op" id="4720031">}</span><span class="op" id="4720032">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720036">d</span><span class="op" id="4720037">.</span><span class="ident" id="4720038">off</span><span class="op" id="4720041">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720046">d</span><span class="op" id="4720047">.</span><span class="ident" id="4720048">next</span><span class="op" id="4720052">(</span><span class="op" id="4720053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720057">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720065">case</span>&nbsp;<span class="ident" id="4720070">reflect</span><span class="op" id="4720077">.</span><span class="ident" id="4720078">Array</span><span class="op" id="4720083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720086">case</span>&nbsp;<span class="ident" id="4720091">reflect</span><span class="op" id="4720098">.</span><span class="ident" id="4720099">Slice</span><span class="op" id="4720104">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720108">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720119">i</span>&nbsp;<span class="op" id="4720121">:=</span>&nbsp;<span class="num" id="4720124">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720127">for</span>&nbsp;<span class="op" id="4720131">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4720135">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720195">op</span>&nbsp;<span class="op" id="4720198">:=</span>&nbsp;<span class="ident" id="4720201">d</span><span class="op" id="4720202">.</span><span class="ident" id="4720203">scanWhile</span><span class="op" id="4720212">(</span><span class="ident" id="4720213">scanSkipSpace</span><span class="op" id="4720226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720230">if</span>&nbsp;<span class="ident" id="4720233">op</span>&nbsp;<span class="op" id="4720236">==</span>&nbsp;<span class="ident" id="4720239">scanEndArray</span>&nbsp;<span class="op" id="4720252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720257">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720265">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4720270">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720326">d</span><span class="op" id="4720327">.</span><span class="ident" id="4720328">off</span><span class="op" id="4720331">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720336">d</span><span class="op" id="4720337">.</span><span class="ident" id="4720338">scan</span><span class="op" id="4720342">.</span><span class="ident" id="4720343">undo</span><span class="op" id="4720347">(</span><span class="ident" id="4720348">op</span><span class="op" id="4720350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4720355">//&nbsp;Get&nbsp;element&nbsp;of&nbsp;array,&nbsp;growing&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720404">if</span>&nbsp;<span class="ident" id="4720407">v</span><span class="op" id="4720408">.</span><span class="ident" id="4720409">Kind</span><span class="op" id="4720413">(</span><span class="op" id="4720414">)</span>&nbsp;<span class="op" id="4720416">==</span>&nbsp;<span class="ident" id="4720419">reflect</span><span class="op" id="4720426">.</span><span class="ident" id="4720427">Slice</span>&nbsp;<span class="op" id="4720433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4720438">//&nbsp;Grow&nbsp;slice&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720468">if</span>&nbsp;<span class="ident" id="4720471">i</span>&nbsp;<span class="op" id="4720473">&gt;=</span>&nbsp;<span class="ident" id="4720476">v</span><span class="op" id="4720477">.</span><span class="ident" id="4720478">Cap</span><span class="op" id="4720481">(</span><span class="op" id="4720482">)</span>&nbsp;<span class="op" id="4720484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720490">newcap</span>&nbsp;<span class="op" id="4720497">:=</span>&nbsp;<span class="ident" id="4720500">v</span><span class="op" id="4720501">.</span><span class="ident" id="4720502">Cap</span><span class="op" id="4720505">(</span><span class="op" id="4720506">)</span>&nbsp;<span class="op" id="4720508">+</span>&nbsp;<span class="ident" id="4720510">v</span><span class="op" id="4720511">.</span><span class="ident" id="4720512">Cap</span><span class="op" id="4720515">(</span><span class="op" id="4720516">)</span><span class="op" id="4720517">/</span><span class="num" id="4720518">2</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720524">if</span>&nbsp;<span class="ident" id="4720527">newcap</span>&nbsp;<span class="op" id="4720534">&lt;</span>&nbsp;<span class="num" id="4720536">4</span>&nbsp;<span class="op" id="4720538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720545">newcap</span>&nbsp;<span class="op" id="4720552">=</span>&nbsp;<span class="num" id="4720554">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720566">newv</span>&nbsp;<span class="op" id="4720571">:=</span>&nbsp;<span class="ident" id="4720574">reflect</span><span class="op" id="4720581">.</span><span class="ident" id="4720582">MakeSlice</span><span class="op" id="4720591">(</span><span class="ident" id="4720592">v</span><span class="op" id="4720593">.</span><span class="ident" id="4720594">Type</span><span class="op" id="4720598">(</span><span class="op" id="4720599">)</span><span class="op" id="4720600">,</span>&nbsp;<span class="ident" id="4720602">v</span><span class="op" id="4720603">.</span><span class="ident" id="4720604">Len</span><span class="op" id="4720607">(</span><span class="op" id="4720608">)</span><span class="op" id="4720609">,</span>&nbsp;<span class="ident" id="4720611">newcap</span><span class="op" id="4720617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720623">reflect</span><span class="op" id="4720630">.</span><span class="ident" id="4720631">Copy</span><span class="op" id="4720635">(</span><span class="ident" id="4720636">newv</span><span class="op" id="4720640">,</span>&nbsp;<span class="ident" id="4720642">v</span><span class="op" id="4720643">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720649">v</span><span class="op" id="4720650">.</span><span class="ident" id="4720651">Set</span><span class="op" id="4720654">(</span><span class="ident" id="4720655">newv</span><span class="op" id="4720659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720669">if</span>&nbsp;<span class="ident" id="4720672">i</span>&nbsp;<span class="op" id="4720674">&gt;=</span>&nbsp;<span class="ident" id="4720677">v</span><span class="op" id="4720678">.</span><span class="ident" id="4720679">Len</span><span class="op" id="4720682">(</span><span class="op" id="4720683">)</span>&nbsp;<span class="op" id="4720685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720691">v</span><span class="op" id="4720692">.</span><span class="ident" id="4720693">SetLen</span><span class="op" id="4720699">(</span><span class="ident" id="4720700">i</span>&nbsp;<span class="op" id="4720702">+</span>&nbsp;<span class="num" id="4720704">1</span><span class="op" id="4720705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720710">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720719">if</span>&nbsp;<span class="ident" id="4720722">i</span>&nbsp;<span class="op" id="4720724">&lt;</span>&nbsp;<span class="ident" id="4720726">v</span><span class="op" id="4720727">.</span><span class="ident" id="4720728">Len</span><span class="op" id="4720731">(</span><span class="op" id="4720732">)</span>&nbsp;<span class="op" id="4720734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4720739">//&nbsp;Decode&nbsp;into&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720766">d</span><span class="op" id="4720767">.</span><span class="ident" id="4720768">value</span><span class="op" id="4720773">(</span><span class="ident" id="4720774">v</span><span class="op" id="4720775">.</span><span class="ident" id="4720776">Index</span><span class="op" id="4720781">(</span><span class="ident" id="4720782">i</span><span class="op" id="4720783">)</span><span class="op" id="4720784">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720788">}</span>&nbsp;<span class="keyword" id="4720790">else</span>&nbsp;<span class="op" id="4720795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4720800">//&nbsp;Ran&nbsp;out&nbsp;of&nbsp;fixed&nbsp;array:&nbsp;skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720836">d</span><span class="op" id="4720837">.</span><span class="ident" id="4720838">value</span><span class="op" id="4720843">(</span><span class="ident" id="4720844">reflect</span><span class="op" id="4720851">.</span><span class="ident" id="4720852">Value</span><span class="op" id="4720857">{</span><span class="op" id="4720858">}</span><span class="op" id="4720859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720867">i</span><span class="op" id="4720868">++</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4720874">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4720906">op</span>&nbsp;<span class="op" id="4720909">=</span>&nbsp;<span class="ident" id="4720911">d</span><span class="op" id="4720912">.</span><span class="ident" id="4720913">scanWhile</span><span class="op" id="4720922">(</span><span class="ident" id="4720923">scanSkipSpace</span><span class="op" id="4720936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720940">if</span>&nbsp;<span class="ident" id="4720943">op</span>&nbsp;<span class="op" id="4720946">==</span>&nbsp;<span class="ident" id="4720949">scanEndArray</span>&nbsp;<span class="op" id="4720962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720967">break</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4720975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4720979">if</span>&nbsp;<span class="ident" id="4720982">op</span>&nbsp;<span class="op" id="4720985">!=</span>&nbsp;<span class="ident" id="4720988">scanArrayValue</span>&nbsp;<span class="op" id="4721003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721008">d</span><span class="op" id="4721009">.</span><span class="builtintype" id="4721010">error</span><span class="op" id="4721015">(</span><span class="ident" id="4721016">errPhase</span><span class="op" id="4721024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721031">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721035">if</span>&nbsp;<span class="ident" id="4721038">i</span>&nbsp;<span class="op" id="4721040">&lt;</span>&nbsp;<span class="ident" id="4721042">v</span><span class="op" id="4721043">.</span><span class="ident" id="4721044">Len</span><span class="op" id="4721047">(</span><span class="op" id="4721048">)</span>&nbsp;<span class="op" id="4721050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721054">if</span>&nbsp;<span class="ident" id="4721057">v</span><span class="op" id="4721058">.</span><span class="ident" id="4721059">Kind</span><span class="op" id="4721063">(</span><span class="op" id="4721064">)</span>&nbsp;<span class="op" id="4721066">==</span>&nbsp;<span class="ident" id="4721069">reflect</span><span class="op" id="4721076">.</span><span class="ident" id="4721077">Array</span>&nbsp;<span class="op" id="4721083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4721088">//&nbsp;Array.&nbsp;&nbsp;Zero&nbsp;the&nbsp;rest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721117">z</span>&nbsp;<span class="op" id="4721119">:=</span>&nbsp;<span class="ident" id="4721122">reflect</span><span class="op" id="4721129">.</span><span class="ident" id="4721130">Zero</span><span class="op" id="4721134">(</span><span class="ident" id="4721135">v</span><span class="op" id="4721136">.</span><span class="ident" id="4721137">Type</span><span class="op" id="4721141">(</span><span class="op" id="4721142">)</span><span class="op" id="4721143">.</span><span class="ident" id="4721144">Elem</span><span class="op" id="4721148">(</span><span class="op" id="4721149">)</span><span class="op" id="4721150">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721155">for</span>&nbsp;<span class="op" id="4721159">;</span>&nbsp;<span class="ident" id="4721161">i</span>&nbsp;<span class="op" id="4721163">&lt;</span>&nbsp;<span class="ident" id="4721165">v</span><span class="op" id="4721166">.</span><span class="ident" id="4721167">Len</span><span class="op" id="4721170">(</span><span class="op" id="4721171">)</span><span class="op" id="4721172">;</span>&nbsp;<span class="ident" id="4721174">i</span><span class="op" id="4721175">++</span>&nbsp;<span class="op" id="4721178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721184">v</span><span class="op" id="4721185">.</span><span class="ident" id="4721186">Index</span><span class="op" id="4721191">(</span><span class="ident" id="4721192">i</span><span class="op" id="4721193">)</span><span class="op" id="4721194">.</span><span class="ident" id="4721195">Set</span><span class="op" id="4721198">(</span><span class="ident" id="4721199">z</span><span class="op" id="4721200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721209">}</span>&nbsp;<span class="keyword" id="4721211">else</span>&nbsp;<span class="op" id="4721216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721221">v</span><span class="op" id="4721222">.</span><span class="ident" id="4721223">SetLen</span><span class="op" id="4721229">(</span><span class="ident" id="4721230">i</span><span class="op" id="4721231">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721241">if</span>&nbsp;<span class="ident" id="4721244">i</span>&nbsp;<span class="op" id="4721246">==</span>&nbsp;<span class="num" id="4721249">0</span>&nbsp;<span class="op" id="4721251">&amp;&amp;</span>&nbsp;<span class="ident" id="4721254">v</span><span class="op" id="4721255">.</span><span class="ident" id="4721256">Kind</span><span class="op" id="4721260">(</span><span class="op" id="4721261">)</span>&nbsp;<span class="op" id="4721263">==</span>&nbsp;<span class="ident" id="4721266">reflect</span><span class="op" id="4721273">.</span><span class="ident" id="4721274">Slice</span>&nbsp;<span class="op" id="4721280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721284">v</span><span class="op" id="4721285">.</span><span class="ident" id="4721286">Set</span><span class="op" id="4721289">(</span><span class="ident" id="4721290">reflect</span><span class="op" id="4721297">.</span><span class="ident" id="4721298">MakeSlice</span><span class="op" id="4721307">(</span><span class="ident" id="4721308">v</span><span class="op" id="4721309">.</span><span class="ident" id="4721310">Type</span><span class="op" id="4721314">(</span><span class="op" id="4721315">)</span><span class="op" id="4721316">,</span>&nbsp;<span class="num" id="4721318">0</span><span class="op" id="4721319">,</span>&nbsp;<span class="num" id="4721321">0</span><span class="op" id="4721322">)</span><span class="op" id="4721323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721326">}</span><br>
<span class="lineno">470</span><span class="op" id="4721328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4721331">var</span>&nbsp;<span class="ident" id="4721335">nullLiteral</span>&nbsp;<span class="op" id="4721347">=</span>&nbsp;<span class="op" id="4721349">[</span><span class="op" id="4721350">]</span><span class="builtintype" id="4721351">byte</span><span class="op" id="4721355">(</span><span class="string" id="4721356">&#34;null&#34;</span><span class="op" id="4721362">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4721365">//&nbsp;object&nbsp;consumes&nbsp;an&nbsp;object&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno">475</span><span class="comment" id="4721444">//&nbsp;the&nbsp;first&nbsp;byte&nbsp;(&#39;{&#39;)&nbsp;of&nbsp;the&nbsp;object&nbsp;has&nbsp;been&nbsp;read&nbsp;already.</span><br>
<span class="lineno"></span><span class="keyword" id="4721505">func</span>&nbsp;<span class="op" id="4721510">(</span><span class="ident" id="4721511">d</span>&nbsp;<span class="op" id="4721513">*</span><span class="ident" id="4721514">decodeState</span><span class="op" id="4721525">)</span>&nbsp;<span class="ident" id="4721527">object</span><span class="op" id="4721533">(</span><span class="ident" id="4721534">v</span>&nbsp;<span class="ident" id="4721536">reflect</span><span class="op" id="4721543">.</span><span class="ident" id="4721544">Value</span><span class="op" id="4721549">)</span>&nbsp;<span class="op" id="4721551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4721554">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721581">u</span><span class="op" id="4721582">,</span>&nbsp;<span class="ident" id="4721584">ut</span><span class="op" id="4721586">,</span>&nbsp;<span class="ident" id="4721588">pv</span>&nbsp;<span class="op" id="4721591">:=</span>&nbsp;<span class="ident" id="4721594">d</span><span class="op" id="4721595">.</span><span class="ident" id="4721596">indirect</span><span class="op" id="4721604">(</span><span class="ident" id="4721605">v</span><span class="op" id="4721606">,</span>&nbsp;<span class="ident" id="4721608">false</span><span class="op" id="4721613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721616">if</span>&nbsp;<span class="ident" id="4721619">u</span>&nbsp;<span class="op" id="4721621">!=</span>&nbsp;<span class="ident" id="4721624">nil</span>&nbsp;<span class="op" id="4721628">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721632">d</span><span class="op" id="4721633">.</span><span class="ident" id="4721634">off</span><span class="op" id="4721637">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721642">err</span>&nbsp;<span class="op" id="4721646">:=</span>&nbsp;<span class="ident" id="4721649">u</span><span class="op" id="4721650">.</span><span class="ident" id="4721651">UnmarshalJSON</span><span class="op" id="4721664">(</span><span class="ident" id="4721665">d</span><span class="op" id="4721666">.</span><span class="ident" id="4721667">next</span><span class="op" id="4721671">(</span><span class="op" id="4721672">)</span><span class="op" id="4721673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721677">if</span>&nbsp;<span class="ident" id="4721680">err</span>&nbsp;<span class="op" id="4721684">!=</span>&nbsp;<span class="ident" id="4721687">nil</span>&nbsp;<span class="op" id="4721691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721696">d</span><span class="op" id="4721697">.</span><span class="builtintype" id="4721698">error</span><span class="op" id="4721703">(</span><span class="ident" id="4721704">err</span><span class="op" id="4721707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721711">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721715">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721726">if</span>&nbsp;<span class="ident" id="4721729">ut</span>&nbsp;<span class="op" id="4721732">!=</span>&nbsp;<span class="ident" id="4721735">nil</span>&nbsp;<span class="op" id="4721739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721743">d</span><span class="op" id="4721744">.</span><span class="ident" id="4721745">saveError</span><span class="op" id="4721754">(</span><span class="op" id="4721755">&amp;</span><span class="ident" id="4721756">UnmarshalTypeError</span><span class="op" id="4721774">{</span><span class="string" id="4721775">&#34;object&#34;</span><span class="op" id="4721783">,</span>&nbsp;<span class="ident" id="4721785">v</span><span class="op" id="4721786">.</span><span class="ident" id="4721787">Type</span><span class="op" id="4721791">(</span><span class="op" id="4721792">)</span><span class="op" id="4721793">}</span><span class="op" id="4721794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721798">d</span><span class="op" id="4721799">.</span><span class="ident" id="4721800">off</span><span class="op" id="4721803">--</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721808">d</span><span class="op" id="4721809">.</span><span class="ident" id="4721810">next</span><span class="op" id="4721814">(</span><span class="op" id="4721815">)</span>&nbsp;<span class="comment" id="4721817">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721845">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4721853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721856">v</span>&nbsp;<span class="op" id="4721858">=</span>&nbsp;<span class="ident" id="4721860">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4721865">//&nbsp;Decoding&nbsp;into&nbsp;nil&nbsp;interface?&nbsp;&nbsp;Switch&nbsp;to&nbsp;non-reflect&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4721927">if</span>&nbsp;<span class="ident" id="4721930">v</span><span class="op" id="4721931">.</span><span class="ident" id="4721932">Kind</span><span class="op" id="4721936">(</span><span class="op" id="4721937">)</span>&nbsp;<span class="op" id="4721939">==</span>&nbsp;<span class="ident" id="4721942">reflect</span><span class="op" id="4721949">.</span><span class="ident" id="4721950">Interface</span>&nbsp;<span class="op" id="4721960">&amp;&amp;</span>&nbsp;<span class="ident" id="4721963">v</span><span class="op" id="4721964">.</span><span class="ident" id="4721965">NumMethod</span><span class="op" id="4721974">(</span><span class="op" id="4721975">)</span>&nbsp;<span class="op" id="4721977">==</span>&nbsp;<span class="num" id="4721980">0</span>&nbsp;<span class="op" id="4721982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4721986">v</span><span class="op" id="4721987">.</span><span class="ident" id="4721988">Set</span><span class="op" id="4721991">(</span><span class="ident" id="4721992">reflect</span><span class="op" id="4721999">.</span><span class="ident" id="4722000">ValueOf</span><span class="op" id="4722007">(</span><span class="ident" id="4722008">d</span><span class="op" id="4722009">.</span><span class="ident" id="4722010">objectInterface</span><span class="op" id="4722025">(</span><span class="op" id="4722026">)</span><span class="op" id="4722027">)</span><span class="op" id="4722028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722032">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4722040">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4722044">//&nbsp;Check&nbsp;type&nbsp;of&nbsp;target:&nbsp;struct&nbsp;or&nbsp;map[string]T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722093">switch</span>&nbsp;<span class="ident" id="4722100">v</span><span class="op" id="4722101">.</span><span class="ident" id="4722102">Kind</span><span class="op" id="4722106">(</span><span class="op" id="4722107">)</span>&nbsp;<span class="op" id="4722109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722112">case</span>&nbsp;<span class="ident" id="4722117">reflect</span><span class="op" id="4722124">.</span><span class="ident" id="4722125">Map</span><span class="op" id="4722128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4722132">//&nbsp;map&nbsp;must&nbsp;have&nbsp;string&nbsp;kind</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722163">t</span>&nbsp;<span class="op" id="4722165">:=</span>&nbsp;<span class="ident" id="4722168">v</span><span class="op" id="4722169">.</span><span class="ident" id="4722170">Type</span><span class="op" id="4722174">(</span><span class="op" id="4722175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722179">if</span>&nbsp;<span class="ident" id="4722182">t</span><span class="op" id="4722183">.</span><span class="ident" id="4722184">Key</span><span class="op" id="4722187">(</span><span class="op" id="4722188">)</span><span class="op" id="4722189">.</span><span class="ident" id="4722190">Kind</span><span class="op" id="4722194">(</span><span class="op" id="4722195">)</span>&nbsp;<span class="op" id="4722197">!=</span>&nbsp;<span class="ident" id="4722200">reflect</span><span class="op" id="4722207">.</span><span class="ident" id="4722208">String</span>&nbsp;<span class="op" id="4722215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722220">d</span><span class="op" id="4722221">.</span><span class="ident" id="4722222">saveError</span><span class="op" id="4722231">(</span><span class="op" id="4722232">&amp;</span><span class="ident" id="4722233">UnmarshalTypeError</span><span class="op" id="4722251">{</span><span class="string" id="4722252">&#34;object&#34;</span><span class="op" id="4722260">,</span>&nbsp;<span class="ident" id="4722262">v</span><span class="op" id="4722263">.</span><span class="ident" id="4722264">Type</span><span class="op" id="4722268">(</span><span class="op" id="4722269">)</span><span class="op" id="4722270">}</span><span class="op" id="4722271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722276">d</span><span class="op" id="4722277">.</span><span class="ident" id="4722278">off</span><span class="op" id="4722281">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722287">d</span><span class="op" id="4722288">.</span><span class="ident" id="4722289">next</span><span class="op" id="4722293">(</span><span class="op" id="4722294">)</span>&nbsp;<span class="comment" id="4722296">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4722334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722338">if</span>&nbsp;<span class="ident" id="4722341">v</span><span class="op" id="4722342">.</span><span class="ident" id="4722343">IsNil</span><span class="op" id="4722348">(</span><span class="op" id="4722349">)</span>&nbsp;<span class="op" id="4722351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722356">v</span><span class="op" id="4722357">.</span><span class="ident" id="4722358">Set</span><span class="op" id="4722361">(</span><span class="ident" id="4722362">reflect</span><span class="op" id="4722369">.</span><span class="ident" id="4722370">MakeMap</span><span class="op" id="4722377">(</span><span class="ident" id="4722378">t</span><span class="op" id="4722379">)</span><span class="op" id="4722380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4722384">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722387">case</span>&nbsp;<span class="ident" id="4722392">reflect</span><span class="op" id="4722399">.</span><span class="ident" id="4722400">Struct</span><span class="op" id="4722406">:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722410">default</span><span class="op" id="4722417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722421">d</span><span class="op" id="4722422">.</span><span class="ident" id="4722423">saveError</span><span class="op" id="4722432">(</span><span class="op" id="4722433">&amp;</span><span class="ident" id="4722434">UnmarshalTypeError</span><span class="op" id="4722452">{</span><span class="string" id="4722453">&#34;object&#34;</span><span class="op" id="4722461">,</span>&nbsp;<span class="ident" id="4722463">v</span><span class="op" id="4722464">.</span><span class="ident" id="4722465">Type</span><span class="op" id="4722469">(</span><span class="op" id="4722470">)</span><span class="op" id="4722471">}</span><span class="op" id="4722472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722476">d</span><span class="op" id="4722477">.</span><span class="ident" id="4722478">off</span><span class="op" id="4722481">--</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722486">d</span><span class="op" id="4722487">.</span><span class="ident" id="4722488">next</span><span class="op" id="4722492">(</span><span class="op" id="4722493">)</span>&nbsp;<span class="comment" id="4722495">//&nbsp;skip&nbsp;over&nbsp;{&nbsp;}&nbsp;in&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722523">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4722531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722535">var</span>&nbsp;<span class="ident" id="4722539">mapElem</span>&nbsp;<span class="ident" id="4722547">reflect</span><span class="op" id="4722554">.</span><span class="ident" id="4722555">Value</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722563">for</span>&nbsp;<span class="op" id="4722567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4722571">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722619">op</span>&nbsp;<span class="op" id="4722622">:=</span>&nbsp;<span class="ident" id="4722625">d</span><span class="op" id="4722626">.</span><span class="ident" id="4722627">scanWhile</span><span class="op" id="4722636">(</span><span class="ident" id="4722637">scanSkipSpace</span><span class="op" id="4722650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722654">if</span>&nbsp;<span class="ident" id="4722657">op</span>&nbsp;<span class="op" id="4722660">==</span>&nbsp;<span class="ident" id="4722663">scanEndObject</span>&nbsp;<span class="op" id="4722677">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4722682">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722736">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4722744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722748">if</span>&nbsp;<span class="ident" id="4722751">op</span>&nbsp;<span class="op" id="4722754">!=</span>&nbsp;<span class="ident" id="4722757">scanBeginLiteral</span>&nbsp;<span class="op" id="4722774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722779">d</span><span class="op" id="4722780">.</span><span class="builtintype" id="4722781">error</span><span class="op" id="4722786">(</span><span class="ident" id="4722787">errPhase</span><span class="op" id="4722795">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4722799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4722804">//&nbsp;Read&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722819">start</span>&nbsp;<span class="op" id="4722825">:=</span>&nbsp;<span class="ident" id="4722828">d</span><span class="op" id="4722829">.</span><span class="ident" id="4722830">off</span>&nbsp;<span class="op" id="4722834">-</span>&nbsp;<span class="num" id="4722836">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722840">op</span>&nbsp;<span class="op" id="4722843">=</span>&nbsp;<span class="ident" id="4722845">d</span><span class="op" id="4722846">.</span><span class="ident" id="4722847">scanWhile</span><span class="op" id="4722856">(</span><span class="ident" id="4722857">scanContinue</span><span class="op" id="4722869">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722873">item</span>&nbsp;<span class="op" id="4722878">:=</span>&nbsp;<span class="ident" id="4722881">d</span><span class="op" id="4722882">.</span><span class="ident" id="4722883">data</span><span class="op" id="4722887">[</span><span class="ident" id="4722888">start</span>&nbsp;<span class="op" id="4722894">:</span>&nbsp;<span class="ident" id="4722896">d</span><span class="op" id="4722897">.</span><span class="ident" id="4722898">off</span><span class="op" id="4722901">-</span><span class="num" id="4722902">1</span><span class="op" id="4722903">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722907">key</span><span class="op" id="4722910">,</span>&nbsp;<span class="ident" id="4722912">ok</span>&nbsp;<span class="op" id="4722915">:=</span>&nbsp;<span class="ident" id="4722918">unquoteBytes</span><span class="op" id="4722930">(</span><span class="ident" id="4722931">item</span><span class="op" id="4722935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4722939">if</span>&nbsp;<span class="op" id="4722942">!</span><span class="ident" id="4722943">ok</span>&nbsp;<span class="op" id="4722946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4722951">d</span><span class="op" id="4722952">.</span><span class="builtintype" id="4722953">error</span><span class="op" id="4722958">(</span><span class="ident" id="4722959">errPhase</span><span class="op" id="4722967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4722971">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4722976">//&nbsp;Figure&nbsp;out&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723020">var</span>&nbsp;<span class="ident" id="4723024">subv</span>&nbsp;<span class="ident" id="4723029">reflect</span><span class="op" id="4723036">.</span><span class="ident" id="4723037">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723045">destring</span>&nbsp;<span class="op" id="4723054">:=</span>&nbsp;<span class="ident" id="4723057">false</span>&nbsp;<span class="comment" id="4723063">//&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;wrapped&nbsp;in&nbsp;a&nbsp;string&nbsp;to&nbsp;be&nbsp;decoded&nbsp;first</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723130">if</span>&nbsp;<span class="ident" id="4723133">v</span><span class="op" id="4723134">.</span><span class="ident" id="4723135">Kind</span><span class="op" id="4723139">(</span><span class="op" id="4723140">)</span>&nbsp;<span class="op" id="4723142">==</span>&nbsp;<span class="ident" id="4723145">reflect</span><span class="op" id="4723152">.</span><span class="ident" id="4723153">Map</span>&nbsp;<span class="op" id="4723157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723162">elemType</span>&nbsp;<span class="op" id="4723171">:=</span>&nbsp;<span class="ident" id="4723174">v</span><span class="op" id="4723175">.</span><span class="ident" id="4723176">Type</span><span class="op" id="4723180">(</span><span class="op" id="4723181">)</span><span class="op" id="4723182">.</span><span class="ident" id="4723183">Elem</span><span class="op" id="4723187">(</span><span class="op" id="4723188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723193">if</span>&nbsp;<span class="op" id="4723196">!</span><span class="ident" id="4723197">mapElem</span><span class="op" id="4723204">.</span><span class="ident" id="4723205">IsValid</span><span class="op" id="4723212">(</span><span class="op" id="4723213">)</span>&nbsp;<span class="op" id="4723215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723221">mapElem</span>&nbsp;<span class="op" id="4723229">=</span>&nbsp;<span class="ident" id="4723231">reflect</span><span class="op" id="4723238">.</span><span class="ident" id="4723239">New</span><span class="op" id="4723242">(</span><span class="ident" id="4723243">elemType</span><span class="op" id="4723251">)</span><span class="op" id="4723252">.</span><span class="ident" id="4723253">Elem</span><span class="op" id="4723257">(</span><span class="op" id="4723258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723263">}</span>&nbsp;<span class="keyword" id="4723265">else</span>&nbsp;<span class="op" id="4723270">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723276">mapElem</span><span class="op" id="4723283">.</span><span class="ident" id="4723284">Set</span><span class="op" id="4723287">(</span><span class="ident" id="4723288">reflect</span><span class="op" id="4723295">.</span><span class="ident" id="4723296">Zero</span><span class="op" id="4723300">(</span><span class="ident" id="4723301">elemType</span><span class="op" id="4723309">)</span><span class="op" id="4723310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723320">subv</span>&nbsp;<span class="op" id="4723325">=</span>&nbsp;<span class="ident" id="4723327">mapElem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723337">}</span>&nbsp;<span class="keyword" id="4723339">else</span>&nbsp;<span class="op" id="4723344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723349">var</span>&nbsp;<span class="ident" id="4723353">f</span>&nbsp;<span class="op" id="4723355">*</span><span class="ident" id="4723356">field</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723365">fields</span>&nbsp;<span class="op" id="4723372">:=</span>&nbsp;<span class="ident" id="4723375">cachedTypeFields</span><span class="op" id="4723391">(</span><span class="ident" id="4723392">v</span><span class="op" id="4723393">.</span><span class="ident" id="4723394">Type</span><span class="op" id="4723398">(</span><span class="op" id="4723399">)</span><span class="op" id="4723400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723405">for</span>&nbsp;<span class="ident" id="4723409">i</span>&nbsp;<span class="op" id="4723411">:=</span>&nbsp;<span class="keyword" id="4723414">range</span>&nbsp;<span class="ident" id="4723420">fields</span>&nbsp;<span class="op" id="4723427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723433">ff</span>&nbsp;<span class="op" id="4723436">:=</span>&nbsp;<span class="op" id="4723439">&amp;</span><span class="ident" id="4723440">fields</span><span class="op" id="4723446">[</span><span class="ident" id="4723447">i</span><span class="op" id="4723448">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723454">if</span>&nbsp;<span class="ident" id="4723457">bytes</span><span class="op" id="4723462">.</span><span class="ident" id="4723463">Equal</span><span class="op" id="4723468">(</span><span class="ident" id="4723469">ff</span><span class="op" id="4723471">.</span><span class="ident" id="4723472">nameBytes</span><span class="op" id="4723481">,</span>&nbsp;<span class="ident" id="4723483">key</span><span class="op" id="4723486">)</span>&nbsp;<span class="op" id="4723488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723495">f</span>&nbsp;<span class="op" id="4723497">=</span>&nbsp;<span class="ident" id="4723499">ff</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723507">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723523">if</span>&nbsp;<span class="ident" id="4723526">f</span>&nbsp;<span class="op" id="4723528">==</span>&nbsp;<span class="ident" id="4723531">nil</span>&nbsp;<span class="op" id="4723535">&amp;&amp;</span>&nbsp;<span class="ident" id="4723538">ff</span><span class="op" id="4723540">.</span><span class="ident" id="4723541">equalFold</span><span class="op" id="4723550">(</span><span class="ident" id="4723551">ff</span><span class="op" id="4723553">.</span><span class="ident" id="4723554">nameBytes</span><span class="op" id="4723563">,</span>&nbsp;<span class="ident" id="4723565">key</span><span class="op" id="4723568">)</span>&nbsp;<span class="op" id="4723570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723577">f</span>&nbsp;<span class="op" id="4723579">=</span>&nbsp;<span class="ident" id="4723581">ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723588">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723598">if</span>&nbsp;<span class="ident" id="4723601">f</span>&nbsp;<span class="op" id="4723603">!=</span>&nbsp;<span class="ident" id="4723606">nil</span>&nbsp;<span class="op" id="4723610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723616">subv</span>&nbsp;<span class="op" id="4723621">=</span>&nbsp;<span class="ident" id="4723623">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723629">destring</span>&nbsp;<span class="op" id="4723638">=</span>&nbsp;<span class="ident" id="4723640">f</span><span class="op" id="4723641">.</span><span class="ident" id="4723642">quoted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723653">for</span>&nbsp;<span class="ident" id="4723657">_</span><span class="op" id="4723658">,</span>&nbsp;<span class="ident" id="4723660">i</span>&nbsp;<span class="op" id="4723662">:=</span>&nbsp;<span class="keyword" id="4723665">range</span>&nbsp;<span class="ident" id="4723671">f</span><span class="op" id="4723672">.</span><span class="ident" id="4723673">index</span>&nbsp;<span class="op" id="4723679">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723686">if</span>&nbsp;<span class="ident" id="4723689">subv</span><span class="op" id="4723693">.</span><span class="ident" id="4723694">Kind</span><span class="op" id="4723698">(</span><span class="op" id="4723699">)</span>&nbsp;<span class="op" id="4723701">==</span>&nbsp;<span class="ident" id="4723704">reflect</span><span class="op" id="4723711">.</span><span class="ident" id="4723712">Ptr</span>&nbsp;<span class="op" id="4723716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723724">if</span>&nbsp;<span class="ident" id="4723727">subv</span><span class="op" id="4723731">.</span><span class="ident" id="4723732">IsNil</span><span class="op" id="4723737">(</span><span class="op" id="4723738">)</span>&nbsp;<span class="op" id="4723740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723749">subv</span><span class="op" id="4723753">.</span><span class="ident" id="4723754">Set</span><span class="op" id="4723757">(</span><span class="ident" id="4723758">reflect</span><span class="op" id="4723765">.</span><span class="ident" id="4723766">New</span><span class="op" id="4723769">(</span><span class="ident" id="4723770">subv</span><span class="op" id="4723774">.</span><span class="ident" id="4723775">Type</span><span class="op" id="4723779">(</span><span class="op" id="4723780">)</span><span class="op" id="4723781">.</span><span class="ident" id="4723782">Elem</span><span class="op" id="4723786">(</span><span class="op" id="4723787">)</span><span class="op" id="4723788">)</span><span class="op" id="4723789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723805">subv</span>&nbsp;<span class="op" id="4723810">=</span>&nbsp;<span class="ident" id="4723812">subv</span><span class="op" id="4723816">.</span><span class="ident" id="4723817">Elem</span><span class="op" id="4723821">(</span><span class="op" id="4723822">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723836">subv</span>&nbsp;<span class="op" id="4723841">=</span>&nbsp;<span class="ident" id="4723843">subv</span><span class="op" id="4723847">.</span><span class="ident" id="4723848">Field</span><span class="op" id="4723853">(</span><span class="ident" id="4723854">i</span><span class="op" id="4723855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723870">}</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4723875">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723901">if</span>&nbsp;<span class="ident" id="4723904">op</span>&nbsp;<span class="op" id="4723907">==</span>&nbsp;<span class="ident" id="4723910">scanSkipSpace</span>&nbsp;<span class="op" id="4723924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723929">op</span>&nbsp;<span class="op" id="4723932">=</span>&nbsp;<span class="ident" id="4723934">d</span><span class="op" id="4723935">.</span><span class="ident" id="4723936">scanWhile</span><span class="op" id="4723945">(</span><span class="ident" id="4723946">scanSkipSpace</span><span class="op" id="4723959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4723963">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4723967">if</span>&nbsp;<span class="ident" id="4723970">op</span>&nbsp;<span class="op" id="4723973">!=</span>&nbsp;<span class="ident" id="4723976">scanObjectKey</span>&nbsp;<span class="op" id="4723990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4723995">d</span><span class="op" id="4723996">.</span><span class="builtintype" id="4723997">error</span><span class="op" id="4724002">(</span><span class="ident" id="4724003">errPhase</span><span class="op" id="4724011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4724020">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724037">if</span>&nbsp;<span class="ident" id="4724040">destring</span>&nbsp;<span class="op" id="4724049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724054">switch</span>&nbsp;<span class="ident" id="4724061">qv</span>&nbsp;<span class="op" id="4724064">:=</span>&nbsp;<span class="ident" id="4724067">d</span><span class="op" id="4724068">.</span><span class="ident" id="4724069">valueQuoted</span><span class="op" id="4724080">(</span><span class="op" id="4724081">)</span><span class="op" id="4724082">.</span><span class="op" id="4724083">(</span><span class="keyword" id="4724084">type</span><span class="op" id="4724088">)</span>&nbsp;<span class="op" id="4724090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724095">case</span>&nbsp;<span class="ident" id="4724100">nil</span><span class="op" id="4724103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724109">d</span><span class="op" id="4724110">.</span><span class="ident" id="4724111">literalStore</span><span class="op" id="4724123">(</span><span class="ident" id="4724124">nullLiteral</span><span class="op" id="4724135">,</span>&nbsp;<span class="ident" id="4724137">subv</span><span class="op" id="4724141">,</span>&nbsp;<span class="ident" id="4724143">false</span><span class="op" id="4724148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724153">case</span>&nbsp;<span class="builtintype" id="4724158">string</span><span class="op" id="4724164">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724170">d</span><span class="op" id="4724171">.</span><span class="ident" id="4724172">literalStore</span><span class="op" id="4724184">(</span><span class="op" id="4724185">[</span><span class="op" id="4724186">]</span><span class="builtintype" id="4724187">byte</span><span class="op" id="4724191">(</span><span class="ident" id="4724192">qv</span><span class="op" id="4724194">)</span><span class="op" id="4724195">,</span>&nbsp;<span class="ident" id="4724197">subv</span><span class="op" id="4724201">,</span>&nbsp;<span class="ident" id="4724203">true</span><span class="op" id="4724207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724212">default</span><span class="op" id="4724219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724225">d</span><span class="op" id="4724226">.</span><span class="ident" id="4724227">saveError</span><span class="op" id="4724236">(</span><span class="ident" id="4724237">fmt</span><span class="op" id="4724240">.</span><span class="ident" id="4724241">Errorf</span><span class="op" id="4724247">(</span><span class="string" id="4724248">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;unquoted&nbsp;value&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4724333">,</span>&nbsp;<span class="ident" id="4724335">item</span><span class="op" id="4724339">,</span>&nbsp;<span class="ident" id="4724341">v</span><span class="op" id="4724342">.</span><span class="ident" id="4724343">Type</span><span class="op" id="4724347">(</span><span class="op" id="4724348">)</span><span class="op" id="4724349">)</span><span class="op" id="4724350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724359">}</span>&nbsp;<span class="keyword" id="4724361">else</span>&nbsp;<span class="op" id="4724366">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724371">d</span><span class="op" id="4724372">.</span><span class="ident" id="4724373">value</span><span class="op" id="4724378">(</span><span class="ident" id="4724379">subv</span><span class="op" id="4724383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4724392">//&nbsp;Write&nbsp;value&nbsp;back&nbsp;to&nbsp;map;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4724422">//&nbsp;if&nbsp;using&nbsp;struct,&nbsp;subv&nbsp;points&nbsp;into&nbsp;struct&nbsp;already.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724477">if</span>&nbsp;<span class="ident" id="4724480">v</span><span class="op" id="4724481">.</span><span class="ident" id="4724482">Kind</span><span class="op" id="4724486">(</span><span class="op" id="4724487">)</span>&nbsp;<span class="op" id="4724489">==</span>&nbsp;<span class="ident" id="4724492">reflect</span><span class="op" id="4724499">.</span><span class="ident" id="4724500">Map</span>&nbsp;<span class="op" id="4724504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724509">kv</span>&nbsp;<span class="op" id="4724512">:=</span>&nbsp;<span class="ident" id="4724515">reflect</span><span class="op" id="4724522">.</span><span class="ident" id="4724523">ValueOf</span><span class="op" id="4724530">(</span><span class="ident" id="4724531">key</span><span class="op" id="4724534">)</span><span class="op" id="4724535">.</span><span class="ident" id="4724536">Convert</span><span class="op" id="4724543">(</span><span class="ident" id="4724544">v</span><span class="op" id="4724545">.</span><span class="ident" id="4724546">Type</span><span class="op" id="4724550">(</span><span class="op" id="4724551">)</span><span class="op" id="4724552">.</span><span class="ident" id="4724553">Key</span><span class="op" id="4724556">(</span><span class="op" id="4724557">)</span><span class="op" id="4724558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724563">v</span><span class="op" id="4724564">.</span><span class="ident" id="4724565">SetMapIndex</span><span class="op" id="4724576">(</span><span class="ident" id="4724577">kv</span><span class="op" id="4724579">,</span>&nbsp;<span class="ident" id="4724581">subv</span><span class="op" id="4724585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4724594">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724626">op</span>&nbsp;<span class="op" id="4724629">=</span>&nbsp;<span class="ident" id="4724631">d</span><span class="op" id="4724632">.</span><span class="ident" id="4724633">scanWhile</span><span class="op" id="4724642">(</span><span class="ident" id="4724643">scanSkipSpace</span><span class="op" id="4724656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724660">if</span>&nbsp;<span class="ident" id="4724663">op</span>&nbsp;<span class="op" id="4724666">==</span>&nbsp;<span class="ident" id="4724669">scanEndObject</span>&nbsp;<span class="op" id="4724683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724688">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724696">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4724700">if</span>&nbsp;<span class="ident" id="4724703">op</span>&nbsp;<span class="op" id="4724706">!=</span>&nbsp;<span class="ident" id="4724709">scanObjectValue</span>&nbsp;<span class="op" id="4724725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4724730">d</span><span class="op" id="4724731">.</span><span class="builtintype" id="4724732">error</span><span class="op" id="4724737">(</span><span class="ident" id="4724738">errPhase</span><span class="op" id="4724746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4724753">}</span><br>
<span class="lineno"></span><span class="op" id="4724755">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="comment" id="4724758">//&nbsp;literal&nbsp;consumes&nbsp;a&nbsp;literal&nbsp;from&nbsp;d.data[d.off-1:],&nbsp;decoding&nbsp;into&nbsp;the&nbsp;value&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4724838">//&nbsp;The&nbsp;first&nbsp;byte&nbsp;of&nbsp;the&nbsp;literal&nbsp;has&nbsp;been&nbsp;read&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="4724893">//&nbsp;(that&#39;s&nbsp;how&nbsp;the&nbsp;caller&nbsp;knows&nbsp;it&#39;s&nbsp;a&nbsp;literal).</span><br>
<span class="lineno"></span><span class="keyword" id="4724942">func</span>&nbsp;<span class="op" id="4724947">(</span><span class="ident" id="4724948">d</span>&nbsp;<span class="op" id="4724950">*</span><span class="ident" id="4724951">decodeState</span><span class="op" id="4724962">)</span>&nbsp;<span class="ident" id="4724964">literal</span><span class="op" id="4724971">(</span><span class="ident" id="4724972">v</span>&nbsp;<span class="ident" id="4724974">reflect</span><span class="op" id="4724981">.</span><span class="ident" id="4724982">Value</span><span class="op" id="4724987">)</span>&nbsp;<span class="op" id="4724989">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4724992">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725050">start</span>&nbsp;<span class="op" id="4725056">:=</span>&nbsp;<span class="ident" id="4725059">d</span><span class="op" id="4725060">.</span><span class="ident" id="4725061">off</span>&nbsp;<span class="op" id="4725065">-</span>&nbsp;<span class="num" id="4725067">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725070">op</span>&nbsp;<span class="op" id="4725073">:=</span>&nbsp;<span class="ident" id="4725076">d</span><span class="op" id="4725077">.</span><span class="ident" id="4725078">scanWhile</span><span class="op" id="4725087">(</span><span class="ident" id="4725088">scanContinue</span><span class="op" id="4725100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4725104">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725145">d</span><span class="op" id="4725146">.</span><span class="ident" id="4725147">off</span><span class="op" id="4725150">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725154">d</span><span class="op" id="4725155">.</span><span class="ident" id="4725156">scan</span><span class="op" id="4725160">.</span><span class="ident" id="4725161">undo</span><span class="op" id="4725165">(</span><span class="ident" id="4725166">op</span><span class="op" id="4725168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725172">d</span><span class="op" id="4725173">.</span><span class="ident" id="4725174">literalStore</span><span class="op" id="4725186">(</span><span class="ident" id="4725187">d</span><span class="op" id="4725188">.</span><span class="ident" id="4725189">data</span><span class="op" id="4725193">[</span><span class="ident" id="4725194">start</span><span class="op" id="4725199">:</span><span class="ident" id="4725200">d</span><span class="op" id="4725201">.</span><span class="ident" id="4725202">off</span><span class="op" id="4725205">]</span><span class="op" id="4725206">,</span>&nbsp;<span class="ident" id="4725208">v</span><span class="op" id="4725209">,</span>&nbsp;<span class="ident" id="4725211">false</span><span class="op" id="4725216">)</span><br>
<span class="lineno"></span><span class="op" id="4725218">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="4725221">//&nbsp;convertNumber&nbsp;converts&nbsp;the&nbsp;number&nbsp;literal&nbsp;s&nbsp;to&nbsp;a&nbsp;float64&nbsp;or&nbsp;a&nbsp;Number</span><br>
<span class="lineno"></span><span class="comment" id="4725293">//&nbsp;depending&nbsp;on&nbsp;the&nbsp;setting&nbsp;of&nbsp;d.useNumber.</span><br>
<span class="lineno"></span><span class="keyword" id="4725337">func</span>&nbsp;<span class="op" id="4725342">(</span><span class="ident" id="4725343">d</span>&nbsp;<span class="op" id="4725345">*</span><span class="ident" id="4725346">decodeState</span><span class="op" id="4725357">)</span>&nbsp;<span class="ident" id="4725359">convertNumber</span><span class="op" id="4725372">(</span><span class="ident" id="4725373">s</span>&nbsp;<span class="builtintype" id="4725375">string</span><span class="op" id="4725381">)</span>&nbsp;<span class="op" id="4725383">(</span><span class="keyword" id="4725384">interface</span><span class="op" id="4725393">{</span><span class="op" id="4725394">}</span><span class="op" id="4725395">,</span>&nbsp;<span class="builtintype" id="4725397">error</span><span class="op" id="4725402">)</span>&nbsp;<span class="op" id="4725404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725407">if</span>&nbsp;<span class="ident" id="4725410">d</span><span class="op" id="4725411">.</span><span class="ident" id="4725412">useNumber</span>&nbsp;<span class="op" id="4725422">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725426">return</span>&nbsp;<span class="ident" id="4725433">Number</span><span class="op" id="4725439">(</span><span class="ident" id="4725440">s</span><span class="op" id="4725441">)</span><span class="op" id="4725442">,</span>&nbsp;<span class="ident" id="4725444">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4725449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4725452">f</span><span class="op" id="4725453">,</span>&nbsp;<span class="ident" id="4725455">err</span>&nbsp;<span class="op" id="4725459">:=</span>&nbsp;<span class="ident" id="4725462">strconv</span><span class="op" id="4725469">.</span><span class="ident" id="4725470">ParseFloat</span><span class="op" id="4725480">(</span><span class="ident" id="4725481">s</span><span class="op" id="4725482">,</span>&nbsp;<span class="num" id="4725484">64</span><span class="op" id="4725486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725489">if</span>&nbsp;<span class="ident" id="4725492">err</span>&nbsp;<span class="op" id="4725496">!=</span>&nbsp;<span class="ident" id="4725499">nil</span>&nbsp;<span class="op" id="4725503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725507">return</span>&nbsp;<span class="ident" id="4725514">nil</span><span class="op" id="4725517">,</span>&nbsp;<span class="op" id="4725519">&amp;</span><span class="ident" id="4725520">UnmarshalTypeError</span><span class="op" id="4725538">{</span><span class="string" id="4725539">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4725549">+</span>&nbsp;<span class="ident" id="4725551">s</span><span class="op" id="4725552">,</span>&nbsp;<span class="ident" id="4725554">reflect</span><span class="op" id="4725561">.</span><span class="ident" id="4725562">TypeOf</span><span class="op" id="4725568">(</span><span class="num" id="4725569">0.0</span><span class="op" id="4725572">)</span><span class="op" id="4725573">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4725576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725579">return</span>&nbsp;<span class="ident" id="4725586">f</span><span class="op" id="4725587">,</span>&nbsp;<span class="ident" id="4725589">nil</span><br>
<span class="lineno"></span><span class="op" id="4725593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4725596">var</span>&nbsp;<span class="ident" id="4725600">numberType</span>&nbsp;<span class="op" id="4725611">=</span>&nbsp;<span class="ident" id="4725613">reflect</span><span class="op" id="4725620">.</span><span class="ident" id="4725621">TypeOf</span><span class="op" id="4725627">(</span><span class="ident" id="4725628">Number</span><span class="op" id="4725634">(</span><span class="string" id="4725635">&#34;&#34;</span><span class="op" id="4725637">)</span><span class="op" id="4725638">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span><span class="comment" id="4725641">//&nbsp;literalStore&nbsp;decodes&nbsp;a&nbsp;literal&nbsp;stored&nbsp;in&nbsp;item&nbsp;into&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4725698">//</span><br>
<span class="lineno"></span><span class="comment" id="4725701">//&nbsp;fromQuoted&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;literal&nbsp;came&nbsp;from&nbsp;unwrapping&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4725769">//&nbsp;string&nbsp;from&nbsp;the&nbsp;&#34;,string&#34;&nbsp;struct&nbsp;tag&nbsp;option.&nbsp;this&nbsp;is&nbsp;used&nbsp;only&nbsp;to</span><br>
<span class="lineno">660</span><span class="comment" id="4725838">//&nbsp;produce&nbsp;more&nbsp;helpful&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="4725878">func</span>&nbsp;<span class="op" id="4725883">(</span><span class="ident" id="4725884">d</span>&nbsp;<span class="op" id="4725886">*</span><span class="ident" id="4725887">decodeState</span><span class="op" id="4725898">)</span>&nbsp;<span class="ident" id="4725900">literalStore</span><span class="op" id="4725912">(</span><span class="ident" id="4725913">item</span>&nbsp;<span class="op" id="4725918">[</span><span class="op" id="4725919">]</span><span class="builtintype" id="4725920">byte</span><span class="op" id="4725924">,</span>&nbsp;<span class="ident" id="4725926">v</span>&nbsp;<span class="ident" id="4725928">reflect</span><span class="op" id="4725935">.</span><span class="ident" id="4725936">Value</span><span class="op" id="4725941">,</span>&nbsp;<span class="ident" id="4725943">fromQuoted</span>&nbsp;<span class="builtintype" id="4725954">bool</span><span class="op" id="4725958">)</span>&nbsp;<span class="op" id="4725960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4725963">//&nbsp;Check&nbsp;for&nbsp;unmarshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4725990">if</span>&nbsp;<span class="builtinfunc" id="4725993">len</span><span class="op" id="4725996">(</span><span class="ident" id="4725997">item</span><span class="op" id="4726001">)</span>&nbsp;<span class="op" id="4726003">==</span>&nbsp;<span class="num" id="4726006">0</span>&nbsp;<span class="op" id="4726008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4726012">//Empty&nbsp;string&nbsp;given</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726035">d</span><span class="op" id="4726036">.</span><span class="ident" id="4726037">saveError</span><span class="op" id="4726046">(</span><span class="ident" id="4726047">fmt</span><span class="op" id="4726050">.</span><span class="ident" id="4726051">Errorf</span><span class="op" id="4726057">(</span><span class="string" id="4726058">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4726131">,</span>&nbsp;<span class="ident" id="4726133">item</span><span class="op" id="4726137">,</span>&nbsp;<span class="ident" id="4726139">v</span><span class="op" id="4726140">.</span><span class="ident" id="4726141">Type</span><span class="op" id="4726145">(</span><span class="op" id="4726146">)</span><span class="op" id="4726147">)</span><span class="op" id="4726148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726152">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726163">wantptr</span>&nbsp;<span class="op" id="4726171">:=</span>&nbsp;<span class="ident" id="4726174">item</span><span class="op" id="4726178">[</span><span class="num" id="4726179">0</span><span class="op" id="4726180">]</span>&nbsp;<span class="op" id="4726182">==</span>&nbsp;<span class="string" id="4726185">&#39;n&#39;</span>&nbsp;<span class="comment" id="4726189">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726198">u</span><span class="op" id="4726199">,</span>&nbsp;<span class="ident" id="4726201">ut</span><span class="op" id="4726203">,</span>&nbsp;<span class="ident" id="4726205">pv</span>&nbsp;<span class="op" id="4726208">:=</span>&nbsp;<span class="ident" id="4726211">d</span><span class="op" id="4726212">.</span><span class="ident" id="4726213">indirect</span><span class="op" id="4726221">(</span><span class="ident" id="4726222">v</span><span class="op" id="4726223">,</span>&nbsp;<span class="ident" id="4726225">wantptr</span><span class="op" id="4726232">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726235">if</span>&nbsp;<span class="ident" id="4726238">u</span>&nbsp;<span class="op" id="4726240">!=</span>&nbsp;<span class="ident" id="4726243">nil</span>&nbsp;<span class="op" id="4726247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726251">err</span>&nbsp;<span class="op" id="4726255">:=</span>&nbsp;<span class="ident" id="4726258">u</span><span class="op" id="4726259">.</span><span class="ident" id="4726260">UnmarshalJSON</span><span class="op" id="4726273">(</span><span class="ident" id="4726274">item</span><span class="op" id="4726278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726282">if</span>&nbsp;<span class="ident" id="4726285">err</span>&nbsp;<span class="op" id="4726289">!=</span>&nbsp;<span class="ident" id="4726292">nil</span>&nbsp;<span class="op" id="4726296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726301">d</span><span class="op" id="4726302">.</span><span class="builtintype" id="4726303">error</span><span class="op" id="4726308">(</span><span class="ident" id="4726309">err</span><span class="op" id="4726312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726316">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726320">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726331">if</span>&nbsp;<span class="ident" id="4726334">ut</span>&nbsp;<span class="op" id="4726337">!=</span>&nbsp;<span class="ident" id="4726340">nil</span>&nbsp;<span class="op" id="4726344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726348">if</span>&nbsp;<span class="ident" id="4726351">item</span><span class="op" id="4726355">[</span><span class="num" id="4726356">0</span><span class="op" id="4726357">]</span>&nbsp;<span class="op" id="4726359">!=</span>&nbsp;<span class="string" id="4726362">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4726366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726371">if</span>&nbsp;<span class="ident" id="4726374">fromQuoted</span>&nbsp;<span class="op" id="4726385">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726391">d</span><span class="op" id="4726392">.</span><span class="ident" id="4726393">saveError</span><span class="op" id="4726402">(</span><span class="ident" id="4726403">fmt</span><span class="op" id="4726406">.</span><span class="ident" id="4726407">Errorf</span><span class="op" id="4726413">(</span><span class="string" id="4726414">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4726487">,</span>&nbsp;<span class="ident" id="4726489">item</span><span class="op" id="4726493">,</span>&nbsp;<span class="ident" id="4726495">v</span><span class="op" id="4726496">.</span><span class="ident" id="4726497">Type</span><span class="op" id="4726501">(</span><span class="op" id="4726502">)</span><span class="op" id="4726503">)</span><span class="op" id="4726504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726509">}</span>&nbsp;<span class="keyword" id="4726511">else</span>&nbsp;<span class="op" id="4726516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726522">d</span><span class="op" id="4726523">.</span><span class="ident" id="4726524">saveError</span><span class="op" id="4726533">(</span><span class="op" id="4726534">&amp;</span><span class="ident" id="4726535">UnmarshalTypeError</span><span class="op" id="4726553">{</span><span class="string" id="4726554">&#34;string&#34;</span><span class="op" id="4726562">,</span>&nbsp;<span class="ident" id="4726564">v</span><span class="op" id="4726565">.</span><span class="ident" id="4726566">Type</span><span class="op" id="4726570">(</span><span class="op" id="4726571">)</span><span class="op" id="4726572">}</span><span class="op" id="4726573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726582">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726586">s</span><span class="op" id="4726587">,</span>&nbsp;<span class="ident" id="4726589">ok</span>&nbsp;<span class="op" id="4726592">:=</span>&nbsp;<span class="ident" id="4726595">unquoteBytes</span><span class="op" id="4726607">(</span><span class="ident" id="4726608">item</span><span class="op" id="4726612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726616">if</span>&nbsp;<span class="op" id="4726619">!</span><span class="ident" id="4726620">ok</span>&nbsp;<span class="op" id="4726623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726628">if</span>&nbsp;<span class="ident" id="4726631">fromQuoted</span>&nbsp;<span class="op" id="4726642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726648">d</span><span class="op" id="4726649">.</span><span class="builtintype" id="4726650">error</span><span class="op" id="4726655">(</span><span class="ident" id="4726656">fmt</span><span class="op" id="4726659">.</span><span class="ident" id="4726660">Errorf</span><span class="op" id="4726666">(</span><span class="string" id="4726667">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4726740">,</span>&nbsp;<span class="ident" id="4726742">item</span><span class="op" id="4726746">,</span>&nbsp;<span class="ident" id="4726748">v</span><span class="op" id="4726749">.</span><span class="ident" id="4726750">Type</span><span class="op" id="4726754">(</span><span class="op" id="4726755">)</span><span class="op" id="4726756">)</span><span class="op" id="4726757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726762">}</span>&nbsp;<span class="keyword" id="4726764">else</span>&nbsp;<span class="op" id="4726769">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726775">d</span><span class="op" id="4726776">.</span><span class="builtintype" id="4726777">error</span><span class="op" id="4726782">(</span><span class="ident" id="4726783">errPhase</span><span class="op" id="4726791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726804">err</span>&nbsp;<span class="op" id="4726808">:=</span>&nbsp;<span class="ident" id="4726811">ut</span><span class="op" id="4726813">.</span><span class="ident" id="4726814">UnmarshalText</span><span class="op" id="4726827">(</span><span class="ident" id="4726828">s</span><span class="op" id="4726829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726833">if</span>&nbsp;<span class="ident" id="4726836">err</span>&nbsp;<span class="op" id="4726840">!=</span>&nbsp;<span class="ident" id="4726843">nil</span>&nbsp;<span class="op" id="4726847">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726852">d</span><span class="op" id="4726853">.</span><span class="builtintype" id="4726854">error</span><span class="op" id="4726859">(</span><span class="ident" id="4726860">err</span><span class="op" id="4726863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726871">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4726879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4726883">v</span>&nbsp;<span class="op" id="4726885">=</span>&nbsp;<span class="ident" id="4726887">pv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726892">switch</span>&nbsp;<span class="ident" id="4726899">c</span>&nbsp;<span class="op" id="4726901">:=</span>&nbsp;<span class="ident" id="4726904">item</span><span class="op" id="4726908">[</span><span class="num" id="4726909">0</span><span class="op" id="4726910">]</span><span class="op" id="4726911">;</span>&nbsp;<span class="ident" id="4726913">c</span>&nbsp;<span class="op" id="4726915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726918">case</span>&nbsp;<span class="string" id="4726923">&#39;n&#39;</span><span class="op" id="4726926">:</span>&nbsp;<span class="comment" id="4726928">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726938">switch</span>&nbsp;<span class="ident" id="4726945">v</span><span class="op" id="4726946">.</span><span class="ident" id="4726947">Kind</span><span class="op" id="4726951">(</span><span class="op" id="4726952">)</span>&nbsp;<span class="op" id="4726954">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4726958">case</span>&nbsp;<span class="ident" id="4726963">reflect</span><span class="op" id="4726970">.</span><span class="ident" id="4726971">Interface</span><span class="op" id="4726980">,</span>&nbsp;<span class="ident" id="4726982">reflect</span><span class="op" id="4726989">.</span><span class="ident" id="4726990">Ptr</span><span class="op" id="4726993">,</span>&nbsp;<span class="ident" id="4726995">reflect</span><span class="op" id="4727002">.</span><span class="ident" id="4727003">Map</span><span class="op" id="4727006">,</span>&nbsp;<span class="ident" id="4727008">reflect</span><span class="op" id="4727015">.</span><span class="ident" id="4727016">Slice</span><span class="op" id="4727021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727026">v</span><span class="op" id="4727027">.</span><span class="ident" id="4727028">Set</span><span class="op" id="4727031">(</span><span class="ident" id="4727032">reflect</span><span class="op" id="4727039">.</span><span class="ident" id="4727040">Zero</span><span class="op" id="4727044">(</span><span class="ident" id="4727045">v</span><span class="op" id="4727046">.</span><span class="ident" id="4727047">Type</span><span class="op" id="4727051">(</span><span class="op" id="4727052">)</span><span class="op" id="4727053">)</span><span class="op" id="4727054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4727059">//&nbsp;otherwise,&nbsp;ignore&nbsp;null&nbsp;for&nbsp;primitives/string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727112">case</span>&nbsp;<span class="string" id="4727117">&#39;t&#39;</span><span class="op" id="4727120">,</span>&nbsp;<span class="string" id="4727122">&#39;f&#39;</span><span class="op" id="4727125">:</span>&nbsp;<span class="comment" id="4727127">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727144">value</span>&nbsp;<span class="op" id="4727150">:=</span>&nbsp;<span class="ident" id="4727153">c</span>&nbsp;<span class="op" id="4727155">==</span>&nbsp;<span class="string" id="4727158">&#39;t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727164">switch</span>&nbsp;<span class="ident" id="4727171">v</span><span class="op" id="4727172">.</span><span class="ident" id="4727173">Kind</span><span class="op" id="4727177">(</span><span class="op" id="4727178">)</span>&nbsp;<span class="op" id="4727180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727184">default</span><span class="op" id="4727191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727196">if</span>&nbsp;<span class="ident" id="4727199">fromQuoted</span>&nbsp;<span class="op" id="4727210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727216">d</span><span class="op" id="4727217">.</span><span class="ident" id="4727218">saveError</span><span class="op" id="4727227">(</span><span class="ident" id="4727228">fmt</span><span class="op" id="4727231">.</span><span class="ident" id="4727232">Errorf</span><span class="op" id="4727238">(</span><span class="string" id="4727239">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4727312">,</span>&nbsp;<span class="ident" id="4727314">item</span><span class="op" id="4727318">,</span>&nbsp;<span class="ident" id="4727320">v</span><span class="op" id="4727321">.</span><span class="ident" id="4727322">Type</span><span class="op" id="4727326">(</span><span class="op" id="4727327">)</span><span class="op" id="4727328">)</span><span class="op" id="4727329">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727334">}</span>&nbsp;<span class="keyword" id="4727336">else</span>&nbsp;<span class="op" id="4727341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727347">d</span><span class="op" id="4727348">.</span><span class="ident" id="4727349">saveError</span><span class="op" id="4727358">(</span><span class="op" id="4727359">&amp;</span><span class="ident" id="4727360">UnmarshalTypeError</span><span class="op" id="4727378">{</span><span class="string" id="4727379">&#34;bool&#34;</span><span class="op" id="4727385">,</span>&nbsp;<span class="ident" id="4727387">v</span><span class="op" id="4727388">.</span><span class="ident" id="4727389">Type</span><span class="op" id="4727393">(</span><span class="op" id="4727394">)</span><span class="op" id="4727395">}</span><span class="op" id="4727396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727405">case</span>&nbsp;<span class="ident" id="4727410">reflect</span><span class="op" id="4727417">.</span><span class="ident" id="4727418">Bool</span><span class="op" id="4727422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727427">v</span><span class="op" id="4727428">.</span><span class="ident" id="4727429">SetBool</span><span class="op" id="4727436">(</span><span class="ident" id="4727437">value</span><span class="op" id="4727442">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727446">case</span>&nbsp;<span class="ident" id="4727451">reflect</span><span class="op" id="4727458">.</span><span class="ident" id="4727459">Interface</span><span class="op" id="4727468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727473">if</span>&nbsp;<span class="ident" id="4727476">v</span><span class="op" id="4727477">.</span><span class="ident" id="4727478">NumMethod</span><span class="op" id="4727487">(</span><span class="op" id="4727488">)</span>&nbsp;<span class="op" id="4727490">==</span>&nbsp;<span class="num" id="4727493">0</span>&nbsp;<span class="op" id="4727495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727501">v</span><span class="op" id="4727502">.</span><span class="ident" id="4727503">Set</span><span class="op" id="4727506">(</span><span class="ident" id="4727507">reflect</span><span class="op" id="4727514">.</span><span class="ident" id="4727515">ValueOf</span><span class="op" id="4727522">(</span><span class="ident" id="4727523">value</span><span class="op" id="4727528">)</span><span class="op" id="4727529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727534">}</span>&nbsp;<span class="keyword" id="4727536">else</span>&nbsp;<span class="op" id="4727541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727547">d</span><span class="op" id="4727548">.</span><span class="ident" id="4727549">saveError</span><span class="op" id="4727558">(</span><span class="op" id="4727559">&amp;</span><span class="ident" id="4727560">UnmarshalTypeError</span><span class="op" id="4727578">{</span><span class="string" id="4727579">&#34;bool&#34;</span><span class="op" id="4727585">,</span>&nbsp;<span class="ident" id="4727587">v</span><span class="op" id="4727588">.</span><span class="ident" id="4727589">Type</span><span class="op" id="4727593">(</span><span class="op" id="4727594">)</span><span class="op" id="4727595">}</span><span class="op" id="4727596">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727609">case</span>&nbsp;<span class="string" id="4727614">&#39;&#34;&#39;</span><span class="op" id="4727617">:</span>&nbsp;<span class="comment" id="4727619">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727631">s</span><span class="op" id="4727632">,</span>&nbsp;<span class="ident" id="4727634">ok</span>&nbsp;<span class="op" id="4727637">:=</span>&nbsp;<span class="ident" id="4727640">unquoteBytes</span><span class="op" id="4727652">(</span><span class="ident" id="4727653">item</span><span class="op" id="4727657">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727661">if</span>&nbsp;<span class="op" id="4727664">!</span><span class="ident" id="4727665">ok</span>&nbsp;<span class="op" id="4727668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727673">if</span>&nbsp;<span class="ident" id="4727676">fromQuoted</span>&nbsp;<span class="op" id="4727687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727693">d</span><span class="op" id="4727694">.</span><span class="builtintype" id="4727695">error</span><span class="op" id="4727700">(</span><span class="ident" id="4727701">fmt</span><span class="op" id="4727704">.</span><span class="ident" id="4727705">Errorf</span><span class="op" id="4727711">(</span><span class="string" id="4727712">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4727785">,</span>&nbsp;<span class="ident" id="4727787">item</span><span class="op" id="4727791">,</span>&nbsp;<span class="ident" id="4727793">v</span><span class="op" id="4727794">.</span><span class="ident" id="4727795">Type</span><span class="op" id="4727799">(</span><span class="op" id="4727800">)</span><span class="op" id="4727801">)</span><span class="op" id="4727802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727807">}</span>&nbsp;<span class="keyword" id="4727809">else</span>&nbsp;<span class="op" id="4727814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727820">d</span><span class="op" id="4727821">.</span><span class="builtintype" id="4727822">error</span><span class="op" id="4727827">(</span><span class="ident" id="4727828">errPhase</span><span class="op" id="4727836">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4727845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727849">switch</span>&nbsp;<span class="ident" id="4727856">v</span><span class="op" id="4727857">.</span><span class="ident" id="4727858">Kind</span><span class="op" id="4727862">(</span><span class="op" id="4727863">)</span>&nbsp;<span class="op" id="4727865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727869">default</span><span class="op" id="4727876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727881">d</span><span class="op" id="4727882">.</span><span class="ident" id="4727883">saveError</span><span class="op" id="4727892">(</span><span class="op" id="4727893">&amp;</span><span class="ident" id="4727894">UnmarshalTypeError</span><span class="op" id="4727912">{</span><span class="string" id="4727913">&#34;string&#34;</span><span class="op" id="4727921">,</span>&nbsp;<span class="ident" id="4727923">v</span><span class="op" id="4727924">.</span><span class="ident" id="4727925">Type</span><span class="op" id="4727929">(</span><span class="op" id="4727930">)</span><span class="op" id="4727931">}</span><span class="op" id="4727932">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727936">case</span>&nbsp;<span class="ident" id="4727941">reflect</span><span class="op" id="4727948">.</span><span class="ident" id="4727949">Slice</span><span class="op" id="4727954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4727959">if</span>&nbsp;<span class="ident" id="4727962">v</span><span class="op" id="4727963">.</span><span class="ident" id="4727964">Type</span><span class="op" id="4727968">(</span><span class="op" id="4727969">)</span>&nbsp;<span class="op" id="4727971">!=</span>&nbsp;<span class="ident" id="4727974">byteSliceType</span>&nbsp;<span class="op" id="4727988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4727994">d</span><span class="op" id="4727995">.</span><span class="ident" id="4727996">saveError</span><span class="op" id="4728005">(</span><span class="op" id="4728006">&amp;</span><span class="ident" id="4728007">UnmarshalTypeError</span><span class="op" id="4728025">{</span><span class="string" id="4728026">&#34;string&#34;</span><span class="op" id="4728034">,</span>&nbsp;<span class="ident" id="4728036">v</span><span class="op" id="4728037">.</span><span class="ident" id="4728038">Type</span><span class="op" id="4728042">(</span><span class="op" id="4728043">)</span><span class="op" id="4728044">}</span><span class="op" id="4728045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728051">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728060">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728065">b</span>&nbsp;<span class="op" id="4728067">:=</span>&nbsp;<span class="builtinfunc" id="4728070">make</span><span class="op" id="4728074">(</span><span class="op" id="4728075">[</span><span class="op" id="4728076">]</span><span class="builtintype" id="4728077">byte</span><span class="op" id="4728081">,</span>&nbsp;<span class="ident" id="4728083">base64</span><span class="op" id="4728089">.</span><span class="ident" id="4728090">StdEncoding</span><span class="op" id="4728101">.</span><span class="ident" id="4728102">DecodedLen</span><span class="op" id="4728112">(</span><span class="builtinfunc" id="4728113">len</span><span class="op" id="4728116">(</span><span class="ident" id="4728117">s</span><span class="op" id="4728118">)</span><span class="op" id="4728119">)</span><span class="op" id="4728120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728125">n</span><span class="op" id="4728126">,</span>&nbsp;<span class="ident" id="4728128">err</span>&nbsp;<span class="op" id="4728132">:=</span>&nbsp;<span class="ident" id="4728135">base64</span><span class="op" id="4728141">.</span><span class="ident" id="4728142">StdEncoding</span><span class="op" id="4728153">.</span><span class="ident" id="4728154">Decode</span><span class="op" id="4728160">(</span><span class="ident" id="4728161">b</span><span class="op" id="4728162">,</span>&nbsp;<span class="ident" id="4728164">s</span><span class="op" id="4728165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728170">if</span>&nbsp;<span class="ident" id="4728173">err</span>&nbsp;<span class="op" id="4728177">!=</span>&nbsp;<span class="ident" id="4728180">nil</span>&nbsp;<span class="op" id="4728184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728190">d</span><span class="op" id="4728191">.</span><span class="ident" id="4728192">saveError</span><span class="op" id="4728201">(</span><span class="ident" id="4728202">err</span><span class="op" id="4728205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728211">break</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728225">v</span><span class="op" id="4728226">.</span><span class="ident" id="4728227">Set</span><span class="op" id="4728230">(</span><span class="ident" id="4728231">reflect</span><span class="op" id="4728238">.</span><span class="ident" id="4728239">ValueOf</span><span class="op" id="4728246">(</span><span class="ident" id="4728247">b</span><span class="op" id="4728248">[</span><span class="num" id="4728249">0</span><span class="op" id="4728250">:</span><span class="ident" id="4728251">n</span><span class="op" id="4728252">]</span><span class="op" id="4728253">)</span><span class="op" id="4728254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728258">case</span>&nbsp;<span class="ident" id="4728263">reflect</span><span class="op" id="4728270">.</span><span class="ident" id="4728271">String</span><span class="op" id="4728277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728282">v</span><span class="op" id="4728283">.</span><span class="ident" id="4728284">SetString</span><span class="op" id="4728293">(</span><span class="builtintype" id="4728294">string</span><span class="op" id="4728300">(</span><span class="ident" id="4728301">s</span><span class="op" id="4728302">)</span><span class="op" id="4728303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728307">case</span>&nbsp;<span class="ident" id="4728312">reflect</span><span class="op" id="4728319">.</span><span class="ident" id="4728320">Interface</span><span class="op" id="4728329">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728334">if</span>&nbsp;<span class="ident" id="4728337">v</span><span class="op" id="4728338">.</span><span class="ident" id="4728339">NumMethod</span><span class="op" id="4728348">(</span><span class="op" id="4728349">)</span>&nbsp;<span class="op" id="4728351">==</span>&nbsp;<span class="num" id="4728354">0</span>&nbsp;<span class="op" id="4728356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728362">v</span><span class="op" id="4728363">.</span><span class="ident" id="4728364">Set</span><span class="op" id="4728367">(</span><span class="ident" id="4728368">reflect</span><span class="op" id="4728375">.</span><span class="ident" id="4728376">ValueOf</span><span class="op" id="4728383">(</span><span class="builtintype" id="4728384">string</span><span class="op" id="4728390">(</span><span class="ident" id="4728391">s</span><span class="op" id="4728392">)</span><span class="op" id="4728393">)</span><span class="op" id="4728394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728399">}</span>&nbsp;<span class="keyword" id="4728401">else</span>&nbsp;<span class="op" id="4728406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728412">d</span><span class="op" id="4728413">.</span><span class="ident" id="4728414">saveError</span><span class="op" id="4728423">(</span><span class="op" id="4728424">&amp;</span><span class="ident" id="4728425">UnmarshalTypeError</span><span class="op" id="4728443">{</span><span class="string" id="4728444">&#34;string&#34;</span><span class="op" id="4728452">,</span>&nbsp;<span class="ident" id="4728454">v</span><span class="op" id="4728455">.</span><span class="ident" id="4728456">Type</span><span class="op" id="4728460">(</span><span class="op" id="4728461">)</span><span class="op" id="4728462">}</span><span class="op" id="4728463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728468">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728476">default</span><span class="op" id="4728483">:</span>&nbsp;<span class="comment" id="4728485">//&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728497">if</span>&nbsp;<span class="ident" id="4728500">c</span>&nbsp;<span class="op" id="4728502">!=</span>&nbsp;<span class="string" id="4728505">&#39;-&#39;</span>&nbsp;<span class="op" id="4728509">&amp;&amp;</span>&nbsp;<span class="op" id="4728512">(</span><span class="ident" id="4728513">c</span>&nbsp;<span class="op" id="4728515">&lt;</span>&nbsp;<span class="string" id="4728517">&#39;0&#39;</span>&nbsp;<span class="op" id="4728521">||</span>&nbsp;<span class="ident" id="4728524">c</span>&nbsp;<span class="op" id="4728526">&gt;</span>&nbsp;<span class="string" id="4728528">&#39;9&#39;</span><span class="op" id="4728531">)</span>&nbsp;<span class="op" id="4728533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728538">if</span>&nbsp;<span class="ident" id="4728541">fromQuoted</span>&nbsp;<span class="op" id="4728552">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728558">d</span><span class="op" id="4728559">.</span><span class="builtintype" id="4728560">error</span><span class="op" id="4728565">(</span><span class="ident" id="4728566">fmt</span><span class="op" id="4728569">.</span><span class="ident" id="4728570">Errorf</span><span class="op" id="4728576">(</span><span class="string" id="4728577">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4728650">,</span>&nbsp;<span class="ident" id="4728652">item</span><span class="op" id="4728656">,</span>&nbsp;<span class="ident" id="4728658">v</span><span class="op" id="4728659">.</span><span class="ident" id="4728660">Type</span><span class="op" id="4728664">(</span><span class="op" id="4728665">)</span><span class="op" id="4728666">)</span><span class="op" id="4728667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728672">}</span>&nbsp;<span class="keyword" id="4728674">else</span>&nbsp;<span class="op" id="4728679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728685">d</span><span class="op" id="4728686">.</span><span class="builtintype" id="4728687">error</span><span class="op" id="4728692">(</span><span class="ident" id="4728693">errPhase</span><span class="op" id="4728701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728710">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728714">s</span>&nbsp;<span class="op" id="4728716">:=</span>&nbsp;<span class="builtintype" id="4728719">string</span><span class="op" id="4728725">(</span><span class="ident" id="4728726">item</span><span class="op" id="4728730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728734">switch</span>&nbsp;<span class="ident" id="4728741">v</span><span class="op" id="4728742">.</span><span class="ident" id="4728743">Kind</span><span class="op" id="4728747">(</span><span class="op" id="4728748">)</span>&nbsp;<span class="op" id="4728750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728754">default</span><span class="op" id="4728761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728766">if</span>&nbsp;<span class="ident" id="4728769">v</span><span class="op" id="4728770">.</span><span class="ident" id="4728771">Kind</span><span class="op" id="4728775">(</span><span class="op" id="4728776">)</span>&nbsp;<span class="op" id="4728778">==</span>&nbsp;<span class="ident" id="4728781">reflect</span><span class="op" id="4728788">.</span><span class="ident" id="4728789">String</span>&nbsp;<span class="op" id="4728796">&amp;&amp;</span>&nbsp;<span class="ident" id="4728799">v</span><span class="op" id="4728800">.</span><span class="ident" id="4728801">Type</span><span class="op" id="4728805">(</span><span class="op" id="4728806">)</span>&nbsp;<span class="op" id="4728808">==</span>&nbsp;<span class="ident" id="4728811">numberType</span>&nbsp;<span class="op" id="4728822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728828">v</span><span class="op" id="4728829">.</span><span class="ident" id="4728830">SetString</span><span class="op" id="4728839">(</span><span class="ident" id="4728840">s</span><span class="op" id="4728841">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728847">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4728861">if</span>&nbsp;<span class="ident" id="4728864">fromQuoted</span>&nbsp;<span class="op" id="4728875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4728881">d</span><span class="op" id="4728882">.</span><span class="builtintype" id="4728883">error</span><span class="op" id="4728888">(</span><span class="ident" id="4728889">fmt</span><span class="op" id="4728892">.</span><span class="ident" id="4728893">Errorf</span><span class="op" id="4728899">(</span><span class="string" id="4728900">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;,string&nbsp;struct&nbsp;tag,&nbsp;trying&nbsp;to&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;%v&#34;</span><span class="op" id="4728973">,</span>&nbsp;<span class="ident" id="4728975">item</span><span class="op" id="4728979">,</span>&nbsp;<span class="ident" id="4728981">v</span><span class="op" id="4728982">.</span><span class="ident" id="4728983">Type</span><span class="op" id="4728987">(</span><span class="op" id="4728988">)</span><span class="op" id="4728989">)</span><span class="op" id="4728990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4728995">}</span>&nbsp;<span class="keyword" id="4728997">else</span>&nbsp;<span class="op" id="4729002">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729008">d</span><span class="op" id="4729009">.</span><span class="builtintype" id="4729010">error</span><span class="op" id="4729015">(</span><span class="op" id="4729016">&amp;</span><span class="ident" id="4729017">UnmarshalTypeError</span><span class="op" id="4729035">{</span><span class="string" id="4729036">&#34;number&#34;</span><span class="op" id="4729044">,</span>&nbsp;<span class="ident" id="4729046">v</span><span class="op" id="4729047">.</span><span class="ident" id="4729048">Type</span><span class="op" id="4729052">(</span><span class="op" id="4729053">)</span><span class="op" id="4729054">}</span><span class="op" id="4729055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4729060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729064">case</span>&nbsp;<span class="ident" id="4729069">reflect</span><span class="op" id="4729076">.</span><span class="ident" id="4729077">Interface</span><span class="op" id="4729086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729091">n</span><span class="op" id="4729092">,</span>&nbsp;<span class="ident" id="4729094">err</span>&nbsp;<span class="op" id="4729098">:=</span>&nbsp;<span class="ident" id="4729101">d</span><span class="op" id="4729102">.</span><span class="ident" id="4729103">convertNumber</span><span class="op" id="4729116">(</span><span class="ident" id="4729117">s</span><span class="op" id="4729118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729123">if</span>&nbsp;<span class="ident" id="4729126">err</span>&nbsp;<span class="op" id="4729130">!=</span>&nbsp;<span class="ident" id="4729133">nil</span>&nbsp;<span class="op" id="4729137">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729143">d</span><span class="op" id="4729144">.</span><span class="ident" id="4729145">saveError</span><span class="op" id="4729154">(</span><span class="ident" id="4729155">err</span><span class="op" id="4729158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729164">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4729173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729178">if</span>&nbsp;<span class="ident" id="4729181">v</span><span class="op" id="4729182">.</span><span class="ident" id="4729183">NumMethod</span><span class="op" id="4729192">(</span><span class="op" id="4729193">)</span>&nbsp;<span class="op" id="4729195">!=</span>&nbsp;<span class="num" id="4729198">0</span>&nbsp;<span class="op" id="4729200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729206">d</span><span class="op" id="4729207">.</span><span class="ident" id="4729208">saveError</span><span class="op" id="4729217">(</span><span class="op" id="4729218">&amp;</span><span class="ident" id="4729219">UnmarshalTypeError</span><span class="op" id="4729237">{</span><span class="string" id="4729238">&#34;number&#34;</span><span class="op" id="4729246">,</span>&nbsp;<span class="ident" id="4729248">v</span><span class="op" id="4729249">.</span><span class="ident" id="4729250">Type</span><span class="op" id="4729254">(</span><span class="op" id="4729255">)</span><span class="op" id="4729256">}</span><span class="op" id="4729257">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729263">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4729272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729277">v</span><span class="op" id="4729278">.</span><span class="ident" id="4729279">Set</span><span class="op" id="4729282">(</span><span class="ident" id="4729283">reflect</span><span class="op" id="4729290">.</span><span class="ident" id="4729291">ValueOf</span><span class="op" id="4729298">(</span><span class="ident" id="4729299">n</span><span class="op" id="4729300">)</span><span class="op" id="4729301">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729306">case</span>&nbsp;<span class="ident" id="4729311">reflect</span><span class="op" id="4729318">.</span><span class="ident" id="4729319">Int</span><span class="op" id="4729322">,</span>&nbsp;<span class="ident" id="4729324">reflect</span><span class="op" id="4729331">.</span><span class="ident" id="4729332">Int8</span><span class="op" id="4729336">,</span>&nbsp;<span class="ident" id="4729338">reflect</span><span class="op" id="4729345">.</span><span class="ident" id="4729346">Int16</span><span class="op" id="4729351">,</span>&nbsp;<span class="ident" id="4729353">reflect</span><span class="op" id="4729360">.</span><span class="ident" id="4729361">Int32</span><span class="op" id="4729366">,</span>&nbsp;<span class="ident" id="4729368">reflect</span><span class="op" id="4729375">.</span><span class="ident" id="4729376">Int64</span><span class="op" id="4729381">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729386">n</span><span class="op" id="4729387">,</span>&nbsp;<span class="ident" id="4729389">err</span>&nbsp;<span class="op" id="4729393">:=</span>&nbsp;<span class="ident" id="4729396">strconv</span><span class="op" id="4729403">.</span><span class="ident" id="4729404">ParseInt</span><span class="op" id="4729412">(</span><span class="ident" id="4729413">s</span><span class="op" id="4729414">,</span>&nbsp;<span class="num" id="4729416">10</span><span class="op" id="4729418">,</span>&nbsp;<span class="num" id="4729420">64</span><span class="op" id="4729422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729427">if</span>&nbsp;<span class="ident" id="4729430">err</span>&nbsp;<span class="op" id="4729434">!=</span>&nbsp;<span class="ident" id="4729437">nil</span>&nbsp;<span class="op" id="4729441">||</span>&nbsp;<span class="ident" id="4729444">v</span><span class="op" id="4729445">.</span><span class="ident" id="4729446">OverflowInt</span><span class="op" id="4729457">(</span><span class="ident" id="4729458">n</span><span class="op" id="4729459">)</span>&nbsp;<span class="op" id="4729461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729467">d</span><span class="op" id="4729468">.</span><span class="ident" id="4729469">saveError</span><span class="op" id="4729478">(</span><span class="op" id="4729479">&amp;</span><span class="ident" id="4729480">UnmarshalTypeError</span><span class="op" id="4729498">{</span><span class="string" id="4729499">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4729509">+</span>&nbsp;<span class="ident" id="4729511">s</span><span class="op" id="4729512">,</span>&nbsp;<span class="ident" id="4729514">v</span><span class="op" id="4729515">.</span><span class="ident" id="4729516">Type</span><span class="op" id="4729520">(</span><span class="op" id="4729521">)</span><span class="op" id="4729522">}</span><span class="op" id="4729523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729529">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4729538">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729543">v</span><span class="op" id="4729544">.</span><span class="ident" id="4729545">SetInt</span><span class="op" id="4729551">(</span><span class="ident" id="4729552">n</span><span class="op" id="4729553">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729558">case</span>&nbsp;<span class="ident" id="4729563">reflect</span><span class="op" id="4729570">.</span><span class="ident" id="4729571">Uint</span><span class="op" id="4729575">,</span>&nbsp;<span class="ident" id="4729577">reflect</span><span class="op" id="4729584">.</span><span class="ident" id="4729585">Uint8</span><span class="op" id="4729590">,</span>&nbsp;<span class="ident" id="4729592">reflect</span><span class="op" id="4729599">.</span><span class="ident" id="4729600">Uint16</span><span class="op" id="4729606">,</span>&nbsp;<span class="ident" id="4729608">reflect</span><span class="op" id="4729615">.</span><span class="ident" id="4729616">Uint32</span><span class="op" id="4729622">,</span>&nbsp;<span class="ident" id="4729624">reflect</span><span class="op" id="4729631">.</span><span class="ident" id="4729632">Uint64</span><span class="op" id="4729638">,</span>&nbsp;<span class="ident" id="4729640">reflect</span><span class="op" id="4729647">.</span><span class="ident" id="4729648">Uintptr</span><span class="op" id="4729655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729660">n</span><span class="op" id="4729661">,</span>&nbsp;<span class="ident" id="4729663">err</span>&nbsp;<span class="op" id="4729667">:=</span>&nbsp;<span class="ident" id="4729670">strconv</span><span class="op" id="4729677">.</span><span class="ident" id="4729678">ParseUint</span><span class="op" id="4729687">(</span><span class="ident" id="4729688">s</span><span class="op" id="4729689">,</span>&nbsp;<span class="num" id="4729691">10</span><span class="op" id="4729693">,</span>&nbsp;<span class="num" id="4729695">64</span><span class="op" id="4729697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729702">if</span>&nbsp;<span class="ident" id="4729705">err</span>&nbsp;<span class="op" id="4729709">!=</span>&nbsp;<span class="ident" id="4729712">nil</span>&nbsp;<span class="op" id="4729716">||</span>&nbsp;<span class="ident" id="4729719">v</span><span class="op" id="4729720">.</span><span class="ident" id="4729721">OverflowUint</span><span class="op" id="4729733">(</span><span class="ident" id="4729734">n</span><span class="op" id="4729735">)</span>&nbsp;<span class="op" id="4729737">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729743">d</span><span class="op" id="4729744">.</span><span class="ident" id="4729745">saveError</span><span class="op" id="4729754">(</span><span class="op" id="4729755">&amp;</span><span class="ident" id="4729756">UnmarshalTypeError</span><span class="op" id="4729774">{</span><span class="string" id="4729775">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4729785">+</span>&nbsp;<span class="ident" id="4729787">s</span><span class="op" id="4729788">,</span>&nbsp;<span class="ident" id="4729790">v</span><span class="op" id="4729791">.</span><span class="ident" id="4729792">Type</span><span class="op" id="4729796">(</span><span class="op" id="4729797">)</span><span class="op" id="4729798">}</span><span class="op" id="4729799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729805">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4729814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729819">v</span><span class="op" id="4729820">.</span><span class="ident" id="4729821">SetUint</span><span class="op" id="4729828">(</span><span class="ident" id="4729829">n</span><span class="op" id="4729830">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729835">case</span>&nbsp;<span class="ident" id="4729840">reflect</span><span class="op" id="4729847">.</span><span class="ident" id="4729848">Float32</span><span class="op" id="4729855">,</span>&nbsp;<span class="ident" id="4729857">reflect</span><span class="op" id="4729864">.</span><span class="ident" id="4729865">Float64</span><span class="op" id="4729872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729877">n</span><span class="op" id="4729878">,</span>&nbsp;<span class="ident" id="4729880">err</span>&nbsp;<span class="op" id="4729884">:=</span>&nbsp;<span class="ident" id="4729887">strconv</span><span class="op" id="4729894">.</span><span class="ident" id="4729895">ParseFloat</span><span class="op" id="4729905">(</span><span class="ident" id="4729906">s</span><span class="op" id="4729907">,</span>&nbsp;<span class="ident" id="4729909">v</span><span class="op" id="4729910">.</span><span class="ident" id="4729911">Type</span><span class="op" id="4729915">(</span><span class="op" id="4729916">)</span><span class="op" id="4729917">.</span><span class="ident" id="4729918">Bits</span><span class="op" id="4729922">(</span><span class="op" id="4729923">)</span><span class="op" id="4729924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4729929">if</span>&nbsp;<span class="ident" id="4729932">err</span>&nbsp;<span class="op" id="4729936">!=</span>&nbsp;<span class="ident" id="4729939">nil</span>&nbsp;<span class="op" id="4729943">||</span>&nbsp;<span class="ident" id="4729946">v</span><span class="op" id="4729947">.</span><span class="ident" id="4729948">OverflowFloat</span><span class="op" id="4729961">(</span><span class="ident" id="4729962">n</span><span class="op" id="4729963">)</span>&nbsp;<span class="op" id="4729965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4729971">d</span><span class="op" id="4729972">.</span><span class="ident" id="4729973">saveError</span><span class="op" id="4729982">(</span><span class="op" id="4729983">&amp;</span><span class="ident" id="4729984">UnmarshalTypeError</span><span class="op" id="4730002">{</span><span class="string" id="4730003">&#34;number&nbsp;&#34;</span>&nbsp;<span class="op" id="4730013">+</span>&nbsp;<span class="ident" id="4730015">s</span><span class="op" id="4730016">,</span>&nbsp;<span class="ident" id="4730018">v</span><span class="op" id="4730019">.</span><span class="ident" id="4730020">Type</span><span class="op" id="4730024">(</span><span class="op" id="4730025">)</span><span class="op" id="4730026">}</span><span class="op" id="4730027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730033">break</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4730042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4730047">v</span><span class="op" id="4730048">.</span><span class="ident" id="4730049">SetFloat</span><span class="op" id="4730057">(</span><span class="ident" id="4730058">n</span><span class="op" id="4730059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4730063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4730066">}</span><br>
<span class="lineno"></span><span class="op" id="4730068">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="comment" id="4730071">//&nbsp;The&nbsp;xxxInterface&nbsp;routines&nbsp;build&nbsp;up&nbsp;a&nbsp;value&nbsp;to&nbsp;be&nbsp;stored</span><br>
<span class="lineno"></span><span class="comment" id="4730130">//&nbsp;in&nbsp;an&nbsp;empty&nbsp;interface.&nbsp;&nbsp;They&nbsp;are&nbsp;not&nbsp;strictly&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4730190">//&nbsp;but&nbsp;they&nbsp;avoid&nbsp;the&nbsp;weight&nbsp;of&nbsp;reflection&nbsp;in&nbsp;this&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="4730255">//&nbsp;valueInterface&nbsp;is&nbsp;like&nbsp;value&nbsp;but&nbsp;returns&nbsp;interface{}</span><br>
<span class="lineno"></span><span class="keyword" id="4730311">func</span>&nbsp;<span class="op" id="4730316">(</span><span class="ident" id="4730317">d</span>&nbsp;<span class="op" id="4730319">*</span><span class="ident" id="4730320">decodeState</span><span class="op" id="4730331">)</span>&nbsp;<span class="ident" id="4730333">valueInterface</span><span class="op" id="4730347">(</span><span class="op" id="4730348">)</span>&nbsp;<span class="keyword" id="4730350">interface</span><span class="op" id="4730359">{</span><span class="op" id="4730360">}</span>&nbsp;<span class="op" id="4730362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730365">switch</span>&nbsp;<span class="ident" id="4730372">d</span><span class="op" id="4730373">.</span><span class="ident" id="4730374">scanWhile</span><span class="op" id="4730383">(</span><span class="ident" id="4730384">scanSkipSpace</span><span class="op" id="4730397">)</span>&nbsp;<span class="op" id="4730399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730402">default</span><span class="op" id="4730409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4730413">d</span><span class="op" id="4730414">.</span><span class="builtintype" id="4730415">error</span><span class="op" id="4730420">(</span><span class="ident" id="4730421">errPhase</span><span class="op" id="4730429">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4730433">panic</span><span class="op" id="4730438">(</span><span class="string" id="4730439">&#34;unreachable&#34;</span><span class="op" id="4730452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730455">case</span>&nbsp;<span class="ident" id="4730460">scanBeginArray</span><span class="op" id="4730474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730478">return</span>&nbsp;<span class="ident" id="4730485">d</span><span class="op" id="4730486">.</span><span class="ident" id="4730487">arrayInterface</span><span class="op" id="4730501">(</span><span class="op" id="4730502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730505">case</span>&nbsp;<span class="ident" id="4730510">scanBeginObject</span><span class="op" id="4730525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730529">return</span>&nbsp;<span class="ident" id="4730536">d</span><span class="op" id="4730537">.</span><span class="ident" id="4730538">objectInterface</span><span class="op" id="4730553">(</span><span class="op" id="4730554">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730557">case</span>&nbsp;<span class="ident" id="4730562">scanBeginLiteral</span><span class="op" id="4730578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730582">return</span>&nbsp;<span class="ident" id="4730589">d</span><span class="op" id="4730590">.</span><span class="ident" id="4730591">literalInterface</span><span class="op" id="4730607">(</span><span class="op" id="4730608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4730611">}</span><br>
<span class="lineno"></span><span class="op" id="4730613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4730616">//&nbsp;arrayInterface&nbsp;is&nbsp;like&nbsp;array&nbsp;but&nbsp;returns&nbsp;[]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="4730675">func</span>&nbsp;<span class="op" id="4730680">(</span><span class="ident" id="4730681">d</span>&nbsp;<span class="op" id="4730683">*</span><span class="ident" id="4730684">decodeState</span><span class="op" id="4730695">)</span>&nbsp;<span class="ident" id="4730697">arrayInterface</span><span class="op" id="4730711">(</span><span class="op" id="4730712">)</span>&nbsp;<span class="op" id="4730714">[</span><span class="op" id="4730715">]</span><span class="keyword" id="4730716">interface</span><span class="op" id="4730725">{</span><span class="op" id="4730726">}</span>&nbsp;<span class="op" id="4730728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730731">var</span>&nbsp;<span class="ident" id="4730735">v</span>&nbsp;<span class="op" id="4730737">=</span>&nbsp;<span class="builtinfunc" id="4730739">make</span><span class="op" id="4730743">(</span><span class="op" id="4730744">[</span><span class="op" id="4730745">]</span><span class="keyword" id="4730746">interface</span><span class="op" id="4730755">{</span><span class="op" id="4730756">}</span><span class="op" id="4730757">,</span>&nbsp;<span class="num" id="4730759">0</span><span class="op" id="4730760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730763">for</span>&nbsp;<span class="op" id="4730767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4730771">//&nbsp;Look&nbsp;ahead&nbsp;for&nbsp;]&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4730831">op</span>&nbsp;<span class="op" id="4730834">:=</span>&nbsp;<span class="ident" id="4730837">d</span><span class="op" id="4730838">.</span><span class="ident" id="4730839">scanWhile</span><span class="op" id="4730848">(</span><span class="ident" id="4730849">scanSkipSpace</span><span class="op" id="4730862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730866">if</span>&nbsp;<span class="ident" id="4730869">op</span>&nbsp;<span class="op" id="4730872">==</span>&nbsp;<span class="ident" id="4730875">scanEndArray</span>&nbsp;<span class="op" id="4730888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4730893">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4730901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4730906">//&nbsp;Back&nbsp;up&nbsp;so&nbsp;d.value&nbsp;can&nbsp;have&nbsp;the&nbsp;byte&nbsp;we&nbsp;just&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4730962">d</span><span class="op" id="4730963">.</span><span class="ident" id="4730964">off</span><span class="op" id="4730967">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4730972">d</span><span class="op" id="4730973">.</span><span class="ident" id="4730974">scan</span><span class="op" id="4730978">.</span><span class="ident" id="4730979">undo</span><span class="op" id="4730983">(</span><span class="ident" id="4730984">op</span><span class="op" id="4730986">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4730991">v</span>&nbsp;<span class="op" id="4730993">=</span>&nbsp;<span class="builtinfunc" id="4730995">append</span><span class="op" id="4731001">(</span><span class="ident" id="4731002">v</span><span class="op" id="4731003">,</span>&nbsp;<span class="ident" id="4731005">d</span><span class="op" id="4731006">.</span><span class="ident" id="4731007">valueInterface</span><span class="op" id="4731021">(</span><span class="op" id="4731022">)</span><span class="op" id="4731023">)</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731028">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731060">op</span>&nbsp;<span class="op" id="4731063">=</span>&nbsp;<span class="ident" id="4731065">d</span><span class="op" id="4731066">.</span><span class="ident" id="4731067">scanWhile</span><span class="op" id="4731076">(</span><span class="ident" id="4731077">scanSkipSpace</span><span class="op" id="4731090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731094">if</span>&nbsp;<span class="ident" id="4731097">op</span>&nbsp;<span class="op" id="4731100">==</span>&nbsp;<span class="ident" id="4731103">scanEndArray</span>&nbsp;<span class="op" id="4731116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731121">break</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731133">if</span>&nbsp;<span class="ident" id="4731136">op</span>&nbsp;<span class="op" id="4731139">!=</span>&nbsp;<span class="ident" id="4731142">scanArrayValue</span>&nbsp;<span class="op" id="4731157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731162">d</span><span class="op" id="4731163">.</span><span class="builtintype" id="4731164">error</span><span class="op" id="4731169">(</span><span class="ident" id="4731170">errPhase</span><span class="op" id="4731178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731185">}</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731188">return</span>&nbsp;<span class="ident" id="4731195">v</span><br>
<span class="lineno"></span><span class="op" id="4731197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4731200">//&nbsp;objectInterface&nbsp;is&nbsp;like&nbsp;object&nbsp;but&nbsp;returns&nbsp;map[string]interface{}.</span><br>
<span class="lineno"></span><span class="keyword" id="4731270">func</span>&nbsp;<span class="op" id="4731275">(</span><span class="ident" id="4731276">d</span>&nbsp;<span class="op" id="4731278">*</span><span class="ident" id="4731279">decodeState</span><span class="op" id="4731290">)</span>&nbsp;<span class="ident" id="4731292">objectInterface</span><span class="op" id="4731307">(</span><span class="op" id="4731308">)</span>&nbsp;<span class="keyword" id="4731310">map</span><span class="op" id="4731313">[</span><span class="builtintype" id="4731314">string</span><span class="op" id="4731320">]</span><span class="keyword" id="4731321">interface</span><span class="op" id="4731330">{</span><span class="op" id="4731331">}</span>&nbsp;<span class="op" id="4731333">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731336">m</span>&nbsp;<span class="op" id="4731338">:=</span>&nbsp;<span class="builtinfunc" id="4731341">make</span><span class="op" id="4731345">(</span><span class="keyword" id="4731346">map</span><span class="op" id="4731349">[</span><span class="builtintype" id="4731350">string</span><span class="op" id="4731356">]</span><span class="keyword" id="4731357">interface</span><span class="op" id="4731366">{</span><span class="op" id="4731367">}</span><span class="op" id="4731368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731371">for</span>&nbsp;<span class="op" id="4731375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731379">//&nbsp;Read&nbsp;opening&nbsp;&#34;&nbsp;of&nbsp;string&nbsp;key&nbsp;or&nbsp;closing&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731427">op</span>&nbsp;<span class="op" id="4731430">:=</span>&nbsp;<span class="ident" id="4731433">d</span><span class="op" id="4731434">.</span><span class="ident" id="4731435">scanWhile</span><span class="op" id="4731444">(</span><span class="ident" id="4731445">scanSkipSpace</span><span class="op" id="4731458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731462">if</span>&nbsp;<span class="ident" id="4731465">op</span>&nbsp;<span class="op" id="4731468">==</span>&nbsp;<span class="ident" id="4731471">scanEndObject</span>&nbsp;<span class="op" id="4731485">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731490">//&nbsp;closing&nbsp;}&nbsp;-&nbsp;can&nbsp;only&nbsp;happen&nbsp;on&nbsp;first&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731544">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731556">if</span>&nbsp;<span class="ident" id="4731559">op</span>&nbsp;<span class="op" id="4731562">!=</span>&nbsp;<span class="ident" id="4731565">scanBeginLiteral</span>&nbsp;<span class="op" id="4731582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731587">d</span><span class="op" id="4731588">.</span><span class="builtintype" id="4731589">error</span><span class="op" id="4731594">(</span><span class="ident" id="4731595">errPhase</span><span class="op" id="4731603">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731612">//&nbsp;Read&nbsp;string&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731634">start</span>&nbsp;<span class="op" id="4731640">:=</span>&nbsp;<span class="ident" id="4731643">d</span><span class="op" id="4731644">.</span><span class="ident" id="4731645">off</span>&nbsp;<span class="op" id="4731649">-</span>&nbsp;<span class="num" id="4731651">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731655">op</span>&nbsp;<span class="op" id="4731658">=</span>&nbsp;<span class="ident" id="4731660">d</span><span class="op" id="4731661">.</span><span class="ident" id="4731662">scanWhile</span><span class="op" id="4731671">(</span><span class="ident" id="4731672">scanContinue</span><span class="op" id="4731684">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731688">item</span>&nbsp;<span class="op" id="4731693">:=</span>&nbsp;<span class="ident" id="4731696">d</span><span class="op" id="4731697">.</span><span class="ident" id="4731698">data</span><span class="op" id="4731702">[</span><span class="ident" id="4731703">start</span>&nbsp;<span class="op" id="4731709">:</span>&nbsp;<span class="ident" id="4731711">d</span><span class="op" id="4731712">.</span><span class="ident" id="4731713">off</span><span class="op" id="4731716">-</span><span class="num" id="4731717">1</span><span class="op" id="4731718">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731722">key</span><span class="op" id="4731725">,</span>&nbsp;<span class="ident" id="4731727">ok</span>&nbsp;<span class="op" id="4731730">:=</span>&nbsp;<span class="ident" id="4731733">unquote</span><span class="op" id="4731740">(</span><span class="ident" id="4731741">item</span><span class="op" id="4731745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731749">if</span>&nbsp;<span class="op" id="4731752">!</span><span class="ident" id="4731753">ok</span>&nbsp;<span class="op" id="4731756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731761">d</span><span class="op" id="4731762">.</span><span class="builtintype" id="4731763">error</span><span class="op" id="4731768">(</span><span class="ident" id="4731769">errPhase</span><span class="op" id="4731777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731781">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731786">//&nbsp;Read&nbsp;:&nbsp;before&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731812">if</span>&nbsp;<span class="ident" id="4731815">op</span>&nbsp;<span class="op" id="4731818">==</span>&nbsp;<span class="ident" id="4731821">scanSkipSpace</span>&nbsp;<span class="op" id="4731835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731840">op</span>&nbsp;<span class="op" id="4731843">=</span>&nbsp;<span class="ident" id="4731845">d</span><span class="op" id="4731846">.</span><span class="ident" id="4731847">scanWhile</span><span class="op" id="4731856">(</span><span class="ident" id="4731857">scanSkipSpace</span><span class="op" id="4731870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731874">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4731878">if</span>&nbsp;<span class="ident" id="4731881">op</span>&nbsp;<span class="op" id="4731884">!=</span>&nbsp;<span class="ident" id="4731887">scanObjectKey</span>&nbsp;<span class="op" id="4731901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731906">d</span><span class="op" id="4731907">.</span><span class="builtintype" id="4731908">error</span><span class="op" id="4731913">(</span><span class="ident" id="4731914">errPhase</span><span class="op" id="4731922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4731926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731931">//&nbsp;Read&nbsp;value.</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4731948">m</span><span class="op" id="4731949">[</span><span class="ident" id="4731950">key</span><span class="op" id="4731953">]</span>&nbsp;<span class="op" id="4731955">=</span>&nbsp;<span class="ident" id="4731957">d</span><span class="op" id="4731958">.</span><span class="ident" id="4731959">valueInterface</span><span class="op" id="4731973">(</span><span class="op" id="4731974">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4731979">//&nbsp;Next&nbsp;token&nbsp;must&nbsp;be&nbsp;,&nbsp;or&nbsp;}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732011">op</span>&nbsp;<span class="op" id="4732014">=</span>&nbsp;<span class="ident" id="4732016">d</span><span class="op" id="4732017">.</span><span class="ident" id="4732018">scanWhile</span><span class="op" id="4732027">(</span><span class="ident" id="4732028">scanSkipSpace</span><span class="op" id="4732041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732045">if</span>&nbsp;<span class="ident" id="4732048">op</span>&nbsp;<span class="op" id="4732051">==</span>&nbsp;<span class="ident" id="4732054">scanEndObject</span>&nbsp;<span class="op" id="4732068">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732073">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732085">if</span>&nbsp;<span class="ident" id="4732088">op</span>&nbsp;<span class="op" id="4732091">!=</span>&nbsp;<span class="ident" id="4732094">scanObjectValue</span>&nbsp;<span class="op" id="4732110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732115">d</span><span class="op" id="4732116">.</span><span class="builtintype" id="4732117">error</span><span class="op" id="4732122">(</span><span class="ident" id="4732123">errPhase</span><span class="op" id="4732131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732135">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732141">return</span>&nbsp;<span class="ident" id="4732148">m</span><br>
<span class="lineno"></span><span class="op" id="4732150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4732153">//&nbsp;literalInterface&nbsp;is&nbsp;like&nbsp;literal&nbsp;but&nbsp;returns&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno">915</span><span class="keyword" id="4732221">func</span>&nbsp;<span class="op" id="4732226">(</span><span class="ident" id="4732227">d</span>&nbsp;<span class="op" id="4732229">*</span><span class="ident" id="4732230">decodeState</span><span class="op" id="4732241">)</span>&nbsp;<span class="ident" id="4732243">literalInterface</span><span class="op" id="4732259">(</span><span class="op" id="4732260">)</span>&nbsp;<span class="keyword" id="4732262">interface</span><span class="op" id="4732271">{</span><span class="op" id="4732272">}</span>&nbsp;<span class="op" id="4732274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4732277">//&nbsp;All&nbsp;bytes&nbsp;inside&nbsp;literal&nbsp;return&nbsp;scanContinue&nbsp;op&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732335">start</span>&nbsp;<span class="op" id="4732341">:=</span>&nbsp;<span class="ident" id="4732344">d</span><span class="op" id="4732345">.</span><span class="ident" id="4732346">off</span>&nbsp;<span class="op" id="4732350">-</span>&nbsp;<span class="num" id="4732352">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732355">op</span>&nbsp;<span class="op" id="4732358">:=</span>&nbsp;<span class="ident" id="4732361">d</span><span class="op" id="4732362">.</span><span class="ident" id="4732363">scanWhile</span><span class="op" id="4732372">(</span><span class="ident" id="4732373">scanContinue</span><span class="op" id="4732385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4732389">//&nbsp;Scan&nbsp;read&nbsp;one&nbsp;byte&nbsp;too&nbsp;far;&nbsp;back&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732430">d</span><span class="op" id="4732431">.</span><span class="ident" id="4732432">off</span><span class="op" id="4732435">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732439">d</span><span class="op" id="4732440">.</span><span class="ident" id="4732441">scan</span><span class="op" id="4732445">.</span><span class="ident" id="4732446">undo</span><span class="op" id="4732450">(</span><span class="ident" id="4732451">op</span><span class="op" id="4732453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732456">item</span>&nbsp;<span class="op" id="4732461">:=</span>&nbsp;<span class="ident" id="4732464">d</span><span class="op" id="4732465">.</span><span class="ident" id="4732466">data</span><span class="op" id="4732470">[</span><span class="ident" id="4732471">start</span><span class="op" id="4732476">:</span><span class="ident" id="4732477">d</span><span class="op" id="4732478">.</span><span class="ident" id="4732479">off</span><span class="op" id="4732482">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732486">switch</span>&nbsp;<span class="ident" id="4732493">c</span>&nbsp;<span class="op" id="4732495">:=</span>&nbsp;<span class="ident" id="4732498">item</span><span class="op" id="4732502">[</span><span class="num" id="4732503">0</span><span class="op" id="4732504">]</span><span class="op" id="4732505">;</span>&nbsp;<span class="ident" id="4732507">c</span>&nbsp;<span class="op" id="4732509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732512">case</span>&nbsp;<span class="string" id="4732517">&#39;n&#39;</span><span class="op" id="4732520">:</span>&nbsp;<span class="comment" id="4732522">//&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732532">return</span>&nbsp;<span class="ident" id="4732539">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732545">case</span>&nbsp;<span class="string" id="4732550">&#39;t&#39;</span><span class="op" id="4732553">,</span>&nbsp;<span class="string" id="4732555">&#39;f&#39;</span><span class="op" id="4732558">:</span>&nbsp;<span class="comment" id="4732560">//&nbsp;true,&nbsp;false</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732577">return</span>&nbsp;<span class="ident" id="4732584">c</span>&nbsp;<span class="op" id="4732586">==</span>&nbsp;<span class="string" id="4732589">&#39;t&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732595">case</span>&nbsp;<span class="string" id="4732600">&#39;&#34;&#39;</span><span class="op" id="4732603">:</span>&nbsp;<span class="comment" id="4732605">//&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732617">s</span><span class="op" id="4732618">,</span>&nbsp;<span class="ident" id="4732620">ok</span>&nbsp;<span class="op" id="4732623">:=</span>&nbsp;<span class="ident" id="4732626">unquote</span><span class="op" id="4732633">(</span><span class="ident" id="4732634">item</span><span class="op" id="4732638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732642">if</span>&nbsp;<span class="op" id="4732645">!</span><span class="ident" id="4732646">ok</span>&nbsp;<span class="op" id="4732649">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732654">d</span><span class="op" id="4732655">.</span><span class="builtintype" id="4732656">error</span><span class="op" id="4732661">(</span><span class="ident" id="4732662">errPhase</span><span class="op" id="4732670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732678">return</span>&nbsp;<span class="ident" id="4732685">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732689">default</span><span class="op" id="4732696">:</span>&nbsp;<span class="comment" id="4732698">//&nbsp;number</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732710">if</span>&nbsp;<span class="ident" id="4732713">c</span>&nbsp;<span class="op" id="4732715">!=</span>&nbsp;<span class="string" id="4732718">&#39;-&#39;</span>&nbsp;<span class="op" id="4732722">&amp;&amp;</span>&nbsp;<span class="op" id="4732725">(</span><span class="ident" id="4732726">c</span>&nbsp;<span class="op" id="4732728">&lt;</span>&nbsp;<span class="string" id="4732730">&#39;0&#39;</span>&nbsp;<span class="op" id="4732734">||</span>&nbsp;<span class="ident" id="4732737">c</span>&nbsp;<span class="op" id="4732739">&gt;</span>&nbsp;<span class="string" id="4732741">&#39;9&#39;</span><span class="op" id="4732744">)</span>&nbsp;<span class="op" id="4732746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732751">d</span><span class="op" id="4732752">.</span><span class="builtintype" id="4732753">error</span><span class="op" id="4732758">(</span><span class="ident" id="4732759">errPhase</span><span class="op" id="4732767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732775">n</span><span class="op" id="4732776">,</span>&nbsp;<span class="ident" id="4732778">err</span>&nbsp;<span class="op" id="4732782">:=</span>&nbsp;<span class="ident" id="4732785">d</span><span class="op" id="4732786">.</span><span class="ident" id="4732787">convertNumber</span><span class="op" id="4732800">(</span><span class="builtintype" id="4732801">string</span><span class="op" id="4732807">(</span><span class="ident" id="4732808">item</span><span class="op" id="4732812">)</span><span class="op" id="4732813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732817">if</span>&nbsp;<span class="ident" id="4732820">err</span>&nbsp;<span class="op" id="4732824">!=</span>&nbsp;<span class="ident" id="4732827">nil</span>&nbsp;<span class="op" id="4732831">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4732836">d</span><span class="op" id="4732837">.</span><span class="ident" id="4732838">saveError</span><span class="op" id="4732847">(</span><span class="ident" id="4732848">err</span><span class="op" id="4732851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732859">return</span>&nbsp;<span class="ident" id="4732866">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4732869">}</span><br>
<span class="lineno"></span><span class="op" id="4732871">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="comment" id="4732874">//&nbsp;getu4&nbsp;decodes&nbsp;\uXXXX&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s,&nbsp;returning&nbsp;the&nbsp;hex&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="4732948">//&nbsp;or&nbsp;it&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="4732969">func</span>&nbsp;<span class="ident" id="4732974">getu4</span><span class="op" id="4732979">(</span><span class="ident" id="4732980">s</span>&nbsp;<span class="op" id="4732982">[</span><span class="op" id="4732983">]</span><span class="builtintype" id="4732984">byte</span><span class="op" id="4732988">)</span>&nbsp;<span class="builtintype" id="4732990">rune</span>&nbsp;<span class="op" id="4732995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4732998">if</span>&nbsp;<span class="builtinfunc" id="4733001">len</span><span class="op" id="4733004">(</span><span class="ident" id="4733005">s</span><span class="op" id="4733006">)</span>&nbsp;<span class="op" id="4733008">&lt;</span>&nbsp;<span class="num" id="4733010">6</span>&nbsp;<span class="op" id="4733012">||</span>&nbsp;<span class="ident" id="4733015">s</span><span class="op" id="4733016">[</span><span class="num" id="4733017">0</span><span class="op" id="4733018">]</span>&nbsp;<span class="op" id="4733020">!=</span>&nbsp;<span class="string" id="4733023">&#39;\\&#39;</span>&nbsp;<span class="op" id="4733028">||</span>&nbsp;<span class="ident" id="4733031">s</span><span class="op" id="4733032">[</span><span class="num" id="4733033">1</span><span class="op" id="4733034">]</span>&nbsp;<span class="op" id="4733036">!=</span>&nbsp;<span class="string" id="4733039">&#39;u&#39;</span>&nbsp;<span class="op" id="4733043">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733047">return</span>&nbsp;<span class="op" id="4733054">-</span><span class="num" id="4733055">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733061">r</span><span class="op" id="4733062">,</span>&nbsp;<span class="ident" id="4733064">err</span>&nbsp;<span class="op" id="4733068">:=</span>&nbsp;<span class="ident" id="4733071">strconv</span><span class="op" id="4733078">.</span><span class="ident" id="4733079">ParseUint</span><span class="op" id="4733088">(</span><span class="builtintype" id="4733089">string</span><span class="op" id="4733095">(</span><span class="ident" id="4733096">s</span><span class="op" id="4733097">[</span><span class="num" id="4733098">2</span><span class="op" id="4733099">:</span><span class="num" id="4733100">6</span><span class="op" id="4733101">]</span><span class="op" id="4733102">)</span><span class="op" id="4733103">,</span>&nbsp;<span class="num" id="4733105">16</span><span class="op" id="4733107">,</span>&nbsp;<span class="num" id="4733109">64</span><span class="op" id="4733111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733114">if</span>&nbsp;<span class="ident" id="4733117">err</span>&nbsp;<span class="op" id="4733121">!=</span>&nbsp;<span class="ident" id="4733124">nil</span>&nbsp;<span class="op" id="4733128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733132">return</span>&nbsp;<span class="op" id="4733139">-</span><span class="num" id="4733140">1</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733146">return</span>&nbsp;<span class="builtintype" id="4733153">rune</span><span class="op" id="4733157">(</span><span class="ident" id="4733158">r</span><span class="op" id="4733159">)</span><br>
<span class="lineno"></span><span class="op" id="4733161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4733164">//&nbsp;unquote&nbsp;converts&nbsp;a&nbsp;quoted&nbsp;JSON&nbsp;string&nbsp;literal&nbsp;s&nbsp;into&nbsp;an&nbsp;actual&nbsp;string&nbsp;t.</span><br>
<span class="lineno">965</span><span class="comment" id="4733240">//&nbsp;The&nbsp;rules&nbsp;are&nbsp;different&nbsp;than&nbsp;for&nbsp;Go,&nbsp;so&nbsp;cannot&nbsp;use&nbsp;strconv.Unquote.</span><br>
<span class="lineno"></span><span class="keyword" id="4733311">func</span>&nbsp;<span class="ident" id="4733316">unquote</span><span class="op" id="4733323">(</span><span class="ident" id="4733324">s</span>&nbsp;<span class="op" id="4733326">[</span><span class="op" id="4733327">]</span><span class="builtintype" id="4733328">byte</span><span class="op" id="4733332">)</span>&nbsp;<span class="op" id="4733334">(</span><span class="ident" id="4733335">t</span>&nbsp;<span class="builtintype" id="4733337">string</span><span class="op" id="4733343">,</span>&nbsp;<span class="ident" id="4733345">ok</span>&nbsp;<span class="builtintype" id="4733348">bool</span><span class="op" id="4733352">)</span>&nbsp;<span class="op" id="4733354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733357">s</span><span class="op" id="4733358">,</span>&nbsp;<span class="ident" id="4733360">ok</span>&nbsp;<span class="op" id="4733363">=</span>&nbsp;<span class="ident" id="4733365">unquoteBytes</span><span class="op" id="4733377">(</span><span class="ident" id="4733378">s</span><span class="op" id="4733379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733382">t</span>&nbsp;<span class="op" id="4733384">=</span>&nbsp;<span class="builtintype" id="4733386">string</span><span class="op" id="4733392">(</span><span class="ident" id="4733393">s</span><span class="op" id="4733394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733397">return</span><br>
<span class="lineno">970</span><span class="op" id="4733404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4733407">func</span>&nbsp;<span class="ident" id="4733412">unquoteBytes</span><span class="op" id="4733424">(</span><span class="ident" id="4733425">s</span>&nbsp;<span class="op" id="4733427">[</span><span class="op" id="4733428">]</span><span class="builtintype" id="4733429">byte</span><span class="op" id="4733433">)</span>&nbsp;<span class="op" id="4733435">(</span><span class="ident" id="4733436">t</span>&nbsp;<span class="op" id="4733438">[</span><span class="op" id="4733439">]</span><span class="builtintype" id="4733440">byte</span><span class="op" id="4733444">,</span>&nbsp;<span class="ident" id="4733446">ok</span>&nbsp;<span class="builtintype" id="4733449">bool</span><span class="op" id="4733453">)</span>&nbsp;<span class="op" id="4733455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733458">if</span>&nbsp;<span class="builtinfunc" id="4733461">len</span><span class="op" id="4733464">(</span><span class="ident" id="4733465">s</span><span class="op" id="4733466">)</span>&nbsp;<span class="op" id="4733468">&lt;</span>&nbsp;<span class="num" id="4733470">2</span>&nbsp;<span class="op" id="4733472">||</span>&nbsp;<span class="ident" id="4733475">s</span><span class="op" id="4733476">[</span><span class="num" id="4733477">0</span><span class="op" id="4733478">]</span>&nbsp;<span class="op" id="4733480">!=</span>&nbsp;<span class="string" id="4733483">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4733487">||</span>&nbsp;<span class="ident" id="4733490">s</span><span class="op" id="4733491">[</span><span class="builtinfunc" id="4733492">len</span><span class="op" id="4733495">(</span><span class="ident" id="4733496">s</span><span class="op" id="4733497">)</span><span class="op" id="4733498">-</span><span class="num" id="4733499">1</span><span class="op" id="4733500">]</span>&nbsp;<span class="op" id="4733502">!=</span>&nbsp;<span class="string" id="4733505">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4733509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733513">return</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733524">s</span>&nbsp;<span class="op" id="4733526">=</span>&nbsp;<span class="ident" id="4733528">s</span><span class="op" id="4733529">[</span><span class="num" id="4733530">1</span>&nbsp;<span class="op" id="4733532">:</span>&nbsp;<span class="builtinfunc" id="4733534">len</span><span class="op" id="4733537">(</span><span class="ident" id="4733538">s</span><span class="op" id="4733539">)</span><span class="op" id="4733540">-</span><span class="num" id="4733541">1</span><span class="op" id="4733542">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4733546">//&nbsp;Check&nbsp;for&nbsp;unusual&nbsp;characters.&nbsp;If&nbsp;there&nbsp;are&nbsp;none,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4733599">//&nbsp;then&nbsp;no&nbsp;unquoting&nbsp;is&nbsp;needed,&nbsp;so&nbsp;return&nbsp;a&nbsp;slice&nbsp;of&nbsp;the</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4733657">//&nbsp;original&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733677">r</span>&nbsp;<span class="op" id="4733679">:=</span>&nbsp;<span class="num" id="4733682">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733685">for</span>&nbsp;<span class="ident" id="4733689">r</span>&nbsp;<span class="op" id="4733691">&lt;</span>&nbsp;<span class="builtinfunc" id="4733693">len</span><span class="op" id="4733696">(</span><span class="ident" id="4733697">s</span><span class="op" id="4733698">)</span>&nbsp;<span class="op" id="4733700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733704">c</span>&nbsp;<span class="op" id="4733706">:=</span>&nbsp;<span class="ident" id="4733709">s</span><span class="op" id="4733710">[</span><span class="ident" id="4733711">r</span><span class="op" id="4733712">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733716">if</span>&nbsp;<span class="ident" id="4733719">c</span>&nbsp;<span class="op" id="4733721">==</span>&nbsp;<span class="string" id="4733724">&#39;\\&#39;</span>&nbsp;<span class="op" id="4733729">||</span>&nbsp;<span class="ident" id="4733732">c</span>&nbsp;<span class="op" id="4733734">==</span>&nbsp;<span class="string" id="4733737">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4733741">||</span>&nbsp;<span class="ident" id="4733744">c</span>&nbsp;<span class="op" id="4733746">&lt;</span>&nbsp;<span class="string" id="4733748">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4733752">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733757">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733769">if</span>&nbsp;<span class="ident" id="4733772">c</span>&nbsp;<span class="op" id="4733774">&lt;</span>&nbsp;<span class="ident" id="4733776">utf8</span><span class="op" id="4733780">.</span><span class="ident" id="4733781">RuneSelf</span>&nbsp;<span class="op" id="4733790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733795">r</span><span class="op" id="4733796">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733802">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733817">rr</span><span class="op" id="4733819">,</span>&nbsp;<span class="ident" id="4733821">size</span>&nbsp;<span class="op" id="4733826">:=</span>&nbsp;<span class="ident" id="4733829">utf8</span><span class="op" id="4733833">.</span><span class="ident" id="4733834">DecodeRune</span><span class="op" id="4733844">(</span><span class="ident" id="4733845">s</span><span class="op" id="4733846">[</span><span class="ident" id="4733847">r</span><span class="op" id="4733848">:</span><span class="op" id="4733849">]</span><span class="op" id="4733850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733854">if</span>&nbsp;<span class="ident" id="4733857">rr</span>&nbsp;<span class="op" id="4733860">==</span>&nbsp;<span class="ident" id="4733863">utf8</span><span class="op" id="4733867">.</span><span class="ident" id="4733868">RuneError</span>&nbsp;<span class="op" id="4733878">&amp;&amp;</span>&nbsp;<span class="ident" id="4733881">size</span>&nbsp;<span class="op" id="4733886">==</span>&nbsp;<span class="num" id="4733889">1</span>&nbsp;<span class="op" id="4733891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733896">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733904">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733908">r</span>&nbsp;<span class="op" id="4733910">+=</span>&nbsp;<span class="ident" id="4733913">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733922">if</span>&nbsp;<span class="ident" id="4733925">r</span>&nbsp;<span class="op" id="4733927">==</span>&nbsp;<span class="builtinfunc" id="4733930">len</span><span class="op" id="4733933">(</span><span class="ident" id="4733934">s</span><span class="op" id="4733935">)</span>&nbsp;<span class="op" id="4733937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4733941">return</span>&nbsp;<span class="ident" id="4733948">s</span><span class="op" id="4733949">,</span>&nbsp;<span class="ident" id="4733951">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4733957">}</span><br>
<span class="lineno">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4733961">b</span>&nbsp;<span class="op" id="4733963">:=</span>&nbsp;<span class="builtinfunc" id="4733966">make</span><span class="op" id="4733970">(</span><span class="op" id="4733971">[</span><span class="op" id="4733972">]</span><span class="builtintype" id="4733973">byte</span><span class="op" id="4733977">,</span>&nbsp;<span class="builtinfunc" id="4733979">len</span><span class="op" id="4733982">(</span><span class="ident" id="4733983">s</span><span class="op" id="4733984">)</span><span class="op" id="4733985">+</span><span class="num" id="4733986">2</span><span class="op" id="4733987">*</span><span class="ident" id="4733988">utf8</span><span class="op" id="4733992">.</span><span class="ident" id="4733993">UTFMax</span><span class="op" id="4733999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734002">w</span>&nbsp;<span class="op" id="4734004">:=</span>&nbsp;<span class="builtinfunc" id="4734007">copy</span><span class="op" id="4734011">(</span><span class="ident" id="4734012">b</span><span class="op" id="4734013">,</span>&nbsp;<span class="ident" id="4734015">s</span><span class="op" id="4734016">[</span><span class="num" id="4734017">0</span><span class="op" id="4734018">:</span><span class="ident" id="4734019">r</span><span class="op" id="4734020">]</span><span class="op" id="4734021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734024">for</span>&nbsp;<span class="ident" id="4734028">r</span>&nbsp;<span class="op" id="4734030">&lt;</span>&nbsp;<span class="builtinfunc" id="4734032">len</span><span class="op" id="4734035">(</span><span class="ident" id="4734036">s</span><span class="op" id="4734037">)</span>&nbsp;<span class="op" id="4734039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4734043">//&nbsp;Out&nbsp;of&nbsp;room?&nbsp;&nbsp;Can&nbsp;only&nbsp;happen&nbsp;if&nbsp;s&nbsp;is&nbsp;full&nbsp;of</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4734094">//&nbsp;malformed&nbsp;UTF-8&nbsp;and&nbsp;we&#39;re&nbsp;replacing&nbsp;each</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4734140">//&nbsp;byte&nbsp;with&nbsp;RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734166">if</span>&nbsp;<span class="ident" id="4734169">w</span>&nbsp;<span class="op" id="4734171">&gt;=</span>&nbsp;<span class="builtinfunc" id="4734174">len</span><span class="op" id="4734177">(</span><span class="ident" id="4734178">b</span><span class="op" id="4734179">)</span><span class="op" id="4734180">-</span><span class="num" id="4734181">2</span><span class="op" id="4734182">*</span><span class="ident" id="4734183">utf8</span><span class="op" id="4734187">.</span><span class="ident" id="4734188">UTFMax</span>&nbsp;<span class="op" id="4734195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734200">nb</span>&nbsp;<span class="op" id="4734203">:=</span>&nbsp;<span class="builtinfunc" id="4734206">make</span><span class="op" id="4734210">(</span><span class="op" id="4734211">[</span><span class="op" id="4734212">]</span><span class="builtintype" id="4734213">byte</span><span class="op" id="4734217">,</span>&nbsp;<span class="op" id="4734219">(</span><span class="builtinfunc" id="4734220">len</span><span class="op" id="4734223">(</span><span class="ident" id="4734224">b</span><span class="op" id="4734225">)</span><span class="op" id="4734226">+</span><span class="ident" id="4734227">utf8</span><span class="op" id="4734231">.</span><span class="ident" id="4734232">UTFMax</span><span class="op" id="4734238">)</span><span class="op" id="4734239">*</span><span class="num" id="4734240">2</span><span class="op" id="4734241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4734246">copy</span><span class="op" id="4734250">(</span><span class="ident" id="4734251">nb</span><span class="op" id="4734253">,</span>&nbsp;<span class="ident" id="4734255">b</span><span class="op" id="4734256">[</span><span class="num" id="4734257">0</span><span class="op" id="4734258">:</span><span class="ident" id="4734259">w</span><span class="op" id="4734260">]</span><span class="op" id="4734261">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734266">b</span>&nbsp;<span class="op" id="4734268">=</span>&nbsp;<span class="ident" id="4734270">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4734275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734279">switch</span>&nbsp;<span class="ident" id="4734286">c</span>&nbsp;<span class="op" id="4734288">:=</span>&nbsp;<span class="ident" id="4734291">s</span><span class="op" id="4734292">[</span><span class="ident" id="4734293">r</span><span class="op" id="4734294">]</span><span class="op" id="4734295">;</span>&nbsp;<span class="op" id="4734297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734301">case</span>&nbsp;<span class="ident" id="4734306">c</span>&nbsp;<span class="op" id="4734308">==</span>&nbsp;<span class="string" id="4734311">&#39;\\&#39;</span><span class="op" id="4734315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734320">r</span><span class="op" id="4734321">++</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734327">if</span>&nbsp;<span class="ident" id="4734330">r</span>&nbsp;<span class="op" id="4734332">&gt;=</span>&nbsp;<span class="builtinfunc" id="4734335">len</span><span class="op" id="4734338">(</span><span class="ident" id="4734339">s</span><span class="op" id="4734340">)</span>&nbsp;<span class="op" id="4734342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734348">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4734358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734363">switch</span>&nbsp;<span class="ident" id="4734370">s</span><span class="op" id="4734371">[</span><span class="ident" id="4734372">r</span><span class="op" id="4734373">]</span>&nbsp;<span class="op" id="4734375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734380">default</span><span class="op" id="4734387">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734393">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734403">case</span>&nbsp;<span class="string" id="4734408">&#39;&#34;&#39;</span><span class="op" id="4734411">,</span>&nbsp;<span class="string" id="4734413">&#39;\\&#39;</span><span class="op" id="4734417">,</span>&nbsp;<span class="string" id="4734419">&#39;/&#39;</span><span class="op" id="4734422">,</span>&nbsp;<span class="string" id="4734424">&#39;\&#39;&#39;</span><span class="op" id="4734428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734434">b</span><span class="op" id="4734435">[</span><span class="ident" id="4734436">w</span><span class="op" id="4734437">]</span>&nbsp;<span class="op" id="4734439">=</span>&nbsp;<span class="ident" id="4734441">s</span><span class="op" id="4734442">[</span><span class="ident" id="4734443">r</span><span class="op" id="4734444">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734450">r</span><span class="op" id="4734451">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734458">w</span><span class="op" id="4734459">++</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734465">case</span>&nbsp;<span class="string" id="4734470">&#39;b&#39;</span><span class="op" id="4734473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734479">b</span><span class="op" id="4734480">[</span><span class="ident" id="4734481">w</span><span class="op" id="4734482">]</span>&nbsp;<span class="op" id="4734484">=</span>&nbsp;<span class="string" id="4734486">&#39;\b&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734495">r</span><span class="op" id="4734496">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734503">w</span><span class="op" id="4734504">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734510">case</span>&nbsp;<span class="string" id="4734515">&#39;f&#39;</span><span class="op" id="4734518">:</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734524">b</span><span class="op" id="4734525">[</span><span class="ident" id="4734526">w</span><span class="op" id="4734527">]</span>&nbsp;<span class="op" id="4734529">=</span>&nbsp;<span class="string" id="4734531">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734540">r</span><span class="op" id="4734541">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734548">w</span><span class="op" id="4734549">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734555">case</span>&nbsp;<span class="string" id="4734560">&#39;n&#39;</span><span class="op" id="4734563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734569">b</span><span class="op" id="4734570">[</span><span class="ident" id="4734571">w</span><span class="op" id="4734572">]</span>&nbsp;<span class="op" id="4734574">=</span>&nbsp;<span class="string" id="4734576">&#39;\n&#39;</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734585">r</span><span class="op" id="4734586">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734593">w</span><span class="op" id="4734594">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734600">case</span>&nbsp;<span class="string" id="4734605">&#39;r&#39;</span><span class="op" id="4734608">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734614">b</span><span class="op" id="4734615">[</span><span class="ident" id="4734616">w</span><span class="op" id="4734617">]</span>&nbsp;<span class="op" id="4734619">=</span>&nbsp;<span class="string" id="4734621">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734630">r</span><span class="op" id="4734631">++</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734638">w</span><span class="op" id="4734639">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734645">case</span>&nbsp;<span class="string" id="4734650">&#39;t&#39;</span><span class="op" id="4734653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734659">b</span><span class="op" id="4734660">[</span><span class="ident" id="4734661">w</span><span class="op" id="4734662">]</span>&nbsp;<span class="op" id="4734664">=</span>&nbsp;<span class="string" id="4734666">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734675">r</span><span class="op" id="4734676">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734683">w</span><span class="op" id="4734684">++</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734690">case</span>&nbsp;<span class="string" id="4734695">&#39;u&#39;</span><span class="op" id="4734698">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734704">r</span><span class="op" id="4734705">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734712">rr</span>&nbsp;<span class="op" id="4734715">:=</span>&nbsp;<span class="ident" id="4734718">getu4</span><span class="op" id="4734723">(</span><span class="ident" id="4734724">s</span><span class="op" id="4734725">[</span><span class="ident" id="4734726">r</span><span class="op" id="4734727">:</span><span class="op" id="4734728">]</span><span class="op" id="4734729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734735">if</span>&nbsp;<span class="ident" id="4734738">rr</span>&nbsp;<span class="op" id="4734741">&lt;</span>&nbsp;<span class="num" id="4734743">0</span>&nbsp;<span class="op" id="4734745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734752">return</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4734763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734769">r</span>&nbsp;<span class="op" id="4734771">+=</span>&nbsp;<span class="num" id="4734774">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734780">if</span>&nbsp;<span class="ident" id="4734783">utf16</span><span class="op" id="4734788">.</span><span class="ident" id="4734789">IsSurrogate</span><span class="op" id="4734800">(</span><span class="ident" id="4734801">rr</span><span class="op" id="4734803">)</span>&nbsp;<span class="op" id="4734805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734812">rr1</span>&nbsp;<span class="op" id="4734816">:=</span>&nbsp;<span class="ident" id="4734819">getu4</span><span class="op" id="4734824">(</span><span class="ident" id="4734825">s</span><span class="op" id="4734826">[</span><span class="ident" id="4734827">r</span><span class="op" id="4734828">:</span><span class="op" id="4734829">]</span><span class="op" id="4734830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734837">if</span>&nbsp;<span class="ident" id="4734840">dec</span>&nbsp;<span class="op" id="4734844">:=</span>&nbsp;<span class="ident" id="4734847">utf16</span><span class="op" id="4734852">.</span><span class="ident" id="4734853">DecodeRune</span><span class="op" id="4734863">(</span><span class="ident" id="4734864">rr</span><span class="op" id="4734866">,</span>&nbsp;<span class="ident" id="4734868">rr1</span><span class="op" id="4734871">)</span><span class="op" id="4734872">;</span>&nbsp;<span class="ident" id="4734874">dec</span>&nbsp;<span class="op" id="4734878">!=</span>&nbsp;<span class="ident" id="4734881">unicode</span><span class="op" id="4734888">.</span><span class="ident" id="4734889">ReplacementChar</span>&nbsp;<span class="op" id="4734905">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4734913">//&nbsp;A&nbsp;valid&nbsp;pair;&nbsp;consume.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734945">r</span>&nbsp;<span class="op" id="4734947">+=</span>&nbsp;<span class="num" id="4734950">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4734958">w</span>&nbsp;<span class="op" id="4734960">+=</span>&nbsp;<span class="ident" id="4734963">utf8</span><span class="op" id="4734967">.</span><span class="ident" id="4734968">EncodeRune</span><span class="op" id="4734978">(</span><span class="ident" id="4734979">b</span><span class="op" id="4734980">[</span><span class="ident" id="4734981">w</span><span class="op" id="4734982">:</span><span class="op" id="4734983">]</span><span class="op" id="4734984">,</span>&nbsp;<span class="ident" id="4734986">dec</span><span class="op" id="4734989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4734997">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735008">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4735015">//&nbsp;Invalid&nbsp;surrogate;&nbsp;fall&nbsp;back&nbsp;to&nbsp;replacement&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735073">rr</span>&nbsp;<span class="op" id="4735076">=</span>&nbsp;<span class="ident" id="4735078">unicode</span><span class="op" id="4735085">.</span><span class="ident" id="4735086">ReplacementChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735112">w</span>&nbsp;<span class="op" id="4735114">+=</span>&nbsp;<span class="ident" id="4735117">utf8</span><span class="op" id="4735121">.</span><span class="ident" id="4735122">EncodeRune</span><span class="op" id="4735132">(</span><span class="ident" id="4735133">b</span><span class="op" id="4735134">[</span><span class="ident" id="4735135">w</span><span class="op" id="4735136">:</span><span class="op" id="4735137">]</span><span class="op" id="4735138">,</span>&nbsp;<span class="ident" id="4735140">rr</span><span class="op" id="4735142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735147">}</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4735152">//&nbsp;Quote,&nbsp;control&nbsp;characters&nbsp;are&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735196">case</span>&nbsp;<span class="ident" id="4735201">c</span>&nbsp;<span class="op" id="4735203">==</span>&nbsp;<span class="string" id="4735206">&#39;&#34;&#39;</span><span class="op" id="4735209">,</span>&nbsp;<span class="ident" id="4735211">c</span>&nbsp;<span class="op" id="4735213">&lt;</span>&nbsp;<span class="string" id="4735215">&#39;&nbsp;&#39;</span><span class="op" id="4735218">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735223">return</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4735233">//&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735244">case</span>&nbsp;<span class="ident" id="4735249">c</span>&nbsp;<span class="op" id="4735251">&lt;</span>&nbsp;<span class="ident" id="4735253">utf8</span><span class="op" id="4735257">.</span><span class="ident" id="4735258">RuneSelf</span><span class="op" id="4735266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735271">b</span><span class="op" id="4735272">[</span><span class="ident" id="4735273">w</span><span class="op" id="4735274">]</span>&nbsp;<span class="op" id="4735276">=</span>&nbsp;<span class="ident" id="4735278">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735283">r</span><span class="op" id="4735284">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735290">w</span><span class="op" id="4735291">++</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4735297">//&nbsp;Coerce&nbsp;to&nbsp;well-formed&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735331">default</span><span class="op" id="4735338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735343">rr</span><span class="op" id="4735345">,</span>&nbsp;<span class="ident" id="4735347">size</span>&nbsp;<span class="op" id="4735352">:=</span>&nbsp;<span class="ident" id="4735355">utf8</span><span class="op" id="4735359">.</span><span class="ident" id="4735360">DecodeRune</span><span class="op" id="4735370">(</span><span class="ident" id="4735371">s</span><span class="op" id="4735372">[</span><span class="ident" id="4735373">r</span><span class="op" id="4735374">:</span><span class="op" id="4735375">]</span><span class="op" id="4735376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735381">r</span>&nbsp;<span class="op" id="4735383">+=</span>&nbsp;<span class="ident" id="4735386">size</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4735394">w</span>&nbsp;<span class="op" id="4735396">+=</span>&nbsp;<span class="ident" id="4735399">utf8</span><span class="op" id="4735403">.</span><span class="ident" id="4735404">EncodeRune</span><span class="op" id="4735414">(</span><span class="ident" id="4735415">b</span><span class="op" id="4735416">[</span><span class="ident" id="4735417">w</span><span class="op" id="4735418">:</span><span class="op" id="4735419">]</span><span class="op" id="4735420">,</span>&nbsp;<span class="ident" id="4735422">rr</span><span class="op" id="4735424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4735431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4735434">return</span>&nbsp;<span class="ident" id="4735441">b</span><span class="op" id="4735442">[</span><span class="num" id="4735443">0</span><span class="op" id="4735444">:</span><span class="ident" id="4735445">w</span><span class="op" id="4735446">]</span><span class="op" id="4735447">,</span>&nbsp;<span class="ident" id="4735449">true</span><br>
<span class="lineno"></span><span class="op" id="4735454">}</span>
</div>
</body>
</html>
