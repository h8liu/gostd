<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html" class="current">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8137301">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8137357">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8137411">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8137462">package</span>&nbsp;<span class="ident" id="8137470">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8137475">import</span>&nbsp;<span class="op" id="8137482">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8137485">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8137496">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8137507">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8137518">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8137529">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8137536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8137539">func</span>&nbsp;<span class="ident" id="8137544">TestResolveUDPAddr</span><span class="op" id="8137562">(</span><span class="ident" id="8137563">t</span>&nbsp;<span class="op" id="8137565">*</span><span class="ident" id="8137566">testing</span><span class="op" id="8137573">.</span><span class="ident" id="8137574">T</span><span class="op" id="8137575">)</span>&nbsp;<span class="op" id="8137577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137580">for</span>&nbsp;<span class="ident" id="8137584">_</span><span class="op" id="8137585">,</span>&nbsp;<span class="ident" id="8137587">tt</span>&nbsp;<span class="op" id="8137590">:=</span>&nbsp;<span class="keyword" id="8137593">range</span>&nbsp;<span class="ident" id="8137599">resolveTCPAddrTests</span>&nbsp;<span class="op" id="8137619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137623">net</span>&nbsp;<span class="op" id="8137627">:=</span>&nbsp;<span class="ident" id="8137630">strings</span><span class="op" id="8137637">.</span><span class="ident" id="8137638">Replace</span><span class="op" id="8137645">(</span><span class="ident" id="8137646">tt</span><span class="op" id="8137648">.</span><span class="ident" id="8137649">net</span><span class="op" id="8137652">,</span>&nbsp;<span class="string" id="8137654">&#34;tcp&#34;</span><span class="op" id="8137659">,</span>&nbsp;<span class="string" id="8137661">&#34;udp&#34;</span><span class="op" id="8137666">,</span>&nbsp;<span class="op" id="8137668">-</span><span class="num" id="8137669">1</span><span class="op" id="8137670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137674">addr</span><span class="op" id="8137678">,</span>&nbsp;<span class="ident" id="8137680">err</span>&nbsp;<span class="op" id="8137684">:=</span>&nbsp;<span class="ident" id="8137687">ResolveUDPAddr</span><span class="op" id="8137701">(</span><span class="ident" id="8137702">net</span><span class="op" id="8137705">,</span>&nbsp;<span class="ident" id="8137707">tt</span><span class="op" id="8137709">.</span><span class="ident" id="8137710">litAddrOrName</span><span class="op" id="8137723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137727">if</span>&nbsp;<span class="ident" id="8137730">err</span>&nbsp;<span class="op" id="8137734">!=</span>&nbsp;<span class="ident" id="8137737">tt</span><span class="op" id="8137739">.</span><span class="ident" id="8137740">err</span>&nbsp;<span class="op" id="8137744">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137749">t</span><span class="op" id="8137750">.</span><span class="ident" id="8137751">Fatalf</span><span class="op" id="8137757">(</span><span class="string" id="8137758">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8137793">,</span>&nbsp;<span class="ident" id="8137795">net</span><span class="op" id="8137798">,</span>&nbsp;<span class="ident" id="8137800">tt</span><span class="op" id="8137802">.</span><span class="ident" id="8137803">litAddrOrName</span><span class="op" id="8137816">,</span>&nbsp;<span class="ident" id="8137818">err</span><span class="op" id="8137821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137829">if</span>&nbsp;<span class="op" id="8137832">!</span><span class="ident" id="8137833">reflect</span><span class="op" id="8137840">.</span><span class="ident" id="8137841">DeepEqual</span><span class="op" id="8137850">(</span><span class="ident" id="8137851">addr</span><span class="op" id="8137855">,</span>&nbsp;<span class="op" id="8137857">(</span><span class="op" id="8137858">*</span><span class="ident" id="8137859">UDPAddr</span><span class="op" id="8137866">)</span><span class="op" id="8137867">(</span><span class="ident" id="8137868">tt</span><span class="op" id="8137870">.</span><span class="ident" id="8137871">addr</span><span class="op" id="8137875">)</span><span class="op" id="8137876">)</span>&nbsp;<span class="op" id="8137878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137883">t</span><span class="op" id="8137884">.</span><span class="ident" id="8137885">Fatalf</span><span class="op" id="8137891">(</span><span class="string" id="8137892">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8137932">,</span>&nbsp;<span class="ident" id="8137934">net</span><span class="op" id="8137937">,</span>&nbsp;<span class="ident" id="8137939">tt</span><span class="op" id="8137941">.</span><span class="ident" id="8137942">litAddrOrName</span><span class="op" id="8137955">,</span>&nbsp;<span class="ident" id="8137957">addr</span><span class="op" id="8137961">,</span>&nbsp;<span class="ident" id="8137963">tt</span><span class="op" id="8137965">.</span><span class="ident" id="8137966">addr</span><span class="op" id="8137970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8137974">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8137978">if</span>&nbsp;<span class="ident" id="8137981">err</span>&nbsp;<span class="op" id="8137985">==</span>&nbsp;<span class="ident" id="8137988">nil</span>&nbsp;<span class="op" id="8137992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8137997">str</span>&nbsp;<span class="op" id="8138001">:=</span>&nbsp;<span class="ident" id="8138004">addr</span><span class="op" id="8138008">.</span><span class="ident" id="8138009">String</span><span class="op" id="8138015">(</span><span class="op" id="8138016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138021">addr1</span><span class="op" id="8138026">,</span>&nbsp;<span class="ident" id="8138028">err</span>&nbsp;<span class="op" id="8138032">:=</span>&nbsp;<span class="ident" id="8138035">ResolveUDPAddr</span><span class="op" id="8138049">(</span><span class="ident" id="8138050">net</span><span class="op" id="8138053">,</span>&nbsp;<span class="ident" id="8138055">str</span><span class="op" id="8138058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138063">if</span>&nbsp;<span class="ident" id="8138066">err</span>&nbsp;<span class="op" id="8138070">!=</span>&nbsp;<span class="ident" id="8138073">nil</span>&nbsp;<span class="op" id="8138077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138083">t</span><span class="op" id="8138084">.</span><span class="ident" id="8138085">Fatalf</span><span class="op" id="8138091">(</span><span class="string" id="8138092">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="8138130">,</span>&nbsp;<span class="ident" id="8138132">net</span><span class="op" id="8138135">,</span>&nbsp;<span class="ident" id="8138137">str</span><span class="op" id="8138140">,</span>&nbsp;<span class="ident" id="8138142">tt</span><span class="op" id="8138144">.</span><span class="ident" id="8138145">litAddrOrName</span><span class="op" id="8138158">,</span>&nbsp;<span class="ident" id="8138160">err</span><span class="op" id="8138163">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138173">if</span>&nbsp;<span class="op" id="8138176">!</span><span class="ident" id="8138177">reflect</span><span class="op" id="8138184">.</span><span class="ident" id="8138185">DeepEqual</span><span class="op" id="8138194">(</span><span class="ident" id="8138195">addr1</span><span class="op" id="8138200">,</span>&nbsp;<span class="ident" id="8138202">addr</span><span class="op" id="8138206">)</span>&nbsp;<span class="op" id="8138208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138214">t</span><span class="op" id="8138215">.</span><span class="ident" id="8138216">Fatalf</span><span class="op" id="8138222">(</span><span class="string" id="8138223">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8138273">,</span>&nbsp;<span class="ident" id="8138275">net</span><span class="op" id="8138278">,</span>&nbsp;<span class="ident" id="8138280">str</span><span class="op" id="8138283">,</span>&nbsp;<span class="ident" id="8138285">tt</span><span class="op" id="8138287">.</span><span class="ident" id="8138288">litAddrOrName</span><span class="op" id="8138301">,</span>&nbsp;<span class="ident" id="8138303">addr1</span><span class="op" id="8138308">,</span>&nbsp;<span class="ident" id="8138310">addr</span><span class="op" id="8138314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138323">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138326">}</span><br>
<span class="lineno"></span><span class="op" id="8138328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8138331">func</span>&nbsp;<span class="ident" id="8138336">TestReadFromUDP</span><span class="op" id="8138351">(</span><span class="ident" id="8138352">t</span>&nbsp;<span class="op" id="8138354">*</span><span class="ident" id="8138355">testing</span><span class="op" id="8138362">.</span><span class="ident" id="8138363">T</span><span class="op" id="8138364">)</span>&nbsp;<span class="op" id="8138366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138369">switch</span>&nbsp;<span class="ident" id="8138376">runtime</span><span class="op" id="8138383">.</span><span class="ident" id="8138384">GOOS</span>&nbsp;<span class="op" id="8138389">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138392">case</span>&nbsp;<span class="string" id="8138397">&#34;nacl&#34;</span><span class="op" id="8138403">,</span>&nbsp;<span class="string" id="8138405">&#34;plan9&#34;</span><span class="op" id="8138412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138416">t</span><span class="op" id="8138417">.</span><span class="ident" id="8138418">Skipf</span><span class="op" id="8138423">(</span><span class="string" id="8138424">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="8138461">,</span>&nbsp;<span class="ident" id="8138463">runtime</span><span class="op" id="8138470">.</span><span class="ident" id="8138471">GOOS</span><span class="op" id="8138475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138482">ra</span><span class="op" id="8138484">,</span>&nbsp;<span class="ident" id="8138486">err</span>&nbsp;<span class="op" id="8138490">:=</span>&nbsp;<span class="ident" id="8138493">ResolveUDPAddr</span><span class="op" id="8138507">(</span><span class="string" id="8138508">&#34;udp&#34;</span><span class="op" id="8138513">,</span>&nbsp;<span class="string" id="8138515">&#34;127.0.0.1:7&#34;</span><span class="op" id="8138528">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138531">if</span>&nbsp;<span class="ident" id="8138534">err</span>&nbsp;<span class="op" id="8138538">!=</span>&nbsp;<span class="ident" id="8138541">nil</span>&nbsp;<span class="op" id="8138545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138549">t</span><span class="op" id="8138550">.</span><span class="ident" id="8138551">Fatal</span><span class="op" id="8138556">(</span><span class="ident" id="8138557">err</span><span class="op" id="8138560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138567">la</span><span class="op" id="8138569">,</span>&nbsp;<span class="ident" id="8138571">err</span>&nbsp;<span class="op" id="8138575">:=</span>&nbsp;<span class="ident" id="8138578">ResolveUDPAddr</span><span class="op" id="8138592">(</span><span class="string" id="8138593">&#34;udp&#34;</span><span class="op" id="8138598">,</span>&nbsp;<span class="string" id="8138600">&#34;127.0.0.1:0&#34;</span><span class="op" id="8138613">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138616">if</span>&nbsp;<span class="ident" id="8138619">err</span>&nbsp;<span class="op" id="8138623">!=</span>&nbsp;<span class="ident" id="8138626">nil</span>&nbsp;<span class="op" id="8138630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138634">t</span><span class="op" id="8138635">.</span><span class="ident" id="8138636">Fatal</span><span class="op" id="8138641">(</span><span class="ident" id="8138642">err</span><span class="op" id="8138645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138652">c</span><span class="op" id="8138653">,</span>&nbsp;<span class="ident" id="8138655">err</span>&nbsp;<span class="op" id="8138659">:=</span>&nbsp;<span class="ident" id="8138662">ListenUDP</span><span class="op" id="8138671">(</span><span class="string" id="8138672">&#34;udp&#34;</span><span class="op" id="8138677">,</span>&nbsp;<span class="ident" id="8138679">la</span><span class="op" id="8138681">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138684">if</span>&nbsp;<span class="ident" id="8138687">err</span>&nbsp;<span class="op" id="8138691">!=</span>&nbsp;<span class="ident" id="8138694">nil</span>&nbsp;<span class="op" id="8138698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138702">t</span><span class="op" id="8138703">.</span><span class="ident" id="8138704">Fatal</span><span class="op" id="8138709">(</span><span class="ident" id="8138710">err</span><span class="op" id="8138713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138719">defer</span>&nbsp;<span class="ident" id="8138725">c</span><span class="op" id="8138726">.</span><span class="ident" id="8138727">Close</span><span class="op" id="8138732">(</span><span class="op" id="8138733">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138737">_</span><span class="op" id="8138738">,</span>&nbsp;<span class="ident" id="8138740">err</span>&nbsp;<span class="op" id="8138744">=</span>&nbsp;<span class="ident" id="8138746">c</span><span class="op" id="8138747">.</span><span class="ident" id="8138748">WriteToUDP</span><span class="op" id="8138758">(</span><span class="op" id="8138759">[</span><span class="op" id="8138760">]</span><span class="builtintype" id="8138761">byte</span><span class="op" id="8138765">(</span><span class="string" id="8138766">&#34;a&#34;</span><span class="op" id="8138769">)</span><span class="op" id="8138770">,</span>&nbsp;<span class="ident" id="8138772">ra</span><span class="op" id="8138774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138777">if</span>&nbsp;<span class="ident" id="8138780">err</span>&nbsp;<span class="op" id="8138784">!=</span>&nbsp;<span class="ident" id="8138787">nil</span>&nbsp;<span class="op" id="8138791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138795">t</span><span class="op" id="8138796">.</span><span class="ident" id="8138797">Fatal</span><span class="op" id="8138802">(</span><span class="ident" id="8138803">err</span><span class="op" id="8138806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138813">err</span>&nbsp;<span class="op" id="8138817">=</span>&nbsp;<span class="ident" id="8138819">c</span><span class="op" id="8138820">.</span><span class="ident" id="8138821">SetDeadline</span><span class="op" id="8138832">(</span><span class="ident" id="8138833">time</span><span class="op" id="8138837">.</span><span class="ident" id="8138838">Now</span><span class="op" id="8138841">(</span><span class="op" id="8138842">)</span><span class="op" id="8138843">.</span><span class="ident" id="8138844">Add</span><span class="op" id="8138847">(</span><span class="num" id="8138848">100</span>&nbsp;<span class="op" id="8138852">*</span>&nbsp;<span class="ident" id="8138854">time</span><span class="op" id="8138858">.</span><span class="ident" id="8138859">Millisecond</span><span class="op" id="8138870">)</span><span class="op" id="8138871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138874">if</span>&nbsp;<span class="ident" id="8138877">err</span>&nbsp;<span class="op" id="8138881">!=</span>&nbsp;<span class="ident" id="8138884">nil</span>&nbsp;<span class="op" id="8138888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138892">t</span><span class="op" id="8138893">.</span><span class="ident" id="8138894">Fatal</span><span class="op" id="8138899">(</span><span class="ident" id="8138900">err</span><span class="op" id="8138903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8138906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138909">b</span>&nbsp;<span class="op" id="8138911">:=</span>&nbsp;<span class="builtinfunc" id="8138914">make</span><span class="op" id="8138918">(</span><span class="op" id="8138919">[</span><span class="op" id="8138920">]</span><span class="builtintype" id="8138921">byte</span><span class="op" id="8138925">,</span>&nbsp;<span class="num" id="8138927">1</span><span class="op" id="8138928">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138931">_</span><span class="op" id="8138932">,</span>&nbsp;<span class="ident" id="8138934">_</span><span class="op" id="8138935">,</span>&nbsp;<span class="ident" id="8138937">err</span>&nbsp;<span class="op" id="8138941">=</span>&nbsp;<span class="ident" id="8138943">c</span><span class="op" id="8138944">.</span><span class="ident" id="8138945">ReadFromUDP</span><span class="op" id="8138956">(</span><span class="ident" id="8138957">b</span><span class="op" id="8138958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8138961">if</span>&nbsp;<span class="ident" id="8138964">err</span>&nbsp;<span class="op" id="8138968">==</span>&nbsp;<span class="ident" id="8138971">nil</span>&nbsp;<span class="op" id="8138975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8138979">t</span><span class="op" id="8138980">.</span><span class="ident" id="8138981">Fatal</span><span class="op" id="8138986">(</span><span class="string" id="8138987">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8139012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139015">}</span>&nbsp;<span class="keyword" id="8139017">else</span>&nbsp;<span class="keyword" id="8139022">if</span>&nbsp;<span class="op" id="8139025">!</span><span class="ident" id="8139026">isTimeout</span><span class="op" id="8139035">(</span><span class="ident" id="8139036">err</span><span class="op" id="8139039">)</span>&nbsp;<span class="op" id="8139041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139045">t</span><span class="op" id="8139046">.</span><span class="ident" id="8139047">Fatal</span><span class="op" id="8139052">(</span><span class="ident" id="8139053">err</span><span class="op" id="8139056">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139059">}</span><br>
<span class="lineno"></span><span class="op" id="8139061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8139064">func</span>&nbsp;<span class="ident" id="8139069">TestWriteToUDP</span><span class="op" id="8139083">(</span><span class="ident" id="8139084">t</span>&nbsp;<span class="op" id="8139086">*</span><span class="ident" id="8139087">testing</span><span class="op" id="8139094">.</span><span class="ident" id="8139095">T</span><span class="op" id="8139096">)</span>&nbsp;<span class="op" id="8139098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139101">switch</span>&nbsp;<span class="ident" id="8139108">runtime</span><span class="op" id="8139115">.</span><span class="ident" id="8139116">GOOS</span>&nbsp;<span class="op" id="8139121">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139124">case</span>&nbsp;<span class="string" id="8139129">&#34;plan9&#34;</span><span class="op" id="8139136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139140">t</span><span class="op" id="8139141">.</span><span class="ident" id="8139142">Skipf</span><span class="op" id="8139147">(</span><span class="string" id="8139148">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8139169">,</span>&nbsp;<span class="ident" id="8139171">runtime</span><span class="op" id="8139178">.</span><span class="ident" id="8139179">GOOS</span><span class="op" id="8139183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139190">l</span><span class="op" id="8139191">,</span>&nbsp;<span class="ident" id="8139193">err</span>&nbsp;<span class="op" id="8139197">:=</span>&nbsp;<span class="ident" id="8139200">ListenPacket</span><span class="op" id="8139212">(</span><span class="string" id="8139213">&#34;udp&#34;</span><span class="op" id="8139218">,</span>&nbsp;<span class="string" id="8139220">&#34;127.0.0.1:0&#34;</span><span class="op" id="8139233">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139236">if</span>&nbsp;<span class="ident" id="8139239">err</span>&nbsp;<span class="op" id="8139243">!=</span>&nbsp;<span class="ident" id="8139246">nil</span>&nbsp;<span class="op" id="8139250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139254">t</span><span class="op" id="8139255">.</span><span class="ident" id="8139256">Fatalf</span><span class="op" id="8139262">(</span><span class="string" id="8139263">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8139282">,</span>&nbsp;<span class="ident" id="8139284">err</span><span class="op" id="8139287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139293">defer</span>&nbsp;<span class="ident" id="8139299">l</span><span class="op" id="8139300">.</span><span class="ident" id="8139301">Close</span><span class="op" id="8139306">(</span><span class="op" id="8139307">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139311">testWriteToConn</span><span class="op" id="8139326">(</span><span class="ident" id="8139327">t</span><span class="op" id="8139328">,</span>&nbsp;<span class="ident" id="8139330">l</span><span class="op" id="8139331">.</span><span class="ident" id="8139332">LocalAddr</span><span class="op" id="8139341">(</span><span class="op" id="8139342">)</span><span class="op" id="8139343">.</span><span class="ident" id="8139344">String</span><span class="op" id="8139350">(</span><span class="op" id="8139351">)</span><span class="op" id="8139352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139355">testWriteToPacketConn</span><span class="op" id="8139376">(</span><span class="ident" id="8139377">t</span><span class="op" id="8139378">,</span>&nbsp;<span class="ident" id="8139380">l</span><span class="op" id="8139381">.</span><span class="ident" id="8139382">LocalAddr</span><span class="op" id="8139391">(</span><span class="op" id="8139392">)</span><span class="op" id="8139393">.</span><span class="ident" id="8139394">String</span><span class="op" id="8139400">(</span><span class="op" id="8139401">)</span><span class="op" id="8139402">)</span><br>
<span class="lineno"></span><span class="op" id="8139404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8139407">func</span>&nbsp;<span class="ident" id="8139412">testWriteToConn</span><span class="op" id="8139427">(</span><span class="ident" id="8139428">t</span>&nbsp;<span class="op" id="8139430">*</span><span class="ident" id="8139431">testing</span><span class="op" id="8139438">.</span><span class="ident" id="8139439">T</span><span class="op" id="8139440">,</span>&nbsp;<span class="ident" id="8139442">raddr</span>&nbsp;<span class="builtintype" id="8139448">string</span><span class="op" id="8139454">)</span>&nbsp;<span class="op" id="8139456">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139459">c</span><span class="op" id="8139460">,</span>&nbsp;<span class="ident" id="8139462">err</span>&nbsp;<span class="op" id="8139466">:=</span>&nbsp;<span class="ident" id="8139469">Dial</span><span class="op" id="8139473">(</span><span class="string" id="8139474">&#34;udp&#34;</span><span class="op" id="8139479">,</span>&nbsp;<span class="ident" id="8139481">raddr</span><span class="op" id="8139486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139489">if</span>&nbsp;<span class="ident" id="8139492">err</span>&nbsp;<span class="op" id="8139496">!=</span>&nbsp;<span class="ident" id="8139499">nil</span>&nbsp;<span class="op" id="8139503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139507">t</span><span class="op" id="8139508">.</span><span class="ident" id="8139509">Fatalf</span><span class="op" id="8139515">(</span><span class="string" id="8139516">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8139533">,</span>&nbsp;<span class="ident" id="8139535">err</span><span class="op" id="8139538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139544">defer</span>&nbsp;<span class="ident" id="8139550">c</span><span class="op" id="8139551">.</span><span class="ident" id="8139552">Close</span><span class="op" id="8139557">(</span><span class="op" id="8139558">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139562">ra</span><span class="op" id="8139564">,</span>&nbsp;<span class="ident" id="8139566">err</span>&nbsp;<span class="op" id="8139570">:=</span>&nbsp;<span class="ident" id="8139573">ResolveUDPAddr</span><span class="op" id="8139587">(</span><span class="string" id="8139588">&#34;udp&#34;</span><span class="op" id="8139593">,</span>&nbsp;<span class="ident" id="8139595">raddr</span><span class="op" id="8139600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139603">if</span>&nbsp;<span class="ident" id="8139606">err</span>&nbsp;<span class="op" id="8139610">!=</span>&nbsp;<span class="ident" id="8139613">nil</span>&nbsp;<span class="op" id="8139617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139621">t</span><span class="op" id="8139622">.</span><span class="ident" id="8139623">Fatalf</span><span class="op" id="8139629">(</span><span class="string" id="8139630">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8139657">,</span>&nbsp;<span class="ident" id="8139659">err</span><span class="op" id="8139662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139665">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139669">_</span><span class="op" id="8139670">,</span>&nbsp;<span class="ident" id="8139672">err</span>&nbsp;<span class="op" id="8139676">=</span>&nbsp;<span class="ident" id="8139678">c</span><span class="op" id="8139679">.</span><span class="op" id="8139680">(</span><span class="op" id="8139681">*</span><span class="ident" id="8139682">UDPConn</span><span class="op" id="8139689">)</span><span class="op" id="8139690">.</span><span class="ident" id="8139691">WriteToUDP</span><span class="op" id="8139701">(</span><span class="op" id="8139702">[</span><span class="op" id="8139703">]</span><span class="builtintype" id="8139704">byte</span><span class="op" id="8139708">(</span><span class="string" id="8139709">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8139742">)</span><span class="op" id="8139743">,</span>&nbsp;<span class="ident" id="8139745">ra</span><span class="op" id="8139747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139750">if</span>&nbsp;<span class="ident" id="8139753">err</span>&nbsp;<span class="op" id="8139757">==</span>&nbsp;<span class="ident" id="8139760">nil</span>&nbsp;<span class="op" id="8139764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139768">t</span><span class="op" id="8139769">.</span><span class="ident" id="8139770">Fatal</span><span class="op" id="8139775">(</span><span class="string" id="8139776">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8139800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139803">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8139806">if</span>&nbsp;<span class="ident" id="8139809">err</span>&nbsp;<span class="op" id="8139813">!=</span>&nbsp;<span class="ident" id="8139816">nil</span>&nbsp;<span class="op" id="8139820">&amp;&amp;</span>&nbsp;<span class="ident" id="8139823">err</span><span class="op" id="8139826">.</span><span class="op" id="8139827">(</span><span class="op" id="8139828">*</span><span class="ident" id="8139829">OpError</span><span class="op" id="8139836">)</span><span class="op" id="8139837">.</span><span class="ident" id="8139838">Err</span>&nbsp;<span class="op" id="8139842">!=</span>&nbsp;<span class="ident" id="8139845">ErrWriteToConnected</span>&nbsp;<span class="op" id="8139865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139869">t</span><span class="op" id="8139870">.</span><span class="ident" id="8139871">Fatalf</span><span class="op" id="8139877">(</span><span class="string" id="8139878">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="8139929">,</span>&nbsp;<span class="ident" id="8139931">err</span><span class="op" id="8139934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8139937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8139941">_</span><span class="op" id="8139942">,</span>&nbsp;<span class="ident" id="8139944">err</span>&nbsp;<span class="op" id="8139948">=</span>&nbsp;<span class="ident" id="8139950">c</span><span class="op" id="8139951">.</span><span class="op" id="8139952">(</span><span class="op" id="8139953">*</span><span class="ident" id="8139954">UDPConn</span><span class="op" id="8139961">)</span><span class="op" id="8139962">.</span><span class="ident" id="8139963">WriteTo</span><span class="op" id="8139970">(</span><span class="op" id="8139971">[</span><span class="op" id="8139972">]</span><span class="builtintype" id="8139973">byte</span><span class="op" id="8139977">(</span><span class="string" id="8139978">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8140011">)</span><span class="op" id="8140012">,</span>&nbsp;<span class="ident" id="8140014">ra</span><span class="op" id="8140016">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140019">if</span>&nbsp;<span class="ident" id="8140022">err</span>&nbsp;<span class="op" id="8140026">==</span>&nbsp;<span class="ident" id="8140029">nil</span>&nbsp;<span class="op" id="8140033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140037">t</span><span class="op" id="8140038">.</span><span class="ident" id="8140039">Fatal</span><span class="op" id="8140044">(</span><span class="string" id="8140045">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8140066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140072">if</span>&nbsp;<span class="ident" id="8140075">err</span>&nbsp;<span class="op" id="8140079">!=</span>&nbsp;<span class="ident" id="8140082">nil</span>&nbsp;<span class="op" id="8140086">&amp;&amp;</span>&nbsp;<span class="ident" id="8140089">err</span><span class="op" id="8140092">.</span><span class="op" id="8140093">(</span><span class="op" id="8140094">*</span><span class="ident" id="8140095">OpError</span><span class="op" id="8140102">)</span><span class="op" id="8140103">.</span><span class="ident" id="8140104">Err</span>&nbsp;<span class="op" id="8140108">!=</span>&nbsp;<span class="ident" id="8140111">ErrWriteToConnected</span>&nbsp;<span class="op" id="8140131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140135">t</span><span class="op" id="8140136">.</span><span class="ident" id="8140137">Fatalf</span><span class="op" id="8140143">(</span><span class="string" id="8140144">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="8140192">,</span>&nbsp;<span class="ident" id="8140194">err</span><span class="op" id="8140197">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140204">_</span><span class="op" id="8140205">,</span>&nbsp;<span class="ident" id="8140207">err</span>&nbsp;<span class="op" id="8140211">=</span>&nbsp;<span class="ident" id="8140213">c</span><span class="op" id="8140214">.</span><span class="ident" id="8140215">Write</span><span class="op" id="8140220">(</span><span class="op" id="8140221">[</span><span class="op" id="8140222">]</span><span class="builtintype" id="8140223">byte</span><span class="op" id="8140227">(</span><span class="string" id="8140228">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8140261">)</span><span class="op" id="8140262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140265">if</span>&nbsp;<span class="ident" id="8140268">err</span>&nbsp;<span class="op" id="8140272">!=</span>&nbsp;<span class="ident" id="8140275">nil</span>&nbsp;<span class="op" id="8140279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140283">t</span><span class="op" id="8140284">.</span><span class="ident" id="8140285">Fatalf</span><span class="op" id="8140291">(</span><span class="string" id="8140292">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8140310">,</span>&nbsp;<span class="ident" id="8140312">err</span><span class="op" id="8140315">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140318">}</span><br>
<span class="lineno"></span><span class="op" id="8140320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8140323">func</span>&nbsp;<span class="ident" id="8140328">testWriteToPacketConn</span><span class="op" id="8140349">(</span><span class="ident" id="8140350">t</span>&nbsp;<span class="op" id="8140352">*</span><span class="ident" id="8140353">testing</span><span class="op" id="8140360">.</span><span class="ident" id="8140361">T</span><span class="op" id="8140362">,</span>&nbsp;<span class="ident" id="8140364">raddr</span>&nbsp;<span class="builtintype" id="8140370">string</span><span class="op" id="8140376">)</span>&nbsp;<span class="op" id="8140378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140381">c</span><span class="op" id="8140382">,</span>&nbsp;<span class="ident" id="8140384">err</span>&nbsp;<span class="op" id="8140388">:=</span>&nbsp;<span class="ident" id="8140391">ListenPacket</span><span class="op" id="8140403">(</span><span class="string" id="8140404">&#34;udp&#34;</span><span class="op" id="8140409">,</span>&nbsp;<span class="string" id="8140411">&#34;127.0.0.1:0&#34;</span><span class="op" id="8140424">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140427">if</span>&nbsp;<span class="ident" id="8140430">err</span>&nbsp;<span class="op" id="8140434">!=</span>&nbsp;<span class="ident" id="8140437">nil</span>&nbsp;<span class="op" id="8140441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140445">t</span><span class="op" id="8140446">.</span><span class="ident" id="8140447">Fatalf</span><span class="op" id="8140453">(</span><span class="string" id="8140454">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8140479">,</span>&nbsp;<span class="ident" id="8140481">err</span><span class="op" id="8140484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140490">defer</span>&nbsp;<span class="ident" id="8140496">c</span><span class="op" id="8140497">.</span><span class="ident" id="8140498">Close</span><span class="op" id="8140503">(</span><span class="op" id="8140504">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140508">ra</span><span class="op" id="8140510">,</span>&nbsp;<span class="ident" id="8140512">err</span>&nbsp;<span class="op" id="8140516">:=</span>&nbsp;<span class="ident" id="8140519">ResolveUDPAddr</span><span class="op" id="8140533">(</span><span class="string" id="8140534">&#34;udp&#34;</span><span class="op" id="8140539">,</span>&nbsp;<span class="ident" id="8140541">raddr</span><span class="op" id="8140546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140549">if</span>&nbsp;<span class="ident" id="8140552">err</span>&nbsp;<span class="op" id="8140556">!=</span>&nbsp;<span class="ident" id="8140559">nil</span>&nbsp;<span class="op" id="8140563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140567">t</span><span class="op" id="8140568">.</span><span class="ident" id="8140569">Fatalf</span><span class="op" id="8140575">(</span><span class="string" id="8140576">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8140603">,</span>&nbsp;<span class="ident" id="8140605">err</span><span class="op" id="8140608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140615">_</span><span class="op" id="8140616">,</span>&nbsp;<span class="ident" id="8140618">err</span>&nbsp;<span class="op" id="8140622">=</span>&nbsp;<span class="ident" id="8140624">c</span><span class="op" id="8140625">.</span><span class="op" id="8140626">(</span><span class="op" id="8140627">*</span><span class="ident" id="8140628">UDPConn</span><span class="op" id="8140635">)</span><span class="op" id="8140636">.</span><span class="ident" id="8140637">WriteToUDP</span><span class="op" id="8140647">(</span><span class="op" id="8140648">[</span><span class="op" id="8140649">]</span><span class="builtintype" id="8140650">byte</span><span class="op" id="8140654">(</span><span class="string" id="8140655">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8140684">)</span><span class="op" id="8140685">,</span>&nbsp;<span class="ident" id="8140687">ra</span><span class="op" id="8140689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140692">if</span>&nbsp;<span class="ident" id="8140695">err</span>&nbsp;<span class="op" id="8140699">!=</span>&nbsp;<span class="ident" id="8140702">nil</span>&nbsp;<span class="op" id="8140706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140710">t</span><span class="op" id="8140711">.</span><span class="ident" id="8140712">Fatalf</span><span class="op" id="8140718">(</span><span class="string" id="8140719">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8140742">,</span>&nbsp;<span class="ident" id="8140744">err</span><span class="op" id="8140747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140754">_</span><span class="op" id="8140755">,</span>&nbsp;<span class="ident" id="8140757">err</span>&nbsp;<span class="op" id="8140761">=</span>&nbsp;<span class="ident" id="8140763">c</span><span class="op" id="8140764">.</span><span class="ident" id="8140765">WriteTo</span><span class="op" id="8140772">(</span><span class="op" id="8140773">[</span><span class="op" id="8140774">]</span><span class="builtintype" id="8140775">byte</span><span class="op" id="8140779">(</span><span class="string" id="8140780">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8140809">)</span><span class="op" id="8140810">,</span>&nbsp;<span class="ident" id="8140812">ra</span><span class="op" id="8140814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140817">if</span>&nbsp;<span class="ident" id="8140820">err</span>&nbsp;<span class="op" id="8140824">!=</span>&nbsp;<span class="ident" id="8140827">nil</span>&nbsp;<span class="op" id="8140831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140835">t</span><span class="op" id="8140836">.</span><span class="ident" id="8140837">Fatalf</span><span class="op" id="8140843">(</span><span class="string" id="8140844">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8140864">,</span>&nbsp;<span class="ident" id="8140866">err</span><span class="op" id="8140869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140876">_</span><span class="op" id="8140877">,</span>&nbsp;<span class="ident" id="8140879">err</span>&nbsp;<span class="op" id="8140883">=</span>&nbsp;<span class="ident" id="8140885">c</span><span class="op" id="8140886">.</span><span class="op" id="8140887">(</span><span class="op" id="8140888">*</span><span class="ident" id="8140889">UDPConn</span><span class="op" id="8140896">)</span><span class="op" id="8140897">.</span><span class="ident" id="8140898">Write</span><span class="op" id="8140903">(</span><span class="op" id="8140904">[</span><span class="op" id="8140905">]</span><span class="builtintype" id="8140906">byte</span><span class="op" id="8140910">(</span><span class="string" id="8140911">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8140940">)</span><span class="op" id="8140941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8140944">if</span>&nbsp;<span class="ident" id="8140947">err</span>&nbsp;<span class="op" id="8140951">==</span>&nbsp;<span class="ident" id="8140954">nil</span>&nbsp;<span class="op" id="8140958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8140962">t</span><span class="op" id="8140963">.</span><span class="ident" id="8140964">Fatal</span><span class="op" id="8140969">(</span><span class="string" id="8140970">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8140989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8140992">}</span><br>
<span class="lineno"></span><span class="op" id="8140994">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="8140997">var</span>&nbsp;<span class="ident" id="8141001">udpConnLocalNameTests</span>&nbsp;<span class="op" id="8141023">=</span>&nbsp;<span class="op" id="8141025">[</span><span class="op" id="8141026">]</span><span class="keyword" id="8141027">struct</span>&nbsp;<span class="op" id="8141034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141037">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8141043">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141051">laddr</span>&nbsp;<span class="op" id="8141057">*</span><span class="ident" id="8141058">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="8141066">}</span><span class="op" id="8141067">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141070">{</span><span class="string" id="8141071">&#34;udp4&#34;</span><span class="op" id="8141077">,</span>&nbsp;<span class="op" id="8141079">&amp;</span><span class="ident" id="8141080">UDPAddr</span><span class="op" id="8141087">{</span><span class="ident" id="8141088">IP</span><span class="op" id="8141090">:</span>&nbsp;<span class="ident" id="8141092">IPv4</span><span class="op" id="8141096">(</span><span class="num" id="8141097">127</span><span class="op" id="8141100">,</span>&nbsp;<span class="num" id="8141102">0</span><span class="op" id="8141103">,</span>&nbsp;<span class="num" id="8141105">0</span><span class="op" id="8141106">,</span>&nbsp;<span class="num" id="8141108">1</span><span class="op" id="8141109">)</span><span class="op" id="8141110">}</span><span class="op" id="8141111">}</span><span class="op" id="8141112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141115">{</span><span class="string" id="8141116">&#34;udp4&#34;</span><span class="op" id="8141122">,</span>&nbsp;<span class="op" id="8141124">&amp;</span><span class="ident" id="8141125">UDPAddr</span><span class="op" id="8141132">{</span><span class="op" id="8141133">}</span><span class="op" id="8141134">}</span><span class="op" id="8141135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141138">{</span><span class="string" id="8141139">&#34;udp4&#34;</span><span class="op" id="8141145">,</span>&nbsp;<span class="ident" id="8141147">nil</span><span class="op" id="8141150">}</span><span class="op" id="8141151">,</span><br>
<span class="lineno"></span><span class="op" id="8141153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="8141156">func</span>&nbsp;<span class="ident" id="8141161">TestUDPConnLocalName</span><span class="op" id="8141181">(</span><span class="ident" id="8141182">t</span>&nbsp;<span class="op" id="8141184">*</span><span class="ident" id="8141185">testing</span><span class="op" id="8141192">.</span><span class="ident" id="8141193">T</span><span class="op" id="8141194">)</span>&nbsp;<span class="op" id="8141196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141199">if</span>&nbsp;<span class="ident" id="8141202">testing</span><span class="op" id="8141209">.</span><span class="ident" id="8141210">Short</span><span class="op" id="8141215">(</span><span class="op" id="8141216">)</span>&nbsp;<span class="op" id="8141218">||</span>&nbsp;<span class="op" id="8141221">!</span><span class="op" id="8141222">*</span><span class="ident" id="8141223">testExternal</span>&nbsp;<span class="op" id="8141236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141240">t</span><span class="op" id="8141241">.</span><span class="ident" id="8141242">Skip</span><span class="op" id="8141246">(</span><span class="string" id="8141247">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8141288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141295">for</span>&nbsp;<span class="ident" id="8141299">_</span><span class="op" id="8141300">,</span>&nbsp;<span class="ident" id="8141302">tt</span>&nbsp;<span class="op" id="8141305">:=</span>&nbsp;<span class="keyword" id="8141308">range</span>&nbsp;<span class="ident" id="8141314">udpConnLocalNameTests</span>&nbsp;<span class="op" id="8141336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141340">c</span><span class="op" id="8141341">,</span>&nbsp;<span class="ident" id="8141343">err</span>&nbsp;<span class="op" id="8141347">:=</span>&nbsp;<span class="ident" id="8141350">ListenUDP</span><span class="op" id="8141359">(</span><span class="ident" id="8141360">tt</span><span class="op" id="8141362">.</span><span class="ident" id="8141363">net</span><span class="op" id="8141366">,</span>&nbsp;<span class="ident" id="8141368">tt</span><span class="op" id="8141370">.</span><span class="ident" id="8141371">laddr</span><span class="op" id="8141376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141380">if</span>&nbsp;<span class="ident" id="8141383">err</span>&nbsp;<span class="op" id="8141387">!=</span>&nbsp;<span class="ident" id="8141390">nil</span>&nbsp;<span class="op" id="8141394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141399">t</span><span class="op" id="8141400">.</span><span class="ident" id="8141401">Fatalf</span><span class="op" id="8141407">(</span><span class="string" id="8141408">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8141430">,</span>&nbsp;<span class="ident" id="8141432">err</span><span class="op" id="8141435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141439">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141443">defer</span>&nbsp;<span class="ident" id="8141449">c</span><span class="op" id="8141450">.</span><span class="ident" id="8141451">Close</span><span class="op" id="8141456">(</span><span class="op" id="8141457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141461">la</span>&nbsp;<span class="op" id="8141464">:=</span>&nbsp;<span class="ident" id="8141467">c</span><span class="op" id="8141468">.</span><span class="ident" id="8141469">LocalAddr</span><span class="op" id="8141478">(</span><span class="op" id="8141479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141483">if</span>&nbsp;<span class="ident" id="8141486">a</span><span class="op" id="8141487">,</span>&nbsp;<span class="ident" id="8141489">ok</span>&nbsp;<span class="op" id="8141492">:=</span>&nbsp;<span class="ident" id="8141495">la</span><span class="op" id="8141497">.</span><span class="op" id="8141498">(</span><span class="op" id="8141499">*</span><span class="ident" id="8141500">UDPAddr</span><span class="op" id="8141507">)</span><span class="op" id="8141508">;</span>&nbsp;<span class="op" id="8141510">!</span><span class="ident" id="8141511">ok</span>&nbsp;<span class="op" id="8141514">||</span>&nbsp;<span class="ident" id="8141517">a</span><span class="op" id="8141518">.</span><span class="ident" id="8141519">Port</span>&nbsp;<span class="op" id="8141524">==</span>&nbsp;<span class="num" id="8141527">0</span>&nbsp;<span class="op" id="8141529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141534">t</span><span class="op" id="8141535">.</span><span class="ident" id="8141536">Fatalf</span><span class="op" id="8141542">(</span><span class="string" id="8141543">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8141604">,</span>&nbsp;<span class="ident" id="8141606">la</span><span class="op" id="8141608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141612">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141615">}</span><br>
<span class="lineno"></span><span class="op" id="8141617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8141620">func</span>&nbsp;<span class="ident" id="8141625">TestUDPConnLocalAndRemoteNames</span><span class="op" id="8141655">(</span><span class="ident" id="8141656">t</span>&nbsp;<span class="op" id="8141658">*</span><span class="ident" id="8141659">testing</span><span class="op" id="8141666">.</span><span class="ident" id="8141667">T</span><span class="op" id="8141668">)</span>&nbsp;<span class="op" id="8141670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141673">for</span>&nbsp;<span class="ident" id="8141677">_</span><span class="op" id="8141678">,</span>&nbsp;<span class="ident" id="8141680">laddr</span>&nbsp;<span class="op" id="8141686">:=</span>&nbsp;<span class="keyword" id="8141689">range</span>&nbsp;<span class="op" id="8141695">[</span><span class="op" id="8141696">]</span><span class="builtintype" id="8141697">string</span><span class="op" id="8141703">{</span><span class="string" id="8141704">&#34;&#34;</span><span class="op" id="8141706">,</span>&nbsp;<span class="string" id="8141708">&#34;127.0.0.1:0&#34;</span><span class="op" id="8141721">}</span>&nbsp;<span class="op" id="8141723">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141727">c1</span><span class="op" id="8141729">,</span>&nbsp;<span class="ident" id="8141731">err</span>&nbsp;<span class="op" id="8141735">:=</span>&nbsp;<span class="ident" id="8141738">ListenPacket</span><span class="op" id="8141750">(</span><span class="string" id="8141751">&#34;udp&#34;</span><span class="op" id="8141756">,</span>&nbsp;<span class="string" id="8141758">&#34;127.0.0.1:0&#34;</span><span class="op" id="8141771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141775">if</span>&nbsp;<span class="ident" id="8141778">err</span>&nbsp;<span class="op" id="8141782">!=</span>&nbsp;<span class="ident" id="8141785">nil</span>&nbsp;<span class="op" id="8141789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141794">t</span><span class="op" id="8141795">.</span><span class="ident" id="8141796">Fatalf</span><span class="op" id="8141802">(</span><span class="string" id="8141803">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8141825">,</span>&nbsp;<span class="ident" id="8141827">err</span><span class="op" id="8141830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8141834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141838">defer</span>&nbsp;<span class="ident" id="8141844">c1</span><span class="op" id="8141846">.</span><span class="ident" id="8141847">Close</span><span class="op" id="8141852">(</span><span class="op" id="8141853">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141858">var</span>&nbsp;<span class="ident" id="8141862">la</span>&nbsp;<span class="op" id="8141865">*</span><span class="ident" id="8141866">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141876">if</span>&nbsp;<span class="ident" id="8141879">laddr</span>&nbsp;<span class="op" id="8141885">!=</span>&nbsp;<span class="string" id="8141888">&#34;&#34;</span>&nbsp;<span class="op" id="8141891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141896">var</span>&nbsp;<span class="ident" id="8141900">err</span>&nbsp;<span class="builtintype" id="8141904">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8141913">if</span>&nbsp;<span class="ident" id="8141916">la</span><span class="op" id="8141918">,</span>&nbsp;<span class="ident" id="8141920">err</span>&nbsp;<span class="op" id="8141924">=</span>&nbsp;<span class="ident" id="8141926">ResolveUDPAddr</span><span class="op" id="8141940">(</span><span class="string" id="8141941">&#34;udp&#34;</span><span class="op" id="8141946">,</span>&nbsp;<span class="ident" id="8141948">laddr</span><span class="op" id="8141953">)</span><span class="op" id="8141954">;</span>&nbsp;<span class="ident" id="8141956">err</span>&nbsp;<span class="op" id="8141960">!=</span>&nbsp;<span class="ident" id="8141963">nil</span>&nbsp;<span class="op" id="8141967">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8141973">t</span><span class="op" id="8141974">.</span><span class="ident" id="8141975">Fatalf</span><span class="op" id="8141981">(</span><span class="string" id="8141982">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8142009">,</span>&nbsp;<span class="ident" id="8142011">err</span><span class="op" id="8142014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142027">c2</span><span class="op" id="8142029">,</span>&nbsp;<span class="ident" id="8142031">err</span>&nbsp;<span class="op" id="8142035">:=</span>&nbsp;<span class="ident" id="8142038">DialUDP</span><span class="op" id="8142045">(</span><span class="string" id="8142046">&#34;udp&#34;</span><span class="op" id="8142051">,</span>&nbsp;<span class="ident" id="8142053">la</span><span class="op" id="8142055">,</span>&nbsp;<span class="ident" id="8142057">c1</span><span class="op" id="8142059">.</span><span class="ident" id="8142060">LocalAddr</span><span class="op" id="8142069">(</span><span class="op" id="8142070">)</span><span class="op" id="8142071">.</span><span class="op" id="8142072">(</span><span class="op" id="8142073">*</span><span class="ident" id="8142074">UDPAddr</span><span class="op" id="8142081">)</span><span class="op" id="8142082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142086">if</span>&nbsp;<span class="ident" id="8142089">err</span>&nbsp;<span class="op" id="8142093">!=</span>&nbsp;<span class="ident" id="8142096">nil</span>&nbsp;<span class="op" id="8142100">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142105">t</span><span class="op" id="8142106">.</span><span class="ident" id="8142107">Fatalf</span><span class="op" id="8142113">(</span><span class="string" id="8142114">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8142134">,</span>&nbsp;<span class="ident" id="8142136">err</span><span class="op" id="8142139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142147">defer</span>&nbsp;<span class="ident" id="8142153">c2</span><span class="op" id="8142155">.</span><span class="ident" id="8142156">Close</span><span class="op" id="8142161">(</span><span class="op" id="8142162">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142167">var</span>&nbsp;<span class="ident" id="8142171">connAddrs</span>&nbsp;<span class="op" id="8142181">=</span>&nbsp;<span class="op" id="8142183">[</span><span class="num" id="8142184">4</span><span class="op" id="8142185">]</span><span class="keyword" id="8142186">struct</span>&nbsp;<span class="op" id="8142193">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142198">got</span>&nbsp;<span class="ident" id="8142202">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142210">ok</span>&nbsp;&nbsp;<span class="builtintype" id="8142214">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142221">}</span><span class="op" id="8142222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142227">{</span><span class="ident" id="8142228">c1</span><span class="op" id="8142230">.</span><span class="ident" id="8142231">LocalAddr</span><span class="op" id="8142240">(</span><span class="op" id="8142241">)</span><span class="op" id="8142242">,</span>&nbsp;<span class="builtintype" id="8142244">true</span><span class="op" id="8142248">}</span><span class="op" id="8142249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142254">{</span><span class="ident" id="8142255">c1</span><span class="op" id="8142257">.</span><span class="op" id="8142258">(</span><span class="op" id="8142259">*</span><span class="ident" id="8142260">UDPConn</span><span class="op" id="8142267">)</span><span class="op" id="8142268">.</span><span class="ident" id="8142269">RemoteAddr</span><span class="op" id="8142279">(</span><span class="op" id="8142280">)</span><span class="op" id="8142281">,</span>&nbsp;<span class="builtintype" id="8142283">false</span><span class="op" id="8142288">}</span><span class="op" id="8142289">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142294">{</span><span class="ident" id="8142295">c2</span><span class="op" id="8142297">.</span><span class="ident" id="8142298">LocalAddr</span><span class="op" id="8142307">(</span><span class="op" id="8142308">)</span><span class="op" id="8142309">,</span>&nbsp;<span class="builtintype" id="8142311">true</span><span class="op" id="8142315">}</span><span class="op" id="8142316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142321">{</span><span class="ident" id="8142322">c2</span><span class="op" id="8142324">.</span><span class="ident" id="8142325">RemoteAddr</span><span class="op" id="8142335">(</span><span class="op" id="8142336">)</span><span class="op" id="8142337">,</span>&nbsp;<span class="builtintype" id="8142339">true</span><span class="op" id="8142343">}</span><span class="op" id="8142344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142352">for</span>&nbsp;<span class="ident" id="8142356">_</span><span class="op" id="8142357">,</span>&nbsp;<span class="ident" id="8142359">ca</span>&nbsp;<span class="op" id="8142362">:=</span>&nbsp;<span class="keyword" id="8142365">range</span>&nbsp;<span class="ident" id="8142371">connAddrs</span>&nbsp;<span class="op" id="8142381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142386">if</span>&nbsp;<span class="ident" id="8142389">a</span><span class="op" id="8142390">,</span>&nbsp;<span class="ident" id="8142392">ok</span>&nbsp;<span class="op" id="8142395">:=</span>&nbsp;<span class="ident" id="8142398">ca</span><span class="op" id="8142400">.</span><span class="ident" id="8142401">got</span><span class="op" id="8142404">.</span><span class="op" id="8142405">(</span><span class="op" id="8142406">*</span><span class="ident" id="8142407">UDPAddr</span><span class="op" id="8142414">)</span><span class="op" id="8142415">;</span>&nbsp;<span class="ident" id="8142417">ok</span>&nbsp;<span class="op" id="8142420">!=</span>&nbsp;<span class="ident" id="8142423">ca</span><span class="op" id="8142425">.</span><span class="ident" id="8142426">ok</span>&nbsp;<span class="op" id="8142429">||</span>&nbsp;<span class="ident" id="8142432">ok</span>&nbsp;<span class="op" id="8142435">&amp;&amp;</span>&nbsp;<span class="ident" id="8142438">a</span><span class="op" id="8142439">.</span><span class="ident" id="8142440">Port</span>&nbsp;<span class="op" id="8142445">==</span>&nbsp;<span class="num" id="8142448">0</span>&nbsp;<span class="op" id="8142450">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142456">t</span><span class="op" id="8142457">.</span><span class="ident" id="8142458">Fatalf</span><span class="op" id="8142464">(</span><span class="string" id="8142465">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8142526">,</span>&nbsp;<span class="ident" id="8142528">ca</span><span class="op" id="8142530">.</span><span class="ident" id="8142531">got</span><span class="op" id="8142534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142546">}</span><br>
<span class="lineno"></span><span class="op" id="8142548">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="8142551">func</span>&nbsp;<span class="ident" id="8142556">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="8142583">(</span><span class="ident" id="8142584">t</span>&nbsp;<span class="op" id="8142586">*</span><span class="ident" id="8142587">testing</span><span class="op" id="8142594">.</span><span class="ident" id="8142595">T</span><span class="op" id="8142596">)</span>&nbsp;<span class="op" id="8142598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142601">if</span>&nbsp;<span class="ident" id="8142604">testing</span><span class="op" id="8142611">.</span><span class="ident" id="8142612">Short</span><span class="op" id="8142617">(</span><span class="op" id="8142618">)</span>&nbsp;<span class="op" id="8142620">||</span>&nbsp;<span class="op" id="8142623">!</span><span class="op" id="8142624">*</span><span class="ident" id="8142625">testExternal</span>&nbsp;<span class="op" id="8142638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142642">t</span><span class="op" id="8142643">.</span><span class="ident" id="8142644">Skip</span><span class="op" id="8142648">(</span><span class="string" id="8142649">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8142690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142693">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142696">if</span>&nbsp;<span class="op" id="8142699">!</span><span class="ident" id="8142700">supportsIPv6</span>&nbsp;<span class="op" id="8142713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142717">t</span><span class="op" id="8142718">.</span><span class="ident" id="8142719">Skip</span><span class="op" id="8142723">(</span><span class="string" id="8142724">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8142747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142753">ifi</span>&nbsp;<span class="op" id="8142757">:=</span>&nbsp;<span class="ident" id="8142760">loopbackInterface</span><span class="op" id="8142777">(</span><span class="op" id="8142778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142781">if</span>&nbsp;<span class="ident" id="8142784">ifi</span>&nbsp;<span class="op" id="8142788">==</span>&nbsp;<span class="ident" id="8142791">nil</span>&nbsp;<span class="op" id="8142795">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142799">t</span><span class="op" id="8142800">.</span><span class="ident" id="8142801">Skip</span><span class="op" id="8142805">(</span><span class="string" id="8142806">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="8142836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142842">laddr</span>&nbsp;<span class="op" id="8142848">:=</span>&nbsp;<span class="ident" id="8142851">ipv6LinkLocalUnicastAddr</span><span class="op" id="8142875">(</span><span class="ident" id="8142876">ifi</span><span class="op" id="8142879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142882">if</span>&nbsp;<span class="ident" id="8142885">laddr</span>&nbsp;<span class="op" id="8142891">==</span>&nbsp;<span class="string" id="8142894">&#34;&#34;</span>&nbsp;<span class="op" id="8142897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142901">t</span><span class="op" id="8142902">.</span><span class="ident" id="8142903">Skip</span><span class="op" id="8142907">(</span><span class="string" id="8142908">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="8142952">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8142955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8142959">type</span>&nbsp;<span class="ident" id="8142964">test</span>&nbsp;<span class="keyword" id="8142969">struct</span>&nbsp;<span class="op" id="8142976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8142980">net</span><span class="op" id="8142983">,</span>&nbsp;<span class="ident" id="8142985">addr</span>&nbsp;&nbsp;<span class="builtintype" id="8142991">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143000">nameLookup</span>&nbsp;<span class="builtintype" id="8143011">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143020">var</span>&nbsp;<span class="ident" id="8143024">tests</span>&nbsp;<span class="op" id="8143030">=</span>&nbsp;<span class="op" id="8143032">[</span><span class="op" id="8143033">]</span><span class="ident" id="8143034">test</span><span class="op" id="8143038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143042">{</span><span class="string" id="8143043">&#34;udp&#34;</span><span class="op" id="8143048">,</span>&nbsp;<span class="string" id="8143050">&#34;[&#34;</span>&nbsp;<span class="op" id="8143054">+</span>&nbsp;<span class="ident" id="8143056">laddr</span>&nbsp;<span class="op" id="8143062">+</span>&nbsp;<span class="string" id="8143064">&#34;%&#34;</span>&nbsp;<span class="op" id="8143068">+</span>&nbsp;<span class="ident" id="8143070">ifi</span><span class="op" id="8143073">.</span><span class="ident" id="8143074">Name</span>&nbsp;<span class="op" id="8143079">+</span>&nbsp;<span class="string" id="8143081">&#34;]:0&#34;</span><span class="op" id="8143086">,</span>&nbsp;<span class="builtintype" id="8143088">false</span><span class="op" id="8143093">}</span><span class="op" id="8143094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143098">{</span><span class="string" id="8143099">&#34;udp6&#34;</span><span class="op" id="8143105">,</span>&nbsp;<span class="string" id="8143107">&#34;[&#34;</span>&nbsp;<span class="op" id="8143111">+</span>&nbsp;<span class="ident" id="8143113">laddr</span>&nbsp;<span class="op" id="8143119">+</span>&nbsp;<span class="string" id="8143121">&#34;%&#34;</span>&nbsp;<span class="op" id="8143125">+</span>&nbsp;<span class="ident" id="8143127">ifi</span><span class="op" id="8143130">.</span><span class="ident" id="8143131">Name</span>&nbsp;<span class="op" id="8143136">+</span>&nbsp;<span class="string" id="8143138">&#34;]:0&#34;</span><span class="op" id="8143143">,</span>&nbsp;<span class="builtintype" id="8143145">false</span><span class="op" id="8143150">}</span><span class="op" id="8143151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143154">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8143157">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143217">if</span>&nbsp;<span class="ident" id="8143220">runtime</span><span class="op" id="8143227">.</span><span class="ident" id="8143228">GOOS</span>&nbsp;<span class="op" id="8143233">==</span>&nbsp;<span class="string" id="8143236">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="8143248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143252">tests</span>&nbsp;<span class="op" id="8143258">=</span>&nbsp;<span class="ident" id="8143260">tests</span><span class="op" id="8143265">[</span><span class="num" id="8143266">1</span><span class="op" id="8143267">:</span><span class="op" id="8143268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143274">switch</span>&nbsp;<span class="ident" id="8143281">runtime</span><span class="op" id="8143288">.</span><span class="ident" id="8143289">GOOS</span>&nbsp;<span class="op" id="8143294">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143297">case</span>&nbsp;<span class="string" id="8143302">&#34;darwin&#34;</span><span class="op" id="8143310">,</span>&nbsp;<span class="string" id="8143312">&#34;dragonfly&#34;</span><span class="op" id="8143323">,</span>&nbsp;<span class="string" id="8143325">&#34;freebsd&#34;</span><span class="op" id="8143334">,</span>&nbsp;<span class="string" id="8143336">&#34;openbsd&#34;</span><span class="op" id="8143345">,</span>&nbsp;<span class="string" id="8143347">&#34;netbsd&#34;</span><span class="op" id="8143355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143359">tests</span>&nbsp;<span class="op" id="8143365">=</span>&nbsp;<span class="builtinfunc" id="8143367">append</span><span class="op" id="8143373">(</span><span class="ident" id="8143374">tests</span><span class="op" id="8143379">,</span>&nbsp;<span class="op" id="8143381">[</span><span class="op" id="8143382">]</span><span class="ident" id="8143383">test</span><span class="op" id="8143387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143392">{</span><span class="string" id="8143393">&#34;udp&#34;</span><span class="op" id="8143398">,</span>&nbsp;<span class="string" id="8143400">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="8143414">+</span>&nbsp;<span class="ident" id="8143416">ifi</span><span class="op" id="8143419">.</span><span class="ident" id="8143420">Name</span>&nbsp;<span class="op" id="8143425">+</span>&nbsp;<span class="string" id="8143427">&#34;]:0&#34;</span><span class="op" id="8143432">,</span>&nbsp;<span class="builtintype" id="8143434">true</span><span class="op" id="8143438">}</span><span class="op" id="8143439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143444">{</span><span class="string" id="8143445">&#34;udp6&#34;</span><span class="op" id="8143451">,</span>&nbsp;<span class="string" id="8143453">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="8143467">+</span>&nbsp;<span class="ident" id="8143469">ifi</span><span class="op" id="8143472">.</span><span class="ident" id="8143473">Name</span>&nbsp;<span class="op" id="8143478">+</span>&nbsp;<span class="string" id="8143480">&#34;]:0&#34;</span><span class="op" id="8143485">,</span>&nbsp;<span class="builtintype" id="8143487">true</span><span class="op" id="8143491">}</span><span class="op" id="8143492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143496">}</span><span class="op" id="8143497">...</span><span class="op" id="8143500">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143503">case</span>&nbsp;<span class="string" id="8143508">&#34;linux&#34;</span><span class="op" id="8143515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143519">tests</span>&nbsp;<span class="op" id="8143525">=</span>&nbsp;<span class="builtinfunc" id="8143527">append</span><span class="op" id="8143533">(</span><span class="ident" id="8143534">tests</span><span class="op" id="8143539">,</span>&nbsp;<span class="op" id="8143541">[</span><span class="op" id="8143542">]</span><span class="ident" id="8143543">test</span><span class="op" id="8143547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143552">{</span><span class="string" id="8143553">&#34;udp&#34;</span><span class="op" id="8143558">,</span>&nbsp;<span class="string" id="8143560">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="8143578">+</span>&nbsp;<span class="ident" id="8143580">ifi</span><span class="op" id="8143583">.</span><span class="ident" id="8143584">Name</span>&nbsp;<span class="op" id="8143589">+</span>&nbsp;<span class="string" id="8143591">&#34;]:0&#34;</span><span class="op" id="8143596">,</span>&nbsp;<span class="builtintype" id="8143598">true</span><span class="op" id="8143602">}</span><span class="op" id="8143603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143608">{</span><span class="string" id="8143609">&#34;udp6&#34;</span><span class="op" id="8143615">,</span>&nbsp;<span class="string" id="8143617">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="8143635">+</span>&nbsp;<span class="ident" id="8143637">ifi</span><span class="op" id="8143640">.</span><span class="ident" id="8143641">Name</span>&nbsp;<span class="op" id="8143646">+</span>&nbsp;<span class="string" id="8143648">&#34;]:0&#34;</span><span class="op" id="8143653">,</span>&nbsp;<span class="builtintype" id="8143655">true</span><span class="op" id="8143659">}</span><span class="op" id="8143660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143664">}</span><span class="op" id="8143665">...</span><span class="op" id="8143668">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143674">for</span>&nbsp;<span class="ident" id="8143678">_</span><span class="op" id="8143679">,</span>&nbsp;<span class="ident" id="8143681">tt</span>&nbsp;<span class="op" id="8143684">:=</span>&nbsp;<span class="keyword" id="8143687">range</span>&nbsp;<span class="ident" id="8143693">tests</span>&nbsp;<span class="op" id="8143699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143703">c1</span><span class="op" id="8143705">,</span>&nbsp;<span class="ident" id="8143707">err</span>&nbsp;<span class="op" id="8143711">:=</span>&nbsp;<span class="ident" id="8143714">ListenPacket</span><span class="op" id="8143726">(</span><span class="ident" id="8143727">tt</span><span class="op" id="8143729">.</span><span class="ident" id="8143730">net</span><span class="op" id="8143733">,</span>&nbsp;<span class="ident" id="8143735">tt</span><span class="op" id="8143737">.</span><span class="ident" id="8143738">addr</span><span class="op" id="8143742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143746">if</span>&nbsp;<span class="ident" id="8143749">err</span>&nbsp;<span class="op" id="8143753">!=</span>&nbsp;<span class="ident" id="8143756">nil</span>&nbsp;<span class="op" id="8143760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8143765">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8143811">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8143860">t</span><span class="op" id="8143861">.</span><span class="ident" id="8143862">Logf</span><span class="op" id="8143866">(</span><span class="string" id="8143867">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8143892">,</span>&nbsp;<span class="ident" id="8143894">err</span><span class="op" id="8143897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143902">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8143913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143917">defer</span>&nbsp;<span class="ident" id="8143923">c1</span><span class="op" id="8143925">.</span><span class="ident" id="8143926">Close</span><span class="op" id="8143931">(</span><span class="op" id="8143932">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8143936">if</span>&nbsp;<span class="ident" id="8143939">la</span><span class="op" id="8143941">,</span>&nbsp;<span class="ident" id="8143943">ok</span>&nbsp;<span class="op" id="8143946">:=</span>&nbsp;<span class="ident" id="8143949">c1</span><span class="op" id="8143951">.</span><span class="ident" id="8143952">LocalAddr</span><span class="op" id="8143961">(</span><span class="op" id="8143962">)</span><span class="op" id="8143963">.</span><span class="op" id="8143964">(</span><span class="op" id="8143965">*</span><span class="ident" id="8143966">UDPAddr</span><span class="op" id="8143973">)</span><span class="op" id="8143974">;</span>&nbsp;<span class="op" id="8143976">!</span><span class="ident" id="8143977">ok</span>&nbsp;<span class="op" id="8143980">||</span>&nbsp;<span class="op" id="8143983">!</span><span class="ident" id="8143984">tt</span><span class="op" id="8143986">.</span><span class="ident" id="8143987">nameLookup</span>&nbsp;<span class="op" id="8143998">&amp;&amp;</span>&nbsp;<span class="ident" id="8144001">la</span><span class="op" id="8144003">.</span><span class="ident" id="8144004">Zone</span>&nbsp;<span class="op" id="8144009">==</span>&nbsp;<span class="string" id="8144012">&#34;&#34;</span>&nbsp;<span class="op" id="8144015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144020">t</span><span class="op" id="8144021">.</span><span class="ident" id="8144022">Fatalf</span><span class="op" id="8144028">(</span><span class="string" id="8144029">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8144085">,</span>&nbsp;<span class="ident" id="8144087">la</span><span class="op" id="8144089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144098">c2</span><span class="op" id="8144100">,</span>&nbsp;<span class="ident" id="8144102">err</span>&nbsp;<span class="op" id="8144106">:=</span>&nbsp;<span class="ident" id="8144109">Dial</span><span class="op" id="8144113">(</span><span class="ident" id="8144114">tt</span><span class="op" id="8144116">.</span><span class="ident" id="8144117">net</span><span class="op" id="8144120">,</span>&nbsp;<span class="ident" id="8144122">c1</span><span class="op" id="8144124">.</span><span class="ident" id="8144125">LocalAddr</span><span class="op" id="8144134">(</span><span class="op" id="8144135">)</span><span class="op" id="8144136">.</span><span class="ident" id="8144137">String</span><span class="op" id="8144143">(</span><span class="op" id="8144144">)</span><span class="op" id="8144145">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8144149">if</span>&nbsp;<span class="ident" id="8144152">err</span>&nbsp;<span class="op" id="8144156">!=</span>&nbsp;<span class="ident" id="8144159">nil</span>&nbsp;<span class="op" id="8144163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144168">t</span><span class="op" id="8144169">.</span><span class="ident" id="8144170">Fatalf</span><span class="op" id="8144176">(</span><span class="string" id="8144177">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8144194">,</span>&nbsp;<span class="ident" id="8144196">err</span><span class="op" id="8144199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8144207">defer</span>&nbsp;<span class="ident" id="8144213">c2</span><span class="op" id="8144215">.</span><span class="ident" id="8144216">Close</span><span class="op" id="8144221">(</span><span class="op" id="8144222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8144226">if</span>&nbsp;<span class="ident" id="8144229">la</span><span class="op" id="8144231">,</span>&nbsp;<span class="ident" id="8144233">ok</span>&nbsp;<span class="op" id="8144236">:=</span>&nbsp;<span class="ident" id="8144239">c2</span><span class="op" id="8144241">.</span><span class="ident" id="8144242">LocalAddr</span><span class="op" id="8144251">(</span><span class="op" id="8144252">)</span><span class="op" id="8144253">.</span><span class="op" id="8144254">(</span><span class="op" id="8144255">*</span><span class="ident" id="8144256">UDPAddr</span><span class="op" id="8144263">)</span><span class="op" id="8144264">;</span>&nbsp;<span class="op" id="8144266">!</span><span class="ident" id="8144267">ok</span>&nbsp;<span class="op" id="8144270">||</span>&nbsp;<span class="op" id="8144273">!</span><span class="ident" id="8144274">tt</span><span class="op" id="8144276">.</span><span class="ident" id="8144277">nameLookup</span>&nbsp;<span class="op" id="8144288">&amp;&amp;</span>&nbsp;<span class="ident" id="8144291">la</span><span class="op" id="8144293">.</span><span class="ident" id="8144294">Zone</span>&nbsp;<span class="op" id="8144299">==</span>&nbsp;<span class="string" id="8144302">&#34;&#34;</span>&nbsp;<span class="op" id="8144305">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144310">t</span><span class="op" id="8144311">.</span><span class="ident" id="8144312">Fatalf</span><span class="op" id="8144318">(</span><span class="string" id="8144319">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8144375">,</span>&nbsp;<span class="ident" id="8144377">la</span><span class="op" id="8144379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8144387">if</span>&nbsp;<span class="ident" id="8144390">ra</span><span class="op" id="8144392">,</span>&nbsp;<span class="ident" id="8144394">ok</span>&nbsp;<span class="op" id="8144397">:=</span>&nbsp;<span class="ident" id="8144400">c2</span><span class="op" id="8144402">.</span><span class="ident" id="8144403">RemoteAddr</span><span class="op" id="8144413">(</span><span class="op" id="8144414">)</span><span class="op" id="8144415">.</span><span class="op" id="8144416">(</span><span class="op" id="8144417">*</span><span class="ident" id="8144418">UDPAddr</span><span class="op" id="8144425">)</span><span class="op" id="8144426">;</span>&nbsp;<span class="op" id="8144428">!</span><span class="ident" id="8144429">ok</span>&nbsp;<span class="op" id="8144432">||</span>&nbsp;<span class="op" id="8144435">!</span><span class="ident" id="8144436">tt</span><span class="op" id="8144438">.</span><span class="ident" id="8144439">nameLookup</span>&nbsp;<span class="op" id="8144450">&amp;&amp;</span>&nbsp;<span class="ident" id="8144453">ra</span><span class="op" id="8144455">.</span><span class="ident" id="8144456">Zone</span>&nbsp;<span class="op" id="8144461">==</span>&nbsp;<span class="string" id="8144464">&#34;&#34;</span>&nbsp;<span class="op" id="8144467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144472">t</span><span class="op" id="8144473">.</span><span class="ident" id="8144474">Fatalf</span><span class="op" id="8144480">(</span><span class="string" id="8144481">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8144537">,</span>&nbsp;<span class="ident" id="8144539">ra</span><span class="op" id="8144541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144545">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8144550">if</span>&nbsp;<span class="ident" id="8144553">_</span><span class="op" id="8144554">,</span>&nbsp;<span class="ident" id="8144556">err</span>&nbsp;<span class="op" id="8144560">:=</span>&nbsp;<span class="ident" id="8144563">c2</span><span class="op" id="8144565">.</span><span class="ident" id="8144566">Write</span><span class="op" id="8144571">(</span><span class="op" id="8144572">[</span><span class="op" id="8144573">]</span><span class="builtintype" id="8144574">byte</span><span class="op" id="8144578">(</span><span class="string" id="8144579">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="8144609">)</span><span class="op" id="8144610">)</span><span class="op" id="8144611">;</span>&nbsp;<span class="ident" id="8144613">err</span>&nbsp;<span class="op" id="8144617">!=</span>&nbsp;<span class="ident" id="8144620">nil</span>&nbsp;<span class="op" id="8144624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144629">t</span><span class="op" id="8144630">.</span><span class="ident" id="8144631">Fatalf</span><span class="op" id="8144637">(</span><span class="string" id="8144638">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8144661">,</span>&nbsp;<span class="ident" id="8144663">err</span><span class="op" id="8144666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144674">b</span>&nbsp;<span class="op" id="8144676">:=</span>&nbsp;<span class="builtinfunc" id="8144679">make</span><span class="op" id="8144683">(</span><span class="op" id="8144684">[</span><span class="op" id="8144685">]</span><span class="builtintype" id="8144686">byte</span><span class="op" id="8144690">,</span>&nbsp;<span class="num" id="8144692">32</span><span class="op" id="8144694">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8144698">if</span>&nbsp;<span class="ident" id="8144701">_</span><span class="op" id="8144702">,</span>&nbsp;<span class="ident" id="8144704">from</span><span class="op" id="8144708">,</span>&nbsp;<span class="ident" id="8144710">err</span>&nbsp;<span class="op" id="8144714">:=</span>&nbsp;<span class="ident" id="8144717">c1</span><span class="op" id="8144719">.</span><span class="ident" id="8144720">ReadFrom</span><span class="op" id="8144728">(</span><span class="ident" id="8144729">b</span><span class="op" id="8144730">)</span><span class="op" id="8144731">;</span>&nbsp;<span class="ident" id="8144733">err</span>&nbsp;<span class="op" id="8144737">!=</span>&nbsp;<span class="ident" id="8144740">nil</span>&nbsp;<span class="op" id="8144744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144749">t</span><span class="op" id="8144750">.</span><span class="ident" id="8144751">Fatalf</span><span class="op" id="8144757">(</span><span class="string" id="8144758">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8144790">,</span>&nbsp;<span class="ident" id="8144792">err</span><span class="op" id="8144795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144799">}</span>&nbsp;<span class="keyword" id="8144801">else</span>&nbsp;<span class="op" id="8144806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8144811">if</span>&nbsp;<span class="ident" id="8144814">ra</span><span class="op" id="8144816">,</span>&nbsp;<span class="ident" id="8144818">ok</span>&nbsp;<span class="op" id="8144821">:=</span>&nbsp;<span class="ident" id="8144824">from</span><span class="op" id="8144828">.</span><span class="op" id="8144829">(</span><span class="op" id="8144830">*</span><span class="ident" id="8144831">UDPAddr</span><span class="op" id="8144838">)</span><span class="op" id="8144839">;</span>&nbsp;<span class="op" id="8144841">!</span><span class="ident" id="8144842">ok</span>&nbsp;<span class="op" id="8144845">||</span>&nbsp;<span class="op" id="8144848">!</span><span class="ident" id="8144849">tt</span><span class="op" id="8144851">.</span><span class="ident" id="8144852">nameLookup</span>&nbsp;<span class="op" id="8144863">&amp;&amp;</span>&nbsp;<span class="ident" id="8144866">ra</span><span class="op" id="8144868">.</span><span class="ident" id="8144869">Zone</span>&nbsp;<span class="op" id="8144874">==</span>&nbsp;<span class="string" id="8144877">&#34;&#34;</span>&nbsp;<span class="op" id="8144880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8144886">t</span><span class="op" id="8144887">.</span><span class="ident" id="8144888">Fatalf</span><span class="op" id="8144894">(</span><span class="string" id="8144895">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8144951">,</span>&nbsp;<span class="ident" id="8144953">ra</span><span class="op" id="8144955">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8144967">}</span><br>
<span class="lineno"></span><span class="op" id="8144969">}</span>
</div>
</body>
</html>
