<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5112222">package</span>&nbsp;<span class="ident" id="5112230">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5112236">import</span>&nbsp;<span class="op" id="5112243">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5112246">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5112268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5112271">func</span>&nbsp;<span class="ident" id="5112276">parseArgs</span><span class="op" id="5112285">(</span><span class="ident" id="5112286">p</span>&nbsp;<span class="op" id="5112288">*</span><span class="ident" id="5112289">parser</span><span class="op" id="5112295">)</span>&nbsp;<span class="op" id="5112297">(</span><span class="ident" id="5112298">typ</span>&nbsp;<span class="op" id="5112302">*</span><span class="ident" id="5112303">lex8</span><span class="op" id="5112307">.</span><span class="ident" id="5112308">Token</span><span class="op" id="5112313">,</span>&nbsp;<span class="ident" id="5112315">args</span>&nbsp;<span class="op" id="5112320">[</span><span class="op" id="5112321">]</span><span class="op" id="5112322">*</span><span class="ident" id="5112323">lex8</span><span class="op" id="5112327">.</span><span class="ident" id="5112328">Token</span><span class="op" id="5112333">)</span>&nbsp;<span class="op" id="5112335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112338">typ</span>&nbsp;<span class="op" id="5112342">=</span>&nbsp;<span class="ident" id="5112344">p</span><span class="op" id="5112345">.</span><span class="ident" id="5112346">expect</span><span class="op" id="5112352">(</span><span class="ident" id="5112353">Operand</span><span class="op" id="5112360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112363">if</span>&nbsp;<span class="ident" id="5112366">typ</span>&nbsp;<span class="op" id="5112370">==</span>&nbsp;<span class="ident" id="5112373">nil</span>&nbsp;<span class="op" id="5112377">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112381">p</span><span class="op" id="5112382">.</span><span class="ident" id="5112383">skipErrStmt</span><span class="op" id="5112394">(</span><span class="op" id="5112395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112399">return</span>&nbsp;<span class="ident" id="5112406">nil</span><span class="op" id="5112409">,</span>&nbsp;<span class="ident" id="5112411">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5112416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112420">for</span>&nbsp;<span class="op" id="5112424">!</span><span class="ident" id="5112425">p</span><span class="op" id="5112426">.</span><span class="ident" id="5112427">acceptType</span><span class="op" id="5112437">(</span><span class="ident" id="5112438">Semi</span><span class="op" id="5112442">)</span>&nbsp;<span class="op" id="5112444">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112448">if</span>&nbsp;<span class="op" id="5112451">!</span><span class="ident" id="5112452">p</span><span class="op" id="5112453">.</span><span class="ident" id="5112454">hasErr</span><span class="op" id="5112460">(</span><span class="op" id="5112461">)</span>&nbsp;<span class="op" id="5112463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112468">t</span>&nbsp;<span class="op" id="5112470">:=</span>&nbsp;<span class="ident" id="5112473">p</span><span class="op" id="5112474">.</span><span class="ident" id="5112475">token</span><span class="op" id="5112480">(</span><span class="op" id="5112481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112486">if</span>&nbsp;<span class="ident" id="5112489">t</span><span class="op" id="5112490">.</span><span class="ident" id="5112491">Type</span>&nbsp;<span class="op" id="5112496">==</span>&nbsp;<span class="ident" id="5112499">Operand</span>&nbsp;<span class="op" id="5112507">||</span>&nbsp;<span class="ident" id="5112510">t</span><span class="op" id="5112511">.</span><span class="ident" id="5112512">Type</span>&nbsp;<span class="op" id="5112517">==</span>&nbsp;<span class="ident" id="5112520">String</span>&nbsp;<span class="op" id="5112527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112533">args</span>&nbsp;<span class="op" id="5112538">=</span>&nbsp;<span class="builtinfunc" id="5112540">append</span><span class="op" id="5112546">(</span><span class="ident" id="5112547">args</span><span class="op" id="5112551">,</span>&nbsp;<span class="ident" id="5112553">t</span><span class="op" id="5112554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5112559">}</span>&nbsp;<span class="keyword" id="5112561">else</span>&nbsp;<span class="op" id="5112566">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112572">p</span><span class="op" id="5112573">.</span><span class="ident" id="5112574">err</span><span class="op" id="5112577">(</span><span class="ident" id="5112578">t</span><span class="op" id="5112579">.</span><span class="ident" id="5112580">Pos</span><span class="op" id="5112583">,</span>&nbsp;<span class="string" id="5112585">&#34;expect&nbsp;operand&nbsp;or&nbsp;string,&nbsp;got&nbsp;%s&#34;</span><span class="op" id="5112619">,</span>&nbsp;<span class="ident" id="5112621">typeStr</span><span class="op" id="5112628">(</span><span class="ident" id="5112629">t</span><span class="op" id="5112630">.</span><span class="ident" id="5112631">Type</span><span class="op" id="5112635">)</span><span class="op" id="5112636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5112641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5112645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112649">if</span>&nbsp;<span class="ident" id="5112652">p</span><span class="op" id="5112653">.</span><span class="ident" id="5112654">see</span><span class="op" id="5112657">(</span><span class="ident" id="5112658">lex8</span><span class="op" id="5112662">.</span><span class="ident" id="5112663">EOF</span><span class="op" id="5112666">)</span>&nbsp;<span class="op" id="5112668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112673">break</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5112681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112685">p</span><span class="op" id="5112686">.</span><span class="ident" id="5112687">next</span><span class="op" id="5112691">(</span><span class="op" id="5112692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5112695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112699">p</span><span class="op" id="5112700">.</span><span class="ident" id="5112701">clearErr</span><span class="op" id="5112709">(</span><span class="op" id="5112710">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112714">return</span>&nbsp;<span class="ident" id="5112721">typ</span><span class="op" id="5112724">,</span>&nbsp;<span class="ident" id="5112726">args</span><br>
<span class="lineno"></span><span class="op" id="5112731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5112734">func</span>&nbsp;<span class="ident" id="5112739">parseData</span><span class="op" id="5112748">(</span><span class="ident" id="5112749">p</span>&nbsp;<span class="op" id="5112751">*</span><span class="ident" id="5112752">parser</span><span class="op" id="5112758">,</span>&nbsp;<span class="ident" id="5112760">t</span>&nbsp;<span class="op" id="5112762">*</span><span class="ident" id="5112763">lex8</span><span class="op" id="5112767">.</span><span class="ident" id="5112768">Token</span><span class="op" id="5112773">,</span>&nbsp;<span class="ident" id="5112775">args</span>&nbsp;<span class="op" id="5112780">[</span><span class="op" id="5112781">]</span><span class="op" id="5112782">*</span><span class="ident" id="5112783">lex8</span><span class="op" id="5112787">.</span><span class="ident" id="5112788">Token</span><span class="op" id="5112793">)</span>&nbsp;<span class="op" id="5112795">(</span><span class="op" id="5112796">[</span><span class="op" id="5112797">]</span><span class="builtintype" id="5112798">byte</span><span class="op" id="5112802">,</span>&nbsp;<span class="builtintype" id="5112804">uint32</span><span class="op" id="5112810">)</span>&nbsp;<span class="op" id="5112812">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112815">switch</span>&nbsp;<span class="ident" id="5112822">t</span><span class="op" id="5112823">.</span><span class="ident" id="5112824">Lit</span>&nbsp;<span class="op" id="5112828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112831">case</span>&nbsp;<span class="string" id="5112836">&#34;str&#34;</span><span class="op" id="5112841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112845">return</span>&nbsp;<span class="ident" id="5112852">parseDataStr</span><span class="op" id="5112864">(</span><span class="ident" id="5112865">p</span><span class="op" id="5112866">,</span>&nbsp;<span class="ident" id="5112868">args</span><span class="op" id="5112872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112875">case</span>&nbsp;<span class="string" id="5112880">&#34;x&#34;</span><span class="op" id="5112883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112887">return</span>&nbsp;<span class="ident" id="5112894">parseDataHex</span><span class="op" id="5112906">(</span><span class="ident" id="5112907">p</span><span class="op" id="5112908">,</span>&nbsp;<span class="ident" id="5112910">args</span><span class="op" id="5112914">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112917">case</span>&nbsp;<span class="string" id="5112922">&#34;u32&#34;</span><span class="op" id="5112927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112931">return</span>&nbsp;<span class="ident" id="5112938">parseDataNums</span><span class="op" id="5112951">(</span><span class="ident" id="5112952">p</span><span class="op" id="5112953">,</span>&nbsp;<span class="ident" id="5112955">args</span><span class="op" id="5112959">,</span>&nbsp;<span class="ident" id="5112961">modeWord</span><span class="op" id="5112969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112972">case</span>&nbsp;<span class="string" id="5112977">&#34;i32&#34;</span><span class="op" id="5112982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112986">return</span>&nbsp;<span class="ident" id="5112993">parseDataNums</span><span class="op" id="5113006">(</span><span class="ident" id="5113007">p</span><span class="op" id="5113008">,</span>&nbsp;<span class="ident" id="5113010">args</span><span class="op" id="5113014">,</span>&nbsp;<span class="ident" id="5113016">modeWord</span><span class="op" id="5113024">|</span><span class="ident" id="5113025">modeSigned</span><span class="op" id="5113035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113038">case</span>&nbsp;<span class="string" id="5113043">&#34;u8&#34;</span><span class="op" id="5113047">,</span>&nbsp;<span class="string" id="5113049">&#34;byte&#34;</span><span class="op" id="5113055">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113059">return</span>&nbsp;<span class="ident" id="5113066">parseDataNums</span><span class="op" id="5113079">(</span><span class="ident" id="5113080">p</span><span class="op" id="5113081">,</span>&nbsp;<span class="ident" id="5113083">args</span><span class="op" id="5113087">,</span>&nbsp;<span class="num" id="5113089">0</span><span class="op" id="5113090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113093">case</span>&nbsp;<span class="string" id="5113098">&#34;i8&#34;</span><span class="op" id="5113102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113106">return</span>&nbsp;<span class="ident" id="5113113">parseDataNums</span><span class="op" id="5113126">(</span><span class="ident" id="5113127">p</span><span class="op" id="5113128">,</span>&nbsp;<span class="ident" id="5113130">args</span><span class="op" id="5113134">,</span>&nbsp;<span class="ident" id="5113136">modeSigned</span><span class="op" id="5113146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113149">case</span>&nbsp;<span class="string" id="5113154">&#34;f32&#34;</span><span class="op" id="5113159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113163">return</span>&nbsp;<span class="ident" id="5113170">parseDataNums</span><span class="op" id="5113183">(</span><span class="ident" id="5113184">p</span><span class="op" id="5113185">,</span>&nbsp;<span class="ident" id="5113187">args</span><span class="op" id="5113191">,</span>&nbsp;<span class="ident" id="5113193">modeWord</span><span class="op" id="5113201">|</span><span class="ident" id="5113202">modeFloat</span><span class="op" id="5113211">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113214">default</span><span class="op" id="5113221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113225">p</span><span class="op" id="5113226">.</span><span class="ident" id="5113227">err</span><span class="op" id="5113230">(</span><span class="ident" id="5113231">t</span><span class="op" id="5113232">.</span><span class="ident" id="5113233">Pos</span><span class="op" id="5113236">,</span>&nbsp;<span class="string" id="5113238">&#34;unknown&nbsp;data&nbsp;type&nbsp;%q&#34;</span><span class="op" id="5113260">,</span>&nbsp;<span class="ident" id="5113262">t</span><span class="op" id="5113263">.</span><span class="ident" id="5113264">Lit</span><span class="op" id="5113267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113271">return</span>&nbsp;<span class="ident" id="5113278">nil</span><span class="op" id="5113281">,</span>&nbsp;<span class="num" id="5113283">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113286">}</span><br>
<span class="lineno"></span><span class="op" id="5113288">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="5113291">func</span>&nbsp;<span class="ident" id="5113296">parseVarStmt</span><span class="op" id="5113308">(</span><span class="ident" id="5113309">p</span>&nbsp;<span class="op" id="5113311">*</span><span class="ident" id="5113312">parser</span><span class="op" id="5113318">)</span>&nbsp;<span class="op" id="5113320">*</span><span class="ident" id="5113321">varStmt</span>&nbsp;<span class="op" id="5113329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113332">typ</span><span class="op" id="5113335">,</span>&nbsp;<span class="ident" id="5113337">args</span>&nbsp;<span class="op" id="5113342">:=</span>&nbsp;<span class="ident" id="5113345">parseArgs</span><span class="op" id="5113354">(</span><span class="ident" id="5113355">p</span><span class="op" id="5113356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113359">if</span>&nbsp;<span class="ident" id="5113362">typ</span>&nbsp;<span class="op" id="5113366">==</span>&nbsp;<span class="ident" id="5113369">nil</span>&nbsp;<span class="op" id="5113373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113377">return</span>&nbsp;<span class="ident" id="5113384">nil</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113393">ret</span>&nbsp;<span class="op" id="5113397">:=</span>&nbsp;<span class="builtinfunc" id="5113400">new</span><span class="op" id="5113403">(</span><span class="ident" id="5113404">varStmt</span><span class="op" id="5113411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113414">ret</span><span class="op" id="5113417">.</span><span class="ident" id="5113418">typ</span>&nbsp;<span class="op" id="5113422">=</span>&nbsp;<span class="ident" id="5113424">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113429">ret</span><span class="op" id="5113432">.</span><span class="ident" id="5113433">args</span>&nbsp;<span class="op" id="5113438">=</span>&nbsp;<span class="ident" id="5113440">args</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113446">ret</span><span class="op" id="5113449">.</span><span class="ident" id="5113450">data</span><span class="op" id="5113454">,</span>&nbsp;<span class="ident" id="5113456">ret</span><span class="op" id="5113459">.</span><span class="ident" id="5113460">align</span>&nbsp;<span class="op" id="5113466">=</span>&nbsp;<span class="ident" id="5113468">parseData</span><span class="op" id="5113477">(</span><span class="ident" id="5113478">p</span><span class="op" id="5113479">,</span>&nbsp;<span class="ident" id="5113481">typ</span><span class="op" id="5113484">,</span>&nbsp;<span class="ident" id="5113486">args</span><span class="op" id="5113490">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113494">return</span>&nbsp;<span class="ident" id="5113501">ret</span><br>
<span class="lineno"></span><span class="op" id="5113505">}</span>
</div>
</body>
</html>
