<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/jpeg</h2>
<ul>
<li><a href="/gostd/image/jpeg/dct_test.go.html">dct_test.go</a></li>
<li><a href="/gostd/image/jpeg/fdct.go.html">fdct.go</a></li>
<li><a href="/gostd/image/jpeg/huffman.go.html">huffman.go</a></li>
<li><a href="/gostd/image/jpeg/idct.go.html">idct.go</a></li>
<li><a href="/gostd/image/jpeg/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/jpeg/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/jpeg/scan.go.html">scan.go</a></li>
<li><a href="/gostd/image/jpeg/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/jpeg/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7403067">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7403122">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7403176">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7403227">package</span>&nbsp;<span class="ident" id="7403235">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7403241">import</span>&nbsp;<span class="op" id="7403248">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403251">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403260">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403267">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403276">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403291">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403304">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403317">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403330">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7403336">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7403346">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7403349">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="7403428">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="7403507">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="7403532">var</span>&nbsp;<span class="ident" id="7403536">zigzag</span>&nbsp;<span class="op" id="7403543">=</span>&nbsp;<span class="op" id="7403545">[</span><span class="ident" id="7403546">blockSize</span><span class="op" id="7403555">]</span><span class="builtintype" id="7403556">int</span><span class="op" id="7403559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403562">0</span><span class="op" id="7403563">,</span>&nbsp;<span class="num" id="7403565">1</span><span class="op" id="7403566">,</span>&nbsp;<span class="num" id="7403568">5</span><span class="op" id="7403569">,</span>&nbsp;<span class="num" id="7403571">6</span><span class="op" id="7403572">,</span>&nbsp;<span class="num" id="7403574">14</span><span class="op" id="7403576">,</span>&nbsp;<span class="num" id="7403578">15</span><span class="op" id="7403580">,</span>&nbsp;<span class="num" id="7403582">27</span><span class="op" id="7403584">,</span>&nbsp;<span class="num" id="7403586">28</span><span class="op" id="7403588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403591">2</span><span class="op" id="7403592">,</span>&nbsp;<span class="num" id="7403594">4</span><span class="op" id="7403595">,</span>&nbsp;<span class="num" id="7403597">7</span><span class="op" id="7403598">,</span>&nbsp;<span class="num" id="7403600">13</span><span class="op" id="7403602">,</span>&nbsp;<span class="num" id="7403604">16</span><span class="op" id="7403606">,</span>&nbsp;<span class="num" id="7403608">26</span><span class="op" id="7403610">,</span>&nbsp;<span class="num" id="7403612">29</span><span class="op" id="7403614">,</span>&nbsp;<span class="num" id="7403616">42</span><span class="op" id="7403618">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403621">3</span><span class="op" id="7403622">,</span>&nbsp;<span class="num" id="7403624">8</span><span class="op" id="7403625">,</span>&nbsp;<span class="num" id="7403627">12</span><span class="op" id="7403629">,</span>&nbsp;<span class="num" id="7403631">17</span><span class="op" id="7403633">,</span>&nbsp;<span class="num" id="7403635">25</span><span class="op" id="7403637">,</span>&nbsp;<span class="num" id="7403639">30</span><span class="op" id="7403641">,</span>&nbsp;<span class="num" id="7403643">41</span><span class="op" id="7403645">,</span>&nbsp;<span class="num" id="7403647">43</span><span class="op" id="7403649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403652">9</span><span class="op" id="7403653">,</span>&nbsp;<span class="num" id="7403655">11</span><span class="op" id="7403657">,</span>&nbsp;<span class="num" id="7403659">18</span><span class="op" id="7403661">,</span>&nbsp;<span class="num" id="7403663">24</span><span class="op" id="7403665">,</span>&nbsp;<span class="num" id="7403667">31</span><span class="op" id="7403669">,</span>&nbsp;<span class="num" id="7403671">40</span><span class="op" id="7403673">,</span>&nbsp;<span class="num" id="7403675">44</span><span class="op" id="7403677">,</span>&nbsp;<span class="num" id="7403679">53</span><span class="op" id="7403681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403684">10</span><span class="op" id="7403686">,</span>&nbsp;<span class="num" id="7403688">19</span><span class="op" id="7403690">,</span>&nbsp;<span class="num" id="7403692">23</span><span class="op" id="7403694">,</span>&nbsp;<span class="num" id="7403696">32</span><span class="op" id="7403698">,</span>&nbsp;<span class="num" id="7403700">39</span><span class="op" id="7403702">,</span>&nbsp;<span class="num" id="7403704">45</span><span class="op" id="7403706">,</span>&nbsp;<span class="num" id="7403708">52</span><span class="op" id="7403710">,</span>&nbsp;<span class="num" id="7403712">54</span><span class="op" id="7403714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403717">20</span><span class="op" id="7403719">,</span>&nbsp;<span class="num" id="7403721">22</span><span class="op" id="7403723">,</span>&nbsp;<span class="num" id="7403725">33</span><span class="op" id="7403727">,</span>&nbsp;<span class="num" id="7403729">38</span><span class="op" id="7403731">,</span>&nbsp;<span class="num" id="7403733">46</span><span class="op" id="7403735">,</span>&nbsp;<span class="num" id="7403737">51</span><span class="op" id="7403739">,</span>&nbsp;<span class="num" id="7403741">55</span><span class="op" id="7403743">,</span>&nbsp;<span class="num" id="7403745">60</span><span class="op" id="7403747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403750">21</span><span class="op" id="7403752">,</span>&nbsp;<span class="num" id="7403754">34</span><span class="op" id="7403756">,</span>&nbsp;<span class="num" id="7403758">37</span><span class="op" id="7403760">,</span>&nbsp;<span class="num" id="7403762">47</span><span class="op" id="7403764">,</span>&nbsp;<span class="num" id="7403766">50</span><span class="op" id="7403768">,</span>&nbsp;<span class="num" id="7403770">56</span><span class="op" id="7403772">,</span>&nbsp;<span class="num" id="7403774">59</span><span class="op" id="7403776">,</span>&nbsp;<span class="num" id="7403778">61</span><span class="op" id="7403780">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7403783">35</span><span class="op" id="7403785">,</span>&nbsp;<span class="num" id="7403787">36</span><span class="op" id="7403789">,</span>&nbsp;<span class="num" id="7403791">48</span><span class="op" id="7403793">,</span>&nbsp;<span class="num" id="7403795">49</span><span class="op" id="7403797">,</span>&nbsp;<span class="num" id="7403799">57</span><span class="op" id="7403801">,</span>&nbsp;<span class="num" id="7403803">58</span><span class="op" id="7403805">,</span>&nbsp;<span class="num" id="7403807">62</span><span class="op" id="7403809">,</span>&nbsp;<span class="num" id="7403811">63</span><span class="op" id="7403813">,</span><br>
<span class="lineno"></span><span class="op" id="7403815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7403818">func</span>&nbsp;<span class="ident" id="7403823">TestZigUnzig</span><span class="op" id="7403835">(</span><span class="ident" id="7403836">t</span>&nbsp;<span class="op" id="7403838">*</span><span class="ident" id="7403839">testing</span><span class="op" id="7403846">.</span><span class="ident" id="7403847">T</span><span class="op" id="7403848">)</span>&nbsp;<span class="op" id="7403850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7403853">for</span>&nbsp;<span class="ident" id="7403857">i</span>&nbsp;<span class="op" id="7403859">:=</span>&nbsp;<span class="num" id="7403862">0</span><span class="op" id="7403863">;</span>&nbsp;<span class="ident" id="7403865">i</span>&nbsp;<span class="op" id="7403867">&lt;</span>&nbsp;<span class="ident" id="7403869">blockSize</span><span class="op" id="7403878">;</span>&nbsp;<span class="ident" id="7403880">i</span><span class="op" id="7403881">++</span>&nbsp;<span class="op" id="7403884">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7403888">if</span>&nbsp;<span class="ident" id="7403891">unzig</span><span class="op" id="7403896">[</span><span class="ident" id="7403897">zigzag</span><span class="op" id="7403903">[</span><span class="ident" id="7403904">i</span><span class="op" id="7403905">]</span><span class="op" id="7403906">]</span>&nbsp;<span class="op" id="7403908">!=</span>&nbsp;<span class="ident" id="7403911">i</span>&nbsp;<span class="op" id="7403913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7403918">t</span><span class="op" id="7403919">.</span><span class="ident" id="7403920">Errorf</span><span class="op" id="7403926">(</span><span class="string" id="7403927">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7403952">,</span>&nbsp;<span class="ident" id="7403954">i</span><span class="op" id="7403955">,</span>&nbsp;<span class="ident" id="7403957">unzig</span><span class="op" id="7403962">[</span><span class="ident" id="7403963">zigzag</span><span class="op" id="7403969">[</span><span class="ident" id="7403970">i</span><span class="op" id="7403971">]</span><span class="op" id="7403972">]</span><span class="op" id="7403973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7403977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7403981">if</span>&nbsp;<span class="ident" id="7403984">zigzag</span><span class="op" id="7403990">[</span><span class="ident" id="7403991">unzig</span><span class="op" id="7403996">[</span><span class="ident" id="7403997">i</span><span class="op" id="7403998">]</span><span class="op" id="7403999">]</span>&nbsp;<span class="op" id="7404001">!=</span>&nbsp;<span class="ident" id="7404004">i</span>&nbsp;<span class="op" id="7404006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7404011">t</span><span class="op" id="7404012">.</span><span class="ident" id="7404013">Errorf</span><span class="op" id="7404019">(</span><span class="string" id="7404020">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7404045">,</span>&nbsp;<span class="ident" id="7404047">i</span><span class="op" id="7404048">,</span>&nbsp;<span class="ident" id="7404050">zigzag</span><span class="op" id="7404056">[</span><span class="ident" id="7404057">unzig</span><span class="op" id="7404062">[</span><span class="ident" id="7404063">i</span><span class="op" id="7404064">]</span><span class="op" id="7404065">]</span><span class="op" id="7404066">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7404070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7404073">}</span><br>
<span class="lineno"></span><span class="op" id="7404075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7404078">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="7404149">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="7404210">var</span>&nbsp;<span class="ident" id="7404214">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="7404242">=</span>&nbsp;<span class="op" id="7404244">[</span><span class="ident" id="7404245">nQuantIndex</span><span class="op" id="7404256">]</span><span class="op" id="7404257">[</span><span class="ident" id="7404258">blockSize</span><span class="op" id="7404267">]</span><span class="builtintype" id="7404268">byte</span><span class="op" id="7404272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7404275">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7404290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404294">16</span><span class="op" id="7404296">,</span>&nbsp;<span class="num" id="7404298">11</span><span class="op" id="7404300">,</span>&nbsp;<span class="num" id="7404302">10</span><span class="op" id="7404304">,</span>&nbsp;<span class="num" id="7404306">16</span><span class="op" id="7404308">,</span>&nbsp;<span class="num" id="7404310">24</span><span class="op" id="7404312">,</span>&nbsp;<span class="num" id="7404314">40</span><span class="op" id="7404316">,</span>&nbsp;<span class="num" id="7404318">51</span><span class="op" id="7404320">,</span>&nbsp;<span class="num" id="7404322">61</span><span class="op" id="7404324">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404328">12</span><span class="op" id="7404330">,</span>&nbsp;<span class="num" id="7404332">12</span><span class="op" id="7404334">,</span>&nbsp;<span class="num" id="7404336">14</span><span class="op" id="7404338">,</span>&nbsp;<span class="num" id="7404340">19</span><span class="op" id="7404342">,</span>&nbsp;<span class="num" id="7404344">26</span><span class="op" id="7404346">,</span>&nbsp;<span class="num" id="7404348">58</span><span class="op" id="7404350">,</span>&nbsp;<span class="num" id="7404352">60</span><span class="op" id="7404354">,</span>&nbsp;<span class="num" id="7404356">55</span><span class="op" id="7404358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404362">14</span><span class="op" id="7404364">,</span>&nbsp;<span class="num" id="7404366">13</span><span class="op" id="7404368">,</span>&nbsp;<span class="num" id="7404370">16</span><span class="op" id="7404372">,</span>&nbsp;<span class="num" id="7404374">24</span><span class="op" id="7404376">,</span>&nbsp;<span class="num" id="7404378">40</span><span class="op" id="7404380">,</span>&nbsp;<span class="num" id="7404382">57</span><span class="op" id="7404384">,</span>&nbsp;<span class="num" id="7404386">69</span><span class="op" id="7404388">,</span>&nbsp;<span class="num" id="7404390">56</span><span class="op" id="7404392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404396">14</span><span class="op" id="7404398">,</span>&nbsp;<span class="num" id="7404400">17</span><span class="op" id="7404402">,</span>&nbsp;<span class="num" id="7404404">22</span><span class="op" id="7404406">,</span>&nbsp;<span class="num" id="7404408">29</span><span class="op" id="7404410">,</span>&nbsp;<span class="num" id="7404412">51</span><span class="op" id="7404414">,</span>&nbsp;<span class="num" id="7404416">87</span><span class="op" id="7404418">,</span>&nbsp;<span class="num" id="7404420">80</span><span class="op" id="7404422">,</span>&nbsp;<span class="num" id="7404424">62</span><span class="op" id="7404426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404430">18</span><span class="op" id="7404432">,</span>&nbsp;<span class="num" id="7404434">22</span><span class="op" id="7404436">,</span>&nbsp;<span class="num" id="7404438">37</span><span class="op" id="7404440">,</span>&nbsp;<span class="num" id="7404442">56</span><span class="op" id="7404444">,</span>&nbsp;<span class="num" id="7404446">68</span><span class="op" id="7404448">,</span>&nbsp;<span class="num" id="7404450">109</span><span class="op" id="7404453">,</span>&nbsp;<span class="num" id="7404455">103</span><span class="op" id="7404458">,</span>&nbsp;<span class="num" id="7404460">77</span><span class="op" id="7404462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404466">24</span><span class="op" id="7404468">,</span>&nbsp;<span class="num" id="7404470">35</span><span class="op" id="7404472">,</span>&nbsp;<span class="num" id="7404474">55</span><span class="op" id="7404476">,</span>&nbsp;<span class="num" id="7404478">64</span><span class="op" id="7404480">,</span>&nbsp;<span class="num" id="7404482">81</span><span class="op" id="7404484">,</span>&nbsp;<span class="num" id="7404486">104</span><span class="op" id="7404489">,</span>&nbsp;<span class="num" id="7404491">113</span><span class="op" id="7404494">,</span>&nbsp;<span class="num" id="7404496">92</span><span class="op" id="7404498">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404502">49</span><span class="op" id="7404504">,</span>&nbsp;<span class="num" id="7404506">64</span><span class="op" id="7404508">,</span>&nbsp;<span class="num" id="7404510">78</span><span class="op" id="7404512">,</span>&nbsp;<span class="num" id="7404514">87</span><span class="op" id="7404516">,</span>&nbsp;<span class="num" id="7404518">103</span><span class="op" id="7404521">,</span>&nbsp;<span class="num" id="7404523">121</span><span class="op" id="7404526">,</span>&nbsp;<span class="num" id="7404528">120</span><span class="op" id="7404531">,</span>&nbsp;<span class="num" id="7404533">101</span><span class="op" id="7404536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404540">72</span><span class="op" id="7404542">,</span>&nbsp;<span class="num" id="7404544">92</span><span class="op" id="7404546">,</span>&nbsp;<span class="num" id="7404548">95</span><span class="op" id="7404550">,</span>&nbsp;<span class="num" id="7404552">98</span><span class="op" id="7404554">,</span>&nbsp;<span class="num" id="7404556">112</span><span class="op" id="7404559">,</span>&nbsp;<span class="num" id="7404561">100</span><span class="op" id="7404564">,</span>&nbsp;<span class="num" id="7404566">103</span><span class="op" id="7404569">,</span>&nbsp;<span class="num" id="7404571">99</span><span class="op" id="7404573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7404576">}</span><span class="op" id="7404577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7404580">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7404597">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404601">17</span><span class="op" id="7404603">,</span>&nbsp;<span class="num" id="7404605">18</span><span class="op" id="7404607">,</span>&nbsp;<span class="num" id="7404609">24</span><span class="op" id="7404611">,</span>&nbsp;<span class="num" id="7404613">47</span><span class="op" id="7404615">,</span>&nbsp;<span class="num" id="7404617">99</span><span class="op" id="7404619">,</span>&nbsp;<span class="num" id="7404621">99</span><span class="op" id="7404623">,</span>&nbsp;<span class="num" id="7404625">99</span><span class="op" id="7404627">,</span>&nbsp;<span class="num" id="7404629">99</span><span class="op" id="7404631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404635">18</span><span class="op" id="7404637">,</span>&nbsp;<span class="num" id="7404639">21</span><span class="op" id="7404641">,</span>&nbsp;<span class="num" id="7404643">26</span><span class="op" id="7404645">,</span>&nbsp;<span class="num" id="7404647">66</span><span class="op" id="7404649">,</span>&nbsp;<span class="num" id="7404651">99</span><span class="op" id="7404653">,</span>&nbsp;<span class="num" id="7404655">99</span><span class="op" id="7404657">,</span>&nbsp;<span class="num" id="7404659">99</span><span class="op" id="7404661">,</span>&nbsp;<span class="num" id="7404663">99</span><span class="op" id="7404665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404669">24</span><span class="op" id="7404671">,</span>&nbsp;<span class="num" id="7404673">26</span><span class="op" id="7404675">,</span>&nbsp;<span class="num" id="7404677">56</span><span class="op" id="7404679">,</span>&nbsp;<span class="num" id="7404681">99</span><span class="op" id="7404683">,</span>&nbsp;<span class="num" id="7404685">99</span><span class="op" id="7404687">,</span>&nbsp;<span class="num" id="7404689">99</span><span class="op" id="7404691">,</span>&nbsp;<span class="num" id="7404693">99</span><span class="op" id="7404695">,</span>&nbsp;<span class="num" id="7404697">99</span><span class="op" id="7404699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404703">47</span><span class="op" id="7404705">,</span>&nbsp;<span class="num" id="7404707">66</span><span class="op" id="7404709">,</span>&nbsp;<span class="num" id="7404711">99</span><span class="op" id="7404713">,</span>&nbsp;<span class="num" id="7404715">99</span><span class="op" id="7404717">,</span>&nbsp;<span class="num" id="7404719">99</span><span class="op" id="7404721">,</span>&nbsp;<span class="num" id="7404723">99</span><span class="op" id="7404725">,</span>&nbsp;<span class="num" id="7404727">99</span><span class="op" id="7404729">,</span>&nbsp;<span class="num" id="7404731">99</span><span class="op" id="7404733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404737">99</span><span class="op" id="7404739">,</span>&nbsp;<span class="num" id="7404741">99</span><span class="op" id="7404743">,</span>&nbsp;<span class="num" id="7404745">99</span><span class="op" id="7404747">,</span>&nbsp;<span class="num" id="7404749">99</span><span class="op" id="7404751">,</span>&nbsp;<span class="num" id="7404753">99</span><span class="op" id="7404755">,</span>&nbsp;<span class="num" id="7404757">99</span><span class="op" id="7404759">,</span>&nbsp;<span class="num" id="7404761">99</span><span class="op" id="7404763">,</span>&nbsp;<span class="num" id="7404765">99</span><span class="op" id="7404767">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404771">99</span><span class="op" id="7404773">,</span>&nbsp;<span class="num" id="7404775">99</span><span class="op" id="7404777">,</span>&nbsp;<span class="num" id="7404779">99</span><span class="op" id="7404781">,</span>&nbsp;<span class="num" id="7404783">99</span><span class="op" id="7404785">,</span>&nbsp;<span class="num" id="7404787">99</span><span class="op" id="7404789">,</span>&nbsp;<span class="num" id="7404791">99</span><span class="op" id="7404793">,</span>&nbsp;<span class="num" id="7404795">99</span><span class="op" id="7404797">,</span>&nbsp;<span class="num" id="7404799">99</span><span class="op" id="7404801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404805">99</span><span class="op" id="7404807">,</span>&nbsp;<span class="num" id="7404809">99</span><span class="op" id="7404811">,</span>&nbsp;<span class="num" id="7404813">99</span><span class="op" id="7404815">,</span>&nbsp;<span class="num" id="7404817">99</span><span class="op" id="7404819">,</span>&nbsp;<span class="num" id="7404821">99</span><span class="op" id="7404823">,</span>&nbsp;<span class="num" id="7404825">99</span><span class="op" id="7404827">,</span>&nbsp;<span class="num" id="7404829">99</span><span class="op" id="7404831">,</span>&nbsp;<span class="num" id="7404833">99</span><span class="op" id="7404835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7404839">99</span><span class="op" id="7404841">,</span>&nbsp;<span class="num" id="7404843">99</span><span class="op" id="7404845">,</span>&nbsp;<span class="num" id="7404847">99</span><span class="op" id="7404849">,</span>&nbsp;<span class="num" id="7404851">99</span><span class="op" id="7404853">,</span>&nbsp;<span class="num" id="7404855">99</span><span class="op" id="7404857">,</span>&nbsp;<span class="num" id="7404859">99</span><span class="op" id="7404861">,</span>&nbsp;<span class="num" id="7404863">99</span><span class="op" id="7404865">,</span>&nbsp;<span class="num" id="7404867">99</span><span class="op" id="7404869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7404872">}</span><span class="op" id="7404873">,</span><br>
<span class="lineno"></span><span class="op" id="7404875">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7404878">func</span>&nbsp;<span class="ident" id="7404883">TestUnscaledQuant</span><span class="op" id="7404900">(</span><span class="ident" id="7404901">t</span>&nbsp;<span class="op" id="7404903">*</span><span class="ident" id="7404904">testing</span><span class="op" id="7404911">.</span><span class="ident" id="7404912">T</span><span class="op" id="7404913">)</span>&nbsp;<span class="op" id="7404915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7404918">bad</span>&nbsp;<span class="op" id="7404922">:=</span>&nbsp;<span class="builtintype" id="7404925">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7404932">for</span>&nbsp;<span class="ident" id="7404936">i</span>&nbsp;<span class="op" id="7404938">:=</span>&nbsp;<span class="ident" id="7404941">quantIndex</span><span class="op" id="7404951">(</span><span class="num" id="7404952">0</span><span class="op" id="7404953">)</span><span class="op" id="7404954">;</span>&nbsp;<span class="ident" id="7404956">i</span>&nbsp;<span class="op" id="7404958">&lt;</span>&nbsp;<span class="ident" id="7404960">nQuantIndex</span><span class="op" id="7404971">;</span>&nbsp;<span class="ident" id="7404973">i</span><span class="op" id="7404974">++</span>&nbsp;<span class="op" id="7404977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7404981">for</span>&nbsp;<span class="ident" id="7404985">zig</span>&nbsp;<span class="op" id="7404989">:=</span>&nbsp;<span class="num" id="7404992">0</span><span class="op" id="7404993">;</span>&nbsp;<span class="ident" id="7404995">zig</span>&nbsp;<span class="op" id="7404999">&lt;</span>&nbsp;<span class="ident" id="7405001">blockSize</span><span class="op" id="7405010">;</span>&nbsp;<span class="ident" id="7405012">zig</span><span class="op" id="7405015">++</span>&nbsp;<span class="op" id="7405018">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405023">got</span>&nbsp;<span class="op" id="7405027">:=</span>&nbsp;<span class="ident" id="7405030">unscaledQuant</span><span class="op" id="7405043">[</span><span class="ident" id="7405044">i</span><span class="op" id="7405045">]</span><span class="op" id="7405046">[</span><span class="ident" id="7405047">zig</span><span class="op" id="7405050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405055">want</span>&nbsp;<span class="op" id="7405060">:=</span>&nbsp;<span class="ident" id="7405063">unscaledQuantInNaturalOrder</span><span class="op" id="7405090">[</span><span class="ident" id="7405091">i</span><span class="op" id="7405092">]</span><span class="op" id="7405093">[</span><span class="ident" id="7405094">unzig</span><span class="op" id="7405099">[</span><span class="ident" id="7405100">zig</span><span class="op" id="7405103">]</span><span class="op" id="7405104">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7405109">if</span>&nbsp;<span class="ident" id="7405112">got</span>&nbsp;<span class="op" id="7405116">!=</span>&nbsp;<span class="ident" id="7405119">want</span>&nbsp;<span class="op" id="7405124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405130">t</span><span class="op" id="7405131">.</span><span class="ident" id="7405132">Errorf</span><span class="op" id="7405138">(</span><span class="string" id="7405139">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7405170">,</span>&nbsp;<span class="ident" id="7405172">i</span><span class="op" id="7405173">,</span>&nbsp;<span class="ident" id="7405175">zig</span><span class="op" id="7405178">,</span>&nbsp;<span class="ident" id="7405180">got</span><span class="op" id="7405183">,</span>&nbsp;<span class="ident" id="7405185">want</span><span class="op" id="7405189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405195">bad</span>&nbsp;<span class="op" id="7405199">=</span>&nbsp;<span class="builtintype" id="7405201">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7405219">if</span>&nbsp;<span class="ident" id="7405222">bad</span>&nbsp;<span class="op" id="7405226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405230">names</span>&nbsp;<span class="op" id="7405236">:=</span>&nbsp;<span class="op" id="7405239">[</span><span class="ident" id="7405240">nQuantIndex</span><span class="op" id="7405251">]</span><span class="builtintype" id="7405252">string</span><span class="op" id="7405258">{</span><span class="string" id="7405259">&#34;Luminance&#34;</span><span class="op" id="7405270">,</span>&nbsp;<span class="string" id="7405272">&#34;Chrominance&#34;</span><span class="op" id="7405285">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405289">buf</span>&nbsp;<span class="op" id="7405293">:=</span>&nbsp;<span class="op" id="7405296">&amp;</span><span class="ident" id="7405297">bytes</span><span class="op" id="7405302">.</span><span class="ident" id="7405303">Buffer</span><span class="op" id="7405309">{</span><span class="op" id="7405310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7405314">for</span>&nbsp;<span class="ident" id="7405318">i</span><span class="op" id="7405319">,</span>&nbsp;<span class="ident" id="7405321">name</span>&nbsp;<span class="op" id="7405326">:=</span>&nbsp;<span class="keyword" id="7405329">range</span>&nbsp;<span class="ident" id="7405335">names</span>&nbsp;<span class="op" id="7405341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405346">fmt</span><span class="op" id="7405349">.</span><span class="ident" id="7405350">Fprintf</span><span class="op" id="7405357">(</span><span class="ident" id="7405358">buf</span><span class="op" id="7405361">,</span>&nbsp;<span class="string" id="7405363">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="7405376">,</span>&nbsp;<span class="ident" id="7405378">name</span><span class="op" id="7405382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7405387">for</span>&nbsp;<span class="ident" id="7405391">zig</span>&nbsp;<span class="op" id="7405395">:=</span>&nbsp;<span class="num" id="7405398">0</span><span class="op" id="7405399">;</span>&nbsp;<span class="ident" id="7405401">zig</span>&nbsp;<span class="op" id="7405405">&lt;</span>&nbsp;<span class="ident" id="7405407">blockSize</span><span class="op" id="7405416">;</span>&nbsp;<span class="ident" id="7405418">zig</span><span class="op" id="7405421">++</span>&nbsp;<span class="op" id="7405424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405430">fmt</span><span class="op" id="7405433">.</span><span class="ident" id="7405434">Fprintf</span><span class="op" id="7405441">(</span><span class="ident" id="7405442">buf</span><span class="op" id="7405445">,</span>&nbsp;<span class="string" id="7405447">&#34;%d,&nbsp;&#34;</span><span class="op" id="7405453">,</span>&nbsp;<span class="ident" id="7405455">unscaledQuantInNaturalOrder</span><span class="op" id="7405482">[</span><span class="ident" id="7405483">i</span><span class="op" id="7405484">]</span><span class="op" id="7405485">[</span><span class="ident" id="7405486">unzig</span><span class="op" id="7405491">[</span><span class="ident" id="7405492">zig</span><span class="op" id="7405495">]</span><span class="op" id="7405496">]</span><span class="op" id="7405497">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7405503">if</span>&nbsp;<span class="ident" id="7405506">zig</span><span class="op" id="7405509">%</span><span class="num" id="7405510">8</span>&nbsp;<span class="op" id="7405512">==</span>&nbsp;<span class="num" id="7405515">7</span>&nbsp;<span class="op" id="7405517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405524">buf</span><span class="op" id="7405527">.</span><span class="ident" id="7405528">WriteString</span><span class="op" id="7405539">(</span><span class="string" id="7405540">&#34;\n&#34;</span><span class="op" id="7405544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405560">buf</span><span class="op" id="7405563">.</span><span class="ident" id="7405564">WriteString</span><span class="op" id="7405575">(</span><span class="string" id="7405576">&#34;},\n&#34;</span><span class="op" id="7405582">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405590">t</span><span class="op" id="7405591">.</span><span class="ident" id="7405592">Logf</span><span class="op" id="7405596">(</span><span class="string" id="7405597">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="7405633">,</span>&nbsp;<span class="ident" id="7405635">buf</span><span class="op" id="7405638">.</span><span class="ident" id="7405639">String</span><span class="op" id="7405645">(</span><span class="op" id="7405646">)</span><span class="op" id="7405647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405650">}</span><br>
<span class="lineno"></span><span class="op" id="7405652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7405655">var</span>&nbsp;<span class="ident" id="7405659">testCase</span>&nbsp;<span class="op" id="7405668">=</span>&nbsp;<span class="op" id="7405670">[</span><span class="op" id="7405671">]</span><span class="keyword" id="7405672">struct</span>&nbsp;<span class="op" id="7405679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405682">filename</span>&nbsp;&nbsp;<span class="builtintype" id="7405692">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405700">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7405710">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7405715">tolerance</span>&nbsp;<span class="ident" id="7405725">int64</span><br>
<span class="lineno"></span><span class="op" id="7405731">}</span><span class="op" id="7405732">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405735">{</span><span class="string" id="7405736">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7405763">,</span>&nbsp;<span class="num" id="7405765">1</span><span class="op" id="7405766">,</span>&nbsp;<span class="num" id="7405768">24</span>&nbsp;<span class="op" id="7405771">&lt;&lt;</span>&nbsp;<span class="num" id="7405774">8</span><span class="op" id="7405775">}</span><span class="op" id="7405776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405779">{</span><span class="string" id="7405780">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7405807">,</span>&nbsp;<span class="num" id="7405809">20</span><span class="op" id="7405811">,</span>&nbsp;<span class="num" id="7405813">12</span>&nbsp;<span class="op" id="7405816">&lt;&lt;</span>&nbsp;<span class="num" id="7405819">8</span><span class="op" id="7405820">}</span><span class="op" id="7405821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405824">{</span><span class="string" id="7405825">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7405852">,</span>&nbsp;<span class="num" id="7405854">60</span><span class="op" id="7405856">,</span>&nbsp;<span class="num" id="7405858">8</span>&nbsp;<span class="op" id="7405860">&lt;&lt;</span>&nbsp;<span class="num" id="7405863">8</span><span class="op" id="7405864">}</span><span class="op" id="7405865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405868">{</span><span class="string" id="7405869">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7405896">,</span>&nbsp;<span class="num" id="7405898">80</span><span class="op" id="7405900">,</span>&nbsp;<span class="num" id="7405902">6</span>&nbsp;<span class="op" id="7405904">&lt;&lt;</span>&nbsp;<span class="num" id="7405907">8</span><span class="op" id="7405908">}</span><span class="op" id="7405909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405912">{</span><span class="string" id="7405913">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7405940">,</span>&nbsp;<span class="num" id="7405942">90</span><span class="op" id="7405944">,</span>&nbsp;<span class="num" id="7405946">4</span>&nbsp;<span class="op" id="7405948">&lt;&lt;</span>&nbsp;<span class="num" id="7405951">8</span><span class="op" id="7405952">}</span><span class="op" id="7405953">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7405956">{</span><span class="string" id="7405957">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7405984">,</span>&nbsp;<span class="num" id="7405986">100</span><span class="op" id="7405989">,</span>&nbsp;<span class="num" id="7405991">2</span>&nbsp;<span class="op" id="7405993">&lt;&lt;</span>&nbsp;<span class="num" id="7405996">8</span><span class="op" id="7405997">}</span><span class="op" id="7405998">,</span><br>
<span class="lineno"></span><span class="op" id="7406000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7406003">func</span>&nbsp;<span class="ident" id="7406008">delta</span><span class="op" id="7406013">(</span><span class="ident" id="7406014">u0</span><span class="op" id="7406016">,</span>&nbsp;<span class="ident" id="7406018">u1</span>&nbsp;<span class="builtintype" id="7406021">uint32</span><span class="op" id="7406027">)</span>&nbsp;<span class="ident" id="7406029">int64</span>&nbsp;<span class="op" id="7406035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406038">d</span>&nbsp;<span class="op" id="7406040">:=</span>&nbsp;<span class="ident" id="7406043">int64</span><span class="op" id="7406048">(</span><span class="ident" id="7406049">u0</span><span class="op" id="7406051">)</span>&nbsp;<span class="op" id="7406053">-</span>&nbsp;<span class="ident" id="7406055">int64</span><span class="op" id="7406060">(</span><span class="ident" id="7406061">u1</span><span class="op" id="7406063">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406066">if</span>&nbsp;<span class="ident" id="7406069">d</span>&nbsp;<span class="op" id="7406071">&lt;</span>&nbsp;<span class="num" id="7406073">0</span>&nbsp;<span class="op" id="7406075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406079">return</span>&nbsp;<span class="op" id="7406086">-</span><span class="ident" id="7406087">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7406090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406093">return</span>&nbsp;<span class="ident" id="7406100">d</span><br>
<span class="lineno"></span><span class="op" id="7406102">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7406105">func</span>&nbsp;<span class="ident" id="7406110">readPng</span><span class="op" id="7406117">(</span><span class="ident" id="7406118">filename</span>&nbsp;<span class="builtintype" id="7406127">string</span><span class="op" id="7406133">)</span>&nbsp;<span class="op" id="7406135">(</span><span class="ident" id="7406136">image</span><span class="op" id="7406141">.</span><span class="ident" id="7406142">Image</span><span class="op" id="7406147">,</span>&nbsp;<span class="builtintype" id="7406149">error</span><span class="op" id="7406154">)</span>&nbsp;<span class="op" id="7406156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406159">f</span><span class="op" id="7406160">,</span>&nbsp;<span class="ident" id="7406162">err</span>&nbsp;<span class="op" id="7406166">:=</span>&nbsp;<span class="ident" id="7406169">os</span><span class="op" id="7406171">.</span><span class="ident" id="7406172">Open</span><span class="op" id="7406176">(</span><span class="ident" id="7406177">filename</span><span class="op" id="7406185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406188">if</span>&nbsp;<span class="ident" id="7406191">err</span>&nbsp;<span class="op" id="7406195">!=</span>&nbsp;<span class="ident" id="7406198">nil</span>&nbsp;<span class="op" id="7406202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406206">return</span>&nbsp;<span class="ident" id="7406213">nil</span><span class="op" id="7406216">,</span>&nbsp;<span class="ident" id="7406218">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7406223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406226">defer</span>&nbsp;<span class="ident" id="7406232">f</span><span class="op" id="7406233">.</span><span class="ident" id="7406234">Close</span><span class="op" id="7406239">(</span><span class="op" id="7406240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406243">return</span>&nbsp;<span class="ident" id="7406250">png</span><span class="op" id="7406253">.</span><span class="ident" id="7406254">Decode</span><span class="op" id="7406260">(</span><span class="ident" id="7406261">f</span><span class="op" id="7406262">)</span><br>
<span class="lineno"></span><span class="op" id="7406264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7406267">func</span>&nbsp;<span class="ident" id="7406272">TestWriter</span><span class="op" id="7406282">(</span><span class="ident" id="7406283">t</span>&nbsp;<span class="op" id="7406285">*</span><span class="ident" id="7406286">testing</span><span class="op" id="7406293">.</span><span class="ident" id="7406294">T</span><span class="op" id="7406295">)</span>&nbsp;<span class="op" id="7406297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406300">for</span>&nbsp;<span class="ident" id="7406304">_</span><span class="op" id="7406305">,</span>&nbsp;<span class="ident" id="7406307">tc</span>&nbsp;<span class="op" id="7406310">:=</span>&nbsp;<span class="keyword" id="7406313">range</span>&nbsp;<span class="ident" id="7406319">testCase</span>&nbsp;<span class="op" id="7406328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7406332">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406353">m0</span><span class="op" id="7406355">,</span>&nbsp;<span class="ident" id="7406357">err</span>&nbsp;<span class="op" id="7406361">:=</span>&nbsp;<span class="ident" id="7406364">readPng</span><span class="op" id="7406371">(</span><span class="ident" id="7406372">tc</span><span class="op" id="7406374">.</span><span class="ident" id="7406375">filename</span><span class="op" id="7406383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406387">if</span>&nbsp;<span class="ident" id="7406390">err</span>&nbsp;<span class="op" id="7406394">!=</span>&nbsp;<span class="ident" id="7406397">nil</span>&nbsp;<span class="op" id="7406401">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406406">t</span><span class="op" id="7406407">.</span><span class="ident" id="7406408">Error</span><span class="op" id="7406413">(</span><span class="ident" id="7406414">tc</span><span class="op" id="7406416">.</span><span class="ident" id="7406417">filename</span><span class="op" id="7406425">,</span>&nbsp;<span class="ident" id="7406427">err</span><span class="op" id="7406430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406435">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7406446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7406450">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406482">var</span>&nbsp;<span class="ident" id="7406486">buf</span>&nbsp;<span class="ident" id="7406490">bytes</span><span class="op" id="7406495">.</span><span class="ident" id="7406496">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406505">err</span>&nbsp;<span class="op" id="7406509">=</span>&nbsp;<span class="ident" id="7406511">Encode</span><span class="op" id="7406517">(</span><span class="op" id="7406518">&amp;</span><span class="ident" id="7406519">buf</span><span class="op" id="7406522">,</span>&nbsp;<span class="ident" id="7406524">m0</span><span class="op" id="7406526">,</span>&nbsp;<span class="op" id="7406528">&amp;</span><span class="ident" id="7406529">Options</span><span class="op" id="7406536">{</span><span class="ident" id="7406537">Quality</span><span class="op" id="7406544">:</span>&nbsp;<span class="ident" id="7406546">tc</span><span class="op" id="7406548">.</span><span class="ident" id="7406549">quality</span><span class="op" id="7406556">}</span><span class="op" id="7406557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406561">if</span>&nbsp;<span class="ident" id="7406564">err</span>&nbsp;<span class="op" id="7406568">!=</span>&nbsp;<span class="ident" id="7406571">nil</span>&nbsp;<span class="op" id="7406575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406580">t</span><span class="op" id="7406581">.</span><span class="ident" id="7406582">Error</span><span class="op" id="7406587">(</span><span class="ident" id="7406588">tc</span><span class="op" id="7406590">.</span><span class="ident" id="7406591">filename</span><span class="op" id="7406599">,</span>&nbsp;<span class="ident" id="7406601">err</span><span class="op" id="7406604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406609">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7406620">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7406624">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406647">m1</span><span class="op" id="7406649">,</span>&nbsp;<span class="ident" id="7406651">err</span>&nbsp;<span class="op" id="7406655">:=</span>&nbsp;<span class="ident" id="7406658">Decode</span><span class="op" id="7406664">(</span><span class="op" id="7406665">&amp;</span><span class="ident" id="7406666">buf</span><span class="op" id="7406669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406673">if</span>&nbsp;<span class="ident" id="7406676">err</span>&nbsp;<span class="op" id="7406680">!=</span>&nbsp;<span class="ident" id="7406683">nil</span>&nbsp;<span class="op" id="7406687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406692">t</span><span class="op" id="7406693">.</span><span class="ident" id="7406694">Error</span><span class="op" id="7406699">(</span><span class="ident" id="7406700">tc</span><span class="op" id="7406702">.</span><span class="ident" id="7406703">filename</span><span class="op" id="7406711">,</span>&nbsp;<span class="ident" id="7406713">err</span><span class="op" id="7406716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406721">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7406732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406736">if</span>&nbsp;<span class="ident" id="7406739">m0</span><span class="op" id="7406741">.</span><span class="ident" id="7406742">Bounds</span><span class="op" id="7406748">(</span><span class="op" id="7406749">)</span>&nbsp;<span class="op" id="7406751">!=</span>&nbsp;<span class="ident" id="7406754">m1</span><span class="op" id="7406756">.</span><span class="ident" id="7406757">Bounds</span><span class="op" id="7406763">(</span><span class="op" id="7406764">)</span>&nbsp;<span class="op" id="7406766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406771">t</span><span class="op" id="7406772">.</span><span class="ident" id="7406773">Errorf</span><span class="op" id="7406779">(</span><span class="string" id="7406780">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7406810">,</span>&nbsp;<span class="ident" id="7406812">tc</span><span class="op" id="7406814">.</span><span class="ident" id="7406815">filename</span><span class="op" id="7406823">,</span>&nbsp;<span class="ident" id="7406825">m0</span><span class="op" id="7406827">.</span><span class="ident" id="7406828">Bounds</span><span class="op" id="7406834">(</span><span class="op" id="7406835">)</span><span class="op" id="7406836">,</span>&nbsp;<span class="ident" id="7406838">m1</span><span class="op" id="7406840">.</span><span class="ident" id="7406841">Bounds</span><span class="op" id="7406847">(</span><span class="op" id="7406848">)</span><span class="op" id="7406849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406854">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7406865">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7406869">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7406924">if</span>&nbsp;<span class="ident" id="7406927">averageDelta</span><span class="op" id="7406939">(</span><span class="ident" id="7406940">m0</span><span class="op" id="7406942">,</span>&nbsp;<span class="ident" id="7406944">m1</span><span class="op" id="7406946">)</span>&nbsp;<span class="op" id="7406948">&gt;</span>&nbsp;<span class="ident" id="7406950">tc</span><span class="op" id="7406952">.</span><span class="ident" id="7406953">tolerance</span>&nbsp;<span class="op" id="7406963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7406968">t</span><span class="op" id="7406969">.</span><span class="ident" id="7406970">Errorf</span><span class="op" id="7406976">(</span><span class="string" id="7406977">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="7407020">,</span>&nbsp;<span class="ident" id="7407022">tc</span><span class="op" id="7407024">.</span><span class="ident" id="7407025">filename</span><span class="op" id="7407033">,</span>&nbsp;<span class="ident" id="7407035">tc</span><span class="op" id="7407037">.</span><span class="ident" id="7407038">quality</span><span class="op" id="7407045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407050">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407061">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407064">}</span><br>
<span class="lineno"></span><span class="op" id="7407066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7407069">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="7407143">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="7407175">func</span>&nbsp;<span class="ident" id="7407180">TestWriteGrayscale</span><span class="op" id="7407198">(</span><span class="ident" id="7407199">t</span>&nbsp;<span class="op" id="7407201">*</span><span class="ident" id="7407202">testing</span><span class="op" id="7407209">.</span><span class="ident" id="7407210">T</span><span class="op" id="7407211">)</span>&nbsp;<span class="op" id="7407213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407216">m0</span>&nbsp;<span class="op" id="7407219">:=</span>&nbsp;<span class="ident" id="7407222">image</span><span class="op" id="7407227">.</span><span class="ident" id="7407228">NewGray</span><span class="op" id="7407235">(</span><span class="ident" id="7407236">image</span><span class="op" id="7407241">.</span><span class="ident" id="7407242">Rect</span><span class="op" id="7407246">(</span><span class="num" id="7407247">0</span><span class="op" id="7407248">,</span>&nbsp;<span class="num" id="7407250">0</span><span class="op" id="7407251">,</span>&nbsp;<span class="num" id="7407253">32</span><span class="op" id="7407255">,</span>&nbsp;<span class="num" id="7407257">32</span><span class="op" id="7407259">)</span><span class="op" id="7407260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407263">for</span>&nbsp;<span class="ident" id="7407267">i</span>&nbsp;<span class="op" id="7407269">:=</span>&nbsp;<span class="keyword" id="7407272">range</span>&nbsp;<span class="ident" id="7407278">m0</span><span class="op" id="7407280">.</span><span class="ident" id="7407281">Pix</span>&nbsp;<span class="op" id="7407285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407289">m0</span><span class="op" id="7407291">.</span><span class="ident" id="7407292">Pix</span><span class="op" id="7407295">[</span><span class="ident" id="7407296">i</span><span class="op" id="7407297">]</span>&nbsp;<span class="op" id="7407299">=</span>&nbsp;<span class="builtintype" id="7407301">uint8</span><span class="op" id="7407306">(</span><span class="ident" id="7407307">i</span><span class="op" id="7407308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407311">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407314">var</span>&nbsp;<span class="ident" id="7407318">buf</span>&nbsp;<span class="ident" id="7407322">bytes</span><span class="op" id="7407327">.</span><span class="ident" id="7407328">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407336">if</span>&nbsp;<span class="ident" id="7407339">err</span>&nbsp;<span class="op" id="7407343">:=</span>&nbsp;<span class="ident" id="7407346">Encode</span><span class="op" id="7407352">(</span><span class="op" id="7407353">&amp;</span><span class="ident" id="7407354">buf</span><span class="op" id="7407357">,</span>&nbsp;<span class="ident" id="7407359">m0</span><span class="op" id="7407361">,</span>&nbsp;<span class="ident" id="7407363">nil</span><span class="op" id="7407366">)</span><span class="op" id="7407367">;</span>&nbsp;<span class="ident" id="7407369">err</span>&nbsp;<span class="op" id="7407373">!=</span>&nbsp;<span class="ident" id="7407376">nil</span>&nbsp;<span class="op" id="7407380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407384">t</span><span class="op" id="7407385">.</span><span class="ident" id="7407386">Fatal</span><span class="op" id="7407391">(</span><span class="ident" id="7407392">err</span><span class="op" id="7407395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407401">m1</span><span class="op" id="7407403">,</span>&nbsp;<span class="ident" id="7407405">err</span>&nbsp;<span class="op" id="7407409">:=</span>&nbsp;<span class="ident" id="7407412">Decode</span><span class="op" id="7407418">(</span><span class="op" id="7407419">&amp;</span><span class="ident" id="7407420">buf</span><span class="op" id="7407423">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407426">if</span>&nbsp;<span class="ident" id="7407429">err</span>&nbsp;<span class="op" id="7407433">!=</span>&nbsp;<span class="ident" id="7407436">nil</span>&nbsp;<span class="op" id="7407440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407444">t</span><span class="op" id="7407445">.</span><span class="ident" id="7407446">Fatal</span><span class="op" id="7407451">(</span><span class="ident" id="7407452">err</span><span class="op" id="7407455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407461">if</span>&nbsp;<span class="ident" id="7407464">m0</span><span class="op" id="7407466">.</span><span class="ident" id="7407467">Bounds</span><span class="op" id="7407473">(</span><span class="op" id="7407474">)</span>&nbsp;<span class="op" id="7407476">!=</span>&nbsp;<span class="ident" id="7407479">m1</span><span class="op" id="7407481">.</span><span class="ident" id="7407482">Bounds</span><span class="op" id="7407488">(</span><span class="op" id="7407489">)</span>&nbsp;<span class="op" id="7407491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407495">t</span><span class="op" id="7407496">.</span><span class="ident" id="7407497">Fatalf</span><span class="op" id="7407503">(</span><span class="string" id="7407504">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7407530">,</span>&nbsp;<span class="ident" id="7407532">m0</span><span class="op" id="7407534">.</span><span class="ident" id="7407535">Bounds</span><span class="op" id="7407541">(</span><span class="op" id="7407542">)</span><span class="op" id="7407543">,</span>&nbsp;<span class="ident" id="7407545">m1</span><span class="op" id="7407547">.</span><span class="ident" id="7407548">Bounds</span><span class="op" id="7407554">(</span><span class="op" id="7407555">)</span><span class="op" id="7407556">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407562">if</span>&nbsp;<span class="ident" id="7407565">_</span><span class="op" id="7407566">,</span>&nbsp;<span class="ident" id="7407568">ok</span>&nbsp;<span class="op" id="7407571">:=</span>&nbsp;<span class="ident" id="7407574">m1</span><span class="op" id="7407576">.</span><span class="op" id="7407577">(</span><span class="op" id="7407578">*</span><span class="ident" id="7407579">image</span><span class="op" id="7407584">.</span><span class="ident" id="7407585">Gray</span><span class="op" id="7407589">)</span><span class="op" id="7407590">;</span>&nbsp;<span class="op" id="7407592">!</span><span class="ident" id="7407593">ok</span>&nbsp;<span class="op" id="7407596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407600">t</span><span class="op" id="7407601">.</span><span class="ident" id="7407602">Errorf</span><span class="op" id="7407608">(</span><span class="string" id="7407609">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="7407635">,</span>&nbsp;<span class="ident" id="7407637">m1</span><span class="op" id="7407639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7407645">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407699">want</span>&nbsp;<span class="op" id="7407704">:=</span>&nbsp;<span class="ident" id="7407707">int64</span><span class="op" id="7407712">(</span><span class="num" id="7407713">2</span>&nbsp;<span class="op" id="7407715">&lt;&lt;</span>&nbsp;<span class="num" id="7407718">8</span><span class="op" id="7407719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407722">if</span>&nbsp;<span class="ident" id="7407725">got</span>&nbsp;<span class="op" id="7407729">:=</span>&nbsp;<span class="ident" id="7407732">averageDelta</span><span class="op" id="7407744">(</span><span class="ident" id="7407745">m0</span><span class="op" id="7407747">,</span>&nbsp;<span class="ident" id="7407749">m1</span><span class="op" id="7407751">)</span><span class="op" id="7407752">;</span>&nbsp;<span class="ident" id="7407754">got</span>&nbsp;<span class="op" id="7407758">&gt;</span>&nbsp;<span class="ident" id="7407760">want</span>&nbsp;<span class="op" id="7407765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407769">t</span><span class="op" id="7407770">.</span><span class="ident" id="7407771">Errorf</span><span class="op" id="7407777">(</span><span class="string" id="7407778">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="7407822">,</span>&nbsp;<span class="ident" id="7407824">got</span><span class="op" id="7407827">,</span>&nbsp;<span class="ident" id="7407829">want</span><span class="op" id="7407833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407836">}</span><br>
<span class="lineno"></span><span class="op" id="7407838">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="7407841">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="7407917">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="7407942">func</span>&nbsp;<span class="ident" id="7407947">averageDelta</span><span class="op" id="7407959">(</span><span class="ident" id="7407960">m0</span><span class="op" id="7407962">,</span>&nbsp;<span class="ident" id="7407964">m1</span>&nbsp;<span class="ident" id="7407967">image</span><span class="op" id="7407972">.</span><span class="ident" id="7407973">Image</span><span class="op" id="7407978">)</span>&nbsp;<span class="ident" id="7407980">int64</span>&nbsp;<span class="op" id="7407986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407989">b</span>&nbsp;<span class="op" id="7407991">:=</span>&nbsp;<span class="ident" id="7407994">m0</span><span class="op" id="7407996">.</span><span class="ident" id="7407997">Bounds</span><span class="op" id="7408003">(</span><span class="op" id="7408004">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408007">var</span>&nbsp;<span class="ident" id="7408011">sum</span><span class="op" id="7408014">,</span>&nbsp;<span class="ident" id="7408016">n</span>&nbsp;<span class="ident" id="7408018">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408025">for</span>&nbsp;<span class="ident" id="7408029">y</span>&nbsp;<span class="op" id="7408031">:=</span>&nbsp;<span class="ident" id="7408034">b</span><span class="op" id="7408035">.</span><span class="ident" id="7408036">Min</span><span class="op" id="7408039">.</span><span class="ident" id="7408040">Y</span><span class="op" id="7408041">;</span>&nbsp;<span class="ident" id="7408043">y</span>&nbsp;<span class="op" id="7408045">&lt;</span>&nbsp;<span class="ident" id="7408047">b</span><span class="op" id="7408048">.</span><span class="ident" id="7408049">Max</span><span class="op" id="7408052">.</span><span class="ident" id="7408053">Y</span><span class="op" id="7408054">;</span>&nbsp;<span class="ident" id="7408056">y</span><span class="op" id="7408057">++</span>&nbsp;<span class="op" id="7408060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408064">for</span>&nbsp;<span class="ident" id="7408068">x</span>&nbsp;<span class="op" id="7408070">:=</span>&nbsp;<span class="ident" id="7408073">b</span><span class="op" id="7408074">.</span><span class="ident" id="7408075">Min</span><span class="op" id="7408078">.</span><span class="ident" id="7408079">X</span><span class="op" id="7408080">;</span>&nbsp;<span class="ident" id="7408082">x</span>&nbsp;<span class="op" id="7408084">&lt;</span>&nbsp;<span class="ident" id="7408086">b</span><span class="op" id="7408087">.</span><span class="ident" id="7408088">Max</span><span class="op" id="7408091">.</span><span class="ident" id="7408092">X</span><span class="op" id="7408093">;</span>&nbsp;<span class="ident" id="7408095">x</span><span class="op" id="7408096">++</span>&nbsp;<span class="op" id="7408099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408104">c0</span>&nbsp;<span class="op" id="7408107">:=</span>&nbsp;<span class="ident" id="7408110">m0</span><span class="op" id="7408112">.</span><span class="ident" id="7408113">At</span><span class="op" id="7408115">(</span><span class="ident" id="7408116">x</span><span class="op" id="7408117">,</span>&nbsp;<span class="ident" id="7408119">y</span><span class="op" id="7408120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408125">c1</span>&nbsp;<span class="op" id="7408128">:=</span>&nbsp;<span class="ident" id="7408131">m1</span><span class="op" id="7408133">.</span><span class="ident" id="7408134">At</span><span class="op" id="7408136">(</span><span class="ident" id="7408137">x</span><span class="op" id="7408138">,</span>&nbsp;<span class="ident" id="7408140">y</span><span class="op" id="7408141">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408146">r0</span><span class="op" id="7408148">,</span>&nbsp;<span class="ident" id="7408150">g0</span><span class="op" id="7408152">,</span>&nbsp;<span class="ident" id="7408154">b0</span><span class="op" id="7408156">,</span>&nbsp;<span class="ident" id="7408158">_</span>&nbsp;<span class="op" id="7408160">:=</span>&nbsp;<span class="ident" id="7408163">c0</span><span class="op" id="7408165">.</span><span class="ident" id="7408166">RGBA</span><span class="op" id="7408170">(</span><span class="op" id="7408171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408176">r1</span><span class="op" id="7408178">,</span>&nbsp;<span class="ident" id="7408180">g1</span><span class="op" id="7408182">,</span>&nbsp;<span class="ident" id="7408184">b1</span><span class="op" id="7408186">,</span>&nbsp;<span class="ident" id="7408188">_</span>&nbsp;<span class="op" id="7408190">:=</span>&nbsp;<span class="ident" id="7408193">c1</span><span class="op" id="7408195">.</span><span class="ident" id="7408196">RGBA</span><span class="op" id="7408200">(</span><span class="op" id="7408201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408206">sum</span>&nbsp;<span class="op" id="7408210">+=</span>&nbsp;<span class="ident" id="7408213">delta</span><span class="op" id="7408218">(</span><span class="ident" id="7408219">r0</span><span class="op" id="7408221">,</span>&nbsp;<span class="ident" id="7408223">r1</span><span class="op" id="7408225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408230">sum</span>&nbsp;<span class="op" id="7408234">+=</span>&nbsp;<span class="ident" id="7408237">delta</span><span class="op" id="7408242">(</span><span class="ident" id="7408243">g0</span><span class="op" id="7408245">,</span>&nbsp;<span class="ident" id="7408247">g1</span><span class="op" id="7408249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408254">sum</span>&nbsp;<span class="op" id="7408258">+=</span>&nbsp;<span class="ident" id="7408261">delta</span><span class="op" id="7408266">(</span><span class="ident" id="7408267">b0</span><span class="op" id="7408269">,</span>&nbsp;<span class="ident" id="7408271">b1</span><span class="op" id="7408273">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408278">n</span>&nbsp;<span class="op" id="7408280">+=</span>&nbsp;<span class="num" id="7408283">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408293">return</span>&nbsp;<span class="ident" id="7408300">sum</span>&nbsp;<span class="op" id="7408304">/</span>&nbsp;<span class="ident" id="7408306">n</span><br>
<span class="lineno"></span><span class="op" id="7408308">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="7408311">func</span>&nbsp;<span class="ident" id="7408316">BenchmarkEncode</span><span class="op" id="7408331">(</span><span class="ident" id="7408332">b</span>&nbsp;<span class="op" id="7408334">*</span><span class="ident" id="7408335">testing</span><span class="op" id="7408342">.</span><span class="ident" id="7408343">B</span><span class="op" id="7408344">)</span>&nbsp;<span class="op" id="7408346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408349">b</span><span class="op" id="7408350">.</span><span class="ident" id="7408351">StopTimer</span><span class="op" id="7408360">(</span><span class="op" id="7408361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408364">img</span>&nbsp;<span class="op" id="7408368">:=</span>&nbsp;<span class="ident" id="7408371">image</span><span class="op" id="7408376">.</span><span class="ident" id="7408377">NewRGBA</span><span class="op" id="7408384">(</span><span class="ident" id="7408385">image</span><span class="op" id="7408390">.</span><span class="ident" id="7408391">Rect</span><span class="op" id="7408395">(</span><span class="num" id="7408396">0</span><span class="op" id="7408397">,</span>&nbsp;<span class="num" id="7408399">0</span><span class="op" id="7408400">,</span>&nbsp;<span class="num" id="7408402">640</span><span class="op" id="7408405">,</span>&nbsp;<span class="num" id="7408407">480</span><span class="op" id="7408410">)</span><span class="op" id="7408411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408414">bo</span>&nbsp;<span class="op" id="7408417">:=</span>&nbsp;<span class="ident" id="7408420">img</span><span class="op" id="7408423">.</span><span class="ident" id="7408424">Bounds</span><span class="op" id="7408430">(</span><span class="op" id="7408431">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408434">rnd</span>&nbsp;<span class="op" id="7408438">:=</span>&nbsp;<span class="ident" id="7408441">rand</span><span class="op" id="7408445">.</span><span class="ident" id="7408446">New</span><span class="op" id="7408449">(</span><span class="ident" id="7408450">rand</span><span class="op" id="7408454">.</span><span class="ident" id="7408455">NewSource</span><span class="op" id="7408464">(</span><span class="num" id="7408465">123</span><span class="op" id="7408468">)</span><span class="op" id="7408469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408472">for</span>&nbsp;<span class="ident" id="7408476">y</span>&nbsp;<span class="op" id="7408478">:=</span>&nbsp;<span class="ident" id="7408481">bo</span><span class="op" id="7408483">.</span><span class="ident" id="7408484">Min</span><span class="op" id="7408487">.</span><span class="ident" id="7408488">Y</span><span class="op" id="7408489">;</span>&nbsp;<span class="ident" id="7408491">y</span>&nbsp;<span class="op" id="7408493">&lt;</span>&nbsp;<span class="ident" id="7408495">bo</span><span class="op" id="7408497">.</span><span class="ident" id="7408498">Max</span><span class="op" id="7408501">.</span><span class="ident" id="7408502">Y</span><span class="op" id="7408503">;</span>&nbsp;<span class="ident" id="7408505">y</span><span class="op" id="7408506">++</span>&nbsp;<span class="op" id="7408509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408513">for</span>&nbsp;<span class="ident" id="7408517">x</span>&nbsp;<span class="op" id="7408519">:=</span>&nbsp;<span class="ident" id="7408522">bo</span><span class="op" id="7408524">.</span><span class="ident" id="7408525">Min</span><span class="op" id="7408528">.</span><span class="ident" id="7408529">X</span><span class="op" id="7408530">;</span>&nbsp;<span class="ident" id="7408532">x</span>&nbsp;<span class="op" id="7408534">&lt;</span>&nbsp;<span class="ident" id="7408536">bo</span><span class="op" id="7408538">.</span><span class="ident" id="7408539">Max</span><span class="op" id="7408542">.</span><span class="ident" id="7408543">X</span><span class="op" id="7408544">;</span>&nbsp;<span class="ident" id="7408546">x</span><span class="op" id="7408547">++</span>&nbsp;<span class="op" id="7408550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408555">img</span><span class="op" id="7408558">.</span><span class="ident" id="7408559">SetRGBA</span><span class="op" id="7408566">(</span><span class="ident" id="7408567">x</span><span class="op" id="7408568">,</span>&nbsp;<span class="ident" id="7408570">y</span><span class="op" id="7408571">,</span>&nbsp;<span class="ident" id="7408573">color</span><span class="op" id="7408578">.</span><span class="ident" id="7408579">RGBA</span><span class="op" id="7408583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7408589">uint8</span><span class="op" id="7408594">(</span><span class="ident" id="7408595">rnd</span><span class="op" id="7408598">.</span><span class="ident" id="7408599">Intn</span><span class="op" id="7408603">(</span><span class="num" id="7408604">256</span><span class="op" id="7408607">)</span><span class="op" id="7408608">)</span><span class="op" id="7408609">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7408615">uint8</span><span class="op" id="7408620">(</span><span class="ident" id="7408621">rnd</span><span class="op" id="7408624">.</span><span class="ident" id="7408625">Intn</span><span class="op" id="7408629">(</span><span class="num" id="7408630">256</span><span class="op" id="7408633">)</span><span class="op" id="7408634">)</span><span class="op" id="7408635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7408641">uint8</span><span class="op" id="7408646">(</span><span class="ident" id="7408647">rnd</span><span class="op" id="7408650">.</span><span class="ident" id="7408651">Intn</span><span class="op" id="7408655">(</span><span class="num" id="7408656">256</span><span class="op" id="7408659">)</span><span class="op" id="7408660">)</span><span class="op" id="7408661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7408667">255</span><span class="op" id="7408670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408675">}</span><span class="op" id="7408676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408680">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408686">b</span><span class="op" id="7408687">.</span><span class="ident" id="7408688">SetBytes</span><span class="op" id="7408696">(</span><span class="num" id="7408697">640</span>&nbsp;<span class="op" id="7408701">*</span>&nbsp;<span class="num" id="7408703">480</span>&nbsp;<span class="op" id="7408707">*</span>&nbsp;<span class="num" id="7408709">4</span><span class="op" id="7408710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408713">b</span><span class="op" id="7408714">.</span><span class="ident" id="7408715">StartTimer</span><span class="op" id="7408725">(</span><span class="op" id="7408726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408729">options</span>&nbsp;<span class="op" id="7408737">:=</span>&nbsp;<span class="op" id="7408740">&amp;</span><span class="ident" id="7408741">Options</span><span class="op" id="7408748">{</span><span class="ident" id="7408749">Quality</span><span class="op" id="7408756">:</span>&nbsp;<span class="num" id="7408758">90</span><span class="op" id="7408760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408763">for</span>&nbsp;<span class="ident" id="7408767">i</span>&nbsp;<span class="op" id="7408769">:=</span>&nbsp;<span class="num" id="7408772">0</span><span class="op" id="7408773">;</span>&nbsp;<span class="ident" id="7408775">i</span>&nbsp;<span class="op" id="7408777">&lt;</span>&nbsp;<span class="ident" id="7408779">b</span><span class="op" id="7408780">.</span><span class="ident" id="7408781">N</span><span class="op" id="7408782">;</span>&nbsp;<span class="ident" id="7408784">i</span><span class="op" id="7408785">++</span>&nbsp;<span class="op" id="7408788">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408792">Encode</span><span class="op" id="7408798">(</span><span class="ident" id="7408799">ioutil</span><span class="op" id="7408805">.</span><span class="ident" id="7408806">Discard</span><span class="op" id="7408813">,</span>&nbsp;<span class="ident" id="7408815">img</span><span class="op" id="7408818">,</span>&nbsp;<span class="ident" id="7408820">options</span><span class="op" id="7408827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408830">}</span><br>
<span class="lineno"></span><span class="op" id="7408832">}</span>
</div>
</body>
</html>
