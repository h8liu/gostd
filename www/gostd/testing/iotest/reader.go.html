<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5418230">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5418285">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5418339">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5418390">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5418466">package</span>&nbsp;<span class="ident" id="5418474">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5418482">import</span>&nbsp;<span class="op" id="5418489">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5418492">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5418502">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5418507">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5418510">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="5418560">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="5418611">func</span>&nbsp;<span class="ident" id="5418616">OneByteReader</span><span class="op" id="5418629">(</span><span class="ident" id="5418630">r</span>&nbsp;<span class="ident" id="5418632">io</span><span class="op" id="5418634">.</span><span class="ident" id="5418635">Reader</span><span class="op" id="5418641">)</span>&nbsp;<span class="ident" id="5418643">io</span><span class="op" id="5418645">.</span><span class="ident" id="5418646">Reader</span>&nbsp;<span class="op" id="5418653">{</span>&nbsp;<span class="keyword" id="5418655">return</span>&nbsp;<span class="op" id="5418662">&amp;</span><span class="ident" id="5418663">oneByteReader</span><span class="op" id="5418676">{</span><span class="ident" id="5418677">r</span><span class="op" id="5418678">}</span>&nbsp;<span class="op" id="5418680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5418683">type</span>&nbsp;<span class="ident" id="5418688">oneByteReader</span>&nbsp;<span class="keyword" id="5418702">struct</span>&nbsp;<span class="op" id="5418709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5418712">r</span>&nbsp;<span class="ident" id="5418714">io</span><span class="op" id="5418716">.</span><span class="ident" id="5418717">Reader</span><br>
<span class="lineno"></span><span class="op" id="5418724">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5418727">func</span>&nbsp;<span class="op" id="5418732">(</span><span class="ident" id="5418733">r</span>&nbsp;<span class="op" id="5418735">*</span><span class="ident" id="5418736">oneByteReader</span><span class="op" id="5418749">)</span>&nbsp;<span class="ident" id="5418751">Read</span><span class="op" id="5418755">(</span><span class="ident" id="5418756">p</span>&nbsp;<span class="op" id="5418758">[</span><span class="op" id="5418759">]</span><span class="builtintype" id="5418760">byte</span><span class="op" id="5418764">)</span>&nbsp;<span class="op" id="5418766">(</span><span class="builtintype" id="5418767">int</span><span class="op" id="5418770">,</span>&nbsp;<span class="builtintype" id="5418772">error</span><span class="op" id="5418777">)</span>&nbsp;<span class="op" id="5418779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5418782">if</span>&nbsp;<span class="builtinfunc" id="5418785">len</span><span class="op" id="5418788">(</span><span class="ident" id="5418789">p</span><span class="op" id="5418790">)</span>&nbsp;<span class="op" id="5418792">==</span>&nbsp;<span class="num" id="5418795">0</span>&nbsp;<span class="op" id="5418797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5418801">return</span>&nbsp;<span class="num" id="5418808">0</span><span class="op" id="5418809">,</span>&nbsp;<span class="builtintype" id="5418811">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5418816">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5418819">return</span>&nbsp;<span class="ident" id="5418826">r</span><span class="op" id="5418827">.</span><span class="ident" id="5418828">r</span><span class="op" id="5418829">.</span><span class="ident" id="5418830">Read</span><span class="op" id="5418834">(</span><span class="ident" id="5418835">p</span><span class="op" id="5418836">[</span><span class="num" id="5418837">0</span><span class="op" id="5418838">:</span><span class="num" id="5418839">1</span><span class="op" id="5418840">]</span><span class="op" id="5418841">)</span><br>
<span class="lineno"></span><span class="op" id="5418843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5418846">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="5418898">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="5418949">func</span>&nbsp;<span class="ident" id="5418954">HalfReader</span><span class="op" id="5418964">(</span><span class="ident" id="5418965">r</span>&nbsp;<span class="ident" id="5418967">io</span><span class="op" id="5418969">.</span><span class="ident" id="5418970">Reader</span><span class="op" id="5418976">)</span>&nbsp;<span class="ident" id="5418978">io</span><span class="op" id="5418980">.</span><span class="ident" id="5418981">Reader</span>&nbsp;<span class="op" id="5418988">{</span>&nbsp;<span class="keyword" id="5418990">return</span>&nbsp;<span class="op" id="5418997">&amp;</span><span class="ident" id="5418998">halfReader</span><span class="op" id="5419008">{</span><span class="ident" id="5419009">r</span><span class="op" id="5419010">}</span>&nbsp;<span class="op" id="5419012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5419015">type</span>&nbsp;<span class="ident" id="5419020">halfReader</span>&nbsp;<span class="keyword" id="5419031">struct</span>&nbsp;<span class="op" id="5419038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419041">r</span>&nbsp;<span class="ident" id="5419043">io</span><span class="op" id="5419045">.</span><span class="ident" id="5419046">Reader</span><br>
<span class="lineno"></span><span class="op" id="5419053">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="5419056">func</span>&nbsp;<span class="op" id="5419061">(</span><span class="ident" id="5419062">r</span>&nbsp;<span class="op" id="5419064">*</span><span class="ident" id="5419065">halfReader</span><span class="op" id="5419075">)</span>&nbsp;<span class="ident" id="5419077">Read</span><span class="op" id="5419081">(</span><span class="ident" id="5419082">p</span>&nbsp;<span class="op" id="5419084">[</span><span class="op" id="5419085">]</span><span class="builtintype" id="5419086">byte</span><span class="op" id="5419090">)</span>&nbsp;<span class="op" id="5419092">(</span><span class="builtintype" id="5419093">int</span><span class="op" id="5419096">,</span>&nbsp;<span class="builtintype" id="5419098">error</span><span class="op" id="5419103">)</span>&nbsp;<span class="op" id="5419105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5419108">return</span>&nbsp;<span class="ident" id="5419115">r</span><span class="op" id="5419116">.</span><span class="ident" id="5419117">r</span><span class="op" id="5419118">.</span><span class="ident" id="5419119">Read</span><span class="op" id="5419123">(</span><span class="ident" id="5419124">p</span><span class="op" id="5419125">[</span><span class="num" id="5419126">0</span>&nbsp;<span class="op" id="5419128">:</span>&nbsp;<span class="op" id="5419130">(</span><span class="builtinfunc" id="5419131">len</span><span class="op" id="5419134">(</span><span class="ident" id="5419135">p</span><span class="op" id="5419136">)</span><span class="op" id="5419137">+</span><span class="num" id="5419138">1</span><span class="op" id="5419139">)</span><span class="op" id="5419140">/</span><span class="num" id="5419141">2</span><span class="op" id="5419142">]</span><span class="op" id="5419143">)</span><br>
<span class="lineno"></span><span class="op" id="5419145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5419148">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5419225">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5419303">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5419379">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="5419457">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="5419503">func</span>&nbsp;<span class="ident" id="5419508">DataErrReader</span><span class="op" id="5419521">(</span><span class="ident" id="5419522">r</span>&nbsp;<span class="ident" id="5419524">io</span><span class="op" id="5419526">.</span><span class="ident" id="5419527">Reader</span><span class="op" id="5419533">)</span>&nbsp;<span class="ident" id="5419535">io</span><span class="op" id="5419537">.</span><span class="ident" id="5419538">Reader</span>&nbsp;<span class="op" id="5419545">{</span>&nbsp;<span class="keyword" id="5419547">return</span>&nbsp;<span class="op" id="5419554">&amp;</span><span class="ident" id="5419555">dataErrReader</span><span class="op" id="5419568">{</span><span class="ident" id="5419569">r</span><span class="op" id="5419570">,</span>&nbsp;<span class="builtintype" id="5419572">nil</span><span class="op" id="5419575">,</span>&nbsp;<span class="builtinfunc" id="5419577">make</span><span class="op" id="5419581">(</span><span class="op" id="5419582">[</span><span class="op" id="5419583">]</span><span class="builtintype" id="5419584">byte</span><span class="op" id="5419588">,</span>&nbsp;<span class="num" id="5419590">1024</span><span class="op" id="5419594">)</span><span class="op" id="5419595">}</span>&nbsp;<span class="op" id="5419597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5419600">type</span>&nbsp;<span class="ident" id="5419605">dataErrReader</span>&nbsp;<span class="keyword" id="5419619">struct</span>&nbsp;<span class="op" id="5419626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419629">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419636">io</span><span class="op" id="5419638">.</span><span class="ident" id="5419639">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419647">unread</span>&nbsp;<span class="op" id="5419654">[</span><span class="op" id="5419655">]</span><span class="builtintype" id="5419656">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419662">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5419669">[</span><span class="op" id="5419670">]</span><span class="builtintype" id="5419671">byte</span><br>
<span class="lineno"></span><span class="op" id="5419676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5419679">func</span>&nbsp;<span class="op" id="5419684">(</span><span class="ident" id="5419685">r</span>&nbsp;<span class="op" id="5419687">*</span><span class="ident" id="5419688">dataErrReader</span><span class="op" id="5419701">)</span>&nbsp;<span class="ident" id="5419703">Read</span><span class="op" id="5419707">(</span><span class="ident" id="5419708">p</span>&nbsp;<span class="op" id="5419710">[</span><span class="op" id="5419711">]</span><span class="builtintype" id="5419712">byte</span><span class="op" id="5419716">)</span>&nbsp;<span class="op" id="5419718">(</span><span class="ident" id="5419719">n</span>&nbsp;<span class="builtintype" id="5419721">int</span><span class="op" id="5419724">,</span>&nbsp;<span class="ident" id="5419726">err</span>&nbsp;<span class="builtintype" id="5419730">error</span><span class="op" id="5419735">)</span>&nbsp;<span class="op" id="5419737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5419740">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5419785">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5419840">for</span>&nbsp;<span class="op" id="5419844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5419848">if</span>&nbsp;<span class="builtinfunc" id="5419851">len</span><span class="op" id="5419854">(</span><span class="ident" id="5419855">r</span><span class="op" id="5419856">.</span><span class="ident" id="5419857">unread</span><span class="op" id="5419863">)</span>&nbsp;<span class="op" id="5419865">==</span>&nbsp;<span class="num" id="5419868">0</span>&nbsp;<span class="op" id="5419870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419875">n1</span><span class="op" id="5419877">,</span>&nbsp;<span class="ident" id="5419879">err1</span>&nbsp;<span class="op" id="5419884">:=</span>&nbsp;<span class="ident" id="5419887">r</span><span class="op" id="5419888">.</span><span class="ident" id="5419889">r</span><span class="op" id="5419890">.</span><span class="ident" id="5419891">Read</span><span class="op" id="5419895">(</span><span class="ident" id="5419896">r</span><span class="op" id="5419897">.</span><span class="ident" id="5419898">data</span><span class="op" id="5419902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419907">r</span><span class="op" id="5419908">.</span><span class="ident" id="5419909">unread</span>&nbsp;<span class="op" id="5419916">=</span>&nbsp;<span class="ident" id="5419918">r</span><span class="op" id="5419919">.</span><span class="ident" id="5419920">data</span><span class="op" id="5419924">[</span><span class="num" id="5419925">0</span><span class="op" id="5419926">:</span><span class="ident" id="5419927">n1</span><span class="op" id="5419929">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419934">err</span>&nbsp;<span class="op" id="5419938">=</span>&nbsp;<span class="ident" id="5419940">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5419947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5419951">if</span>&nbsp;<span class="ident" id="5419954">n</span>&nbsp;<span class="op" id="5419956">&gt;</span>&nbsp;<span class="num" id="5419958">0</span>&nbsp;<span class="op" id="5419960">||</span>&nbsp;<span class="ident" id="5419963">err</span>&nbsp;<span class="op" id="5419967">!=</span>&nbsp;<span class="builtintype" id="5419970">nil</span>&nbsp;<span class="op" id="5419974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5419979">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5419987">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5419991">n</span>&nbsp;<span class="op" id="5419993">=</span>&nbsp;<span class="builtinfunc" id="5419995">copy</span><span class="op" id="5419999">(</span><span class="ident" id="5420000">p</span><span class="op" id="5420001">,</span>&nbsp;<span class="ident" id="5420003">r</span><span class="op" id="5420004">.</span><span class="ident" id="5420005">unread</span><span class="op" id="5420011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5420015">r</span><span class="op" id="5420016">.</span><span class="ident" id="5420017">unread</span>&nbsp;<span class="op" id="5420024">=</span>&nbsp;<span class="ident" id="5420026">r</span><span class="op" id="5420027">.</span><span class="ident" id="5420028">unread</span><span class="op" id="5420034">[</span><span class="ident" id="5420035">n</span><span class="op" id="5420036">:</span><span class="op" id="5420037">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5420040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5420043">return</span><br>
<span class="lineno"></span><span class="op" id="5420050">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="5420053">var</span>&nbsp;<span class="ident" id="5420057">ErrTimeout</span>&nbsp;<span class="op" id="5420068">=</span>&nbsp;<span class="ident" id="5420070">errors</span><span class="op" id="5420076">.</span><span class="ident" id="5420077">New</span><span class="op" id="5420080">(</span><span class="string" id="5420081">&#34;timeout&#34;</span><span class="op" id="5420090">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5420093">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5420148">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="5420200">func</span>&nbsp;<span class="ident" id="5420205">TimeoutReader</span><span class="op" id="5420218">(</span><span class="ident" id="5420219">r</span>&nbsp;<span class="ident" id="5420221">io</span><span class="op" id="5420223">.</span><span class="ident" id="5420224">Reader</span><span class="op" id="5420230">)</span>&nbsp;<span class="ident" id="5420232">io</span><span class="op" id="5420234">.</span><span class="ident" id="5420235">Reader</span>&nbsp;<span class="op" id="5420242">{</span>&nbsp;<span class="keyword" id="5420244">return</span>&nbsp;<span class="op" id="5420251">&amp;</span><span class="ident" id="5420252">timeoutReader</span><span class="op" id="5420265">{</span><span class="ident" id="5420266">r</span><span class="op" id="5420267">,</span>&nbsp;<span class="num" id="5420269">0</span><span class="op" id="5420270">}</span>&nbsp;<span class="op" id="5420272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5420275">type</span>&nbsp;<span class="ident" id="5420280">timeoutReader</span>&nbsp;<span class="keyword" id="5420294">struct</span>&nbsp;<span class="op" id="5420301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5420304">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5420310">io</span><span class="op" id="5420312">.</span><span class="ident" id="5420313">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5420321">count</span>&nbsp;<span class="builtintype" id="5420327">int</span><br>
<span class="lineno">80</span><span class="op" id="5420331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5420334">func</span>&nbsp;<span class="op" id="5420339">(</span><span class="ident" id="5420340">r</span>&nbsp;<span class="op" id="5420342">*</span><span class="ident" id="5420343">timeoutReader</span><span class="op" id="5420356">)</span>&nbsp;<span class="ident" id="5420358">Read</span><span class="op" id="5420362">(</span><span class="ident" id="5420363">p</span>&nbsp;<span class="op" id="5420365">[</span><span class="op" id="5420366">]</span><span class="builtintype" id="5420367">byte</span><span class="op" id="5420371">)</span>&nbsp;<span class="op" id="5420373">(</span><span class="builtintype" id="5420374">int</span><span class="op" id="5420377">,</span>&nbsp;<span class="builtintype" id="5420379">error</span><span class="op" id="5420384">)</span>&nbsp;<span class="op" id="5420386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5420389">r</span><span class="op" id="5420390">.</span><span class="ident" id="5420391">count</span><span class="op" id="5420396">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5420400">if</span>&nbsp;<span class="ident" id="5420403">r</span><span class="op" id="5420404">.</span><span class="ident" id="5420405">count</span>&nbsp;<span class="op" id="5420411">==</span>&nbsp;<span class="num" id="5420414">2</span>&nbsp;<span class="op" id="5420416">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5420420">return</span>&nbsp;<span class="num" id="5420427">0</span><span class="op" id="5420428">,</span>&nbsp;<span class="ident" id="5420430">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5420442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5420445">return</span>&nbsp;<span class="ident" id="5420452">r</span><span class="op" id="5420453">.</span><span class="ident" id="5420454">r</span><span class="op" id="5420455">.</span><span class="ident" id="5420456">Read</span><span class="op" id="5420460">(</span><span class="ident" id="5420461">p</span><span class="op" id="5420462">)</span><br>
<span class="lineno"></span><span class="op" id="5420464">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
