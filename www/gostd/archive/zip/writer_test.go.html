<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7152644">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7152699">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7152753">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7152804">package</span>&nbsp;<span class="ident" id="7152812">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7152817">import</span>&nbsp;<span class="op" id="7152824">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7152827">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7152836">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7152842">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7152855">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7152868">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7152874">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7152884">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7152887">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7152934">type</span>&nbsp;<span class="ident" id="7152939">WriteTest</span>&nbsp;<span class="keyword" id="7152949">struct</span>&nbsp;<span class="op" id="7152956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152959">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7152966">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152974">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7152981">[</span><span class="op" id="7152982">]</span><span class="builtintype" id="7152983">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152989">Method</span>&nbsp;<span class="builtintype" id="7152996">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153004">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7153011">os</span><span class="op" id="7153013">.</span><span class="ident" id="7153014">FileMode</span><br>
<span class="lineno"></span><span class="op" id="7153023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7153026">var</span>&nbsp;<span class="ident" id="7153030">writeTests</span>&nbsp;<span class="op" id="7153041">=</span>&nbsp;<span class="op" id="7153043">[</span><span class="op" id="7153044">]</span><span class="ident" id="7153045">WriteTest</span><span class="op" id="7153054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153061">Name</span><span class="op" id="7153065">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7153069">&#34;foo&#34;</span><span class="op" id="7153074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153078">Data</span><span class="op" id="7153082">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7153086">[</span><span class="op" id="7153087">]</span><span class="builtintype" id="7153088">byte</span><span class="op" id="7153092">(</span><span class="string" id="7153093">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="7153153">)</span><span class="op" id="7153154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153158">Method</span><span class="op" id="7153164">:</span>&nbsp;<span class="ident" id="7153166">Store</span><span class="op" id="7153171">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153175">Mode</span><span class="op" id="7153179">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7153183">0666</span><span class="op" id="7153187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153190">}</span><span class="op" id="7153191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153198">Name</span><span class="op" id="7153202">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7153206">&#34;bar&#34;</span><span class="op" id="7153211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153215">Data</span><span class="op" id="7153219">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7153223">nil</span><span class="op" id="7153226">,</span>&nbsp;<span class="comment" id="7153228">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153260">Method</span><span class="op" id="7153266">:</span>&nbsp;<span class="ident" id="7153268">Deflate</span><span class="op" id="7153275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153279">Mode</span><span class="op" id="7153283">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7153287">0644</span><span class="op" id="7153291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153294">}</span><span class="op" id="7153295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153302">Name</span><span class="op" id="7153306">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7153310">&#34;setuid&#34;</span><span class="op" id="7153318">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153322">Data</span><span class="op" id="7153326">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7153330">[</span><span class="op" id="7153331">]</span><span class="builtintype" id="7153332">byte</span><span class="op" id="7153336">(</span><span class="string" id="7153337">&#34;setuid&nbsp;file&#34;</span><span class="op" id="7153350">)</span><span class="op" id="7153351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153355">Method</span><span class="op" id="7153361">:</span>&nbsp;<span class="ident" id="7153363">Deflate</span><span class="op" id="7153370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153374">Mode</span><span class="op" id="7153378">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7153382">0755</span>&nbsp;<span class="op" id="7153387">|</span>&nbsp;<span class="ident" id="7153389">os</span><span class="op" id="7153391">.</span><span class="ident" id="7153392">ModeSetuid</span><span class="op" id="7153402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153405">}</span><span class="op" id="7153406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153409">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153413">Name</span><span class="op" id="7153417">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7153421">&#34;setgid&#34;</span><span class="op" id="7153429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153433">Data</span><span class="op" id="7153437">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7153441">[</span><span class="op" id="7153442">]</span><span class="builtintype" id="7153443">byte</span><span class="op" id="7153447">(</span><span class="string" id="7153448">&#34;setgid&nbsp;file&#34;</span><span class="op" id="7153461">)</span><span class="op" id="7153462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153466">Method</span><span class="op" id="7153472">:</span>&nbsp;<span class="ident" id="7153474">Deflate</span><span class="op" id="7153481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153485">Mode</span><span class="op" id="7153489">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7153493">0755</span>&nbsp;<span class="op" id="7153498">|</span>&nbsp;<span class="ident" id="7153500">os</span><span class="op" id="7153502">.</span><span class="ident" id="7153503">ModeSetgid</span><span class="op" id="7153513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153516">}</span><span class="op" id="7153517">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153524">Name</span><span class="op" id="7153528">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7153532">&#34;symlink&#34;</span><span class="op" id="7153541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153545">Data</span><span class="op" id="7153549">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7153553">[</span><span class="op" id="7153554">]</span><span class="builtintype" id="7153555">byte</span><span class="op" id="7153559">(</span><span class="string" id="7153560">&#34;../link/target&#34;</span><span class="op" id="7153576">)</span><span class="op" id="7153577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153581">Method</span><span class="op" id="7153587">:</span>&nbsp;<span class="ident" id="7153589">Deflate</span><span class="op" id="7153596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153600">Mode</span><span class="op" id="7153604">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7153608">0755</span>&nbsp;<span class="op" id="7153613">|</span>&nbsp;<span class="ident" id="7153615">os</span><span class="op" id="7153617">.</span><span class="ident" id="7153618">ModeSymlink</span><span class="op" id="7153629">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153632">}</span><span class="op" id="7153633">,</span><br>
<span class="lineno"></span><span class="op" id="7153635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7153638">func</span>&nbsp;<span class="ident" id="7153643">TestWriter</span><span class="op" id="7153653">(</span><span class="ident" id="7153654">t</span>&nbsp;<span class="op" id="7153656">*</span><span class="ident" id="7153657">testing</span><span class="op" id="7153664">.</span><span class="ident" id="7153665">T</span><span class="op" id="7153666">)</span>&nbsp;<span class="op" id="7153668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153671">largeData</span>&nbsp;<span class="op" id="7153681">:=</span>&nbsp;<span class="builtinfunc" id="7153684">make</span><span class="op" id="7153688">(</span><span class="op" id="7153689">[</span><span class="op" id="7153690">]</span><span class="builtintype" id="7153691">byte</span><span class="op" id="7153695">,</span>&nbsp;<span class="num" id="7153697">1</span><span class="op" id="7153698">&lt;&lt;</span><span class="num" id="7153700">17</span><span class="op" id="7153702">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153705">for</span>&nbsp;<span class="ident" id="7153709">i</span>&nbsp;<span class="op" id="7153711">:=</span>&nbsp;<span class="keyword" id="7153714">range</span>&nbsp;<span class="ident" id="7153720">largeData</span>&nbsp;<span class="op" id="7153730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153734">largeData</span><span class="op" id="7153743">[</span><span class="ident" id="7153744">i</span><span class="op" id="7153745">]</span>&nbsp;<span class="op" id="7153747">=</span>&nbsp;<span class="builtintype" id="7153749">byte</span><span class="op" id="7153753">(</span><span class="ident" id="7153754">rand</span><span class="op" id="7153758">.</span><span class="ident" id="7153759">Int</span><span class="op" id="7153762">(</span><span class="op" id="7153763">)</span><span class="op" id="7153764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153770">writeTests</span><span class="op" id="7153780">[</span><span class="num" id="7153781">1</span><span class="op" id="7153782">]</span><span class="op" id="7153783">.</span><span class="ident" id="7153784">Data</span>&nbsp;<span class="op" id="7153789">=</span>&nbsp;<span class="ident" id="7153791">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153802">defer</span>&nbsp;<span class="keyword" id="7153808">func</span><span class="op" id="7153812">(</span><span class="op" id="7153813">)</span>&nbsp;<span class="op" id="7153815">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153819">writeTests</span><span class="op" id="7153829">[</span><span class="num" id="7153830">1</span><span class="op" id="7153831">]</span><span class="op" id="7153832">.</span><span class="ident" id="7153833">Data</span>&nbsp;<span class="op" id="7153838">=</span>&nbsp;<span class="ident" id="7153840">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153845">}</span><span class="op" id="7153846">(</span><span class="op" id="7153847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7153851">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153872">buf</span>&nbsp;<span class="op" id="7153876">:=</span>&nbsp;<span class="builtinfunc" id="7153879">new</span><span class="op" id="7153882">(</span><span class="ident" id="7153883">bytes</span><span class="op" id="7153888">.</span><span class="ident" id="7153889">Buffer</span><span class="op" id="7153895">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153898">w</span>&nbsp;<span class="op" id="7153900">:=</span>&nbsp;<span class="ident" id="7153903">NewWriter</span><span class="op" id="7153912">(</span><span class="ident" id="7153913">buf</span><span class="op" id="7153916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153920">for</span>&nbsp;<span class="ident" id="7153924">_</span><span class="op" id="7153925">,</span>&nbsp;<span class="ident" id="7153927">wt</span>&nbsp;<span class="op" id="7153930">:=</span>&nbsp;<span class="keyword" id="7153933">range</span>&nbsp;<span class="ident" id="7153939">writeTests</span>&nbsp;<span class="op" id="7153950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153954">testCreate</span><span class="op" id="7153964">(</span><span class="ident" id="7153965">t</span><span class="op" id="7153966">,</span>&nbsp;<span class="ident" id="7153968">w</span><span class="op" id="7153969">,</span>&nbsp;<span class="op" id="7153971">&amp;</span><span class="ident" id="7153972">wt</span><span class="op" id="7153974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153977">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153981">if</span>&nbsp;<span class="ident" id="7153984">err</span>&nbsp;<span class="op" id="7153988">:=</span>&nbsp;<span class="ident" id="7153991">w</span><span class="op" id="7153992">.</span><span class="ident" id="7153993">Close</span><span class="op" id="7153998">(</span><span class="op" id="7153999">)</span><span class="op" id="7154000">;</span>&nbsp;<span class="ident" id="7154002">err</span>&nbsp;<span class="op" id="7154006">!=</span>&nbsp;<span class="ident" id="7154009">nil</span>&nbsp;<span class="op" id="7154013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154017">t</span><span class="op" id="7154018">.</span><span class="ident" id="7154019">Fatal</span><span class="op" id="7154024">(</span><span class="ident" id="7154025">err</span><span class="op" id="7154028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7154035">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154052">r</span><span class="op" id="7154053">,</span>&nbsp;<span class="ident" id="7154055">err</span>&nbsp;<span class="op" id="7154059">:=</span>&nbsp;<span class="ident" id="7154062">NewReader</span><span class="op" id="7154071">(</span><span class="ident" id="7154072">bytes</span><span class="op" id="7154077">.</span><span class="ident" id="7154078">NewReader</span><span class="op" id="7154087">(</span><span class="ident" id="7154088">buf</span><span class="op" id="7154091">.</span><span class="ident" id="7154092">Bytes</span><span class="op" id="7154097">(</span><span class="op" id="7154098">)</span><span class="op" id="7154099">)</span><span class="op" id="7154100">,</span>&nbsp;<span class="ident" id="7154102">int64</span><span class="op" id="7154107">(</span><span class="ident" id="7154108">buf</span><span class="op" id="7154111">.</span><span class="ident" id="7154112">Len</span><span class="op" id="7154115">(</span><span class="op" id="7154116">)</span><span class="op" id="7154117">)</span><span class="op" id="7154118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154121">if</span>&nbsp;<span class="ident" id="7154124">err</span>&nbsp;<span class="op" id="7154128">!=</span>&nbsp;<span class="ident" id="7154131">nil</span>&nbsp;<span class="op" id="7154135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154139">t</span><span class="op" id="7154140">.</span><span class="ident" id="7154141">Fatal</span><span class="op" id="7154146">(</span><span class="ident" id="7154147">err</span><span class="op" id="7154150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154153">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154156">for</span>&nbsp;<span class="ident" id="7154160">i</span><span class="op" id="7154161">,</span>&nbsp;<span class="ident" id="7154163">wt</span>&nbsp;<span class="op" id="7154166">:=</span>&nbsp;<span class="keyword" id="7154169">range</span>&nbsp;<span class="ident" id="7154175">writeTests</span>&nbsp;<span class="op" id="7154186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154190">testReadFile</span><span class="op" id="7154202">(</span><span class="ident" id="7154203">t</span><span class="op" id="7154204">,</span>&nbsp;<span class="ident" id="7154206">r</span><span class="op" id="7154207">.</span><span class="ident" id="7154208">File</span><span class="op" id="7154212">[</span><span class="ident" id="7154213">i</span><span class="op" id="7154214">]</span><span class="op" id="7154215">,</span>&nbsp;<span class="op" id="7154217">&amp;</span><span class="ident" id="7154218">wt</span><span class="op" id="7154220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154223">}</span><br>
<span class="lineno"></span><span class="op" id="7154225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7154228">func</span>&nbsp;<span class="ident" id="7154233">TestWriterFlush</span><span class="op" id="7154248">(</span><span class="ident" id="7154249">t</span>&nbsp;<span class="op" id="7154251">*</span><span class="ident" id="7154252">testing</span><span class="op" id="7154259">.</span><span class="ident" id="7154260">T</span><span class="op" id="7154261">)</span>&nbsp;<span class="op" id="7154263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154266">var</span>&nbsp;<span class="ident" id="7154270">buf</span>&nbsp;<span class="ident" id="7154274">bytes</span><span class="op" id="7154279">.</span><span class="ident" id="7154280">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154288">w</span>&nbsp;<span class="op" id="7154290">:=</span>&nbsp;<span class="ident" id="7154293">NewWriter</span><span class="op" id="7154302">(</span><span class="keyword" id="7154303">struct</span><span class="op" id="7154309">{</span>&nbsp;<span class="ident" id="7154311">io</span><span class="op" id="7154313">.</span><span class="ident" id="7154314">Writer</span>&nbsp;<span class="op" id="7154321">}</span><span class="op" id="7154322">{</span><span class="op" id="7154323">&amp;</span><span class="ident" id="7154324">buf</span><span class="op" id="7154327">}</span><span class="op" id="7154328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154331">_</span><span class="op" id="7154332">,</span>&nbsp;<span class="ident" id="7154334">err</span>&nbsp;<span class="op" id="7154338">:=</span>&nbsp;<span class="ident" id="7154341">w</span><span class="op" id="7154342">.</span><span class="ident" id="7154343">Create</span><span class="op" id="7154349">(</span><span class="string" id="7154350">&#34;foo&#34;</span><span class="op" id="7154355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154358">if</span>&nbsp;<span class="ident" id="7154361">err</span>&nbsp;<span class="op" id="7154365">!=</span>&nbsp;<span class="ident" id="7154368">nil</span>&nbsp;<span class="op" id="7154372">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154376">t</span><span class="op" id="7154377">.</span><span class="ident" id="7154378">Fatal</span><span class="op" id="7154383">(</span><span class="ident" id="7154384">err</span><span class="op" id="7154387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154393">if</span>&nbsp;<span class="ident" id="7154396">buf</span><span class="op" id="7154399">.</span><span class="ident" id="7154400">Len</span><span class="op" id="7154403">(</span><span class="op" id="7154404">)</span>&nbsp;<span class="op" id="7154406">&gt;</span>&nbsp;<span class="num" id="7154408">0</span>&nbsp;<span class="op" id="7154410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154414">t</span><span class="op" id="7154415">.</span><span class="ident" id="7154416">Fatalf</span><span class="op" id="7154422">(</span><span class="string" id="7154423">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="7154462">,</span>&nbsp;<span class="ident" id="7154464">buf</span><span class="op" id="7154467">.</span><span class="ident" id="7154468">Len</span><span class="op" id="7154471">(</span><span class="op" id="7154472">)</span><span class="op" id="7154473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154476">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154479">if</span>&nbsp;<span class="ident" id="7154482">err</span>&nbsp;<span class="op" id="7154486">:=</span>&nbsp;<span class="ident" id="7154489">w</span><span class="op" id="7154490">.</span><span class="ident" id="7154491">Flush</span><span class="op" id="7154496">(</span><span class="op" id="7154497">)</span><span class="op" id="7154498">;</span>&nbsp;<span class="ident" id="7154500">err</span>&nbsp;<span class="op" id="7154504">!=</span>&nbsp;<span class="ident" id="7154507">nil</span>&nbsp;<span class="op" id="7154511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154515">t</span><span class="op" id="7154516">.</span><span class="ident" id="7154517">Fatal</span><span class="op" id="7154522">(</span><span class="ident" id="7154523">err</span><span class="op" id="7154526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154532">if</span>&nbsp;<span class="ident" id="7154535">buf</span><span class="op" id="7154538">.</span><span class="ident" id="7154539">Len</span><span class="op" id="7154542">(</span><span class="op" id="7154543">)</span>&nbsp;<span class="op" id="7154545">==</span>&nbsp;<span class="num" id="7154548">0</span>&nbsp;<span class="op" id="7154550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154554">t</span><span class="op" id="7154555">.</span><span class="ident" id="7154556">Fatal</span><span class="op" id="7154561">(</span><span class="string" id="7154562">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="7154592">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154595">}</span><br>
<span class="lineno"></span><span class="op" id="7154597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7154600">func</span>&nbsp;<span class="ident" id="7154605">testCreate</span><span class="op" id="7154615">(</span><span class="ident" id="7154616">t</span>&nbsp;<span class="op" id="7154618">*</span><span class="ident" id="7154619">testing</span><span class="op" id="7154626">.</span><span class="ident" id="7154627">T</span><span class="op" id="7154628">,</span>&nbsp;<span class="ident" id="7154630">w</span>&nbsp;<span class="op" id="7154632">*</span><span class="ident" id="7154633">Writer</span><span class="op" id="7154639">,</span>&nbsp;<span class="ident" id="7154641">wt</span>&nbsp;<span class="op" id="7154644">*</span><span class="ident" id="7154645">WriteTest</span><span class="op" id="7154654">)</span>&nbsp;<span class="op" id="7154656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154659">header</span>&nbsp;<span class="op" id="7154666">:=</span>&nbsp;<span class="op" id="7154669">&amp;</span><span class="ident" id="7154670">FileHeader</span><span class="op" id="7154680">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154684">Name</span><span class="op" id="7154688">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7154692">wt</span><span class="op" id="7154694">.</span><span class="ident" id="7154695">Name</span><span class="op" id="7154699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154703">Method</span><span class="op" id="7154709">:</span>&nbsp;<span class="ident" id="7154711">wt</span><span class="op" id="7154713">.</span><span class="ident" id="7154714">Method</span><span class="op" id="7154720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154726">if</span>&nbsp;<span class="ident" id="7154729">wt</span><span class="op" id="7154731">.</span><span class="ident" id="7154732">Mode</span>&nbsp;<span class="op" id="7154737">!=</span>&nbsp;<span class="num" id="7154740">0</span>&nbsp;<span class="op" id="7154742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154746">header</span><span class="op" id="7154752">.</span><span class="ident" id="7154753">SetMode</span><span class="op" id="7154760">(</span><span class="ident" id="7154761">wt</span><span class="op" id="7154763">.</span><span class="ident" id="7154764">Mode</span><span class="op" id="7154768">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154774">f</span><span class="op" id="7154775">,</span>&nbsp;<span class="ident" id="7154777">err</span>&nbsp;<span class="op" id="7154781">:=</span>&nbsp;<span class="ident" id="7154784">w</span><span class="op" id="7154785">.</span><span class="ident" id="7154786">CreateHeader</span><span class="op" id="7154798">(</span><span class="ident" id="7154799">header</span><span class="op" id="7154805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154808">if</span>&nbsp;<span class="ident" id="7154811">err</span>&nbsp;<span class="op" id="7154815">!=</span>&nbsp;<span class="ident" id="7154818">nil</span>&nbsp;<span class="op" id="7154822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154826">t</span><span class="op" id="7154827">.</span><span class="ident" id="7154828">Fatal</span><span class="op" id="7154833">(</span><span class="ident" id="7154834">err</span><span class="op" id="7154837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154840">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154843">_</span><span class="op" id="7154844">,</span>&nbsp;<span class="ident" id="7154846">err</span>&nbsp;<span class="op" id="7154850">=</span>&nbsp;<span class="ident" id="7154852">f</span><span class="op" id="7154853">.</span><span class="ident" id="7154854">Write</span><span class="op" id="7154859">(</span><span class="ident" id="7154860">wt</span><span class="op" id="7154862">.</span><span class="ident" id="7154863">Data</span><span class="op" id="7154867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154870">if</span>&nbsp;<span class="ident" id="7154873">err</span>&nbsp;<span class="op" id="7154877">!=</span>&nbsp;<span class="ident" id="7154880">nil</span>&nbsp;<span class="op" id="7154884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154888">t</span><span class="op" id="7154889">.</span><span class="ident" id="7154890">Fatal</span><span class="op" id="7154895">(</span><span class="ident" id="7154896">err</span><span class="op" id="7154899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154902">}</span><br>
<span class="lineno"></span><span class="op" id="7154904">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7154907">func</span>&nbsp;<span class="ident" id="7154912">testReadFile</span><span class="op" id="7154924">(</span><span class="ident" id="7154925">t</span>&nbsp;<span class="op" id="7154927">*</span><span class="ident" id="7154928">testing</span><span class="op" id="7154935">.</span><span class="ident" id="7154936">T</span><span class="op" id="7154937">,</span>&nbsp;<span class="ident" id="7154939">f</span>&nbsp;<span class="op" id="7154941">*</span><span class="ident" id="7154942">File</span><span class="op" id="7154946">,</span>&nbsp;<span class="ident" id="7154948">wt</span>&nbsp;<span class="op" id="7154951">*</span><span class="ident" id="7154952">WriteTest</span><span class="op" id="7154961">)</span>&nbsp;<span class="op" id="7154963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154966">if</span>&nbsp;<span class="ident" id="7154969">f</span><span class="op" id="7154970">.</span><span class="ident" id="7154971">Name</span>&nbsp;<span class="op" id="7154976">!=</span>&nbsp;<span class="ident" id="7154979">wt</span><span class="op" id="7154981">.</span><span class="ident" id="7154982">Name</span>&nbsp;<span class="op" id="7154987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154991">t</span><span class="op" id="7154992">.</span><span class="ident" id="7154993">Fatalf</span><span class="op" id="7154999">(</span><span class="string" id="7155000">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7155028">,</span>&nbsp;<span class="ident" id="7155030">f</span><span class="op" id="7155031">.</span><span class="ident" id="7155032">Name</span><span class="op" id="7155036">,</span>&nbsp;<span class="ident" id="7155038">wt</span><span class="op" id="7155040">.</span><span class="ident" id="7155041">Name</span><span class="op" id="7155045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155048">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155051">testFileMode</span><span class="op" id="7155063">(</span><span class="ident" id="7155064">t</span><span class="op" id="7155065">,</span>&nbsp;<span class="ident" id="7155067">wt</span><span class="op" id="7155069">.</span><span class="ident" id="7155070">Name</span><span class="op" id="7155074">,</span>&nbsp;<span class="ident" id="7155076">f</span><span class="op" id="7155077">,</span>&nbsp;<span class="ident" id="7155079">wt</span><span class="op" id="7155081">.</span><span class="ident" id="7155082">Mode</span><span class="op" id="7155086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155089">rc</span><span class="op" id="7155091">,</span>&nbsp;<span class="ident" id="7155093">err</span>&nbsp;<span class="op" id="7155097">:=</span>&nbsp;<span class="ident" id="7155100">f</span><span class="op" id="7155101">.</span><span class="ident" id="7155102">Open</span><span class="op" id="7155106">(</span><span class="op" id="7155107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155110">if</span>&nbsp;<span class="ident" id="7155113">err</span>&nbsp;<span class="op" id="7155117">!=</span>&nbsp;<span class="ident" id="7155120">nil</span>&nbsp;<span class="op" id="7155124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155128">t</span><span class="op" id="7155129">.</span><span class="ident" id="7155130">Fatal</span><span class="op" id="7155135">(</span><span class="string" id="7155136">&#34;opening:&#34;</span><span class="op" id="7155146">,</span>&nbsp;<span class="ident" id="7155148">err</span><span class="op" id="7155151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155154">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155157">b</span><span class="op" id="7155158">,</span>&nbsp;<span class="ident" id="7155160">err</span>&nbsp;<span class="op" id="7155164">:=</span>&nbsp;<span class="ident" id="7155167">ioutil</span><span class="op" id="7155173">.</span><span class="ident" id="7155174">ReadAll</span><span class="op" id="7155181">(</span><span class="ident" id="7155182">rc</span><span class="op" id="7155184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155187">if</span>&nbsp;<span class="ident" id="7155190">err</span>&nbsp;<span class="op" id="7155194">!=</span>&nbsp;<span class="ident" id="7155197">nil</span>&nbsp;<span class="op" id="7155201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155205">t</span><span class="op" id="7155206">.</span><span class="ident" id="7155207">Fatal</span><span class="op" id="7155212">(</span><span class="string" id="7155213">&#34;reading:&#34;</span><span class="op" id="7155223">,</span>&nbsp;<span class="ident" id="7155225">err</span><span class="op" id="7155228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155234">err</span>&nbsp;<span class="op" id="7155238">=</span>&nbsp;<span class="ident" id="7155240">rc</span><span class="op" id="7155242">.</span><span class="ident" id="7155243">Close</span><span class="op" id="7155248">(</span><span class="op" id="7155249">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155252">if</span>&nbsp;<span class="ident" id="7155255">err</span>&nbsp;<span class="op" id="7155259">!=</span>&nbsp;<span class="ident" id="7155262">nil</span>&nbsp;<span class="op" id="7155266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155270">t</span><span class="op" id="7155271">.</span><span class="ident" id="7155272">Fatal</span><span class="op" id="7155277">(</span><span class="string" id="7155278">&#34;closing:&#34;</span><span class="op" id="7155288">,</span>&nbsp;<span class="ident" id="7155290">err</span><span class="op" id="7155293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155299">if</span>&nbsp;<span class="op" id="7155302">!</span><span class="ident" id="7155303">bytes</span><span class="op" id="7155308">.</span><span class="ident" id="7155309">Equal</span><span class="op" id="7155314">(</span><span class="ident" id="7155315">b</span><span class="op" id="7155316">,</span>&nbsp;<span class="ident" id="7155318">wt</span><span class="op" id="7155320">.</span><span class="ident" id="7155321">Data</span><span class="op" id="7155325">)</span>&nbsp;<span class="op" id="7155327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155331">t</span><span class="op" id="7155332">.</span><span class="ident" id="7155333">Errorf</span><span class="op" id="7155339">(</span><span class="string" id="7155340">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7155367">,</span>&nbsp;<span class="ident" id="7155369">b</span><span class="op" id="7155370">,</span>&nbsp;<span class="ident" id="7155372">wt</span><span class="op" id="7155374">.</span><span class="ident" id="7155375">Data</span><span class="op" id="7155379">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155382">}</span><br>
<span class="lineno"></span><span class="op" id="7155384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7155387">func</span>&nbsp;<span class="ident" id="7155392">BenchmarkCompressedZipGarbage</span><span class="op" id="7155421">(</span><span class="ident" id="7155422">b</span>&nbsp;<span class="op" id="7155424">*</span><span class="ident" id="7155425">testing</span><span class="op" id="7155432">.</span><span class="ident" id="7155433">B</span><span class="op" id="7155434">)</span>&nbsp;<span class="op" id="7155436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155439">b</span><span class="op" id="7155440">.</span><span class="ident" id="7155441">ReportAllocs</span><span class="op" id="7155453">(</span><span class="op" id="7155454">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155457">var</span>&nbsp;<span class="ident" id="7155461">buf</span>&nbsp;<span class="ident" id="7155465">bytes</span><span class="op" id="7155470">.</span><span class="ident" id="7155471">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155479">bigBuf</span>&nbsp;<span class="op" id="7155486">:=</span>&nbsp;<span class="ident" id="7155489">bytes</span><span class="op" id="7155494">.</span><span class="ident" id="7155495">Repeat</span><span class="op" id="7155501">(</span><span class="op" id="7155502">[</span><span class="op" id="7155503">]</span><span class="builtintype" id="7155504">byte</span><span class="op" id="7155508">(</span><span class="string" id="7155509">&#34;a&#34;</span><span class="op" id="7155512">)</span><span class="op" id="7155513">,</span>&nbsp;<span class="num" id="7155515">1</span><span class="op" id="7155516">&lt;&lt;</span><span class="num" id="7155518">20</span><span class="op" id="7155520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155523">for</span>&nbsp;<span class="ident" id="7155527">i</span>&nbsp;<span class="op" id="7155529">:=</span>&nbsp;<span class="num" id="7155532">0</span><span class="op" id="7155533">;</span>&nbsp;<span class="ident" id="7155535">i</span>&nbsp;<span class="op" id="7155537">&lt;</span>&nbsp;<span class="ident" id="7155539">b</span><span class="op" id="7155540">.</span><span class="ident" id="7155541">N</span><span class="op" id="7155542">;</span>&nbsp;<span class="ident" id="7155544">i</span><span class="op" id="7155545">++</span>&nbsp;<span class="op" id="7155548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155552">buf</span><span class="op" id="7155555">.</span><span class="ident" id="7155556">Reset</span><span class="op" id="7155561">(</span><span class="op" id="7155562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155566">zw</span>&nbsp;<span class="op" id="7155569">:=</span>&nbsp;<span class="ident" id="7155572">NewWriter</span><span class="op" id="7155581">(</span><span class="op" id="7155582">&amp;</span><span class="ident" id="7155583">buf</span><span class="op" id="7155586">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155590">for</span>&nbsp;<span class="ident" id="7155594">j</span>&nbsp;<span class="op" id="7155596">:=</span>&nbsp;<span class="num" id="7155599">0</span><span class="op" id="7155600">;</span>&nbsp;<span class="ident" id="7155602">j</span>&nbsp;<span class="op" id="7155604">&lt;</span>&nbsp;<span class="num" id="7155606">3</span><span class="op" id="7155607">;</span>&nbsp;<span class="ident" id="7155609">j</span><span class="op" id="7155610">++</span>&nbsp;<span class="op" id="7155613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155618">w</span><span class="op" id="7155619">,</span>&nbsp;<span class="ident" id="7155621">_</span>&nbsp;<span class="op" id="7155623">:=</span>&nbsp;<span class="ident" id="7155626">zw</span><span class="op" id="7155628">.</span><span class="ident" id="7155629">CreateHeader</span><span class="op" id="7155641">(</span><span class="op" id="7155642">&amp;</span><span class="ident" id="7155643">FileHeader</span><span class="op" id="7155653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155659">Name</span><span class="op" id="7155663">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7155667">&#34;foo&#34;</span><span class="op" id="7155672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155678">Method</span><span class="op" id="7155684">:</span>&nbsp;<span class="ident" id="7155686">Deflate</span><span class="op" id="7155693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155698">}</span><span class="op" id="7155699">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155704">w</span><span class="op" id="7155705">.</span><span class="ident" id="7155706">Write</span><span class="op" id="7155711">(</span><span class="ident" id="7155712">bigBuf</span><span class="op" id="7155718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155726">zw</span><span class="op" id="7155728">.</span><span class="ident" id="7155729">Close</span><span class="op" id="7155734">(</span><span class="op" id="7155735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155738">}</span><br>
<span class="lineno"></span><span class="op" id="7155740">}</span>
</div>
</body>
</html>
