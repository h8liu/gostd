<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6519062">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6519118">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6519172">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6519223">package</span>&nbsp;<span class="ident" id="6519231">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519237">import</span>&nbsp;<span class="op" id="6519244">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6519247">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6519256">&#34;compress/flate&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6519274">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6519280">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6519290">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519293">func</span>&nbsp;<span class="ident" id="6519298">TestRead</span><span class="op" id="6519306">(</span><span class="ident" id="6519307">t</span>&nbsp;<span class="op" id="6519309">*</span><span class="ident" id="6519310">testing</span><span class="op" id="6519317">.</span><span class="ident" id="6519318">T</span><span class="op" id="6519319">)</span>&nbsp;<span class="op" id="6519321">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6519324">var</span>&nbsp;<span class="ident" id="6519328">n</span>&nbsp;<span class="builtintype" id="6519330">int</span>&nbsp;<span class="op" id="6519334">=</span>&nbsp;<span class="num" id="6519336">4e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6519341">if</span>&nbsp;<span class="ident" id="6519344">testing</span><span class="op" id="6519351">.</span><span class="ident" id="6519352">Short</span><span class="op" id="6519357">(</span><span class="op" id="6519358">)</span>&nbsp;<span class="op" id="6519360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519364">n</span>&nbsp;<span class="op" id="6519366">=</span>&nbsp;<span class="num" id="6519368">1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519376">b</span>&nbsp;<span class="op" id="6519378">:=</span>&nbsp;<span class="builtinfunc" id="6519381">make</span><span class="op" id="6519385">(</span><span class="op" id="6519386">[</span><span class="op" id="6519387">]</span><span class="builtintype" id="6519388">byte</span><span class="op" id="6519392">,</span>&nbsp;<span class="ident" id="6519394">n</span><span class="op" id="6519395">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519398">n</span><span class="op" id="6519399">,</span>&nbsp;<span class="ident" id="6519401">err</span>&nbsp;<span class="op" id="6519405">:=</span>&nbsp;<span class="ident" id="6519408">io</span><span class="op" id="6519410">.</span><span class="ident" id="6519411">ReadFull</span><span class="op" id="6519419">(</span><span class="ident" id="6519420">Reader</span><span class="op" id="6519426">,</span>&nbsp;<span class="ident" id="6519428">b</span><span class="op" id="6519429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6519432">if</span>&nbsp;<span class="ident" id="6519435">n</span>&nbsp;<span class="op" id="6519437">!=</span>&nbsp;<span class="builtinfunc" id="6519440">len</span><span class="op" id="6519443">(</span><span class="ident" id="6519444">b</span><span class="op" id="6519445">)</span>&nbsp;<span class="op" id="6519447">||</span>&nbsp;<span class="ident" id="6519450">err</span>&nbsp;<span class="op" id="6519454">!=</span>&nbsp;<span class="ident" id="6519457">nil</span>&nbsp;<span class="op" id="6519461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519465">t</span><span class="op" id="6519466">.</span><span class="ident" id="6519467">Fatalf</span><span class="op" id="6519473">(</span><span class="string" id="6519474">&#34;ReadFull(buf)&nbsp;=&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="6519498">,</span>&nbsp;<span class="ident" id="6519500">n</span><span class="op" id="6519501">,</span>&nbsp;<span class="ident" id="6519503">err</span><span class="op" id="6519506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6519513">var</span>&nbsp;<span class="ident" id="6519517">z</span>&nbsp;<span class="ident" id="6519519">bytes</span><span class="op" id="6519524">.</span><span class="ident" id="6519525">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519533">f</span><span class="op" id="6519534">,</span>&nbsp;<span class="ident" id="6519536">_</span>&nbsp;<span class="op" id="6519538">:=</span>&nbsp;<span class="ident" id="6519541">flate</span><span class="op" id="6519546">.</span><span class="ident" id="6519547">NewWriter</span><span class="op" id="6519556">(</span><span class="op" id="6519557">&amp;</span><span class="ident" id="6519558">z</span><span class="op" id="6519559">,</span>&nbsp;<span class="num" id="6519561">5</span><span class="op" id="6519562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519565">f</span><span class="op" id="6519566">.</span><span class="ident" id="6519567">Write</span><span class="op" id="6519572">(</span><span class="ident" id="6519573">b</span><span class="op" id="6519574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519577">f</span><span class="op" id="6519578">.</span><span class="ident" id="6519579">Close</span><span class="op" id="6519584">(</span><span class="op" id="6519585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6519588">if</span>&nbsp;<span class="ident" id="6519591">z</span><span class="op" id="6519592">.</span><span class="ident" id="6519593">Len</span><span class="op" id="6519596">(</span><span class="op" id="6519597">)</span>&nbsp;<span class="op" id="6519599">&lt;</span>&nbsp;<span class="builtinfunc" id="6519601">len</span><span class="op" id="6519604">(</span><span class="ident" id="6519605">b</span><span class="op" id="6519606">)</span><span class="op" id="6519607">*</span><span class="num" id="6519608">99</span><span class="op" id="6519610">/</span><span class="num" id="6519611">100</span>&nbsp;<span class="op" id="6519615">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519619">t</span><span class="op" id="6519620">.</span><span class="ident" id="6519621">Fatalf</span><span class="op" id="6519627">(</span><span class="string" id="6519628">&#34;Compressed&nbsp;%d&nbsp;-&gt;&nbsp;%d&#34;</span><span class="op" id="6519649">,</span>&nbsp;<span class="builtinfunc" id="6519651">len</span><span class="op" id="6519654">(</span><span class="ident" id="6519655">b</span><span class="op" id="6519656">)</span><span class="op" id="6519657">,</span>&nbsp;<span class="ident" id="6519659">z</span><span class="op" id="6519660">.</span><span class="ident" id="6519661">Len</span><span class="op" id="6519664">(</span><span class="op" id="6519665">)</span><span class="op" id="6519666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519669">}</span><br>
<span class="lineno"></span><span class="op" id="6519671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519674">func</span>&nbsp;<span class="ident" id="6519679">TestReadEmpty</span><span class="op" id="6519692">(</span><span class="ident" id="6519693">t</span>&nbsp;<span class="op" id="6519695">*</span><span class="ident" id="6519696">testing</span><span class="op" id="6519703">.</span><span class="ident" id="6519704">T</span><span class="op" id="6519705">)</span>&nbsp;<span class="op" id="6519707">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519710">n</span><span class="op" id="6519711">,</span>&nbsp;<span class="ident" id="6519713">err</span>&nbsp;<span class="op" id="6519717">:=</span>&nbsp;<span class="ident" id="6519720">Reader</span><span class="op" id="6519726">.</span><span class="ident" id="6519727">Read</span><span class="op" id="6519731">(</span><span class="builtinfunc" id="6519732">make</span><span class="op" id="6519736">(</span><span class="op" id="6519737">[</span><span class="op" id="6519738">]</span><span class="builtintype" id="6519739">byte</span><span class="op" id="6519743">,</span>&nbsp;<span class="num" id="6519745">0</span><span class="op" id="6519746">)</span><span class="op" id="6519747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6519750">if</span>&nbsp;<span class="ident" id="6519753">n</span>&nbsp;<span class="op" id="6519755">!=</span>&nbsp;<span class="num" id="6519758">0</span>&nbsp;<span class="op" id="6519760">||</span>&nbsp;<span class="ident" id="6519763">err</span>&nbsp;<span class="op" id="6519767">!=</span>&nbsp;<span class="ident" id="6519770">nil</span>&nbsp;<span class="op" id="6519774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519778">t</span><span class="op" id="6519779">.</span><span class="ident" id="6519780">Fatalf</span><span class="op" id="6519786">(</span><span class="string" id="6519787">&#34;Read(make([]byte,&nbsp;0))&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6519819">,</span>&nbsp;<span class="ident" id="6519821">n</span><span class="op" id="6519822">,</span>&nbsp;<span class="ident" id="6519824">err</span><span class="op" id="6519827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519833">n</span><span class="op" id="6519834">,</span>&nbsp;<span class="ident" id="6519836">err</span>&nbsp;<span class="op" id="6519840">=</span>&nbsp;<span class="ident" id="6519842">Reader</span><span class="op" id="6519848">.</span><span class="ident" id="6519849">Read</span><span class="op" id="6519853">(</span><span class="ident" id="6519854">nil</span><span class="op" id="6519857">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6519860">if</span>&nbsp;<span class="ident" id="6519863">n</span>&nbsp;<span class="op" id="6519865">!=</span>&nbsp;<span class="num" id="6519868">0</span>&nbsp;<span class="op" id="6519870">||</span>&nbsp;<span class="ident" id="6519873">err</span>&nbsp;<span class="op" id="6519877">!=</span>&nbsp;<span class="ident" id="6519880">nil</span>&nbsp;<span class="op" id="6519884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519888">t</span><span class="op" id="6519889">.</span><span class="ident" id="6519890">Fatalf</span><span class="op" id="6519896">(</span><span class="string" id="6519897">&#34;Read(nil)&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6519917">,</span>&nbsp;<span class="ident" id="6519919">n</span><span class="op" id="6519920">,</span>&nbsp;<span class="ident" id="6519922">err</span><span class="op" id="6519925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519928">}</span><br>
<span class="lineno"></span><span class="op" id="6519930">}</span>
</div>
</body>
</html>
