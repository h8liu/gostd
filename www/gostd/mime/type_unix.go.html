<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3485766">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3485821">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3485875">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3485926">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3485996">package</span>&nbsp;<span class="ident" id="3486004">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3486010">import</span>&nbsp;<span class="op" id="3486017">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486020">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486029">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486035">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3486045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3486048">var</span>&nbsp;<span class="ident" id="3486052">typeFiles</span>&nbsp;<span class="op" id="3486062">=</span>&nbsp;<span class="op" id="3486064">[</span><span class="op" id="3486065">]</span><span class="builtintype" id="3486066">string</span><span class="op" id="3486072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486075">&#34;/etc/mime.types&#34;</span><span class="op" id="3486092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486095">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="3486120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486123">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="3486147">,</span><br>
<span class="lineno"></span><span class="op" id="3486149">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3486152">func</span>&nbsp;<span class="ident" id="3486157">loadMimeFile</span><span class="op" id="3486169">(</span><span class="ident" id="3486170">filename</span>&nbsp;<span class="builtintype" id="3486179">string</span><span class="op" id="3486185">)</span>&nbsp;<span class="op" id="3486187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486190">f</span><span class="op" id="3486191">,</span>&nbsp;<span class="ident" id="3486193">err</span>&nbsp;<span class="op" id="3486197">:=</span>&nbsp;<span class="ident" id="3486200">os</span><span class="op" id="3486202">.</span><span class="ident" id="3486203">Open</span><span class="op" id="3486207">(</span><span class="ident" id="3486208">filename</span><span class="op" id="3486216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486219">if</span>&nbsp;<span class="ident" id="3486222">err</span>&nbsp;<span class="op" id="3486226">!=</span>&nbsp;<span class="ident" id="3486229">nil</span>&nbsp;<span class="op" id="3486233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486237">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486248">defer</span>&nbsp;<span class="ident" id="3486254">f</span><span class="op" id="3486255">.</span><span class="ident" id="3486256">Close</span><span class="op" id="3486261">(</span><span class="op" id="3486262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486266">scanner</span>&nbsp;<span class="op" id="3486274">:=</span>&nbsp;<span class="ident" id="3486277">bufio</span><span class="op" id="3486282">.</span><span class="ident" id="3486283">NewScanner</span><span class="op" id="3486293">(</span><span class="ident" id="3486294">f</span><span class="op" id="3486295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486298">for</span>&nbsp;<span class="ident" id="3486302">scanner</span><span class="op" id="3486309">.</span><span class="ident" id="3486310">Scan</span><span class="op" id="3486314">(</span><span class="op" id="3486315">)</span>&nbsp;<span class="op" id="3486317">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486321">fields</span>&nbsp;<span class="op" id="3486328">:=</span>&nbsp;<span class="ident" id="3486331">strings</span><span class="op" id="3486338">.</span><span class="ident" id="3486339">Fields</span><span class="op" id="3486345">(</span><span class="ident" id="3486346">scanner</span><span class="op" id="3486353">.</span><span class="ident" id="3486354">Text</span><span class="op" id="3486358">(</span><span class="op" id="3486359">)</span><span class="op" id="3486360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486364">if</span>&nbsp;<span class="builtinfunc" id="3486367">len</span><span class="op" id="3486370">(</span><span class="ident" id="3486371">fields</span><span class="op" id="3486377">)</span>&nbsp;<span class="op" id="3486379">&lt;=</span>&nbsp;<span class="num" id="3486382">1</span>&nbsp;<span class="op" id="3486384">||</span>&nbsp;<span class="ident" id="3486387">fields</span><span class="op" id="3486393">[</span><span class="num" id="3486394">0</span><span class="op" id="3486395">]</span><span class="op" id="3486396">[</span><span class="num" id="3486397">0</span><span class="op" id="3486398">]</span>&nbsp;<span class="op" id="3486400">==</span>&nbsp;<span class="string" id="3486403">&#39;#&#39;</span>&nbsp;<span class="op" id="3486407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486412">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486427">mimeType</span>&nbsp;<span class="op" id="3486436">:=</span>&nbsp;<span class="ident" id="3486439">fields</span><span class="op" id="3486445">[</span><span class="num" id="3486446">0</span><span class="op" id="3486447">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486451">for</span>&nbsp;<span class="ident" id="3486455">_</span><span class="op" id="3486456">,</span>&nbsp;<span class="ident" id="3486458">ext</span>&nbsp;<span class="op" id="3486462">:=</span>&nbsp;<span class="keyword" id="3486465">range</span>&nbsp;<span class="ident" id="3486471">fields</span><span class="op" id="3486477">[</span><span class="num" id="3486478">1</span><span class="op" id="3486479">:</span><span class="op" id="3486480">]</span>&nbsp;<span class="op" id="3486482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486487">if</span>&nbsp;<span class="ident" id="3486490">ext</span><span class="op" id="3486493">[</span><span class="num" id="3486494">0</span><span class="op" id="3486495">]</span>&nbsp;<span class="op" id="3486497">==</span>&nbsp;<span class="string" id="3486500">&#39;#&#39;</span>&nbsp;<span class="op" id="3486504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486510">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486524">setExtensionType</span><span class="op" id="3486540">(</span><span class="string" id="3486541">&#34;.&#34;</span><span class="op" id="3486544">+</span><span class="ident" id="3486545">ext</span><span class="op" id="3486548">,</span>&nbsp;<span class="ident" id="3486550">mimeType</span><span class="op" id="3486558">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486568">if</span>&nbsp;<span class="ident" id="3486571">err</span>&nbsp;<span class="op" id="3486575">:=</span>&nbsp;<span class="ident" id="3486578">scanner</span><span class="op" id="3486585">.</span><span class="ident" id="3486586">Err</span><span class="op" id="3486589">(</span><span class="op" id="3486590">)</span><span class="op" id="3486591">;</span>&nbsp;<span class="ident" id="3486593">err</span>&nbsp;<span class="op" id="3486597">!=</span>&nbsp;<span class="ident" id="3486600">nil</span>&nbsp;<span class="op" id="3486604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3486608">panic</span><span class="op" id="3486613">(</span><span class="ident" id="3486614">err</span><span class="op" id="3486617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486620">}</span><br>
<span class="lineno">45</span><span class="op" id="3486622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3486625">func</span>&nbsp;<span class="ident" id="3486630">initMime</span><span class="op" id="3486638">(</span><span class="op" id="3486639">)</span>&nbsp;<span class="op" id="3486641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486644">for</span>&nbsp;<span class="ident" id="3486648">_</span><span class="op" id="3486649">,</span>&nbsp;<span class="ident" id="3486651">filename</span>&nbsp;<span class="op" id="3486660">:=</span>&nbsp;<span class="keyword" id="3486663">range</span>&nbsp;<span class="ident" id="3486669">typeFiles</span>&nbsp;<span class="op" id="3486679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486683">loadMimeFile</span><span class="op" id="3486695">(</span><span class="ident" id="3486696">filename</span><span class="op" id="3486704">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486707">}</span><br>
<span class="lineno"></span><span class="op" id="3486709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3486712">func</span>&nbsp;<span class="ident" id="3486717">initMimeForTests</span><span class="op" id="3486733">(</span><span class="op" id="3486734">)</span>&nbsp;<span class="keyword" id="3486736">map</span><span class="op" id="3486739">[</span><span class="builtintype" id="3486740">string</span><span class="op" id="3486746">]</span><span class="builtintype" id="3486747">string</span>&nbsp;<span class="op" id="3486754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486757">typeFiles</span>&nbsp;<span class="op" id="3486767">=</span>&nbsp;<span class="op" id="3486769">[</span><span class="op" id="3486770">]</span><span class="builtintype" id="3486771">string</span><span class="op" id="3486777">{</span><span class="string" id="3486778">&#34;testdata/test.types&#34;</span><span class="op" id="3486799">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486802">return</span>&nbsp;<span class="keyword" id="3486809">map</span><span class="op" id="3486812">[</span><span class="builtintype" id="3486813">string</span><span class="op" id="3486819">]</span><span class="builtintype" id="3486820">string</span><span class="op" id="3486826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486830">&#34;.T1&#34;</span><span class="op" id="3486835">:</span>&nbsp;&nbsp;<span class="string" id="3486838">&#34;application/test&#34;</span><span class="op" id="3486856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486860">&#34;.t2&#34;</span><span class="op" id="3486865">:</span>&nbsp;&nbsp;<span class="string" id="3486868">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="3486894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3486898">&#34;.png&#34;</span><span class="op" id="3486904">:</span>&nbsp;<span class="string" id="3486906">&#34;image/png&#34;</span><span class="op" id="3486917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486920">}</span><br>
<span class="lineno">60</span><span class="op" id="3486922">}</span>
</div>
</body>
</html>
