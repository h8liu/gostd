<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6448643">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6448699">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6448753">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6448804">package</span>&nbsp;<span class="ident" id="6448812">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6448819">import</span>&nbsp;<span class="op" id="6448826">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6448829">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6448840">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6448848">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6448855">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6448858">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="6448923">type</span>&nbsp;<span class="ident" id="6448928">GCStats</span>&nbsp;<span class="keyword" id="6448936">struct</span>&nbsp;<span class="op" id="6448943">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448946">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6448961"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6448965">.</span><span class="ident" id="6448966">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6448977">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449005">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6449020">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6449036">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449070">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6449085"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6449089">.</span><span class="ident" id="6449090">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6449101">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449137">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6449152">[</span><span class="op" id="6449153">]</span><span class="ident" id="6449154"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6449158">.</span><span class="ident" id="6449159">Duration</span>&nbsp;<span class="comment" id="6449168">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449205">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6449220">[</span><span class="op" id="6449221">]</span><span class="ident" id="6449222"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6449226">.</span><span class="ident" id="6449227">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6449236">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449283">PauseQuantiles</span>&nbsp;<span class="op" id="6449298">[</span><span class="op" id="6449299">]</span><span class="ident" id="6449300"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6449304">.</span><span class="ident" id="6449305">Duration</span><br>
<span class="lineno"></span><span class="op" id="6449314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6449317">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="6449386">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="6449453">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="6449529">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="6449596">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="6449673">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6449736">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="6449807">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="6449850">func</span>&nbsp;<span class="ident" id="6449855">ReadGCStats</span><span class="op" id="6449866">(</span><span class="ident" id="6449867">stats</span>&nbsp;<span class="op" id="6449873">*</span><span class="ident" id="6449874"><a href="/runtime/debug/garbage.go.html#6448928">GCStats</a></span><span class="op" id="6449881">)</span>&nbsp;<span class="op" id="6449883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6449886">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6449948">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450011">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450075">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450131">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6450156">const</span>&nbsp;<span class="ident" id="6450162">maxPause</span>&nbsp;<span class="op" id="6450171">=</span>&nbsp;<span class="builtinfunc" id="6450173">len</span><span class="op" id="6450176">(</span><span class="op" id="6450177">(</span><span class="op" id="6450178">(</span><span class="op" id="6450179">*</span><span class="ident" id="6450180"><a href="/runtime/debug/garbage.go.html#6448829">runtime</a></span><span class="op" id="6450187">.</span><span class="ident" id="6450188">MemStats</span><span class="op" id="6450196">)</span><span class="op" id="6450197">(</span><span class="ident" id="6450198">nil</span><span class="op" id="6450201">)</span><span class="op" id="6450202">)</span><span class="op" id="6450203">.</span><span class="ident" id="6450204">PauseNs</span><span class="op" id="6450211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6450214">if</span>&nbsp;<span class="builtinfunc" id="6450217">cap</span><span class="op" id="6450220">(</span><span class="ident" id="6450221"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450226">.</span><span class="ident" id="6450227">Pause</span><span class="op" id="6450232">)</span>&nbsp;<span class="op" id="6450234">&lt;</span>&nbsp;<span class="num" id="6450236">2</span><span class="op" id="6450237">*</span><span class="ident" id="6450238"><a href="/runtime/debug/garbage.go.html#6450162">maxPause</a></span><span class="op" id="6450246">+</span><span class="num" id="6450247">3</span>&nbsp;<span class="op" id="6450249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450253"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450258">.</span><span class="ident" id="6450259">Pause</span>&nbsp;<span class="op" id="6450265">=</span>&nbsp;<span class="builtinfunc" id="6450267">make</span><span class="op" id="6450271">(</span><span class="op" id="6450272">[</span><span class="op" id="6450273">]</span><span class="ident" id="6450274"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6450278">.</span><span class="ident" id="6450279">Duration</span><span class="op" id="6450287">,</span>&nbsp;<span class="num" id="6450289">2</span><span class="op" id="6450290">*</span><span class="ident" id="6450291"><a href="/runtime/debug/garbage.go.html#6450162">maxPause</a></span><span class="op" id="6450299">+</span><span class="num" id="6450300">3</span><span class="op" id="6450301">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6450304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450308">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450374">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450442">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450505">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450564">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450632">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450652"><a href="/runtime/debug/stubs.go.html#6458223">readGCStats</a></span><span class="op" id="6450663">(</span><span class="op" id="6450664">&amp;</span><span class="ident" id="6450665"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450670">.</span><span class="ident" id="6450671">Pause</span><span class="op" id="6450676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450679">n</span>&nbsp;<span class="op" id="6450681">:=</span>&nbsp;<span class="builtinfunc" id="6450684">len</span><span class="op" id="6450687">(</span><span class="ident" id="6450688"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450693">.</span><span class="ident" id="6450694">Pause</span><span class="op" id="6450699">)</span>&nbsp;<span class="op" id="6450701">-</span>&nbsp;<span class="num" id="6450703">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450706"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450711">.</span><span class="ident" id="6450712">LastGC</span>&nbsp;<span class="op" id="6450719">=</span>&nbsp;<span class="ident" id="6450721"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6450725">.</span><span class="ident" id="6450726">Unix</span><span class="op" id="6450730">(</span><span class="num" id="6450731">0</span><span class="op" id="6450732">,</span>&nbsp;<span class="ident" id="6450734">int64</span><span class="op" id="6450739">(</span><span class="ident" id="6450740"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450745">.</span><span class="ident" id="6450746">Pause</span><span class="op" id="6450751">[</span><span class="ident" id="6450752"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6450753">]</span><span class="op" id="6450754">)</span><span class="op" id="6450755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450758"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450763">.</span><span class="ident" id="6450764">NumGC</span>&nbsp;<span class="op" id="6450770">=</span>&nbsp;<span class="ident" id="6450772">int64</span><span class="op" id="6450777">(</span><span class="ident" id="6450778"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450783">.</span><span class="ident" id="6450784">Pause</span><span class="op" id="6450789">[</span><span class="ident" id="6450790"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6450791">+</span><span class="num" id="6450792">1</span><span class="op" id="6450793">]</span><span class="op" id="6450794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450797"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450802">.</span><span class="ident" id="6450803">PauseTotal</span>&nbsp;<span class="op" id="6450814">=</span>&nbsp;<span class="ident" id="6450816"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450821">.</span><span class="ident" id="6450822">Pause</span><span class="op" id="6450827">[</span><span class="ident" id="6450828"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6450829">+</span><span class="num" id="6450830">2</span><span class="op" id="6450831">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450834"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span>&nbsp;<span class="op" id="6450836">/=</span>&nbsp;<span class="num" id="6450839">2</span>&nbsp;<span class="comment" id="6450841">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450879"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450884">.</span><span class="ident" id="6450885">Pause</span>&nbsp;<span class="op" id="6450891">=</span>&nbsp;<span class="ident" id="6450893"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450898">.</span><span class="ident" id="6450899">Pause</span><span class="op" id="6450904">[</span><span class="op" id="6450905">:</span><span class="ident" id="6450906"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6450907">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6450911">if</span>&nbsp;<span class="builtinfunc" id="6450914">cap</span><span class="op" id="6450917">(</span><span class="ident" id="6450918"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450923">.</span><span class="ident" id="6450924">PauseEnd</span><span class="op" id="6450932">)</span>&nbsp;<span class="op" id="6450934">&lt;</span>&nbsp;<span class="ident" id="6450936"><a href="/runtime/debug/garbage.go.html#6450162">maxPause</a></span>&nbsp;<span class="op" id="6450945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450949"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6450954">.</span><span class="ident" id="6450955">PauseEnd</span>&nbsp;<span class="op" id="6450964">=</span>&nbsp;<span class="builtinfunc" id="6450966">make</span><span class="op" id="6450970">(</span><span class="op" id="6450971">[</span><span class="op" id="6450972">]</span><span class="ident" id="6450973"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6450977">.</span><span class="ident" id="6450978">Time</span><span class="op" id="6450982">,</span>&nbsp;<span class="num" id="6450984">0</span><span class="op" id="6450985">,</span>&nbsp;<span class="ident" id="6450987"><a href="/runtime/debug/garbage.go.html#6450162">maxPause</a></span><span class="op" id="6450995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6450998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451001"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451006">.</span><span class="ident" id="6451007">PauseEnd</span>&nbsp;<span class="op" id="6451016">=</span>&nbsp;<span class="ident" id="6451018"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451023">.</span><span class="ident" id="6451024">PauseEnd</span><span class="op" id="6451032">[</span><span class="op" id="6451033">:</span><span class="num" id="6451034">0</span><span class="op" id="6451035">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6451038">for</span>&nbsp;<span class="ident" id="6451042">_</span><span class="op" id="6451043">,</span>&nbsp;<span class="ident" id="6451045">ns</span>&nbsp;<span class="op" id="6451048">:=</span>&nbsp;<span class="keyword" id="6451051">range</span>&nbsp;<span class="ident" id="6451057"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451062">.</span><span class="ident" id="6451063">Pause</span><span class="op" id="6451068">[</span><span class="ident" id="6451069"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span>&nbsp;<span class="op" id="6451071">:</span>&nbsp;<span class="ident" id="6451073"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6451074">+</span><span class="ident" id="6451075"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6451076">]</span>&nbsp;<span class="op" id="6451078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451082"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451087">.</span><span class="ident" id="6451088">PauseEnd</span>&nbsp;<span class="op" id="6451097">=</span>&nbsp;<span class="builtinfunc" id="6451099">append</span><span class="op" id="6451105">(</span><span class="ident" id="6451106"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451111">.</span><span class="ident" id="6451112">PauseEnd</span><span class="op" id="6451120">,</span>&nbsp;<span class="ident" id="6451122"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6451126">.</span><span class="ident" id="6451127">Unix</span><span class="op" id="6451131">(</span><span class="num" id="6451132">0</span><span class="op" id="6451133">,</span>&nbsp;<span class="ident" id="6451135">int64</span><span class="op" id="6451140">(</span><span class="ident" id="6451141"><a href="/runtime/debug/garbage.go.html#6451045">ns</a></span><span class="op" id="6451143">)</span><span class="op" id="6451144">)</span><span class="op" id="6451145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6451148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6451152">if</span>&nbsp;<span class="builtinfunc" id="6451155">len</span><span class="op" id="6451158">(</span><span class="ident" id="6451159"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451164">.</span><span class="ident" id="6451165">PauseQuantiles</span><span class="op" id="6451179">)</span>&nbsp;<span class="op" id="6451181">&gt;</span>&nbsp;<span class="num" id="6451183">0</span>&nbsp;<span class="op" id="6451185">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6451189">if</span>&nbsp;<span class="ident" id="6451192"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span>&nbsp;<span class="op" id="6451194">==</span>&nbsp;<span class="num" id="6451197">0</span>&nbsp;<span class="op" id="6451199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6451204">for</span>&nbsp;<span class="ident" id="6451208">i</span>&nbsp;<span class="op" id="6451210">:=</span>&nbsp;<span class="keyword" id="6451213">range</span>&nbsp;<span class="ident" id="6451219"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451224">.</span><span class="ident" id="6451225">PauseQuantiles</span>&nbsp;<span class="op" id="6451240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451246"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451251">.</span><span class="ident" id="6451252">PauseQuantiles</span><span class="op" id="6451266">[</span><span class="ident" id="6451267"><a href="/runtime/debug/garbage.go.html#6451208">i</a></span><span class="op" id="6451268">]</span>&nbsp;<span class="op" id="6451270">=</span>&nbsp;<span class="num" id="6451272">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6451277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6451281">}</span>&nbsp;<span class="keyword" id="6451283">else</span>&nbsp;<span class="op" id="6451288">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451293">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451358">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451411">sorted</span>&nbsp;<span class="op" id="6451418">:=</span>&nbsp;<span class="ident" id="6451421"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451426">.</span><span class="ident" id="6451427">Pause</span><span class="op" id="6451432">[</span><span class="ident" id="6451433"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span>&nbsp;<span class="op" id="6451435">:</span>&nbsp;<span class="ident" id="6451437"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6451438">+</span><span class="ident" id="6451439"><a href="/runtime/debug/garbage.go.html#6450679">n</a></span><span class="op" id="6451440">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6451445">copy</span><span class="op" id="6451449">(</span><span class="ident" id="6451450"><a href="/runtime/debug/garbage.go.html#6451411">sorted</a></span><span class="op" id="6451456">,</span>&nbsp;<span class="ident" id="6451458"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451463">.</span><span class="ident" id="6451464">Pause</span><span class="op" id="6451469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451474"><a href="/runtime/debug/garbage.go.html#6448840">sort</a></span><span class="op" id="6451478">.</span><span class="ident" id="6451479">Sort</span><span class="op" id="6451483">(</span><span class="ident" id="6451484"><a href="/runtime/debug/garbage.go.html#6451699">byDuration</a></span><span class="op" id="6451494">(</span><span class="ident" id="6451495"><a href="/runtime/debug/garbage.go.html#6451411">sorted</a></span><span class="op" id="6451501">)</span><span class="op" id="6451502">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451507">nq</span>&nbsp;<span class="op" id="6451510">:=</span>&nbsp;<span class="builtinfunc" id="6451513">len</span><span class="op" id="6451516">(</span><span class="ident" id="6451517"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451522">.</span><span class="ident" id="6451523">PauseQuantiles</span><span class="op" id="6451537">)</span>&nbsp;<span class="op" id="6451539">-</span>&nbsp;<span class="num" id="6451541">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6451546">for</span>&nbsp;<span class="ident" id="6451550">i</span>&nbsp;<span class="op" id="6451552">:=</span>&nbsp;<span class="num" id="6451555">0</span><span class="op" id="6451556">;</span>&nbsp;<span class="ident" id="6451558"><a href="/runtime/debug/garbage.go.html#6451550">i</a></span>&nbsp;<span class="op" id="6451560">&lt;</span>&nbsp;<span class="ident" id="6451562"><a href="/runtime/debug/garbage.go.html#6451507">nq</a></span><span class="op" id="6451564">;</span>&nbsp;<span class="ident" id="6451566"><a href="/runtime/debug/garbage.go.html#6451550">i</a></span><span class="op" id="6451567">++</span>&nbsp;<span class="op" id="6451570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451576"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451581">.</span><span class="ident" id="6451582">PauseQuantiles</span><span class="op" id="6451596">[</span><span class="ident" id="6451597"><a href="/runtime/debug/garbage.go.html#6451550">i</a></span><span class="op" id="6451598">]</span>&nbsp;<span class="op" id="6451600">=</span>&nbsp;<span class="ident" id="6451602"><a href="/runtime/debug/garbage.go.html#6451411">sorted</a></span><span class="op" id="6451608">[</span><span class="builtinfunc" id="6451609">len</span><span class="op" id="6451612">(</span><span class="ident" id="6451613"><a href="/runtime/debug/garbage.go.html#6451411">sorted</a></span><span class="op" id="6451619">)</span><span class="op" id="6451620">*</span><span class="ident" id="6451621"><a href="/runtime/debug/garbage.go.html#6451550">i</a></span><span class="op" id="6451622">/</span><span class="ident" id="6451623"><a href="/runtime/debug/garbage.go.html#6451507">nq</a></span><span class="op" id="6451625">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6451630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451635"><a href="/runtime/debug/garbage.go.html#6449867">stats</a></span><span class="op" id="6451640">.</span><span class="ident" id="6451641">PauseQuantiles</span><span class="op" id="6451655">[</span><span class="ident" id="6451656"><a href="/runtime/debug/garbage.go.html#6451507">nq</a></span><span class="op" id="6451658">]</span>&nbsp;<span class="op" id="6451660">=</span>&nbsp;<span class="ident" id="6451662"><a href="/runtime/debug/garbage.go.html#6451411">sorted</a></span><span class="op" id="6451668">[</span><span class="builtinfunc" id="6451669">len</span><span class="op" id="6451672">(</span><span class="ident" id="6451673"><a href="/runtime/debug/garbage.go.html#6451411">sorted</a></span><span class="op" id="6451679">)</span><span class="op" id="6451680">-</span><span class="num" id="6451681">1</span><span class="op" id="6451682">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6451686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6451689">}</span><br>
<span class="lineno"></span><span class="op" id="6451691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6451694">type</span>&nbsp;<span class="ident" id="6451699">byDuration</span>&nbsp;<span class="op" id="6451710">[</span><span class="op" id="6451711">]</span><span class="ident" id="6451712"><a href="/runtime/debug/garbage.go.html#6448848">time</a></span><span class="op" id="6451716">.</span><span class="ident" id="6451717">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="6451727">func</span>&nbsp;<span class="op" id="6451732">(</span><span class="ident" id="6451733">x</span>&nbsp;<span class="ident" id="6451735"><a href="/runtime/debug/garbage.go.html#6451699">byDuration</a></span><span class="op" id="6451745">)</span>&nbsp;<span class="ident" id="6451747">Len</span><span class="op" id="6451750">(</span><span class="op" id="6451751">)</span>&nbsp;<span class="builtintype" id="6451753">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6451767">{</span>&nbsp;<span class="keyword" id="6451769">return</span>&nbsp;<span class="builtinfunc" id="6451776">len</span><span class="op" id="6451779">(</span><span class="ident" id="6451780"><a href="/runtime/debug/garbage.go.html#6451733">x</a></span><span class="op" id="6451781">)</span>&nbsp;<span class="op" id="6451783">}</span><br>
<span class="lineno"></span><span class="keyword" id="6451785">func</span>&nbsp;<span class="op" id="6451790">(</span><span class="ident" id="6451791">x</span>&nbsp;<span class="ident" id="6451793"><a href="/runtime/debug/garbage.go.html#6451699">byDuration</a></span><span class="op" id="6451803">)</span>&nbsp;<span class="ident" id="6451805">Swap</span><span class="op" id="6451809">(</span><span class="ident" id="6451810">i</span><span class="op" id="6451811">,</span>&nbsp;<span class="ident" id="6451813">j</span>&nbsp;<span class="builtintype" id="6451815">int</span><span class="op" id="6451818">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6451825">{</span>&nbsp;<span class="ident" id="6451827"><a href="/runtime/debug/garbage.go.html#6451791">x</a></span><span class="op" id="6451828">[</span><span class="ident" id="6451829"><a href="/runtime/debug/garbage.go.html#6451810">i</a></span><span class="op" id="6451830">]</span><span class="op" id="6451831">,</span>&nbsp;<span class="ident" id="6451833"><a href="/runtime/debug/garbage.go.html#6451791">x</a></span><span class="op" id="6451834">[</span><span class="ident" id="6451835"><a href="/runtime/debug/garbage.go.html#6451813">j</a></span><span class="op" id="6451836">]</span>&nbsp;<span class="op" id="6451838">=</span>&nbsp;<span class="ident" id="6451840"><a href="/runtime/debug/garbage.go.html#6451791">x</a></span><span class="op" id="6451841">[</span><span class="ident" id="6451842"><a href="/runtime/debug/garbage.go.html#6451813">j</a></span><span class="op" id="6451843">]</span><span class="op" id="6451844">,</span>&nbsp;<span class="ident" id="6451846"><a href="/runtime/debug/garbage.go.html#6451791">x</a></span><span class="op" id="6451847">[</span><span class="ident" id="6451848"><a href="/runtime/debug/garbage.go.html#6451810">i</a></span><span class="op" id="6451849">]</span>&nbsp;<span class="op" id="6451851">}</span><br>
<span class="lineno"></span><span class="keyword" id="6451853">func</span>&nbsp;<span class="op" id="6451858">(</span><span class="ident" id="6451859">x</span>&nbsp;<span class="ident" id="6451861"><a href="/runtime/debug/garbage.go.html#6451699">byDuration</a></span><span class="op" id="6451871">)</span>&nbsp;<span class="ident" id="6451873">Less</span><span class="op" id="6451877">(</span><span class="ident" id="6451878">i</span><span class="op" id="6451879">,</span>&nbsp;<span class="ident" id="6451881">j</span>&nbsp;<span class="builtintype" id="6451883">int</span><span class="op" id="6451886">)</span>&nbsp;<span class="builtintype" id="6451888">bool</span>&nbsp;<span class="op" id="6451893">{</span>&nbsp;<span class="keyword" id="6451895">return</span>&nbsp;<span class="ident" id="6451902"><a href="/runtime/debug/garbage.go.html#6451859">x</a></span><span class="op" id="6451903">[</span><span class="ident" id="6451904"><a href="/runtime/debug/garbage.go.html#6451878">i</a></span><span class="op" id="6451905">]</span>&nbsp;<span class="op" id="6451907">&lt;</span>&nbsp;<span class="ident" id="6451909"><a href="/runtime/debug/garbage.go.html#6451859">x</a></span><span class="op" id="6451910">[</span><span class="ident" id="6451911"><a href="/runtime/debug/garbage.go.html#6451881">j</a></span><span class="op" id="6451912">]</span>&nbsp;<span class="op" id="6451914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="6451917">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="6451980">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6452050">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="6452131">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6452177">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="6452246">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6452296">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="6452350">func</span>&nbsp;<span class="ident" id="6452355">SetGCPercent</span><span class="op" id="6452367">(</span><span class="ident" id="6452368">percent</span>&nbsp;<span class="builtintype" id="6452376">int</span><span class="op" id="6452379">)</span>&nbsp;<span class="builtintype" id="6452381">int</span>&nbsp;<span class="op" id="6452385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6452388">old</span>&nbsp;<span class="op" id="6452392">:=</span>&nbsp;<span class="ident" id="6452395"><a href="/runtime/debug/stubs.go.html#6458096">setGCPercent</a></span><span class="op" id="6452407">(</span><span class="builtintype" id="6452408">int32</span><span class="op" id="6452413">(</span><span class="ident" id="6452414"><a href="/runtime/debug/garbage.go.html#6452368">percent</a></span><span class="op" id="6452421">)</span><span class="op" id="6452422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6452425"><a href="/runtime/debug/garbage.go.html#6448829">runtime</a></span><span class="op" id="6452432">.</span><span class="ident" id="6452433">GC</span><span class="op" id="6452435">(</span><span class="op" id="6452436">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6452439">return</span>&nbsp;<span class="builtintype" id="6452446">int</span><span class="op" id="6452449">(</span><span class="ident" id="6452450"><a href="/runtime/debug/garbage.go.html#6452388">old</a></span><span class="op" id="6452453">)</span><br>
<span class="lineno"></span><span class="op" id="6452455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6452458">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="6452517">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="6452577">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="6452644">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="6452709">func</span>&nbsp;<span class="ident" id="6452714">FreeOSMemory</span><span class="op" id="6452726">(</span><span class="op" id="6452727">)</span>&nbsp;<span class="op" id="6452729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6452732"><a href="/runtime/debug/stubs.go.html#6458283">freeOSMemory</a></span><span class="op" id="6452744">(</span><span class="op" id="6452745">)</span><br>
<span class="lineno"></span><span class="op" id="6452747">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6452750">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="6452804">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="6452848">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="6452912">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="6452936">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6452981">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="6453057">//</span><br>
<span class="lineno"></span><span class="comment" id="6453060">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6453124">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="6453194">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="6453211">func</span>&nbsp;<span class="ident" id="6453216">SetMaxStack</span><span class="op" id="6453227">(</span><span class="ident" id="6453228">bytes</span>&nbsp;<span class="builtintype" id="6453234">int</span><span class="op" id="6453237">)</span>&nbsp;<span class="builtintype" id="6453239">int</span>&nbsp;<span class="op" id="6453243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6453246">return</span>&nbsp;<span class="ident" id="6453253"><a href="/runtime/debug/stubs.go.html#6458070">setMaxStack</a></span><span class="op" id="6453264">(</span><span class="ident" id="6453265"><a href="/runtime/debug/garbage.go.html#6453228">bytes</a></span><span class="op" id="6453270">)</span><br>
<span class="lineno"></span><span class="op" id="6453272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6453275">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="6453336">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="6453408">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="6453443">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6453490">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="6453532">//</span><br>
<span class="lineno"></span><span class="comment" id="6453535">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="6453612">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="6453686">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="6453774">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="6453847">//</span><br>
<span class="lineno"></span><span class="comment" id="6453850">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6453916">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6453984">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="6454055">func</span>&nbsp;<span class="ident" id="6454060">SetMaxThreads</span><span class="op" id="6454073">(</span><span class="ident" id="6454074">threads</span>&nbsp;<span class="builtintype" id="6454082">int</span><span class="op" id="6454085">)</span>&nbsp;<span class="builtintype" id="6454087">int</span>&nbsp;<span class="op" id="6454091">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6454094">return</span>&nbsp;<span class="ident" id="6454101"><a href="/runtime/debug/stubs.go.html#6458159">setMaxThreads</a></span><span class="op" id="6454114">(</span><span class="ident" id="6454115"><a href="/runtime/debug/garbage.go.html#6454074">threads</a></span><span class="op" id="6454122">)</span><br>
<span class="lineno"></span><span class="op" id="6454124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6454127">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="6454200">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="6454275">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="6454354">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="6454422">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="6454494">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="6454566">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="6454621">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="6454679">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="6454715">func</span>&nbsp;<span class="ident" id="6454720">SetPanicOnFault</span><span class="op" id="6454735">(</span><span class="ident" id="6454736">enabled</span>&nbsp;<span class="builtintype" id="6454744">bool</span><span class="op" id="6454748">)</span>&nbsp;<span class="builtintype" id="6454750">bool</span>&nbsp;<span class="op" id="6454755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6454758">return</span>&nbsp;<span class="ident" id="6454765"><a href="/runtime/debug/stubs.go.html#6458127">setPanicOnFault</a></span><span class="op" id="6454780">(</span><span class="ident" id="6454781"><a href="/runtime/debug/garbage.go.html#6454736">enabled</a></span><span class="op" id="6454788">)</span><br>
<span class="lineno"></span><span class="op" id="6454790">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="6454793">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6454862">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="6454898">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="6454970">func</span>&nbsp;<span class="ident" id="6454975">WriteHeapDump</span><span class="op" id="6454988">(</span><span class="ident" id="6454989">fd</span>&nbsp;<span class="builtintype" id="6454992">uintptr</span><span class="op" id="6454999">)</span>
</div>
</body>
</html>
