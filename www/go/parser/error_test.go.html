<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8620936">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8620991">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8621045">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8621096">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;a&nbsp;parser&nbsp;test&nbsp;harness.&nbsp;The&nbsp;files&nbsp;in&nbsp;the&nbsp;testdata</span><br>
<span class="lineno"></span><span class="comment" id="8621169">//&nbsp;directory&nbsp;are&nbsp;parsed&nbsp;and&nbsp;the&nbsp;errors&nbsp;reported&nbsp;are&nbsp;compared&nbsp;against&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="8621242">//&nbsp;error&nbsp;messages&nbsp;expected&nbsp;in&nbsp;the&nbsp;test&nbsp;files.&nbsp;The&nbsp;test&nbsp;files&nbsp;must&nbsp;end&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="8621315">//&nbsp;.src&nbsp;rather&nbsp;than&nbsp;.go&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;disturbed&nbsp;by&nbsp;gofmt&nbsp;runs.</span><br>
<span class="lineno"></span><span class="comment" id="8621385">//</span><br>
<span class="lineno">10</span><span class="comment" id="8621388">//&nbsp;Expected&nbsp;errors&nbsp;are&nbsp;indicated&nbsp;in&nbsp;the&nbsp;test&nbsp;files&nbsp;by&nbsp;putting&nbsp;a&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="8621460">//&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;immediately&nbsp;following&nbsp;an&nbsp;offending&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="8621534">//&nbsp;The&nbsp;harness&nbsp;will&nbsp;verify&nbsp;that&nbsp;an&nbsp;error&nbsp;matching&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="8621607">//&nbsp;rx&nbsp;is&nbsp;reported&nbsp;at&nbsp;that&nbsp;source&nbsp;position.</span><br>
<span class="lineno"></span><span class="comment" id="8621650">//</span><br>
<span class="lineno">15</span><span class="comment" id="8621653">//&nbsp;For&nbsp;instance,&nbsp;the&nbsp;following&nbsp;test&nbsp;file&nbsp;indicates&nbsp;that&nbsp;a&nbsp;&#34;not&nbsp;declared&#34;</span><br>
<span class="lineno"></span><span class="comment" id="8621726">//&nbsp;error&nbsp;should&nbsp;be&nbsp;reported&nbsp;for&nbsp;the&nbsp;undeclared&nbsp;variable&nbsp;x:</span><br>
<span class="lineno"></span><span class="comment" id="8621785">//</span><br>
<span class="lineno"></span><span class="comment" id="8621788">//&nbsp;&nbsp;&nbsp;&nbsppackage&nbsp;p</span><br>
<span class="lineno"></span><span class="comment" id="8621801">//&nbsp;&nbsp;&nbsp;&nbspfunc&nbsp;f()&nbsp;{</span><br>
<span class="lineno">20</span><span class="comment" id="8621815">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp_&nbsp;=&nbsp;x&nbsp;/*&nbsp;ERROR&nbsp;&#34;not&nbsp;declared&#34;&nbsp;*/&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="8621856">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8621862">package</span>&nbsp;<span class="ident" id="8621870">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8621878">import</span>&nbsp;<span class="op" id="8621885">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8621888">&#34;go/scanner&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8621902">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8621914">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8621927">&#34;path/filepath&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8621944">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8621954">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8621965">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8621975">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8621978">const</span>&nbsp;<span class="ident" id="8621984">testdata</span>&nbsp;<span class="op" id="8621993">=</span>&nbsp;<span class="string" id="8621995">&#34;testdata&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8622007">var</span>&nbsp;<span class="ident" id="8622011">fsetErrs</span>&nbsp;<span class="op" id="8622020">=</span>&nbsp;<span class="ident" id="8622022"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8622027">.</span><span class="ident" id="8622028">NewFileSet</span><span class="op" id="8622038">(</span><span class="op" id="8622039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8622042">//&nbsp;getFile&nbsp;assumes&nbsp;that&nbsp;each&nbsp;filename&nbsp;occurs&nbsp;at&nbsp;most&nbsp;once</span><br>
<span class="lineno">40</span><span class="keyword" id="8622100">func</span>&nbsp;<span class="ident" id="8622105">getFile</span><span class="op" id="8622112">(</span><span class="ident" id="8622113">filename</span>&nbsp;<span class="builtintype" id="8622122">string</span><span class="op" id="8622128">)</span>&nbsp;<span class="op" id="8622130">(</span><span class="ident" id="8622131">file</span>&nbsp;<span class="op" id="8622136">*</span><span class="ident" id="8622137"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8622142">.</span><span class="ident" id="8622143">File</span><span class="op" id="8622147">)</span>&nbsp;<span class="op" id="8622149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8622152"><a href="/go/parser/error_test.go.html#8622011">fsetErrs</a></span><span class="op" id="8622160">.</span><span class="ident" id="8622161">Iterate</span><span class="op" id="8622168">(</span><span class="keyword" id="8622169">func</span><span class="op" id="8622173">(</span><span class="ident" id="8622174">f</span>&nbsp;<span class="op" id="8622176">*</span><span class="ident" id="8622177"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8622182">.</span><span class="ident" id="8622183">File</span><span class="op" id="8622187">)</span>&nbsp;<span class="builtintype" id="8622189">bool</span>&nbsp;<span class="op" id="8622194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8622198">if</span>&nbsp;<span class="ident" id="8622201"><a href="/go/parser/error_test.go.html#8622174">f</a></span><span class="op" id="8622202">.</span><span class="ident" id="8622203">Name</span><span class="op" id="8622207">(</span><span class="op" id="8622208">)</span>&nbsp;<span class="op" id="8622210">==</span>&nbsp;<span class="ident" id="8622213"><a href="/go/parser/error_test.go.html#8622113">filename</a></span>&nbsp;<span class="op" id="8622222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8622227">if</span>&nbsp;<span class="ident" id="8622230"><a href="/go/parser/error_test.go.html#8622131">file</a></span>&nbsp;<span class="op" id="8622235">!=</span>&nbsp;<span class="ident" id="8622238">nil</span>&nbsp;<span class="op" id="8622242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8622248">panic</span><span class="op" id="8622253">(</span><span class="ident" id="8622254"><a href="/go/parser/error_test.go.html#8622113">filename</a></span>&nbsp;<span class="op" id="8622263">+</span>&nbsp;<span class="string" id="8622265">&#34;&nbsp;used&nbsp;multiple&nbsp;times&#34;</span><span class="op" id="8622287">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8622292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8622297"><a href="/go/parser/error_test.go.html#8622131">file</a></span>&nbsp;<span class="op" id="8622302">=</span>&nbsp;<span class="ident" id="8622304"><a href="/go/parser/error_test.go.html#8622174">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8622308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8622312">return</span>&nbsp;<span class="builtintype" id="8622319">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8622325">}</span><span class="op" id="8622326">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8622329">return</span>&nbsp;<span class="ident" id="8622336"><a href="/go/parser/error_test.go.html#8622131">file</a></span><br>
<span class="lineno"></span><span class="op" id="8622341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8622344">func</span>&nbsp;<span class="ident" id="8622349">getPos</span><span class="op" id="8622355">(</span><span class="ident" id="8622356">filename</span>&nbsp;<span class="builtintype" id="8622365">string</span><span class="op" id="8622371">,</span>&nbsp;<span class="ident" id="8622373">offset</span>&nbsp;<span class="builtintype" id="8622380">int</span><span class="op" id="8622383">)</span>&nbsp;<span class="ident" id="8622385"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8622390">.</span><span class="ident" id="8622391">Pos</span>&nbsp;<span class="op" id="8622395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8622398">if</span>&nbsp;<span class="ident" id="8622401">f</span>&nbsp;<span class="op" id="8622403">:=</span>&nbsp;<span class="ident" id="8622406"><a href="/go/parser/error_test.go.html#8622105">getFile</a></span><span class="op" id="8622413">(</span><span class="ident" id="8622414"><a href="/go/parser/error_test.go.html#8622356">filename</a></span><span class="op" id="8622422">)</span><span class="op" id="8622423">;</span>&nbsp;<span class="ident" id="8622425"><a href="/go/parser/error_test.go.html#8622401">f</a></span>&nbsp;<span class="op" id="8622427">!=</span>&nbsp;<span class="ident" id="8622430">nil</span>&nbsp;<span class="op" id="8622434">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8622438">return</span>&nbsp;<span class="ident" id="8622445"><a href="/go/parser/error_test.go.html#8622401">f</a></span><span class="op" id="8622446">.</span><span class="ident" id="8622447">Pos</span><span class="op" id="8622450">(</span><span class="ident" id="8622451"><a href="/go/parser/error_test.go.html#8622373">offset</a></span><span class="op" id="8622457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8622460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8622463">return</span>&nbsp;<span class="ident" id="8622470"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8622475">.</span><span class="ident" id="8622476">NoPos</span><br>
<span class="lineno"></span><span class="op" id="8622482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="8622485">//&nbsp;ERROR&nbsp;comments&nbsp;must&nbsp;be&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;and&nbsp;rx&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="8622550">//&nbsp;a&nbsp;regular&nbsp;expression&nbsp;that&nbsp;matches&nbsp;the&nbsp;expected&nbsp;error&nbsp;message.</span><br>
<span class="lineno"></span><span class="comment" id="8622615">//&nbsp;The&nbsp;special&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;HERE&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;must&nbsp;be&nbsp;used&nbsp;for&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="8622680">//&nbsp;messages&nbsp;that&nbsp;appear&nbsp;immediately&nbsp;after&nbsp;a&nbsp;token,&nbsp;rather&nbsp;than&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="8622746">//&nbsp;a&nbsp;token&#39;s&nbsp;position.</span><br>
<span class="lineno">65</span><span class="comment" id="8622769">//</span><br>
<span class="lineno"></span><span class="keyword" id="8622772">var</span>&nbsp;<span class="ident" id="8622776">errRx</span>&nbsp;<span class="op" id="8622782">=</span>&nbsp;<span class="ident" id="8622784"><a href="/go/parser/error_test.go.html#8621944">regexp</a></span><span class="op" id="8622790">.</span><span class="ident" id="8622791">MustCompile</span><span class="op" id="8622802">(</span><span class="string" id="8622803">`^/\*&nbsp;*ERROR&nbsp;*(HERE)?&nbsp;*&#34;([^&#34;]*)&#34;&nbsp;*\*/$`</span><span class="op" id="8622842">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8622845">//&nbsp;expectedErrors&nbsp;collects&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;of&nbsp;ERROR&nbsp;comments&nbsp;found</span><br>
<span class="lineno"></span><span class="comment" id="8622920">//&nbsp;in&nbsp;files&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a&nbsp;map&nbsp;of&nbsp;error&nbsp;positions&nbsp;to&nbsp;error&nbsp;messages.</span><br>
<span class="lineno">70</span><span class="comment" id="8622996">//</span><br>
<span class="lineno"></span><span class="keyword" id="8622999">func</span>&nbsp;<span class="ident" id="8623004">expectedErrors</span><span class="op" id="8623018">(</span><span class="ident" id="8623019">t</span>&nbsp;<span class="op" id="8623021">*</span><span class="ident" id="8623022"><a href="/go/parser/error_test.go.html#8621965">testing</a></span><span class="op" id="8623029">.</span><span class="ident" id="8623030">T</span><span class="op" id="8623031">,</span>&nbsp;<span class="ident" id="8623033">filename</span>&nbsp;<span class="builtintype" id="8623042">string</span><span class="op" id="8623048">,</span>&nbsp;<span class="ident" id="8623050">src</span>&nbsp;<span class="op" id="8623054">[</span><span class="op" id="8623055">]</span><span class="builtintype" id="8623056">byte</span><span class="op" id="8623060">)</span>&nbsp;<span class="keyword" id="8623062">map</span><span class="op" id="8623065">[</span><span class="ident" id="8623066"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8623071">.</span><span class="ident" id="8623072">Pos</span><span class="op" id="8623075">]</span><span class="builtintype" id="8623076">string</span>&nbsp;<span class="op" id="8623083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623086">errors</span>&nbsp;<span class="op" id="8623093">:=</span>&nbsp;<span class="builtinfunc" id="8623096">make</span><span class="op" id="8623100">(</span><span class="keyword" id="8623101">map</span><span class="op" id="8623104">[</span><span class="ident" id="8623105"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8623110">.</span><span class="ident" id="8623111">Pos</span><span class="op" id="8623114">]</span><span class="builtintype" id="8623115">string</span><span class="op" id="8623121">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623125">var</span>&nbsp;<span class="ident" id="8623129">s</span>&nbsp;<span class="ident" id="8623131"><a href="/go/parser/error_test.go.html#8621888">scanner</a></span><span class="op" id="8623138">.</span><span class="ident" id="8623139">Scanner</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8623148">//&nbsp;file&nbsp;was&nbsp;parsed&nbsp;already&nbsp;-&nbsp;do&nbsp;not&nbsp;add&nbsp;it&nbsp;again&nbsp;to&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8623210">//&nbsp;set&nbsp;otherwise&nbsp;the&nbsp;position&nbsp;information&nbsp;returned&nbsp;here&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8623272">//&nbsp;not&nbsp;match&nbsp;the&nbsp;position&nbsp;information&nbsp;collected&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623335"><a href="/go/parser/error_test.go.html#8623129">s</a></span><span class="op" id="8623336">.</span><span class="ident" id="8623337">Init</span><span class="op" id="8623341">(</span><span class="ident" id="8623342"><a href="/go/parser/error_test.go.html#8622105">getFile</a></span><span class="op" id="8623349">(</span><span class="ident" id="8623350"><a href="/go/parser/error_test.go.html#8623033">filename</a></span><span class="op" id="8623358">)</span><span class="op" id="8623359">,</span>&nbsp;<span class="ident" id="8623361"><a href="/go/parser/error_test.go.html#8623050">src</a></span><span class="op" id="8623364">,</span>&nbsp;<span class="ident" id="8623366">nil</span><span class="op" id="8623369">,</span>&nbsp;<span class="ident" id="8623371"><a href="/go/parser/error_test.go.html#8621888">scanner</a></span><span class="op" id="8623378">.</span><span class="ident" id="8623379">ScanComments</span><span class="op" id="8623391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623394">var</span>&nbsp;<span class="ident" id="8623398">prev</span>&nbsp;<span class="ident" id="8623403"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8623408">.</span><span class="ident" id="8623409">Pos</span>&nbsp;<span class="comment" id="8623413">//&nbsp;position&nbsp;of&nbsp;last&nbsp;non-comment,&nbsp;non-semicolon&nbsp;token</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623467">var</span>&nbsp;<span class="ident" id="8623471">here</span>&nbsp;<span class="ident" id="8623476"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8623481">.</span><span class="ident" id="8623482">Pos</span>&nbsp;<span class="comment" id="8623486">//&nbsp;position&nbsp;immediately&nbsp;after&nbsp;the&nbsp;token&nbsp;at&nbsp;position&nbsp;prev</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623545">for</span>&nbsp;<span class="op" id="8623549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623553">pos</span><span class="op" id="8623556">,</span>&nbsp;<span class="ident" id="8623558">tok</span><span class="op" id="8623561">,</span>&nbsp;<span class="ident" id="8623563">lit</span>&nbsp;<span class="op" id="8623567">:=</span>&nbsp;<span class="ident" id="8623570"><a href="/go/parser/error_test.go.html#8623129">s</a></span><span class="op" id="8623571">.</span><span class="ident" id="8623572">Scan</span><span class="op" id="8623576">(</span><span class="op" id="8623577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623581">switch</span>&nbsp;<span class="ident" id="8623588"><a href="/go/parser/error_test.go.html#8623558">tok</a></span>&nbsp;<span class="op" id="8623592">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623596">case</span>&nbsp;<span class="ident" id="8623601"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8623606">.</span><span class="ident" id="8623607">EOF</span><span class="op" id="8623610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623615">return</span>&nbsp;<span class="ident" id="8623622"><a href="/go/parser/error_test.go.html#8623086">errors</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623631">case</span>&nbsp;<span class="ident" id="8623636"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8623641">.</span><span class="ident" id="8623642">COMMENT</span><span class="op" id="8623649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623654">s</span>&nbsp;<span class="op" id="8623656">:=</span>&nbsp;<span class="ident" id="8623659"><a href="/go/parser/error_test.go.html#8622776">errRx</a></span><span class="op" id="8623664">.</span><span class="ident" id="8623665">FindStringSubmatch</span><span class="op" id="8623683">(</span><span class="ident" id="8623684"><a href="/go/parser/error_test.go.html#8623563">lit</a></span><span class="op" id="8623687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623692">if</span>&nbsp;<span class="builtinfunc" id="8623695">len</span><span class="op" id="8623698">(</span><span class="ident" id="8623699"><a href="/go/parser/error_test.go.html#8623654">s</a></span><span class="op" id="8623700">)</span>&nbsp;<span class="op" id="8623702">==</span>&nbsp;<span class="num" id="8623705">3</span>&nbsp;<span class="op" id="8623707">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623713">pos</span>&nbsp;<span class="op" id="8623717">:=</span>&nbsp;<span class="ident" id="8623720"><a href="/go/parser/error_test.go.html#8623398">prev</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623729">if</span>&nbsp;<span class="ident" id="8623732"><a href="/go/parser/error_test.go.html#8623654">s</a></span><span class="op" id="8623733">[</span><span class="num" id="8623734">1</span><span class="op" id="8623735">]</span>&nbsp;<span class="op" id="8623737">==</span>&nbsp;<span class="string" id="8623740">&#34;HERE&#34;</span>&nbsp;<span class="op" id="8623747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623754"><a href="/go/parser/error_test.go.html#8623713">pos</a></span>&nbsp;<span class="op" id="8623758">=</span>&nbsp;<span class="ident" id="8623760"><a href="/go/parser/error_test.go.html#8623471">here</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8623769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623775"><a href="/go/parser/error_test.go.html#8623086">errors</a></span><span class="op" id="8623781">[</span><span class="ident" id="8623782"><a href="/go/parser/error_test.go.html#8623713">pos</a></span><span class="op" id="8623785">]</span>&nbsp;<span class="op" id="8623787">=</span>&nbsp;<span class="builtintype" id="8623789">string</span><span class="op" id="8623795">(</span><span class="ident" id="8623796"><a href="/go/parser/error_test.go.html#8623654">s</a></span><span class="op" id="8623797">[</span><span class="num" id="8623798">2</span><span class="op" id="8623799">]</span><span class="op" id="8623800">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8623805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623809">default</span><span class="op" id="8623816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623821"><a href="/go/parser/error_test.go.html#8623398">prev</a></span>&nbsp;<span class="op" id="8623826">=</span>&nbsp;<span class="ident" id="8623828"><a href="/go/parser/error_test.go.html#8623553">pos</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623835">var</span>&nbsp;<span class="ident" id="8623839">l</span>&nbsp;<span class="builtintype" id="8623841">int</span>&nbsp;<span class="comment" id="8623845">//&nbsp;token&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8623864">if</span>&nbsp;<span class="ident" id="8623867"><a href="/go/parser/error_test.go.html#8623558">tok</a></span><span class="op" id="8623870">.</span><span class="ident" id="8623871">IsLiteral</span><span class="op" id="8623880">(</span><span class="op" id="8623881">)</span>&nbsp;<span class="op" id="8623883">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623889"><a href="/go/parser/error_test.go.html#8623839">l</a></span>&nbsp;<span class="op" id="8623891">=</span>&nbsp;<span class="builtinfunc" id="8623893">len</span><span class="op" id="8623896">(</span><span class="ident" id="8623897"><a href="/go/parser/error_test.go.html#8623563">lit</a></span><span class="op" id="8623900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8623905">}</span>&nbsp;<span class="keyword" id="8623907">else</span>&nbsp;<span class="op" id="8623912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623918"><a href="/go/parser/error_test.go.html#8623839">l</a></span>&nbsp;<span class="op" id="8623920">=</span>&nbsp;<span class="builtinfunc" id="8623922">len</span><span class="op" id="8623925">(</span><span class="ident" id="8623926"><a href="/go/parser/error_test.go.html#8623558">tok</a></span><span class="op" id="8623929">.</span><span class="ident" id="8623930">String</span><span class="op" id="8623936">(</span><span class="op" id="8623937">)</span><span class="op" id="8623938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8623943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8623948"><a href="/go/parser/error_test.go.html#8623471">here</a></span>&nbsp;<span class="op" id="8623953">=</span>&nbsp;<span class="ident" id="8623955"><a href="/go/parser/error_test.go.html#8623398">prev</a></span>&nbsp;<span class="op" id="8623960">+</span>&nbsp;<span class="ident" id="8623962"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8623967">.</span><span class="ident" id="8623968">Pos</span><span class="op" id="8623971">(</span><span class="ident" id="8623972"><a href="/go/parser/error_test.go.html#8623839">l</a></span><span class="op" id="8623973">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8623977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8623980">}</span><br>
<span class="lineno"></span><span class="op" id="8623982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8623985">//&nbsp;compareErrors&nbsp;compares&nbsp;the&nbsp;map&nbsp;of&nbsp;expected&nbsp;error&nbsp;messages&nbsp;with&nbsp;the&nbsp;list</span><br>
<span class="lineno">110</span><span class="comment" id="8624060">//&nbsp;of&nbsp;found&nbsp;errors&nbsp;and&nbsp;reports&nbsp;discrepancies.</span><br>
<span class="lineno"></span><span class="comment" id="8624106">//</span><br>
<span class="lineno"></span><span class="keyword" id="8624109">func</span>&nbsp;<span class="ident" id="8624114">compareErrors</span><span class="op" id="8624127">(</span><span class="ident" id="8624128">t</span>&nbsp;<span class="op" id="8624130">*</span><span class="ident" id="8624131"><a href="/go/parser/error_test.go.html#8621965">testing</a></span><span class="op" id="8624138">.</span><span class="ident" id="8624139">T</span><span class="op" id="8624140">,</span>&nbsp;<span class="ident" id="8624142">expected</span>&nbsp;<span class="keyword" id="8624151">map</span><span class="op" id="8624154">[</span><span class="ident" id="8624155"><a href="/go/parser/error_test.go.html#8621902">token</a></span><span class="op" id="8624160">.</span><span class="ident" id="8624161">Pos</span><span class="op" id="8624164">]</span><span class="builtintype" id="8624165">string</span><span class="op" id="8624171">,</span>&nbsp;<span class="ident" id="8624173">found</span>&nbsp;<span class="ident" id="8624179"><a href="/go/parser/error_test.go.html#8621888">scanner</a></span><span class="op" id="8624186">.</span><span class="ident" id="8624187">ErrorList</span><span class="op" id="8624196">)</span>&nbsp;<span class="op" id="8624198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8624201">for</span>&nbsp;<span class="ident" id="8624205">_</span><span class="op" id="8624206">,</span>&nbsp;<span class="builtintype" id="8624208">error</span>&nbsp;<span class="op" id="8624214">:=</span>&nbsp;<span class="keyword" id="8624217">range</span>&nbsp;<span class="ident" id="8624223"><a href="/go/parser/error_test.go.html#8624173">found</a></span>&nbsp;<span class="op" id="8624229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624233">//&nbsp;error.Pos&nbsp;is&nbsp;a&nbsp;token.Position,&nbsp;but&nbsp;we&nbsp;want</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624281">//&nbsp;a&nbsp;token.Pos&nbsp;so&nbsp;we&nbsp;can&nbsp;do&nbsp;a&nbsp;map&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8624324">pos</span>&nbsp;<span class="op" id="8624328">:=</span>&nbsp;<span class="ident" id="8624331"><a href="/go/parser/error_test.go.html#8622349">getPos</a></span><span class="op" id="8624337">(</span><span class="builtintype" id="8624338"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8624343">.</span><span class="ident" id="8624344">Pos</span><span class="op" id="8624347">.</span><span class="ident" id="8624348">Filename</span><span class="op" id="8624356">,</span>&nbsp;<span class="builtintype" id="8624358"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8624363">.</span><span class="ident" id="8624364">Pos</span><span class="op" id="8624367">.</span><span class="ident" id="8624368">Offset</span><span class="op" id="8624374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8624378">if</span>&nbsp;<span class="ident" id="8624381">msg</span><span class="op" id="8624384">,</span>&nbsp;<span class="ident" id="8624386">found</span>&nbsp;<span class="op" id="8624392">:=</span>&nbsp;<span class="ident" id="8624395"><a href="/go/parser/error_test.go.html#8624142">expected</a></span><span class="op" id="8624403">[</span><span class="ident" id="8624404"><a href="/go/parser/error_test.go.html#8624324">pos</a></span><span class="op" id="8624407">]</span><span class="op" id="8624408">;</span>&nbsp;<span class="ident" id="8624410"><a href="/go/parser/error_test.go.html#8624386">found</a></span>&nbsp;<span class="op" id="8624416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624421">//&nbsp;we&nbsp;expect&nbsp;a&nbsp;message&nbsp;at&nbsp;pos;&nbsp;check&nbsp;if&nbsp;it&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8624475">rx</span><span class="op" id="8624477">,</span>&nbsp;<span class="ident" id="8624479">err</span>&nbsp;<span class="op" id="8624483">:=</span>&nbsp;<span class="ident" id="8624486"><a href="/go/parser/error_test.go.html#8621944">regexp</a></span><span class="op" id="8624492">.</span><span class="ident" id="8624493">Compile</span><span class="op" id="8624500">(</span><span class="ident" id="8624501"><a href="/go/parser/error_test.go.html#8624381">msg</a></span><span class="op" id="8624504">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8624509">if</span>&nbsp;<span class="ident" id="8624512"><a href="/go/parser/error_test.go.html#8624479">err</a></span>&nbsp;<span class="op" id="8624516">!=</span>&nbsp;<span class="ident" id="8624519">nil</span>&nbsp;<span class="op" id="8624523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8624529"><a href="/go/parser/error_test.go.html#8624128">t</a></span><span class="op" id="8624530">.</span><span class="ident" id="8624531">Errorf</span><span class="op" id="8624537">(</span><span class="string" id="8624538">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="8624546">,</span>&nbsp;<span class="builtintype" id="8624548"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8624553">.</span><span class="ident" id="8624554">Pos</span><span class="op" id="8624557">,</span>&nbsp;<span class="ident" id="8624559"><a href="/go/parser/error_test.go.html#8624479">err</a></span><span class="op" id="8624562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8624568">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8624580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8624585">if</span>&nbsp;<span class="ident" id="8624588">match</span>&nbsp;<span class="op" id="8624594">:=</span>&nbsp;<span class="ident" id="8624597"><a href="/go/parser/error_test.go.html#8624475">rx</a></span><span class="op" id="8624599">.</span><span class="ident" id="8624600">MatchString</span><span class="op" id="8624611">(</span><span class="builtintype" id="8624612"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8624617">.</span><span class="ident" id="8624618">Msg</span><span class="op" id="8624621">)</span><span class="op" id="8624622">;</span>&nbsp;<span class="op" id="8624624">!</span><span class="ident" id="8624625"><a href="/go/parser/error_test.go.html#8624588">match</a></span>&nbsp;<span class="op" id="8624631">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8624637"><a href="/go/parser/error_test.go.html#8624128">t</a></span><span class="op" id="8624638">.</span><span class="ident" id="8624639">Errorf</span><span class="op" id="8624645">(</span><span class="string" id="8624646">&#34;%s:&nbsp;%q&nbsp;does&nbsp;not&nbsp;match&nbsp;%q&#34;</span><span class="op" id="8624672">,</span>&nbsp;<span class="builtintype" id="8624674"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8624679">.</span><span class="ident" id="8624680">Pos</span><span class="op" id="8624683">,</span>&nbsp;<span class="builtintype" id="8624685"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8624690">.</span><span class="ident" id="8624691">Msg</span><span class="op" id="8624694">,</span>&nbsp;<span class="ident" id="8624696"><a href="/go/parser/error_test.go.html#8624381">msg</a></span><span class="op" id="8624699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8624705">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8624717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624722">//&nbsp;we&nbsp;have&nbsp;a&nbsp;match&nbsp;-&nbsp;eliminate&nbsp;this&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8624767">delete</span><span class="op" id="8624773">(</span><span class="ident" id="8624774"><a href="/go/parser/error_test.go.html#8624142">expected</a></span><span class="op" id="8624782">,</span>&nbsp;<span class="ident" id="8624784"><a href="/go/parser/error_test.go.html#8624324">pos</a></span><span class="op" id="8624787">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8624791">}</span>&nbsp;<span class="keyword" id="8624793">else</span>&nbsp;<span class="op" id="8624798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624803">//&nbsp;To&nbsp;keep&nbsp;in&nbsp;mind&nbsp;when&nbsp;analyzing&nbsp;failed&nbsp;test&nbsp;output:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624860">//&nbsp;If&nbsp;the&nbsp;same&nbsp;error&nbsp;position&nbsp;occurs&nbsp;multiple&nbsp;times&nbsp;in&nbsp;errors,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624926">//&nbsp;this&nbsp;message&nbsp;will&nbsp;be&nbsp;triggered&nbsp;(because&nbsp;the&nbsp;first&nbsp;error&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8624991">//&nbsp;the&nbsp;position&nbsp;removes&nbsp;this&nbsp;position&nbsp;from&nbsp;the&nbsp;expected&nbsp;errors).</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625059"><a href="/go/parser/error_test.go.html#8624128">t</a></span><span class="op" id="8625060">.</span><span class="ident" id="8625061">Errorf</span><span class="op" id="8625067">(</span><span class="string" id="8625068">&#34;%s:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8625094">,</span>&nbsp;<span class="builtintype" id="8625096"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8625101">.</span><span class="ident" id="8625102">Pos</span><span class="op" id="8625105">,</span>&nbsp;<span class="builtintype" id="8625107"><a href="/go/parser/error_test.go.html#8624208">error</a></span><span class="op" id="8625112">.</span><span class="ident" id="8625113">Msg</span><span class="op" id="8625116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8625120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8625123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8625127">//&nbsp;there&nbsp;should&nbsp;be&nbsp;no&nbsp;expected&nbsp;errors&nbsp;left</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8625171">if</span>&nbsp;<span class="builtinfunc" id="8625174">len</span><span class="op" id="8625177">(</span><span class="ident" id="8625178"><a href="/go/parser/error_test.go.html#8624142">expected</a></span><span class="op" id="8625186">)</span>&nbsp;<span class="op" id="8625188">&gt;</span>&nbsp;<span class="num" id="8625190">0</span>&nbsp;<span class="op" id="8625192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625196"><a href="/go/parser/error_test.go.html#8624128">t</a></span><span class="op" id="8625197">.</span><span class="ident" id="8625198">Errorf</span><span class="op" id="8625204">(</span><span class="string" id="8625205">&#34;%d&nbsp;errors&nbsp;not&nbsp;reported:&#34;</span><span class="op" id="8625230">,</span>&nbsp;<span class="builtinfunc" id="8625232">len</span><span class="op" id="8625235">(</span><span class="ident" id="8625236"><a href="/go/parser/error_test.go.html#8624142">expected</a></span><span class="op" id="8625244">)</span><span class="op" id="8625245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8625249">for</span>&nbsp;<span class="ident" id="8625253">pos</span><span class="op" id="8625256">,</span>&nbsp;<span class="ident" id="8625258">msg</span>&nbsp;<span class="op" id="8625262">:=</span>&nbsp;<span class="keyword" id="8625265">range</span>&nbsp;<span class="ident" id="8625271"><a href="/go/parser/error_test.go.html#8624142">expected</a></span>&nbsp;<span class="op" id="8625280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625285"><a href="/go/parser/error_test.go.html#8624128">t</a></span><span class="op" id="8625286">.</span><span class="ident" id="8625287">Errorf</span><span class="op" id="8625293">(</span><span class="string" id="8625294">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="8625304">,</span>&nbsp;<span class="ident" id="8625306"><a href="/go/parser/error_test.go.html#8622011">fsetErrs</a></span><span class="op" id="8625314">.</span><span class="ident" id="8625315">Position</span><span class="op" id="8625323">(</span><span class="ident" id="8625324"><a href="/go/parser/error_test.go.html#8625253">pos</a></span><span class="op" id="8625327">)</span><span class="op" id="8625328">,</span>&nbsp;<span class="ident" id="8625330"><a href="/go/parser/error_test.go.html#8625258">msg</a></span><span class="op" id="8625333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8625337">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8625340">}</span><br>
<span class="lineno"></span><span class="op" id="8625342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8625345">func</span>&nbsp;<span class="ident" id="8625350">checkErrors</span><span class="op" id="8625361">(</span><span class="ident" id="8625362">t</span>&nbsp;<span class="op" id="8625364">*</span><span class="ident" id="8625365"><a href="/go/parser/error_test.go.html#8621965">testing</a></span><span class="op" id="8625372">.</span><span class="ident" id="8625373">T</span><span class="op" id="8625374">,</span>&nbsp;<span class="ident" id="8625376">filename</span>&nbsp;<span class="builtintype" id="8625385">string</span><span class="op" id="8625391">,</span>&nbsp;<span class="ident" id="8625393">input</span>&nbsp;<span class="keyword" id="8625399">interface</span><span class="op" id="8625408">{</span><span class="op" id="8625409">}</span><span class="op" id="8625410">)</span>&nbsp;<span class="op" id="8625412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625415">src</span><span class="op" id="8625418">,</span>&nbsp;<span class="ident" id="8625420">err</span>&nbsp;<span class="op" id="8625424">:=</span>&nbsp;<span class="ident" id="8625427"><a href="/go/parser/interface.go.html#5214080">readSource</a></span><span class="op" id="8625437">(</span><span class="ident" id="8625438"><a href="/go/parser/error_test.go.html#8625376">filename</a></span><span class="op" id="8625446">,</span>&nbsp;<span class="ident" id="8625448"><a href="/go/parser/error_test.go.html#8625393">input</a></span><span class="op" id="8625453">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8625456">if</span>&nbsp;<span class="ident" id="8625459"><a href="/go/parser/error_test.go.html#8625420">err</a></span>&nbsp;<span class="op" id="8625463">!=</span>&nbsp;<span class="ident" id="8625466">nil</span>&nbsp;<span class="op" id="8625470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625474"><a href="/go/parser/error_test.go.html#8625362">t</a></span><span class="op" id="8625475">.</span><span class="ident" id="8625476">Error</span><span class="op" id="8625481">(</span><span class="ident" id="8625482"><a href="/go/parser/error_test.go.html#8625420">err</a></span><span class="op" id="8625485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8625489">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8625497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625501">_</span><span class="op" id="8625502">,</span>&nbsp;<span class="ident" id="8625504"><a href="/go/parser/error_test.go.html#8625420">err</a></span>&nbsp;<span class="op" id="8625508">=</span>&nbsp;<span class="ident" id="8625510"><a href="/go/parser/interface.go.html#5216452">ParseFile</a></span><span class="op" id="8625519">(</span><span class="ident" id="8625520"><a href="/go/parser/error_test.go.html#8622011">fsetErrs</a></span><span class="op" id="8625528">,</span>&nbsp;<span class="ident" id="8625530"><a href="/go/parser/error_test.go.html#8625376">filename</a></span><span class="op" id="8625538">,</span>&nbsp;<span class="ident" id="8625540"><a href="/go/parser/error_test.go.html#8625415">src</a></span><span class="op" id="8625543">,</span>&nbsp;<span class="ident" id="8625545"><a href="/go/parser/interface.go.html#5215132">DeclarationErrors</a></span><span class="op" id="8625562">|</span><span class="ident" id="8625563"><a href="/go/parser/interface.go.html#5215306">AllErrors</a></span><span class="op" id="8625572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625575">found</span><span class="op" id="8625580">,</span>&nbsp;<span class="ident" id="8625582">ok</span>&nbsp;<span class="op" id="8625585">:=</span>&nbsp;<span class="ident" id="8625588"><a href="/go/parser/error_test.go.html#8625420">err</a></span><span class="op" id="8625591">.</span><span class="op" id="8625592">(</span><span class="ident" id="8625593"><a href="/go/parser/error_test.go.html#8621888">scanner</a></span><span class="op" id="8625600">.</span><span class="ident" id="8625601">ErrorList</span><span class="op" id="8625610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8625613">if</span>&nbsp;<span class="ident" id="8625616"><a href="/go/parser/error_test.go.html#8625420">err</a></span>&nbsp;<span class="op" id="8625620">!=</span>&nbsp;<span class="ident" id="8625623">nil</span>&nbsp;<span class="op" id="8625627">&amp;&amp;</span>&nbsp;<span class="op" id="8625630">!</span><span class="ident" id="8625631"><a href="/go/parser/error_test.go.html#8625582">ok</a></span>&nbsp;<span class="op" id="8625634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625638"><a href="/go/parser/error_test.go.html#8625362">t</a></span><span class="op" id="8625639">.</span><span class="ident" id="8625640">Error</span><span class="op" id="8625645">(</span><span class="ident" id="8625646"><a href="/go/parser/error_test.go.html#8625420">err</a></span><span class="op" id="8625649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8625653">return</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8625661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625664"><a href="/go/parser/error_test.go.html#8625575">found</a></span><span class="op" id="8625669">.</span><span class="ident" id="8625670">RemoveMultiples</span><span class="op" id="8625685">(</span><span class="op" id="8625686">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8625690">//&nbsp;we&nbsp;are&nbsp;expecting&nbsp;the&nbsp;following&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8625732">//&nbsp;(collect&nbsp;these&nbsp;after&nbsp;parsing&nbsp;a&nbsp;file&nbsp;so&nbsp;that&nbsp;it&nbsp;is&nbsp;found&nbsp;in&nbsp;the&nbsp;file&nbsp;set)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625809">expected</span>&nbsp;<span class="op" id="8625818">:=</span>&nbsp;<span class="ident" id="8625821"><a href="/go/parser/error_test.go.html#8623004">expectedErrors</a></span><span class="op" id="8625835">(</span><span class="ident" id="8625836"><a href="/go/parser/error_test.go.html#8625362">t</a></span><span class="op" id="8625837">,</span>&nbsp;<span class="ident" id="8625839"><a href="/go/parser/error_test.go.html#8625376">filename</a></span><span class="op" id="8625847">,</span>&nbsp;<span class="ident" id="8625849"><a href="/go/parser/error_test.go.html#8625415">src</a></span><span class="op" id="8625852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8625856">//&nbsp;verify&nbsp;errors&nbsp;returned&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625897"><a href="/go/parser/error_test.go.html#8624114">compareErrors</a></span><span class="op" id="8625910">(</span><span class="ident" id="8625911"><a href="/go/parser/error_test.go.html#8625362">t</a></span><span class="op" id="8625912">,</span>&nbsp;<span class="ident" id="8625914"><a href="/go/parser/error_test.go.html#8625809">expected</a></span><span class="op" id="8625922">,</span>&nbsp;<span class="ident" id="8625924"><a href="/go/parser/error_test.go.html#8625575">found</a></span><span class="op" id="8625929">)</span><br>
<span class="lineno"></span><span class="op" id="8625931">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8625934">func</span>&nbsp;<span class="ident" id="8625939">TestErrors</span><span class="op" id="8625949">(</span><span class="ident" id="8625950">t</span>&nbsp;<span class="op" id="8625952">*</span><span class="ident" id="8625953"><a href="/go/parser/error_test.go.html#8621965">testing</a></span><span class="op" id="8625960">.</span><span class="ident" id="8625961">T</span><span class="op" id="8625962">)</span>&nbsp;<span class="op" id="8625964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8625967">list</span><span class="op" id="8625971">,</span>&nbsp;<span class="ident" id="8625973">err</span>&nbsp;<span class="op" id="8625977">:=</span>&nbsp;<span class="ident" id="8625980"><a href="/go/parser/error_test.go.html#8621914">ioutil</a></span><span class="op" id="8625986">.</span><span class="ident" id="8625987">ReadDir</span><span class="op" id="8625994">(</span><span class="ident" id="8625995"><a href="/go/parser/error_test.go.html#8621984">testdata</a></span><span class="op" id="8626003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8626006">if</span>&nbsp;<span class="ident" id="8626009"><a href="/go/parser/error_test.go.html#8625973">err</a></span>&nbsp;<span class="op" id="8626013">!=</span>&nbsp;<span class="ident" id="8626016">nil</span>&nbsp;<span class="op" id="8626020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8626024"><a href="/go/parser/error_test.go.html#8625950">t</a></span><span class="op" id="8626025">.</span><span class="ident" id="8626026">Fatal</span><span class="op" id="8626031">(</span><span class="ident" id="8626032"><a href="/go/parser/error_test.go.html#8625973">err</a></span><span class="op" id="8626035">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8626038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8626041">for</span>&nbsp;<span class="ident" id="8626045">_</span><span class="op" id="8626046">,</span>&nbsp;<span class="ident" id="8626048">fi</span>&nbsp;<span class="op" id="8626051">:=</span>&nbsp;<span class="keyword" id="8626054">range</span>&nbsp;<span class="ident" id="8626060"><a href="/go/parser/error_test.go.html#8625967">list</a></span>&nbsp;<span class="op" id="8626065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8626069">name</span>&nbsp;<span class="op" id="8626074">:=</span>&nbsp;<span class="ident" id="8626077"><a href="/go/parser/error_test.go.html#8626048">fi</a></span><span class="op" id="8626079">.</span><span class="ident" id="8626080">Name</span><span class="op" id="8626084">(</span><span class="op" id="8626085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8626089">if</span>&nbsp;<span class="op" id="8626092">!</span><span class="ident" id="8626093"><a href="/go/parser/error_test.go.html#8626048">fi</a></span><span class="op" id="8626095">.</span><span class="ident" id="8626096">IsDir</span><span class="op" id="8626101">(</span><span class="op" id="8626102">)</span>&nbsp;<span class="op" id="8626104">&amp;&amp;</span>&nbsp;<span class="op" id="8626107">!</span><span class="ident" id="8626108"><a href="/go/parser/error_test.go.html#8621954">strings</a></span><span class="op" id="8626115">.</span><span class="ident" id="8626116">HasPrefix</span><span class="op" id="8626125">(</span><span class="ident" id="8626126"><a href="/go/parser/error_test.go.html#8626069">name</a></span><span class="op" id="8626130">,</span>&nbsp;<span class="string" id="8626132">&#34;.&#34;</span><span class="op" id="8626135">)</span>&nbsp;<span class="op" id="8626137">&amp;&amp;</span>&nbsp;<span class="ident" id="8626140"><a href="/go/parser/error_test.go.html#8621954">strings</a></span><span class="op" id="8626147">.</span><span class="ident" id="8626148">HasSuffix</span><span class="op" id="8626157">(</span><span class="ident" id="8626158"><a href="/go/parser/error_test.go.html#8626069">name</a></span><span class="op" id="8626162">,</span>&nbsp;<span class="string" id="8626164">&#34;.src&#34;</span><span class="op" id="8626170">)</span>&nbsp;<span class="op" id="8626172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8626177"><a href="/go/parser/error_test.go.html#8625350">checkErrors</a></span><span class="op" id="8626188">(</span><span class="ident" id="8626189"><a href="/go/parser/error_test.go.html#8625950">t</a></span><span class="op" id="8626190">,</span>&nbsp;<span class="ident" id="8626192"><a href="/go/parser/error_test.go.html#8621927">filepath</a></span><span class="op" id="8626200">.</span><span class="ident" id="8626201">Join</span><span class="op" id="8626205">(</span><span class="ident" id="8626206"><a href="/go/parser/error_test.go.html#8621984">testdata</a></span><span class="op" id="8626214">,</span>&nbsp;<span class="ident" id="8626216"><a href="/go/parser/error_test.go.html#8626069">name</a></span><span class="op" id="8626220">)</span><span class="op" id="8626221">,</span>&nbsp;<span class="ident" id="8626223">nil</span><span class="op" id="8626226">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8626230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8626233">}</span><br>
<span class="lineno"></span><span class="op" id="8626235">}</span>
</div>
</body>
</html>
