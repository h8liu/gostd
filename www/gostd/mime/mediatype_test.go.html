<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html" class="current">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8212753">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8212808">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8212862">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8212913">package</span>&nbsp;<span class="ident" id="8212921">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8212927">import</span>&nbsp;<span class="op" id="8212934">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212937">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212948">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8212958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8212961">func</span>&nbsp;<span class="ident" id="8212966">TestConsumeToken</span><span class="op" id="8212982">(</span><span class="ident" id="8212983">t</span>&nbsp;<span class="op" id="8212985">*</span><span class="ident" id="8212986">testing</span><span class="op" id="8212993">.</span><span class="ident" id="8212994">T</span><span class="op" id="8212995">)</span>&nbsp;<span class="op" id="8212997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213000">tests</span>&nbsp;<span class="op" id="8213006">:=</span>&nbsp;<span class="op" id="8213009">[</span><span class="op" id="8213010">...</span><span class="op" id="8213013">]</span><span class="op" id="8213014">[</span><span class="num" id="8213015">3</span><span class="op" id="8213016">]</span><span class="builtintype" id="8213017">string</span><span class="op" id="8213023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213027">{</span><span class="string" id="8213028">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8213037">,</span>&nbsp;<span class="string" id="8213039">&#34;foo&#34;</span><span class="op" id="8213044">,</span>&nbsp;<span class="string" id="8213046">&#34;&nbsp;bar&#34;</span><span class="op" id="8213052">}</span><span class="op" id="8213053">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213057">{</span><span class="string" id="8213058">&#34;bar&#34;</span><span class="op" id="8213063">,</span>&nbsp;<span class="string" id="8213065">&#34;bar&#34;</span><span class="op" id="8213070">,</span>&nbsp;<span class="string" id="8213072">&#34;&#34;</span><span class="op" id="8213074">}</span><span class="op" id="8213075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213079">{</span><span class="string" id="8213080">&#34;&#34;</span><span class="op" id="8213082">,</span>&nbsp;<span class="string" id="8213084">&#34;&#34;</span><span class="op" id="8213086">,</span>&nbsp;<span class="string" id="8213088">&#34;&#34;</span><span class="op" id="8213090">}</span><span class="op" id="8213091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213095">{</span><span class="string" id="8213096">&#34;&nbsp;foo&#34;</span><span class="op" id="8213102">,</span>&nbsp;<span class="string" id="8213104">&#34;&#34;</span><span class="op" id="8213106">,</span>&nbsp;<span class="string" id="8213108">&#34;&nbsp;foo&#34;</span><span class="op" id="8213114">}</span><span class="op" id="8213115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213121">for</span>&nbsp;<span class="ident" id="8213125">_</span><span class="op" id="8213126">,</span>&nbsp;<span class="ident" id="8213128">test</span>&nbsp;<span class="op" id="8213133">:=</span>&nbsp;<span class="keyword" id="8213136">range</span>&nbsp;<span class="ident" id="8213142">tests</span>&nbsp;<span class="op" id="8213148">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213152">token</span><span class="op" id="8213157">,</span>&nbsp;<span class="ident" id="8213159">rest</span>&nbsp;<span class="op" id="8213164">:=</span>&nbsp;<span class="ident" id="8213167">consumeToken</span><span class="op" id="8213179">(</span><span class="ident" id="8213180">test</span><span class="op" id="8213184">[</span><span class="num" id="8213185">0</span><span class="op" id="8213186">]</span><span class="op" id="8213187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213191">expectedToken</span>&nbsp;<span class="op" id="8213205">:=</span>&nbsp;<span class="ident" id="8213208">test</span><span class="op" id="8213212">[</span><span class="num" id="8213213">1</span><span class="op" id="8213214">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213218">expectedRest</span>&nbsp;<span class="op" id="8213231">:=</span>&nbsp;<span class="ident" id="8213234">test</span><span class="op" id="8213238">[</span><span class="num" id="8213239">2</span><span class="op" id="8213240">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213244">if</span>&nbsp;<span class="ident" id="8213247">token</span>&nbsp;<span class="op" id="8213253">!=</span>&nbsp;<span class="ident" id="8213256">expectedToken</span>&nbsp;<span class="op" id="8213270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213275">t</span><span class="op" id="8213276">.</span><span class="ident" id="8213277">Errorf</span><span class="op" id="8213283">(</span><span class="string" id="8213284">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8213336">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213342">expectedToken</span><span class="op" id="8213355">,</span>&nbsp;<span class="ident" id="8213357">token</span><span class="op" id="8213362">,</span>&nbsp;<span class="ident" id="8213364">test</span><span class="op" id="8213368">[</span><span class="num" id="8213369">0</span><span class="op" id="8213370">]</span><span class="op" id="8213371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213375">}</span>&nbsp;<span class="keyword" id="8213377">else</span>&nbsp;<span class="keyword" id="8213382">if</span>&nbsp;<span class="ident" id="8213385">rest</span>&nbsp;<span class="op" id="8213390">!=</span>&nbsp;<span class="ident" id="8213393">expectedRest</span>&nbsp;<span class="op" id="8213406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213411">t</span><span class="op" id="8213412">.</span><span class="ident" id="8213413">Errorf</span><span class="op" id="8213419">(</span><span class="string" id="8213420">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8213493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213499">expectedRest</span><span class="op" id="8213511">,</span>&nbsp;<span class="ident" id="8213513">rest</span><span class="op" id="8213517">,</span>&nbsp;<span class="ident" id="8213519">token</span><span class="op" id="8213524">,</span>&nbsp;<span class="ident" id="8213526">test</span><span class="op" id="8213530">[</span><span class="num" id="8213531">0</span><span class="op" id="8213532">]</span><span class="op" id="8213533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213537">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213540">}</span><br>
<span class="lineno"></span><span class="op" id="8213542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8213545">func</span>&nbsp;<span class="ident" id="8213550">TestConsumeValue</span><span class="op" id="8213566">(</span><span class="ident" id="8213567">t</span>&nbsp;<span class="op" id="8213569">*</span><span class="ident" id="8213570">testing</span><span class="op" id="8213577">.</span><span class="ident" id="8213578">T</span><span class="op" id="8213579">)</span>&nbsp;<span class="op" id="8213581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213584">tests</span>&nbsp;<span class="op" id="8213590">:=</span>&nbsp;<span class="op" id="8213593">[</span><span class="op" id="8213594">...</span><span class="op" id="8213597">]</span><span class="op" id="8213598">[</span><span class="num" id="8213599">3</span><span class="op" id="8213600">]</span><span class="builtintype" id="8213601">string</span><span class="op" id="8213607">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213611">{</span><span class="string" id="8213612">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8213621">,</span>&nbsp;<span class="string" id="8213623">&#34;foo&#34;</span><span class="op" id="8213628">,</span>&nbsp;<span class="string" id="8213630">&#34;&nbsp;bar&#34;</span><span class="op" id="8213636">}</span><span class="op" id="8213637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213641">{</span><span class="string" id="8213642">&#34;bar&#34;</span><span class="op" id="8213647">,</span>&nbsp;<span class="string" id="8213649">&#34;bar&#34;</span><span class="op" id="8213654">,</span>&nbsp;<span class="string" id="8213656">&#34;&#34;</span><span class="op" id="8213658">}</span><span class="op" id="8213659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213663">{</span><span class="string" id="8213664">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8213671">,</span>&nbsp;<span class="string" id="8213673">&#34;&#34;</span><span class="op" id="8213675">,</span>&nbsp;<span class="string" id="8213677">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8213684">}</span><span class="op" id="8213685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213689">{</span><span class="string" id="8213690">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="8213705">,</span>&nbsp;<span class="string" id="8213707">&#34;My&nbsp;value&#34;</span><span class="op" id="8213717">,</span>&nbsp;<span class="string" id="8213719">&#34;end&#34;</span><span class="op" id="8213724">}</span><span class="op" id="8213725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213729">{</span><span class="string" id="8213730">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="8213746">,</span>&nbsp;<span class="string" id="8213748">&#34;My&nbsp;value&#34;</span><span class="op" id="8213758">,</span>&nbsp;<span class="string" id="8213760">&#34;&nbsp;end&#34;</span><span class="op" id="8213766">}</span><span class="op" id="8213767">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213771">{</span><span class="string" id="8213772">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="8213783">,</span>&nbsp;<span class="string" id="8213785">&#34;\\&#34;</span><span class="op" id="8213789">,</span>&nbsp;<span class="string" id="8213791">&#34;&nbsp;rest&#34;</span><span class="op" id="8213798">}</span><span class="op" id="8213799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213803">{</span><span class="string" id="8213804">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="8213822">,</span>&nbsp;<span class="string" id="8213824">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="8213837">,</span>&nbsp;<span class="string" id="8213839">&#34;end&#34;</span><span class="op" id="8213844">}</span><span class="op" id="8213845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213849">{</span><span class="string" id="8213850">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8213860">,</span>&nbsp;<span class="string" id="8213862">&#34;&#34;</span><span class="op" id="8213864">,</span>&nbsp;<span class="string" id="8213866">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8213876">}</span><span class="op" id="8213877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213883">for</span>&nbsp;<span class="ident" id="8213887">_</span><span class="op" id="8213888">,</span>&nbsp;<span class="ident" id="8213890">test</span>&nbsp;<span class="op" id="8213895">:=</span>&nbsp;<span class="keyword" id="8213898">range</span>&nbsp;<span class="ident" id="8213904">tests</span>&nbsp;<span class="op" id="8213910">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213914">value</span><span class="op" id="8213919">,</span>&nbsp;<span class="ident" id="8213921">rest</span>&nbsp;<span class="op" id="8213926">:=</span>&nbsp;<span class="ident" id="8213929">consumeValue</span><span class="op" id="8213941">(</span><span class="ident" id="8213942">test</span><span class="op" id="8213946">[</span><span class="num" id="8213947">0</span><span class="op" id="8213948">]</span><span class="op" id="8213949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213953">expectedValue</span>&nbsp;<span class="op" id="8213967">:=</span>&nbsp;<span class="ident" id="8213970">test</span><span class="op" id="8213974">[</span><span class="num" id="8213975">1</span><span class="op" id="8213976">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213980">expectedRest</span>&nbsp;<span class="op" id="8213993">:=</span>&nbsp;<span class="ident" id="8213996">test</span><span class="op" id="8214000">[</span><span class="num" id="8214001">2</span><span class="op" id="8214002">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8214006">if</span>&nbsp;<span class="ident" id="8214009">value</span>&nbsp;<span class="op" id="8214015">!=</span>&nbsp;<span class="ident" id="8214018">expectedValue</span>&nbsp;<span class="op" id="8214032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214037">t</span><span class="op" id="8214038">.</span><span class="ident" id="8214039">Errorf</span><span class="op" id="8214045">(</span><span class="string" id="8214046">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8214098">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214104">expectedValue</span><span class="op" id="8214117">,</span>&nbsp;<span class="ident" id="8214119">value</span><span class="op" id="8214124">,</span>&nbsp;<span class="ident" id="8214126">test</span><span class="op" id="8214130">[</span><span class="num" id="8214131">0</span><span class="op" id="8214132">]</span><span class="op" id="8214133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214137">}</span>&nbsp;<span class="keyword" id="8214139">else</span>&nbsp;<span class="keyword" id="8214144">if</span>&nbsp;<span class="ident" id="8214147">rest</span>&nbsp;<span class="op" id="8214152">!=</span>&nbsp;<span class="ident" id="8214155">expectedRest</span>&nbsp;<span class="op" id="8214168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214173">t</span><span class="op" id="8214174">.</span><span class="ident" id="8214175">Errorf</span><span class="op" id="8214181">(</span><span class="string" id="8214182">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8214255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214261">expectedRest</span><span class="op" id="8214273">,</span>&nbsp;<span class="ident" id="8214275">rest</span><span class="op" id="8214279">,</span>&nbsp;<span class="ident" id="8214281">value</span><span class="op" id="8214286">,</span>&nbsp;<span class="ident" id="8214288">test</span><span class="op" id="8214292">[</span><span class="num" id="8214293">0</span><span class="op" id="8214294">]</span><span class="op" id="8214295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214299">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214302">}</span><br>
<span class="lineno"></span><span class="op" id="8214304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8214307">func</span>&nbsp;<span class="ident" id="8214312">TestConsumeMediaParam</span><span class="op" id="8214333">(</span><span class="ident" id="8214334">t</span>&nbsp;<span class="op" id="8214336">*</span><span class="ident" id="8214337">testing</span><span class="op" id="8214344">.</span><span class="ident" id="8214345">T</span><span class="op" id="8214346">)</span>&nbsp;<span class="op" id="8214348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214351">tests</span>&nbsp;<span class="op" id="8214357">:=</span>&nbsp;<span class="op" id="8214360">[</span><span class="op" id="8214361">...</span><span class="op" id="8214364">]</span><span class="op" id="8214365">[</span><span class="num" id="8214366">4</span><span class="op" id="8214367">]</span><span class="builtintype" id="8214368">string</span><span class="op" id="8214374">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214378">{</span><span class="string" id="8214379">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="8214391">,</span>&nbsp;<span class="string" id="8214393">&#34;foo&#34;</span><span class="op" id="8214398">,</span>&nbsp;<span class="string" id="8214400">&#34;bar&#34;</span><span class="op" id="8214405">,</span>&nbsp;<span class="string" id="8214407">&#34;&#34;</span><span class="op" id="8214409">}</span><span class="op" id="8214410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214414">{</span><span class="string" id="8214415">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="8214426">,</span>&nbsp;<span class="string" id="8214428">&#34;foo&#34;</span><span class="op" id="8214433">,</span>&nbsp;<span class="string" id="8214435">&#34;bar&#34;</span><span class="op" id="8214440">,</span>&nbsp;<span class="string" id="8214442">&#34;&#34;</span><span class="op" id="8214444">}</span><span class="op" id="8214445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214449">{</span><span class="string" id="8214450">&#34;;foo=bar&#34;</span><span class="op" id="8214460">,</span>&nbsp;<span class="string" id="8214462">&#34;foo&#34;</span><span class="op" id="8214467">,</span>&nbsp;<span class="string" id="8214469">&#34;bar&#34;</span><span class="op" id="8214474">,</span>&nbsp;<span class="string" id="8214476">&#34;&#34;</span><span class="op" id="8214478">}</span><span class="op" id="8214479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214483">{</span><span class="string" id="8214484">&#34;;FOO=bar&#34;</span><span class="op" id="8214494">,</span>&nbsp;<span class="string" id="8214496">&#34;foo&#34;</span><span class="op" id="8214501">,</span>&nbsp;<span class="string" id="8214503">&#34;bar&#34;</span><span class="op" id="8214508">,</span>&nbsp;<span class="string" id="8214510">&#34;&#34;</span><span class="op" id="8214512">}</span><span class="op" id="8214513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214517">{</span><span class="string" id="8214518">`;foo=&#34;bar&#34;`</span><span class="op" id="8214530">,</span>&nbsp;<span class="string" id="8214532">&#34;foo&#34;</span><span class="op" id="8214537">,</span>&nbsp;<span class="string" id="8214539">&#34;bar&#34;</span><span class="op" id="8214544">,</span>&nbsp;<span class="string" id="8214546">&#34;&#34;</span><span class="op" id="8214548">}</span><span class="op" id="8214549">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214553">{</span><span class="string" id="8214554">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="8214568">,</span>&nbsp;<span class="string" id="8214570">&#34;foo&#34;</span><span class="op" id="8214575">,</span>&nbsp;<span class="string" id="8214577">&#34;bar&#34;</span><span class="op" id="8214582">,</span>&nbsp;<span class="string" id="8214584">&#34;;&nbsp;&#34;</span><span class="op" id="8214588">}</span><span class="op" id="8214589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214593">{</span><span class="string" id="8214594">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="8214615">,</span>&nbsp;<span class="string" id="8214617">&#34;foo&#34;</span><span class="op" id="8214622">,</span>&nbsp;<span class="string" id="8214624">&#34;bar&#34;</span><span class="op" id="8214629">,</span>&nbsp;<span class="string" id="8214631">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="8214642">}</span><span class="op" id="8214643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214647">{</span><span class="string" id="8214648">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="8214670">,</span>&nbsp;<span class="string" id="8214672">&#34;boundary&#34;</span><span class="op" id="8214682">,</span>&nbsp;<span class="string" id="8214684">&#34;----CUT&#34;</span><span class="op" id="8214693">,</span>&nbsp;<span class="string" id="8214695">&#34;;&#34;</span><span class="op" id="8214698">}</span><span class="op" id="8214699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214703">{</span><span class="string" id="8214704">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8214745">,</span>&nbsp;<span class="string" id="8214747">&#34;key&#34;</span><span class="op" id="8214752">,</span>&nbsp;<span class="string" id="8214754">&#34;value&#34;</span><span class="op" id="8214761">,</span>&nbsp;<span class="string" id="8214763">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8214792">}</span><span class="op" id="8214793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214797">{</span><span class="string" id="8214798">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8214827">,</span>&nbsp;<span class="string" id="8214829">&#34;blah&#34;</span><span class="op" id="8214835">,</span>&nbsp;<span class="string" id="8214837">&#34;value&#34;</span><span class="op" id="8214844">,</span>&nbsp;<span class="string" id="8214846">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8214860">}</span><span class="op" id="8214861">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214865">{</span><span class="string" id="8214866">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8214880">,</span>&nbsp;<span class="string" id="8214882">&#34;name&#34;</span><span class="op" id="8214888">,</span>&nbsp;<span class="string" id="8214890">&#34;foo&#34;</span><span class="op" id="8214895">,</span>&nbsp;<span class="string" id="8214897">`&nbsp;`</span><span class="op" id="8214900">}</span><span class="op" id="8214901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8214907">for</span>&nbsp;<span class="ident" id="8214911">_</span><span class="op" id="8214912">,</span>&nbsp;<span class="ident" id="8214914">test</span>&nbsp;<span class="op" id="8214919">:=</span>&nbsp;<span class="keyword" id="8214922">range</span>&nbsp;<span class="ident" id="8214928">tests</span>&nbsp;<span class="op" id="8214934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214938">param</span><span class="op" id="8214943">,</span>&nbsp;<span class="ident" id="8214945">value</span><span class="op" id="8214950">,</span>&nbsp;<span class="ident" id="8214952">rest</span>&nbsp;<span class="op" id="8214957">:=</span>&nbsp;<span class="ident" id="8214960">consumeMediaParam</span><span class="op" id="8214977">(</span><span class="ident" id="8214978">test</span><span class="op" id="8214982">[</span><span class="num" id="8214983">0</span><span class="op" id="8214984">]</span><span class="op" id="8214985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214989">expectedParam</span>&nbsp;<span class="op" id="8215003">:=</span>&nbsp;<span class="ident" id="8215006">test</span><span class="op" id="8215010">[</span><span class="num" id="8215011">1</span><span class="op" id="8215012">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215016">expectedValue</span>&nbsp;<span class="op" id="8215030">:=</span>&nbsp;<span class="ident" id="8215033">test</span><span class="op" id="8215037">[</span><span class="num" id="8215038">2</span><span class="op" id="8215039">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215043">expectedRest</span>&nbsp;<span class="op" id="8215056">:=</span>&nbsp;<span class="ident" id="8215059">test</span><span class="op" id="8215063">[</span><span class="num" id="8215064">3</span><span class="op" id="8215065">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8215069">if</span>&nbsp;<span class="ident" id="8215072">param</span>&nbsp;<span class="op" id="8215078">!=</span>&nbsp;<span class="ident" id="8215081">expectedParam</span>&nbsp;<span class="op" id="8215095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215100">t</span><span class="op" id="8215101">.</span><span class="ident" id="8215102">Errorf</span><span class="op" id="8215108">(</span><span class="string" id="8215109">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8215161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215167">expectedParam</span><span class="op" id="8215180">,</span>&nbsp;<span class="ident" id="8215182">param</span><span class="op" id="8215187">,</span>&nbsp;<span class="ident" id="8215189">test</span><span class="op" id="8215193">[</span><span class="num" id="8215194">0</span><span class="op" id="8215195">]</span><span class="op" id="8215196">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215200">}</span>&nbsp;<span class="keyword" id="8215202">else</span>&nbsp;<span class="keyword" id="8215207">if</span>&nbsp;<span class="ident" id="8215210">value</span>&nbsp;<span class="op" id="8215216">!=</span>&nbsp;<span class="ident" id="8215219">expectedValue</span>&nbsp;<span class="op" id="8215233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215238">t</span><span class="op" id="8215239">.</span><span class="ident" id="8215240">Errorf</span><span class="op" id="8215246">(</span><span class="string" id="8215247">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8215299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215305">expectedValue</span><span class="op" id="8215318">,</span>&nbsp;<span class="ident" id="8215320">value</span><span class="op" id="8215325">,</span>&nbsp;<span class="ident" id="8215327">test</span><span class="op" id="8215331">[</span><span class="num" id="8215332">0</span><span class="op" id="8215333">]</span><span class="op" id="8215334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215338">}</span>&nbsp;<span class="keyword" id="8215340">else</span>&nbsp;<span class="keyword" id="8215345">if</span>&nbsp;<span class="ident" id="8215348">rest</span>&nbsp;<span class="op" id="8215353">!=</span>&nbsp;<span class="ident" id="8215356">expectedRest</span>&nbsp;<span class="op" id="8215369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215374">t</span><span class="op" id="8215375">.</span><span class="ident" id="8215376">Errorf</span><span class="op" id="8215382">(</span><span class="string" id="8215383">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8215453">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215459">expectedRest</span><span class="op" id="8215471">,</span>&nbsp;<span class="ident" id="8215473">rest</span><span class="op" id="8215477">,</span>&nbsp;<span class="ident" id="8215479">param</span><span class="op" id="8215484">,</span>&nbsp;<span class="ident" id="8215486">value</span><span class="op" id="8215491">,</span>&nbsp;<span class="ident" id="8215493">test</span><span class="op" id="8215497">[</span><span class="num" id="8215498">0</span><span class="op" id="8215499">]</span><span class="op" id="8215500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215507">}</span><br>
<span class="lineno"></span><span class="op" id="8215509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8215512">type</span>&nbsp;<span class="ident" id="8215517">mediaTypeTest</span>&nbsp;<span class="keyword" id="8215531">struct</span>&nbsp;<span class="op" id="8215538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215541">in</span>&nbsp;<span class="builtintype" id="8215544">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215552">t</span>&nbsp;&nbsp;<span class="builtintype" id="8215555">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215563">p</span>&nbsp;&nbsp;<span class="keyword" id="8215566">map</span><span class="op" id="8215569">[</span><span class="builtintype" id="8215570">string</span><span class="op" id="8215576">]</span><span class="builtintype" id="8215577">string</span><br>
<span class="lineno"></span><span class="op" id="8215584">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="8215587">func</span>&nbsp;<span class="ident" id="8215592">TestParseMediaType</span><span class="op" id="8215610">(</span><span class="ident" id="8215611">t</span>&nbsp;<span class="op" id="8215613">*</span><span class="ident" id="8215614">testing</span><span class="op" id="8215621">.</span><span class="ident" id="8215622">T</span><span class="op" id="8215623">)</span>&nbsp;<span class="op" id="8215625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8215628">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215660">m</span>&nbsp;<span class="op" id="8215662">:=</span>&nbsp;<span class="keyword" id="8215665">func</span><span class="op" id="8215669">(</span><span class="ident" id="8215670">s</span>&nbsp;<span class="op" id="8215672">...</span><span class="builtintype" id="8215675">string</span><span class="op" id="8215681">)</span>&nbsp;<span class="keyword" id="8215683">map</span><span class="op" id="8215686">[</span><span class="builtintype" id="8215687">string</span><span class="op" id="8215693">]</span><span class="builtintype" id="8215694">string</span>&nbsp;<span class="op" id="8215701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215705">sm</span>&nbsp;<span class="op" id="8215708">:=</span>&nbsp;<span class="builtinfunc" id="8215711">make</span><span class="op" id="8215715">(</span><span class="keyword" id="8215716">map</span><span class="op" id="8215719">[</span><span class="builtintype" id="8215720">string</span><span class="op" id="8215726">]</span><span class="builtintype" id="8215727">string</span><span class="op" id="8215733">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8215737">for</span>&nbsp;<span class="ident" id="8215741">i</span>&nbsp;<span class="op" id="8215743">:=</span>&nbsp;<span class="num" id="8215746">0</span><span class="op" id="8215747">;</span>&nbsp;<span class="ident" id="8215749">i</span>&nbsp;<span class="op" id="8215751">&lt;</span>&nbsp;<span class="builtinfunc" id="8215753">len</span><span class="op" id="8215756">(</span><span class="ident" id="8215757">s</span><span class="op" id="8215758">)</span><span class="op" id="8215759">;</span>&nbsp;<span class="ident" id="8215761">i</span>&nbsp;<span class="op" id="8215763">+=</span>&nbsp;<span class="num" id="8215766">2</span>&nbsp;<span class="op" id="8215768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215773">sm</span><span class="op" id="8215775">[</span><span class="ident" id="8215776">s</span><span class="op" id="8215777">[</span><span class="ident" id="8215778">i</span><span class="op" id="8215779">]</span><span class="op" id="8215780">]</span>&nbsp;<span class="op" id="8215782">=</span>&nbsp;<span class="ident" id="8215784">s</span><span class="op" id="8215785">[</span><span class="ident" id="8215786">i</span><span class="op" id="8215787">+</span><span class="num" id="8215788">1</span><span class="op" id="8215789">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8215797">return</span>&nbsp;<span class="ident" id="8215804">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215808">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215812">nameFoo</span>&nbsp;<span class="op" id="8215820">:=</span>&nbsp;<span class="keyword" id="8215823">map</span><span class="op" id="8215826">[</span><span class="builtintype" id="8215827">string</span><span class="op" id="8215833">]</span><span class="builtintype" id="8215834">string</span><span class="op" id="8215840">{</span><span class="string" id="8215841">&#34;name&#34;</span><span class="op" id="8215847">:</span>&nbsp;<span class="string" id="8215849">&#34;foo&#34;</span><span class="op" id="8215854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215857">tests</span>&nbsp;<span class="op" id="8215863">:=</span>&nbsp;<span class="op" id="8215866">[</span><span class="op" id="8215867">]</span><span class="ident" id="8215868">mediaTypeTest</span><span class="op" id="8215881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215885">{</span><span class="string" id="8215886">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8215909">,</span>&nbsp;<span class="string" id="8215911">&#34;form-data&#34;</span><span class="op" id="8215922">,</span>&nbsp;<span class="ident" id="8215924">nameFoo</span><span class="op" id="8215931">}</span><span class="op" id="8215932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215936">{</span><span class="string" id="8215937">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="8215960">,</span>&nbsp;<span class="string" id="8215962">&#34;form-data&#34;</span><span class="op" id="8215973">,</span>&nbsp;<span class="ident" id="8215975">nameFoo</span><span class="op" id="8215982">}</span><span class="op" id="8215983">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215987">{</span><span class="string" id="8215988">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="8216010">,</span>&nbsp;<span class="string" id="8216012">&#34;form-data&#34;</span><span class="op" id="8216023">,</span>&nbsp;<span class="ident" id="8216025">nameFoo</span><span class="op" id="8216032">}</span><span class="op" id="8216033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216037">{</span><span class="string" id="8216038">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8216063">,</span>&nbsp;<span class="string" id="8216065">&#34;form-data&#34;</span><span class="op" id="8216076">,</span>&nbsp;<span class="ident" id="8216078">nameFoo</span><span class="op" id="8216085">}</span><span class="op" id="8216086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216090">{</span><span class="string" id="8216091">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8216116">,</span>&nbsp;<span class="string" id="8216118">&#34;form-data&#34;</span><span class="op" id="8216129">,</span>&nbsp;<span class="ident" id="8216131">nameFoo</span><span class="op" id="8216138">}</span><span class="op" id="8216139">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216144">{</span><span class="string" id="8216145">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8216194">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216199">&#34;form-data&#34;</span><span class="op" id="8216210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216215">m</span><span class="op" id="8216216">(</span><span class="string" id="8216217">&#34;key&#34;</span><span class="op" id="8216222">,</span>&nbsp;<span class="string" id="8216224">&#34;value&#34;</span><span class="op" id="8216231">,</span>&nbsp;<span class="string" id="8216233">&#34;blah&#34;</span><span class="op" id="8216239">,</span>&nbsp;<span class="string" id="8216241">&#34;value&#34;</span><span class="op" id="8216248">,</span>&nbsp;<span class="string" id="8216250">&#34;name&#34;</span><span class="op" id="8216256">,</span>&nbsp;<span class="string" id="8216258">&#34;foo&#34;</span><span class="op" id="8216263">)</span><span class="op" id="8216264">}</span><span class="op" id="8216265">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216270">{</span><span class="string" id="8216271">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="8216328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216333">&#34;&#34;</span><span class="op" id="8216335">,</span>&nbsp;<span class="ident" id="8216337">m</span><span class="op" id="8216338">(</span><span class="op" id="8216339">)</span><span class="op" id="8216340">}</span><span class="op" id="8216341">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8216346">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216366">{</span><span class="string" id="8216367">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="8216445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216450">&#34;application/x-stuff&#34;</span><span class="op" id="8216471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216476">m</span><span class="op" id="8216477">(</span><span class="string" id="8216478">&#34;title&#34;</span><span class="op" id="8216485">,</span>&nbsp;<span class="string" id="8216487">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="8216506">)</span><span class="op" id="8216507">}</span><span class="op" id="8216508">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216513">{</span><span class="string" id="8216514">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="8216557">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216562">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="8216580">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216585">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="8216643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216648">&#34;message/external-body&#34;</span><span class="op" id="8216671">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216676">m</span><span class="op" id="8216677">(</span><span class="string" id="8216678">&#34;access-type&#34;</span><span class="op" id="8216691">,</span>&nbsp;<span class="string" id="8216693">&#34;URL&#34;</span><span class="op" id="8216698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216704">&#34;url&#34;</span><span class="op" id="8216709">,</span>&nbsp;<span class="string" id="8216711">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="8216767">)</span><span class="op" id="8216768">}</span><span class="op" id="8216769">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216774">{</span><span class="string" id="8216775">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="8216799">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216804">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="8216856">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216861">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="8216899">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216904">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="8216925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8216930">&#34;application/x-stuff&#34;</span><span class="op" id="8216951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216956">m</span><span class="op" id="8216957">(</span><span class="string" id="8216958">&#34;title&#34;</span><span class="op" id="8216965">,</span>&nbsp;<span class="string" id="8216967">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="8217006">)</span><span class="op" id="8217007">}</span><span class="op" id="8217008">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217013">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217063">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217126">{</span><span class="string" id="8217127">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="8217161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217166">&#34;attachment&#34;</span><span class="op" id="8217178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217183">m</span><span class="op" id="8217184">(</span><span class="string" id="8217185">&#34;filename&#34;</span><span class="op" id="8217195">,</span>&nbsp;<span class="string" id="8217197">&#34;foo.html&#34;</span><span class="op" id="8217207">)</span><span class="op" id="8217208">}</span><span class="op" id="8217209">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217213">{</span><span class="string" id="8217214">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="8217262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217267">&#34;attachment&#34;</span><span class="op" id="8217279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217284">m</span><span class="op" id="8217285">(</span><span class="string" id="8217286">&#34;filename&#34;</span><span class="op" id="8217296">,</span>&nbsp;<span class="string" id="8217298">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="8217321">)</span><span class="op" id="8217322">}</span><span class="op" id="8217323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217327">{</span><span class="string" id="8217328">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="8217377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217382">&#34;attachment&#34;</span><span class="op" id="8217394">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217399">m</span><span class="op" id="8217400">(</span><span class="string" id="8217401">&#34;filename&#34;</span><span class="op" id="8217411">,</span>&nbsp;<span class="string" id="8217413">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="8217439">)</span><span class="op" id="8217440">}</span><span class="op" id="8217441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217445">{</span><span class="string" id="8217446">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="8217490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217495">&#34;attachment&#34;</span><span class="op" id="8217507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217512">m</span><span class="op" id="8217513">(</span><span class="string" id="8217514">&#34;foo&#34;</span><span class="op" id="8217519">,</span>&nbsp;<span class="string" id="8217521">&#34;\&#34;\\&#34;</span><span class="op" id="8217527">,</span>&nbsp;<span class="string" id="8217529">&#34;filename&#34;</span><span class="op" id="8217539">,</span>&nbsp;<span class="string" id="8217541">&#34;foo.html&#34;</span><span class="op" id="8217551">)</span><span class="op" id="8217552">}</span><span class="op" id="8217553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217557">{</span><span class="string" id="8217558">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="8217589">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217594">&#34;attachment&#34;</span><span class="op" id="8217606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217611">m</span><span class="op" id="8217612">(</span><span class="string" id="8217613">&#34;filename&#34;</span><span class="op" id="8217623">,</span>&nbsp;<span class="string" id="8217625">&#34;foo.html&#34;</span><span class="op" id="8217635">)</span><span class="op" id="8217636">}</span><span class="op" id="8217637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217641">{</span><span class="string" id="8217642">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="8217675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217680">&#34;attachment&#34;</span><span class="op" id="8217692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217697">m</span><span class="op" id="8217698">(</span><span class="string" id="8217699">&#34;filename&#34;</span><span class="op" id="8217709">,</span>&nbsp;<span class="string" id="8217711">&#34;foo.html&#34;</span><span class="op" id="8217721">)</span><span class="op" id="8217722">}</span><span class="op" id="8217723">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217727">{</span><span class="string" id="8217728">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="8217761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217766">&#34;attachment&#34;</span><span class="op" id="8217778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217783">m</span><span class="op" id="8217784">(</span><span class="string" id="8217785">&#34;filename&#34;</span><span class="op" id="8217795">,</span>&nbsp;<span class="string" id="8217797">&#34;foo.html&#34;</span><span class="op" id="8217807">)</span><span class="op" id="8217808">}</span><span class="op" id="8217809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217813">{</span><span class="string" id="8217814">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="8217851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217856">&#34;attachment&#34;</span><span class="op" id="8217868">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217873">m</span><span class="op" id="8217874">(</span><span class="string" id="8217875">&#34;filename&#34;</span><span class="op" id="8217885">,</span>&nbsp;<span class="string" id="8217887">&#34;foo-%41.html&#34;</span><span class="op" id="8217901">)</span><span class="op" id="8217902">}</span><span class="op" id="8217903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217907">{</span><span class="string" id="8217908">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="8217946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217951">&#34;attachment&#34;</span><span class="op" id="8217963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217968">m</span><span class="op" id="8217969">(</span><span class="string" id="8217970">&#34;filename&#34;</span><span class="op" id="8217980">,</span>&nbsp;<span class="string" id="8217982">&#34;foo-%41.html&#34;</span><span class="op" id="8217996">)</span><span class="op" id="8217997">}</span><span class="op" id="8217998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218002">{</span><span class="string" id="8218003">`filename=foo.html`</span><span class="op" id="8218022">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218027">&#34;&#34;</span><span class="op" id="8218029">,</span>&nbsp;<span class="ident" id="8218031">m</span><span class="op" id="8218032">(</span><span class="op" id="8218033">)</span><span class="op" id="8218034">}</span><span class="op" id="8218035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218039">{</span><span class="string" id="8218040">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="8218064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218069">&#34;&#34;</span><span class="op" id="8218071">,</span>&nbsp;<span class="ident" id="8218073">m</span><span class="op" id="8218074">(</span><span class="op" id="8218075">)</span><span class="op" id="8218076">}</span><span class="op" id="8218077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218081">{</span><span class="string" id="8218082">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="8218121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218126">&#34;&#34;</span><span class="op" id="8218128">,</span>&nbsp;<span class="ident" id="8218130">m</span><span class="op" id="8218131">(</span><span class="op" id="8218132">)</span><span class="op" id="8218133">}</span><span class="op" id="8218134">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218138">{</span><span class="string" id="8218139">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="8218178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218183">&#34;&#34;</span><span class="op" id="8218185">,</span>&nbsp;<span class="ident" id="8218187">m</span><span class="op" id="8218188">(</span><span class="op" id="8218189">)</span><span class="op" id="8218190">}</span><span class="op" id="8218191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218195">{</span><span class="string" id="8218196">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="8218233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218238">&#34;&#34;</span><span class="op" id="8218240">,</span>&nbsp;<span class="ident" id="8218242">m</span><span class="op" id="8218243">(</span><span class="op" id="8218244">)</span><span class="op" id="8218245">}</span><span class="op" id="8218246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218250">{</span><span class="string" id="8218251">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="8218278">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218283">&#34;&#34;</span><span class="op" id="8218285">,</span>&nbsp;<span class="ident" id="8218287">m</span><span class="op" id="8218288">(</span><span class="op" id="8218289">)</span><span class="op" id="8218290">}</span><span class="op" id="8218291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218295">{</span><span class="string" id="8218296">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="8218357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218362">&#34;attachment&#34;</span><span class="op" id="8218374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218379">m</span><span class="op" id="8218380">(</span><span class="string" id="8218381">&#34;creation-date&#34;</span><span class="op" id="8218396">,</span>&nbsp;<span class="string" id="8218398">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="8218431">)</span><span class="op" id="8218432">}</span><span class="op" id="8218433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218437">{</span><span class="string" id="8218438">`foobar`</span><span class="op" id="8218446">,</span>&nbsp;<span class="string" id="8218448">&#34;foobar&#34;</span><span class="op" id="8218456">,</span>&nbsp;<span class="ident" id="8218458">m</span><span class="op" id="8218459">(</span><span class="op" id="8218460">)</span><span class="op" id="8218461">}</span><span class="op" id="8218462">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218466">{</span><span class="string" id="8218467">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8218514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218519">&#34;attachment&#34;</span><span class="op" id="8218531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218536">m</span><span class="op" id="8218537">(</span><span class="string" id="8218538">&#34;filename&#34;</span><span class="op" id="8218548">,</span>&nbsp;<span class="string" id="8218550">&#34;foo-.html&#34;</span><span class="op" id="8218563">)</span><span class="op" id="8218564">}</span><span class="op" id="8218565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218569">{</span><span class="string" id="8218570">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="8218613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218618">&#34;attachment&#34;</span><span class="op" id="8218630">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218635">m</span><span class="op" id="8218636">(</span><span class="string" id="8218637">&#34;filename&#34;</span><span class="op" id="8218647">,</span>&nbsp;<span class="string" id="8218649">&#34;A-%41.html&#34;</span><span class="op" id="8218661">)</span><span class="op" id="8218662">}</span><span class="op" id="8218663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218667">{</span><span class="string" id="8218668">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="8218718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218723">&#34;attachment&#34;</span><span class="op" id="8218735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218740">m</span><span class="op" id="8218741">(</span><span class="string" id="8218742">&#34;filename&#34;</span><span class="op" id="8218752">,</span>&nbsp;<span class="string" id="8218754">&#34;foo.html&#34;</span><span class="op" id="8218764">)</span><span class="op" id="8218765">}</span><span class="op" id="8218766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218770">{</span><span class="string" id="8218771">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="8218834">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218839">&#34;attachment&#34;</span><span class="op" id="8218851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218856">m</span><span class="op" id="8218857">(</span><span class="string" id="8218858">&#34;filename&#34;</span><span class="op" id="8218868">,</span>&nbsp;<span class="string" id="8218870">&#34;foo-.html&#34;</span><span class="op" id="8218883">)</span><span class="op" id="8218884">}</span><span class="op" id="8218885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218889">{</span><span class="string" id="8218890">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="8218939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218944">&#34;attachment&#34;</span><span class="op" id="8218956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218961">m</span><span class="op" id="8218962">(</span><span class="string" id="8218963">&#34;filename&#34;</span><span class="op" id="8218973">,</span>&nbsp;<span class="string" id="8218975">&#34;foo&#34;</span><span class="op" id="8218980">)</span><span class="op" id="8218981">}</span><span class="op" id="8218982">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218986">{</span><span class="string" id="8218987">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8219035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219040">&#34;attachment&#34;</span><span class="op" id="8219052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219057">m</span><span class="op" id="8219058">(</span><span class="string" id="8219059">&#34;filename&#34;</span><span class="op" id="8219069">,</span>&nbsp;<span class="string" id="8219071">&#34;foo&#34;</span><span class="op" id="8219076">)</span><span class="op" id="8219077">}</span><span class="op" id="8219078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219082">{</span><span class="string" id="8219083">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8219131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219136">&#34;attachment&#34;</span><span class="op" id="8219148">,</span>&nbsp;<span class="ident" id="8219150">m</span><span class="op" id="8219151">(</span><span class="op" id="8219152">)</span><span class="op" id="8219153">}</span><span class="op" id="8219154">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219158">{</span><span class="string" id="8219159">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="8219207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219212">&#34;attachment&#34;</span><span class="op" id="8219224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219229">m</span><span class="op" id="8219230">(</span><span class="string" id="8219231">&#34;filename&#34;</span><span class="op" id="8219241">,</span>&nbsp;<span class="string" id="8219243">&#34;foobar&#34;</span><span class="op" id="8219251">)</span><span class="op" id="8219252">}</span><span class="op" id="8219253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219257">{</span><span class="string" id="8219258">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8219328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219333">&#34;attachment&#34;</span><span class="op" id="8219345">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219350">m</span><span class="op" id="8219351">(</span><span class="string" id="8219352">&#34;filename&#34;</span><span class="op" id="8219362">,</span>&nbsp;<span class="string" id="8219364">&#34;foo-.html&#34;</span><span class="op" id="8219377">)</span><span class="op" id="8219378">}</span><span class="op" id="8219379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219383">{</span><span class="string" id="8219384">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="8219454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219459">&#34;attachment&#34;</span><span class="op" id="8219471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219476">m</span><span class="op" id="8219477">(</span><span class="string" id="8219478">&#34;filename&#34;</span><span class="op" id="8219488">,</span>&nbsp;<span class="string" id="8219490">&#34;foo-.html&#34;</span><span class="op" id="8219503">)</span><span class="op" id="8219504">}</span><span class="op" id="8219505">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8219510">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8219572">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219629">{</span><span class="string" id="8219630">`form-data;&nbsp;firstname=&#34;&#34;;&nbsp;lastname=&#34;&#34;`</span><span class="op" id="8219694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219699">&#34;form-data&#34;</span><span class="op" id="8219710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219715">m</span><span class="op" id="8219716">(</span><span class="string" id="8219717">&#34;firstname&#34;</span><span class="op" id="8219728">,</span>&nbsp;<span class="string" id="8219730">&#34;&#34;</span><span class="op" id="8219740">,</span>&nbsp;<span class="string" id="8219742">&#34;lastname&#34;</span><span class="op" id="8219752">,</span>&nbsp;<span class="string" id="8219754">&#34;&#34;</span><span class="op" id="8219774">)</span><span class="op" id="8219775">}</span><span class="op" id="8219776">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219782">for</span>&nbsp;<span class="ident" id="8219786">_</span><span class="op" id="8219787">,</span>&nbsp;<span class="ident" id="8219789">test</span>&nbsp;<span class="op" id="8219794">:=</span>&nbsp;<span class="keyword" id="8219797">range</span>&nbsp;<span class="ident" id="8219803">tests</span>&nbsp;<span class="op" id="8219809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219813">mt</span><span class="op" id="8219815">,</span>&nbsp;<span class="ident" id="8219817">params</span><span class="op" id="8219823">,</span>&nbsp;<span class="ident" id="8219825">err</span>&nbsp;<span class="op" id="8219829">:=</span>&nbsp;<span class="ident" id="8219832">ParseMediaType</span><span class="op" id="8219846">(</span><span class="ident" id="8219847">test</span><span class="op" id="8219851">.</span><span class="ident" id="8219852">in</span><span class="op" id="8219854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219858">if</span>&nbsp;<span class="ident" id="8219861">err</span>&nbsp;<span class="op" id="8219865">!=</span>&nbsp;<span class="ident" id="8219868">nil</span>&nbsp;<span class="op" id="8219872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219877">if</span>&nbsp;<span class="ident" id="8219880">test</span><span class="op" id="8219884">.</span><span class="ident" id="8219885">t</span>&nbsp;<span class="op" id="8219887">!=</span>&nbsp;<span class="string" id="8219890">&#34;&#34;</span>&nbsp;<span class="op" id="8219893">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219899">t</span><span class="op" id="8219900">.</span><span class="ident" id="8219901">Errorf</span><span class="op" id="8219907">(</span><span class="string" id="8219908">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8219944">,</span>&nbsp;<span class="ident" id="8219946">test</span><span class="op" id="8219950">.</span><span class="ident" id="8219951">in</span><span class="op" id="8219953">,</span>&nbsp;<span class="ident" id="8219955">err</span><span class="op" id="8219958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219964">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219981">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219992">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219996">if</span>&nbsp;<span class="ident" id="8219999">g</span><span class="op" id="8220000">,</span>&nbsp;<span class="ident" id="8220002">e</span>&nbsp;<span class="op" id="8220004">:=</span>&nbsp;<span class="ident" id="8220007">mt</span><span class="op" id="8220009">,</span>&nbsp;<span class="ident" id="8220011">test</span><span class="op" id="8220015">.</span><span class="ident" id="8220016">t</span><span class="op" id="8220017">;</span>&nbsp;<span class="ident" id="8220019">g</span>&nbsp;<span class="op" id="8220021">!=</span>&nbsp;<span class="ident" id="8220024">e</span>&nbsp;<span class="op" id="8220026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220031">t</span><span class="op" id="8220032">.</span><span class="ident" id="8220033">Errorf</span><span class="op" id="8220039">(</span><span class="string" id="8220040">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8220080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220086">test</span><span class="op" id="8220090">.</span><span class="ident" id="8220091">in</span><span class="op" id="8220093">,</span>&nbsp;<span class="ident" id="8220095">e</span><span class="op" id="8220096">,</span>&nbsp;<span class="ident" id="8220098">g</span><span class="op" id="8220099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220104">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220115">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220119">if</span>&nbsp;<span class="builtinfunc" id="8220122">len</span><span class="op" id="8220125">(</span><span class="ident" id="8220126">params</span><span class="op" id="8220132">)</span>&nbsp;<span class="op" id="8220134">==</span>&nbsp;<span class="num" id="8220137">0</span>&nbsp;<span class="op" id="8220139">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8220142">len</span><span class="op" id="8220145">(</span><span class="ident" id="8220146">test</span><span class="op" id="8220150">.</span><span class="ident" id="8220151">p</span><span class="op" id="8220152">)</span>&nbsp;<span class="op" id="8220154">==</span>&nbsp;<span class="num" id="8220157">0</span>&nbsp;<span class="op" id="8220159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220164">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220179">if</span>&nbsp;<span class="op" id="8220182">!</span><span class="ident" id="8220183">reflect</span><span class="op" id="8220190">.</span><span class="ident" id="8220191">DeepEqual</span><span class="op" id="8220200">(</span><span class="ident" id="8220201">params</span><span class="op" id="8220207">,</span>&nbsp;<span class="ident" id="8220209">test</span><span class="op" id="8220213">.</span><span class="ident" id="8220214">p</span><span class="op" id="8220215">)</span>&nbsp;<span class="op" id="8220217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220222">t</span><span class="op" id="8220223">.</span><span class="ident" id="8220224">Errorf</span><span class="op" id="8220230">(</span><span class="string" id="8220231">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="8220262">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8220268">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="8220285">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8220291">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="8220306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220312">test</span><span class="op" id="8220316">.</span><span class="ident" id="8220317">in</span><span class="op" id="8220319">,</span>&nbsp;<span class="ident" id="8220321">test</span><span class="op" id="8220325">.</span><span class="ident" id="8220326">p</span><span class="op" id="8220327">,</span>&nbsp;<span class="ident" id="8220329">params</span><span class="op" id="8220335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220342">}</span><br>
<span class="lineno">245</span><span class="op" id="8220344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8220347">type</span>&nbsp;<span class="ident" id="8220352">badMediaTypeTest</span>&nbsp;<span class="keyword" id="8220369">struct</span>&nbsp;<span class="op" id="8220376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220379">in</span>&nbsp;&nbsp;<span class="builtintype" id="8220383">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220391">err</span>&nbsp;<span class="builtintype" id="8220395">string</span><br>
<span class="lineno">250</span><span class="op" id="8220402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8220405">var</span>&nbsp;<span class="ident" id="8220409">badMediaTypeTests</span>&nbsp;<span class="op" id="8220427">=</span>&nbsp;<span class="op" id="8220429">[</span><span class="op" id="8220430">]</span><span class="ident" id="8220431">badMediaTypeTest</span><span class="op" id="8220447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220450">{</span><span class="string" id="8220451">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="8220469">,</span>&nbsp;<span class="string" id="8220471">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="8220502">}</span><span class="op" id="8220503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220506">{</span><span class="string" id="8220507">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8220537">,</span>&nbsp;<span class="string" id="8220539">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="8220573">}</span><span class="op" id="8220574">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220577">{</span><span class="string" id="8220578">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8220613">,</span>&nbsp;<span class="string" id="8220615">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="8220661">}</span><span class="op" id="8220662">,</span><br>
<span class="lineno"></span><span class="op" id="8220664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8220667">func</span>&nbsp;<span class="ident" id="8220672">TestParseMediaTypeBogus</span><span class="op" id="8220695">(</span><span class="ident" id="8220696">t</span>&nbsp;<span class="op" id="8220698">*</span><span class="ident" id="8220699">testing</span><span class="op" id="8220706">.</span><span class="ident" id="8220707">T</span><span class="op" id="8220708">)</span>&nbsp;<span class="op" id="8220710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220713">for</span>&nbsp;<span class="ident" id="8220717">_</span><span class="op" id="8220718">,</span>&nbsp;<span class="ident" id="8220720">tt</span>&nbsp;<span class="op" id="8220723">:=</span>&nbsp;<span class="keyword" id="8220726">range</span>&nbsp;<span class="ident" id="8220732">badMediaTypeTests</span>&nbsp;<span class="op" id="8220750">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220754">mt</span><span class="op" id="8220756">,</span>&nbsp;<span class="ident" id="8220758">params</span><span class="op" id="8220764">,</span>&nbsp;<span class="ident" id="8220766">err</span>&nbsp;<span class="op" id="8220770">:=</span>&nbsp;<span class="ident" id="8220773">ParseMediaType</span><span class="op" id="8220787">(</span><span class="ident" id="8220788">tt</span><span class="op" id="8220790">.</span><span class="ident" id="8220791">in</span><span class="op" id="8220793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220797">if</span>&nbsp;<span class="ident" id="8220800">err</span>&nbsp;<span class="op" id="8220804">==</span>&nbsp;<span class="ident" id="8220807">nil</span>&nbsp;<span class="op" id="8220811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220816">t</span><span class="op" id="8220817">.</span><span class="ident" id="8220818">Errorf</span><span class="op" id="8220824">(</span><span class="string" id="8220825">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="8220875">,</span>&nbsp;<span class="ident" id="8220877">tt</span><span class="op" id="8220879">.</span><span class="ident" id="8220880">in</span><span class="op" id="8220882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220887">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220898">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220902">if</span>&nbsp;<span class="ident" id="8220905">err</span><span class="op" id="8220908">.</span><span class="ident" id="8220909">Error</span><span class="op" id="8220914">(</span><span class="op" id="8220915">)</span>&nbsp;<span class="op" id="8220917">!=</span>&nbsp;<span class="ident" id="8220920">tt</span><span class="op" id="8220922">.</span><span class="ident" id="8220923">err</span>&nbsp;<span class="op" id="8220927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220932">t</span><span class="op" id="8220933">.</span><span class="ident" id="8220934">Errorf</span><span class="op" id="8220940">(</span><span class="string" id="8220941">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8220979">,</span>&nbsp;<span class="ident" id="8220981">tt</span><span class="op" id="8220983">.</span><span class="ident" id="8220984">in</span><span class="op" id="8220986">,</span>&nbsp;<span class="ident" id="8220988">err</span><span class="op" id="8220991">.</span><span class="ident" id="8220992">Error</span><span class="op" id="8220997">(</span><span class="op" id="8220998">)</span><span class="op" id="8220999">,</span>&nbsp;<span class="ident" id="8221001">tt</span><span class="op" id="8221003">.</span><span class="ident" id="8221004">err</span><span class="op" id="8221007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8221015">if</span>&nbsp;<span class="ident" id="8221018">params</span>&nbsp;<span class="op" id="8221025">!=</span>&nbsp;<span class="ident" id="8221028">nil</span>&nbsp;<span class="op" id="8221032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221037">t</span><span class="op" id="8221038">.</span><span class="ident" id="8221039">Errorf</span><span class="op" id="8221045">(</span><span class="string" id="8221046">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="8221095">,</span>&nbsp;<span class="ident" id="8221097">tt</span><span class="op" id="8221099">.</span><span class="ident" id="8221100">in</span><span class="op" id="8221102">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8221110">if</span>&nbsp;<span class="ident" id="8221113">mt</span>&nbsp;<span class="op" id="8221116">!=</span>&nbsp;<span class="string" id="8221119">&#34;&#34;</span>&nbsp;<span class="op" id="8221122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221127">t</span><span class="op" id="8221128">.</span><span class="ident" id="8221129">Errorf</span><span class="op" id="8221135">(</span><span class="string" id="8221136">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="8221198">,</span>&nbsp;<span class="ident" id="8221200">tt</span><span class="op" id="8221202">.</span><span class="ident" id="8221203">in</span><span class="op" id="8221205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221212">}</span><br>
<span class="lineno">275</span><span class="op" id="8221214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8221217">type</span>&nbsp;<span class="ident" id="8221222">formatTest</span>&nbsp;<span class="keyword" id="8221233">struct</span>&nbsp;<span class="op" id="8221240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221243">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8221250">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221258">params</span>&nbsp;<span class="keyword" id="8221265">map</span><span class="op" id="8221268">[</span><span class="builtintype" id="8221269">string</span><span class="op" id="8221275">]</span><span class="builtintype" id="8221276">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221284">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8221291">string</span><br>
<span class="lineno"></span><span class="op" id="8221298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8221301">var</span>&nbsp;<span class="ident" id="8221305">formatTests</span>&nbsp;<span class="op" id="8221317">=</span>&nbsp;<span class="op" id="8221319">[</span><span class="op" id="8221320">]</span><span class="ident" id="8221321">formatTest</span><span class="op" id="8221331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221334">{</span><span class="string" id="8221335">&#34;noslash&#34;</span><span class="op" id="8221344">,</span>&nbsp;<span class="ident" id="8221346">nil</span><span class="op" id="8221349">,</span>&nbsp;<span class="string" id="8221351">&#34;&#34;</span><span class="op" id="8221353">}</span><span class="op" id="8221354">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221357">{</span><span class="string" id="8221358">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="8221371">,</span>&nbsp;<span class="ident" id="8221373">nil</span><span class="op" id="8221376">,</span>&nbsp;<span class="string" id="8221378">&#34;&#34;</span><span class="op" id="8221380">}</span><span class="op" id="8221381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221384">{</span><span class="string" id="8221385">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="8221398">,</span>&nbsp;<span class="ident" id="8221400">nil</span><span class="op" id="8221403">,</span>&nbsp;<span class="string" id="8221405">&#34;&#34;</span><span class="op" id="8221407">}</span><span class="op" id="8221408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221411">{</span><span class="string" id="8221412">&#34;foo/BAR&#34;</span><span class="op" id="8221421">,</span>&nbsp;<span class="ident" id="8221423">nil</span><span class="op" id="8221426">,</span>&nbsp;<span class="string" id="8221428">&#34;foo/bar&#34;</span><span class="op" id="8221437">}</span><span class="op" id="8221438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221441">{</span><span class="string" id="8221442">&#34;foo/BAR&#34;</span><span class="op" id="8221451">,</span>&nbsp;<span class="keyword" id="8221453">map</span><span class="op" id="8221456">[</span><span class="builtintype" id="8221457">string</span><span class="op" id="8221463">]</span><span class="builtintype" id="8221464">string</span><span class="op" id="8221470">{</span><span class="string" id="8221471">&#34;X&#34;</span><span class="op" id="8221474">:</span>&nbsp;<span class="string" id="8221476">&#34;Y&#34;</span><span class="op" id="8221479">}</span><span class="op" id="8221480">,</span>&nbsp;<span class="string" id="8221482">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="8221496">}</span><span class="op" id="8221497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221500">{</span><span class="string" id="8221501">&#34;foo/BAR&#34;</span><span class="op" id="8221510">,</span>&nbsp;<span class="keyword" id="8221512">map</span><span class="op" id="8221515">[</span><span class="builtintype" id="8221516">string</span><span class="op" id="8221522">]</span><span class="builtintype" id="8221523">string</span><span class="op" id="8221529">{</span><span class="string" id="8221530">&#34;space&#34;</span><span class="op" id="8221537">:</span>&nbsp;<span class="string" id="8221539">&#34;With&nbsp;space&#34;</span><span class="op" id="8221551">}</span><span class="op" id="8221552">,</span>&nbsp;<span class="string" id="8221554">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="8221583">}</span><span class="op" id="8221584">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221587">{</span><span class="string" id="8221588">&#34;foo/BAR&#34;</span><span class="op" id="8221597">,</span>&nbsp;<span class="keyword" id="8221599">map</span><span class="op" id="8221602">[</span><span class="builtintype" id="8221603">string</span><span class="op" id="8221609">]</span><span class="builtintype" id="8221610">string</span><span class="op" id="8221616">{</span><span class="string" id="8221617">&#34;quote&#34;</span><span class="op" id="8221624">:</span>&nbsp;<span class="string" id="8221626">`With&nbsp;&#34;quote`</span><span class="op" id="8221639">}</span><span class="op" id="8221640">,</span>&nbsp;<span class="string" id="8221642">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="8221673">}</span><span class="op" id="8221674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221677">{</span><span class="string" id="8221678">&#34;foo/BAR&#34;</span><span class="op" id="8221687">,</span>&nbsp;<span class="keyword" id="8221689">map</span><span class="op" id="8221692">[</span><span class="builtintype" id="8221693">string</span><span class="op" id="8221699">]</span><span class="builtintype" id="8221700">string</span><span class="op" id="8221706">{</span><span class="string" id="8221707">&#34;bslash&#34;</span><span class="op" id="8221715">:</span>&nbsp;<span class="string" id="8221717">`With&nbsp;\backslash`</span><span class="op" id="8221734">}</span><span class="op" id="8221735">,</span>&nbsp;<span class="string" id="8221737">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="8221773">}</span><span class="op" id="8221774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221777">{</span><span class="string" id="8221778">&#34;foo/BAR&#34;</span><span class="op" id="8221787">,</span>&nbsp;<span class="keyword" id="8221789">map</span><span class="op" id="8221792">[</span><span class="builtintype" id="8221793">string</span><span class="op" id="8221799">]</span><span class="builtintype" id="8221800">string</span><span class="op" id="8221806">{</span><span class="string" id="8221807">&#34;both&#34;</span><span class="op" id="8221813">:</span>&nbsp;<span class="string" id="8221815">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="8221843">}</span><span class="op" id="8221844">,</span>&nbsp;<span class="string" id="8221846">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="8221892">}</span><span class="op" id="8221893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221896">{</span><span class="string" id="8221897">&#34;foo/BAR&#34;</span><span class="op" id="8221906">,</span>&nbsp;<span class="keyword" id="8221908">map</span><span class="op" id="8221911">[</span><span class="builtintype" id="8221912">string</span><span class="op" id="8221918">]</span><span class="builtintype" id="8221919">string</span><span class="op" id="8221925">{</span><span class="string" id="8221926">&#34;&#34;</span><span class="op" id="8221928">:</span>&nbsp;<span class="string" id="8221930">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="8221947">}</span><span class="op" id="8221948">,</span>&nbsp;<span class="string" id="8221950">&#34;&#34;</span><span class="op" id="8221952">}</span><span class="op" id="8221953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221956">{</span><span class="string" id="8221957">&#34;foo/BAR&#34;</span><span class="op" id="8221966">,</span>&nbsp;<span class="keyword" id="8221968">map</span><span class="op" id="8221971">[</span><span class="builtintype" id="8221972">string</span><span class="op" id="8221978">]</span><span class="builtintype" id="8221979">string</span><span class="op" id="8221985">{</span><span class="string" id="8221986">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="8222001">:</span>&nbsp;<span class="string" id="8222003">&#34;baz&#34;</span><span class="op" id="8222008">}</span><span class="op" id="8222009">,</span>&nbsp;<span class="string" id="8222011">&#34;&#34;</span><span class="op" id="8222013">}</span><span class="op" id="8222014">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222017">{</span><span class="string" id="8222018">&#34;foo/BAR&#34;</span><span class="op" id="8222027">,</span>&nbsp;<span class="keyword" id="8222029">map</span><span class="op" id="8222032">[</span><span class="builtintype" id="8222033">string</span><span class="op" id="8222039">]</span><span class="builtintype" id="8222040">string</span><span class="op" id="8222046">{</span><span class="string" id="8222047">&#34;nonascii&#34;</span><span class="op" id="8222057">:</span>&nbsp;<span class="string" id="8222059">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;&#34;</span><span class="op" id="8222087">}</span><span class="op" id="8222088">,</span>&nbsp;<span class="string" id="8222090">&#34;&#34;</span><span class="op" id="8222092">}</span><span class="op" id="8222093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222096">{</span><span class="string" id="8222097">&#34;foo/bar&#34;</span><span class="op" id="8222106">,</span>&nbsp;<span class="keyword" id="8222108">map</span><span class="op" id="8222111">[</span><span class="builtintype" id="8222112">string</span><span class="op" id="8222118">]</span><span class="builtintype" id="8222119">string</span><span class="op" id="8222125">{</span><span class="string" id="8222126">&#34;a&#34;</span><span class="op" id="8222129">:</span>&nbsp;<span class="string" id="8222131">&#34;av&#34;</span><span class="op" id="8222135">,</span>&nbsp;<span class="string" id="8222137">&#34;b&#34;</span><span class="op" id="8222140">:</span>&nbsp;<span class="string" id="8222142">&#34;bv&#34;</span><span class="op" id="8222146">,</span>&nbsp;<span class="string" id="8222148">&#34;c&#34;</span><span class="op" id="8222151">:</span>&nbsp;<span class="string" id="8222153">&#34;cv&#34;</span><span class="op" id="8222157">}</span><span class="op" id="8222158">,</span>&nbsp;<span class="string" id="8222160">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="8222187">}</span><span class="op" id="8222188">,</span><br>
<span class="lineno"></span><span class="op" id="8222190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8222193">func</span>&nbsp;<span class="ident" id="8222198">TestFormatMediaType</span><span class="op" id="8222217">(</span><span class="ident" id="8222218">t</span>&nbsp;<span class="op" id="8222220">*</span><span class="ident" id="8222221">testing</span><span class="op" id="8222228">.</span><span class="ident" id="8222229">T</span><span class="op" id="8222230">)</span>&nbsp;<span class="op" id="8222232">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222235">for</span>&nbsp;<span class="ident" id="8222239">i</span><span class="op" id="8222240">,</span>&nbsp;<span class="ident" id="8222242">tt</span>&nbsp;<span class="op" id="8222245">:=</span>&nbsp;<span class="keyword" id="8222248">range</span>&nbsp;<span class="ident" id="8222254">formatTests</span>&nbsp;<span class="op" id="8222266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222270">got</span>&nbsp;<span class="op" id="8222274">:=</span>&nbsp;<span class="ident" id="8222277">FormatMediaType</span><span class="op" id="8222292">(</span><span class="ident" id="8222293">tt</span><span class="op" id="8222295">.</span><span class="ident" id="8222296">typ</span><span class="op" id="8222299">,</span>&nbsp;<span class="ident" id="8222301">tt</span><span class="op" id="8222303">.</span><span class="ident" id="8222304">params</span><span class="op" id="8222310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222314">if</span>&nbsp;<span class="ident" id="8222317">got</span>&nbsp;<span class="op" id="8222321">!=</span>&nbsp;<span class="ident" id="8222324">tt</span><span class="op" id="8222326">.</span><span class="ident" id="8222327">want</span>&nbsp;<span class="op" id="8222332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222337">t</span><span class="op" id="8222338">.</span><span class="ident" id="8222339">Errorf</span><span class="op" id="8222345">(</span><span class="string" id="8222346">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8222389">,</span>&nbsp;<span class="ident" id="8222391">i</span><span class="op" id="8222392">,</span>&nbsp;<span class="ident" id="8222394">tt</span><span class="op" id="8222396">.</span><span class="ident" id="8222397">typ</span><span class="op" id="8222400">,</span>&nbsp;<span class="ident" id="8222402">tt</span><span class="op" id="8222404">.</span><span class="ident" id="8222405">params</span><span class="op" id="8222411">,</span>&nbsp;<span class="ident" id="8222413">got</span><span class="op" id="8222416">,</span>&nbsp;<span class="ident" id="8222418">tt</span><span class="op" id="8222420">.</span><span class="ident" id="8222421">want</span><span class="op" id="8222425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222429">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222432">}</span><br>
<span class="lineno"></span><span class="op" id="8222434">}</span>
</div>
</body>
</html>
