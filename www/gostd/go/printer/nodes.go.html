<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5962114">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5962169">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5962223">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5962274">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="5962334">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5962395">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5962450">package</span>&nbsp;<span class="ident" id="5962458">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5962467">import</span>&nbsp;<span class="op" id="5962474">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5962477">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5962486">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5962496">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5962508">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5962523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5962526">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="5962548">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="5962643">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5962738">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="5962758">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="5962794">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5962873">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5962949">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5963029">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5963051">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="5963128">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="5963206">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5963282">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5963334">//</span><br>
<span class="lineno"></span><span class="comment" id="5963337">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="5963416">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="5963491">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="5963569">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5963647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5963726">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="5963801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5963872">//</span><br>
<span class="lineno"></span><span class="keyword" id="5963875">func</span>&nbsp;<span class="op" id="5963880">(</span><span class="ident" id="5963881">p</span>&nbsp;<span class="op" id="5963883">*</span><span class="ident" id="5963884">printer</span><span class="op" id="5963891">)</span>&nbsp;<span class="ident" id="5963893">linebreak</span><span class="op" id="5963902">(</span><span class="ident" id="5963903">line</span><span class="op" id="5963907">,</span>&nbsp;<span class="ident" id="5963909">min</span>&nbsp;<span class="builtintype" id="5963913">int</span><span class="op" id="5963916">,</span>&nbsp;<span class="ident" id="5963918">ws</span>&nbsp;<span class="ident" id="5963921">whiteSpace</span><span class="op" id="5963931">,</span>&nbsp;<span class="ident" id="5963933">newSection</span>&nbsp;<span class="builtintype" id="5963944">bool</span><span class="op" id="5963948">)</span>&nbsp;<span class="op" id="5963950">(</span><span class="ident" id="5963951">printedBreak</span>&nbsp;<span class="builtintype" id="5963964">bool</span><span class="op" id="5963968">)</span>&nbsp;<span class="op" id="5963970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5963973">n</span>&nbsp;<span class="op" id="5963975">:=</span>&nbsp;<span class="ident" id="5963978">nlimit</span><span class="op" id="5963984">(</span><span class="ident" id="5963985">line</span>&nbsp;<span class="op" id="5963990">-</span>&nbsp;<span class="ident" id="5963992">p</span><span class="op" id="5963993">.</span><span class="ident" id="5963994">pos</span><span class="op" id="5963997">.</span><span class="ident" id="5963998">Line</span><span class="op" id="5964002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964005">if</span>&nbsp;<span class="ident" id="5964008">n</span>&nbsp;<span class="op" id="5964010">&lt;</span>&nbsp;<span class="ident" id="5964012">min</span>&nbsp;<span class="op" id="5964016">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964020">n</span>&nbsp;<span class="op" id="5964022">=</span>&nbsp;<span class="ident" id="5964024">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5964029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964032">if</span>&nbsp;<span class="ident" id="5964035">n</span>&nbsp;<span class="op" id="5964037">&gt;</span>&nbsp;<span class="num" id="5964039">0</span>&nbsp;<span class="op" id="5964041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964045">p</span><span class="op" id="5964046">.</span><span class="builtinfunc" id="5964047">print</span><span class="op" id="5964052">(</span><span class="ident" id="5964053">ws</span><span class="op" id="5964055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964059">if</span>&nbsp;<span class="ident" id="5964062">newSection</span>&nbsp;<span class="op" id="5964073">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964078">p</span><span class="op" id="5964079">.</span><span class="builtinfunc" id="5964080">print</span><span class="op" id="5964085">(</span><span class="ident" id="5964086">formfeed</span><span class="op" id="5964094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964099">n</span><span class="op" id="5964100">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5964105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964109">for</span>&nbsp;<span class="op" id="5964113">;</span>&nbsp;<span class="ident" id="5964115">n</span>&nbsp;<span class="op" id="5964117">&gt;</span>&nbsp;<span class="num" id="5964119">0</span><span class="op" id="5964120">;</span>&nbsp;<span class="ident" id="5964122">n</span><span class="op" id="5964123">--</span>&nbsp;<span class="op" id="5964126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964131">p</span><span class="op" id="5964132">.</span><span class="builtinfunc" id="5964133">print</span><span class="op" id="5964138">(</span><span class="ident" id="5964139">newline</span><span class="op" id="5964146">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5964150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964154">printedBreak</span>&nbsp;<span class="op" id="5964167">=</span>&nbsp;<span class="builtintype" id="5964169">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5964175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964178">return</span><br>
<span class="lineno"></span><span class="op" id="5964185">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5964188">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="5964262">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5964338">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="5964416">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="5964475">func</span>&nbsp;<span class="op" id="5964480">(</span><span class="ident" id="5964481">p</span>&nbsp;<span class="op" id="5964483">*</span><span class="ident" id="5964484">printer</span><span class="op" id="5964491">)</span>&nbsp;<span class="ident" id="5964493">setComment</span><span class="op" id="5964503">(</span><span class="ident" id="5964504">g</span>&nbsp;<span class="op" id="5964506">*</span><span class="ident" id="5964507">ast</span><span class="op" id="5964510">.</span><span class="ident" id="5964511">CommentGroup</span><span class="op" id="5964523">)</span>&nbsp;<span class="op" id="5964525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964528">if</span>&nbsp;<span class="ident" id="5964531">g</span>&nbsp;<span class="op" id="5964533">==</span>&nbsp;<span class="ident" id="5964536">nil</span>&nbsp;<span class="op" id="5964540">||</span>&nbsp;<span class="op" id="5964543">!</span><span class="ident" id="5964544">p</span><span class="op" id="5964545">.</span><span class="ident" id="5964546">useNodeComments</span>&nbsp;<span class="op" id="5964562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964566">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5964574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5964577">if</span>&nbsp;<span class="ident" id="5964580">p</span><span class="op" id="5964581">.</span><span class="ident" id="5964582">comments</span>&nbsp;<span class="op" id="5964591">==</span>&nbsp;<span class="ident" id="5964594">nil</span>&nbsp;<span class="op" id="5964598">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5964602">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964636">p</span><span class="op" id="5964637">.</span><span class="ident" id="5964638">comments</span>&nbsp;<span class="op" id="5964647">=</span>&nbsp;<span class="builtinfunc" id="5964649">make</span><span class="op" id="5964653">(</span><span class="op" id="5964654">[</span><span class="op" id="5964655">]</span><span class="op" id="5964656">*</span><span class="ident" id="5964657">ast</span><span class="op" id="5964660">.</span><span class="ident" id="5964661">CommentGroup</span><span class="op" id="5964673">,</span>&nbsp;<span class="num" id="5964675">1</span><span class="op" id="5964676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5964679">}</span>&nbsp;<span class="keyword" id="5964681">else</span>&nbsp;<span class="keyword" id="5964686">if</span>&nbsp;<span class="ident" id="5964689">p</span><span class="op" id="5964690">.</span><span class="ident" id="5964691">cindex</span>&nbsp;<span class="op" id="5964698">&lt;</span>&nbsp;<span class="builtinfunc" id="5964700">len</span><span class="op" id="5964703">(</span><span class="ident" id="5964704">p</span><span class="op" id="5964705">.</span><span class="ident" id="5964706">comments</span><span class="op" id="5964714">)</span>&nbsp;<span class="op" id="5964716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5964720">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5964774">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5964829">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964883">p</span><span class="op" id="5964884">.</span><span class="ident" id="5964885">flush</span><span class="op" id="5964890">(</span><span class="ident" id="5964891">p</span><span class="op" id="5964892">.</span><span class="ident" id="5964893">posFor</span><span class="op" id="5964899">(</span><span class="ident" id="5964900">g</span><span class="op" id="5964901">.</span><span class="ident" id="5964902">List</span><span class="op" id="5964906">[</span><span class="num" id="5964907">0</span><span class="op" id="5964908">]</span><span class="op" id="5964909">.</span><span class="ident" id="5964910">Pos</span><span class="op" id="5964913">(</span><span class="op" id="5964914">)</span><span class="op" id="5964915">)</span><span class="op" id="5964916">,</span>&nbsp;<span class="ident" id="5964918">token</span><span class="op" id="5964923">.</span><span class="ident" id="5964924">ILLEGAL</span><span class="op" id="5964931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964935">p</span><span class="op" id="5964936">.</span><span class="ident" id="5964937">comments</span>&nbsp;<span class="op" id="5964946">=</span>&nbsp;<span class="ident" id="5964948">p</span><span class="op" id="5964949">.</span><span class="ident" id="5964950">comments</span><span class="op" id="5964958">[</span><span class="num" id="5964959">0</span><span class="op" id="5964960">:</span><span class="num" id="5964961">1</span><span class="op" id="5964962">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5964966">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5964999">p</span><span class="op" id="5965000">.</span><span class="ident" id="5965001">internalError</span><span class="op" id="5965014">(</span><span class="string" id="5965015">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="5965050">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5965053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965056">p</span><span class="op" id="5965057">.</span><span class="ident" id="5965058">comments</span><span class="op" id="5965066">[</span><span class="num" id="5965067">0</span><span class="op" id="5965068">]</span>&nbsp;<span class="op" id="5965070">=</span>&nbsp;<span class="ident" id="5965072">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965075">p</span><span class="op" id="5965076">.</span><span class="ident" id="5965077">cindex</span>&nbsp;<span class="op" id="5965084">=</span>&nbsp;<span class="num" id="5965086">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5965089">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5965152">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5965211">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5965268">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5965288">if</span>&nbsp;<span class="ident" id="5965291">p</span><span class="op" id="5965292">.</span><span class="ident" id="5965293">commentOffset</span>&nbsp;<span class="op" id="5965307">==</span>&nbsp;<span class="ident" id="5965310">infinity</span>&nbsp;<span class="op" id="5965319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965323">p</span><span class="op" id="5965324">.</span><span class="ident" id="5965325">nextComment</span><span class="op" id="5965336">(</span><span class="op" id="5965337">)</span>&nbsp;<span class="comment" id="5965339">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5965369">}</span><br>
<span class="lineno">90</span><span class="op" id="5965371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5965374">type</span>&nbsp;<span class="ident" id="5965379">exprListMode</span>&nbsp;<span class="builtintype" id="5965392">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5965398">const</span>&nbsp;<span class="op" id="5965404">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965407">commaTerm</span>&nbsp;<span class="ident" id="5965417">exprListMode</span>&nbsp;<span class="op" id="5965430">=</span>&nbsp;<span class="num" id="5965432">1</span>&nbsp;<span class="op" id="5965434">&lt;&lt;</span>&nbsp;<span class="ident" id="5965437">iota</span>&nbsp;<span class="comment" id="5965442">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965487">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5965522">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="5965566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5965569">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="5965641">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="5965673">func</span>&nbsp;<span class="op" id="5965678">(</span><span class="ident" id="5965679">p</span>&nbsp;<span class="op" id="5965681">*</span><span class="ident" id="5965682">printer</span><span class="op" id="5965689">)</span>&nbsp;<span class="ident" id="5965691">identList</span><span class="op" id="5965700">(</span><span class="ident" id="5965701">list</span>&nbsp;<span class="op" id="5965706">[</span><span class="op" id="5965707">]</span><span class="op" id="5965708">*</span><span class="ident" id="5965709">ast</span><span class="op" id="5965712">.</span><span class="ident" id="5965713">Ident</span><span class="op" id="5965718">,</span>&nbsp;<span class="ident" id="5965720">indent</span>&nbsp;<span class="builtintype" id="5965727">bool</span><span class="op" id="5965731">)</span>&nbsp;<span class="op" id="5965733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5965736">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965809">xlist</span>&nbsp;<span class="op" id="5965815">:=</span>&nbsp;<span class="builtinfunc" id="5965818">make</span><span class="op" id="5965822">(</span><span class="op" id="5965823">[</span><span class="op" id="5965824">]</span><span class="ident" id="5965825">ast</span><span class="op" id="5965828">.</span><span class="ident" id="5965829">Expr</span><span class="op" id="5965833">,</span>&nbsp;<span class="builtinfunc" id="5965835">len</span><span class="op" id="5965838">(</span><span class="ident" id="5965839">list</span><span class="op" id="5965843">)</span><span class="op" id="5965844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5965847">for</span>&nbsp;<span class="ident" id="5965851">i</span><span class="op" id="5965852">,</span>&nbsp;<span class="ident" id="5965854">x</span>&nbsp;<span class="op" id="5965856">:=</span>&nbsp;<span class="keyword" id="5965859">range</span>&nbsp;<span class="ident" id="5965865">list</span>&nbsp;<span class="op" id="5965870">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965874">xlist</span><span class="op" id="5965879">[</span><span class="ident" id="5965880">i</span><span class="op" id="5965881">]</span>&nbsp;<span class="op" id="5965883">=</span>&nbsp;<span class="ident" id="5965885">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5965888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5965891">var</span>&nbsp;<span class="ident" id="5965895">mode</span>&nbsp;<span class="ident" id="5965900">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5965914">if</span>&nbsp;<span class="op" id="5965917">!</span><span class="ident" id="5965918">indent</span>&nbsp;<span class="op" id="5965925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965929">mode</span>&nbsp;<span class="op" id="5965934">=</span>&nbsp;<span class="ident" id="5965936">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5965946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5965949">p</span><span class="op" id="5965950">.</span><span class="ident" id="5965951">exprList</span><span class="op" id="5965959">(</span><span class="ident" id="5965960">token</span><span class="op" id="5965965">.</span><span class="ident" id="5965966">NoPos</span><span class="op" id="5965971">,</span>&nbsp;<span class="ident" id="5965973">xlist</span><span class="op" id="5965978">,</span>&nbsp;<span class="num" id="5965980">1</span><span class="op" id="5965981">,</span>&nbsp;<span class="ident" id="5965983">mode</span><span class="op" id="5965987">,</span>&nbsp;<span class="ident" id="5965989">token</span><span class="op" id="5965994">.</span><span class="ident" id="5965995">NoPos</span><span class="op" id="5966000">)</span><br>
<span class="lineno"></span><span class="op" id="5966002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5966005">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="5966064">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="5966128">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="5966144">//</span><br>
<span class="lineno"></span><span class="comment" id="5966147">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="5966216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="5966283">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="5966349">func</span>&nbsp;<span class="op" id="5966354">(</span><span class="ident" id="5966355">p</span>&nbsp;<span class="op" id="5966357">*</span><span class="ident" id="5966358">printer</span><span class="op" id="5966365">)</span>&nbsp;<span class="ident" id="5966367">exprList</span><span class="op" id="5966375">(</span><span class="ident" id="5966376">prev0</span>&nbsp;<span class="ident" id="5966382">token</span><span class="op" id="5966387">.</span><span class="ident" id="5966388">Pos</span><span class="op" id="5966391">,</span>&nbsp;<span class="ident" id="5966393">list</span>&nbsp;<span class="op" id="5966398">[</span><span class="op" id="5966399">]</span><span class="ident" id="5966400">ast</span><span class="op" id="5966403">.</span><span class="ident" id="5966404">Expr</span><span class="op" id="5966408">,</span>&nbsp;<span class="ident" id="5966410">depth</span>&nbsp;<span class="builtintype" id="5966416">int</span><span class="op" id="5966419">,</span>&nbsp;<span class="ident" id="5966421">mode</span>&nbsp;<span class="ident" id="5966426">exprListMode</span><span class="op" id="5966438">,</span>&nbsp;<span class="ident" id="5966440">next0</span>&nbsp;<span class="ident" id="5966446">token</span><span class="op" id="5966451">.</span><span class="ident" id="5966452">Pos</span><span class="op" id="5966455">)</span>&nbsp;<span class="op" id="5966457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5966460">if</span>&nbsp;<span class="builtinfunc" id="5966463">len</span><span class="op" id="5966466">(</span><span class="ident" id="5966467">list</span><span class="op" id="5966471">)</span>&nbsp;<span class="op" id="5966473">==</span>&nbsp;<span class="num" id="5966476">0</span>&nbsp;<span class="op" id="5966478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5966482">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5966490">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5966494">prev</span>&nbsp;<span class="op" id="5966499">:=</span>&nbsp;<span class="ident" id="5966502">p</span><span class="op" id="5966503">.</span><span class="ident" id="5966504">posFor</span><span class="op" id="5966510">(</span><span class="ident" id="5966511">prev0</span><span class="op" id="5966516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5966519">next</span>&nbsp;<span class="op" id="5966524">:=</span>&nbsp;<span class="ident" id="5966527">p</span><span class="op" id="5966528">.</span><span class="ident" id="5966529">posFor</span><span class="op" id="5966535">(</span><span class="ident" id="5966536">next0</span><span class="op" id="5966541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5966544">line</span>&nbsp;<span class="op" id="5966549">:=</span>&nbsp;<span class="ident" id="5966552">p</span><span class="op" id="5966553">.</span><span class="ident" id="5966554">lineFor</span><span class="op" id="5966561">(</span><span class="ident" id="5966562">list</span><span class="op" id="5966566">[</span><span class="num" id="5966567">0</span><span class="op" id="5966568">]</span><span class="op" id="5966569">.</span><span class="ident" id="5966570">Pos</span><span class="op" id="5966573">(</span><span class="op" id="5966574">)</span><span class="op" id="5966575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5966578">endLine</span>&nbsp;<span class="op" id="5966586">:=</span>&nbsp;<span class="ident" id="5966589">p</span><span class="op" id="5966590">.</span><span class="ident" id="5966591">lineFor</span><span class="op" id="5966598">(</span><span class="ident" id="5966599">list</span><span class="op" id="5966603">[</span><span class="builtinfunc" id="5966604">len</span><span class="op" id="5966607">(</span><span class="ident" id="5966608">list</span><span class="op" id="5966612">)</span><span class="op" id="5966613">-</span><span class="num" id="5966614">1</span><span class="op" id="5966615">]</span><span class="op" id="5966616">.</span><span class="ident" id="5966617">End</span><span class="op" id="5966620">(</span><span class="op" id="5966621">)</span><span class="op" id="5966622">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5966626">if</span>&nbsp;<span class="ident" id="5966629">prev</span><span class="op" id="5966633">.</span><span class="ident" id="5966634">IsValid</span><span class="op" id="5966641">(</span><span class="op" id="5966642">)</span>&nbsp;<span class="op" id="5966644">&amp;&amp;</span>&nbsp;<span class="ident" id="5966647">prev</span><span class="op" id="5966651">.</span><span class="ident" id="5966652">Line</span>&nbsp;<span class="op" id="5966657">==</span>&nbsp;<span class="ident" id="5966660">line</span>&nbsp;<span class="op" id="5966665">&amp;&amp;</span>&nbsp;<span class="ident" id="5966668">line</span>&nbsp;<span class="op" id="5966673">==</span>&nbsp;<span class="ident" id="5966676">endLine</span>&nbsp;<span class="op" id="5966684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5966688">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5966727">for</span>&nbsp;<span class="ident" id="5966731">i</span><span class="op" id="5966732">,</span>&nbsp;<span class="ident" id="5966734">x</span>&nbsp;<span class="op" id="5966736">:=</span>&nbsp;<span class="keyword" id="5966739">range</span>&nbsp;<span class="ident" id="5966745">list</span>&nbsp;<span class="op" id="5966750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5966755">if</span>&nbsp;<span class="ident" id="5966758">i</span>&nbsp;<span class="op" id="5966760">&gt;</span>&nbsp;<span class="num" id="5966762">0</span>&nbsp;<span class="op" id="5966764">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5966770">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5966827">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5966879">p</span><span class="op" id="5966880">.</span><span class="builtinfunc" id="5966881">print</span><span class="op" id="5966886">(</span><span class="ident" id="5966887">x</span><span class="op" id="5966888">.</span><span class="ident" id="5966889">Pos</span><span class="op" id="5966892">(</span><span class="op" id="5966893">)</span><span class="op" id="5966894">,</span>&nbsp;<span class="ident" id="5966896">token</span><span class="op" id="5966901">.</span><span class="ident" id="5966902">COMMA</span><span class="op" id="5966907">,</span>&nbsp;<span class="ident" id="5966909">blank</span><span class="op" id="5966914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5966919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5966924">p</span><span class="op" id="5966925">.</span><span class="ident" id="5966926">expr0</span><span class="op" id="5966931">(</span><span class="ident" id="5966932">x</span><span class="op" id="5966933">,</span>&nbsp;<span class="ident" id="5966935">depth</span><span class="op" id="5966940">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5966944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5966948">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5966956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5966960">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5966998">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967050">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967102">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967160">ws</span>&nbsp;<span class="op" id="5967163">:=</span>&nbsp;<span class="ident" id="5967166">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5967174">if</span>&nbsp;<span class="ident" id="5967177">mode</span><span class="op" id="5967181">&amp;</span><span class="ident" id="5967182">noIndent</span>&nbsp;<span class="op" id="5967191">==</span>&nbsp;<span class="num" id="5967194">0</span>&nbsp;<span class="op" id="5967196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967200">ws</span>&nbsp;<span class="op" id="5967203">=</span>&nbsp;<span class="ident" id="5967205">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5967213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967217">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967290">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967328">prevBreak</span>&nbsp;<span class="op" id="5967338">:=</span>&nbsp;<span class="op" id="5967341">-</span><span class="num" id="5967342">1</span>&nbsp;<span class="comment" id="5967344">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5967406">if</span>&nbsp;<span class="ident" id="5967409">prev</span><span class="op" id="5967413">.</span><span class="ident" id="5967414">IsValid</span><span class="op" id="5967421">(</span><span class="op" id="5967422">)</span>&nbsp;<span class="op" id="5967424">&amp;&amp;</span>&nbsp;<span class="ident" id="5967427">prev</span><span class="op" id="5967431">.</span><span class="ident" id="5967432">Line</span>&nbsp;<span class="op" id="5967437">&lt;</span>&nbsp;<span class="ident" id="5967439">line</span>&nbsp;<span class="op" id="5967444">&amp;&amp;</span>&nbsp;<span class="ident" id="5967447">p</span><span class="op" id="5967448">.</span><span class="ident" id="5967449">linebreak</span><span class="op" id="5967458">(</span><span class="ident" id="5967459">line</span><span class="op" id="5967463">,</span>&nbsp;<span class="num" id="5967465">0</span><span class="op" id="5967466">,</span>&nbsp;<span class="ident" id="5967468">ws</span><span class="op" id="5967470">,</span>&nbsp;<span class="builtintype" id="5967472">true</span><span class="op" id="5967476">)</span>&nbsp;<span class="op" id="5967478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967482">ws</span>&nbsp;<span class="op" id="5967485">=</span>&nbsp;<span class="ident" id="5967487">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967496">prevBreak</span>&nbsp;<span class="op" id="5967506">=</span>&nbsp;<span class="num" id="5967508">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5967511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967515">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967612">size</span>&nbsp;<span class="op" id="5967617">:=</span>&nbsp;<span class="num" id="5967620">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967624">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967652">prevLine</span>&nbsp;<span class="op" id="5967661">:=</span>&nbsp;<span class="ident" id="5967664">prev</span><span class="op" id="5967668">.</span><span class="ident" id="5967669">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5967675">for</span>&nbsp;<span class="ident" id="5967679">i</span><span class="op" id="5967680">,</span>&nbsp;<span class="ident" id="5967682">x</span>&nbsp;<span class="op" id="5967684">:=</span>&nbsp;<span class="keyword" id="5967687">range</span>&nbsp;<span class="ident" id="5967693">list</span>&nbsp;<span class="op" id="5967698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5967702">line</span>&nbsp;<span class="op" id="5967707">=</span>&nbsp;<span class="ident" id="5967709">p</span><span class="op" id="5967710">.</span><span class="ident" id="5967711">lineFor</span><span class="op" id="5967718">(</span><span class="ident" id="5967719">x</span><span class="op" id="5967720">.</span><span class="ident" id="5967721">Pos</span><span class="op" id="5967724">(</span><span class="op" id="5967725">)</span><span class="op" id="5967726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967731">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967800">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967868">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967913">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5967982">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5968049">useFF</span>&nbsp;<span class="op" id="5968055">:=</span>&nbsp;<span class="builtintype" id="5968058">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968066">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968129">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968195">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968264">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5968278">prevSize</span>&nbsp;<span class="op" id="5968287">:=</span>&nbsp;<span class="ident" id="5968290">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5968297">const</span>&nbsp;<span class="ident" id="5968303">infinity</span>&nbsp;<span class="op" id="5968312">=</span>&nbsp;<span class="num" id="5968314">1e6</span>&nbsp;<span class="comment" id="5968318">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5968351">size</span>&nbsp;<span class="op" id="5968356">=</span>&nbsp;<span class="ident" id="5968358">p</span><span class="op" id="5968359">.</span><span class="ident" id="5968360">nodeSize</span><span class="op" id="5968368">(</span><span class="ident" id="5968369">x</span><span class="op" id="5968370">,</span>&nbsp;<span class="ident" id="5968372">infinity</span><span class="op" id="5968380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5968384">pair</span><span class="op" id="5968388">,</span>&nbsp;<span class="ident" id="5968390">isPair</span>&nbsp;<span class="op" id="5968397">:=</span>&nbsp;<span class="ident" id="5968400">x</span><span class="op" id="5968401">.</span><span class="op" id="5968402">(</span><span class="op" id="5968403">*</span><span class="ident" id="5968404">ast</span><span class="op" id="5968407">.</span><span class="ident" id="5968408">KeyValueExpr</span><span class="op" id="5968420">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5968424">if</span>&nbsp;<span class="ident" id="5968427">size</span>&nbsp;<span class="op" id="5968432">&lt;=</span>&nbsp;<span class="ident" id="5968435">infinity</span>&nbsp;<span class="op" id="5968444">&amp;&amp;</span>&nbsp;<span class="ident" id="5968447">prev</span><span class="op" id="5968451">.</span><span class="ident" id="5968452">IsValid</span><span class="op" id="5968459">(</span><span class="op" id="5968460">)</span>&nbsp;<span class="op" id="5968462">&amp;&amp;</span>&nbsp;<span class="ident" id="5968465">next</span><span class="op" id="5968469">.</span><span class="ident" id="5968470">IsValid</span><span class="op" id="5968477">(</span><span class="op" id="5968478">)</span>&nbsp;<span class="op" id="5968480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968485">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5968515">if</span>&nbsp;<span class="ident" id="5968518">isPair</span>&nbsp;<span class="op" id="5968525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5968531">size</span>&nbsp;<span class="op" id="5968536">=</span>&nbsp;<span class="ident" id="5968538">p</span><span class="op" id="5968539">.</span><span class="ident" id="5968540">nodeSize</span><span class="op" id="5968548">(</span><span class="ident" id="5968549">pair</span><span class="op" id="5968553">.</span><span class="ident" id="5968554">Key</span><span class="op" id="5968557">,</span>&nbsp;<span class="ident" id="5968559">infinity</span><span class="op" id="5968567">)</span>&nbsp;<span class="comment" id="5968569">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5968592">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5968596">}</span>&nbsp;<span class="keyword" id="5968598">else</span>&nbsp;<span class="op" id="5968603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968608">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5968670">size</span>&nbsp;<span class="op" id="5968675">=</span>&nbsp;<span class="num" id="5968677">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5968681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968686">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968745">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968802">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5968857">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5968911">if</span>&nbsp;<span class="ident" id="5968914">prevSize</span>&nbsp;<span class="op" id="5968923">&gt;</span>&nbsp;<span class="num" id="5968925">0</span>&nbsp;<span class="op" id="5968927">&amp;&amp;</span>&nbsp;<span class="ident" id="5968930">size</span>&nbsp;<span class="op" id="5968935">&gt;</span>&nbsp;<span class="num" id="5968937">0</span>&nbsp;<span class="op" id="5968939">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5968944">const</span>&nbsp;<span class="ident" id="5968950">smallSize</span>&nbsp;<span class="op" id="5968960">=</span>&nbsp;<span class="num" id="5968962">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5968968">if</span>&nbsp;<span class="ident" id="5968971">prevSize</span>&nbsp;<span class="op" id="5968980">&lt;=</span>&nbsp;<span class="ident" id="5968983">smallSize</span>&nbsp;<span class="op" id="5968993">&amp;&amp;</span>&nbsp;<span class="ident" id="5968996">size</span>&nbsp;<span class="op" id="5969001">&lt;=</span>&nbsp;<span class="ident" id="5969004">smallSize</span>&nbsp;<span class="op" id="5969014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969020">useFF</span>&nbsp;<span class="op" id="5969026">=</span>&nbsp;<span class="builtintype" id="5969028">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969037">}</span>&nbsp;<span class="keyword" id="5969039">else</span>&nbsp;<span class="op" id="5969044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5969050">const</span>&nbsp;<span class="ident" id="5969056">r</span>&nbsp;<span class="op" id="5969058">=</span>&nbsp;<span class="num" id="5969060">4</span>&nbsp;<span class="comment" id="5969062">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969079">ratio</span>&nbsp;<span class="op" id="5969085">:=</span>&nbsp;<span class="builtintype" id="5969088">float64</span><span class="op" id="5969095">(</span><span class="ident" id="5969096">size</span><span class="op" id="5969100">)</span>&nbsp;<span class="op" id="5969102">/</span>&nbsp;<span class="builtintype" id="5969104">float64</span><span class="op" id="5969111">(</span><span class="ident" id="5969112">prevSize</span><span class="op" id="5969120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969126">useFF</span>&nbsp;<span class="op" id="5969132">=</span>&nbsp;<span class="ident" id="5969134">ratio</span>&nbsp;<span class="op" id="5969140">&lt;=</span>&nbsp;<span class="num" id="5969143">1.0</span><span class="op" id="5969146">/</span><span class="ident" id="5969147">r</span>&nbsp;<span class="op" id="5969149">||</span>&nbsp;<span class="ident" id="5969152">r</span>&nbsp;<span class="op" id="5969154">&lt;=</span>&nbsp;<span class="ident" id="5969157">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969175">needsLinebreak</span>&nbsp;<span class="op" id="5969190">:=</span>&nbsp;<span class="num" id="5969193">0</span>&nbsp;<span class="op" id="5969195">&lt;</span>&nbsp;<span class="ident" id="5969197">prevLine</span>&nbsp;<span class="op" id="5969206">&amp;&amp;</span>&nbsp;<span class="ident" id="5969209">prevLine</span>&nbsp;<span class="op" id="5969218">&lt;</span>&nbsp;<span class="ident" id="5969220">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5969227">if</span>&nbsp;<span class="ident" id="5969230">i</span>&nbsp;<span class="op" id="5969232">&gt;</span>&nbsp;<span class="num" id="5969234">0</span>&nbsp;<span class="op" id="5969236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5969241">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5969297">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5969353">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5969402">if</span>&nbsp;<span class="op" id="5969405">!</span><span class="ident" id="5969406">needsLinebreak</span>&nbsp;<span class="op" id="5969421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969427">p</span><span class="op" id="5969428">.</span><span class="builtinfunc" id="5969429">print</span><span class="op" id="5969434">(</span><span class="ident" id="5969435">x</span><span class="op" id="5969436">.</span><span class="ident" id="5969437">Pos</span><span class="op" id="5969440">(</span><span class="op" id="5969441">)</span><span class="op" id="5969442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969452">p</span><span class="op" id="5969453">.</span><span class="builtinfunc" id="5969454">print</span><span class="op" id="5969459">(</span><span class="ident" id="5969460">token</span><span class="op" id="5969465">.</span><span class="ident" id="5969466">COMMA</span><span class="op" id="5969471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969476">needsBlank</span>&nbsp;<span class="op" id="5969487">:=</span>&nbsp;<span class="builtintype" id="5969490">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5969498">if</span>&nbsp;<span class="ident" id="5969501">needsLinebreak</span>&nbsp;<span class="op" id="5969516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5969522">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5969588">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5969654">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5969706">if</span>&nbsp;<span class="ident" id="5969709">p</span><span class="op" id="5969710">.</span><span class="ident" id="5969711">linebreak</span><span class="op" id="5969720">(</span><span class="ident" id="5969721">line</span><span class="op" id="5969725">,</span>&nbsp;<span class="num" id="5969727">0</span><span class="op" id="5969728">,</span>&nbsp;<span class="ident" id="5969730">ws</span><span class="op" id="5969732">,</span>&nbsp;<span class="ident" id="5969734">useFF</span>&nbsp;<span class="op" id="5969740">||</span>&nbsp;<span class="ident" id="5969743">prevBreak</span><span class="op" id="5969752">+</span><span class="num" id="5969753">1</span>&nbsp;<span class="op" id="5969755">&lt;</span>&nbsp;<span class="ident" id="5969757">i</span><span class="op" id="5969758">)</span>&nbsp;<span class="op" id="5969760">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969767">ws</span>&nbsp;<span class="op" id="5969770">=</span>&nbsp;<span class="ident" id="5969772">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969784">prevBreak</span>&nbsp;<span class="op" id="5969794">=</span>&nbsp;<span class="ident" id="5969796">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969803">needsBlank</span>&nbsp;<span class="op" id="5969814">=</span>&nbsp;<span class="builtintype" id="5969816">false</span>&nbsp;<span class="comment" id="5969822">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969862">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5969867">if</span>&nbsp;<span class="ident" id="5969870">needsBlank</span>&nbsp;<span class="op" id="5969881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5969887">p</span><span class="op" id="5969888">.</span><span class="builtinfunc" id="5969889">print</span><span class="op" id="5969894">(</span><span class="ident" id="5969895">blank</span><span class="op" id="5969900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5969909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5969914">if</span>&nbsp;<span class="builtinfunc" id="5969917">len</span><span class="op" id="5969920">(</span><span class="ident" id="5969921">list</span><span class="op" id="5969925">)</span>&nbsp;<span class="op" id="5969927">&gt;</span>&nbsp;<span class="num" id="5969929">1</span>&nbsp;<span class="op" id="5969931">&amp;&amp;</span>&nbsp;<span class="ident" id="5969934">isPair</span>&nbsp;<span class="op" id="5969941">&amp;&amp;</span>&nbsp;<span class="ident" id="5969944">size</span>&nbsp;<span class="op" id="5969949">&gt;</span>&nbsp;<span class="num" id="5969951">0</span>&nbsp;<span class="op" id="5969953">&amp;&amp;</span>&nbsp;<span class="ident" id="5969956">needsLinebreak</span>&nbsp;<span class="op" id="5969971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5969976">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5970037">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5970098">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5970159">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5970187">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970249">p</span><span class="op" id="5970250">.</span><span class="ident" id="5970251">expr</span><span class="op" id="5970255">(</span><span class="ident" id="5970256">pair</span><span class="op" id="5970260">.</span><span class="ident" id="5970261">Key</span><span class="op" id="5970264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970269">p</span><span class="op" id="5970270">.</span><span class="builtinfunc" id="5970271">print</span><span class="op" id="5970276">(</span><span class="ident" id="5970277">pair</span><span class="op" id="5970281">.</span><span class="ident" id="5970282">Colon</span><span class="op" id="5970287">,</span>&nbsp;<span class="ident" id="5970289">token</span><span class="op" id="5970294">.</span><span class="ident" id="5970295">COLON</span><span class="op" id="5970300">,</span>&nbsp;<span class="ident" id="5970302">vtab</span><span class="op" id="5970306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970311">p</span><span class="op" id="5970312">.</span><span class="ident" id="5970313">expr</span><span class="op" id="5970317">(</span><span class="ident" id="5970318">pair</span><span class="op" id="5970322">.</span><span class="ident" id="5970323">Value</span><span class="op" id="5970328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5970332">}</span>&nbsp;<span class="keyword" id="5970334">else</span>&nbsp;<span class="op" id="5970339">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970344">p</span><span class="op" id="5970345">.</span><span class="ident" id="5970346">expr0</span><span class="op" id="5970351">(</span><span class="ident" id="5970352">x</span><span class="op" id="5970353">,</span>&nbsp;<span class="ident" id="5970355">depth</span><span class="op" id="5970360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5970364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970369">prevLine</span>&nbsp;<span class="op" id="5970378">=</span>&nbsp;<span class="ident" id="5970380">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5970386">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5970390">if</span>&nbsp;<span class="ident" id="5970393">mode</span><span class="op" id="5970397">&amp;</span><span class="ident" id="5970398">commaTerm</span>&nbsp;<span class="op" id="5970408">!=</span>&nbsp;<span class="num" id="5970411">0</span>&nbsp;<span class="op" id="5970413">&amp;&amp;</span>&nbsp;<span class="ident" id="5970416">next</span><span class="op" id="5970420">.</span><span class="ident" id="5970421">IsValid</span><span class="op" id="5970428">(</span><span class="op" id="5970429">)</span>&nbsp;<span class="op" id="5970431">&amp;&amp;</span>&nbsp;<span class="ident" id="5970434">p</span><span class="op" id="5970435">.</span><span class="ident" id="5970436">pos</span><span class="op" id="5970439">.</span><span class="ident" id="5970440">Line</span>&nbsp;<span class="op" id="5970445">&lt;</span>&nbsp;<span class="ident" id="5970447">next</span><span class="op" id="5970451">.</span><span class="ident" id="5970452">Line</span>&nbsp;<span class="op" id="5970457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5970461">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970527">p</span><span class="op" id="5970528">.</span><span class="builtinfunc" id="5970529">print</span><span class="op" id="5970534">(</span><span class="ident" id="5970535">token</span><span class="op" id="5970540">.</span><span class="ident" id="5970541">COMMA</span><span class="op" id="5970546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5970550">if</span>&nbsp;<span class="ident" id="5970553">ws</span>&nbsp;<span class="op" id="5970556">==</span>&nbsp;<span class="ident" id="5970559">ignore</span>&nbsp;<span class="op" id="5970566">&amp;&amp;</span>&nbsp;<span class="ident" id="5970569">mode</span><span class="op" id="5970573">&amp;</span><span class="ident" id="5970574">noIndent</span>&nbsp;<span class="op" id="5970583">==</span>&nbsp;<span class="num" id="5970586">0</span>&nbsp;<span class="op" id="5970588">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5970593">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970623">p</span><span class="op" id="5970624">.</span><span class="builtinfunc" id="5970625">print</span><span class="op" id="5970630">(</span><span class="ident" id="5970631">unindent</span><span class="op" id="5970639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5970643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970647">p</span><span class="op" id="5970648">.</span><span class="builtinfunc" id="5970649">print</span><span class="op" id="5970654">(</span><span class="ident" id="5970655">formfeed</span><span class="op" id="5970663">)</span>&nbsp;<span class="comment" id="5970665">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5970720">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5970728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5970732">if</span>&nbsp;<span class="ident" id="5970735">ws</span>&nbsp;<span class="op" id="5970738">==</span>&nbsp;<span class="ident" id="5970741">ignore</span>&nbsp;<span class="op" id="5970748">&amp;&amp;</span>&nbsp;<span class="ident" id="5970751">mode</span><span class="op" id="5970755">&amp;</span><span class="ident" id="5970756">noIndent</span>&nbsp;<span class="op" id="5970765">==</span>&nbsp;<span class="num" id="5970768">0</span>&nbsp;<span class="op" id="5970770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5970774">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970803">p</span><span class="op" id="5970804">.</span><span class="builtinfunc" id="5970805">print</span><span class="op" id="5970810">(</span><span class="ident" id="5970811">unindent</span><span class="op" id="5970819">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5970822">}</span><br>
<span class="lineno"></span><span class="op" id="5970824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5970827">func</span>&nbsp;<span class="op" id="5970832">(</span><span class="ident" id="5970833">p</span>&nbsp;<span class="op" id="5970835">*</span><span class="ident" id="5970836">printer</span><span class="op" id="5970843">)</span>&nbsp;<span class="ident" id="5970845">parameters</span><span class="op" id="5970855">(</span><span class="ident" id="5970856">fields</span>&nbsp;<span class="op" id="5970863">*</span><span class="ident" id="5970864">ast</span><span class="op" id="5970867">.</span><span class="ident" id="5970868">FieldList</span><span class="op" id="5970877">)</span>&nbsp;<span class="op" id="5970879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970882">p</span><span class="op" id="5970883">.</span><span class="builtinfunc" id="5970884">print</span><span class="op" id="5970889">(</span><span class="ident" id="5970890">fields</span><span class="op" id="5970896">.</span><span class="ident" id="5970897">Opening</span><span class="op" id="5970904">,</span>&nbsp;<span class="ident" id="5970906">token</span><span class="op" id="5970911">.</span><span class="ident" id="5970912">LPAREN</span><span class="op" id="5970918">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5970921">if</span>&nbsp;<span class="builtinfunc" id="5970924">len</span><span class="op" id="5970927">(</span><span class="ident" id="5970928">fields</span><span class="op" id="5970934">.</span><span class="ident" id="5970935">List</span><span class="op" id="5970939">)</span>&nbsp;<span class="op" id="5970941">&gt;</span>&nbsp;<span class="num" id="5970943">0</span>&nbsp;<span class="op" id="5970945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970949">prevLine</span>&nbsp;<span class="op" id="5970958">:=</span>&nbsp;<span class="ident" id="5970961">p</span><span class="op" id="5970962">.</span><span class="ident" id="5970963">lineFor</span><span class="op" id="5970970">(</span><span class="ident" id="5970971">fields</span><span class="op" id="5970977">.</span><span class="ident" id="5970978">Opening</span><span class="op" id="5970985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5970989">ws</span>&nbsp;<span class="op" id="5970992">:=</span>&nbsp;<span class="ident" id="5970995">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5971004">for</span>&nbsp;<span class="ident" id="5971008">i</span><span class="op" id="5971009">,</span>&nbsp;<span class="ident" id="5971011">par</span>&nbsp;<span class="op" id="5971015">:=</span>&nbsp;<span class="keyword" id="5971018">range</span>&nbsp;<span class="ident" id="5971024">fields</span><span class="op" id="5971030">.</span><span class="ident" id="5971031">List</span>&nbsp;<span class="op" id="5971036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971041">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971098">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971155">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5971196">var</span>&nbsp;<span class="ident" id="5971200">parLineBeg</span>&nbsp;<span class="builtintype" id="5971211">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5971218">if</span>&nbsp;<span class="builtinfunc" id="5971221">len</span><span class="op" id="5971224">(</span><span class="ident" id="5971225">par</span><span class="op" id="5971228">.</span><span class="ident" id="5971229">Names</span><span class="op" id="5971234">)</span>&nbsp;<span class="op" id="5971236">&gt;</span>&nbsp;<span class="num" id="5971238">0</span>&nbsp;<span class="op" id="5971240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5971246">parLineBeg</span>&nbsp;<span class="op" id="5971257">=</span>&nbsp;<span class="ident" id="5971259">p</span><span class="op" id="5971260">.</span><span class="ident" id="5971261">lineFor</span><span class="op" id="5971268">(</span><span class="ident" id="5971269">par</span><span class="op" id="5971272">.</span><span class="ident" id="5971273">Names</span><span class="op" id="5971278">[</span><span class="num" id="5971279">0</span><span class="op" id="5971280">]</span><span class="op" id="5971281">.</span><span class="ident" id="5971282">Pos</span><span class="op" id="5971285">(</span><span class="op" id="5971286">)</span><span class="op" id="5971287">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5971292">}</span>&nbsp;<span class="keyword" id="5971294">else</span>&nbsp;<span class="op" id="5971299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5971305">parLineBeg</span>&nbsp;<span class="op" id="5971316">=</span>&nbsp;<span class="ident" id="5971318">p</span><span class="op" id="5971319">.</span><span class="ident" id="5971320">lineFor</span><span class="op" id="5971327">(</span><span class="ident" id="5971328">par</span><span class="op" id="5971331">.</span><span class="ident" id="5971332">Type</span><span class="op" id="5971336">.</span><span class="ident" id="5971337">Pos</span><span class="op" id="5971340">(</span><span class="op" id="5971341">)</span><span class="op" id="5971342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5971347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5971352">var</span>&nbsp;<span class="ident" id="5971356">parLineEnd</span>&nbsp;<span class="op" id="5971367">=</span>&nbsp;<span class="ident" id="5971369">p</span><span class="op" id="5971370">.</span><span class="ident" id="5971371">lineFor</span><span class="op" id="5971378">(</span><span class="ident" id="5971379">par</span><span class="op" id="5971382">.</span><span class="ident" id="5971383">Type</span><span class="op" id="5971387">.</span><span class="ident" id="5971388">End</span><span class="op" id="5971391">(</span><span class="op" id="5971392">)</span><span class="op" id="5971393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971398">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5971429">needsLinebreak</span>&nbsp;<span class="op" id="5971444">:=</span>&nbsp;<span class="num" id="5971447">0</span>&nbsp;<span class="op" id="5971449">&lt;</span>&nbsp;<span class="ident" id="5971451">prevLine</span>&nbsp;<span class="op" id="5971460">&amp;&amp;</span>&nbsp;<span class="ident" id="5971463">prevLine</span>&nbsp;<span class="op" id="5971472">&lt;</span>&nbsp;<span class="ident" id="5971474">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5971488">if</span>&nbsp;<span class="ident" id="5971491">i</span>&nbsp;<span class="op" id="5971493">&gt;</span>&nbsp;<span class="num" id="5971495">0</span>&nbsp;<span class="op" id="5971497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971503">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971559">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971614">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5971668">if</span>&nbsp;<span class="op" id="5971671">!</span><span class="ident" id="5971672">needsLinebreak</span>&nbsp;<span class="op" id="5971687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5971694">p</span><span class="op" id="5971695">.</span><span class="builtinfunc" id="5971696">print</span><span class="op" id="5971701">(</span><span class="ident" id="5971702">par</span><span class="op" id="5971705">.</span><span class="ident" id="5971706">Pos</span><span class="op" id="5971709">(</span><span class="op" id="5971710">)</span><span class="op" id="5971711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5971717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5971723">p</span><span class="op" id="5971724">.</span><span class="builtinfunc" id="5971725">print</span><span class="op" id="5971730">(</span><span class="ident" id="5971731">token</span><span class="op" id="5971736">.</span><span class="ident" id="5971737">COMMA</span><span class="op" id="5971742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5971747">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971752">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5971799">if</span>&nbsp;<span class="ident" id="5971802">needsLinebreak</span>&nbsp;<span class="op" id="5971817">&amp;&amp;</span>&nbsp;<span class="ident" id="5971820">p</span><span class="op" id="5971821">.</span><span class="ident" id="5971822">linebreak</span><span class="op" id="5971831">(</span><span class="ident" id="5971832">parLineBeg</span><span class="op" id="5971842">,</span>&nbsp;<span class="num" id="5971844">0</span><span class="op" id="5971845">,</span>&nbsp;<span class="ident" id="5971847">ws</span><span class="op" id="5971849">,</span>&nbsp;<span class="builtintype" id="5971851">true</span><span class="op" id="5971855">)</span>&nbsp;<span class="op" id="5971857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5971863">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5971948">ws</span>&nbsp;<span class="op" id="5971951">=</span>&nbsp;<span class="ident" id="5971953">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5971963">}</span>&nbsp;<span class="keyword" id="5971965">else</span>&nbsp;<span class="keyword" id="5971970">if</span>&nbsp;<span class="ident" id="5971973">i</span>&nbsp;<span class="op" id="5971975">&gt;</span>&nbsp;<span class="num" id="5971977">0</span>&nbsp;<span class="op" id="5971979">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5971985">p</span><span class="op" id="5971986">.</span><span class="builtinfunc" id="5971987">print</span><span class="op" id="5971992">(</span><span class="ident" id="5971993">blank</span><span class="op" id="5971998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5972003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972008">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5972030">if</span>&nbsp;<span class="builtinfunc" id="5972033">len</span><span class="op" id="5972036">(</span><span class="ident" id="5972037">par</span><span class="op" id="5972040">.</span><span class="ident" id="5972041">Names</span><span class="op" id="5972046">)</span>&nbsp;<span class="op" id="5972048">&gt;</span>&nbsp;<span class="num" id="5972050">0</span>&nbsp;<span class="op" id="5972052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972058">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972126">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972197">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972270">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972346">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972423">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972455">p</span><span class="op" id="5972456">.</span><span class="ident" id="5972457">identList</span><span class="op" id="5972466">(</span><span class="ident" id="5972467">par</span><span class="op" id="5972470">.</span><span class="ident" id="5972471">Names</span><span class="op" id="5972476">,</span>&nbsp;<span class="ident" id="5972478">ws</span>&nbsp;<span class="op" id="5972481">==</span>&nbsp;<span class="ident" id="5972484">indent</span><span class="op" id="5972490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972496">p</span><span class="op" id="5972497">.</span><span class="builtinfunc" id="5972498">print</span><span class="op" id="5972503">(</span><span class="ident" id="5972504">blank</span><span class="op" id="5972509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5972514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972519">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972540">p</span><span class="op" id="5972541">.</span><span class="ident" id="5972542">expr</span><span class="op" id="5972546">(</span><span class="ident" id="5972547">stripParensAlways</span><span class="op" id="5972564">(</span><span class="ident" id="5972565">par</span><span class="op" id="5972568">.</span><span class="ident" id="5972569">Type</span><span class="op" id="5972573">)</span><span class="op" id="5972574">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972579">prevLine</span>&nbsp;<span class="op" id="5972588">=</span>&nbsp;<span class="ident" id="5972590">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5972603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972607">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972678">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5972722">if</span>&nbsp;<span class="ident" id="5972725">closing</span>&nbsp;<span class="op" id="5972733">:=</span>&nbsp;<span class="ident" id="5972736">p</span><span class="op" id="5972737">.</span><span class="ident" id="5972738">lineFor</span><span class="op" id="5972745">(</span><span class="ident" id="5972746">fields</span><span class="op" id="5972752">.</span><span class="ident" id="5972753">Closing</span><span class="op" id="5972760">)</span><span class="op" id="5972761">;</span>&nbsp;<span class="num" id="5972763">0</span>&nbsp;<span class="op" id="5972765">&lt;</span>&nbsp;<span class="ident" id="5972767">prevLine</span>&nbsp;<span class="op" id="5972776">&amp;&amp;</span>&nbsp;<span class="ident" id="5972779">prevLine</span>&nbsp;<span class="op" id="5972788">&lt;</span>&nbsp;<span class="ident" id="5972790">closing</span>&nbsp;<span class="op" id="5972798">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972803">p</span><span class="op" id="5972804">.</span><span class="builtinfunc" id="5972805">print</span><span class="op" id="5972810">(</span><span class="ident" id="5972811">token</span><span class="op" id="5972816">.</span><span class="ident" id="5972817">COMMA</span><span class="op" id="5972822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972827">p</span><span class="op" id="5972828">.</span><span class="ident" id="5972829">linebreak</span><span class="op" id="5972838">(</span><span class="ident" id="5972839">closing</span><span class="op" id="5972846">,</span>&nbsp;<span class="num" id="5972848">0</span><span class="op" id="5972849">,</span>&nbsp;<span class="ident" id="5972851">ignore</span><span class="op" id="5972857">,</span>&nbsp;<span class="builtintype" id="5972859">true</span><span class="op" id="5972863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5972867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5972871">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5972900">if</span>&nbsp;<span class="ident" id="5972903">ws</span>&nbsp;<span class="op" id="5972906">==</span>&nbsp;<span class="ident" id="5972909">ignore</span>&nbsp;<span class="op" id="5972916">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972921">p</span><span class="op" id="5972922">.</span><span class="builtinfunc" id="5972923">print</span><span class="op" id="5972928">(</span><span class="ident" id="5972929">unindent</span><span class="op" id="5972937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5972941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5972944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5972947">p</span><span class="op" id="5972948">.</span><span class="builtinfunc" id="5972949">print</span><span class="op" id="5972954">(</span><span class="ident" id="5972955">fields</span><span class="op" id="5972961">.</span><span class="ident" id="5972962">Closing</span><span class="op" id="5972969">,</span>&nbsp;<span class="ident" id="5972971">token</span><span class="op" id="5972976">.</span><span class="ident" id="5972977">RPAREN</span><span class="op" id="5972983">)</span><br>
<span class="lineno"></span><span class="op" id="5972985">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5972988">func</span>&nbsp;<span class="op" id="5972993">(</span><span class="ident" id="5972994">p</span>&nbsp;<span class="op" id="5972996">*</span><span class="ident" id="5972997">printer</span><span class="op" id="5973004">)</span>&nbsp;<span class="ident" id="5973006">signature</span><span class="op" id="5973015">(</span><span class="ident" id="5973016">params</span><span class="op" id="5973022">,</span>&nbsp;<span class="ident" id="5973024">result</span>&nbsp;<span class="op" id="5973031">*</span><span class="ident" id="5973032">ast</span><span class="op" id="5973035">.</span><span class="ident" id="5973036">FieldList</span><span class="op" id="5973045">)</span>&nbsp;<span class="op" id="5973047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973050">if</span>&nbsp;<span class="ident" id="5973053">params</span>&nbsp;<span class="op" id="5973060">!=</span>&nbsp;<span class="ident" id="5973063">nil</span>&nbsp;<span class="op" id="5973067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973071">p</span><span class="op" id="5973072">.</span><span class="ident" id="5973073">parameters</span><span class="op" id="5973083">(</span><span class="ident" id="5973084">params</span><span class="op" id="5973090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973093">}</span>&nbsp;<span class="keyword" id="5973095">else</span>&nbsp;<span class="op" id="5973100">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973104">p</span><span class="op" id="5973105">.</span><span class="builtinfunc" id="5973106">print</span><span class="op" id="5973111">(</span><span class="ident" id="5973112">token</span><span class="op" id="5973117">.</span><span class="ident" id="5973118">LPAREN</span><span class="op" id="5973124">,</span>&nbsp;<span class="ident" id="5973126">token</span><span class="op" id="5973131">.</span><span class="ident" id="5973132">RPAREN</span><span class="op" id="5973138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973144">n</span>&nbsp;<span class="op" id="5973146">:=</span>&nbsp;<span class="ident" id="5973149">result</span><span class="op" id="5973155">.</span><span class="ident" id="5973156">NumFields</span><span class="op" id="5973165">(</span><span class="op" id="5973166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973169">if</span>&nbsp;<span class="ident" id="5973172">n</span>&nbsp;<span class="op" id="5973174">&gt;</span>&nbsp;<span class="num" id="5973176">0</span>&nbsp;<span class="op" id="5973178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5973182">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973201">p</span><span class="op" id="5973202">.</span><span class="builtinfunc" id="5973203">print</span><span class="op" id="5973208">(</span><span class="ident" id="5973209">blank</span><span class="op" id="5973214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973218">if</span>&nbsp;<span class="ident" id="5973221">n</span>&nbsp;<span class="op" id="5973223">==</span>&nbsp;<span class="num" id="5973226">1</span>&nbsp;<span class="op" id="5973228">&amp;&amp;</span>&nbsp;<span class="ident" id="5973231">result</span><span class="op" id="5973237">.</span><span class="ident" id="5973238">List</span><span class="op" id="5973242">[</span><span class="num" id="5973243">0</span><span class="op" id="5973244">]</span><span class="op" id="5973245">.</span><span class="ident" id="5973246">Names</span>&nbsp;<span class="op" id="5973252">==</span>&nbsp;<span class="ident" id="5973255">nil</span>&nbsp;<span class="op" id="5973259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5973264">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973303">p</span><span class="op" id="5973304">.</span><span class="ident" id="5973305">expr</span><span class="op" id="5973309">(</span><span class="ident" id="5973310">stripParensAlways</span><span class="op" id="5973327">(</span><span class="ident" id="5973328">result</span><span class="op" id="5973334">.</span><span class="ident" id="5973335">List</span><span class="op" id="5973339">[</span><span class="num" id="5973340">0</span><span class="op" id="5973341">]</span><span class="op" id="5973342">.</span><span class="ident" id="5973343">Type</span><span class="op" id="5973347">)</span><span class="op" id="5973348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973353">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973366">p</span><span class="op" id="5973367">.</span><span class="ident" id="5973368">parameters</span><span class="op" id="5973378">(</span><span class="ident" id="5973379">result</span><span class="op" id="5973385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973388">}</span><br>
<span class="lineno"></span><span class="op" id="5973390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5973393">func</span>&nbsp;<span class="ident" id="5973398">identListSize</span><span class="op" id="5973411">(</span><span class="ident" id="5973412">list</span>&nbsp;<span class="op" id="5973417">[</span><span class="op" id="5973418">]</span><span class="op" id="5973419">*</span><span class="ident" id="5973420">ast</span><span class="op" id="5973423">.</span><span class="ident" id="5973424">Ident</span><span class="op" id="5973429">,</span>&nbsp;<span class="ident" id="5973431">maxSize</span>&nbsp;<span class="builtintype" id="5973439">int</span><span class="op" id="5973442">)</span>&nbsp;<span class="op" id="5973444">(</span><span class="ident" id="5973445">size</span>&nbsp;<span class="builtintype" id="5973450">int</span><span class="op" id="5973453">)</span>&nbsp;<span class="op" id="5973455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973458">for</span>&nbsp;<span class="ident" id="5973462">i</span><span class="op" id="5973463">,</span>&nbsp;<span class="ident" id="5973465">x</span>&nbsp;<span class="op" id="5973467">:=</span>&nbsp;<span class="keyword" id="5973470">range</span>&nbsp;<span class="ident" id="5973476">list</span>&nbsp;<span class="op" id="5973481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973485">if</span>&nbsp;<span class="ident" id="5973488">i</span>&nbsp;<span class="op" id="5973490">&gt;</span>&nbsp;<span class="num" id="5973492">0</span>&nbsp;<span class="op" id="5973494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973499">size</span>&nbsp;<span class="op" id="5973504">+=</span>&nbsp;<span class="builtinfunc" id="5973507">len</span><span class="op" id="5973510">(</span><span class="string" id="5973511">&#34;,&nbsp;&#34;</span><span class="op" id="5973515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973519">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973523">size</span>&nbsp;<span class="op" id="5973528">+=</span>&nbsp;<span class="ident" id="5973531">utf8</span><span class="op" id="5973535">.</span><span class="ident" id="5973536">RuneCountInString</span><span class="op" id="5973553">(</span><span class="ident" id="5973554">x</span><span class="op" id="5973555">.</span><span class="ident" id="5973556">Name</span><span class="op" id="5973560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973564">if</span>&nbsp;<span class="ident" id="5973567">size</span>&nbsp;<span class="op" id="5973572">&gt;=</span>&nbsp;<span class="ident" id="5973575">maxSize</span>&nbsp;<span class="op" id="5973583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973588">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973599">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973602">return</span><br>
<span class="lineno"></span><span class="op" id="5973609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5973612">func</span>&nbsp;<span class="op" id="5973617">(</span><span class="ident" id="5973618">p</span>&nbsp;<span class="op" id="5973620">*</span><span class="ident" id="5973621">printer</span><span class="op" id="5973628">)</span>&nbsp;<span class="ident" id="5973630">isOneLineFieldList</span><span class="op" id="5973648">(</span><span class="ident" id="5973649">list</span>&nbsp;<span class="op" id="5973654">[</span><span class="op" id="5973655">]</span><span class="op" id="5973656">*</span><span class="ident" id="5973657">ast</span><span class="op" id="5973660">.</span><span class="ident" id="5973661">Field</span><span class="op" id="5973666">)</span>&nbsp;<span class="builtintype" id="5973668">bool</span>&nbsp;<span class="op" id="5973673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973676">if</span>&nbsp;<span class="builtinfunc" id="5973679">len</span><span class="op" id="5973682">(</span><span class="ident" id="5973683">list</span><span class="op" id="5973687">)</span>&nbsp;<span class="op" id="5973689">!=</span>&nbsp;<span class="num" id="5973692">1</span>&nbsp;<span class="op" id="5973694">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973698">return</span>&nbsp;<span class="builtintype" id="5973705">false</span>&nbsp;<span class="comment" id="5973711">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973739">f</span>&nbsp;<span class="op" id="5973741">:=</span>&nbsp;<span class="ident" id="5973744">list</span><span class="op" id="5973748">[</span><span class="num" id="5973749">0</span><span class="op" id="5973750">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973753">if</span>&nbsp;<span class="ident" id="5973756">f</span><span class="op" id="5973757">.</span><span class="ident" id="5973758">Tag</span>&nbsp;<span class="op" id="5973762">!=</span>&nbsp;<span class="ident" id="5973765">nil</span>&nbsp;<span class="op" id="5973769">||</span>&nbsp;<span class="ident" id="5973772">f</span><span class="op" id="5973773">.</span><span class="ident" id="5973774">Comment</span>&nbsp;<span class="op" id="5973782">!=</span>&nbsp;<span class="ident" id="5973785">nil</span>&nbsp;<span class="op" id="5973789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973793">return</span>&nbsp;<span class="builtintype" id="5973800">false</span>&nbsp;<span class="comment" id="5973806">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5973839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5973842">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973868">const</span>&nbsp;<span class="ident" id="5973874">maxSize</span>&nbsp;<span class="op" id="5973882">=</span>&nbsp;<span class="num" id="5973884">30</span>&nbsp;<span class="comment" id="5973887">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5973943">namesSize</span>&nbsp;<span class="op" id="5973953">:=</span>&nbsp;<span class="ident" id="5973956">identListSize</span><span class="op" id="5973969">(</span><span class="ident" id="5973970">f</span><span class="op" id="5973971">.</span><span class="ident" id="5973972">Names</span><span class="op" id="5973977">,</span>&nbsp;<span class="ident" id="5973979">maxSize</span><span class="op" id="5973986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5973989">if</span>&nbsp;<span class="ident" id="5973992">namesSize</span>&nbsp;<span class="op" id="5974002">&gt;</span>&nbsp;<span class="num" id="5974004">0</span>&nbsp;<span class="op" id="5974006">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974010">namesSize</span>&nbsp;<span class="op" id="5974020">=</span>&nbsp;<span class="num" id="5974022">1</span>&nbsp;<span class="comment" id="5974024">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5974058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974061">typeSize</span>&nbsp;<span class="op" id="5974070">:=</span>&nbsp;<span class="ident" id="5974073">p</span><span class="op" id="5974074">.</span><span class="ident" id="5974075">nodeSize</span><span class="op" id="5974083">(</span><span class="ident" id="5974084">f</span><span class="op" id="5974085">.</span><span class="ident" id="5974086">Type</span><span class="op" id="5974090">,</span>&nbsp;<span class="ident" id="5974092">maxSize</span><span class="op" id="5974099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974102">return</span>&nbsp;<span class="ident" id="5974109">namesSize</span><span class="op" id="5974118">+</span><span class="ident" id="5974119">typeSize</span>&nbsp;<span class="op" id="5974128">&lt;=</span>&nbsp;<span class="ident" id="5974131">maxSize</span><br>
<span class="lineno"></span><span class="op" id="5974139">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5974142">func</span>&nbsp;<span class="op" id="5974147">(</span><span class="ident" id="5974148">p</span>&nbsp;<span class="op" id="5974150">*</span><span class="ident" id="5974151">printer</span><span class="op" id="5974158">)</span>&nbsp;<span class="ident" id="5974160">setLineComment</span><span class="op" id="5974174">(</span><span class="ident" id="5974175">text</span>&nbsp;<span class="builtintype" id="5974180">string</span><span class="op" id="5974186">)</span>&nbsp;<span class="op" id="5974188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974191">p</span><span class="op" id="5974192">.</span><span class="ident" id="5974193">setComment</span><span class="op" id="5974203">(</span><span class="op" id="5974204">&amp;</span><span class="ident" id="5974205">ast</span><span class="op" id="5974208">.</span><span class="ident" id="5974209">CommentGroup</span><span class="op" id="5974221">{</span><span class="ident" id="5974222">List</span><span class="op" id="5974226">:</span>&nbsp;<span class="op" id="5974228">[</span><span class="op" id="5974229">]</span><span class="op" id="5974230">*</span><span class="ident" id="5974231">ast</span><span class="op" id="5974234">.</span><span class="ident" id="5974235">Comment</span><span class="op" id="5974242">{</span><span class="op" id="5974243">{</span><span class="ident" id="5974244">Slash</span><span class="op" id="5974249">:</span>&nbsp;<span class="ident" id="5974251">token</span><span class="op" id="5974256">.</span><span class="ident" id="5974257">NoPos</span><span class="op" id="5974262">,</span>&nbsp;<span class="ident" id="5974264">Text</span><span class="op" id="5974268">:</span>&nbsp;<span class="ident" id="5974270">text</span><span class="op" id="5974274">}</span><span class="op" id="5974275">}</span><span class="op" id="5974276">}</span><span class="op" id="5974277">)</span><br>
<span class="lineno"></span><span class="op" id="5974279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5974282">func</span>&nbsp;<span class="op" id="5974287">(</span><span class="ident" id="5974288">p</span>&nbsp;<span class="op" id="5974290">*</span><span class="ident" id="5974291">printer</span><span class="op" id="5974298">)</span>&nbsp;<span class="ident" id="5974300">fieldList</span><span class="op" id="5974309">(</span><span class="ident" id="5974310">fields</span>&nbsp;<span class="op" id="5974317">*</span><span class="ident" id="5974318">ast</span><span class="op" id="5974321">.</span><span class="ident" id="5974322">FieldList</span><span class="op" id="5974331">,</span>&nbsp;<span class="ident" id="5974333">isStruct</span><span class="op" id="5974341">,</span>&nbsp;<span class="ident" id="5974343">isIncomplete</span>&nbsp;<span class="builtintype" id="5974356">bool</span><span class="op" id="5974360">)</span>&nbsp;<span class="op" id="5974362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974365">lbrace</span>&nbsp;<span class="op" id="5974372">:=</span>&nbsp;<span class="ident" id="5974375">fields</span><span class="op" id="5974381">.</span><span class="ident" id="5974382">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974391">list</span>&nbsp;<span class="op" id="5974396">:=</span>&nbsp;<span class="ident" id="5974399">fields</span><span class="op" id="5974405">.</span><span class="ident" id="5974406">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974412">rbrace</span>&nbsp;<span class="op" id="5974419">:=</span>&nbsp;<span class="ident" id="5974422">fields</span><span class="op" id="5974428">.</span><span class="ident" id="5974429">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974438">hasComments</span>&nbsp;<span class="op" id="5974450">:=</span>&nbsp;<span class="ident" id="5974453">isIncomplete</span>&nbsp;<span class="op" id="5974466">||</span>&nbsp;<span class="ident" id="5974469">p</span><span class="op" id="5974470">.</span><span class="ident" id="5974471">commentBefore</span><span class="op" id="5974484">(</span><span class="ident" id="5974485">p</span><span class="op" id="5974486">.</span><span class="ident" id="5974487">posFor</span><span class="op" id="5974493">(</span><span class="ident" id="5974494">rbrace</span><span class="op" id="5974500">)</span><span class="op" id="5974501">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974504">srcIsOneLine</span>&nbsp;<span class="op" id="5974517">:=</span>&nbsp;<span class="ident" id="5974520">lbrace</span><span class="op" id="5974526">.</span><span class="ident" id="5974527">IsValid</span><span class="op" id="5974534">(</span><span class="op" id="5974535">)</span>&nbsp;<span class="op" id="5974537">&amp;&amp;</span>&nbsp;<span class="ident" id="5974540">rbrace</span><span class="op" id="5974546">.</span><span class="ident" id="5974547">IsValid</span><span class="op" id="5974554">(</span><span class="op" id="5974555">)</span>&nbsp;<span class="op" id="5974557">&amp;&amp;</span>&nbsp;<span class="ident" id="5974560">p</span><span class="op" id="5974561">.</span><span class="ident" id="5974562">lineFor</span><span class="op" id="5974569">(</span><span class="ident" id="5974570">lbrace</span><span class="op" id="5974576">)</span>&nbsp;<span class="op" id="5974578">==</span>&nbsp;<span class="ident" id="5974581">p</span><span class="op" id="5974582">.</span><span class="ident" id="5974583">lineFor</span><span class="op" id="5974590">(</span><span class="ident" id="5974591">rbrace</span><span class="op" id="5974597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974601">if</span>&nbsp;<span class="op" id="5974604">!</span><span class="ident" id="5974605">hasComments</span>&nbsp;<span class="op" id="5974617">&amp;&amp;</span>&nbsp;<span class="ident" id="5974620">srcIsOneLine</span>&nbsp;<span class="op" id="5974633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5974637">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974679">if</span>&nbsp;<span class="builtinfunc" id="5974682">len</span><span class="op" id="5974685">(</span><span class="ident" id="5974686">list</span><span class="op" id="5974690">)</span>&nbsp;<span class="op" id="5974692">==</span>&nbsp;<span class="num" id="5974695">0</span>&nbsp;<span class="op" id="5974697">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5974702">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974753">p</span><span class="op" id="5974754">.</span><span class="builtinfunc" id="5974755">print</span><span class="op" id="5974760">(</span><span class="ident" id="5974761">lbrace</span><span class="op" id="5974767">,</span>&nbsp;<span class="ident" id="5974769">token</span><span class="op" id="5974774">.</span><span class="ident" id="5974775">LBRACE</span><span class="op" id="5974781">,</span>&nbsp;<span class="ident" id="5974783">rbrace</span><span class="op" id="5974789">,</span>&nbsp;<span class="ident" id="5974791">token</span><span class="op" id="5974796">.</span><span class="ident" id="5974797">RBRACE</span><span class="op" id="5974803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974808">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5974817">}</span>&nbsp;<span class="keyword" id="5974819">else</span>&nbsp;<span class="keyword" id="5974824">if</span>&nbsp;<span class="ident" id="5974827">isStruct</span>&nbsp;<span class="op" id="5974836">&amp;&amp;</span>&nbsp;<span class="ident" id="5974839">p</span><span class="op" id="5974840">.</span><span class="ident" id="5974841">isOneLineFieldList</span><span class="op" id="5974859">(</span><span class="ident" id="5974860">list</span><span class="op" id="5974864">)</span>&nbsp;<span class="op" id="5974866">{</span>&nbsp;<span class="comment" id="5974868">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5974900">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5974939">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974997">p</span><span class="op" id="5974998">.</span><span class="builtinfunc" id="5974999">print</span><span class="op" id="5975004">(</span><span class="ident" id="5975005">lbrace</span><span class="op" id="5975011">,</span>&nbsp;<span class="ident" id="5975013">token</span><span class="op" id="5975018">.</span><span class="ident" id="5975019">LBRACE</span><span class="op" id="5975025">,</span>&nbsp;<span class="ident" id="5975027">blank</span><span class="op" id="5975032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975037">f</span>&nbsp;<span class="op" id="5975039">:=</span>&nbsp;<span class="ident" id="5975042">list</span><span class="op" id="5975046">[</span><span class="num" id="5975047">0</span><span class="op" id="5975048">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975053">for</span>&nbsp;<span class="ident" id="5975057">i</span><span class="op" id="5975058">,</span>&nbsp;<span class="ident" id="5975060">x</span>&nbsp;<span class="op" id="5975062">:=</span>&nbsp;<span class="keyword" id="5975065">range</span>&nbsp;<span class="ident" id="5975071">f</span><span class="op" id="5975072">.</span><span class="ident" id="5975073">Names</span>&nbsp;<span class="op" id="5975079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975085">if</span>&nbsp;<span class="ident" id="5975088">i</span>&nbsp;<span class="op" id="5975090">&gt;</span>&nbsp;<span class="num" id="5975092">0</span>&nbsp;<span class="op" id="5975094">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5975101">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975151">p</span><span class="op" id="5975152">.</span><span class="builtinfunc" id="5975153">print</span><span class="op" id="5975158">(</span><span class="ident" id="5975159">token</span><span class="op" id="5975164">.</span><span class="ident" id="5975165">COMMA</span><span class="op" id="5975170">,</span>&nbsp;<span class="ident" id="5975172">blank</span><span class="op" id="5975177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975189">p</span><span class="op" id="5975190">.</span><span class="ident" id="5975191">expr</span><span class="op" id="5975195">(</span><span class="ident" id="5975196">x</span><span class="op" id="5975197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975202">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975207">if</span>&nbsp;<span class="builtinfunc" id="5975210">len</span><span class="op" id="5975213">(</span><span class="ident" id="5975214">f</span><span class="op" id="5975215">.</span><span class="ident" id="5975216">Names</span><span class="op" id="5975221">)</span>&nbsp;<span class="op" id="5975223">&gt;</span>&nbsp;<span class="num" id="5975225">0</span>&nbsp;<span class="op" id="5975227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975233">p</span><span class="op" id="5975234">.</span><span class="builtinfunc" id="5975235">print</span><span class="op" id="5975240">(</span><span class="ident" id="5975241">blank</span><span class="op" id="5975246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975256">p</span><span class="op" id="5975257">.</span><span class="ident" id="5975258">expr</span><span class="op" id="5975262">(</span><span class="ident" id="5975263">f</span><span class="op" id="5975264">.</span><span class="ident" id="5975265">Type</span><span class="op" id="5975269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975274">p</span><span class="op" id="5975275">.</span><span class="builtinfunc" id="5975276">print</span><span class="op" id="5975281">(</span><span class="ident" id="5975282">blank</span><span class="op" id="5975287">,</span>&nbsp;<span class="ident" id="5975289">rbrace</span><span class="op" id="5975295">,</span>&nbsp;<span class="ident" id="5975297">token</span><span class="op" id="5975302">.</span><span class="ident" id="5975303">RBRACE</span><span class="op" id="5975309">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975314">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5975329">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975363">p</span><span class="op" id="5975364">.</span><span class="builtinfunc" id="5975365">print</span><span class="op" id="5975370">(</span><span class="ident" id="5975371">blank</span><span class="op" id="5975376">,</span>&nbsp;<span class="ident" id="5975378">lbrace</span><span class="op" id="5975384">,</span>&nbsp;<span class="ident" id="5975386">token</span><span class="op" id="5975391">.</span><span class="ident" id="5975392">LBRACE</span><span class="op" id="5975398">,</span>&nbsp;<span class="ident" id="5975400">indent</span><span class="op" id="5975406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975409">if</span>&nbsp;<span class="ident" id="5975412">hasComments</span>&nbsp;<span class="op" id="5975424">||</span>&nbsp;<span class="builtinfunc" id="5975427">len</span><span class="op" id="5975430">(</span><span class="ident" id="5975431">list</span><span class="op" id="5975435">)</span>&nbsp;<span class="op" id="5975437">&gt;</span>&nbsp;<span class="num" id="5975439">0</span>&nbsp;<span class="op" id="5975441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975445">p</span><span class="op" id="5975446">.</span><span class="builtinfunc" id="5975447">print</span><span class="op" id="5975452">(</span><span class="ident" id="5975453">formfeed</span><span class="op" id="5975461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975468">if</span>&nbsp;<span class="ident" id="5975471">isStruct</span>&nbsp;<span class="op" id="5975480">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975485">sep</span>&nbsp;<span class="op" id="5975489">:=</span>&nbsp;<span class="ident" id="5975492">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975499">if</span>&nbsp;<span class="builtinfunc" id="5975502">len</span><span class="op" id="5975505">(</span><span class="ident" id="5975506">list</span><span class="op" id="5975510">)</span>&nbsp;<span class="op" id="5975512">==</span>&nbsp;<span class="num" id="5975515">1</span>&nbsp;<span class="op" id="5975517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975522">sep</span>&nbsp;<span class="op" id="5975526">=</span>&nbsp;<span class="ident" id="5975528">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975540">var</span>&nbsp;<span class="ident" id="5975544">line</span>&nbsp;<span class="builtintype" id="5975549">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975555">for</span>&nbsp;<span class="ident" id="5975559">i</span><span class="op" id="5975560">,</span>&nbsp;<span class="ident" id="5975562">f</span>&nbsp;<span class="op" id="5975564">:=</span>&nbsp;<span class="keyword" id="5975567">range</span>&nbsp;<span class="ident" id="5975573">list</span>&nbsp;<span class="op" id="5975578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975583">if</span>&nbsp;<span class="ident" id="5975586">i</span>&nbsp;<span class="op" id="5975588">&gt;</span>&nbsp;<span class="num" id="5975590">0</span>&nbsp;<span class="op" id="5975592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975598">p</span><span class="op" id="5975599">.</span><span class="ident" id="5975600">linebreak</span><span class="op" id="5975609">(</span><span class="ident" id="5975610">p</span><span class="op" id="5975611">.</span><span class="ident" id="5975612">lineFor</span><span class="op" id="5975619">(</span><span class="ident" id="5975620">f</span><span class="op" id="5975621">.</span><span class="ident" id="5975622">Pos</span><span class="op" id="5975625">(</span><span class="op" id="5975626">)</span><span class="op" id="5975627">)</span><span class="op" id="5975628">,</span>&nbsp;<span class="num" id="5975630">1</span><span class="op" id="5975631">,</span>&nbsp;<span class="ident" id="5975633">ignore</span><span class="op" id="5975639">,</span>&nbsp;<span class="ident" id="5975641">p</span><span class="op" id="5975642">.</span><span class="ident" id="5975643">linesFrom</span><span class="op" id="5975652">(</span><span class="ident" id="5975653">line</span><span class="op" id="5975657">)</span>&nbsp;<span class="op" id="5975659">&gt;</span>&nbsp;<span class="num" id="5975661">0</span><span class="op" id="5975662">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975672">extraTabs</span>&nbsp;<span class="op" id="5975682">:=</span>&nbsp;<span class="num" id="5975685">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975690">p</span><span class="op" id="5975691">.</span><span class="ident" id="5975692">setComment</span><span class="op" id="5975702">(</span><span class="ident" id="5975703">f</span><span class="op" id="5975704">.</span><span class="ident" id="5975705">Doc</span><span class="op" id="5975708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975713">p</span><span class="op" id="5975714">.</span><span class="ident" id="5975715">recordLine</span><span class="op" id="5975725">(</span><span class="op" id="5975726">&amp;</span><span class="ident" id="5975727">line</span><span class="op" id="5975731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975736">if</span>&nbsp;<span class="builtinfunc" id="5975739">len</span><span class="op" id="5975742">(</span><span class="ident" id="5975743">f</span><span class="op" id="5975744">.</span><span class="ident" id="5975745">Names</span><span class="op" id="5975750">)</span>&nbsp;<span class="op" id="5975752">&gt;</span>&nbsp;<span class="num" id="5975754">0</span>&nbsp;<span class="op" id="5975756">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5975762">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975782">p</span><span class="op" id="5975783">.</span><span class="ident" id="5975784">identList</span><span class="op" id="5975793">(</span><span class="ident" id="5975794">f</span><span class="op" id="5975795">.</span><span class="ident" id="5975796">Names</span><span class="op" id="5975801">,</span>&nbsp;<span class="builtintype" id="5975803">false</span><span class="op" id="5975808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975814">p</span><span class="op" id="5975815">.</span><span class="builtinfunc" id="5975816">print</span><span class="op" id="5975821">(</span><span class="ident" id="5975822">sep</span><span class="op" id="5975825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975831">p</span><span class="op" id="5975832">.</span><span class="ident" id="5975833">expr</span><span class="op" id="5975837">(</span><span class="ident" id="5975838">f</span><span class="op" id="5975839">.</span><span class="ident" id="5975840">Type</span><span class="op" id="5975844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975850">extraTabs</span>&nbsp;<span class="op" id="5975860">=</span>&nbsp;<span class="num" id="5975862">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975867">}</span>&nbsp;<span class="keyword" id="5975869">else</span>&nbsp;<span class="op" id="5975874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5975880">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975903">p</span><span class="op" id="5975904">.</span><span class="ident" id="5975905">expr</span><span class="op" id="5975909">(</span><span class="ident" id="5975910">f</span><span class="op" id="5975911">.</span><span class="ident" id="5975912">Type</span><span class="op" id="5975916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975922">extraTabs</span>&nbsp;<span class="op" id="5975932">=</span>&nbsp;<span class="num" id="5975934">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5975939">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975944">if</span>&nbsp;<span class="ident" id="5975947">f</span><span class="op" id="5975948">.</span><span class="ident" id="5975949">Tag</span>&nbsp;<span class="op" id="5975953">!=</span>&nbsp;<span class="ident" id="5975956">nil</span>&nbsp;<span class="op" id="5975960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5975966">if</span>&nbsp;<span class="builtinfunc" id="5975969">len</span><span class="op" id="5975972">(</span><span class="ident" id="5975973">f</span><span class="op" id="5975974">.</span><span class="ident" id="5975975">Names</span><span class="op" id="5975980">)</span>&nbsp;<span class="op" id="5975982">&gt;</span>&nbsp;<span class="num" id="5975984">0</span>&nbsp;<span class="op" id="5975986">&amp;&amp;</span>&nbsp;<span class="ident" id="5975989">sep</span>&nbsp;<span class="op" id="5975993">==</span>&nbsp;<span class="ident" id="5975996">vtab</span>&nbsp;<span class="op" id="5976001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976008">p</span><span class="op" id="5976009">.</span><span class="builtinfunc" id="5976010">print</span><span class="op" id="5976015">(</span><span class="ident" id="5976016">sep</span><span class="op" id="5976019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976031">p</span><span class="op" id="5976032">.</span><span class="builtinfunc" id="5976033">print</span><span class="op" id="5976038">(</span><span class="ident" id="5976039">sep</span><span class="op" id="5976042">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976048">p</span><span class="op" id="5976049">.</span><span class="ident" id="5976050">expr</span><span class="op" id="5976054">(</span><span class="ident" id="5976055">f</span><span class="op" id="5976056">.</span><span class="ident" id="5976057">Tag</span><span class="op" id="5976060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976066">extraTabs</span>&nbsp;<span class="op" id="5976076">=</span>&nbsp;<span class="num" id="5976078">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976088">if</span>&nbsp;<span class="ident" id="5976091">f</span><span class="op" id="5976092">.</span><span class="ident" id="5976093">Comment</span>&nbsp;<span class="op" id="5976101">!=</span>&nbsp;<span class="ident" id="5976104">nil</span>&nbsp;<span class="op" id="5976108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976114">for</span>&nbsp;<span class="op" id="5976118">;</span>&nbsp;<span class="ident" id="5976120">extraTabs</span>&nbsp;<span class="op" id="5976130">&gt;</span>&nbsp;<span class="num" id="5976132">0</span><span class="op" id="5976133">;</span>&nbsp;<span class="ident" id="5976135">extraTabs</span><span class="op" id="5976144">--</span>&nbsp;<span class="op" id="5976147">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976154">p</span><span class="op" id="5976155">.</span><span class="builtinfunc" id="5976156">print</span><span class="op" id="5976161">(</span><span class="ident" id="5976162">sep</span><span class="op" id="5976165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976177">p</span><span class="op" id="5976178">.</span><span class="ident" id="5976179">setComment</span><span class="op" id="5976189">(</span><span class="ident" id="5976190">f</span><span class="op" id="5976191">.</span><span class="ident" id="5976192">Comment</span><span class="op" id="5976199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976208">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976212">if</span>&nbsp;<span class="ident" id="5976215">isIncomplete</span>&nbsp;<span class="op" id="5976228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976233">if</span>&nbsp;<span class="builtinfunc" id="5976236">len</span><span class="op" id="5976239">(</span><span class="ident" id="5976240">list</span><span class="op" id="5976244">)</span>&nbsp;<span class="op" id="5976246">&gt;</span>&nbsp;<span class="num" id="5976248">0</span>&nbsp;<span class="op" id="5976250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976256">p</span><span class="op" id="5976257">.</span><span class="builtinfunc" id="5976258">print</span><span class="op" id="5976263">(</span><span class="ident" id="5976264">formfeed</span><span class="op" id="5976272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976282">p</span><span class="op" id="5976283">.</span><span class="ident" id="5976284">flush</span><span class="op" id="5976289">(</span><span class="ident" id="5976290">p</span><span class="op" id="5976291">.</span><span class="ident" id="5976292">posFor</span><span class="op" id="5976298">(</span><span class="ident" id="5976299">rbrace</span><span class="op" id="5976305">)</span><span class="op" id="5976306">,</span>&nbsp;<span class="ident" id="5976308">token</span><span class="op" id="5976313">.</span><span class="ident" id="5976314">RBRACE</span><span class="op" id="5976320">)</span>&nbsp;<span class="comment" id="5976322">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976374">p</span><span class="op" id="5976375">.</span><span class="ident" id="5976376">setLineComment</span><span class="op" id="5976390">(</span><span class="string" id="5976391">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="5976434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976442">}</span>&nbsp;<span class="keyword" id="5976444">else</span>&nbsp;<span class="op" id="5976449">{</span>&nbsp;<span class="comment" id="5976451">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976467">var</span>&nbsp;<span class="ident" id="5976471">line</span>&nbsp;<span class="builtintype" id="5976476">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976482">for</span>&nbsp;<span class="ident" id="5976486">i</span><span class="op" id="5976487">,</span>&nbsp;<span class="ident" id="5976489">f</span>&nbsp;<span class="op" id="5976491">:=</span>&nbsp;<span class="keyword" id="5976494">range</span>&nbsp;<span class="ident" id="5976500">list</span>&nbsp;<span class="op" id="5976505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976510">if</span>&nbsp;<span class="ident" id="5976513">i</span>&nbsp;<span class="op" id="5976515">&gt;</span>&nbsp;<span class="num" id="5976517">0</span>&nbsp;<span class="op" id="5976519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976525">p</span><span class="op" id="5976526">.</span><span class="ident" id="5976527">linebreak</span><span class="op" id="5976536">(</span><span class="ident" id="5976537">p</span><span class="op" id="5976538">.</span><span class="ident" id="5976539">lineFor</span><span class="op" id="5976546">(</span><span class="ident" id="5976547">f</span><span class="op" id="5976548">.</span><span class="ident" id="5976549">Pos</span><span class="op" id="5976552">(</span><span class="op" id="5976553">)</span><span class="op" id="5976554">)</span><span class="op" id="5976555">,</span>&nbsp;<span class="num" id="5976557">1</span><span class="op" id="5976558">,</span>&nbsp;<span class="ident" id="5976560">ignore</span><span class="op" id="5976566">,</span>&nbsp;<span class="ident" id="5976568">p</span><span class="op" id="5976569">.</span><span class="ident" id="5976570">linesFrom</span><span class="op" id="5976579">(</span><span class="ident" id="5976580">line</span><span class="op" id="5976584">)</span>&nbsp;<span class="op" id="5976586">&gt;</span>&nbsp;<span class="num" id="5976588">0</span><span class="op" id="5976589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976594">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976599">p</span><span class="op" id="5976600">.</span><span class="ident" id="5976601">setComment</span><span class="op" id="5976611">(</span><span class="ident" id="5976612">f</span><span class="op" id="5976613">.</span><span class="ident" id="5976614">Doc</span><span class="op" id="5976617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976622">p</span><span class="op" id="5976623">.</span><span class="ident" id="5976624">recordLine</span><span class="op" id="5976634">(</span><span class="op" id="5976635">&amp;</span><span class="ident" id="5976636">line</span><span class="op" id="5976640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976645">if</span>&nbsp;<span class="ident" id="5976648">ftyp</span><span class="op" id="5976652">,</span>&nbsp;<span class="ident" id="5976654">isFtyp</span>&nbsp;<span class="op" id="5976661">:=</span>&nbsp;<span class="ident" id="5976664">f</span><span class="op" id="5976665">.</span><span class="ident" id="5976666">Type</span><span class="op" id="5976670">.</span><span class="op" id="5976671">(</span><span class="op" id="5976672">*</span><span class="ident" id="5976673">ast</span><span class="op" id="5976676">.</span><span class="ident" id="5976677">FuncType</span><span class="op" id="5976685">)</span><span class="op" id="5976686">;</span>&nbsp;<span class="ident" id="5976688">isFtyp</span>&nbsp;<span class="op" id="5976695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5976701">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976715">p</span><span class="op" id="5976716">.</span><span class="ident" id="5976717">expr</span><span class="op" id="5976721">(</span><span class="ident" id="5976722">f</span><span class="op" id="5976723">.</span><span class="ident" id="5976724">Names</span><span class="op" id="5976729">[</span><span class="num" id="5976730">0</span><span class="op" id="5976731">]</span><span class="op" id="5976732">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976738">p</span><span class="op" id="5976739">.</span><span class="ident" id="5976740">signature</span><span class="op" id="5976749">(</span><span class="ident" id="5976750">ftyp</span><span class="op" id="5976754">.</span><span class="ident" id="5976755">Params</span><span class="op" id="5976761">,</span>&nbsp;<span class="ident" id="5976763">ftyp</span><span class="op" id="5976767">.</span><span class="ident" id="5976768">Results</span><span class="op" id="5976775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976780">}</span>&nbsp;<span class="keyword" id="5976782">else</span>&nbsp;<span class="op" id="5976787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5976793">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976819">p</span><span class="op" id="5976820">.</span><span class="ident" id="5976821">expr</span><span class="op" id="5976825">(</span><span class="ident" id="5976826">f</span><span class="op" id="5976827">.</span><span class="ident" id="5976828">Type</span><span class="op" id="5976832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976837">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976842">p</span><span class="op" id="5976843">.</span><span class="ident" id="5976844">setComment</span><span class="op" id="5976854">(</span><span class="ident" id="5976855">f</span><span class="op" id="5976856">.</span><span class="ident" id="5976857">Comment</span><span class="op" id="5976864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976872">if</span>&nbsp;<span class="ident" id="5976875">isIncomplete</span>&nbsp;<span class="op" id="5976888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976893">if</span>&nbsp;<span class="builtinfunc" id="5976896">len</span><span class="op" id="5976899">(</span><span class="ident" id="5976900">list</span><span class="op" id="5976904">)</span>&nbsp;<span class="op" id="5976906">&gt;</span>&nbsp;<span class="num" id="5976908">0</span>&nbsp;<span class="op" id="5976910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976916">p</span><span class="op" id="5976917">.</span><span class="builtinfunc" id="5976918">print</span><span class="op" id="5976923">(</span><span class="ident" id="5976924">formfeed</span><span class="op" id="5976932">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976942">p</span><span class="op" id="5976943">.</span><span class="ident" id="5976944">flush</span><span class="op" id="5976949">(</span><span class="ident" id="5976950">p</span><span class="op" id="5976951">.</span><span class="ident" id="5976952">posFor</span><span class="op" id="5976958">(</span><span class="ident" id="5976959">rbrace</span><span class="op" id="5976965">)</span><span class="op" id="5976966">,</span>&nbsp;<span class="ident" id="5976968">token</span><span class="op" id="5976973">.</span><span class="ident" id="5976974">RBRACE</span><span class="op" id="5976980">)</span>&nbsp;<span class="comment" id="5976982">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977034">p</span><span class="op" id="5977035">.</span><span class="ident" id="5977036">setLineComment</span><span class="op" id="5977050">(</span><span class="string" id="5977051">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="5977095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977106">p</span><span class="op" id="5977107">.</span><span class="builtinfunc" id="5977108">print</span><span class="op" id="5977113">(</span><span class="ident" id="5977114">unindent</span><span class="op" id="5977122">,</span>&nbsp;<span class="ident" id="5977124">formfeed</span><span class="op" id="5977132">,</span>&nbsp;<span class="ident" id="5977134">rbrace</span><span class="op" id="5977140">,</span>&nbsp;<span class="ident" id="5977142">token</span><span class="op" id="5977147">.</span><span class="ident" id="5977148">RBRACE</span><span class="op" id="5977154">)</span><br>
<span class="lineno"></span><span class="op" id="5977156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5977159">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="5977239">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5977255">func</span>&nbsp;<span class="ident" id="5977260">walkBinary</span><span class="op" id="5977270">(</span><span class="ident" id="5977271">e</span>&nbsp;<span class="op" id="5977273">*</span><span class="ident" id="5977274">ast</span><span class="op" id="5977277">.</span><span class="ident" id="5977278">BinaryExpr</span><span class="op" id="5977288">)</span>&nbsp;<span class="op" id="5977290">(</span><span class="ident" id="5977291">has4</span><span class="op" id="5977295">,</span>&nbsp;<span class="ident" id="5977297">has5</span>&nbsp;<span class="builtintype" id="5977302">bool</span><span class="op" id="5977306">,</span>&nbsp;<span class="ident" id="5977308">maxProblem</span>&nbsp;<span class="builtintype" id="5977319">int</span><span class="op" id="5977322">)</span>&nbsp;<span class="op" id="5977324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977327">switch</span>&nbsp;<span class="ident" id="5977334">e</span><span class="op" id="5977335">.</span><span class="ident" id="5977336">Op</span><span class="op" id="5977338">.</span><span class="ident" id="5977339">Precedence</span><span class="op" id="5977349">(</span><span class="op" id="5977350">)</span>&nbsp;<span class="op" id="5977352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977355">case</span>&nbsp;<span class="num" id="5977360">4</span><span class="op" id="5977361">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977365">has4</span>&nbsp;<span class="op" id="5977370">=</span>&nbsp;<span class="builtintype" id="5977372">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977378">case</span>&nbsp;<span class="num" id="5977383">5</span><span class="op" id="5977384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977388">has5</span>&nbsp;<span class="op" id="5977393">=</span>&nbsp;<span class="builtintype" id="5977395">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977405">switch</span>&nbsp;<span class="ident" id="5977412">l</span>&nbsp;<span class="op" id="5977414">:=</span>&nbsp;<span class="ident" id="5977417">e</span><span class="op" id="5977418">.</span><span class="ident" id="5977419">X</span><span class="op" id="5977420">.</span><span class="op" id="5977421">(</span><span class="keyword" id="5977422">type</span><span class="op" id="5977426">)</span>&nbsp;<span class="op" id="5977428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977431">case</span>&nbsp;<span class="op" id="5977436">*</span><span class="ident" id="5977437">ast</span><span class="op" id="5977440">.</span><span class="ident" id="5977441">BinaryExpr</span><span class="op" id="5977451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977455">if</span>&nbsp;<span class="ident" id="5977458">l</span><span class="op" id="5977459">.</span><span class="ident" id="5977460">Op</span><span class="op" id="5977462">.</span><span class="ident" id="5977463">Precedence</span><span class="op" id="5977473">(</span><span class="op" id="5977474">)</span>&nbsp;<span class="op" id="5977476">&lt;</span>&nbsp;<span class="ident" id="5977478">e</span><span class="op" id="5977479">.</span><span class="ident" id="5977480">Op</span><span class="op" id="5977482">.</span><span class="ident" id="5977483">Precedence</span><span class="op" id="5977493">(</span><span class="op" id="5977494">)</span>&nbsp;<span class="op" id="5977496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977501">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977532">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977588">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977600">h4</span><span class="op" id="5977602">,</span>&nbsp;<span class="ident" id="5977604">h5</span><span class="op" id="5977606">,</span>&nbsp;<span class="ident" id="5977608">mp</span>&nbsp;<span class="op" id="5977611">:=</span>&nbsp;<span class="ident" id="5977614">walkBinary</span><span class="op" id="5977624">(</span><span class="ident" id="5977625">l</span><span class="op" id="5977626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977630">has4</span>&nbsp;<span class="op" id="5977635">=</span>&nbsp;<span class="ident" id="5977637">has4</span>&nbsp;<span class="op" id="5977642">||</span>&nbsp;<span class="ident" id="5977645">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977650">has5</span>&nbsp;<span class="op" id="5977655">=</span>&nbsp;<span class="ident" id="5977657">has5</span>&nbsp;<span class="op" id="5977662">||</span>&nbsp;<span class="ident" id="5977665">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977670">if</span>&nbsp;<span class="ident" id="5977673">maxProblem</span>&nbsp;<span class="op" id="5977684">&lt;</span>&nbsp;<span class="ident" id="5977686">mp</span>&nbsp;<span class="op" id="5977689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977694">maxProblem</span>&nbsp;<span class="op" id="5977705">=</span>&nbsp;<span class="ident" id="5977707">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977719">switch</span>&nbsp;<span class="ident" id="5977726">r</span>&nbsp;<span class="op" id="5977728">:=</span>&nbsp;<span class="ident" id="5977731">e</span><span class="op" id="5977732">.</span><span class="ident" id="5977733">Y</span><span class="op" id="5977734">.</span><span class="op" id="5977735">(</span><span class="keyword" id="5977736">type</span><span class="op" id="5977740">)</span>&nbsp;<span class="op" id="5977742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977745">case</span>&nbsp;<span class="op" id="5977750">*</span><span class="ident" id="5977751">ast</span><span class="op" id="5977754">.</span><span class="ident" id="5977755">BinaryExpr</span><span class="op" id="5977765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977769">if</span>&nbsp;<span class="ident" id="5977772">r</span><span class="op" id="5977773">.</span><span class="ident" id="5977774">Op</span><span class="op" id="5977776">.</span><span class="ident" id="5977777">Precedence</span><span class="op" id="5977787">(</span><span class="op" id="5977788">)</span>&nbsp;<span class="op" id="5977790">&lt;=</span>&nbsp;<span class="ident" id="5977793">e</span><span class="op" id="5977794">.</span><span class="ident" id="5977795">Op</span><span class="op" id="5977797">.</span><span class="ident" id="5977798">Precedence</span><span class="op" id="5977808">(</span><span class="op" id="5977809">)</span>&nbsp;<span class="op" id="5977811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977816">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977847">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977903">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977915">h4</span><span class="op" id="5977917">,</span>&nbsp;<span class="ident" id="5977919">h5</span><span class="op" id="5977921">,</span>&nbsp;<span class="ident" id="5977923">mp</span>&nbsp;<span class="op" id="5977926">:=</span>&nbsp;<span class="ident" id="5977929">walkBinary</span><span class="op" id="5977939">(</span><span class="ident" id="5977940">r</span><span class="op" id="5977941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977945">has4</span>&nbsp;<span class="op" id="5977950">=</span>&nbsp;<span class="ident" id="5977952">has4</span>&nbsp;<span class="op" id="5977957">||</span>&nbsp;<span class="ident" id="5977960">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977965">has5</span>&nbsp;<span class="op" id="5977970">=</span>&nbsp;<span class="ident" id="5977972">has5</span>&nbsp;<span class="op" id="5977977">||</span>&nbsp;<span class="ident" id="5977980">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977985">if</span>&nbsp;<span class="ident" id="5977988">maxProblem</span>&nbsp;<span class="op" id="5977999">&lt;</span>&nbsp;<span class="ident" id="5978001">mp</span>&nbsp;<span class="op" id="5978004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978009">maxProblem</span>&nbsp;<span class="op" id="5978020">=</span>&nbsp;<span class="ident" id="5978022">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978031">case</span>&nbsp;<span class="op" id="5978036">*</span><span class="ident" id="5978037">ast</span><span class="op" id="5978040">.</span><span class="ident" id="5978041">StarExpr</span><span class="op" id="5978049">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978053">if</span>&nbsp;<span class="ident" id="5978056">e</span><span class="op" id="5978057">.</span><span class="ident" id="5978058">Op</span>&nbsp;<span class="op" id="5978061">==</span>&nbsp;<span class="ident" id="5978064">token</span><span class="op" id="5978069">.</span><span class="ident" id="5978070">QUO</span>&nbsp;<span class="op" id="5978074">{</span>&nbsp;<span class="comment" id="5978076">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978087">maxProblem</span>&nbsp;<span class="op" id="5978098">=</span>&nbsp;<span class="num" id="5978100">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978108">case</span>&nbsp;<span class="op" id="5978113">*</span><span class="ident" id="5978114">ast</span><span class="op" id="5978117">.</span><span class="ident" id="5978118">UnaryExpr</span><span class="op" id="5978127">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978131">switch</span>&nbsp;<span class="ident" id="5978138">e</span><span class="op" id="5978139">.</span><span class="ident" id="5978140">Op</span><span class="op" id="5978142">.</span><span class="ident" id="5978143">String</span><span class="op" id="5978149">(</span><span class="op" id="5978150">)</span>&nbsp;<span class="op" id="5978152">+</span>&nbsp;<span class="ident" id="5978154">r</span><span class="op" id="5978155">.</span><span class="ident" id="5978156">Op</span><span class="op" id="5978158">.</span><span class="ident" id="5978159">String</span><span class="op" id="5978165">(</span><span class="op" id="5978166">)</span>&nbsp;<span class="op" id="5978168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978172">case</span>&nbsp;<span class="string" id="5978177">&#34;/*&#34;</span><span class="op" id="5978181">,</span>&nbsp;<span class="string" id="5978183">&#34;&amp;&amp;&#34;</span><span class="op" id="5978187">,</span>&nbsp;<span class="string" id="5978189">&#34;&amp;^&#34;</span><span class="op" id="5978193">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978198">maxProblem</span>&nbsp;<span class="op" id="5978209">=</span>&nbsp;<span class="num" id="5978211">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978215">case</span>&nbsp;<span class="string" id="5978220">&#34;++&#34;</span><span class="op" id="5978224">,</span>&nbsp;<span class="string" id="5978226">&#34;--&#34;</span><span class="op" id="5978230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978235">if</span>&nbsp;<span class="ident" id="5978238">maxProblem</span>&nbsp;<span class="op" id="5978249">&lt;</span>&nbsp;<span class="num" id="5978251">4</span>&nbsp;<span class="op" id="5978253">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978259">maxProblem</span>&nbsp;<span class="op" id="5978270">=</span>&nbsp;<span class="num" id="5978272">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978287">return</span><br>
<span class="lineno">560</span><span class="op" id="5978294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5978297">func</span>&nbsp;<span class="ident" id="5978302">cutoff</span><span class="op" id="5978308">(</span><span class="ident" id="5978309">e</span>&nbsp;<span class="op" id="5978311">*</span><span class="ident" id="5978312">ast</span><span class="op" id="5978315">.</span><span class="ident" id="5978316">BinaryExpr</span><span class="op" id="5978326">,</span>&nbsp;<span class="ident" id="5978328">depth</span>&nbsp;<span class="builtintype" id="5978334">int</span><span class="op" id="5978337">)</span>&nbsp;<span class="builtintype" id="5978339">int</span>&nbsp;<span class="op" id="5978343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978346">has4</span><span class="op" id="5978350">,</span>&nbsp;<span class="ident" id="5978352">has5</span><span class="op" id="5978356">,</span>&nbsp;<span class="ident" id="5978358">maxProblem</span>&nbsp;<span class="op" id="5978369">:=</span>&nbsp;<span class="ident" id="5978372">walkBinary</span><span class="op" id="5978382">(</span><span class="ident" id="5978383">e</span><span class="op" id="5978384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978387">if</span>&nbsp;<span class="ident" id="5978390">maxProblem</span>&nbsp;<span class="op" id="5978401">&gt;</span>&nbsp;<span class="num" id="5978403">0</span>&nbsp;<span class="op" id="5978405">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978409">return</span>&nbsp;<span class="ident" id="5978416">maxProblem</span>&nbsp;<span class="op" id="5978427">+</span>&nbsp;<span class="num" id="5978429">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978435">if</span>&nbsp;<span class="ident" id="5978438">has4</span>&nbsp;<span class="op" id="5978443">&amp;&amp;</span>&nbsp;<span class="ident" id="5978446">has5</span>&nbsp;<span class="op" id="5978451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978455">if</span>&nbsp;<span class="ident" id="5978458">depth</span>&nbsp;<span class="op" id="5978464">==</span>&nbsp;<span class="num" id="5978467">1</span>&nbsp;<span class="op" id="5978469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978474">return</span>&nbsp;<span class="num" id="5978481">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978489">return</span>&nbsp;<span class="num" id="5978496">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978502">if</span>&nbsp;<span class="ident" id="5978505">depth</span>&nbsp;<span class="op" id="5978511">==</span>&nbsp;<span class="num" id="5978514">1</span>&nbsp;<span class="op" id="5978516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978520">return</span>&nbsp;<span class="num" id="5978527">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978533">return</span>&nbsp;<span class="num" id="5978540">4</span><br>
<span class="lineno"></span><span class="op" id="5978542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5978545">func</span>&nbsp;<span class="ident" id="5978550">diffPrec</span><span class="op" id="5978558">(</span><span class="ident" id="5978559">expr</span>&nbsp;<span class="ident" id="5978564">ast</span><span class="op" id="5978567">.</span><span class="ident" id="5978568">Expr</span><span class="op" id="5978572">,</span>&nbsp;<span class="ident" id="5978574">prec</span>&nbsp;<span class="builtintype" id="5978579">int</span><span class="op" id="5978582">)</span>&nbsp;<span class="builtintype" id="5978584">int</span>&nbsp;<span class="op" id="5978588">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978591">x</span><span class="op" id="5978592">,</span>&nbsp;<span class="ident" id="5978594">ok</span>&nbsp;<span class="op" id="5978597">:=</span>&nbsp;<span class="ident" id="5978600">expr</span><span class="op" id="5978604">.</span><span class="op" id="5978605">(</span><span class="op" id="5978606">*</span><span class="ident" id="5978607">ast</span><span class="op" id="5978610">.</span><span class="ident" id="5978611">BinaryExpr</span><span class="op" id="5978621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978624">if</span>&nbsp;<span class="op" id="5978627">!</span><span class="ident" id="5978628">ok</span>&nbsp;<span class="op" id="5978631">||</span>&nbsp;<span class="ident" id="5978634">prec</span>&nbsp;<span class="op" id="5978639">!=</span>&nbsp;<span class="ident" id="5978642">x</span><span class="op" id="5978643">.</span><span class="ident" id="5978644">Op</span><span class="op" id="5978646">.</span><span class="ident" id="5978647">Precedence</span><span class="op" id="5978657">(</span><span class="op" id="5978658">)</span>&nbsp;<span class="op" id="5978660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978664">return</span>&nbsp;<span class="num" id="5978671">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978677">return</span>&nbsp;<span class="num" id="5978684">0</span><br>
<span class="lineno">585</span><span class="op" id="5978686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5978689">func</span>&nbsp;<span class="ident" id="5978694">reduceDepth</span><span class="op" id="5978705">(</span><span class="ident" id="5978706">depth</span>&nbsp;<span class="builtintype" id="5978712">int</span><span class="op" id="5978715">)</span>&nbsp;<span class="builtintype" id="5978717">int</span>&nbsp;<span class="op" id="5978721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978724">depth</span><span class="op" id="5978729">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978733">if</span>&nbsp;<span class="ident" id="5978736">depth</span>&nbsp;<span class="op" id="5978742">&lt;</span>&nbsp;<span class="num" id="5978744">1</span>&nbsp;<span class="op" id="5978746">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978750">depth</span>&nbsp;<span class="op" id="5978756">=</span>&nbsp;<span class="num" id="5978758">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978764">return</span>&nbsp;<span class="ident" id="5978771">depth</span><br>
<span class="lineno"></span><span class="op" id="5978777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="5978780">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5978848">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5978914">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="5978953">//</span><br>
<span class="lineno"></span><span class="comment" id="5978956">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="5978980">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="5979020">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="5979048">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="5979086">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="5979106">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="5979126">//</span><br>
<span class="lineno"></span><span class="comment" id="5979129">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="5979205">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="5979292">//</span><br>
<span class="lineno"></span><span class="comment" id="5979295">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="5979371">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="5979448">//</span><br>
<span class="lineno"></span><span class="comment" id="5979451">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="5979519">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="5979590">//</span><br>
<span class="lineno">615</span><span class="comment" id="5979593">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5979602">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5979611">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;^&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5979620">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp++&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno"></span><span class="comment" id="5979629">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp--&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno">620</span><span class="comment" id="5979638">//</span><br>
<span class="lineno"></span><span class="comment" id="5979641">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="5979707">//</span><br>
<span class="lineno"></span><span class="comment" id="5979710">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="5979784">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="5979849">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5979897">//</span><br>
<span class="lineno"></span><span class="comment" id="5979900">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5979974">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="5980027">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="5980075">//</span><br>
<span class="lineno"></span><span class="keyword" id="5980078">func</span>&nbsp;<span class="op" id="5980083">(</span><span class="ident" id="5980084">p</span>&nbsp;<span class="op" id="5980086">*</span><span class="ident" id="5980087">printer</span><span class="op" id="5980094">)</span>&nbsp;<span class="ident" id="5980096">binaryExpr</span><span class="op" id="5980106">(</span><span class="ident" id="5980107">x</span>&nbsp;<span class="op" id="5980109">*</span><span class="ident" id="5980110">ast</span><span class="op" id="5980113">.</span><span class="ident" id="5980114">BinaryExpr</span><span class="op" id="5980124">,</span>&nbsp;<span class="ident" id="5980126">prec1</span><span class="op" id="5980131">,</span>&nbsp;<span class="ident" id="5980133">cutoff</span><span class="op" id="5980139">,</span>&nbsp;<span class="ident" id="5980141">depth</span>&nbsp;<span class="builtintype" id="5980147">int</span><span class="op" id="5980150">)</span>&nbsp;<span class="op" id="5980152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980155">prec</span>&nbsp;<span class="op" id="5980160">:=</span>&nbsp;<span class="ident" id="5980163">x</span><span class="op" id="5980164">.</span><span class="ident" id="5980165">Op</span><span class="op" id="5980167">.</span><span class="ident" id="5980168">Precedence</span><span class="op" id="5980178">(</span><span class="op" id="5980179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5980182">if</span>&nbsp;<span class="ident" id="5980185">prec</span>&nbsp;<span class="op" id="5980190">&lt;</span>&nbsp;<span class="ident" id="5980192">prec1</span>&nbsp;<span class="op" id="5980198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5980202">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5980226">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5980294">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980362">p</span><span class="op" id="5980363">.</span><span class="builtinfunc" id="5980364">print</span><span class="op" id="5980369">(</span><span class="ident" id="5980370">token</span><span class="op" id="5980375">.</span><span class="ident" id="5980376">LPAREN</span><span class="op" id="5980382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980386">p</span><span class="op" id="5980387">.</span><span class="ident" id="5980388">expr0</span><span class="op" id="5980393">(</span><span class="ident" id="5980394">x</span><span class="op" id="5980395">,</span>&nbsp;<span class="ident" id="5980397">reduceDepth</span><span class="op" id="5980408">(</span><span class="ident" id="5980409">depth</span><span class="op" id="5980414">)</span><span class="op" id="5980415">)</span>&nbsp;<span class="comment" id="5980417">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980458">p</span><span class="op" id="5980459">.</span><span class="builtinfunc" id="5980460">print</span><span class="op" id="5980465">(</span><span class="ident" id="5980466">token</span><span class="op" id="5980471">.</span><span class="ident" id="5980472">RPAREN</span><span class="op" id="5980478">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5980482">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5980490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980494">printBlank</span>&nbsp;<span class="op" id="5980505">:=</span>&nbsp;<span class="ident" id="5980508">prec</span>&nbsp;<span class="op" id="5980513">&lt;</span>&nbsp;<span class="ident" id="5980515">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980524">ws</span>&nbsp;<span class="op" id="5980527">:=</span>&nbsp;<span class="ident" id="5980530">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980538">p</span><span class="op" id="5980539">.</span><span class="ident" id="5980540">expr1</span><span class="op" id="5980545">(</span><span class="ident" id="5980546">x</span><span class="op" id="5980547">.</span><span class="ident" id="5980548">X</span><span class="op" id="5980549">,</span>&nbsp;<span class="ident" id="5980551">prec</span><span class="op" id="5980555">,</span>&nbsp;<span class="ident" id="5980557">depth</span><span class="op" id="5980562">+</span><span class="ident" id="5980563">diffPrec</span><span class="op" id="5980571">(</span><span class="ident" id="5980572">x</span><span class="op" id="5980573">.</span><span class="ident" id="5980574">X</span><span class="op" id="5980575">,</span>&nbsp;<span class="ident" id="5980577">prec</span><span class="op" id="5980581">)</span><span class="op" id="5980582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5980585">if</span>&nbsp;<span class="ident" id="5980588">printBlank</span>&nbsp;<span class="op" id="5980599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980603">p</span><span class="op" id="5980604">.</span><span class="builtinfunc" id="5980605">print</span><span class="op" id="5980610">(</span><span class="ident" id="5980611">blank</span><span class="op" id="5980616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5980619">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980622">xline</span>&nbsp;<span class="op" id="5980628">:=</span>&nbsp;<span class="ident" id="5980631">p</span><span class="op" id="5980632">.</span><span class="ident" id="5980633">pos</span><span class="op" id="5980636">.</span><span class="ident" id="5980637">Line</span>&nbsp;<span class="comment" id="5980642">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980696">yline</span>&nbsp;<span class="op" id="5980702">:=</span>&nbsp;<span class="ident" id="5980705">p</span><span class="op" id="5980706">.</span><span class="ident" id="5980707">lineFor</span><span class="op" id="5980714">(</span><span class="ident" id="5980715">x</span><span class="op" id="5980716">.</span><span class="ident" id="5980717">Y</span><span class="op" id="5980718">.</span><span class="ident" id="5980719">Pos</span><span class="op" id="5980722">(</span><span class="op" id="5980723">)</span><span class="op" id="5980724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980727">p</span><span class="op" id="5980728">.</span><span class="builtinfunc" id="5980729">print</span><span class="op" id="5980734">(</span><span class="ident" id="5980735">x</span><span class="op" id="5980736">.</span><span class="ident" id="5980737">OpPos</span><span class="op" id="5980742">,</span>&nbsp;<span class="ident" id="5980744">x</span><span class="op" id="5980745">.</span><span class="ident" id="5980746">Op</span><span class="op" id="5980748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5980751">if</span>&nbsp;<span class="ident" id="5980754">xline</span>&nbsp;<span class="op" id="5980760">!=</span>&nbsp;<span class="ident" id="5980763">yline</span>&nbsp;<span class="op" id="5980769">&amp;&amp;</span>&nbsp;<span class="ident" id="5980772">xline</span>&nbsp;<span class="op" id="5980778">&gt;</span>&nbsp;<span class="num" id="5980780">0</span>&nbsp;<span class="op" id="5980782">&amp;&amp;</span>&nbsp;<span class="ident" id="5980785">yline</span>&nbsp;<span class="op" id="5980791">&gt;</span>&nbsp;<span class="num" id="5980793">0</span>&nbsp;<span class="op" id="5980795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5980799">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5980861">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5980880">if</span>&nbsp;<span class="ident" id="5980883">p</span><span class="op" id="5980884">.</span><span class="ident" id="5980885">linebreak</span><span class="op" id="5980894">(</span><span class="ident" id="5980895">yline</span><span class="op" id="5980900">,</span>&nbsp;<span class="num" id="5980902">1</span><span class="op" id="5980903">,</span>&nbsp;<span class="ident" id="5980905">ws</span><span class="op" id="5980907">,</span>&nbsp;<span class="builtintype" id="5980909">true</span><span class="op" id="5980913">)</span>&nbsp;<span class="op" id="5980915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980920">ws</span>&nbsp;<span class="op" id="5980923">=</span>&nbsp;<span class="ident" id="5980925">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5980935">printBlank</span>&nbsp;<span class="op" id="5980946">=</span>&nbsp;<span class="builtintype" id="5980948">false</span>&nbsp;<span class="comment" id="5980954">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5980985">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5980988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5980991">if</span>&nbsp;<span class="ident" id="5980994">printBlank</span>&nbsp;<span class="op" id="5981005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981009">p</span><span class="op" id="5981010">.</span><span class="builtinfunc" id="5981011">print</span><span class="op" id="5981016">(</span><span class="ident" id="5981017">blank</span><span class="op" id="5981022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981028">p</span><span class="op" id="5981029">.</span><span class="ident" id="5981030">expr1</span><span class="op" id="5981035">(</span><span class="ident" id="5981036">x</span><span class="op" id="5981037">.</span><span class="ident" id="5981038">Y</span><span class="op" id="5981039">,</span>&nbsp;<span class="ident" id="5981041">prec</span><span class="op" id="5981045">+</span><span class="num" id="5981046">1</span><span class="op" id="5981047">,</span>&nbsp;<span class="ident" id="5981049">depth</span><span class="op" id="5981054">+</span><span class="num" id="5981055">1</span><span class="op" id="5981056">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981059">if</span>&nbsp;<span class="ident" id="5981062">ws</span>&nbsp;<span class="op" id="5981065">==</span>&nbsp;<span class="ident" id="5981068">ignore</span>&nbsp;<span class="op" id="5981075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981079">p</span><span class="op" id="5981080">.</span><span class="builtinfunc" id="5981081">print</span><span class="op" id="5981086">(</span><span class="ident" id="5981087">unindent</span><span class="op" id="5981095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981098">}</span><br>
<span class="lineno"></span><span class="op" id="5981100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="5981103">func</span>&nbsp;<span class="ident" id="5981108">isBinary</span><span class="op" id="5981116">(</span><span class="ident" id="5981117">expr</span>&nbsp;<span class="ident" id="5981122">ast</span><span class="op" id="5981125">.</span><span class="ident" id="5981126">Expr</span><span class="op" id="5981130">)</span>&nbsp;<span class="builtintype" id="5981132">bool</span>&nbsp;<span class="op" id="5981137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981140">_</span><span class="op" id="5981141">,</span>&nbsp;<span class="ident" id="5981143">ok</span>&nbsp;<span class="op" id="5981146">:=</span>&nbsp;<span class="ident" id="5981149">expr</span><span class="op" id="5981153">.</span><span class="op" id="5981154">(</span><span class="op" id="5981155">*</span><span class="ident" id="5981156">ast</span><span class="op" id="5981159">.</span><span class="ident" id="5981160">BinaryExpr</span><span class="op" id="5981170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981173">return</span>&nbsp;<span class="ident" id="5981180">ok</span><br>
<span class="lineno"></span><span class="op" id="5981183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5981186">func</span>&nbsp;<span class="op" id="5981191">(</span><span class="ident" id="5981192">p</span>&nbsp;<span class="op" id="5981194">*</span><span class="ident" id="5981195">printer</span><span class="op" id="5981202">)</span>&nbsp;<span class="ident" id="5981204">expr1</span><span class="op" id="5981209">(</span><span class="ident" id="5981210">expr</span>&nbsp;<span class="ident" id="5981215">ast</span><span class="op" id="5981218">.</span><span class="ident" id="5981219">Expr</span><span class="op" id="5981223">,</span>&nbsp;<span class="ident" id="5981225">prec1</span><span class="op" id="5981230">,</span>&nbsp;<span class="ident" id="5981232">depth</span>&nbsp;<span class="builtintype" id="5981238">int</span><span class="op" id="5981241">)</span>&nbsp;<span class="op" id="5981243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981246">p</span><span class="op" id="5981247">.</span><span class="builtinfunc" id="5981248">print</span><span class="op" id="5981253">(</span><span class="ident" id="5981254">expr</span><span class="op" id="5981258">.</span><span class="ident" id="5981259">Pos</span><span class="op" id="5981262">(</span><span class="op" id="5981263">)</span><span class="op" id="5981264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981268">switch</span>&nbsp;<span class="ident" id="5981275">x</span>&nbsp;<span class="op" id="5981277">:=</span>&nbsp;<span class="ident" id="5981280">expr</span><span class="op" id="5981284">.</span><span class="op" id="5981285">(</span><span class="keyword" id="5981286">type</span><span class="op" id="5981290">)</span>&nbsp;<span class="op" id="5981292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981295">case</span>&nbsp;<span class="op" id="5981300">*</span><span class="ident" id="5981301">ast</span><span class="op" id="5981304">.</span><span class="ident" id="5981305">BadExpr</span><span class="op" id="5981312">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981316">p</span><span class="op" id="5981317">.</span><span class="builtinfunc" id="5981318">print</span><span class="op" id="5981323">(</span><span class="string" id="5981324">&#34;BadExpr&#34;</span><span class="op" id="5981333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981337">case</span>&nbsp;<span class="op" id="5981342">*</span><span class="ident" id="5981343">ast</span><span class="op" id="5981346">.</span><span class="ident" id="5981347">Ident</span><span class="op" id="5981352">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981356">p</span><span class="op" id="5981357">.</span><span class="builtinfunc" id="5981358">print</span><span class="op" id="5981363">(</span><span class="ident" id="5981364">x</span><span class="op" id="5981365">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981369">case</span>&nbsp;<span class="op" id="5981374">*</span><span class="ident" id="5981375">ast</span><span class="op" id="5981378">.</span><span class="ident" id="5981379">BinaryExpr</span><span class="op" id="5981389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981393">if</span>&nbsp;<span class="ident" id="5981396">depth</span>&nbsp;<span class="op" id="5981402">&lt;</span>&nbsp;<span class="num" id="5981404">1</span>&nbsp;<span class="op" id="5981406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981411">p</span><span class="op" id="5981412">.</span><span class="ident" id="5981413">internalError</span><span class="op" id="5981426">(</span><span class="string" id="5981427">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="5981439">,</span>&nbsp;<span class="ident" id="5981441">depth</span><span class="op" id="5981446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981451">depth</span>&nbsp;<span class="op" id="5981457">=</span>&nbsp;<span class="num" id="5981459">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981463">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981467">p</span><span class="op" id="5981468">.</span><span class="ident" id="5981469">binaryExpr</span><span class="op" id="5981479">(</span><span class="ident" id="5981480">x</span><span class="op" id="5981481">,</span>&nbsp;<span class="ident" id="5981483">prec1</span><span class="op" id="5981488">,</span>&nbsp;<span class="ident" id="5981490">cutoff</span><span class="op" id="5981496">(</span><span class="ident" id="5981497">x</span><span class="op" id="5981498">,</span>&nbsp;<span class="ident" id="5981500">depth</span><span class="op" id="5981505">)</span><span class="op" id="5981506">,</span>&nbsp;<span class="ident" id="5981508">depth</span><span class="op" id="5981513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981517">case</span>&nbsp;<span class="op" id="5981522">*</span><span class="ident" id="5981523">ast</span><span class="op" id="5981526">.</span><span class="ident" id="5981527">KeyValueExpr</span><span class="op" id="5981539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981543">p</span><span class="op" id="5981544">.</span><span class="ident" id="5981545">expr</span><span class="op" id="5981549">(</span><span class="ident" id="5981550">x</span><span class="op" id="5981551">.</span><span class="ident" id="5981552">Key</span><span class="op" id="5981555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981559">p</span><span class="op" id="5981560">.</span><span class="builtinfunc" id="5981561">print</span><span class="op" id="5981566">(</span><span class="ident" id="5981567">x</span><span class="op" id="5981568">.</span><span class="ident" id="5981569">Colon</span><span class="op" id="5981574">,</span>&nbsp;<span class="ident" id="5981576">token</span><span class="op" id="5981581">.</span><span class="ident" id="5981582">COLON</span><span class="op" id="5981587">,</span>&nbsp;<span class="ident" id="5981589">blank</span><span class="op" id="5981594">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981598">p</span><span class="op" id="5981599">.</span><span class="ident" id="5981600">expr</span><span class="op" id="5981604">(</span><span class="ident" id="5981605">x</span><span class="op" id="5981606">.</span><span class="ident" id="5981607">Value</span><span class="op" id="5981612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981616">case</span>&nbsp;<span class="op" id="5981621">*</span><span class="ident" id="5981622">ast</span><span class="op" id="5981625">.</span><span class="ident" id="5981626">StarExpr</span><span class="op" id="5981634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981638">const</span>&nbsp;<span class="ident" id="5981644">prec</span>&nbsp;<span class="op" id="5981649">=</span>&nbsp;<span class="ident" id="5981651">token</span><span class="op" id="5981656">.</span><span class="ident" id="5981657">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981669">if</span>&nbsp;<span class="ident" id="5981672">prec</span>&nbsp;<span class="op" id="5981677">&lt;</span>&nbsp;<span class="ident" id="5981679">prec1</span>&nbsp;<span class="op" id="5981685">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5981690">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981715">p</span><span class="op" id="5981716">.</span><span class="builtinfunc" id="5981717">print</span><span class="op" id="5981722">(</span><span class="ident" id="5981723">token</span><span class="op" id="5981728">.</span><span class="ident" id="5981729">LPAREN</span><span class="op" id="5981735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981740">p</span><span class="op" id="5981741">.</span><span class="builtinfunc" id="5981742">print</span><span class="op" id="5981747">(</span><span class="ident" id="5981748">token</span><span class="op" id="5981753">.</span><span class="ident" id="5981754">MUL</span><span class="op" id="5981757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981762">p</span><span class="op" id="5981763">.</span><span class="ident" id="5981764">expr</span><span class="op" id="5981768">(</span><span class="ident" id="5981769">x</span><span class="op" id="5981770">.</span><span class="ident" id="5981771">X</span><span class="op" id="5981772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981777">p</span><span class="op" id="5981778">.</span><span class="builtinfunc" id="5981779">print</span><span class="op" id="5981784">(</span><span class="ident" id="5981785">token</span><span class="op" id="5981790">.</span><span class="ident" id="5981791">RPAREN</span><span class="op" id="5981797">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981801">}</span>&nbsp;<span class="keyword" id="5981803">else</span>&nbsp;<span class="op" id="5981808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5981813">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981841">p</span><span class="op" id="5981842">.</span><span class="builtinfunc" id="5981843">print</span><span class="op" id="5981848">(</span><span class="ident" id="5981849">token</span><span class="op" id="5981854">.</span><span class="ident" id="5981855">MUL</span><span class="op" id="5981858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981863">p</span><span class="op" id="5981864">.</span><span class="ident" id="5981865">expr</span><span class="op" id="5981869">(</span><span class="ident" id="5981870">x</span><span class="op" id="5981871">.</span><span class="ident" id="5981872">X</span><span class="op" id="5981873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981877">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981881">case</span>&nbsp;<span class="op" id="5981886">*</span><span class="ident" id="5981887">ast</span><span class="op" id="5981890">.</span><span class="ident" id="5981891">UnaryExpr</span><span class="op" id="5981900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981904">const</span>&nbsp;<span class="ident" id="5981910">prec</span>&nbsp;<span class="op" id="5981915">=</span>&nbsp;<span class="ident" id="5981917">token</span><span class="op" id="5981922">.</span><span class="ident" id="5981923">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981935">if</span>&nbsp;<span class="ident" id="5981938">prec</span>&nbsp;<span class="op" id="5981943">&lt;</span>&nbsp;<span class="ident" id="5981945">prec1</span>&nbsp;<span class="op" id="5981951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5981956">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981981">p</span><span class="op" id="5981982">.</span><span class="builtinfunc" id="5981983">print</span><span class="op" id="5981988">(</span><span class="ident" id="5981989">token</span><span class="op" id="5981994">.</span><span class="ident" id="5981995">LPAREN</span><span class="op" id="5982001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982006">p</span><span class="op" id="5982007">.</span><span class="ident" id="5982008">expr</span><span class="op" id="5982012">(</span><span class="ident" id="5982013">x</span><span class="op" id="5982014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982019">p</span><span class="op" id="5982020">.</span><span class="builtinfunc" id="5982021">print</span><span class="op" id="5982026">(</span><span class="ident" id="5982027">token</span><span class="op" id="5982032">.</span><span class="ident" id="5982033">RPAREN</span><span class="op" id="5982039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982043">}</span>&nbsp;<span class="keyword" id="5982045">else</span>&nbsp;<span class="op" id="5982050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982055">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982083">p</span><span class="op" id="5982084">.</span><span class="builtinfunc" id="5982085">print</span><span class="op" id="5982090">(</span><span class="ident" id="5982091">x</span><span class="op" id="5982092">.</span><span class="ident" id="5982093">Op</span><span class="op" id="5982095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982100">if</span>&nbsp;<span class="ident" id="5982103">x</span><span class="op" id="5982104">.</span><span class="ident" id="5982105">Op</span>&nbsp;<span class="op" id="5982108">==</span>&nbsp;<span class="ident" id="5982111">token</span><span class="op" id="5982116">.</span><span class="ident" id="5982117">RANGE</span>&nbsp;<span class="op" id="5982123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982129">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982188">p</span><span class="op" id="5982189">.</span><span class="builtinfunc" id="5982190">print</span><span class="op" id="5982195">(</span><span class="ident" id="5982196">blank</span><span class="op" id="5982201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982206">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982211">p</span><span class="op" id="5982212">.</span><span class="ident" id="5982213">expr1</span><span class="op" id="5982218">(</span><span class="ident" id="5982219">x</span><span class="op" id="5982220">.</span><span class="ident" id="5982221">X</span><span class="op" id="5982222">,</span>&nbsp;<span class="ident" id="5982224">prec</span><span class="op" id="5982228">,</span>&nbsp;<span class="ident" id="5982230">depth</span><span class="op" id="5982235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982243">case</span>&nbsp;<span class="op" id="5982248">*</span><span class="ident" id="5982249">ast</span><span class="op" id="5982252">.</span><span class="ident" id="5982253">BasicLit</span><span class="op" id="5982261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982265">p</span><span class="op" id="5982266">.</span><span class="builtinfunc" id="5982267">print</span><span class="op" id="5982272">(</span><span class="ident" id="5982273">x</span><span class="op" id="5982274">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982278">case</span>&nbsp;<span class="op" id="5982283">*</span><span class="ident" id="5982284">ast</span><span class="op" id="5982287">.</span><span class="ident" id="5982288">FuncLit</span><span class="op" id="5982295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982299">p</span><span class="op" id="5982300">.</span><span class="ident" id="5982301">expr</span><span class="op" id="5982305">(</span><span class="ident" id="5982306">x</span><span class="op" id="5982307">.</span><span class="ident" id="5982308">Type</span><span class="op" id="5982312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982316">p</span><span class="op" id="5982317">.</span><span class="ident" id="5982318">adjBlock</span><span class="op" id="5982326">(</span><span class="ident" id="5982327">p</span><span class="op" id="5982328">.</span><span class="ident" id="5982329">distanceFrom</span><span class="op" id="5982341">(</span><span class="ident" id="5982342">x</span><span class="op" id="5982343">.</span><span class="ident" id="5982344">Type</span><span class="op" id="5982348">.</span><span class="ident" id="5982349">Pos</span><span class="op" id="5982352">(</span><span class="op" id="5982353">)</span><span class="op" id="5982354">)</span><span class="op" id="5982355">,</span>&nbsp;<span class="ident" id="5982357">blank</span><span class="op" id="5982362">,</span>&nbsp;<span class="ident" id="5982364">x</span><span class="op" id="5982365">.</span><span class="ident" id="5982366">Body</span><span class="op" id="5982370">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982374">case</span>&nbsp;<span class="op" id="5982379">*</span><span class="ident" id="5982380">ast</span><span class="op" id="5982383">.</span><span class="ident" id="5982384">ParenExpr</span><span class="op" id="5982393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982397">if</span>&nbsp;<span class="ident" id="5982400">_</span><span class="op" id="5982401">,</span>&nbsp;<span class="ident" id="5982403">hasParens</span>&nbsp;<span class="op" id="5982413">:=</span>&nbsp;<span class="ident" id="5982416">x</span><span class="op" id="5982417">.</span><span class="ident" id="5982418">X</span><span class="op" id="5982419">.</span><span class="op" id="5982420">(</span><span class="op" id="5982421">*</span><span class="ident" id="5982422">ast</span><span class="op" id="5982425">.</span><span class="ident" id="5982426">ParenExpr</span><span class="op" id="5982435">)</span><span class="op" id="5982436">;</span>&nbsp;<span class="ident" id="5982438">hasParens</span>&nbsp;<span class="op" id="5982448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982453">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982526">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982610">p</span><span class="op" id="5982611">.</span><span class="ident" id="5982612">expr0</span><span class="op" id="5982617">(</span><span class="ident" id="5982618">x</span><span class="op" id="5982619">.</span><span class="ident" id="5982620">X</span><span class="op" id="5982621">,</span>&nbsp;<span class="ident" id="5982623">depth</span><span class="op" id="5982628">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982632">}</span>&nbsp;<span class="keyword" id="5982634">else</span>&nbsp;<span class="op" id="5982639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982644">p</span><span class="op" id="5982645">.</span><span class="builtinfunc" id="5982646">print</span><span class="op" id="5982651">(</span><span class="ident" id="5982652">token</span><span class="op" id="5982657">.</span><span class="ident" id="5982658">LPAREN</span><span class="op" id="5982664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982669">p</span><span class="op" id="5982670">.</span><span class="ident" id="5982671">expr0</span><span class="op" id="5982676">(</span><span class="ident" id="5982677">x</span><span class="op" id="5982678">.</span><span class="ident" id="5982679">X</span><span class="op" id="5982680">,</span>&nbsp;<span class="ident" id="5982682">reduceDepth</span><span class="op" id="5982693">(</span><span class="ident" id="5982694">depth</span><span class="op" id="5982699">)</span><span class="op" id="5982700">)</span>&nbsp;<span class="comment" id="5982702">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982744">p</span><span class="op" id="5982745">.</span><span class="builtinfunc" id="5982746">print</span><span class="op" id="5982751">(</span><span class="ident" id="5982752">x</span><span class="op" id="5982753">.</span><span class="ident" id="5982754">Rparen</span><span class="op" id="5982760">,</span>&nbsp;<span class="ident" id="5982762">token</span><span class="op" id="5982767">.</span><span class="ident" id="5982768">RPAREN</span><span class="op" id="5982774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982778">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982782">case</span>&nbsp;<span class="op" id="5982787">*</span><span class="ident" id="5982788">ast</span><span class="op" id="5982791">.</span><span class="ident" id="5982792">SelectorExpr</span><span class="op" id="5982804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982808">p</span><span class="op" id="5982809">.</span><span class="ident" id="5982810">expr1</span><span class="op" id="5982815">(</span><span class="ident" id="5982816">x</span><span class="op" id="5982817">.</span><span class="ident" id="5982818">X</span><span class="op" id="5982819">,</span>&nbsp;<span class="ident" id="5982821">token</span><span class="op" id="5982826">.</span><span class="ident" id="5982827">HighestPrec</span><span class="op" id="5982838">,</span>&nbsp;<span class="ident" id="5982840">depth</span><span class="op" id="5982845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982849">p</span><span class="op" id="5982850">.</span><span class="builtinfunc" id="5982851">print</span><span class="op" id="5982856">(</span><span class="ident" id="5982857">token</span><span class="op" id="5982862">.</span><span class="ident" id="5982863">PERIOD</span><span class="op" id="5982869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982873">if</span>&nbsp;<span class="ident" id="5982876">line</span>&nbsp;<span class="op" id="5982881">:=</span>&nbsp;<span class="ident" id="5982884">p</span><span class="op" id="5982885">.</span><span class="ident" id="5982886">lineFor</span><span class="op" id="5982893">(</span><span class="ident" id="5982894">x</span><span class="op" id="5982895">.</span><span class="ident" id="5982896">Sel</span><span class="op" id="5982899">.</span><span class="ident" id="5982900">Pos</span><span class="op" id="5982903">(</span><span class="op" id="5982904">)</span><span class="op" id="5982905">)</span><span class="op" id="5982906">;</span>&nbsp;<span class="ident" id="5982908">p</span><span class="op" id="5982909">.</span><span class="ident" id="5982910">pos</span><span class="op" id="5982913">.</span><span class="ident" id="5982914">IsValid</span><span class="op" id="5982921">(</span><span class="op" id="5982922">)</span>&nbsp;<span class="op" id="5982924">&amp;&amp;</span>&nbsp;<span class="ident" id="5982927">p</span><span class="op" id="5982928">.</span><span class="ident" id="5982929">pos</span><span class="op" id="5982932">.</span><span class="ident" id="5982933">Line</span>&nbsp;<span class="op" id="5982938">&lt;</span>&nbsp;<span class="ident" id="5982940">line</span>&nbsp;<span class="op" id="5982945">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982950">p</span><span class="op" id="5982951">.</span><span class="builtinfunc" id="5982952">print</span><span class="op" id="5982957">(</span><span class="ident" id="5982958">indent</span><span class="op" id="5982964">,</span>&nbsp;<span class="ident" id="5982966">newline</span><span class="op" id="5982973">,</span>&nbsp;<span class="ident" id="5982975">x</span><span class="op" id="5982976">.</span><span class="ident" id="5982977">Sel</span><span class="op" id="5982980">.</span><span class="ident" id="5982981">Pos</span><span class="op" id="5982984">(</span><span class="op" id="5982985">)</span><span class="op" id="5982986">,</span>&nbsp;<span class="ident" id="5982988">x</span><span class="op" id="5982989">.</span><span class="ident" id="5982990">Sel</span><span class="op" id="5982993">,</span>&nbsp;<span class="ident" id="5982995">unindent</span><span class="op" id="5983003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983007">}</span>&nbsp;<span class="keyword" id="5983009">else</span>&nbsp;<span class="op" id="5983014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983019">p</span><span class="op" id="5983020">.</span><span class="builtinfunc" id="5983021">print</span><span class="op" id="5983026">(</span><span class="ident" id="5983027">x</span><span class="op" id="5983028">.</span><span class="ident" id="5983029">Sel</span><span class="op" id="5983032">.</span><span class="ident" id="5983033">Pos</span><span class="op" id="5983036">(</span><span class="op" id="5983037">)</span><span class="op" id="5983038">,</span>&nbsp;<span class="ident" id="5983040">x</span><span class="op" id="5983041">.</span><span class="ident" id="5983042">Sel</span><span class="op" id="5983045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983053">case</span>&nbsp;<span class="op" id="5983058">*</span><span class="ident" id="5983059">ast</span><span class="op" id="5983062">.</span><span class="ident" id="5983063">TypeAssertExpr</span><span class="op" id="5983077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983081">p</span><span class="op" id="5983082">.</span><span class="ident" id="5983083">expr1</span><span class="op" id="5983088">(</span><span class="ident" id="5983089">x</span><span class="op" id="5983090">.</span><span class="ident" id="5983091">X</span><span class="op" id="5983092">,</span>&nbsp;<span class="ident" id="5983094">token</span><span class="op" id="5983099">.</span><span class="ident" id="5983100">HighestPrec</span><span class="op" id="5983111">,</span>&nbsp;<span class="ident" id="5983113">depth</span><span class="op" id="5983118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983122">p</span><span class="op" id="5983123">.</span><span class="builtinfunc" id="5983124">print</span><span class="op" id="5983129">(</span><span class="ident" id="5983130">token</span><span class="op" id="5983135">.</span><span class="ident" id="5983136">PERIOD</span><span class="op" id="5983142">,</span>&nbsp;<span class="ident" id="5983144">x</span><span class="op" id="5983145">.</span><span class="ident" id="5983146">Lparen</span><span class="op" id="5983152">,</span>&nbsp;<span class="ident" id="5983154">token</span><span class="op" id="5983159">.</span><span class="ident" id="5983160">LPAREN</span><span class="op" id="5983166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983170">if</span>&nbsp;<span class="ident" id="5983173">x</span><span class="op" id="5983174">.</span><span class="ident" id="5983175">Type</span>&nbsp;<span class="op" id="5983180">!=</span>&nbsp;<span class="ident" id="5983183">nil</span>&nbsp;<span class="op" id="5983187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983192">p</span><span class="op" id="5983193">.</span><span class="ident" id="5983194">expr</span><span class="op" id="5983198">(</span><span class="ident" id="5983199">x</span><span class="op" id="5983200">.</span><span class="ident" id="5983201">Type</span><span class="op" id="5983205">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983209">}</span>&nbsp;<span class="keyword" id="5983211">else</span>&nbsp;<span class="op" id="5983216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983221">p</span><span class="op" id="5983222">.</span><span class="builtinfunc" id="5983223">print</span><span class="op" id="5983228">(</span><span class="ident" id="5983229">token</span><span class="op" id="5983234">.</span><span class="ident" id="5983235">TYPE</span><span class="op" id="5983239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983247">p</span><span class="op" id="5983248">.</span><span class="builtinfunc" id="5983249">print</span><span class="op" id="5983254">(</span><span class="ident" id="5983255">x</span><span class="op" id="5983256">.</span><span class="ident" id="5983257">Rparen</span><span class="op" id="5983263">,</span>&nbsp;<span class="ident" id="5983265">token</span><span class="op" id="5983270">.</span><span class="ident" id="5983271">RPAREN</span><span class="op" id="5983277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983281">case</span>&nbsp;<span class="op" id="5983286">*</span><span class="ident" id="5983287">ast</span><span class="op" id="5983290">.</span><span class="ident" id="5983291">IndexExpr</span><span class="op" id="5983300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983304">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983380">p</span><span class="op" id="5983381">.</span><span class="ident" id="5983382">expr1</span><span class="op" id="5983387">(</span><span class="ident" id="5983388">x</span><span class="op" id="5983389">.</span><span class="ident" id="5983390">X</span><span class="op" id="5983391">,</span>&nbsp;<span class="ident" id="5983393">token</span><span class="op" id="5983398">.</span><span class="ident" id="5983399">HighestPrec</span><span class="op" id="5983410">,</span>&nbsp;<span class="num" id="5983412">1</span><span class="op" id="5983413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983417">p</span><span class="op" id="5983418">.</span><span class="builtinfunc" id="5983419">print</span><span class="op" id="5983424">(</span><span class="ident" id="5983425">x</span><span class="op" id="5983426">.</span><span class="ident" id="5983427">Lbrack</span><span class="op" id="5983433">,</span>&nbsp;<span class="ident" id="5983435">token</span><span class="op" id="5983440">.</span><span class="ident" id="5983441">LBRACK</span><span class="op" id="5983447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983451">p</span><span class="op" id="5983452">.</span><span class="ident" id="5983453">expr0</span><span class="op" id="5983458">(</span><span class="ident" id="5983459">x</span><span class="op" id="5983460">.</span><span class="ident" id="5983461">Index</span><span class="op" id="5983466">,</span>&nbsp;<span class="ident" id="5983468">depth</span><span class="op" id="5983473">+</span><span class="num" id="5983474">1</span><span class="op" id="5983475">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983479">p</span><span class="op" id="5983480">.</span><span class="builtinfunc" id="5983481">print</span><span class="op" id="5983486">(</span><span class="ident" id="5983487">x</span><span class="op" id="5983488">.</span><span class="ident" id="5983489">Rbrack</span><span class="op" id="5983495">,</span>&nbsp;<span class="ident" id="5983497">token</span><span class="op" id="5983502">.</span><span class="ident" id="5983503">RBRACK</span><span class="op" id="5983509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983513">case</span>&nbsp;<span class="op" id="5983518">*</span><span class="ident" id="5983519">ast</span><span class="op" id="5983522">.</span><span class="ident" id="5983523">SliceExpr</span><span class="op" id="5983532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983536">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983612">p</span><span class="op" id="5983613">.</span><span class="ident" id="5983614">expr1</span><span class="op" id="5983619">(</span><span class="ident" id="5983620">x</span><span class="op" id="5983621">.</span><span class="ident" id="5983622">X</span><span class="op" id="5983623">,</span>&nbsp;<span class="ident" id="5983625">token</span><span class="op" id="5983630">.</span><span class="ident" id="5983631">HighestPrec</span><span class="op" id="5983642">,</span>&nbsp;<span class="num" id="5983644">1</span><span class="op" id="5983645">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983649">p</span><span class="op" id="5983650">.</span><span class="builtinfunc" id="5983651">print</span><span class="op" id="5983656">(</span><span class="ident" id="5983657">x</span><span class="op" id="5983658">.</span><span class="ident" id="5983659">Lbrack</span><span class="op" id="5983665">,</span>&nbsp;<span class="ident" id="5983667">token</span><span class="op" id="5983672">.</span><span class="ident" id="5983673">LBRACK</span><span class="op" id="5983679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983683">indices</span>&nbsp;<span class="op" id="5983691">:=</span>&nbsp;<span class="op" id="5983694">[</span><span class="op" id="5983695">]</span><span class="ident" id="5983696">ast</span><span class="op" id="5983699">.</span><span class="ident" id="5983700">Expr</span><span class="op" id="5983704">{</span><span class="ident" id="5983705">x</span><span class="op" id="5983706">.</span><span class="ident" id="5983707">Low</span><span class="op" id="5983710">,</span>&nbsp;<span class="ident" id="5983712">x</span><span class="op" id="5983713">.</span><span class="ident" id="5983714">High</span><span class="op" id="5983718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983722">if</span>&nbsp;<span class="ident" id="5983725">x</span><span class="op" id="5983726">.</span><span class="ident" id="5983727">Max</span>&nbsp;<span class="op" id="5983731">!=</span>&nbsp;<span class="ident" id="5983734">nil</span>&nbsp;<span class="op" id="5983738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983743">indices</span>&nbsp;<span class="op" id="5983751">=</span>&nbsp;<span class="builtinfunc" id="5983753">append</span><span class="op" id="5983759">(</span><span class="ident" id="5983760">indices</span><span class="op" id="5983767">,</span>&nbsp;<span class="ident" id="5983769">x</span><span class="op" id="5983770">.</span><span class="ident" id="5983771">Max</span><span class="op" id="5983774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983778">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983782">for</span>&nbsp;<span class="ident" id="5983786">i</span><span class="op" id="5983787">,</span>&nbsp;<span class="ident" id="5983789">y</span>&nbsp;<span class="op" id="5983791">:=</span>&nbsp;<span class="keyword" id="5983794">range</span>&nbsp;<span class="ident" id="5983800">indices</span>&nbsp;<span class="op" id="5983808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983813">if</span>&nbsp;<span class="ident" id="5983816">i</span>&nbsp;<span class="op" id="5983818">&gt;</span>&nbsp;<span class="num" id="5983820">0</span>&nbsp;<span class="op" id="5983822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983828">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983912">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983995">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984037">x</span>&nbsp;<span class="op" id="5984039">:=</span>&nbsp;<span class="ident" id="5984042">indices</span><span class="op" id="5984049">[</span><span class="ident" id="5984050">i</span><span class="op" id="5984051">-</span><span class="num" id="5984052">1</span><span class="op" id="5984053">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984059">if</span>&nbsp;<span class="ident" id="5984062">depth</span>&nbsp;<span class="op" id="5984068">&lt;=</span>&nbsp;<span class="num" id="5984071">1</span>&nbsp;<span class="op" id="5984073">&amp;&amp;</span>&nbsp;<span class="ident" id="5984076">x</span>&nbsp;<span class="op" id="5984078">!=</span>&nbsp;<span class="ident" id="5984081">nil</span>&nbsp;<span class="op" id="5984085">&amp;&amp;</span>&nbsp;<span class="ident" id="5984088">y</span>&nbsp;<span class="op" id="5984090">!=</span>&nbsp;<span class="ident" id="5984093">nil</span>&nbsp;<span class="op" id="5984097">&amp;&amp;</span>&nbsp;<span class="op" id="5984100">(</span><span class="ident" id="5984101">isBinary</span><span class="op" id="5984109">(</span><span class="ident" id="5984110">x</span><span class="op" id="5984111">)</span>&nbsp;<span class="op" id="5984113">||</span>&nbsp;<span class="ident" id="5984116">isBinary</span><span class="op" id="5984124">(</span><span class="ident" id="5984125">y</span><span class="op" id="5984126">)</span><span class="op" id="5984127">)</span>&nbsp;<span class="op" id="5984129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984136">p</span><span class="op" id="5984137">.</span><span class="builtinfunc" id="5984138">print</span><span class="op" id="5984143">(</span><span class="ident" id="5984144">blank</span><span class="op" id="5984149">,</span>&nbsp;<span class="ident" id="5984151">token</span><span class="op" id="5984156">.</span><span class="ident" id="5984157">COLON</span><span class="op" id="5984162">,</span>&nbsp;<span class="ident" id="5984164">blank</span><span class="op" id="5984169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984175">}</span>&nbsp;<span class="keyword" id="5984177">else</span>&nbsp;<span class="op" id="5984182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984189">p</span><span class="op" id="5984190">.</span><span class="builtinfunc" id="5984191">print</span><span class="op" id="5984196">(</span><span class="ident" id="5984197">token</span><span class="op" id="5984202">.</span><span class="ident" id="5984203">COLON</span><span class="op" id="5984208">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984224">if</span>&nbsp;<span class="ident" id="5984227">y</span>&nbsp;<span class="op" id="5984229">!=</span>&nbsp;<span class="ident" id="5984232">nil</span>&nbsp;<span class="op" id="5984236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984242">p</span><span class="op" id="5984243">.</span><span class="ident" id="5984244">expr0</span><span class="op" id="5984249">(</span><span class="ident" id="5984250">y</span><span class="op" id="5984251">,</span>&nbsp;<span class="ident" id="5984253">depth</span><span class="op" id="5984258">+</span><span class="num" id="5984259">1</span><span class="op" id="5984260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984265">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984273">p</span><span class="op" id="5984274">.</span><span class="builtinfunc" id="5984275">print</span><span class="op" id="5984280">(</span><span class="ident" id="5984281">x</span><span class="op" id="5984282">.</span><span class="ident" id="5984283">Rbrack</span><span class="op" id="5984289">,</span>&nbsp;<span class="ident" id="5984291">token</span><span class="op" id="5984296">.</span><span class="ident" id="5984297">RBRACK</span><span class="op" id="5984303">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984307">case</span>&nbsp;<span class="op" id="5984312">*</span><span class="ident" id="5984313">ast</span><span class="op" id="5984316">.</span><span class="ident" id="5984317">CallExpr</span><span class="op" id="5984325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984329">if</span>&nbsp;<span class="builtinfunc" id="5984332">len</span><span class="op" id="5984335">(</span><span class="ident" id="5984336">x</span><span class="op" id="5984337">.</span><span class="ident" id="5984338">Args</span><span class="op" id="5984342">)</span>&nbsp;<span class="op" id="5984344">&gt;</span>&nbsp;<span class="num" id="5984346">1</span>&nbsp;<span class="op" id="5984348">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984353">depth</span><span class="op" id="5984358">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984367">if</span>&nbsp;<span class="ident" id="5984370">_</span><span class="op" id="5984371">,</span>&nbsp;<span class="ident" id="5984373">ok</span>&nbsp;<span class="op" id="5984376">:=</span>&nbsp;<span class="ident" id="5984379">x</span><span class="op" id="5984380">.</span><span class="ident" id="5984381">Fun</span><span class="op" id="5984384">.</span><span class="op" id="5984385">(</span><span class="op" id="5984386">*</span><span class="ident" id="5984387">ast</span><span class="op" id="5984390">.</span><span class="ident" id="5984391">FuncType</span><span class="op" id="5984399">)</span><span class="op" id="5984400">;</span>&nbsp;<span class="ident" id="5984402">ok</span>&nbsp;<span class="op" id="5984405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5984410">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984490">p</span><span class="op" id="5984491">.</span><span class="builtinfunc" id="5984492">print</span><span class="op" id="5984497">(</span><span class="ident" id="5984498">token</span><span class="op" id="5984503">.</span><span class="ident" id="5984504">LPAREN</span><span class="op" id="5984510">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984515">p</span><span class="op" id="5984516">.</span><span class="ident" id="5984517">expr1</span><span class="op" id="5984522">(</span><span class="ident" id="5984523">x</span><span class="op" id="5984524">.</span><span class="ident" id="5984525">Fun</span><span class="op" id="5984528">,</span>&nbsp;<span class="ident" id="5984530">token</span><span class="op" id="5984535">.</span><span class="ident" id="5984536">HighestPrec</span><span class="op" id="5984547">,</span>&nbsp;<span class="ident" id="5984549">depth</span><span class="op" id="5984554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984559">p</span><span class="op" id="5984560">.</span><span class="builtinfunc" id="5984561">print</span><span class="op" id="5984566">(</span><span class="ident" id="5984567">token</span><span class="op" id="5984572">.</span><span class="ident" id="5984573">RPAREN</span><span class="op" id="5984579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984583">}</span>&nbsp;<span class="keyword" id="5984585">else</span>&nbsp;<span class="op" id="5984590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984595">p</span><span class="op" id="5984596">.</span><span class="ident" id="5984597">expr1</span><span class="op" id="5984602">(</span><span class="ident" id="5984603">x</span><span class="op" id="5984604">.</span><span class="ident" id="5984605">Fun</span><span class="op" id="5984608">,</span>&nbsp;<span class="ident" id="5984610">token</span><span class="op" id="5984615">.</span><span class="ident" id="5984616">HighestPrec</span><span class="op" id="5984627">,</span>&nbsp;<span class="ident" id="5984629">depth</span><span class="op" id="5984634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984638">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984642">p</span><span class="op" id="5984643">.</span><span class="builtinfunc" id="5984644">print</span><span class="op" id="5984649">(</span><span class="ident" id="5984650">x</span><span class="op" id="5984651">.</span><span class="ident" id="5984652">Lparen</span><span class="op" id="5984658">,</span>&nbsp;<span class="ident" id="5984660">token</span><span class="op" id="5984665">.</span><span class="ident" id="5984666">LPAREN</span><span class="op" id="5984672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984676">if</span>&nbsp;<span class="ident" id="5984679">x</span><span class="op" id="5984680">.</span><span class="ident" id="5984681">Ellipsis</span><span class="op" id="5984689">.</span><span class="ident" id="5984690">IsValid</span><span class="op" id="5984697">(</span><span class="op" id="5984698">)</span>&nbsp;<span class="op" id="5984700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984705">p</span><span class="op" id="5984706">.</span><span class="ident" id="5984707">exprList</span><span class="op" id="5984715">(</span><span class="ident" id="5984716">x</span><span class="op" id="5984717">.</span><span class="ident" id="5984718">Lparen</span><span class="op" id="5984724">,</span>&nbsp;<span class="ident" id="5984726">x</span><span class="op" id="5984727">.</span><span class="ident" id="5984728">Args</span><span class="op" id="5984732">,</span>&nbsp;<span class="ident" id="5984734">depth</span><span class="op" id="5984739">,</span>&nbsp;<span class="num" id="5984741">0</span><span class="op" id="5984742">,</span>&nbsp;<span class="ident" id="5984744">x</span><span class="op" id="5984745">.</span><span class="ident" id="5984746">Ellipsis</span><span class="op" id="5984754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984759">p</span><span class="op" id="5984760">.</span><span class="builtinfunc" id="5984761">print</span><span class="op" id="5984766">(</span><span class="ident" id="5984767">x</span><span class="op" id="5984768">.</span><span class="ident" id="5984769">Ellipsis</span><span class="op" id="5984777">,</span>&nbsp;<span class="ident" id="5984779">token</span><span class="op" id="5984784">.</span><span class="ident" id="5984785">ELLIPSIS</span><span class="op" id="5984793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984798">if</span>&nbsp;<span class="ident" id="5984801">x</span><span class="op" id="5984802">.</span><span class="ident" id="5984803">Rparen</span><span class="op" id="5984809">.</span><span class="ident" id="5984810">IsValid</span><span class="op" id="5984817">(</span><span class="op" id="5984818">)</span>&nbsp;<span class="op" id="5984820">&amp;&amp;</span>&nbsp;<span class="ident" id="5984823">p</span><span class="op" id="5984824">.</span><span class="ident" id="5984825">lineFor</span><span class="op" id="5984832">(</span><span class="ident" id="5984833">x</span><span class="op" id="5984834">.</span><span class="ident" id="5984835">Ellipsis</span><span class="op" id="5984843">)</span>&nbsp;<span class="op" id="5984845">&lt;</span>&nbsp;<span class="ident" id="5984847">p</span><span class="op" id="5984848">.</span><span class="ident" id="5984849">lineFor</span><span class="op" id="5984856">(</span><span class="ident" id="5984857">x</span><span class="op" id="5984858">.</span><span class="ident" id="5984859">Rparen</span><span class="op" id="5984865">)</span>&nbsp;<span class="op" id="5984867">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984873">p</span><span class="op" id="5984874">.</span><span class="builtinfunc" id="5984875">print</span><span class="op" id="5984880">(</span><span class="ident" id="5984881">token</span><span class="op" id="5984886">.</span><span class="ident" id="5984887">COMMA</span><span class="op" id="5984892">,</span>&nbsp;<span class="ident" id="5984894">formfeed</span><span class="op" id="5984902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984911">}</span>&nbsp;<span class="keyword" id="5984913">else</span>&nbsp;<span class="op" id="5984918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984923">p</span><span class="op" id="5984924">.</span><span class="ident" id="5984925">exprList</span><span class="op" id="5984933">(</span><span class="ident" id="5984934">x</span><span class="op" id="5984935">.</span><span class="ident" id="5984936">Lparen</span><span class="op" id="5984942">,</span>&nbsp;<span class="ident" id="5984944">x</span><span class="op" id="5984945">.</span><span class="ident" id="5984946">Args</span><span class="op" id="5984950">,</span>&nbsp;<span class="ident" id="5984952">depth</span><span class="op" id="5984957">,</span>&nbsp;<span class="ident" id="5984959">commaTerm</span><span class="op" id="5984968">,</span>&nbsp;<span class="ident" id="5984970">x</span><span class="op" id="5984971">.</span><span class="ident" id="5984972">Rparen</span><span class="op" id="5984978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984982">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984986">p</span><span class="op" id="5984987">.</span><span class="builtinfunc" id="5984988">print</span><span class="op" id="5984993">(</span><span class="ident" id="5984994">x</span><span class="op" id="5984995">.</span><span class="ident" id="5984996">Rparen</span><span class="op" id="5985002">,</span>&nbsp;<span class="ident" id="5985004">token</span><span class="op" id="5985009">.</span><span class="ident" id="5985010">RPAREN</span><span class="op" id="5985016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985020">case</span>&nbsp;<span class="op" id="5985025">*</span><span class="ident" id="5985026">ast</span><span class="op" id="5985029">.</span><span class="ident" id="5985030">CompositeLit</span><span class="op" id="5985042">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985046">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985143">if</span>&nbsp;<span class="ident" id="5985146">x</span><span class="op" id="5985147">.</span><span class="ident" id="5985148">Type</span>&nbsp;<span class="op" id="5985153">!=</span>&nbsp;<span class="ident" id="5985156">nil</span>&nbsp;<span class="op" id="5985160">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985165">p</span><span class="op" id="5985166">.</span><span class="ident" id="5985167">expr1</span><span class="op" id="5985172">(</span><span class="ident" id="5985173">x</span><span class="op" id="5985174">.</span><span class="ident" id="5985175">Type</span><span class="op" id="5985179">,</span>&nbsp;<span class="ident" id="5985181">token</span><span class="op" id="5985186">.</span><span class="ident" id="5985187">HighestPrec</span><span class="op" id="5985198">,</span>&nbsp;<span class="ident" id="5985200">depth</span><span class="op" id="5985205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985213">p</span><span class="op" id="5985214">.</span><span class="builtinfunc" id="5985215">print</span><span class="op" id="5985220">(</span><span class="ident" id="5985221">x</span><span class="op" id="5985222">.</span><span class="ident" id="5985223">Lbrace</span><span class="op" id="5985229">,</span>&nbsp;<span class="ident" id="5985231">token</span><span class="op" id="5985236">.</span><span class="ident" id="5985237">LBRACE</span><span class="op" id="5985243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985247">p</span><span class="op" id="5985248">.</span><span class="ident" id="5985249">exprList</span><span class="op" id="5985257">(</span><span class="ident" id="5985258">x</span><span class="op" id="5985259">.</span><span class="ident" id="5985260">Lbrace</span><span class="op" id="5985266">,</span>&nbsp;<span class="ident" id="5985268">x</span><span class="op" id="5985269">.</span><span class="ident" id="5985270">Elts</span><span class="op" id="5985274">,</span>&nbsp;<span class="num" id="5985276">1</span><span class="op" id="5985277">,</span>&nbsp;<span class="ident" id="5985279">commaTerm</span><span class="op" id="5985288">,</span>&nbsp;<span class="ident" id="5985290">x</span><span class="op" id="5985291">.</span><span class="ident" id="5985292">Rbrace</span><span class="op" id="5985298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985302">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985367">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985431">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985455">mode</span>&nbsp;<span class="op" id="5985460">:=</span>&nbsp;<span class="ident" id="5985463">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985482">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985542">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985598">if</span>&nbsp;<span class="builtinfunc" id="5985601">len</span><span class="op" id="5985604">(</span><span class="ident" id="5985605">x</span><span class="op" id="5985606">.</span><span class="ident" id="5985607">Elts</span><span class="op" id="5985611">)</span>&nbsp;<span class="op" id="5985613">&gt;</span>&nbsp;<span class="num" id="5985615">0</span>&nbsp;<span class="op" id="5985617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985622">mode</span>&nbsp;<span class="op" id="5985627">|=</span>&nbsp;<span class="ident" id="5985630">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985649">p</span><span class="op" id="5985650">.</span><span class="builtinfunc" id="5985651">print</span><span class="op" id="5985656">(</span><span class="ident" id="5985657">mode</span><span class="op" id="5985661">,</span>&nbsp;<span class="ident" id="5985663">x</span><span class="op" id="5985664">.</span><span class="ident" id="5985665">Rbrace</span><span class="op" id="5985671">,</span>&nbsp;<span class="ident" id="5985673">token</span><span class="op" id="5985678">.</span><span class="ident" id="5985679">RBRACE</span><span class="op" id="5985685">,</span>&nbsp;<span class="ident" id="5985687">mode</span><span class="op" id="5985691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985695">case</span>&nbsp;<span class="op" id="5985700">*</span><span class="ident" id="5985701">ast</span><span class="op" id="5985704">.</span><span class="ident" id="5985705">Ellipsis</span><span class="op" id="5985713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985717">p</span><span class="op" id="5985718">.</span><span class="builtinfunc" id="5985719">print</span><span class="op" id="5985724">(</span><span class="ident" id="5985725">token</span><span class="op" id="5985730">.</span><span class="ident" id="5985731">ELLIPSIS</span><span class="op" id="5985739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985743">if</span>&nbsp;<span class="ident" id="5985746">x</span><span class="op" id="5985747">.</span><span class="ident" id="5985748">Elt</span>&nbsp;<span class="op" id="5985752">!=</span>&nbsp;<span class="ident" id="5985755">nil</span>&nbsp;<span class="op" id="5985759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985764">p</span><span class="op" id="5985765">.</span><span class="ident" id="5985766">expr</span><span class="op" id="5985770">(</span><span class="ident" id="5985771">x</span><span class="op" id="5985772">.</span><span class="ident" id="5985773">Elt</span><span class="op" id="5985776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985780">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985784">case</span>&nbsp;<span class="op" id="5985789">*</span><span class="ident" id="5985790">ast</span><span class="op" id="5985793">.</span><span class="ident" id="5985794">ArrayType</span><span class="op" id="5985803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985807">p</span><span class="op" id="5985808">.</span><span class="builtinfunc" id="5985809">print</span><span class="op" id="5985814">(</span><span class="ident" id="5985815">token</span><span class="op" id="5985820">.</span><span class="ident" id="5985821">LBRACK</span><span class="op" id="5985827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985831">if</span>&nbsp;<span class="ident" id="5985834">x</span><span class="op" id="5985835">.</span><span class="ident" id="5985836">Len</span>&nbsp;<span class="op" id="5985840">!=</span>&nbsp;<span class="ident" id="5985843">nil</span>&nbsp;<span class="op" id="5985847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985852">p</span><span class="op" id="5985853">.</span><span class="ident" id="5985854">expr</span><span class="op" id="5985858">(</span><span class="ident" id="5985859">x</span><span class="op" id="5985860">.</span><span class="ident" id="5985861">Len</span><span class="op" id="5985864">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985872">p</span><span class="op" id="5985873">.</span><span class="builtinfunc" id="5985874">print</span><span class="op" id="5985879">(</span><span class="ident" id="5985880">token</span><span class="op" id="5985885">.</span><span class="ident" id="5985886">RBRACK</span><span class="op" id="5985892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985896">p</span><span class="op" id="5985897">.</span><span class="ident" id="5985898">expr</span><span class="op" id="5985902">(</span><span class="ident" id="5985903">x</span><span class="op" id="5985904">.</span><span class="ident" id="5985905">Elt</span><span class="op" id="5985908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985912">case</span>&nbsp;<span class="op" id="5985917">*</span><span class="ident" id="5985918">ast</span><span class="op" id="5985921">.</span><span class="ident" id="5985922">StructType</span><span class="op" id="5985932">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985936">p</span><span class="op" id="5985937">.</span><span class="builtinfunc" id="5985938">print</span><span class="op" id="5985943">(</span><span class="ident" id="5985944">token</span><span class="op" id="5985949">.</span><span class="ident" id="5985950">STRUCT</span><span class="op" id="5985956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985960">p</span><span class="op" id="5985961">.</span><span class="ident" id="5985962">fieldList</span><span class="op" id="5985971">(</span><span class="ident" id="5985972">x</span><span class="op" id="5985973">.</span><span class="ident" id="5985974">Fields</span><span class="op" id="5985980">,</span>&nbsp;<span class="builtintype" id="5985982">true</span><span class="op" id="5985986">,</span>&nbsp;<span class="ident" id="5985988">x</span><span class="op" id="5985989">.</span><span class="ident" id="5985990">Incomplete</span><span class="op" id="5986000">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986004">case</span>&nbsp;<span class="op" id="5986009">*</span><span class="ident" id="5986010">ast</span><span class="op" id="5986013">.</span><span class="ident" id="5986014">FuncType</span><span class="op" id="5986022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986026">p</span><span class="op" id="5986027">.</span><span class="builtinfunc" id="5986028">print</span><span class="op" id="5986033">(</span><span class="ident" id="5986034">token</span><span class="op" id="5986039">.</span><span class="ident" id="5986040">FUNC</span><span class="op" id="5986044">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986048">p</span><span class="op" id="5986049">.</span><span class="ident" id="5986050">signature</span><span class="op" id="5986059">(</span><span class="ident" id="5986060">x</span><span class="op" id="5986061">.</span><span class="ident" id="5986062">Params</span><span class="op" id="5986068">,</span>&nbsp;<span class="ident" id="5986070">x</span><span class="op" id="5986071">.</span><span class="ident" id="5986072">Results</span><span class="op" id="5986079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986083">case</span>&nbsp;<span class="op" id="5986088">*</span><span class="ident" id="5986089">ast</span><span class="op" id="5986092">.</span><span class="ident" id="5986093">InterfaceType</span><span class="op" id="5986106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986110">p</span><span class="op" id="5986111">.</span><span class="builtinfunc" id="5986112">print</span><span class="op" id="5986117">(</span><span class="ident" id="5986118">token</span><span class="op" id="5986123">.</span><span class="ident" id="5986124">INTERFACE</span><span class="op" id="5986133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986137">p</span><span class="op" id="5986138">.</span><span class="ident" id="5986139">fieldList</span><span class="op" id="5986148">(</span><span class="ident" id="5986149">x</span><span class="op" id="5986150">.</span><span class="ident" id="5986151">Methods</span><span class="op" id="5986158">,</span>&nbsp;<span class="builtintype" id="5986160">false</span><span class="op" id="5986165">,</span>&nbsp;<span class="ident" id="5986167">x</span><span class="op" id="5986168">.</span><span class="ident" id="5986169">Incomplete</span><span class="op" id="5986179">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986183">case</span>&nbsp;<span class="op" id="5986188">*</span><span class="ident" id="5986189">ast</span><span class="op" id="5986192">.</span><span class="ident" id="5986193">MapType</span><span class="op" id="5986200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986204">p</span><span class="op" id="5986205">.</span><span class="builtinfunc" id="5986206">print</span><span class="op" id="5986211">(</span><span class="ident" id="5986212">token</span><span class="op" id="5986217">.</span><span class="ident" id="5986218">MAP</span><span class="op" id="5986221">,</span>&nbsp;<span class="ident" id="5986223">token</span><span class="op" id="5986228">.</span><span class="ident" id="5986229">LBRACK</span><span class="op" id="5986235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986239">p</span><span class="op" id="5986240">.</span><span class="ident" id="5986241">expr</span><span class="op" id="5986245">(</span><span class="ident" id="5986246">x</span><span class="op" id="5986247">.</span><span class="ident" id="5986248">Key</span><span class="op" id="5986251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986255">p</span><span class="op" id="5986256">.</span><span class="builtinfunc" id="5986257">print</span><span class="op" id="5986262">(</span><span class="ident" id="5986263">token</span><span class="op" id="5986268">.</span><span class="ident" id="5986269">RBRACK</span><span class="op" id="5986275">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986279">p</span><span class="op" id="5986280">.</span><span class="ident" id="5986281">expr</span><span class="op" id="5986285">(</span><span class="ident" id="5986286">x</span><span class="op" id="5986287">.</span><span class="ident" id="5986288">Value</span><span class="op" id="5986293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986297">case</span>&nbsp;<span class="op" id="5986302">*</span><span class="ident" id="5986303">ast</span><span class="op" id="5986306">.</span><span class="ident" id="5986307">ChanType</span><span class="op" id="5986315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986319">switch</span>&nbsp;<span class="ident" id="5986326">x</span><span class="op" id="5986327">.</span><span class="ident" id="5986328">Dir</span>&nbsp;<span class="op" id="5986332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986336">case</span>&nbsp;<span class="ident" id="5986341">ast</span><span class="op" id="5986344">.</span><span class="ident" id="5986345">SEND</span>&nbsp;<span class="op" id="5986350">|</span>&nbsp;<span class="ident" id="5986352">ast</span><span class="op" id="5986355">.</span><span class="ident" id="5986356">RECV</span><span class="op" id="5986360">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986365">p</span><span class="op" id="5986366">.</span><span class="builtinfunc" id="5986367">print</span><span class="op" id="5986372">(</span><span class="ident" id="5986373">token</span><span class="op" id="5986378">.</span><span class="ident" id="5986379">CHAN</span><span class="op" id="5986383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986387">case</span>&nbsp;<span class="ident" id="5986392">ast</span><span class="op" id="5986395">.</span><span class="ident" id="5986396">RECV</span><span class="op" id="5986400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986405">p</span><span class="op" id="5986406">.</span><span class="builtinfunc" id="5986407">print</span><span class="op" id="5986412">(</span><span class="ident" id="5986413">token</span><span class="op" id="5986418">.</span><span class="ident" id="5986419">ARROW</span><span class="op" id="5986424">,</span>&nbsp;<span class="ident" id="5986426">token</span><span class="op" id="5986431">.</span><span class="ident" id="5986432">CHAN</span><span class="op" id="5986436">)</span>&nbsp;<span class="comment" id="5986438">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986476">case</span>&nbsp;<span class="ident" id="5986481">ast</span><span class="op" id="5986484">.</span><span class="ident" id="5986485">SEND</span><span class="op" id="5986489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986494">p</span><span class="op" id="5986495">.</span><span class="builtinfunc" id="5986496">print</span><span class="op" id="5986501">(</span><span class="ident" id="5986502">token</span><span class="op" id="5986507">.</span><span class="ident" id="5986508">CHAN</span><span class="op" id="5986512">,</span>&nbsp;<span class="ident" id="5986514">x</span><span class="op" id="5986515">.</span><span class="ident" id="5986516">Arrow</span><span class="op" id="5986521">,</span>&nbsp;<span class="ident" id="5986523">token</span><span class="op" id="5986528">.</span><span class="ident" id="5986529">ARROW</span><span class="op" id="5986534">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986542">p</span><span class="op" id="5986543">.</span><span class="builtinfunc" id="5986544">print</span><span class="op" id="5986549">(</span><span class="ident" id="5986550">blank</span><span class="op" id="5986555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986559">p</span><span class="op" id="5986560">.</span><span class="ident" id="5986561">expr</span><span class="op" id="5986565">(</span><span class="ident" id="5986566">x</span><span class="op" id="5986567">.</span><span class="ident" id="5986568">Value</span><span class="op" id="5986573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986577">default</span><span class="op" id="5986584">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5986588">panic</span><span class="op" id="5986593">(</span><span class="string" id="5986594">&#34;unreachable&#34;</span><span class="op" id="5986607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986614">return</span><br>
<span class="lineno"></span><span class="op" id="5986621">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="5986624">func</span>&nbsp;<span class="op" id="5986629">(</span><span class="ident" id="5986630">p</span>&nbsp;<span class="op" id="5986632">*</span><span class="ident" id="5986633">printer</span><span class="op" id="5986640">)</span>&nbsp;<span class="ident" id="5986642">expr0</span><span class="op" id="5986647">(</span><span class="ident" id="5986648">x</span>&nbsp;<span class="ident" id="5986650">ast</span><span class="op" id="5986653">.</span><span class="ident" id="5986654">Expr</span><span class="op" id="5986658">,</span>&nbsp;<span class="ident" id="5986660">depth</span>&nbsp;<span class="builtintype" id="5986666">int</span><span class="op" id="5986669">)</span>&nbsp;<span class="op" id="5986671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986674">p</span><span class="op" id="5986675">.</span><span class="ident" id="5986676">expr1</span><span class="op" id="5986681">(</span><span class="ident" id="5986682">x</span><span class="op" id="5986683">,</span>&nbsp;<span class="ident" id="5986685">token</span><span class="op" id="5986690">.</span><span class="ident" id="5986691">LowestPrec</span><span class="op" id="5986701">,</span>&nbsp;<span class="ident" id="5986703">depth</span><span class="op" id="5986708">)</span><br>
<span class="lineno"></span><span class="op" id="5986710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="5986713">func</span>&nbsp;<span class="op" id="5986718">(</span><span class="ident" id="5986719">p</span>&nbsp;<span class="op" id="5986721">*</span><span class="ident" id="5986722">printer</span><span class="op" id="5986729">)</span>&nbsp;<span class="ident" id="5986731">expr</span><span class="op" id="5986735">(</span><span class="ident" id="5986736">x</span>&nbsp;<span class="ident" id="5986738">ast</span><span class="op" id="5986741">.</span><span class="ident" id="5986742">Expr</span><span class="op" id="5986746">)</span>&nbsp;<span class="op" id="5986748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986751">const</span>&nbsp;<span class="ident" id="5986757">depth</span>&nbsp;<span class="op" id="5986763">=</span>&nbsp;<span class="num" id="5986765">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986768">p</span><span class="op" id="5986769">.</span><span class="ident" id="5986770">expr1</span><span class="op" id="5986775">(</span><span class="ident" id="5986776">x</span><span class="op" id="5986777">,</span>&nbsp;<span class="ident" id="5986779">token</span><span class="op" id="5986784">.</span><span class="ident" id="5986785">LowestPrec</span><span class="op" id="5986795">,</span>&nbsp;<span class="ident" id="5986797">depth</span><span class="op" id="5986802">)</span><br>
<span class="lineno"></span><span class="op" id="5986804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5986807">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5986887">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5986902">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5986988">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="5987072">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="5987117">func</span>&nbsp;<span class="op" id="5987122">(</span><span class="ident" id="5987123">p</span>&nbsp;<span class="op" id="5987125">*</span><span class="ident" id="5987126">printer</span><span class="op" id="5987133">)</span>&nbsp;<span class="ident" id="5987135">stmtList</span><span class="op" id="5987143">(</span><span class="ident" id="5987144">list</span>&nbsp;<span class="op" id="5987149">[</span><span class="op" id="5987150">]</span><span class="ident" id="5987151">ast</span><span class="op" id="5987154">.</span><span class="ident" id="5987155">Stmt</span><span class="op" id="5987159">,</span>&nbsp;<span class="ident" id="5987161">nindent</span>&nbsp;<span class="builtintype" id="5987169">int</span><span class="op" id="5987172">,</span>&nbsp;<span class="ident" id="5987174">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5987187">bool</span><span class="op" id="5987191">)</span>&nbsp;<span class="op" id="5987193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987196">if</span>&nbsp;<span class="ident" id="5987199">nindent</span>&nbsp;<span class="op" id="5987207">&gt;</span>&nbsp;<span class="num" id="5987209">0</span>&nbsp;<span class="op" id="5987211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987215">p</span><span class="op" id="5987216">.</span><span class="builtinfunc" id="5987217">print</span><span class="op" id="5987222">(</span><span class="ident" id="5987223">indent</span><span class="op" id="5987229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987232">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987235">var</span>&nbsp;<span class="ident" id="5987239">line</span>&nbsp;<span class="builtintype" id="5987244">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987249">i</span>&nbsp;<span class="op" id="5987251">:=</span>&nbsp;<span class="num" id="5987254">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987257">for</span>&nbsp;<span class="ident" id="5987261">_</span><span class="op" id="5987262">,</span>&nbsp;<span class="ident" id="5987264">s</span>&nbsp;<span class="op" id="5987266">:=</span>&nbsp;<span class="keyword" id="5987269">range</span>&nbsp;<span class="ident" id="5987275">list</span>&nbsp;<span class="op" id="5987280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987284">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987330">if</span>&nbsp;<span class="ident" id="5987333">_</span><span class="op" id="5987334">,</span>&nbsp;<span class="ident" id="5987336">isEmpty</span>&nbsp;<span class="op" id="5987344">:=</span>&nbsp;<span class="ident" id="5987347">s</span><span class="op" id="5987348">.</span><span class="op" id="5987349">(</span><span class="op" id="5987350">*</span><span class="ident" id="5987351">ast</span><span class="op" id="5987354">.</span><span class="ident" id="5987355">EmptyStmt</span><span class="op" id="5987364">)</span><span class="op" id="5987365">;</span>&nbsp;<span class="op" id="5987367">!</span><span class="ident" id="5987368">isEmpty</span>&nbsp;<span class="op" id="5987376">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987381">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987446">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5987496">if</span>&nbsp;<span class="builtinfunc" id="5987499">len</span><span class="op" id="5987502">(</span><span class="ident" id="5987503">p</span><span class="op" id="5987504">.</span><span class="ident" id="5987505">output</span><span class="op" id="5987511">)</span>&nbsp;<span class="op" id="5987513">&gt;</span>&nbsp;<span class="num" id="5987515">0</span>&nbsp;<span class="op" id="5987517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987523">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987597">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987655">p</span><span class="op" id="5987656">.</span><span class="ident" id="5987657">linebreak</span><span class="op" id="5987666">(</span><span class="ident" id="5987667">p</span><span class="op" id="5987668">.</span><span class="ident" id="5987669">lineFor</span><span class="op" id="5987676">(</span><span class="ident" id="5987677">s</span><span class="op" id="5987678">.</span><span class="ident" id="5987679">Pos</span><span class="op" id="5987682">(</span><span class="op" id="5987683">)</span><span class="op" id="5987684">)</span><span class="op" id="5987685">,</span>&nbsp;<span class="num" id="5987687">1</span><span class="op" id="5987688">,</span>&nbsp;<span class="ident" id="5987690">ignore</span><span class="op" id="5987696">,</span>&nbsp;<span class="ident" id="5987698">i</span>&nbsp;<span class="op" id="5987700">==</span>&nbsp;<span class="num" id="5987703">0</span>&nbsp;<span class="op" id="5987705">||</span>&nbsp;<span class="ident" id="5987708">nindent</span>&nbsp;<span class="op" id="5987716">==</span>&nbsp;<span class="num" id="5987719">0</span>&nbsp;<span class="op" id="5987721">||</span>&nbsp;<span class="ident" id="5987724">p</span><span class="op" id="5987725">.</span><span class="ident" id="5987726">linesFrom</span><span class="op" id="5987735">(</span><span class="ident" id="5987736">line</span><span class="op" id="5987740">)</span>&nbsp;<span class="op" id="5987742">&gt;</span>&nbsp;<span class="num" id="5987744">0</span><span class="op" id="5987745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5987750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987755">p</span><span class="op" id="5987756">.</span><span class="ident" id="5987757">recordLine</span><span class="op" id="5987767">(</span><span class="op" id="5987768">&amp;</span><span class="ident" id="5987769">line</span><span class="op" id="5987773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5987778">p</span><span class="op" id="5987779">.</span><span class="ident" id="5987780">stmt</span><span class="op" id="5987784">(</span><span class="ident" id="5987785">s</span><span class="op" id="5987786">,</span>&nbsp;<span class="ident" id="5987788">nextIsRBrace</span>&nbsp;<span class="op" id="5987801">&amp;&amp;</span>&nbsp;<span class="ident" id="5987804">i</span>&nbsp;<span class="op" id="5987806">==</span>&nbsp;<span class="builtinfunc" id="5987809">len</span><span class="op" id="5987812">(</span><span class="ident" id="5987813">list</span><span class="op" id="5987817">)</span><span class="op" id="5987818">-</span><span class="num" id="5987819">1</span><span class="op" id="5987820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987825">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987890">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5987954">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988004">for</span>&nbsp;<span class="ident" id="5988008">t</span>&nbsp;<span class="op" id="5988010">:=</span>&nbsp;<span class="ident" id="5988013">s</span><span class="op" id="5988014">;</span>&nbsp;<span class="op" id="5988016">;</span>&nbsp;<span class="op" id="5988018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988024">lt</span><span class="op" id="5988026">,</span>&nbsp;<span class="ident" id="5988028">_</span>&nbsp;<span class="op" id="5988030">:=</span>&nbsp;<span class="ident" id="5988033">t</span><span class="op" id="5988034">.</span><span class="op" id="5988035">(</span><span class="op" id="5988036">*</span><span class="ident" id="5988037">ast</span><span class="op" id="5988040">.</span><span class="ident" id="5988041">LabeledStmt</span><span class="op" id="5988052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988058">if</span>&nbsp;<span class="ident" id="5988061">lt</span>&nbsp;<span class="op" id="5988064">==</span>&nbsp;<span class="ident" id="5988067">nil</span>&nbsp;<span class="op" id="5988071">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988078">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5988088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988094">line</span><span class="op" id="5988098">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988105">t</span>&nbsp;<span class="op" id="5988107">=</span>&nbsp;<span class="ident" id="5988109">lt</span><span class="op" id="5988111">.</span><span class="ident" id="5988112">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5988120">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988125">i</span><span class="op" id="5988126">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5988131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5988134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988137">if</span>&nbsp;<span class="ident" id="5988140">nindent</span>&nbsp;<span class="op" id="5988148">&gt;</span>&nbsp;<span class="num" id="5988150">0</span>&nbsp;<span class="op" id="5988152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988156">p</span><span class="op" id="5988157">.</span><span class="builtinfunc" id="5988158">print</span><span class="op" id="5988163">(</span><span class="ident" id="5988164">unindent</span><span class="op" id="5988172">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5988175">}</span><br>
<span class="lineno"></span><span class="op" id="5988177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5988180">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="5988251">func</span>&nbsp;<span class="op" id="5988256">(</span><span class="ident" id="5988257">p</span>&nbsp;<span class="op" id="5988259">*</span><span class="ident" id="5988260">printer</span><span class="op" id="5988267">)</span>&nbsp;<span class="ident" id="5988269">block</span><span class="op" id="5988274">(</span><span class="ident" id="5988275">b</span>&nbsp;<span class="op" id="5988277">*</span><span class="ident" id="5988278">ast</span><span class="op" id="5988281">.</span><span class="ident" id="5988282">BlockStmt</span><span class="op" id="5988291">,</span>&nbsp;<span class="ident" id="5988293">nindent</span>&nbsp;<span class="builtintype" id="5988301">int</span><span class="op" id="5988304">)</span>&nbsp;<span class="op" id="5988306">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988309">p</span><span class="op" id="5988310">.</span><span class="builtinfunc" id="5988311">print</span><span class="op" id="5988316">(</span><span class="ident" id="5988317">b</span><span class="op" id="5988318">.</span><span class="ident" id="5988319">Lbrace</span><span class="op" id="5988325">,</span>&nbsp;<span class="ident" id="5988327">token</span><span class="op" id="5988332">.</span><span class="ident" id="5988333">LBRACE</span><span class="op" id="5988339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988342">p</span><span class="op" id="5988343">.</span><span class="ident" id="5988344">stmtList</span><span class="op" id="5988352">(</span><span class="ident" id="5988353">b</span><span class="op" id="5988354">.</span><span class="ident" id="5988355">List</span><span class="op" id="5988359">,</span>&nbsp;<span class="ident" id="5988361">nindent</span><span class="op" id="5988368">,</span>&nbsp;<span class="builtintype" id="5988370">true</span><span class="op" id="5988374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988377">p</span><span class="op" id="5988378">.</span><span class="ident" id="5988379">linebreak</span><span class="op" id="5988388">(</span><span class="ident" id="5988389">p</span><span class="op" id="5988390">.</span><span class="ident" id="5988391">lineFor</span><span class="op" id="5988398">(</span><span class="ident" id="5988399">b</span><span class="op" id="5988400">.</span><span class="ident" id="5988401">Rbrace</span><span class="op" id="5988407">)</span><span class="op" id="5988408">,</span>&nbsp;<span class="num" id="5988410">1</span><span class="op" id="5988411">,</span>&nbsp;<span class="ident" id="5988413">ignore</span><span class="op" id="5988419">,</span>&nbsp;<span class="builtintype" id="5988421">true</span><span class="op" id="5988425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988428">p</span><span class="op" id="5988429">.</span><span class="builtinfunc" id="5988430">print</span><span class="op" id="5988435">(</span><span class="ident" id="5988436">b</span><span class="op" id="5988437">.</span><span class="ident" id="5988438">Rbrace</span><span class="op" id="5988444">,</span>&nbsp;<span class="ident" id="5988446">token</span><span class="op" id="5988451">.</span><span class="ident" id="5988452">RBRACE</span><span class="op" id="5988458">)</span><br>
<span class="lineno"></span><span class="op" id="5988460">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="5988463">func</span>&nbsp;<span class="ident" id="5988468">isTypeName</span><span class="op" id="5988478">(</span><span class="ident" id="5988479">x</span>&nbsp;<span class="ident" id="5988481">ast</span><span class="op" id="5988484">.</span><span class="ident" id="5988485">Expr</span><span class="op" id="5988489">)</span>&nbsp;<span class="builtintype" id="5988491">bool</span>&nbsp;<span class="op" id="5988496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988499">switch</span>&nbsp;<span class="ident" id="5988506">t</span>&nbsp;<span class="op" id="5988508">:=</span>&nbsp;<span class="ident" id="5988511">x</span><span class="op" id="5988512">.</span><span class="op" id="5988513">(</span><span class="keyword" id="5988514">type</span><span class="op" id="5988518">)</span>&nbsp;<span class="op" id="5988520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988523">case</span>&nbsp;<span class="op" id="5988528">*</span><span class="ident" id="5988529">ast</span><span class="op" id="5988532">.</span><span class="ident" id="5988533">Ident</span><span class="op" id="5988538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988542">return</span>&nbsp;<span class="builtintype" id="5988549">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988555">case</span>&nbsp;<span class="op" id="5988560">*</span><span class="ident" id="5988561">ast</span><span class="op" id="5988564">.</span><span class="ident" id="5988565">SelectorExpr</span><span class="op" id="5988577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988581">return</span>&nbsp;<span class="ident" id="5988588">isTypeName</span><span class="op" id="5988598">(</span><span class="ident" id="5988599">t</span><span class="op" id="5988600">.</span><span class="ident" id="5988601">X</span><span class="op" id="5988602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5988605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988608">return</span>&nbsp;<span class="builtintype" id="5988615">false</span><br>
<span class="lineno"></span><span class="op" id="5988621">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="5988624">func</span>&nbsp;<span class="ident" id="5988629">stripParens</span><span class="op" id="5988640">(</span><span class="ident" id="5988641">x</span>&nbsp;<span class="ident" id="5988643">ast</span><span class="op" id="5988646">.</span><span class="ident" id="5988647">Expr</span><span class="op" id="5988651">)</span>&nbsp;<span class="ident" id="5988653">ast</span><span class="op" id="5988656">.</span><span class="ident" id="5988657">Expr</span>&nbsp;<span class="op" id="5988662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988665">if</span>&nbsp;<span class="ident" id="5988668">px</span><span class="op" id="5988670">,</span>&nbsp;<span class="ident" id="5988672">strip</span>&nbsp;<span class="op" id="5988678">:=</span>&nbsp;<span class="ident" id="5988681">x</span><span class="op" id="5988682">.</span><span class="op" id="5988683">(</span><span class="op" id="5988684">*</span><span class="ident" id="5988685">ast</span><span class="op" id="5988688">.</span><span class="ident" id="5988689">ParenExpr</span><span class="op" id="5988698">)</span><span class="op" id="5988699">;</span>&nbsp;<span class="ident" id="5988701">strip</span>&nbsp;<span class="op" id="5988707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5988711">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5988766">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5988820">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5988837">ast</span><span class="op" id="5988840">.</span><span class="ident" id="5988841">Inspect</span><span class="op" id="5988848">(</span><span class="ident" id="5988849">px</span><span class="op" id="5988851">.</span><span class="ident" id="5988852">X</span><span class="op" id="5988853">,</span>&nbsp;<span class="keyword" id="5988855">func</span><span class="op" id="5988859">(</span><span class="ident" id="5988860">node</span>&nbsp;<span class="ident" id="5988865">ast</span><span class="op" id="5988868">.</span><span class="ident" id="5988869">Node</span><span class="op" id="5988873">)</span>&nbsp;<span class="builtintype" id="5988875">bool</span>&nbsp;<span class="op" id="5988880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988885">switch</span>&nbsp;<span class="ident" id="5988892">x</span>&nbsp;<span class="op" id="5988894">:=</span>&nbsp;<span class="ident" id="5988897">node</span><span class="op" id="5988901">.</span><span class="op" id="5988902">(</span><span class="keyword" id="5988903">type</span><span class="op" id="5988907">)</span>&nbsp;<span class="op" id="5988909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988914">case</span>&nbsp;<span class="op" id="5988919">*</span><span class="ident" id="5988920">ast</span><span class="op" id="5988923">.</span><span class="ident" id="5988924">ParenExpr</span><span class="op" id="5988933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5988939">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5988994">return</span>&nbsp;<span class="builtintype" id="5989001">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989010">case</span>&nbsp;<span class="op" id="5989015">*</span><span class="ident" id="5989016">ast</span><span class="op" id="5989019">.</span><span class="ident" id="5989020">CompositeLit</span><span class="op" id="5989032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989038">if</span>&nbsp;<span class="ident" id="5989041">isTypeName</span><span class="op" id="5989051">(</span><span class="ident" id="5989052">x</span><span class="op" id="5989053">.</span><span class="ident" id="5989054">Type</span><span class="op" id="5989058">)</span>&nbsp;<span class="op" id="5989060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989067">strip</span>&nbsp;<span class="op" id="5989073">=</span>&nbsp;<span class="builtintype" id="5989075">false</span>&nbsp;<span class="comment" id="5989081">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989113">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989119">return</span>&nbsp;<span class="builtintype" id="5989126">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5989140">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989182">return</span>&nbsp;<span class="builtintype" id="5989189">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989196">}</span><span class="op" id="5989197">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989201">if</span>&nbsp;<span class="ident" id="5989204">strip</span>&nbsp;<span class="op" id="5989210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989215">return</span>&nbsp;<span class="ident" id="5989222">stripParens</span><span class="op" id="5989233">(</span><span class="ident" id="5989234">px</span><span class="op" id="5989236">.</span><span class="ident" id="5989237">X</span><span class="op" id="5989238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989248">return</span>&nbsp;<span class="ident" id="5989255">x</span><br>
<span class="lineno">985</span><span class="op" id="5989257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5989260">func</span>&nbsp;<span class="ident" id="5989265">stripParensAlways</span><span class="op" id="5989282">(</span><span class="ident" id="5989283">x</span>&nbsp;<span class="ident" id="5989285">ast</span><span class="op" id="5989288">.</span><span class="ident" id="5989289">Expr</span><span class="op" id="5989293">)</span>&nbsp;<span class="ident" id="5989295">ast</span><span class="op" id="5989298">.</span><span class="ident" id="5989299">Expr</span>&nbsp;<span class="op" id="5989304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989307">if</span>&nbsp;<span class="ident" id="5989310">x</span><span class="op" id="5989311">,</span>&nbsp;<span class="ident" id="5989313">ok</span>&nbsp;<span class="op" id="5989316">:=</span>&nbsp;<span class="ident" id="5989319">x</span><span class="op" id="5989320">.</span><span class="op" id="5989321">(</span><span class="op" id="5989322">*</span><span class="ident" id="5989323">ast</span><span class="op" id="5989326">.</span><span class="ident" id="5989327">ParenExpr</span><span class="op" id="5989336">)</span><span class="op" id="5989337">;</span>&nbsp;<span class="ident" id="5989339">ok</span>&nbsp;<span class="op" id="5989342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989346">return</span>&nbsp;<span class="ident" id="5989353">stripParensAlways</span><span class="op" id="5989370">(</span><span class="ident" id="5989371">x</span><span class="op" id="5989372">.</span><span class="ident" id="5989373">X</span><span class="op" id="5989374">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989380">return</span>&nbsp;<span class="ident" id="5989387">x</span><br>
<span class="lineno"></span><span class="op" id="5989389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5989392">func</span>&nbsp;<span class="op" id="5989397">(</span><span class="ident" id="5989398">p</span>&nbsp;<span class="op" id="5989400">*</span><span class="ident" id="5989401">printer</span><span class="op" id="5989408">)</span>&nbsp;<span class="ident" id="5989410">controlClause</span><span class="op" id="5989423">(</span><span class="ident" id="5989424">isForStmt</span>&nbsp;<span class="builtintype" id="5989434">bool</span><span class="op" id="5989438">,</span>&nbsp;<span class="ident" id="5989440">init</span>&nbsp;<span class="ident" id="5989445">ast</span><span class="op" id="5989448">.</span><span class="ident" id="5989449">Stmt</span><span class="op" id="5989453">,</span>&nbsp;<span class="ident" id="5989455">expr</span>&nbsp;<span class="ident" id="5989460">ast</span><span class="op" id="5989463">.</span><span class="ident" id="5989464">Expr</span><span class="op" id="5989468">,</span>&nbsp;<span class="ident" id="5989470">post</span>&nbsp;<span class="ident" id="5989475">ast</span><span class="op" id="5989478">.</span><span class="ident" id="5989479">Stmt</span><span class="op" id="5989483">)</span>&nbsp;<span class="op" id="5989485">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989488">p</span><span class="op" id="5989489">.</span><span class="builtinfunc" id="5989490">print</span><span class="op" id="5989495">(</span><span class="ident" id="5989496">blank</span><span class="op" id="5989501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989504">needsBlank</span>&nbsp;<span class="op" id="5989515">:=</span>&nbsp;<span class="builtintype" id="5989518">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989525">if</span>&nbsp;<span class="ident" id="5989528">init</span>&nbsp;<span class="op" id="5989533">==</span>&nbsp;<span class="ident" id="5989536">nil</span>&nbsp;<span class="op" id="5989540">&amp;&amp;</span>&nbsp;<span class="ident" id="5989543">post</span>&nbsp;<span class="op" id="5989548">==</span>&nbsp;<span class="ident" id="5989551">nil</span>&nbsp;<span class="op" id="5989555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5989559">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989587">if</span>&nbsp;<span class="ident" id="5989590">expr</span>&nbsp;<span class="op" id="5989595">!=</span>&nbsp;<span class="ident" id="5989598">nil</span>&nbsp;<span class="op" id="5989602">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989607">p</span><span class="op" id="5989608">.</span><span class="ident" id="5989609">expr</span><span class="op" id="5989613">(</span><span class="ident" id="5989614">stripParens</span><span class="op" id="5989625">(</span><span class="ident" id="5989626">expr</span><span class="op" id="5989630">)</span><span class="op" id="5989631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989636">needsBlank</span>&nbsp;<span class="op" id="5989647">=</span>&nbsp;<span class="builtintype" id="5989649">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989659">}</span>&nbsp;<span class="keyword" id="5989661">else</span>&nbsp;<span class="op" id="5989666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5989670">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5989699">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989753">if</span>&nbsp;<span class="ident" id="5989756">init</span>&nbsp;<span class="op" id="5989761">!=</span>&nbsp;<span class="ident" id="5989764">nil</span>&nbsp;<span class="op" id="5989768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989773">p</span><span class="op" id="5989774">.</span><span class="ident" id="5989775">stmt</span><span class="op" id="5989779">(</span><span class="ident" id="5989780">init</span><span class="op" id="5989784">,</span>&nbsp;<span class="builtintype" id="5989786">false</span><span class="op" id="5989791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989799">p</span><span class="op" id="5989800">.</span><span class="builtinfunc" id="5989801">print</span><span class="op" id="5989806">(</span><span class="ident" id="5989807">token</span><span class="op" id="5989812">.</span><span class="ident" id="5989813">SEMICOLON</span><span class="op" id="5989822">,</span>&nbsp;<span class="ident" id="5989824">blank</span><span class="op" id="5989829">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989833">if</span>&nbsp;<span class="ident" id="5989836">expr</span>&nbsp;<span class="op" id="5989841">!=</span>&nbsp;<span class="ident" id="5989844">nil</span>&nbsp;<span class="op" id="5989848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989853">p</span><span class="op" id="5989854">.</span><span class="ident" id="5989855">expr</span><span class="op" id="5989859">(</span><span class="ident" id="5989860">stripParens</span><span class="op" id="5989871">(</span><span class="ident" id="5989872">expr</span><span class="op" id="5989876">)</span><span class="op" id="5989877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989882">needsBlank</span>&nbsp;<span class="op" id="5989893">=</span>&nbsp;<span class="builtintype" id="5989895">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5989902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989906">if</span>&nbsp;<span class="ident" id="5989909">isForStmt</span>&nbsp;<span class="op" id="5989919">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989924">p</span><span class="op" id="5989925">.</span><span class="builtinfunc" id="5989926">print</span><span class="op" id="5989931">(</span><span class="ident" id="5989932">token</span><span class="op" id="5989937">.</span><span class="ident" id="5989938">SEMICOLON</span><span class="op" id="5989947">,</span>&nbsp;<span class="ident" id="5989949">blank</span><span class="op" id="5989954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5989959">needsBlank</span>&nbsp;<span class="op" id="5989970">=</span>&nbsp;<span class="builtintype" id="5989972">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5989981">if</span>&nbsp;<span class="ident" id="5989984">post</span>&nbsp;<span class="op" id="5989989">!=</span>&nbsp;<span class="ident" id="5989992">nil</span>&nbsp;<span class="op" id="5989996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5990002">p</span><span class="op" id="5990003">.</span><span class="ident" id="5990004">stmt</span><span class="op" id="5990008">(</span><span class="ident" id="5990009">post</span><span class="op" id="5990013">,</span>&nbsp;<span class="builtintype" id="5990015">false</span><span class="op" id="5990020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5990026">needsBlank</span>&nbsp;<span class="op" id="5990037">=</span>&nbsp;<span class="builtintype" id="5990039">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5990047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5990051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5990054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990057">if</span>&nbsp;<span class="ident" id="5990060">needsBlank</span>&nbsp;<span class="op" id="5990071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5990075">p</span><span class="op" id="5990076">.</span><span class="builtinfunc" id="5990077">print</span><span class="op" id="5990082">(</span><span class="ident" id="5990083">blank</span><span class="op" id="5990088">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5990091">}</span><br>
<span class="lineno"></span><span class="op" id="5990093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5990096">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5990169">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="5990242">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="5990285">//</span><br>
<span class="lineno"></span><span class="keyword" id="5990288">func</span>&nbsp;<span class="op" id="5990293">(</span><span class="ident" id="5990294">p</span>&nbsp;<span class="op" id="5990296">*</span><span class="ident" id="5990297">printer</span><span class="op" id="5990304">)</span>&nbsp;<span class="ident" id="5990306">indentList</span><span class="op" id="5990316">(</span><span class="ident" id="5990317">list</span>&nbsp;<span class="op" id="5990322">[</span><span class="op" id="5990323">]</span><span class="ident" id="5990324">ast</span><span class="op" id="5990327">.</span><span class="ident" id="5990328">Expr</span><span class="op" id="5990332">)</span>&nbsp;<span class="builtintype" id="5990334">bool</span>&nbsp;<span class="op" id="5990339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5990342">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5990415">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5990484">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990540">if</span>&nbsp;<span class="builtinfunc" id="5990543">len</span><span class="op" id="5990546">(</span><span class="ident" id="5990547">list</span><span class="op" id="5990551">)</span>&nbsp;<span class="op" id="5990553">&gt;=</span>&nbsp;<span class="num" id="5990556">2</span>&nbsp;<span class="op" id="5990558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990562">var</span>&nbsp;<span class="ident" id="5990566">b</span>&nbsp;<span class="op" id="5990568">=</span>&nbsp;<span class="ident" id="5990570">p</span><span class="op" id="5990571">.</span><span class="ident" id="5990572">lineFor</span><span class="op" id="5990579">(</span><span class="ident" id="5990580">list</span><span class="op" id="5990584">[</span><span class="num" id="5990585">0</span><span class="op" id="5990586">]</span><span class="op" id="5990587">.</span><span class="ident" id="5990588">Pos</span><span class="op" id="5990591">(</span><span class="op" id="5990592">)</span><span class="op" id="5990593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990597">var</span>&nbsp;<span class="ident" id="5990601">e</span>&nbsp;<span class="op" id="5990603">=</span>&nbsp;<span class="ident" id="5990605">p</span><span class="op" id="5990606">.</span><span class="ident" id="5990607">lineFor</span><span class="op" id="5990614">(</span><span class="ident" id="5990615">list</span><span class="op" id="5990619">[</span><span class="builtinfunc" id="5990620">len</span><span class="op" id="5990623">(</span><span class="ident" id="5990624">list</span><span class="op" id="5990628">)</span><span class="op" id="5990629">-</span><span class="num" id="5990630">1</span><span class="op" id="5990631">]</span><span class="op" id="5990632">.</span><span class="ident" id="5990633">End</span><span class="op" id="5990636">(</span><span class="op" id="5990637">)</span><span class="op" id="5990638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990642">if</span>&nbsp;<span class="num" id="5990645">0</span>&nbsp;<span class="op" id="5990647">&lt;</span>&nbsp;<span class="ident" id="5990649">b</span>&nbsp;<span class="op" id="5990651">&amp;&amp;</span>&nbsp;<span class="ident" id="5990654">b</span>&nbsp;<span class="op" id="5990656">&lt;</span>&nbsp;<span class="ident" id="5990658">e</span>&nbsp;<span class="op" id="5990660">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5990665">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5990697">n</span>&nbsp;<span class="op" id="5990699">:=</span>&nbsp;<span class="num" id="5990702">0</span>&nbsp;<span class="comment" id="5990704">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5990735">line</span>&nbsp;<span class="op" id="5990740">:=</span>&nbsp;<span class="ident" id="5990743">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990748">for</span>&nbsp;<span class="ident" id="5990752">_</span><span class="op" id="5990753">,</span>&nbsp;<span class="ident" id="5990755">x</span>&nbsp;<span class="op" id="5990757">:=</span>&nbsp;<span class="keyword" id="5990760">range</span>&nbsp;<span class="ident" id="5990766">list</span>&nbsp;<span class="op" id="5990771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5990777">xb</span>&nbsp;<span class="op" id="5990780">:=</span>&nbsp;<span class="ident" id="5990783">p</span><span class="op" id="5990784">.</span><span class="ident" id="5990785">lineFor</span><span class="op" id="5990792">(</span><span class="ident" id="5990793">x</span><span class="op" id="5990794">.</span><span class="ident" id="5990795">Pos</span><span class="op" id="5990798">(</span><span class="op" id="5990799">)</span><span class="op" id="5990800">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5990806">xe</span>&nbsp;<span class="op" id="5990809">:=</span>&nbsp;<span class="ident" id="5990812">p</span><span class="op" id="5990813">.</span><span class="ident" id="5990814">lineFor</span><span class="op" id="5990821">(</span><span class="ident" id="5990822">x</span><span class="op" id="5990823">.</span><span class="ident" id="5990824">End</span><span class="op" id="5990827">(</span><span class="op" id="5990828">)</span><span class="op" id="5990829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990835">if</span>&nbsp;<span class="ident" id="5990838">line</span>&nbsp;<span class="op" id="5990843">&lt;</span>&nbsp;<span class="ident" id="5990845">xb</span>&nbsp;<span class="op" id="5990848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5990855">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5990893">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990932">return</span>&nbsp;<span class="builtintype" id="5990939">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5990948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5990954">if</span>&nbsp;<span class="ident" id="5990957">xb</span>&nbsp;<span class="op" id="5990960">&lt;</span>&nbsp;<span class="ident" id="5990962">xe</span>&nbsp;<span class="op" id="5990965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5990972">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991006">n</span><span class="op" id="5991007">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5991014">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991020">line</span>&nbsp;<span class="op" id="5991025">=</span>&nbsp;<span class="ident" id="5991027">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5991033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991038">return</span>&nbsp;<span class="ident" id="5991045">n</span>&nbsp;<span class="op" id="5991047">&gt;</span>&nbsp;<span class="num" id="5991049">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5991053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5991056">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991059">return</span>&nbsp;<span class="builtintype" id="5991066">false</span><br>
<span class="lineno"></span><span class="op" id="5991072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5991075">func</span>&nbsp;<span class="op" id="5991080">(</span><span class="ident" id="5991081">p</span>&nbsp;<span class="op" id="5991083">*</span><span class="ident" id="5991084">printer</span><span class="op" id="5991091">)</span>&nbsp;<span class="ident" id="5991093">stmt</span><span class="op" id="5991097">(</span><span class="ident" id="5991098">stmt</span>&nbsp;<span class="ident" id="5991103">ast</span><span class="op" id="5991106">.</span><span class="ident" id="5991107">Stmt</span><span class="op" id="5991111">,</span>&nbsp;<span class="ident" id="5991113">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5991126">bool</span><span class="op" id="5991130">)</span>&nbsp;<span class="op" id="5991132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991135">p</span><span class="op" id="5991136">.</span><span class="builtinfunc" id="5991137">print</span><span class="op" id="5991142">(</span><span class="ident" id="5991143">stmt</span><span class="op" id="5991147">.</span><span class="ident" id="5991148">Pos</span><span class="op" id="5991151">(</span><span class="op" id="5991152">)</span><span class="op" id="5991153">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991157">switch</span>&nbsp;<span class="ident" id="5991164">s</span>&nbsp;<span class="op" id="5991166">:=</span>&nbsp;<span class="ident" id="5991169">stmt</span><span class="op" id="5991173">.</span><span class="op" id="5991174">(</span><span class="keyword" id="5991175">type</span><span class="op" id="5991179">)</span>&nbsp;<span class="op" id="5991181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991184">case</span>&nbsp;<span class="op" id="5991189">*</span><span class="ident" id="5991190">ast</span><span class="op" id="5991193">.</span><span class="ident" id="5991194">BadStmt</span><span class="op" id="5991201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991205">p</span><span class="op" id="5991206">.</span><span class="builtinfunc" id="5991207">print</span><span class="op" id="5991212">(</span><span class="string" id="5991213">&#34;BadStmt&#34;</span><span class="op" id="5991222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991226">case</span>&nbsp;<span class="op" id="5991231">*</span><span class="ident" id="5991232">ast</span><span class="op" id="5991235">.</span><span class="ident" id="5991236">DeclStmt</span><span class="op" id="5991244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991248">p</span><span class="op" id="5991249">.</span><span class="ident" id="5991250">decl</span><span class="op" id="5991254">(</span><span class="ident" id="5991255">s</span><span class="op" id="5991256">.</span><span class="ident" id="5991257">Decl</span><span class="op" id="5991261">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991265">case</span>&nbsp;<span class="op" id="5991270">*</span><span class="ident" id="5991271">ast</span><span class="op" id="5991274">.</span><span class="ident" id="5991275">EmptyStmt</span><span class="op" id="5991284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5991288">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991307">case</span>&nbsp;<span class="op" id="5991312">*</span><span class="ident" id="5991313">ast</span><span class="op" id="5991316">.</span><span class="ident" id="5991317">LabeledStmt</span><span class="op" id="5991328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5991332">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5991396">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5991457">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991492">p</span><span class="op" id="5991493">.</span><span class="builtinfunc" id="5991494">print</span><span class="op" id="5991499">(</span><span class="ident" id="5991500">unindent</span><span class="op" id="5991508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991512">p</span><span class="op" id="5991513">.</span><span class="ident" id="5991514">expr</span><span class="op" id="5991518">(</span><span class="ident" id="5991519">s</span><span class="op" id="5991520">.</span><span class="ident" id="5991521">Label</span><span class="op" id="5991526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991530">p</span><span class="op" id="5991531">.</span><span class="builtinfunc" id="5991532">print</span><span class="op" id="5991537">(</span><span class="ident" id="5991538">s</span><span class="op" id="5991539">.</span><span class="ident" id="5991540">Colon</span><span class="op" id="5991545">,</span>&nbsp;<span class="ident" id="5991547">token</span><span class="op" id="5991552">.</span><span class="ident" id="5991553">COLON</span><span class="op" id="5991558">,</span>&nbsp;<span class="ident" id="5991560">indent</span><span class="op" id="5991566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991570">if</span>&nbsp;<span class="ident" id="5991573">e</span><span class="op" id="5991574">,</span>&nbsp;<span class="ident" id="5991576">isEmpty</span>&nbsp;<span class="op" id="5991584">:=</span>&nbsp;<span class="ident" id="5991587">s</span><span class="op" id="5991588">.</span><span class="ident" id="5991589">Stmt</span><span class="op" id="5991593">.</span><span class="op" id="5991594">(</span><span class="op" id="5991595">*</span><span class="ident" id="5991596">ast</span><span class="op" id="5991599">.</span><span class="ident" id="5991600">EmptyStmt</span><span class="op" id="5991609">)</span><span class="op" id="5991610">;</span>&nbsp;<span class="ident" id="5991612">isEmpty</span>&nbsp;<span class="op" id="5991620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991625">if</span>&nbsp;<span class="op" id="5991628">!</span><span class="ident" id="5991629">nextIsRBrace</span>&nbsp;<span class="op" id="5991642">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991648">p</span><span class="op" id="5991649">.</span><span class="builtinfunc" id="5991650">print</span><span class="op" id="5991655">(</span><span class="ident" id="5991656">newline</span><span class="op" id="5991663">,</span>&nbsp;<span class="ident" id="5991665">e</span><span class="op" id="5991666">.</span><span class="ident" id="5991667">Pos</span><span class="op" id="5991670">(</span><span class="op" id="5991671">)</span><span class="op" id="5991672">,</span>&nbsp;<span class="ident" id="5991674">token</span><span class="op" id="5991679">.</span><span class="ident" id="5991680">SEMICOLON</span><span class="op" id="5991689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991695">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5991704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5991708">}</span>&nbsp;<span class="keyword" id="5991710">else</span>&nbsp;<span class="op" id="5991715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991720">p</span><span class="op" id="5991721">.</span><span class="ident" id="5991722">linebreak</span><span class="op" id="5991731">(</span><span class="ident" id="5991732">p</span><span class="op" id="5991733">.</span><span class="ident" id="5991734">lineFor</span><span class="op" id="5991741">(</span><span class="ident" id="5991742">s</span><span class="op" id="5991743">.</span><span class="ident" id="5991744">Stmt</span><span class="op" id="5991748">.</span><span class="ident" id="5991749">Pos</span><span class="op" id="5991752">(</span><span class="op" id="5991753">)</span><span class="op" id="5991754">)</span><span class="op" id="5991755">,</span>&nbsp;<span class="num" id="5991757">1</span><span class="op" id="5991758">,</span>&nbsp;<span class="ident" id="5991760">ignore</span><span class="op" id="5991766">,</span>&nbsp;<span class="builtintype" id="5991768">true</span><span class="op" id="5991772">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5991776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991780">p</span><span class="op" id="5991781">.</span><span class="ident" id="5991782">stmt</span><span class="op" id="5991786">(</span><span class="ident" id="5991787">s</span><span class="op" id="5991788">.</span><span class="ident" id="5991789">Stmt</span><span class="op" id="5991793">,</span>&nbsp;<span class="ident" id="5991795">nextIsRBrace</span><span class="op" id="5991807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991811">case</span>&nbsp;<span class="op" id="5991816">*</span><span class="ident" id="5991817">ast</span><span class="op" id="5991820">.</span><span class="ident" id="5991821">ExprStmt</span><span class="op" id="5991829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991833">const</span>&nbsp;<span class="ident" id="5991839">depth</span>&nbsp;<span class="op" id="5991845">=</span>&nbsp;<span class="num" id="5991847">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991851">p</span><span class="op" id="5991852">.</span><span class="ident" id="5991853">expr0</span><span class="op" id="5991858">(</span><span class="ident" id="5991859">s</span><span class="op" id="5991860">.</span><span class="ident" id="5991861">X</span><span class="op" id="5991862">,</span>&nbsp;<span class="ident" id="5991864">depth</span><span class="op" id="5991869">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991873">case</span>&nbsp;<span class="op" id="5991878">*</span><span class="ident" id="5991879">ast</span><span class="op" id="5991882">.</span><span class="ident" id="5991883">SendStmt</span><span class="op" id="5991891">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5991895">const</span>&nbsp;<span class="ident" id="5991901">depth</span>&nbsp;<span class="op" id="5991907">=</span>&nbsp;<span class="num" id="5991909">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991913">p</span><span class="op" id="5991914">.</span><span class="ident" id="5991915">expr0</span><span class="op" id="5991920">(</span><span class="ident" id="5991921">s</span><span class="op" id="5991922">.</span><span class="ident" id="5991923">Chan</span><span class="op" id="5991927">,</span>&nbsp;<span class="ident" id="5991929">depth</span><span class="op" id="5991934">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991938">p</span><span class="op" id="5991939">.</span><span class="builtinfunc" id="5991940">print</span><span class="op" id="5991945">(</span><span class="ident" id="5991946">blank</span><span class="op" id="5991951">,</span>&nbsp;<span class="ident" id="5991953">s</span><span class="op" id="5991954">.</span><span class="ident" id="5991955">Arrow</span><span class="op" id="5991960">,</span>&nbsp;<span class="ident" id="5991962">token</span><span class="op" id="5991967">.</span><span class="ident" id="5991968">ARROW</span><span class="op" id="5991973">,</span>&nbsp;<span class="ident" id="5991975">blank</span><span class="op" id="5991980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5991984">p</span><span class="op" id="5991985">.</span><span class="ident" id="5991986">expr0</span><span class="op" id="5991991">(</span><span class="ident" id="5991992">s</span><span class="op" id="5991993">.</span><span class="ident" id="5991994">Value</span><span class="op" id="5991999">,</span>&nbsp;<span class="ident" id="5992001">depth</span><span class="op" id="5992006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992010">case</span>&nbsp;<span class="op" id="5992015">*</span><span class="ident" id="5992016">ast</span><span class="op" id="5992019">.</span><span class="ident" id="5992020">IncDecStmt</span><span class="op" id="5992030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992034">const</span>&nbsp;<span class="ident" id="5992040">depth</span>&nbsp;<span class="op" id="5992046">=</span>&nbsp;<span class="num" id="5992048">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992052">p</span><span class="op" id="5992053">.</span><span class="ident" id="5992054">expr0</span><span class="op" id="5992059">(</span><span class="ident" id="5992060">s</span><span class="op" id="5992061">.</span><span class="ident" id="5992062">X</span><span class="op" id="5992063">,</span>&nbsp;<span class="ident" id="5992065">depth</span><span class="op" id="5992070">+</span><span class="num" id="5992071">1</span><span class="op" id="5992072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992076">p</span><span class="op" id="5992077">.</span><span class="builtinfunc" id="5992078">print</span><span class="op" id="5992083">(</span><span class="ident" id="5992084">s</span><span class="op" id="5992085">.</span><span class="ident" id="5992086">TokPos</span><span class="op" id="5992092">,</span>&nbsp;<span class="ident" id="5992094">s</span><span class="op" id="5992095">.</span><span class="ident" id="5992096">Tok</span><span class="op" id="5992099">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992103">case</span>&nbsp;<span class="op" id="5992108">*</span><span class="ident" id="5992109">ast</span><span class="op" id="5992112">.</span><span class="ident" id="5992113">AssignStmt</span><span class="op" id="5992123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992127">var</span>&nbsp;<span class="ident" id="5992131">depth</span>&nbsp;<span class="op" id="5992137">=</span>&nbsp;<span class="num" id="5992139">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992143">if</span>&nbsp;<span class="builtinfunc" id="5992146">len</span><span class="op" id="5992149">(</span><span class="ident" id="5992150">s</span><span class="op" id="5992151">.</span><span class="ident" id="5992152">Lhs</span><span class="op" id="5992155">)</span>&nbsp;<span class="op" id="5992157">&gt;</span>&nbsp;<span class="num" id="5992159">1</span>&nbsp;<span class="op" id="5992161">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5992164">len</span><span class="op" id="5992167">(</span><span class="ident" id="5992168">s</span><span class="op" id="5992169">.</span><span class="ident" id="5992170">Rhs</span><span class="op" id="5992173">)</span>&nbsp;<span class="op" id="5992175">&gt;</span>&nbsp;<span class="num" id="5992177">1</span>&nbsp;<span class="op" id="5992179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992184">depth</span><span class="op" id="5992189">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5992194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992198">p</span><span class="op" id="5992199">.</span><span class="ident" id="5992200">exprList</span><span class="op" id="5992208">(</span><span class="ident" id="5992209">s</span><span class="op" id="5992210">.</span><span class="ident" id="5992211">Pos</span><span class="op" id="5992214">(</span><span class="op" id="5992215">)</span><span class="op" id="5992216">,</span>&nbsp;<span class="ident" id="5992218">s</span><span class="op" id="5992219">.</span><span class="ident" id="5992220">Lhs</span><span class="op" id="5992223">,</span>&nbsp;<span class="ident" id="5992225">depth</span><span class="op" id="5992230">,</span>&nbsp;<span class="num" id="5992232">0</span><span class="op" id="5992233">,</span>&nbsp;<span class="ident" id="5992235">s</span><span class="op" id="5992236">.</span><span class="ident" id="5992237">TokPos</span><span class="op" id="5992243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992247">p</span><span class="op" id="5992248">.</span><span class="builtinfunc" id="5992249">print</span><span class="op" id="5992254">(</span><span class="ident" id="5992255">blank</span><span class="op" id="5992260">,</span>&nbsp;<span class="ident" id="5992262">s</span><span class="op" id="5992263">.</span><span class="ident" id="5992264">TokPos</span><span class="op" id="5992270">,</span>&nbsp;<span class="ident" id="5992272">s</span><span class="op" id="5992273">.</span><span class="ident" id="5992274">Tok</span><span class="op" id="5992277">,</span>&nbsp;<span class="ident" id="5992279">blank</span><span class="op" id="5992284">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992288">p</span><span class="op" id="5992289">.</span><span class="ident" id="5992290">exprList</span><span class="op" id="5992298">(</span><span class="ident" id="5992299">s</span><span class="op" id="5992300">.</span><span class="ident" id="5992301">TokPos</span><span class="op" id="5992307">,</span>&nbsp;<span class="ident" id="5992309">s</span><span class="op" id="5992310">.</span><span class="ident" id="5992311">Rhs</span><span class="op" id="5992314">,</span>&nbsp;<span class="ident" id="5992316">depth</span><span class="op" id="5992321">,</span>&nbsp;<span class="num" id="5992323">0</span><span class="op" id="5992324">,</span>&nbsp;<span class="ident" id="5992326">token</span><span class="op" id="5992331">.</span><span class="ident" id="5992332">NoPos</span><span class="op" id="5992337">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992341">case</span>&nbsp;<span class="op" id="5992346">*</span><span class="ident" id="5992347">ast</span><span class="op" id="5992350">.</span><span class="ident" id="5992351">GoStmt</span><span class="op" id="5992357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992361">p</span><span class="op" id="5992362">.</span><span class="builtinfunc" id="5992363">print</span><span class="op" id="5992368">(</span><span class="ident" id="5992369">token</span><span class="op" id="5992374">.</span><span class="ident" id="5992375">GO</span><span class="op" id="5992377">,</span>&nbsp;<span class="ident" id="5992379">blank</span><span class="op" id="5992384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992388">p</span><span class="op" id="5992389">.</span><span class="ident" id="5992390">expr</span><span class="op" id="5992394">(</span><span class="ident" id="5992395">s</span><span class="op" id="5992396">.</span><span class="ident" id="5992397">Call</span><span class="op" id="5992401">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992405">case</span>&nbsp;<span class="op" id="5992410">*</span><span class="ident" id="5992411">ast</span><span class="op" id="5992414">.</span><span class="ident" id="5992415">DeferStmt</span><span class="op" id="5992424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992428">p</span><span class="op" id="5992429">.</span><span class="builtinfunc" id="5992430">print</span><span class="op" id="5992435">(</span><span class="ident" id="5992436">token</span><span class="op" id="5992441">.</span><span class="ident" id="5992442">DEFER</span><span class="op" id="5992447">,</span>&nbsp;<span class="ident" id="5992449">blank</span><span class="op" id="5992454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992458">p</span><span class="op" id="5992459">.</span><span class="ident" id="5992460">expr</span><span class="op" id="5992464">(</span><span class="ident" id="5992465">s</span><span class="op" id="5992466">.</span><span class="ident" id="5992467">Call</span><span class="op" id="5992471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992475">case</span>&nbsp;<span class="op" id="5992480">*</span><span class="ident" id="5992481">ast</span><span class="op" id="5992484">.</span><span class="ident" id="5992485">ReturnStmt</span><span class="op" id="5992495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992499">p</span><span class="op" id="5992500">.</span><span class="builtinfunc" id="5992501">print</span><span class="op" id="5992506">(</span><span class="ident" id="5992507">token</span><span class="op" id="5992512">.</span><span class="ident" id="5992513">RETURN</span><span class="op" id="5992519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992523">if</span>&nbsp;<span class="ident" id="5992526">s</span><span class="op" id="5992527">.</span><span class="ident" id="5992528">Results</span>&nbsp;<span class="op" id="5992536">!=</span>&nbsp;<span class="ident" id="5992539">nil</span>&nbsp;<span class="op" id="5992543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992548">p</span><span class="op" id="5992549">.</span><span class="builtinfunc" id="5992550">print</span><span class="op" id="5992555">(</span><span class="ident" id="5992556">blank</span><span class="op" id="5992561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5992566">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5992623">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5992683">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5992737">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5992793">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5992846">if</span>&nbsp;<span class="ident" id="5992849">p</span><span class="op" id="5992850">.</span><span class="ident" id="5992851">indentList</span><span class="op" id="5992861">(</span><span class="ident" id="5992862">s</span><span class="op" id="5992863">.</span><span class="ident" id="5992864">Results</span><span class="op" id="5992871">)</span>&nbsp;<span class="op" id="5992873">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992879">p</span><span class="op" id="5992880">.</span><span class="builtinfunc" id="5992881">print</span><span class="op" id="5992886">(</span><span class="ident" id="5992887">indent</span><span class="op" id="5992893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992899">p</span><span class="op" id="5992900">.</span><span class="ident" id="5992901">exprList</span><span class="op" id="5992909">(</span><span class="ident" id="5992910">s</span><span class="op" id="5992911">.</span><span class="ident" id="5992912">Pos</span><span class="op" id="5992915">(</span><span class="op" id="5992916">)</span><span class="op" id="5992917">,</span>&nbsp;<span class="ident" id="5992919">s</span><span class="op" id="5992920">.</span><span class="ident" id="5992921">Results</span><span class="op" id="5992928">,</span>&nbsp;<span class="num" id="5992930">1</span><span class="op" id="5992931">,</span>&nbsp;<span class="ident" id="5992933">noIndent</span><span class="op" id="5992941">,</span>&nbsp;<span class="ident" id="5992943">token</span><span class="op" id="5992948">.</span><span class="ident" id="5992949">NoPos</span><span class="op" id="5992954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992960">p</span><span class="op" id="5992961">.</span><span class="builtinfunc" id="5992962">print</span><span class="op" id="5992967">(</span><span class="ident" id="5992968">unindent</span><span class="op" id="5992976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5992981">}</span>&nbsp;<span class="keyword" id="5992983">else</span>&nbsp;<span class="op" id="5992988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5992994">p</span><span class="op" id="5992995">.</span><span class="ident" id="5992996">exprList</span><span class="op" id="5993004">(</span><span class="ident" id="5993005">s</span><span class="op" id="5993006">.</span><span class="ident" id="5993007">Pos</span><span class="op" id="5993010">(</span><span class="op" id="5993011">)</span><span class="op" id="5993012">,</span>&nbsp;<span class="ident" id="5993014">s</span><span class="op" id="5993015">.</span><span class="ident" id="5993016">Results</span><span class="op" id="5993023">,</span>&nbsp;<span class="num" id="5993025">1</span><span class="op" id="5993026">,</span>&nbsp;<span class="num" id="5993028">0</span><span class="op" id="5993029">,</span>&nbsp;<span class="ident" id="5993031">token</span><span class="op" id="5993036">.</span><span class="ident" id="5993037">NoPos</span><span class="op" id="5993042">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5993047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5993051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993055">case</span>&nbsp;<span class="op" id="5993060">*</span><span class="ident" id="5993061">ast</span><span class="op" id="5993064">.</span><span class="ident" id="5993065">BranchStmt</span><span class="op" id="5993075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993079">p</span><span class="op" id="5993080">.</span><span class="builtinfunc" id="5993081">print</span><span class="op" id="5993086">(</span><span class="ident" id="5993087">s</span><span class="op" id="5993088">.</span><span class="ident" id="5993089">Tok</span><span class="op" id="5993092">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993096">if</span>&nbsp;<span class="ident" id="5993099">s</span><span class="op" id="5993100">.</span><span class="ident" id="5993101">Label</span>&nbsp;<span class="op" id="5993107">!=</span>&nbsp;<span class="ident" id="5993110">nil</span>&nbsp;<span class="op" id="5993114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993119">p</span><span class="op" id="5993120">.</span><span class="builtinfunc" id="5993121">print</span><span class="op" id="5993126">(</span><span class="ident" id="5993127">blank</span><span class="op" id="5993132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993137">p</span><span class="op" id="5993138">.</span><span class="ident" id="5993139">expr</span><span class="op" id="5993143">(</span><span class="ident" id="5993144">s</span><span class="op" id="5993145">.</span><span class="ident" id="5993146">Label</span><span class="op" id="5993151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5993155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993159">case</span>&nbsp;<span class="op" id="5993164">*</span><span class="ident" id="5993165">ast</span><span class="op" id="5993168">.</span><span class="ident" id="5993169">BlockStmt</span><span class="op" id="5993178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993182">p</span><span class="op" id="5993183">.</span><span class="ident" id="5993184">block</span><span class="op" id="5993189">(</span><span class="ident" id="5993190">s</span><span class="op" id="5993191">,</span>&nbsp;<span class="num" id="5993193">1</span><span class="op" id="5993194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993198">case</span>&nbsp;<span class="op" id="5993203">*</span><span class="ident" id="5993204">ast</span><span class="op" id="5993207">.</span><span class="ident" id="5993208">IfStmt</span><span class="op" id="5993214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993218">p</span><span class="op" id="5993219">.</span><span class="builtinfunc" id="5993220">print</span><span class="op" id="5993225">(</span><span class="ident" id="5993226">token</span><span class="op" id="5993231">.</span><span class="ident" id="5993232">IF</span><span class="op" id="5993234">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993238">p</span><span class="op" id="5993239">.</span><span class="ident" id="5993240">controlClause</span><span class="op" id="5993253">(</span><span class="builtintype" id="5993254">false</span><span class="op" id="5993259">,</span>&nbsp;<span class="ident" id="5993261">s</span><span class="op" id="5993262">.</span><span class="ident" id="5993263">Init</span><span class="op" id="5993267">,</span>&nbsp;<span class="ident" id="5993269">s</span><span class="op" id="5993270">.</span><span class="ident" id="5993271">Cond</span><span class="op" id="5993275">,</span>&nbsp;<span class="ident" id="5993277">nil</span><span class="op" id="5993280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993284">p</span><span class="op" id="5993285">.</span><span class="ident" id="5993286">block</span><span class="op" id="5993291">(</span><span class="ident" id="5993292">s</span><span class="op" id="5993293">.</span><span class="ident" id="5993294">Body</span><span class="op" id="5993298">,</span>&nbsp;<span class="num" id="5993300">1</span><span class="op" id="5993301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993305">if</span>&nbsp;<span class="ident" id="5993308">s</span><span class="op" id="5993309">.</span><span class="ident" id="5993310">Else</span>&nbsp;<span class="op" id="5993315">!=</span>&nbsp;<span class="ident" id="5993318">nil</span>&nbsp;<span class="op" id="5993322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993327">p</span><span class="op" id="5993328">.</span><span class="builtinfunc" id="5993329">print</span><span class="op" id="5993334">(</span><span class="ident" id="5993335">blank</span><span class="op" id="5993340">,</span>&nbsp;<span class="ident" id="5993342">token</span><span class="op" id="5993347">.</span><span class="ident" id="5993348">ELSE</span><span class="op" id="5993352">,</span>&nbsp;<span class="ident" id="5993354">blank</span><span class="op" id="5993359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993364">switch</span>&nbsp;<span class="ident" id="5993371">s</span><span class="op" id="5993372">.</span><span class="ident" id="5993373">Else</span><span class="op" id="5993377">.</span><span class="op" id="5993378">(</span><span class="keyword" id="5993379">type</span><span class="op" id="5993383">)</span>&nbsp;<span class="op" id="5993385">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993390">case</span>&nbsp;<span class="op" id="5993395">*</span><span class="ident" id="5993396">ast</span><span class="op" id="5993399">.</span><span class="ident" id="5993400">BlockStmt</span><span class="op" id="5993409">,</span>&nbsp;<span class="op" id="5993411">*</span><span class="ident" id="5993412">ast</span><span class="op" id="5993415">.</span><span class="ident" id="5993416">IfStmt</span><span class="op" id="5993422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993428">p</span><span class="op" id="5993429">.</span><span class="ident" id="5993430">stmt</span><span class="op" id="5993434">(</span><span class="ident" id="5993435">s</span><span class="op" id="5993436">.</span><span class="ident" id="5993437">Else</span><span class="op" id="5993441">,</span>&nbsp;<span class="ident" id="5993443">nextIsRBrace</span><span class="op" id="5993455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993460">default</span><span class="op" id="5993467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993473">p</span><span class="op" id="5993474">.</span><span class="builtinfunc" id="5993475">print</span><span class="op" id="5993480">(</span><span class="ident" id="5993481">token</span><span class="op" id="5993486">.</span><span class="ident" id="5993487">LBRACE</span><span class="op" id="5993493">,</span>&nbsp;<span class="ident" id="5993495">indent</span><span class="op" id="5993501">,</span>&nbsp;<span class="ident" id="5993503">formfeed</span><span class="op" id="5993511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993517">p</span><span class="op" id="5993518">.</span><span class="ident" id="5993519">stmt</span><span class="op" id="5993523">(</span><span class="ident" id="5993524">s</span><span class="op" id="5993525">.</span><span class="ident" id="5993526">Else</span><span class="op" id="5993530">,</span>&nbsp;<span class="builtintype" id="5993532">true</span><span class="op" id="5993536">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993542">p</span><span class="op" id="5993543">.</span><span class="builtinfunc" id="5993544">print</span><span class="op" id="5993549">(</span><span class="ident" id="5993550">unindent</span><span class="op" id="5993558">,</span>&nbsp;<span class="ident" id="5993560">formfeed</span><span class="op" id="5993568">,</span>&nbsp;<span class="ident" id="5993570">token</span><span class="op" id="5993575">.</span><span class="ident" id="5993576">RBRACE</span><span class="op" id="5993582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5993587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5993591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993595">case</span>&nbsp;<span class="op" id="5993600">*</span><span class="ident" id="5993601">ast</span><span class="op" id="5993604">.</span><span class="ident" id="5993605">CaseClause</span><span class="op" id="5993615">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993619">if</span>&nbsp;<span class="ident" id="5993622">s</span><span class="op" id="5993623">.</span><span class="ident" id="5993624">List</span>&nbsp;<span class="op" id="5993629">!=</span>&nbsp;<span class="ident" id="5993632">nil</span>&nbsp;<span class="op" id="5993636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993641">p</span><span class="op" id="5993642">.</span><span class="builtinfunc" id="5993643">print</span><span class="op" id="5993648">(</span><span class="ident" id="5993649">token</span><span class="op" id="5993654">.</span><span class="ident" id="5993655">CASE</span><span class="op" id="5993659">,</span>&nbsp;<span class="ident" id="5993661">blank</span><span class="op" id="5993666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993671">p</span><span class="op" id="5993672">.</span><span class="ident" id="5993673">exprList</span><span class="op" id="5993681">(</span><span class="ident" id="5993682">s</span><span class="op" id="5993683">.</span><span class="ident" id="5993684">Pos</span><span class="op" id="5993687">(</span><span class="op" id="5993688">)</span><span class="op" id="5993689">,</span>&nbsp;<span class="ident" id="5993691">s</span><span class="op" id="5993692">.</span><span class="ident" id="5993693">List</span><span class="op" id="5993697">,</span>&nbsp;<span class="num" id="5993699">1</span><span class="op" id="5993700">,</span>&nbsp;<span class="num" id="5993702">0</span><span class="op" id="5993703">,</span>&nbsp;<span class="ident" id="5993705">s</span><span class="op" id="5993706">.</span><span class="ident" id="5993707">Colon</span><span class="op" id="5993712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5993716">}</span>&nbsp;<span class="keyword" id="5993718">else</span>&nbsp;<span class="op" id="5993723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993728">p</span><span class="op" id="5993729">.</span><span class="builtinfunc" id="5993730">print</span><span class="op" id="5993735">(</span><span class="ident" id="5993736">token</span><span class="op" id="5993741">.</span><span class="ident" id="5993742">DEFAULT</span><span class="op" id="5993749">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5993753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993757">p</span><span class="op" id="5993758">.</span><span class="builtinfunc" id="5993759">print</span><span class="op" id="5993764">(</span><span class="ident" id="5993765">s</span><span class="op" id="5993766">.</span><span class="ident" id="5993767">Colon</span><span class="op" id="5993772">,</span>&nbsp;<span class="ident" id="5993774">token</span><span class="op" id="5993779">.</span><span class="ident" id="5993780">COLON</span><span class="op" id="5993785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993789">p</span><span class="op" id="5993790">.</span><span class="ident" id="5993791">stmtList</span><span class="op" id="5993799">(</span><span class="ident" id="5993800">s</span><span class="op" id="5993801">.</span><span class="ident" id="5993802">Body</span><span class="op" id="5993806">,</span>&nbsp;<span class="num" id="5993808">1</span><span class="op" id="5993809">,</span>&nbsp;<span class="ident" id="5993811">nextIsRBrace</span><span class="op" id="5993823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993827">case</span>&nbsp;<span class="op" id="5993832">*</span><span class="ident" id="5993833">ast</span><span class="op" id="5993836">.</span><span class="ident" id="5993837">SwitchStmt</span><span class="op" id="5993847">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993851">p</span><span class="op" id="5993852">.</span><span class="builtinfunc" id="5993853">print</span><span class="op" id="5993858">(</span><span class="ident" id="5993859">token</span><span class="op" id="5993864">.</span><span class="ident" id="5993865">SWITCH</span><span class="op" id="5993871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993875">p</span><span class="op" id="5993876">.</span><span class="ident" id="5993877">controlClause</span><span class="op" id="5993890">(</span><span class="builtintype" id="5993891">false</span><span class="op" id="5993896">,</span>&nbsp;<span class="ident" id="5993898">s</span><span class="op" id="5993899">.</span><span class="ident" id="5993900">Init</span><span class="op" id="5993904">,</span>&nbsp;<span class="ident" id="5993906">s</span><span class="op" id="5993907">.</span><span class="ident" id="5993908">Tag</span><span class="op" id="5993911">,</span>&nbsp;<span class="ident" id="5993913">nil</span><span class="op" id="5993916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993920">p</span><span class="op" id="5993921">.</span><span class="ident" id="5993922">block</span><span class="op" id="5993927">(</span><span class="ident" id="5993928">s</span><span class="op" id="5993929">.</span><span class="ident" id="5993930">Body</span><span class="op" id="5993934">,</span>&nbsp;<span class="num" id="5993936">0</span><span class="op" id="5993937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993941">case</span>&nbsp;<span class="op" id="5993946">*</span><span class="ident" id="5993947">ast</span><span class="op" id="5993950">.</span><span class="ident" id="5993951">TypeSwitchStmt</span><span class="op" id="5993965">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5993969">p</span><span class="op" id="5993970">.</span><span class="builtinfunc" id="5993971">print</span><span class="op" id="5993976">(</span><span class="ident" id="5993977">token</span><span class="op" id="5993982">.</span><span class="ident" id="5993983">SWITCH</span><span class="op" id="5993989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5993993">if</span>&nbsp;<span class="ident" id="5993996">s</span><span class="op" id="5993997">.</span><span class="ident" id="5993998">Init</span>&nbsp;<span class="op" id="5994003">!=</span>&nbsp;<span class="ident" id="5994006">nil</span>&nbsp;<span class="op" id="5994010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994015">p</span><span class="op" id="5994016">.</span><span class="builtinfunc" id="5994017">print</span><span class="op" id="5994022">(</span><span class="ident" id="5994023">blank</span><span class="op" id="5994028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994033">p</span><span class="op" id="5994034">.</span><span class="ident" id="5994035">stmt</span><span class="op" id="5994039">(</span><span class="ident" id="5994040">s</span><span class="op" id="5994041">.</span><span class="ident" id="5994042">Init</span><span class="op" id="5994046">,</span>&nbsp;<span class="builtintype" id="5994048">false</span><span class="op" id="5994053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994058">p</span><span class="op" id="5994059">.</span><span class="builtinfunc" id="5994060">print</span><span class="op" id="5994065">(</span><span class="ident" id="5994066">token</span><span class="op" id="5994071">.</span><span class="ident" id="5994072">SEMICOLON</span><span class="op" id="5994081">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5994085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994089">p</span><span class="op" id="5994090">.</span><span class="builtinfunc" id="5994091">print</span><span class="op" id="5994096">(</span><span class="ident" id="5994097">blank</span><span class="op" id="5994102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994106">p</span><span class="op" id="5994107">.</span><span class="ident" id="5994108">stmt</span><span class="op" id="5994112">(</span><span class="ident" id="5994113">s</span><span class="op" id="5994114">.</span><span class="ident" id="5994115">Assign</span><span class="op" id="5994121">,</span>&nbsp;<span class="builtintype" id="5994123">false</span><span class="op" id="5994128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994132">p</span><span class="op" id="5994133">.</span><span class="builtinfunc" id="5994134">print</span><span class="op" id="5994139">(</span><span class="ident" id="5994140">blank</span><span class="op" id="5994145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994149">p</span><span class="op" id="5994150">.</span><span class="ident" id="5994151">block</span><span class="op" id="5994156">(</span><span class="ident" id="5994157">s</span><span class="op" id="5994158">.</span><span class="ident" id="5994159">Body</span><span class="op" id="5994163">,</span>&nbsp;<span class="num" id="5994165">0</span><span class="op" id="5994166">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994170">case</span>&nbsp;<span class="op" id="5994175">*</span><span class="ident" id="5994176">ast</span><span class="op" id="5994179">.</span><span class="ident" id="5994180">CommClause</span><span class="op" id="5994190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994194">if</span>&nbsp;<span class="ident" id="5994197">s</span><span class="op" id="5994198">.</span><span class="ident" id="5994199">Comm</span>&nbsp;<span class="op" id="5994204">!=</span>&nbsp;<span class="ident" id="5994207">nil</span>&nbsp;<span class="op" id="5994211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994216">p</span><span class="op" id="5994217">.</span><span class="builtinfunc" id="5994218">print</span><span class="op" id="5994223">(</span><span class="ident" id="5994224">token</span><span class="op" id="5994229">.</span><span class="ident" id="5994230">CASE</span><span class="op" id="5994234">,</span>&nbsp;<span class="ident" id="5994236">blank</span><span class="op" id="5994241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994246">p</span><span class="op" id="5994247">.</span><span class="ident" id="5994248">stmt</span><span class="op" id="5994252">(</span><span class="ident" id="5994253">s</span><span class="op" id="5994254">.</span><span class="ident" id="5994255">Comm</span><span class="op" id="5994259">,</span>&nbsp;<span class="builtintype" id="5994261">false</span><span class="op" id="5994266">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5994270">}</span>&nbsp;<span class="keyword" id="5994272">else</span>&nbsp;<span class="op" id="5994277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994282">p</span><span class="op" id="5994283">.</span><span class="builtinfunc" id="5994284">print</span><span class="op" id="5994289">(</span><span class="ident" id="5994290">token</span><span class="op" id="5994295">.</span><span class="ident" id="5994296">DEFAULT</span><span class="op" id="5994303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5994307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994311">p</span><span class="op" id="5994312">.</span><span class="builtinfunc" id="5994313">print</span><span class="op" id="5994318">(</span><span class="ident" id="5994319">s</span><span class="op" id="5994320">.</span><span class="ident" id="5994321">Colon</span><span class="op" id="5994326">,</span>&nbsp;<span class="ident" id="5994328">token</span><span class="op" id="5994333">.</span><span class="ident" id="5994334">COLON</span><span class="op" id="5994339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994343">p</span><span class="op" id="5994344">.</span><span class="ident" id="5994345">stmtList</span><span class="op" id="5994353">(</span><span class="ident" id="5994354">s</span><span class="op" id="5994355">.</span><span class="ident" id="5994356">Body</span><span class="op" id="5994360">,</span>&nbsp;<span class="num" id="5994362">1</span><span class="op" id="5994363">,</span>&nbsp;<span class="ident" id="5994365">nextIsRBrace</span><span class="op" id="5994377">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994381">case</span>&nbsp;<span class="op" id="5994386">*</span><span class="ident" id="5994387">ast</span><span class="op" id="5994390">.</span><span class="ident" id="5994391">SelectStmt</span><span class="op" id="5994401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994405">p</span><span class="op" id="5994406">.</span><span class="builtinfunc" id="5994407">print</span><span class="op" id="5994412">(</span><span class="ident" id="5994413">token</span><span class="op" id="5994418">.</span><span class="ident" id="5994419">SELECT</span><span class="op" id="5994425">,</span>&nbsp;<span class="ident" id="5994427">blank</span><span class="op" id="5994432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994436">body</span>&nbsp;<span class="op" id="5994441">:=</span>&nbsp;<span class="ident" id="5994444">s</span><span class="op" id="5994445">.</span><span class="ident" id="5994446">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994453">if</span>&nbsp;<span class="builtinfunc" id="5994456">len</span><span class="op" id="5994459">(</span><span class="ident" id="5994460">body</span><span class="op" id="5994464">.</span><span class="ident" id="5994465">List</span><span class="op" id="5994469">)</span>&nbsp;<span class="op" id="5994471">==</span>&nbsp;<span class="num" id="5994474">0</span>&nbsp;<span class="op" id="5994476">&amp;&amp;</span>&nbsp;<span class="op" id="5994479">!</span><span class="ident" id="5994480">p</span><span class="op" id="5994481">.</span><span class="ident" id="5994482">commentBefore</span><span class="op" id="5994495">(</span><span class="ident" id="5994496">p</span><span class="op" id="5994497">.</span><span class="ident" id="5994498">posFor</span><span class="op" id="5994504">(</span><span class="ident" id="5994505">body</span><span class="op" id="5994509">.</span><span class="ident" id="5994510">Rbrace</span><span class="op" id="5994516">)</span><span class="op" id="5994517">)</span>&nbsp;<span class="op" id="5994519">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5994524">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994584">p</span><span class="op" id="5994585">.</span><span class="builtinfunc" id="5994586">print</span><span class="op" id="5994591">(</span><span class="ident" id="5994592">body</span><span class="op" id="5994596">.</span><span class="ident" id="5994597">Lbrace</span><span class="op" id="5994603">,</span>&nbsp;<span class="ident" id="5994605">token</span><span class="op" id="5994610">.</span><span class="ident" id="5994611">LBRACE</span><span class="op" id="5994617">,</span>&nbsp;<span class="ident" id="5994619">body</span><span class="op" id="5994623">.</span><span class="ident" id="5994624">Rbrace</span><span class="op" id="5994630">,</span>&nbsp;<span class="ident" id="5994632">token</span><span class="op" id="5994637">.</span><span class="ident" id="5994638">RBRACE</span><span class="op" id="5994644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5994648">}</span>&nbsp;<span class="keyword" id="5994650">else</span>&nbsp;<span class="op" id="5994655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994660">p</span><span class="op" id="5994661">.</span><span class="ident" id="5994662">block</span><span class="op" id="5994667">(</span><span class="ident" id="5994668">body</span><span class="op" id="5994672">,</span>&nbsp;<span class="num" id="5994674">0</span><span class="op" id="5994675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5994679">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994683">case</span>&nbsp;<span class="op" id="5994688">*</span><span class="ident" id="5994689">ast</span><span class="op" id="5994692">.</span><span class="ident" id="5994693">ForStmt</span><span class="op" id="5994700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994704">p</span><span class="op" id="5994705">.</span><span class="builtinfunc" id="5994706">print</span><span class="op" id="5994711">(</span><span class="ident" id="5994712">token</span><span class="op" id="5994717">.</span><span class="ident" id="5994718">FOR</span><span class="op" id="5994721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994725">p</span><span class="op" id="5994726">.</span><span class="ident" id="5994727">controlClause</span><span class="op" id="5994740">(</span><span class="builtintype" id="5994741">true</span><span class="op" id="5994745">,</span>&nbsp;<span class="ident" id="5994747">s</span><span class="op" id="5994748">.</span><span class="ident" id="5994749">Init</span><span class="op" id="5994753">,</span>&nbsp;<span class="ident" id="5994755">s</span><span class="op" id="5994756">.</span><span class="ident" id="5994757">Cond</span><span class="op" id="5994761">,</span>&nbsp;<span class="ident" id="5994763">s</span><span class="op" id="5994764">.</span><span class="ident" id="5994765">Post</span><span class="op" id="5994769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994773">p</span><span class="op" id="5994774">.</span><span class="ident" id="5994775">block</span><span class="op" id="5994780">(</span><span class="ident" id="5994781">s</span><span class="op" id="5994782">.</span><span class="ident" id="5994783">Body</span><span class="op" id="5994787">,</span>&nbsp;<span class="num" id="5994789">1</span><span class="op" id="5994790">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994794">case</span>&nbsp;<span class="op" id="5994799">*</span><span class="ident" id="5994800">ast</span><span class="op" id="5994803">.</span><span class="ident" id="5994804">RangeStmt</span><span class="op" id="5994813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994817">p</span><span class="op" id="5994818">.</span><span class="builtinfunc" id="5994819">print</span><span class="op" id="5994824">(</span><span class="ident" id="5994825">token</span><span class="op" id="5994830">.</span><span class="ident" id="5994831">FOR</span><span class="op" id="5994834">,</span>&nbsp;<span class="ident" id="5994836">blank</span><span class="op" id="5994841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994845">if</span>&nbsp;<span class="ident" id="5994848">s</span><span class="op" id="5994849">.</span><span class="ident" id="5994850">Key</span>&nbsp;<span class="op" id="5994854">!=</span>&nbsp;<span class="ident" id="5994857">nil</span>&nbsp;<span class="op" id="5994861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994866">p</span><span class="op" id="5994867">.</span><span class="ident" id="5994868">expr</span><span class="op" id="5994872">(</span><span class="ident" id="5994873">s</span><span class="op" id="5994874">.</span><span class="ident" id="5994875">Key</span><span class="op" id="5994878">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5994883">if</span>&nbsp;<span class="ident" id="5994886">s</span><span class="op" id="5994887">.</span><span class="ident" id="5994888">Value</span>&nbsp;<span class="op" id="5994894">!=</span>&nbsp;<span class="ident" id="5994897">nil</span>&nbsp;<span class="op" id="5994901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5994907">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5994959">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995011">p</span><span class="op" id="5995012">.</span><span class="builtinfunc" id="5995013">print</span><span class="op" id="5995018">(</span><span class="ident" id="5995019">s</span><span class="op" id="5995020">.</span><span class="ident" id="5995021">Value</span><span class="op" id="5995026">.</span><span class="ident" id="5995027">Pos</span><span class="op" id="5995030">(</span><span class="op" id="5995031">)</span><span class="op" id="5995032">,</span>&nbsp;<span class="ident" id="5995034">token</span><span class="op" id="5995039">.</span><span class="ident" id="5995040">COMMA</span><span class="op" id="5995045">,</span>&nbsp;<span class="ident" id="5995047">blank</span><span class="op" id="5995052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995058">p</span><span class="op" id="5995059">.</span><span class="ident" id="5995060">expr</span><span class="op" id="5995064">(</span><span class="ident" id="5995065">s</span><span class="op" id="5995066">.</span><span class="ident" id="5995067">Value</span><span class="op" id="5995072">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5995077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995082">p</span><span class="op" id="5995083">.</span><span class="builtinfunc" id="5995084">print</span><span class="op" id="5995089">(</span><span class="ident" id="5995090">blank</span><span class="op" id="5995095">,</span>&nbsp;<span class="ident" id="5995097">s</span><span class="op" id="5995098">.</span><span class="ident" id="5995099">TokPos</span><span class="op" id="5995105">,</span>&nbsp;<span class="ident" id="5995107">s</span><span class="op" id="5995108">.</span><span class="ident" id="5995109">Tok</span><span class="op" id="5995112">,</span>&nbsp;<span class="ident" id="5995114">blank</span><span class="op" id="5995119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5995123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995127">p</span><span class="op" id="5995128">.</span><span class="builtinfunc" id="5995129">print</span><span class="op" id="5995134">(</span><span class="ident" id="5995135">token</span><span class="op" id="5995140">.</span><span class="ident" id="5995141">RANGE</span><span class="op" id="5995146">,</span>&nbsp;<span class="ident" id="5995148">blank</span><span class="op" id="5995153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995157">p</span><span class="op" id="5995158">.</span><span class="ident" id="5995159">expr</span><span class="op" id="5995163">(</span><span class="ident" id="5995164">stripParens</span><span class="op" id="5995175">(</span><span class="ident" id="5995176">s</span><span class="op" id="5995177">.</span><span class="ident" id="5995178">X</span><span class="op" id="5995179">)</span><span class="op" id="5995180">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995184">p</span><span class="op" id="5995185">.</span><span class="builtinfunc" id="5995186">print</span><span class="op" id="5995191">(</span><span class="ident" id="5995192">blank</span><span class="op" id="5995197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995201">p</span><span class="op" id="5995202">.</span><span class="ident" id="5995203">block</span><span class="op" id="5995208">(</span><span class="ident" id="5995209">s</span><span class="op" id="5995210">.</span><span class="ident" id="5995211">Body</span><span class="op" id="5995215">,</span>&nbsp;<span class="num" id="5995217">1</span><span class="op" id="5995218">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5995222">default</span><span class="op" id="5995229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5995233">panic</span><span class="op" id="5995238">(</span><span class="string" id="5995239">&#34;unreachable&#34;</span><span class="op" id="5995252">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5995255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5995259">return</span><br>
<span class="lineno"></span><span class="op" id="5995266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="5995269">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5995349">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5995366">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5995442">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="5995518">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="5995593">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="5995668">//</span><br>
<span class="lineno"></span><span class="comment" id="5995671">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="5995704">//</span><br>
<span class="lineno">1255</span><span class="comment" id="5995707">//&nbsp;&nbsp;&nbsp;&nbspconst&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="5995718">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5995749">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5995780">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoo</span><br>
<span class="lineno"></span><span class="comment" id="5995788">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="5995814">//&nbsp;&nbsp;&nbsp;&nbsp)</span><br>
<span class="lineno"></span><span class="comment" id="5995819">//</span><br>
<span class="lineno"></span><span class="comment" id="5995822">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="5995895">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5995970">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="5996047">//</span><br>
<span class="lineno"></span><span class="comment" id="5996050">//&nbsp;&nbsp;&nbsp;&nbspmatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="5996088">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="5996117">//&nbsp;&nbsp;&nbsp;&nbspT&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5996187">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="5996248">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="5996285">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="5996351">//</span><br>
<span class="lineno"></span><span class="keyword" id="5996354">func</span>&nbsp;<span class="ident" id="5996359">keepTypeColumn</span><span class="op" id="5996373">(</span><span class="ident" id="5996374">specs</span>&nbsp;<span class="op" id="5996380">[</span><span class="op" id="5996381">]</span><span class="ident" id="5996382">ast</span><span class="op" id="5996385">.</span><span class="ident" id="5996386">Spec</span><span class="op" id="5996390">)</span>&nbsp;<span class="op" id="5996392">[</span><span class="op" id="5996393">]</span><span class="builtintype" id="5996394">bool</span>&nbsp;<span class="op" id="5996399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996402">m</span>&nbsp;<span class="op" id="5996404">:=</span>&nbsp;<span class="builtinfunc" id="5996407">make</span><span class="op" id="5996411">(</span><span class="op" id="5996412">[</span><span class="op" id="5996413">]</span><span class="builtintype" id="5996414">bool</span><span class="op" id="5996418">,</span>&nbsp;<span class="builtinfunc" id="5996420">len</span><span class="op" id="5996423">(</span><span class="ident" id="5996424">specs</span><span class="op" id="5996429">)</span><span class="op" id="5996430">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996434">populate</span>&nbsp;<span class="op" id="5996443">:=</span>&nbsp;<span class="keyword" id="5996446">func</span><span class="op" id="5996450">(</span><span class="ident" id="5996451">i</span><span class="op" id="5996452">,</span>&nbsp;<span class="ident" id="5996454">j</span>&nbsp;<span class="builtintype" id="5996456">int</span><span class="op" id="5996459">,</span>&nbsp;<span class="ident" id="5996461">keepType</span>&nbsp;<span class="builtintype" id="5996470">bool</span><span class="op" id="5996474">)</span>&nbsp;<span class="op" id="5996476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996480">if</span>&nbsp;<span class="ident" id="5996483">keepType</span>&nbsp;<span class="op" id="5996492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996497">for</span>&nbsp;<span class="op" id="5996501">;</span>&nbsp;<span class="ident" id="5996503">i</span>&nbsp;<span class="op" id="5996505">&lt;</span>&nbsp;<span class="ident" id="5996507">j</span><span class="op" id="5996508">;</span>&nbsp;<span class="ident" id="5996510">i</span><span class="op" id="5996511">++</span>&nbsp;<span class="op" id="5996514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996520">m</span><span class="op" id="5996521">[</span><span class="ident" id="5996522">i</span><span class="op" id="5996523">]</span>&nbsp;<span class="op" id="5996525">=</span>&nbsp;<span class="builtintype" id="5996527">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996546">i0</span>&nbsp;<span class="op" id="5996549">:=</span>&nbsp;<span class="op" id="5996552">-</span><span class="num" id="5996553">1</span>&nbsp;<span class="comment" id="5996555">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996617">var</span>&nbsp;<span class="ident" id="5996621">keepType</span>&nbsp;<span class="builtintype" id="5996630">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996636">for</span>&nbsp;<span class="ident" id="5996640">i</span><span class="op" id="5996641">,</span>&nbsp;<span class="ident" id="5996643">s</span>&nbsp;<span class="op" id="5996645">:=</span>&nbsp;<span class="keyword" id="5996648">range</span>&nbsp;<span class="ident" id="5996654">specs</span>&nbsp;<span class="op" id="5996660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996664">t</span>&nbsp;<span class="op" id="5996666">:=</span>&nbsp;<span class="ident" id="5996669">s</span><span class="op" id="5996670">.</span><span class="op" id="5996671">(</span><span class="op" id="5996672">*</span><span class="ident" id="5996673">ast</span><span class="op" id="5996676">.</span><span class="ident" id="5996677">ValueSpec</span><span class="op" id="5996686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996690">if</span>&nbsp;<span class="ident" id="5996693">t</span><span class="op" id="5996694">.</span><span class="ident" id="5996695">Values</span>&nbsp;<span class="op" id="5996702">!=</span>&nbsp;<span class="ident" id="5996705">nil</span>&nbsp;<span class="op" id="5996709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996714">if</span>&nbsp;<span class="ident" id="5996717">i0</span>&nbsp;<span class="op" id="5996720">&lt;</span>&nbsp;<span class="num" id="5996722">0</span>&nbsp;<span class="op" id="5996724">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5996730">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996786">i0</span>&nbsp;<span class="op" id="5996789">=</span>&nbsp;<span class="ident" id="5996791">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996797">keepType</span>&nbsp;<span class="op" id="5996806">=</span>&nbsp;<span class="builtintype" id="5996808">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996821">}</span>&nbsp;<span class="keyword" id="5996823">else</span>&nbsp;<span class="op" id="5996828">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996833">if</span>&nbsp;<span class="ident" id="5996836">i0</span>&nbsp;<span class="op" id="5996839">&gt;=</span>&nbsp;<span class="num" id="5996842">0</span>&nbsp;<span class="op" id="5996844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5996850">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996870">populate</span><span class="op" id="5996878">(</span><span class="ident" id="5996879">i0</span><span class="op" id="5996881">,</span>&nbsp;<span class="ident" id="5996883">i</span><span class="op" id="5996884">,</span>&nbsp;<span class="ident" id="5996886">keepType</span><span class="op" id="5996894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996900">i0</span>&nbsp;<span class="op" id="5996903">=</span>&nbsp;<span class="op" id="5996905">-</span><span class="num" id="5996906">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996911">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996919">if</span>&nbsp;<span class="ident" id="5996922">t</span><span class="op" id="5996923">.</span><span class="ident" id="5996924">Type</span>&nbsp;<span class="op" id="5996929">!=</span>&nbsp;<span class="ident" id="5996932">nil</span>&nbsp;<span class="op" id="5996936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996941">keepType</span>&nbsp;<span class="op" id="5996950">=</span>&nbsp;<span class="builtintype" id="5996952">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996962">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996965">if</span>&nbsp;<span class="ident" id="5996968">i0</span>&nbsp;<span class="op" id="5996971">&gt;=</span>&nbsp;<span class="num" id="5996974">0</span>&nbsp;<span class="op" id="5996976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5996980">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996998">populate</span><span class="op" id="5997006">(</span><span class="ident" id="5997007">i0</span><span class="op" id="5997009">,</span>&nbsp;<span class="builtinfunc" id="5997011">len</span><span class="op" id="5997014">(</span><span class="ident" id="5997015">specs</span><span class="op" id="5997020">)</span><span class="op" id="5997021">,</span>&nbsp;<span class="ident" id="5997023">keepType</span><span class="op" id="5997031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997038">return</span>&nbsp;<span class="ident" id="5997045">m</span><br>
<span class="lineno"></span><span class="op" id="5997047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5997050">func</span>&nbsp;<span class="op" id="5997055">(</span><span class="ident" id="5997056">p</span>&nbsp;<span class="op" id="5997058">*</span><span class="ident" id="5997059">printer</span><span class="op" id="5997066">)</span>&nbsp;<span class="ident" id="5997068">valueSpec</span><span class="op" id="5997077">(</span><span class="ident" id="5997078">s</span>&nbsp;<span class="op" id="5997080">*</span><span class="ident" id="5997081">ast</span><span class="op" id="5997084">.</span><span class="ident" id="5997085">ValueSpec</span><span class="op" id="5997094">,</span>&nbsp;<span class="ident" id="5997096">keepType</span>&nbsp;<span class="builtintype" id="5997105">bool</span><span class="op" id="5997109">)</span>&nbsp;<span class="op" id="5997111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997114">p</span><span class="op" id="5997115">.</span><span class="ident" id="5997116">setComment</span><span class="op" id="5997126">(</span><span class="ident" id="5997127">s</span><span class="op" id="5997128">.</span><span class="ident" id="5997129">Doc</span><span class="op" id="5997132">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997135">p</span><span class="op" id="5997136">.</span><span class="ident" id="5997137">identList</span><span class="op" id="5997146">(</span><span class="ident" id="5997147">s</span><span class="op" id="5997148">.</span><span class="ident" id="5997149">Names</span><span class="op" id="5997154">,</span>&nbsp;<span class="builtintype" id="5997156">false</span><span class="op" id="5997161">)</span>&nbsp;<span class="comment" id="5997163">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997182">extraTabs</span>&nbsp;<span class="op" id="5997192">:=</span>&nbsp;<span class="num" id="5997195">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997198">if</span>&nbsp;<span class="ident" id="5997201">s</span><span class="op" id="5997202">.</span><span class="ident" id="5997203">Type</span>&nbsp;<span class="op" id="5997208">!=</span>&nbsp;<span class="ident" id="5997211">nil</span>&nbsp;<span class="op" id="5997215">||</span>&nbsp;<span class="ident" id="5997218">keepType</span>&nbsp;<span class="op" id="5997227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997231">p</span><span class="op" id="5997232">.</span><span class="builtinfunc" id="5997233">print</span><span class="op" id="5997238">(</span><span class="ident" id="5997239">vtab</span><span class="op" id="5997243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997247">extraTabs</span><span class="op" id="5997256">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997263">if</span>&nbsp;<span class="ident" id="5997266">s</span><span class="op" id="5997267">.</span><span class="ident" id="5997268">Type</span>&nbsp;<span class="op" id="5997273">!=</span>&nbsp;<span class="ident" id="5997276">nil</span>&nbsp;<span class="op" id="5997280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997284">p</span><span class="op" id="5997285">.</span><span class="ident" id="5997286">expr</span><span class="op" id="5997290">(</span><span class="ident" id="5997291">s</span><span class="op" id="5997292">.</span><span class="ident" id="5997293">Type</span><span class="op" id="5997297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997303">if</span>&nbsp;<span class="ident" id="5997306">s</span><span class="op" id="5997307">.</span><span class="ident" id="5997308">Values</span>&nbsp;<span class="op" id="5997315">!=</span>&nbsp;<span class="ident" id="5997318">nil</span>&nbsp;<span class="op" id="5997322">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997326">p</span><span class="op" id="5997327">.</span><span class="builtinfunc" id="5997328">print</span><span class="op" id="5997333">(</span><span class="ident" id="5997334">vtab</span><span class="op" id="5997338">,</span>&nbsp;<span class="ident" id="5997340">token</span><span class="op" id="5997345">.</span><span class="ident" id="5997346">ASSIGN</span><span class="op" id="5997352">,</span>&nbsp;<span class="ident" id="5997354">blank</span><span class="op" id="5997359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997363">p</span><span class="op" id="5997364">.</span><span class="ident" id="5997365">exprList</span><span class="op" id="5997373">(</span><span class="ident" id="5997374">token</span><span class="op" id="5997379">.</span><span class="ident" id="5997380">NoPos</span><span class="op" id="5997385">,</span>&nbsp;<span class="ident" id="5997387">s</span><span class="op" id="5997388">.</span><span class="ident" id="5997389">Values</span><span class="op" id="5997395">,</span>&nbsp;<span class="num" id="5997397">1</span><span class="op" id="5997398">,</span>&nbsp;<span class="num" id="5997400">0</span><span class="op" id="5997401">,</span>&nbsp;<span class="ident" id="5997403">token</span><span class="op" id="5997408">.</span><span class="ident" id="5997409">NoPos</span><span class="op" id="5997414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997418">extraTabs</span><span class="op" id="5997427">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997434">if</span>&nbsp;<span class="ident" id="5997437">s</span><span class="op" id="5997438">.</span><span class="ident" id="5997439">Comment</span>&nbsp;<span class="op" id="5997447">!=</span>&nbsp;<span class="ident" id="5997450">nil</span>&nbsp;<span class="op" id="5997454">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997458">for</span>&nbsp;<span class="op" id="5997462">;</span>&nbsp;<span class="ident" id="5997464">extraTabs</span>&nbsp;<span class="op" id="5997474">&gt;</span>&nbsp;<span class="num" id="5997476">0</span><span class="op" id="5997477">;</span>&nbsp;<span class="ident" id="5997479">extraTabs</span><span class="op" id="5997488">--</span>&nbsp;<span class="op" id="5997491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997496">p</span><span class="op" id="5997497">.</span><span class="builtinfunc" id="5997498">print</span><span class="op" id="5997503">(</span><span class="ident" id="5997504">vtab</span><span class="op" id="5997508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997516">p</span><span class="op" id="5997517">.</span><span class="ident" id="5997518">setComment</span><span class="op" id="5997528">(</span><span class="ident" id="5997529">s</span><span class="op" id="5997530">.</span><span class="ident" id="5997531">Comment</span><span class="op" id="5997538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997541">}</span><br>
<span class="lineno">1335</span><span class="op" id="5997543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5997546">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5997622">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5997693">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="5997722">//</span><br>
<span class="lineno"></span><span class="keyword" id="5997725">func</span>&nbsp;<span class="op" id="5997730">(</span><span class="ident" id="5997731">p</span>&nbsp;<span class="op" id="5997733">*</span><span class="ident" id="5997734">printer</span><span class="op" id="5997741">)</span>&nbsp;<span class="ident" id="5997743">spec</span><span class="op" id="5997747">(</span><span class="ident" id="5997748">spec</span>&nbsp;<span class="ident" id="5997753">ast</span><span class="op" id="5997756">.</span><span class="ident" id="5997757">Spec</span><span class="op" id="5997761">,</span>&nbsp;<span class="ident" id="5997763">n</span>&nbsp;<span class="builtintype" id="5997765">int</span><span class="op" id="5997768">,</span>&nbsp;<span class="ident" id="5997770">doIndent</span>&nbsp;<span class="builtintype" id="5997779">bool</span><span class="op" id="5997783">)</span>&nbsp;<span class="op" id="5997785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997788">switch</span>&nbsp;<span class="ident" id="5997795">s</span>&nbsp;<span class="op" id="5997797">:=</span>&nbsp;<span class="ident" id="5997800">spec</span><span class="op" id="5997804">.</span><span class="op" id="5997805">(</span><span class="keyword" id="5997806">type</span><span class="op" id="5997810">)</span>&nbsp;<span class="op" id="5997812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997815">case</span>&nbsp;<span class="op" id="5997820">*</span><span class="ident" id="5997821">ast</span><span class="op" id="5997824">.</span><span class="ident" id="5997825">ImportSpec</span><span class="op" id="5997835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997839">p</span><span class="op" id="5997840">.</span><span class="ident" id="5997841">setComment</span><span class="op" id="5997851">(</span><span class="ident" id="5997852">s</span><span class="op" id="5997853">.</span><span class="ident" id="5997854">Doc</span><span class="op" id="5997857">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997861">if</span>&nbsp;<span class="ident" id="5997864">s</span><span class="op" id="5997865">.</span><span class="ident" id="5997866">Name</span>&nbsp;<span class="op" id="5997871">!=</span>&nbsp;<span class="ident" id="5997874">nil</span>&nbsp;<span class="op" id="5997878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997883">p</span><span class="op" id="5997884">.</span><span class="ident" id="5997885">expr</span><span class="op" id="5997889">(</span><span class="ident" id="5997890">s</span><span class="op" id="5997891">.</span><span class="ident" id="5997892">Name</span><span class="op" id="5997896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997901">p</span><span class="op" id="5997902">.</span><span class="builtinfunc" id="5997903">print</span><span class="op" id="5997908">(</span><span class="ident" id="5997909">blank</span><span class="op" id="5997914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997922">p</span><span class="op" id="5997923">.</span><span class="ident" id="5997924">expr</span><span class="op" id="5997928">(</span><span class="ident" id="5997929">s</span><span class="op" id="5997930">.</span><span class="ident" id="5997931">Path</span><span class="op" id="5997935">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997939">p</span><span class="op" id="5997940">.</span><span class="ident" id="5997941">setComment</span><span class="op" id="5997951">(</span><span class="ident" id="5997952">s</span><span class="op" id="5997953">.</span><span class="ident" id="5997954">Comment</span><span class="op" id="5997961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997965">p</span><span class="op" id="5997966">.</span><span class="builtinfunc" id="5997967">print</span><span class="op" id="5997972">(</span><span class="ident" id="5997973">s</span><span class="op" id="5997974">.</span><span class="ident" id="5997975">EndPos</span><span class="op" id="5997981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997985">case</span>&nbsp;<span class="op" id="5997990">*</span><span class="ident" id="5997991">ast</span><span class="op" id="5997994">.</span><span class="ident" id="5997995">ValueSpec</span><span class="op" id="5998004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998008">if</span>&nbsp;<span class="ident" id="5998011">n</span>&nbsp;<span class="op" id="5998013">!=</span>&nbsp;<span class="num" id="5998016">1</span>&nbsp;<span class="op" id="5998018">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998023">p</span><span class="op" id="5998024">.</span><span class="ident" id="5998025">internalError</span><span class="op" id="5998038">(</span><span class="string" id="5998039">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="5998060">,</span>&nbsp;<span class="ident" id="5998062">n</span><span class="op" id="5998063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998071">p</span><span class="op" id="5998072">.</span><span class="ident" id="5998073">setComment</span><span class="op" id="5998083">(</span><span class="ident" id="5998084">s</span><span class="op" id="5998085">.</span><span class="ident" id="5998086">Doc</span><span class="op" id="5998089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998093">p</span><span class="op" id="5998094">.</span><span class="ident" id="5998095">identList</span><span class="op" id="5998104">(</span><span class="ident" id="5998105">s</span><span class="op" id="5998106">.</span><span class="ident" id="5998107">Names</span><span class="op" id="5998112">,</span>&nbsp;<span class="ident" id="5998114">doIndent</span><span class="op" id="5998122">)</span>&nbsp;<span class="comment" id="5998124">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998144">if</span>&nbsp;<span class="ident" id="5998147">s</span><span class="op" id="5998148">.</span><span class="ident" id="5998149">Type</span>&nbsp;<span class="op" id="5998154">!=</span>&nbsp;<span class="ident" id="5998157">nil</span>&nbsp;<span class="op" id="5998161">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998166">p</span><span class="op" id="5998167">.</span><span class="builtinfunc" id="5998168">print</span><span class="op" id="5998173">(</span><span class="ident" id="5998174">blank</span><span class="op" id="5998179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998184">p</span><span class="op" id="5998185">.</span><span class="ident" id="5998186">expr</span><span class="op" id="5998190">(</span><span class="ident" id="5998191">s</span><span class="op" id="5998192">.</span><span class="ident" id="5998193">Type</span><span class="op" id="5998197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998205">if</span>&nbsp;<span class="ident" id="5998208">s</span><span class="op" id="5998209">.</span><span class="ident" id="5998210">Values</span>&nbsp;<span class="op" id="5998217">!=</span>&nbsp;<span class="ident" id="5998220">nil</span>&nbsp;<span class="op" id="5998224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998229">p</span><span class="op" id="5998230">.</span><span class="builtinfunc" id="5998231">print</span><span class="op" id="5998236">(</span><span class="ident" id="5998237">blank</span><span class="op" id="5998242">,</span>&nbsp;<span class="ident" id="5998244">token</span><span class="op" id="5998249">.</span><span class="ident" id="5998250">ASSIGN</span><span class="op" id="5998256">,</span>&nbsp;<span class="ident" id="5998258">blank</span><span class="op" id="5998263">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998268">p</span><span class="op" id="5998269">.</span><span class="ident" id="5998270">exprList</span><span class="op" id="5998278">(</span><span class="ident" id="5998279">token</span><span class="op" id="5998284">.</span><span class="ident" id="5998285">NoPos</span><span class="op" id="5998290">,</span>&nbsp;<span class="ident" id="5998292">s</span><span class="op" id="5998293">.</span><span class="ident" id="5998294">Values</span><span class="op" id="5998300">,</span>&nbsp;<span class="num" id="5998302">1</span><span class="op" id="5998303">,</span>&nbsp;<span class="num" id="5998305">0</span><span class="op" id="5998306">,</span>&nbsp;<span class="ident" id="5998308">token</span><span class="op" id="5998313">.</span><span class="ident" id="5998314">NoPos</span><span class="op" id="5998319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998327">p</span><span class="op" id="5998328">.</span><span class="ident" id="5998329">setComment</span><span class="op" id="5998339">(</span><span class="ident" id="5998340">s</span><span class="op" id="5998341">.</span><span class="ident" id="5998342">Comment</span><span class="op" id="5998349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998353">case</span>&nbsp;<span class="op" id="5998358">*</span><span class="ident" id="5998359">ast</span><span class="op" id="5998362">.</span><span class="ident" id="5998363">TypeSpec</span><span class="op" id="5998371">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998375">p</span><span class="op" id="5998376">.</span><span class="ident" id="5998377">setComment</span><span class="op" id="5998387">(</span><span class="ident" id="5998388">s</span><span class="op" id="5998389">.</span><span class="ident" id="5998390">Doc</span><span class="op" id="5998393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998397">p</span><span class="op" id="5998398">.</span><span class="ident" id="5998399">expr</span><span class="op" id="5998403">(</span><span class="ident" id="5998404">s</span><span class="op" id="5998405">.</span><span class="ident" id="5998406">Name</span><span class="op" id="5998410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998414">if</span>&nbsp;<span class="ident" id="5998417">n</span>&nbsp;<span class="op" id="5998419">==</span>&nbsp;<span class="num" id="5998422">1</span>&nbsp;<span class="op" id="5998424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998429">p</span><span class="op" id="5998430">.</span><span class="builtinfunc" id="5998431">print</span><span class="op" id="5998436">(</span><span class="ident" id="5998437">blank</span><span class="op" id="5998442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998446">}</span>&nbsp;<span class="keyword" id="5998448">else</span>&nbsp;<span class="op" id="5998453">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998458">p</span><span class="op" id="5998459">.</span><span class="builtinfunc" id="5998460">print</span><span class="op" id="5998465">(</span><span class="ident" id="5998466">vtab</span><span class="op" id="5998470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998478">p</span><span class="op" id="5998479">.</span><span class="ident" id="5998480">expr</span><span class="op" id="5998484">(</span><span class="ident" id="5998485">s</span><span class="op" id="5998486">.</span><span class="ident" id="5998487">Type</span><span class="op" id="5998491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998495">p</span><span class="op" id="5998496">.</span><span class="ident" id="5998497">setComment</span><span class="op" id="5998507">(</span><span class="ident" id="5998508">s</span><span class="op" id="5998509">.</span><span class="ident" id="5998510">Comment</span><span class="op" id="5998517">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998521">default</span><span class="op" id="5998528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5998532">panic</span><span class="op" id="5998537">(</span><span class="string" id="5998538">&#34;unreachable&#34;</span><span class="op" id="5998551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998554">}</span><br>
<span class="lineno"></span><span class="op" id="5998556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="5998559">func</span>&nbsp;<span class="op" id="5998564">(</span><span class="ident" id="5998565">p</span>&nbsp;<span class="op" id="5998567">*</span><span class="ident" id="5998568">printer</span><span class="op" id="5998575">)</span>&nbsp;<span class="ident" id="5998577">genDecl</span><span class="op" id="5998584">(</span><span class="ident" id="5998585">d</span>&nbsp;<span class="op" id="5998587">*</span><span class="ident" id="5998588">ast</span><span class="op" id="5998591">.</span><span class="ident" id="5998592">GenDecl</span><span class="op" id="5998599">)</span>&nbsp;<span class="op" id="5998601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998604">p</span><span class="op" id="5998605">.</span><span class="ident" id="5998606">setComment</span><span class="op" id="5998616">(</span><span class="ident" id="5998617">d</span><span class="op" id="5998618">.</span><span class="ident" id="5998619">Doc</span><span class="op" id="5998622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998625">p</span><span class="op" id="5998626">.</span><span class="builtinfunc" id="5998627">print</span><span class="op" id="5998632">(</span><span class="ident" id="5998633">d</span><span class="op" id="5998634">.</span><span class="ident" id="5998635">Pos</span><span class="op" id="5998638">(</span><span class="op" id="5998639">)</span><span class="op" id="5998640">,</span>&nbsp;<span class="ident" id="5998642">d</span><span class="op" id="5998643">.</span><span class="ident" id="5998644">Tok</span><span class="op" id="5998647">,</span>&nbsp;<span class="ident" id="5998649">blank</span><span class="op" id="5998654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998658">if</span>&nbsp;<span class="ident" id="5998661">d</span><span class="op" id="5998662">.</span><span class="ident" id="5998663">Lparen</span><span class="op" id="5998669">.</span><span class="ident" id="5998670">IsValid</span><span class="op" id="5998677">(</span><span class="op" id="5998678">)</span>&nbsp;<span class="op" id="5998680">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5998684">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998725">p</span><span class="op" id="5998726">.</span><span class="builtinfunc" id="5998727">print</span><span class="op" id="5998732">(</span><span class="ident" id="5998733">d</span><span class="op" id="5998734">.</span><span class="ident" id="5998735">Lparen</span><span class="op" id="5998741">,</span>&nbsp;<span class="ident" id="5998743">token</span><span class="op" id="5998748">.</span><span class="ident" id="5998749">LPAREN</span><span class="op" id="5998755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998759">if</span>&nbsp;<span class="ident" id="5998762">n</span>&nbsp;<span class="op" id="5998764">:=</span>&nbsp;<span class="builtinfunc" id="5998767">len</span><span class="op" id="5998770">(</span><span class="ident" id="5998771">d</span><span class="op" id="5998772">.</span><span class="ident" id="5998773">Specs</span><span class="op" id="5998778">)</span><span class="op" id="5998779">;</span>&nbsp;<span class="ident" id="5998781">n</span>&nbsp;<span class="op" id="5998783">&gt;</span>&nbsp;<span class="num" id="5998785">0</span>&nbsp;<span class="op" id="5998787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998792">p</span><span class="op" id="5998793">.</span><span class="builtinfunc" id="5998794">print</span><span class="op" id="5998799">(</span><span class="ident" id="5998800">indent</span><span class="op" id="5998806">,</span>&nbsp;<span class="ident" id="5998808">formfeed</span><span class="op" id="5998816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998821">if</span>&nbsp;<span class="ident" id="5998824">n</span>&nbsp;<span class="op" id="5998826">&gt;</span>&nbsp;<span class="num" id="5998828">1</span>&nbsp;<span class="op" id="5998830">&amp;&amp;</span>&nbsp;<span class="op" id="5998833">(</span><span class="ident" id="5998834">d</span><span class="op" id="5998835">.</span><span class="ident" id="5998836">Tok</span>&nbsp;<span class="op" id="5998840">==</span>&nbsp;<span class="ident" id="5998843">token</span><span class="op" id="5998848">.</span><span class="ident" id="5998849">CONST</span>&nbsp;<span class="op" id="5998855">||</span>&nbsp;<span class="ident" id="5998858">d</span><span class="op" id="5998859">.</span><span class="ident" id="5998860">Tok</span>&nbsp;<span class="op" id="5998864">==</span>&nbsp;<span class="ident" id="5998867">token</span><span class="op" id="5998872">.</span><span class="ident" id="5998873">VAR</span><span class="op" id="5998876">)</span>&nbsp;<span class="op" id="5998878">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5998884">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5998935">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998984">keepType</span>&nbsp;<span class="op" id="5998993">:=</span>&nbsp;<span class="ident" id="5998996">keepTypeColumn</span><span class="op" id="5999010">(</span><span class="ident" id="5999011">d</span><span class="op" id="5999012">.</span><span class="ident" id="5999013">Specs</span><span class="op" id="5999018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999024">var</span>&nbsp;<span class="ident" id="5999028">line</span>&nbsp;<span class="builtintype" id="5999033">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999041">for</span>&nbsp;<span class="ident" id="5999045">i</span><span class="op" id="5999046">,</span>&nbsp;<span class="ident" id="5999048">s</span>&nbsp;<span class="op" id="5999050">:=</span>&nbsp;<span class="keyword" id="5999053">range</span>&nbsp;<span class="ident" id="5999059">d</span><span class="op" id="5999060">.</span><span class="ident" id="5999061">Specs</span>&nbsp;<span class="op" id="5999067">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999074">if</span>&nbsp;<span class="ident" id="5999077">i</span>&nbsp;<span class="op" id="5999079">&gt;</span>&nbsp;<span class="num" id="5999081">0</span>&nbsp;<span class="op" id="5999083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999091">p</span><span class="op" id="5999092">.</span><span class="ident" id="5999093">linebreak</span><span class="op" id="5999102">(</span><span class="ident" id="5999103">p</span><span class="op" id="5999104">.</span><span class="ident" id="5999105">lineFor</span><span class="op" id="5999112">(</span><span class="ident" id="5999113">s</span><span class="op" id="5999114">.</span><span class="ident" id="5999115">Pos</span><span class="op" id="5999118">(</span><span class="op" id="5999119">)</span><span class="op" id="5999120">)</span><span class="op" id="5999121">,</span>&nbsp;<span class="num" id="5999123">1</span><span class="op" id="5999124">,</span>&nbsp;<span class="ident" id="5999126">ignore</span><span class="op" id="5999132">,</span>&nbsp;<span class="ident" id="5999134">p</span><span class="op" id="5999135">.</span><span class="ident" id="5999136">linesFrom</span><span class="op" id="5999145">(</span><span class="ident" id="5999146">line</span><span class="op" id="5999150">)</span>&nbsp;<span class="op" id="5999152">&gt;</span>&nbsp;<span class="num" id="5999154">0</span><span class="op" id="5999155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999169">p</span><span class="op" id="5999170">.</span><span class="ident" id="5999171">recordLine</span><span class="op" id="5999181">(</span><span class="op" id="5999182">&amp;</span><span class="ident" id="5999183">line</span><span class="op" id="5999187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999194">p</span><span class="op" id="5999195">.</span><span class="ident" id="5999196">valueSpec</span><span class="op" id="5999205">(</span><span class="ident" id="5999206">s</span><span class="op" id="5999207">.</span><span class="op" id="5999208">(</span><span class="op" id="5999209">*</span><span class="ident" id="5999210">ast</span><span class="op" id="5999213">.</span><span class="ident" id="5999214">ValueSpec</span><span class="op" id="5999223">)</span><span class="op" id="5999224">,</span>&nbsp;<span class="ident" id="5999226">keepType</span><span class="op" id="5999234">[</span><span class="ident" id="5999235">i</span><span class="op" id="5999236">]</span><span class="op" id="5999237">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999248">}</span>&nbsp;<span class="keyword" id="5999250">else</span>&nbsp;<span class="op" id="5999255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999261">var</span>&nbsp;<span class="ident" id="5999265">line</span>&nbsp;<span class="builtintype" id="5999270">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999278">for</span>&nbsp;<span class="ident" id="5999282">i</span><span class="op" id="5999283">,</span>&nbsp;<span class="ident" id="5999285">s</span>&nbsp;<span class="op" id="5999287">:=</span>&nbsp;<span class="keyword" id="5999290">range</span>&nbsp;<span class="ident" id="5999296">d</span><span class="op" id="5999297">.</span><span class="ident" id="5999298">Specs</span>&nbsp;<span class="op" id="5999304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999311">if</span>&nbsp;<span class="ident" id="5999314">i</span>&nbsp;<span class="op" id="5999316">&gt;</span>&nbsp;<span class="num" id="5999318">0</span>&nbsp;<span class="op" id="5999320">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999328">p</span><span class="op" id="5999329">.</span><span class="ident" id="5999330">linebreak</span><span class="op" id="5999339">(</span><span class="ident" id="5999340">p</span><span class="op" id="5999341">.</span><span class="ident" id="5999342">lineFor</span><span class="op" id="5999349">(</span><span class="ident" id="5999350">s</span><span class="op" id="5999351">.</span><span class="ident" id="5999352">Pos</span><span class="op" id="5999355">(</span><span class="op" id="5999356">)</span><span class="op" id="5999357">)</span><span class="op" id="5999358">,</span>&nbsp;<span class="num" id="5999360">1</span><span class="op" id="5999361">,</span>&nbsp;<span class="ident" id="5999363">ignore</span><span class="op" id="5999369">,</span>&nbsp;<span class="ident" id="5999371">p</span><span class="op" id="5999372">.</span><span class="ident" id="5999373">linesFrom</span><span class="op" id="5999382">(</span><span class="ident" id="5999383">line</span><span class="op" id="5999387">)</span>&nbsp;<span class="op" id="5999389">&gt;</span>&nbsp;<span class="num" id="5999391">0</span><span class="op" id="5999392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999406">p</span><span class="op" id="5999407">.</span><span class="ident" id="5999408">recordLine</span><span class="op" id="5999418">(</span><span class="op" id="5999419">&amp;</span><span class="ident" id="5999420">line</span><span class="op" id="5999424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999431">p</span><span class="op" id="5999432">.</span><span class="ident" id="5999433">spec</span><span class="op" id="5999437">(</span><span class="ident" id="5999438">s</span><span class="op" id="5999439">,</span>&nbsp;<span class="ident" id="5999441">n</span><span class="op" id="5999442">,</span>&nbsp;<span class="builtintype" id="5999444">false</span><span class="op" id="5999449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999455">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999465">p</span><span class="op" id="5999466">.</span><span class="builtinfunc" id="5999467">print</span><span class="op" id="5999472">(</span><span class="ident" id="5999473">unindent</span><span class="op" id="5999481">,</span>&nbsp;<span class="ident" id="5999483">formfeed</span><span class="op" id="5999491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999499">p</span><span class="op" id="5999500">.</span><span class="builtinfunc" id="5999501">print</span><span class="op" id="5999506">(</span><span class="ident" id="5999507">d</span><span class="op" id="5999508">.</span><span class="ident" id="5999509">Rparen</span><span class="op" id="5999515">,</span>&nbsp;<span class="ident" id="5999517">token</span><span class="op" id="5999522">.</span><span class="ident" id="5999523">RPAREN</span><span class="op" id="5999529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999533">}</span>&nbsp;<span class="keyword" id="5999535">else</span>&nbsp;<span class="op" id="5999540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5999544">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999568">p</span><span class="op" id="5999569">.</span><span class="ident" id="5999570">spec</span><span class="op" id="5999574">(</span><span class="ident" id="5999575">d</span><span class="op" id="5999576">.</span><span class="ident" id="5999577">Specs</span><span class="op" id="5999582">[</span><span class="num" id="5999583">0</span><span class="op" id="5999584">]</span><span class="op" id="5999585">,</span>&nbsp;<span class="num" id="5999587">1</span><span class="op" id="5999588">,</span>&nbsp;<span class="builtintype" id="5999590">true</span><span class="op" id="5999594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999597">}</span><br>
<span class="lineno"></span><span class="op" id="5999599">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="5999602">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="5999666">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5999731">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5999794">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="5999852">//</span><br>
<span class="lineno"></span><span class="keyword" id="5999855">func</span>&nbsp;<span class="op" id="5999860">(</span><span class="ident" id="5999861">p</span>&nbsp;<span class="op" id="5999863">*</span><span class="ident" id="5999864">printer</span><span class="op" id="5999871">)</span>&nbsp;<span class="ident" id="5999873">nodeSize</span><span class="op" id="5999881">(</span><span class="ident" id="5999882">n</span>&nbsp;<span class="ident" id="5999884">ast</span><span class="op" id="5999887">.</span><span class="ident" id="5999888">Node</span><span class="op" id="5999892">,</span>&nbsp;<span class="ident" id="5999894">maxSize</span>&nbsp;<span class="builtintype" id="5999902">int</span><span class="op" id="5999905">)</span>&nbsp;<span class="op" id="5999907">(</span><span class="ident" id="5999908">size</span>&nbsp;<span class="builtintype" id="5999913">int</span><span class="op" id="5999916">)</span>&nbsp;<span class="op" id="5999918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5999921">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5999981">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000041">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000097">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000150">if</span>&nbsp;<span class="ident" id="6000153">size</span><span class="op" id="6000157">,</span>&nbsp;<span class="ident" id="6000159">found</span>&nbsp;<span class="op" id="6000165">:=</span>&nbsp;<span class="ident" id="6000168">p</span><span class="op" id="6000169">.</span><span class="ident" id="6000170">nodeSizes</span><span class="op" id="6000179">[</span><span class="ident" id="6000180">n</span><span class="op" id="6000181">]</span><span class="op" id="6000182">;</span>&nbsp;<span class="ident" id="6000184">found</span>&nbsp;<span class="op" id="6000190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000194">return</span>&nbsp;<span class="ident" id="6000201">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000211">size</span>&nbsp;<span class="op" id="6000216">=</span>&nbsp;<span class="ident" id="6000218">maxSize</span>&nbsp;<span class="op" id="6000226">+</span>&nbsp;<span class="num" id="6000228">1</span>&nbsp;<span class="comment" id="6000230">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000255">p</span><span class="op" id="6000256">.</span><span class="ident" id="6000257">nodeSizes</span><span class="op" id="6000266">[</span><span class="ident" id="6000267">n</span><span class="op" id="6000268">]</span>&nbsp;<span class="op" id="6000270">=</span>&nbsp;<span class="ident" id="6000272">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000279">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000338">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000395">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000412">cfg</span>&nbsp;<span class="op" id="6000416">:=</span>&nbsp;<span class="ident" id="6000419">Config</span><span class="op" id="6000425">{</span><span class="ident" id="6000426">Mode</span><span class="op" id="6000430">:</span>&nbsp;<span class="ident" id="6000432">RawFormat</span><span class="op" id="6000441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000444">var</span>&nbsp;<span class="ident" id="6000448">buf</span>&nbsp;<span class="ident" id="6000452">bytes</span><span class="op" id="6000457">.</span><span class="ident" id="6000458">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000466">if</span>&nbsp;<span class="ident" id="6000469">err</span>&nbsp;<span class="op" id="6000473">:=</span>&nbsp;<span class="ident" id="6000476">cfg</span><span class="op" id="6000479">.</span><span class="ident" id="6000480">fprint</span><span class="op" id="6000486">(</span><span class="op" id="6000487">&amp;</span><span class="ident" id="6000488">buf</span><span class="op" id="6000491">,</span>&nbsp;<span class="ident" id="6000493">p</span><span class="op" id="6000494">.</span><span class="ident" id="6000495">fset</span><span class="op" id="6000499">,</span>&nbsp;<span class="ident" id="6000501">n</span><span class="op" id="6000502">,</span>&nbsp;<span class="ident" id="6000504">p</span><span class="op" id="6000505">.</span><span class="ident" id="6000506">nodeSizes</span><span class="op" id="6000515">)</span><span class="op" id="6000516">;</span>&nbsp;<span class="ident" id="6000518">err</span>&nbsp;<span class="op" id="6000522">!=</span>&nbsp;<span class="ident" id="6000525">nil</span>&nbsp;<span class="op" id="6000529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000533">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000544">if</span>&nbsp;<span class="ident" id="6000547">buf</span><span class="op" id="6000550">.</span><span class="ident" id="6000551">Len</span><span class="op" id="6000554">(</span><span class="op" id="6000555">)</span>&nbsp;<span class="op" id="6000557">&lt;=</span>&nbsp;<span class="ident" id="6000560">maxSize</span>&nbsp;<span class="op" id="6000568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000572">for</span>&nbsp;<span class="ident" id="6000576">_</span><span class="op" id="6000577">,</span>&nbsp;<span class="ident" id="6000579">ch</span>&nbsp;<span class="op" id="6000582">:=</span>&nbsp;<span class="keyword" id="6000585">range</span>&nbsp;<span class="ident" id="6000591">buf</span><span class="op" id="6000594">.</span><span class="ident" id="6000595">Bytes</span><span class="op" id="6000600">(</span><span class="op" id="6000601">)</span>&nbsp;<span class="op" id="6000603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000608">if</span>&nbsp;<span class="ident" id="6000611">ch</span>&nbsp;<span class="op" id="6000614">&lt;</span>&nbsp;<span class="string" id="6000616">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6000620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000626">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000644">size</span>&nbsp;<span class="op" id="6000649">=</span>&nbsp;<span class="ident" id="6000651">buf</span><span class="op" id="6000654">.</span><span class="ident" id="6000655">Len</span><span class="op" id="6000658">(</span><span class="op" id="6000659">)</span>&nbsp;<span class="comment" id="6000661">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000673">p</span><span class="op" id="6000674">.</span><span class="ident" id="6000675">nodeSizes</span><span class="op" id="6000684">[</span><span class="ident" id="6000685">n</span><span class="op" id="6000686">]</span>&nbsp;<span class="op" id="6000688">=</span>&nbsp;<span class="ident" id="6000690">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000696">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000699">return</span><br>
<span class="lineno"></span><span class="op" id="6000706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6000709">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6000782">func</span>&nbsp;<span class="op" id="6000787">(</span><span class="ident" id="6000788">p</span>&nbsp;<span class="op" id="6000790">*</span><span class="ident" id="6000791">printer</span><span class="op" id="6000798">)</span>&nbsp;<span class="ident" id="6000800">bodySize</span><span class="op" id="6000808">(</span><span class="ident" id="6000809">b</span>&nbsp;<span class="op" id="6000811">*</span><span class="ident" id="6000812">ast</span><span class="op" id="6000815">.</span><span class="ident" id="6000816">BlockStmt</span><span class="op" id="6000825">,</span>&nbsp;<span class="ident" id="6000827">maxSize</span>&nbsp;<span class="builtintype" id="6000835">int</span><span class="op" id="6000838">)</span>&nbsp;<span class="builtintype" id="6000840">int</span>&nbsp;<span class="op" id="6000844">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000847">pos1</span>&nbsp;<span class="op" id="6000852">:=</span>&nbsp;<span class="ident" id="6000855">b</span><span class="op" id="6000856">.</span><span class="ident" id="6000857">Pos</span><span class="op" id="6000860">(</span><span class="op" id="6000861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000864">pos2</span>&nbsp;<span class="op" id="6000869">:=</span>&nbsp;<span class="ident" id="6000872">b</span><span class="op" id="6000873">.</span><span class="ident" id="6000874">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000882">if</span>&nbsp;<span class="ident" id="6000885">pos1</span><span class="op" id="6000889">.</span><span class="ident" id="6000890">IsValid</span><span class="op" id="6000897">(</span><span class="op" id="6000898">)</span>&nbsp;<span class="op" id="6000900">&amp;&amp;</span>&nbsp;<span class="ident" id="6000903">pos2</span><span class="op" id="6000907">.</span><span class="ident" id="6000908">IsValid</span><span class="op" id="6000915">(</span><span class="op" id="6000916">)</span>&nbsp;<span class="op" id="6000918">&amp;&amp;</span>&nbsp;<span class="ident" id="6000921">p</span><span class="op" id="6000922">.</span><span class="ident" id="6000923">lineFor</span><span class="op" id="6000930">(</span><span class="ident" id="6000931">pos1</span><span class="op" id="6000935">)</span>&nbsp;<span class="op" id="6000937">!=</span>&nbsp;<span class="ident" id="6000940">p</span><span class="op" id="6000941">.</span><span class="ident" id="6000942">lineFor</span><span class="op" id="6000949">(</span><span class="ident" id="6000950">pos2</span><span class="op" id="6000954">)</span>&nbsp;<span class="op" id="6000956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000960">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001042">return</span>&nbsp;<span class="ident" id="6001049">maxSize</span>&nbsp;<span class="op" id="6001057">+</span>&nbsp;<span class="num" id="6001059">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001065">if</span>&nbsp;<span class="builtinfunc" id="6001068">len</span><span class="op" id="6001071">(</span><span class="ident" id="6001072">b</span><span class="op" id="6001073">.</span><span class="ident" id="6001074">List</span><span class="op" id="6001078">)</span>&nbsp;<span class="op" id="6001080">&gt;</span>&nbsp;<span class="num" id="6001082">5</span>&nbsp;<span class="op" id="6001084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001088">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001141">return</span>&nbsp;<span class="ident" id="6001148">maxSize</span>&nbsp;<span class="op" id="6001156">+</span>&nbsp;<span class="num" id="6001158">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001161">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001164">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001198">bodySize</span>&nbsp;<span class="op" id="6001207">:=</span>&nbsp;<span class="ident" id="6001210">p</span><span class="op" id="6001211">.</span><span class="ident" id="6001212">commentSizeBefore</span><span class="op" id="6001229">(</span><span class="ident" id="6001230">p</span><span class="op" id="6001231">.</span><span class="ident" id="6001232">posFor</span><span class="op" id="6001238">(</span><span class="ident" id="6001239">pos2</span><span class="op" id="6001243">)</span><span class="op" id="6001244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001247">for</span>&nbsp;<span class="ident" id="6001251">i</span><span class="op" id="6001252">,</span>&nbsp;<span class="ident" id="6001254">s</span>&nbsp;<span class="op" id="6001256">:=</span>&nbsp;<span class="keyword" id="6001259">range</span>&nbsp;<span class="ident" id="6001265">b</span><span class="op" id="6001266">.</span><span class="ident" id="6001267">List</span>&nbsp;<span class="op" id="6001272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001276">if</span>&nbsp;<span class="ident" id="6001279">bodySize</span>&nbsp;<span class="op" id="6001288">&gt;</span>&nbsp;<span class="ident" id="6001290">maxSize</span>&nbsp;<span class="op" id="6001298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001303">break</span>&nbsp;<span class="comment" id="6001309">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001338">if</span>&nbsp;<span class="ident" id="6001341">i</span>&nbsp;<span class="op" id="6001343">&gt;</span>&nbsp;<span class="num" id="6001345">0</span>&nbsp;<span class="op" id="6001347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001352">bodySize</span>&nbsp;<span class="op" id="6001361">+=</span>&nbsp;<span class="num" id="6001364">2</span>&nbsp;<span class="comment" id="6001366">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001407">bodySize</span>&nbsp;<span class="op" id="6001416">+=</span>&nbsp;<span class="ident" id="6001419">p</span><span class="op" id="6001420">.</span><span class="ident" id="6001421">nodeSize</span><span class="op" id="6001429">(</span><span class="ident" id="6001430">s</span><span class="op" id="6001431">,</span>&nbsp;<span class="ident" id="6001433">maxSize</span><span class="op" id="6001440">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001446">return</span>&nbsp;<span class="ident" id="6001453">bodySize</span><br>
<span class="lineno"></span><span class="op" id="6001462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6001465">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="6001550">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="6001639">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="6001728">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="6001817">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6001906">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="6001963">//</span><br>
<span class="lineno"></span><span class="keyword" id="6001966">func</span>&nbsp;<span class="op" id="6001971">(</span><span class="ident" id="6001972">p</span>&nbsp;<span class="op" id="6001974">*</span><span class="ident" id="6001975">printer</span><span class="op" id="6001982">)</span>&nbsp;<span class="ident" id="6001984">adjBlock</span><span class="op" id="6001992">(</span><span class="ident" id="6001993">headerSize</span>&nbsp;<span class="builtintype" id="6002004">int</span><span class="op" id="6002007">,</span>&nbsp;<span class="ident" id="6002009">sep</span>&nbsp;<span class="ident" id="6002013">whiteSpace</span><span class="op" id="6002023">,</span>&nbsp;<span class="ident" id="6002025">b</span>&nbsp;<span class="op" id="6002027">*</span><span class="ident" id="6002028">ast</span><span class="op" id="6002031">.</span><span class="ident" id="6002032">BlockStmt</span><span class="op" id="6002041">)</span>&nbsp;<span class="op" id="6002043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002046">if</span>&nbsp;<span class="ident" id="6002049">b</span>&nbsp;<span class="op" id="6002051">==</span>&nbsp;<span class="ident" id="6002054">nil</span>&nbsp;<span class="op" id="6002058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002062">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002070">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002074">const</span>&nbsp;<span class="ident" id="6002080">maxSize</span>&nbsp;<span class="op" id="6002088">=</span>&nbsp;<span class="num" id="6002090">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002095">if</span>&nbsp;<span class="ident" id="6002098">headerSize</span><span class="op" id="6002108">+</span><span class="ident" id="6002109">p</span><span class="op" id="6002110">.</span><span class="ident" id="6002111">bodySize</span><span class="op" id="6002119">(</span><span class="ident" id="6002120">b</span><span class="op" id="6002121">,</span>&nbsp;<span class="ident" id="6002123">maxSize</span><span class="op" id="6002130">)</span>&nbsp;<span class="op" id="6002132">&lt;=</span>&nbsp;<span class="ident" id="6002135">maxSize</span>&nbsp;<span class="op" id="6002143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002147">p</span><span class="op" id="6002148">.</span><span class="builtinfunc" id="6002149">print</span><span class="op" id="6002154">(</span><span class="ident" id="6002155">sep</span><span class="op" id="6002158">,</span>&nbsp;<span class="ident" id="6002160">b</span><span class="op" id="6002161">.</span><span class="ident" id="6002162">Lbrace</span><span class="op" id="6002168">,</span>&nbsp;<span class="ident" id="6002170">token</span><span class="op" id="6002175">.</span><span class="ident" id="6002176">LBRACE</span><span class="op" id="6002182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002186">if</span>&nbsp;<span class="builtinfunc" id="6002189">len</span><span class="op" id="6002192">(</span><span class="ident" id="6002193">b</span><span class="op" id="6002194">.</span><span class="ident" id="6002195">List</span><span class="op" id="6002199">)</span>&nbsp;<span class="op" id="6002201">&gt;</span>&nbsp;<span class="num" id="6002203">0</span>&nbsp;<span class="op" id="6002205">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002210">p</span><span class="op" id="6002211">.</span><span class="builtinfunc" id="6002212">print</span><span class="op" id="6002217">(</span><span class="ident" id="6002218">blank</span><span class="op" id="6002223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002228">for</span>&nbsp;<span class="ident" id="6002232">i</span><span class="op" id="6002233">,</span>&nbsp;<span class="ident" id="6002235">s</span>&nbsp;<span class="op" id="6002237">:=</span>&nbsp;<span class="keyword" id="6002240">range</span>&nbsp;<span class="ident" id="6002246">b</span><span class="op" id="6002247">.</span><span class="ident" id="6002248">List</span>&nbsp;<span class="op" id="6002253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002259">if</span>&nbsp;<span class="ident" id="6002262">i</span>&nbsp;<span class="op" id="6002264">&gt;</span>&nbsp;<span class="num" id="6002266">0</span>&nbsp;<span class="op" id="6002268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002275">p</span><span class="op" id="6002276">.</span><span class="builtinfunc" id="6002277">print</span><span class="op" id="6002282">(</span><span class="ident" id="6002283">token</span><span class="op" id="6002288">.</span><span class="ident" id="6002289">SEMICOLON</span><span class="op" id="6002298">,</span>&nbsp;<span class="ident" id="6002300">blank</span><span class="op" id="6002305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002311">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002317">p</span><span class="op" id="6002318">.</span><span class="ident" id="6002319">stmt</span><span class="op" id="6002323">(</span><span class="ident" id="6002324">s</span><span class="op" id="6002325">,</span>&nbsp;<span class="ident" id="6002327">i</span>&nbsp;<span class="op" id="6002329">==</span>&nbsp;<span class="builtinfunc" id="6002332">len</span><span class="op" id="6002335">(</span><span class="ident" id="6002336">b</span><span class="op" id="6002337">.</span><span class="ident" id="6002338">List</span><span class="op" id="6002342">)</span><span class="op" id="6002343">-</span><span class="num" id="6002344">1</span><span class="op" id="6002345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002355">p</span><span class="op" id="6002356">.</span><span class="builtinfunc" id="6002357">print</span><span class="op" id="6002362">(</span><span class="ident" id="6002363">blank</span><span class="op" id="6002368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002376">p</span><span class="op" id="6002377">.</span><span class="builtinfunc" id="6002378">print</span><span class="op" id="6002383">(</span><span class="ident" id="6002384">noExtraLinebreak</span><span class="op" id="6002400">,</span>&nbsp;<span class="ident" id="6002402">b</span><span class="op" id="6002403">.</span><span class="ident" id="6002404">Rbrace</span><span class="op" id="6002410">,</span>&nbsp;<span class="ident" id="6002412">token</span><span class="op" id="6002417">.</span><span class="ident" id="6002418">RBRACE</span><span class="op" id="6002424">,</span>&nbsp;<span class="ident" id="6002426">noExtraLinebreak</span><span class="op" id="6002442">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002446">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002458">if</span>&nbsp;<span class="ident" id="6002461">sep</span>&nbsp;<span class="op" id="6002465">!=</span>&nbsp;<span class="ident" id="6002468">ignore</span>&nbsp;<span class="op" id="6002475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002479">p</span><span class="op" id="6002480">.</span><span class="builtinfunc" id="6002481">print</span><span class="op" id="6002486">(</span><span class="ident" id="6002487">blank</span><span class="op" id="6002492">)</span>&nbsp;<span class="comment" id="6002494">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002518">p</span><span class="op" id="6002519">.</span><span class="ident" id="6002520">block</span><span class="op" id="6002525">(</span><span class="ident" id="6002526">b</span><span class="op" id="6002527">,</span>&nbsp;<span class="num" id="6002529">1</span><span class="op" id="6002530">)</span><br>
<span class="lineno"></span><span class="op" id="6002532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6002535">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="6002617">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="6002701">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="6002741">func</span>&nbsp;<span class="op" id="6002746">(</span><span class="ident" id="6002747">p</span>&nbsp;<span class="op" id="6002749">*</span><span class="ident" id="6002750">printer</span><span class="op" id="6002757">)</span>&nbsp;<span class="ident" id="6002759">distanceFrom</span><span class="op" id="6002771">(</span><span class="ident" id="6002772">from</span>&nbsp;<span class="ident" id="6002777">token</span><span class="op" id="6002782">.</span><span class="ident" id="6002783">Pos</span><span class="op" id="6002786">)</span>&nbsp;<span class="builtintype" id="6002788">int</span>&nbsp;<span class="op" id="6002792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002795">if</span>&nbsp;<span class="ident" id="6002798">from</span><span class="op" id="6002802">.</span><span class="ident" id="6002803">IsValid</span><span class="op" id="6002810">(</span><span class="op" id="6002811">)</span>&nbsp;<span class="op" id="6002813">&amp;&amp;</span>&nbsp;<span class="ident" id="6002816">p</span><span class="op" id="6002817">.</span><span class="ident" id="6002818">pos</span><span class="op" id="6002821">.</span><span class="ident" id="6002822">IsValid</span><span class="op" id="6002829">(</span><span class="op" id="6002830">)</span>&nbsp;<span class="op" id="6002832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002836">if</span>&nbsp;<span class="ident" id="6002839">f</span>&nbsp;<span class="op" id="6002841">:=</span>&nbsp;<span class="ident" id="6002844">p</span><span class="op" id="6002845">.</span><span class="ident" id="6002846">posFor</span><span class="op" id="6002852">(</span><span class="ident" id="6002853">from</span><span class="op" id="6002857">)</span><span class="op" id="6002858">;</span>&nbsp;<span class="ident" id="6002860">f</span><span class="op" id="6002861">.</span><span class="ident" id="6002862">Line</span>&nbsp;<span class="op" id="6002867">==</span>&nbsp;<span class="ident" id="6002870">p</span><span class="op" id="6002871">.</span><span class="ident" id="6002872">pos</span><span class="op" id="6002875">.</span><span class="ident" id="6002876">Line</span>&nbsp;<span class="op" id="6002881">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002886">return</span>&nbsp;<span class="ident" id="6002893">p</span><span class="op" id="6002894">.</span><span class="ident" id="6002895">pos</span><span class="op" id="6002898">.</span><span class="ident" id="6002899">Column</span>&nbsp;<span class="op" id="6002906">-</span>&nbsp;<span class="ident" id="6002908">f</span><span class="op" id="6002909">.</span><span class="ident" id="6002910">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002925">return</span>&nbsp;<span class="ident" id="6002932">infinity</span><br>
<span class="lineno"></span><span class="op" id="6002941">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="6002944">func</span>&nbsp;<span class="op" id="6002949">(</span><span class="ident" id="6002950">p</span>&nbsp;<span class="op" id="6002952">*</span><span class="ident" id="6002953">printer</span><span class="op" id="6002960">)</span>&nbsp;<span class="ident" id="6002962">funcDecl</span><span class="op" id="6002970">(</span><span class="ident" id="6002971">d</span>&nbsp;<span class="op" id="6002973">*</span><span class="ident" id="6002974">ast</span><span class="op" id="6002977">.</span><span class="ident" id="6002978">FuncDecl</span><span class="op" id="6002986">)</span>&nbsp;<span class="op" id="6002988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002991">p</span><span class="op" id="6002992">.</span><span class="ident" id="6002993">setComment</span><span class="op" id="6003003">(</span><span class="ident" id="6003004">d</span><span class="op" id="6003005">.</span><span class="ident" id="6003006">Doc</span><span class="op" id="6003009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003012">p</span><span class="op" id="6003013">.</span><span class="builtinfunc" id="6003014">print</span><span class="op" id="6003019">(</span><span class="ident" id="6003020">d</span><span class="op" id="6003021">.</span><span class="ident" id="6003022">Pos</span><span class="op" id="6003025">(</span><span class="op" id="6003026">)</span><span class="op" id="6003027">,</span>&nbsp;<span class="ident" id="6003029">token</span><span class="op" id="6003034">.</span><span class="ident" id="6003035">FUNC</span><span class="op" id="6003039">,</span>&nbsp;<span class="ident" id="6003041">blank</span><span class="op" id="6003046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003049">if</span>&nbsp;<span class="ident" id="6003052">d</span><span class="op" id="6003053">.</span><span class="ident" id="6003054">Recv</span>&nbsp;<span class="op" id="6003059">!=</span>&nbsp;<span class="ident" id="6003062">nil</span>&nbsp;<span class="op" id="6003066">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003070">p</span><span class="op" id="6003071">.</span><span class="ident" id="6003072">parameters</span><span class="op" id="6003082">(</span><span class="ident" id="6003083">d</span><span class="op" id="6003084">.</span><span class="ident" id="6003085">Recv</span><span class="op" id="6003089">)</span>&nbsp;<span class="comment" id="6003091">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003119">p</span><span class="op" id="6003120">.</span><span class="builtinfunc" id="6003121">print</span><span class="op" id="6003126">(</span><span class="ident" id="6003127">blank</span><span class="op" id="6003132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003138">p</span><span class="op" id="6003139">.</span><span class="ident" id="6003140">expr</span><span class="op" id="6003144">(</span><span class="ident" id="6003145">d</span><span class="op" id="6003146">.</span><span class="ident" id="6003147">Name</span><span class="op" id="6003151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003154">p</span><span class="op" id="6003155">.</span><span class="ident" id="6003156">signature</span><span class="op" id="6003165">(</span><span class="ident" id="6003166">d</span><span class="op" id="6003167">.</span><span class="ident" id="6003168">Type</span><span class="op" id="6003172">.</span><span class="ident" id="6003173">Params</span><span class="op" id="6003179">,</span>&nbsp;<span class="ident" id="6003181">d</span><span class="op" id="6003182">.</span><span class="ident" id="6003183">Type</span><span class="op" id="6003187">.</span><span class="ident" id="6003188">Results</span><span class="op" id="6003195">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003198">p</span><span class="op" id="6003199">.</span><span class="ident" id="6003200">adjBlock</span><span class="op" id="6003208">(</span><span class="ident" id="6003209">p</span><span class="op" id="6003210">.</span><span class="ident" id="6003211">distanceFrom</span><span class="op" id="6003223">(</span><span class="ident" id="6003224">d</span><span class="op" id="6003225">.</span><span class="ident" id="6003226">Pos</span><span class="op" id="6003229">(</span><span class="op" id="6003230">)</span><span class="op" id="6003231">)</span><span class="op" id="6003232">,</span>&nbsp;<span class="ident" id="6003234">vtab</span><span class="op" id="6003238">,</span>&nbsp;<span class="ident" id="6003240">d</span><span class="op" id="6003241">.</span><span class="ident" id="6003242">Body</span><span class="op" id="6003246">)</span><br>
<span class="lineno"></span><span class="op" id="6003248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6003251">func</span>&nbsp;<span class="op" id="6003256">(</span><span class="ident" id="6003257">p</span>&nbsp;<span class="op" id="6003259">*</span><span class="ident" id="6003260">printer</span><span class="op" id="6003267">)</span>&nbsp;<span class="ident" id="6003269">decl</span><span class="op" id="6003273">(</span><span class="ident" id="6003274">decl</span>&nbsp;<span class="ident" id="6003279">ast</span><span class="op" id="6003282">.</span><span class="ident" id="6003283">Decl</span><span class="op" id="6003287">)</span>&nbsp;<span class="op" id="6003289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003292">switch</span>&nbsp;<span class="ident" id="6003299">d</span>&nbsp;<span class="op" id="6003301">:=</span>&nbsp;<span class="ident" id="6003304">decl</span><span class="op" id="6003308">.</span><span class="op" id="6003309">(</span><span class="keyword" id="6003310">type</span><span class="op" id="6003314">)</span>&nbsp;<span class="op" id="6003316">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003319">case</span>&nbsp;<span class="op" id="6003324">*</span><span class="ident" id="6003325">ast</span><span class="op" id="6003328">.</span><span class="ident" id="6003329">BadDecl</span><span class="op" id="6003336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003340">p</span><span class="op" id="6003341">.</span><span class="builtinfunc" id="6003342">print</span><span class="op" id="6003347">(</span><span class="ident" id="6003348">d</span><span class="op" id="6003349">.</span><span class="ident" id="6003350">Pos</span><span class="op" id="6003353">(</span><span class="op" id="6003354">)</span><span class="op" id="6003355">,</span>&nbsp;<span class="string" id="6003357">&#34;BadDecl&#34;</span><span class="op" id="6003366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003369">case</span>&nbsp;<span class="op" id="6003374">*</span><span class="ident" id="6003375">ast</span><span class="op" id="6003378">.</span><span class="ident" id="6003379">GenDecl</span><span class="op" id="6003386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003390">p</span><span class="op" id="6003391">.</span><span class="ident" id="6003392">genDecl</span><span class="op" id="6003399">(</span><span class="ident" id="6003400">d</span><span class="op" id="6003401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003404">case</span>&nbsp;<span class="op" id="6003409">*</span><span class="ident" id="6003410">ast</span><span class="op" id="6003413">.</span><span class="ident" id="6003414">FuncDecl</span><span class="op" id="6003422">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003426">p</span><span class="op" id="6003427">.</span><span class="ident" id="6003428">funcDecl</span><span class="op" id="6003436">(</span><span class="ident" id="6003437">d</span><span class="op" id="6003438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003441">default</span><span class="op" id="6003448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6003452">panic</span><span class="op" id="6003457">(</span><span class="string" id="6003458">&#34;unreachable&#34;</span><span class="op" id="6003471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003474">}</span><br>
<span class="lineno"></span><span class="op" id="6003476">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="6003479">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="6003559">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6003569">func</span>&nbsp;<span class="ident" id="6003574">declToken</span><span class="op" id="6003583">(</span><span class="ident" id="6003584">decl</span>&nbsp;<span class="ident" id="6003589">ast</span><span class="op" id="6003592">.</span><span class="ident" id="6003593">Decl</span><span class="op" id="6003597">)</span>&nbsp;<span class="op" id="6003599">(</span><span class="ident" id="6003600">tok</span>&nbsp;<span class="ident" id="6003604">token</span><span class="op" id="6003609">.</span><span class="ident" id="6003610">Token</span><span class="op" id="6003615">)</span>&nbsp;<span class="op" id="6003617">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003620">tok</span>&nbsp;<span class="op" id="6003624">=</span>&nbsp;<span class="ident" id="6003626">token</span><span class="op" id="6003631">.</span><span class="ident" id="6003632">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003641">switch</span>&nbsp;<span class="ident" id="6003648">d</span>&nbsp;<span class="op" id="6003650">:=</span>&nbsp;<span class="ident" id="6003653">decl</span><span class="op" id="6003657">.</span><span class="op" id="6003658">(</span><span class="keyword" id="6003659">type</span><span class="op" id="6003663">)</span>&nbsp;<span class="op" id="6003665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003668">case</span>&nbsp;<span class="op" id="6003673">*</span><span class="ident" id="6003674">ast</span><span class="op" id="6003677">.</span><span class="ident" id="6003678">GenDecl</span><span class="op" id="6003685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003689">tok</span>&nbsp;<span class="op" id="6003693">=</span>&nbsp;<span class="ident" id="6003695">d</span><span class="op" id="6003696">.</span><span class="ident" id="6003697">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003702">case</span>&nbsp;<span class="op" id="6003707">*</span><span class="ident" id="6003708">ast</span><span class="op" id="6003711">.</span><span class="ident" id="6003712">FuncDecl</span><span class="op" id="6003720">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003724">tok</span>&nbsp;<span class="op" id="6003728">=</span>&nbsp;<span class="ident" id="6003730">token</span><span class="op" id="6003735">.</span><span class="ident" id="6003736">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003745">return</span><br>
<span class="lineno"></span><span class="op" id="6003752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="6003755">func</span>&nbsp;<span class="op" id="6003760">(</span><span class="ident" id="6003761">p</span>&nbsp;<span class="op" id="6003763">*</span><span class="ident" id="6003764">printer</span><span class="op" id="6003771">)</span>&nbsp;<span class="ident" id="6003773">declList</span><span class="op" id="6003781">(</span><span class="ident" id="6003782">list</span>&nbsp;<span class="op" id="6003787">[</span><span class="op" id="6003788">]</span><span class="ident" id="6003789">ast</span><span class="op" id="6003792">.</span><span class="ident" id="6003793">Decl</span><span class="op" id="6003797">)</span>&nbsp;<span class="op" id="6003799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003802">tok</span>&nbsp;<span class="op" id="6003806">:=</span>&nbsp;<span class="ident" id="6003809">token</span><span class="op" id="6003814">.</span><span class="ident" id="6003815">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003824">for</span>&nbsp;<span class="ident" id="6003828">_</span><span class="op" id="6003829">,</span>&nbsp;<span class="ident" id="6003831">d</span>&nbsp;<span class="op" id="6003833">:=</span>&nbsp;<span class="keyword" id="6003836">range</span>&nbsp;<span class="ident" id="6003842">list</span>&nbsp;<span class="op" id="6003847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003851">prev</span>&nbsp;<span class="op" id="6003856">:=</span>&nbsp;<span class="ident" id="6003859">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003865">tok</span>&nbsp;<span class="op" id="6003869">=</span>&nbsp;<span class="ident" id="6003871">declToken</span><span class="op" id="6003880">(</span><span class="ident" id="6003881">d</span><span class="op" id="6003882">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003886">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003951">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004018">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004075">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004141">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004210">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004277">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004334">if</span>&nbsp;<span class="builtinfunc" id="6004337">len</span><span class="op" id="6004340">(</span><span class="ident" id="6004341">p</span><span class="op" id="6004342">.</span><span class="ident" id="6004343">output</span><span class="op" id="6004349">)</span>&nbsp;<span class="op" id="6004351">&gt;</span>&nbsp;<span class="num" id="6004353">0</span>&nbsp;<span class="op" id="6004355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004360">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004433">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004490">min</span>&nbsp;<span class="op" id="6004494">:=</span>&nbsp;<span class="num" id="6004497">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004502">if</span>&nbsp;<span class="ident" id="6004505">prev</span>&nbsp;<span class="op" id="6004510">!=</span>&nbsp;<span class="ident" id="6004513">tok</span>&nbsp;<span class="op" id="6004517">||</span>&nbsp;<span class="ident" id="6004520">getDoc</span><span class="op" id="6004526">(</span><span class="ident" id="6004527">d</span><span class="op" id="6004528">)</span>&nbsp;<span class="op" id="6004530">!=</span>&nbsp;<span class="ident" id="6004533">nil</span>&nbsp;<span class="op" id="6004537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004543">min</span>&nbsp;<span class="op" id="6004547">=</span>&nbsp;<span class="num" id="6004549">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004559">p</span><span class="op" id="6004560">.</span><span class="ident" id="6004561">linebreak</span><span class="op" id="6004570">(</span><span class="ident" id="6004571">p</span><span class="op" id="6004572">.</span><span class="ident" id="6004573">lineFor</span><span class="op" id="6004580">(</span><span class="ident" id="6004581">d</span><span class="op" id="6004582">.</span><span class="ident" id="6004583">Pos</span><span class="op" id="6004586">(</span><span class="op" id="6004587">)</span><span class="op" id="6004588">)</span><span class="op" id="6004589">,</span>&nbsp;<span class="ident" id="6004591">min</span><span class="op" id="6004594">,</span>&nbsp;<span class="ident" id="6004596">ignore</span><span class="op" id="6004602">,</span>&nbsp;<span class="builtintype" id="6004604">false</span><span class="op" id="6004609">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004617">p</span><span class="op" id="6004618">.</span><span class="ident" id="6004619">decl</span><span class="op" id="6004623">(</span><span class="ident" id="6004624">d</span><span class="op" id="6004625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004628">}</span><br>
<span class="lineno"></span><span class="op" id="6004630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="6004633">func</span>&nbsp;<span class="op" id="6004638">(</span><span class="ident" id="6004639">p</span>&nbsp;<span class="op" id="6004641">*</span><span class="ident" id="6004642">printer</span><span class="op" id="6004649">)</span>&nbsp;<span class="ident" id="6004651">file</span><span class="op" id="6004655">(</span><span class="ident" id="6004656">src</span>&nbsp;<span class="op" id="6004660">*</span><span class="ident" id="6004661">ast</span><span class="op" id="6004664">.</span><span class="ident" id="6004665">File</span><span class="op" id="6004669">)</span>&nbsp;<span class="op" id="6004671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004674">p</span><span class="op" id="6004675">.</span><span class="ident" id="6004676">setComment</span><span class="op" id="6004686">(</span><span class="ident" id="6004687">src</span><span class="op" id="6004690">.</span><span class="ident" id="6004691">Doc</span><span class="op" id="6004694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004697">p</span><span class="op" id="6004698">.</span><span class="builtinfunc" id="6004699">print</span><span class="op" id="6004704">(</span><span class="ident" id="6004705">src</span><span class="op" id="6004708">.</span><span class="ident" id="6004709">Pos</span><span class="op" id="6004712">(</span><span class="op" id="6004713">)</span><span class="op" id="6004714">,</span>&nbsp;<span class="ident" id="6004716">token</span><span class="op" id="6004721">.</span><span class="ident" id="6004722">PACKAGE</span><span class="op" id="6004729">,</span>&nbsp;<span class="ident" id="6004731">blank</span><span class="op" id="6004736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004739">p</span><span class="op" id="6004740">.</span><span class="ident" id="6004741">expr</span><span class="op" id="6004745">(</span><span class="ident" id="6004746">src</span><span class="op" id="6004749">.</span><span class="ident" id="6004750">Name</span><span class="op" id="6004754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004757">p</span><span class="op" id="6004758">.</span><span class="ident" id="6004759">declList</span><span class="op" id="6004767">(</span><span class="ident" id="6004768">src</span><span class="op" id="6004771">.</span><span class="ident" id="6004772">Decls</span><span class="op" id="6004777">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004780">p</span><span class="op" id="6004781">.</span><span class="builtinfunc" id="6004782">print</span><span class="op" id="6004787">(</span><span class="ident" id="6004788">newline</span><span class="op" id="6004795">)</span><br>
<span class="lineno"></span><span class="op" id="6004797">}</span>
</div>
</body>
</html>
