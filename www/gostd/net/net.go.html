<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3077228">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3077283">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3077337">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3077388">/*<br>
<span class="lineno"></span>Package&nbsp;net&nbsp;provides&nbsp;a&nbsp;portable&nbsp;interface&nbsp;for&nbsp;network&nbsp;I/O,&nbsp;including<br>
<span class="lineno"></span>TCP/IP,&nbsp;UDP,&nbsp;domain&nbsp;name&nbsp;resolution,&nbsp;and&nbsp;Unix&nbsp;domain&nbsp;sockets.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>Although&nbsp;the&nbsp;package&nbsp;provides&nbsp;access&nbsp;to&nbsp;low-level&nbsp;networking<br>
<span class="lineno">10</span>primitives,&nbsp;most&nbsp;clients&nbsp;will&nbsp;need&nbsp;only&nbsp;the&nbsp;basic&nbsp;interface&nbsp;provided<br>
<span class="lineno"></span>by&nbsp;the&nbsp;Dial,&nbsp;Listen,&nbsp;and&nbsp;Accept&nbsp;functions&nbsp;and&nbsp;the&nbsp;associated<br>
<span class="lineno"></span>Conn&nbsp;and&nbsp;Listener&nbsp;interfaces.&nbsp;The&nbsp;crypto/tls&nbsp;package&nbsp;uses<br>
<span class="lineno"></span>the&nbsp;same&nbsp;interfaces&nbsp;and&nbsp;similar&nbsp;Dial&nbsp;and&nbsp;Listen&nbsp;functions.<br>
<span class="lineno"></span><br>
<span class="lineno">15</span>The&nbsp;Dial&nbsp;function&nbsp;connects&nbsp;to&nbsp;a&nbsp;server:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;net.Dial(&#34;tcp&#34;,&nbsp;&#34;google.com:80&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Fprintf(conn,&nbsp;&#34;GET&nbsp;/&nbsp;HTTP/1.0\r\n\r\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspstatus,&nbsp;err&nbsp;:=&nbsp;bufio.NewReader(conn).ReadString(&#39;\n&#39;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>The&nbsp;Listen&nbsp;function&nbsp;creates&nbsp;servers:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspln,&nbsp;err&nbsp;:=&nbsp;net.Listen(&#34;tcp&#34;,&nbsp;&#34;:8080&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;ln.Accept()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;handleConnection(conn)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="3078291">package</span>&nbsp;<span class="ident" id="3078299">net</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3078304">//&nbsp;TODO(rsc):</span><br>
<span class="lineno"></span><span class="comment" id="3078318">//&nbsp;&nbsp;&nbsp;&nbspsupport&nbsp;for&nbsp;raw&nbsp;ethernet&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3078355">import</span>&nbsp;<span class="op" id="3078362">(</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3078365">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3078375">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3078381">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3078387">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3078398">&#34;time&#34;</span><br>
<span class="lineno">50</span><span class="op" id="3078405">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3078408">//&nbsp;Addr&nbsp;represents&nbsp;a&nbsp;network&nbsp;end&nbsp;point&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3078456">type</span>&nbsp;<span class="ident" id="3078461">Addr</span>&nbsp;<span class="keyword" id="3078466">interface</span>&nbsp;<span class="op" id="3078476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3078479">Network</span><span class="op" id="3078486">(</span><span class="op" id="3078487">)</span>&nbsp;<span class="builtintype" id="3078489">string</span>&nbsp;<span class="comment" id="3078496">//&nbsp;name&nbsp;of&nbsp;the&nbsp;network</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3078520">String</span><span class="op" id="3078526">(</span><span class="op" id="3078527">)</span>&nbsp;<span class="builtintype" id="3078529">string</span>&nbsp;&nbsp;<span class="comment" id="3078537">//&nbsp;string&nbsp;form&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span><span class="op" id="3078563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3078566">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;generic&nbsp;stream-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3078623">//</span><br>
<span class="lineno">60</span><span class="comment" id="3078626">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Conn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3078694">type</span>&nbsp;<span class="ident" id="3078699">Conn</span>&nbsp;<span class="keyword" id="3078704">interface</span>&nbsp;<span class="op" id="3078714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3078717">//&nbsp;Read&nbsp;reads&nbsp;data&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3078758">//&nbsp;Read&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3078833">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3078900">Read</span><span class="op" id="3078904">(</span><span class="ident" id="3078905">b</span>&nbsp;<span class="op" id="3078907">[</span><span class="op" id="3078908">]</span><span class="builtintype" id="3078909">byte</span><span class="op" id="3078913">)</span>&nbsp;<span class="op" id="3078915">(</span><span class="ident" id="3078916">n</span>&nbsp;<span class="builtintype" id="3078918">int</span><span class="op" id="3078921">,</span>&nbsp;<span class="ident" id="3078923">err</span>&nbsp;<span class="builtintype" id="3078927">error</span><span class="op" id="3078932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3078936">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3078977">//&nbsp;Write&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079053">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3079121">Write</span><span class="op" id="3079126">(</span><span class="ident" id="3079127">b</span>&nbsp;<span class="op" id="3079129">[</span><span class="op" id="3079130">]</span><span class="builtintype" id="3079131">byte</span><span class="op" id="3079135">)</span>&nbsp;<span class="op" id="3079137">(</span><span class="ident" id="3079138">n</span>&nbsp;<span class="builtintype" id="3079140">int</span><span class="op" id="3079143">,</span>&nbsp;<span class="ident" id="3079145">err</span>&nbsp;<span class="builtintype" id="3079149">error</span><span class="op" id="3079154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079158">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079191">//&nbsp;Any&nbsp;blocked&nbsp;Read&nbsp;or&nbsp;Write&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3079269">Close</span><span class="op" id="3079274">(</span><span class="op" id="3079275">)</span>&nbsp;<span class="builtintype" id="3079277">error</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079285">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3079334">LocalAddr</span><span class="op" id="3079343">(</span><span class="op" id="3079344">)</span>&nbsp;<span class="ident" id="3079346">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079353">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3079404">RemoteAddr</span><span class="op" id="3079414">(</span><span class="op" id="3079415">)</span>&nbsp;<span class="ident" id="3079417">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079424">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079485">//&nbsp;with&nbsp;the&nbsp;connection.&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079543">//&nbsp;SetReadDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079585">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079589">//&nbsp;A&nbsp;deadline&nbsp;is&nbsp;an&nbsp;absolute&nbsp;time&nbsp;after&nbsp;which&nbsp;I/O&nbsp;operations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079651">//&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079703">//&nbsp;blocking.&nbsp;The&nbsp;deadline&nbsp;applies&nbsp;to&nbsp;all&nbsp;future&nbsp;I/O,&nbsp;not&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079766">//&nbsp;the&nbsp;immediately&nbsp;following&nbsp;call&nbsp;to&nbsp;Read&nbsp;or&nbsp;Write.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079819">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079823">//&nbsp;An&nbsp;idle&nbsp;timeout&nbsp;can&nbsp;be&nbsp;implemented&nbsp;by&nbsp;repeatedly&nbsp;extending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079886">//&nbsp;the&nbsp;deadline&nbsp;after&nbsp;successful&nbsp;Read&nbsp;or&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079941">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3079945">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;I/O&nbsp;operations&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3080008">SetDeadline</span><span class="op" id="3080019">(</span><span class="ident" id="3080020">t</span>&nbsp;<span class="ident" id="3080022">time</span><span class="op" id="3080026">.</span><span class="ident" id="3080027">Time</span><span class="op" id="3080031">)</span>&nbsp;<span class="builtintype" id="3080033">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3080041">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3080102">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3080155">SetReadDeadline</span><span class="op" id="3080170">(</span><span class="ident" id="3080171">t</span>&nbsp;<span class="ident" id="3080173">time</span><span class="op" id="3080177">.</span><span class="ident" id="3080178">Time</span><span class="op" id="3080182">)</span>&nbsp;<span class="builtintype" id="3080184">error</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3080192">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3080255">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3080321">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3080368">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3080422">SetWriteDeadline</span><span class="op" id="3080438">(</span><span class="ident" id="3080439">t</span>&nbsp;<span class="ident" id="3080441">time</span><span class="op" id="3080445">.</span><span class="ident" id="3080446">Time</span><span class="op" id="3080450">)</span>&nbsp;<span class="builtintype" id="3080452">error</span><br>
<span class="lineno"></span><span class="op" id="3080458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3080461">type</span>&nbsp;<span class="ident" id="3080466">conn</span>&nbsp;<span class="keyword" id="3080471">struct</span>&nbsp;<span class="op" id="3080478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3080481">fd</span>&nbsp;<span class="op" id="3080484">*</span><span class="ident" id="3080485">netFD</span><br>
<span class="lineno">110</span><span class="op" id="3080491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3080494">func</span>&nbsp;<span class="op" id="3080499">(</span><span class="ident" id="3080500">c</span>&nbsp;<span class="op" id="3080502">*</span><span class="ident" id="3080503">conn</span><span class="op" id="3080507">)</span>&nbsp;<span class="ident" id="3080509">ok</span><span class="op" id="3080511">(</span><span class="op" id="3080512">)</span>&nbsp;<span class="builtintype" id="3080514">bool</span>&nbsp;<span class="op" id="3080519">{</span>&nbsp;<span class="keyword" id="3080521">return</span>&nbsp;<span class="ident" id="3080528">c</span>&nbsp;<span class="op" id="3080530">!=</span>&nbsp;<span class="ident" id="3080533">nil</span>&nbsp;<span class="op" id="3080537">&amp;&amp;</span>&nbsp;<span class="ident" id="3080540">c</span><span class="op" id="3080541">.</span><span class="ident" id="3080542">fd</span>&nbsp;<span class="op" id="3080545">!=</span>&nbsp;<span class="ident" id="3080548">nil</span>&nbsp;<span class="op" id="3080552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3080555">//&nbsp;Implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3080597">//&nbsp;Read&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3080638">func</span>&nbsp;<span class="op" id="3080643">(</span><span class="ident" id="3080644">c</span>&nbsp;<span class="op" id="3080646">*</span><span class="ident" id="3080647">conn</span><span class="op" id="3080651">)</span>&nbsp;<span class="ident" id="3080653">Read</span><span class="op" id="3080657">(</span><span class="ident" id="3080658">b</span>&nbsp;<span class="op" id="3080660">[</span><span class="op" id="3080661">]</span><span class="builtintype" id="3080662">byte</span><span class="op" id="3080666">)</span>&nbsp;<span class="op" id="3080668">(</span><span class="builtintype" id="3080669">int</span><span class="op" id="3080672">,</span>&nbsp;<span class="builtintype" id="3080674">error</span><span class="op" id="3080679">)</span>&nbsp;<span class="op" id="3080681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080684">if</span>&nbsp;<span class="op" id="3080687">!</span><span class="ident" id="3080688">c</span><span class="op" id="3080689">.</span><span class="ident" id="3080690">ok</span><span class="op" id="3080692">(</span><span class="op" id="3080693">)</span>&nbsp;<span class="op" id="3080695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080699">return</span>&nbsp;<span class="num" id="3080706">0</span><span class="op" id="3080707">,</span>&nbsp;<span class="ident" id="3080709">syscall</span><span class="op" id="3080716">.</span><span class="ident" id="3080717">EINVAL</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3080725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080728">return</span>&nbsp;<span class="ident" id="3080735">c</span><span class="op" id="3080736">.</span><span class="ident" id="3080737">fd</span><span class="op" id="3080739">.</span><span class="ident" id="3080740">Read</span><span class="op" id="3080744">(</span><span class="ident" id="3080745">b</span><span class="op" id="3080746">)</span><br>
<span class="lineno"></span><span class="op" id="3080748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3080751">//&nbsp;Write&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">125</span><span class="keyword" id="3080794">func</span>&nbsp;<span class="op" id="3080799">(</span><span class="ident" id="3080800">c</span>&nbsp;<span class="op" id="3080802">*</span><span class="ident" id="3080803">conn</span><span class="op" id="3080807">)</span>&nbsp;<span class="ident" id="3080809">Write</span><span class="op" id="3080814">(</span><span class="ident" id="3080815">b</span>&nbsp;<span class="op" id="3080817">[</span><span class="op" id="3080818">]</span><span class="builtintype" id="3080819">byte</span><span class="op" id="3080823">)</span>&nbsp;<span class="op" id="3080825">(</span><span class="builtintype" id="3080826">int</span><span class="op" id="3080829">,</span>&nbsp;<span class="builtintype" id="3080831">error</span><span class="op" id="3080836">)</span>&nbsp;<span class="op" id="3080838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080841">if</span>&nbsp;<span class="op" id="3080844">!</span><span class="ident" id="3080845">c</span><span class="op" id="3080846">.</span><span class="ident" id="3080847">ok</span><span class="op" id="3080849">(</span><span class="op" id="3080850">)</span>&nbsp;<span class="op" id="3080852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080856">return</span>&nbsp;<span class="num" id="3080863">0</span><span class="op" id="3080864">,</span>&nbsp;<span class="ident" id="3080866">syscall</span><span class="op" id="3080873">.</span><span class="ident" id="3080874">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3080882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080885">return</span>&nbsp;<span class="ident" id="3080892">c</span><span class="op" id="3080893">.</span><span class="ident" id="3080894">fd</span><span class="op" id="3080896">.</span><span class="ident" id="3080897">Write</span><span class="op" id="3080902">(</span><span class="ident" id="3080903">b</span><span class="op" id="3080904">)</span><br>
<span class="lineno">130</span><span class="op" id="3080906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3080909">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3080941">func</span>&nbsp;<span class="op" id="3080946">(</span><span class="ident" id="3080947">c</span>&nbsp;<span class="op" id="3080949">*</span><span class="ident" id="3080950">conn</span><span class="op" id="3080954">)</span>&nbsp;<span class="ident" id="3080956">Close</span><span class="op" id="3080961">(</span><span class="op" id="3080962">)</span>&nbsp;<span class="builtintype" id="3080964">error</span>&nbsp;<span class="op" id="3080970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080973">if</span>&nbsp;<span class="op" id="3080976">!</span><span class="ident" id="3080977">c</span><span class="op" id="3080978">.</span><span class="ident" id="3080979">ok</span><span class="op" id="3080981">(</span><span class="op" id="3080982">)</span>&nbsp;<span class="op" id="3080984">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3080988">return</span>&nbsp;<span class="ident" id="3080995">syscall</span><span class="op" id="3081002">.</span><span class="ident" id="3081003">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3081011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081014">return</span>&nbsp;<span class="ident" id="3081021">c</span><span class="op" id="3081022">.</span><span class="ident" id="3081023">fd</span><span class="op" id="3081025">.</span><span class="ident" id="3081026">Close</span><span class="op" id="3081031">(</span><span class="op" id="3081032">)</span><br>
<span class="lineno"></span><span class="op" id="3081034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3081037">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3081085">func</span>&nbsp;<span class="op" id="3081090">(</span><span class="ident" id="3081091">c</span>&nbsp;<span class="op" id="3081093">*</span><span class="ident" id="3081094">conn</span><span class="op" id="3081098">)</span>&nbsp;<span class="ident" id="3081100">LocalAddr</span><span class="op" id="3081109">(</span><span class="op" id="3081110">)</span>&nbsp;<span class="ident" id="3081112">Addr</span>&nbsp;<span class="op" id="3081117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081120">if</span>&nbsp;<span class="op" id="3081123">!</span><span class="ident" id="3081124">c</span><span class="op" id="3081125">.</span><span class="ident" id="3081126">ok</span><span class="op" id="3081128">(</span><span class="op" id="3081129">)</span>&nbsp;<span class="op" id="3081131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081135">return</span>&nbsp;<span class="ident" id="3081142">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3081147">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081150">return</span>&nbsp;<span class="ident" id="3081157">c</span><span class="op" id="3081158">.</span><span class="ident" id="3081159">fd</span><span class="op" id="3081161">.</span><span class="ident" id="3081162">laddr</span><br>
<span class="lineno"></span><span class="op" id="3081168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081171">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3081221">func</span>&nbsp;<span class="op" id="3081226">(</span><span class="ident" id="3081227">c</span>&nbsp;<span class="op" id="3081229">*</span><span class="ident" id="3081230">conn</span><span class="op" id="3081234">)</span>&nbsp;<span class="ident" id="3081236">RemoteAddr</span><span class="op" id="3081246">(</span><span class="op" id="3081247">)</span>&nbsp;<span class="ident" id="3081249">Addr</span>&nbsp;<span class="op" id="3081254">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081257">if</span>&nbsp;<span class="op" id="3081260">!</span><span class="ident" id="3081261">c</span><span class="op" id="3081262">.</span><span class="ident" id="3081263">ok</span><span class="op" id="3081265">(</span><span class="op" id="3081266">)</span>&nbsp;<span class="op" id="3081268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081272">return</span>&nbsp;<span class="ident" id="3081279">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3081284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081287">return</span>&nbsp;<span class="ident" id="3081294">c</span><span class="op" id="3081295">.</span><span class="ident" id="3081296">fd</span><span class="op" id="3081298">.</span><span class="ident" id="3081299">raddr</span><br>
<span class="lineno"></span><span class="op" id="3081305">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3081308">//&nbsp;SetDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3081363">func</span>&nbsp;<span class="op" id="3081368">(</span><span class="ident" id="3081369">c</span>&nbsp;<span class="op" id="3081371">*</span><span class="ident" id="3081372">conn</span><span class="op" id="3081376">)</span>&nbsp;<span class="ident" id="3081378">SetDeadline</span><span class="op" id="3081389">(</span><span class="ident" id="3081390">t</span>&nbsp;<span class="ident" id="3081392">time</span><span class="op" id="3081396">.</span><span class="ident" id="3081397">Time</span><span class="op" id="3081401">)</span>&nbsp;<span class="builtintype" id="3081403">error</span>&nbsp;<span class="op" id="3081409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081412">if</span>&nbsp;<span class="op" id="3081415">!</span><span class="ident" id="3081416">c</span><span class="op" id="3081417">.</span><span class="ident" id="3081418">ok</span><span class="op" id="3081420">(</span><span class="op" id="3081421">)</span>&nbsp;<span class="op" id="3081423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081427">return</span>&nbsp;<span class="ident" id="3081434">syscall</span><span class="op" id="3081441">.</span><span class="ident" id="3081442">EINVAL</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3081450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081453">return</span>&nbsp;<span class="ident" id="3081460">c</span><span class="op" id="3081461">.</span><span class="ident" id="3081462">fd</span><span class="op" id="3081464">.</span><span class="ident" id="3081465">setDeadline</span><span class="op" id="3081476">(</span><span class="ident" id="3081477">t</span><span class="op" id="3081478">)</span><br>
<span class="lineno"></span><span class="op" id="3081480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081483">//&nbsp;SetReadDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetReadDeadline&nbsp;method.</span><br>
<span class="lineno">165</span><span class="keyword" id="3081546">func</span>&nbsp;<span class="op" id="3081551">(</span><span class="ident" id="3081552">c</span>&nbsp;<span class="op" id="3081554">*</span><span class="ident" id="3081555">conn</span><span class="op" id="3081559">)</span>&nbsp;<span class="ident" id="3081561">SetReadDeadline</span><span class="op" id="3081576">(</span><span class="ident" id="3081577">t</span>&nbsp;<span class="ident" id="3081579">time</span><span class="op" id="3081583">.</span><span class="ident" id="3081584">Time</span><span class="op" id="3081588">)</span>&nbsp;<span class="builtintype" id="3081590">error</span>&nbsp;<span class="op" id="3081596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081599">if</span>&nbsp;<span class="op" id="3081602">!</span><span class="ident" id="3081603">c</span><span class="op" id="3081604">.</span><span class="ident" id="3081605">ok</span><span class="op" id="3081607">(</span><span class="op" id="3081608">)</span>&nbsp;<span class="op" id="3081610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081614">return</span>&nbsp;<span class="ident" id="3081621">syscall</span><span class="op" id="3081628">.</span><span class="ident" id="3081629">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3081637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081640">return</span>&nbsp;<span class="ident" id="3081647">c</span><span class="op" id="3081648">.</span><span class="ident" id="3081649">fd</span><span class="op" id="3081651">.</span><span class="ident" id="3081652">setReadDeadline</span><span class="op" id="3081667">(</span><span class="ident" id="3081668">t</span><span class="op" id="3081669">)</span><br>
<span class="lineno">170</span><span class="op" id="3081671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081674">//&nbsp;SetWriteDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetWriteDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3081739">func</span>&nbsp;<span class="op" id="3081744">(</span><span class="ident" id="3081745">c</span>&nbsp;<span class="op" id="3081747">*</span><span class="ident" id="3081748">conn</span><span class="op" id="3081752">)</span>&nbsp;<span class="ident" id="3081754">SetWriteDeadline</span><span class="op" id="3081770">(</span><span class="ident" id="3081771">t</span>&nbsp;<span class="ident" id="3081773">time</span><span class="op" id="3081777">.</span><span class="ident" id="3081778">Time</span><span class="op" id="3081782">)</span>&nbsp;<span class="builtintype" id="3081784">error</span>&nbsp;<span class="op" id="3081790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081793">if</span>&nbsp;<span class="op" id="3081796">!</span><span class="ident" id="3081797">c</span><span class="op" id="3081798">.</span><span class="ident" id="3081799">ok</span><span class="op" id="3081801">(</span><span class="op" id="3081802">)</span>&nbsp;<span class="op" id="3081804">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081808">return</span>&nbsp;<span class="ident" id="3081815">syscall</span><span class="op" id="3081822">.</span><span class="ident" id="3081823">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3081831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3081834">return</span>&nbsp;<span class="ident" id="3081841">c</span><span class="op" id="3081842">.</span><span class="ident" id="3081843">fd</span><span class="op" id="3081845">.</span><span class="ident" id="3081846">setWriteDeadline</span><span class="op" id="3081862">(</span><span class="ident" id="3081863">t</span><span class="op" id="3081864">)</span><br>
<span class="lineno"></span><span class="op" id="3081866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="3081869">//&nbsp;SetReadBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3081926">//&nbsp;receive&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3081976">func</span>&nbsp;<span class="op" id="3081981">(</span><span class="ident" id="3081982">c</span>&nbsp;<span class="op" id="3081984">*</span><span class="ident" id="3081985">conn</span><span class="op" id="3081989">)</span>&nbsp;<span class="ident" id="3081991">SetReadBuffer</span><span class="op" id="3082004">(</span><span class="ident" id="3082005">bytes</span>&nbsp;<span class="builtintype" id="3082011">int</span><span class="op" id="3082014">)</span>&nbsp;<span class="builtintype" id="3082016">error</span>&nbsp;<span class="op" id="3082022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3082025">if</span>&nbsp;<span class="op" id="3082028">!</span><span class="ident" id="3082029">c</span><span class="op" id="3082030">.</span><span class="ident" id="3082031">ok</span><span class="op" id="3082033">(</span><span class="op" id="3082034">)</span>&nbsp;<span class="op" id="3082036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3082040">return</span>&nbsp;<span class="ident" id="3082047">syscall</span><span class="op" id="3082054">.</span><span class="ident" id="3082055">EINVAL</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3082063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3082066">return</span>&nbsp;<span class="ident" id="3082073">setReadBuffer</span><span class="op" id="3082086">(</span><span class="ident" id="3082087">c</span><span class="op" id="3082088">.</span><span class="ident" id="3082089">fd</span><span class="op" id="3082091">,</span>&nbsp;<span class="ident" id="3082093">bytes</span><span class="op" id="3082098">)</span><br>
<span class="lineno"></span><span class="op" id="3082100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082103">//&nbsp;SetWriteBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno">190</span><span class="comment" id="3082161">//&nbsp;transmit&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3082212">func</span>&nbsp;<span class="op" id="3082217">(</span><span class="ident" id="3082218">c</span>&nbsp;<span class="op" id="3082220">*</span><span class="ident" id="3082221">conn</span><span class="op" id="3082225">)</span>&nbsp;<span class="ident" id="3082227">SetWriteBuffer</span><span class="op" id="3082241">(</span><span class="ident" id="3082242">bytes</span>&nbsp;<span class="builtintype" id="3082248">int</span><span class="op" id="3082251">)</span>&nbsp;<span class="builtintype" id="3082253">error</span>&nbsp;<span class="op" id="3082259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3082262">if</span>&nbsp;<span class="op" id="3082265">!</span><span class="ident" id="3082266">c</span><span class="op" id="3082267">.</span><span class="ident" id="3082268">ok</span><span class="op" id="3082270">(</span><span class="op" id="3082271">)</span>&nbsp;<span class="op" id="3082273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3082277">return</span>&nbsp;<span class="ident" id="3082284">syscall</span><span class="op" id="3082291">.</span><span class="ident" id="3082292">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3082300">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3082303">return</span>&nbsp;<span class="ident" id="3082310">setWriteBuffer</span><span class="op" id="3082324">(</span><span class="ident" id="3082325">c</span><span class="op" id="3082326">.</span><span class="ident" id="3082327">fd</span><span class="op" id="3082329">,</span>&nbsp;<span class="ident" id="3082331">bytes</span><span class="op" id="3082336">)</span><br>
<span class="lineno"></span><span class="op" id="3082338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082341">//&nbsp;File&nbsp;sets&nbsp;the&nbsp;underlying&nbsp;os.File&nbsp;to&nbsp;blocking&nbsp;mode&nbsp;and&nbsp;returns&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span><span class="comment" id="3082414">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno">200</span><span class="comment" id="3082477">//&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="3082542">//</span><br>
<span class="lineno"></span><span class="comment" id="3082545">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;connection&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="3082623">//&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original&nbsp;using&nbsp;this&nbsp;duplicate</span><br>
<span class="lineno"></span><span class="comment" id="3082695">//&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno">205</span><span class="keyword" id="3082738">func</span>&nbsp;<span class="op" id="3082743">(</span><span class="ident" id="3082744">c</span>&nbsp;<span class="op" id="3082746">*</span><span class="ident" id="3082747">conn</span><span class="op" id="3082751">)</span>&nbsp;<span class="ident" id="3082753">File</span><span class="op" id="3082757">(</span><span class="op" id="3082758">)</span>&nbsp;<span class="op" id="3082760">(</span><span class="ident" id="3082761">f</span>&nbsp;<span class="op" id="3082763">*</span><span class="ident" id="3082764">os</span><span class="op" id="3082766">.</span><span class="ident" id="3082767">File</span><span class="op" id="3082771">,</span>&nbsp;<span class="ident" id="3082773">err</span>&nbsp;<span class="builtintype" id="3082777">error</span><span class="op" id="3082782">)</span>&nbsp;<span class="op" id="3082784">{</span>&nbsp;<span class="keyword" id="3082786">return</span>&nbsp;<span class="ident" id="3082793">c</span><span class="op" id="3082794">.</span><span class="ident" id="3082795">fd</span><span class="op" id="3082797">.</span><span class="ident" id="3082798">dup</span><span class="op" id="3082801">(</span><span class="op" id="3082802">)</span>&nbsp;<span class="op" id="3082804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082807">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;network&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3082847">type</span>&nbsp;<span class="ident" id="3082852">Error</span>&nbsp;<span class="keyword" id="3082858">interface</span>&nbsp;<span class="op" id="3082868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3082871">error</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3082878">Timeout</span><span class="op" id="3082885">(</span><span class="op" id="3082886">)</span>&nbsp;<span class="builtintype" id="3082888">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3082895">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;a&nbsp;timeout?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3082923">Temporary</span><span class="op" id="3082932">(</span><span class="op" id="3082933">)</span>&nbsp;<span class="builtintype" id="3082935">bool</span>&nbsp;<span class="comment" id="3082940">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;temporary?</span><br>
<span class="lineno"></span><span class="op" id="3082967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082970">//&nbsp;PacketConn&nbsp;is&nbsp;a&nbsp;generic&nbsp;packet-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">215</span><span class="comment" id="3083033">//</span><br>
<span class="lineno"></span><span class="comment" id="3083036">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;PacketConn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3083110">type</span>&nbsp;<span class="ident" id="3083115">PacketConn</span>&nbsp;<span class="keyword" id="3083126">interface</span>&nbsp;<span class="op" id="3083136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083139">//&nbsp;ReadFrom&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;the&nbsp;connection,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083188">//&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083246">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083298">//&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083321">//&nbsp;ReadFrom&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083369">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083431">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3083472">ReadFrom</span><span class="op" id="3083480">(</span><span class="ident" id="3083481">b</span>&nbsp;<span class="op" id="3083483">[</span><span class="op" id="3083484">]</span><span class="builtintype" id="3083485">byte</span><span class="op" id="3083489">)</span>&nbsp;<span class="op" id="3083491">(</span><span class="ident" id="3083492">n</span>&nbsp;<span class="builtintype" id="3083494">int</span><span class="op" id="3083497">,</span>&nbsp;<span class="ident" id="3083499">addr</span>&nbsp;<span class="ident" id="3083504">Addr</span><span class="op" id="3083508">,</span>&nbsp;<span class="ident" id="3083510">err</span>&nbsp;<span class="builtintype" id="3083514">error</span><span class="op" id="3083519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083523">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;packet&nbsp;with&nbsp;payload&nbsp;b&nbsp;to&nbsp;addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083575">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083622">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083684">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083726">//&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3083787">WriteTo</span><span class="op" id="3083794">(</span><span class="ident" id="3083795">b</span>&nbsp;<span class="op" id="3083797">[</span><span class="op" id="3083798">]</span><span class="builtintype" id="3083799">byte</span><span class="op" id="3083803">,</span>&nbsp;<span class="ident" id="3083805">addr</span>&nbsp;<span class="ident" id="3083810">Addr</span><span class="op" id="3083814">)</span>&nbsp;<span class="op" id="3083816">(</span><span class="ident" id="3083817">n</span>&nbsp;<span class="builtintype" id="3083819">int</span><span class="op" id="3083822">,</span>&nbsp;<span class="ident" id="3083824">err</span>&nbsp;<span class="builtintype" id="3083828">error</span><span class="op" id="3083833">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083837">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083870">//&nbsp;Any&nbsp;blocked&nbsp;ReadFrom&nbsp;or&nbsp;WriteTo&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3083954">Close</span><span class="op" id="3083959">(</span><span class="op" id="3083960">)</span>&nbsp;<span class="builtintype" id="3083962">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3083970">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3084019">LocalAddr</span><span class="op" id="3084028">(</span><span class="op" id="3084029">)</span>&nbsp;<span class="ident" id="3084031">Addr</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084038">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084099">//&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3084124">SetDeadline</span><span class="op" id="3084135">(</span><span class="ident" id="3084136">t</span>&nbsp;<span class="ident" id="3084138">time</span><span class="op" id="3084142">.</span><span class="ident" id="3084143">Time</span><span class="op" id="3084147">)</span>&nbsp;<span class="builtintype" id="3084149">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084157">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084218">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Read&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084280">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084322">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3084375">SetReadDeadline</span><span class="op" id="3084390">(</span><span class="ident" id="3084391">t</span>&nbsp;<span class="ident" id="3084393">time</span><span class="op" id="3084397">.</span><span class="ident" id="3084398">Time</span><span class="op" id="3084402">)</span>&nbsp;<span class="builtintype" id="3084404">error</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084412">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084475">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Write&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084538">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084580">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084634">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3084700">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3084747">SetWriteDeadline</span><span class="op" id="3084763">(</span><span class="ident" id="3084764">t</span>&nbsp;<span class="ident" id="3084766">time</span><span class="op" id="3084770">.</span><span class="ident" id="3084771">Time</span><span class="op" id="3084775">)</span>&nbsp;<span class="builtintype" id="3084777">error</span><br>
<span class="lineno"></span><span class="op" id="3084783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3084786">var</span>&nbsp;<span class="ident" id="3084790">listenerBacklog</span>&nbsp;<span class="op" id="3084806">=</span>&nbsp;<span class="ident" id="3084808">maxListenerBacklog</span><span class="op" id="3084826">(</span><span class="op" id="3084827">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3084830">//&nbsp;A&nbsp;Listener&nbsp;is&nbsp;a&nbsp;generic&nbsp;network&nbsp;listener&nbsp;for&nbsp;stream-oriented&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="comment" id="3084905">//</span><br>
<span class="lineno"></span><span class="comment" id="3084908">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Listener&nbsp;simultaneously.</span><br>
<span class="lineno">265</span><span class="keyword" id="3084980">type</span>&nbsp;<span class="ident" id="3084985">Listener</span>&nbsp;<span class="keyword" id="3084994">interface</span>&nbsp;<span class="op" id="3085004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085007">//&nbsp;Accept&nbsp;waits&nbsp;for&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;connection&nbsp;to&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085077">Accept</span><span class="op" id="3085083">(</span><span class="op" id="3085084">)</span>&nbsp;<span class="op" id="3085086">(</span><span class="ident" id="3085087">c</span>&nbsp;<span class="ident" id="3085089">Conn</span><span class="op" id="3085093">,</span>&nbsp;<span class="ident" id="3085095">err</span>&nbsp;<span class="builtintype" id="3085099">error</span><span class="op" id="3085104">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085108">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;listener.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085139">//&nbsp;Any&nbsp;blocked&nbsp;Accept&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085210">Close</span><span class="op" id="3085215">(</span><span class="op" id="3085216">)</span>&nbsp;<span class="builtintype" id="3085218">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085226">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085275">Addr</span><span class="op" id="3085279">(</span><span class="op" id="3085280">)</span>&nbsp;<span class="ident" id="3085282">Addr</span><br>
<span class="lineno">275</span><span class="op" id="3085287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3085290">//&nbsp;Various&nbsp;errors&nbsp;contained&nbsp;in&nbsp;OpError.</span><br>
<span class="lineno"></span><span class="keyword" id="3085330">var</span>&nbsp;<span class="op" id="3085334">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085337">//&nbsp;For&nbsp;connection&nbsp;setup&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085384">errMissingAddress</span>&nbsp;<span class="op" id="3085402">=</span>&nbsp;<span class="ident" id="3085404">errors</span><span class="op" id="3085410">.</span><span class="ident" id="3085411">New</span><span class="op" id="3085414">(</span><span class="string" id="3085415">&#34;missing&nbsp;address&#34;</span><span class="op" id="3085432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085436">//&nbsp;For&nbsp;both&nbsp;read&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085476">errTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3085496">error</span>&nbsp;<span class="op" id="3085502">=</span>&nbsp;<span class="op" id="3085504">&amp;</span><span class="ident" id="3085505">timeoutError</span><span class="op" id="3085517">{</span><span class="op" id="3085518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085521">errClosing</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085547">=</span>&nbsp;<span class="ident" id="3085549">errors</span><span class="op" id="3085555">.</span><span class="ident" id="3085556">New</span><span class="op" id="3085559">(</span><span class="string" id="3085560">&#34;use&nbsp;of&nbsp;closed&nbsp;network&nbsp;connection&#34;</span><span class="op" id="3085594">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085597">ErrWriteToConnected</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085623">=</span>&nbsp;<span class="ident" id="3085625">errors</span><span class="op" id="3085631">.</span><span class="ident" id="3085632">New</span><span class="op" id="3085635">(</span><span class="string" id="3085636">&#34;use&nbsp;of&nbsp;WriteTo&nbsp;with&nbsp;pre-connected&nbsp;connection&#34;</span><span class="op" id="3085682">)</span><br>
<span class="lineno"></span><span class="op" id="3085684">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3085687">//&nbsp;OpError&nbsp;is&nbsp;the&nbsp;error&nbsp;type&nbsp;usually&nbsp;returned&nbsp;by&nbsp;functions&nbsp;in&nbsp;the&nbsp;net</span><br>
<span class="lineno"></span><span class="comment" id="3085757">//&nbsp;package.&nbsp;It&nbsp;describes&nbsp;the&nbsp;operation,&nbsp;network&nbsp;type,&nbsp;and&nbsp;address&nbsp;of</span><br>
<span class="lineno">290</span><span class="comment" id="3085826">//&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3085839">type</span>&nbsp;<span class="ident" id="3085844">OpError</span>&nbsp;<span class="keyword" id="3085852">struct</span>&nbsp;<span class="op" id="3085859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085862">//&nbsp;Op&nbsp;is&nbsp;the&nbsp;operation&nbsp;which&nbsp;caused&nbsp;the&nbsp;error,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085918">//&nbsp;&#34;read&#34;&nbsp;or&nbsp;&#34;write&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3085941">Op</span>&nbsp;<span class="builtintype" id="3085944">string</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3085953">//&nbsp;Net&nbsp;is&nbsp;the&nbsp;network&nbsp;type&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3086011">//&nbsp;such&nbsp;as&nbsp;&#34;tcp&#34;&nbsp;or&nbsp;&#34;udp6&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086040">Net</span>&nbsp;<span class="builtintype" id="3086044">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3086053">//&nbsp;Addr&nbsp;is&nbsp;the&nbsp;network&nbsp;address&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086115">Addr</span>&nbsp;<span class="ident" id="3086120">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3086127">//&nbsp;Err&nbsp;is&nbsp;the&nbsp;error&nbsp;that&nbsp;occurred&nbsp;during&nbsp;the&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086184">Err</span>&nbsp;<span class="builtintype" id="3086188">error</span><br>
<span class="lineno">305</span><span class="op" id="3086194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086197">func</span>&nbsp;<span class="op" id="3086202">(</span><span class="ident" id="3086203">e</span>&nbsp;<span class="op" id="3086205">*</span><span class="ident" id="3086206">OpError</span><span class="op" id="3086213">)</span>&nbsp;<span class="ident" id="3086215">Error</span><span class="op" id="3086220">(</span><span class="op" id="3086221">)</span>&nbsp;<span class="builtintype" id="3086223">string</span>&nbsp;<span class="op" id="3086230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3086233">if</span>&nbsp;<span class="ident" id="3086236">e</span>&nbsp;<span class="op" id="3086238">==</span>&nbsp;<span class="ident" id="3086241">nil</span>&nbsp;<span class="op" id="3086245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3086249">return</span>&nbsp;<span class="string" id="3086256">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3086265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086268">s</span>&nbsp;<span class="op" id="3086270">:=</span>&nbsp;<span class="ident" id="3086273">e</span><span class="op" id="3086274">.</span><span class="ident" id="3086275">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3086279">if</span>&nbsp;<span class="ident" id="3086282">e</span><span class="op" id="3086283">.</span><span class="ident" id="3086284">Net</span>&nbsp;<span class="op" id="3086288">!=</span>&nbsp;<span class="string" id="3086291">&#34;&#34;</span>&nbsp;<span class="op" id="3086294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086298">s</span>&nbsp;<span class="op" id="3086300">+=</span>&nbsp;<span class="string" id="3086303">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3086307">+</span>&nbsp;<span class="ident" id="3086309">e</span><span class="op" id="3086310">.</span><span class="ident" id="3086311">Net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3086316">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3086319">if</span>&nbsp;<span class="ident" id="3086322">e</span><span class="op" id="3086323">.</span><span class="ident" id="3086324">Addr</span>&nbsp;<span class="op" id="3086329">!=</span>&nbsp;<span class="ident" id="3086332">nil</span>&nbsp;<span class="op" id="3086336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086340">s</span>&nbsp;<span class="op" id="3086342">+=</span>&nbsp;<span class="string" id="3086345">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3086349">+</span>&nbsp;<span class="ident" id="3086351">e</span><span class="op" id="3086352">.</span><span class="ident" id="3086353">Addr</span><span class="op" id="3086357">.</span><span class="ident" id="3086358">String</span><span class="op" id="3086364">(</span><span class="op" id="3086365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3086368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086371">s</span>&nbsp;<span class="op" id="3086373">+=</span>&nbsp;<span class="string" id="3086376">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3086381">+</span>&nbsp;<span class="ident" id="3086383">e</span><span class="op" id="3086384">.</span><span class="ident" id="3086385">Err</span><span class="op" id="3086388">.</span><span class="ident" id="3086389">Error</span><span class="op" id="3086394">(</span><span class="op" id="3086395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3086398">return</span>&nbsp;<span class="ident" id="3086405">s</span><br>
<span class="lineno">320</span><span class="op" id="3086407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086410">type</span>&nbsp;<span class="ident" id="3086415">temporary</span>&nbsp;<span class="keyword" id="3086425">interface</span>&nbsp;<span class="op" id="3086435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086438">Temporary</span><span class="op" id="3086447">(</span><span class="op" id="3086448">)</span>&nbsp;<span class="builtintype" id="3086450">bool</span><br>
<span class="lineno"></span><span class="op" id="3086455">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3086458">func</span>&nbsp;<span class="op" id="3086463">(</span><span class="ident" id="3086464">e</span>&nbsp;<span class="op" id="3086466">*</span><span class="ident" id="3086467">OpError</span><span class="op" id="3086474">)</span>&nbsp;<span class="ident" id="3086476">Temporary</span><span class="op" id="3086485">(</span><span class="op" id="3086486">)</span>&nbsp;<span class="builtintype" id="3086488">bool</span>&nbsp;<span class="op" id="3086493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086496">t</span><span class="op" id="3086497">,</span>&nbsp;<span class="ident" id="3086499">ok</span>&nbsp;<span class="op" id="3086502">:=</span>&nbsp;<span class="ident" id="3086505">e</span><span class="op" id="3086506">.</span><span class="ident" id="3086507">Err</span><span class="op" id="3086510">.</span><span class="op" id="3086511">(</span><span class="ident" id="3086512">temporary</span><span class="op" id="3086521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3086524">return</span>&nbsp;<span class="ident" id="3086531">ok</span>&nbsp;<span class="op" id="3086534">&amp;&amp;</span>&nbsp;<span class="ident" id="3086537">t</span><span class="op" id="3086538">.</span><span class="ident" id="3086539">Temporary</span><span class="op" id="3086548">(</span><span class="op" id="3086549">)</span><br>
<span class="lineno"></span><span class="op" id="3086551">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="3086554">var</span>&nbsp;<span class="ident" id="3086558">noDeadline</span>&nbsp;<span class="op" id="3086569">=</span>&nbsp;<span class="ident" id="3086571">time</span><span class="op" id="3086575">.</span><span class="ident" id="3086576">Time</span><span class="op" id="3086580">{</span><span class="op" id="3086581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086584">type</span>&nbsp;<span class="ident" id="3086589">timeout</span>&nbsp;<span class="keyword" id="3086597">interface</span>&nbsp;<span class="op" id="3086607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086610">Timeout</span><span class="op" id="3086617">(</span><span class="op" id="3086618">)</span>&nbsp;<span class="builtintype" id="3086620">bool</span><br>
<span class="lineno">335</span><span class="op" id="3086625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086628">func</span>&nbsp;<span class="op" id="3086633">(</span><span class="ident" id="3086634">e</span>&nbsp;<span class="op" id="3086636">*</span><span class="ident" id="3086637">OpError</span><span class="op" id="3086644">)</span>&nbsp;<span class="ident" id="3086646">Timeout</span><span class="op" id="3086653">(</span><span class="op" id="3086654">)</span>&nbsp;<span class="builtintype" id="3086656">bool</span>&nbsp;<span class="op" id="3086661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086664">t</span><span class="op" id="3086665">,</span>&nbsp;<span class="ident" id="3086667">ok</span>&nbsp;<span class="op" id="3086670">:=</span>&nbsp;<span class="ident" id="3086673">e</span><span class="op" id="3086674">.</span><span class="ident" id="3086675">Err</span><span class="op" id="3086678">.</span><span class="op" id="3086679">(</span><span class="ident" id="3086680">timeout</span><span class="op" id="3086687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3086690">return</span>&nbsp;<span class="ident" id="3086697">ok</span>&nbsp;<span class="op" id="3086700">&amp;&amp;</span>&nbsp;<span class="ident" id="3086703">t</span><span class="op" id="3086704">.</span><span class="ident" id="3086705">Timeout</span><span class="op" id="3086712">(</span><span class="op" id="3086713">)</span><br>
<span class="lineno">340</span><span class="op" id="3086715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086718">type</span>&nbsp;<span class="ident" id="3086723">timeoutError</span>&nbsp;<span class="keyword" id="3086736">struct</span><span class="op" id="3086742">{</span><span class="op" id="3086743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086746">func</span>&nbsp;<span class="op" id="3086751">(</span><span class="ident" id="3086752">e</span>&nbsp;<span class="op" id="3086754">*</span><span class="ident" id="3086755">timeoutError</span><span class="op" id="3086767">)</span>&nbsp;<span class="ident" id="3086769">Error</span><span class="op" id="3086774">(</span><span class="op" id="3086775">)</span>&nbsp;<span class="builtintype" id="3086777">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3086786">{</span>&nbsp;<span class="keyword" id="3086788">return</span>&nbsp;<span class="string" id="3086795">&#34;i/o&nbsp;timeout&#34;</span>&nbsp;<span class="op" id="3086809">}</span><br>
<span class="lineno">345</span><span class="keyword" id="3086811">func</span>&nbsp;<span class="op" id="3086816">(</span><span class="ident" id="3086817">e</span>&nbsp;<span class="op" id="3086819">*</span><span class="ident" id="3086820">timeoutError</span><span class="op" id="3086832">)</span>&nbsp;<span class="ident" id="3086834">Timeout</span><span class="op" id="3086841">(</span><span class="op" id="3086842">)</span>&nbsp;<span class="builtintype" id="3086844">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3086851">{</span>&nbsp;<span class="keyword" id="3086853">return</span>&nbsp;<span class="builtintype" id="3086860">true</span>&nbsp;<span class="op" id="3086865">}</span><br>
<span class="lineno"></span><span class="keyword" id="3086867">func</span>&nbsp;<span class="op" id="3086872">(</span><span class="ident" id="3086873">e</span>&nbsp;<span class="op" id="3086875">*</span><span class="ident" id="3086876">timeoutError</span><span class="op" id="3086888">)</span>&nbsp;<span class="ident" id="3086890">Temporary</span><span class="op" id="3086899">(</span><span class="op" id="3086900">)</span>&nbsp;<span class="builtintype" id="3086902">bool</span>&nbsp;<span class="op" id="3086907">{</span>&nbsp;<span class="keyword" id="3086909">return</span>&nbsp;<span class="builtintype" id="3086916">true</span>&nbsp;<span class="op" id="3086921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086924">type</span>&nbsp;<span class="ident" id="3086929">AddrError</span>&nbsp;<span class="keyword" id="3086939">struct</span>&nbsp;<span class="op" id="3086946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086949">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3086954">string</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3086962">Addr</span>&nbsp;<span class="builtintype" id="3086967">string</span><br>
<span class="lineno"></span><span class="op" id="3086974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086977">func</span>&nbsp;<span class="op" id="3086982">(</span><span class="ident" id="3086983">e</span>&nbsp;<span class="op" id="3086985">*</span><span class="ident" id="3086986">AddrError</span><span class="op" id="3086995">)</span>&nbsp;<span class="ident" id="3086997">Error</span><span class="op" id="3087002">(</span><span class="op" id="3087003">)</span>&nbsp;<span class="builtintype" id="3087005">string</span>&nbsp;<span class="op" id="3087012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3087015">if</span>&nbsp;<span class="ident" id="3087018">e</span>&nbsp;<span class="op" id="3087020">==</span>&nbsp;<span class="ident" id="3087023">nil</span>&nbsp;<span class="op" id="3087027">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3087031">return</span>&nbsp;<span class="string" id="3087038">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3087047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3087050">s</span>&nbsp;<span class="op" id="3087052">:=</span>&nbsp;<span class="ident" id="3087055">e</span><span class="op" id="3087056">.</span><span class="ident" id="3087057">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3087062">if</span>&nbsp;<span class="ident" id="3087065">e</span><span class="op" id="3087066">.</span><span class="ident" id="3087067">Addr</span>&nbsp;<span class="op" id="3087072">!=</span>&nbsp;<span class="string" id="3087075">&#34;&#34;</span>&nbsp;<span class="op" id="3087078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3087082">s</span>&nbsp;<span class="op" id="3087084">+=</span>&nbsp;<span class="string" id="3087087">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3087091">+</span>&nbsp;<span class="ident" id="3087093">e</span><span class="op" id="3087094">.</span><span class="ident" id="3087095">Addr</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3087101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3087104">return</span>&nbsp;<span class="ident" id="3087111">s</span><br>
<span class="lineno"></span><span class="op" id="3087113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087116">func</span>&nbsp;<span class="op" id="3087121">(</span><span class="ident" id="3087122">e</span>&nbsp;<span class="op" id="3087124">*</span><span class="ident" id="3087125">AddrError</span><span class="op" id="3087134">)</span>&nbsp;<span class="ident" id="3087136">Temporary</span><span class="op" id="3087145">(</span><span class="op" id="3087146">)</span>&nbsp;<span class="builtintype" id="3087148">bool</span>&nbsp;<span class="op" id="3087153">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3087156">return</span>&nbsp;<span class="builtintype" id="3087163">false</span><br>
<span class="lineno"></span><span class="op" id="3087169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087172">func</span>&nbsp;<span class="op" id="3087177">(</span><span class="ident" id="3087178">e</span>&nbsp;<span class="op" id="3087180">*</span><span class="ident" id="3087181">AddrError</span><span class="op" id="3087190">)</span>&nbsp;<span class="ident" id="3087192">Timeout</span><span class="op" id="3087199">(</span><span class="op" id="3087200">)</span>&nbsp;<span class="builtintype" id="3087202">bool</span>&nbsp;<span class="op" id="3087207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3087210">return</span>&nbsp;<span class="builtintype" id="3087217">false</span><br>
<span class="lineno">370</span><span class="op" id="3087223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087226">type</span>&nbsp;<span class="ident" id="3087231">UnknownNetworkError</span>&nbsp;<span class="builtintype" id="3087251">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087259">func</span>&nbsp;<span class="op" id="3087264">(</span><span class="ident" id="3087265">e</span>&nbsp;<span class="ident" id="3087267">UnknownNetworkError</span><span class="op" id="3087286">)</span>&nbsp;<span class="ident" id="3087288">Error</span><span class="op" id="3087293">(</span><span class="op" id="3087294">)</span>&nbsp;<span class="builtintype" id="3087296">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3087305">{</span>&nbsp;<span class="keyword" id="3087307">return</span>&nbsp;<span class="string" id="3087314">&#34;unknown&nbsp;network&nbsp;&#34;</span>&nbsp;<span class="op" id="3087333">+</span>&nbsp;<span class="builtintype" id="3087335">string</span><span class="op" id="3087341">(</span><span class="ident" id="3087342">e</span><span class="op" id="3087343">)</span>&nbsp;<span class="op" id="3087345">}</span><br>
<span class="lineno">375</span><span class="keyword" id="3087347">func</span>&nbsp;<span class="op" id="3087352">(</span><span class="ident" id="3087353">e</span>&nbsp;<span class="ident" id="3087355">UnknownNetworkError</span><span class="op" id="3087374">)</span>&nbsp;<span class="ident" id="3087376">Temporary</span><span class="op" id="3087385">(</span><span class="op" id="3087386">)</span>&nbsp;<span class="builtintype" id="3087388">bool</span>&nbsp;<span class="op" id="3087393">{</span>&nbsp;<span class="keyword" id="3087395">return</span>&nbsp;<span class="builtintype" id="3087402">false</span>&nbsp;<span class="op" id="3087408">}</span><br>
<span class="lineno"></span><span class="keyword" id="3087410">func</span>&nbsp;<span class="op" id="3087415">(</span><span class="ident" id="3087416">e</span>&nbsp;<span class="ident" id="3087418">UnknownNetworkError</span><span class="op" id="3087437">)</span>&nbsp;<span class="ident" id="3087439">Timeout</span><span class="op" id="3087446">(</span><span class="op" id="3087447">)</span>&nbsp;<span class="builtintype" id="3087449">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3087456">{</span>&nbsp;<span class="keyword" id="3087458">return</span>&nbsp;<span class="builtintype" id="3087465">false</span>&nbsp;<span class="op" id="3087471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087474">type</span>&nbsp;<span class="ident" id="3087479">InvalidAddrError</span>&nbsp;<span class="builtintype" id="3087496">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="3087504">func</span>&nbsp;<span class="op" id="3087509">(</span><span class="ident" id="3087510">e</span>&nbsp;<span class="ident" id="3087512">InvalidAddrError</span><span class="op" id="3087528">)</span>&nbsp;<span class="ident" id="3087530">Error</span><span class="op" id="3087535">(</span><span class="op" id="3087536">)</span>&nbsp;<span class="builtintype" id="3087538">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3087547">{</span>&nbsp;<span class="keyword" id="3087549">return</span>&nbsp;<span class="builtintype" id="3087556">string</span><span class="op" id="3087562">(</span><span class="ident" id="3087563">e</span><span class="op" id="3087564">)</span>&nbsp;<span class="op" id="3087566">}</span><br>
<span class="lineno"></span><span class="keyword" id="3087568">func</span>&nbsp;<span class="op" id="3087573">(</span><span class="ident" id="3087574">e</span>&nbsp;<span class="ident" id="3087576">InvalidAddrError</span><span class="op" id="3087592">)</span>&nbsp;<span class="ident" id="3087594">Timeout</span><span class="op" id="3087601">(</span><span class="op" id="3087602">)</span>&nbsp;<span class="builtintype" id="3087604">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3087611">{</span>&nbsp;<span class="keyword" id="3087613">return</span>&nbsp;<span class="builtintype" id="3087620">false</span>&nbsp;<span class="op" id="3087626">}</span><br>
<span class="lineno"></span><span class="keyword" id="3087628">func</span>&nbsp;<span class="op" id="3087633">(</span><span class="ident" id="3087634">e</span>&nbsp;<span class="ident" id="3087636">InvalidAddrError</span><span class="op" id="3087652">)</span>&nbsp;<span class="ident" id="3087654">Temporary</span><span class="op" id="3087663">(</span><span class="op" id="3087664">)</span>&nbsp;<span class="builtintype" id="3087666">bool</span>&nbsp;<span class="op" id="3087671">{</span>&nbsp;<span class="keyword" id="3087673">return</span>&nbsp;<span class="builtintype" id="3087680">false</span>&nbsp;<span class="op" id="3087686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3087689">//&nbsp;DNSConfigError&nbsp;represents&nbsp;an&nbsp;error&nbsp;reading&nbsp;the&nbsp;machine&#39;s&nbsp;DNS&nbsp;configuration.</span><br>
<span class="lineno">385</span><span class="keyword" id="3087768">type</span>&nbsp;<span class="ident" id="3087773">DNSConfigError</span>&nbsp;<span class="keyword" id="3087788">struct</span>&nbsp;<span class="op" id="3087795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3087798">Err</span>&nbsp;<span class="builtintype" id="3087802">error</span><br>
<span class="lineno"></span><span class="op" id="3087808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087811">func</span>&nbsp;<span class="op" id="3087816">(</span><span class="ident" id="3087817">e</span>&nbsp;<span class="op" id="3087819">*</span><span class="ident" id="3087820">DNSConfigError</span><span class="op" id="3087834">)</span>&nbsp;<span class="ident" id="3087836">Error</span><span class="op" id="3087841">(</span><span class="op" id="3087842">)</span>&nbsp;<span class="builtintype" id="3087844">string</span>&nbsp;<span class="op" id="3087851">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3087854">return</span>&nbsp;<span class="string" id="3087861">&#34;error&nbsp;reading&nbsp;DNS&nbsp;config:&nbsp;&#34;</span>&nbsp;<span class="op" id="3087890">+</span>&nbsp;<span class="ident" id="3087892">e</span><span class="op" id="3087893">.</span><span class="ident" id="3087894">Err</span><span class="op" id="3087897">.</span><span class="ident" id="3087898">Error</span><span class="op" id="3087903">(</span><span class="op" id="3087904">)</span><br>
<span class="lineno"></span><span class="op" id="3087906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087909">func</span>&nbsp;<span class="op" id="3087914">(</span><span class="ident" id="3087915">e</span>&nbsp;<span class="op" id="3087917">*</span><span class="ident" id="3087918">DNSConfigError</span><span class="op" id="3087932">)</span>&nbsp;<span class="ident" id="3087934">Timeout</span><span class="op" id="3087941">(</span><span class="op" id="3087942">)</span>&nbsp;<span class="builtintype" id="3087944">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3087951">{</span>&nbsp;<span class="keyword" id="3087953">return</span>&nbsp;<span class="builtintype" id="3087960">false</span>&nbsp;<span class="op" id="3087966">}</span><br>
<span class="lineno"></span><span class="keyword" id="3087968">func</span>&nbsp;<span class="op" id="3087973">(</span><span class="ident" id="3087974">e</span>&nbsp;<span class="op" id="3087976">*</span><span class="ident" id="3087977">DNSConfigError</span><span class="op" id="3087991">)</span>&nbsp;<span class="ident" id="3087993">Temporary</span><span class="op" id="3088002">(</span><span class="op" id="3088003">)</span>&nbsp;<span class="builtintype" id="3088005">bool</span>&nbsp;<span class="op" id="3088010">{</span>&nbsp;<span class="keyword" id="3088012">return</span>&nbsp;<span class="builtintype" id="3088019">false</span>&nbsp;<span class="op" id="3088025">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="3088028">type</span>&nbsp;<span class="ident" id="3088033">writerOnly</span>&nbsp;<span class="keyword" id="3088044">struct</span>&nbsp;<span class="op" id="3088051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3088054">io</span><span class="op" id="3088056">.</span><span class="ident" id="3088057">Writer</span><br>
<span class="lineno"></span><span class="op" id="3088064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="3088067">//&nbsp;Fallback&nbsp;implementation&nbsp;of&nbsp;io.ReaderFrom&#39;s&nbsp;ReadFrom,&nbsp;when&nbsp;sendfile&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="3088143">//&nbsp;applicable.</span><br>
<span class="lineno"></span><span class="keyword" id="3088158">func</span>&nbsp;<span class="ident" id="3088163">genericReadFrom</span><span class="op" id="3088178">(</span><span class="ident" id="3088179">w</span>&nbsp;<span class="ident" id="3088181">io</span><span class="op" id="3088183">.</span><span class="ident" id="3088184">Writer</span><span class="op" id="3088190">,</span>&nbsp;<span class="ident" id="3088192">r</span>&nbsp;<span class="ident" id="3088194">io</span><span class="op" id="3088196">.</span><span class="ident" id="3088197">Reader</span><span class="op" id="3088203">)</span>&nbsp;<span class="op" id="3088205">(</span><span class="ident" id="3088206">n</span>&nbsp;<span class="ident" id="3088208">int64</span><span class="op" id="3088213">,</span>&nbsp;<span class="ident" id="3088215">err</span>&nbsp;<span class="builtintype" id="3088219">error</span><span class="op" id="3088224">)</span>&nbsp;<span class="op" id="3088226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3088229">//&nbsp;Use&nbsp;wrapper&nbsp;to&nbsp;hide&nbsp;existing&nbsp;r.ReadFrom&nbsp;from&nbsp;io.Copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3088287">return</span>&nbsp;<span class="ident" id="3088294">io</span><span class="op" id="3088296">.</span><span class="ident" id="3088297">Copy</span><span class="op" id="3088301">(</span><span class="ident" id="3088302">writerOnly</span><span class="op" id="3088312">{</span><span class="ident" id="3088313">w</span><span class="op" id="3088314">}</span><span class="op" id="3088315">,</span>&nbsp;<span class="ident" id="3088317">r</span><span class="op" id="3088318">)</span><br>
<span class="lineno">405</span><span class="op" id="3088320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3088323">//&nbsp;Limit&nbsp;the&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;cgo-using&nbsp;goroutines,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3088387">//&nbsp;each&nbsp;will&nbsp;block&nbsp;an&nbsp;entire&nbsp;operating&nbsp;system&nbsp;thread.&nbsp;The&nbsp;usual&nbsp;culprit</span><br>
<span class="lineno"></span><span class="comment" id="3088459">//&nbsp;is&nbsp;resolving&nbsp;many&nbsp;DNS&nbsp;names&nbsp;in&nbsp;separate&nbsp;goroutines&nbsp;but&nbsp;the&nbsp;DNS</span><br>
<span class="lineno">410</span><span class="comment" id="3088525">//&nbsp;server&nbsp;is&nbsp;not&nbsp;responding.&nbsp;Then&nbsp;the&nbsp;many&nbsp;lookups&nbsp;each&nbsp;use&nbsp;a&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3088597">//&nbsp;thread,&nbsp;and&nbsp;the&nbsp;system&nbsp;or&nbsp;the&nbsp;program&nbsp;runs&nbsp;out&nbsp;of&nbsp;threads.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3088660">var</span>&nbsp;<span class="ident" id="3088664">threadLimit</span>&nbsp;<span class="op" id="3088676">=</span>&nbsp;<span class="builtinfunc" id="3088678">make</span><span class="op" id="3088682">(</span><span class="keyword" id="3088683">chan</span>&nbsp;<span class="keyword" id="3088688">struct</span><span class="op" id="3088694">{</span><span class="op" id="3088695">}</span><span class="op" id="3088696">,</span>&nbsp;<span class="num" id="3088698">500</span><span class="op" id="3088701">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="comment" id="3088704">//&nbsp;Using&nbsp;send&nbsp;for&nbsp;acquire&nbsp;is&nbsp;fine&nbsp;here&nbsp;because&nbsp;we&nbsp;are&nbsp;not&nbsp;using&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="3088773">//&nbsp;to&nbsp;protect&nbsp;any&nbsp;memory.&nbsp;All&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="3088845">//&nbsp;making&nbsp;calls&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3088873">func</span>&nbsp;<span class="ident" id="3088878">acquireThread</span><span class="op" id="3088891">(</span><span class="op" id="3088892">)</span>&nbsp;<span class="op" id="3088894">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3088897">threadLimit</span>&nbsp;<span class="op" id="3088909">&lt;-</span>&nbsp;<span class="keyword" id="3088912">struct</span><span class="op" id="3088918">{</span><span class="op" id="3088919">}</span><span class="op" id="3088920">{</span><span class="op" id="3088921">}</span><br>
<span class="lineno"></span><span class="op" id="3088923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3088926">func</span>&nbsp;<span class="ident" id="3088931">releaseThread</span><span class="op" id="3088944">(</span><span class="op" id="3088945">)</span>&nbsp;<span class="op" id="3088947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3088950">&lt;-</span><span class="ident" id="3088952">threadLimit</span><br>
<span class="lineno">425</span><span class="op" id="3088964">}</span>
</div>
</body>
</html>
