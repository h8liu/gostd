<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6314671">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6314726">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6314780">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6314831">/*<br>
<span class="lineno"></span>Package&nbsp;mail&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;mail&nbsp;messages.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>For&nbsp;the&nbsp;most&nbsp;part,&nbsp;this&nbsp;package&nbsp;follows&nbsp;the&nbsp;syntax&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;5322.<br>
<span class="lineno"></span>Notable&nbsp;divergences:<br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;Obsolete&nbsp;address&nbsp;formats&nbsp;are&nbsp;not&nbsp;parsed,&nbsp;including&nbsp;addresses&nbsp;with<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;embedded&nbsp;route&nbsp;information.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;Group&nbsp;addresses&nbsp;are&nbsp;not&nbsp;parsed.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;The&nbsp;full&nbsp;range&nbsp;of&nbsp;spacing&nbsp;(the&nbsp;CFWS&nbsp;syntax&nbsp;element)&nbsp;is&nbsp;not&nbsp;supported,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;such&nbsp;as&nbsp;breaking&nbsp;addresses&nbsp;across&nbsp;lines.<br>
<span class="lineno">15</span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="6315238">package</span>&nbsp;<span class="ident" id="6315246">mail</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6315252">import</span>&nbsp;<span class="op" id="6315259">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315262">&#34;bufio&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315271">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315280">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315299">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315309">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315316">&#34;io&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315322">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315335">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315342">&#34;net/textproto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315359">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315370">&#34;strings&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315381">&#34;time&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6315389">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="6315399">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6315402">var</span>&nbsp;<span class="ident" id="6315406">debug</span>&nbsp;<span class="op" id="6315412">=</span>&nbsp;<span class="ident" id="6315414"><a href="/net/mail/message.go.html#6315434">debugT</a></span><span class="op" id="6315420">(</span><span class="builtintype" id="6315421">false</span><span class="op" id="6315426">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6315429">type</span>&nbsp;<span class="ident" id="6315434">debugT</span>&nbsp;<span class="builtintype" id="6315441">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6315447">func</span>&nbsp;<span class="op" id="6315452">(</span><span class="ident" id="6315453">d</span>&nbsp;<span class="ident" id="6315455"><a href="/net/mail/message.go.html#6315434">debugT</a></span><span class="op" id="6315461">)</span>&nbsp;<span class="ident" id="6315463">Printf</span><span class="op" id="6315469">(</span><span class="ident" id="6315470">format</span>&nbsp;<span class="builtintype" id="6315477">string</span><span class="op" id="6315483">,</span>&nbsp;<span class="ident" id="6315485">args</span>&nbsp;<span class="op" id="6315490">...</span><span class="keyword" id="6315493">interface</span><span class="op" id="6315502">{</span><span class="op" id="6315503">}</span><span class="op" id="6315504">)</span>&nbsp;<span class="op" id="6315506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6315509">if</span>&nbsp;<span class="ident" id="6315512"><a href="/net/mail/message.go.html#6315453">d</a></span>&nbsp;<span class="op" id="6315514">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6315518"><a href="/net/mail/message.go.html#6315335">log</a></span><span class="op" id="6315521">.</span><span class="ident" id="6315522">Printf</span><span class="op" id="6315528">(</span><span class="ident" id="6315529"><a href="/net/mail/message.go.html#6315470">format</a></span><span class="op" id="6315535">,</span>&nbsp;<span class="ident" id="6315537"><a href="/net/mail/message.go.html#6315485">args</a></span><span class="op" id="6315541">...</span><span class="op" id="6315544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6315547">}</span><br>
<span class="lineno"></span><span class="op" id="6315549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6315552">//&nbsp;A&nbsp;Message&nbsp;represents&nbsp;a&nbsp;parsed&nbsp;mail&nbsp;message.</span><br>
<span class="lineno">45</span><span class="keyword" id="6315599">type</span>&nbsp;<span class="ident" id="6315604">Message</span>&nbsp;<span class="keyword" id="6315612">struct</span>&nbsp;<span class="op" id="6315619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6315622">Header</span>&nbsp;<span class="ident" id="6315629"><a href="/net/mail/message.go.html#6317188">Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6315637">Body</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6315644"><a href="/net/mail/message.go.html#6315316">io</a></span><span class="op" id="6315646">.</span><span class="ident" id="6315647">Reader</span><br>
<span class="lineno"></span><span class="op" id="6315654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="6315657">//&nbsp;ReadMessage&nbsp;reads&nbsp;a&nbsp;message&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6315696">//&nbsp;The&nbsp;headers&nbsp;are&nbsp;parsed,&nbsp;and&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;message&nbsp;will&nbsp;be&nbsp;available</span><br>
<span class="lineno"></span><span class="comment" id="6315769">//&nbsp;for&nbsp;reading&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="6315792">func</span>&nbsp;<span class="ident" id="6315797">ReadMessage</span><span class="op" id="6315808">(</span><span class="ident" id="6315809">r</span>&nbsp;<span class="ident" id="6315811"><a href="/net/mail/message.go.html#6315316">io</a></span><span class="op" id="6315813">.</span><span class="ident" id="6315814">Reader</span><span class="op" id="6315820">)</span>&nbsp;<span class="op" id="6315822">(</span><span class="ident" id="6315823">msg</span>&nbsp;<span class="op" id="6315827">*</span><span class="ident" id="6315828"><a href="/net/mail/message.go.html#6315604">Message</a></span><span class="op" id="6315835">,</span>&nbsp;<span class="ident" id="6315837">err</span>&nbsp;<span class="builtintype" id="6315841">error</span><span class="op" id="6315846">)</span>&nbsp;<span class="op" id="6315848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6315851">tp</span>&nbsp;<span class="op" id="6315854">:=</span>&nbsp;<span class="ident" id="6315857"><a href="/net/mail/message.go.html#6315342">textproto</a></span><span class="op" id="6315866">.</span><span class="ident" id="6315867">NewReader</span><span class="op" id="6315876">(</span><span class="ident" id="6315877"><a href="/net/mail/message.go.html#6315262">bufio</a></span><span class="op" id="6315882">.</span><span class="ident" id="6315883">NewReader</span><span class="op" id="6315892">(</span><span class="ident" id="6315893"><a href="/net/mail/message.go.html#6315809">r</a></span><span class="op" id="6315894">)</span><span class="op" id="6315895">)</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6315899">hdr</span><span class="op" id="6315902">,</span>&nbsp;<span class="ident" id="6315904"><a href="/net/mail/message.go.html#6315837">err</a></span>&nbsp;<span class="op" id="6315908">:=</span>&nbsp;<span class="ident" id="6315911"><a href="/net/mail/message.go.html#6315851">tp</a></span><span class="op" id="6315913">.</span><span class="ident" id="6315914">ReadMIMEHeader</span><span class="op" id="6315928">(</span><span class="op" id="6315929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6315932">if</span>&nbsp;<span class="ident" id="6315935"><a href="/net/mail/message.go.html#6315837">err</a></span>&nbsp;<span class="op" id="6315939">!=</span>&nbsp;<span class="ident" id="6315942">nil</span>&nbsp;<span class="op" id="6315946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6315950">return</span>&nbsp;<span class="ident" id="6315957">nil</span><span class="op" id="6315960">,</span>&nbsp;<span class="ident" id="6315962"><a href="/net/mail/message.go.html#6315837">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6315967">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6315971">return</span>&nbsp;<span class="op" id="6315978">&amp;</span><span class="ident" id="6315979"><a href="/net/mail/message.go.html#6315604">Message</a></span><span class="op" id="6315986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6315990">Header</span><span class="op" id="6315996">:</span>&nbsp;<span class="ident" id="6315998"><a href="/net/mail/message.go.html#6317188">Header</a></span><span class="op" id="6316004">(</span><span class="ident" id="6316005"><a href="/net/mail/message.go.html#6315899">hdr</a></span><span class="op" id="6316008">)</span><span class="op" id="6316009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316013">Body</span><span class="op" id="6316017">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6316021"><a href="/net/mail/message.go.html#6315851">tp</a></span><span class="op" id="6316023">.</span><span class="ident" id="6316024">R</span><span class="op" id="6316025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6316028">}</span><span class="op" id="6316029">,</span>&nbsp;<span class="ident" id="6316031">nil</span><br>
<span class="lineno">65</span><span class="op" id="6316035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6316038">//&nbsp;Layouts&nbsp;suitable&nbsp;for&nbsp;passing&nbsp;to&nbsp;time.Parse.</span><br>
<span class="lineno"></span><span class="comment" id="6316085">//&nbsp;These&nbsp;are&nbsp;tried&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><span class="keyword" id="6316114">var</span>&nbsp;<span class="ident" id="6316118">dateLayouts</span>&nbsp;<span class="op" id="6316130">[</span><span class="op" id="6316131">]</span><span class="builtintype" id="6316132">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6316140">func</span>&nbsp;<span class="ident" id="6316145">init</span><span class="op" id="6316149">(</span><span class="op" id="6316150">)</span>&nbsp;<span class="op" id="6316152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6316155">//&nbsp;Generate&nbsp;layouts&nbsp;based&nbsp;on&nbsp;RFC&nbsp;5322,&nbsp;section&nbsp;3.3.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316209">dows</span>&nbsp;<span class="op" id="6316214">:=</span>&nbsp;<span class="op" id="6316217">[</span><span class="op" id="6316218">...</span><span class="op" id="6316221">]</span><span class="builtintype" id="6316222">string</span><span class="op" id="6316228">{</span><span class="string" id="6316229">&#34;&#34;</span><span class="op" id="6316231">,</span>&nbsp;<span class="string" id="6316233">&#34;Mon,&nbsp;&#34;</span><span class="op" id="6316240">}</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6316244">//&nbsp;day-of-week</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316260">days</span>&nbsp;<span class="op" id="6316265">:=</span>&nbsp;<span class="op" id="6316268">[</span><span class="op" id="6316269">...</span><span class="op" id="6316272">]</span><span class="builtintype" id="6316273">string</span><span class="op" id="6316279">{</span><span class="string" id="6316280">&#34;2&#34;</span><span class="op" id="6316283">,</span>&nbsp;<span class="string" id="6316285">&#34;02&#34;</span><span class="op" id="6316289">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6316295">//&nbsp;day&nbsp;=&nbsp;1*2DIGIT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316314">years</span>&nbsp;<span class="op" id="6316320">:=</span>&nbsp;<span class="op" id="6316323">[</span><span class="op" id="6316324">...</span><span class="op" id="6316327">]</span><span class="builtintype" id="6316328">string</span><span class="op" id="6316334">{</span><span class="string" id="6316335">&#34;2006&#34;</span><span class="op" id="6316341">,</span>&nbsp;<span class="string" id="6316343">&#34;06&#34;</span><span class="op" id="6316347">}</span>&nbsp;<span class="comment" id="6316349">//&nbsp;year&nbsp;=&nbsp;4*DIGIT&nbsp;/&nbsp;2*DIGIT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316378">seconds</span>&nbsp;<span class="op" id="6316386">:=</span>&nbsp;<span class="op" id="6316389">[</span><span class="op" id="6316390">...</span><span class="op" id="6316393">]</span><span class="builtintype" id="6316394">string</span><span class="op" id="6316400">{</span><span class="string" id="6316401">&#34;:05&#34;</span><span class="op" id="6316406">,</span>&nbsp;<span class="string" id="6316408">&#34;&#34;</span><span class="op" id="6316410">}</span>&nbsp;&nbsp;<span class="comment" id="6316413">//&nbsp;second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6316424">//&nbsp;&#34;-0700&nbsp;(MST)&#34;&nbsp;is&nbsp;not&nbsp;in&nbsp;RFC&nbsp;5322,&nbsp;but&nbsp;is&nbsp;common.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316477">zones</span>&nbsp;<span class="op" id="6316483">:=</span>&nbsp;<span class="op" id="6316486">[</span><span class="op" id="6316487">...</span><span class="op" id="6316490">]</span><span class="builtintype" id="6316491">string</span><span class="op" id="6316497">{</span><span class="string" id="6316498">&#34;-0700&#34;</span><span class="op" id="6316505">,</span>&nbsp;<span class="string" id="6316507">&#34;MST&#34;</span><span class="op" id="6316512">,</span>&nbsp;<span class="string" id="6316514">&#34;-0700&nbsp;(MST)&#34;</span><span class="op" id="6316527">}</span>&nbsp;<span class="comment" id="6316529">//&nbsp;zone&nbsp;=&nbsp;((&#34;+&#34;&nbsp;/&nbsp;&#34;-&#34;)&nbsp;4DIGIT)&nbsp;/&nbsp;&#34;GMT&#34;&nbsp;/&nbsp;...</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6316576">for</span>&nbsp;<span class="ident" id="6316580">_</span><span class="op" id="6316581">,</span>&nbsp;<span class="ident" id="6316583">dow</span>&nbsp;<span class="op" id="6316587">:=</span>&nbsp;<span class="keyword" id="6316590">range</span>&nbsp;<span class="ident" id="6316596"><a href="/net/mail/message.go.html#6316209">dows</a></span>&nbsp;<span class="op" id="6316601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6316605">for</span>&nbsp;<span class="ident" id="6316609">_</span><span class="op" id="6316610">,</span>&nbsp;<span class="ident" id="6316612">day</span>&nbsp;<span class="op" id="6316616">:=</span>&nbsp;<span class="keyword" id="6316619">range</span>&nbsp;<span class="ident" id="6316625"><a href="/net/mail/message.go.html#6316260">days</a></span>&nbsp;<span class="op" id="6316630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6316635">for</span>&nbsp;<span class="ident" id="6316639">_</span><span class="op" id="6316640">,</span>&nbsp;<span class="ident" id="6316642">year</span>&nbsp;<span class="op" id="6316647">:=</span>&nbsp;<span class="keyword" id="6316650">range</span>&nbsp;<span class="ident" id="6316656"><a href="/net/mail/message.go.html#6316314">years</a></span>&nbsp;<span class="op" id="6316662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6316668">for</span>&nbsp;<span class="ident" id="6316672">_</span><span class="op" id="6316673">,</span>&nbsp;<span class="ident" id="6316675">second</span>&nbsp;<span class="op" id="6316682">:=</span>&nbsp;<span class="keyword" id="6316685">range</span>&nbsp;<span class="ident" id="6316691"><a href="/net/mail/message.go.html#6316378">seconds</a></span>&nbsp;<span class="op" id="6316699">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6316706">for</span>&nbsp;<span class="ident" id="6316710">_</span><span class="op" id="6316711">,</span>&nbsp;<span class="ident" id="6316713">zone</span>&nbsp;<span class="op" id="6316718">:=</span>&nbsp;<span class="keyword" id="6316721">range</span>&nbsp;<span class="ident" id="6316727"><a href="/net/mail/message.go.html#6316477">zones</a></span>&nbsp;<span class="op" id="6316733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316741">s</span>&nbsp;<span class="op" id="6316743">:=</span>&nbsp;<span class="ident" id="6316746"><a href="/net/mail/message.go.html#6316583">dow</a></span>&nbsp;<span class="op" id="6316750">+</span>&nbsp;<span class="ident" id="6316752"><a href="/net/mail/message.go.html#6316612">day</a></span>&nbsp;<span class="op" id="6316756">+</span>&nbsp;<span class="string" id="6316758">&#34;&nbsp;Jan&nbsp;&#34;</span>&nbsp;<span class="op" id="6316766">+</span>&nbsp;<span class="ident" id="6316768"><a href="/net/mail/message.go.html#6316642">year</a></span>&nbsp;<span class="op" id="6316773">+</span>&nbsp;<span class="string" id="6316775">&#34;&nbsp;15:04&#34;</span>&nbsp;<span class="op" id="6316784">+</span>&nbsp;<span class="ident" id="6316786"><a href="/net/mail/message.go.html#6316675">second</a></span>&nbsp;<span class="op" id="6316793">+</span>&nbsp;<span class="string" id="6316795">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6316799">+</span>&nbsp;<span class="ident" id="6316801"><a href="/net/mail/message.go.html#6316713">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316812"><a href="/net/mail/message.go.html#6316118">dateLayouts</a></span>&nbsp;<span class="op" id="6316824">=</span>&nbsp;<span class="builtinfunc" id="6316826">append</span><span class="op" id="6316832">(</span><span class="ident" id="6316833"><a href="/net/mail/message.go.html#6316118">dateLayouts</a></span><span class="op" id="6316844">,</span>&nbsp;<span class="ident" id="6316846"><a href="/net/mail/message.go.html#6316741">s</a></span><span class="op" id="6316847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6316854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6316860">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6316865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6316869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6316872">}</span><br>
<span class="lineno"></span><span class="op" id="6316874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6316877">func</span>&nbsp;<span class="ident" id="6316882">parseDate</span><span class="op" id="6316891">(</span><span class="ident" id="6316892">date</span>&nbsp;<span class="builtintype" id="6316897">string</span><span class="op" id="6316903">)</span>&nbsp;<span class="op" id="6316905">(</span><span class="ident" id="6316906"><a href="/net/mail/message.go.html#6315381">time</a></span><span class="op" id="6316910">.</span><span class="ident" id="6316911">Time</span><span class="op" id="6316915">,</span>&nbsp;<span class="builtintype" id="6316917">error</span><span class="op" id="6316922">)</span>&nbsp;<span class="op" id="6316924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6316927">for</span>&nbsp;<span class="ident" id="6316931">_</span><span class="op" id="6316932">,</span>&nbsp;<span class="ident" id="6316934">layout</span>&nbsp;<span class="op" id="6316941">:=</span>&nbsp;<span class="keyword" id="6316944">range</span>&nbsp;<span class="ident" id="6316950"><a href="/net/mail/message.go.html#6316118">dateLayouts</a></span>&nbsp;<span class="op" id="6316962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6316966">t</span><span class="op" id="6316967">,</span>&nbsp;<span class="ident" id="6316969">err</span>&nbsp;<span class="op" id="6316973">:=</span>&nbsp;<span class="ident" id="6316976"><a href="/net/mail/message.go.html#6315381">time</a></span><span class="op" id="6316980">.</span><span class="ident" id="6316981">Parse</span><span class="op" id="6316986">(</span><span class="ident" id="6316987"><a href="/net/mail/message.go.html#6316934">layout</a></span><span class="op" id="6316993">,</span>&nbsp;<span class="ident" id="6316995"><a href="/net/mail/message.go.html#6316892">date</a></span><span class="op" id="6316999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317003">if</span>&nbsp;<span class="ident" id="6317006"><a href="/net/mail/message.go.html#6316969">err</a></span>&nbsp;<span class="op" id="6317010">==</span>&nbsp;<span class="ident" id="6317013">nil</span>&nbsp;<span class="op" id="6317017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317022">return</span>&nbsp;<span class="ident" id="6317029"><a href="/net/mail/message.go.html#6316966">t</a></span><span class="op" id="6317030">,</span>&nbsp;<span class="ident" id="6317032">nil</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6317038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6317041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317044">return</span>&nbsp;<span class="ident" id="6317051"><a href="/net/mail/message.go.html#6315381">time</a></span><span class="op" id="6317055">.</span><span class="ident" id="6317056">Time</span><span class="op" id="6317060">{</span><span class="op" id="6317061">}</span><span class="op" id="6317062">,</span>&nbsp;<span class="ident" id="6317064"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6317070">.</span><span class="ident" id="6317071">New</span><span class="op" id="6317074">(</span><span class="string" id="6317075">&#34;mail:&nbsp;header&nbsp;could&nbsp;not&nbsp;be&nbsp;parsed&#34;</span><span class="op" id="6317109">)</span><br>
<span class="lineno"></span><span class="op" id="6317111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6317114">//&nbsp;A&nbsp;Header&nbsp;represents&nbsp;the&nbsp;key-value&nbsp;pairs&nbsp;in&nbsp;a&nbsp;mail&nbsp;message&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6317183">type</span>&nbsp;<span class="ident" id="6317188">Header</span>&nbsp;<span class="keyword" id="6317195">map</span><span class="op" id="6317198">[</span><span class="builtintype" id="6317199">string</span><span class="op" id="6317205">]</span><span class="op" id="6317206">[</span><span class="op" id="6317207">]</span><span class="builtintype" id="6317208">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6317216">//&nbsp;Get&nbsp;gets&nbsp;the&nbsp;first&nbsp;value&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="6317275">//&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;values&nbsp;associated&nbsp;with&nbsp;the&nbsp;key,&nbsp;Get&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno">110</span><span class="keyword" id="6317342">func</span>&nbsp;<span class="op" id="6317347">(</span><span class="ident" id="6317348">h</span>&nbsp;<span class="ident" id="6317350"><a href="/net/mail/message.go.html#6317188">Header</a></span><span class="op" id="6317356">)</span>&nbsp;<span class="ident" id="6317358">Get</span><span class="op" id="6317361">(</span><span class="ident" id="6317362">key</span>&nbsp;<span class="builtintype" id="6317366">string</span><span class="op" id="6317372">)</span>&nbsp;<span class="builtintype" id="6317374">string</span>&nbsp;<span class="op" id="6317381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317384">return</span>&nbsp;<span class="ident" id="6317391"><a href="/net/mail/message.go.html#6315342">textproto</a></span><span class="op" id="6317400">.</span><span class="ident" id="6317401">MIMEHeader</span><span class="op" id="6317411">(</span><span class="ident" id="6317412"><a href="/net/mail/message.go.html#6317348">h</a></span><span class="op" id="6317413">)</span><span class="op" id="6317414">.</span><span class="ident" id="6317415">Get</span><span class="op" id="6317418">(</span><span class="ident" id="6317419"><a href="/net/mail/message.go.html#6317362">key</a></span><span class="op" id="6317422">)</span><br>
<span class="lineno"></span><span class="op" id="6317424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6317427">var</span>&nbsp;<span class="ident" id="6317431">ErrHeaderNotPresent</span>&nbsp;<span class="op" id="6317451">=</span>&nbsp;<span class="ident" id="6317453"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6317459">.</span><span class="ident" id="6317460">New</span><span class="op" id="6317463">(</span><span class="string" id="6317464">&#34;mail:&nbsp;header&nbsp;not&nbsp;in&nbsp;message&#34;</span><span class="op" id="6317493">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="6317496">//&nbsp;Date&nbsp;parses&nbsp;the&nbsp;Date&nbsp;header&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="6317534">func</span>&nbsp;<span class="op" id="6317539">(</span><span class="ident" id="6317540">h</span>&nbsp;<span class="ident" id="6317542"><a href="/net/mail/message.go.html#6317188">Header</a></span><span class="op" id="6317548">)</span>&nbsp;<span class="ident" id="6317550">Date</span><span class="op" id="6317554">(</span><span class="op" id="6317555">)</span>&nbsp;<span class="op" id="6317557">(</span><span class="ident" id="6317558"><a href="/net/mail/message.go.html#6315381">time</a></span><span class="op" id="6317562">.</span><span class="ident" id="6317563">Time</span><span class="op" id="6317567">,</span>&nbsp;<span class="builtintype" id="6317569">error</span><span class="op" id="6317574">)</span>&nbsp;<span class="op" id="6317576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6317579">hdr</span>&nbsp;<span class="op" id="6317583">:=</span>&nbsp;<span class="ident" id="6317586"><a href="/net/mail/message.go.html#6317540">h</a></span><span class="op" id="6317587">.</span><span class="ident" id="6317588">Get</span><span class="op" id="6317591">(</span><span class="string" id="6317592">&#34;Date&#34;</span><span class="op" id="6317598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317601">if</span>&nbsp;<span class="ident" id="6317604"><a href="/net/mail/message.go.html#6317579">hdr</a></span>&nbsp;<span class="op" id="6317608">==</span>&nbsp;<span class="string" id="6317611">&#34;&#34;</span>&nbsp;<span class="op" id="6317614">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317618">return</span>&nbsp;<span class="ident" id="6317625"><a href="/net/mail/message.go.html#6315381">time</a></span><span class="op" id="6317629">.</span><span class="ident" id="6317630">Time</span><span class="op" id="6317634">{</span><span class="op" id="6317635">}</span><span class="op" id="6317636">,</span>&nbsp;<span class="ident" id="6317638"><a href="/net/mail/message.go.html#6317431">ErrHeaderNotPresent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6317659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317662">return</span>&nbsp;<span class="ident" id="6317669"><a href="/net/mail/message.go.html#6316882">parseDate</a></span><span class="op" id="6317678">(</span><span class="ident" id="6317679"><a href="/net/mail/message.go.html#6317579">hdr</a></span><span class="op" id="6317682">)</span><br>
<span class="lineno"></span><span class="op" id="6317684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6317687">//&nbsp;AddressList&nbsp;parses&nbsp;the&nbsp;named&nbsp;header&nbsp;field&nbsp;as&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="6317756">func</span>&nbsp;<span class="op" id="6317761">(</span><span class="ident" id="6317762">h</span>&nbsp;<span class="ident" id="6317764"><a href="/net/mail/message.go.html#6317188">Header</a></span><span class="op" id="6317770">)</span>&nbsp;<span class="ident" id="6317772">AddressList</span><span class="op" id="6317783">(</span><span class="ident" id="6317784">key</span>&nbsp;<span class="builtintype" id="6317788">string</span><span class="op" id="6317794">)</span>&nbsp;<span class="op" id="6317796">(</span><span class="op" id="6317797">[</span><span class="op" id="6317798">]</span><span class="op" id="6317799">*</span><span class="ident" id="6317800"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6317807">,</span>&nbsp;<span class="builtintype" id="6317809">error</span><span class="op" id="6317814">)</span>&nbsp;<span class="op" id="6317816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6317819">hdr</span>&nbsp;<span class="op" id="6317823">:=</span>&nbsp;<span class="ident" id="6317826"><a href="/net/mail/message.go.html#6317762">h</a></span><span class="op" id="6317827">.</span><span class="ident" id="6317828">Get</span><span class="op" id="6317831">(</span><span class="ident" id="6317832"><a href="/net/mail/message.go.html#6317784">key</a></span><span class="op" id="6317835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317838">if</span>&nbsp;<span class="ident" id="6317841"><a href="/net/mail/message.go.html#6317819">hdr</a></span>&nbsp;<span class="op" id="6317845">==</span>&nbsp;<span class="string" id="6317848">&#34;&#34;</span>&nbsp;<span class="op" id="6317851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317855">return</span>&nbsp;<span class="ident" id="6317862">nil</span><span class="op" id="6317865">,</span>&nbsp;<span class="ident" id="6317867"><a href="/net/mail/message.go.html#6317431">ErrHeaderNotPresent</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6317888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6317891">return</span>&nbsp;<span class="ident" id="6317898"><a href="/net/mail/message.go.html#6318450">ParseAddressList</a></span><span class="op" id="6317914">(</span><span class="ident" id="6317915"><a href="/net/mail/message.go.html#6317819">hdr</a></span><span class="op" id="6317918">)</span><br>
<span class="lineno"></span><span class="op" id="6317920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6317923">//&nbsp;Address&nbsp;represents&nbsp;a&nbsp;single&nbsp;mail&nbsp;address.</span><br>
<span class="lineno">135</span><span class="comment" id="6317968">//&nbsp;An&nbsp;address&nbsp;such&nbsp;as&nbsp;&#34;Barry&nbsp;Gibbs&nbsp;&lt;bg@example.com&gt;&#34;&nbsp;is&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="6318036">//&nbsp;as&nbsp;Address{Name:&nbsp;&#34;Barry&nbsp;Gibbs&#34;,&nbsp;Address:&nbsp;&#34;bg@example.com&#34;}.</span><br>
<span class="lineno"></span><span class="keyword" id="6318099">type</span>&nbsp;<span class="ident" id="6318104">Address</span>&nbsp;<span class="keyword" id="6318112">struct</span>&nbsp;<span class="op" id="6318119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6318122">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6318130">string</span>&nbsp;<span class="comment" id="6318137">//&nbsp;Proper&nbsp;name;&nbsp;may&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6318168">Address</span>&nbsp;<span class="builtintype" id="6318176">string</span>&nbsp;<span class="comment" id="6318183">//&nbsp;user@domain</span><br>
<span class="lineno">140</span><span class="op" id="6318198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6318201">//&nbsp;Parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;address,&nbsp;e.g.&nbsp;&#34;Barry&nbsp;Gibbs&nbsp;&lt;bg@example.com&gt;&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6318274">func</span>&nbsp;<span class="ident" id="6318279">ParseAddress</span><span class="op" id="6318291">(</span><span class="ident" id="6318292">address</span>&nbsp;<span class="builtintype" id="6318300">string</span><span class="op" id="6318306">)</span>&nbsp;<span class="op" id="6318308">(</span><span class="op" id="6318309">*</span><span class="ident" id="6318310"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6318317">,</span>&nbsp;<span class="builtintype" id="6318319">error</span><span class="op" id="6318324">)</span>&nbsp;<span class="op" id="6318326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6318329">return</span>&nbsp;<span class="ident" id="6318336"><a href="/net/mail/message.go.html#6319742">newAddrParser</a></span><span class="op" id="6318349">(</span><span class="ident" id="6318350"><a href="/net/mail/message.go.html#6318292">address</a></span><span class="op" id="6318357">)</span><span class="op" id="6318358">.</span><span class="ident" id="6318359">parseAddress</span><span class="op" id="6318371">(</span><span class="op" id="6318372">)</span><br>
<span class="lineno">145</span><span class="op" id="6318374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6318377">//&nbsp;ParseAddressList&nbsp;parses&nbsp;the&nbsp;given&nbsp;string&nbsp;as&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="6318445">func</span>&nbsp;<span class="ident" id="6318450">ParseAddressList</span><span class="op" id="6318466">(</span><span class="ident" id="6318467">list</span>&nbsp;<span class="builtintype" id="6318472">string</span><span class="op" id="6318478">)</span>&nbsp;<span class="op" id="6318480">(</span><span class="op" id="6318481">[</span><span class="op" id="6318482">]</span><span class="op" id="6318483">*</span><span class="ident" id="6318484"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6318491">,</span>&nbsp;<span class="builtintype" id="6318493">error</span><span class="op" id="6318498">)</span>&nbsp;<span class="op" id="6318500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6318503">return</span>&nbsp;<span class="ident" id="6318510"><a href="/net/mail/message.go.html#6319742">newAddrParser</a></span><span class="op" id="6318523">(</span><span class="ident" id="6318524"><a href="/net/mail/message.go.html#6318467">list</a></span><span class="op" id="6318528">)</span><span class="op" id="6318529">.</span><span class="ident" id="6318530">parseAddressList</span><span class="op" id="6318546">(</span><span class="op" id="6318547">)</span><br>
<span class="lineno">150</span><span class="op" id="6318549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6318552">//&nbsp;String&nbsp;formats&nbsp;the&nbsp;address&nbsp;as&nbsp;a&nbsp;valid&nbsp;RFC&nbsp;5322&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="6318611">//&nbsp;If&nbsp;the&nbsp;address&#39;s&nbsp;name&nbsp;contains&nbsp;non-ASCII&nbsp;characters</span><br>
<span class="lineno"></span><span class="comment" id="6318666">//&nbsp;the&nbsp;name&nbsp;will&nbsp;be&nbsp;rendered&nbsp;according&nbsp;to&nbsp;RFC&nbsp;2047.</span><br>
<span class="lineno">155</span><span class="keyword" id="6318718">func</span>&nbsp;<span class="op" id="6318723">(</span><span class="ident" id="6318724">a</span>&nbsp;<span class="op" id="6318726">*</span><span class="ident" id="6318727"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6318734">)</span>&nbsp;<span class="ident" id="6318736">String</span><span class="op" id="6318742">(</span><span class="op" id="6318743">)</span>&nbsp;<span class="builtintype" id="6318745">string</span>&nbsp;<span class="op" id="6318752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6318755">s</span>&nbsp;<span class="op" id="6318757">:=</span>&nbsp;<span class="string" id="6318760">&#34;&lt;&#34;</span>&nbsp;<span class="op" id="6318764">+</span>&nbsp;<span class="ident" id="6318766"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6318767">.</span><span class="ident" id="6318768">Address</span>&nbsp;<span class="op" id="6318776">+</span>&nbsp;<span class="string" id="6318778">&#34;&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6318783">if</span>&nbsp;<span class="ident" id="6318786"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6318787">.</span><span class="ident" id="6318788">Name</span>&nbsp;<span class="op" id="6318793">==</span>&nbsp;<span class="string" id="6318796">&#34;&#34;</span>&nbsp;<span class="op" id="6318799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6318803">return</span>&nbsp;<span class="ident" id="6318810"><a href="/net/mail/message.go.html#6318755">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6318813">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6318816">//&nbsp;If&nbsp;every&nbsp;character&nbsp;is&nbsp;printable&nbsp;ASCII,&nbsp;quoting&nbsp;is&nbsp;simple.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6318878">allPrintable</span>&nbsp;<span class="op" id="6318891">:=</span>&nbsp;<span class="builtintype" id="6318894">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6318900">for</span>&nbsp;<span class="ident" id="6318904">i</span>&nbsp;<span class="op" id="6318906">:=</span>&nbsp;<span class="num" id="6318909">0</span><span class="op" id="6318910">;</span>&nbsp;<span class="ident" id="6318912"><a href="/net/mail/message.go.html#6318904">i</a></span>&nbsp;<span class="op" id="6318914">&lt;</span>&nbsp;<span class="builtinfunc" id="6318916">len</span><span class="op" id="6318919">(</span><span class="ident" id="6318920"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6318921">.</span><span class="ident" id="6318922">Name</span><span class="op" id="6318926">)</span><span class="op" id="6318927">;</span>&nbsp;<span class="ident" id="6318929"><a href="/net/mail/message.go.html#6318904">i</a></span><span class="op" id="6318930">++</span>&nbsp;<span class="op" id="6318933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6318937">//&nbsp;isWSP&nbsp;here&nbsp;should&nbsp;actually&nbsp;be&nbsp;isFWS,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6318979">//&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;support&nbsp;folding&nbsp;yet.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319018">if</span>&nbsp;<span class="op" id="6319021">!</span><span class="ident" id="6319022"><a href="/net/mail/message.go.html#6327870">isVchar</a></span><span class="op" id="6319029">(</span><span class="ident" id="6319030"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319031">.</span><span class="ident" id="6319032">Name</span><span class="op" id="6319036">[</span><span class="ident" id="6319037"><a href="/net/mail/message.go.html#6318904">i</a></span><span class="op" id="6319038">]</span><span class="op" id="6319039">)</span>&nbsp;<span class="op" id="6319041">&amp;&amp;</span>&nbsp;<span class="op" id="6319044">!</span><span class="ident" id="6319045"><a href="/net/mail/message.go.html#6328074">isWSP</a></span><span class="op" id="6319050">(</span><span class="ident" id="6319051"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319052">.</span><span class="ident" id="6319053">Name</span><span class="op" id="6319057">[</span><span class="ident" id="6319058"><a href="/net/mail/message.go.html#6318904">i</a></span><span class="op" id="6319059">]</span><span class="op" id="6319060">)</span>&nbsp;<span class="op" id="6319062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319067"><a href="/net/mail/message.go.html#6318878">allPrintable</a></span>&nbsp;<span class="op" id="6319080">=</span>&nbsp;<span class="builtintype" id="6319082">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319091">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319102">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319105">if</span>&nbsp;<span class="ident" id="6319108"><a href="/net/mail/message.go.html#6318878">allPrintable</a></span>&nbsp;<span class="op" id="6319121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319125">b</span>&nbsp;<span class="op" id="6319127">:=</span>&nbsp;<span class="ident" id="6319130"><a href="/net/mail/message.go.html#6315271">bytes</a></span><span class="op" id="6319135">.</span><span class="ident" id="6319136">NewBufferString</span><span class="op" id="6319151">(</span><span class="string" id="6319152">`&#34;`</span><span class="op" id="6319155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319159">for</span>&nbsp;<span class="ident" id="6319163">i</span>&nbsp;<span class="op" id="6319165">:=</span>&nbsp;<span class="num" id="6319168">0</span><span class="op" id="6319169">;</span>&nbsp;<span class="ident" id="6319171"><a href="/net/mail/message.go.html#6319163">i</a></span>&nbsp;<span class="op" id="6319173">&lt;</span>&nbsp;<span class="builtinfunc" id="6319175">len</span><span class="op" id="6319178">(</span><span class="ident" id="6319179"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319180">.</span><span class="ident" id="6319181">Name</span><span class="op" id="6319185">)</span><span class="op" id="6319186">;</span>&nbsp;<span class="ident" id="6319188"><a href="/net/mail/message.go.html#6319163">i</a></span><span class="op" id="6319189">++</span>&nbsp;<span class="op" id="6319192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319197">if</span>&nbsp;<span class="op" id="6319200">!</span><span class="ident" id="6319201"><a href="/net/mail/message.go.html#6327649">isQtext</a></span><span class="op" id="6319208">(</span><span class="ident" id="6319209"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319210">.</span><span class="ident" id="6319211">Name</span><span class="op" id="6319215">[</span><span class="ident" id="6319216"><a href="/net/mail/message.go.html#6319163">i</a></span><span class="op" id="6319217">]</span><span class="op" id="6319218">)</span>&nbsp;<span class="op" id="6319220">&amp;&amp;</span>&nbsp;<span class="op" id="6319223">!</span><span class="ident" id="6319224"><a href="/net/mail/message.go.html#6328074">isWSP</a></span><span class="op" id="6319229">(</span><span class="ident" id="6319230"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319231">.</span><span class="ident" id="6319232">Name</span><span class="op" id="6319236">[</span><span class="ident" id="6319237"><a href="/net/mail/message.go.html#6319163">i</a></span><span class="op" id="6319238">]</span><span class="op" id="6319239">)</span>&nbsp;<span class="op" id="6319241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319247"><a href="/net/mail/message.go.html#6319125">b</a></span><span class="op" id="6319248">.</span><span class="ident" id="6319249">WriteByte</span><span class="op" id="6319258">(</span><span class="string" id="6319259">&#39;\\&#39;</span><span class="op" id="6319263">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319273"><a href="/net/mail/message.go.html#6319125">b</a></span><span class="op" id="6319274">.</span><span class="ident" id="6319275">WriteByte</span><span class="op" id="6319284">(</span><span class="ident" id="6319285"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319286">.</span><span class="ident" id="6319287">Name</span><span class="op" id="6319291">[</span><span class="ident" id="6319292"><a href="/net/mail/message.go.html#6319163">i</a></span><span class="op" id="6319293">]</span><span class="op" id="6319294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319302"><a href="/net/mail/message.go.html#6319125">b</a></span><span class="op" id="6319303">.</span><span class="ident" id="6319304">WriteString</span><span class="op" id="6319315">(</span><span class="string" id="6319316">`&#34;&nbsp;`</span><span class="op" id="6319320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319324"><a href="/net/mail/message.go.html#6319125">b</a></span><span class="op" id="6319325">.</span><span class="ident" id="6319326">WriteString</span><span class="op" id="6319337">(</span><span class="ident" id="6319338"><a href="/net/mail/message.go.html#6318755">s</a></span><span class="op" id="6319339">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319343">return</span>&nbsp;<span class="ident" id="6319350"><a href="/net/mail/message.go.html#6319125">b</a></span><span class="op" id="6319351">.</span><span class="ident" id="6319352">String</span><span class="op" id="6319358">(</span><span class="op" id="6319359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6319366">//&nbsp;UTF-8&nbsp;&#34;Q&#34;&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319389">b</span>&nbsp;<span class="op" id="6319391">:=</span>&nbsp;<span class="ident" id="6319394"><a href="/net/mail/message.go.html#6315271">bytes</a></span><span class="op" id="6319399">.</span><span class="ident" id="6319400">NewBufferString</span><span class="op" id="6319415">(</span><span class="string" id="6319416">&#34;=?utf-8?q?&#34;</span><span class="op" id="6319428">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319431">for</span>&nbsp;<span class="ident" id="6319435">i</span>&nbsp;<span class="op" id="6319437">:=</span>&nbsp;<span class="num" id="6319440">0</span><span class="op" id="6319441">;</span>&nbsp;<span class="ident" id="6319443"><a href="/net/mail/message.go.html#6319435">i</a></span>&nbsp;<span class="op" id="6319445">&lt;</span>&nbsp;<span class="builtinfunc" id="6319447">len</span><span class="op" id="6319450">(</span><span class="ident" id="6319451"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319452">.</span><span class="ident" id="6319453">Name</span><span class="op" id="6319457">)</span><span class="op" id="6319458">;</span>&nbsp;<span class="ident" id="6319460"><a href="/net/mail/message.go.html#6319435">i</a></span><span class="op" id="6319461">++</span>&nbsp;<span class="op" id="6319464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319468">switch</span>&nbsp;<span class="ident" id="6319475">c</span>&nbsp;<span class="op" id="6319477">:=</span>&nbsp;<span class="ident" id="6319480"><a href="/net/mail/message.go.html#6318724">a</a></span><span class="op" id="6319481">.</span><span class="ident" id="6319482">Name</span><span class="op" id="6319486">[</span><span class="ident" id="6319487"><a href="/net/mail/message.go.html#6319435">i</a></span><span class="op" id="6319488">]</span><span class="op" id="6319489">;</span>&nbsp;<span class="op" id="6319491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319495">case</span>&nbsp;<span class="ident" id="6319500"><a href="/net/mail/message.go.html#6319475">c</a></span>&nbsp;<span class="op" id="6319502">==</span>&nbsp;<span class="string" id="6319505">&#39;&nbsp;&#39;</span><span class="op" id="6319508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319513"><a href="/net/mail/message.go.html#6319389">b</a></span><span class="op" id="6319514">.</span><span class="ident" id="6319515">WriteByte</span><span class="op" id="6319524">(</span><span class="string" id="6319525">&#39;_&#39;</span><span class="op" id="6319528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319532">case</span>&nbsp;<span class="ident" id="6319537"><a href="/net/mail/message.go.html#6327870">isVchar</a></span><span class="op" id="6319544">(</span><span class="ident" id="6319545"><a href="/net/mail/message.go.html#6319475">c</a></span><span class="op" id="6319546">)</span>&nbsp;<span class="op" id="6319548">&amp;&amp;</span>&nbsp;<span class="ident" id="6319551"><a href="/net/mail/message.go.html#6319475">c</a></span>&nbsp;<span class="op" id="6319553">!=</span>&nbsp;<span class="string" id="6319556">&#39;=&#39;</span>&nbsp;<span class="op" id="6319560">&amp;&amp;</span>&nbsp;<span class="ident" id="6319563"><a href="/net/mail/message.go.html#6319475">c</a></span>&nbsp;<span class="op" id="6319565">!=</span>&nbsp;<span class="string" id="6319568">&#39;?&#39;</span>&nbsp;<span class="op" id="6319572">&amp;&amp;</span>&nbsp;<span class="ident" id="6319575"><a href="/net/mail/message.go.html#6319475">c</a></span>&nbsp;<span class="op" id="6319577">!=</span>&nbsp;<span class="string" id="6319580">&#39;_&#39;</span><span class="op" id="6319583">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319588"><a href="/net/mail/message.go.html#6319389">b</a></span><span class="op" id="6319589">.</span><span class="ident" id="6319590">WriteByte</span><span class="op" id="6319599">(</span><span class="ident" id="6319600"><a href="/net/mail/message.go.html#6319475">c</a></span><span class="op" id="6319601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319605">default</span><span class="op" id="6319612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319617"><a href="/net/mail/message.go.html#6315309">fmt</a></span><span class="op" id="6319620">.</span><span class="ident" id="6319621">Fprintf</span><span class="op" id="6319628">(</span><span class="ident" id="6319629"><a href="/net/mail/message.go.html#6319389">b</a></span><span class="op" id="6319630">,</span>&nbsp;<span class="string" id="6319632">&#34;=%02X&#34;</span><span class="op" id="6319639">,</span>&nbsp;<span class="ident" id="6319641"><a href="/net/mail/message.go.html#6319475">c</a></span><span class="op" id="6319642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319649">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319652"><a href="/net/mail/message.go.html#6319389">b</a></span><span class="op" id="6319653">.</span><span class="ident" id="6319654">WriteString</span><span class="op" id="6319665">(</span><span class="string" id="6319666">&#34;?=&nbsp;&#34;</span><span class="op" id="6319671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319674"><a href="/net/mail/message.go.html#6319389">b</a></span><span class="op" id="6319675">.</span><span class="ident" id="6319676">WriteString</span><span class="op" id="6319687">(</span><span class="ident" id="6319688"><a href="/net/mail/message.go.html#6318755">s</a></span><span class="op" id="6319689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319692">return</span>&nbsp;<span class="ident" id="6319699"><a href="/net/mail/message.go.html#6319389">b</a></span><span class="op" id="6319700">.</span><span class="ident" id="6319701">String</span><span class="op" id="6319707">(</span><span class="op" id="6319708">)</span><br>
<span class="lineno"></span><span class="op" id="6319710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="6319713">type</span>&nbsp;<span class="ident" id="6319718">addrParser</span>&nbsp;<span class="op" id="6319729">[</span><span class="op" id="6319730">]</span><span class="builtintype" id="6319731">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6319737">func</span>&nbsp;<span class="ident" id="6319742">newAddrParser</span><span class="op" id="6319755">(</span><span class="ident" id="6319756">s</span>&nbsp;<span class="builtintype" id="6319758">string</span><span class="op" id="6319764">)</span>&nbsp;<span class="op" id="6319766">*</span><span class="ident" id="6319767"><a href="/net/mail/message.go.html#6319718">addrParser</a></span>&nbsp;<span class="op" id="6319778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319781">p</span>&nbsp;<span class="op" id="6319783">:=</span>&nbsp;<span class="ident" id="6319786"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6319796">(</span><span class="ident" id="6319797"><a href="/net/mail/message.go.html#6319756">s</a></span><span class="op" id="6319798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319801">return</span>&nbsp;<span class="op" id="6319808">&amp;</span><span class="ident" id="6319809"><a href="/net/mail/message.go.html#6319781">p</a></span><br>
<span class="lineno">205</span><span class="op" id="6319811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6319814">func</span>&nbsp;<span class="op" id="6319819">(</span><span class="ident" id="6319820">p</span>&nbsp;<span class="op" id="6319822">*</span><span class="ident" id="6319823"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6319833">)</span>&nbsp;<span class="ident" id="6319835">parseAddressList</span><span class="op" id="6319851">(</span><span class="op" id="6319852">)</span>&nbsp;<span class="op" id="6319854">(</span><span class="op" id="6319855">[</span><span class="op" id="6319856">]</span><span class="op" id="6319857">*</span><span class="ident" id="6319858"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6319865">,</span>&nbsp;<span class="builtintype" id="6319867">error</span><span class="op" id="6319872">)</span>&nbsp;<span class="op" id="6319874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319877">var</span>&nbsp;<span class="ident" id="6319881">list</span>&nbsp;<span class="op" id="6319886">[</span><span class="op" id="6319887">]</span><span class="op" id="6319888">*</span><span class="ident" id="6319889"><a href="/net/mail/message.go.html#6318104">Address</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319898">for</span>&nbsp;<span class="op" id="6319902">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319906"><a href="/net/mail/message.go.html#6319820">p</a></span><span class="op" id="6319907">.</span><span class="ident" id="6319908">skipSpace</span><span class="op" id="6319917">(</span><span class="op" id="6319918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319922">addr</span><span class="op" id="6319926">,</span>&nbsp;<span class="ident" id="6319928">err</span>&nbsp;<span class="op" id="6319932">:=</span>&nbsp;<span class="ident" id="6319935"><a href="/net/mail/message.go.html#6319820">p</a></span><span class="op" id="6319936">.</span><span class="ident" id="6319937">parseAddress</span><span class="op" id="6319949">(</span><span class="op" id="6319950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319954">if</span>&nbsp;<span class="ident" id="6319957"><a href="/net/mail/message.go.html#6319928">err</a></span>&nbsp;<span class="op" id="6319961">!=</span>&nbsp;<span class="ident" id="6319964">nil</span>&nbsp;<span class="op" id="6319968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6319973">return</span>&nbsp;<span class="ident" id="6319980">nil</span><span class="op" id="6319983">,</span>&nbsp;<span class="ident" id="6319985"><a href="/net/mail/message.go.html#6319928">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6319991">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6319995"><a href="/net/mail/message.go.html#6319881">list</a></span>&nbsp;<span class="op" id="6320000">=</span>&nbsp;<span class="builtinfunc" id="6320002">append</span><span class="op" id="6320008">(</span><span class="ident" id="6320009"><a href="/net/mail/message.go.html#6319881">list</a></span><span class="op" id="6320013">,</span>&nbsp;<span class="ident" id="6320015"><a href="/net/mail/message.go.html#6319922">addr</a></span><span class="op" id="6320019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320024"><a href="/net/mail/message.go.html#6319820">p</a></span><span class="op" id="6320025">.</span><span class="ident" id="6320026">skipSpace</span><span class="op" id="6320035">(</span><span class="op" id="6320036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320040">if</span>&nbsp;<span class="ident" id="6320043"><a href="/net/mail/message.go.html#6319820">p</a></span><span class="op" id="6320044">.</span><span class="ident" id="6320045">empty</span><span class="op" id="6320050">(</span><span class="op" id="6320051">)</span>&nbsp;<span class="op" id="6320053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320058">break</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6320066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320070">if</span>&nbsp;<span class="op" id="6320073">!</span><span class="ident" id="6320074"><a href="/net/mail/message.go.html#6319820">p</a></span><span class="op" id="6320075">.</span><span class="ident" id="6320076">consume</span><span class="op" id="6320083">(</span><span class="string" id="6320084">&#39;,&#39;</span><span class="op" id="6320087">)</span>&nbsp;<span class="op" id="6320089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320094">return</span>&nbsp;<span class="ident" id="6320101">nil</span><span class="op" id="6320104">,</span>&nbsp;<span class="ident" id="6320106"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6320112">.</span><span class="ident" id="6320113">New</span><span class="op" id="6320116">(</span><span class="string" id="6320117">&#34;mail:&nbsp;expected&nbsp;comma&#34;</span><span class="op" id="6320139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6320143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6320146">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320149">return</span>&nbsp;<span class="ident" id="6320156"><a href="/net/mail/message.go.html#6319881">list</a></span><span class="op" id="6320160">,</span>&nbsp;<span class="ident" id="6320162">nil</span><br>
<span class="lineno"></span><span class="op" id="6320166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6320169">//&nbsp;parseAddress&nbsp;parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;address&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6320237">func</span>&nbsp;<span class="op" id="6320242">(</span><span class="ident" id="6320243">p</span>&nbsp;<span class="op" id="6320245">*</span><span class="ident" id="6320246"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6320256">)</span>&nbsp;<span class="ident" id="6320258">parseAddress</span><span class="op" id="6320270">(</span><span class="op" id="6320271">)</span>&nbsp;<span class="op" id="6320273">(</span><span class="ident" id="6320274">addr</span>&nbsp;<span class="op" id="6320279">*</span><span class="ident" id="6320280"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6320287">,</span>&nbsp;<span class="ident" id="6320289">err</span>&nbsp;<span class="builtintype" id="6320293">error</span><span class="op" id="6320298">)</span>&nbsp;<span class="op" id="6320300">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320303"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6320308">.</span><span class="ident" id="6320309">Printf</span><span class="op" id="6320315">(</span><span class="string" id="6320316">&#34;parseAddress:&nbsp;%q&#34;</span><span class="op" id="6320334">,</span>&nbsp;<span class="op" id="6320336">*</span><span class="ident" id="6320337"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6320338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320341"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6320342">.</span><span class="ident" id="6320343">skipSpace</span><span class="op" id="6320352">(</span><span class="op" id="6320353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320356">if</span>&nbsp;<span class="ident" id="6320359"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6320360">.</span><span class="ident" id="6320361">empty</span><span class="op" id="6320366">(</span><span class="op" id="6320367">)</span>&nbsp;<span class="op" id="6320369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320373">return</span>&nbsp;<span class="ident" id="6320380">nil</span><span class="op" id="6320383">,</span>&nbsp;<span class="ident" id="6320385"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6320391">.</span><span class="ident" id="6320392">New</span><span class="op" id="6320395">(</span><span class="string" id="6320396">&#34;mail:&nbsp;no&nbsp;address&#34;</span><span class="op" id="6320414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6320417">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6320421">//&nbsp;address&nbsp;=&nbsp;name-addr&nbsp;/&nbsp;addr-spec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6320457">//&nbsp;TODO(dsymonds):&nbsp;Support&nbsp;parsing&nbsp;group&nbsp;address.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6320509">//&nbsp;addr-spec&nbsp;has&nbsp;a&nbsp;more&nbsp;restricted&nbsp;grammar&nbsp;than&nbsp;name-addr,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6320569">//&nbsp;so&nbsp;try&nbsp;parsing&nbsp;it&nbsp;first,&nbsp;and&nbsp;fallback&nbsp;to&nbsp;name-addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6320625">//&nbsp;TODO(dsymonds):&nbsp;Is&nbsp;this&nbsp;really&nbsp;correct?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320669">spec</span><span class="op" id="6320673">,</span>&nbsp;<span class="ident" id="6320675"><a href="/net/mail/message.go.html#6320289">err</a></span>&nbsp;<span class="op" id="6320679">:=</span>&nbsp;<span class="ident" id="6320682"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6320683">.</span><span class="ident" id="6320684">consumeAddrSpec</span><span class="op" id="6320699">(</span><span class="op" id="6320700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320703">if</span>&nbsp;<span class="ident" id="6320706"><a href="/net/mail/message.go.html#6320289">err</a></span>&nbsp;<span class="op" id="6320710">==</span>&nbsp;<span class="ident" id="6320713">nil</span>&nbsp;<span class="op" id="6320717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320721">return</span>&nbsp;<span class="op" id="6320728">&amp;</span><span class="ident" id="6320729"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6320736">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320741">Address</span><span class="op" id="6320748">:</span>&nbsp;<span class="ident" id="6320750"><a href="/net/mail/message.go.html#6320669">spec</a></span><span class="op" id="6320754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6320758">}</span><span class="op" id="6320759">,</span>&nbsp;<span class="ident" id="6320761"><a href="/net/mail/message.go.html#6320289">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6320766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320769"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6320774">.</span><span class="ident" id="6320775">Printf</span><span class="op" id="6320781">(</span><span class="string" id="6320782">&#34;parseAddress:&nbsp;not&nbsp;an&nbsp;addr-spec:&nbsp;%v&#34;</span><span class="op" id="6320818">,</span>&nbsp;<span class="ident" id="6320820"><a href="/net/mail/message.go.html#6320289">err</a></span><span class="op" id="6320823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320826"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6320831">.</span><span class="ident" id="6320832">Printf</span><span class="op" id="6320838">(</span><span class="string" id="6320839">&#34;parseAddress:&nbsp;state&nbsp;is&nbsp;now&nbsp;%q&#34;</span><span class="op" id="6320870">,</span>&nbsp;<span class="op" id="6320872">*</span><span class="ident" id="6320873"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6320874">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6320878">//&nbsp;display-name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320895">var</span>&nbsp;<span class="ident" id="6320899">displayName</span>&nbsp;<span class="builtintype" id="6320911">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320919">if</span>&nbsp;<span class="ident" id="6320922"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6320923">.</span><span class="ident" id="6320924">peek</span><span class="op" id="6320928">(</span><span class="op" id="6320929">)</span>&nbsp;<span class="op" id="6320931">!=</span>&nbsp;<span class="string" id="6320934">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="6320938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6320942"><a href="/net/mail/message.go.html#6320899">displayName</a></span><span class="op" id="6320953">,</span>&nbsp;<span class="ident" id="6320955"><a href="/net/mail/message.go.html#6320289">err</a></span>&nbsp;<span class="op" id="6320959">=</span>&nbsp;<span class="ident" id="6320961"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6320962">.</span><span class="ident" id="6320963">consumePhrase</span><span class="op" id="6320976">(</span><span class="op" id="6320977">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6320981">if</span>&nbsp;<span class="ident" id="6320984"><a href="/net/mail/message.go.html#6320289">err</a></span>&nbsp;<span class="op" id="6320988">!=</span>&nbsp;<span class="ident" id="6320991">nil</span>&nbsp;<span class="op" id="6320995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321000">return</span>&nbsp;<span class="ident" id="6321007">nil</span><span class="op" id="6321010">,</span>&nbsp;<span class="ident" id="6321012"><a href="/net/mail/message.go.html#6320289">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321024"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6321029">.</span><span class="ident" id="6321030">Printf</span><span class="op" id="6321036">(</span><span class="string" id="6321037">&#34;parseAddress:&nbsp;displayName=%q&#34;</span><span class="op" id="6321067">,</span>&nbsp;<span class="ident" id="6321069"><a href="/net/mail/message.go.html#6320899">displayName</a></span><span class="op" id="6321080">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6321084">//&nbsp;angle-addr&nbsp;=&nbsp;&#34;&lt;&#34;&nbsp;addr-spec&nbsp;&#34;&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321119"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6321120">.</span><span class="ident" id="6321121">skipSpace</span><span class="op" id="6321130">(</span><span class="op" id="6321131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321134">if</span>&nbsp;<span class="op" id="6321137">!</span><span class="ident" id="6321138"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6321139">.</span><span class="ident" id="6321140">consume</span><span class="op" id="6321147">(</span><span class="string" id="6321148">&#39;&lt;&#39;</span><span class="op" id="6321151">)</span>&nbsp;<span class="op" id="6321153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321157">return</span>&nbsp;<span class="ident" id="6321164">nil</span><span class="op" id="6321167">,</span>&nbsp;<span class="ident" id="6321169"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6321175">.</span><span class="ident" id="6321176">New</span><span class="op" id="6321179">(</span><span class="string" id="6321180">&#34;mail:&nbsp;no&nbsp;angle-addr&#34;</span><span class="op" id="6321201">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321207"><a href="/net/mail/message.go.html#6320669">spec</a></span><span class="op" id="6321211">,</span>&nbsp;<span class="ident" id="6321213"><a href="/net/mail/message.go.html#6320289">err</a></span>&nbsp;<span class="op" id="6321217">=</span>&nbsp;<span class="ident" id="6321219"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6321220">.</span><span class="ident" id="6321221">consumeAddrSpec</span><span class="op" id="6321236">(</span><span class="op" id="6321237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321240">if</span>&nbsp;<span class="ident" id="6321243"><a href="/net/mail/message.go.html#6320289">err</a></span>&nbsp;<span class="op" id="6321247">!=</span>&nbsp;<span class="ident" id="6321250">nil</span>&nbsp;<span class="op" id="6321254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321258">return</span>&nbsp;<span class="ident" id="6321265">nil</span><span class="op" id="6321268">,</span>&nbsp;<span class="ident" id="6321270"><a href="/net/mail/message.go.html#6320289">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321275">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321278">if</span>&nbsp;<span class="op" id="6321281">!</span><span class="ident" id="6321282"><a href="/net/mail/message.go.html#6320243">p</a></span><span class="op" id="6321283">.</span><span class="ident" id="6321284">consume</span><span class="op" id="6321291">(</span><span class="string" id="6321292">&#39;&gt;&#39;</span><span class="op" id="6321295">)</span>&nbsp;<span class="op" id="6321297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321301">return</span>&nbsp;<span class="ident" id="6321308">nil</span><span class="op" id="6321311">,</span>&nbsp;<span class="ident" id="6321313"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6321319">.</span><span class="ident" id="6321320">New</span><span class="op" id="6321323">(</span><span class="string" id="6321324">&#34;mail:&nbsp;unclosed&nbsp;angle-addr&#34;</span><span class="op" id="6321351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321357"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6321362">.</span><span class="ident" id="6321363">Printf</span><span class="op" id="6321369">(</span><span class="string" id="6321370">&#34;parseAddress:&nbsp;spec=%q&#34;</span><span class="op" id="6321393">,</span>&nbsp;<span class="ident" id="6321395"><a href="/net/mail/message.go.html#6320669">spec</a></span><span class="op" id="6321399">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321403">return</span>&nbsp;<span class="op" id="6321410">&amp;</span><span class="ident" id="6321411"><a href="/net/mail/message.go.html#6318104">Address</a></span><span class="op" id="6321418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321422">Name</span><span class="op" id="6321426">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6321431"><a href="/net/mail/message.go.html#6320899">displayName</a></span><span class="op" id="6321442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321446">Address</span><span class="op" id="6321453">:</span>&nbsp;<span class="ident" id="6321455"><a href="/net/mail/message.go.html#6320669">spec</a></span><span class="op" id="6321459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321462">}</span><span class="op" id="6321463">,</span>&nbsp;<span class="ident" id="6321465">nil</span><br>
<span class="lineno"></span><span class="op" id="6321469">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="6321472">//&nbsp;consumeAddrSpec&nbsp;parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;addr-spec&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6321545">func</span>&nbsp;<span class="op" id="6321550">(</span><span class="ident" id="6321551">p</span>&nbsp;<span class="op" id="6321553">*</span><span class="ident" id="6321554"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6321564">)</span>&nbsp;<span class="ident" id="6321566">consumeAddrSpec</span><span class="op" id="6321581">(</span><span class="op" id="6321582">)</span>&nbsp;<span class="op" id="6321584">(</span><span class="ident" id="6321585">spec</span>&nbsp;<span class="builtintype" id="6321590">string</span><span class="op" id="6321596">,</span>&nbsp;<span class="ident" id="6321598">err</span>&nbsp;<span class="builtintype" id="6321602">error</span><span class="op" id="6321607">)</span>&nbsp;<span class="op" id="6321609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321612"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6321617">.</span><span class="ident" id="6321618">Printf</span><span class="op" id="6321624">(</span><span class="string" id="6321625">&#34;consumeAddrSpec:&nbsp;%q&#34;</span><span class="op" id="6321646">,</span>&nbsp;<span class="op" id="6321648">*</span><span class="ident" id="6321649"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6321650">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321654">orig</span>&nbsp;<span class="op" id="6321659">:=</span>&nbsp;<span class="op" id="6321662">*</span><span class="ident" id="6321663"><a href="/net/mail/message.go.html#6321551">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321666">defer</span>&nbsp;<span class="keyword" id="6321672">func</span><span class="op" id="6321676">(</span><span class="op" id="6321677">)</span>&nbsp;<span class="op" id="6321679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321683">if</span>&nbsp;<span class="ident" id="6321686"><a href="/net/mail/message.go.html#6321598">err</a></span>&nbsp;<span class="op" id="6321690">!=</span>&nbsp;<span class="ident" id="6321693">nil</span>&nbsp;<span class="op" id="6321697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321702">*</span><span class="ident" id="6321703"><a href="/net/mail/message.go.html#6321551">p</a></span>&nbsp;<span class="op" id="6321705">=</span>&nbsp;<span class="ident" id="6321707"><a href="/net/mail/message.go.html#6321654">orig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321714">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321717">}</span><span class="op" id="6321718">(</span><span class="op" id="6321719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6321723">//&nbsp;local-part&nbsp;=&nbsp;dot-atom&nbsp;/&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321765">var</span>&nbsp;<span class="ident" id="6321769">localPart</span>&nbsp;<span class="builtintype" id="6321779">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321787"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6321788">.</span><span class="ident" id="6321789">skipSpace</span><span class="op" id="6321798">(</span><span class="op" id="6321799">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321802">if</span>&nbsp;<span class="ident" id="6321805"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6321806">.</span><span class="ident" id="6321807">empty</span><span class="op" id="6321812">(</span><span class="op" id="6321813">)</span>&nbsp;<span class="op" id="6321815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321819">return</span>&nbsp;<span class="string" id="6321826">&#34;&#34;</span><span class="op" id="6321828">,</span>&nbsp;<span class="ident" id="6321830"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6321836">.</span><span class="ident" id="6321837">New</span><span class="op" id="6321840">(</span><span class="string" id="6321841">&#34;mail:&nbsp;no&nbsp;addr-spec&#34;</span><span class="op" id="6321861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6321864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6321867">if</span>&nbsp;<span class="ident" id="6321870"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6321871">.</span><span class="ident" id="6321872">peek</span><span class="op" id="6321876">(</span><span class="op" id="6321877">)</span>&nbsp;<span class="op" id="6321879">==</span>&nbsp;<span class="string" id="6321882">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6321886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6321890">//&nbsp;quoted-string</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321909"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6321914">.</span><span class="ident" id="6321915">Printf</span><span class="op" id="6321921">(</span><span class="string" id="6321922">&#34;consumeAddrSpec:&nbsp;parsing&nbsp;quoted-string&#34;</span><span class="op" id="6321962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6321966"><a href="/net/mail/message.go.html#6321769">localPart</a></span><span class="op" id="6321975">,</span>&nbsp;<span class="ident" id="6321977"><a href="/net/mail/message.go.html#6321598">err</a></span>&nbsp;<span class="op" id="6321981">=</span>&nbsp;<span class="ident" id="6321983"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6321984">.</span><span class="ident" id="6321985">consumeQuotedString</span><span class="op" id="6322004">(</span><span class="op" id="6322005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6322008">}</span>&nbsp;<span class="keyword" id="6322010">else</span>&nbsp;<span class="op" id="6322015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6322019">//&nbsp;dot-atom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6322033"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6322038">.</span><span class="ident" id="6322039">Printf</span><span class="op" id="6322045">(</span><span class="string" id="6322046">&#34;consumeAddrSpec:&nbsp;parsing&nbsp;dot-atom&#34;</span><span class="op" id="6322081">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6322085"><a href="/net/mail/message.go.html#6321769">localPart</a></span><span class="op" id="6322094">,</span>&nbsp;<span class="ident" id="6322096"><a href="/net/mail/message.go.html#6321598">err</a></span>&nbsp;<span class="op" id="6322100">=</span>&nbsp;<span class="ident" id="6322102"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6322103">.</span><span class="ident" id="6322104">consumeAtom</span><span class="op" id="6322115">(</span><span class="builtintype" id="6322116">true</span><span class="op" id="6322120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6322123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322126">if</span>&nbsp;<span class="ident" id="6322129"><a href="/net/mail/message.go.html#6321598">err</a></span>&nbsp;<span class="op" id="6322133">!=</span>&nbsp;<span class="ident" id="6322136">nil</span>&nbsp;<span class="op" id="6322140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6322144"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6322149">.</span><span class="ident" id="6322150">Printf</span><span class="op" id="6322156">(</span><span class="string" id="6322157">&#34;consumeAddrSpec:&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6322186">,</span>&nbsp;<span class="ident" id="6322188"><a href="/net/mail/message.go.html#6321598">err</a></span><span class="op" id="6322191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322195">return</span>&nbsp;<span class="string" id="6322202">&#34;&#34;</span><span class="op" id="6322204">,</span>&nbsp;<span class="ident" id="6322206"><a href="/net/mail/message.go.html#6321598">err</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6322211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322215">if</span>&nbsp;<span class="op" id="6322218">!</span><span class="ident" id="6322219"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6322220">.</span><span class="ident" id="6322221">consume</span><span class="op" id="6322228">(</span><span class="string" id="6322229">&#39;@&#39;</span><span class="op" id="6322232">)</span>&nbsp;<span class="op" id="6322234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322238">return</span>&nbsp;<span class="string" id="6322245">&#34;&#34;</span><span class="op" id="6322247">,</span>&nbsp;<span class="ident" id="6322249"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6322255">.</span><span class="ident" id="6322256">New</span><span class="op" id="6322259">(</span><span class="string" id="6322260">&#34;mail:&nbsp;missing&nbsp;@&nbsp;in&nbsp;addr-spec&#34;</span><span class="op" id="6322290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6322293">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6322297">//&nbsp;domain&nbsp;=&nbsp;dot-atom&nbsp;/&nbsp;domain-literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322336">var</span>&nbsp;<span class="ident" id="6322340">domain</span>&nbsp;<span class="builtintype" id="6322347">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6322355"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6322356">.</span><span class="ident" id="6322357">skipSpace</span><span class="op" id="6322366">(</span><span class="op" id="6322367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322370">if</span>&nbsp;<span class="ident" id="6322373"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6322374">.</span><span class="ident" id="6322375">empty</span><span class="op" id="6322380">(</span><span class="op" id="6322381">)</span>&nbsp;<span class="op" id="6322383">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322387">return</span>&nbsp;<span class="string" id="6322394">&#34;&#34;</span><span class="op" id="6322396">,</span>&nbsp;<span class="ident" id="6322398"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6322404">.</span><span class="ident" id="6322405">New</span><span class="op" id="6322408">(</span><span class="string" id="6322409">&#34;mail:&nbsp;no&nbsp;domain&nbsp;in&nbsp;addr-spec&#34;</span><span class="op" id="6322439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6322442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6322445">//&nbsp;TODO(dsymonds):&nbsp;Handle&nbsp;domain-literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6322487"><a href="/net/mail/message.go.html#6322340">domain</a></span><span class="op" id="6322493">,</span>&nbsp;<span class="ident" id="6322495"><a href="/net/mail/message.go.html#6321598">err</a></span>&nbsp;<span class="op" id="6322499">=</span>&nbsp;<span class="ident" id="6322501"><a href="/net/mail/message.go.html#6321551">p</a></span><span class="op" id="6322502">.</span><span class="ident" id="6322503">consumeAtom</span><span class="op" id="6322514">(</span><span class="builtintype" id="6322515">true</span><span class="op" id="6322519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322522">if</span>&nbsp;<span class="ident" id="6322525"><a href="/net/mail/message.go.html#6321598">err</a></span>&nbsp;<span class="op" id="6322529">!=</span>&nbsp;<span class="ident" id="6322532">nil</span>&nbsp;<span class="op" id="6322536">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322540">return</span>&nbsp;<span class="string" id="6322547">&#34;&#34;</span><span class="op" id="6322549">,</span>&nbsp;<span class="ident" id="6322551"><a href="/net/mail/message.go.html#6321598">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6322556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322560">return</span>&nbsp;<span class="ident" id="6322567"><a href="/net/mail/message.go.html#6321769">localPart</a></span>&nbsp;<span class="op" id="6322577">+</span>&nbsp;<span class="string" id="6322579">&#34;@&#34;</span>&nbsp;<span class="op" id="6322583">+</span>&nbsp;<span class="ident" id="6322585"><a href="/net/mail/message.go.html#6322340">domain</a></span><span class="op" id="6322591">,</span>&nbsp;<span class="ident" id="6322593">nil</span><br>
<span class="lineno"></span><span class="op" id="6322597">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="6322600">//&nbsp;consumePhrase&nbsp;parses&nbsp;the&nbsp;RFC&nbsp;5322&nbsp;phrase&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6322663">func</span>&nbsp;<span class="op" id="6322668">(</span><span class="ident" id="6322669">p</span>&nbsp;<span class="op" id="6322671">*</span><span class="ident" id="6322672"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6322682">)</span>&nbsp;<span class="ident" id="6322684">consumePhrase</span><span class="op" id="6322697">(</span><span class="op" id="6322698">)</span>&nbsp;<span class="op" id="6322700">(</span><span class="ident" id="6322701">phrase</span>&nbsp;<span class="builtintype" id="6322708">string</span><span class="op" id="6322714">,</span>&nbsp;<span class="ident" id="6322716">err</span>&nbsp;<span class="builtintype" id="6322720">error</span><span class="op" id="6322725">)</span>&nbsp;<span class="op" id="6322727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6322730"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6322735">.</span><span class="ident" id="6322736">Printf</span><span class="op" id="6322742">(</span><span class="string" id="6322743">&#34;consumePhrase:&nbsp;[%s]&#34;</span><span class="op" id="6322764">,</span>&nbsp;<span class="op" id="6322766">*</span><span class="ident" id="6322767"><a href="/net/mail/message.go.html#6322669">p</a></span><span class="op" id="6322768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6322771">//&nbsp;phrase&nbsp;=&nbsp;1*word</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322791">var</span>&nbsp;<span class="ident" id="6322795">words</span>&nbsp;<span class="op" id="6322801">[</span><span class="op" id="6322802">]</span><span class="builtintype" id="6322803">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322811">for</span>&nbsp;<span class="op" id="6322815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6322819">//&nbsp;word&nbsp;=&nbsp;atom&nbsp;/&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322852">var</span>&nbsp;<span class="ident" id="6322856">word</span>&nbsp;<span class="builtintype" id="6322861">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6322870"><a href="/net/mail/message.go.html#6322669">p</a></span><span class="op" id="6322871">.</span><span class="ident" id="6322872">skipSpace</span><span class="op" id="6322881">(</span><span class="op" id="6322882">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322886">if</span>&nbsp;<span class="ident" id="6322889"><a href="/net/mail/message.go.html#6322669">p</a></span><span class="op" id="6322890">.</span><span class="ident" id="6322891">empty</span><span class="op" id="6322896">(</span><span class="op" id="6322897">)</span>&nbsp;<span class="op" id="6322899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322904">return</span>&nbsp;<span class="string" id="6322911">&#34;&#34;</span><span class="op" id="6322913">,</span>&nbsp;<span class="ident" id="6322915"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6322921">.</span><span class="ident" id="6322922">New</span><span class="op" id="6322925">(</span><span class="string" id="6322926">&#34;mail:&nbsp;missing&nbsp;phrase&#34;</span><span class="op" id="6322948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6322952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6322956">if</span>&nbsp;<span class="ident" id="6322959"><a href="/net/mail/message.go.html#6322669">p</a></span><span class="op" id="6322960">.</span><span class="ident" id="6322961">peek</span><span class="op" id="6322965">(</span><span class="op" id="6322966">)</span>&nbsp;<span class="op" id="6322968">==</span>&nbsp;<span class="string" id="6322971">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6322975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6322980">//&nbsp;quoted-string</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323000"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323004">,</span>&nbsp;<span class="ident" id="6323006"><a href="/net/mail/message.go.html#6322716">err</a></span>&nbsp;<span class="op" id="6323010">=</span>&nbsp;<span class="ident" id="6323012"><a href="/net/mail/message.go.html#6322669">p</a></span><span class="op" id="6323013">.</span><span class="ident" id="6323014">consumeQuotedString</span><span class="op" id="6323033">(</span><span class="op" id="6323034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6323038">}</span>&nbsp;<span class="keyword" id="6323040">else</span>&nbsp;<span class="op" id="6323045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6323050">//&nbsp;atom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6323061">//&nbsp;We&nbsp;actually&nbsp;parse&nbsp;dot-atom&nbsp;here&nbsp;to&nbsp;be&nbsp;more&nbsp;permissive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6323121">//&nbsp;than&nbsp;what&nbsp;RFC&nbsp;5322&nbsp;specifies.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323157"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323161">,</span>&nbsp;<span class="ident" id="6323163"><a href="/net/mail/message.go.html#6322716">err</a></span>&nbsp;<span class="op" id="6323167">=</span>&nbsp;<span class="ident" id="6323169"><a href="/net/mail/message.go.html#6322669">p</a></span><span class="op" id="6323170">.</span><span class="ident" id="6323171">consumeAtom</span><span class="op" id="6323182">(</span><span class="builtintype" id="6323183">true</span><span class="op" id="6323187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6323191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6323196">//&nbsp;RFC&nbsp;2047&nbsp;encoded-word&nbsp;starts&nbsp;with&nbsp;=?,&nbsp;ends&nbsp;with&nbsp;?=,&nbsp;and&nbsp;has&nbsp;two&nbsp;other&nbsp;?s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6323275">if</span>&nbsp;<span class="ident" id="6323278"><a href="/net/mail/message.go.html#6322716">err</a></span>&nbsp;<span class="op" id="6323282">==</span>&nbsp;<span class="ident" id="6323285">nil</span>&nbsp;<span class="op" id="6323289">&amp;&amp;</span>&nbsp;<span class="ident" id="6323292"><a href="/net/mail/message.go.html#6315370">strings</a></span><span class="op" id="6323299">.</span><span class="ident" id="6323300">HasPrefix</span><span class="op" id="6323309">(</span><span class="ident" id="6323310"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323314">,</span>&nbsp;<span class="string" id="6323316">&#34;=?&#34;</span><span class="op" id="6323320">)</span>&nbsp;<span class="op" id="6323322">&amp;&amp;</span>&nbsp;<span class="ident" id="6323325"><a href="/net/mail/message.go.html#6315370">strings</a></span><span class="op" id="6323332">.</span><span class="ident" id="6323333">HasSuffix</span><span class="op" id="6323342">(</span><span class="ident" id="6323343"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323347">,</span>&nbsp;<span class="string" id="6323349">&#34;?=&#34;</span><span class="op" id="6323353">)</span>&nbsp;<span class="op" id="6323355">&amp;&amp;</span>&nbsp;<span class="ident" id="6323358"><a href="/net/mail/message.go.html#6315370">strings</a></span><span class="op" id="6323365">.</span><span class="ident" id="6323366">Count</span><span class="op" id="6323371">(</span><span class="ident" id="6323372"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323376">,</span>&nbsp;<span class="string" id="6323378">&#34;?&#34;</span><span class="op" id="6323381">)</span>&nbsp;<span class="op" id="6323383">==</span>&nbsp;<span class="num" id="6323386">4</span>&nbsp;<span class="op" id="6323388">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323393"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323397">,</span>&nbsp;<span class="ident" id="6323399"><a href="/net/mail/message.go.html#6322716">err</a></span>&nbsp;<span class="op" id="6323403">=</span>&nbsp;<span class="ident" id="6323405"><a href="/net/mail/message.go.html#6325436">decodeRFC2047Word</a></span><span class="op" id="6323422">(</span><span class="ident" id="6323423"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6323431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6323436">if</span>&nbsp;<span class="ident" id="6323439"><a href="/net/mail/message.go.html#6322716">err</a></span>&nbsp;<span class="op" id="6323443">!=</span>&nbsp;<span class="ident" id="6323446">nil</span>&nbsp;<span class="op" id="6323450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6323455">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6323463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323467"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6323472">.</span><span class="ident" id="6323473">Printf</span><span class="op" id="6323479">(</span><span class="string" id="6323480">&#34;consumePhrase:&nbsp;consumed&nbsp;%q&#34;</span><span class="op" id="6323508">,</span>&nbsp;<span class="ident" id="6323510"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323518"><a href="/net/mail/message.go.html#6322795">words</a></span>&nbsp;<span class="op" id="6323524">=</span>&nbsp;<span class="builtinfunc" id="6323526">append</span><span class="op" id="6323532">(</span><span class="ident" id="6323533"><a href="/net/mail/message.go.html#6322795">words</a></span><span class="op" id="6323538">,</span>&nbsp;<span class="ident" id="6323540"><a href="/net/mail/message.go.html#6322856">word</a></span><span class="op" id="6323544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6323547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6323550">//&nbsp;Ignore&nbsp;any&nbsp;error&nbsp;if&nbsp;we&nbsp;got&nbsp;at&nbsp;least&nbsp;one&nbsp;word.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6323600">if</span>&nbsp;<span class="ident" id="6323603"><a href="/net/mail/message.go.html#6322716">err</a></span>&nbsp;<span class="op" id="6323607">!=</span>&nbsp;<span class="ident" id="6323610">nil</span>&nbsp;<span class="op" id="6323614">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6323617">len</span><span class="op" id="6323620">(</span><span class="ident" id="6323621"><a href="/net/mail/message.go.html#6322795">words</a></span><span class="op" id="6323626">)</span>&nbsp;<span class="op" id="6323628">==</span>&nbsp;<span class="num" id="6323631">0</span>&nbsp;<span class="op" id="6323633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323637"><a href="/net/mail/message.go.html#6315406">debug</a></span><span class="op" id="6323642">.</span><span class="ident" id="6323643">Printf</span><span class="op" id="6323649">(</span><span class="string" id="6323650">&#34;consumePhrase:&nbsp;hit&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="6323678">,</span>&nbsp;<span class="ident" id="6323680"><a href="/net/mail/message.go.html#6322716">err</a></span><span class="op" id="6323683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6323687">return</span>&nbsp;<span class="string" id="6323694">&#34;&#34;</span><span class="op" id="6323696">,</span>&nbsp;<span class="ident" id="6323698"><a href="/net/mail/message.go.html#6315309">fmt</a></span><span class="op" id="6323701">.</span><span class="ident" id="6323702">Errorf</span><span class="op" id="6323708">(</span><span class="string" id="6323709">&#34;mail:&nbsp;missing&nbsp;word&nbsp;in&nbsp;phrase:&nbsp;%v&#34;</span><span class="op" id="6323743">,</span>&nbsp;<span class="ident" id="6323745"><a href="/net/mail/message.go.html#6322716">err</a></span><span class="op" id="6323748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6323751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323754"><a href="/net/mail/message.go.html#6322701">phrase</a></span>&nbsp;<span class="op" id="6323761">=</span>&nbsp;<span class="ident" id="6323763"><a href="/net/mail/message.go.html#6315370">strings</a></span><span class="op" id="6323770">.</span><span class="ident" id="6323771">Join</span><span class="op" id="6323775">(</span><span class="ident" id="6323776"><a href="/net/mail/message.go.html#6322795">words</a></span><span class="op" id="6323781">,</span>&nbsp;<span class="string" id="6323783">&#34;&nbsp;&#34;</span><span class="op" id="6323786">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6323789">return</span>&nbsp;<span class="ident" id="6323796"><a href="/net/mail/message.go.html#6322701">phrase</a></span><span class="op" id="6323802">,</span>&nbsp;<span class="ident" id="6323804">nil</span><br>
<span class="lineno"></span><span class="op" id="6323808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6323811">//&nbsp;consumeQuotedString&nbsp;parses&nbsp;the&nbsp;quoted&nbsp;string&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6323878">func</span>&nbsp;<span class="op" id="6323883">(</span><span class="ident" id="6323884">p</span>&nbsp;<span class="op" id="6323886">*</span><span class="ident" id="6323887"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6323897">)</span>&nbsp;<span class="ident" id="6323899">consumeQuotedString</span><span class="op" id="6323918">(</span><span class="op" id="6323919">)</span>&nbsp;<span class="op" id="6323921">(</span><span class="ident" id="6323922">qs</span>&nbsp;<span class="builtintype" id="6323925">string</span><span class="op" id="6323931">,</span>&nbsp;<span class="ident" id="6323933">err</span>&nbsp;<span class="builtintype" id="6323937">error</span><span class="op" id="6323942">)</span>&nbsp;<span class="op" id="6323944">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6323947">//&nbsp;Assume&nbsp;first&nbsp;byte&nbsp;is&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323977">i</span>&nbsp;<span class="op" id="6323979">:=</span>&nbsp;<span class="num" id="6323982">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6323985">qsb</span>&nbsp;<span class="op" id="6323989">:=</span>&nbsp;<span class="builtinfunc" id="6323992">make</span><span class="op" id="6323996">(</span><span class="op" id="6323997">[</span><span class="op" id="6323998">]</span><span class="builtintype" id="6323999">byte</span><span class="op" id="6324003">,</span>&nbsp;<span class="num" id="6324005">0</span><span class="op" id="6324006">,</span>&nbsp;<span class="num" id="6324008">10</span><span class="op" id="6324010">)</span><br>
<span class="lineno"></span><span class="ident" id="6324012">Loop</span><span class="op" id="6324016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324019">for</span>&nbsp;<span class="op" id="6324023">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324027">if</span>&nbsp;<span class="ident" id="6324030"><a href="/net/mail/message.go.html#6323977">i</a></span>&nbsp;<span class="op" id="6324032">&gt;=</span>&nbsp;<span class="ident" id="6324035"><a href="/net/mail/message.go.html#6323884">p</a></span><span class="op" id="6324036">.</span><span class="builtinfunc" id="6324037">len</span><span class="op" id="6324040">(</span><span class="op" id="6324041">)</span>&nbsp;<span class="op" id="6324043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324048">return</span>&nbsp;<span class="string" id="6324055">&#34;&#34;</span><span class="op" id="6324057">,</span>&nbsp;<span class="ident" id="6324059"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6324065">.</span><span class="ident" id="6324066">New</span><span class="op" id="6324069">(</span><span class="string" id="6324070">&#34;mail:&nbsp;unclosed&nbsp;quoted-string&#34;</span><span class="op" id="6324100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6324104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324108">switch</span>&nbsp;<span class="ident" id="6324115">c</span>&nbsp;<span class="op" id="6324117">:=</span>&nbsp;<span class="op" id="6324120">(</span><span class="op" id="6324121">*</span><span class="ident" id="6324122"><a href="/net/mail/message.go.html#6323884">p</a></span><span class="op" id="6324123">)</span><span class="op" id="6324124">[</span><span class="ident" id="6324125"><a href="/net/mail/message.go.html#6323977">i</a></span><span class="op" id="6324126">]</span><span class="op" id="6324127">;</span>&nbsp;<span class="op" id="6324129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324133">case</span>&nbsp;<span class="ident" id="6324138"><a href="/net/mail/message.go.html#6324115">c</a></span>&nbsp;<span class="op" id="6324140">==</span>&nbsp;<span class="string" id="6324143">&#39;&#34;&#39;</span><span class="op" id="6324146">:</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324151">break</span>&nbsp;<span class="ident" id="6324157">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324164">case</span>&nbsp;<span class="ident" id="6324169"><a href="/net/mail/message.go.html#6324115">c</a></span>&nbsp;<span class="op" id="6324171">==</span>&nbsp;<span class="string" id="6324174">&#39;\\&#39;</span><span class="op" id="6324178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324183">if</span>&nbsp;<span class="ident" id="6324186"><a href="/net/mail/message.go.html#6323977">i</a></span><span class="op" id="6324187">+</span><span class="num" id="6324188">1</span>&nbsp;<span class="op" id="6324190">==</span>&nbsp;<span class="ident" id="6324193"><a href="/net/mail/message.go.html#6323884">p</a></span><span class="op" id="6324194">.</span><span class="builtinfunc" id="6324195">len</span><span class="op" id="6324198">(</span><span class="op" id="6324199">)</span>&nbsp;<span class="op" id="6324201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324207">return</span>&nbsp;<span class="string" id="6324214">&#34;&#34;</span><span class="op" id="6324216">,</span>&nbsp;<span class="ident" id="6324218"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6324224">.</span><span class="ident" id="6324225">New</span><span class="op" id="6324228">(</span><span class="string" id="6324229">&#34;mail:&nbsp;unclosed&nbsp;quoted-string&#34;</span><span class="op" id="6324259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6324264">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6324269"><a href="/net/mail/message.go.html#6323985">qsb</a></span>&nbsp;<span class="op" id="6324273">=</span>&nbsp;<span class="builtinfunc" id="6324275">append</span><span class="op" id="6324281">(</span><span class="ident" id="6324282"><a href="/net/mail/message.go.html#6323985">qsb</a></span><span class="op" id="6324285">,</span>&nbsp;<span class="op" id="6324287">(</span><span class="op" id="6324288">*</span><span class="ident" id="6324289"><a href="/net/mail/message.go.html#6323884">p</a></span><span class="op" id="6324290">)</span><span class="op" id="6324291">[</span><span class="ident" id="6324292"><a href="/net/mail/message.go.html#6323977">i</a></span><span class="op" id="6324293">+</span><span class="num" id="6324294">1</span><span class="op" id="6324295">]</span><span class="op" id="6324296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6324301"><a href="/net/mail/message.go.html#6323977">i</a></span>&nbsp;<span class="op" id="6324303">+=</span>&nbsp;<span class="num" id="6324306">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324310">case</span>&nbsp;<span class="ident" id="6324315"><a href="/net/mail/message.go.html#6327649">isQtext</a></span><span class="op" id="6324322">(</span><span class="ident" id="6324323"><a href="/net/mail/message.go.html#6324115">c</a></span><span class="op" id="6324324">)</span><span class="op" id="6324325">,</span>&nbsp;<span class="ident" id="6324327"><a href="/net/mail/message.go.html#6324115">c</a></span>&nbsp;<span class="op" id="6324329">==</span>&nbsp;<span class="string" id="6324332">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6324336">||</span>&nbsp;<span class="ident" id="6324339"><a href="/net/mail/message.go.html#6324115">c</a></span>&nbsp;<span class="op" id="6324341">==</span>&nbsp;<span class="string" id="6324344">&#39;\t&#39;</span><span class="op" id="6324348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6324353">//&nbsp;qtext&nbsp;(printable&nbsp;US-ASCII&nbsp;excluding&nbsp;&#34;&nbsp;and&nbsp;\),&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6324408">//&nbsp;FWS&nbsp;(almost;&nbsp;we&#39;re&nbsp;ignoring&nbsp;CRLF)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6324448"><a href="/net/mail/message.go.html#6323985">qsb</a></span>&nbsp;<span class="op" id="6324452">=</span>&nbsp;<span class="builtinfunc" id="6324454">append</span><span class="op" id="6324460">(</span><span class="ident" id="6324461"><a href="/net/mail/message.go.html#6323985">qsb</a></span><span class="op" id="6324464">,</span>&nbsp;<span class="ident" id="6324466"><a href="/net/mail/message.go.html#6324115">c</a></span><span class="op" id="6324467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6324472"><a href="/net/mail/message.go.html#6323977">i</a></span><span class="op" id="6324473">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324478">default</span><span class="op" id="6324485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324490">return</span>&nbsp;<span class="string" id="6324497">&#34;&#34;</span><span class="op" id="6324499">,</span>&nbsp;<span class="ident" id="6324501"><a href="/net/mail/message.go.html#6315309">fmt</a></span><span class="op" id="6324504">.</span><span class="ident" id="6324505">Errorf</span><span class="op" id="6324511">(</span><span class="string" id="6324512">&#34;mail:&nbsp;bad&nbsp;character&nbsp;in&nbsp;quoted-string:&nbsp;%q&#34;</span><span class="op" id="6324554">,</span>&nbsp;<span class="ident" id="6324556"><a href="/net/mail/message.go.html#6324115">c</a></span><span class="op" id="6324557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6324561">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6324564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6324567">*</span><span class="ident" id="6324568"><a href="/net/mail/message.go.html#6323884">p</a></span>&nbsp;<span class="op" id="6324570">=</span>&nbsp;<span class="op" id="6324572">(</span><span class="op" id="6324573">*</span><span class="ident" id="6324574"><a href="/net/mail/message.go.html#6323884">p</a></span><span class="op" id="6324575">)</span><span class="op" id="6324576">[</span><span class="ident" id="6324577"><a href="/net/mail/message.go.html#6323977">i</a></span><span class="op" id="6324578">+</span><span class="num" id="6324579">1</span><span class="op" id="6324580">:</span><span class="op" id="6324581">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324584">return</span>&nbsp;<span class="builtintype" id="6324591">string</span><span class="op" id="6324597">(</span><span class="ident" id="6324598"><a href="/net/mail/message.go.html#6323985">qsb</a></span><span class="op" id="6324601">)</span><span class="op" id="6324602">,</span>&nbsp;<span class="ident" id="6324604">nil</span><br>
<span class="lineno"></span><span class="op" id="6324608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="6324611">//&nbsp;consumeAtom&nbsp;parses&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;atom&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="comment" id="6324669">//&nbsp;If&nbsp;dot&nbsp;is&nbsp;true,&nbsp;consumeAtom&nbsp;parses&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;dot-atom&nbsp;instead.</span><br>
<span class="lineno"></span><span class="keyword" id="6324737">func</span>&nbsp;<span class="op" id="6324742">(</span><span class="ident" id="6324743">p</span>&nbsp;<span class="op" id="6324745">*</span><span class="ident" id="6324746"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6324756">)</span>&nbsp;<span class="ident" id="6324758">consumeAtom</span><span class="op" id="6324769">(</span><span class="ident" id="6324770">dot</span>&nbsp;<span class="builtintype" id="6324774">bool</span><span class="op" id="6324778">)</span>&nbsp;<span class="op" id="6324780">(</span><span class="ident" id="6324781">atom</span>&nbsp;<span class="builtintype" id="6324786">string</span><span class="op" id="6324792">,</span>&nbsp;<span class="ident" id="6324794">err</span>&nbsp;<span class="builtintype" id="6324798">error</span><span class="op" id="6324803">)</span>&nbsp;<span class="op" id="6324805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324808">if</span>&nbsp;<span class="op" id="6324811">!</span><span class="ident" id="6324812"><a href="/net/mail/message.go.html#6327464">isAtext</a></span><span class="op" id="6324819">(</span><span class="ident" id="6324820"><a href="/net/mail/message.go.html#6324743">p</a></span><span class="op" id="6324821">.</span><span class="ident" id="6324822">peek</span><span class="op" id="6324826">(</span><span class="op" id="6324827">)</span><span class="op" id="6324828">,</span>&nbsp;<span class="builtintype" id="6324830">false</span><span class="op" id="6324835">)</span>&nbsp;<span class="op" id="6324837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324841">return</span>&nbsp;<span class="string" id="6324848">&#34;&#34;</span><span class="op" id="6324850">,</span>&nbsp;<span class="ident" id="6324852"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6324858">.</span><span class="ident" id="6324859">New</span><span class="op" id="6324862">(</span><span class="string" id="6324863">&#34;mail:&nbsp;invalid&nbsp;string&#34;</span><span class="op" id="6324885">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6324888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6324891">i</span>&nbsp;<span class="op" id="6324893">:=</span>&nbsp;<span class="num" id="6324896">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324899">for</span>&nbsp;<span class="op" id="6324903">;</span>&nbsp;<span class="ident" id="6324905"><a href="/net/mail/message.go.html#6324891">i</a></span>&nbsp;<span class="op" id="6324907">&lt;</span>&nbsp;<span class="ident" id="6324909"><a href="/net/mail/message.go.html#6324743">p</a></span><span class="op" id="6324910">.</span><span class="builtinfunc" id="6324911">len</span><span class="op" id="6324914">(</span><span class="op" id="6324915">)</span>&nbsp;<span class="op" id="6324917">&amp;&amp;</span>&nbsp;<span class="ident" id="6324920"><a href="/net/mail/message.go.html#6327464">isAtext</a></span><span class="op" id="6324927">(</span><span class="op" id="6324928">(</span><span class="op" id="6324929">*</span><span class="ident" id="6324930"><a href="/net/mail/message.go.html#6324743">p</a></span><span class="op" id="6324931">)</span><span class="op" id="6324932">[</span><span class="ident" id="6324933"><a href="/net/mail/message.go.html#6324891">i</a></span><span class="op" id="6324934">]</span><span class="op" id="6324935">,</span>&nbsp;<span class="ident" id="6324937"><a href="/net/mail/message.go.html#6324770">dot</a></span><span class="op" id="6324940">)</span><span class="op" id="6324941">;</span>&nbsp;<span class="ident" id="6324943"><a href="/net/mail/message.go.html#6324891">i</a></span><span class="op" id="6324944">++</span>&nbsp;<span class="op" id="6324947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6324950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6324953"><a href="/net/mail/message.go.html#6324781">atom</a></span><span class="op" id="6324957">,</span>&nbsp;<span class="op" id="6324959">*</span><span class="ident" id="6324960"><a href="/net/mail/message.go.html#6324743">p</a></span>&nbsp;<span class="op" id="6324962">=</span>&nbsp;<span class="builtintype" id="6324964">string</span><span class="op" id="6324970">(</span><span class="op" id="6324971">(</span><span class="op" id="6324972">*</span><span class="ident" id="6324973"><a href="/net/mail/message.go.html#6324743">p</a></span><span class="op" id="6324974">)</span><span class="op" id="6324975">[</span><span class="op" id="6324976">:</span><span class="ident" id="6324977"><a href="/net/mail/message.go.html#6324891">i</a></span><span class="op" id="6324978">]</span><span class="op" id="6324979">)</span><span class="op" id="6324980">,</span>&nbsp;<span class="op" id="6324982">(</span><span class="op" id="6324983">*</span><span class="ident" id="6324984"><a href="/net/mail/message.go.html#6324743">p</a></span><span class="op" id="6324985">)</span><span class="op" id="6324986">[</span><span class="ident" id="6324987"><a href="/net/mail/message.go.html#6324891">i</a></span><span class="op" id="6324988">:</span><span class="op" id="6324989">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6324992">return</span>&nbsp;<span class="ident" id="6324999"><a href="/net/mail/message.go.html#6324781">atom</a></span><span class="op" id="6325003">,</span>&nbsp;<span class="ident" id="6325005">nil</span><br>
<span class="lineno"></span><span class="op" id="6325009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6325012">func</span>&nbsp;<span class="op" id="6325017">(</span><span class="ident" id="6325018">p</span>&nbsp;<span class="op" id="6325020">*</span><span class="ident" id="6325021"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6325031">)</span>&nbsp;<span class="ident" id="6325033">consume</span><span class="op" id="6325040">(</span><span class="ident" id="6325041">c</span>&nbsp;<span class="builtintype" id="6325043">byte</span><span class="op" id="6325047">)</span>&nbsp;<span class="builtintype" id="6325049">bool</span>&nbsp;<span class="op" id="6325054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325057">if</span>&nbsp;<span class="ident" id="6325060"><a href="/net/mail/message.go.html#6325018">p</a></span><span class="op" id="6325061">.</span><span class="ident" id="6325062">empty</span><span class="op" id="6325067">(</span><span class="op" id="6325068">)</span>&nbsp;<span class="op" id="6325070">||</span>&nbsp;<span class="ident" id="6325073"><a href="/net/mail/message.go.html#6325018">p</a></span><span class="op" id="6325074">.</span><span class="ident" id="6325075">peek</span><span class="op" id="6325079">(</span><span class="op" id="6325080">)</span>&nbsp;<span class="op" id="6325082">!=</span>&nbsp;<span class="ident" id="6325085"><a href="/net/mail/message.go.html#6325041">c</a></span>&nbsp;<span class="op" id="6325087">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325091">return</span>&nbsp;<span class="builtintype" id="6325098">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6325105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6325108">*</span><span class="ident" id="6325109"><a href="/net/mail/message.go.html#6325018">p</a></span>&nbsp;<span class="op" id="6325111">=</span>&nbsp;<span class="op" id="6325113">(</span><span class="op" id="6325114">*</span><span class="ident" id="6325115"><a href="/net/mail/message.go.html#6325018">p</a></span><span class="op" id="6325116">)</span><span class="op" id="6325117">[</span><span class="num" id="6325118">1</span><span class="op" id="6325119">:</span><span class="op" id="6325120">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325123">return</span>&nbsp;<span class="builtintype" id="6325130">true</span><br>
<span class="lineno"></span><span class="op" id="6325135">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="comment" id="6325138">//&nbsp;skipSpace&nbsp;skips&nbsp;the&nbsp;leading&nbsp;space&nbsp;and&nbsp;tab&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6325195">func</span>&nbsp;<span class="op" id="6325200">(</span><span class="ident" id="6325201">p</span>&nbsp;<span class="op" id="6325203">*</span><span class="ident" id="6325204"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6325214">)</span>&nbsp;<span class="ident" id="6325216">skipSpace</span><span class="op" id="6325225">(</span><span class="op" id="6325226">)</span>&nbsp;<span class="op" id="6325228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6325231">*</span><span class="ident" id="6325232"><a href="/net/mail/message.go.html#6325201">p</a></span>&nbsp;<span class="op" id="6325234">=</span>&nbsp;<span class="ident" id="6325236"><a href="/net/mail/message.go.html#6315271">bytes</a></span><span class="op" id="6325241">.</span><span class="ident" id="6325242">TrimLeft</span><span class="op" id="6325250">(</span><span class="op" id="6325251">*</span><span class="ident" id="6325252"><a href="/net/mail/message.go.html#6325201">p</a></span><span class="op" id="6325253">,</span>&nbsp;<span class="string" id="6325255">&#34;&nbsp;\t&#34;</span><span class="op" id="6325260">)</span><br>
<span class="lineno"></span><span class="op" id="6325262">}</span><br>
<span class="lineno">430</span><br>
<span class="lineno"></span><span class="keyword" id="6325265">func</span>&nbsp;<span class="op" id="6325270">(</span><span class="ident" id="6325271">p</span>&nbsp;<span class="op" id="6325273">*</span><span class="ident" id="6325274"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6325284">)</span>&nbsp;<span class="ident" id="6325286">peek</span><span class="op" id="6325290">(</span><span class="op" id="6325291">)</span>&nbsp;<span class="builtintype" id="6325293">byte</span>&nbsp;<span class="op" id="6325298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325301">return</span>&nbsp;<span class="op" id="6325308">(</span><span class="op" id="6325309">*</span><span class="ident" id="6325310"><a href="/net/mail/message.go.html#6325271">p</a></span><span class="op" id="6325311">)</span><span class="op" id="6325312">[</span><span class="num" id="6325313">0</span><span class="op" id="6325314">]</span><br>
<span class="lineno"></span><span class="op" id="6325316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="6325319">func</span>&nbsp;<span class="op" id="6325324">(</span><span class="ident" id="6325325">p</span>&nbsp;<span class="op" id="6325327">*</span><span class="ident" id="6325328"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6325338">)</span>&nbsp;<span class="ident" id="6325340">empty</span><span class="op" id="6325345">(</span><span class="op" id="6325346">)</span>&nbsp;<span class="builtintype" id="6325348">bool</span>&nbsp;<span class="op" id="6325353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325356">return</span>&nbsp;<span class="ident" id="6325363"><a href="/net/mail/message.go.html#6325325">p</a></span><span class="op" id="6325364">.</span><span class="builtinfunc" id="6325365">len</span><span class="op" id="6325368">(</span><span class="op" id="6325369">)</span>&nbsp;<span class="op" id="6325371">==</span>&nbsp;<span class="num" id="6325374">0</span><br>
<span class="lineno"></span><span class="op" id="6325376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6325379">func</span>&nbsp;<span class="op" id="6325384">(</span><span class="ident" id="6325385">p</span>&nbsp;<span class="op" id="6325387">*</span><span class="ident" id="6325388"><a href="/net/mail/message.go.html#6319718">addrParser</a></span><span class="op" id="6325398">)</span>&nbsp;<span class="builtinfunc" id="6325400">len</span><span class="op" id="6325403">(</span><span class="op" id="6325404">)</span>&nbsp;<span class="builtintype" id="6325406">int</span>&nbsp;<span class="op" id="6325410">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325413">return</span>&nbsp;<span class="builtinfunc" id="6325420">len</span><span class="op" id="6325423">(</span><span class="op" id="6325424">*</span><span class="ident" id="6325425"><a href="/net/mail/message.go.html#6325385">p</a></span><span class="op" id="6325426">)</span><br>
<span class="lineno"></span><span class="op" id="6325428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6325431">func</span>&nbsp;<span class="ident" id="6325436">decodeRFC2047Word</span><span class="op" id="6325453">(</span><span class="ident" id="6325454">s</span>&nbsp;<span class="builtintype" id="6325456">string</span><span class="op" id="6325462">)</span>&nbsp;<span class="op" id="6325464">(</span><span class="builtintype" id="6325465">string</span><span class="op" id="6325471">,</span>&nbsp;<span class="builtintype" id="6325473">error</span><span class="op" id="6325478">)</span>&nbsp;<span class="op" id="6325480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6325483">fields</span>&nbsp;<span class="op" id="6325490">:=</span>&nbsp;<span class="ident" id="6325493"><a href="/net/mail/message.go.html#6315370">strings</a></span><span class="op" id="6325500">.</span><span class="ident" id="6325501">Split</span><span class="op" id="6325506">(</span><span class="ident" id="6325507"><a href="/net/mail/message.go.html#6325454">s</a></span><span class="op" id="6325508">,</span>&nbsp;<span class="string" id="6325510">&#34;?&#34;</span><span class="op" id="6325513">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325516">if</span>&nbsp;<span class="builtinfunc" id="6325519">len</span><span class="op" id="6325522">(</span><span class="ident" id="6325523"><a href="/net/mail/message.go.html#6325483">fields</a></span><span class="op" id="6325529">)</span>&nbsp;<span class="op" id="6325531">!=</span>&nbsp;<span class="num" id="6325534">5</span>&nbsp;<span class="op" id="6325536">||</span>&nbsp;<span class="ident" id="6325539"><a href="/net/mail/message.go.html#6325483">fields</a></span><span class="op" id="6325545">[</span><span class="num" id="6325546">0</span><span class="op" id="6325547">]</span>&nbsp;<span class="op" id="6325549">!=</span>&nbsp;<span class="string" id="6325552">&#34;=&#34;</span>&nbsp;<span class="op" id="6325556">||</span>&nbsp;<span class="ident" id="6325559"><a href="/net/mail/message.go.html#6325483">fields</a></span><span class="op" id="6325565">[</span><span class="num" id="6325566">4</span><span class="op" id="6325567">]</span>&nbsp;<span class="op" id="6325569">!=</span>&nbsp;<span class="string" id="6325572">&#34;=&#34;</span>&nbsp;<span class="op" id="6325576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325580">return</span>&nbsp;<span class="string" id="6325587">&#34;&#34;</span><span class="op" id="6325589">,</span>&nbsp;<span class="ident" id="6325591"><a href="/net/mail/message.go.html#6315299">errors</a></span><span class="op" id="6325597">.</span><span class="ident" id="6325598">New</span><span class="op" id="6325601">(</span><span class="string" id="6325602">&#34;address&nbsp;not&nbsp;RFC&nbsp;2047&nbsp;encoded&#34;</span><span class="op" id="6325632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6325635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6325638">charset</span><span class="op" id="6325645">,</span>&nbsp;<span class="ident" id="6325647">enc</span>&nbsp;<span class="op" id="6325651">:=</span>&nbsp;<span class="ident" id="6325654"><a href="/net/mail/message.go.html#6315370">strings</a></span><span class="op" id="6325661">.</span><span class="ident" id="6325662">ToLower</span><span class="op" id="6325669">(</span><span class="ident" id="6325670"><a href="/net/mail/message.go.html#6325483">fields</a></span><span class="op" id="6325676">[</span><span class="num" id="6325677">1</span><span class="op" id="6325678">]</span><span class="op" id="6325679">)</span><span class="op" id="6325680">,</span>&nbsp;<span class="ident" id="6325682"><a href="/net/mail/message.go.html#6315370">strings</a></span><span class="op" id="6325689">.</span><span class="ident" id="6325690">ToLower</span><span class="op" id="6325697">(</span><span class="ident" id="6325698"><a href="/net/mail/message.go.html#6325483">fields</a></span><span class="op" id="6325704">[</span><span class="num" id="6325705">2</span><span class="op" id="6325706">]</span><span class="op" id="6325707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325710">if</span>&nbsp;<span class="ident" id="6325713"><a href="/net/mail/message.go.html#6325638">charset</a></span>&nbsp;<span class="op" id="6325721">!=</span>&nbsp;<span class="string" id="6325724">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="6325735">&amp;&amp;</span>&nbsp;<span class="ident" id="6325738"><a href="/net/mail/message.go.html#6325638">charset</a></span>&nbsp;<span class="op" id="6325746">!=</span>&nbsp;<span class="string" id="6325749">&#34;iso-8859-1&#34;</span>&nbsp;<span class="op" id="6325762">&amp;&amp;</span>&nbsp;<span class="ident" id="6325765"><a href="/net/mail/message.go.html#6325638">charset</a></span>&nbsp;<span class="op" id="6325773">!=</span>&nbsp;<span class="string" id="6325776">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="6325784">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325788">return</span>&nbsp;<span class="string" id="6325795">&#34;&#34;</span><span class="op" id="6325797">,</span>&nbsp;<span class="ident" id="6325799"><a href="/net/mail/message.go.html#6315309">fmt</a></span><span class="op" id="6325802">.</span><span class="ident" id="6325803">Errorf</span><span class="op" id="6325809">(</span><span class="string" id="6325810">&#34;charset&nbsp;not&nbsp;supported:&nbsp;%q&#34;</span><span class="op" id="6325837">,</span>&nbsp;<span class="ident" id="6325839"><a href="/net/mail/message.go.html#6325638">charset</a></span><span class="op" id="6325846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6325849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6325853">in</span>&nbsp;<span class="op" id="6325856">:=</span>&nbsp;<span class="ident" id="6325859"><a href="/net/mail/message.go.html#6315271">bytes</a></span><span class="op" id="6325864">.</span><span class="ident" id="6325865">NewBufferString</span><span class="op" id="6325880">(</span><span class="ident" id="6325881"><a href="/net/mail/message.go.html#6325483">fields</a></span><span class="op" id="6325887">[</span><span class="num" id="6325888">3</span><span class="op" id="6325889">]</span><span class="op" id="6325890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325893">var</span>&nbsp;<span class="ident" id="6325897">r</span>&nbsp;<span class="ident" id="6325899"><a href="/net/mail/message.go.html#6315316">io</a></span><span class="op" id="6325901">.</span><span class="ident" id="6325902">Reader</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325910">switch</span>&nbsp;<span class="ident" id="6325917"><a href="/net/mail/message.go.html#6325647">enc</a></span>&nbsp;<span class="op" id="6325921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325924">case</span>&nbsp;<span class="string" id="6325929">&#34;b&#34;</span><span class="op" id="6325932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6325936"><a href="/net/mail/message.go.html#6325897">r</a></span>&nbsp;<span class="op" id="6325938">=</span>&nbsp;<span class="ident" id="6325940"><a href="/net/mail/message.go.html#6315280">base64</a></span><span class="op" id="6325946">.</span><span class="ident" id="6325947">NewDecoder</span><span class="op" id="6325957">(</span><span class="ident" id="6325958"><a href="/net/mail/message.go.html#6315280">base64</a></span><span class="op" id="6325964">.</span><span class="ident" id="6325965">StdEncoding</span><span class="op" id="6325976">,</span>&nbsp;<span class="ident" id="6325978"><a href="/net/mail/message.go.html#6325853">in</a></span><span class="op" id="6325980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6325983">case</span>&nbsp;<span class="string" id="6325988">&#34;q&#34;</span><span class="op" id="6325991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6325995"><a href="/net/mail/message.go.html#6325897">r</a></span>&nbsp;<span class="op" id="6325997">=</span>&nbsp;<span class="ident" id="6325999"><a href="/net/mail/message.go.html#6326581">qDecoder</a></span><span class="op" id="6326007">{</span><span class="ident" id="6326008">r</span><span class="op" id="6326009">:</span>&nbsp;<span class="ident" id="6326011"><a href="/net/mail/message.go.html#6325853">in</a></span><span class="op" id="6326013">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326016">default</span><span class="op" id="6326023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326027">return</span>&nbsp;<span class="string" id="6326034">&#34;&#34;</span><span class="op" id="6326036">,</span>&nbsp;<span class="ident" id="6326038"><a href="/net/mail/message.go.html#6315309">fmt</a></span><span class="op" id="6326041">.</span><span class="ident" id="6326042">Errorf</span><span class="op" id="6326048">(</span><span class="string" id="6326049">&#34;RFC&nbsp;2047&nbsp;encoding&nbsp;not&nbsp;supported:&nbsp;%q&#34;</span><span class="op" id="6326086">,</span>&nbsp;<span class="ident" id="6326088"><a href="/net/mail/message.go.html#6325647">enc</a></span><span class="op" id="6326091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326098">dec</span><span class="op" id="6326101">,</span>&nbsp;<span class="ident" id="6326103">err</span>&nbsp;<span class="op" id="6326107">:=</span>&nbsp;<span class="ident" id="6326110"><a href="/net/mail/message.go.html#6315322">ioutil</a></span><span class="op" id="6326116">.</span><span class="ident" id="6326117">ReadAll</span><span class="op" id="6326124">(</span><span class="ident" id="6326125"><a href="/net/mail/message.go.html#6325897">r</a></span><span class="op" id="6326126">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326129">if</span>&nbsp;<span class="ident" id="6326132"><a href="/net/mail/message.go.html#6326103">err</a></span>&nbsp;<span class="op" id="6326136">!=</span>&nbsp;<span class="ident" id="6326139">nil</span>&nbsp;<span class="op" id="6326143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326147">return</span>&nbsp;<span class="string" id="6326154">&#34;&#34;</span><span class="op" id="6326156">,</span>&nbsp;<span class="ident" id="6326158"><a href="/net/mail/message.go.html#6326103">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326167">switch</span>&nbsp;<span class="ident" id="6326174"><a href="/net/mail/message.go.html#6325638">charset</a></span>&nbsp;<span class="op" id="6326182">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326185">case</span>&nbsp;<span class="string" id="6326190">&#34;us-ascii&#34;</span><span class="op" id="6326200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326204">b</span>&nbsp;<span class="op" id="6326206">:=</span>&nbsp;<span class="builtinfunc" id="6326209">new</span><span class="op" id="6326212">(</span><span class="ident" id="6326213"><a href="/net/mail/message.go.html#6315271">bytes</a></span><span class="op" id="6326218">.</span><span class="ident" id="6326219">Buffer</span><span class="op" id="6326225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326229">for</span>&nbsp;<span class="ident" id="6326233">_</span><span class="op" id="6326234">,</span>&nbsp;<span class="ident" id="6326236">c</span>&nbsp;<span class="op" id="6326238">:=</span>&nbsp;<span class="keyword" id="6326241">range</span>&nbsp;<span class="ident" id="6326247"><a href="/net/mail/message.go.html#6326098">dec</a></span>&nbsp;<span class="op" id="6326251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326256">if</span>&nbsp;<span class="ident" id="6326259"><a href="/net/mail/message.go.html#6326236">c</a></span>&nbsp;<span class="op" id="6326261">&gt;=</span>&nbsp;<span class="num" id="6326264">0x80</span>&nbsp;<span class="op" id="6326269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326275"><a href="/net/mail/message.go.html#6326204">b</a></span><span class="op" id="6326276">.</span><span class="ident" id="6326277">WriteRune</span><span class="op" id="6326286">(</span><span class="ident" id="6326287"><a href="/net/mail/message.go.html#6315389">unicode</a></span><span class="op" id="6326294">.</span><span class="ident" id="6326295">ReplacementChar</span><span class="op" id="6326310">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326315">}</span>&nbsp;<span class="keyword" id="6326317">else</span>&nbsp;<span class="op" id="6326322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326328"><a href="/net/mail/message.go.html#6326204">b</a></span><span class="op" id="6326329">.</span><span class="ident" id="6326330">WriteRune</span><span class="op" id="6326339">(</span><span class="builtintype" id="6326340">rune</span><span class="op" id="6326344">(</span><span class="ident" id="6326345"><a href="/net/mail/message.go.html#6326236">c</a></span><span class="op" id="6326346">)</span><span class="op" id="6326347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326360">return</span>&nbsp;<span class="ident" id="6326367"><a href="/net/mail/message.go.html#6326204">b</a></span><span class="op" id="6326368">.</span><span class="ident" id="6326369">String</span><span class="op" id="6326375">(</span><span class="op" id="6326376">)</span><span class="op" id="6326377">,</span>&nbsp;<span class="ident" id="6326379">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326384">case</span>&nbsp;<span class="string" id="6326389">&#34;iso-8859-1&#34;</span><span class="op" id="6326401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326405">b</span>&nbsp;<span class="op" id="6326407">:=</span>&nbsp;<span class="builtinfunc" id="6326410">new</span><span class="op" id="6326413">(</span><span class="ident" id="6326414"><a href="/net/mail/message.go.html#6315271">bytes</a></span><span class="op" id="6326419">.</span><span class="ident" id="6326420">Buffer</span><span class="op" id="6326426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326430">for</span>&nbsp;<span class="ident" id="6326434">_</span><span class="op" id="6326435">,</span>&nbsp;<span class="ident" id="6326437">c</span>&nbsp;<span class="op" id="6326439">:=</span>&nbsp;<span class="keyword" id="6326442">range</span>&nbsp;<span class="ident" id="6326448"><a href="/net/mail/message.go.html#6326098">dec</a></span>&nbsp;<span class="op" id="6326452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326457"><a href="/net/mail/message.go.html#6326405">b</a></span><span class="op" id="6326458">.</span><span class="ident" id="6326459">WriteRune</span><span class="op" id="6326468">(</span><span class="builtintype" id="6326469">rune</span><span class="op" id="6326473">(</span><span class="ident" id="6326474"><a href="/net/mail/message.go.html#6326437">c</a></span><span class="op" id="6326475">)</span><span class="op" id="6326476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326480">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326484">return</span>&nbsp;<span class="ident" id="6326491"><a href="/net/mail/message.go.html#6326405">b</a></span><span class="op" id="6326492">.</span><span class="ident" id="6326493">String</span><span class="op" id="6326499">(</span><span class="op" id="6326500">)</span><span class="op" id="6326501">,</span>&nbsp;<span class="ident" id="6326503">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326508">case</span>&nbsp;<span class="string" id="6326513">&#34;utf-8&#34;</span><span class="op" id="6326520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326524">return</span>&nbsp;<span class="builtintype" id="6326531">string</span><span class="op" id="6326537">(</span><span class="ident" id="6326538"><a href="/net/mail/message.go.html#6326098">dec</a></span><span class="op" id="6326541">)</span><span class="op" id="6326542">,</span>&nbsp;<span class="ident" id="6326544">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6326552">panic</span><span class="op" id="6326557">(</span><span class="string" id="6326558">&#34;unreachable&#34;</span><span class="op" id="6326571">)</span><br>
<span class="lineno">490</span><span class="op" id="6326573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6326576">type</span>&nbsp;<span class="ident" id="6326581">qDecoder</span>&nbsp;<span class="keyword" id="6326590">struct</span>&nbsp;<span class="op" id="6326597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326600">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6326608"><a href="/net/mail/message.go.html#6315316">io</a></span><span class="op" id="6326610">.</span><span class="ident" id="6326611">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326619">scratch</span>&nbsp;<span class="op" id="6326627">[</span><span class="num" id="6326628">2</span><span class="op" id="6326629">]</span><span class="builtintype" id="6326630">byte</span><br>
<span class="lineno">495</span><span class="op" id="6326635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6326638">func</span>&nbsp;<span class="op" id="6326643">(</span><span class="ident" id="6326644">qd</span>&nbsp;<span class="ident" id="6326647"><a href="/net/mail/message.go.html#6326581">qDecoder</a></span><span class="op" id="6326655">)</span>&nbsp;<span class="ident" id="6326657">Read</span><span class="op" id="6326661">(</span><span class="ident" id="6326662">p</span>&nbsp;<span class="op" id="6326664">[</span><span class="op" id="6326665">]</span><span class="builtintype" id="6326666">byte</span><span class="op" id="6326670">)</span>&nbsp;<span class="op" id="6326672">(</span><span class="ident" id="6326673">n</span>&nbsp;<span class="builtintype" id="6326675">int</span><span class="op" id="6326678">,</span>&nbsp;<span class="ident" id="6326680">err</span>&nbsp;<span class="builtintype" id="6326684">error</span><span class="op" id="6326689">)</span>&nbsp;<span class="op" id="6326691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6326694">//&nbsp;This&nbsp;method&nbsp;writes&nbsp;at&nbsp;most&nbsp;one&nbsp;byte&nbsp;into&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326742">if</span>&nbsp;<span class="builtinfunc" id="6326745">len</span><span class="op" id="6326748">(</span><span class="ident" id="6326749"><a href="/net/mail/message.go.html#6326662">p</a></span><span class="op" id="6326750">)</span>&nbsp;<span class="op" id="6326752">==</span>&nbsp;<span class="num" id="6326755">0</span>&nbsp;<span class="op" id="6326757">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326761">return</span>&nbsp;<span class="num" id="6326768">0</span><span class="op" id="6326769">,</span>&nbsp;<span class="ident" id="6326771">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326779">if</span>&nbsp;<span class="ident" id="6326782">_</span><span class="op" id="6326783">,</span>&nbsp;<span class="ident" id="6326785">err</span>&nbsp;<span class="op" id="6326789">:=</span>&nbsp;<span class="ident" id="6326792"><a href="/net/mail/message.go.html#6326644">qd</a></span><span class="op" id="6326794">.</span><span class="ident" id="6326795">r</span><span class="op" id="6326796">.</span><span class="ident" id="6326797">Read</span><span class="op" id="6326801">(</span><span class="ident" id="6326802"><a href="/net/mail/message.go.html#6326644">qd</a></span><span class="op" id="6326804">.</span><span class="ident" id="6326805">scratch</span><span class="op" id="6326812">[</span><span class="op" id="6326813">:</span><span class="num" id="6326814">1</span><span class="op" id="6326815">]</span><span class="op" id="6326816">)</span><span class="op" id="6326817">;</span>&nbsp;<span class="ident" id="6326819"><a href="/net/mail/message.go.html#6326785">err</a></span>&nbsp;<span class="op" id="6326823">!=</span>&nbsp;<span class="ident" id="6326826">nil</span>&nbsp;<span class="op" id="6326830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326834">return</span>&nbsp;<span class="num" id="6326841">0</span><span class="op" id="6326842">,</span>&nbsp;<span class="ident" id="6326844"><a href="/net/mail/message.go.html#6326785">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326849">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326852">switch</span>&nbsp;<span class="ident" id="6326859">c</span>&nbsp;<span class="op" id="6326861">:=</span>&nbsp;<span class="ident" id="6326864"><a href="/net/mail/message.go.html#6326644">qd</a></span><span class="op" id="6326866">.</span><span class="ident" id="6326867">scratch</span><span class="op" id="6326874">[</span><span class="num" id="6326875">0</span><span class="op" id="6326876">]</span><span class="op" id="6326877">;</span>&nbsp;<span class="op" id="6326879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326882">case</span>&nbsp;<span class="ident" id="6326887"><a href="/net/mail/message.go.html#6326859">c</a></span>&nbsp;<span class="op" id="6326889">==</span>&nbsp;<span class="string" id="6326892">&#39;=&#39;</span><span class="op" id="6326895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326899">if</span>&nbsp;<span class="ident" id="6326902">_</span><span class="op" id="6326903">,</span>&nbsp;<span class="ident" id="6326905">err</span>&nbsp;<span class="op" id="6326909">:=</span>&nbsp;<span class="ident" id="6326912"><a href="/net/mail/message.go.html#6315316">io</a></span><span class="op" id="6326914">.</span><span class="ident" id="6326915">ReadFull</span><span class="op" id="6326923">(</span><span class="ident" id="6326924"><a href="/net/mail/message.go.html#6326644">qd</a></span><span class="op" id="6326926">.</span><span class="ident" id="6326927">r</span><span class="op" id="6326928">,</span>&nbsp;<span class="ident" id="6326930"><a href="/net/mail/message.go.html#6326644">qd</a></span><span class="op" id="6326932">.</span><span class="ident" id="6326933">scratch</span><span class="op" id="6326940">[</span><span class="op" id="6326941">:</span><span class="num" id="6326942">2</span><span class="op" id="6326943">]</span><span class="op" id="6326944">)</span><span class="op" id="6326945">;</span>&nbsp;<span class="ident" id="6326947"><a href="/net/mail/message.go.html#6326905">err</a></span>&nbsp;<span class="op" id="6326951">!=</span>&nbsp;<span class="ident" id="6326954">nil</span>&nbsp;<span class="op" id="6326958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6326963">return</span>&nbsp;<span class="num" id="6326970">0</span><span class="op" id="6326971">,</span>&nbsp;<span class="ident" id="6326973"><a href="/net/mail/message.go.html#6326905">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6326979">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6326983">x</span><span class="op" id="6326984">,</span>&nbsp;<span class="ident" id="6326986">err</span>&nbsp;<span class="op" id="6326990">:=</span>&nbsp;<span class="ident" id="6326993"><a href="/net/mail/message.go.html#6315359">strconv</a></span><span class="op" id="6327000">.</span><span class="ident" id="6327001">ParseInt</span><span class="op" id="6327009">(</span><span class="builtintype" id="6327010">string</span><span class="op" id="6327016">(</span><span class="ident" id="6327017"><a href="/net/mail/message.go.html#6326644">qd</a></span><span class="op" id="6327019">.</span><span class="ident" id="6327020">scratch</span><span class="op" id="6327027">[</span><span class="op" id="6327028">:</span><span class="num" id="6327029">2</span><span class="op" id="6327030">]</span><span class="op" id="6327031">)</span><span class="op" id="6327032">,</span>&nbsp;<span class="num" id="6327034">16</span><span class="op" id="6327036">,</span>&nbsp;<span class="num" id="6327038">64</span><span class="op" id="6327040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327044">if</span>&nbsp;<span class="ident" id="6327047"><a href="/net/mail/message.go.html#6326986">err</a></span>&nbsp;<span class="op" id="6327051">!=</span>&nbsp;<span class="ident" id="6327054">nil</span>&nbsp;<span class="op" id="6327058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327063">return</span>&nbsp;<span class="num" id="6327070">0</span><span class="op" id="6327071">,</span>&nbsp;<span class="ident" id="6327073"><a href="/net/mail/message.go.html#6315309">fmt</a></span><span class="op" id="6327076">.</span><span class="ident" id="6327077">Errorf</span><span class="op" id="6327083">(</span><span class="string" id="6327084">&#34;mail:&nbsp;invalid&nbsp;RFC&nbsp;2047&nbsp;encoding:&nbsp;%q&#34;</span><span class="op" id="6327121">,</span>&nbsp;<span class="ident" id="6327123"><a href="/net/mail/message.go.html#6326644">qd</a></span><span class="op" id="6327125">.</span><span class="ident" id="6327126">scratch</span><span class="op" id="6327133">[</span><span class="op" id="6327134">:</span><span class="num" id="6327135">2</span><span class="op" id="6327136">]</span><span class="op" id="6327137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6327141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327145"><a href="/net/mail/message.go.html#6326662">p</a></span><span class="op" id="6327146">[</span><span class="num" id="6327147">0</span><span class="op" id="6327148">]</span>&nbsp;<span class="op" id="6327150">=</span>&nbsp;<span class="builtintype" id="6327152">byte</span><span class="op" id="6327156">(</span><span class="ident" id="6327157"><a href="/net/mail/message.go.html#6326983">x</a></span><span class="op" id="6327158">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327161">case</span>&nbsp;<span class="ident" id="6327166"><a href="/net/mail/message.go.html#6326859">c</a></span>&nbsp;<span class="op" id="6327168">==</span>&nbsp;<span class="string" id="6327171">&#39;_&#39;</span><span class="op" id="6327174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327178"><a href="/net/mail/message.go.html#6326662">p</a></span><span class="op" id="6327179">[</span><span class="num" id="6327180">0</span><span class="op" id="6327181">]</span>&nbsp;<span class="op" id="6327183">=</span>&nbsp;<span class="string" id="6327185">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327190">default</span><span class="op" id="6327197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6327201"><a href="/net/mail/message.go.html#6326662">p</a></span><span class="op" id="6327202">[</span><span class="num" id="6327203">0</span><span class="op" id="6327204">]</span>&nbsp;<span class="op" id="6327206">=</span>&nbsp;<span class="ident" id="6327208"><a href="/net/mail/message.go.html#6326859">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6327211">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327214">return</span>&nbsp;<span class="num" id="6327221">1</span><span class="op" id="6327222">,</span>&nbsp;<span class="ident" id="6327224">nil</span><br>
<span class="lineno"></span><span class="op" id="6327228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6327231">var</span>&nbsp;<span class="ident" id="6327235">atextChars</span>&nbsp;<span class="op" id="6327246">=</span>&nbsp;<span class="op" id="6327248">[</span><span class="op" id="6327249">]</span><span class="builtintype" id="6327250">byte</span><span class="op" id="6327254">(</span><span class="string" id="6327255">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>&nbsp;<span class="op" id="6327284">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327287">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>&nbsp;<span class="op" id="6327316">+</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327319">&#34;0123456789&#34;</span>&nbsp;<span class="op" id="6327332">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6327335">&#34;!#$%&amp;&#39;*+-/=?^_`{|}~&#34;</span><span class="op" id="6327356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327359">//&nbsp;isAtext&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;atext&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6327420">//&nbsp;If&nbsp;dot&nbsp;is&nbsp;true,&nbsp;period&nbsp;is&nbsp;included.</span><br>
<span class="lineno">530</span><span class="keyword" id="6327459">func</span>&nbsp;<span class="ident" id="6327464">isAtext</span><span class="op" id="6327471">(</span><span class="ident" id="6327472">c</span>&nbsp;<span class="builtintype" id="6327474">byte</span><span class="op" id="6327478">,</span>&nbsp;<span class="ident" id="6327480">dot</span>&nbsp;<span class="builtintype" id="6327484">bool</span><span class="op" id="6327488">)</span>&nbsp;<span class="builtintype" id="6327490">bool</span>&nbsp;<span class="op" id="6327495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327498">if</span>&nbsp;<span class="ident" id="6327501"><a href="/net/mail/message.go.html#6327480">dot</a></span>&nbsp;<span class="op" id="6327505">&amp;&amp;</span>&nbsp;<span class="ident" id="6327508"><a href="/net/mail/message.go.html#6327472">c</a></span>&nbsp;<span class="op" id="6327510">==</span>&nbsp;<span class="string" id="6327513">&#39;.&#39;</span>&nbsp;<span class="op" id="6327517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327521">return</span>&nbsp;<span class="builtintype" id="6327528">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6327534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327537">return</span>&nbsp;<span class="ident" id="6327544"><a href="/net/mail/message.go.html#6315271">bytes</a></span><span class="op" id="6327549">.</span><span class="ident" id="6327550">IndexByte</span><span class="op" id="6327559">(</span><span class="ident" id="6327560"><a href="/net/mail/message.go.html#6327235">atextChars</a></span><span class="op" id="6327570">,</span>&nbsp;<span class="ident" id="6327572"><a href="/net/mail/message.go.html#6327472">c</a></span><span class="op" id="6327573">)</span>&nbsp;<span class="op" id="6327575">&gt;=</span>&nbsp;<span class="num" id="6327578">0</span><br>
<span class="lineno">535</span><span class="op" id="6327580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327583">//&nbsp;isQtext&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;qtext&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6327644">func</span>&nbsp;<span class="ident" id="6327649">isQtext</span><span class="op" id="6327656">(</span><span class="ident" id="6327657">c</span>&nbsp;<span class="builtintype" id="6327659">byte</span><span class="op" id="6327663">)</span>&nbsp;<span class="builtintype" id="6327665">bool</span>&nbsp;<span class="op" id="6327670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327673">//&nbsp;Printable&nbsp;US-ASCII,&nbsp;excluding&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327727">if</span>&nbsp;<span class="ident" id="6327730"><a href="/net/mail/message.go.html#6327657">c</a></span>&nbsp;<span class="op" id="6327732">==</span>&nbsp;<span class="string" id="6327735">&#39;\\&#39;</span>&nbsp;<span class="op" id="6327740">||</span>&nbsp;<span class="ident" id="6327743"><a href="/net/mail/message.go.html#6327657">c</a></span>&nbsp;<span class="op" id="6327745">==</span>&nbsp;<span class="string" id="6327748">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6327752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327756">return</span>&nbsp;<span class="builtintype" id="6327763">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6327770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327773">return</span>&nbsp;<span class="string" id="6327780">&#39;!&#39;</span>&nbsp;<span class="op" id="6327784">&lt;=</span>&nbsp;<span class="ident" id="6327787"><a href="/net/mail/message.go.html#6327657">c</a></span>&nbsp;<span class="op" id="6327789">&amp;&amp;</span>&nbsp;<span class="ident" id="6327792"><a href="/net/mail/message.go.html#6327657">c</a></span>&nbsp;<span class="op" id="6327794">&lt;=</span>&nbsp;<span class="string" id="6327797">&#39;~&#39;</span><br>
<span class="lineno"></span><span class="op" id="6327801">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="6327804">//&nbsp;isVchar&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;VCHAR&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6327865">func</span>&nbsp;<span class="ident" id="6327870">isVchar</span><span class="op" id="6327877">(</span><span class="ident" id="6327878">c</span>&nbsp;<span class="builtintype" id="6327880">byte</span><span class="op" id="6327884">)</span>&nbsp;<span class="builtintype" id="6327886">bool</span>&nbsp;<span class="op" id="6327891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6327894">//&nbsp;Visible&nbsp;(printing)&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6327929">return</span>&nbsp;<span class="string" id="6327936">&#39;!&#39;</span>&nbsp;<span class="op" id="6327940">&lt;=</span>&nbsp;<span class="ident" id="6327943"><a href="/net/mail/message.go.html#6327878">c</a></span>&nbsp;<span class="op" id="6327945">&amp;&amp;</span>&nbsp;<span class="ident" id="6327948"><a href="/net/mail/message.go.html#6327878">c</a></span>&nbsp;<span class="op" id="6327950">&lt;=</span>&nbsp;<span class="string" id="6327953">&#39;~&#39;</span><br>
<span class="lineno">550</span><span class="op" id="6327957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6327960">//&nbsp;isWSP&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;a&nbsp;WSP&nbsp;(white&nbsp;space).</span><br>
<span class="lineno"></span><span class="comment" id="6328011">//&nbsp;WSP&nbsp;is&nbsp;a&nbsp;space&nbsp;or&nbsp;horizontal&nbsp;tab&nbsp;(RFC5234&nbsp;Appendix&nbsp;B).</span><br>
<span class="lineno"></span><span class="keyword" id="6328069">func</span>&nbsp;<span class="ident" id="6328074">isWSP</span><span class="op" id="6328079">(</span><span class="ident" id="6328080">c</span>&nbsp;<span class="builtintype" id="6328082">byte</span><span class="op" id="6328086">)</span>&nbsp;<span class="builtintype" id="6328088">bool</span>&nbsp;<span class="op" id="6328093">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6328096">return</span>&nbsp;<span class="ident" id="6328103"><a href="/net/mail/message.go.html#6328080">c</a></span>&nbsp;<span class="op" id="6328105">==</span>&nbsp;<span class="string" id="6328108">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6328112">||</span>&nbsp;<span class="ident" id="6328115"><a href="/net/mail/message.go.html#6328080">c</a></span>&nbsp;<span class="op" id="6328117">==</span>&nbsp;<span class="string" id="6328120">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="6328125">}</span>
</div>
</body>
</html>
